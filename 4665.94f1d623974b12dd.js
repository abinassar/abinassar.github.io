(self.webpackChunkapp=self.webpackChunkapp||[]).push([[4665],{4665:(Du,y,ee)=>{"use strict";ee.r(y),ee.d(y,{GraphicsPageModule:()=>Ne});var Q=ee(9928),g=ee(6895),v=ee(4719),m=ee(5062),x=ee(655);const e=["plot"],n=["*"];class t{static setModuleName(ze){t.moduleName=ze}static getModuleName(){return t.moduleName}static setPlotly(ze){if("object"==typeof ze&&"function"!=typeof ze.react)throw new Error("Invalid plotly.js version. Please, use any version above 1.40.0");t.plotly=ze}static insert(ze){return-1===t.instances.indexOf(ze)&&t.instances.push(ze),ze}static remove(ze){const Me=t.instances.indexOf(ze);Me>=0&&(t.instances.splice(Me,1),t.plotly.purge(ze))}getInstanceByDivId(ze){for(const Me of t.instances)if(Me&&Me.id===ze)return Me}getPlotly(){return(0,x.mG)(this,void 0,void 0,function*(){return yield this.waitFor(()=>"waiting"!==this._getPlotly()),this._getPlotly()})}_getPlotly(){if(typeof t.plotly>"u")throw new Error("ViaCDN"===t.moduleName?"Error loading Peer dependency plotly.js from CDN url":"Peer dependency plotly.js isn't installed");return t.plotly}waitFor(ze){return new Promise(Me=>{const Se=()=>{ze()?Me():setTimeout(Se,10)};Se()})}newPlot(ze,Me,Se,Ie,Fe){return(0,x.mG)(this,void 0,void 0,function*(){if(yield this.waitFor(()=>"waiting"!==this._getPlotly()),Fe){const Re={data:Me,layout:Se,config:Ie,frames:Fe};return this._getPlotly().newPlot(ze,Re).then(()=>t.insert(ze))}return this._getPlotly().newPlot(ze,Me,Se,Ie).then(()=>t.insert(ze))})}plot(ze,Me,Se,Ie,Fe){if(Fe){const Re={data:Me,layout:Se,config:Ie,frames:Fe};return"function"==typeof this._getPlotly().plot?this._getPlotly().plot(ze,Re):this._getPlotly().newPlot(ze,Re)}return"function"==typeof this._getPlotly().plot?this._getPlotly().plot(ze,Me,Se,Ie):this._getPlotly().newPlot(ze,Me,Se,Ie)}update(ze,Me,Se,Ie,Fe){if(Fe){const Re={data:Me,layout:Se,config:Ie,frames:Fe};return this._getPlotly().react(ze,Re)}return this._getPlotly().react(ze,Me,Se,Ie)}resize(ze){return this._getPlotly().Plots.resize(ze)}}t.\u0275fac=function(ze){return new(ze||t)},t.instances=[],t.plotly=void 0,t.moduleName=void 0,t.\u0275prov=m.Yz7({factory:function(){return new t},token:t,providedIn:"root"});let a=(()=>{class De{constructor(Me,Se,Ie){this.plotly=Me,this.iterableDiffers=Se,this.keyValueDiffers=Ie,this.defaultClassName="js-plotly-plot",this.revision=0,this.debug=!1,this.useResizeHandler=!1,this.updateOnLayoutChange=!0,this.updateOnDataChange=!0,this.updateOnlyWithRevision=!1,this.initialized=new m.vpe,this.update=new m.vpe,this.purge=new m.vpe,this.error=new m.vpe,this.afterExport=new m.vpe,this.afterPlot=new m.vpe,this.animated=new m.vpe,this.animatingFrame=new m.vpe,this.animationInterrupted=new m.vpe,this.autoSize=new m.vpe,this.beforeExport=new m.vpe,this.buttonClicked=new m.vpe,this.click=new m.vpe,this.plotlyClick=new m.vpe,this.clickAnnotation=new m.vpe,this.deselect=new m.vpe,this.doubleClick=new m.vpe,this.framework=new m.vpe,this.hover=new m.vpe,this.legendClick=new m.vpe,this.legendDoubleClick=new m.vpe,this.react=new m.vpe,this.relayout=new m.vpe,this.restyle=new m.vpe,this.redraw=new m.vpe,this.selected=new m.vpe,this.selecting=new m.vpe,this.sliderChange=new m.vpe,this.sliderEnd=new m.vpe,this.sliderStart=new m.vpe,this.transitioning=new m.vpe,this.transitionInterrupted=new m.vpe,this.unhover=new m.vpe,this.relayouting=new m.vpe,this.treemapclick=new m.vpe,this.sunburstclick=new m.vpe,this.eventNames=["afterExport","afterPlot","animated","animatingFrame","animationInterrupted","autoSize","beforeExport","buttonClicked","clickAnnotation","deselect","doubleClick","framework","hover","legendClick","legendDoubleClick","react","relayout","restyle","redraw","selected","selecting","sliderChange","sliderEnd","sliderStart","transitioning","transitionInterrupted","unhover","relayouting","treemapclick","sunburstclick"]}ngOnInit(){this.createPlot().then(()=>{const Me=this.createFigure();this.initialized.emit(Me)}),this.click.observers.length>0&&console.error("DEPRECATED: Reconsider using `(plotlyClick)` instead of `(click)` to avoid event conflict. Please check https://github.com/plotly/angular-plotly.js#FAQ")}ngOnDestroy(){"function"==typeof this.resizeHandler&&(this.getWindow().removeEventListener("resize",this.resizeHandler),this.resizeHandler=void 0);const Me=this.createFigure();this.purge.emit(Me),t.remove(this.plotlyInstance)}ngOnChanges(Me){let Se=!1;const Ie=Me.revision;Ie&&!Ie.isFirstChange()&&(Se=!0);const Fe=Me.debug;Fe&&!Fe.isFirstChange()&&(Se=!0),Se&&this.updatePlot(),this.updateWindowResizeHandler()}ngDoCheck(){if(this.updateOnlyWithRevision)return!1;let Me=!1;this.updateOnLayoutChange&&(this.layoutDiffer?this.layoutDiffer.diff(this.layout)&&(Me=!0):this.layoutDiffer=this.layout?this.keyValueDiffers.find(this.layout).create():void 0),this.updateOnDataChange&&(this.dataDiffer?this.dataDiffer.diff(this.data)&&(Me=!0):this.dataDiffer=Array.isArray(this.data)?this.iterableDiffers.find(this.data).create(this.dataDifferTrackBy):void 0),Me&&this.plotlyInstance&&this.updatePlot()}getWindow(){return window}getClassName(){let Me=[this.defaultClassName];return Array.isArray(this.className)?Me=Me.concat(this.className):this.className&&Me.push(this.className),Me.join(" ")}createPlot(){return this.plotly.newPlot(this.plotEl.nativeElement,this.data,this.layout,this.config,this.frames).then(Me=>{this.plotlyInstance=Me,this.getWindow().gd=this.debug?Me:void 0,this.eventNames.forEach(Se=>{const Ie=`plotly_${Se.toLowerCase()}`;Me.on(Ie,Fe=>this[Se].emit(Fe))}),Me.on("plotly_click",Se=>{this.click.emit(Se),this.plotlyClick.emit(Se)}),this.updateWindowResizeHandler()},Me=>{console.error("Error while plotting:",Me),this.error.emit(Me)})}createFigure(){const Me=this.plotlyInstance;return{data:Me.data,layout:Me.layout,frames:Me._transitionData?Me._transitionData._frames:null}}updatePlot(){if(!this.plotlyInstance){const Se=new Error("Plotly component wasn't initialized");throw this.error.emit(Se),Se}const Me=Object.assign({},this.layout);return this.plotly.update(this.plotlyInstance,this.data,Me,this.config,this.frames).then(()=>{const Se=this.createFigure();this.update.emit(Se)},Se=>{console.error("Error while updating plot:",Se),this.error.emit(Se)})}updateWindowResizeHandler(){this.useResizeHandler?void 0===this.resizeHandler&&(this.resizeHandler=()=>this.plotly.resize(this.plotlyInstance),this.getWindow().addEventListener("resize",this.resizeHandler)):"function"==typeof this.resizeHandler&&(this.getWindow().removeEventListener("resize",this.resizeHandler),this.resizeHandler=void 0)}dataDifferTrackBy(Me,Se){const Ie=Object.assign({},Se,{uid:""});return JSON.stringify(Ie)}}return De.\u0275fac=function(Me){return new(Me||De)(m.Y36(t),m.Y36(m.ZZ4),m.Y36(m.aQg))},De.\u0275cmp=m.Xpm({type:De,selectors:[["plotly-plot"]],viewQuery:function(Me,Se){if(1&Me&&m.Gf(e,7),2&Me){let Ie;m.iGM(Ie=m.CRH())&&(Se.plotEl=Ie.first)}},inputs:{revision:"revision",debug:"debug",useResizeHandler:"useResizeHandler",updateOnLayoutChange:"updateOnLayoutChange",updateOnDataChange:"updateOnDataChange",updateOnlyWithRevision:"updateOnlyWithRevision",data:"data",layout:"layout",config:"config",frames:"frames",style:"style",divId:"divId",className:"className"},outputs:{initialized:"initialized",update:"update",purge:"purge",error:"error",afterExport:"afterExport",afterPlot:"afterPlot",animated:"animated",animatingFrame:"animatingFrame",animationInterrupted:"animationInterrupted",autoSize:"autoSize",beforeExport:"beforeExport",buttonClicked:"buttonClicked",click:"click",plotlyClick:"plotlyClick",clickAnnotation:"clickAnnotation",deselect:"deselect",doubleClick:"doubleClick",framework:"framework",hover:"hover",legendClick:"legendClick",legendDoubleClick:"legendDoubleClick",react:"react",relayout:"relayout",restyle:"restyle",redraw:"redraw",selected:"selected",selecting:"selecting",sliderChange:"sliderChange",sliderEnd:"sliderEnd",sliderStart:"sliderStart",transitioning:"transitioning",transitionInterrupted:"transitionInterrupted",unhover:"unhover",relayouting:"relayouting",treemapclick:"treemapclick",sunburstclick:"sunburstclick"},features:[m._Bn([t]),m.TTD],ngContentSelectors:n,decls:3,vars:3,consts:[[3,"ngClass","ngStyle"],["plot",""]],template:function(Me,Se){1&Me&&(m.F$t(),m.TgZ(0,"div",0,1),m.Hsn(2),m.qZA()),2&Me&&(m.Q6J("ngClass",Se.getClassName())("ngStyle",Se.style),m.uIk("id",Se.divId))},dependencies:[g.mk,g.PC],encapsulation:2}),De})(),r=(()=>{class De{constructor(){}}return De.\u0275fac=function(Me){return new(Me||De)},De.\u0275mod=m.oAB({type:De}),De.\u0275inj=m.cJS({providers:[t],imports:[g.ez]}),De})(),d=(()=>{class De{constructor(){if(!this.isValid())throw new Error("Invalid PlotlyJS object. Please check https://github.com/plotly/angular-plotly.js#quick-start to see how to add PlotlyJS to your project.");t.setPlotly(De.plotlyjs)}isValid(){return void 0!==De.plotlyjs&&("function"==typeof De.plotlyjs.plot||"function"==typeof De.plotlyjs.newPlot)}}return De.\u0275fac=function(Me){return new(Me||De)},De.\u0275mod=m.oAB({type:De}),De.\u0275inj=m.cJS({providers:[t],imports:[g.ez,r,r]}),De.plotlyjs={},De})();var u=ee(9102),f=ee(4781),c=ee(6651),h=ee(4795),p=ee(117),o=ee(643),b=ee(1391),l=ee(1886);function T(De,ze){if(1&De){const Me=m.EpF();m.TgZ(0,"ion-row",15)(1,"ion-col")(2,"app-global-map",16),m.NdJ("showFullScreenMap",function(){m.CHM(Me);const Ie=m.oxw();return m.KtG(Ie.showFullScreenMap())}),m.qZA()()()}if(2&De){const Me=m.oxw();m.xp6(2),m.Q6J("P1",Me.P1)("P2",Me.P2)("insideComponent",!0)}}function _(De,ze){if(1&De&&(m.TgZ(0,"ion-select-option",29),m._uU(1),m.qZA()),2&De){const Me=ze.$implicit;m.s9C("value",Me),m.xp6(1),m.hij(" ",Me," ")}}function w(De,ze){if(1&De&&(m.TgZ(0,"ion-grid",17)(1,"ion-row")(2,"h3"),m._uU(3," Punto inicial "),m.qZA()(),m.TgZ(4,"ion-row",4)(5,"ion-col")(6,"ion-item"),m._UZ(7,"ion-input",18),m.qZA()(),m.TgZ(8,"ion-col")(9,"ion-item"),m._UZ(10,"ion-input",19),m.qZA()()(),m.TgZ(11,"ion-row")(12,"h3"),m._uU(13," Punto final "),m.qZA()(),m.TgZ(14,"ion-row",4)(15,"ion-col")(16,"ion-item"),m._UZ(17,"ion-input",20),m.qZA()(),m.TgZ(18,"ion-col")(19,"ion-item"),m._UZ(20,"ion-input",21),m.qZA()()(),m.TgZ(21,"ion-row")(22,"h3"),m._uU(23," Frecuencia "),m.qZA()(),m.TgZ(24,"ion-row",4)(25,"ion-col")(26,"ion-item"),m._UZ(27,"ion-input",22),m.qZA()(),m.TgZ(28,"ion-col",23)(29,"ion-select",24),m.YNc(30,_,2,2,"ion-select-option",25),m.qZA()()(),m.TgZ(31,"ion-row")(32,"h3"),m._uU(33," Altura de antenas "),m.qZA()(),m.TgZ(34,"ion-row",4)(35,"ion-col")(36,"h6"),m._uU(37," Altura Antena Initial "),m.qZA(),m.TgZ(38,"ion-item"),m._UZ(39,"ion-input",26),m.TgZ(40,"h4",27),m._uU(41," mts "),m.qZA()()(),m.TgZ(42,"ion-col")(43,"h6"),m._uU(44," Altura Antena Final "),m.qZA(),m.TgZ(45,"ion-item"),m._UZ(46,"ion-input",28),m.TgZ(47,"h4",27),m._uU(48," mts "),m.qZA()()()()()),2&De){const Me=m.oxw();m.Q6J("formGroup",Me.settingsForm),m.xp6(30),m.Q6J("ngForOf",Me.frecuenciesUnits)}}let k=(()=>{class De{constructor(Me,Se,Ie,Fe,Re,Xe){this.settingsService=Me,this.router=Se,this.formBuilder=Ie,this.homeService=Fe,this.screenOrientation=Re,this.alertService=Xe,this.anthenaOneHeight=5,this.anthenaTwoHeight=3,this.antennaSettingsObservable=this.settingsService.setLinkSettings$.subscribe(nt=>{this.anthenaOneHeight=nt.anthenaOneHigh,this.anthenaTwoHeight=nt.anthenaTwoHigh}),this.updateGeoPointsObservable=this.settingsService.updateGeoPoints$.subscribe(()=>{console.log("set geopoints"),this.settingsForm.get("initialLat").setValue(this.settingsService.linkSettings.P1.lat),this.settingsForm.get("initialLng").setValue(this.settingsService.linkSettings.P1.lng),this.settingsForm.get("finalLat").setValue(this.settingsService.linkSettings.P2.lat),this.settingsForm.get("finalLng").setValue(this.settingsService.linkSettings.P2.lng)}),this.showForm=!1,this.frecuencyUnit=c.c.GHZ,this.frecuenciesUnits=[c.c.HZ,c.c.MHZ,c.c.GHZ],this.showMap=!0}ionViewDidEnter(){this.alertService.showLoading("Obteniendo datos de enlace"),this.getUserLinks(),this.showMap=!0}saveLinkSettings(){if(this.settingsForm.valid){this.alertService.showLoading("Guardando datos del enlace...");const Me={...this.settingsService.linkSettings.antennaSelected};Me.frecuency=this.settingsForm.get("frecuency").value;const Se={P1:{lat:this.settingsForm.get("initialLat").value,lng:this.settingsForm.get("initialLng").value},P2:{lat:this.settingsForm.get("finalLat").value,lng:this.settingsForm.get("finalLng").value},antennaOneHeight:this.settingsForm.get("antennaInitialHeight").value,antennaTwoHeight:this.settingsForm.get("antennaFinalHeight").value,antennaSelected:Me,atmosphericPressure:this.settingsService.linkSettings.atmosphericPressure,temperature:this.settingsService.linkSettings.temperature,waterDensity:this.settingsService.linkSettings.waterDensity,linkName:this.settingsService.linkSettings.linkName};this.settingsService.SetUserLinkSettingsData("DSVlv21Tk8ZcPjwwvmrlzzMk2472",[Se]).subscribe(Ie=>{this.alertService.closeLoading()},Ie=>{this.alertService.closeLoading(),this.alertService.presentAlert("Hubo un problema guadrando la configuracion","Por favor, intenta mas tarde")})}else this.settingsForm.markAllAsTouched(),this.alertService.presentAlert("Salvar configuraci\xf3n","Por favor completa los datos para poder guardar los datos del enlace")}getUserLinks(){this.settingsService.getUserLinks("DSVlv21Tk8ZcPjwwvmrlzzMk2472").then(Me=>{console.log("repsonse ",Me);const Se=Me.linkSettings;this.alertService.closeLoading(),this.settingsService.linkSettings=Se[0],this.P1={...Se[0].P1},this.P2={...Se[0].P2},this.setSettingsForm(),this.showForm=!0}).catch(Me=>{this.alertService.closeLoading(),this.setSettingsForm(),this.showForm=!0})}changeSelectedLink(){}showFullScreenMap(){this.showMap=!1,setTimeout(()=>{this.screenOrientation.lock(this.screenOrientation.ORIENTATIONS.LANDSCAPE),this.router.navigate(["/home/map"])},100)}getDestinationLatLong(Me,Se,Ie,Fe){const Xe=Fe/1e3,nt=Me*Math.PI/180,ct=Se*Math.PI/180,xt=Ie*Math.PI/180,dt=Math.asin(Math.sin(nt)*Math.cos(Xe/6371)+Math.cos(nt)*Math.sin(Xe/6371)*Math.cos(xt)),tt=ct+Math.atan2(Math.sin(xt)*Math.sin(Xe/6371)*Math.cos(nt),Math.cos(Xe/6371)-Math.sin(nt)*Math.sin(dt));return[180*dt/Math.PI,180*tt/Math.PI]}getBearingOriginal(Me,Se,Ie,Fe){let Re=Me*Math.PI/180,Xe=Ie*Math.PI/180,nt=Se*Math.PI/180,ct=Fe*Math.PI/180;const xt=Math.sin(ct-nt)*Math.cos(Xe),dt=Math.cos(Re)*Math.sin(Xe)-Math.sin(Re)*Math.cos(Xe)*Math.cos(ct-nt);return(180*Math.atan2(xt,dt)/Math.PI+360)%360}getBearingRobot(Me,Se,Ie,Fe){const Re=Me*Math.PI/180,Xe=Ie*Math.PI/180,nt=(Fe-Se)*Math.PI/180,ct=Math.sin(nt)*Math.cos(Xe),xt=Math.cos(Re)*Math.sin(Xe)-Math.sin(Re)*Math.cos(Xe)*Math.cos(nt);return(180*Math.atan2(ct,xt)/Math.PI+360)%360}setSettingsForm(){this.settingsForm=this.formBuilder.group({initialLat:this.formBuilder.control(0===this.settingsService.linkSettings.P1.lat?null:this.settingsService.linkSettings.P1.lat,v.kI.required),initialLng:this.formBuilder.control(0===this.settingsService.linkSettings.P1.lng?null:this.settingsService.linkSettings.P1.lng,v.kI.required),finalLat:this.formBuilder.control(0===this.settingsService.linkSettings.P2.lat?null:this.settingsService.linkSettings.P2.lat,v.kI.required),finalLng:this.formBuilder.control(0===this.settingsService.linkSettings.P2.lng?null:this.settingsService.linkSettings.P2.lng,v.kI.required),frecuency:this.formBuilder.control(0===this.settingsService.linkSettings.antennaSelected.frecuency?null:this.settingsService.linkSettings.antennaSelected.frecuency,v.kI.required),frecuencyUnit:this.formBuilder.control(this.frecuencyUnit===c.c.HZ?null:this.frecuencyUnit,v.kI.required),antennaInitialHeight:this.formBuilder.control(0===this.settingsService.linkSettings.antennaOneHeight?null:this.settingsService.linkSettings.antennaOneHeight,v.kI.required),antennaFinalHeight:this.formBuilder.control(0===this.settingsService.linkSettings.antennaTwoHeight?null:this.settingsService.linkSettings.antennaTwoHeight,v.kI.required)})}navToProfileGraph(){this.showMap=!1,setTimeout(()=>{this.router.navigate(["/home/graphics/elevation-profile"])},100)}navToAtenuationGraph(){this.showMap=!1,setTimeout(()=>{this.router.navigate(["/home/graphics/atenuation-graph"])},100)}navToAtenuationVaporGraph(){this.showMap=!1,setTimeout(()=>{this.router.navigate(["/home/graphics/atenuation-water-vapor-graph"])},100)}ngOnDestroy(){this.antennaSettingsObservable.unsubscribe(),this.updateGeoPointsObservable.unsubscribe()}}return De.\u0275fac=function(Me){return new(Me||De)(m.Y36(h.g),m.Y36(f.F0),m.Y36(v.qu),m.Y36(p.Y),m.Y36(o.E),m.Y36(b.c9))},De.\u0275cmp=m.Xpm({type:De,selectors:[["app-graphics"]],decls:40,vars:4,consts:[["slot","primary",1,"ion-text-center"],[3,"click"],[1,"ion-padding",3,"fullscreen"],["class","cellphone-width justify-content-center align-items-center",4,"ngIf"],[1,"ion-padding"],[3,"formGroup",4,"ngIf"],["detail","",3,"click"],["slot","start"],["alt","Silhouette of a person's head","src","../../../../../assets/images/telecom-towers.png"],["alt","Silhouette of a person's head","src","../../../../../assets/images/desert.png"],["alt","Silhouette of a person's head","src","../../../../../assets/images/storm.jpg"],["slot","fixed","vertical","bottom","horizontal","end"],["name","settings-outline"],["side","top"],["name","refresh"],[1,"cellphone-width","justify-content-center","align-items-center"],[1,"map-container",3,"P1","P2","insideComponent","showFullScreenMap"],[3,"formGroup"],["fill","outline","label","Latitud","labelPlacement","floating","placeholder","Ingresa latitud","type","number","formControlName","initialLat"],["fill","outline","label","Longitud","labelPlacement","floating","placeholder","Ingresa longitud","type","number","formControlName","initialLng"],["fill","outline","label","Latitud","labelPlacement","floating","placeholder","Ingresa latitud","type","number","formControlName","finalLat"],["fill","outline","label","Longitud","labelPlacement","floating","placeholder","Ingresa longitud","type","number","formControlName","finalLng"],["fill","outline","label","Frecuencia","labelPlacement","floating","placeholder","Ingresa frecuencia","type","number","formControlName","frecuency"],["size","4"],["aria-label","Frecuencia","formControlName","frecuencyUnit"],[3,"value",4,"ngFor","ngForOf"],["fill","outline","label","Altura antena inicial","labelPlacement","floating","placeholder","Ingresa Altura","type","number","formControlName","antennaInitialHeight"],[1,"ml-10px"],["fill","outline","label","Altura antena final","labelPlacement","floating","placeholder","Ingresa Altura","type","number","formControlName","antennaFinalHeight"],[3,"value"]],template:function(Me,Se){1&Me&&(m.TgZ(0,"ion-header")(1,"ion-toolbar")(2,"ion-buttons",0)(3,"ion-button",1),m.NdJ("click",function(){return Se.changeSelectedLink()}),m._uU(4),m.qZA()(),m.TgZ(5,"ion-title"),m._uU(6,"Gr\xe1ficas"),m.qZA()()(),m.TgZ(7,"ion-content",2),m.YNc(8,T,3,3,"ion-row",3),m.TgZ(9,"ion-card",4)(10,"ion-card-header")(11,"ion-card-title"),m._uU(12,"Estadisticas del enlace:"),m.qZA()(),m.TgZ(13,"ion-card-content"),m.YNc(14,w,49,2,"ion-grid",5),m.qZA()(),m.TgZ(15,"ion-card",4)(16,"ion-card-header")(17,"ion-card-title"),m._uU(18,"Gr\xe1ficas:"),m.qZA()(),m.TgZ(19,"ion-item",6),m.NdJ("click",function(){return Se.navToProfileGraph()}),m.TgZ(20,"ion-avatar",7),m._UZ(21,"img",8),m.qZA(),m.TgZ(22,"ion-label"),m._uU(23," Perfil de elevaci\xf3n "),m.qZA()(),m.TgZ(24,"ion-item",6),m.NdJ("click",function(){return Se.navToAtenuationGraph()}),m.TgZ(25,"ion-avatar",7),m._UZ(26,"img",9),m.qZA(),m.TgZ(27,"ion-label"),m._uU(28," Atenuacion en aire seco "),m.qZA()(),m.TgZ(29,"ion-item",6),m.NdJ("click",function(){return Se.navToAtenuationVaporGraph()}),m.TgZ(30,"ion-avatar",7),m._UZ(31,"img",10),m.qZA(),m.TgZ(32,"ion-label"),m._uU(33," Atenuacion debido a Vapor de Agua "),m.qZA()()()(),m.TgZ(34,"ion-fab",11)(35,"ion-fab-button"),m._UZ(36,"ion-icon",12),m.qZA(),m.TgZ(37,"ion-fab-list",13)(38,"ion-fab-button",1),m.NdJ("click",function(){return Se.saveLinkSettings()}),m._UZ(39,"ion-icon",14),m.qZA()()()),2&Me&&(m.xp6(4),m.hij(" ",Se.settingsService.linkSettings.linkName," "),m.xp6(3),m.Q6J("fullscreen",!0),m.xp6(1),m.Q6J("ngIf",Se.showMap),m.xp6(6),m.Q6J("ngIf",Se.showForm))},dependencies:[Q.BJ,Q.YG,Q.Sm,Q.PM,Q.FN,Q.Zi,Q.Dq,Q.wI,Q.W2,Q.IJ,Q.W4,Q.zq,Q.jY,Q.Gu,Q.gu,Q.pK,Q.Ie,Q.Q$,Q.Nd,Q.t9,Q.n0,Q.sr,Q.wd,Q.as,Q.QI,g.sg,g.O5,v.JJ,v.JL,v.sg,v.u,l.B]}),De})();var L=ee(5861),M=ee(7347);function I(De,ze){if(1&De){const Me=m.EpF();m.TgZ(0,"ion-row",13)(1,"ion-col")(2,"app-global-map",14),m.NdJ("showFullScreenMap",function(){m.CHM(Me);const Ie=m.oxw();return m.KtG(Ie.showFullScreenMap())}),m.qZA()()()}if(2&De){const Me=m.oxw();m.xp6(2),m.Q6J("P1",Me.P1)("P2",Me.P2)("insideComponent",!0)}}function P(De,ze){1&De&&(m.TgZ(0,"div",21),m._uU(1,"Debe ingresar un valor para la presi\xf3n atmosf\xe9rica."),m.qZA())}function S(De,ze){1&De&&(m.TgZ(0,"div",21),m._uU(1,"Debe ingresar un valor de temperatura."),m.qZA())}function E(De,ze){if(1&De&&(m.TgZ(0,"ion-card",15)(1,"ion-card-header")(2,"ion-card-title"),m._uU(3,"Informaci\xf3n atmosf\xe9rica:"),m.qZA()(),m.TgZ(4,"ion-grid")(5,"ion-row",16)(6,"ion-col")(7,"h3")(8,"ion-badge",0),m._uU(9,"Locaci\xf3n:"),m.qZA(),m.TgZ(10,"span"),m._uU(11),m.qZA()()()(),m.TgZ(12,"ion-row",16)(13,"ion-col",17)(14,"h3")(15,"ion-badge",0),m._uU(16,"Presi\xf3n atmosf\xe9rica:"),m.qZA()(),m.TgZ(17,"ion-item"),m._UZ(18,"ion-input",18),m.YNc(19,P,2,0,"div",19),m.qZA(),m.TgZ(20,"span"),m._uU(21," (hPa) "),m.qZA()(),m.TgZ(22,"ion-col",17)(23,"h3")(24,"ion-badge",0),m._uU(25,"Temperatura:"),m.qZA()(),m.TgZ(26,"ion-item"),m._UZ(27,"ion-input",20),m.YNc(28,S,2,0,"div",19),m.qZA(),m.TgZ(29,"span"),m._uU(30," (C\xb0) "),m.qZA()()()()()),2&De){const Me=m.oxw();m.Q6J("formGroup",Me.atmosphericForm),m.xp6(11),m.hij(" ",Me.settingsService.locationName," "),m.xp6(8),m.Q6J("ngIf",Me.atmosphericForm.get("atmosphericPressure").invalid&&Me.atmosphericForm.get("atmosphericPressure").touched),m.xp6(9),m.Q6J("ngIf",Me.atmosphericForm.get("temperature").invalid&&Me.atmosphericForm.get("temperature").touched)}}function z(De,ze){1&De&&(m.TgZ(0,"div",21),m._uU(1,"Debe ingresar un valor de frecuencia."),m.qZA())}function R(De,ze){if(1&De&&(m.TgZ(0,"ion-select-option",28),m._uU(1),m.qZA()),2&De){const Me=ze.$implicit;m.s9C("value",Me),m.xp6(1),m.hij(" ",Me," ")}}function q(De,ze){if(1&De){const Me=m.EpF();m.TgZ(0,"ion-grid",15)(1,"ion-row",2)(2,"ion-col")(3,"ion-item"),m._UZ(4,"ion-input",22),m.YNc(5,z,2,0,"div",19),m.qZA()(),m.TgZ(6,"ion-col",23)(7,"ion-select",24),m.YNc(8,R,2,2,"ion-select-option",25),m.qZA()()(),m.TgZ(9,"ion-row",26)(10,"ion-col")(11,"ion-button",5),m.NdJ("click",function(){m.CHM(Me);const Ie=m.oxw();return m.KtG(Ie.getAtenuation())}),m._uU(12," Obtener atenuaci\xf3n "),m.qZA()(),m.TgZ(13,"ion-col",27)(14,"h2"),m._uU(15),m.qZA()()()()}if(2&De){const Me=m.oxw();m.Q6J("formGroup",Me.atenuationForm),m.xp6(5),m.Q6J("ngIf",Me.atenuationForm.get("frecuency").invalid&&Me.atenuationForm.get("frecuency").touched),m.xp6(3),m.Q6J("ngForOf",Me.frecuenciesUnits),m.xp6(7),m.hij(" ",Me.atenuationByFrecuency," - (dB) ")}}const V=function(){return{position:"relative",width:"100%",height:"100%"}};function W(De,ze){if(1&De&&(m.ynx(0,29),m._UZ(1,"plotly-plot",30),m.BQk()),2&De){const Me=m.oxw();m.xp6(1),m.Akn(m.DdM(5,V)),m.Q6J("data",Me.elevationData.data)("layout",Me.elevationData.layout)("useResizeHandler",!0)}}function K(De,ze){1&De&&(m.TgZ(0,"ion-card",2)(1,"ion-card-subtitle"),m._uU(2,"Generar gr\xe1fica"),m.qZA(),m.TgZ(3,"ion-card-title"),m._uU(4,"Procedimiento:"),m.qZA(),m.TgZ(5,"ion-card-content")(6,"ul")(7,"li")(8,"p",31),m._uU(9," 1.- Selecciona los dos puntos en el mapa donde quieres graficar el perfil de elevaci\xf3n. "),m.qZA()(),m.TgZ(10,"li")(11,"p",31),m._uU(12,' 2.- Seleccionados los puntos, presiona el bot\xf3n "Generar gr\xe1fica" para obtener mostrar el gr\xe1fico de atenuaci\xf3n. '),m.qZA()()(),m.TgZ(13,"strong"),m._uU(14," Nota: Para obtener la atenuaci\xf3n en una frecuencia espec\xedfica es necesario obtener la informaci\xf3n de presi\xf3n atmosf\xe9rica y temperatura. "),m.qZA()()())}let G=(()=>{class De{constructor(Me,Se,Ie,Fe,Re,Xe,nt,ct){this.locationService=Me,this.loadingCtrl=Se,this.homeService=Ie,this.alertService=Fe,this.settingsService=Re,this.formBuilder=Xe,this.screenOrientation=nt,this.router=ct,this.atenuationDataX=[],this.atenuationDataY=[],this.atenuationGraph=!1,this.showMap=!1,this.frecuenciesUnits=[M.cz.HZ,M.cz.MHZ,M.cz.GHZ],this.showForm=!1,this.atenuationByFrecuency=0}ionViewDidEnter(){this.getUserLinks()}getUserLinks(){this.alertService.showLoading("Obteniendo datos del enlace..."),this.settingsService.getUserLinks("DSVlv21Tk8ZcPjwwvmrlzzMk2472").then(Me=>{console.log("repsonse ",Me);const Se=Me.linkSettings;this.alertService.closeLoading(),this.settingsService.linkSettings=Se[0],this.P1={...Se[0].P1},this.P2={...Se[0].P2},this.getLocationData(),this.showMap=!0,this.setForms()}).catch(Me=>{this.getLocationData(),this.showMap=!0,this.setForms()})}setForms(){this.atenuationForm=this.formBuilder.group({frecuency:this.formBuilder.control(0===this.settingsService.linkSettings.antennaSelected.frecuency?null:this.settingsService.linkSettings.antennaSelected.frecuency,v.kI.required),frecuencyUnit:this.formBuilder.control(M.cz.GHZ,v.kI.required)}),this.atmosphericForm=this.formBuilder.group({atmosphericPressure:this.formBuilder.control(0===this.settingsService.linkSettings.atmosphericPressure?null:this.settingsService.linkSettings.atmosphericPressure,v.kI.required),temperature:this.formBuilder.control(0===this.settingsService.linkSettings.temperature?null:this.settingsService.linkSettings.temperature,v.kI.required)}),this.showForm=!0}showFullScreenMap(){this.showMap=!1,setTimeout(()=>{this.screenOrientation.lock(this.screenOrientation.ORIENTATIONS.LANDSCAPE),this.router.navigate(["/home/map"])},100)}saveLinkSettings(){if(this.atmosphericForm.valid){this.alertService.showLoading("Guardando datos del enlace...");const Me={P1:this.settingsService.linkSettings.P1,P2:this.settingsService.linkSettings.P2,antennaOneHeight:this.settingsService.linkSettings.antennaOneHeight,antennaTwoHeight:this.settingsService.linkSettings.antennaTwoHeight,antennaSelected:this.settingsService.linkSettings.antennaSelected,atmosphericPressure:this.atmosphericForm.get("atmosphericPressure").value,temperature:this.atmosphericForm.get("temperature").value,waterDensity:this.settingsService.linkSettings.waterDensity,linkName:this.settingsService.linkSettings.linkName};this.settingsService.SetUserLinkSettingsData("DSVlv21Tk8ZcPjwwvmrlzzMk2472",[Me]).subscribe(Se=>{this.alertService.closeLoading()},Se=>{this.alertService.closeLoading(),this.alertService.presentAlert("Hubo un problema guardando la configuracion","Por favor, intenta mas tarde")})}else this.atmosphericForm.markAllAsTouched(),this.alertService.presentAlert("Salvar configuraci\xf3n","Por favor completa los datos de temperature y presi\xf3n para poder guardar los datos del enlace")}showForms(){console.log("atmosphericForm ",this.atmosphericForm),console.log("atenuationForm ",this.atenuationForm)}calcFrecuency(Me,Se){let Ie=Me;return Se===M.cz.MHZ?Ie/=1e3:Se===M.cz.HZ&&(Ie/=1e9),Ie}getAtenuation(){if(this.atenuationForm.valid&&this.atmosphericForm.valid){let Me=this.calcFrecuency(this.atenuationForm.get("frecuency").value,this.atenuationForm.get("frecuencyUnit").value);this.locationService.getSpecificAtenuation(this.settingsService.atmosphericPressure,this.settingsService.temperature,Me).subscribe(Se=>{this.atenuationByFrecuency=Se.atenuationValue})}else this.atmosphericForm.markAllAsTouched(),this.atenuationForm.markAllAsTouched()}getLocationData(){var Me=this;return(0,L.Z)(function*(){Me.settingsService.linkSettings.P1!==M.Cn?Me.generateAtenuationGraph():(Me.atenuationGraph=!1,Me.alertService.presentAlert("Gr\xe1fica de atenuaci\xf3n","Por favor selecciona al menos un punto en el mapa para mostrar la gr\xe1fica"))})()}generateAtenuationGraph(){var Me=this;return(0,L.Z)(function*(){if(Me.P1={...Me.settingsService.linkSettings.P1},Me.P2={...Me.settingsService.linkSettings.P2},0!==Me.settingsService.linkSettings.P1.lat||0!==Me.settingsService.linkSettings.P2.lat){const Se=yield Me.loadingCtrl.create({message:"Obteniendo datos atmosf\xe9ricos..."});yield Se.present(),Me.locationService.getLocationData(Me.settingsService.linkSettings.P1.lat.toString(),Me.settingsService.linkSettings.P1.lng.toString()).subscribe(Ie=>{console.log("weather response ",JSON.stringify(Ie)),Me.settingsService.locationName=Ie.name,Me.settingsService.temperature=Number((Ie.main.temp-273.15).toString().substring(0,10)),Me.settingsService.atmosphericPressure=Ie.main.pressure,Me.atmosphericForm.get("temperature").setValue(Me.settingsService.temperature),Me.atmosphericForm.get("atmosphericPressure").setValue(Me.settingsService.atmosphericPressure),Se.dismiss(),setTimeout(()=>{Me.createAtenuationGraph()},300)})}})()}createAtenuationGraph(){var Me=this;return(0,L.Z)(function*(){yield(yield Me.loadingCtrl.create({message:"Cargando gr\xe1fico..."})).present(),Me.locationService.getAtenuation(Me.settingsService.atmosphericPressure,Me.settingsService.temperature).subscribe(Ie=>{let Fe=Ie.atenuationsPoints;for(let Re=0;Re<Fe.length;Re++)Me.atenuationDataY.push(Fe[Re].atenuation),Me.atenuationDataX.push(Fe[Re].frecuency);Me.elevationData={data:[{x:Me.atenuationDataX,y:Me.atenuationDataY,mode:"lines+markers",line:{shape:"spline",color:"#7f7f7f",width:1,opacity:.5}}],layout:{title:"Atenuaci\xf3n en Aire Seco",yaxis:{type:"log",title:"Atenuaci\xf3n espec\xedfica (dB/Km)"},xaxis:{type:"log",title:"Frecuencia (Ghz)"}}},Me.atenuationGraph=!0,Me.loadingCtrl.dismiss()})})()}}return De.\u0275fac=function(Me){return new(Me||De)(m.Y36(b.aU),m.Y36(Q.HT),m.Y36(p.Y),m.Y36(b.c9),m.Y36(b.gb),m.Y36(v.qu),m.Y36(o.E),m.Y36(f.F0))},De.\u0275cmp=m.Xpm({type:De,selectors:[["app-atenuation-graph"]],decls:36,vars:5,consts:[["slot","start"],["defaultHref","/home/graphics"],[1,"ion-padding"],["src","../../../../../../../assets/images/desert.png"],["class","cellphone-width justify-content-center align-items-center",4,"ngIf"],[3,"click"],[3,"formGroup",4,"ngIf"],["class","graph-container",4,"ngIf","ngIfElse"],["noAtenuationGraphic",""],["slot","fixed","vertical","bottom","horizontal","end"],["name","settings-outline"],["side","top"],["name","refresh"],[1,"cellphone-width","justify-content-center","align-items-center"],[1,"map-container",3,"P1","P2","insideComponent","showFullScreenMap"],[3,"formGroup"],[1,"ion-padding","pt-0px"],[1,"vertical-center"],["fill","outline","label","Presi\xf3n atmosf\xe9rica","labelPlacement","floating","placeholder","Ingresa valor","type","number","formControlName","atmosphericPressure"],["slot","error",4,"ngIf"],["fill","outline","label","Temperatura","labelPlacement","floating","placeholder","Ingresa temperatura","type","number","formControlName","temperature"],["slot","error"],["fill","outline","label","Frecuencia","labelPlacement","floating","placeholder","Ingresa frecuencia","type","number","formControlName","frecuency"],["size","4"],["aria-label","Frecuencia","formControlName","frecuencyUnit"],[3,"value",4,"ngFor","ngForOf"],[1,"ion-justify-content-center","ion-align-self-center"],[1,"center-container"],[3,"value"],[1,"graph-container"],[3,"data","layout","useResizeHandler"],[1,"fs-20"]],template:function(Me,Se){if(1&Me&&(m.TgZ(0,"ion-header")(1,"ion-toolbar")(2,"ion-buttons",0),m._UZ(3,"ion-back-button",1),m.qZA(),m.TgZ(4,"ion-title"),m._uU(5,"Atenuaci\xf3n en aire seco"),m.qZA()()(),m.TgZ(6,"ion-content",2)(7,"ion-card"),m._UZ(8,"img",3),m.TgZ(9,"ion-card-header")(10,"ion-card-subtitle"),m._uU(11,"Atenuaci\xf3n debido a aire seco"),m.qZA(),m.TgZ(12,"ion-card-title"),m._uU(13,"Enlaces de microondas"),m.qZA()(),m.TgZ(14,"ion-card-content"),m._uU(15," La atenuaci\xf3n debido a aire seco es un fen\xf3meno que ocurre en la propagaci\xf3n de ondas electromagn\xe9ticas, como las ondas de radio y las se\xf1ales de televisi\xf3n, a medida que se propagan a trav\xe9s del aire. "),m.qZA()(),m.YNc(16,I,3,3,"ion-row",4),m.TgZ(17,"ion-button",5),m.NdJ("click",function(){return Se.getLocationData()}),m._uU(18," Obtener datos atmosf\xe9ricos "),m.qZA(),m.YNc(19,E,31,4,"ion-card",6),m.TgZ(20,"ion-card")(21,"ion-card-header")(22,"ion-card-title"),m._uU(23,"Obtener atenuaci\xf3n en una frecuencia"),m.qZA()(),m.TgZ(24,"ion-card-content"),m.YNc(25,q,16,4,"ion-grid",6),m.qZA()(),m.TgZ(26,"ion-card",2),m.YNc(27,W,2,6,"ng-container",7),m.YNc(28,K,15,0,"ng-template",null,8,m.W1O),m.qZA()(),m.TgZ(30,"ion-fab",9)(31,"ion-fab-button"),m._UZ(32,"ion-icon",10),m.qZA(),m.TgZ(33,"ion-fab-list",11)(34,"ion-fab-button",5),m.NdJ("click",function(){return Se.saveLinkSettings()}),m._UZ(35,"ion-icon",12),m.qZA()()()),2&Me){const Ie=m.MAs(29);m.xp6(16),m.Q6J("ngIf",Se.showMap),m.xp6(3),m.Q6J("ngIf",Se.showForm),m.xp6(6),m.Q6J("ngIf",Se.showForm),m.xp6(2),m.Q6J("ngIf",Se.atenuationGraph)("ngIfElse",Ie)}},dependencies:[Q.oU,Q.yp,Q.YG,Q.Sm,Q.PM,Q.FN,Q.Zi,Q.tO,Q.Dq,Q.wI,Q.W2,Q.IJ,Q.W4,Q.zq,Q.jY,Q.Gu,Q.gu,Q.pK,Q.Ie,Q.Nd,Q.t9,Q.n0,Q.sr,Q.wd,Q.as,Q.QI,Q.cs,g.sg,g.O5,v.JJ,v.JL,a,v.sg,v.u,l.B],styles:[".cellphone-width[_ngcontent-%COMP%]{width:100%}.graph-container[_ngcontent-%COMP%]   .plot-container[_ngcontent-%COMP%]{border-radius:5px}.center-container[_ngcontent-%COMP%]{display:flex;align-items:center}.vertical-center[_ngcontent-%COMP%]{display:flex;justify-content:flex-start;align-items:center}.mh-10px[_ngcontent-%COMP%]{margin:0 10px}"]}),De})();function Y(De,ze){1&De&&(m.TgZ(0,"div",22),m._uU(1,"Debe ingresar un valor para la presi\xf3n atmosf\xe9rica."),m.qZA())}function $(De,ze){1&De&&(m.TgZ(0,"div",22),m._uU(1,"Debe ingresar un valor de temperatura."),m.qZA())}function B(De,ze){1&De&&(m.TgZ(0,"div",22),m._uU(1,"Debe ingresar un valor de densidad."),m.qZA())}function N(De,ze){if(1&De&&(m.TgZ(0,"ion-card",15)(1,"ion-card-header")(2,"ion-card-title"),m._uU(3,"Informaci\xf3n atmosf\xe9rica:"),m.qZA()(),m.TgZ(4,"ion-grid")(5,"ion-row",16)(6,"ion-col")(7,"h3")(8,"ion-badge",0),m._uU(9,"Locaci\xf3n:"),m.qZA(),m.TgZ(10,"span"),m._uU(11),m.qZA()()()(),m.TgZ(12,"ion-row",16)(13,"ion-col",17)(14,"h3")(15,"ion-badge",0),m._uU(16,"Presi\xf3n atmosf\xe9rica:"),m.qZA()(),m.TgZ(17,"ion-item"),m._UZ(18,"ion-input",18),m.YNc(19,Y,2,0,"div",19),m.qZA(),m.TgZ(20,"span"),m._uU(21," (hPa) "),m.qZA()(),m.TgZ(22,"ion-col",17)(23,"h3")(24,"ion-badge",0),m._uU(25,"Temperatura:"),m.qZA()(),m.TgZ(26,"ion-item"),m._UZ(27,"ion-input",20),m.YNc(28,$,2,0,"div",19),m.qZA(),m.TgZ(29,"span"),m._uU(30," (C\xb0) "),m.qZA()()(),m.TgZ(31,"ion-row",16)(32,"ion-col",17)(33,"h3")(34,"ion-badge",0),m._uU(35,"Densidad del agua:"),m.qZA()(),m.TgZ(36,"ion-item"),m._UZ(37,"ion-input",21),m.YNc(38,B,2,0,"div",19),m.qZA(),m.TgZ(39,"span"),m._uU(40," (C\xb0) "),m.qZA()()()()()),2&De){const Me=m.oxw();m.Q6J("formGroup",Me.atmosphericForm),m.xp6(11),m.hij(" ",Me.settingsService.locationName," "),m.xp6(8),m.Q6J("ngIf",Me.atmosphericForm.get("atmosphericPressure").invalid&&Me.atmosphericForm.get("atmosphericPressure").touched),m.xp6(9),m.Q6J("ngIf",Me.atmosphericForm.get("temperature").invalid&&Me.atmosphericForm.get("temperature").touched),m.xp6(10),m.Q6J("ngIf",Me.atmosphericForm.get("waterDensity").invalid&&Me.atmosphericForm.get("waterDensity").touched)}}function U(De,ze){1&De&&(m.TgZ(0,"div",22),m._uU(1,"Debe ingresar un valor de frecuencia."),m.qZA())}function te(De,ze){if(1&De&&(m.TgZ(0,"ion-select-option",29),m._uU(1),m.qZA()),2&De){const Me=ze.$implicit;m.s9C("value",Me),m.xp6(1),m.hij(" ",Me," ")}}function j(De,ze){if(1&De){const Me=m.EpF();m.TgZ(0,"ion-grid",15)(1,"ion-row",8)(2,"ion-col")(3,"ion-item"),m._UZ(4,"ion-input",23),m.YNc(5,U,2,0,"div",19),m.qZA()(),m.TgZ(6,"ion-col",24)(7,"ion-select",25),m.YNc(8,te,2,2,"ion-select-option",26),m.qZA()()(),m.TgZ(9,"ion-row",27)(10,"ion-col")(11,"ion-button",6),m.NdJ("click",function(){m.CHM(Me);const Ie=m.oxw();return m.KtG(Ie.getAtenuation())}),m._uU(12," Obtener atenuaci\xf3n "),m.qZA()(),m.TgZ(13,"ion-col",28)(14,"h2"),m._uU(15),m.qZA()()()()}if(2&De){const Me=m.oxw();m.Q6J("formGroup",Me.atenuationForm),m.xp6(5),m.Q6J("ngIf",Me.atenuationForm.get("frecuency").invalid&&Me.atenuationForm.get("frecuency").touched),m.xp6(3),m.Q6J("ngForOf",Me.frecuenciesUnits),m.xp6(7),m.hij(" ",Me.atenuationByFrecuency," - (dB/Km) ")}}const J=function(){return{position:"relative",width:"100%",height:"100%"}};function X(De,ze){if(1&De&&(m.ynx(0,30),m._UZ(1,"plotly-plot",31),m.BQk()),2&De){const Me=m.oxw();m.xp6(1),m.Akn(m.DdM(5,J)),m.Q6J("data",Me.elevationData.data)("layout",Me.elevationData.layout)("useResizeHandler",!0)}}function re(De,ze){1&De&&(m.TgZ(0,"ion-card-subtitle"),m._uU(1,"Generar gr\xe1fica"),m.qZA(),m.TgZ(2,"ion-card-title"),m._uU(3,"Procedimiento:"),m.qZA(),m.TgZ(4,"ion-card-content")(5,"ul")(6,"li")(7,"p",32),m._uU(8," 1.- Selecciona los dos puntos en el mapa donde quieres graficar el perfil de elevaci\xf3n. "),m.qZA()(),m.TgZ(9,"li")(10,"p",32),m._uU(11,' 2.- Seleccionados los puntos, presiona el bot\xf3n "Generar gr\xe1fica" para obtener mostrar el gr\xe1fico de atenuaci\xf3n. '),m.qZA()()(),m.TgZ(12,"strong"),m._uU(13," Nota: Para obtener la atenuaci\xf3n en una frecuencia espec\xedfica es necesario obtener la informaci\xf3n de presi\xf3n atmosf\xe9rica y temperatura. "),m.qZA()())}let ne=(()=>{class De{constructor(Me,Se,Ie,Fe,Re,Xe,nt,ct){this.locationService=Me,this.loadingCtrl=Se,this.formBuilder=Ie,this.settingsService=Fe,this.homeService=Re,this.alertService=Xe,this.screenOrientation=nt,this.router=ct,this.atenuationDataX=[],this.atenuationDataY=[],this.atenuationGraph=!1,this.frecuenciesUnits=[M.cz.HZ,M.cz.MHZ,M.cz.GHZ],this.showForm=!1,this.atenuationByFrecuency=0,this.showMap=!1}ionViewDidEnter(){this.getUserLinks()}setForms(){this.atenuationForm=this.formBuilder.group({frecuency:this.formBuilder.control(0===this.settingsService.linkSettings.antennaSelected.frecuency?null:this.settingsService.linkSettings.antennaSelected.frecuency,v.kI.required),frecuencyUnit:this.formBuilder.control(M.cz.GHZ,v.kI.required)}),this.atmosphericForm=this.formBuilder.group({atmosphericPressure:this.formBuilder.control(0===this.settingsService.linkSettings.atmosphericPressure?null:this.settingsService.linkSettings.atmosphericPressure,v.kI.required),temperature:this.formBuilder.control(0===this.settingsService.linkSettings.temperature?null:this.settingsService.linkSettings.temperature,v.kI.required),waterDensity:this.formBuilder.control(0===this.settingsService.linkSettings.waterDensity?null:this.settingsService.linkSettings.waterDensity,v.kI.required)}),this.showForm=!0}getUserLinks(){this.alertService.showLoading("Obteniendo datos del enlace..."),this.settingsService.getUserLinks("DSVlv21Tk8ZcPjwwvmrlzzMk2472").then(Me=>{console.log("repsonse ",Me);const Se=Me.linkSettings;this.alertService.closeLoading(),this.settingsService.linkSettings=Se[0],this.P1={...Se[0].P1},this.P2={...Se[0].P2},this.getLocationData(),this.showMap=!0,this.setForms()}).catch(Me=>{this.getLocationData(),this.showMap=!0,this.setForms()})}saveLinkSettings(){if(this.atmosphericForm.valid){this.alertService.showLoading("Guardando datos del enlace...");const Me={P1:this.settingsService.linkSettings.P1,P2:this.settingsService.linkSettings.P2,antennaOneHeight:this.settingsService.linkSettings.antennaOneHeight,antennaTwoHeight:this.settingsService.linkSettings.antennaTwoHeight,antennaSelected:this.settingsService.linkSettings.antennaSelected,atmosphericPressure:this.atmosphericForm.get("atmosphericPressure").value,temperature:this.atmosphericForm.get("temperature").value,waterDensity:this.atmosphericForm.get("waterDensity").value,linkName:this.settingsService.linkSettings.linkName};this.settingsService.SetUserLinkSettingsData("DSVlv21Tk8ZcPjwwvmrlzzMk2472",[Me]).subscribe(Se=>{this.alertService.closeLoading()},Se=>{this.alertService.closeLoading(),this.alertService.presentAlert("Hubo un problema guardando la configuracion","Por favor, intenta mas tarde")})}else this.atmosphericForm.markAllAsTouched(),this.alertService.presentAlert("Salvar configuraci\xf3n","Por favor completa los datos de temperature y presi\xf3n para poder guardar los datos del enlace")}showFullScreenMap(){this.showMap=!1,setTimeout(()=>{this.screenOrientation.lock(this.screenOrientation.ORIENTATIONS.LANDSCAPE),this.router.navigate(["/home/map"])},100)}getLocationData(){var Me=this;return(0,L.Z)(function*(){Me.settingsService.linkSettings.P1!==M.Cn?Me.generateAtenuationGraph():(Me.atenuationGraph=!1,Me.alertService.presentAlert("Gr\xe1fica de atenuaci\xf3n","Por favor selecciona al menos un punto en el mapa para mostrar la gr\xe1fica"))})()}generateAtenuationGraph(){var Me=this;return(0,L.Z)(function*(){Me.P1={...Me.settingsService.linkSettings.P1},Me.P2={...Me.settingsService.linkSettings.P2},0===Me.settingsService.linkSettings.P1.lat&&0===Me.settingsService.linkSettings.P2.lat||(yield(yield Me.loadingCtrl.create({message:"Obteniendo datos atmosf\xe9ricos..."})).present(),Me.locationService.getLocationData(Me.settingsService.linkSettings.P1.lat.toString(),Me.settingsService.linkSettings.P1.lng.toString()).subscribe(Ie=>{Me.settingsService.locationName=Ie.name,Me.settingsService.temperature=Ie.main.temp-273.15,Me.settingsService.atmosphericPressure=Ie.main.pressure,Me.settingsService.waterDensity=7.5,Me.atmosphericForm.get("temperature").setValue(Me.settingsService.temperature),Me.atmosphericForm.get("atmosphericPressure").setValue(Me.settingsService.atmosphericPressure),Me.atmosphericForm.get("waterDensity").setValue(7.5),Me.locationService.getWaterVaporAtenuation(Ie.main.pressure,Me.settingsService.temperature,7.5).subscribe(Fe=>{let Re=Fe.atenuationsPoints;for(let Xe=0;Xe<Re.length;Xe++)Me.atenuationDataY.push(Re[Xe].atenuation),Me.atenuationDataX.push(Re[Xe].frecuency);Me.elevationData={data:[{x:Me.atenuationDataX,y:Me.atenuationDataY,mode:"lines+markers",line:{shape:"spline",color:"#7f7f7f",width:1,opacity:.5}}],layout:{title:"Atenuaci\xf3n por Vapor de Agua",yaxis:{type:"log",title:"Atenuaci\xf3n espec\xedfica (dB/Km)"},xaxis:{type:"log",title:"Frecuencia (Ghz)"}}},Me.atenuationGraph=!0,Me.loadingCtrl.dismiss()})}))})()}setAtenuationForm(){this.atenuationForm=this.formBuilder.group({frecuency:this.formBuilder.control(null,v.kI.required),frecuencyUnit:this.formBuilder.control(M.cz.HZ,v.kI.required)}),this.showForm=!0}calcFrecuency(Me,Se){let Ie=Me;return Se===M.cz.MHZ?Ie/=1e3:Se===M.cz.HZ&&(Ie/=1e9),Ie}getAtenuation(){if(this.atenuationForm.valid&&this.atmosphericForm.valid){let Me=this.calcFrecuency(this.atenuationForm.get("frecuency").value,this.atenuationForm.get("frecuencyUnit").value);this.locationService.getSpecificWaterVaporAtenuation(this.settingsService.atmosphericPressure,this.settingsService.temperature,7.5,Me).subscribe(Se=>{this.atenuationByFrecuency=Se.atenuationValue})}else this.atmosphericForm.markAllAsTouched(),this.atenuationForm.markAllAsTouched()}}return De.\u0275fac=function(Me){return new(Me||De)(m.Y36(b.aU),m.Y36(Q.HT),m.Y36(v.qu),m.Y36(b.gb),m.Y36(p.Y),m.Y36(b.c9),m.Y36(o.E),m.Y36(f.F0))},De.\u0275cmp=m.Xpm({type:De,selectors:[["app-atenuation-water-vapor-graph"]],decls:38,vars:8,consts:[["slot","start"],["defaultHref","/home/graphics"],[1,"ion-padding",3,"fullscreen"],["src","../../../../../../../assets/images/storm.jpg"],[1,"cellphone-width","justify-content-center","align-items-center"],[1,"map-container",3,"P1","P2","insideComponent","showFullScreenMap"],[3,"click"],[3,"formGroup",4,"ngIf"],[1,"ion-padding"],["class","graph-container",4,"ngIf","ngIfElse"],["noAtenuationGraphic",""],["slot","fixed","vertical","bottom","horizontal","end"],["name","settings-outline"],["side","top"],["name","refresh"],[3,"formGroup"],[1,"ion-padding","pt-0px"],[1,"vertical-center"],["fill","outline","label","Presi\xf3n atmosf\xe9rica","labelPlacement","floating","placeholder","Ingresa valor","type","number","formControlName","atmosphericPressure"],["slot","error",4,"ngIf"],["fill","outline","label","Temperatura","labelPlacement","floating","placeholder","Ingresa temperatura","type","number","formControlName","temperature"],["fill","outline","label","Densidad del agua","labelPlacement","floating","placeholder","Ingresa valor","type","number","formControlName","waterDensity"],["slot","error"],["fill","outline","label","Frecuencia","labelPlacement","floating","placeholder","Ingresa frecuencia","type","number","formControlName","frecuency"],["size","4"],["aria-label","Frecuencia","formControlName","frecuencyUnit"],[3,"value",4,"ngFor","ngForOf"],[1,"ion-justify-content-center","ion-align-self-center"],[1,"center-container"],[3,"value"],[1,"graph-container"],[3,"data","layout","useResizeHandler"],[1,"fs-20"]],template:function(Me,Se){if(1&Me&&(m.TgZ(0,"ion-header")(1,"ion-toolbar")(2,"ion-buttons",0),m._UZ(3,"ion-back-button",1),m.qZA(),m.TgZ(4,"ion-title"),m._uU(5,"Atenuaci\xf3n por Vapor de Agua"),m.qZA()()(),m.TgZ(6,"ion-content",2)(7,"ion-card"),m._UZ(8,"img",3),m.TgZ(9,"ion-card-header")(10,"ion-card-subtitle"),m._uU(11,"Atenuaci\xf3n debido a vapor de agua"),m.qZA(),m.TgZ(12,"ion-card-title"),m._uU(13,"Enlaces de microondas"),m.qZA()(),m.TgZ(14,"ion-card-content"),m._uU(15," La atenuaci\xf3n debido a vapor de agua es un fen\xf3meno que afecta las se\xf1ales de radiofrecuencia y microondas en la atm\xf3sfera terrestre, en particular cuando \xe9stas se propagan a trav\xe9s de regiones con alta humedad. "),m.qZA()(),m.TgZ(16,"ion-row",4)(17,"ion-col")(18,"app-global-map",5),m.NdJ("showFullScreenMap",function(){return Se.showFullScreenMap()}),m.qZA()()(),m.TgZ(19,"ion-button",6),m.NdJ("click",function(){return Se.getLocationData()}),m._uU(20," Obtener datos atmosf\xe9ricos "),m.qZA(),m.YNc(21,N,41,5,"ion-card",7),m.TgZ(22,"ion-card")(23,"ion-card-header")(24,"ion-card-title"),m._uU(25,"Obtener atenuaci\xf3n en una frecuencia"),m.qZA()(),m.TgZ(26,"ion-card-content"),m.YNc(27,j,16,4,"ion-grid",7),m.qZA()(),m.TgZ(28,"ion-card",8),m.YNc(29,X,2,6,"ng-container",9),m.YNc(30,re,14,0,"ng-template",null,10,m.W1O),m.qZA()(),m.TgZ(32,"ion-fab",11)(33,"ion-fab-button"),m._UZ(34,"ion-icon",12),m.qZA(),m.TgZ(35,"ion-fab-list",13)(36,"ion-fab-button",6),m.NdJ("click",function(){return Se.saveLinkSettings()}),m._UZ(37,"ion-icon",14),m.qZA()()()),2&Me){const Ie=m.MAs(31);m.xp6(6),m.Q6J("fullscreen",!0),m.xp6(12),m.Q6J("P1",Se.P1)("P2",Se.P2)("insideComponent",!0),m.xp6(3),m.Q6J("ngIf",Se.showForm),m.xp6(6),m.Q6J("ngIf",Se.showForm),m.xp6(2),m.Q6J("ngIf",Se.atenuationGraph)("ngIfElse",Ie)}},dependencies:[Q.oU,Q.yp,Q.YG,Q.Sm,Q.PM,Q.FN,Q.Zi,Q.tO,Q.Dq,Q.wI,Q.W2,Q.IJ,Q.W4,Q.zq,Q.jY,Q.Gu,Q.gu,Q.pK,Q.Ie,Q.Nd,Q.t9,Q.n0,Q.sr,Q.wd,Q.as,Q.QI,Q.cs,g.sg,g.O5,v.JJ,v.JL,a,v.sg,v.u,l.B],styles:[".cellphone-width[_ngcontent-%COMP%]{width:100%}.graph-container[_ngcontent-%COMP%]   .plot-container[_ngcontent-%COMP%]{border-radius:5px}.center-container[_ngcontent-%COMP%]{display:flex;align-items:center}.vertical-center[_ngcontent-%COMP%]{display:flex;justify-content:flex-start;align-items:center}.mh-10px[_ngcontent-%COMP%]{margin:0 10px}"]}),De})(),le=(()=>{class De{transform(Me,Se){return Me.toString().substring(0,Se)}}return De.\u0275fac=function(Me){return new(Me||De)},De.\u0275pipe=m.Yjl({name:"truncate",type:De,pure:!0}),De})();function oe(De,ze){if(1&De){const Me=m.EpF();m.TgZ(0,"ion-row",16)(1,"ion-col")(2,"app-global-map",17),m.NdJ("showFullScreenMap",function(){m.CHM(Me);const Ie=m.oxw();return m.KtG(Ie.showFullScreenMap())}),m.qZA()()()}if(2&De){const Me=m.oxw();m.xp6(2),m.Q6J("P1",Me.P1)("P2",Me.P2)("insideComponent",!0)}}function de(De,ze){if(1&De&&(m.TgZ(0,"ion-row",18)(1,"ion-col")(2,"h6"),m._uU(3," Altura Antena Initial "),m.qZA(),m.TgZ(4,"ion-item"),m._UZ(5,"ion-input",19),m.TgZ(6,"h4",20),m._uU(7," mts "),m.qZA()()(),m.TgZ(8,"ion-col")(9,"h6"),m._uU(10," Altura Antena Final "),m.qZA(),m.TgZ(11,"ion-item"),m._UZ(12,"ion-input",21),m.TgZ(13,"h4",20),m._uU(14," mts "),m.qZA()()()()),2&De){const Me=m.oxw();m.Q6J("formGroup",Me.settingsForm)}}const se=function(){return{position:"relative",width:"100%",height:"100%"}};function ge(De,ze){if(1&De&&(m.ynx(0,22),m._UZ(1,"plotly-plot",23),m.BQk()),2&De){const Me=m.oxw();m.xp6(1),m.Akn(m.DdM(5,se)),m.Q6J("data",Me.elevationData.data)("layout",Me.elevationData.layout)("useResizeHandler",!0)}}function _e(De,ze){1&De&&(m.TgZ(0,"ion-card-subtitle"),m._uU(1,"Generar gr\xe1fica"),m.qZA(),m.TgZ(2,"ion-card-title"),m._uU(3,"Procedimiento:"),m.qZA(),m.TgZ(4,"ion-card-content")(5,"ul")(6,"li")(7,"p",24),m._uU(8," 1.- Selecciona los dos puntos en el mapa donde quieres graficar el perfil de elevaci\xf3n. "),m.qZA()(),m.TgZ(9,"li")(10,"p",24),m._uU(11,' 2.- Seleccionados los puntos, presiona el bot\xf3n "Generar gr\xe1fica" para obtener mostrar el gr\xe1fico. '),m.qZA()()()())}function Te(De,ze){if(1&De&&(m.TgZ(0,"ion-row",6)(1,"ion-col")(2,"h3")(3,"ion-badge",0),m._uU(4),m.qZA(),m.TgZ(5,"span"),m._uU(6),m.ALo(7,"truncate"),m.ALo(8,"truncate"),m.ALo(9,"truncate"),m.qZA()()()()),2&De){const Me=ze.$implicit,Se=ze.index;m.xp6(4),m.hij("N\xb0",Se+1,":"),m.xp6(2),m.lnq(" Distancia: ",m.xi3(7,4,Me.distance/1e3,7)," Km (aprox.) ; Lat: ",m.xi3(8,7,Me.lat,10)," - Lng: ",m.xi3(9,10,Me.lng,10)," ")}}function we(De,ze){if(1&De&&(m.TgZ(0,"ion-card")(1,"ion-card-header")(2,"ion-card-title")(3,"ion-badge",25),m._uU(4,"IMPORTANTE"),m.qZA(),m._uU(5," Puntos de obstrucci\xf3n: "),m.qZA(),m.TgZ(6,"ion-card-subtitle"),m._uU(7," Es importante que revises la configuracion del enlace, ya que existen puntos de obstruccion en el 60% de la primera zona de fresnel, por lo que esta afectada la factilidad del radienlace. "),m.qZA()(),m.TgZ(8,"ion-grid"),m.YNc(9,Te,10,13,"ion-row",26),m.qZA()()),2&De){const Me=m.oxw();m.xp6(9),m.Q6J("ngForOf",Me.obstructionFieldPoints)}}const ve=[{path:"",component:k},{path:"elevation-profile",component:(()=>{class De{constructor(Me,Se,Ie,Fe,Re,Xe,nt,ct){this.settingsService=Me,this.locationService=Se,this.alertService=Ie,this.loadingCtrl=Fe,this.homeService=Re,this.formBuilder=Xe,this.router=nt,this.screenOrientation=ct,this.lambda=299792458/(1e6*this.settingsService.linkSettings.antennaSelected.frecuency),this.dataFresnelx=[],this.dataFresnely=[],this.dataFresnelyInverted=[],this.elevationDataX=[],this.elevationDataY=[],this.elevationGraph=!1,this.atenuationDataX=[],this.atenuationDataY=[],this.atenuationGraph=!1,this.responsesData=[],this.requestArray=[],this.firstIteration=!0,this.elevationTotalDataX=[],this.elevationTotalDataY=[],this.obstructionPointsX=[],this.obstructionPointsInvertedX=[],this.obstructionPointsY=[],this.obstructionPointsInvertedY=[],this.obstruction60PercentPointsX=[],this.obstruction60PercentPointsInvertedX=[],this.obstruction60PercentPointsY=[],this.obstruction60PercentPointsInvertedY=[],this.pointsFraction=1e3,this.showForm=!1,this.obstructionSelectedPoints=[],this.obstruction60PercentSelectedPoints=[],this.startUpperObstruction=!1,this.startLowerObstruction=!1,this.clearMap=!1,this.showMap=!1,this.obstructionFieldPoints=[]}ionViewWillEnter(){this.getUserLinks()}showFullScreenMap(){this.showMap=!1,setTimeout(()=>{this.screenOrientation.lock(this.screenOrientation.ORIENTATIONS.LANDSCAPE),this.router.navigate(["/home/map"])},100)}setSettingsForm(){this.settingsForm=this.formBuilder.group({antennaInitialHeight:this.formBuilder.control(0===this.settingsService.linkSettings.antennaOneHeight?null:this.settingsService.linkSettings.antennaOneHeight,v.kI.required),antennaFinalHeight:this.formBuilder.control(0===this.settingsService.linkSettings.antennaTwoHeight?null:this.settingsService.linkSettings.antennaTwoHeight,v.kI.required)})}getUserLinks(){this.alertService.showLoading("Obteniendo datos del enlace..."),this.settingsService.getUserLinks("DSVlv21Tk8ZcPjwwvmrlzzMk2472").then(Me=>{console.log("repsonse ",Me);const Se=Me.linkSettings;this.alertService.closeLoading(),this.settingsService.linkSettings=Se[0],this.P1={...Se[0].P1},this.P2={...Se[0].P2},this.setSettingsForm(),this.showForm=!0,this.P1={...this.settingsService.linkSettings.P1},this.P2={...this.settingsService.linkSettings.P2},this.showMap=!0,this.settingsService.showTabs=!0,this.screenOrientation.lock(this.screenOrientation.ORIENTATIONS.PORTRAIT)}).catch(Me=>{this.alertService.closeLoading(),this.setSettingsForm(),this.showForm=!0})}saveLinkSettings(){if(this.settingsForm.valid){this.alertService.showLoading("Guardando datos del enlace...");const Me={P1:this.settingsService.linkSettings.P1,P2:this.settingsService.linkSettings.P2,antennaOneHeight:this.settingsForm.get("antennaInitialHeight").value,antennaTwoHeight:this.settingsForm.get("antennaFinalHeight").value,antennaSelected:this.settingsService.linkSettings.antennaSelected,atmosphericPressure:this.settingsService.linkSettings.atmosphericPressure,temperature:this.settingsService.linkSettings.temperature,waterDensity:this.settingsService.linkSettings.waterDensity,linkName:this.settingsService.linkSettings.linkName};this.settingsService.SetUserLinkSettingsData("DSVlv21Tk8ZcPjwwvmrlzzMk2472",[Me]).subscribe(Se=>{this.alertService.closeLoading()},Se=>{this.alertService.closeLoading(),this.alertService.presentAlert("Hubo un problema guadrando la configuracion","Por favor, intenta mas tarde")})}else this.settingsForm.markAllAsTouched(),this.alertService.presentAlert("Salvar configuraci\xf3n","Por favor completa los datos para poder guardar los datos del enlace")}generateElevationGraph(){this.settingsService.linkSettings.P1!==M.Cn&&this.settingsService.linkSettings.P2!==M.Cn?this.getElevationProfile():(this.elevationGraph=!1,this.alertService.presentAlert("Puntos geogr\xe1ficos","Por favor selecciona dos puntos en el mapa para mostrar la gr\xe1fica"))}getBearingRobot(Me,Se,Ie,Fe){const Re=Me*Math.PI/180,Xe=Ie*Math.PI/180,nt=(Fe-Se)*Math.PI/180,ct=Math.sin(nt)*Math.cos(Xe),xt=Math.cos(Re)*Math.sin(Xe)-Math.sin(Re)*Math.cos(Xe)*Math.cos(nt);return(180*Math.atan2(ct,xt)/Math.PI+360)%360}getDestinationLatLong(Me,Se,Ie,Fe){const Xe=Fe/1e3,nt=Me*Math.PI/180,ct=Se*Math.PI/180,xt=Ie*Math.PI/180,dt=Math.asin(Math.sin(nt)*Math.cos(Xe/6371)+Math.cos(nt)*Math.sin(Xe/6371)*Math.cos(xt)),tt=ct+Math.atan2(Math.sin(xt)*Math.sin(Xe/6371)*Math.cos(nt),Math.cos(Xe/6371)-Math.sin(nt)*Math.sin(dt));return[180*dt/Math.PI,180*tt/Math.PI]}setObstructionPoints(){this.obstructionFieldPoints=[];let Me=this.getBearingRobot(this.settingsService.linkSettings.P1.lat,this.settingsService.linkSettings.P1.lng,this.settingsService.linkSettings.P2.lat,this.settingsService.linkSettings.P2.lng);this.obstructionSelectedPoints.forEach(Se=>{let Ie=this.getDestinationLatLong(this.settingsService.linkSettings.P1.lat,this.settingsService.linkSettings.P1.lng,Me,Se.distance);this.obstructionFieldPoints.push({distance:Se.distance,elevation:Se.elevation,lat:Ie[0],lng:Ie[1]})})}showMapp(){console.log("home service show map ",this.homeService.showMap),console.log("this.obstructionSelectedPoints ",this.obstructionSelectedPoints)}deleteMap(){this.clearMap=!0}showObstructions(){console.log("this.obstructionSelectedPoints ",this.obstructionSelectedPoints)}resetElevationData(){this.elevationDataX=[],this.elevationDataY=[],this.elevationData.data=[]}getElevationProfile(){var Me=this;return(0,L.Z)(function*(){yield(yield Me.loadingCtrl.create({message:"Cargando perfil de elevaci\xf3n..."})).present(),Me.locationService.getElevationProfile(Me.settingsService.linkSettings.P1,Me.settingsService.linkSettings.P2).subscribe(Ie=>{Me.elevationDataX=[],Me.elevationDataY=[],Me.obstructionSelectedPoints=[],Me.obstruction60PercentSelectedPoints=[];let Fe=1e3*Ie.linkDistance/Me.pointsFraction,Re=0;console.log("distanceFraction: ",Fe);let Xe=Ie.elevations;Me.settingsService.linkDistance=Ie.linkDistance;for(let xt=0;xt<Xe.length;xt++)Me.elevationDataX.push(Re),Me.elevationDataY.push(Xe[xt]),Re+=Fe;console.log("this.elevationDataX ",Me.elevationDataX),console.log("this.elevationDataY ",Me.elevationDataY),Me.elevationDataY=Me.interpolateArray(Me.elevationDataY),Me.elevationData={data:[{name:"Puntos de Elevacion",x:Me.elevationDataX,y:Me.elevationDataY,mode:"lines+markers",fill:"tozeroy",opacity:.5,line:{shape:"spline",color:"#afafaf",width:1},marker:{size:2}}],layout:{title:"Gr\xe1fico de elevaci\xf3n",yaxis:{showline:!1,showgrid:!1,title:"Distancia (m)"},xaxis:{showline:!1,showgrid:!1,title:"Distancia (m)"}}};let nt=Me.settingsService.linkSettings.antennaOneHeight,ct=Me.settingsService.linkSettings.antennaTwoHeight;nt+=Me.elevationDataY[0],ct+=Me.elevationDataY[Me.elevationDataY.length-1],Me.createElipseCurve(Me.elevationDataX[0],nt,Me.elevationDataX[Me.elevationData.data[0].x.length-1],ct,Me.pointsFraction),Me.setObstructionPoints(),Me.elevationGraph=!0,Me.loadingCtrl.dismiss()},Ie=>{Me.loadingCtrl.dismiss(),Me.alertService.presentAlert("Error",JSON.stringify(Ie))})})()}getFresnelPoint(Me,Se,Ie,Fe,Re,Xe,nt,ct,xt,dt,tt){let Ke,mt,Bt,Ut;return 0===Me||Number.isNaN(Me)?Xe===nt?(Ke=ct,mt=ct,Bt=dt,Ut=dt):(Ke=xt,mt=xt,Bt=tt,Ut=tt):(Ke=this.getXTranferredPoint(Se,Me,Fe),mt=this.getXTranferredPoint(Se,Me,Re),Bt=this.getYTranferredPoint(Ie,Me,Fe),Ut=this.getYTranferredPoint(Ie,Me,Re)),{fresnelPositiveXPoint:Ke,fresnelNegativeXPoint:mt,fresnelPositiveYPoint:Bt,fresnelNegativeYPoint:Ut}}createElipseCurve(Me,Se,Ie,Fe,Re=this.pointsFraction){console.log("lambda ",this.lambda),console.log("fraction ",Re);let tt,Xe=Math.abs(Ie-Me),nt=Math.abs(Fe-Se),ct=Math.sqrt(Math.pow(Xe,2)+Math.pow(nt,2)),xt=Math.abs(Ie-Me)/Re,dt=(Fe-Se)/(Ie-Me);console.log("pendiente de la recta ",dt),tt=0===dt?0:Math.atan(dt);let Ke=tt*Math.PI/180,mt=Ke+Math.PI/2,Bt=Ke-Math.PI/2;mt<0&&(mt+=2*Math.PI),Bt<0&&(Bt+=2*Math.PI);let Ut=Me,er=Se;this.obstructionPointsX=[],this.obstructionPointsY=[],this.obstructionPointsInvertedX=[],this.obstructionPointsInvertedY=[];const He=this.createFresnelPoints(1,Re,[],[],Ut,er,0,ct-0,Bt,mt,Ie,Fe,Me,Se,[],[],[],[],dt,xt,ct/Re);this.elevationData.data.push({x:He.fresnelDataX,y:He.fresnelDataY,type:"scatter",line:{color:"#17BECF"},name:"zona de fresnel inferior"},{x:He.fresnelInvertedDataX,y:He.fresnelInvertedDataY,type:"scatter",line:{color:"#17BECF"},name:"zona de fresnel superior"},{x:He.fresnelData60PercentX,y:He.fresnelData60PercentY,type:"scatter",line:{color:"#9a37c4"},name:"zona de fresnel 60% inferior"},{x:He.fresnelInvertedData60PercentX,y:He.fresnelInvertedData60PercentY,type:"scatter",line:{color:"#9a37c4"},name:"zona de fresnel 60% superior"}),this.elevationData.data.push({x:this.obstructionPointsX,y:this.obstructionPointsY,mode:"markers",type:"scatter",opacity:.8,line:{color:"#d91313"},name:"puntos de obstruccion inferior"},{x:this.obstructionPointsInvertedX,y:this.obstructionPointsInvertedY,mode:"markers",type:"scatter",opacity:.8,line:{color:"#d91313"},name:"puntos de obstruccion superior"}),this.elevationGraph=!0}createFresnelPoints(Me=1,Se,Ie,Fe,Re,Xe,nt,ct,xt,dt,tt,Ke,mt,Bt,Ut,er,Wt,rr,Ht,Ve,We){let he=[],ye=[],Be=[],Ge=[];for(let He=0;He<=Se;He++){Ie.push(Re),Fe.push(Xe);let st=Me*this.fresnelRadio(this.lambda,nt,ct),ot=.6*this.fresnelRadio(this.lambda,nt,ct);st<1e-5&&(st=0);const wt=this.getFresnelPoint(st,Re,Xe,xt,dt,He,Se,tt,mt,Ke,Bt),Ct=this.getFresnelPoint(ot,Re,Xe,xt,dt,He,Se,tt,mt,Ke,Bt);he.push(Ct.fresnelPositiveXPoint),ye.push(Ct.fresnelNegativeXPoint),Be.push(Ct.fresnelPositiveYPoint),Ge.push(Ct.fresnelNegativeYPoint),Ut.push(wt.fresnelPositiveXPoint),Wt.push(wt.fresnelNegativeXPoint),er.push(wt.fresnelPositiveYPoint),rr.push(wt.fresnelNegativeYPoint),Xe=this.getFinalPointY(Ht,Re+Ve,Re,Xe),Re+=Ve,nt+=We,ct=Math.abs(ct-We)}return this.elevationDataY.forEach((He,st)=>{let ot=he.findIndex(Ct=>Ct>this.elevationDataX[st]-We&&Ct<this.elevationDataX[st]+We);He>=Be[ot]?(this.startLowerObstruction||(this.startLowerObstruction=!0,-1===this.obstructionSelectedPoints.findIndex(rt=>rt.distance===he[ot])&&this.obstructionSelectedPoints.push({distance:he[ot],elevation:Be[ot]})),this.obstructionPointsX.push(he[ot]),this.obstructionPointsY.push(Be[ot])):this.startLowerObstruction=!1;let wt=ye.findIndex(Ct=>Ct>this.elevationDataX[st]-We&&Ct<this.elevationDataX[st]+We);He>=Ge[wt]?(this.startUpperObstruction||(this.startUpperObstruction=!0,-1===this.obstructionSelectedPoints.findIndex(rt=>rt.distance===ye[ot])&&this.obstructionSelectedPoints.push({distance:ye[ot],elevation:Ge[ot]})),this.obstructionPointsInvertedX.push(ye[wt]),this.obstructionPointsInvertedY.push(Ge[wt])):this.startUpperObstruction=!1}),{fresnelDataX:Ut,fresnelDataY:er,fresnelInvertedDataX:Wt,fresnelInvertedDataY:rr,rectDataX:Ie,rectDataY:Fe,fresnelData60PercentX:he,fresnelData60PercentY:Be,fresnelInvertedData60PercentX:ye,fresnelInvertedData60PercentY:Ge}}showObs(){console.log("obstruction60PercentPointsX ",this.obstruction60PercentPointsX),console.log("obstruction60PercentPointsY ",this.obstruction60PercentPointsY),console.log("obstructionPointsInvertedX ",this.obstructionPointsInvertedX),console.log("obstructionPointsInvertedY ",this.obstructionPointsInvertedY)}getFinalPointY(Me,Se,Ie,Fe){return Me*(Se-Ie)+Fe}getXTranferredPoint(Me,Se,Ie){return Me+Se*Math.cos(Ie)}getYTranferredPoint(Me,Se,Ie){return Me+Se*Math.sin(Ie)}interpolateArray(Me){const Se=[];let Ie=Me[0],Fe=0;for(let Re=1;Re<Me.length;Re++)if(Me[Re]===Ie)Fe++;else{const Xe=(Me[Re]-Ie)/(Fe+1);for(let nt=1;nt<=Fe+1;nt++)Se.push(Ie+nt*Xe);Ie=Me[Re],Fe=0}return Se.push(Ie),Se}fresnelRadio(Me,Se,Ie){return 17.32*Math.sqrt(Se*Ie/(20*(Se+Ie)))}ngOnDestroy(){}}return De.\u0275fac=function(Me){return new(Me||De)(m.Y36(b.gb),m.Y36(b.aU),m.Y36(b.c9),m.Y36(Q.HT),m.Y36(p.Y),m.Y36(v.qu),m.Y36(f.F0),m.Y36(o.E))},De.\u0275cmp=m.Xpm({type:De,selectors:[["app-elevation-profile"]],decls:54,vars:9,consts:[["slot","start"],["defaultHref","/home/graphics"],[1,"ion-padding"],["src","../../../../../../../assets/images/telecom-towers.png"],[3,"click"],["class","cellphone-width justify-content-center align-items-center",4,"ngIf"],[1,"ion-padding","pt-0px"],[1,"ph-10px"],["class","ph-10px",3,"formGroup",4,"ngIf"],["class","graph-container",4,"ngIf","ngIfElse"],["noElevationGraphic",""],[4,"ngIf"],["slot","fixed","vertical","bottom","horizontal","end"],["name","settings-outline"],["side","top"],["name","refresh"],[1,"cellphone-width","justify-content-center","align-items-center"],[1,"map-container",3,"P1","P2","insideComponent","showFullScreenMap"],[1,"ph-10px",3,"formGroup"],["fill","outline","label","Altura antena inicial","labelPlacement","floating","placeholder","Ingresa Altura","type","number","formControlName","antennaInitialHeight"],[1,"ml-10px"],["fill","outline","label","Altura antena final","labelPlacement","floating","placeholder","Ingresa Altura","type","number","formControlName","antennaFinalHeight"],[1,"graph-container"],[3,"data","layout","useResizeHandler"],[1,"fs-20"],["color","warning"],["class","ion-padding pt-0px",4,"ngFor","ngForOf"]],template:function(Me,Se){if(1&Me&&(m.TgZ(0,"ion-header")(1,"ion-toolbar")(2,"ion-buttons",0),m._UZ(3,"ion-back-button",1),m.qZA(),m.TgZ(4,"ion-title"),m._uU(5,"Perfil de Elevaci\xf3n"),m.qZA()()(),m.TgZ(6,"ion-content",2)(7,"ion-card"),m._UZ(8,"img",3),m.TgZ(9,"ion-card-header")(10,"ion-card-subtitle"),m._uU(11,"Perfil de elevaci\xf3n"),m.qZA(),m.TgZ(12,"ion-card-title"),m._uU(13,"Enlaces de microondas"),m.qZA()(),m.TgZ(14,"ion-card-content"),m._uU(15," Un perfil de elevaciones es una herramienta utilizada para diferenciar alturas, porcentajes de pendientes, medir segmentos de una ruta, una monta\xf1a, la cuenca de un r\xedo, etc. "),m.qZA()(),m.TgZ(16,"button",4),m.NdJ("click",function(){return Se.showObs()}),m._uU(17," show obstructions "),m.qZA(),m.YNc(18,oe,3,3,"ion-row",5),m.TgZ(19,"ion-card")(20,"ion-card-header")(21,"ion-card-title"),m._uU(22,"Puntos seleccionados:"),m.qZA()(),m.TgZ(23,"ion-grid")(24,"ion-row",6)(25,"ion-col")(26,"h3")(27,"ion-badge",0),m._uU(28,"Punto N\xb01:"),m.qZA(),m.TgZ(29,"span"),m._uU(30),m.qZA()()(),m.TgZ(31,"ion-col")(32,"h3")(33,"ion-badge",0),m._uU(34,"Punto N\xb02:"),m.qZA(),m.TgZ(35,"span"),m._uU(36),m.qZA()()()(),m.TgZ(37,"ion-row",7)(38,"h3"),m._uU(39," Altura de antenas "),m.qZA()(),m.YNc(40,de,15,1,"ion-row",8),m.qZA()(),m.TgZ(41,"ion-button",4),m.NdJ("click",function(){return Se.generateElevationGraph()}),m._uU(42," Generar Gr\xe1fica "),m.qZA(),m.TgZ(43,"ion-card",2),m.YNc(44,ge,2,6,"ng-container",9),m.YNc(45,_e,12,0,"ng-template",null,10,m.W1O),m.qZA(),m.YNc(47,we,10,1,"ion-card",11),m.qZA(),m.TgZ(48,"ion-fab",12)(49,"ion-fab-button"),m._UZ(50,"ion-icon",13),m.qZA(),m.TgZ(51,"ion-fab-list",14)(52,"ion-fab-button",4),m.NdJ("click",function(){return Se.saveLinkSettings()}),m._UZ(53,"ion-icon",15),m.qZA()()()),2&Me){const Ie=m.MAs(46);m.xp6(18),m.Q6J("ngIf",Se.showMap),m.xp6(12),m.AsE(" Latitud: ",Se.settingsService.linkSettings.P1.lat," - Longitud: ",Se.settingsService.linkSettings.P1.lng," "),m.xp6(6),m.AsE(" Latitud: ",Se.settingsService.linkSettings.P2.lat," - Longitud: ",Se.settingsService.linkSettings.P2.lng," "),m.xp6(4),m.Q6J("ngIf",Se.showForm),m.xp6(4),m.Q6J("ngIf",Se.elevationGraph)("ngIfElse",Ie),m.xp6(3),m.Q6J("ngIf",Se.elevationGraph&&Se.obstructionFieldPoints.length>0)}},dependencies:[Q.oU,Q.yp,Q.YG,Q.Sm,Q.PM,Q.FN,Q.Zi,Q.tO,Q.Dq,Q.wI,Q.W2,Q.IJ,Q.W4,Q.zq,Q.jY,Q.Gu,Q.gu,Q.pK,Q.Ie,Q.Nd,Q.sr,Q.wd,Q.as,Q.cs,g.sg,g.O5,v.JJ,v.JL,a,v.sg,v.u,l.B,le],styles:[".cellphone-width[_ngcontent-%COMP%]{width:100%}.graph-container[_ngcontent-%COMP%]   .plot-container[_ngcontent-%COMP%]{border-radius:5px}"]}),De})()},{path:"atenuation-graph",component:G},{path:"atenuation-water-vapor-graph",component:ne},{path:"",redirectTo:"/home/graphics",pathMatch:"full"}];let Ae=(()=>{class De{}return De.\u0275fac=function(Me){return new(Me||De)},De.\u0275mod=m.oAB({type:De}),De.\u0275inj=m.cJS({imports:[f.Bz.forChild(ve),f.Bz]}),De})();var ke=ee(6155),Pe=ee(4466);d.plotlyjs=u;let Ne=(()=>{class De{}return De.\u0275fac=function(Me){return new(Me||De)},De.\u0275mod=m.oAB({type:De}),De.\u0275inj=m.cJS({imports:[Q.Pc,g.ez,v.u5,d,Ae,v.UX,ke.MapPageModule,Pe.m]}),De})()},9102:Du=>{Du.exports=function y(ee,Q,g){function v(e,n){if(!Q[e]){if(!ee[e]){if(m)return m(e,!0);var a=new Error("Cannot find module '"+e+"'");throw a.code="MODULE_NOT_FOUND",a}var r=Q[e]={exports:{}};ee[e][0].call(r.exports,function(d){return v(ee[e][1][d]||d)},r,r.exports,y,ee,Q,g)}return Q[e].exports}for(var m=void 0,x=0;x<g.length;x++)v(g[x]);return v}({1:[function(y,ee,Q){"use strict";var g=y("../src/lib"),v={"X,X div":'direction:ltr;font-family:"Open Sans",verdana,arial,sans-serif;margin:0;padding:0;',"X input,X button":'font-family:"Open Sans",verdana,arial,sans-serif;',"X input:focus,X button:focus":"outline:none;","X a":"text-decoration:none;","X a:hover":"text-decoration:none;","X .crisp":"shape-rendering:crispEdges;","X .user-select-none":"-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;-o-user-select:none;user-select:none;","X svg":"overflow:hidden;","X svg a":"fill:#447adb;","X svg a:hover":"fill:#3c6dc5;","X .main-svg":"position:absolute;top:0;left:0;pointer-events:none;","X .main-svg .draglayer":"pointer-events:all;","X .cursor-default":"cursor:default;","X .cursor-pointer":"cursor:pointer;","X .cursor-crosshair":"cursor:crosshair;","X .cursor-move":"cursor:move;","X .cursor-col-resize":"cursor:col-resize;","X .cursor-row-resize":"cursor:row-resize;","X .cursor-ns-resize":"cursor:ns-resize;","X .cursor-ew-resize":"cursor:ew-resize;","X .cursor-sw-resize":"cursor:sw-resize;","X .cursor-s-resize":"cursor:s-resize;","X .cursor-se-resize":"cursor:se-resize;","X .cursor-w-resize":"cursor:w-resize;","X .cursor-e-resize":"cursor:e-resize;","X .cursor-nw-resize":"cursor:nw-resize;","X .cursor-n-resize":"cursor:n-resize;","X .cursor-ne-resize":"cursor:ne-resize;","X .cursor-grab":"cursor:-webkit-grab;cursor:grab;","X .modebar":"position:absolute;top:2px;right:2px;","X .ease-bg":"-webkit-transition:background-color .3s ease 0s;-moz-transition:background-color .3s ease 0s;-ms-transition:background-color .3s ease 0s;-o-transition:background-color .3s ease 0s;transition:background-color .3s ease 0s;","X .modebar--hover>:not(.watermark)":"opacity:0;-webkit-transition:opacity .3s ease 0s;-moz-transition:opacity .3s ease 0s;-ms-transition:opacity .3s ease 0s;-o-transition:opacity .3s ease 0s;transition:opacity .3s ease 0s;","X:hover .modebar--hover .modebar-group":"opacity:1;","X .modebar-group":"float:left;display:inline-block;box-sizing:border-box;padding-left:8px;position:relative;vertical-align:middle;white-space:nowrap;","X .modebar-btn":"position:relative;font-size:16px;padding:3px 4px;height:22px;cursor:pointer;line-height:normal;box-sizing:border-box;","X .modebar-btn svg":"position:relative;top:2px;","X .modebar.vertical":"display:flex;flex-direction:column;flex-wrap:wrap;align-content:flex-end;max-height:100%;","X .modebar.vertical svg":"top:-1px;","X .modebar.vertical .modebar-group":"display:block;float:none;padding-left:0px;padding-bottom:8px;","X .modebar.vertical .modebar-group .modebar-btn":"display:block;text-align:center;","X [data-title]:before,X [data-title]:after":"position:absolute;-webkit-transform:translate3d(0, 0, 0);-moz-transform:translate3d(0, 0, 0);-ms-transform:translate3d(0, 0, 0);-o-transform:translate3d(0, 0, 0);transform:translate3d(0, 0, 0);display:none;opacity:0;z-index:1001;pointer-events:none;top:110%;right:50%;","X [data-title]:hover:before,X [data-title]:hover:after":"display:block;opacity:1;","X [data-title]:before":'content:"";position:absolute;background:rgba(0,0,0,0);border:6px solid rgba(0,0,0,0);z-index:1002;margin-top:-12px;border-bottom-color:#69738a;margin-right:-6px;',"X [data-title]:after":"content:attr(data-title);background:#69738a;color:#fff;padding:8px 10px;font-size:12px;line-height:12px;white-space:nowrap;margin-right:-18px;border-radius:2px;","X .vertical [data-title]:before,X .vertical [data-title]:after":"top:0%;right:200%;","X .vertical [data-title]:before":"border:6px solid rgba(0,0,0,0);border-left-color:#69738a;margin-top:8px;margin-right:-30px;",Y:'font-family:"Open Sans",verdana,arial,sans-serif;position:fixed;top:50px;right:20px;z-index:10000;font-size:10pt;max-width:180px;',"Y p":"margin:0;","Y .notifier-note":"min-width:180px;max-width:250px;border:1px solid #fff;z-index:3000;margin:0;background-color:#8c97af;background-color:rgba(140,151,175,.9);color:#fff;padding:10px;overflow-wrap:break-word;word-wrap:break-word;-ms-hyphens:auto;-webkit-hyphens:auto;hyphens:auto;","Y .notifier-close":"color:#fff;opacity:.8;float:right;padding:0 5px;background:none;border:none;font-size:20px;font-weight:bold;line-height:20px;","Y .notifier-close:hover":"color:#444;text-decoration:none;cursor:pointer;"};for(var m in v){var x=m.replace(/^,/," ,").replace(/X/g,".js-plotly-plot .plotly").replace(/Y/g,".plotly-notifier");g.addStyleRule(x,v[m])}},{"../src/lib":515}],2:[function(y,ee,Q){"use strict";ee.exports=y("../src/transforms/aggregate")},{"../src/transforms/aggregate":1127}],3:[function(y,ee,Q){"use strict";ee.exports=y("../src/traces/bar")},{"../src/traces/bar":665}],4:[function(y,ee,Q){"use strict";ee.exports=y("../src/traces/barpolar")},{"../src/traces/barpolar":678}],5:[function(y,ee,Q){"use strict";ee.exports=y("../src/traces/box")},{"../src/traces/box":688}],6:[function(y,ee,Q){"use strict";ee.exports=y("../src/components/calendars")},{"../src/components/calendars":365}],7:[function(y,ee,Q){"use strict";ee.exports=y("../src/traces/candlestick")},{"../src/traces/candlestick":697}],8:[function(y,ee,Q){"use strict";ee.exports=y("../src/traces/carpet")},{"../src/traces/carpet":716}],9:[function(y,ee,Q){"use strict";ee.exports=y("../src/traces/choropleth")},{"../src/traces/choropleth":730}],10:[function(y,ee,Q){"use strict";ee.exports=y("../src/traces/choroplethmapbox")},{"../src/traces/choroplethmapbox":737}],11:[function(y,ee,Q){"use strict";ee.exports=y("../src/traces/cone")},{"../src/traces/cone":743}],12:[function(y,ee,Q){"use strict";ee.exports=y("../src/traces/contour")},{"../src/traces/contour":758}],13:[function(y,ee,Q){"use strict";ee.exports=y("../src/traces/contourcarpet")},{"../src/traces/contourcarpet":769}],14:[function(y,ee,Q){"use strict";ee.exports=y("../src/core")},{"../src/core":493}],15:[function(y,ee,Q){"use strict";ee.exports=y("../src/traces/densitymapbox")},{"../src/traces/densitymapbox":777}],16:[function(y,ee,Q){"use strict";ee.exports=y("../src/transforms/filter")},{"../src/transforms/filter":1128}],17:[function(y,ee,Q){"use strict";ee.exports=y("../src/traces/funnel")},{"../src/traces/funnel":787}],18:[function(y,ee,Q){"use strict";ee.exports=y("../src/traces/funnelarea")},{"../src/traces/funnelarea":796}],19:[function(y,ee,Q){"use strict";ee.exports=y("../src/transforms/groupby")},{"../src/transforms/groupby":1129}],20:[function(y,ee,Q){"use strict";ee.exports=y("../src/traces/heatmap")},{"../src/traces/heatmap":809}],21:[function(y,ee,Q){"use strict";ee.exports=y("../src/traces/heatmapgl")},{"../src/traces/heatmapgl":820}],22:[function(y,ee,Q){"use strict";ee.exports=y("../src/traces/histogram")},{"../src/traces/histogram":832}],23:[function(y,ee,Q){"use strict";ee.exports=y("../src/traces/histogram2d")},{"../src/traces/histogram2d":838}],24:[function(y,ee,Q){"use strict";ee.exports=y("../src/traces/histogram2dcontour")},{"../src/traces/histogram2dcontour":842}],25:[function(y,ee,Q){"use strict";ee.exports=y("../src/traces/icicle")},{"../src/traces/icicle":848}],26:[function(y,ee,Q){"use strict";ee.exports=y("../src/traces/image")},{"../src/traces/image":861}],27:[function(y,ee,Q){"use strict";var g=y("./core");g.register([y("./bar"),y("./box"),y("./heatmap"),y("./histogram"),y("./histogram2d"),y("./histogram2dcontour"),y("./contour"),y("./scatterternary"),y("./violin"),y("./funnel"),y("./waterfall"),y("./image"),y("./pie"),y("./sunburst"),y("./treemap"),y("./icicle"),y("./funnelarea"),y("./scatter3d"),y("./surface"),y("./isosurface"),y("./volume"),y("./mesh3d"),y("./cone"),y("./streamtube"),y("./scattergeo"),y("./choropleth"),y("./scattergl"),y("./splom"),y("./pointcloud"),y("./heatmapgl"),y("./parcoords"),y("./parcats"),y("./scattermapbox"),y("./choroplethmapbox"),y("./densitymapbox"),y("./sankey"),y("./indicator"),y("./table"),y("./carpet"),y("./scattercarpet"),y("./contourcarpet"),y("./ohlc"),y("./candlestick"),y("./scatterpolar"),y("./scatterpolargl"),y("./barpolar"),y("./scattersmith"),y("./aggregate"),y("./filter"),y("./groupby"),y("./sort"),y("./calendars")]),ee.exports=g},{"./aggregate":2,"./bar":3,"./barpolar":4,"./box":5,"./calendars":6,"./candlestick":7,"./carpet":8,"./choropleth":9,"./choroplethmapbox":10,"./cone":11,"./contour":12,"./contourcarpet":13,"./core":14,"./densitymapbox":15,"./filter":16,"./funnel":17,"./funnelarea":18,"./groupby":19,"./heatmap":20,"./heatmapgl":21,"./histogram":22,"./histogram2d":23,"./histogram2dcontour":24,"./icicle":25,"./image":26,"./indicator":28,"./isosurface":29,"./mesh3d":30,"./ohlc":31,"./parcats":32,"./parcoords":33,"./pie":34,"./pointcloud":35,"./sankey":36,"./scatter3d":37,"./scattercarpet":38,"./scattergeo":39,"./scattergl":40,"./scattermapbox":41,"./scatterpolar":42,"./scatterpolargl":43,"./scattersmith":44,"./scatterternary":45,"./sort":46,"./splom":47,"./streamtube":48,"./sunburst":49,"./surface":50,"./table":51,"./treemap":52,"./violin":53,"./volume":54,"./waterfall":55}],28:[function(y,ee,Q){"use strict";ee.exports=y("../src/traces/indicator")},{"../src/traces/indicator":869}],29:[function(y,ee,Q){"use strict";ee.exports=y("../src/traces/isosurface")},{"../src/traces/isosurface":875}],30:[function(y,ee,Q){"use strict";ee.exports=y("../src/traces/mesh3d")},{"../src/traces/mesh3d":880}],31:[function(y,ee,Q){"use strict";ee.exports=y("../src/traces/ohlc")},{"../src/traces/ohlc":885}],32:[function(y,ee,Q){"use strict";ee.exports=y("../src/traces/parcats")},{"../src/traces/parcats":894}],33:[function(y,ee,Q){"use strict";ee.exports=y("../src/traces/parcoords")},{"../src/traces/parcoords":905}],34:[function(y,ee,Q){"use strict";ee.exports=y("../src/traces/pie")},{"../src/traces/pie":916}],35:[function(y,ee,Q){"use strict";ee.exports=y("../src/traces/pointcloud")},{"../src/traces/pointcloud":925}],36:[function(y,ee,Q){"use strict";ee.exports=y("../src/traces/sankey")},{"../src/traces/sankey":931}],37:[function(y,ee,Q){"use strict";ee.exports=y("../src/traces/scatter3d")},{"../src/traces/scatter3d":969}],38:[function(y,ee,Q){"use strict";ee.exports=y("../src/traces/scattercarpet")},{"../src/traces/scattercarpet":976}],39:[function(y,ee,Q){"use strict";ee.exports=y("../src/traces/scattergeo")},{"../src/traces/scattergeo":984}],40:[function(y,ee,Q){"use strict";ee.exports=y("../src/traces/scattergl")},{"../src/traces/scattergl":998}],41:[function(y,ee,Q){"use strict";ee.exports=y("../src/traces/scattermapbox")},{"../src/traces/scattermapbox":1008}],42:[function(y,ee,Q){"use strict";ee.exports=y("../src/traces/scatterpolar")},{"../src/traces/scatterpolar":1016}],43:[function(y,ee,Q){"use strict";ee.exports=y("../src/traces/scatterpolargl")},{"../src/traces/scatterpolargl":1024}],44:[function(y,ee,Q){"use strict";ee.exports=y("../src/traces/scattersmith")},{"../src/traces/scattersmith":1031}],45:[function(y,ee,Q){"use strict";ee.exports=y("../src/traces/scatterternary")},{"../src/traces/scatterternary":1039}],46:[function(y,ee,Q){"use strict";ee.exports=y("../src/transforms/sort")},{"../src/transforms/sort":1131}],47:[function(y,ee,Q){"use strict";ee.exports=y("../src/traces/splom")},{"../src/traces/splom":1049}],48:[function(y,ee,Q){"use strict";ee.exports=y("../src/traces/streamtube")},{"../src/traces/streamtube":1057}],49:[function(y,ee,Q){"use strict";ee.exports=y("../src/traces/sunburst")},{"../src/traces/sunburst":1065}],50:[function(y,ee,Q){"use strict";ee.exports=y("../src/traces/surface")},{"../src/traces/surface":1074}],51:[function(y,ee,Q){"use strict";ee.exports=y("../src/traces/table")},{"../src/traces/table":1082}],52:[function(y,ee,Q){"use strict";ee.exports=y("../src/traces/treemap")},{"../src/traces/treemap":1093}],53:[function(y,ee,Q){"use strict";ee.exports=y("../src/traces/violin")},{"../src/traces/violin":1106}],54:[function(y,ee,Q){"use strict";ee.exports=y("../src/traces/volume")},{"../src/traces/volume":1114}],55:[function(y,ee,Q){"use strict";ee.exports=y("../src/traces/waterfall")},{"../src/traces/waterfall":1122}],56:[function(y,ee,Q){var g,v;g=this,v=function(g,v,m,x,e){"use strict";function n(re){return re.target.depth}function t(re,ne){return re.sourceLinks.length?re.depth:ne-1}function a(re){return function(){return re}}e=e&&e.hasOwnProperty("default")?e.default:e;var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(re){return typeof re}:function(re){return re&&"function"==typeof Symbol&&re.constructor===Symbol&&re!==Symbol.prototype?"symbol":typeof re};function d(re,ne){return i(re.source,ne.source)||re.index-ne.index}function s(re,ne){return i(re.target,ne.target)||re.index-ne.index}function i(re,ne){return re.partOfCycle===ne.partOfCycle?re.y0-ne.y0:"top"===re.circularLinkType||"bottom"===ne.circularLinkType?-1:1}function u(re){return re.value}function f(re){return(re.y0+re.y1)/2}function c(re){return f(re.source)}function h(re){return f(re.target)}function p(re){return re.index}function o(re){return re.nodes}function b(re){return re.links}function l(re,ne){var le=re.get(ne);if(!le)throw new Error("missing: "+ne);return le}function T(re,ne){return ne(re)}function _(re,ne,le){var oe=0;if(null===le){for(var de=[],se=0;se<re.links.length;se++){var ge=re.links[se],_e=ge.source.index,Te=ge.target.index;de[_e]||(de[_e]=[]),de[Te]||(de[Te]=[]),-1===de[_e].indexOf(Te)&&de[_e].push(Te)}var we=e(de);we.sort(function(ve,Ae){return ve.length-Ae.length});var Oe={};for(se=0;se<we.length;se++){var fe=we[se].slice(-2);Oe[fe[0]]||(Oe[fe[0]]={}),Oe[fe[0]][fe[1]]=!0}re.links.forEach(function(ve){var Ae=ve.target.index,ke=ve.source.index;Ae===ke||Oe[ke]&&Oe[ke][Ae]?(ve.circular=!0,ve.circularLinkID=oe,oe+=1):ve.circular=!1})}else re.links.forEach(function(ve){ve.source[le]<ve.target[le]?ve.circular=!1:(ve.circular=!0,ve.circularLinkID=oe,oe+=1)})}function w(re,ne){var le=0,oe=0;re.links.forEach(function(de){de.circular&&(de.circularLinkType=de.source.circularLinkType||de.target.circularLinkType?de.source.circularLinkType?de.source.circularLinkType:de.target.circularLinkType:le<oe?"top":"bottom","top"==de.circularLinkType?le+=1:oe+=1,re.nodes.forEach(function(se){T(se,ne)!=T(de.source,ne)&&T(se,ne)!=T(de.target,ne)||(se.circularLinkType=de.circularLinkType)}))}),re.links.forEach(function(de){de.circular&&(de.source.circularLinkType==de.target.circularLinkType&&(de.circularLinkType=de.source.circularLinkType),J(de,ne)&&(de.circularLinkType=de.source.circularLinkType))})}function k(re){var ne=Math.abs(re.y1-re.y0),le=Math.abs(re.target.x0-re.source.x1);return Math.atan(le/ne)}function L(re,ne){var le=0;re.sourceLinks.forEach(function(de){le=de.circular&&!J(de,ne)?le+1:le});var oe=0;return re.targetLinks.forEach(function(de){oe=de.circular&&!J(de,ne)?oe+1:oe}),le+oe}function M(re){var le=0;re.source.sourceLinks.forEach(function(se){le=se.circular?le+1:le});var de=0;return re.target.targetLinks.forEach(function(se){de=se.circular?de+1:de}),!(le>1||de>1)}function I(re,ne,le){return re.sort(S),re.forEach(function(oe,de){var se,ge,_e=0;if(J(oe,le)&&M(oe))oe.circularPathData.verticalBuffer=_e+oe.width/2;else{for(var Te=0;Te<de;Te++)if(!((se=re[de]).source.column<(ge=re[Te]).target.column||se.target.column>ge.source.column)){var we=re[Te].circularPathData.verticalBuffer+re[Te].width/2+ne;_e=we>_e?we:_e}oe.circularPathData.verticalBuffer=_e+oe.width/2}}),re}function P(re,ne,le,oe){var de=v.min(re.links,function(se){return se.source.y0});re.links.forEach(function(se){se.circular&&(se.circularPathData={})}),I(re.links.filter(function(se){return"top"==se.circularLinkType}),ne,oe),I(re.links.filter(function(se){return"bottom"==se.circularLinkType}),ne,oe),re.links.forEach(function(se){if(se.circular){if(se.circularPathData.arcRadius=se.width+10,se.circularPathData.leftNodeBuffer=5,se.circularPathData.rightNodeBuffer=5,se.circularPathData.sourceWidth=se.source.x1-se.source.x0,se.circularPathData.sourceX=se.source.x0+se.circularPathData.sourceWidth,se.circularPathData.targetX=se.target.x0,se.circularPathData.sourceY=se.y0,se.circularPathData.targetY=se.y1,J(se,oe)&&M(se))se.circularPathData.leftSmallArcRadius=10+se.width/2,se.circularPathData.leftLargeArcRadius=10+se.width/2,se.circularPathData.rightSmallArcRadius=10+se.width/2,se.circularPathData.rightLargeArcRadius=10+se.width/2,"bottom"==se.circularLinkType?(se.circularPathData.verticalFullExtent=se.source.y1+25+se.circularPathData.verticalBuffer,se.circularPathData.verticalLeftInnerExtent=se.circularPathData.verticalFullExtent-se.circularPathData.leftLargeArcRadius,se.circularPathData.verticalRightInnerExtent=se.circularPathData.verticalFullExtent-se.circularPathData.rightLargeArcRadius):(se.circularPathData.verticalFullExtent=se.source.y0-25-se.circularPathData.verticalBuffer,se.circularPathData.verticalLeftInnerExtent=se.circularPathData.verticalFullExtent+se.circularPathData.leftLargeArcRadius,se.circularPathData.verticalRightInnerExtent=se.circularPathData.verticalFullExtent+se.circularPathData.rightLargeArcRadius);else{var ge=se.source.column,_e=se.circularLinkType,Te=re.links.filter(function(fe){return fe.source.column==ge&&fe.circularLinkType==_e});Te.sort("bottom"==se.circularLinkType?z:E);var we=0;Te.forEach(function(fe,ve){fe.circularLinkID==se.circularLinkID&&(se.circularPathData.leftSmallArcRadius=10+se.width/2+we,se.circularPathData.leftLargeArcRadius=10+se.width/2+ve*ne+we),we+=fe.width}),ge=se.target.column,(Te=re.links.filter(function(fe){return fe.target.column==ge&&fe.circularLinkType==_e})).sort("bottom"==se.circularLinkType?q:R),we=0,Te.forEach(function(fe,ve){fe.circularLinkID==se.circularLinkID&&(se.circularPathData.rightSmallArcRadius=10+se.width/2+we,se.circularPathData.rightLargeArcRadius=10+se.width/2+ve*ne+we),we+=fe.width}),"bottom"==se.circularLinkType?(se.circularPathData.verticalFullExtent=Math.max(le,se.source.y1,se.target.y1)+25+se.circularPathData.verticalBuffer,se.circularPathData.verticalLeftInnerExtent=se.circularPathData.verticalFullExtent-se.circularPathData.leftLargeArcRadius,se.circularPathData.verticalRightInnerExtent=se.circularPathData.verticalFullExtent-se.circularPathData.rightLargeArcRadius):(se.circularPathData.verticalFullExtent=de-25-se.circularPathData.verticalBuffer,se.circularPathData.verticalLeftInnerExtent=se.circularPathData.verticalFullExtent+se.circularPathData.leftLargeArcRadius,se.circularPathData.verticalRightInnerExtent=se.circularPathData.verticalFullExtent+se.circularPathData.rightLargeArcRadius)}se.circularPathData.leftInnerExtent=se.circularPathData.sourceX+se.circularPathData.leftNodeBuffer,se.circularPathData.rightInnerExtent=se.circularPathData.targetX-se.circularPathData.rightNodeBuffer,se.circularPathData.leftFullExtent=se.circularPathData.sourceX+se.circularPathData.leftLargeArcRadius+se.circularPathData.leftNodeBuffer,se.circularPathData.rightFullExtent=se.circularPathData.targetX-se.circularPathData.rightLargeArcRadius-se.circularPathData.rightNodeBuffer}if(se.circular)se.path="top"==(fe=se).circularLinkType?"M"+fe.circularPathData.sourceX+" "+fe.circularPathData.sourceY+" L"+fe.circularPathData.leftInnerExtent+" "+fe.circularPathData.sourceY+" A"+fe.circularPathData.leftLargeArcRadius+" "+fe.circularPathData.leftSmallArcRadius+" 0 0 0 "+fe.circularPathData.leftFullExtent+" "+(fe.circularPathData.sourceY-fe.circularPathData.leftSmallArcRadius)+" L"+fe.circularPathData.leftFullExtent+" "+fe.circularPathData.verticalLeftInnerExtent+" A"+fe.circularPathData.leftLargeArcRadius+" "+fe.circularPathData.leftLargeArcRadius+" 0 0 0 "+fe.circularPathData.leftInnerExtent+" "+fe.circularPathData.verticalFullExtent+" L"+fe.circularPathData.rightInnerExtent+" "+fe.circularPathData.verticalFullExtent+" A"+fe.circularPathData.rightLargeArcRadius+" "+fe.circularPathData.rightLargeArcRadius+" 0 0 0 "+fe.circularPathData.rightFullExtent+" "+fe.circularPathData.verticalRightInnerExtent+" L"+fe.circularPathData.rightFullExtent+" "+(fe.circularPathData.targetY-fe.circularPathData.rightSmallArcRadius)+" A"+fe.circularPathData.rightLargeArcRadius+" "+fe.circularPathData.rightSmallArcRadius+" 0 0 0 "+fe.circularPathData.rightInnerExtent+" "+fe.circularPathData.targetY+" L"+fe.circularPathData.targetX+" "+fe.circularPathData.targetY:"M"+fe.circularPathData.sourceX+" "+fe.circularPathData.sourceY+" L"+fe.circularPathData.leftInnerExtent+" "+fe.circularPathData.sourceY+" A"+fe.circularPathData.leftLargeArcRadius+" "+fe.circularPathData.leftSmallArcRadius+" 0 0 1 "+fe.circularPathData.leftFullExtent+" "+(fe.circularPathData.sourceY+fe.circularPathData.leftSmallArcRadius)+" L"+fe.circularPathData.leftFullExtent+" "+fe.circularPathData.verticalLeftInnerExtent+" A"+fe.circularPathData.leftLargeArcRadius+" "+fe.circularPathData.leftLargeArcRadius+" 0 0 1 "+fe.circularPathData.leftInnerExtent+" "+fe.circularPathData.verticalFullExtent+" L"+fe.circularPathData.rightInnerExtent+" "+fe.circularPathData.verticalFullExtent+" A"+fe.circularPathData.rightLargeArcRadius+" "+fe.circularPathData.rightLargeArcRadius+" 0 0 1 "+fe.circularPathData.rightFullExtent+" "+fe.circularPathData.verticalRightInnerExtent+" L"+fe.circularPathData.rightFullExtent+" "+(fe.circularPathData.targetY+fe.circularPathData.rightSmallArcRadius)+" A"+fe.circularPathData.rightLargeArcRadius+" "+fe.circularPathData.rightSmallArcRadius+" 0 0 1 "+fe.circularPathData.rightInnerExtent+" "+fe.circularPathData.targetY+" L"+fe.circularPathData.targetX+" "+fe.circularPathData.targetY;else{var Oe=x.linkHorizontal().source(function(fe){return[fe.source.x0+(fe.source.x1-fe.source.x0),fe.y0]}).target(function(fe){return[fe.target.x0,fe.y1]});se.path=Oe(se)}var fe})}function S(re,ne){return V(re)==V(ne)?"bottom"==re.circularLinkType?z(re,ne):E(re,ne):V(ne)-V(re)}function E(re,ne){return re.y0-ne.y0}function z(re,ne){return ne.y0-re.y0}function R(re,ne){return re.y1-ne.y1}function q(re,ne){return ne.y1-re.y1}function V(re){return re.target.column-re.source.column}function W(re){return re.target.x0-re.source.x1}function K(re,ne){var le=k(re),oe=W(ne)/Math.tan(le);return"up"==j(re)?re.y1+oe:re.y1-oe}function G(re,ne){var le=k(re),oe=W(ne)/Math.tan(le);return"up"==j(re)?re.y1-oe:re.y1+oe}function Y(re,ne,le,oe){re.links.forEach(function(de){if(!de.circular&&de.target.column-de.source.column>1){var se=de.source.column+1,ge=de.target.column-1,_e=1,Te=ge-se+1;for(_e=1;se<=ge;se++,_e++)re.nodes.forEach(function(we){if(we.column==se){var Oe,fe=_e/(Te+1),ve=Math.pow(1-fe,3),Ae=3*fe*Math.pow(1-fe,2),ke=3*Math.pow(fe,2)*(1-fe),Pe=Math.pow(fe,3),Ne=ve*de.y0+Ae*de.y0+ke*de.y1+Pe*de.y1,De=Ne-de.width/2,ze=Ne+de.width/2;De>we.y0&&De<we.y1?(Oe=we.y1-De+10,we=B(we,Oe="bottom"==we.circularLinkType?Oe:-Oe,ne,le),re.nodes.forEach(function(Me){T(Me,oe)!=T(we,oe)&&Me.column==we.column&&$(we,Me)&&B(Me,Oe,ne,le)})):(ze>we.y0&&ze<we.y1||De<we.y0&&ze>we.y1)&&(we=B(we,Oe=ze-we.y0+10,ne,le),re.nodes.forEach(function(Me){T(Me,oe)!=T(we,oe)&&Me.column==we.column&&Me.y0<we.y1&&Me.y1>we.y1&&B(Me,Oe,ne,le)}))}})}})}function $(re,ne){return re.y0>ne.y0&&re.y0<ne.y1||re.y1>ne.y0&&re.y1<ne.y1||re.y0<ne.y0&&re.y1>ne.y1}function B(re,ne,le,oe){return re.y0+ne>=le&&re.y1+ne<=oe&&(re.y0=re.y0+ne,re.y1=re.y1+ne,re.targetLinks.forEach(function(de){de.y1=de.y1+ne}),re.sourceLinks.forEach(function(de){de.y0=de.y0+ne})),re}function N(re,ne,le,oe){re.nodes.forEach(function(de){oe&&de.y+(de.y1-de.y0)>ne&&(de.y=de.y-(de.y+(de.y1-de.y0)-ne));var se=re.links.filter(function(Te){return T(Te.source,le)==T(de,le)}),ge=se.length;ge>1&&se.sort(function(Te,we){if(!Te.circular&&!we.circular){if(Te.target.column==we.target.column||!te(Te,we))return Te.y1-we.y1;if(Te.target.column>we.target.column){var Oe=G(we,Te);return Te.y1-Oe}if(we.target.column>Te.target.column)return G(Te,we)-we.y1}return Te.circular&&!we.circular?"top"==Te.circularLinkType?-1:1:we.circular&&!Te.circular?"top"==we.circularLinkType?1:-1:Te.circular&&we.circular?Te.circularLinkType===we.circularLinkType&&"top"==Te.circularLinkType?Te.target.column===we.target.column?Te.target.y1-we.target.y1:we.target.column-Te.target.column:Te.circularLinkType===we.circularLinkType&&"bottom"==Te.circularLinkType?Te.target.column===we.target.column?we.target.y1-Te.target.y1:Te.target.column-we.target.column:"top"==Te.circularLinkType?-1:1:void 0});var _e=de.y0;se.forEach(function(Te){Te.y0=_e+Te.width/2,_e+=Te.width}),se.forEach(function(Te,we){if("bottom"==Te.circularLinkType){for(var Oe=we+1,fe=0;Oe<ge;Oe++)fe+=se[Oe].width;Te.y0=de.y1-fe-Te.width/2}})})}function U(re,ne,le){re.nodes.forEach(function(oe){var de=re.links.filter(function(_e){return T(_e.target,le)==T(oe,le)}),se=de.length;se>1&&de.sort(function(_e,Te){if(!_e.circular&&!Te.circular){if(_e.source.column==Te.source.column||!te(_e,Te))return _e.y0-Te.y0;if(Te.source.column<_e.source.column){var we=K(Te,_e);return _e.y0-we}if(_e.source.column<Te.source.column)return K(_e,Te)-Te.y0}return _e.circular&&!Te.circular?"top"==_e.circularLinkType?-1:1:Te.circular&&!_e.circular?"top"==Te.circularLinkType?1:-1:_e.circular&&Te.circular?_e.circularLinkType===Te.circularLinkType&&"top"==_e.circularLinkType?_e.source.column===Te.source.column?_e.source.y1-Te.source.y1:_e.source.column-Te.source.column:_e.circularLinkType===Te.circularLinkType&&"bottom"==_e.circularLinkType?_e.source.column===Te.source.column?_e.source.y1-Te.source.y1:Te.source.column-_e.source.column:"top"==_e.circularLinkType?-1:1:void 0});var ge=oe.y0;de.forEach(function(_e){_e.y1=ge+_e.width/2,ge+=_e.width}),de.forEach(function(_e,Te){if("bottom"==_e.circularLinkType){for(var we=Te+1,Oe=0;we<se;we++)Oe+=de[we].width;_e.y1=oe.y1-Oe-_e.width/2}})})}function te(re,ne){return j(re)==j(ne)}function j(re){return re.y0-re.y1>0?"up":"down"}function J(re,ne){return T(re.source,ne)==T(re.target,ne)}function X(re,ne,le){var oe=re.nodes,de=re.links,se=!1,ge=!1;if(de.forEach(function(we){"top"==we.circularLinkType?se=!0:"bottom"==we.circularLinkType&&(ge=!0)}),0==se||0==ge){var _e=v.min(oe,function(we){return we.y0}),Te=(le-ne)/(v.max(oe,function(we){return we.y1})-_e);oe.forEach(function(we){var Oe=(we.y1-we.y0)*Te;we.y0=(we.y0-_e)*Te,we.y1=we.y0+Oe}),de.forEach(function(we){we.y0=(we.y0-_e)*Te,we.y1=(we.y1-_e)*Te,we.width=we.width*Te})}}g.sankeyCircular=function(){var re,ne,le=0,oe=0,de=1,se=1,ge=24,_e=p,Te=t,we=o,Oe=b,fe=32,ve=2,Ae=null;function ke(){var Se={nodes:we.apply(null,arguments),links:Oe.apply(null,arguments)};Pe(Se),_(Se,0,Ae),Ne(Se),De(Se),w(Se,_e),ze(Se,fe,_e),Me(Se);for(var Ie=4,Fe=0;Fe<Ie;Fe++)N(Se,se,_e),U(Se,0,_e),Y(Se,oe,se,_e),N(Se,se,_e),U(Se,0,_e);return X(Se,oe,se),P(Se,ve,se,_e),Se}function Pe(Se){Se.nodes.forEach(function(Fe,Re){Fe.index=Re,Fe.sourceLinks=[],Fe.targetLinks=[]});var Ie=m.map(Se.nodes,_e);return Se.links.forEach(function(Fe,Re){Fe.index=Re;var Xe=Fe.source,nt=Fe.target;"object"!==(void 0===Xe?"undefined":r(Xe))&&(Xe=Fe.source=l(Ie,Xe)),"object"!==(void 0===nt?"undefined":r(nt))&&(nt=Fe.target=l(Ie,nt)),Xe.sourceLinks.push(Fe),nt.targetLinks.push(Fe)}),Se}function Ne(Se){Se.nodes.forEach(function(Ie){Ie.partOfCycle=!1,Ie.value=Math.max(v.sum(Ie.sourceLinks,u),v.sum(Ie.targetLinks,u)),Ie.sourceLinks.forEach(function(Fe){Fe.circular&&(Ie.partOfCycle=!0,Ie.circularLinkType=Fe.circularLinkType)}),Ie.targetLinks.forEach(function(Fe){Fe.circular&&(Ie.partOfCycle=!0,Ie.circularLinkType=Fe.circularLinkType)})})}function De(Se){var Ie,Fe,Re;for(Ie=Se.nodes,Fe=[],Re=0;Ie.length;++Re,Ie=Fe,Fe=[])Ie.forEach(function(Xe){Xe.depth=Re,Xe.sourceLinks.forEach(function(nt){Fe.indexOf(nt.target)<0&&!nt.circular&&Fe.push(nt.target)})});for(Ie=Se.nodes,Fe=[],Re=0;Ie.length;++Re,Ie=Fe,Fe=[])Ie.forEach(function(Xe){Xe.height=Re,Xe.targetLinks.forEach(function(nt){Fe.indexOf(nt.source)<0&&!nt.circular&&Fe.push(nt.source)})});Se.nodes.forEach(function(Xe){Xe.column=Math.floor(Te.call(null,Xe,Re))})}function ze(Se,Ie,Fe){var Re=m.nest().key(function(dt){return dt.column}).sortKeys(v.ascending).entries(Se.nodes).map(function(dt){return dt.values});(function(dt){if(ne){var tt=1/0;Re.forEach(function(Ut){var er=se*ne/(Ut.length+1);tt=er<tt?er:tt}),re=tt}var Ke=v.min(Re,function(Ut){return(se-oe-(Ut.length-1)*re)/v.sum(Ut,u)});Ke*=.3,Se.links.forEach(function(Ut){Ut.width=Ut.value*Ke});var Ut,er,Wt,rr,Ht,Ve,mt=(er=0,Wt=0,rr=0,Ht=0,Ve=v.max((Ut=Se).nodes,function(We){return We.column}),Ut.links.forEach(function(We){We.circular&&("top"==We.circularLinkType?er+=We.width:Wt+=We.width,0==We.target.column&&(Ht+=We.width),We.source.column==Ve&&(rr+=We.width))}),{top:er=er>0?er+25+10:er,bottom:Wt=Wt>0?Wt+25+10:Wt,left:Ht=Ht>0?Ht+25+10:Ht,right:rr=rr>0?rr+25+10:rr}),Bt=function(Ut,er){var Wt=v.max(Ut.nodes,function(he){return he.column}),rr=de-le,Ht=se-oe,Ve=rr/(rr+er.right+er.left),We=Ht/(Ht+er.top+er.bottom);return le=le*Ve+er.left,de=0==er.right?de:de*Ve,oe=oe*We+er.top,se*=We,Ut.nodes.forEach(function(he){he.x0=le+he.column*((de-le-ge)/Wt),he.x1=he.x0+ge}),We}(Se,mt);Ke*=Bt,Se.links.forEach(function(Ut){Ut.width=Ut.value*Ke}),Re.forEach(function(Ut){var er=Ut.length;Ut.forEach(function(Wt,rr){Wt.depth==Re.length-1&&1==er||0==Wt.depth&&1==er?(Wt.y0=se/2-Wt.value*Ke,Wt.y1=Wt.y0+Wt.value*Ke):Wt.partOfCycle?0==L(Wt,dt)?(Wt.y0=se/2+rr,Wt.y1=Wt.y0+Wt.value*Ke):"top"==Wt.circularLinkType?(Wt.y0=oe+rr,Wt.y1=Wt.y0+Wt.value*Ke):(Wt.y0=se-Wt.value*Ke-rr,Wt.y1=Wt.y0+Wt.value*Ke):0==mt.top||0==mt.bottom?(Wt.y0=(se-oe)/er*rr,Wt.y1=Wt.y0+Wt.value*Ke):(Wt.y0=(se-oe)/2-er/2+rr,Wt.y1=Wt.y0+Wt.value*Ke)})})})(Fe),xt();for(var Xe=1,nt=Ie;nt>0;--nt)ct(Xe*=.99,Fe),xt();function ct(dt,tt){var Ke=Re.length;Re.forEach(function(mt){var Bt=mt.length,Ut=mt[0].depth;mt.forEach(function(er){var Wt;if((er.sourceLinks.length||er.targetLinks.length)&&!(er.partOfCycle&&L(er,tt)>0))if(0==Ut&&1==Bt)er.y0=se/2-(Wt=er.y1-er.y0)/2,er.y1=se/2+Wt/2;else if(Ut==Ke-1&&1==Bt)er.y0=se/2-(Wt=er.y1-er.y0)/2,er.y1=se/2+Wt/2;else{var rr=v.mean(er.sourceLinks,h),Ht=v.mean(er.targetLinks,c),Ve=((rr&&Ht?(rr+Ht)/2:rr||Ht)-f(er))*dt;er.y0+=Ve,er.y1+=Ve}})})}function xt(){Re.forEach(function(dt){var tt,Ke,mt,Bt=oe,Ut=dt.length;for(dt.sort(i),mt=0;mt<Ut;++mt)(Ke=Bt-(tt=dt[mt]).y0)>0&&(tt.y0+=Ke,tt.y1+=Ke),Bt=tt.y1+re;if((Ke=Bt-re-se)>0)for(Bt=tt.y0-=Ke,tt.y1-=Ke,mt=Ut-2;mt>=0;--mt)(Ke=(tt=dt[mt]).y1+re-Bt)>0&&(tt.y0-=Ke,tt.y1-=Ke),Bt=tt.y0})}}function Me(Se){Se.nodes.forEach(function(Ie){Ie.sourceLinks.sort(s),Ie.targetLinks.sort(d)}),Se.nodes.forEach(function(Ie){var Fe=Ie.y0,Re=Fe,Xe=Ie.y1,nt=Xe;Ie.sourceLinks.forEach(function(ct){ct.circular?(ct.y0=Xe-ct.width/2,Xe-=ct.width):(ct.y0=Fe+ct.width/2,Fe+=ct.width)}),Ie.targetLinks.forEach(function(ct){ct.circular?(ct.y1=nt-ct.width/2,nt-=ct.width):(ct.y1=Re+ct.width/2,Re+=ct.width)})})}return ke.nodeId=function(Se){return arguments.length?(_e="function"==typeof Se?Se:a(Se),ke):_e},ke.nodeAlign=function(Se){return arguments.length?(Te="function"==typeof Se?Se:a(Se),ke):Te},ke.nodeWidth=function(Se){return arguments.length?(ge=+Se,ke):ge},ke.nodePadding=function(Se){return arguments.length?(re=+Se,ke):re},ke.nodes=function(Se){return arguments.length?(we="function"==typeof Se?Se:a(Se),ke):we},ke.links=function(Se){return arguments.length?(Oe="function"==typeof Se?Se:a(Se),ke):Oe},ke.size=function(Se){return arguments.length?(le=oe=0,de=+Se[0],se=+Se[1],ke):[de-le,se-oe]},ke.extent=function(Se){return arguments.length?(le=+Se[0][0],de=+Se[1][0],oe=+Se[0][1],se=+Se[1][1],ke):[[le,oe],[de,se]]},ke.iterations=function(Se){return arguments.length?(fe=+Se,ke):fe},ke.circularLinkGap=function(Se){return arguments.length?(ve=+Se,ke):ve},ke.nodePaddingRatio=function(Se){return arguments.length?(ne=+Se,ke):ne},ke.sortNodes=function(Se){return arguments.length?(Ae=Se,ke):Ae},ke.update=function(Se){return w(Se,_e),Me(Se),Se.links.forEach(function(Ie){Ie.circular&&(Ie.circularLinkType=Ie.y0+Ie.y1<se?"top":"bottom",Ie.source.circularLinkType=Ie.circularLinkType,Ie.target.circularLinkType=Ie.circularLinkType)}),N(Se,se,_e,!1),U(Se,0,_e),P(Se,ve,se,_e),Se},ke},g.sankeyCenter=function(re){return re.targetLinks.length?re.depth:re.sourceLinks.length?v.min(re.sourceLinks,n)-1:0},g.sankeyLeft=function(re){return re.depth},g.sankeyRight=function(re,ne){return ne-1-re.height},g.sankeyJustify=t,Object.defineProperty(g,"__esModule",{value:!0})},"object"==typeof Q&&void 0!==ee?v(Q,y("d3-array"),y("d3-collection"),y("d3-shape"),y("elementary-circuits-directed-graph")):v(g.d3=g.d3||{},g.d3,g.d3,g.d3,null)},{"d3-array":107,"d3-collection":108,"d3-shape":119,"elementary-circuits-directed-graph":130}],57:[function(y,ee,Q){var g,v;g=this,v=function(g,v,m,x){"use strict";function e(T){return T.target.depth}function n(T,_){return T.sourceLinks.length?T.depth:_-1}function t(T){return function(){return T}}function a(T,_){return d(T.source,_.source)||T.index-_.index}function r(T,_){return d(T.target,_.target)||T.index-_.index}function d(T,_){return T.y0-_.y0}function s(T){return T.value}function i(T){return(T.y0+T.y1)/2}function u(T){return i(T.source)*T.value}function f(T){return i(T.target)*T.value}function c(T){return T.index}function h(T){return T.nodes}function p(T){return T.links}function o(T,_){var w=T.get(_);if(!w)throw new Error("missing: "+_);return w}function b(T){return[T.source.x1,T.y0]}function l(T){return[T.target.x0,T.y1]}g.sankey=function(){var T=0,_=0,w=1,k=1,L=24,M=8,I=c,P=n,S=h,E=p,z=32;function R(){var Y={nodes:S.apply(null,arguments),links:E.apply(null,arguments)};return q(Y),V(Y),W(Y),K(Y),G(Y),Y}function q(Y){Y.nodes.forEach(function(B,N){B.index=N,B.sourceLinks=[],B.targetLinks=[]});var $=m.map(Y.nodes,I);Y.links.forEach(function(B,N){B.index=N;var U=B.source,te=B.target;"object"!=typeof U&&(U=B.source=o($,U)),"object"!=typeof te&&(te=B.target=o($,te)),U.sourceLinks.push(B),te.targetLinks.push(B)})}function V(Y){Y.nodes.forEach(function($){$.value=Math.max(v.sum($.sourceLinks,s),v.sum($.targetLinks,s))})}function W(Y){var $,B,N;for($=Y.nodes,B=[],N=0;$.length;++N,$=B,B=[])$.forEach(function(te){te.depth=N,te.sourceLinks.forEach(function(j){B.indexOf(j.target)<0&&B.push(j.target)})});for($=Y.nodes,B=[],N=0;$.length;++N,$=B,B=[])$.forEach(function(te){te.height=N,te.targetLinks.forEach(function(j){B.indexOf(j.source)<0&&B.push(j.source)})});var U=(w-T-L)/(N-1);Y.nodes.forEach(function(te){te.x1=(te.x0=T+Math.max(0,Math.min(N-1,Math.floor(P.call(null,te,N))))*U)+L})}function K(Y){var $=m.nest().key(function(J){return J.x0}).sortKeys(v.ascending).entries(Y.nodes).map(function(J){return J.values});(function(){var J=v.max($,function(ne){return ne.length}),X=2/3*(k-_)/(J-1);M>X&&(M=X);var re=v.min($,function(ne){return(k-_-(ne.length-1)*M)/v.sum(ne,s)});$.forEach(function(ne){ne.forEach(function(le,oe){le.y1=(le.y0=oe)+le.value*re})}),Y.links.forEach(function(ne){ne.width=ne.value*re})})(),j();for(var B=1,N=z;N>0;--N)te(B*=.99),j(),U(B),j();function U(J){$.forEach(function(X){X.forEach(function(re){if(re.targetLinks.length){var ne=(v.sum(re.targetLinks,u)/v.sum(re.targetLinks,s)-i(re))*J;re.y0+=ne,re.y1+=ne}})})}function te(J){$.slice().reverse().forEach(function(X){X.forEach(function(re){if(re.sourceLinks.length){var ne=(v.sum(re.sourceLinks,f)/v.sum(re.sourceLinks,s)-i(re))*J;re.y0+=ne,re.y1+=ne}})})}function j(){$.forEach(function(J){var X,re,ne,le=_,oe=J.length;for(J.sort(d),ne=0;ne<oe;++ne)(re=le-(X=J[ne]).y0)>0&&(X.y0+=re,X.y1+=re),le=X.y1+M;if((re=le-M-k)>0)for(le=X.y0-=re,X.y1-=re,ne=oe-2;ne>=0;--ne)(re=(X=J[ne]).y1+M-le)>0&&(X.y0-=re,X.y1-=re),le=X.y0})}}function G(Y){Y.nodes.forEach(function($){$.sourceLinks.sort(r),$.targetLinks.sort(a)}),Y.nodes.forEach(function($){var B=$.y0,N=B;$.sourceLinks.forEach(function(U){U.y0=B+U.width/2,B+=U.width}),$.targetLinks.forEach(function(U){U.y1=N+U.width/2,N+=U.width})})}return R.update=function(Y){return G(Y),Y},R.nodeId=function(Y){return arguments.length?(I="function"==typeof Y?Y:t(Y),R):I},R.nodeAlign=function(Y){return arguments.length?(P="function"==typeof Y?Y:t(Y),R):P},R.nodeWidth=function(Y){return arguments.length?(L=+Y,R):L},R.nodePadding=function(Y){return arguments.length?(M=+Y,R):M},R.nodes=function(Y){return arguments.length?(S="function"==typeof Y?Y:t(Y),R):S},R.links=function(Y){return arguments.length?(E="function"==typeof Y?Y:t(Y),R):E},R.size=function(Y){return arguments.length?(T=_=0,w=+Y[0],k=+Y[1],R):[w-T,k-_]},R.extent=function(Y){return arguments.length?(T=+Y[0][0],w=+Y[1][0],_=+Y[0][1],k=+Y[1][1],R):[[T,_],[w,k]]},R.iterations=function(Y){return arguments.length?(z=+Y,R):z},R},g.sankeyCenter=function(T){return T.targetLinks.length?T.depth:T.sourceLinks.length?v.min(T.sourceLinks,e)-1:0},g.sankeyLeft=function(T){return T.depth},g.sankeyRight=function(T,_){return _-1-T.height},g.sankeyJustify=n,g.sankeyLinkHorizontal=function(){return x.linkHorizontal().source(b).target(l)},Object.defineProperty(g,"__esModule",{value:!0})},"object"==typeof Q&&void 0!==ee?v(Q,y("d3-array"),y("d3-collection"),y("d3-shape")):v(g.d3=g.d3||{},g.d3,g.d3,g.d3)},{"d3-array":107,"d3-collection":108,"d3-shape":119}],58:[function(y,ee,Q){(function(){var g={version:"3.8.0"},v=[].slice,m=function(ce){return v.call(ce)},x=self.document;function e(ce){return ce&&(ce.ownerDocument||ce.document||ce).documentElement}function n(ce){return ce&&(ce.ownerDocument&&ce.ownerDocument.defaultView||ce.document&&ce||ce.defaultView)}if(x)try{m(x.documentElement.childNodes)}catch{m=function(C){for(var D=C.length,F=new Array(D);D--;)F[D]=C[D];return F}}if(Date.now||(Date.now=function(){return+new Date}),x)try{x.createElement("DIV").style.setProperty("opacity",0,"")}catch{var t=this.Element.prototype,a=t.setAttribute,r=t.setAttributeNS,d=this.CSSStyleDeclaration.prototype,s=d.setProperty;t.setAttribute=function(C,D){a.call(this,C,D+"")},t.setAttributeNS=function(C,D,F){r.call(this,C,D,F+"")},d.setProperty=function(C,D,F){s.call(this,C,D+"",F)}}function i(ce,C){return ce<C?-1:ce>C?1:ce>=C?0:NaN}function u(ce){return null===ce?NaN:+ce}function f(ce){return!isNaN(ce)}function c(ce){return{left:function(C,D,F,H){for(arguments.length<3&&(F=0),arguments.length<4&&(H=C.length);F<H;){var ae=F+H>>>1;ce(C[ae],D)<0?F=ae+1:H=ae}return F},right:function(C,D,F,H){for(arguments.length<3&&(F=0),arguments.length<4&&(H=C.length);F<H;){var ae=F+H>>>1;ce(C[ae],D)>0?H=ae:F=ae+1}return F}}}g.ascending=i,g.descending=function(ce,C){return C<ce?-1:C>ce?1:C>=ce?0:NaN},g.min=function(ce,C){var D,F,H=-1,ae=ce.length;if(1===arguments.length){for(;++H<ae;)if(null!=(F=ce[H])&&F>=F){D=F;break}for(;++H<ae;)null!=(F=ce[H])&&D>F&&(D=F)}else{for(;++H<ae;)if(null!=(F=C.call(ce,ce[H],H))&&F>=F){D=F;break}for(;++H<ae;)null!=(F=C.call(ce,ce[H],H))&&D>F&&(D=F)}return D},g.max=function(ce,C){var D,F,H=-1,ae=ce.length;if(1===arguments.length){for(;++H<ae;)if(null!=(F=ce[H])&&F>=F){D=F;break}for(;++H<ae;)null!=(F=ce[H])&&F>D&&(D=F)}else{for(;++H<ae;)if(null!=(F=C.call(ce,ce[H],H))&&F>=F){D=F;break}for(;++H<ae;)null!=(F=C.call(ce,ce[H],H))&&F>D&&(D=F)}return D},g.extent=function(ce,C){var D,F,H,ae=-1,ue=ce.length;if(1===arguments.length){for(;++ae<ue;)if(null!=(F=ce[ae])&&F>=F){D=H=F;break}for(;++ae<ue;)null!=(F=ce[ae])&&(D>F&&(D=F),H<F&&(H=F))}else{for(;++ae<ue;)if(null!=(F=C.call(ce,ce[ae],ae))&&F>=F){D=H=F;break}for(;++ae<ue;)null!=(F=C.call(ce,ce[ae],ae))&&(D>F&&(D=F),H<F&&(H=F))}return[D,H]},g.sum=function(ce,C){var D,F=0,H=ce.length,ae=-1;if(1===arguments.length)for(;++ae<H;)f(D=+ce[ae])&&(F+=D);else for(;++ae<H;)f(D=+C.call(ce,ce[ae],ae))&&(F+=D);return F},g.mean=function(ce,C){var D,F=0,H=ce.length,ae=-1,ue=H;if(1===arguments.length)for(;++ae<H;)f(D=u(ce[ae]))?F+=D:--ue;else for(;++ae<H;)f(D=u(C.call(ce,ce[ae],ae)))?F+=D:--ue;if(ue)return F/ue},g.quantile=function(ce,C){var D=(ce.length-1)*C+1,F=Math.floor(D),H=+ce[F-1],ae=D-F;return ae?H+ae*(ce[F]-H):H},g.median=function(ce,C){var D,F=[],H=ce.length,ae=-1;if(1===arguments.length)for(;++ae<H;)f(D=u(ce[ae]))&&F.push(D);else for(;++ae<H;)f(D=u(C.call(ce,ce[ae],ae)))&&F.push(D);if(F.length)return g.quantile(F.sort(i),.5)},g.variance=function(ce,C){var D,F,H=ce.length,ae=0,ue=0,me=-1,be=0;if(1===arguments.length)for(;++me<H;)f(D=u(ce[me]))&&(ue+=(F=D-ae)*(D-(ae+=F/++be)));else for(;++me<H;)f(D=u(C.call(ce,ce[me],me)))&&(ue+=(F=D-ae)*(D-(ae+=F/++be)));if(be>1)return ue/(be-1)},g.deviation=function(){var ce=g.variance.apply(this,arguments);return ce&&Math.sqrt(ce)};var h=c(i);function p(ce){return ce.length}g.bisectLeft=h.left,g.bisect=g.bisectRight=h.right,g.bisector=function(ce){return c(1===ce.length?function(C,D){return i(ce(C),D)}:ce)},g.shuffle=function(ce,C,D){(ae=arguments.length)<3&&(D=ce.length,ae<2&&(C=0));for(var F,H,ae=D-C;ae;)H=Math.random()*ae--|0,F=ce[ae+C],ce[ae+C]=ce[H+C],ce[H+C]=F;return ce},g.permute=function(ce,C){for(var D=C.length,F=new Array(D);D--;)F[D]=ce[C[D]];return F},g.pairs=function(ce){for(var C=0,D=ce.length-1,F=ce[0],H=new Array(D<0?0:D);C<D;)H[C]=[F,F=ce[++C]];return H},g.transpose=function(ce){if(!(H=ce.length))return[];for(var C=-1,D=g.min(ce,p),F=new Array(D);++C<D;)for(var H,ae=-1,ue=F[C]=new Array(H);++ae<H;)ue[ae]=ce[ae][C];return F},g.zip=function(){return g.transpose(arguments)},g.keys=function(ce){var C=[];for(var D in ce)C.push(D);return C},g.values=function(ce){var C=[];for(var D in ce)C.push(ce[D]);return C},g.entries=function(ce){var C=[];for(var D in ce)C.push({key:D,value:ce[D]});return C},g.merge=function(ce){for(var C,D,F,H=ce.length,ae=-1,ue=0;++ae<H;)ue+=ce[ae].length;for(D=new Array(ue);--H>=0;)for(C=(F=ce[H]).length;--C>=0;)D[--ue]=F[C];return D};var o=Math.abs;function b(ce){for(var C=1;ce*C%1;)C*=10;return C}function l(ce,C){for(var D in C)Object.defineProperty(ce.prototype,D,{value:C[D],enumerable:!1})}function T(){this._=Object.create(null)}function _(ce){return"__proto__"==(ce+="")||"\0"===ce[0]?"\0"+ce:ce}function w(ce){return"\0"===(ce+="")[0]?ce.slice(1):ce}function k(ce){return _(ce)in this._}function L(ce){return(ce=_(ce))in this._&&delete this._[ce]}function M(){var ce=[];for(var C in this._)ce.push(w(C));return ce}function I(){var ce=0;for(var C in this._)++ce;return ce}function P(){for(var ce in this._)return!1;return!0}function S(){this._=Object.create(null)}function E(ce){return ce}function z(ce,C,D){return function(){var F=D.apply(C,arguments);return F===C?ce:F}}function R(ce,C){if(C in ce)return C;C=C.charAt(0).toUpperCase()+C.slice(1);for(var D=0,F=q.length;D<F;++D){var H=q[D]+C;if(H in ce)return H}}g.range=function(ce,C,D){if(arguments.length<3&&(D=1,arguments.length<2&&(C=ce,ce=0)),(C-ce)/D==1/0)throw new Error("infinite range");var F,H=[],ae=b(o(D)),ue=-1;if(ce*=ae,C*=ae,(D*=ae)<0)for(;(F=ce+D*++ue)>C;)H.push(F/ae);else for(;(F=ce+D*++ue)<C;)H.push(F/ae);return H},g.map=function(ce,C){var D=new T;if(ce instanceof T)ce.forEach(function(me,be){D.set(me,be)});else if(Array.isArray(ce)){var F,H=-1,ae=ce.length;if(1===arguments.length)for(;++H<ae;)D.set(H,ce[H]);else for(;++H<ae;)D.set(C.call(ce,F=ce[H],H),F)}else for(var ue in ce)D.set(ue,ce[ue]);return D},l(T,{has:k,get:function(ce){return this._[_(ce)]},set:function(ce,C){return this._[_(ce)]=C},remove:L,keys:M,values:function(){var ce=[];for(var C in this._)ce.push(this._[C]);return ce},entries:function(){var ce=[];for(var C in this._)ce.push({key:w(C),value:this._[C]});return ce},size:I,empty:P,forEach:function(ce){for(var C in this._)ce.call(this,w(C),this._[C])}}),g.nest=function(){var ce,C,D={},F=[],H=[];function ae(ue,me,be){if(be>=F.length)return C?C.call(D,me):ce?me.sort(ce):me;for(var Le,qe,Qe,at,_t=-1,Et=me.length,Tt=F[be++],Mt=new T;++_t<Et;)(at=Mt.get(Le=Tt(qe=me[_t])))?at.push(qe):Mt.set(Le,[qe]);return ue?(qe=ue(),Qe=function(bt,Dt){qe.set(bt,ae(ue,Dt,be))}):(qe={},Qe=function(bt,Dt){qe[bt]=ae(ue,Dt,be)}),Mt.forEach(Qe),qe}return D.map=function(ue,me){return ae(me,ue,0)},D.entries=function(ue){return function me(be,Le){if(Le>=F.length)return be;var qe=[],Qe=H[Le++];return be.forEach(function(at,_t){qe.push({key:at,values:me(_t,Le)})}),Qe?qe.sort(function(at,_t){return Qe(at.key,_t.key)}):qe}(ae(g.map,ue,0),0)},D.key=function(ue){return F.push(ue),D},D.sortKeys=function(ue){return H[F.length-1]=ue,D},D.sortValues=function(ue){return ce=ue,D},D.rollup=function(ue){return C=ue,D},D},g.set=function(ce){var C=new S;if(ce)for(var D=0,F=ce.length;D<F;++D)C.add(ce[D]);return C},l(S,{has:k,add:function(ce){return this._[_(ce+="")]=!0,ce},remove:L,values:M,size:I,empty:P,forEach:function(ce){for(var C in this._)ce.call(this,w(C))}}),g.behavior={},g.rebind=function(ce,C){for(var D,F=1,H=arguments.length;++F<H;)ce[D=arguments[F]]=z(ce,C,C[D]);return ce};var q=["webkit","ms","moz","Moz","o","O"];function V(){}function W(){}function K(ce){var C=[],D=new T;function F(){for(var H,ae=C,ue=-1,me=ae.length;++ue<me;)(H=ae[ue].on)&&H.apply(this,arguments);return ce}return F.on=function(H,ae){var ue,me=D.get(H);return arguments.length<2?me&&me.on:(me&&(me.on=null,C=C.slice(0,ue=C.indexOf(me)).concat(C.slice(ue+1)),D.remove(H)),ae&&C.push(D.set(H,{on:ae})),ce)},F}function G(){g.event.preventDefault()}function Y(){for(var ce,C=g.event;ce=C.sourceEvent;)C=ce;return C}function $(ce){for(var C=new W,D=0,F=arguments.length;++D<F;)C[arguments[D]]=K(C);return C.of=function(H,ae){return function(ue){try{var me=ue.sourceEvent=g.event;ue.target=ce,g.event=ue,C[ue.type].apply(H,ae)}finally{g.event=me}}},C}g.dispatch=function(){for(var ce=new W,C=-1,D=arguments.length;++C<D;)ce[arguments[C]]=K(ce);return ce},W.prototype.on=function(ce,C){var D=ce.indexOf("."),F="";if(D>=0&&(F=ce.slice(D+1),ce=ce.slice(0,D)),ce)return arguments.length<2?this[ce].on(F):this[ce].on(F,C);if(2===arguments.length){if(null==C)for(ce in this)this.hasOwnProperty(ce)&&this[ce].on(F,null);return this}},g.event=null,g.requote=function(ce){return ce.replace(B,"\\$&")};var B=/[\\\^\$\*\+\?\|\[\]\(\)\.\{\}]/g,N={}.__proto__?function(ce,C){ce.__proto__=C}:function(ce,C){for(var D in C)ce[D]=C[D]};function U(ce){return N(ce,X),ce}var te=function(ce,C){return C.querySelector(ce)},j=function(ce,C){return C.querySelectorAll(ce)},J=function(ce,C){var D=ce.matches||ce[R(ce,"matchesSelector")];return(J=function(F,H){return D.call(F,H)})(ce,C)};"function"==typeof Sizzle&&(te=function(ce,C){return Sizzle(ce,C)[0]||null},j=Sizzle,J=Sizzle.matchesSelector),g.selection=function(){return g.select(x.documentElement)};var X=g.selection.prototype=[];function re(ce){return"function"==typeof ce?ce:function(){return te(ce,this)}}function ne(ce){return"function"==typeof ce?ce:function(){return j(ce,this)}}X.select=function(ce){var C,D,F,H,ae=[];ce=re(ce);for(var ue=-1,me=this.length;++ue<me;){ae.push(C=[]),C.parentNode=(F=this[ue]).parentNode;for(var be=-1,Le=F.length;++be<Le;)(H=F[be])?(C.push(D=ce.call(H,H.__data__,be,ue)),D&&"__data__"in H&&(D.__data__=H.__data__)):C.push(null)}return U(ae)},X.selectAll=function(ce){var C,D,F=[];ce=ne(ce);for(var H=-1,ae=this.length;++H<ae;)for(var ue=this[H],me=-1,be=ue.length;++me<be;)(D=ue[me])&&(F.push(C=m(ce.call(D,D.__data__,me,H))),C.parentNode=D);return U(F)};var le="http://www.w3.org/1999/xhtml",oe={svg:"http://www.w3.org/2000/svg",xhtml:le,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function de(ce,C){return ce=g.ns.qualify(ce),null==C?ce.local?function(){this.removeAttributeNS(ce.space,ce.local)}:function(){this.removeAttribute(ce)}:"function"==typeof C?ce.local?function(){var D=C.apply(this,arguments);null==D?this.removeAttributeNS(ce.space,ce.local):this.setAttributeNS(ce.space,ce.local,D)}:function(){var D=C.apply(this,arguments);null==D?this.removeAttribute(ce):this.setAttribute(ce,D)}:ce.local?function(){this.setAttributeNS(ce.space,ce.local,C)}:function(){this.setAttribute(ce,C)}}function se(ce){return ce.trim().replace(/\s+/g," ")}function ge(ce){return new RegExp("(?:^|\\s+)"+g.requote(ce)+"(?:\\s+|$)","g")}function _e(ce){return(ce+"").trim().split(/^|\s+/)}function Te(ce,C){var D=(ce=_e(ce).map(we)).length;return"function"==typeof C?function(){for(var F=-1,H=C.apply(this,arguments);++F<D;)ce[F](this,H)}:function(){for(var F=-1;++F<D;)ce[F](this,C)}}function we(ce){var C=ge(ce);return function(D,F){if(H=D.classList)return F?H.add(ce):H.remove(ce);var H=D.getAttribute("class")||"";F?(C.lastIndex=0,C.test(H)||D.setAttribute("class",se(H+" "+ce))):D.setAttribute("class",se(H.replace(C," ")))}}function Oe(ce,C,D){return null==C?function(){this.style.removeProperty(ce)}:"function"==typeof C?function(){var F=C.apply(this,arguments);null==F?this.style.removeProperty(ce):this.style.setProperty(ce,F,D)}:function(){this.style.setProperty(ce,C,D)}}function fe(ce,C){return null==C?function(){delete this[ce]}:"function"==typeof C?function(){var D=C.apply(this,arguments);null==D?delete this[ce]:this[ce]=D}:function(){this[ce]=C}}function ve(ce){return"function"==typeof ce?ce:(ce=g.ns.qualify(ce)).local?function(){return this.ownerDocument.createElementNS(ce.space,ce.local)}:function(){var C=this.ownerDocument,D=this.namespaceURI;return D===le&&C.documentElement.namespaceURI===le?C.createElement(ce):C.createElementNS(D,ce)}}function Ae(){var ce=this.parentNode;ce&&ce.removeChild(this)}function ke(ce){return{__data__:ce}}function Pe(ce){return function(){return J(this,ce)}}function Ne(ce){return arguments.length||(ce=i),function(C,D){return C&&D?ce(C.__data__,D.__data__):!C-!D}}function De(ce,C){for(var D=0,F=ce.length;D<F;D++)for(var H,ae=ce[D],ue=0,me=ae.length;ue<me;ue++)(H=ae[ue])&&C(H,ue,D);return ce}function ze(ce){return N(ce,Me),ce}g.ns={prefix:oe,qualify:function(ce){var C=ce.indexOf(":"),D=ce;return C>=0&&"xmlns"!==(D=ce.slice(0,C))&&(ce=ce.slice(C+1)),oe.hasOwnProperty(D)?{space:oe[D],local:ce}:ce}},X.attr=function(ce,C){if(arguments.length<2){if("string"==typeof ce){var D=this.node();return(ce=g.ns.qualify(ce)).local?D.getAttributeNS(ce.space,ce.local):D.getAttribute(ce)}for(C in ce)this.each(de(C,ce[C]));return this}return this.each(de(ce,C))},X.classed=function(ce,C){if(arguments.length<2){if("string"==typeof ce){var D=this.node(),F=(ce=_e(ce)).length,H=-1;if(C=D.classList){for(;++H<F;)if(!C.contains(ce[H]))return!1}else for(C=D.getAttribute("class");++H<F;)if(!ge(ce[H]).test(C))return!1;return!0}for(C in ce)this.each(Te(C,ce[C]));return this}return this.each(Te(ce,C))},X.style=function(ce,C,D){var F=arguments.length;if(F<3){if("string"!=typeof ce){for(D in F<2&&(C=""),ce)this.each(Oe(D,ce[D],C));return this}if(F<2){var H=this.node();return n(H).getComputedStyle(H,null).getPropertyValue(ce)}D=""}return this.each(Oe(ce,C,D))},X.property=function(ce,C){if(arguments.length<2){if("string"==typeof ce)return this.node()[ce];for(C in ce)this.each(fe(C,ce[C]));return this}return this.each(fe(ce,C))},X.text=function(ce){return arguments.length?this.each("function"==typeof ce?function(){var C=ce.apply(this,arguments);this.textContent=C??""}:null==ce?function(){this.textContent=""}:function(){this.textContent=ce}):this.node().textContent},X.html=function(ce){return arguments.length?this.each("function"==typeof ce?function(){var C=ce.apply(this,arguments);this.innerHTML=C??""}:null==ce?function(){this.innerHTML=""}:function(){this.innerHTML=ce}):this.node().innerHTML},X.append=function(ce){return ce=ve(ce),this.select(function(){return this.appendChild(ce.apply(this,arguments))})},X.insert=function(ce,C){return ce=ve(ce),C=re(C),this.select(function(){return this.insertBefore(ce.apply(this,arguments),C.apply(this,arguments)||null)})},X.remove=function(){return this.each(Ae)},X.data=function(ce,C){var D,F,H=-1,ae=this.length;if(!arguments.length){for(ce=new Array(ae=(D=this[0]).length);++H<ae;)(F=D[H])&&(ce[H]=F.__data__);return ce}function ue(qe,Qe){var at,_t,Et,Tt=qe.length,Mt=Qe.length,bt=Math.min(Tt,Mt),Dt=new Array(Mt),It=new Array(Mt),Nt=new Array(Tt);if(C){var nr,dr=new T,Sr=new Array(Tt);for(at=-1;++at<Tt;)(_t=qe[at])&&(dr.has(nr=C.call(_t,_t.__data__,at))?Nt[at]=_t:dr.set(nr,_t),Sr[at]=nr);for(at=-1;++at<Mt;)(_t=dr.get(nr=C.call(Qe,Et=Qe[at],at)))?!0!==_t&&(Dt[at]=_t,_t.__data__=Et):It[at]=ke(Et),dr.set(nr,!0);for(at=-1;++at<Tt;)at in Sr&&!0!==dr.get(Sr[at])&&(Nt[at]=qe[at])}else{for(at=-1;++at<bt;)Et=Qe[at],(_t=qe[at])?(_t.__data__=Et,Dt[at]=_t):It[at]=ke(Et);for(;at<Mt;++at)It[at]=ke(Qe[at]);for(;at<Tt;++at)Nt[at]=qe[at]}It.update=Dt,It.parentNode=Dt.parentNode=Nt.parentNode=qe.parentNode,me.push(It),be.push(Dt),Le.push(Nt)}var me=ze([]),be=U([]),Le=U([]);if("function"==typeof ce)for(;++H<ae;)ue(D=this[H],ce.call(D,D.parentNode.__data__,H));else for(;++H<ae;)ue(D=this[H],ce);return be.enter=function(){return me},be.exit=function(){return Le},be},X.datum=function(ce){return arguments.length?this.property("__data__",ce):this.property("__data__")},X.filter=function(ce){var C,D,F,H=[];"function"!=typeof ce&&(ce=Pe(ce));for(var ae=0,ue=this.length;ae<ue;ae++){H.push(C=[]),C.parentNode=(D=this[ae]).parentNode;for(var me=0,be=D.length;me<be;me++)(F=D[me])&&ce.call(F,F.__data__,me,ae)&&C.push(F)}return U(H)},X.order=function(){for(var ce=-1,C=this.length;++ce<C;)for(var D,F=this[ce],H=F.length-1,ae=F[H];--H>=0;)(D=F[H])&&(ae&&ae!==D.nextSibling&&ae.parentNode.insertBefore(D,ae),ae=D);return this},X.sort=function(ce){ce=Ne.apply(this,arguments);for(var C=-1,D=this.length;++C<D;)this[C].sort(ce);return this.order()},X.each=function(ce){return De(this,function(C,D,F){ce.call(C,C.__data__,D,F)})},X.call=function(ce){var C=m(arguments);return ce.apply(C[0]=this,C),this},X.empty=function(){return!this.node()},X.node=function(){for(var ce=0,C=this.length;ce<C;ce++)for(var D=this[ce],F=0,H=D.length;F<H;F++){var ae=D[F];if(ae)return ae}return null},X.size=function(){var ce=0;return De(this,function(){++ce}),ce};var Me=[];function Se(ce){var C,D;return function(F,H,ae){var ue,me=ce[ae].update,be=me.length;for(ae!=D&&(D=ae,C=0),H>=C&&(C=H+1);!(ue=me[C])&&++C<be;);return ue}}function Ie(ce,C,D){var F="__on"+ce,H=ce.indexOf("."),ae=Re;H>0&&(ce=ce.slice(0,H));var ue=Fe.get(ce);function me(){var be=this[F];be&&(this.removeEventListener(ce,be,be.$),delete this[F])}return ue&&(ce=ue,ae=Xe),H?C?function(){var be=ae(C,m(arguments));me.call(this),this.addEventListener(ce,this[F]=be,be.$=D),be._=C}:me:C?V:function(){var be,Le=new RegExp("^__on([^.]+)"+g.requote(ce)+"$");for(var qe in this)if(be=qe.match(Le)){var Qe=this[qe];this.removeEventListener(be[1],Qe,Qe.$),delete this[qe]}}}g.selection.enter=ze,g.selection.enter.prototype=Me,Me.append=X.append,Me.empty=X.empty,Me.node=X.node,Me.call=X.call,Me.size=X.size,Me.select=function(ce){for(var C,D,F,H,ae,ue=[],me=-1,be=this.length;++me<be;){F=(H=this[me]).update,ue.push(C=[]),C.parentNode=H.parentNode;for(var Le=-1,qe=H.length;++Le<qe;)(ae=H[Le])?(C.push(F[Le]=D=ce.call(H.parentNode,ae.__data__,Le,me)),D.__data__=ae.__data__):C.push(null)}return U(ue)},Me.insert=function(ce,C){return arguments.length<2&&(C=Se(this)),X.insert.call(this,ce,C)},g.select=function(ce){var C;return"string"==typeof ce?(C=[te(ce,x)]).parentNode=x.documentElement:(C=[ce]).parentNode=e(ce),U([C])},g.selectAll=function(ce){var C;return"string"==typeof ce?(C=m(j(ce,x))).parentNode=x.documentElement:(C=m(ce)).parentNode=null,U([C])},X.on=function(ce,C,D){var F=arguments.length;if(F<3){if("string"!=typeof ce){for(D in F<2&&(C=!1),ce)this.each(Ie(D,ce[D],C));return this}if(F<2)return(F=this.node()["__on"+ce])&&F._;D=!1}return this.each(Ie(ce,C,D))};var Fe=g.map({mouseenter:"mouseover",mouseleave:"mouseout"});function Re(ce,C){return function(D){var F=g.event;g.event=D,C[0]=this.__data__;try{ce.apply(this,C)}finally{g.event=F}}}function Xe(ce,C){var D=Re(ce,C);return function(F){var H=F.relatedTarget;H&&(H===this||8&H.compareDocumentPosition(this))||D.call(this,F)}}x&&Fe.forEach(function(ce){"on"+ce in x&&Fe.remove(ce)});var nt,ct=0;function xt(ce){var C=".dragsuppress-"+ ++ct,D="click"+C,F=g.select(n(ce)).on("touchmove"+C,G).on("dragstart"+C,G).on("selectstart"+C,G);if(null==nt&&(nt=!("onselectstart"in ce)&&R(ce.style,"userSelect")),nt){var H=e(ce).style,ae=H[nt];H[nt]="none"}return function(ue){if(F.on(C,null),nt&&(H[nt]=ae),ue){var me=function(){F.on(D,null)};F.on(D,function(){G(),me()},!0),setTimeout(me,0)}}}g.mouse=function(ce){return tt(ce,Y())};var dt=this.navigator&&/WebKit/.test(this.navigator.userAgent)?-1:0;function tt(ce,C){C.changedTouches&&(C=C.changedTouches[0]);var D=ce.ownerSVGElement||ce;if(D.createSVGPoint){var F=D.createSVGPoint();if(dt<0){var H=n(ce);if(H.scrollX||H.scrollY){var ae=(D=g.select("body").append("svg").style({position:"absolute",top:0,left:0,margin:0,padding:0,border:"none"},"important"))[0][0].getScreenCTM();dt=!(ae.f||ae.e),D.remove()}}return dt?(F.x=C.pageX,F.y=C.pageY):(F.x=C.clientX,F.y=C.clientY),[(F=F.matrixTransform(ce.getScreenCTM().inverse())).x,F.y]}var ue=ce.getBoundingClientRect();return[C.clientX-ue.left-ce.clientLeft,C.clientY-ue.top-ce.clientTop]}function Ke(){return g.event.changedTouches[0].identifier}g.touch=function(ce,C,D){if(arguments.length<3&&(D=C,C=Y().changedTouches),C)for(var F,H=0,ae=C.length;H<ae;++H)if((F=C[H]).identifier===D)return tt(ce,F)},g.behavior.drag=function(){var ce=$(H,"drag","dragstart","dragend"),C=null,D=ae(V,g.mouse,n,"mousemove","mouseup"),F=ae(Ke,g.touch,E,"touchmove","touchend");function H(){this.on("mousedown.drag",D).on("touchstart.drag",F)}function ae(ue,me,be,Le,qe){return function(){var Qe,at=this,_t=g.event.target.correspondingElement||g.event.target,Et=at.parentNode,Tt=ce.of(at,arguments),Mt=0,bt=ue(),Dt=".drag"+(null==bt?"":"-"+bt),It=g.select(be(_t)).on(Le+Dt,dr).on(qe+Dt,Sr),Nt=xt(_t),nr=me(Et,bt);function dr(){var Ar,Kr,Jr=me(Et,bt);Jr&&(Mt|=(Ar=Jr[0]-nr[0])|(Kr=Jr[1]-nr[1]),nr=Jr,Tt({type:"drag",x:Jr[0]+Qe[0],y:Jr[1]+Qe[1],dx:Ar,dy:Kr}))}function Sr(){me(Et,bt)&&(It.on(Le+Dt,null).on(qe+Dt,null),Nt(Mt),Tt({type:"dragend"}))}Qe=C?[(Qe=C.apply(at,arguments)).x-nr[0],Qe.y-nr[1]]:[0,0],Tt({type:"dragstart"})}}return H.origin=function(ue){return arguments.length?(C=ue,H):C},g.rebind(H,ce,"on")},g.touches=function(ce,C){return arguments.length<2&&(C=Y().touches),C?m(C).map(function(D){var F=tt(ce,D);return F.identifier=D.identifier,F}):[]};var mt=1e-6,Bt=Math.PI,Ut=2*Bt,er=Ut-mt,Wt=Bt/2,rr=Bt/180,Ht=180/Bt;function Ve(ce){return ce>1?Wt:ce<-1?-Wt:Math.asin(ce)}function We(ce){return((ce=Math.exp(ce))+1/ce)/2}var he=Math.SQRT2;g.interpolateZoom=function(ce,C){var D,F,H=ce[0],ae=ce[1],ue=ce[2],Le=C[2],qe=C[0]-H,Qe=C[1]-ae,at=qe*qe+Qe*Qe;if(at<1e-12)F=Math.log(Le/ue)/he,D=function(Dt){return[H+Dt*qe,ae+Dt*Qe,ue*Math.exp(he*Dt*F)]};else{var _t=Math.sqrt(at),Et=(Le*Le-ue*ue+4*at)/(2*ue*2*_t),Tt=(Le*Le-ue*ue-4*at)/(2*Le*2*_t),Mt=Math.log(Math.sqrt(Et*Et+1)-Et),bt=Math.log(Math.sqrt(Tt*Tt+1)-Tt);F=(bt-Mt)/he,D=function(Dt){var It,Sr,Nt=Dt*F,nr=We(Mt),dr=ue/(2*_t)*(nr*(It=he*Nt+Mt,((It=Math.exp(2*It))-1)/(It+1))-(Sr=Mt,((Sr=Math.exp(Sr))-1/Sr)/2));return[H+dr*qe,ae+dr*Qe,ue*nr/We(he*Nt+Mt)]}}return D.duration=1e3*F,D},g.behavior.zoom=function(){var ce,C,D,F,H,ae,ue,me,be,Le={x:0,y:0,k:1},qe=[960,500],Qe=Ge,at=250,_t=0,Et="mousedown.zoom",Tt="mousemove.zoom",Mt="mouseup.zoom",bt="touchstart.zoom",Dt=$(It,"zoomstart","zoom","zoomend");function It(Gr){Gr.on(Et,an).on(Be+".zoom",Wn).on("dblclick.zoom",ui).on(bt,jn)}function Nt(Gr){return[(Gr[0]-Le.x)/Le.k,(Gr[1]-Le.y)/Le.k]}function nr(Gr){Le.k=Math.max(Qe[0],Math.min(Qe[1],Gr))}function dr(Gr,Tn){var Xn;Le.x+=Gr[0]-(Tn=[(Xn=Tn)[0]*Le.k+Le.x,Xn[1]*Le.k+Le.y])[0],Le.y+=Gr[1]-Tn[1]}function Sr(Gr,Tn,Xn,Hn){Gr.__chart__={x:Le.x,y:Le.y,k:Le.k},nr(Math.pow(2,Hn)),dr(C=Tn,Xn),Gr=g.select(Gr),at>0&&(Gr=Gr.transition().duration(at)),Gr.call(It.event)}function Ar(){ue&&ue.domain(ae.range().map(function(Gr){return(Gr-Le.x)/Le.k}).map(ae.invert)),be&&be.domain(me.range().map(function(Gr){return(Gr-Le.y)/Le.k}).map(me.invert))}function Kr(Gr){_t++||Gr({type:"zoomstart"})}function Jr(Gr){Ar(),Gr({type:"zoom",scale:Le.k,translate:[Le.x,Le.y]})}function cn(Gr){--_t||(Gr({type:"zoomend"}),C=null)}function an(){var Gr=this,Tn=Dt.of(Gr,arguments),Xn=0,Hn=g.select(n(Gr)).on(Tt,Si).on(Mt,$n),ni=Nt(g.mouse(Gr)),hi=xt(Gr);function Si(){Xn=1,dr(g.mouse(Gr),ni),Jr(Tn)}function $n(){Hn.on(Tt,null).on(Mt,null),hi(Xn),cn(Tn)}_s.call(Gr),Kr(Tn)}function jn(){var Gr,Tn=this,Xn=Dt.of(Tn,arguments),Hn={},ni=0,hi=".zoom-"+g.event.changedTouches[0].identifier,Si="touchmove"+hi,$n="touchend"+hi,xi=[],mi=g.select(Tn),Ci=xt(Tn);function bi(){var Ca=g.touches(Tn);return Gr=Le.k,Ca.forEach(function(Pa){Pa.identifier in Hn&&(Hn[Pa.identifier]=Nt(Pa))}),Ca}function Pi(){var Ca=g.event.target;g.select(Ca).on(Si,Ui).on($n,ca),xi.push(Ca);for(var Pa=g.event.changedTouches,la=0,Ta=Pa.length;la<Ta;++la)Hn[Pa[la].identifier]=null;var ga=bi(),vo=Date.now();if(1===ga.length){if(vo-H<500){var qa=ga[0];Sr(Tn,qa,Hn[qa.identifier],Math.floor(Math.log(Le.k)/Math.LN2)+1),G()}H=vo}else if(ga.length>1){var Oo=ga[1],ms=(qa=ga[0])[0]-Oo[0],Rs=qa[1]-Oo[1];ni=ms*ms+Rs*Rs}}function Ui(){var Ca,Pa,la,Ta,ga=g.touches(Tn);_s.call(Tn);for(var vo=0,qa=ga.length;vo<qa;++vo,Ta=null)if(Ta=Hn[(la=ga[vo]).identifier]){if(Pa)break;Ca=la,Pa=Ta}if(Ta){var Oo=(Oo=la[0]-Ca[0])*Oo+(Oo=la[1]-Ca[1])*Oo,ms=ni&&Math.sqrt(Oo/ni);Ca=[(Ca[0]+la[0])/2,(Ca[1]+la[1])/2],Pa=[(Pa[0]+Ta[0])/2,(Pa[1]+Ta[1])/2],nr(ms*Gr)}H=null,dr(Ca,Pa),Jr(Xn)}function ca(){if(g.event.touches.length){for(var Ca=g.event.changedTouches,Pa=0,la=Ca.length;Pa<la;++Pa)delete Hn[Ca[Pa].identifier];for(var Ta in Hn)return void bi()}g.selectAll(xi).on(hi,null),mi.on(Et,an).on(bt,jn),Ci(),cn(Xn)}Pi(),Kr(Xn),mi.on(Et,null).on(bt,Pi)}function Wn(){var Gr=Dt.of(this,arguments);F?clearTimeout(F):(_s.call(this),ce=Nt(C=D||g.mouse(this)),Kr(Gr)),F=setTimeout(function(){F=null,cn(Gr)},50),G(),nr(Math.pow(2,.002*ye())*Le.k),dr(C,ce),Jr(Gr)}function ui(){var Gr=g.mouse(this),Tn=Math.log(Le.k)/Math.LN2;Sr(this,Gr,Nt(Gr),g.event.shiftKey?Math.ceil(Tn)-1:Math.floor(Tn)+1)}return Be||(Be="onwheel"in x?(ye=function(){return-g.event.deltaY*(g.event.deltaMode?120:1)},"wheel"):"onmousewheel"in x?(ye=function(){return g.event.wheelDelta},"mousewheel"):(ye=function(){return-g.event.detail},"MozMousePixelScroll")),It.event=function(Gr){Gr.each(function(){var Tn=Dt.of(this,arguments),Xn=Le;us?g.select(this).transition().each("start.zoom",function(){Le=this.__chart__||{x:0,y:0,k:1},Kr(Tn)}).tween("zoom:zoom",function(){var Hn=qe[0],hi=C?C[0]:Hn/2,Si=C?C[1]:qe[1]/2,$n=g.interpolateZoom([(hi-Le.x)/Le.k,(Si-Le.y)/Le.k,Hn/Le.k],[(hi-Xn.x)/Xn.k,(Si-Xn.y)/Xn.k,Hn/Xn.k]);return function(xi){var mi=$n(xi),Ci=Hn/mi[2];this.__chart__=Le={x:hi-mi[0]*Ci,y:Si-mi[1]*Ci,k:Ci},Jr(Tn)}}).each("interrupt.zoom",function(){cn(Tn)}).each("end.zoom",function(){cn(Tn)}):(this.__chart__=Le,Kr(Tn),Jr(Tn),cn(Tn))})},It.translate=function(Gr){return arguments.length?(Le={x:+Gr[0],y:+Gr[1],k:Le.k},Ar(),It):[Le.x,Le.y]},It.scale=function(Gr){return arguments.length?(Le={x:Le.x,y:Le.y,k:null},nr(+Gr),Ar(),It):Le.k},It.scaleExtent=function(Gr){return arguments.length?(Qe=null==Gr?Ge:[+Gr[0],+Gr[1]],It):Qe},It.center=function(Gr){return arguments.length?(D=Gr&&[+Gr[0],+Gr[1]],It):D},It.size=function(Gr){return arguments.length?(qe=Gr&&[+Gr[0],+Gr[1]],It):qe},It.duration=function(Gr){return arguments.length?(at=+Gr,It):at},It.x=function(Gr){return arguments.length?(ue=Gr,ae=Gr.copy(),Le={x:0,y:0,k:1},It):ue},It.y=function(Gr){return arguments.length?(be=Gr,me=Gr.copy(),Le={x:0,y:0,k:1},It):be},g.rebind(It,Dt,"on")};var ye,Be,Ge=[0,1/0];function Je(){}function He(ce,C,D){return this instanceof He?(this.h=+ce,this.s=+C,void(this.l=+D)):arguments.length<2?ce instanceof He?new He(ce.h,ce.s,ce.l):kr(""+ce,ur,He):new He(ce,C,D)}g.color=Je,Je.prototype.toString=function(){return this.rgb()+""},g.hsl=He;var st=He.prototype=new Je;function ot(ce,C,D){var F,H;function ae(ue){return Math.round(255*((me=ue)>360?me-=360:me<0&&(me+=360),me<60?F+(H-F)*me/60:me<180?H:me<240?F+(H-F)*(240-me)/60:F));var me}return ce=isNaN(ce)?0:(ce%=360)<0?ce+360:ce,C=isNaN(C)||C<0?0:C>1?1:C,F=2*(D=D<0?0:D>1?1:D)-(H=D<=.5?D*(1+C):D+C-D*C),new At(ae(ce+120),ae(ce),ae(ce-120))}function wt(ce,C,D){return this instanceof wt?(this.h=+ce,this.c=+C,void(this.l=+D)):arguments.length<2?ce instanceof wt?new wt(ce.h,ce.c,ce.l):Ee(ce instanceof ft?ce.l:(ce=Jt((ce=g.rgb(ce)).r,ce.g,ce.b)).l,ce.a,ce.b):new wt(ce,C,D)}st.brighter=function(ce){return ce=Math.pow(.7,arguments.length?ce:1),new He(this.h,this.s,this.l/ce)},st.darker=function(ce){return ce=Math.pow(.7,arguments.length?ce:1),new He(this.h,this.s,ce*this.l)},st.rgb=function(){return ot(this.h,this.s,this.l)},g.hcl=wt;var Ct=wt.prototype=new Je;function rt(ce,C,D){return isNaN(ce)&&(ce=0),isNaN(C)&&(C=0),new ft(D,Math.cos(ce*=rr)*C,Math.sin(ce)*C)}function ft(ce,C,D){return this instanceof ft?(this.l=+ce,this.a=+C,void(this.b=+D)):arguments.length<2?ce instanceof ft?new ft(ce.l,ce.a,ce.b):ce instanceof wt?rt(ce.h,ce.c,ce.l):Jt((ce=At(ce)).r,ce.g,ce.b):new ft(ce,C,D)}Ct.brighter=function(ce){return new wt(this.h,this.c,Math.min(100,this.l+Rt*(arguments.length?ce:1)))},Ct.darker=function(ce){return new wt(this.h,this.c,Math.max(0,this.l-Rt*(arguments.length?ce:1)))},Ct.rgb=function(){return rt(this.h,this.c,this.l).rgb()},g.lab=ft;var Rt=18,kt=ft.prototype=new Je;function Lt(ce,C,D){var F=(ce+16)/116,H=F+C/500,ae=F-D/200;return new At(ht(3.2404542*(H=.95047*Ye(H))-1.5371385*(F=1*Ye(F))-.4985314*(ae=1.08883*Ye(ae))),ht(-.969266*H+1.8760108*F+.041556*ae),ht(.0556434*H-.2040259*F+1.0572252*ae))}function Ee(ce,C,D){return ce>0?new wt(Math.atan2(D,C)*Ht,Math.sqrt(C*C+D*D),ce):new wt(NaN,NaN,ce)}function Ye(ce){return ce>.206893034?ce*ce*ce:(ce-4/29)/7.787037}function it(ce){return ce>.008856?Math.pow(ce,1/3):7.787037*ce+4/29}function ht(ce){return Math.round(255*(ce<=.00304?12.92*ce:1.055*Math.pow(ce,1/2.4)-.055))}function At(ce,C,D){return this instanceof At?(this.r=~~ce,this.g=~~C,void(this.b=~~D)):arguments.length<2?ce instanceof At?new At(ce.r,ce.g,ce.b):kr(""+ce,At,ot):new At(ce,C,D)}function Ft(ce){return new At(ce>>16,ce>>8&255,255&ce)}function Gt(ce){return Ft(ce)+""}kt.brighter=function(ce){return new ft(Math.min(100,this.l+Rt*(arguments.length?ce:1)),this.a,this.b)},kt.darker=function(ce){return new ft(Math.max(0,this.l-Rt*(arguments.length?ce:1)),this.a,this.b)},kt.rgb=function(){return Lt(this.l,this.a,this.b)},g.rgb=At;var jt=At.prototype=new Je;function fr(ce){return ce<16?"0"+Math.max(0,ce).toString(16):Math.min(255,ce).toString(16)}function kr(ce,C,D){var F,H,ae,ue=0,me=0,be=0;if(F=/([a-z]+)\((.*)\)/.exec(ce=ce.toLowerCase()))switch(H=F[2].split(","),F[1]){case"hsl":return D(parseFloat(H[0]),parseFloat(H[1])/100,parseFloat(H[2])/100);case"rgb":return C(Qt(H[0]),Qt(H[1]),Qt(H[2]))}return(ae=cr.get(ce))?C(ae.r,ae.g,ae.b):(null==ce||"#"!==ce.charAt(0)||isNaN(ae=parseInt(ce.slice(1),16))||(4===ce.length?(ue=(3840&ae)>>4,ue|=ue>>4,me=240&ae,me|=me>>4,be=15&ae,be|=be<<4):7===ce.length&&(ue=(16711680&ae)>>16,me=(65280&ae)>>8,be=255&ae)),C(ue,me,be))}function ur(ce,C,D){var F,H,ae=Math.min(ce/=255,C/=255,D/=255),ue=Math.max(ce,C,D),me=ue-ae,be=(ue+ae)/2;return me?(H=be<.5?me/(ue+ae):me/(2-ue-ae),F=ce==ue?(C-D)/me+(C<D?6:0):C==ue?(D-ce)/me+2:(ce-C)/me+4,F*=60):(F=NaN,H=be>0&&be<1?0:F),new He(F,H,be)}function Jt(ce,C,D){var F=it((.4124564*(ce=$t(ce))+.3575761*(C=$t(C))+.1804375*(D=$t(D)))/.95047),H=it((.2126729*ce+.7151522*C+.072175*D)/1);return ft(116*H-16,500*(F-H),200*(H-it((.0193339*ce+.119192*C+.9503041*D)/1.08883)))}function $t(ce){return(ce/=255)<=.04045?ce/12.92:Math.pow((ce+.055)/1.055,2.4)}function Qt(ce){var C=parseFloat(ce);return"%"===ce.charAt(ce.length-1)?Math.round(2.55*C):C}jt.brighter=function(ce){ce=Math.pow(.7,arguments.length?ce:1);var C=this.r,D=this.g,F=this.b,H=30;return C||D||F?(C&&C<H&&(C=H),D&&D<H&&(D=H),F&&F<H&&(F=H),new At(Math.min(255,C/ce),Math.min(255,D/ce),Math.min(255,F/ce))):new At(H,H,H)},jt.darker=function(ce){return new At((ce=Math.pow(.7,arguments.length?ce:1))*this.r,ce*this.g,ce*this.b)},jt.hsl=function(){return ur(this.r,this.g,this.b)},jt.toString=function(){return"#"+fr(this.r)+fr(this.g)+fr(this.b)};var cr=g.map({aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074});function gr(ce){return"function"==typeof ce?ce:function(){return ce}}function Tr(ce){return function(C,D,F){return 2===arguments.length&&"function"==typeof D&&(F=D,D=null),Fr(C,D,ce,F)}}function Fr(ce,C,D,F){var qe,H={},ae=g.dispatch("beforesend","progress","load","error"),ue={},me=new XMLHttpRequest,be=null;function Le(){var qe,at,_t,Qe=me.status;if(!Qe&&((_t=(at=me).responseType)&&"text"!==_t?at.response:at.responseText)||Qe>=200&&Qe<300||304===Qe){try{qe=D.call(H,me)}catch(at){return void ae.error.call(H,at)}ae.load.call(H,qe)}else ae.error.call(H,me)}return self.XDomainRequest&&!("withCredentials"in me)&&/^(http(s)?:)?\/\//.test(ce)&&(me=new XDomainRequest),"onload"in me?me.onload=me.onerror=Le:me.onreadystatechange=function(){me.readyState>3&&Le()},me.onprogress=function(qe){var Qe=g.event;g.event=qe;try{ae.progress.call(H,me)}finally{g.event=Qe}},H.header=function(qe,Qe){return qe=(qe+"").toLowerCase(),arguments.length<2?ue[qe]:(null==Qe?delete ue[qe]:ue[qe]=Qe+"",H)},H.mimeType=function(qe){return arguments.length?(C=null==qe?null:qe+"",H):C},H.responseType=function(qe){return arguments.length?(be=qe,H):be},H.response=function(qe){return D=qe,H},["get","post"].forEach(function(qe){H[qe]=function(){return H.send.apply(H,[qe].concat(m(arguments)))}}),H.send=function(qe,Qe,at){if(2===arguments.length&&"function"==typeof Qe&&(at=Qe,Qe=null),me.open(qe,ce,!0),null==C||"accept"in ue||(ue.accept=C+",*/*"),me.setRequestHeader)for(var _t in ue)me.setRequestHeader(_t,ue[_t]);return null!=C&&me.overrideMimeType&&me.overrideMimeType(C),null!=be&&(me.responseType=be),null!=at&&H.on("error",at).on("load",function(Et){at(null,Et)}),ae.beforesend.call(H,me),me.send(Qe??null),H},H.abort=function(){return me.abort(),H},g.rebind(H,ae,"on"),null==F?H:H.get(1===(qe=F).length?function(Qe,at){qe(null==Qe?at:null)}:qe)}cr.forEach(function(ce,C){cr.set(ce,Ft(C))}),g.functor=gr,g.xhr=Tr(E),g.dsv=function(ce,C){var D=new RegExp('["'+ce+"\n]"),F=ce.charCodeAt(0);function H(Le,qe,Qe){arguments.length<3&&(Qe=qe,qe=null);var at=Fr(Le,C,null==qe?ae:ue(qe),Qe);return at.row=function(_t){return arguments.length?at.response(null==(qe=_t)?ae:ue(_t)):qe},at}function ae(Le){return H.parse(Le.responseText)}function ue(Le){return function(qe){return H.parse(qe.responseText,Le)}}function me(Le){return Le.map(be).join(ce)}function be(Le){return D.test(Le)?'"'+Le.replace(/\"/g,'""')+'"':Le}return H.parse=function(Le,qe){var Qe;return H.parseRows(Le,function(at,_t){if(Qe)return Qe(at,_t-1);var Et=function(Tt){for(var Mt={},bt=at.length,Dt=0;Dt<bt;++Dt)Mt[at[Dt]]=Tt[Dt];return Mt};Qe=qe?function(Tt,Mt){return qe(Et(Tt),Mt)}:Et})},H.parseRows=function(Le,qe){var Qe,at,_t={},Et={},Tt=[],Mt=Le.length,bt=0,Dt=0;function It(){if(bt>=Mt)return Et;if(at)return at=!1,_t;var nr=bt;if(34===Le.charCodeAt(nr)){for(var dr=nr;dr++<Mt;)if(34===Le.charCodeAt(dr)){if(34!==Le.charCodeAt(dr+1))break;++dr}return bt=dr+2,13===(Sr=Le.charCodeAt(dr+1))?(at=!0,10===Le.charCodeAt(dr+2)&&++bt):10===Sr&&(at=!0),Le.slice(nr+1,dr).replace(/""/g,'"')}for(;bt<Mt;){var Sr,Ar=1;if(10===(Sr=Le.charCodeAt(bt++)))at=!0;else if(13===Sr)at=!0,10===Le.charCodeAt(bt)&&(++bt,++Ar);else if(Sr!==F)continue;return Le.slice(nr,bt-Ar)}return Le.slice(nr)}for(;(Qe=It())!==Et;){for(var Nt=[];Qe!==_t&&Qe!==Et;)Nt.push(Qe),Qe=It();qe&&null==(Nt=qe(Nt,Dt++))||Tt.push(Nt)}return Tt},H.format=function(Le){if(Array.isArray(Le[0]))return H.formatRows(Le);var qe=new S,Qe=[];return Le.forEach(function(at){for(var _t in at)qe.has(_t)||Qe.push(qe.add(_t))}),[Qe.map(be).join(ce)].concat(Le.map(function(at){return Qe.map(function(_t){return be(at[_t])}).join(ce)})).join("\n")},H.formatRows=function(Le){return Le.map(me).join("\n")},H},g.csv=g.dsv(",","text/csv"),g.tsv=g.dsv("\t","text/tab-separated-values");var Nr,Xr,un,$r,Pn=this[R(this,"requestAnimationFrame")]||function(ce){setTimeout(ce,17)};function gn(ce,C,D){var F=arguments.length;F<2&&(C=0),F<3&&(D=Date.now());var ae={c:ce,t:D+C,n:null};return Xr?Xr.n=ae:Nr=ae,Xr=ae,un||($r=clearTimeout($r),un=1,Pn(dn)),ae}function dn(){var ce=An(),C=Zn()-ce;C>24?(isFinite(C)&&(clearTimeout($r),$r=setTimeout(dn,C)),un=0):(un=1,Pn(dn))}function An(){for(var ce=Date.now(),C=Nr;C;)ce>=C.t&&C.c(ce-C.t)&&(C.c=null),C=C.n;return ce}function Zn(){for(var ce,C=Nr,D=1/0;C;)C.c?(C.t<D&&(D=C.t),C=(ce=C).n):C=ce?ce.n=C.n:Nr=C.n;return Xr=ce,D}function Rr(ce){return ce[0]}function hn(ce){return ce[1]}function nn(ce){for(var C,D,F,H=ce.length,ae=[0,1],ue=2,me=2;me<H;me++){for(;ue>1&&((D=ce[ae[ue-1]])[0]-(C=ce[ae[ue-2]])[0])*((F=ce[me])[1]-C[1])-(D[1]-C[1])*(F[0]-C[0])<=0;)--ue;ae[ue++]=me}return ae.slice(0,ue)}function Hr(ce,C){return ce[0]-C[0]||ce[1]-C[1]}g.timer=function(){gn.apply(this,arguments)},g.timer.flush=function(){An(),Zn()},g.round=function(ce,C){return C?Math.round(ce*(C=Math.pow(10,C)))/C:Math.round(ce)},g.geom={},g.geom.hull=function(ce){var C=Rr,D=hn;if(arguments.length)return F(ce);function F(H){if(H.length<3)return[];var ae,ue=gr(C),me=gr(D),be=H.length,Le=[],qe=[];for(ae=0;ae<be;ae++)Le.push([+ue.call(this,H[ae],ae),+me.call(this,H[ae],ae),ae]);for(Le.sort(Hr),ae=0;ae<be;ae++)qe.push([Le[ae][0],-Le[ae][1]]);var Qe=nn(Le),at=nn(qe),_t=at[0]===Qe[0],Et=at[at.length-1]===Qe[Qe.length-1],Tt=[];for(ae=Qe.length-1;ae>=0;--ae)Tt.push(H[Le[Qe[ae]][2]]);for(ae=+_t;ae<at.length-Et;++ae)Tt.push(H[Le[at[ae]][2]]);return Tt}return F.x=function(H){return arguments.length?(C=H,F):C},F.y=function(H){return arguments.length?(D=H,F):D},F},g.geom.polygon=function(ce){return N(ce,Fn),ce};var Fn=g.geom.polygon.prototype=[];function Un(ce,C,D){return(D[0]-C[0])*(ce[1]-C[1])<(D[1]-C[1])*(ce[0]-C[0])}function vn(ce,C,D,F){var H=ce[0],ae=D[0],ue=C[0]-H,me=F[0]-ae,be=ce[1],Le=D[1],qe=C[1]-be,Qe=F[1]-Le,at=(me*(be-Le)-Qe*(H-ae))/(Qe*ue-me*qe);return[H+at*ue,be+at*qe]}function Cn(ce){var C=ce[0],D=ce[ce.length-1];return!(C[0]-D[0]||C[1]-D[1])}Fn.area=function(){for(var ce,C=-1,D=this.length,F=this[D-1],H=0;++C<D;)H+=(ce=F)[1]*(F=this[C])[0]-ce[0]*F[1];return.5*H},Fn.centroid=function(ce){var C,D,F=-1,H=this.length,ae=0,ue=0,me=this[H-1];for(arguments.length||(ce=-1/(6*this.area()));++F<H;)ae+=((C=me)[0]+(me=this[F])[0])*(D=C[0]*me[1]-me[0]*C[1]),ue+=(C[1]+me[1])*D;return[ae*ce,ue*ce]},Fn.clip=function(ce){for(var C,D,F,H,ae,ue,me=Cn(ce),be=-1,Le=this.length-Cn(this),qe=this[Le-1];++be<Le;){for(C=ce.slice(),ce.length=0,H=this[be],ae=C[(F=C.length-me)-1],D=-1;++D<F;)Un(ue=C[D],qe,H)?(Un(ae,qe,H)||ce.push(vn(ae,ue,qe,H)),ce.push(ue)):Un(ae,qe,H)&&ce.push(vn(ae,ue,qe,H)),ae=ue;me&&ce.push(ce[0]),qe=H}return ce};var li,tr,mr,Pt,or,hr=[],zr=[];function Dr(){kn(this),this.edge=this.site=this.circle=null}function Ir(ce){var C=hr.pop()||new Dr;return C.site=ce,C}function Mr(ce){mn(ce),mr.remove(ce),hr.push(ce),kn(ce)}function vr(ce){var C=ce.circle,D=C.x,F=C.cy,H={x:D,y:F},ae=ce.P,ue=ce.N,me=[ce];Mr(ce);for(var be=ae;be.circle&&o(D-be.circle.x)<mt&&o(F-be.circle.cy)<mt;)ae=be.P,me.unshift(be),Mr(be),be=ae;me.unshift(be),mn(be);for(var Le=ue;Le.circle&&o(D-Le.circle.x)<mt&&o(F-Le.circle.cy)<mt;)ue=Le.N,me.push(Le),Mr(Le),Le=ue;me.push(Le),mn(Le);var qe,Qe=me.length;for(qe=1;qe<Qe;++qe)Yn((Le=me[qe]).edge,(be=me[qe-1]).site,Le.site,H);(Le=me[Qe-1]).edge=Sn((be=me[0]).site,Le.site,null,H),en(be),en(Le)}function xr(ce){for(var C,D,F,H,ae=ce.x,ue=ce.y,me=mr._;me;)if((F=wr(me,ue)-ae)>mt)me=me.L;else{if(!((H=ae-Er(me,ue))>mt)){F>-mt?(C=me.P,D=me):H>-mt?(C=me,D=me.N):C=D=me;break}if(!me.R){C=me;break}me=me.R}var be=Ir(ce);if(mr.insert(C,be),C||D){if(C===D)return mn(C),D=Ir(C.site),mr.insert(be,D),be.edge=D.edge=Sn(C.site,be.site),en(C),void en(D);if(D){mn(C),mn(D);var Le=C.site,qe=Le.x,Qe=Le.y,at=ce.x-qe,_t=ce.y-Qe,Et=D.site,Tt=Et.x-qe,Mt=Et.y-Qe,bt=2*(at*Mt-_t*Tt),Dt=at*at+_t*_t,It=Tt*Tt+Mt*Mt,Nt={x:(Mt*Dt-_t*It)/bt+qe,y:(at*It-Tt*Dt)/bt+Qe};Yn(D.edge,Le,Et,Nt),be.edge=Sn(Le,ce,null,Nt),D.edge=Sn(ce,Et,null,Nt),en(C),en(D)}else be.edge=Sn(C.site,be.site)}}function wr(ce,C){var D=ce.site,F=D.x,H=D.y,ae=H-C;if(!ae)return F;var ue=ce.P;if(!ue)return-1/0;var me=(D=ue.site).x,be=D.y,Le=be-C;if(!Le)return me;var qe=me-F,Qe=1/ae-1/Le,at=qe/Le;return Qe?(-at+Math.sqrt(at*at-2*Qe*(qe*qe/(-2*Le)-be+Le/2+H-ae/2)))/Qe+F:(F+me)/2}function Er(ce,C){var D=ce.N;if(D)return wr(D,C);var F=ce.site;return F.y===C?F.x:1/0}function qr(ce){this.site=ce,this.edges=[]}function Vr(ce,C){return C.angle-ce.angle}function Qr(){kn(this),this.x=this.y=this.arc=this.site=this.cy=null}function en(ce){var C=ce.P,D=ce.N;if(C&&D){var F=C.site,H=ce.site,ae=D.site;if(F!==ae){var ue=H.x,me=H.y,be=F.x-ue,Le=F.y-me,qe=ae.x-ue,Qe=2*(be*(Mt=ae.y-me)-Le*qe);if(!(Qe>=-1e-12)){var at=be*be+Le*Le,_t=qe*qe+Mt*Mt,Et=(Mt*at-Le*_t)/Qe,Tt=(be*_t-qe*at)/Qe,Mt=Tt+me,bt=zr.pop()||new Qr;bt.arc=ce,bt.site=H,bt.x=Et+ue,bt.y=Mt+Math.sqrt(Et*Et+Tt*Tt),bt.cy=Mt,ce.circle=bt;for(var Dt=null,It=or._;It;)if(bt.y<It.y||bt.y===It.y&&bt.x<=It.x){if(!It.L){Dt=It.P;break}It=It.L}else{if(!It.R){Dt=It;break}It=It.R}or.insert(Dt,bt),Dt||(Pt=bt)}}}}function mn(ce){var C=ce.circle;C&&(C.P||(Pt=C.N),or.remove(C),zr.push(C),kn(C),ce.circle=null)}function xn(ce,C){var D=ce.b;if(D)return!0;var F,H,ae=ce.a,ue=C[0][0],me=C[1][0],be=C[0][1],Le=C[1][1],qe=ce.l,Qe=ce.r,at=qe.x,_t=qe.y,Et=Qe.x,Tt=Qe.y,Mt=(at+Et)/2;if(Tt===_t){if(Mt<ue||Mt>=me)return;if(at>Et){if(ae){if(ae.y>=Le)return}else ae={x:Mt,y:be};D={x:Mt,y:Le}}else{if(ae){if(ae.y<be)return}else ae={x:Mt,y:Le};D={x:Mt,y:be}}}else if(H=(_t+Tt)/2-(F=(at-Et)/(Tt-_t))*Mt,F<-1||F>1)if(at>Et){if(ae){if(ae.y>=Le)return}else ae={x:(be-H)/F,y:be};D={x:(Le-H)/F,y:Le}}else{if(ae){if(ae.y<be)return}else ae={x:(Le-H)/F,y:Le};D={x:(be-H)/F,y:be}}else if(_t<Tt){if(ae){if(ae.x>=me)return}else ae={x:ue,y:F*ue+H};D={x:me,y:F*me+H}}else{if(ae){if(ae.x<ue)return}else ae={x:me,y:F*me+H};D={x:ue,y:F*ue+H}}return ce.a=ae,ce.b=D,!0}function bn(ce,C){this.l=ce,this.r=C,this.a=this.b=null}function Sn(ce,C,D,F){var H=new bn(ce,C);return li.push(H),D&&Yn(H,ce,C,D),F&&Yn(H,C,ce,F),tr[ce.i].edges.push(new ki(H,ce,C)),tr[C.i].edges.push(new ki(H,C,ce)),H}function In(ce,C,D){var F=new bn(ce,null);return F.a=C,F.b=D,li.push(F),F}function Yn(ce,C,D,F){ce.a||ce.b?ce.l===D?ce.b=F:ce.a=F:(ce.a=F,ce.l=C,ce.r=D)}function ki(ce,C,D){var F=ce.a,H=ce.b;this.edge=ce,this.site=C,this.angle=D?Math.atan2(D.y-C.y,D.x-C.x):ce.l===C?Math.atan2(H.x-F.x,F.y-H.y):Math.atan2(F.x-H.x,H.y-F.y)}function Ti(){this._=null}function kn(ce){ce.U=ce.C=ce.L=ce.R=ce.P=ce.N=null}function Qn(ce,C){var D=C,F=C.R,H=D.U;H?H.L===D?H.L=F:H.R=F:ce._=F,F.U=H,D.U=F,D.R=F.L,D.R&&(D.R.U=D),F.L=D}function Jn(ce,C){var D=C,F=C.L,H=D.U;H?H.L===D?H.L=F:H.R=F:ce._=F,F.U=H,D.U=F,D.L=F.R,D.L&&(D.L.U=D),F.R=D}function Ii(ce){for(;ce.L;)ce=ce.L;return ce}function ha(ce,C){var D,F,H,ae=ce.sort(Ia).pop();for(li=[],tr=new Array(ce.length),mr=new Ti,or=new Ti;;)if(H=Pt,ae&&(!H||ae.y<H.y||ae.y===H.y&&ae.x<H.x))ae.x===D&&ae.y===F||(tr[ae.i]=new qr(ae),xr(ae),D=ae.x,F=ae.y),ae=ce.pop();else{if(!H)break;vr(H.arc)}C&&(function(me){for(var be,Le,qe,Qe,at,_t=li,Et=(Le=me[0][0],qe=me[0][1],Qe=me[1][0],at=me[1][1],function(Mt){var bt,Dt=Mt.a,It=Mt.b,Nt=Dt.x,nr=Dt.y,dr=0,Sr=1,Ar=It.x-Nt,Kr=It.y-nr;if(bt=Le-Nt,Ar||!(bt>0)){if(bt/=Ar,Ar<0){if(bt<dr)return;bt<Sr&&(Sr=bt)}else if(Ar>0){if(bt>Sr)return;bt>dr&&(dr=bt)}if(bt=Qe-Nt,Ar||!(bt<0)){if(bt/=Ar,Ar<0){if(bt>Sr)return;bt>dr&&(dr=bt)}else if(Ar>0){if(bt<dr)return;bt<Sr&&(Sr=bt)}if(bt=qe-nr,Kr||!(bt>0)){if(bt/=Kr,Kr<0){if(bt<dr)return;bt<Sr&&(Sr=bt)}else if(Kr>0){if(bt>Sr)return;bt>dr&&(dr=bt)}if(bt=at-nr,Kr||!(bt<0)){if(bt/=Kr,Kr<0){if(bt>Sr)return;bt>dr&&(dr=bt)}else if(Kr>0){if(bt<dr)return;bt<Sr&&(Sr=bt)}return dr>0&&(Mt.a={x:Nt+dr*Ar,y:nr+dr*Kr}),Sr<1&&(Mt.b={x:Nt+Sr*Ar,y:nr+Sr*Kr}),Mt}}}}}),Tt=_t.length;Tt--;)(!xn(be=_t[Tt],me)||!Et(be)||o(be.a.x-be.b.x)<mt&&o(be.a.y-be.b.y)<mt)&&(be.a=be.b=null,_t.splice(Tt,1))}(C),function(me){for(var be,Le,qe,Qe,at,_t,Et,Tt,Mt,bt,Dt=me[0][0],It=me[1][0],Nt=me[0][1],nr=me[1][1],dr=tr,Sr=dr.length;Sr--;)if((at=dr[Sr])&&at.prepare())for(Tt=(Et=at.edges).length,_t=0;_t<Tt;)qe=(bt=Et[_t].end()).x,Qe=bt.y,be=(Mt=Et[++_t%Tt].start()).x,Le=Mt.y,(o(qe-be)>mt||o(Qe-Le)>mt)&&(Et.splice(_t,0,new ki(In(at.site,bt,o(qe-Dt)<mt&&nr-Qe>mt?{x:Dt,y:o(be-Dt)<mt?Le:nr}:o(Qe-nr)<mt&&It-qe>mt?{x:o(Le-nr)<mt?be:It,y:nr}:o(qe-It)<mt&&Qe-Nt>mt?{x:It,y:o(be-It)<mt?Le:Nt}:o(Qe-Nt)<mt&&qe-Dt>mt?{x:o(Le-Nt)<mt?be:Dt,y:Nt}:null),at.site,null)),++Tt)}(C));var ue={cells:tr,edges:li};return mr=or=li=tr=null,ue}function Ia(ce,C){return C.y-ce.y||C.x-ce.x}qr.prototype.prepare=function(){for(var ce,C=this.edges,D=C.length;D--;)(ce=C[D].edge).b&&ce.a||C.splice(D,1);return C.sort(Vr),C.length},ki.prototype={start:function(){return this.edge.l===this.site?this.edge.a:this.edge.b},end:function(){return this.edge.l===this.site?this.edge.b:this.edge.a}},Ti.prototype={insert:function(ce,C){var D,F,H;if(ce){if(C.P=ce,C.N=ce.N,ce.N&&(ce.N.P=C),ce.N=C,ce.R){for(ce=ce.R;ce.L;)ce=ce.L;ce.L=C}else ce.R=C;D=ce}else this._?(ce=Ii(this._),C.P=null,C.N=ce,ce.P=ce.L=C,D=ce):(C.P=C.N=null,this._=C,D=null);for(C.L=C.R=null,C.U=D,C.C=!0,ce=C;D&&D.C;)D===(F=D.U).L?(H=F.R)&&H.C?(D.C=H.C=!1,F.C=!0,ce=F):(ce===D.R&&(Qn(this,D),D=(ce=D).U),D.C=!1,F.C=!0,Jn(this,F)):(H=F.L)&&H.C?(D.C=H.C=!1,F.C=!0,ce=F):(ce===D.L&&(Jn(this,D),D=(ce=D).U),D.C=!1,F.C=!0,Qn(this,F)),D=ce.U;this._.C=!1},remove:function(ce){ce.N&&(ce.N.P=ce.P),ce.P&&(ce.P.N=ce.N),ce.N=ce.P=null;var C,D,F,H=ce.U,ae=ce.L,ue=ce.R;if(D=ae?ue?Ii(ue):ae:ue,H?H.L===ce?H.L=D:H.R=D:this._=D,ae&&ue?(F=D.C,D.C=ce.C,D.L=ae,ae.U=D,D!==ue?(H=D.U,D.U=ce.U,H.L=ce=D.R,D.R=ue,ue.U=D):(D.U=H,H=D,ce=D.R)):(F=ce.C,ce=D),ce&&(ce.U=H),!F)if(ce&&ce.C)ce.C=!1;else{do{if(ce===this._)break;if(ce===H.L){if((C=H.R).C&&(C.C=!1,H.C=!0,Qn(this,H),C=H.R),C.L&&C.L.C||C.R&&C.R.C){C.R&&C.R.C||(C.L.C=!1,C.C=!0,Jn(this,C),C=H.R),C.C=H.C,H.C=C.R.C=!1,Qn(this,H),ce=this._;break}}else if((C=H.L).C&&(C.C=!1,H.C=!0,Jn(this,H),C=H.L),C.L&&C.L.C||C.R&&C.R.C){C.L&&C.L.C||(C.R.C=!1,C.C=!0,Qn(this,C),C=H.L),C.C=H.C,H.C=C.L.C=!1,Jn(this,H),ce=this._;break}C.C=!0,ce=H,H=H.U}while(!ce.C);ce&&(ce.C=!1)}}},g.geom.voronoi=function(ce){var C=Rr,D=hn,F=C,H=D,ae=oo;if(ce)return ue(ce);function ue(be){var Le=new Array(be.length),qe=ae[0][0],Qe=ae[0][1],at=ae[1][0],_t=ae[1][1];return ha(me(be),ae).cells.forEach(function(Et,Tt){var Mt=Et.edges,bt=Et.site;(Le[Tt]=Mt.length?Mt.map(function(Dt){var It=Dt.start();return[It.x,It.y]}):bt.x>=qe&&bt.x<=at&&bt.y>=Qe&&bt.y<=_t?[[qe,_t],[at,_t],[at,Qe],[qe,Qe]]:[]).point=be[Tt]}),Le}function me(be){return be.map(function(Le,qe){return{x:Math.round(F(Le,qe)/mt)*mt,y:Math.round(H(Le,qe)/mt)*mt,i:qe}})}return ue.links=function(be){return ha(me(be)).edges.filter(function(Le){return Le.l&&Le.r}).map(function(Le){return{source:be[Le.l.i],target:be[Le.r.i]}})},ue.triangles=function(be){var Le=[];return ha(me(be)).cells.forEach(function(qe,Qe){for(var at,_t,Et,Tt,Mt=qe.site,bt=qe.edges.sort(Vr),Dt=-1,It=bt.length,Nt=bt[It-1].edge,nr=Nt.l===Mt?Nt.r:Nt.l;++Dt<It;)at=nr,nr=(Nt=bt[Dt].edge).l===Mt?Nt.r:Nt.l,Qe<at.i&&Qe<nr.i&&((_t=Mt).x-(Tt=nr).x)*((Et=at).y-_t.y)-(_t.x-Et.x)*(Tt.y-_t.y)<0&&Le.push([be[Qe],be[at.i],be[nr.i]])}),Le},ue.x=function(be){return arguments.length?(F=gr(C=be),ue):C},ue.y=function(be){return arguments.length?(H=gr(D=be),ue):D},ue.clipExtent=function(be){return arguments.length?(ae=be??oo,ue):ae===oo?null:ae},ue.size=function(be){return arguments.length?ue.clipExtent(be&&[[0,0],be]):ae===oo?null:ae&&ae[1]},ue};var oo=[[-1e6,-1e6],[1e6,1e6]];function Gi(ce){return ce.x}function Zi(ce){return ce.y}function Ya(ce,C,D,F,H,ae){if(!ce(C,D,F,H,ae)){var ue=.5*(D+H),me=.5*(F+ae),be=C.nodes;be[0]&&Ya(ce,be[0],D,F,ue,me),be[1]&&Ya(ce,be[1],ue,F,H,me),be[2]&&Ya(ce,be[2],D,me,ue,ae),be[3]&&Ya(ce,be[3],ue,me,H,ae)}}function Fi(ce,C,D,F,H,ae,ue){var me,be=1/0;return function Le(qe,Qe,at,_t,Et){if(!(Qe>ae||at>ue||_t<F||Et<H)){if(Tt=qe.point){var Tt,Mt=C-qe.x,bt=D-qe.y,Dt=Mt*Mt+bt*bt;if(Dt<be){var It=Math.sqrt(be=Dt);F=C-It,H=D-It,ae=C+It,ue=D+It,me=Tt}}for(var Nt=qe.nodes,nr=.5*(Qe+_t),dr=.5*(at+Et),Sr=(D>=dr)<<1|C>=nr,Ar=Sr+4;Sr<Ar;++Sr)if(qe=Nt[3&Sr])switch(3&Sr){case 0:Le(qe,Qe,at,nr,dr);break;case 1:Le(qe,nr,at,_t,dr);break;case 2:Le(qe,Qe,dr,nr,Et);break;case 3:Le(qe,nr,dr,_t,Et)}}}(ce,F,H,ae,ue),me}function so(ce,C){ce=g.rgb(ce),C=g.rgb(C);var D=ce.r,F=ce.g,H=ce.b,ae=C.r-D,ue=C.g-F,me=C.b-H;return function(be){return"#"+fr(Math.round(D+ae*be))+fr(Math.round(F+ue*be))+fr(Math.round(H+me*be))}}function fo(ce,C){var D,F={},H={};for(D in ce)D in C?F[D]=Ra(ce[D],C[D]):H[D]=ce[D];for(D in C)D in ce||(H[D]=C[D]);return function(ae){for(D in F)H[D]=F[D](ae);return H}}function ba(ce,C){return ce=+ce,C=+C,function(D){return ce*(1-D)+C*D}}function Wa(ce,C){var D,F,H,ae=ho.lastIndex=wo.lastIndex=0,ue=-1,me=[],be=[];for(ce+="",C+="";(D=ho.exec(ce))&&(F=wo.exec(C));)(H=F.index)>ae&&(H=C.slice(ae,H),me[ue]?me[ue]+=H:me[++ue]=H),(D=D[0])===(F=F[0])?me[ue]?me[ue]+=F:me[++ue]=F:(me[++ue]=null,be.push({i:ue,x:ba(D,F)})),ae=wo.lastIndex;return ae<C.length&&(H=C.slice(ae),me[ue]?me[ue]+=H:me[++ue]=H),me.length<2?be[0]?(C=be[0].x,function(Le){return C(Le)+""}):function(){return C}:(C=be.length,function(Le){for(var qe,Qe=0;Qe<C;++Qe)me[(qe=be[Qe]).i]=qe.x(Le);return me.join("")})}g.geom.delaunay=function(ce){return g.geom.voronoi().triangles(ce)},g.geom.quadtree=function(ce,C,D,F,H){var ae,ue=Rr,me=hn;if(ae=arguments.length)return ue=Gi,me=Zi,3===ae&&(H=D,F=C,D=C=0),be(ce);function be(Le){var qe,Qe,at,_t,Et,Tt,Mt,bt,Dt,It=gr(ue),Nt=gr(me);if(null!=C)Tt=C,Mt=D,bt=F,Dt=H;else if(bt=Dt=-(Tt=Mt=1/0),Qe=[],at=[],Et=Le.length,ae)for(_t=0;_t<Et;++_t)(qe=Le[_t]).x<Tt&&(Tt=qe.x),qe.y<Mt&&(Mt=qe.y),qe.x>bt&&(bt=qe.x),qe.y>Dt&&(Dt=qe.y),Qe.push(qe.x),at.push(qe.y);else for(_t=0;_t<Et;++_t){var nr=+It(qe=Le[_t],_t),dr=+Nt(qe,_t);nr<Tt&&(Tt=nr),dr<Mt&&(Mt=dr),nr>bt&&(bt=nr),dr>Dt&&(Dt=dr),Qe.push(nr),at.push(dr)}var Sr=bt-Tt,Ar=Dt-Mt;function Kr(an,jn,Wn,ui,Gr,Tn,Xn,Hn){if(!isNaN(Wn)&&!isNaN(ui))if(an.leaf){var ni=an.x,hi=an.y;if(null!=ni)if(o(ni-Wn)+o(hi-ui)<.01)Jr(an,jn,Wn,ui,Gr,Tn,Xn,Hn);else{var Si=an.point;an.x=an.y=an.point=null,Jr(an,Si,ni,hi,Gr,Tn,Xn,Hn),Jr(an,jn,Wn,ui,Gr,Tn,Xn,Hn)}else an.x=Wn,an.y=ui,an.point=jn}else Jr(an,jn,Wn,ui,Gr,Tn,Xn,Hn)}function Jr(an,jn,Wn,ui,Gr,Tn,Xn,Hn){var ni=.5*(Gr+Xn),hi=.5*(Tn+Hn),Si=Wn>=ni,$n=ui>=hi,xi=$n<<1|Si;an.leaf=!1,Si?Gr=ni:Xn=ni,$n?Tn=hi:Hn=hi,Kr(an=an.nodes[xi]||(an.nodes[xi]={leaf:!0,nodes:[],point:null,x:null,y:null}),jn,Wn,ui,Gr,Tn,Xn,Hn)}Sr>Ar?Dt=Mt+Sr:bt=Tt+Ar;var cn={leaf:!0,nodes:[],point:null,x:null,y:null,add:function(an){Kr(cn,an,+It(an,++_t),+Nt(an,_t),Tt,Mt,bt,Dt)},visit:function(an){Ya(an,cn,Tt,Mt,bt,Dt)},find:function(an){return Fi(cn,an[0],an[1],Tt,Mt,bt,Dt)}};if(_t=-1,null==C){for(;++_t<Et;)Kr(cn,Le[_t],Qe[_t],at[_t],Tt,Mt,bt,Dt);--_t}else Le.forEach(cn.add);return Qe=at=Le=qe=null,cn}return be.x=function(Le){return arguments.length?(ue=Le,be):ue},be.y=function(Le){return arguments.length?(me=Le,be):me},be.extent=function(Le){return arguments.length?(null==Le?C=D=F=H=null:(C=+Le[0][0],D=+Le[0][1],F=+Le[1][0],H=+Le[1][1]),be):null==C?null:[[C,D],[F,H]]},be.size=function(Le){return arguments.length?(null==Le?C=D=F=H=null:(C=D=0,F=+Le[0],H=+Le[1]),be):null==C?null:[F-C,H-D]},be},g.interpolateRgb=so,g.interpolateObject=fo,g.interpolateNumber=ba,g.interpolateString=Wa;var ho=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,wo=new RegExp(ho.source,"g");function Ra(ce,C){for(var D,F=g.interpolators.length;--F>=0&&!(D=g.interpolators[F](ce,C)););return D}function pa(ce,C){var D,F=[],H=[],ae=ce.length,ue=C.length,me=Math.min(ce.length,C.length);for(D=0;D<me;++D)F.push(Ra(ce[D],C[D]));for(;D<ae;++D)H[D]=ce[D];for(;D<ue;++D)H[D]=C[D];return function(be){for(D=0;D<me;++D)H[D]=F[D](be);return H}}g.interpolate=Ra,g.interpolators=[function(ce,C){var D=typeof C;return("string"===D?cr.has(C.toLowerCase())||/^(#|rgb\(|hsl\()/i.test(C)?so:Wa:C instanceof Je?so:Array.isArray(C)?pa:"object"===D&&isNaN(C)?fo:ba)(ce,C)}],g.interpolateArray=pa;var Ga=function(){return E},ps=g.map({linear:Ga,poly:function(ce){return function(C){return Math.pow(C,ce)}},quad:function(){return ys},cubic:function(){return xs},sin:function(){return bs},exp:function(){return Ao},circle:function(){return Mo},elastic:function(ce,C){var D;return arguments.length<2&&(C=.45),arguments.length?D=C/Ut*Math.asin(1/ce):(ce=1,D=C/4),function(F){return 1+ce*Math.pow(2,-10*F)*Math.sin((F-D)*Ut/C)}},back:function(ce){return ce||(ce=1.70158),function(C){return C*C*((ce+1)*C-ce)}},bounce:function(){return Fo}}),vs=g.map({in:E,out:ss,"in-out":Wo,"out-in":function(ce){return Wo(ss(ce))}});function Yi(ce){return function(C){return C<=0?0:C>=1?1:ce(C)}}function ss(ce){return function(C){return 1-ce(1-C)}}function Wo(ce){return function(C){return.5*(C<.5?ce(2*C):2-ce(2-2*C))}}function ys(ce){return ce*ce}function xs(ce){return ce*ce*ce}function ds(ce){if(ce<=0)return 0;if(ce>=1)return 1;var C=ce*ce,D=C*ce;return 4*(ce<.5?D:3*(ce-C)+D-.75)}function bs(ce){return 1-Math.cos(ce*Wt)}function Ao(ce){return Math.pow(2,10*(ce-1))}function Mo(ce){return 1-Math.sqrt(1-ce*ce)}function Fo(ce){return ce<1/2.75?7.5625*ce*ce:ce<2/2.75?7.5625*(ce-=1.5/2.75)*ce+.75:ce<2.5/2.75?7.5625*(ce-=2.25/2.75)*ce+.9375:7.5625*(ce-=2.625/2.75)*ce+.984375}function Bo(ce,C){return C-=ce,function(D){return Math.round(ce+C*D)}}function No(ce){var C,D,F,H=[ce.a,ce.b],ae=[ce.c,ce.d],ue=po(H),me=Xo(H,ae),be=po(((C=ae)[0]+=(F=-me)*(D=H)[0],C[1]+=F*D[1],C))||0;H[0]*ae[1]<ae[0]*H[1]&&(H[0]*=-1,H[1]*=-1,ue*=-1,me*=-1),this.rotate=(ue?Math.atan2(H[1],H[0]):Math.atan2(-ae[0],ae[1]))*Ht,this.translate=[ce.e,ce.f],this.scale=[ue,be],this.skew=be?Math.atan2(me,be)*Ht:0}function Xo(ce,C){return ce[0]*C[0]+ce[1]*C[1]}function po(ce){var C=Math.sqrt(Xo(ce,ce));return C&&(ce[0]/=C,ce[1]/=C),C}g.ease=function(ce){var C=ce.indexOf("-"),D=C>=0?ce.slice(0,C):ce,F=C>=0?ce.slice(C+1):"in";return D=ps.get(D)||Ga,Yi((F=vs.get(F)||E)(D.apply(null,v.call(arguments,1))))},g.interpolateHcl=function(ce,C){ce=g.hcl(ce),C=g.hcl(C);var D=ce.h,F=ce.c,H=ce.l,ae=C.h-D,ue=C.c-F,me=C.l-H;return isNaN(ue)&&(ue=0,F=isNaN(F)?C.c:F),isNaN(ae)?(ae=0,D=isNaN(D)?C.h:D):ae>180?ae-=360:ae<-180&&(ae+=360),function(be){return rt(D+ae*be,F+ue*be,H+me*be)+""}},g.interpolateHsl=function(ce,C){ce=g.hsl(ce),C=g.hsl(C);var D=ce.h,F=ce.s,H=ce.l,ae=C.h-D,ue=C.s-F,me=C.l-H;return isNaN(ue)&&(ue=0,F=isNaN(F)?C.s:F),isNaN(ae)?(ae=0,D=isNaN(D)?C.h:D):ae>180?ae-=360:ae<-180&&(ae+=360),function(be){return ot(D+ae*be,F+ue*be,H+me*be)+""}},g.interpolateLab=function(ce,C){ce=g.lab(ce),C=g.lab(C);var D=ce.l,F=ce.a,H=ce.b,ae=C.l-D,ue=C.a-F,me=C.b-H;return function(be){return Lt(D+ae*be,F+ue*be,H+me*be)+""}},g.interpolateRound=Bo,g.transform=function(ce){var C=x.createElementNS(g.ns.prefix.svg,"g");return(g.transform=function(D){if(null!=D){C.setAttribute("transform",D);var F=C.transform.baseVal.consolidate()}return new No(F?F.matrix:ls)})(ce)},No.prototype.toString=function(){return"translate("+this.translate+")rotate("+this.rotate+")skewX("+this.skew+")scale("+this.scale+")"};var ls={a:1,b:0,c:0,d:1,e:0,f:0};function lo(ce){return ce.length?ce.pop()+",":""}function jo(ce,C){var H,ae,ue,D=[],F=[];return ce=g.transform(ce),C=g.transform(C),function(H,ae,ue,me){if(H[0]!==ae[0]||H[1]!==ae[1]){var be=ue.push("translate(",null,",",null,")");me.push({i:be-4,x:ba(H[0],ae[0])},{i:be-2,x:ba(H[1],ae[1])})}else(ae[0]||ae[1])&&ue.push("translate("+ae+")")}(ce.translate,C.translate,D,F),ue=D,(H=ce.rotate)!==(ae=C.rotate)?(H-ae>180?ae+=360:ae-H>180&&(H+=360),F.push({i:ue.push(lo(ue)+"rotate(",null,")")-2,x:ba(H,ae)})):ae&&ue.push(lo(ue)+"rotate("+ae+")"),function(H,ae,ue,me){H!==ae?me.push({i:ue.push(lo(ue)+"skewX(",null,")")-2,x:ba(H,ae)}):ae&&ue.push(lo(ue)+"skewX("+ae+")")}(ce.skew,C.skew,D,F),function(H,ae,ue,me){if(H[0]!==ae[0]||H[1]!==ae[1]){var be=ue.push(lo(ue)+"scale(",null,",",null,")");me.push({i:be-4,x:ba(H[0],ae[0])},{i:be-2,x:ba(H[1],ae[1])})}else 1===ae[0]&&1===ae[1]||ue.push(lo(ue)+"scale("+ae+")")}(ce.scale,C.scale,D,F),ce=C=null,function(H){for(var ae,ue=-1,me=F.length;++ue<me;)D[(ae=F[ue]).i]=ae.x(H);return D.join("")}}function cs(ce,C){return C=(C-=ce=+ce)||1/C,function(D){return(D-ce)/C}}function So(ce,C){return C=(C-=ce=+ce)||1/C,function(D){return Math.max(0,Math.min(1,(D-ce)/C))}}function qi(ce){for(var C=ce.source,D=ce.target,F=function(ue,me){if(ue===me)return ue;for(var be=Ue(ue),Le=Ue(me),qe=be.pop(),Qe=Le.pop(),at=null;qe===Qe;)at=qe,qe=be.pop(),Qe=Le.pop();return at}(C,D),H=[C];C!==F;)H.push(C=C.parent);for(var ae=H.length;D!==F;)H.splice(ae,0,D),D=D.parent;return H}function Ue(ce){for(var C=[],D=ce.parent;null!=D;)C.push(ce),ce=D,D=D.parent;return C.push(ce),C}function Ze(ce){ce.fixed|=2}function et(ce){ce.fixed&=-7}function lt(ce){ce.fixed|=4,ce.px=ce.x,ce.py=ce.y}function yt(ce){ce.fixed&=-5}g.interpolateTransform=jo,g.layout={},g.layout.bundle=function(){return function(ce){for(var C=[],D=-1,F=ce.length;++D<F;)C.push(qi(ce[D]));return C}},g.layout.chord=function(){var ce,C,D,F,H,ae,ue,me={},be=0;function Le(){var Qe,at,_t,Et,Tt,Mt={},bt=[],Dt=g.range(F),It=[];for(ce=[],C=[],Qe=0,Et=-1;++Et<F;){for(at=0,Tt=-1;++Tt<F;)at+=D[Et][Tt];bt.push(at),It.push(g.range(F)),Qe+=at}for(H&&Dt.sort(function(cn,an){return H(bt[cn],bt[an])}),ae&&It.forEach(function(cn,an){cn.sort(function(jn,Wn){return ae(D[an][jn],D[an][Wn])})}),Qe=(Ut-be*F)/Qe,at=0,Et=-1;++Et<F;){for(_t=at,Tt=-1;++Tt<F;){var Nt=Dt[Et],nr=It[Nt][Tt],dr=D[Nt][nr],Sr=at,Ar=at+=dr*Qe;Mt[Nt+"-"+nr]={index:Nt,subindex:nr,startAngle:Sr,endAngle:Ar,value:dr}}C[Nt]={index:Nt,startAngle:_t,endAngle:at,value:bt[Nt]},at+=be}for(Et=-1;++Et<F;)for(Tt=Et-1;++Tt<F;){var Kr=Mt[Et+"-"+Tt],Jr=Mt[Tt+"-"+Et];(Kr.value||Jr.value)&&ce.push(Kr.value<Jr.value?{source:Jr,target:Kr}:{source:Kr,target:Jr})}ue&&qe()}function qe(){ce.sort(function(Qe,at){return ue((Qe.source.value+Qe.target.value)/2,(at.source.value+at.target.value)/2)})}return me.matrix=function(Qe){return arguments.length?(F=(D=Qe)&&D.length,ce=C=null,me):D},me.padding=function(Qe){return arguments.length?(be=Qe,ce=C=null,me):be},me.sortGroups=function(Qe){return arguments.length?(H=Qe,ce=C=null,me):H},me.sortSubgroups=function(Qe){return arguments.length?(ae=Qe,ce=null,me):ae},me.sortChords=function(Qe){return arguments.length?(ue=Qe,ce&&qe(),me):ue},me.chords=function(){return ce||Le(),ce},me.groups=function(){return C||Le(),C},me},g.layout.force=function(){var ce,C,D,F,H,ae,ue={},me=g.dispatch("start","tick","end"),be=[1,1],Le=.9,qe=gt,Qe=St,at=-30,_t=Xt,Et=.1,Tt=.64,Mt=[],bt=[];function Dt(Nt){return function(nr,dr,Sr,Ar){if(nr.point!==Nt){var Kr=nr.cx-Nt.x,Jr=nr.cy-Nt.y,cn=Ar-dr,an=Kr*Kr+Jr*Jr;if(cn*cn/Tt<an){if(an<_t){var jn=nr.charge/an;Nt.px-=Kr*jn,Nt.py-=Jr*jn}return!0}nr.point&&an&&an<_t&&(Nt.px-=Kr*(jn=nr.pointCharge/an),Nt.py-=Jr*jn)}return!nr.charge}}function It(Nt){Nt.px=g.event.x,Nt.py=g.event.y,ue.resume()}return ue.tick=function(){if((D*=.99)<.005)return ce=null,me.end({type:"end",alpha:D=0}),!0;var Nt,nr,dr,Sr,Ar,Kr,Jr,cn,an,jn=Mt.length,Wn=bt.length;for(nr=0;nr<Wn;++nr)Sr=(dr=bt[nr]).source,(Kr=(cn=(Ar=dr.target).x-Sr.x)*cn+(an=Ar.y-Sr.y)*an)&&(cn*=Kr=D*H[nr]*((Kr=Math.sqrt(Kr))-F[nr])/Kr,an*=Kr,Ar.x-=cn*(Jr=Sr.weight+Ar.weight?Sr.weight/(Sr.weight+Ar.weight):.5),Ar.y-=an*Jr,Sr.x+=cn*(Jr=1-Jr),Sr.y+=an*Jr);if((Jr=D*Et)&&(cn=be[0]/2,an=be[1]/2,nr=-1,Jr))for(;++nr<jn;)(dr=Mt[nr]).x+=(cn-dr.x)*Jr,dr.y+=(an-dr.y)*Jr;if(at)for(function ui(Gr,Tn,Xn){var Hn=0,ni=0;if(Gr.charge=0,!Gr.leaf)for(var hi,Si=Gr.nodes,$n=Si.length,xi=-1;++xi<$n;)null!=(hi=Si[xi])&&(ui(hi,Tn,Xn),Gr.charge+=hi.charge,Hn+=hi.charge*hi.cx,ni+=hi.charge*hi.cy);if(Gr.point){Gr.leaf||(Gr.point.x+=Math.random()-.5,Gr.point.y+=Math.random()-.5);var mi=Tn*Xn[Gr.point.index];Gr.charge+=Gr.pointCharge=mi,Hn+=mi*Gr.point.x,ni+=mi*Gr.point.y}Gr.cx=Hn/Gr.charge,Gr.cy=ni/Gr.charge}(Nt=g.geom.quadtree(Mt),D,ae),nr=-1;++nr<jn;)(dr=Mt[nr]).fixed||Nt.visit(Dt(dr));for(nr=-1;++nr<jn;)(dr=Mt[nr]).fixed?(dr.x=dr.px,dr.y=dr.py):(dr.x-=(dr.px-(dr.px=dr.x))*Le,dr.y-=(dr.py-(dr.py=dr.y))*Le);me.tick({type:"tick",alpha:D})},ue.nodes=function(Nt){return arguments.length?(Mt=Nt,ue):Mt},ue.links=function(Nt){return arguments.length?(bt=Nt,ue):bt},ue.size=function(Nt){return arguments.length?(be=Nt,ue):be},ue.linkDistance=function(Nt){return arguments.length?(qe="function"==typeof Nt?Nt:+Nt,ue):qe},ue.distance=ue.linkDistance,ue.linkStrength=function(Nt){return arguments.length?(Qe="function"==typeof Nt?Nt:+Nt,ue):Qe},ue.friction=function(Nt){return arguments.length?(Le=+Nt,ue):Le},ue.charge=function(Nt){return arguments.length?(at="function"==typeof Nt?Nt:+Nt,ue):at},ue.chargeDistance=function(Nt){return arguments.length?(_t=Nt*Nt,ue):Math.sqrt(_t)},ue.gravity=function(Nt){return arguments.length?(Et=+Nt,ue):Et},ue.theta=function(Nt){return arguments.length?(Tt=Nt*Nt,ue):Math.sqrt(Tt)},ue.alpha=function(Nt){return arguments.length?(Nt=+Nt,D?Nt>0?D=Nt:(ce.c=null,ce.t=NaN,ce=null,me.end({type:"end",alpha:D=0})):Nt>0&&(me.start({type:"start",alpha:D=Nt}),ce=gn(ue.tick)),ue):D},ue.start=function(){var Nt,nr,dr,Sr=Mt.length,Ar=bt.length,Kr=be[0],Jr=be[1];for(Nt=0;Nt<Sr;++Nt)(dr=Mt[Nt]).index=Nt,dr.weight=0;for(Nt=0;Nt<Ar;++Nt)"number"==typeof(dr=bt[Nt]).source&&(dr.source=Mt[dr.source]),"number"==typeof dr.target&&(dr.target=Mt[dr.target]),++dr.source.weight,++dr.target.weight;for(Nt=0;Nt<Sr;++Nt)dr=Mt[Nt],isNaN(dr.x)&&(dr.x=cn("x",Kr)),isNaN(dr.y)&&(dr.y=cn("y",Jr)),isNaN(dr.px)&&(dr.px=dr.x),isNaN(dr.py)&&(dr.py=dr.y);if(F=[],"function"==typeof qe)for(Nt=0;Nt<Ar;++Nt)F[Nt]=+qe.call(this,bt[Nt],Nt);else for(Nt=0;Nt<Ar;++Nt)F[Nt]=qe;if(H=[],"function"==typeof Qe)for(Nt=0;Nt<Ar;++Nt)H[Nt]=+Qe.call(this,bt[Nt],Nt);else for(Nt=0;Nt<Ar;++Nt)H[Nt]=Qe;if(ae=[],"function"==typeof at)for(Nt=0;Nt<Sr;++Nt)ae[Nt]=+at.call(this,Mt[Nt],Nt);else for(Nt=0;Nt<Sr;++Nt)ae[Nt]=at;function cn(an,jn){if(!nr){for(nr=new Array(Sr),Tn=0;Tn<Sr;++Tn)nr[Tn]=[];for(Tn=0;Tn<Ar;++Tn){var Wn=bt[Tn];nr[Wn.source.index].push(Wn.target),nr[Wn.target.index].push(Wn.source)}}for(var ui,Gr=nr[Nt],Tn=-1,Xn=Gr.length;++Tn<Xn;)if(!isNaN(ui=Gr[Tn][an]))return ui;return Math.random()*jn}return ue.resume()},ue.resume=function(){return ue.alpha(.1)},ue.stop=function(){return ue.alpha(0)},ue.drag=function(){if(C||(C=g.behavior.drag().origin(E).on("dragstart.force",Ze).on("drag.force",It).on("dragend.force",et)),!arguments.length)return C;this.on("mouseover.force",lt).on("mouseout.force",yt).call(C)},g.rebind(ue,me,"on")};var gt=20,St=1,Xt=1/0;function Kt(ce,C){return g.rebind(ce,C,"sort","children","value"),ce.nodes=ce,ce.links=Or,ce}function Zt(ce,C){for(var D=[ce];null!=(ce=D.pop());)if(C(ce),(H=ce.children)&&(F=H.length))for(var F,H;--F>=0;)D.push(H[F])}function ir(ce,C){for(var D=[ce],F=[];null!=(ce=D.pop());)if(F.push(ce),(ae=ce.children)&&(H=ae.length))for(var H,ae,ue=-1;++ue<H;)D.push(ae[ue]);for(;null!=(ce=F.pop());)C(ce)}function pr(ce){return ce.children}function br(ce){return ce.value}function _r(ce,C){return C.value-ce.value}function Or(ce){return g.merge(ce.map(function(C){return(C.children||[]).map(function(D){return{source:C,target:D}})}))}g.layout.hierarchy=function(){var ce=_r,C=pr,D=br;function F(H){var ae,ue=[H],me=[];for(H.depth=0;null!=(ae=ue.pop());)if(me.push(ae),(Le=C.call(F,ae,ae.depth))&&(be=Le.length)){for(var be,Le,qe;--be>=0;)ue.push(qe=Le[be]),qe.parent=ae,qe.depth=ae.depth+1;D&&(ae.value=0),ae.children=Le}else D&&(ae.value=+D.call(F,ae,ae.depth)||0),delete ae.children;return ir(H,function(Qe){var at,_t;ce&&(at=Qe.children)&&at.sort(ce),D&&(_t=Qe.parent)&&(_t.value+=Qe.value)}),me}return F.sort=function(H){return arguments.length?(ce=H,F):ce},F.children=function(H){return arguments.length?(C=H,F):C},F.value=function(H){return arguments.length?(D=H,F):D},F.revalue=function(H){return D&&(Zt(H,function(ae){ae.children&&(ae.value=0)}),ir(H,function(ae){var ue;ae.children||(ae.value=+D.call(F,ae,ae.depth)||0),(ue=ae.parent)&&(ue.value+=ae.value)})),H},F},g.layout.partition=function(){var ce=g.layout.hierarchy(),C=[1,1];function D(F,H){var ae=ce.call(this,F,H);return function ue(me,be,Le,qe){var Qe=me.children;if(me.x=be,me.y=me.depth*qe,me.dx=Le,me.dy=qe,Qe&&(at=Qe.length)){var at,_t,Et,Tt=-1;for(Le=me.value?Le/me.value:0;++Tt<at;)ue(_t=Qe[Tt],be,Et=_t.value*Le,qe),be+=Et}}(ae[0],0,C[0],C[1]/function ue(me){var be=me.children,Le=0;if(be&&(qe=be.length))for(var qe,Qe=-1;++Qe<qe;)Le=Math.max(Le,ue(be[Qe]));return 1+Le}(ae[0])),ae}return D.size=function(F){return arguments.length?(C=F,D):C},Kt(D,ce)},g.layout.pie=function(){var ce=Number,C=tn,D=0,F=Ut,H=0;function ae(ue){var me,be=ue.length,Le=ue.map(function(Dt,It){return+ce.call(ae,Dt,It)}),qe=+("function"==typeof D?D.apply(this,arguments):D),Qe=("function"==typeof F?F.apply(this,arguments):F)-qe,at=Math.min(Math.abs(Qe)/be,+("function"==typeof H?H.apply(this,arguments):H)),_t=at*(Qe<0?-1:1),Et=g.sum(Le),Tt=Et?(Qe-be*_t)/Et:0,Mt=g.range(be),bt=[];return null!=C&&Mt.sort(C===tn?function(Dt,It){return Le[It]-Le[Dt]}:function(Dt,It){return C(ue[Dt],ue[It])}),Mt.forEach(function(Dt){bt[Dt]={data:ue[Dt],value:me=Le[Dt],startAngle:qe,endAngle:qe+=me*Tt+_t,padAngle:at}}),bt}return ae.value=function(ue){return arguments.length?(ce=ue,ae):ce},ae.sort=function(ue){return arguments.length?(C=ue,ae):C},ae.startAngle=function(ue){return arguments.length?(D=ue,ae):D},ae.endAngle=function(ue){return arguments.length?(F=ue,ae):F},ae.padAngle=function(ue){return arguments.length?(H=ue,ae):H},ae};var tn={};function fn(ce){return ce.x}function En(ce){return ce.y}function On(ce,C,D){ce.y0=C,ce.y=D}g.layout.stack=function(){var ce=E,C=gi,D=Ai,F=On,H=fn,ae=En;function ue(me,be){if(!(at=me.length))return me;var Le=me.map(function(Dt,It){return ce.call(ue,Dt,It)}),qe=Le.map(function(Dt){return Dt.map(function(It,Nt){return[H.call(ue,It,Nt),ae.call(ue,It,Nt)]})}),Qe=C.call(ue,qe,be);Le=g.permute(Le,Qe),qe=g.permute(qe,Qe);var at,_t,Et,Tt,Mt=D.call(ue,qe,be),bt=Le[0].length;for(Et=0;Et<bt;++Et)for(F.call(ue,Le[0][Et],Tt=Mt[Et],qe[0][Et][1]),_t=1;_t<at;++_t)F.call(ue,Le[_t][Et],Tt+=qe[_t-1][Et][1],qe[_t][Et][1]);return me}return ue.values=function(me){return arguments.length?(ce=me,ue):ce},ue.order=function(me){return arguments.length?(C="function"==typeof me?me:qn.get(me)||gi,ue):C},ue.offset=function(me){return arguments.length?(D="function"==typeof me?me:Dn.get(me)||Ai,ue):D},ue.x=function(me){return arguments.length?(H=me,ue):H},ue.y=function(me){return arguments.length?(ae=me,ue):ae},ue.out=function(me){return arguments.length?(F=me,ue):F},ue};var qn=g.map({"inside-out":function(ce){var C,D,F=ce.length,H=ce.map(Ni),ae=ce.map(Bi),ue=g.range(F).sort(function(Qe,at){return H[Qe]-H[at]}),me=0,be=0,Le=[],qe=[];for(C=0;C<F;++C)D=ue[C],me<be?(me+=ae[D],Le.push(D)):(be+=ae[D],qe.push(D));return qe.reverse().concat(Le)},reverse:function(ce){return g.range(ce.length).reverse()},default:gi}),Dn=g.map({silhouette:function(ce){var C,D,F,H=ce.length,ae=ce[0].length,ue=[],me=0,be=[];for(D=0;D<ae;++D){for(C=0,F=0;C<H;C++)F+=ce[C][D][1];F>me&&(me=F),ue.push(F)}for(D=0;D<ae;++D)be[D]=(me-ue[D])/2;return be},wiggle:function(ce){var C,D,F,H,ae,ue,me,be,Le,qe=ce.length,Qe=ce[0],at=Qe.length,_t=[];for(_t[0]=be=Le=0,D=1;D<at;++D){for(C=0,H=0;C<qe;++C)H+=ce[C][D][1];for(C=0,ae=0,me=Qe[D][0]-Qe[D-1][0];C<qe;++C){for(F=0,ue=(ce[C][D][1]-ce[C][D-1][1])/(2*me);F<C;++F)ue+=(ce[F][D][1]-ce[F][D-1][1])/me;ae+=ue*ce[C][D][1]}_t[D]=be-=H?ae/H*me:0,be<Le&&(Le=be)}for(D=0;D<at;++D)_t[D]-=Le;return _t},expand:function(ce){var C,D,F,H=ce.length,ae=ce[0].length,ue=1/H,me=[];for(D=0;D<ae;++D){for(C=0,F=0;C<H;C++)F+=ce[C][D][1];if(F)for(C=0;C<H;C++)ce[C][D][1]/=F;else for(C=0;C<H;C++)ce[C][D][1]=ue}for(D=0;D<ae;++D)me[D]=0;return me},zero:Ai});function gi(ce){return g.range(ce.length)}function Ai(ce){for(var C=-1,D=ce[0].length,F=[];++C<D;)F[C]=0;return F}function Ni(ce){for(var C,D=1,F=0,H=ce[0][1],ae=ce.length;D<ae;++D)(C=ce[D][1])>H&&(F=D,H=C);return F}function Bi(ce){return ce.reduce(ji,0)}function ji(ce,C){return ce+C[1]}function _a(ce,C){return ya(ce,Math.ceil(Math.log(C.length)/Math.LN2+1))}function ya(ce,C){for(var D=-1,F=+ce[0],H=(ce[1]-F)/C,ae=[];++D<=C;)ae[D]=H*D+F;return ae}function aa(ce){return[g.min(ce),g.max(ce)]}function oa(ce,C){return ce.value-C.value}function xa(ce,C){var D=ce._pack_next;ce._pack_next=C,C._pack_prev=ce,C._pack_next=D,D._pack_prev=C}function Fa(ce,C){ce._pack_next=C,C._pack_prev=ce}function Xa(ce,C){var D=C.x-ce.x,F=C.y-ce.y,H=ce.r+C.r;return.999*H*H>D*D+F*F}function Ja(ce){if((C=ce.children)&&(be=C.length)){var C,D,F,H,ae,ue,me,be,Le=1/0,qe=-1/0,Qe=1/0,at=-1/0;if(C.forEach(Ka),(D=C[0]).x=-D.r,D.y=0,It(D),be>1&&((F=C[1]).x=F.r,F.y=0,It(F),be>2))for(Oi(D,F,H=C[2]),It(H),xa(D,H),D._pack_prev=H,xa(H,F),F=D._pack_next,ae=3;ae<be;ae++){Oi(D,F,H=C[ae]);var _t=0,Et=1,Tt=1;for(ue=F._pack_next;ue!==F;ue=ue._pack_next,Et++)if(Xa(ue,H)){_t=1;break}if(1==_t)for(me=D._pack_prev;me!==ue._pack_prev&&!Xa(me,H);me=me._pack_prev,Tt++);_t?(Et<Tt||Et==Tt&&F.r<D.r?Fa(D,F=ue):Fa(D=me,F),ae--):(xa(D,H),F=H,It(H))}var Mt=(Le+qe)/2,bt=(Qe+at)/2,Dt=0;for(ae=0;ae<be;ae++)(H=C[ae]).x-=Mt,H.y-=bt,Dt=Math.max(Dt,H.r+Math.sqrt(H.x*H.x+H.y*H.y));ce.r=Dt,C.forEach(Qa)}function It(Nt){Le=Math.min(Nt.x-Nt.r,Le),qe=Math.max(Nt.x+Nt.r,qe),Qe=Math.min(Nt.y-Nt.r,Qe),at=Math.max(Nt.y+Nt.r,at)}}function Ka(ce){ce._pack_next=ce._pack_prev=ce}function Qa(ce){delete ce._pack_next,delete ce._pack_prev}function Oi(ce,C,D){var F=ce.r+D.r,H=C.x-ce.x,ae=C.y-ce.y;if(F&&(H||ae)){var ue=C.r+D.r,me=H*H+ae*ae,be=.5+((F*=F)-(ue*=ue))/(2*me),Le=Math.sqrt(Math.max(0,2*ue*(F+me)-(F-=me)*F-ue*ue))/(2*me);D.x=ce.x+be*H+Le*ae,D.y=ce.y+be*ae-Le*H}else D.x=ce.x+F,D.y=ce.y}function pt(ce,C){return ce.parent==C.parent?1:2}function Ot(ce){var C=ce.children;return C.length?C[0]:ce.t}function sr(ce){var C,D=ce.children;return(C=D.length)?D[C-1]:ce.t}function Vt(ce,C,D){var F=D/(C.i-ce.i);C.c-=F,C.s+=D,ce.c+=F,C.z+=D,C.m+=D}function lr(ce,C,D){return ce.a.parent===C.parent?ce.a:D}function Pr(ce){return{x:ce.x,y:ce.y,dx:ce.dx,dy:ce.dy}}function Br(ce,C){var D=ce.x+C[3],F=ce.y+C[0],H=ce.dx-C[1]-C[3],ae=ce.dy-C[0]-C[2];return H<0&&(D+=H/2,H=0),ae<0&&(F+=ae/2,ae=0),{x:D,y:F,dx:H,dy:ae}}function Yr(ce){var C=ce[0],D=ce[ce.length-1];return C<D?[C,D]:[D,C]}function on(ce){return ce.rangeExtent?ce.rangeExtent():Yr(ce.range())}function rn(ce,C,D,F){var H=D(ce[0],ce[1]),ae=F(C[0],C[1]);return function(ue){return ae(H(ue))}}function pn(ce,C){var D,F=0,H=ce.length-1,ae=ce[F],ue=ce[H];return ue<ae&&(D=F,F=H,H=D,D=ae,ae=ue,ue=D),ce[F]=C.floor(ae),ce[H]=C.ceil(ue),ce}function _n(ce){return ce?{floor:function(C){return Math.floor(C/ce)*ce},ceil:function(C){return Math.ceil(C/ce)*ce}}:sn}g.layout.histogram=function(){var ce=!0,C=Number,D=aa,F=_a;function H(ae,ue){for(var me,be,Le=[],qe=ae.map(C,this),Qe=D.call(this,qe,ue),at=F.call(this,Qe,qe,ue),_t=(ue=-1,qe.length),Et=at.length-1,Tt=ce?1:1/_t;++ue<Et;)(me=Le[ue]=[]).dx=at[ue+1]-(me.x=at[ue]),me.y=0;if(Et>0)for(ue=-1;++ue<_t;)(be=qe[ue])>=Qe[0]&&be<=Qe[1]&&((me=Le[g.bisect(at,be,1,Et)-1]).y+=Tt,me.push(ae[ue]));return Le}return H.value=function(ae){return arguments.length?(C=ae,H):C},H.range=function(ae){return arguments.length?(D=gr(ae),H):D},H.bins=function(ae){return arguments.length?(F="number"==typeof ae?function(ue){return ya(ue,ae)}:gr(ae),H):F},H.frequency=function(ae){return arguments.length?(ce=!!ae,H):ce},H},g.layout.pack=function(){var ce,C=g.layout.hierarchy().sort(oa),D=0,F=[1,1];function H(ae,ue){var me=C.call(this,ae,ue),be=me[0],Le=F[0],qe=F[1],Qe=null==ce?Math.sqrt:"function"==typeof ce?ce:function(){return ce};if(be.x=be.y=0,ir(be,function(_t){_t.r=+Qe(_t.value)}),ir(be,Ja),D){var at=D*(ce?1:Math.max(2*be.r/Le,2*be.r/qe))/2;ir(be,function(_t){_t.r+=at}),ir(be,Ja),ir(be,function(_t){_t.r-=at})}return function _t(Et,Tt,Mt,bt){var Dt=Et.children;if(Et.x=Tt+=bt*Et.x,Et.y=Mt+=bt*Et.y,Et.r*=bt,Dt)for(var It=-1,Nt=Dt.length;++It<Nt;)_t(Dt[It],Tt,Mt,bt)}(be,Le/2,qe/2,ce?1:1/Math.max(2*be.r/Le,2*be.r/qe)),me}return H.size=function(ae){return arguments.length?(F=ae,H):F},H.radius=function(ae){return arguments.length?(ce=null==ae||"function"==typeof ae?ae:+ae,H):ce},H.padding=function(ae){return arguments.length?(D=+ae,H):D},Kt(H,C)},g.layout.tree=function(){var ce=g.layout.hierarchy().sort(null).value(null),C=pt,D=[1,1],F=null;function H(be,Le){var qe=ce.call(this,be,Le),Qe=qe[0],at=function(It){for(var Nt,nr={A:null,children:[It]},dr=[nr];null!=(Nt=dr.pop());)for(var Sr,Ar=Nt.children,Kr=0,Jr=Ar.length;Kr<Jr;++Kr)dr.push((Ar[Kr]=Sr={_:Ar[Kr],parent:Nt,children:(Sr=Ar[Kr].children)&&Sr.slice()||[],A:null,a:null,z:0,m:0,c:0,s:0,t:null,i:Kr}).a=Sr);return nr.children[0]}(Qe);if(ir(at,ae),at.parent.m=-at.z,Zt(at,ue),F)Zt(Qe,me);else{var _t=Qe,Et=Qe,Tt=Qe;Zt(Qe,function(It){It.x<_t.x&&(_t=It),It.x>Et.x&&(Et=It),It.depth>Tt.depth&&(Tt=It)});var Mt=C(_t,Et)/2-_t.x,bt=D[0]/(Et.x+C(Et,_t)/2+Mt),Dt=D[1]/(Tt.depth||1);Zt(Qe,function(It){It.x=(It.x+Mt)*bt,It.y=It.depth*Dt})}return qe}function ae(be){var Le=be.children,qe=be.parent.children,Qe=be.i?qe[be.i-1]:null;if(Le.length){!function(_t){for(var Et,Tt=0,Mt=0,bt=_t.children,Dt=bt.length;--Dt>=0;)(Et=bt[Dt]).z+=Tt,Et.m+=Tt,Tt+=Et.s+(Mt+=Et.c)}(be);var at=(Le[0].z+Le[Le.length-1].z)/2;Qe?(be.z=Qe.z+C(be._,Qe._),be.m=be.z-at):be.z=at}else Qe&&(be.z=Qe.z+C(be._,Qe._));be.parent.A=function(_t,Et,Tt){if(Et){for(var Mt,bt=_t,Dt=_t,It=Et,Nt=bt.parent.children[0],nr=bt.m,dr=Dt.m,Sr=It.m,Ar=Nt.m;It=sr(It),bt=Ot(bt),It&&bt;)Nt=Ot(Nt),(Dt=sr(Dt)).a=_t,(Mt=It.z+Sr-bt.z-nr+C(It._,bt._))>0&&(Vt(lr(It,_t,Tt),_t,Mt),nr+=Mt,dr+=Mt),Sr+=It.m,nr+=bt.m,Ar+=Nt.m,dr+=Dt.m;It&&!sr(Dt)&&(Dt.t=It,Dt.m+=Sr-dr),bt&&!Ot(Nt)&&(Nt.t=bt,Nt.m+=nr-Ar,Tt=_t)}return Tt}(be,Qe,be.parent.A||qe[0])}function ue(be){be._.x=be.z+be.parent.m,be.m+=be.parent.m}function me(be){be.x*=D[0],be.y=be.depth*D[1]}return H.separation=function(be){return arguments.length?(C=be,H):C},H.size=function(be){return arguments.length?(F=null==(D=be)?me:null,H):F?null:D},H.nodeSize=function(be){return arguments.length?(F=null==(D=be)?null:me,H):F?D:null},Kt(H,ce)},g.layout.cluster=function(){var ce=g.layout.hierarchy().sort(null).value(null),C=pt,D=[1,1],F=!1;function H(ae,ue){var me,be=ce.call(this,ae,ue),Le=be[0],qe=0;ir(Le,function(Tt){var bt,Mt=Tt.children;Mt&&Mt.length?(Tt.x=(bt=Mt).reduce(function(Dt,It){return Dt+It.x},0)/bt.length,Tt.y=function(bt){return 1+g.max(bt,function(Dt){return Dt.y})}(Mt)):(Tt.x=me?qe+=C(Tt,me):0,Tt.y=0,me=Tt)});var Qe=function Tt(Mt){var bt=Mt.children;return bt&&bt.length?Tt(bt[0]):Mt}(Le),at=function Tt(Mt){var bt,Dt=Mt.children;return Dt&&(bt=Dt.length)?Tt(Dt[bt-1]):Mt}(Le),_t=Qe.x-C(Qe,at)/2,Et=at.x+C(at,Qe)/2;return ir(Le,F?function(Tt){Tt.x=(Tt.x-Le.x)*D[0],Tt.y=(Le.y-Tt.y)*D[1]}:function(Tt){Tt.x=(Tt.x-_t)/(Et-_t)*D[0],Tt.y=(1-(Le.y?Tt.y/Le.y:1))*D[1]}),be}return H.separation=function(ae){return arguments.length?(C=ae,H):C},H.size=function(ae){return arguments.length?(F=null==(D=ae),H):F?null:D},H.nodeSize=function(ae){return arguments.length?(F=null!=(D=ae),H):F?D:null},Kt(H,ce)},g.layout.treemap=function(){var ce,C=g.layout.hierarchy(),D=Math.round,F=[1,1],H=null,ae=Pr,ue=!1,me="squarify",be=.5*(1+Math.sqrt(5));function Le(Tt,Mt){for(var bt,Dt,It=-1,Nt=Tt.length;++It<Nt;)Dt=(bt=Tt[It]).value*(Mt<0?0:Mt),bt.area=isNaN(Dt)||Dt<=0?0:Dt}function qe(Tt){var Mt=Tt.children;if(Mt&&Mt.length){var bt,Dt,It,Nt=ae(Tt),nr=[],dr=Mt.slice(),Sr=1/0,Ar="slice"===me?Nt.dx:"dice"===me?Nt.dy:"slice-dice"===me?1&Tt.depth?Nt.dy:Nt.dx:Math.min(Nt.dx,Nt.dy);for(Le(dr,Nt.dx*Nt.dy/Tt.value),nr.area=0;(It=dr.length)>0;)nr.push(bt=dr[It-1]),nr.area+=bt.area,"squarify"!==me||(Dt=at(nr,Ar))<=Sr?(dr.pop(),Sr=Dt):(nr.area-=nr.pop().area,_t(nr,Ar,Nt,!1),Ar=Math.min(Nt.dx,Nt.dy),nr.length=nr.area=0,Sr=1/0);nr.length&&(_t(nr,Ar,Nt,!0),nr.length=nr.area=0),Mt.forEach(qe)}}function Qe(Tt){var Mt=Tt.children;if(Mt&&Mt.length){var bt,Dt=ae(Tt),It=Mt.slice(),Nt=[];for(Le(It,Dt.dx*Dt.dy/Tt.value),Nt.area=0;bt=It.pop();)Nt.push(bt),Nt.area+=bt.area,null!=bt.z&&(_t(Nt,bt.z?Dt.dx:Dt.dy,Dt,!It.length),Nt.length=Nt.area=0);Mt.forEach(Qe)}}function at(Tt,Mt){for(var bt,Dt=Tt.area,It=0,Nt=1/0,nr=-1,dr=Tt.length;++nr<dr;)(bt=Tt[nr].area)&&(bt<Nt&&(Nt=bt),bt>It&&(It=bt));return Mt*=Mt,(Dt*=Dt)?Math.max(Mt*It*be/Dt,Dt/(Mt*Nt*be)):1/0}function _t(Tt,Mt,bt,Dt){var It,Nt=-1,nr=Tt.length,dr=bt.x,Sr=bt.y,Ar=Mt?D(Tt.area/Mt):0;if(Mt==bt.dx){for((Dt||Ar>bt.dy)&&(Ar=bt.dy);++Nt<nr;)(It=Tt[Nt]).x=dr,It.y=Sr,It.dy=Ar,dr+=It.dx=Math.min(bt.x+bt.dx-dr,Ar?D(It.area/Ar):0);It.z=!0,It.dx+=bt.x+bt.dx-dr,bt.y+=Ar,bt.dy-=Ar}else{for((Dt||Ar>bt.dx)&&(Ar=bt.dx);++Nt<nr;)(It=Tt[Nt]).x=dr,It.y=Sr,It.dx=Ar,Sr+=It.dy=Math.min(bt.y+bt.dy-Sr,Ar?D(It.area/Ar):0);It.z=!1,It.dy+=bt.y+bt.dy-Sr,bt.x+=Ar,bt.dx-=Ar}}function Et(Tt){var Mt=ce||C(Tt),bt=Mt[0];return bt.x=bt.y=0,bt.value?(bt.dx=F[0],bt.dy=F[1]):bt.dx=bt.dy=0,ce&&C.revalue(bt),Le([bt],bt.dx*bt.dy/bt.value),(ce?Qe:qe)(bt),ue&&(ce=Mt),Mt}return Et.size=function(Tt){return arguments.length?(F=Tt,Et):F},Et.padding=function(Tt){if(!arguments.length)return H;function Mt(It){var Nt=Tt.call(Et,It,It.depth);return null==Nt?Pr(It):Br(It,"number"==typeof Nt?[Nt,Nt,Nt,Nt]:Nt)}function bt(It){return Br(It,Tt)}var Dt;return ae=null==(H=Tt)?Pr:"function"==(Dt=typeof Tt)?Mt:("number"===Dt&&(Tt=[Tt,Tt,Tt,Tt]),bt),Et},Et.round=function(Tt){return arguments.length?(D=Tt?Math.round:Number,Et):D!=Number},Et.sticky=function(Tt){return arguments.length?(ue=Tt,ce=null,Et):ue},Et.ratio=function(Tt){return arguments.length?(be=Tt,Et):be},Et.mode=function(Tt){return arguments.length?(me=Tt+"",Et):me},Kt(Et,C)},g.random={normal:function(ce,C){var D=arguments.length;return D<2&&(C=1),D<1&&(ce=0),function(){var F,H,ae;do{ae=(F=2*Math.random()-1)*F+(H=2*Math.random()-1)*H}while(!ae||ae>1);return ce+C*F*Math.sqrt(-2*Math.log(ae)/ae)}},logNormal:function(){var ce=g.random.normal.apply(g,arguments);return function(){return Math.exp(ce())}},bates:function(ce){var C=g.random.irwinHall(ce);return function(){return C()/ce}},irwinHall:function(ce){return function(){for(var C=0,D=0;D<ce;D++)C+=Math.random();return C}}},g.scale={};var sn={floor:E,ceil:E};function wn(ce,C,D,F){var H=[],ae=[],ue=0,me=Math.min(ce.length,C.length)-1;for(ce[me]<ce[0]&&(ce=ce.slice().reverse(),C=C.slice().reverse());++ue<=me;)H.push(D(ce[ue-1],ce[ue])),ae.push(F(C[ue-1],C[ue]));return function(be){var Le=g.bisect(ce,be,1,me)-1;return ae[Le](H[Le](be))}}function zn(ce,C){return g.rebind(ce,C,"range","rangeRound","interpolate","clamp")}function Vn(ce,C){return pn(ce,_n(ii(ce,C)[2])),pn(ce,_n(ii(ce,C)[2])),ce}function ii(ce,C){null==C&&(C=10);var D=Yr(ce),F=D[1]-D[0],H=Math.pow(10,Math.floor(Math.log(F/C)/Math.LN10)),ae=C/F*H;return ae<=.15?H*=10:ae<=.35?H*=5:ae<=.75&&(H*=2),D[0]=Math.ceil(D[0]/H)*H,D[1]=Math.floor(D[1]/H)*H+.5*H,D[2]=H,D}function Wr(ce,C){return g.range.apply(g,ii(ce,C))}g.scale.linear=function(){return function ce(C,D,F,H){var ae,ue;function me(){var Le=Math.min(C.length,D.length)>2?wn:rn,qe=H?So:cs;return ae=Le(C,D,qe,F),ue=Le(D,C,qe,Ra),be}function be(Le){return ae(Le)}return be.invert=function(Le){return ue(Le)},be.domain=function(Le){return arguments.length?(C=Le.map(Number),me()):C},be.range=function(Le){return arguments.length?(D=Le,me()):D},be.rangeRound=function(Le){return be.range(Le).interpolate(Bo)},be.clamp=function(Le){return arguments.length?(H=Le,me()):H},be.interpolate=function(Le){return arguments.length?(F=Le,me()):F},be.ticks=function(Le){return Wr(C,Le)},be.tickFormat=function(Le,qe){return d3_scale_linearTickFormat(C,Le,qe)},be.nice=function(Le){return Vn(C,Le),me()},be.copy=function(){return ce(C,D,F,H)},me()}([0,1],[0,1],Ra,!1)},g.scale.log=function(){return function ce(C,D,F,H){function ae(be){return(F?Math.log(be<0?0:be):-Math.log(be>0?0:-be))/Math.log(D)}function ue(be){return F?Math.pow(D,be):-Math.pow(D,-be)}function me(be){return C(ae(be))}return me.invert=function(be){return ue(C.invert(be))},me.domain=function(be){return arguments.length?(F=be[0]>=0,C.domain((H=be.map(Number)).map(ae)),me):H},me.base=function(be){return arguments.length?(D=+be,C.domain(H.map(ae)),me):D},me.nice=function(){var be=pn(H.map(ae),F?Math:ti);return C.domain(be),H=be.map(ue),me},me.ticks=function(){var be=Yr(H),Le=[],qe=be[0],Qe=be[1],at=Math.floor(ae(qe)),_t=Math.ceil(ae(Qe)),Et=D%1?2:D;if(isFinite(_t-at)){if(F){for(;at<_t;at++)for(var Tt=1;Tt<Et;Tt++)Le.push(ue(at)*Tt);Le.push(ue(at))}else for(Le.push(ue(at));at++<_t;)for(Tt=Et-1;Tt>0;Tt--)Le.push(ue(at)*Tt);for(at=0;Le[at]<qe;at++);for(_t=Le.length;Le[_t-1]>Qe;_t--);Le=Le.slice(at,_t)}return Le},me.copy=function(){return ce(C.copy(),D,F,H)},zn(me,C)}(g.scale.linear().domain([0,1]),10,!0,[1,10])};var ti={floor:function(ce){return-Math.ceil(-ce)},ceil:function(ce){return-Math.floor(-ce)}};function Ln(ce){return function(C){return C<0?-Math.pow(-C,ce):Math.pow(C,ce)}}g.scale.pow=function(){return function ce(C,D,F){var H=Ln(D),ae=Ln(1/D);function ue(me){return C(H(me))}return ue.invert=function(me){return ae(C.invert(me))},ue.domain=function(me){return arguments.length?(C.domain((F=me.map(Number)).map(H)),ue):F},ue.ticks=function(me){return Wr(F,me)},ue.tickFormat=function(me,be){return d3_scale_linearTickFormat(F,me,be)},ue.nice=function(me){return ue.domain(Vn(F,me))},ue.exponent=function(me){return arguments.length?(H=Ln(D=me),ae=Ln(1/D),C.domain(F.map(H)),ue):D},ue.copy=function(){return ce(C.copy(),D,F)},zn(ue,C)}(g.scale.linear(),1,[0,1])},g.scale.sqrt=function(){return g.scale.pow().exponent(.5)},g.scale.ordinal=function(){return function ce(C,D){var F,H,ae;function ue(be){return H[((F.get(be)||("range"===D.t?F.set(be,C.push(be)):NaN))-1)%H.length]}function me(be,Le){return g.range(C.length).map(function(qe){return be+Le*qe})}return ue.domain=function(be){if(!arguments.length)return C;C=[],F=new T;for(var Le,qe=-1,Qe=be.length;++qe<Qe;)F.has(Le=be[qe])||F.set(Le,C.push(Le));return ue[D.t].apply(ue,D.a)},ue.range=function(be){return arguments.length?(H=be,ae=0,D={t:"range",a:arguments},ue):H},ue.rangePoints=function(be,Le){arguments.length<2&&(Le=0);var qe=be[0],Qe=be[1],at=C.length<2?(qe=(qe+Qe)/2,0):(Qe-qe)/(C.length-1+Le);return H=me(qe+at*Le/2,at),ae=0,D={t:"rangePoints",a:arguments},ue},ue.rangeRoundPoints=function(be,Le){arguments.length<2&&(Le=0);var qe=be[0],Qe=be[1],at=C.length<2?(qe=Qe=Math.round((qe+Qe)/2),0):(Qe-qe)/(C.length-1+Le)|0;return H=me(qe+Math.round(at*Le/2+(Qe-qe-(C.length-1+Le)*at)/2),at),ae=0,D={t:"rangeRoundPoints",a:arguments},ue},ue.rangeBands=function(be,Le,qe){arguments.length<2&&(Le=0),arguments.length<3&&(qe=Le);var Qe=be[1]<be[0],at=be[Qe-0],Et=(be[1-Qe]-at)/(C.length-Le+2*qe);return H=me(at+Et*qe,Et),Qe&&H.reverse(),ae=Et*(1-Le),D={t:"rangeBands",a:arguments},ue},ue.rangeRoundBands=function(be,Le,qe){arguments.length<2&&(Le=0),arguments.length<3&&(qe=Le);var Qe=be[1]<be[0],at=be[Qe-0],_t=be[1-Qe],Et=Math.floor((_t-at)/(C.length-Le+2*qe));return H=me(at+Math.round((_t-at-(C.length-Le)*Et)/2),Et),Qe&&H.reverse(),ae=Math.round(Et*(1-Le)),D={t:"rangeRoundBands",a:arguments},ue},ue.rangeBand=function(){return ae},ue.rangeExtent=function(){return Yr(D.a[0])},ue.copy=function(){return ce(C,D)},ue.domain(C)}([],{t:"range",a:[[]]})},g.scale.category10=function(){return g.scale.ordinal().range(Nn)},g.scale.category20=function(){return g.scale.ordinal().range(ei)},g.scale.category20b=function(){return g.scale.ordinal().range(wi)},g.scale.category20c=function(){return g.scale.ordinal().range(Li)};var Nn=[2062260,16744206,2924588,14034728,9725885,9197131,14907330,8355711,12369186,1556175].map(Gt),ei=[2062260,11454440,16744206,16759672,2924588,10018698,14034728,16750742,9725885,12955861,9197131,12885140,14907330,16234194,8355711,13092807,12369186,14408589,1556175,10410725].map(Gt),wi=[3750777,5395619,7040719,10264286,6519097,9216594,11915115,13556636,9202993,12426809,15186514,15190932,8666169,11356490,14049643,15177372,8077683,10834324,13528509,14589654].map(Gt),Li=[3244733,7057110,10406625,13032431,15095053,16616764,16625259,16634018,3253076,7652470,10607003,13101504,7695281,10394312,12369372,14342891,6513507,9868950,12434877,14277081].map(Gt);function Mn(){return 0}g.scale.quantile=function(){return function ce(C,D){var F;function H(){var ue=0,me=D.length;for(F=[];++ue<me;)F[ue-1]=g.quantile(C,ue/me);return ae}function ae(ue){if(!isNaN(ue=+ue))return D[g.bisect(F,ue)]}return ae.domain=function(ue){return arguments.length?(C=ue.map(u).filter(f).sort(i),H()):C},ae.range=function(ue){return arguments.length?(D=ue,H()):D},ae.quantiles=function(){return F},ae.invertExtent=function(ue){return(ue=D.indexOf(ue))<0?[NaN,NaN]:[ue>0?F[ue-1]:C[0],ue<F.length?F[ue]:C[C.length-1]]},ae.copy=function(){return ce(C,D)},H()}([],[])},g.scale.quantize=function(){return function ce(C,D,F){var H,ae;function ue(be){return F[Math.max(0,Math.min(ae,Math.floor(H*(be-C))))]}function me(){return H=F.length/(D-C),ae=F.length-1,ue}return ue.domain=function(be){return arguments.length?(C=+be[0],D=+be[be.length-1],me()):[C,D]},ue.range=function(be){return arguments.length?(F=be,me()):F},ue.invertExtent=function(be){return[be=(be=F.indexOf(be))<0?NaN:be/H+C,be+1/H]},ue.copy=function(){return ce(C,D,F)},me()}(0,1,[0,1])},g.scale.threshold=function(){return function ce(C,D){function F(H){if(H<=H)return D[g.bisect(C,H)]}return F.domain=function(H){return arguments.length?(C=H,F):C},F.range=function(H){return arguments.length?(D=H,F):D},F.invertExtent=function(H){return H=D.indexOf(H),[C[H-1],C[H]]},F.copy=function(){return ce(C,D)},F}([.5],[0,1])},g.scale.identity=function(){return function ce(C){function D(F){return+F}return D.invert=D,D.domain=D.range=function(F){return arguments.length?(C=F.map(D),D):C},D.ticks=function(F){return Wr(C,F)},D.tickFormat=function(F,H){return d3_scale_linearTickFormat(C,F,H)},D.copy=function(){return ce(C)},D}([0,1])},g.svg={},g.svg.arc=function(){var ce=Ei,C=di,D=Mn,F=Di,H=zi,ae=Mi,ue=$i;function me(){var Le=Math.max(0,+ce.apply(this,arguments)),qe=Math.max(0,+C.apply(this,arguments)),Qe=H.apply(this,arguments)-Wt,at=ae.apply(this,arguments)-Wt,_t=Math.abs(at-Qe),Et=Qe>at?0:1;if(qe<Le&&(Tt=qe,qe=Le,Le=Tt),_t>=er)return be(qe,Et)+(Le?be(Le,1-Et):"")+"Z";var Tt,Mt,bt,Dt,It,Nt,nr,dr,Sr,Ar,Kr,Jr,cn=0,an=0,jn=[];if((Dt=(+ue.apply(this,arguments)||0)/2)&&(bt=F===Di?Math.sqrt(Le*Le+qe*qe):+F.apply(this,arguments),Et||(an*=-1),qe&&(an=Ve(bt/qe*Math.sin(Dt))),Le&&(cn=Ve(bt/Le*Math.sin(Dt)))),qe){It=qe*Math.cos(Qe+an),Nt=qe*Math.sin(Qe+an),nr=qe*Math.cos(at-an),dr=qe*Math.sin(at-an);var Wn=Math.abs(at-Qe-2*an)<=Bt?0:1;if(an&&ri(It,Nt,nr,dr)===Et^Wn){var ui=(Qe+at)/2;It=qe*Math.cos(ui),Nt=qe*Math.sin(ui),nr=dr=null}}else It=Nt=0;if(Le){Sr=Le*Math.cos(at-cn),Ar=Le*Math.sin(at-cn),Kr=Le*Math.cos(Qe+cn),Jr=Le*Math.sin(Qe+cn);var Gr=Math.abs(Qe-at+2*cn)<=Bt?0:1;if(cn&&ri(Sr,Ar,Kr,Jr)===1-Et^Gr){var Tn=(Qe+at)/2;Sr=Le*Math.cos(Tn),Ar=Le*Math.sin(Tn),Kr=Jr=null}}else Sr=Ar=0;if(_t>mt&&(Tt=Math.min(Math.abs(qe-Le)/2,+D.apply(this,arguments)))>.001){Mt=Le<qe^Et?0:1;var Xn=Tt,Hn=Tt;if(_t<Bt){var ni=null==Kr?[Sr,Ar]:null==nr?[It,Nt]:vn([It,Nt],[Kr,Jr],[nr,dr],[Sr,Ar]),hi=It-ni[0],Si=Nt-ni[1],$n=nr-ni[0],xi=dr-ni[1],mi=1/Math.sin(Math.acos((hi*$n+Si*xi)/(Math.sqrt(hi*hi+Si*Si)*Math.sqrt($n*$n+xi*xi)))/2),Ci=Math.sqrt(ni[0]*ni[0]+ni[1]*ni[1]);Hn=Math.min(Tt,(Le-Ci)/(mi-1)),Xn=Math.min(Tt,(qe-Ci)/(mi+1))}if(null!=nr){var bi=Wi(null==Kr?[Sr,Ar]:[Kr,Jr],[It,Nt],qe,Xn,Et),Pi=Wi([nr,dr],[Sr,Ar],qe,Xn,Et);Tt===Xn?jn.push("M",bi[0],"A",Xn,",",Xn," 0 0,",Mt," ",bi[1],"A",qe,",",qe," 0 ",1-Et^ri(bi[1][0],bi[1][1],Pi[1][0],Pi[1][1]),",",Et," ",Pi[1],"A",Xn,",",Xn," 0 0,",Mt," ",Pi[0]):jn.push("M",bi[0],"A",Xn,",",Xn," 0 1,",Mt," ",Pi[0])}else jn.push("M",It,",",Nt);if(null!=Kr){var Ui=Wi([It,Nt],[Kr,Jr],Le,-Hn,Et),ca=Wi([Sr,Ar],null==nr?[It,Nt]:[nr,dr],Le,-Hn,Et);Tt===Hn?jn.push("L",ca[0],"A",Hn,",",Hn," 0 0,",Mt," ",ca[1],"A",Le,",",Le," 0 ",Et^ri(ca[1][0],ca[1][1],Ui[1][0],Ui[1][1]),",",1-Et," ",Ui[1],"A",Hn,",",Hn," 0 0,",Mt," ",Ui[0]):jn.push("L",ca[0],"A",Hn,",",Hn," 0 0,",Mt," ",Ui[0])}else jn.push("L",Sr,",",Ar)}else jn.push("M",It,",",Nt),null!=nr&&jn.push("A",qe,",",qe," 0 ",Wn,",",Et," ",nr,",",dr),jn.push("L",Sr,",",Ar),null!=Kr&&jn.push("A",Le,",",Le," 0 ",Gr,",",1-Et," ",Kr,",",Jr);return jn.push("Z"),jn.join("")}function be(Le,qe){return"M0,"+Le+"A"+Le+","+Le+" 0 1,"+qe+" 0,"+-Le+"A"+Le+","+Le+" 0 1,"+qe+" 0,"+Le}return me.innerRadius=function(Le){return arguments.length?(ce=gr(Le),me):ce},me.outerRadius=function(Le){return arguments.length?(C=gr(Le),me):C},me.cornerRadius=function(Le){return arguments.length?(D=gr(Le),me):D},me.padRadius=function(Le){return arguments.length?(F=Le==Di?Di:gr(Le),me):F},me.startAngle=function(Le){return arguments.length?(H=gr(Le),me):H},me.endAngle=function(Le){return arguments.length?(ae=gr(Le),me):ae},me.padAngle=function(Le){return arguments.length?(ue=gr(Le),me):ue},me.centroid=function(){var Le=(+ce.apply(this,arguments)+ +C.apply(this,arguments))/2,qe=(+H.apply(this,arguments)+ +ae.apply(this,arguments))/2-Wt;return[Math.cos(qe)*Le,Math.sin(qe)*Le]},me};var Di="auto";function Ei(ce){return ce.innerRadius}function di(ce){return ce.outerRadius}function zi(ce){return ce.startAngle}function Mi(ce){return ce.endAngle}function $i(ce){return ce&&ce.padAngle}function ri(ce,C,D,F){return(ce-D)*C-(C-F)*ce>0?0:1}function Wi(ce,C,D,F,H){var ae=ce[0]-C[0],ue=ce[1]-C[1],me=(H?F:-F)/Math.sqrt(ae*ae+ue*ue),be=me*ue,Le=-me*ae,qe=ce[0]+be,Qe=ce[1]+Le,at=C[0]+be,_t=C[1]+Le,Et=(qe+at)/2,Tt=(Qe+_t)/2,Mt=at-qe,bt=_t-Qe,Dt=Mt*Mt+bt*bt,It=D-F,Nt=qe*_t-at*Qe,nr=(bt<0?-1:1)*Math.sqrt(Math.max(0,It*It*Dt-Nt*Nt)),dr=(Nt*bt-Mt*nr)/Dt,Sr=(-Nt*Mt-bt*nr)/Dt,Ar=(Nt*bt+Mt*nr)/Dt,Kr=(-Nt*Mt+bt*nr)/Dt,Jr=dr-Et,cn=Sr-Tt,an=Ar-Et,jn=Kr-Tt;return Jr*Jr+cn*cn>an*an+jn*jn&&(dr=Ar,Sr=Kr),[[dr-be,Sr-Le],[dr*D/It,Sr*D/It]]}function Ba(){return!0}function Ho(ce){var C=Rr,D=hn,F=Ba,H=go,ae=H.key,ue=.7;function me(be){var Le,qe=[],Qe=[],at=-1,_t=be.length,Et=gr(C),Tt=gr(D);function Mt(){qe.push("M",H(ce(Qe),ue))}for(;++at<_t;)F.call(this,Le=be[at],at)?Qe.push([+Et.call(this,Le,at),+Tt.call(this,Le,at)]):Qe.length&&(Mt(),Qe=[]);return Qe.length&&Mt(),qe.length?qe.join(""):null}return me.x=function(be){return arguments.length?(C=be,me):C},me.y=function(be){return arguments.length?(D=be,me):D},me.defined=function(be){return arguments.length?(F=be,me):F},me.interpolate=function(be){return arguments.length?(ae="function"==typeof be?H=be:(H=Io.get(be)||go).key,me):ae},me.tension=function(be){return arguments.length?(ue=be,me):ue},me}g.svg.line=function(){return Ho(E)};var Io=g.map({linear:go,"linear-closed":vi,step:function(ce){for(var C=0,D=ce.length,F=ce[0],H=[F[0],",",F[1]];++C<D;)H.push("H",(F[0]+(F=ce[C])[0])/2,"V",F[1]);return D>1&&H.push("H",F[0]),H.join("")},"step-before":da,"step-after":mo,basis:Va,"basis-open":function(ce){if(ce.length<4)return go(ce);for(var C,D=[],F=-1,H=ce.length,ae=[0],ue=[0];++F<3;)ae.push((C=ce[F])[0]),ue.push(C[1]);for(D.push(ta($a,ae)+","+ta($a,ue)),--F;++F<H;)C=ce[F],ae.shift(),ae.push(C[0]),ue.shift(),ue.push(C[1]),rs(D,ae,ue);return D.join("")},"basis-closed":function(ce){for(var C,D,F=-1,H=ce.length,ae=H+4,ue=[],me=[];++F<4;)ue.push((D=ce[F%H])[0]),me.push(D[1]);for(C=[ta($a,ue),",",ta($a,me)],--F;++F<ae;)D=ce[F%H],ue.shift(),ue.push(D[0]),me.shift(),me.push(D[1]),rs(C,ue,me);return C.join("")},bundle:function(ce,C){var D=ce.length-1;if(D)for(var F,H,ae=ce[0][0],ue=ce[0][1],me=ce[D][0]-ae,be=ce[D][1]-ue,Le=-1;++Le<=D;)(F=ce[Le])[0]=C*F[0]+(1-C)*(ae+(H=Le/D)*me),F[1]=C*F[1]+(1-C)*(ue+H*be);return Va(ce)},cardinal:function(ce,C){return ce.length<3?go(ce):ce[0]+Xi(ce,wa(ce,C))},"cardinal-open":function(ce,C){return ce.length<4?go(ce):ce[1]+Xi(ce.slice(1,-1),wa(ce,C))},"cardinal-closed":function(ce,C){return ce.length<3?vi(ce):ce[0]+Xi((ce.push(ce[0]),ce),wa([ce[ce.length-2]].concat(ce,[ce[1]]),C))},monotone:function(ce){return ce.length<3?go(ce):ce[0]+Xi(ce,function(C){for(var D,F,H,ae,ue=[],me=function(qe){for(var Qe=0,at=qe.length-1,_t=[],Et=qe[0],Tt=qe[1],Mt=_t[0]=Jo(Et,Tt);++Qe<at;)_t[Qe]=(Mt+(Mt=Jo(Et=Tt,Tt=qe[Qe+1])))/2;return _t[Qe]=Mt,_t}(C),be=-1,Le=C.length-1;++be<Le;)D=Jo(C[be],C[be+1]),o(D)<mt?me[be]=me[be+1]=0:(ae=(F=me[be]/D)*F+(H=me[be+1]/D)*H)>9&&(ae=3*D/Math.sqrt(ae),me[be]=ae*F,me[be+1]=ae*H);for(be=-1;++be<=Le;)ae=(C[Math.min(Le,be+1)][0]-C[Math.max(0,be-1)][0])/(6*(1+me[be]*me[be])),ue.push([ae||0,me[be]*ae||0]);return ue}(ce))}});function go(ce){return ce.length>1?ce.join("L"):ce+"Z"}function vi(ce){return ce.join("L")+"Z"}function da(ce){for(var C=0,D=ce.length,F=ce[0],H=[F[0],",",F[1]];++C<D;)H.push("V",(F=ce[C])[1],"H",F[0]);return H.join("")}function mo(ce){for(var C=0,D=ce.length,F=ce[0],H=[F[0],",",F[1]];++C<D;)H.push("H",(F=ce[C])[0],"V",F[1]);return H.join("")}function Xi(ce,C){if(C.length<1||ce.length!=C.length&&ce.length!=C.length+2)return go(ce);var D=ce.length!=C.length,F="",H=ce[0],ae=ce[1],ue=C[0],me=ue,be=1;if(D&&(F+="Q"+(ae[0]-2*ue[0]/3)+","+(ae[1]-2*ue[1]/3)+","+ae[0]+","+ae[1],H=ce[1],be=2),C.length>1){ae=ce[be],be++,F+="C"+(H[0]+ue[0])+","+(H[1]+ue[1])+","+(ae[0]-(me=C[1])[0])+","+(ae[1]-me[1])+","+ae[0]+","+ae[1];for(var Le=2;Le<C.length;Le++,be++)F+="S"+((ae=ce[be])[0]-(me=C[Le])[0])+","+(ae[1]-me[1])+","+ae[0]+","+ae[1]}if(D){var qe=ce[be];F+="Q"+(ae[0]+2*me[0]/3)+","+(ae[1]+2*me[1]/3)+","+qe[0]+","+qe[1]}return F}function wa(ce,C){for(var D,F=[],H=(1-C)/2,ae=ce[0],ue=ce[1],me=1,be=ce.length;++me<be;)D=ae,ae=ue,F.push([H*((ue=ce[me])[0]-D[0]),H*(ue[1]-D[1])]);return F}function Va(ce){if(ce.length<3)return go(ce);var C=1,D=ce.length,F=ce[0],H=F[0],ae=F[1],ue=[H,H,H,(F=ce[1])[0]],me=[ae,ae,ae,F[1]],be=[H,",",ae,"L",ta($a,ue),",",ta($a,me)];for(ce.push(ce[D-1]);++C<=D;)F=ce[C],ue.shift(),ue.push(F[0]),me.shift(),me.push(F[1]),rs(be,ue,me);return ce.pop(),be.push("L",F),be.join("")}function ta(ce,C){return ce[0]*C[0]+ce[1]*C[1]+ce[2]*C[2]+ce[3]*C[3]}Io.forEach(function(ce,C){C.key=ce,C.closed=/-closed$/.test(ce)});var co=[0,2/3,1/3,0],ra=[0,1/3,2/3,0],$a=[0,1/6,2/3,1/6];function rs(ce,C,D){ce.push("C",ta(co,C),",",ta(co,D),",",ta(ra,C),",",ta(ra,D),",",ta($a,C),",",ta($a,D))}function Jo(ce,C){return(C[1]-ce[1])/(C[0]-ce[0])}function Is(ce){for(var C,D,F,H=-1,ae=ce.length;++H<ae;)D=(C=ce[H])[0],F=C[1]-Wt,C[0]=D*Math.cos(F),C[1]=D*Math.sin(F);return ce}function Oa(ce){var C=Rr,D=Rr,F=0,H=hn,ae=Ba,ue=go,me=ue.key,be=ue,Le="L",qe=.7;function Qe(at){var _t,Et,Tt,Mt=[],bt=[],Dt=[],It=-1,Nt=at.length,nr=gr(C),dr=gr(F),Sr=C===D?function(){return Et}:gr(D),Ar=F===H?function(){return Tt}:gr(H);function Kr(){Mt.push("M",ue(ce(Dt),qe),Le,be(ce(bt.reverse()),qe),"Z")}for(;++It<Nt;)ae.call(this,_t=at[It],It)?(bt.push([Et=+nr.call(this,_t,It),Tt=+dr.call(this,_t,It)]),Dt.push([+Sr.call(this,_t,It),+Ar.call(this,_t,It)])):bt.length&&(Kr(),bt=[],Dt=[]);return bt.length&&Kr(),Mt.length?Mt.join(""):null}return Qe.x=function(at){return arguments.length?(C=D=at,Qe):D},Qe.x0=function(at){return arguments.length?(C=at,Qe):C},Qe.x1=function(at){return arguments.length?(D=at,Qe):D},Qe.y=function(at){return arguments.length?(F=H=at,Qe):H},Qe.y0=function(at){return arguments.length?(F=at,Qe):F},Qe.y1=function(at){return arguments.length?(H=at,Qe):H},Qe.defined=function(at){return arguments.length?(ae=at,Qe):ae},Qe.interpolate=function(at){return arguments.length?(me="function"==typeof at?ue=at:(ue=Io.get(at)||go).key,be=ue.reverse||ue,Le=ue.closed?"M":"L",Qe):me},Qe.tension=function(at){return arguments.length?(qe=at,Qe):qe},Qe}function Os(ce){return ce.source}function Da(ce){return ce.target}function Ko(ce){return ce.radius}function ci(ce){return[ce.x,ce.y]}function yi(ce){return function(){var C=ce.apply(this,arguments),D=C[0],F=C[1]-Wt;return[D*Math.cos(F),D*Math.sin(F)]}}function Ds(){return 64}function zs(){return"circle"}function Qo(ce){var C=Math.sqrt(ce/Bt);return"M0,"+C+"A"+C+","+C+" 0 1,1 0,"+-C+"A"+C+","+C+" 0 1,1 0,"+C+"Z"}g.svg.line.radial=function(){var ce=Ho(Is);return ce.radius=ce.x,delete ce.x,ce.angle=ce.y,delete ce.y,ce},da.reverse=mo,mo.reverse=da,g.svg.area=function(){return Oa(E)},g.svg.area.radial=function(){var ce=Oa(Is);return ce.radius=ce.x,delete ce.x,ce.innerRadius=ce.x0,delete ce.x0,ce.outerRadius=ce.x1,delete ce.x1,ce.angle=ce.y,delete ce.y,ce.startAngle=ce.y0,delete ce.y0,ce.endAngle=ce.y1,delete ce.y1,ce},g.svg.chord=function(){var ce=Os,C=Da,D=Ko,F=zi,H=Mi;function ae(Le,qe){var Qe,at,_t=ue(this,ce,Le,qe),Et=ue(this,C,Le,qe);return"M"+_t.p0+me(_t.r,_t.p1,_t.a1-_t.a0)+((Qe=_t).a0==(at=Et).a0&&Qe.a1==at.a1?be(0,0,0,_t.p0):be(0,0,0,Et.p0)+me(Et.r,Et.p1,Et.a1-Et.a0)+be(0,0,0,_t.p0))+"Z"}function ue(Le,qe,Qe,at){var _t=qe.call(Le,Qe,at),Et=D.call(Le,_t,at),Tt=F.call(Le,_t,at)-Wt,Mt=H.call(Le,_t,at)-Wt;return{r:Et,a0:Tt,a1:Mt,p0:[Et*Math.cos(Tt),Et*Math.sin(Tt)],p1:[Et*Math.cos(Mt),Et*Math.sin(Mt)]}}function me(Le,qe,Qe){return"A"+Le+","+Le+" 0 "+ +(Qe>Bt)+",1 "+qe}function be(Le,qe,Qe,at){return"Q 0,0 "+at}return ae.radius=function(Le){return arguments.length?(D=gr(Le),ae):D},ae.source=function(Le){return arguments.length?(ce=gr(Le),ae):ce},ae.target=function(Le){return arguments.length?(C=gr(Le),ae):C},ae.startAngle=function(Le){return arguments.length?(F=gr(Le),ae):F},ae.endAngle=function(Le){return arguments.length?(H=gr(Le),ae):H},ae},g.svg.diagonal=function(){var ce=Os,C=Da,D=ci;function F(H,ae){var ue=ce.call(this,H,ae),me=C.call(this,H,ae),be=(ue.y+me.y)/2,Le=[ue,{x:ue.x,y:be},{x:me.x,y:be},me];return"M"+(Le=Le.map(D))[0]+"C"+Le[1]+" "+Le[2]+" "+Le[3]}return F.source=function(H){return arguments.length?(ce=gr(H),F):ce},F.target=function(H){return arguments.length?(C=gr(H),F):C},F.projection=function(H){return arguments.length?(D=H,F):D},F},g.svg.diagonal.radial=function(){var ce=g.svg.diagonal(),C=ci,D=ce.projection;return ce.projection=function(F){return arguments.length?D(yi(C=F)):C},ce},g.svg.symbol=function(){var ce=zs,C=Ds;function D(F,H){return(Eo.get(ce.call(this,F,H))||Qo)(C.call(this,F,H))}return D.type=function(F){return arguments.length?(ce=gr(F),D):ce},D.size=function(F){return arguments.length?(C=gr(F),D):C},D};var Eo=g.map({circle:Qo,cross:function(ce){var C=Math.sqrt(ce/5)/2;return"M"+-3*C+","+-C+"H"+-C+"V"+-3*C+"H"+C+"V"+-C+"H"+3*C+"V"+C+"H"+C+"V"+3*C+"H"+-C+"V"+C+"H"+-3*C+"Z"},diamond:function(ce){var C=Math.sqrt(ce/(2*Ys)),D=C*Ys;return"M0,"+-C+"L"+D+",0 0,"+C+" "+-D+",0Z"},square:function(ce){var C=Math.sqrt(ce)/2;return"M"+-C+","+-C+"L"+C+","+-C+" "+C+","+C+" "+-C+","+C+"Z"},"triangle-down":function(ce){var C=Math.sqrt(ce/Uo),D=C*Uo/2;return"M0,"+D+"L"+C+","+-D+" "+-C+","+-D+"Z"},"triangle-up":function(ce){var C=Math.sqrt(ce/Uo),D=C*Uo/2;return"M0,"+-D+"L"+C+","+D+" "+-C+","+D+"Z"}});g.svg.symbolTypes=Eo.keys();var Uo=Math.sqrt(3),Ys=Math.tan(30*rr);X.transition=function(ce){for(var C,D,F=us||++fs,H=Ts(ce),ae=[],ue=ns||{time:Date.now(),ease:ds,delay:0,duration:250},me=-1,be=this.length;++me<be;){ae.push(C=[]);for(var Le=this[me],qe=-1,Qe=Le.length;++qe<Qe;)(D=Le[qe])&&is(D,qe,H,F,ue),C.push(D)}return na(ae,H,F)},X.interrupt=function(ce){return this.each(null==ce?_s:Ji(Ts(ce)))};var _s=Ji(Ts());function Ji(ce){return function(){var C,D,F;(C=this[ce])&&(F=C[D=C.active])&&(F.timer.c=null,F.timer.t=NaN,--C.count?delete C[D]:delete this[ce],C.active+=.5,F.event&&F.event.interrupt.call(this,this.__data__,F.index))}}function na(ce,C,D){return N(ce,La),ce.namespace=C,ce.id=D,ce}var us,ns,La=[],fs=0;function ws(ce,C,D,F){var H=ce.id,ae=ce.namespace;return De(ce,"function"==typeof D?function(ue,me,be){ue[ae][H].tween.set(C,F(D.call(ue,ue.__data__,me,be)))}:(D=F(D),function(ue){ue[ae][H].tween.set(C,D)}))}function gs(ce){return null==ce&&(ce=""),function(){this.textContent=ce}}function Ts(ce){return null==ce?"__transition__":"__transition_"+ce+"__"}function is(ce,C,D,F,H){var ae,ue,me,be,Le,qe=ce[D]||(ce[D]={active:0,count:0}),Qe=qe[F];function at(Et){var Tt=qe.active,Mt=qe[Tt];for(var bt in Mt&&(Mt.timer.c=null,Mt.timer.t=NaN,--qe.count,delete qe[Tt],Mt.event&&Mt.event.interrupt.call(ce,ce.__data__,Mt.index)),qe)if(+bt<F){var Dt=qe[bt];Dt.timer.c=null,Dt.timer.t=NaN,--qe.count,delete qe[bt]}ue.c=_t,gn(function(){return ue.c&&_t(Et||1)&&(ue.c=null,ue.t=NaN),1},0,ae),qe.active=F,Qe.event&&Qe.event.start.call(ce,ce.__data__,C),Le=[],Qe.tween.forEach(function(It,Nt){(Nt=Nt.call(ce,ce.__data__,C))&&Le.push(Nt)}),be=Qe.ease,me=Qe.duration}function _t(Et){for(var Tt=Et/me,Mt=be(Tt),bt=Le.length;bt>0;)Le[--bt].call(ce,Mt);if(Tt>=1)return Qe.event&&Qe.event.end.call(ce,ce.__data__,C),--qe.count?delete qe[F]:delete ce[D],1}Qe||(ue=gn(function(Et){var Tt=Qe.delay;if(ue.t=Tt+ae,Tt<=Et)return at(Et-Tt);ue.c=at},0,ae=H.time),Qe=qe[F]={tween:new T,time:ae,timer:ue,delay:H.delay,duration:H.duration,ease:H.ease,index:C},H=null,++qe.count)}La.call=X.call,La.empty=X.empty,La.node=X.node,La.size=X.size,g.transition=function(ce,C){return ce&&ce.transition?us?ce.transition(C):ce:g.selection().transition(ce)},g.transition.prototype=La,La.select=function(ce){var C,D,F,H=this.id,ae=this.namespace,ue=[];ce=re(ce);for(var me=-1,be=this.length;++me<be;){ue.push(C=[]);for(var Le=this[me],qe=-1,Qe=Le.length;++qe<Qe;)(F=Le[qe])&&(D=ce.call(F,F.__data__,qe,me))?("__data__"in F&&(D.__data__=F.__data__),is(D,qe,ae,H,F[ae][H]),C.push(D)):C.push(null)}return na(ue,ae,H)},La.selectAll=function(ce){var C,D,F,H,ae,ue=this.id,me=this.namespace,be=[];ce=ne(ce);for(var Le=-1,qe=this.length;++Le<qe;)for(var Qe=this[Le],at=-1,_t=Qe.length;++at<_t;)if(F=Qe[at]){ae=F[me][ue],D=ce.call(F,F.__data__,at,Le),be.push(C=[]);for(var Et=-1,Tt=D.length;++Et<Tt;)(H=D[Et])&&is(H,Et,me,ue,ae),C.push(H)}return na(be,me,ue)},La.filter=function(ce){var C,D,F=[];"function"!=typeof ce&&(ce=Pe(ce));for(var H=0,ae=this.length;H<ae;H++){F.push(C=[]);for(var ue,me=0,be=(ue=this[H]).length;me<be;me++)(D=ue[me])&&ce.call(D,D.__data__,me,H)&&C.push(D)}return na(F,this.namespace,this.id)},La.tween=function(ce,C){var D=this.id,F=this.namespace;return arguments.length<2?this.node()[F][D].tween.get(ce):De(this,null==C?function(H){H[F][D].tween.remove(ce)}:function(H){H[F][D].tween.set(ce,C)})},La.attr=function(ce,C){if(arguments.length<2){for(C in ce)this.attr(C,ce[C]);return this}var D="transform"==ce?jo:Ra,F=g.ns.qualify(ce);function H(){this.removeAttribute(F)}function ae(){this.removeAttributeNS(F.space,F.local)}function ue(be){return null==be?H:(be+="",function(){var Le,qe=this.getAttribute(F);return qe!==be&&(Le=D(qe,be),function(Qe){this.setAttribute(F,Le(Qe))})})}function me(be){return null==be?ae:(be+="",function(){var Le,qe=this.getAttributeNS(F.space,F.local);return qe!==be&&(Le=D(qe,be),function(Qe){this.setAttributeNS(F.space,F.local,Le(Qe))})})}return ws(this,"attr."+ce,C,F.local?me:ue)},La.attrTween=function(ce,C){var D=g.ns.qualify(ce);return this.tween("attr."+ce,D.local?function(F,H){var ae=C.call(this,F,H,this.getAttributeNS(D.space,D.local));return ae&&function(ue){this.setAttributeNS(D.space,D.local,ae(ue))}}:function(F,H){var ae=C.call(this,F,H,this.getAttribute(D));return ae&&function(ue){this.setAttribute(D,ae(ue))}})},La.style=function(ce,C,D){var F=arguments.length;if(F<3){if("string"!=typeof ce){for(D in F<2&&(C=""),ce)this.style(D,ce[D],C);return this}D=""}function H(){this.style.removeProperty(ce)}function ae(ue){return null==ue?H:(ue+="",function(){var me,be=n(this).getComputedStyle(this,null).getPropertyValue(ce);return be!==ue&&(me=Ra(be,ue),function(Le){this.style.setProperty(ce,me(Le),D)})})}return ws(this,"style."+ce,C,ae)},La.styleTween=function(ce,C,D){function F(H,ae){var ue=C.call(this,H,ae,n(this).getComputedStyle(this,null).getPropertyValue(ce));return ue&&function(me){this.style.setProperty(ce,ue(me),D)}}return arguments.length<3&&(D=""),this.tween("style."+ce,F)},La.text=function(ce){return ws(this,"text",ce,gs)},La.remove=function(){var ce=this.namespace;return this.each("end.transition",function(){var C;this[ce].count<2&&(C=this.parentNode)&&C.removeChild(this)})},La.ease=function(ce){var C=this.id,D=this.namespace;return arguments.length<1?this.node()[D][C].ease:("function"!=typeof ce&&(ce=g.ease.apply(g,arguments)),De(this,function(F){F[D][C].ease=ce}))},La.delay=function(ce){var C=this.id,D=this.namespace;return arguments.length<1?this.node()[D][C].delay:De(this,"function"==typeof ce?function(F,H,ae){F[D][C].delay=+ce.call(F,F.__data__,H,ae)}:(ce=+ce,function(F){F[D][C].delay=ce}))},La.duration=function(ce){var C=this.id,D=this.namespace;return arguments.length<1?this.node()[D][C].duration:De(this,"function"==typeof ce?function(F,H,ae){F[D][C].duration=Math.max(1,ce.call(F,F.__data__,H,ae))}:(ce=Math.max(1,ce),function(F){F[D][C].duration=ce}))},La.each=function(ce,C){var D=this.id,F=this.namespace;if(arguments.length<2){var H=ns,ae=us;try{us=D,De(this,function(ue,me,be){ns=ue[F][D],ce.call(ue,ue.__data__,me,be)})}finally{ns=H,us=ae}}else De(this,function(ue){var me=ue[F][D];(me.event||(me.event=g.dispatch("start","end","interrupt"))).on(ce,C)});return this},La.transition=function(){for(var ce,C,D,F=this.id,H=++fs,ae=this.namespace,ue=[],me=0,be=this.length;me<be;me++){ue.push(ce=[]);for(var Le,qe=0,Qe=(Le=this[me]).length;qe<Qe;qe++)(C=Le[qe])&&is(C,qe,ae,H,{time:(D=C[ae][F]).time,ease:D.ease,delay:D.delay+D.duration,duration:D.duration}),ce.push(C)}return na(ue,ae,H)},g.svg.axis=function(){var ce,C=g.scale.linear(),D=Ws,F=6,H=6,ae=3,ue=[10],me=null;function be(Le){Le.each(function(){var qe,Qe=g.select(this),at=this.__chart__||C,_t=this.__chart__=C.copy(),Et=me??(_t.ticks?_t.ticks.apply(_t,ue):_t.domain()),Tt=ce??(_t.tickFormat?_t.tickFormat.apply(_t,ue):E),Mt=Qe.selectAll(".tick").data(Et,_t),bt=Mt.enter().insert("g",".domain").attr("class","tick").style("opacity",mt),Dt=g.transition(Mt.exit()).style("opacity",mt).remove(),It=g.transition(Mt.order()).style("opacity",1),Nt=Math.max(F,0)+ae,nr=on(_t),dr=Qe.selectAll(".domain").data([0]),Sr=(dr.enter().append("path").attr("class","domain"),g.transition(dr));bt.append("line"),bt.append("text");var Ar,Kr,Jr,cn,an=bt.select("line"),jn=It.select("line"),Wn=Mt.select("text").text(Tt),ui=bt.select("text"),Gr=It.select("text"),Tn="top"===D||"left"===D?-1:1;if("bottom"===D||"top"===D?(qe=hs,Ar="x",Jr="y",Kr="x2",cn="y2",Wn.attr("dy",Tn<0?"0em":".71em").style("text-anchor","middle"),Sr.attr("d","M"+nr[0]+","+Tn*H+"V0H"+nr[1]+"V"+Tn*H)):(qe=Xs,Ar="y",Jr="x",Kr="y2",cn="x2",Wn.attr("dy",".32em").style("text-anchor",Tn<0?"end":"start"),Sr.attr("d","M"+Tn*H+","+nr[0]+"H0V"+nr[1]+"H"+Tn*H)),an.attr(cn,Tn*F),ui.attr(Jr,Tn*Nt),jn.attr(Kr,0).attr(cn,Tn*F),Gr.attr(Ar,0).attr(Jr,Tn*Nt),_t.rangeBand){var Xn=_t,Hn=Xn.rangeBand()/2;at=_t=function(ni){return Xn(ni)+Hn}}else at.rangeBand?at=_t:Dt.call(qe,_t,at);bt.call(qe,at,_t),It.call(qe,_t,_t)})}return be.scale=function(Le){return arguments.length?(C=Le,be):C},be.orient=function(Le){return arguments.length?(D=Le in il?Le+"":Ws,be):D},be.ticks=function(){return arguments.length?(ue=m(arguments),be):ue},be.tickValues=function(Le){return arguments.length?(me=Le,be):me},be.tickFormat=function(Le){return arguments.length?(ce=Le,be):ce},be.tickSize=function(Le){var qe=arguments.length;return qe?(F=+Le,H=+arguments[qe-1],be):F},be.innerTickSize=function(Le){return arguments.length?(F=+Le,be):F},be.outerTickSize=function(Le){return arguments.length?(H=+Le,be):H},be.tickPadding=function(Le){return arguments.length?(ae=+Le,be):ae},be.tickSubdivide=function(){return arguments.length&&be},be};var Ws="bottom",il={top:1,right:1,bottom:1,left:1};function hs(ce,C,D){ce.attr("transform",function(F){var H=C(F);return"translate("+(isFinite(H)?H:D(F))+",0)"})}function Xs(ce,C,D){ce.attr("transform",function(F){var H=C(F);return"translate(0,"+(isFinite(H)?H:D(F))+")"})}g.svg.brush=function(){var ce,C,D=$(qe,"brushstart","brush","brushend"),F=null,H=null,ae=[0,0],ue=[0,0],me=!0,be=!0,Le=eo[0];function qe(Tt){Tt.each(function(){var Mt=g.select(this).style("pointer-events","all").style("-webkit-tap-highlight-color","rgba(0,0,0,0)").on("mousedown.brush",Et).on("touchstart.brush",Et),bt=Mt.selectAll(".background").data([0]);bt.enter().append("rect").attr("class","background").style("visibility","hidden").style("cursor","crosshair"),Mt.selectAll(".extent").data([0]).enter().append("rect").attr("class","extent").style("cursor","move");var Dt=Mt.selectAll(".resize").data(Le,E);Dt.exit().remove(),Dt.enter().append("g").attr("class",function(dr){return"resize "+dr}).style("cursor",function(dr){return ks[dr]}).append("rect").attr("x",function(dr){return/[ew]$/.test(dr)?-3:null}).attr("y",function(dr){return/^[ns]/.test(dr)?-3:null}).attr("width",6).attr("height",6).style("visibility","hidden"),Dt.style("display",qe.empty()?"none":null);var It,Nt=g.transition(Mt),nr=g.transition(bt);F&&(It=on(F),nr.attr("x",It[0]).attr("width",It[1]-It[0]),at(Nt)),H&&(It=on(H),nr.attr("y",It[0]).attr("height",It[1]-It[0]),_t(Nt)),Qe(Nt)})}function Qe(Tt){Tt.selectAll(".resize").attr("transform",function(Mt){return"translate("+ae[+/e$/.test(Mt)]+","+ue[+/^s/.test(Mt)]+")"})}function at(Tt){Tt.select(".extent").attr("x",ae[0]),Tt.selectAll(".extent,.n>rect,.s>rect").attr("width",ae[1]-ae[0])}function _t(Tt){Tt.select(".extent").attr("y",ue[0]),Tt.selectAll(".extent,.e>rect,.w>rect").attr("height",ue[1]-ue[0])}function Et(){var Tt,Mt,bt=this,Dt=g.select(g.event.target),It=D.of(bt,arguments),Nt=g.select(bt),nr=Dt.datum(),dr=!/^(n|s)$/.test(nr)&&F,Sr=!/^(e|w)$/.test(nr)&&H,Ar=Dt.classed("extent"),Kr=xt(bt),Jr=g.mouse(bt),cn=g.select(n(bt)).on("keydown.brush",Wn).on("keyup.brush",ui);if(g.event.changedTouches?cn.on("touchmove.brush",Gr).on("touchend.brush",Xn):cn.on("mousemove.brush",Gr).on("mouseup.brush",Xn),Nt.interrupt().selectAll("*").interrupt(),Ar)Jr[0]=ae[0]-Jr[0],Jr[1]=ue[0]-Jr[1];else if(nr){var an=+/w$/.test(nr),jn=+/^n/.test(nr);Mt=[ae[1-an]-Jr[0],ue[1-jn]-Jr[1]],Jr[0]=ae[an],Jr[1]=ue[jn]}else g.event.altKey&&(Tt=Jr.slice());function Wn(){32==g.event.keyCode&&(Ar||(Tt=null,Jr[0]-=ae[1],Jr[1]-=ue[1],Ar=2),G())}function ui(){32==g.event.keyCode&&2==Ar&&(Jr[0]+=ae[1],Jr[1]+=ue[1],Ar=0,G())}function Gr(){var Hn=g.mouse(bt),ni=!1;Mt&&(Hn[0]+=Mt[0],Hn[1]+=Mt[1]),Ar||(g.event.altKey?(Tt||(Tt=[(ae[0]+ae[1])/2,(ue[0]+ue[1])/2]),Jr[0]=ae[+(Hn[0]<Tt[0])],Jr[1]=ue[+(Hn[1]<Tt[1])]):Tt=null),dr&&Tn(Hn,F,0)&&(at(Nt),ni=!0),Sr&&Tn(Hn,H,1)&&(_t(Nt),ni=!0),ni&&(Qe(Nt),It({type:"brush",mode:Ar?"move":"resize"}))}function Tn(Hn,ni,hi){var Si,$n,xi=on(ni),mi=xi[0],Ci=xi[1],bi=Jr[hi],Pi=hi?ue:ae,Ui=Pi[1]-Pi[0];if(Ar&&(mi-=bi,Ci-=Ui+bi),Si=(hi?be:me)?Math.max(mi,Math.min(Ci,Hn[hi])):Hn[hi],Ar?$n=(Si+=bi)+Ui:(Tt&&(bi=Math.max(mi,Math.min(Ci,2*Tt[hi]-Si))),bi<Si?($n=Si,Si=bi):$n=bi),Pi[0]!=Si||Pi[1]!=$n)return hi?C=null:ce=null,Pi[0]=Si,Pi[1]=$n,!0}function Xn(){Gr(),Nt.style("pointer-events","all").selectAll(".resize").style("display",qe.empty()?"none":null),g.select("body").style("cursor",null),cn.on("mousemove.brush",null).on("mouseup.brush",null).on("touchmove.brush",null).on("touchend.brush",null).on("keydown.brush",null).on("keyup.brush",null),Kr(),It({type:"brushend"})}Nt.style("pointer-events","none").selectAll(".resize").style("display",null),g.select("body").style("cursor",Dt.style("cursor")),It({type:"brushstart"}),Gr()}return qe.event=function(Tt){Tt.each(function(){var Mt=D.of(this,arguments),bt={x:ae,y:ue,i:ce,j:C},Dt=this.__chart__||bt;this.__chart__=bt,us?g.select(this).transition().each("start.brush",function(){ce=Dt.i,C=Dt.j,ae=Dt.x,ue=Dt.y,Mt({type:"brushstart"})}).tween("brush:brush",function(){var It=pa(ae,bt.x),Nt=pa(ue,bt.y);return ce=C=null,function(nr){ae=bt.x=It(nr),ue=bt.y=Nt(nr),Mt({type:"brush",mode:"resize"})}}).each("end.brush",function(){ce=bt.i,C=bt.j,Mt({type:"brush",mode:"resize"}),Mt({type:"brushend"})}):(Mt({type:"brushstart"}),Mt({type:"brush",mode:"resize"}),Mt({type:"brushend"}))})},qe.x=function(Tt){return arguments.length?(Le=eo[!(F=Tt)<<1|!H],qe):F},qe.y=function(Tt){return arguments.length?(Le=eo[!F<<1|!(H=Tt)],qe):H},qe.clamp=function(Tt){return arguments.length?(F&&H?(me=!!Tt[0],be=!!Tt[1]):F?me=!!Tt:H&&(be=!!Tt),qe):F&&H?[me,be]:F?me:H?be:null},qe.extent=function(Tt){var Mt,bt,Dt,It,Nt;return arguments.length?(F&&(Mt=Tt[0],bt=Tt[1],H&&(Mt=Mt[0],bt=bt[0]),ce=[Mt,bt],F.invert&&(Mt=F(Mt),bt=F(bt)),bt<Mt&&(Nt=Mt,Mt=bt,bt=Nt),Mt==ae[0]&&bt==ae[1]||(ae=[Mt,bt])),H&&(Dt=Tt[0],It=Tt[1],F&&(Dt=Dt[1],It=It[1]),C=[Dt,It],H.invert&&(Dt=H(Dt),It=H(It)),It<Dt&&(Nt=Dt,Dt=It,It=Nt),Dt==ue[0]&&It==ue[1]||(ue=[Dt,It])),qe):(F&&(ce?(Mt=ce[0],bt=ce[1]):(Mt=ae[0],bt=ae[1],F.invert&&(Mt=F.invert(Mt),bt=F.invert(bt)),bt<Mt&&(Nt=Mt,Mt=bt,bt=Nt))),H&&(C?(Dt=C[0],It=C[1]):(Dt=ue[0],It=ue[1],H.invert&&(Dt=H.invert(Dt),It=H.invert(It)),It<Dt&&(Nt=Dt,Dt=It,It=Nt))),F&&H?[[Mt,Dt],[bt,It]]:F?[Mt,bt]:H&&[Dt,It])},qe.clear=function(){return qe.empty()||(ae=[0,0],ue=[0,0],ce=C=null),qe},qe.empty=function(){return!!F&&ae[0]==ae[1]||!!H&&ue[0]==ue[1]},g.rebind(qe,D,"on")};var ks={n:"ns-resize",e:"ew-resize",s:"ns-resize",w:"ew-resize",nw:"nwse-resize",ne:"nesw-resize",se:"nwse-resize",sw:"nesw-resize"},eo=[["n","e","s","w","nw","ne","se","sw"],["e","w"],["n","s"],[]];function al(ce){return JSON.parse(ce.responseText)}function ol(ce){var C=x.createRange();return C.selectNode(x.body),C.createContextualFragment(ce.responseText)}g.text=Tr(function(ce){return ce.responseText}),g.json=function(ce,C){return Fr(ce,"application/json",al,C)},g.html=function(ce,C){return Fr(ce,"text/html",ol,C)},g.xml=Tr(function(ce){return ce.responseXML}),"object"==typeof ee&&ee.exports?ee.exports=g:this.d3=g}).apply(self)},{}],59:[function(y,ee,Q){"use strict";ee.exports=y("./quad")},{"./quad":60}],60:[function(y,ee,Q){"use strict";var g=y("binary-search-bounds"),v=y("clamp"),m=y("parse-rect"),x=y("array-bounds"),e=y("pick-by-alias"),n=y("defined"),t=y("flatten-vertex-data"),a=y("is-obj"),r=y("dtype"),d=y("math-log2");function s(i,u){for(var f=u[0],c=u[1],h=1/(u[2]-f),p=1/(u[3]-c),o=new Array(i.length),b=0,l=i.length/2;b<l;b++)o[2*b]=v((i[2*b]-f)*h,0,1),o[2*b+1]=v((i[2*b+1]-c)*p,0,1);return o}ee.exports=function(i,u){u||(u={}),i=t(i,"float64"),u=e(u,{bounds:"range bounds dataBox databox",maxDepth:"depth maxDepth maxdepth level maxLevel maxlevel levels",dtype:"type dtype format out dst output destination"});var f=n(u.maxDepth,255),c=n(u.bounds,x(i,2));c[0]===c[2]&&c[2]++,c[1]===c[3]&&c[3]++;var h,p=s(i,c),o=i.length>>>1;u.dtype||(u.dtype="array"),"string"==typeof u.dtype?h=new(r(u.dtype))(o):u.dtype&&(h=u.dtype,Array.isArray(h)&&(h.length=o));for(var b=0;b<o;++b)h[b]=b;var l=[],T=[],_=[],w=[];!function R(q,V,W,K,G,Y){if(!K.length)return null;var $=l[G]||(l[G]=[]),B=_[G]||(_[G]=[]),N=T[G]||(T[G]=[]),U=$.length;if(++G>f||Y>1073741824){for(var te=0;te<K.length;te++)$.push(K[te]),B.push(Y),N.push(null,null,null,null);return U}if($.push(K[0]),B.push(Y),K.length<=1)return N.push(null,null,null,null),U;for(var j=.5*W,J=q+j,X=V+j,re=[],ne=[],le=[],oe=[],de=1,se=K.length;de<se;de++){var ge=K[de],Te=p[2*ge+1];p[2*ge]<J?Te<X?re.push(ge):ne.push(ge):Te<X?le.push(ge):oe.push(ge)}return N.push(R(q,V,j,re,G,Y<<=2),R(q,X,j,ne,G,Y+1),R(J,V,j,le,G,Y+2),R(J,X,j,oe,G,Y+3)),U}(0,0,1,h,0,1);for(var k=0,L=0;L<l.length;L++){var M=l[L];if(h.set)h.set(M,k);else for(var I=0,P=M.length;I<P;I++)h[I+k]=M[I];var S=k+l[L].length;w[L]=[k,S],k=S}return h.range=function(){for(var R,q=[],V=arguments.length;V--;)q[V]=arguments[V];if(a(q[q.length-1])){var W=q.pop();q.length||null==W.x&&null==W.l&&null==W.left||(q=[W],R={}),R=e(W,{level:"level maxLevel",d:"d diam diameter r radius px pxSize pixel pixelSize maxD size minSize",lod:"lod details ranges offsets"})}else R={};q.length||(q=c);var ne,K=m.apply(void 0,q),G=[Math.min(K.x,K.x+K.width),Math.min(K.y,K.y+K.height),Math.max(K.x,K.x+K.width),Math.max(K.y,K.y+K.height)],Y=G[0],$=G[1],B=G[2],N=G[3],U=s([Y,$,B,N],c),te=U[0],j=U[1],J=U[2],X=U[3],re=n(R.level,l.length);if(null!=R.d&&("number"==typeof R.d?ne=[R.d,R.d]:R.d.length&&(ne=R.d),re=Math.min(Math.max(Math.ceil(-d(Math.abs(ne[0])/(c[2]-c[0]))),Math.ceil(-d(Math.abs(ne[1])/(c[3]-c[1])))),re)),re=Math.min(re,l.length),R.lod)return E(te,j,J,X,re);var le=[];function oe(se,ge,_e,Te,we,Oe){if(null!==we&&null!==Oe&&!(te>se+_e||j>ge+_e||J<se||X<ge||Te>=re||we===Oe)){var fe=l[Te];void 0===Oe&&(Oe=fe.length);for(var ve=we;ve<Oe;ve++){var Ae=fe[ve],ke=i[2*Ae],Pe=i[2*Ae+1];ke>=Y&&ke<=B&&Pe>=$&&Pe<=N&&le.push(Ae)}var Ne=T[Te],De=Ne[4*we+0],ze=Ne[4*we+1],Me=Ne[4*we+2],Se=Ne[4*we+3],Ie=de(Ne,we+1),Fe=.5*_e,Re=Te+1;oe(se,ge,Fe,Re,De,ze||Me||Se||Ie),oe(se,ge+Fe,Fe,Re,ze,Me||Se||Ie),oe(se+Fe,ge,Fe,Re,Me,Se||Ie),oe(se+Fe,ge+Fe,Fe,Re,Se,Ie)}}function de(se,ge){for(var _e=null,Te=0;null===_e;)if(_e=se[4*ge+Te],++Te>se.length)return null;return _e}return oe(0,0,1,0,0,1),le},h;function E(R,q,V,W,K){for(var G=[],Y=0;Y<K;Y++){var $=_[Y],B=w[Y][0],N=z(R,q,Y),U=z(V,W,Y),te=g.ge($,N),j=g.gt($,U,te,$.length-1);G[Y]=[te+B,j+B]}return G}function z(R,q,V){for(var W=1,K=.5,G=.5,Y=.5,$=0;$<V;$++)W<<=2,W+=R<K?q<G?0:1:q<G?2:3,Y*=.5,K+=R<K?-Y:Y,G+=q<G?-Y:Y;return W}}},{"array-bounds":71,"binary-search-bounds":80,clamp:86,defined:124,dtype:127,"flatten-vertex-data":191,"is-obj":235,"math-log2":240,"parse-rect":249,"pick-by-alias":253}],61:[function(y,ee,Q){"use strict";Object.defineProperty(Q,"__esModule",{value:!0});var g=y("@turf/meta");function v(e){var n=0;if(e&&e.length>0){n+=Math.abs(m(e[0]));for(var t=1;t<e.length;t++)n-=Math.abs(m(e[t]))}return n}function m(e){var n,t,a,r,d,s,i=0,u=e.length;if(u>2){for(s=0;s<u;s++)s===u-2?(a=u-2,r=u-1,d=0):s===u-1?(a=u-1,r=0,d=1):(a=s,r=s+1,d=s+2),n=e[a],t=e[r],i+=(x(e[d][0])-x(n[0]))*Math.sin(x(t[1]));i=6378137*i*6378137/2}return i}function x(e){return e*Math.PI/180}Q.default=function(e){return g.geomReduce(e,function(n,t){return n+function(a){var r,d=0;switch(a.type){case"Polygon":return v(a.coordinates);case"MultiPolygon":for(r=0;r<a.coordinates.length;r++)d+=v(a.coordinates[r]);return d;case"Point":case"MultiPoint":case"LineString":case"MultiLineString":return 0}return 0}(t)},0)}},{"@turf/meta":63}],62:[function(y,ee,Q){"use strict";function g(u,f,c){void 0===c&&(c={});var h={type:"Feature"};return(0===c.id||c.id)&&(h.id=c.id),c.bbox&&(h.bbox=c.bbox),h.properties=f||{},h.geometry=u,h}function v(u,f,c){if(void 0===c&&(c={}),!u)throw new Error("coordinates is required");if(!Array.isArray(u))throw new Error("coordinates must be an Array");if(u.length<2)throw new Error("coordinates must be at least 2 numbers long");if(!i(u[0])||!i(u[1]))throw new Error("coordinates must contain numbers");return g({type:"Point",coordinates:u},f,c)}function m(u,f,c){void 0===c&&(c={});for(var h=0,p=u;h<p.length;h++){var o=p[h];if(o.length<4)throw new Error("Each LinearRing of a Polygon must have 4 or more Positions.");for(var b=0;b<o[o.length-1].length;b++)if(o[o.length-1][b]!==o[0][b])throw new Error("First and last Position are not equivalent.")}return g({type:"Polygon",coordinates:u},f,c)}function x(u,f,c){if(void 0===c&&(c={}),u.length<2)throw new Error("coordinates must be an array of two or more positions");return g({type:"LineString",coordinates:u},f,c)}function e(u,f){void 0===f&&(f={});var c={type:"FeatureCollection"};return f.id&&(c.id=f.id),f.bbox&&(c.bbox=f.bbox),c.features=u,c}function n(u,f,c){return void 0===c&&(c={}),g({type:"MultiLineString",coordinates:u},f,c)}function t(u,f,c){return void 0===c&&(c={}),g({type:"MultiPoint",coordinates:u},f,c)}function a(u,f,c){return void 0===c&&(c={}),g({type:"MultiPolygon",coordinates:u},f,c)}function r(u,f){void 0===f&&(f="kilometers");var c=Q.factors[f];if(!c)throw new Error(f+" units is invalid");return u*c}function d(u,f){void 0===f&&(f="kilometers");var c=Q.factors[f];if(!c)throw new Error(f+" units is invalid");return u/c}function s(u){return u%(2*Math.PI)*180/Math.PI}function i(u){return!isNaN(u)&&null!==u&&!Array.isArray(u)}Object.defineProperty(Q,"__esModule",{value:!0}),Q.earthRadius=6371008.8,Q.factors={centimeters:100*Q.earthRadius,centimetres:100*Q.earthRadius,degrees:Q.earthRadius/111325,feet:3.28084*Q.earthRadius,inches:39.37*Q.earthRadius,kilometers:Q.earthRadius/1e3,kilometres:Q.earthRadius/1e3,meters:Q.earthRadius,metres:Q.earthRadius,miles:Q.earthRadius/1609.344,millimeters:1e3*Q.earthRadius,millimetres:1e3*Q.earthRadius,nauticalmiles:Q.earthRadius/1852,radians:1,yards:1.0936*Q.earthRadius},Q.unitsFactors={centimeters:100,centimetres:100,degrees:1/111325,feet:3.28084,inches:39.37,kilometers:.001,kilometres:.001,meters:1,metres:1,miles:1/1609.344,millimeters:1e3,millimetres:1e3,nauticalmiles:1/1852,radians:1/Q.earthRadius,yards:1.0936133},Q.areaFactors={acres:247105e-9,centimeters:1e4,centimetres:1e4,feet:10.763910417,hectares:1e-4,inches:1550.003100006,kilometers:1e-6,kilometres:1e-6,meters:1,metres:1,miles:386e-9,millimeters:1e6,millimetres:1e6,yards:1.195990046},Q.feature=g,Q.geometry=function(u,f,c){switch(void 0===c&&(c={}),u){case"Point":return v(f).geometry;case"LineString":return x(f).geometry;case"Polygon":return m(f).geometry;case"MultiPoint":return t(f).geometry;case"MultiLineString":return n(f).geometry;case"MultiPolygon":return a(f).geometry;default:throw new Error(u+" is invalid")}},Q.point=v,Q.points=function(u,f,c){return void 0===c&&(c={}),e(u.map(function(h){return v(h,f)}),c)},Q.polygon=m,Q.polygons=function(u,f,c){return void 0===c&&(c={}),e(u.map(function(h){return m(h,f)}),c)},Q.lineString=x,Q.lineStrings=function(u,f,c){return void 0===c&&(c={}),e(u.map(function(h){return x(h,f)}),c)},Q.featureCollection=e,Q.multiLineString=n,Q.multiPoint=t,Q.multiPolygon=a,Q.geometryCollection=function(u,f,c){return void 0===c&&(c={}),g({type:"GeometryCollection",geometries:u},f,c)},Q.round=function(u,f){if(void 0===f&&(f=0),f&&!(f>=0))throw new Error("precision must be a positive number");var c=Math.pow(10,f||0);return Math.round(u*c)/c},Q.radiansToLength=r,Q.lengthToRadians=d,Q.lengthToDegrees=function(u,f){return s(d(u,f))},Q.bearingToAzimuth=function(u){var f=u%360;return f<0&&(f+=360),f},Q.radiansToDegrees=s,Q.degreesToRadians=function(u){return u%360*Math.PI/180},Q.convertLength=function(u,f,c){if(void 0===f&&(f="kilometers"),void 0===c&&(c="kilometers"),!(u>=0))throw new Error("length must be a positive number");return r(d(u,f),c)},Q.convertArea=function(u,f,c){if(void 0===f&&(f="meters"),void 0===c&&(c="kilometers"),!(u>=0))throw new Error("area must be a positive number");var h=Q.areaFactors[f];if(!h)throw new Error("invalid original units");var p=Q.areaFactors[c];if(!p)throw new Error("invalid final units");return u/h*p},Q.isNumber=i,Q.isObject=function(u){return!!u&&u.constructor===Object},Q.validateBBox=function(u){if(!u)throw new Error("bbox is required");if(!Array.isArray(u))throw new Error("bbox must be an Array");if(4!==u.length&&6!==u.length)throw new Error("bbox must be an Array of 4 or 6 numbers");u.forEach(function(f){if(!i(f))throw new Error("bbox must only contain numbers")})},Q.validateId=function(u){if(!u)throw new Error("id is required");if(-1===["string","number"].indexOf(typeof u))throw new Error("id must be a number or a string")}},{}],63:[function(y,ee,Q){"use strict";Object.defineProperty(Q,"__esModule",{value:!0});var g=y("@turf/helpers");function v(r,d,s){if(null!==r)for(var i,u,f,c,h,p,o,b,l=0,T=0,_=r.type,w="FeatureCollection"===_,k="Feature"===_,L=w?r.features.length:1,M=0;M<L;M++){h=(b=!!(o=w?r.features[M].geometry:k?r.geometry:r)&&"GeometryCollection"===o.type)?o.geometries.length:1;for(var I=0;I<h;I++){var P=0,S=0;if(null!==(c=b?o.geometries[I]:o)){p=c.coordinates;var E=c.type;switch(l=!s||"Polygon"!==E&&"MultiPolygon"!==E?0:1,E){case null:break;case"Point":if(!1===d(p,T,M,P,S))return!1;T++,P++;break;case"LineString":case"MultiPoint":for(i=0;i<p.length;i++){if(!1===d(p[i],T,M,P,S))return!1;T++,"MultiPoint"===E&&P++}"LineString"===E&&P++;break;case"Polygon":case"MultiLineString":for(i=0;i<p.length;i++){for(u=0;u<p[i].length-l;u++){if(!1===d(p[i][u],T,M,P,S))return!1;T++}"MultiLineString"===E&&P++,"Polygon"===E&&S++}"Polygon"===E&&P++;break;case"MultiPolygon":for(i=0;i<p.length;i++){for(S=0,u=0;u<p[i].length;u++){for(f=0;f<p[i][u].length-l;f++){if(!1===d(p[i][u][f],T,M,P,S))return!1;T++}S++}P++}break;case"GeometryCollection":for(i=0;i<c.geometries.length;i++)if(!1===v(c.geometries[i],d,s))return!1;break;default:throw new Error("Unknown Geometry Type")}}}}}function m(r,d){var s;switch(r.type){case"FeatureCollection":for(s=0;s<r.features.length&&!1!==d(r.features[s].properties,s);s++);break;case"Feature":d(r.properties,0)}}function x(r,d){if("Feature"===r.type)d(r,0);else if("FeatureCollection"===r.type)for(var s=0;s<r.features.length&&!1!==d(r.features[s],s);s++);}function e(r,d){var s,i,u,f,c,h,p,o,b,l,T=0,_="FeatureCollection"===r.type,w="Feature"===r.type,k=_?r.features.length:1;for(s=0;s<k;s++){for(o=_?r.features[s].properties:w?r.properties:{},b=_?r.features[s].bbox:w?r.bbox:void 0,l=_?r.features[s].id:w?r.id:void 0,c=(p=!!(h=_?r.features[s].geometry:w?r.geometry:r)&&"GeometryCollection"===h.type)?h.geometries.length:1,u=0;u<c;u++)if(null!==(f=p?h.geometries[u]:h))switch(f.type){case"Point":case"LineString":case"MultiPoint":case"Polygon":case"MultiLineString":case"MultiPolygon":if(!1===d(f,T,o,b,l))return!1;break;case"GeometryCollection":for(i=0;i<f.geometries.length;i++)if(!1===d(f.geometries[i],T,o,b,l))return!1;break;default:throw new Error("Unknown Geometry Type")}else if(!1===d(null,T,o,b,l))return!1;T++}}function n(r,d){e(r,function(s,i,u,f,c){var h,p=null===s?null:s.type;switch(p){case null:case"Point":case"LineString":case"Polygon":return!1!==d(g.feature(s,u,{bbox:f,id:c}),i,0)&&void 0}switch(p){case"MultiPoint":h="Point";break;case"MultiLineString":h="LineString";break;case"MultiPolygon":h="Polygon"}for(var o=0;o<s.coordinates.length;o++)if(!1===d(g.feature({type:h,coordinates:s.coordinates[o]},u),i,o))return!1})}function t(r,d){n(r,function(s,i,u){var f=0;if(s.geometry){var c=s.geometry.type;if("Point"!==c&&"MultiPoint"!==c){var h,p=0,o=0,b=0;return!1!==v(s,function(l,T,_,w,k){if(void 0===h||i>p||w>o||k>b)return h=l,p=i,o=w,b=k,void(f=0);var L=g.lineString([h,l],s.properties);if(!1===d(L,i,u,k,f))return!1;f++,h=l})&&void 0}}})}function a(r,d){if(!r)throw new Error("geojson is required");n(r,function(s,i,u){if(null!==s.geometry){var c=s.geometry.coordinates;switch(s.geometry.type){case"LineString":if(!1===d(s,i,u,0,0))return!1;break;case"Polygon":for(var h=0;h<c.length;h++)if(!1===d(g.lineString(c[h],s.properties),i,u,h))return!1}}})}Q.coordEach=v,Q.coordReduce=function(r,d,s,i){var u=s;return v(r,function(f,c,h,p,o){u=0===c&&void 0===s?f:d(u,f,c,h,p,o)},i),u},Q.propEach=m,Q.propReduce=function(r,d,s){var i=s;return m(r,function(u,f){i=0===f&&void 0===s?u:d(i,u,f)}),i},Q.featureEach=x,Q.featureReduce=function(r,d,s){var i=s;return x(r,function(u,f){i=0===f&&void 0===s?u:d(i,u,f)}),i},Q.coordAll=function(r){var d=[];return v(r,function(s){d.push(s)}),d},Q.geomEach=e,Q.geomReduce=function(r,d,s){var i=s;return e(r,function(u,f,c,h,p){i=0===f&&void 0===s?u:d(i,u,f,c,h,p)}),i},Q.flattenEach=n,Q.flattenReduce=function(r,d,s){var i=s;return n(r,function(u,f,c){i=0===f&&0===c&&void 0===s?u:d(i,u,f,c)}),i},Q.segmentEach=t,Q.segmentReduce=function(r,d,s){var i=s,u=!1;return t(r,function(f,c,h,p,o){i=!1===u&&void 0===s?f:d(i,f,c,h,p,o),u=!0}),i},Q.lineEach=a,Q.lineReduce=function(r,d,s){var i=s;return a(r,function(u,f,c,h){i=0===f&&void 0===s?u:d(i,u,f,c,h)}),i},Q.findSegment=function(r,d){if(!g.isObject(d=d||{}))throw new Error("options is invalid");var s,i=d.featureIndex||0,u=d.multiFeatureIndex||0,f=d.geometryIndex||0,c=d.segmentIndex||0,h=d.properties;switch(r.type){case"FeatureCollection":i<0&&(i=r.features.length+i),h=h||r.features[i].properties,s=r.features[i].geometry;break;case"Feature":h=h||r.properties,s=r.geometry;break;case"Point":case"MultiPoint":return null;case"LineString":case"Polygon":case"MultiLineString":case"MultiPolygon":s=r;break;default:throw new Error("geojson is invalid")}if(null===s)return null;var p=s.coordinates;switch(s.type){case"Point":case"MultiPoint":return null;case"LineString":return c<0&&(c=p.length+c-1),g.lineString([p[c],p[c+1]],h,d);case"Polygon":return f<0&&(f=p.length+f),c<0&&(c=p[f].length+c-1),g.lineString([p[f][c],p[f][c+1]],h,d);case"MultiLineString":return u<0&&(u=p.length+u),c<0&&(c=p[u].length+c-1),g.lineString([p[u][c],p[u][c+1]],h,d);case"MultiPolygon":return u<0&&(u=p.length+u),f<0&&(f=p[u].length+f),c<0&&(c=p[u][f].length-c-1),g.lineString([p[u][f][c],p[u][f][c+1]],h,d)}throw new Error("geojson is invalid")},Q.findPoint=function(r,d){if(!g.isObject(d=d||{}))throw new Error("options is invalid");var s,i=d.featureIndex||0,u=d.multiFeatureIndex||0,f=d.geometryIndex||0,c=d.coordIndex||0,h=d.properties;switch(r.type){case"FeatureCollection":i<0&&(i=r.features.length+i),h=h||r.features[i].properties,s=r.features[i].geometry;break;case"Feature":h=h||r.properties,s=r.geometry;break;case"Point":case"MultiPoint":return null;case"LineString":case"Polygon":case"MultiLineString":case"MultiPolygon":s=r;break;default:throw new Error("geojson is invalid")}if(null===s)return null;var p=s.coordinates;switch(s.type){case"Point":return g.point(p,h,d);case"MultiPoint":return u<0&&(u=p.length+u),g.point(p[u],h,d);case"LineString":return c<0&&(c=p.length+c),g.point(p[c],h,d);case"Polygon":return f<0&&(f=p.length+f),c<0&&(c=p[f].length+c),g.point(p[f][c],h,d);case"MultiLineString":return u<0&&(u=p.length+u),c<0&&(c=p[u].length+c),g.point(p[u][c],h,d);case"MultiPolygon":return u<0&&(u=p.length+u),f<0&&(f=p[u].length+f),c<0&&(c=p[u][f].length-c),g.point(p[u][f][c],h,d)}throw new Error("geojson is invalid")}},{"@turf/helpers":62}],64:[function(y,ee,Q){"use strict";Object.defineProperty(Q,"__esModule",{value:!0});var g=y("@turf/meta");function v(m){var x=[1/0,1/0,-1/0,-1/0];return g.coordEach(m,function(e){x[0]>e[0]&&(x[0]=e[0]),x[1]>e[1]&&(x[1]=e[1]),x[2]<e[0]&&(x[2]=e[0]),x[3]<e[1]&&(x[3]=e[1])}),x}v.default=v,Q.default=v},{"@turf/meta":66}],65:[function(y,ee,Q){arguments[4][62][0].apply(Q,arguments)},{dup:62}],66:[function(y,ee,Q){arguments[4][63][0].apply(Q,arguments)},{"@turf/helpers":65,dup:63}],67:[function(y,ee,Q){"use strict";Object.defineProperty(Q,"__esModule",{value:!0});var g=y("@turf/meta"),v=y("@turf/helpers");Q.default=function(m,x){void 0===x&&(x={});var e=0,n=0,t=0;return g.coordEach(m,function(a){e+=a[0],n+=a[1],t++}),v.point([e/t,n/t],x.properties)}},{"@turf/helpers":68,"@turf/meta":69}],68:[function(y,ee,Q){"use strict";function g(u,f,c){void 0===c&&(c={});var h={type:"Feature"};return(0===c.id||c.id)&&(h.id=c.id),c.bbox&&(h.bbox=c.bbox),h.properties=f||{},h.geometry=u,h}function v(u,f,c){return void 0===c&&(c={}),g({type:"Point",coordinates:u},f,c)}function m(u,f,c){void 0===c&&(c={});for(var h=0,p=u;h<p.length;h++){var o=p[h];if(o.length<4)throw new Error("Each LinearRing of a Polygon must have 4 or more Positions.");for(var b=0;b<o[o.length-1].length;b++)if(o[o.length-1][b]!==o[0][b])throw new Error("First and last Position are not equivalent.")}return g({type:"Polygon",coordinates:u},f,c)}function x(u,f,c){if(void 0===c&&(c={}),u.length<2)throw new Error("coordinates must be an array of two or more positions");return g({type:"LineString",coordinates:u},f,c)}function e(u,f){void 0===f&&(f={});var c={type:"FeatureCollection"};return f.id&&(c.id=f.id),f.bbox&&(c.bbox=f.bbox),c.features=u,c}function n(u,f,c){return void 0===c&&(c={}),g({type:"MultiLineString",coordinates:u},f,c)}function t(u,f,c){return void 0===c&&(c={}),g({type:"MultiPoint",coordinates:u},f,c)}function a(u,f,c){return void 0===c&&(c={}),g({type:"MultiPolygon",coordinates:u},f,c)}function r(u,f){void 0===f&&(f="kilometers");var c=Q.factors[f];if(!c)throw new Error(f+" units is invalid");return u*c}function d(u,f){void 0===f&&(f="kilometers");var c=Q.factors[f];if(!c)throw new Error(f+" units is invalid");return u/c}function s(u){return u%(2*Math.PI)*180/Math.PI}function i(u){return!isNaN(u)&&null!==u&&!Array.isArray(u)&&!/^\s*$/.test(u)}Object.defineProperty(Q,"__esModule",{value:!0}),Q.earthRadius=6371008.8,Q.factors={centimeters:100*Q.earthRadius,centimetres:100*Q.earthRadius,degrees:Q.earthRadius/111325,feet:3.28084*Q.earthRadius,inches:39.37*Q.earthRadius,kilometers:Q.earthRadius/1e3,kilometres:Q.earthRadius/1e3,meters:Q.earthRadius,metres:Q.earthRadius,miles:Q.earthRadius/1609.344,millimeters:1e3*Q.earthRadius,millimetres:1e3*Q.earthRadius,nauticalmiles:Q.earthRadius/1852,radians:1,yards:Q.earthRadius/1.0936},Q.unitsFactors={centimeters:100,centimetres:100,degrees:1/111325,feet:3.28084,inches:39.37,kilometers:.001,kilometres:.001,meters:1,metres:1,miles:1/1609.344,millimeters:1e3,millimetres:1e3,nauticalmiles:1/1852,radians:1/Q.earthRadius,yards:1/1.0936},Q.areaFactors={acres:247105e-9,centimeters:1e4,centimetres:1e4,feet:10.763910417,inches:1550.003100006,kilometers:1e-6,kilometres:1e-6,meters:1,metres:1,miles:386e-9,millimeters:1e6,millimetres:1e6,yards:1.195990046},Q.feature=g,Q.geometry=function(u,f,c){switch(void 0===c&&(c={}),u){case"Point":return v(f).geometry;case"LineString":return x(f).geometry;case"Polygon":return m(f).geometry;case"MultiPoint":return t(f).geometry;case"MultiLineString":return n(f).geometry;case"MultiPolygon":return a(f).geometry;default:throw new Error(u+" is invalid")}},Q.point=v,Q.points=function(u,f,c){return void 0===c&&(c={}),e(u.map(function(h){return v(h,f)}),c)},Q.polygon=m,Q.polygons=function(u,f,c){return void 0===c&&(c={}),e(u.map(function(h){return m(h,f)}),c)},Q.lineString=x,Q.lineStrings=function(u,f,c){return void 0===c&&(c={}),e(u.map(function(h){return x(h,f)}),c)},Q.featureCollection=e,Q.multiLineString=n,Q.multiPoint=t,Q.multiPolygon=a,Q.geometryCollection=function(u,f,c){return void 0===c&&(c={}),g({type:"GeometryCollection",geometries:u},f,c)},Q.round=function(u,f){if(void 0===f&&(f=0),f&&!(f>=0))throw new Error("precision must be a positive number");var c=Math.pow(10,f||0);return Math.round(u*c)/c},Q.radiansToLength=r,Q.lengthToRadians=d,Q.lengthToDegrees=function(u,f){return s(d(u,f))},Q.bearingToAzimuth=function(u){var f=u%360;return f<0&&(f+=360),f},Q.radiansToDegrees=s,Q.degreesToRadians=function(u){return u%360*Math.PI/180},Q.convertLength=function(u,f,c){if(void 0===f&&(f="kilometers"),void 0===c&&(c="kilometers"),!(u>=0))throw new Error("length must be a positive number");return r(d(u,f),c)},Q.convertArea=function(u,f,c){if(void 0===f&&(f="meters"),void 0===c&&(c="kilometers"),!(u>=0))throw new Error("area must be a positive number");var h=Q.areaFactors[f];if(!h)throw new Error("invalid original units");var p=Q.areaFactors[c];if(!p)throw new Error("invalid final units");return u/h*p},Q.isNumber=i,Q.isObject=function(u){return!!u&&u.constructor===Object},Q.validateBBox=function(u){if(!u)throw new Error("bbox is required");if(!Array.isArray(u))throw new Error("bbox must be an Array");if(4!==u.length&&6!==u.length)throw new Error("bbox must be an Array of 4 or 6 numbers");u.forEach(function(f){if(!i(f))throw new Error("bbox must only contain numbers")})},Q.validateId=function(u){if(!u)throw new Error("id is required");if(-1===["string","number"].indexOf(typeof u))throw new Error("id must be a number or a string")},Q.radians2degrees=function(){throw new Error("method has been renamed to `radiansToDegrees`")},Q.degrees2radians=function(){throw new Error("method has been renamed to `degreesToRadians`")},Q.distanceToDegrees=function(){throw new Error("method has been renamed to `lengthToDegrees`")},Q.distanceToRadians=function(){throw new Error("method has been renamed to `lengthToRadians`")},Q.radiansToDistance=function(){throw new Error("method has been renamed to `radiansToLength`")},Q.bearingToAngle=function(){throw new Error("method has been renamed to `bearingToAzimuth`")},Q.convertDistance=function(){throw new Error("method has been renamed to `convertLength`")}},{}],69:[function(y,ee,Q){"use strict";Object.defineProperty(Q,"__esModule",{value:!0});var g=y("@turf/helpers");function v(r,d,s){if(null!==r)for(var i,u,f,c,h,p,o,b,l=0,T=0,_=r.type,w="FeatureCollection"===_,k="Feature"===_,L=w?r.features.length:1,M=0;M<L;M++){h=(b=!!(o=w?r.features[M].geometry:k?r.geometry:r)&&"GeometryCollection"===o.type)?o.geometries.length:1;for(var I=0;I<h;I++){var P=0,S=0;if(null!==(c=b?o.geometries[I]:o)){p=c.coordinates;var E=c.type;switch(l=!s||"Polygon"!==E&&"MultiPolygon"!==E?0:1,E){case null:break;case"Point":if(!1===d(p,T,M,P,S))return!1;T++,P++;break;case"LineString":case"MultiPoint":for(i=0;i<p.length;i++){if(!1===d(p[i],T,M,P,S))return!1;T++,"MultiPoint"===E&&P++}"LineString"===E&&P++;break;case"Polygon":case"MultiLineString":for(i=0;i<p.length;i++){for(u=0;u<p[i].length-l;u++){if(!1===d(p[i][u],T,M,P,S))return!1;T++}"MultiLineString"===E&&P++,"Polygon"===E&&S++}"Polygon"===E&&P++;break;case"MultiPolygon":for(i=0;i<p.length;i++){for(S=0,u=0;u<p[i].length;u++){for(f=0;f<p[i][u].length-l;f++){if(!1===d(p[i][u][f],T,M,P,S))return!1;T++}S++}P++}break;case"GeometryCollection":for(i=0;i<c.geometries.length;i++)if(!1===v(c.geometries[i],d,s))return!1;break;default:throw new Error("Unknown Geometry Type")}}}}}function m(r,d){var s;switch(r.type){case"FeatureCollection":for(s=0;s<r.features.length&&!1!==d(r.features[s].properties,s);s++);break;case"Feature":d(r.properties,0)}}function x(r,d){if("Feature"===r.type)d(r,0);else if("FeatureCollection"===r.type)for(var s=0;s<r.features.length&&!1!==d(r.features[s],s);s++);}function e(r,d){var s,i,u,f,c,h,p,o,b,l,T=0,_="FeatureCollection"===r.type,w="Feature"===r.type,k=_?r.features.length:1;for(s=0;s<k;s++){for(o=_?r.features[s].properties:w?r.properties:{},b=_?r.features[s].bbox:w?r.bbox:void 0,l=_?r.features[s].id:w?r.id:void 0,c=(p=!!(h=_?r.features[s].geometry:w?r.geometry:r)&&"GeometryCollection"===h.type)?h.geometries.length:1,u=0;u<c;u++)if(null!==(f=p?h.geometries[u]:h))switch(f.type){case"Point":case"LineString":case"MultiPoint":case"Polygon":case"MultiLineString":case"MultiPolygon":if(!1===d(f,T,o,b,l))return!1;break;case"GeometryCollection":for(i=0;i<f.geometries.length;i++)if(!1===d(f.geometries[i],T,o,b,l))return!1;break;default:throw new Error("Unknown Geometry Type")}else if(!1===d(null,T,o,b,l))return!1;T++}}function n(r,d){e(r,function(s,i,u,f,c){var h,p=null===s?null:s.type;switch(p){case null:case"Point":case"LineString":case"Polygon":return!1!==d(g.feature(s,u,{bbox:f,id:c}),i,0)&&void 0}switch(p){case"MultiPoint":h="Point";break;case"MultiLineString":h="LineString";break;case"MultiPolygon":h="Polygon"}for(var o=0;o<s.coordinates.length;o++)if(!1===d(g.feature({type:h,coordinates:s.coordinates[o]},u),i,o))return!1})}function t(r,d){n(r,function(s,i,u){var f=0;if(s.geometry){var c=s.geometry.type;if("Point"!==c&&"MultiPoint"!==c){var h,p=0,o=0,b=0;return!1!==v(s,function(l,T,_,w,k){if(void 0===h||i>p||w>o||k>b)return h=l,p=i,o=w,b=k,void(f=0);var L=g.lineString([h,l],s.properties);if(!1===d(L,i,u,k,f))return!1;f++,h=l})&&void 0}}})}function a(r,d){if(!r)throw new Error("geojson is required");n(r,function(s,i,u){if(null!==s.geometry){var c=s.geometry.coordinates;switch(s.geometry.type){case"LineString":if(!1===d(s,i,u,0,0))return!1;break;case"Polygon":for(var h=0;h<c.length;h++)if(!1===d(g.lineString(c[h],s.properties),i,u,h))return!1}}})}Q.coordEach=v,Q.coordReduce=function(r,d,s,i){var u=s;return v(r,function(f,c,h,p,o){u=0===c&&void 0===s?f:d(u,f,c,h,p,o)},i),u},Q.propEach=m,Q.propReduce=function(r,d,s){var i=s;return m(r,function(u,f){i=0===f&&void 0===s?u:d(i,u,f)}),i},Q.featureEach=x,Q.featureReduce=function(r,d,s){var i=s;return x(r,function(u,f){i=0===f&&void 0===s?u:d(i,u,f)}),i},Q.coordAll=function(r){var d=[];return v(r,function(s){d.push(s)}),d},Q.geomEach=e,Q.geomReduce=function(r,d,s){var i=s;return e(r,function(u,f,c,h,p){i=0===f&&void 0===s?u:d(i,u,f,c,h,p)}),i},Q.flattenEach=n,Q.flattenReduce=function(r,d,s){var i=s;return n(r,function(u,f,c){i=0===f&&0===c&&void 0===s?u:d(i,u,f,c)}),i},Q.segmentEach=t,Q.segmentReduce=function(r,d,s){var i=s,u=!1;return t(r,function(f,c,h,p,o){i=!1===u&&void 0===s?f:d(i,f,c,h,p,o),u=!0}),i},Q.lineEach=a,Q.lineReduce=function(r,d,s){var i=s;return a(r,function(u,f,c,h){i=0===f&&void 0===s?u:d(i,u,f,c,h)}),i},Q.findSegment=function(r,d){if(!g.isObject(d=d||{}))throw new Error("options is invalid");var s,i=d.featureIndex||0,u=d.multiFeatureIndex||0,f=d.geometryIndex||0,c=d.segmentIndex||0,h=d.properties;switch(r.type){case"FeatureCollection":i<0&&(i=r.features.length+i),h=h||r.features[i].properties,s=r.features[i].geometry;break;case"Feature":h=h||r.properties,s=r.geometry;break;case"Point":case"MultiPoint":return null;case"LineString":case"Polygon":case"MultiLineString":case"MultiPolygon":s=r;break;default:throw new Error("geojson is invalid")}if(null===s)return null;var p=s.coordinates;switch(s.type){case"Point":case"MultiPoint":return null;case"LineString":return c<0&&(c=p.length+c-1),g.lineString([p[c],p[c+1]],h,d);case"Polygon":return f<0&&(f=p.length+f),c<0&&(c=p[f].length+c-1),g.lineString([p[f][c],p[f][c+1]],h,d);case"MultiLineString":return u<0&&(u=p.length+u),c<0&&(c=p[u].length+c-1),g.lineString([p[u][c],p[u][c+1]],h,d);case"MultiPolygon":return u<0&&(u=p.length+u),f<0&&(f=p[u].length+f),c<0&&(c=p[u][f].length-c-1),g.lineString([p[u][f][c],p[u][f][c+1]],h,d)}throw new Error("geojson is invalid")},Q.findPoint=function(r,d){if(!g.isObject(d=d||{}))throw new Error("options is invalid");var s,i=d.featureIndex||0,u=d.multiFeatureIndex||0,f=d.geometryIndex||0,c=d.coordIndex||0,h=d.properties;switch(r.type){case"FeatureCollection":i<0&&(i=r.features.length+i),h=h||r.features[i].properties,s=r.features[i].geometry;break;case"Feature":h=h||r.properties,s=r.geometry;break;case"Point":case"MultiPoint":return null;case"LineString":case"Polygon":case"MultiLineString":case"MultiPolygon":s=r;break;default:throw new Error("geojson is invalid")}if(null===s)return null;var p=s.coordinates;switch(s.type){case"Point":return g.point(p,h,d);case"MultiPoint":return u<0&&(u=p.length+u),g.point(p[u],h,d);case"LineString":return c<0&&(c=p.length+c),g.point(p[c],h,d);case"Polygon":return f<0&&(f=p.length+f),c<0&&(c=p[f].length+c),g.point(p[f][c],h,d);case"MultiLineString":return u<0&&(u=p.length+u),c<0&&(c=p[u].length+c),g.point(p[u][c],h,d);case"MultiPolygon":return u<0&&(u=p.length+u),f<0&&(f=p[u].length+f),c<0&&(c=p[u][f].length-c),g.point(p[u][f][c],h,d)}throw new Error("geojson is invalid")}},{"@turf/helpers":68}],70:[function(y,ee,Q){ee.exports=function(g){var v=0,m=0,x=0,e=0;return g.map(function(n){var t=(n=n.slice())[0],a=t.toUpperCase();if(t!=a)switch(n[0]=a,t){case"a":n[6]+=x,n[7]+=e;break;case"v":n[1]+=e;break;case"h":n[1]+=x;break;default:for(var r=1;r<n.length;)n[r++]+=x,n[r++]+=e}switch(a){case"Z":x=v,e=m;break;case"H":x=n[1];break;case"V":e=n[1];break;case"M":x=v=n[1],e=m=n[2];break;default:x=n[n.length-2],e=n[n.length-1]}return n})}},{}],71:[function(y,ee,Q){"use strict";ee.exports=function(g,v){if(!g||null==g.length)throw Error("Argument should be an array");v=null==v?1:Math.floor(v);for(var m=Array(2*v),x=0;x<v;x++){for(var e=-1/0,n=1/0,t=x,a=g.length;t<a;t+=v)g[t]>e&&(e=g[t]),g[t]<n&&(n=g[t]);m[x]=n,m[v+x]=e}return m}},{}],72:[function(y,ee,Q){"use strict";ee.exports=function(g,v,m){if("function"==typeof Array.prototype.findIndex)return g.findIndex(v,m);if("function"!=typeof v)throw new TypeError("predicate must be a function");var x=Object(g),e=x.length;if(0===e)return-1;for(var n=0;n<e;n++)if(v.call(m,x[n],n,x))return n;return-1}},{}],73:[function(y,ee,Q){"use strict";var g=y("array-bounds");ee.exports=function(v,m,x){if(!v||null==v.length)throw Error("Argument should be an array");null==m&&(m=1),null==x&&(x=g(v,m));for(var e=0;e<m;e++){var n=x[m+e],t=x[e],a=e,r=v.length;if(n===1/0&&t===-1/0)for(a=e;a<r;a+=m)v[a]=v[a]===n?1:v[a]===t?0:.5;else if(n===1/0)for(a=e;a<r;a+=m)v[a]=v[a]===n?1:0;else if(t===-1/0)for(a=e;a<r;a+=m)v[a]=v[a]===t?0:1;else{var d=n-t;for(a=e;a<r;a+=m)isNaN(v[a])||(v[a]=0===d?.5:(v[a]-t)/d)}}return v}},{"array-bounds":71}],74:[function(y,ee,Q){ee.exports=function(g,v){var m="number"==typeof g,x="number"==typeof v;m&&!x?(v=g,g=0):m||x||(g=0,v=0);var e=(v|=0)-(g|=0);if(e<0)throw new Error("array length must be positive");for(var n=new Array(e),t=0,a=g;t<e;t++,a++)n[t]=a;return n}},{}],75:[function(y,ee,Q){(function(g){(function(){"use strict";var v=y("object-assign");function m(w,k){if(w===k)return 0;for(var L=w.length,M=k.length,I=0,P=Math.min(L,M);I<P;++I)if(w[I]!==k[I]){L=w[I],M=k[I];break}return L<M?-1:M<L?1:0}function x(w){return g.Buffer&&"function"==typeof g.Buffer.isBuffer?g.Buffer.isBuffer(w):!(null==w||!w._isBuffer)}var e=y("util/"),n=Object.prototype.hasOwnProperty,t=Array.prototype.slice,a="foo"===function(){}.name;function r(w){return Object.prototype.toString.call(w)}function d(w){return!x(w)&&"function"==typeof g.ArrayBuffer&&("function"==typeof ArrayBuffer.isView?ArrayBuffer.isView(w):!!w&&(w instanceof DataView||!!(w.buffer&&w.buffer instanceof ArrayBuffer)))}var s=ee.exports=p,i=/\s*function\s+([^\(\s]*)\s*/;function u(w){if(e.isFunction(w)){if(a)return w.name;var k=w.toString().match(i);return k&&k[1]}}function f(w,k){return"string"==typeof w?w.length<k?w:w.slice(0,k):w}function c(w){if(a||!e.isFunction(w))return e.inspect(w);var k=u(w);return"[Function"+(k?": "+k:"")+"]"}function h(w,k,L,M,I){throw new s.AssertionError({message:L,actual:w,expected:k,operator:M,stackStartFunction:I})}function p(w,k){w||h(w,!0,k,"==",s.ok)}function o(w,k,L,M){if(w===k)return!0;if(x(w)&&x(k))return 0===m(w,k);if(e.isDate(w)&&e.isDate(k))return w.getTime()===k.getTime();if(e.isRegExp(w)&&e.isRegExp(k))return w.source===k.source&&w.global===k.global&&w.multiline===k.multiline&&w.lastIndex===k.lastIndex&&w.ignoreCase===k.ignoreCase;if(null!==w&&"object"==typeof w||null!==k&&"object"==typeof k){if(d(w)&&d(k)&&r(w)===r(k)&&!(w instanceof Float32Array||w instanceof Float64Array))return 0===m(new Uint8Array(w.buffer),new Uint8Array(k.buffer));if(x(w)!==x(k))return!1;var I=(M=M||{actual:[],expected:[]}).actual.indexOf(w);return-1!==I&&I===M.expected.indexOf(k)||(M.actual.push(w),M.expected.push(k),function(P,S,E,z){if(null==P||null==S)return!1;if(e.isPrimitive(P)||e.isPrimitive(S))return P===S;if(E&&Object.getPrototypeOf(P)!==Object.getPrototypeOf(S))return!1;var R=b(P),q=b(S);if(R&&!q||!R&&q)return!1;if(R)return o(P=t.call(P),S=t.call(S),E);var V,W,K=_(P),G=_(S);if(K.length!==G.length)return!1;for(K.sort(),G.sort(),W=K.length-1;W>=0;W--)if(K[W]!==G[W])return!1;for(W=K.length-1;W>=0;W--)if(!o(P[V=K[W]],S[V],E,z))return!1;return!0}(w,k,L,M))}return L?w===k:w==k}function b(w){return"[object Arguments]"==Object.prototype.toString.call(w)}function l(w,k){if(!w||!k)return!1;if("[object RegExp]"==Object.prototype.toString.call(k))return k.test(w);try{if(w instanceof k)return!0}catch{}return!Error.isPrototypeOf(k)&&!0===k.call({},w)}function T(w,k,L,M){var I;if("function"!=typeof k)throw new TypeError('"block" argument must be a function');"string"==typeof L&&(M=L,L=null),I=function(E){var z;try{E()}catch(R){z=R}return z}(k),M=(L&&L.name?" ("+L.name+").":".")+(M?" "+M:"."),w&&!I&&h(I,L,"Missing expected exception"+M);var P="string"==typeof M,S=!w&&I&&!L;if((!w&&e.isError(I)&&P&&l(I,L)||S)&&h(I,L,"Got unwanted exception"+M),w&&I&&L&&!l(I,L)||!w&&I)throw I}s.AssertionError=function(w){this.name="AssertionError",this.actual=w.actual,this.expected=w.expected,this.operator=w.operator,w.message?(this.message=w.message,this.generatedMessage=!1):(this.message=f(c(this.actual),128)+" "+this.operator+" "+f(c(this.expected),128),this.generatedMessage=!0);var k=w.stackStartFunction||h;if(Error.captureStackTrace)Error.captureStackTrace(this,k);else{var L=new Error;if(L.stack){var M=L.stack,I=u(k),P=M.indexOf("\n"+I);if(P>=0){var S=M.indexOf("\n",P+1);M=M.substring(S+1)}this.stack=M}}},e.inherits(s.AssertionError,Error),s.fail=h,s.ok=p,s.equal=function(w,k,L){w!=k&&h(w,k,L,"==",s.equal)},s.notEqual=function(w,k,L){w==k&&h(w,k,L,"!=",s.notEqual)},s.deepEqual=function(w,k,L){o(w,k,!1)||h(w,k,L,"deepEqual",s.deepEqual)},s.deepStrictEqual=function(w,k,L){o(w,k,!0)||h(w,k,L,"deepStrictEqual",s.deepStrictEqual)},s.notDeepEqual=function(w,k,L){o(w,k,!1)&&h(w,k,L,"notDeepEqual",s.notDeepEqual)},s.notDeepStrictEqual=function w(k,L,M){o(k,L,!0)&&h(k,L,M,"notDeepStrictEqual",w)},s.strictEqual=function(w,k,L){w!==k&&h(w,k,L,"===",s.strictEqual)},s.notStrictEqual=function(w,k,L){w===k&&h(w,k,L,"!==",s.notStrictEqual)},s.throws=function(w,k,L){T(!0,w,k,L)},s.doesNotThrow=function(w,k,L){T(!1,w,k,L)},s.ifError=function(w){if(w)throw w},s.strict=v(function w(k,L){k||h(k,!0,L,"==",w)},s,{equal:s.strictEqual,deepEqual:s.deepStrictEqual,notEqual:s.notStrictEqual,notDeepEqual:s.notDeepStrictEqual}),s.strict.strict=s.strict;var _=Object.keys||function(w){var k=[];for(var L in w)n.call(w,L)&&k.push(L);return k}}).call(this)}).call(this,typeof global<"u"?global:typeof self<"u"?self:typeof window<"u"?window:{})},{"object-assign":247,"util/":78}],76:[function(y,ee,Q){ee.exports="function"==typeof Object.create?function(g,v){g.super_=v,g.prototype=Object.create(v.prototype,{constructor:{value:g,enumerable:!1,writable:!0,configurable:!0}})}:function(g,v){g.super_=v;var m=function(){};m.prototype=v.prototype,g.prototype=new m,g.prototype.constructor=g}},{}],77:[function(y,ee,Q){ee.exports=function(g){return g&&"object"==typeof g&&"function"==typeof g.copy&&"function"==typeof g.fill&&"function"==typeof g.readUInt8}},{}],78:[function(y,ee,Q){(function(g,v){(function(){var m=/%[sdj%]/g;Q.format=function(P){if(!h(P)){for(var S=[],E=0;E<arguments.length;E++)S.push(n(arguments[E]));return S.join(" ")}E=1;for(var z=arguments,R=z.length,q=String(P).replace(m,function(W){if("%%"===W)return"%";if(E>=R)return W;switch(W){case"%s":return String(z[E++]);case"%d":return Number(z[E++]);case"%j":try{return JSON.stringify(z[E++])}catch{return"[Circular]"}default:return W}}),V=z[E];E<R;V=z[++E])f(V)||!b(V)?q+=" "+V:q+=" "+n(V);return q},Q.deprecate=function(P,S){if(p(v.process))return function(){return Q.deprecate(P,S).apply(this,arguments)};if(!0===g.noDeprecation)return P;var E=!1;return function(){if(!E){if(g.throwDeprecation)throw new Error(S);g.traceDeprecation?console.trace(S):console.error(S),E=!0}return P.apply(this,arguments)}};var x,e={};function n(P,S){var E={seen:[],stylize:a};return arguments.length>=3&&(E.depth=arguments[2]),arguments.length>=4&&(E.colors=arguments[3]),u(S)?E.showHidden=S:S&&Q._extend(E,S),p(E.showHidden)&&(E.showHidden=!1),p(E.depth)&&(E.depth=2),p(E.colors)&&(E.colors=!1),p(E.customInspect)&&(E.customInspect=!0),E.colors&&(E.stylize=t),r(E,P,E.depth)}function t(P,S){var E=n.styles[S];return E?"\x1b["+n.colors[E][0]+"m"+P+"\x1b["+n.colors[E][1]+"m":P}function a(P,S){return P}function r(P,S,E){if(P.customInspect&&S&&_(S.inspect)&&S.inspect!==Q.inspect&&(!S.constructor||S.constructor.prototype!==S)){var z=S.inspect(E,P);return h(z)||(z=r(P,z,E)),z}var R=function(B,N){if(p(N))return B.stylize("undefined","undefined");if(h(N)){var U="'"+JSON.stringify(N).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return B.stylize(U,"string")}return c(N)?B.stylize(""+N,"number"):u(N)?B.stylize(""+N,"boolean"):f(N)?B.stylize("null","null"):void 0}(P,S);if(R)return R;var N,q=Object.keys(S),V=(N={},q.forEach(function(U,te){N[U]=!0}),N);if(P.showHidden&&(q=Object.getOwnPropertyNames(S)),T(S)&&(q.indexOf("message")>=0||q.indexOf("description")>=0))return d(S);if(0===q.length){if(_(S))return P.stylize("[Function"+(S.name?": "+S.name:"")+"]","special");if(o(S))return P.stylize(RegExp.prototype.toString.call(S),"regexp");if(l(S))return P.stylize(Date.prototype.toString.call(S),"date");if(T(S))return d(S)}var K,G="",Y=!1,$=["{","}"];return i(S)&&(Y=!0,$=["[","]"]),_(S)&&(G=" [Function"+(S.name?": "+S.name:"")+"]"),o(S)&&(G=" "+RegExp.prototype.toString.call(S)),l(S)&&(G=" "+Date.prototype.toUTCString.call(S)),T(S)&&(G=" "+d(S)),0!==q.length||Y&&0!=S.length?E<0?o(S)?P.stylize(RegExp.prototype.toString.call(S),"regexp"):P.stylize("[Object]","special"):(P.seen.push(S),K=Y?function(B,N,U,te,j){for(var J=[],X=0,re=N.length;X<re;++X)I(N,String(X))?J.push(s(B,N,U,te,String(X),!0)):J.push("");return j.forEach(function(ne){ne.match(/^\d+$/)||J.push(s(B,N,U,te,ne,!0))}),J}(P,S,E,V,q):q.map(function(B){return s(P,S,E,V,B,Y)}),P.seen.pop(),function(B,N,U){return B.reduce(function(te,j){return j.indexOf("\n"),te+j.replace(/\u001b\[\d\d?m/g,"").length+1},0)>60?U[0]+(""===N?"":N+"\n ")+" "+B.join(",\n  ")+" "+U[1]:U[0]+N+" "+B.join(", ")+" "+U[1]}(K,G,$)):$[0]+G+$[1]}function d(P){return"["+Error.prototype.toString.call(P)+"]"}function s(P,S,E,z,R,q){var V,W,K;if((K=Object.getOwnPropertyDescriptor(S,R)||{value:S[R]}).get?W=P.stylize(K.set?"[Getter/Setter]":"[Getter]","special"):K.set&&(W=P.stylize("[Setter]","special")),I(z,R)||(V="["+R+"]"),W||(P.seen.indexOf(K.value)<0?(W=f(E)?r(P,K.value,null):r(P,K.value,E-1)).indexOf("\n")>-1&&(W=q?W.split("\n").map(function(G){return"  "+G}).join("\n").substr(2):"\n"+W.split("\n").map(function(G){return"   "+G}).join("\n")):W=P.stylize("[Circular]","special")),p(V)){if(q&&R.match(/^\d+$/))return W;(V=JSON.stringify(""+R)).match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(V=V.substr(1,V.length-2),V=P.stylize(V,"name")):(V=V.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),V=P.stylize(V,"string"))}return V+": "+W}function i(P){return Array.isArray(P)}function u(P){return"boolean"==typeof P}function f(P){return null===P}function c(P){return"number"==typeof P}function h(P){return"string"==typeof P}function p(P){return void 0===P}function o(P){return b(P)&&"[object RegExp]"===w(P)}function b(P){return"object"==typeof P&&null!==P}function l(P){return b(P)&&"[object Date]"===w(P)}function T(P){return b(P)&&("[object Error]"===w(P)||P instanceof Error)}function _(P){return"function"==typeof P}function w(P){return Object.prototype.toString.call(P)}function k(P){return P<10?"0"+P.toString(10):P.toString(10)}Q.debuglog=function(P){if(p(x)&&(x=g.env.NODE_DEBUG||""),P=P.toUpperCase(),!e[P])if(new RegExp("\\b"+P+"\\b","i").test(x)){var S=g.pid;e[P]=function(){var E=Q.format.apply(Q,arguments);console.error("%s %d: %s",P,S,E)}}else e[P]=function(){};return e[P]},Q.inspect=n,n.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},n.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"},Q.isArray=i,Q.isBoolean=u,Q.isNull=f,Q.isNullOrUndefined=function(P){return null==P},Q.isNumber=c,Q.isString=h,Q.isSymbol=function(P){return"symbol"==typeof P},Q.isUndefined=p,Q.isRegExp=o,Q.isObject=b,Q.isDate=l,Q.isError=T,Q.isFunction=_,Q.isPrimitive=function(P){return null===P||"boolean"==typeof P||"number"==typeof P||"string"==typeof P||"symbol"==typeof P||void 0===P},Q.isBuffer=y("./support/isBuffer");var L=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function M(){var P=new Date,S=[k(P.getHours()),k(P.getMinutes()),k(P.getSeconds())].join(":");return[P.getDate(),L[P.getMonth()],S].join(" ")}function I(P,S){return Object.prototype.hasOwnProperty.call(P,S)}Q.log=function(){console.log("%s - %s",M(),Q.format.apply(Q,arguments))},Q.inherits=y("inherits"),Q._extend=function(P,S){if(!S||!b(S))return P;for(var E=Object.keys(S),z=E.length;z--;)P[E[z]]=S[E[z]];return P}}).call(this)}).call(this,y("_process"),typeof global<"u"?global:typeof self<"u"?self:typeof window<"u"?window:{})},{"./support/isBuffer":77,_process:278,inherits:76}],79:[function(y,ee,Q){"use strict";Q.byteLength=function(r){var d=t(r),i=d[1];return 3*(d[0]+i)/4-i},Q.toByteArray=function(r){var d,s,l,i=t(r),u=i[0],f=i[1],c=new m(3*(u+(l=f))/4-l),h=0,p=f>0?u-4:u;for(s=0;s<p;s+=4)d=v[r.charCodeAt(s)]<<18|v[r.charCodeAt(s+1)]<<12|v[r.charCodeAt(s+2)]<<6|v[r.charCodeAt(s+3)],c[h++]=d>>16&255,c[h++]=d>>8&255,c[h++]=255&d;return 2===f&&(d=v[r.charCodeAt(s)]<<2|v[r.charCodeAt(s+1)]>>4,c[h++]=255&d),1===f&&(d=v[r.charCodeAt(s)]<<10|v[r.charCodeAt(s+1)]<<4|v[r.charCodeAt(s+2)]>>2,c[h++]=d>>8&255,c[h++]=255&d),c},Q.fromByteArray=function(r){for(var d,s=r.length,i=s%3,u=[],f=0,c=s-i;f<c;f+=16383)u.push(a(r,f,f+16383>c?c:f+16383));return 1===i?u.push(g[(d=r[s-1])>>2]+g[d<<4&63]+"=="):2===i&&u.push(g[(d=(r[s-2]<<8)+r[s-1])>>10]+g[d>>4&63]+g[d<<2&63]+"="),u.join("")};for(var g=[],v=[],m=typeof Uint8Array<"u"?Uint8Array:Array,x="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",e=0,n=x.length;e<n;++e)g[e]=x[e],v[x.charCodeAt(e)]=e;function t(r){var d=r.length;if(d%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var s=r.indexOf("=");return-1===s&&(s=d),[s,s===d?0:4-s%4]}function a(r,d,s){for(var u,f=[],c=d;c<s;c+=3)f.push(g[(u=(r[c]<<16&16711680)+(r[c+1]<<8&65280)+(255&r[c+2]))>>18&63]+g[u>>12&63]+g[u>>6&63]+g[63&u]);return f.join("")}v["-".charCodeAt(0)]=62,v["_".charCodeAt(0)]=63},{}],80:[function(y,ee,Q){"use strict";function g(t,a,r,d,s){for(var i=s+1;d<=s;){var u=d+s>>>1,f=t[u];(void 0!==r?r(f,a):f-a)>=0?(i=u,s=u-1):d=u+1}return i}function v(t,a,r,d,s){for(var i=s+1;d<=s;){var u=d+s>>>1,f=t[u];(void 0!==r?r(f,a):f-a)>0?(i=u,s=u-1):d=u+1}return i}function m(t,a,r,d,s){for(var i=d-1;d<=s;){var u=d+s>>>1,f=t[u];(void 0!==r?r(f,a):f-a)<0?(i=u,d=u+1):s=u-1}return i}function x(t,a,r,d,s){for(var i=d-1;d<=s;){var u=d+s>>>1,f=t[u];(void 0!==r?r(f,a):f-a)<=0?(i=u,d=u+1):s=u-1}return i}function e(t,a,r,d,s){for(;d<=s;){var i=d+s>>>1,u=t[i],f=void 0!==r?r(u,a):u-a;if(0===f)return i;f<=0?d=i+1:s=i-1}return-1}function n(t,a,r,d,s,i){return"function"==typeof r?i(t,a,r,void 0===d?0:0|d,void 0===s?t.length-1:0|s):i(t,a,void 0,void 0===r?0:0|r,void 0===d?t.length-1:0|d)}ee.exports={ge:function(t,a,r,d,s){return n(t,a,r,d,s,g)},gt:function(t,a,r,d,s){return n(t,a,r,d,s,v)},lt:function(t,a,r,d,s){return n(t,a,r,d,s,m)},le:function(t,a,r,d,s){return n(t,a,r,d,s,x)},eq:function(t,a,r,d,s){return n(t,a,r,d,s,e)}}},{}],81:[function(y,ee,Q){"use strict";function g(m){var x=32;return(m&=-m)&&x--,65535&m&&(x-=16),16711935&m&&(x-=8),252645135&m&&(x-=4),858993459&m&&(x-=2),1431655765&m&&(x-=1),x}Q.INT_BITS=32,Q.INT_MAX=2147483647,Q.INT_MIN=-1<<31,Q.sign=function(m){return(m>0)-(m<0)},Q.abs=function(m){var x=m>>31;return(m^x)-x},Q.min=function(m,x){return x^(m^x)&-(m<x)},Q.max=function(m,x){return m^(m^x)&-(m<x)},Q.isPow2=function(m){return!(m&m-1||!m)},Q.log2=function(m){var x,e;return x=(m>65535)<<4,x|=e=((m>>>=x)>255)<<3,x|=e=((m>>>=e)>15)<<2,(x|=e=((m>>>=e)>3)<<1)|(m>>>=e)>>1},Q.log10=function(m){return m>=1e9?9:m>=1e8?8:m>=1e7?7:m>=1e6?6:m>=1e5?5:m>=1e4?4:m>=1e3?3:m>=100?2:m>=10?1:0},Q.popCount=function(m){return 16843009*((m=(858993459&(m-=m>>>1&1431655765))+(m>>>2&858993459))+(m>>>4)&252645135)>>>24},Q.countTrailingZeros=g,Q.nextPow2=function(m){return m+=0===m,--m,m|=m>>>1,m|=m>>>2,m|=m>>>4,1+((m|=m>>>8)|m>>>16)},Q.prevPow2=function(m){return m|=m>>>1,m|=m>>>2,m|=m>>>4,m|=m>>>8,(m|=m>>>16)-(m>>>1)},Q.parity=function(m){return m^=m>>>16,m^=m>>>8,m^=m>>>4,27030>>>(m&=15)&1};var v=new Array(256);(function(m){for(var x=0;x<256;++x){var e=x,n=x,t=7;for(e>>>=1;e;e>>>=1)n<<=1,n|=1&e,--t;m[x]=n<<t&255}})(v),Q.reverse=function(m){return v[255&m]<<24|v[m>>>8&255]<<16|v[m>>>16&255]<<8|v[m>>>24&255]},Q.interleave2=function(m,x){return(m=1431655765&((m=858993459&((m=252645135&((m=16711935&((m&=65535)|m<<8))|m<<4))|m<<2))|m<<1))|(x=1431655765&((x=858993459&((x=252645135&((x=16711935&((x&=65535)|x<<8))|x<<4))|x<<2))|x<<1))<<1},Q.deinterleave2=function(m,x){return(m=65535&((m=16711935&((m=252645135&((m=858993459&((m=m>>>x&1431655765)|m>>>1))|m>>>2))|m>>>4))|m>>>16))<<16>>16},Q.interleave3=function(m,x,e){return m=1227133513&((m=3272356035&((m=251719695&((m=4278190335&((m&=1023)|m<<16))|m<<8))|m<<4))|m<<2),(m|=(x=1227133513&((x=3272356035&((x=251719695&((x=4278190335&((x&=1023)|x<<16))|x<<8))|x<<4))|x<<2))<<1)|(e=1227133513&((e=3272356035&((e=251719695&((e=4278190335&((e&=1023)|e<<16))|e<<8))|e<<4))|e<<2))<<2},Q.deinterleave3=function(m,x){return(m=1023&((m=4278190335&((m=251719695&((m=3272356035&((m=m>>>x&1227133513)|m>>>2))|m>>>4))|m>>>8))|m>>>16))<<22>>22},Q.nextCombination=function(m){var x=m|m-1;return x+1|(~x&-~x)-1>>>g(m)+1}},{}],82:[function(y,ee,Q){"use strict";var g=y("clamp");ee.exports=function(e,n){n||(n={});var t,a,r,d,s,i,f,h,p,o=n.cutoff??.25,b=n.radius??8,l=n.channel||0;if(ArrayBuffer.isView(e)||Array.isArray(e)){if(!n.width||!n.height)throw Error("For raw data width and height should be provided by options");t=n.width,a=n.height,d=e,i=n.stride?n.stride:Math.floor(e.length/t/a)}else window.HTMLCanvasElement&&e instanceof window.HTMLCanvasElement?(d=(f=e).getContext("2d").getImageData(0,0,t=f.width,a=f.height).data,i=4):window.CanvasRenderingContext2D&&e instanceof window.CanvasRenderingContext2D?(d=e.getImageData(0,0,t=(f=e.canvas).width,a=f.height).data,i=4):window.ImageData&&e instanceof window.ImageData&&(t=e.width,a=e.height,d=e.data,i=4);if(r=Math.max(t,a),window.Uint8ClampedArray&&d instanceof window.Uint8ClampedArray||window.Uint8Array&&d instanceof window.Uint8Array)for(s=d,d=Array(t*a),h=0,p=s.length;h<p;h++)d[h]=s[h*i+l]/255;else if(1!==i)throw Error("Raw data can have only 1 value per pixel");var T=Array(t*a),_=Array(t*a),w=Array(r),k=Array(r),L=Array(r+1),M=Array(r);for(h=0,p=t*a;h<p;h++){var I=d[h];T[h]=1===I?0:0===I?v:Math.pow(Math.max(0,.5-I),2),_[h]=1===I?v:0===I?0:Math.pow(Math.max(0,I-.5),2)}m(T,t,a,w,k,M,L),m(_,t,a,w,k,M,L);var P=window.Float32Array?new Float32Array(t*a):new Array(t*a);for(h=0,p=t*a;h<p;h++)P[h]=g(1-((T[h]-_[h])/b+o),0,1);return P};var v=1e20;function m(e,n,t,a,r,d,s){for(var i=0;i<n;i++){for(var u=0;u<t;u++)a[u]=e[u*n+i];for(x(a,r,d,s,t),u=0;u<t;u++)e[u*n+i]=r[u]}for(u=0;u<t;u++){for(i=0;i<n;i++)a[i]=e[u*n+i];for(x(a,r,d,s,n),i=0;i<n;i++)e[u*n+i]=Math.sqrt(r[i])}}function x(e,n,t,a,r){t[0]=0,a[0]=-v,a[1]=+v;for(var d=1,s=0;d<r;d++){for(var i=(e[d]+d*d-(e[t[s]]+t[s]*t[s]))/(2*d-2*t[s]);i<=a[s];)s--,i=(e[d]+d*d-(e[t[s]]+t[s]*t[s]))/(2*d-2*t[s]);t[++s]=d,a[s]=i,a[s+1]=+v}for(d=0,s=0;d<r;d++){for(;a[s+1]<d;)s++;n[d]=(d-t[s])*(d-t[s])+e[t[s]]}}},{clamp:86}],83:[function(y,ee,Q){},{}],84:[function(y,ee,Q){"use strict";var g,v="object"==typeof Reflect?Reflect:null,m=v&&"function"==typeof v.apply?v.apply:function(c,h,p){return Function.prototype.apply.call(c,h,p)};g=v&&"function"==typeof v.ownKeys?v.ownKeys:Object.getOwnPropertySymbols?function(c){return Object.getOwnPropertyNames(c).concat(Object.getOwnPropertySymbols(c))}:function(c){return Object.getOwnPropertyNames(c)};var x=Number.isNaN||function(c){return c!=c};function e(){e.init.call(this)}ee.exports=e,ee.exports.once=function(c,h){return new Promise(function(p,o){function b(){void 0!==l&&c.removeListener("error",l),p([].slice.call(arguments))}var l;"error"!==h&&(l=function(T){c.removeListener(h,b),o(T)},c.once("error",l)),c.once(h,b)})},e.EventEmitter=e,e.prototype._events=void 0,e.prototype._eventsCount=0,e.prototype._maxListeners=void 0;var n=10;function t(c){if("function"!=typeof c)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof c)}function a(c){return void 0===c._maxListeners?e.defaultMaxListeners:c._maxListeners}function r(c,h,p,o){var b,l,T;if(t(p),void 0===(l=c._events)?(l=c._events=Object.create(null),c._eventsCount=0):(void 0!==l.newListener&&(c.emit("newListener",h,p.listener?p.listener:p),l=c._events),T=l[h]),void 0===T)T=l[h]=p,++c._eventsCount;else if("function"==typeof T?T=l[h]=o?[p,T]:[T,p]:o?T.unshift(p):T.push(p),(b=a(c))>0&&T.length>b&&!T.warned){T.warned=!0;var w=new Error("Possible EventEmitter memory leak detected. "+T.length+" "+String(h)+" listeners added. Use emitter.setMaxListeners() to increase limit");w.name="MaxListenersExceededWarning",w.emitter=c,w.type=h,w.count=T.length,console&&console.warn&&console.warn(w)}return c}function d(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function s(c,h,p){var o={fired:!1,wrapFn:void 0,target:c,type:h,listener:p},b=d.bind(o);return b.listener=p,o.wrapFn=b,b}function i(c,h,p){var o=c._events;if(void 0===o)return[];var b=o[h];return void 0===b?[]:"function"==typeof b?p?[b.listener||b]:[b]:p?function(l){for(var T=new Array(l.length),_=0;_<T.length;++_)T[_]=l[_].listener||l[_];return T}(b):f(b,b.length)}function u(c){var h=this._events;if(void 0!==h){var p=h[c];if("function"==typeof p)return 1;if(void 0!==p)return p.length}return 0}function f(c,h){for(var p=new Array(h),o=0;o<h;++o)p[o]=c[o];return p}Object.defineProperty(e,"defaultMaxListeners",{enumerable:!0,get:function(){return n},set:function(c){if("number"!=typeof c||c<0||x(c))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+c+".");n=c}}),e.init=function(){void 0!==this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},e.prototype.setMaxListeners=function(c){if("number"!=typeof c||c<0||x(c))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+c+".");return this._maxListeners=c,this},e.prototype.getMaxListeners=function(){return a(this)},e.prototype.emit=function(c){for(var h=[],p=1;p<arguments.length;p++)h.push(arguments[p]);var o="error"===c,b=this._events;if(void 0!==b)o=o&&void 0===b.error;else if(!o)return!1;if(o){var l;if(h.length>0&&(l=h[0]),l instanceof Error)throw l;var T=new Error("Unhandled error."+(l?" ("+l.message+")":""));throw T.context=l,T}var _=b[c];if(void 0===_)return!1;if("function"==typeof _)m(_,this,h);else{var w=_.length,k=f(_,w);for(p=0;p<w;++p)m(k[p],this,h)}return!0},e.prototype.on=e.prototype.addListener=function(c,h){return r(this,c,h,!1)},e.prototype.prependListener=function(c,h){return r(this,c,h,!0)},e.prototype.once=function(c,h){return t(h),this.on(c,s(this,c,h)),this},e.prototype.prependOnceListener=function(c,h){return t(h),this.prependListener(c,s(this,c,h)),this},e.prototype.off=e.prototype.removeListener=function(c,h){var p,o,b,l,T;if(t(h),void 0===(o=this._events))return this;if(void 0===(p=o[c]))return this;if(p===h||p.listener===h)0==--this._eventsCount?this._events=Object.create(null):(delete o[c],o.removeListener&&this.emit("removeListener",c,p.listener||h));else if("function"!=typeof p){for(b=-1,l=p.length-1;l>=0;l--)if(p[l]===h||p[l].listener===h){T=p[l].listener,b=l;break}if(b<0)return this;0===b?p.shift():function(_,w){for(;w+1<_.length;w++)_[w]=_[w+1];_.pop()}(p,b),1===p.length&&(o[c]=p[0]),void 0!==o.removeListener&&this.emit("removeListener",c,T||h)}return this},e.prototype.removeAllListeners=function(c){var h,p,o;if(void 0===(p=this._events))return this;if(void 0===p.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==p[c]&&(0==--this._eventsCount?this._events=Object.create(null):delete p[c]),this;if(0===arguments.length){var b,l=Object.keys(p);for(o=0;o<l.length;++o)"removeListener"!==(b=l[o])&&this.removeAllListeners(b);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(h=p[c]))this.removeListener(c,h);else if(void 0!==h)for(o=h.length-1;o>=0;o--)this.removeListener(c,h[o]);return this},e.prototype.listeners=function(c){return i(this,c,!0)},e.prototype.rawListeners=function(c){return i(this,c,!1)},e.listenerCount=function(c,h){return"function"==typeof c.listenerCount?c.listenerCount(h):u.call(c,h)},e.prototype.listenerCount=u,e.prototype.eventNames=function(){return this._eventsCount>0?g(this._events):[]}},{}],85:[function(y,ee,Q){(function(g){(function(){"use strict";var v=y("base64-js"),m=y("ieee754");function x(B){if(B>2147483647)throw new RangeError('The value "'+B+'" is invalid for option "size"');var N=new Uint8Array(B);return N.__proto__=e.prototype,N}function e(B,N,U){if("number"==typeof B){if("string"==typeof N)throw new TypeError('The "string" argument must be of type string. Received type number');return a(B)}return n(B,N,U)}function n(B,N,U){if("string"==typeof B)return function(J,X){if("string"==typeof X&&""!==X||(X="utf8"),!e.isEncoding(X))throw new TypeError("Unknown encoding: "+X);var re=0|s(J,X),ne=x(re),le=ne.write(J,X);return le!==re&&(ne=ne.slice(0,le)),ne}(B,N);if(ArrayBuffer.isView(B))return r(B);if(null==B)throw TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof B);if(Y(B,ArrayBuffer)||B&&Y(B.buffer,ArrayBuffer))return function(J,X,re){if(X<0||J.byteLength<X)throw new RangeError('"offset" is outside of buffer bounds');if(J.byteLength<X+(re||0))throw new RangeError('"length" is outside of buffer bounds');var ne;return(ne=void 0===X&&void 0===re?new Uint8Array(J):void 0===re?new Uint8Array(J,X):new Uint8Array(J,X,re)).__proto__=e.prototype,ne}(B,N,U);if("number"==typeof B)throw new TypeError('The "value" argument must not be of type number. Received type number');var te=B.valueOf&&B.valueOf();if(null!=te&&te!==B)return e.from(te,N,U);var j=function(J){if(e.isBuffer(J)){var X=0|d(J.length),re=x(X);return 0===re.length||J.copy(re,0,0,X),re}return void 0!==J.length?"number"!=typeof J.length||$(J.length)?x(0):r(J):"Buffer"===J.type&&Array.isArray(J.data)?r(J.data):void 0}(B);if(j)return j;if(typeof Symbol<"u"&&null!=Symbol.toPrimitive&&"function"==typeof B[Symbol.toPrimitive])return e.from(B[Symbol.toPrimitive]("string"),N,U);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof B)}function t(B){if("number"!=typeof B)throw new TypeError('"size" argument must be of type number');if(B<0)throw new RangeError('The value "'+B+'" is invalid for option "size"')}function a(B){return t(B),x(B<0?0:0|d(B))}function r(B){for(var N=B.length<0?0:0|d(B.length),U=x(N),te=0;te<N;te+=1)U[te]=255&B[te];return U}function d(B){if(B>=2147483647)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+2147483647..toString(16)+" bytes");return 0|B}function s(B,N){if(e.isBuffer(B))return B.length;if(ArrayBuffer.isView(B)||Y(B,ArrayBuffer))return B.byteLength;if("string"!=typeof B)throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof B);var U=B.length,te=arguments.length>2&&!0===arguments[2];if(!te&&0===U)return 0;for(var j=!1;;)switch(N){case"ascii":case"latin1":case"binary":return U;case"utf8":case"utf-8":return W(B).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*U;case"hex":return U>>>1;case"base64":return K(B).length;default:if(j)return te?-1:W(B).length;N=(""+N).toLowerCase(),j=!0}}function i(B,N,U){var te=!1;if((void 0===N||N<0)&&(N=0),N>this.length||((void 0===U||U>this.length)&&(U=this.length),U<=0)||(U>>>=0)<=(N>>>=0))return"";for(B||(B="utf8");;)switch(B){case"hex":return M(this,N,U);case"utf8":case"utf-8":return w(this,N,U);case"ascii":return k(this,N,U);case"latin1":case"binary":return L(this,N,U);case"base64":return _(this,N,U);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return I(this,N,U);default:if(te)throw new TypeError("Unknown encoding: "+B);B=(B+"").toLowerCase(),te=!0}}function u(B,N,U){var te=B[N];B[N]=B[U],B[U]=te}function f(B,N,U,te,j){if(0===B.length)return-1;if("string"==typeof U?(te=U,U=0):U>2147483647?U=2147483647:U<-2147483648&&(U=-2147483648),$(U=+U)&&(U=j?0:B.length-1),U<0&&(U=B.length+U),U>=B.length){if(j)return-1;U=B.length-1}else if(U<0){if(!j)return-1;U=0}if("string"==typeof N&&(N=e.from(N,te)),e.isBuffer(N))return 0===N.length?-1:c(B,N,U,te,j);if("number"==typeof N)return N&=255,"function"==typeof Uint8Array.prototype.indexOf?j?Uint8Array.prototype.indexOf.call(B,N,U):Uint8Array.prototype.lastIndexOf.call(B,N,U):c(B,[N],U,te,j);throw new TypeError("val must be string, number or Buffer")}function c(B,N,U,te,j){var J,X=1,re=B.length,ne=N.length;if(void 0!==te&&("ucs2"===(te=String(te).toLowerCase())||"ucs-2"===te||"utf16le"===te||"utf-16le"===te)){if(B.length<2||N.length<2)return-1;X=2,re/=2,ne/=2,U/=2}function le(ge,_e){return 1===X?ge[_e]:ge.readUInt16BE(_e*X)}if(j){var oe=-1;for(J=U;J<re;J++)if(le(B,J)===le(N,-1===oe?0:J-oe)){if(-1===oe&&(oe=J),J-oe+1===ne)return oe*X}else-1!==oe&&(J-=J-oe),oe=-1}else for(U+ne>re&&(U=re-ne),J=U;J>=0;J--){for(var de=!0,se=0;se<ne;se++)if(le(B,J+se)!==le(N,se)){de=!1;break}if(de)return J}return-1}function h(B,N,U,te){U=Number(U)||0;var j=B.length-U;te?(te=Number(te))>j&&(te=j):te=j;var J=N.length;te>J/2&&(te=J/2);for(var X=0;X<te;++X){var re=parseInt(N.substr(2*X,2),16);if($(re))return X;B[U+X]=re}return X}function p(B,N,U,te){return G(W(N,B.length-U),B,U,te)}function o(B,N,U,te){return G(function(j){for(var J=[],X=0;X<j.length;++X)J.push(255&j.charCodeAt(X));return J}(N),B,U,te)}function b(B,N,U,te){return o(B,N,U,te)}function l(B,N,U,te){return G(K(N),B,U,te)}function T(B,N,U,te){return G(function(j,J){for(var X,re,le=[],oe=0;oe<j.length&&!((J-=2)<0);++oe)re=(X=j.charCodeAt(oe))>>8,le.push(X%256),le.push(re);return le}(N,B.length-U),B,U,te)}function _(B,N,U){return v.fromByteArray(0===N&&U===B.length?B:B.slice(N,U))}function w(B,N,U){U=Math.min(B.length,U);for(var te=[],j=N;j<U;){var J,X,re,ne,le=B[j],oe=null,de=le>239?4:le>223?3:le>191?2:1;if(j+de<=U)switch(de){case 1:le<128&&(oe=le);break;case 2:128==(192&(J=B[j+1]))&&(ne=(31&le)<<6|63&J)>127&&(oe=ne);break;case 3:X=B[j+2],128==(192&(J=B[j+1]))&&128==(192&X)&&(ne=(15&le)<<12|(63&J)<<6|63&X)>2047&&(ne<55296||ne>57343)&&(oe=ne);break;case 4:X=B[j+2],re=B[j+3],128==(192&(J=B[j+1]))&&128==(192&X)&&128==(192&re)&&(ne=(15&le)<<18|(63&J)<<12|(63&X)<<6|63&re)>65535&&ne<1114112&&(oe=ne)}null===oe?(oe=65533,de=1):oe>65535&&(te.push((oe-=65536)>>>10&1023|55296),oe=56320|1023&oe),te.push(oe),j+=de}return function(se){var ge=se.length;if(ge<=4096)return String.fromCharCode.apply(String,se);for(var _e="",Te=0;Te<ge;)_e+=String.fromCharCode.apply(String,se.slice(Te,Te+=4096));return _e}(te)}function k(B,N,U){var te="";U=Math.min(B.length,U);for(var j=N;j<U;++j)te+=String.fromCharCode(127&B[j]);return te}function L(B,N,U){var te="";U=Math.min(B.length,U);for(var j=N;j<U;++j)te+=String.fromCharCode(B[j]);return te}function M(B,N,U){var te=B.length;(!N||N<0)&&(N=0),(!U||U<0||U>te)&&(U=te);for(var j="",J=N;J<U;++J)j+=V(B[J]);return j}function I(B,N,U){for(var te=B.slice(N,U),j="",J=0;J<te.length;J+=2)j+=String.fromCharCode(te[J]+256*te[J+1]);return j}function P(B,N,U){if(B%1!=0||B<0)throw new RangeError("offset is not uint");if(B+N>U)throw new RangeError("Trying to access beyond buffer length")}function S(B,N,U,te,j,J){if(!e.isBuffer(B))throw new TypeError('"buffer" argument must be a Buffer instance');if(N>j||N<J)throw new RangeError('"value" argument is out of bounds');if(U+te>B.length)throw new RangeError("Index out of range")}function E(B,N,U,te,j,J){if(U+te>B.length)throw new RangeError("Index out of range");if(U<0)throw new RangeError("Index out of range")}function z(B,N,U,te,j){return N=+N,U>>>=0,j||E(B,0,U,4),m.write(B,N,U,te,23,4),U+4}function R(B,N,U,te,j){return N=+N,U>>>=0,j||E(B,0,U,8),m.write(B,N,U,te,52,8),U+8}Q.Buffer=e,Q.SlowBuffer=function(B){return+B!=B&&(B=0),e.alloc(+B)},Q.INSPECT_MAX_BYTES=50,Q.kMaxLength=2147483647,(e.TYPED_ARRAY_SUPPORT=function(){try{var B=new Uint8Array(1);return B.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===B.foo()}catch{return!1}}())||typeof console>"u"||"function"!=typeof console.error||console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),Object.defineProperty(e.prototype,"parent",{enumerable:!0,get:function(){if(e.isBuffer(this))return this.buffer}}),Object.defineProperty(e.prototype,"offset",{enumerable:!0,get:function(){if(e.isBuffer(this))return this.byteOffset}}),typeof Symbol<"u"&&null!=Symbol.species&&e[Symbol.species]===e&&Object.defineProperty(e,Symbol.species,{value:null,configurable:!0,enumerable:!1,writable:!1}),e.poolSize=8192,e.from=function(B,N,U){return n(B,N,U)},e.prototype.__proto__=Uint8Array.prototype,e.__proto__=Uint8Array,e.alloc=function(B,N,U){return j=N,J=U,t(te=B),te<=0?x(te):void 0!==j?"string"==typeof J?x(te).fill(j,J):x(te).fill(j):x(te);var te,j,J},e.allocUnsafe=function(B){return a(B)},e.allocUnsafeSlow=function(B){return a(B)},e.isBuffer=function(B){return null!=B&&!0===B._isBuffer&&B!==e.prototype},e.compare=function(B,N){if(Y(B,Uint8Array)&&(B=e.from(B,B.offset,B.byteLength)),Y(N,Uint8Array)&&(N=e.from(N,N.offset,N.byteLength)),!e.isBuffer(B)||!e.isBuffer(N))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(B===N)return 0;for(var U=B.length,te=N.length,j=0,J=Math.min(U,te);j<J;++j)if(B[j]!==N[j]){U=B[j],te=N[j];break}return U<te?-1:te<U?1:0},e.isEncoding=function(B){switch(String(B).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},e.concat=function(B,N){if(!Array.isArray(B))throw new TypeError('"list" argument must be an Array of Buffers');if(0===B.length)return e.alloc(0);var U;if(void 0===N)for(N=0,U=0;U<B.length;++U)N+=B[U].length;var te=e.allocUnsafe(N),j=0;for(U=0;U<B.length;++U){var J=B[U];if(Y(J,Uint8Array)&&(J=e.from(J)),!e.isBuffer(J))throw new TypeError('"list" argument must be an Array of Buffers');J.copy(te,j),j+=J.length}return te},e.byteLength=s,e.prototype._isBuffer=!0,e.prototype.swap16=function(){var B=this.length;if(B%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var N=0;N<B;N+=2)u(this,N,N+1);return this},e.prototype.swap32=function(){var B=this.length;if(B%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var N=0;N<B;N+=4)u(this,N,N+3),u(this,N+1,N+2);return this},e.prototype.swap64=function(){var B=this.length;if(B%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var N=0;N<B;N+=8)u(this,N,N+7),u(this,N+1,N+6),u(this,N+2,N+5),u(this,N+3,N+4);return this},e.prototype.toLocaleString=e.prototype.toString=function(){var B=this.length;return 0===B?"":0===arguments.length?w(this,0,B):i.apply(this,arguments)},e.prototype.equals=function(B){if(!e.isBuffer(B))throw new TypeError("Argument must be a Buffer");return this===B||0===e.compare(this,B)},e.prototype.inspect=function(){var B="",N=Q.INSPECT_MAX_BYTES;return B=this.toString("hex",0,N).replace(/(.{2})/g,"$1 ").trim(),this.length>N&&(B+=" ... "),"<Buffer "+B+">"},e.prototype.compare=function(B,N,U,te,j){if(Y(B,Uint8Array)&&(B=e.from(B,B.offset,B.byteLength)),!e.isBuffer(B))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof B);if(void 0===N&&(N=0),void 0===U&&(U=B?B.length:0),void 0===te&&(te=0),void 0===j&&(j=this.length),N<0||U>B.length||te<0||j>this.length)throw new RangeError("out of range index");if(te>=j&&N>=U)return 0;if(te>=j)return-1;if(N>=U)return 1;if(this===B)return 0;for(var J=(j>>>=0)-(te>>>=0),X=(U>>>=0)-(N>>>=0),re=Math.min(J,X),ne=this.slice(te,j),le=B.slice(N,U),oe=0;oe<re;++oe)if(ne[oe]!==le[oe]){J=ne[oe],X=le[oe];break}return J<X?-1:X<J?1:0},e.prototype.includes=function(B,N,U){return-1!==this.indexOf(B,N,U)},e.prototype.indexOf=function(B,N,U){return f(this,B,N,U,!0)},e.prototype.lastIndexOf=function(B,N,U){return f(this,B,N,U,!1)},e.prototype.write=function(B,N,U,te){if(void 0===N)te="utf8",U=this.length,N=0;else if(void 0===U&&"string"==typeof N)te=N,U=this.length,N=0;else{if(!isFinite(N))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");N>>>=0,isFinite(U)?(U>>>=0,void 0===te&&(te="utf8")):(te=U,U=void 0)}var j=this.length-N;if((void 0===U||U>j)&&(U=j),B.length>0&&(U<0||N<0)||N>this.length)throw new RangeError("Attempt to write outside buffer bounds");te||(te="utf8");for(var J=!1;;)switch(te){case"hex":return h(this,B,N,U);case"utf8":case"utf-8":return p(this,B,N,U);case"ascii":return o(this,B,N,U);case"latin1":case"binary":return b(this,B,N,U);case"base64":return l(this,B,N,U);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return T(this,B,N,U);default:if(J)throw new TypeError("Unknown encoding: "+te);te=(""+te).toLowerCase(),J=!0}},e.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}},e.prototype.slice=function(B,N){var U=this.length;(B=~~B)<0?(B+=U)<0&&(B=0):B>U&&(B=U),(N=void 0===N?U:~~N)<0?(N+=U)<0&&(N=0):N>U&&(N=U),N<B&&(N=B);var te=this.subarray(B,N);return te.__proto__=e.prototype,te},e.prototype.readUIntLE=function(B,N,U){B>>>=0,N>>>=0,U||P(B,N,this.length);for(var te=this[B],j=1,J=0;++J<N&&(j*=256);)te+=this[B+J]*j;return te},e.prototype.readUIntBE=function(B,N,U){B>>>=0,N>>>=0,U||P(B,N,this.length);for(var te=this[B+--N],j=1;N>0&&(j*=256);)te+=this[B+--N]*j;return te},e.prototype.readUInt8=function(B,N){return B>>>=0,N||P(B,1,this.length),this[B]},e.prototype.readUInt16LE=function(B,N){return B>>>=0,N||P(B,2,this.length),this[B]|this[B+1]<<8},e.prototype.readUInt16BE=function(B,N){return B>>>=0,N||P(B,2,this.length),this[B]<<8|this[B+1]},e.prototype.readUInt32LE=function(B,N){return B>>>=0,N||P(B,4,this.length),(this[B]|this[B+1]<<8|this[B+2]<<16)+16777216*this[B+3]},e.prototype.readUInt32BE=function(B,N){return B>>>=0,N||P(B,4,this.length),16777216*this[B]+(this[B+1]<<16|this[B+2]<<8|this[B+3])},e.prototype.readIntLE=function(B,N,U){B>>>=0,N>>>=0,U||P(B,N,this.length);for(var te=this[B],j=1,J=0;++J<N&&(j*=256);)te+=this[B+J]*j;return te>=(j*=128)&&(te-=Math.pow(2,8*N)),te},e.prototype.readIntBE=function(B,N,U){B>>>=0,N>>>=0,U||P(B,N,this.length);for(var te=N,j=1,J=this[B+--te];te>0&&(j*=256);)J+=this[B+--te]*j;return J>=(j*=128)&&(J-=Math.pow(2,8*N)),J},e.prototype.readInt8=function(B,N){return B>>>=0,N||P(B,1,this.length),128&this[B]?-1*(255-this[B]+1):this[B]},e.prototype.readInt16LE=function(B,N){B>>>=0,N||P(B,2,this.length);var U=this[B]|this[B+1]<<8;return 32768&U?4294901760|U:U},e.prototype.readInt16BE=function(B,N){B>>>=0,N||P(B,2,this.length);var U=this[B+1]|this[B]<<8;return 32768&U?4294901760|U:U},e.prototype.readInt32LE=function(B,N){return B>>>=0,N||P(B,4,this.length),this[B]|this[B+1]<<8|this[B+2]<<16|this[B+3]<<24},e.prototype.readInt32BE=function(B,N){return B>>>=0,N||P(B,4,this.length),this[B]<<24|this[B+1]<<16|this[B+2]<<8|this[B+3]},e.prototype.readFloatLE=function(B,N){return B>>>=0,N||P(B,4,this.length),m.read(this,B,!0,23,4)},e.prototype.readFloatBE=function(B,N){return B>>>=0,N||P(B,4,this.length),m.read(this,B,!1,23,4)},e.prototype.readDoubleLE=function(B,N){return B>>>=0,N||P(B,8,this.length),m.read(this,B,!0,52,8)},e.prototype.readDoubleBE=function(B,N){return B>>>=0,N||P(B,8,this.length),m.read(this,B,!1,52,8)},e.prototype.writeUIntLE=function(B,N,U,te){B=+B,N>>>=0,U>>>=0,te||S(this,B,N,U,Math.pow(2,8*U)-1,0);var j=1,J=0;for(this[N]=255&B;++J<U&&(j*=256);)this[N+J]=B/j&255;return N+U},e.prototype.writeUIntBE=function(B,N,U,te){B=+B,N>>>=0,U>>>=0,te||S(this,B,N,U,Math.pow(2,8*U)-1,0);var j=U-1,J=1;for(this[N+j]=255&B;--j>=0&&(J*=256);)this[N+j]=B/J&255;return N+U},e.prototype.writeUInt8=function(B,N,U){return B=+B,N>>>=0,U||S(this,B,N,1,255,0),this[N]=255&B,N+1},e.prototype.writeUInt16LE=function(B,N,U){return B=+B,N>>>=0,U||S(this,B,N,2,65535,0),this[N]=255&B,this[N+1]=B>>>8,N+2},e.prototype.writeUInt16BE=function(B,N,U){return B=+B,N>>>=0,U||S(this,B,N,2,65535,0),this[N]=B>>>8,this[N+1]=255&B,N+2},e.prototype.writeUInt32LE=function(B,N,U){return B=+B,N>>>=0,U||S(this,B,N,4,4294967295,0),this[N+3]=B>>>24,this[N+2]=B>>>16,this[N+1]=B>>>8,this[N]=255&B,N+4},e.prototype.writeUInt32BE=function(B,N,U){return B=+B,N>>>=0,U||S(this,B,N,4,4294967295,0),this[N]=B>>>24,this[N+1]=B>>>16,this[N+2]=B>>>8,this[N+3]=255&B,N+4},e.prototype.writeIntLE=function(B,N,U,te){if(B=+B,N>>>=0,!te){var j=Math.pow(2,8*U-1);S(this,B,N,U,j-1,-j)}var J=0,X=1,re=0;for(this[N]=255&B;++J<U&&(X*=256);)B<0&&0===re&&0!==this[N+J-1]&&(re=1),this[N+J]=(B/X>>0)-re&255;return N+U},e.prototype.writeIntBE=function(B,N,U,te){if(B=+B,N>>>=0,!te){var j=Math.pow(2,8*U-1);S(this,B,N,U,j-1,-j)}var J=U-1,X=1,re=0;for(this[N+J]=255&B;--J>=0&&(X*=256);)B<0&&0===re&&0!==this[N+J+1]&&(re=1),this[N+J]=(B/X>>0)-re&255;return N+U},e.prototype.writeInt8=function(B,N,U){return B=+B,N>>>=0,U||S(this,B,N,1,127,-128),B<0&&(B=255+B+1),this[N]=255&B,N+1},e.prototype.writeInt16LE=function(B,N,U){return B=+B,N>>>=0,U||S(this,B,N,2,32767,-32768),this[N]=255&B,this[N+1]=B>>>8,N+2},e.prototype.writeInt16BE=function(B,N,U){return B=+B,N>>>=0,U||S(this,B,N,2,32767,-32768),this[N]=B>>>8,this[N+1]=255&B,N+2},e.prototype.writeInt32LE=function(B,N,U){return B=+B,N>>>=0,U||S(this,B,N,4,2147483647,-2147483648),this[N]=255&B,this[N+1]=B>>>8,this[N+2]=B>>>16,this[N+3]=B>>>24,N+4},e.prototype.writeInt32BE=function(B,N,U){return B=+B,N>>>=0,U||S(this,B,N,4,2147483647,-2147483648),B<0&&(B=4294967295+B+1),this[N]=B>>>24,this[N+1]=B>>>16,this[N+2]=B>>>8,this[N+3]=255&B,N+4},e.prototype.writeFloatLE=function(B,N,U){return z(this,B,N,!0,U)},e.prototype.writeFloatBE=function(B,N,U){return z(this,B,N,!1,U)},e.prototype.writeDoubleLE=function(B,N,U){return R(this,B,N,!0,U)},e.prototype.writeDoubleBE=function(B,N,U){return R(this,B,N,!1,U)},e.prototype.copy=function(B,N,U,te){if(!e.isBuffer(B))throw new TypeError("argument should be a Buffer");if(U||(U=0),te||0===te||(te=this.length),N>=B.length&&(N=B.length),N||(N=0),te>0&&te<U&&(te=U),te===U||0===B.length||0===this.length)return 0;if(N<0)throw new RangeError("targetStart out of bounds");if(U<0||U>=this.length)throw new RangeError("Index out of range");if(te<0)throw new RangeError("sourceEnd out of bounds");te>this.length&&(te=this.length),B.length-N<te-U&&(te=B.length-N+U);var j=te-U;if(this===B&&"function"==typeof Uint8Array.prototype.copyWithin)this.copyWithin(N,U,te);else if(this===B&&U<N&&N<te)for(var J=j-1;J>=0;--J)B[J+N]=this[J+U];else Uint8Array.prototype.set.call(B,this.subarray(U,te),N);return j},e.prototype.fill=function(B,N,U,te){if("string"==typeof B){if("string"==typeof N?(te=N,N=0,U=this.length):"string"==typeof U&&(te=U,U=this.length),void 0!==te&&"string"!=typeof te)throw new TypeError("encoding must be a string");if("string"==typeof te&&!e.isEncoding(te))throw new TypeError("Unknown encoding: "+te);if(1===B.length){var j=B.charCodeAt(0);("utf8"===te&&j<128||"latin1"===te)&&(B=j)}}else"number"==typeof B&&(B&=255);if(N<0||this.length<N||this.length<U)throw new RangeError("Out of range index");if(U<=N)return this;var J;if(N>>>=0,U=void 0===U?this.length:U>>>0,B||(B=0),"number"==typeof B)for(J=N;J<U;++J)this[J]=B;else{var X=e.isBuffer(B)?B:e.from(B,te),re=X.length;if(0===re)throw new TypeError('The value "'+B+'" is invalid for argument "value"');for(J=0;J<U-N;++J)this[J+N]=X[J%re]}return this};var q=/[^+/0-9A-Za-z-_]/g;function V(B){return B<16?"0"+B.toString(16):B.toString(16)}function W(B,N){var U;N=N||1/0;for(var te=B.length,j=null,J=[],X=0;X<te;++X){if((U=B.charCodeAt(X))>55295&&U<57344){if(!j){if(U>56319){(N-=3)>-1&&J.push(239,191,189);continue}if(X+1===te){(N-=3)>-1&&J.push(239,191,189);continue}j=U;continue}if(U<56320){(N-=3)>-1&&J.push(239,191,189),j=U;continue}U=65536+(j-55296<<10|U-56320)}else j&&(N-=3)>-1&&J.push(239,191,189);if(j=null,U<128){if((N-=1)<0)break;J.push(U)}else if(U<2048){if((N-=2)<0)break;J.push(U>>6|192,63&U|128)}else if(U<65536){if((N-=3)<0)break;J.push(U>>12|224,U>>6&63|128,63&U|128)}else{if(!(U<1114112))throw new Error("Invalid code point");if((N-=4)<0)break;J.push(U>>18|240,U>>12&63|128,U>>6&63|128,63&U|128)}}return J}function K(B){return v.toByteArray(function(N){if((N=(N=N.split("=")[0]).trim().replace(q,"")).length<2)return"";for(;N.length%4!=0;)N+="=";return N}(B))}function G(B,N,U,te){for(var j=0;j<te&&!(j+U>=N.length||j>=B.length);++j)N[j+U]=B[j];return j}function Y(B,N){return B instanceof N||null!=B&&null!=B.constructor&&null!=B.constructor.name&&B.constructor.name===N.name}function $(B){return B!=B}}).call(this)}).call(this,y("buffer").Buffer)},{"base64-js":79,buffer:85,ieee754:230}],86:[function(y,ee,Q){ee.exports=function(g,v,m){return v<m?g<v?v:g>m?m:g:g<m?m:g>v?v:g}},{}],87:[function(y,ee,Q){"use strict";var g=y("clamp");function v(m,x){null==x&&(x=!0);var e=m[0],n=m[1],t=m[2],a=m[3];return null==a&&(a=x?1:255),x&&(e*=255,n*=255,t*=255,a*=255),16777216*(e=255&g(e,0,255))+((n=255&g(n,0,255))<<16)+((t=255&g(t,0,255))<<8)+(255&g(a,0,255))}ee.exports=v,ee.exports.to=v,ee.exports.from=function(m,x){var e=(m=+m)>>>24,n=(16711680&m)>>>16,t=(65280&m)>>>8,a=255&m;return!1===x?[e,n,t,a]:[e/255,n/255,t/255,a/255]}},{clamp:86}],88:[function(y,ee,Q){"use strict";ee.exports={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]}},{}],89:[function(y,ee,Q){"use strict";var g=y("color-rgba"),v=y("clamp"),m=y("dtype");ee.exports=function(x,e){"float"!==e&&e||(e="array"),"uint"===e&&(e="uint8"),"uint_clamped"===e&&(e="uint8_clamped");var a,n=new(m(e))(4),t="uint8"!==e&&"uint8_clamped"!==e;return x.length&&"string"!=typeof x||((x=g(x))[0]/=255,x[1]/=255,x[2]/=255),(a=x)instanceof Uint8Array||a instanceof Uint8ClampedArray||Array.isArray(a)&&(a[0]>1||0===a[0])&&(a[1]>1||0===a[1])&&(a[2]>1||0===a[2])&&(!a[3]||a[3]>1)?(n[0]=x[0],n[1]=x[1],n[2]=x[2],n[3]=null!=x[3]?x[3]:255,t&&(n[0]/=255,n[1]/=255,n[2]/=255,n[3]/=255),n):(t?(n[0]=x[0],n[1]=x[1],n[2]=x[2],n[3]=null!=x[3]?x[3]:1):(n[0]=v(Math.floor(255*x[0]),0,255),n[1]=v(Math.floor(255*x[1]),0,255),n[2]=v(Math.floor(255*x[2]),0,255),n[3]=null==x[3]?255:v(Math.floor(255*x[3]),0,255)),n)}},{clamp:86,"color-rgba":91,dtype:127}],90:[function(y,ee,Q){(function(g){(function(){"use strict";var v=y("color-name"),m=y("is-plain-obj"),x=y("defined");ee.exports=function(n){var t,a,r=[],d=1;if("string"==typeof n)if(v[n])r=v[n].slice(),a="rgb";else if("transparent"===n)d=0,a="rgb",r=[0,0,0];else if(/^#[A-Fa-f0-9]+$/.test(n)){var s=(f=n.slice(1)).length;d=1,s<=4?(r=[parseInt(f[0]+f[0],16),parseInt(f[1]+f[1],16),parseInt(f[2]+f[2],16)],4===s&&(d=parseInt(f[3]+f[3],16)/255)):(r=[parseInt(f[0]+f[1],16),parseInt(f[2]+f[3],16),parseInt(f[4]+f[5],16)],8===s&&(d=parseInt(f[6]+f[7],16)/255)),r[0]||(r[0]=0),r[1]||(r[1]=0),r[2]||(r[2]=0),a="rgb"}else if(t=/^((?:rgb|hs[lvb]|hwb|cmyk?|xy[zy]|gray|lab|lchu?v?|[ly]uv|lms)a?)\s*\(([^\)]*)\)/.exec(n)){var i=t[1],u="rgb"===i,f=i.replace(/a$/,"");a=f,s="cmyk"===f?4:"gray"===f?1:3,r=t[2].trim().split(/\s*,\s*/).map(function(h,p){if(/%$/.test(h))return p===s?parseFloat(h)/100:"rgb"===f?255*parseFloat(h)/100:parseFloat(h);if("h"===f[p]){if(/deg$/.test(h))return parseFloat(h);if(void 0!==e[h])return e[h]}return parseFloat(h)}),i===f&&r.push(1),d=u||void 0===r[s]?1:r[s],r=r.slice(0,s)}else n.length>10&&/[0-9](?:\s|\/)/.test(n)&&(r=n.match(/([0-9]+)/g).map(function(h){return parseFloat(h)}),a=n.match(/([a-z])/gi).join("").toLowerCase());else if(isNaN(n))if(m(n)){var c=x(n.r,n.red,n.R,null);null!==c?(a="rgb",r=[c,x(n.g,n.green,n.G),x(n.b,n.blue,n.B)]):(a="hsl",r=[x(n.h,n.hue,n.H),x(n.s,n.saturation,n.S),x(n.l,n.lightness,n.L,n.b,n.brightness)]),d=x(n.a,n.alpha,n.opacity,1),null!=n.opacity&&(d/=100)}else(Array.isArray(n)||g.ArrayBuffer&&ArrayBuffer.isView&&ArrayBuffer.isView(n))&&(r=[n[0],n[1],n[2]],a="rgb",d=4===n.length?n[3]:1);else a="rgb",r=[n>>>16,(65280&n)>>>8,255&n];return{space:a,values:r,alpha:d}};var e={red:0,orange:60,yellow:120,green:180,blue:240,purple:300}}).call(this)}).call(this,typeof global<"u"?global:typeof self<"u"?self:typeof window<"u"?window:{})},{"color-name":88,defined:124,"is-plain-obj":236}],91:[function(y,ee,Q){"use strict";var g=y("color-parse"),v=y("color-space/hsl"),m=y("clamp");ee.exports=function(x){var e,n=g(x);return n.space?((e=Array(3))[0]=m(n.values[0],0,255),e[1]=m(n.values[1],0,255),e[2]=m(n.values[2],0,255),"h"===n.space[0]&&(e=v.rgb(e)),e.push(m(n.alpha,0,1)),e):[]}},{clamp:86,"color-parse":90,"color-space/hsl":92}],92:[function(y,ee,Q){"use strict";var g=y("./rgb");ee.exports={name:"hsl",min:[0,0,0],max:[360,100,100],channel:["hue","saturation","lightness"],alias:["HSL"],rgb:function(v){var m,x,e,n,t,a=v[0]/360,r=v[1]/100,d=v[2]/100;if(0===r)return[t=255*d,t,t];m=2*d-(x=d<.5?d*(1+r):d+r-d*r),n=[0,0,0];for(var s=0;s<3;s++)(e=a+1/3*-(s-1))<0?e++:e>1&&e--,n[s]=255*(t=6*e<1?m+6*(x-m)*e:2*e<1?x:3*e<2?m+(x-m)*(2/3-e)*6:m);return n}},g.hsl=function(v){var m,x,e=v[0]/255,n=v[1]/255,t=v[2]/255,a=Math.min(e,n,t),r=Math.max(e,n,t),d=r-a;return r===a?m=0:e===r?m=(n-t)/d:n===r?m=2+(t-e)/d:t===r&&(m=4+(e-n)/d),(m=Math.min(60*m,360))<0&&(m+=360),x=(a+r)/2,[m,100*(r===a?0:x<=.5?d/(r+a):d/(2-r-a)),100*x]}},{"./rgb":93}],93:[function(y,ee,Q){"use strict";ee.exports={name:"rgb",min:[0,0,0],max:[255,255,255],channel:["red","green","blue"],alias:["RGB"]}},{}],94:[function(y,ee,Q){ee.exports={AFG:"afghan",ALA:"\\b\\wland",ALB:"albania",DZA:"algeria",ASM:"^(?=.*americ).*samoa",AND:"andorra",AGO:"angola",AIA:"anguill?a",ATA:"antarctica",ATG:"antigua",ARG:"argentin",ARM:"armenia",ABW:"^(?!.*bonaire).*\\baruba",AUS:"australia",AUT:"^(?!.*hungary).*austria|\\baustri.*\\bemp",AZE:"azerbaijan",BHS:"bahamas",BHR:"bahrain",BGD:"bangladesh|^(?=.*east).*paki?stan",BRB:"barbados",BLR:"belarus|byelo",BEL:"^(?!.*luxem).*belgium",BLZ:"belize|^(?=.*british).*honduras",BEN:"benin|dahome",BMU:"bermuda",BTN:"bhutan",BOL:"bolivia",BES:"^(?=.*bonaire).*eustatius|^(?=.*carib).*netherlands|\\bbes.?islands",BIH:"herzegovina|bosnia",BWA:"botswana|bechuana",BVT:"bouvet",BRA:"brazil",IOT:"british.?indian.?ocean",BRN:"brunei",BGR:"bulgaria",BFA:"burkina|\\bfaso|upper.?volta",BDI:"burundi",CPV:"verde",KHM:"cambodia|kampuchea|khmer",CMR:"cameroon",CAN:"canada",CYM:"cayman",CAF:"\\bcentral.african.republic",TCD:"\\bchad",CHL:"\\bchile",CHN:"^(?!.*\\bmac)(?!.*\\bhong)(?!.*\\btai)(?!.*\\brep).*china|^(?=.*peo)(?=.*rep).*china",CXR:"christmas",CCK:"\\bcocos|keeling",COL:"colombia",COM:"comoro",COG:"^(?!.*\\bdem)(?!.*\\bd[\\.]?r)(?!.*kinshasa)(?!.*zaire)(?!.*belg)(?!.*l.opoldville)(?!.*free).*\\bcongo",COK:"\\bcook",CRI:"costa.?rica",CIV:"ivoire|ivory",HRV:"croatia",CUB:"\\bcuba",CUW:"^(?!.*bonaire).*\\bcura(c|\xe7)ao",CYP:"cyprus",CSK:"czechoslovakia",CZE:"^(?=.*rep).*czech|czechia|bohemia",COD:"\\bdem.*congo|congo.*\\bdem|congo.*\\bd[\\.]?r|\\bd[\\.]?r.*congo|belgian.?congo|congo.?free.?state|kinshasa|zaire|l.opoldville|drc|droc|rdc",DNK:"denmark",DJI:"djibouti",DMA:"dominica(?!n)",DOM:"dominican.rep",ECU:"ecuador",EGY:"egypt",SLV:"el.?salvador",GNQ:"guine.*eq|eq.*guine|^(?=.*span).*guinea",ERI:"eritrea",EST:"estonia",ETH:"ethiopia|abyssinia",FLK:"falkland|malvinas",FRO:"faroe|faeroe",FJI:"fiji",FIN:"finland",FRA:"^(?!.*\\bdep)(?!.*martinique).*france|french.?republic|\\bgaul",GUF:"^(?=.*french).*guiana",PYF:"french.?polynesia|tahiti",ATF:"french.?southern",GAB:"gabon",GMB:"gambia",GEO:"^(?!.*south).*georgia",DDR:"german.?democratic.?republic|democratic.?republic.*germany|east.germany",DEU:"^(?!.*east).*germany|^(?=.*\\bfed.*\\brep).*german",GHA:"ghana|gold.?coast",GIB:"gibraltar",GRC:"greece|hellenic|hellas",GRL:"greenland",GRD:"grenada",GLP:"guadeloupe",GUM:"\\bguam",GTM:"guatemala",GGY:"guernsey",GIN:"^(?!.*eq)(?!.*span)(?!.*bissau)(?!.*portu)(?!.*new).*guinea",GNB:"bissau|^(?=.*portu).*guinea",GUY:"guyana|british.?guiana",HTI:"haiti",HMD:"heard.*mcdonald",VAT:"holy.?see|vatican|papal.?st",HND:"^(?!.*brit).*honduras",HKG:"hong.?kong",HUN:"^(?!.*austr).*hungary",ISL:"iceland",IND:"india(?!.*ocea)",IDN:"indonesia",IRN:"\\biran|persia",IRQ:"\\biraq|mesopotamia",IRL:"(^ireland)|(^republic.*ireland)",IMN:"^(?=.*isle).*\\bman",ISR:"israel",ITA:"italy",JAM:"jamaica",JPN:"japan",JEY:"jersey",JOR:"jordan",KAZ:"kazak",KEN:"kenya|british.?east.?africa|east.?africa.?prot",KIR:"kiribati",PRK:"^(?=.*democrat|people|north|d.*p.*.r).*\\bkorea|dprk|korea.*(d.*p.*r)",KWT:"kuwait",KGZ:"kyrgyz|kirghiz",LAO:"\\blaos?\\b",LVA:"latvia",LBN:"lebanon",LSO:"lesotho|basuto",LBR:"liberia",LBY:"libya",LIE:"liechtenstein",LTU:"lithuania",LUX:"^(?!.*belg).*luxem",MAC:"maca(o|u)",MDG:"madagascar|malagasy",MWI:"malawi|nyasa",MYS:"malaysia",MDV:"maldive",MLI:"\\bmali\\b",MLT:"\\bmalta",MHL:"marshall",MTQ:"martinique",MRT:"mauritania",MUS:"mauritius",MYT:"\\bmayotte",MEX:"\\bmexic",FSM:"fed.*micronesia|micronesia.*fed",MCO:"monaco",MNG:"mongolia",MNE:"^(?!.*serbia).*montenegro",MSR:"montserrat",MAR:"morocco|\\bmaroc",MOZ:"mozambique",MMR:"myanmar|burma",NAM:"namibia",NRU:"nauru",NPL:"nepal",NLD:"^(?!.*\\bant)(?!.*\\bcarib).*netherlands",ANT:"^(?=.*\\bant).*(nether|dutch)",NCL:"new.?caledonia",NZL:"new.?zealand",NIC:"nicaragua",NER:"\\bniger(?!ia)",NGA:"nigeria",NIU:"niue",NFK:"norfolk",MNP:"mariana",NOR:"norway",OMN:"\\boman|trucial",PAK:"^(?!.*east).*paki?stan",PLW:"palau",PSE:"palestin|\\bgaza|west.?bank",PAN:"panama",PNG:"papua|new.?guinea",PRY:"paraguay",PER:"peru",PHL:"philippines",PCN:"pitcairn",POL:"poland",PRT:"portugal",PRI:"puerto.?rico",QAT:"qatar",KOR:"^(?!.*d.*p.*r)(?!.*democrat)(?!.*people)(?!.*north).*\\bkorea(?!.*d.*p.*r)",MDA:"moldov|b(a|e)ssarabia",REU:"r(e|\xe9)union",ROU:"r(o|u|ou)mania",RUS:"\\brussia|soviet.?union|u\\.?s\\.?s\\.?r|socialist.?republics",RWA:"rwanda",BLM:"barth(e|\xe9)lemy",SHN:"helena",KNA:"kitts|\\bnevis",LCA:"\\blucia",MAF:"^(?=.*collectivity).*martin|^(?=.*france).*martin(?!ique)|^(?=.*french).*martin(?!ique)",SPM:"miquelon",VCT:"vincent",WSM:"^(?!.*amer).*samoa",SMR:"san.?marino",STP:"\\bs(a|\xe3)o.?tom(e|\xe9)",SAU:"\\bsa\\w*.?arabia",SEN:"senegal",SRB:"^(?!.*monte).*serbia",SYC:"seychell",SLE:"sierra",SGP:"singapore",SXM:"^(?!.*martin)(?!.*saba).*maarten",SVK:"^(?!.*cze).*slovak",SVN:"slovenia",SLB:"solomon",SOM:"somali",ZAF:"south.africa|s\\\\..?africa",SGS:"south.?georgia|sandwich",SSD:"\\bs\\w*.?sudan",ESP:"spain",LKA:"sri.?lanka|ceylon",SDN:"^(?!.*\\bs(?!u)).*sudan",SUR:"surinam|dutch.?guiana",SJM:"svalbard",SWZ:"swaziland",SWE:"sweden",CHE:"switz|swiss",SYR:"syria",TWN:"taiwan|taipei|formosa|^(?!.*peo)(?=.*rep).*china",TJK:"tajik",THA:"thailand|\\bsiam",MKD:"macedonia|fyrom",TLS:"^(?=.*leste).*timor|^(?=.*east).*timor",TGO:"togo",TKL:"tokelau",TON:"tonga",TTO:"trinidad|tobago",TUN:"tunisia",TUR:"turkey",TKM:"turkmen",TCA:"turks",TUV:"tuvalu",UGA:"uganda",UKR:"ukrain",ARE:"emirates|^u\\.?a\\.?e\\.?$|united.?arab.?em",GBR:"united.?kingdom|britain|^u\\.?k\\.?$",TZA:"tanzania",USA:"united.?states\\b(?!.*islands)|\\bu\\.?s\\.?a\\.?\\b|^\\s*u\\.?s\\.?\\b(?!.*islands)",UMI:"minor.?outlying.?is",URY:"uruguay",UZB:"uzbek",VUT:"vanuatu|new.?hebrides",VEN:"venezuela",VNM:"^(?!.*republic).*viet.?nam|^(?=.*socialist).*viet.?nam",VGB:"^(?=.*\\bu\\.?\\s?k).*virgin|^(?=.*brit).*virgin|^(?=.*kingdom).*virgin",VIR:"^(?=.*\\bu\\.?\\s?s).*virgin|^(?=.*states).*virgin",WLF:"futuna|wallis",ESH:"western.sahara",YEM:"^(?!.*arab)(?!.*north)(?!.*sana)(?!.*peo)(?!.*dem)(?!.*south)(?!.*aden)(?!.*\\bp\\.?d\\.?r).*yemen",YMD:"^(?=.*peo).*yemen|^(?!.*rep)(?=.*dem).*yemen|^(?=.*south).*yemen|^(?=.*aden).*yemen|^(?=.*\\bp\\.?d\\.?r).*yemen",YUG:"yugoslavia",ZMB:"zambia|northern.?rhodesia",EAZ:"zanzibar",ZWE:"zimbabwe|^(?!.*northern).*rhodesia"}},{}],95:[function(y,ee,Q){ee.exports=["xx-small","x-small","small","medium","large","x-large","xx-large","larger","smaller"]},{}],96:[function(y,ee,Q){ee.exports=["normal","condensed","semi-condensed","extra-condensed","ultra-condensed","expanded","semi-expanded","extra-expanded","ultra-expanded"]},{}],97:[function(y,ee,Q){ee.exports=["normal","italic","oblique"]},{}],98:[function(y,ee,Q){ee.exports=["normal","bold","bolder","lighter","100","200","300","400","500","600","700","800","900"]},{}],99:[function(y,ee,Q){"use strict";ee.exports={parse:y("./parse"),stringify:y("./stringify")}},{"./parse":101,"./stringify":102}],100:[function(y,ee,Q){"use strict";var g=y("css-font-size-keywords");ee.exports={isSize:function(v){return/^[\d\.]/.test(v)||-1!==v.indexOf("/")||-1!==g.indexOf(v)}}},{"css-font-size-keywords":95}],101:[function(y,ee,Q){"use strict";var g=y("unquote"),v=y("css-global-keywords"),m=y("css-system-font-keywords"),x=y("css-font-weight-keywords"),e=y("css-font-style-keywords"),n=y("css-font-stretch-keywords"),t=y("string-split-by"),a=y("./lib/util").isSize;ee.exports=d;var r=d.cache={};function d(i){if("string"!=typeof i)throw new Error("Font argument must be a string.");if(r[i])return r[i];if(""===i)throw new Error("Cannot parse an empty string.");if(-1!==m.indexOf(i))return r[i]={system:i};for(var u,f={style:"normal",variant:"normal",weight:"normal",stretch:"normal",lineHeight:"normal",size:"1rem",family:["serif"]},c=t(i,/\s+/);u=c.shift();){if(-1!==v.indexOf(u))return["style","variant","weight","stretch"].forEach(function(p){f[p]=u}),r[i]=f;if(-1===e.indexOf(u))if("normal"!==u&&"small-caps"!==u)if(-1===n.indexOf(u)){if(-1===x.indexOf(u)){if(a(u)){var h=t(u,"/");if(f.size=h[0],null!=h[1]?f.lineHeight=s(h[1]):"/"===c[0]&&(c.shift(),f.lineHeight=s(c.shift())),!c.length)throw new Error("Missing required font-family.");return f.family=t(c.join(" "),/\s*,\s*/).map(g),r[i]=f}throw new Error("Unknown or unsupported font token: "+u)}f.weight=u}else f.stretch=u;else f.variant=u;else f.style=u}throw new Error("Missing required font-size.")}function s(i){var u=parseFloat(i);return u.toString()===i?u:i}},{"./lib/util":100,"css-font-stretch-keywords":96,"css-font-style-keywords":97,"css-font-weight-keywords":98,"css-global-keywords":103,"css-system-font-keywords":104,"string-split-by":306,unquote:329}],102:[function(y,ee,Q){"use strict";var g=y("pick-by-alias"),v=y("./lib/util").isSize,m=u(y("css-global-keywords")),x=u(y("css-system-font-keywords")),e=u(y("css-font-weight-keywords")),n=u(y("css-font-style-keywords")),t=u(y("css-font-stretch-keywords")),a={normal:1,"small-caps":1},r={serif:1,"sans-serif":1,monospace:1,cursive:1,fantasy:1,"system-ui":1},s="serif";function i(f,c){if(f&&!c[f]&&!m[f])throw Error("Unknown keyword `"+f+"`");return f}function u(f){for(var c={},h=0;h<f.length;h++)c[f[h]]=1;return c}ee.exports=function(f){if((f=g(f,{style:"style fontstyle fontStyle font-style slope distinction",variant:"variant font-variant fontVariant fontvariant var capitalization",weight:"weight w font-weight fontWeight fontweight",stretch:"stretch font-stretch fontStretch fontstretch width",size:"size s font-size fontSize fontsize height em emSize",lineHeight:"lh line-height lineHeight lineheight leading",family:"font family fontFamily font-family fontfamily type typeface face",system:"system reserved default global"})).system)return f.system&&i(f.system,x),f.system;if(i(f.style,n),i(f.variant,a),i(f.weight,e),i(f.stretch,t),null==f.size&&(f.size="1rem"),"number"==typeof f.size&&(f.size+="px"),!v)throw Error("Bad size value `"+f.size+"`");f.family||(f.family=s),Array.isArray(f.family)&&(f.family.length||(f.family=[s]),f.family=f.family.map(function(h){return r[h]?h:'"'+h+'"'}).join(", "));var c=[];return c.push(f.style),f.variant!==f.style&&c.push(f.variant),f.weight!==f.variant&&f.weight!==f.style&&c.push(f.weight),f.stretch!==f.weight&&f.stretch!==f.variant&&f.stretch!==f.style&&c.push(f.stretch),c.push(f.size+(null==f.lineHeight||"normal"===f.lineHeight||f.lineHeight+""=="1"?"":"/"+f.lineHeight)),c.push(f.family),c.filter(Boolean).join(" ")}},{"./lib/util":100,"css-font-stretch-keywords":96,"css-font-style-keywords":97,"css-font-weight-keywords":98,"css-global-keywords":103,"css-system-font-keywords":104,"pick-by-alias":253}],103:[function(y,ee,Q){ee.exports=["inherit","initial","unset"]},{}],104:[function(y,ee,Q){ee.exports=["caption","icon","menu","message-box","small-caption","status-bar"]},{}],105:[function(y,ee,Q){"use strict";var g,v=y("type/value/is"),m=y("type/value/ensure"),x=y("type/plain-function/ensure"),e=y("es5-ext/object/copy"),n=y("es5-ext/object/normalize-options"),t=y("es5-ext/object/map"),a=Function.prototype.bind,r=Object.defineProperty,d=Object.prototype.hasOwnProperty;g=function(s,i,u){var f,c=m(i)&&x(i.value);return delete(f=e(i)).writable,delete f.value,f.get=function(){return!u.overwriteDefinition&&d.call(this,s)?c:(i.value=a.call(c,u.resolveContext?u.resolveContext(this):this),r(this,s,i),this[s])},f},ee.exports=function(s){var i=n(arguments[1]);return v(i.resolveContext)&&x(i.resolveContext),t(s,function(u,f){return g(f,u,i)})}},{"es5-ext/object/copy":147,"es5-ext/object/map":155,"es5-ext/object/normalize-options":156,"type/plain-function/ensure":322,"type/value/ensure":326,"type/value/is":327}],106:[function(y,ee,Q){"use strict";var g=y("type/value/is"),v=y("type/plain-function/is"),m=y("es5-ext/object/assign"),x=y("es5-ext/object/normalize-options"),e=y("es5-ext/string/#/contains");(ee.exports=function(n,t){var a,r,d,s,i;return arguments.length<2||"string"!=typeof n?(s=t,t=n,n=null):s=arguments[2],g(n)?(a=e.call(n,"c"),r=e.call(n,"e"),d=e.call(n,"w")):(a=d=!0,r=!1),i={value:t,configurable:a,enumerable:r,writable:d},s?m(x(s),i):i}).gs=function(n,t,a){var r,d,s,i;return"string"!=typeof n?(s=a,a=t,t=n,n=null):s=arguments[3],g(t)?v(t)?g(a)?v(a)||(s=a,a=void 0):a=void 0:(s=t,t=a=void 0):t=void 0,g(n)?(r=e.call(n,"c"),d=e.call(n,"e")):(r=!0,d=!1),i={get:t,set:a,configurable:r,enumerable:d},s?m(x(s),i):i}},{"es5-ext/object/assign":144,"es5-ext/object/normalize-options":156,"es5-ext/string/#/contains":163,"type/plain-function/is":323,"type/value/is":327}],107:[function(y,ee,Q){var v;v=function(g){"use strict";function v(P,S){return P<S?-1:P>S?1:P>=S?0:NaN}function m(P){var S;return 1===P.length&&(S=P,P=function(E,z){return v(S(E),z)}),{left:function(E,z,R,q){for(null==R&&(R=0),null==q&&(q=E.length);R<q;){var V=R+q>>>1;P(E[V],z)<0?R=V+1:q=V}return R},right:function(E,z,R,q){for(null==R&&(R=0),null==q&&(q=E.length);R<q;){var V=R+q>>>1;P(E[V],z)>0?q=V:R=V+1}return R}}}var x=m(v),e=x.right,n=x.left;function t(P,S){return[P,S]}function a(P){return null===P?NaN:+P}function r(P,S){var E,z,R=P.length,q=0,V=-1,W=0,K=0;if(null==S)for(;++V<R;)isNaN(E=a(P[V]))||(K+=(z=E-W)*(E-(W+=z/++q)));else for(;++V<R;)isNaN(E=a(S(P[V],V,P)))||(K+=(z=E-W)*(E-(W+=z/++q)));if(q>1)return K/(q-1)}function d(P,S){var E=r(P,S);return E&&Math.sqrt(E)}function s(P,S){var E,z,R,q=P.length,V=-1;if(null==S){for(;++V<q;)if(null!=(E=P[V])&&E>=E)for(z=R=E;++V<q;)null!=(E=P[V])&&(z>E&&(z=E),R<E&&(R=E))}else for(;++V<q;)if(null!=(E=S(P[V],V,P))&&E>=E)for(z=R=E;++V<q;)null!=(E=S(P[V],V,P))&&(z>E&&(z=E),R<E&&(R=E));return[z,R]}var i=Array.prototype,u=i.slice,f=i.map;function c(P){return function(){return P}}function h(P){return P}function p(P,S,E){P=+P,S=+S,E=(R=arguments.length)<2?(S=P,P=0,1):R<3?1:+E;for(var z=-1,R=0|Math.max(0,Math.ceil((S-P)/E)),q=new Array(R);++z<R;)q[z]=P+z*E;return q}var o=Math.sqrt(50),b=Math.sqrt(10),l=Math.sqrt(2);function T(P,S,E){var z=(S-P)/Math.max(0,E),R=Math.floor(Math.log(z)/Math.LN10),q=z/Math.pow(10,R);return R>=0?(q>=o?10:q>=b?5:q>=l?2:1)*Math.pow(10,R):-Math.pow(10,-R)/(q>=o?10:q>=b?5:q>=l?2:1)}function _(P,S,E){var z=Math.abs(S-P)/Math.max(0,E),R=Math.pow(10,Math.floor(Math.log(z)/Math.LN10)),q=z/R;return q>=o?R*=10:q>=b?R*=5:q>=l&&(R*=2),S<P?-R:R}function w(P){return Math.ceil(Math.log(P.length)/Math.LN2)+1}function k(P,S,E){if(null==E&&(E=a),z=P.length){if((S=+S)<=0||z<2)return+E(P[0],0,P);if(S>=1)return+E(P[z-1],z-1,P);var z,R=(z-1)*S,q=Math.floor(R),V=+E(P[q],q,P);return V+(+E(P[q+1],q+1,P)-V)*(R-q)}}function L(P,S){var E,z,R=P.length,q=-1;if(null==S){for(;++q<R;)if(null!=(E=P[q])&&E>=E)for(z=E;++q<R;)null!=(E=P[q])&&z>E&&(z=E)}else for(;++q<R;)if(null!=(E=S(P[q],q,P))&&E>=E)for(z=E;++q<R;)null!=(E=S(P[q],q,P))&&z>E&&(z=E);return z}function M(P){if(!(R=P.length))return[];for(var S=-1,E=L(P,I),z=new Array(E);++S<E;)for(var R,q=-1,V=z[S]=new Array(R);++q<R;)V[q]=P[q][S];return z}function I(P){return P.length}g.bisect=e,g.bisectRight=e,g.bisectLeft=n,g.ascending=v,g.bisector=m,g.cross=function(P,S,E){var z,R,q,V,W=P.length,K=S.length,G=new Array(W*K);for(null==E&&(E=t),z=q=0;z<W;++z)for(V=P[z],R=0;R<K;++R,++q)G[q]=E(V,S[R]);return G},g.descending=function(P,S){return S<P?-1:S>P?1:S>=P?0:NaN},g.deviation=d,g.extent=s,g.histogram=function(){var P=h,S=s,E=w;function z(R){var q,V,W=R.length,K=new Array(W);for(q=0;q<W;++q)K[q]=P(R[q],q,R);var G=S(K),Y=G[0],$=G[1],B=E(K,Y,$);Array.isArray(B)||(B=_(Y,$,B),B=p(Math.ceil(Y/B)*B,$,B));for(var N=B.length;B[0]<=Y;)B.shift(),--N;for(;B[N-1]>$;)B.pop(),--N;var U,te=new Array(N+1);for(q=0;q<=N;++q)(U=te[q]=[]).x0=q>0?B[q-1]:Y,U.x1=q<N?B[q]:$;for(q=0;q<W;++q)Y<=(V=K[q])&&V<=$&&te[e(B,V,0,N)].push(R[q]);return te}return z.value=function(R){return arguments.length?(P="function"==typeof R?R:c(R),z):P},z.domain=function(R){return arguments.length?(S="function"==typeof R?R:c([R[0],R[1]]),z):S},z.thresholds=function(R){return arguments.length?(E="function"==typeof R?R:Array.isArray(R)?c(u.call(R)):c(R),z):E},z},g.thresholdFreedmanDiaconis=function(P,S,E){return P=f.call(P,a).sort(v),Math.ceil((E-S)/(2*(k(P,.75)-k(P,.25))*Math.pow(P.length,-1/3)))},g.thresholdScott=function(P,S,E){return Math.ceil((E-S)/(3.5*d(P)*Math.pow(P.length,-1/3)))},g.thresholdSturges=w,g.max=function(P,S){var E,z,R=P.length,q=-1;if(null==S){for(;++q<R;)if(null!=(E=P[q])&&E>=E)for(z=E;++q<R;)null!=(E=P[q])&&E>z&&(z=E)}else for(;++q<R;)if(null!=(E=S(P[q],q,P))&&E>=E)for(z=E;++q<R;)null!=(E=S(P[q],q,P))&&E>z&&(z=E);return z},g.mean=function(P,S){var E,z=P.length,R=z,q=-1,V=0;if(null==S)for(;++q<z;)isNaN(E=a(P[q]))?--R:V+=E;else for(;++q<z;)isNaN(E=a(S(P[q],q,P)))?--R:V+=E;if(R)return V/R},g.median=function(P,S){var E,z=P.length,R=-1,q=[];if(null==S)for(;++R<z;)isNaN(E=a(P[R]))||q.push(E);else for(;++R<z;)isNaN(E=a(S(P[R],R,P)))||q.push(E);return k(q.sort(v),.5)},g.merge=function(P){for(var S,E,z,R=P.length,q=-1,V=0;++q<R;)V+=P[q].length;for(E=new Array(V);--R>=0;)for(S=(z=P[R]).length;--S>=0;)E[--V]=z[S];return E},g.min=L,g.pairs=function(P,S){null==S&&(S=t);for(var E=0,z=P.length-1,R=P[0],q=new Array(z<0?0:z);E<z;)q[E]=S(R,R=P[++E]);return q},g.permute=function(P,S){for(var E=S.length,z=new Array(E);E--;)z[E]=P[S[E]];return z},g.quantile=k,g.range=p,g.scan=function(P,S){if(E=P.length){var E,z,R=0,q=0,V=P[q];for(null==S&&(S=v);++R<E;)(S(z=P[R],V)<0||0!==S(V,V))&&(V=z,q=R);return 0===S(V,V)?q:void 0}},g.shuffle=function(P,S,E){for(var z,R,q=(E??P.length)-(S=null==S?0:+S);q;)R=Math.random()*q--|0,z=P[q+S],P[q+S]=P[R+S],P[R+S]=z;return P},g.sum=function(P,S){var E,z=P.length,R=-1,q=0;if(null==S)for(;++R<z;)(E=+P[R])&&(q+=E);else for(;++R<z;)(E=+S(P[R],R,P))&&(q+=E);return q},g.ticks=function(P,S,E){var z,R,q,V,W=-1;if(E=+E,(P=+P)==(S=+S)&&E>0)return[P];if((z=S<P)&&(R=P,P=S,S=R),0===(V=T(P,S,E))||!isFinite(V))return[];if(V>0)for(P=Math.ceil(P/V),S=Math.floor(S/V),q=new Array(R=Math.ceil(S-P+1));++W<R;)q[W]=(P+W)*V;else for(P=Math.floor(P*V),S=Math.ceil(S*V),q=new Array(R=Math.ceil(P-S+1));++W<R;)q[W]=(P-W)/V;return z&&q.reverse(),q},g.tickIncrement=T,g.tickStep=_,g.transpose=M,g.variance=r,g.zip=function(){return M(arguments)},Object.defineProperty(g,"__esModule",{value:!0})},v("object"==typeof Q&&void 0!==ee?Q:this.d3=this.d3||{})},{}],108:[function(y,ee,Q){var v;v=function(g){"use strict";function v(){}function m(s,i){var u=new v;if(s instanceof v)s.each(function(o,b){u.set(b,o)});else if(Array.isArray(s)){var f,c=-1,h=s.length;if(null==i)for(;++c<h;)u.set(c,s[c]);else for(;++c<h;)u.set(i(f=s[c],c,s),f)}else if(s)for(var p in s)u.set(p,s[p]);return u}function x(){return{}}function e(s,i,u){s[i]=u}function n(){return m()}function t(s,i,u){s.set(i,u)}function a(){}v.prototype=m.prototype={constructor:v,has:function(s){return"$"+s in this},get:function(s){return this["$"+s]},set:function(s,i){return this["$"+s]=i,this},remove:function(s){var i="$"+s;return i in this&&delete this[i]},clear:function(){for(var s in this)"$"===s[0]&&delete this[s]},keys:function(){var s=[];for(var i in this)"$"===i[0]&&s.push(i.slice(1));return s},values:function(){var s=[];for(var i in this)"$"===i[0]&&s.push(this[i]);return s},entries:function(){var s=[];for(var i in this)"$"===i[0]&&s.push({key:i.slice(1),value:this[i]});return s},size:function(){var s=0;for(var i in this)"$"===i[0]&&++s;return s},empty:function(){for(var s in this)if("$"===s[0])return!1;return!0},each:function(s){for(var i in this)"$"===i[0]&&s(this[i],i.slice(1),this)}};var r=m.prototype;function d(s,i){var u=new a;if(s instanceof a)s.each(function(h){u.add(h)});else if(s){var f=-1,c=s.length;if(null==i)for(;++f<c;)u.add(s[f]);else for(;++f<c;)u.add(i(s[f],f,s))}return u}a.prototype=d.prototype={constructor:a,has:r.has,add:function(s){return this["$"+(s+="")]=s,this},remove:r.remove,clear:r.clear,values:r.keys,size:r.size,empty:r.empty,each:r.each},g.nest=function(){var s,i,u,f=[],c=[];function h(p,o,b,l){if(o>=f.length)return null!=s&&p.sort(s),null!=i?i(p):p;for(var T,_,w,k=-1,L=p.length,M=f[o++],I=m(),P=b();++k<L;)(w=I.get(T=M(_=p[k])+""))?w.push(_):I.set(T,[_]);return I.each(function(S,E){l(P,E,h(S,o,b,l))}),P}return u={object:function(p){return h(p,0,x,e)},map:function(p){return h(p,0,n,t)},entries:function(p){return function o(b,l){if(++l>f.length)return b;var T,_=c[l-1];return null!=i&&l>=f.length?T=b.entries():(T=[],b.each(function(w,k){T.push({key:k,values:o(w,l)})})),null!=_?T.sort(function(w,k){return _(w.key,k.key)}):T}(h(p,0,n,t),0)},key:function(p){return f.push(p),u},sortKeys:function(p){return c[f.length-1]=p,u},sortValues:function(p){return s=p,u},rollup:function(p){return i=p,u}}},g.set=d,g.map=m,g.keys=function(s){var i=[];for(var u in s)i.push(u);return i},g.values=function(s){var i=[];for(var u in s)i.push(s[u]);return i},g.entries=function(s){var i=[];for(var u in s)i.push({key:u,value:s[u]});return i},Object.defineProperty(g,"__esModule",{value:!0})},v("object"==typeof Q&&void 0!==ee?Q:this.d3=this.d3||{})},{}],109:[function(y,ee,Q){var g,v;g=this,v=function(g){"use strict";function v(fe,ve,Ae){fe.prototype=ve.prototype=Ae,Ae.constructor=fe}function m(fe,ve){var Ae=Object.create(fe.prototype);for(var ke in ve)Ae[ke]=ve[ke];return Ae}function x(){}var e="\\s*([+-]?\\d+)\\s*",n="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)\\s*",t="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)%\\s*",a=/^#([0-9a-f]{3,8})$/,r=new RegExp("^rgb\\("+[e,e,e]+"\\)$"),d=new RegExp("^rgb\\("+[t,t,t]+"\\)$"),s=new RegExp("^rgba\\("+[e,e,e,n]+"\\)$"),i=new RegExp("^rgba\\("+[t,t,t,n]+"\\)$"),u=new RegExp("^hsl\\("+[n,t,t]+"\\)$"),f=new RegExp("^hsla\\("+[n,t,t,n]+"\\)$"),c={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function h(){return this.rgb().formatHex()}function p(){return this.rgb().formatRgb()}function o(fe){var ve,Ae;return fe=(fe+"").trim().toLowerCase(),(ve=a.exec(fe))?(Ae=ve[1].length,ve=parseInt(ve[1],16),6===Ae?b(ve):3===Ae?new w(ve>>8&15|ve>>4&240,ve>>4&15|240&ve,(15&ve)<<4|15&ve,1):8===Ae?l(ve>>24&255,ve>>16&255,ve>>8&255,(255&ve)/255):4===Ae?l(ve>>12&15|ve>>8&240,ve>>8&15|ve>>4&240,ve>>4&15|240&ve,((15&ve)<<4|15&ve)/255):null):(ve=r.exec(fe))?new w(ve[1],ve[2],ve[3],1):(ve=d.exec(fe))?new w(255*ve[1]/100,255*ve[2]/100,255*ve[3]/100,1):(ve=s.exec(fe))?l(ve[1],ve[2],ve[3],ve[4]):(ve=i.exec(fe))?l(255*ve[1]/100,255*ve[2]/100,255*ve[3]/100,ve[4]):(ve=u.exec(fe))?I(ve[1],ve[2]/100,ve[3]/100,1):(ve=f.exec(fe))?I(ve[1],ve[2]/100,ve[3]/100,ve[4]):c.hasOwnProperty(fe)?b(c[fe]):"transparent"===fe?new w(NaN,NaN,NaN,0):null}function b(fe){return new w(fe>>16&255,fe>>8&255,255&fe,1)}function l(fe,ve,Ae,ke){return ke<=0&&(fe=ve=Ae=NaN),new w(fe,ve,Ae,ke)}function T(fe){return fe instanceof x||(fe=o(fe)),fe?new w((fe=fe.rgb()).r,fe.g,fe.b,fe.opacity):new w}function _(fe,ve,Ae,ke){return 1===arguments.length?T(fe):new w(fe,ve,Ae,ke??1)}function w(fe,ve,Ae,ke){this.r=+fe,this.g=+ve,this.b=+Ae,this.opacity=+ke}function k(){return"#"+M(this.r)+M(this.g)+M(this.b)}function L(){var fe=this.opacity;return(1===(fe=isNaN(fe)?1:Math.max(0,Math.min(1,fe)))?"rgb(":"rgba(")+Math.max(0,Math.min(255,Math.round(this.r)||0))+", "+Math.max(0,Math.min(255,Math.round(this.g)||0))+", "+Math.max(0,Math.min(255,Math.round(this.b)||0))+(1===fe?")":", "+fe+")")}function M(fe){return((fe=Math.max(0,Math.min(255,Math.round(fe)||0)))<16?"0":"")+fe.toString(16)}function I(fe,ve,Ae,ke){return ke<=0?fe=ve=Ae=NaN:Ae<=0||Ae>=1?fe=ve=NaN:ve<=0&&(fe=NaN),new E(fe,ve,Ae,ke)}function P(fe){if(fe instanceof E)return new E(fe.h,fe.s,fe.l,fe.opacity);if(fe instanceof x||(fe=o(fe)),!fe)return new E;if(fe instanceof E)return fe;var ve=(fe=fe.rgb()).r/255,Ae=fe.g/255,ke=fe.b/255,Pe=Math.min(ve,Ae,ke),Ne=Math.max(ve,Ae,ke),De=NaN,ze=Ne-Pe,Me=(Ne+Pe)/2;return ze?(De=ve===Ne?(Ae-ke)/ze+6*(Ae<ke):Ae===Ne?(ke-ve)/ze+2:(ve-Ae)/ze+4,ze/=Me<.5?Ne+Pe:2-Ne-Pe,De*=60):ze=Me>0&&Me<1?0:De,new E(De,ze,Me,fe.opacity)}function S(fe,ve,Ae,ke){return 1===arguments.length?P(fe):new E(fe,ve,Ae,ke??1)}function E(fe,ve,Ae,ke){this.h=+fe,this.s=+ve,this.l=+Ae,this.opacity=+ke}function z(fe,ve,Ae){return 255*(fe<60?ve+(Ae-ve)*fe/60:fe<180?Ae:fe<240?ve+(Ae-ve)*(240-fe)/60:ve)}v(x,o,{copy:function(fe){return Object.assign(new this.constructor,this,fe)},displayable:function(){return this.rgb().displayable()},hex:h,formatHex:h,formatHsl:function(){return P(this).formatHsl()},formatRgb:p,toString:p}),v(w,_,m(x,{brighter:function(fe){return fe=null==fe?1/.7:Math.pow(1/.7,fe),new w(this.r*fe,this.g*fe,this.b*fe,this.opacity)},darker:function(fe){return fe=null==fe?.7:Math.pow(.7,fe),new w(this.r*fe,this.g*fe,this.b*fe,this.opacity)},rgb:function(){return this},displayable:function(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:k,formatHex:k,formatRgb:L,toString:L})),v(E,S,m(x,{brighter:function(fe){return fe=null==fe?1/.7:Math.pow(1/.7,fe),new E(this.h,this.s,this.l*fe,this.opacity)},darker:function(fe){return fe=null==fe?.7:Math.pow(.7,fe),new E(this.h,this.s,this.l*fe,this.opacity)},rgb:function(){var fe=this.h%360+360*(this.h<0),ve=isNaN(fe)||isNaN(this.s)?0:this.s,Ae=this.l,ke=Ae+(Ae<.5?Ae:1-Ae)*ve,Pe=2*Ae-ke;return new w(z(fe>=240?fe-240:fe+120,Pe,ke),z(fe,Pe,ke),z(fe<120?fe+240:fe-120,Pe,ke),this.opacity)},displayable:function(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl:function(){var fe=this.opacity;return(1===(fe=isNaN(fe)?1:Math.max(0,Math.min(1,fe)))?"hsl(":"hsla(")+(this.h||0)+", "+100*(this.s||0)+"%, "+100*(this.l||0)+"%"+(1===fe?")":", "+fe+")")}}));var R=Math.PI/180,q=180/Math.PI,V=6/29,W=3*V*V;function K(fe){if(fe instanceof Y)return new Y(fe.l,fe.a,fe.b,fe.opacity);if(fe instanceof J)return X(fe);fe instanceof w||(fe=T(fe));var ve,Ae,ke=U(fe.r),Pe=U(fe.g),Ne=U(fe.b),De=$((.2225045*ke+.7168786*Pe+.0606169*Ne)/1);return ke===Pe&&Pe===Ne?ve=Ae=De:(ve=$((.4360747*ke+.3850649*Pe+.1430804*Ne)/.96422),Ae=$((.0139322*ke+.0971045*Pe+.7141733*Ne)/.82521)),new Y(116*De-16,500*(ve-De),200*(De-Ae),fe.opacity)}function G(fe,ve,Ae,ke){return 1===arguments.length?K(fe):new Y(fe,ve,Ae,ke??1)}function Y(fe,ve,Ae,ke){this.l=+fe,this.a=+ve,this.b=+Ae,this.opacity=+ke}function $(fe){return fe>.008856451679035631?Math.pow(fe,1/3):fe/W+4/29}function B(fe){return fe>V?fe*fe*fe:W*(fe-4/29)}function N(fe){return 255*(fe<=.0031308?12.92*fe:1.055*Math.pow(fe,1/2.4)-.055)}function U(fe){return(fe/=255)<=.04045?fe/12.92:Math.pow((fe+.055)/1.055,2.4)}function te(fe){if(fe instanceof J)return new J(fe.h,fe.c,fe.l,fe.opacity);if(fe instanceof Y||(fe=K(fe)),0===fe.a&&0===fe.b)return new J(NaN,0<fe.l&&fe.l<100?0:NaN,fe.l,fe.opacity);var ve=Math.atan2(fe.b,fe.a)*q;return new J(ve<0?ve+360:ve,Math.sqrt(fe.a*fe.a+fe.b*fe.b),fe.l,fe.opacity)}function j(fe,ve,Ae,ke){return 1===arguments.length?te(fe):new J(fe,ve,Ae,ke??1)}function J(fe,ve,Ae,ke){this.h=+fe,this.c=+ve,this.l=+Ae,this.opacity=+ke}function X(fe){if(isNaN(fe.h))return new Y(fe.l,0,0,fe.opacity);var ve=fe.h*R;return new Y(fe.l,Math.cos(ve)*fe.c,Math.sin(ve)*fe.c,fe.opacity)}v(Y,G,m(x,{brighter:function(fe){return new Y(this.l+18*(fe??1),this.a,this.b,this.opacity)},darker:function(fe){return new Y(this.l-18*(fe??1),this.a,this.b,this.opacity)},rgb:function(){var fe=(this.l+16)/116,ve=isNaN(this.a)?fe:fe+this.a/500,Ae=isNaN(this.b)?fe:fe-this.b/200;return new w(N(3.1338561*(ve=.96422*B(ve))-1.6168667*(fe=1*B(fe))-.4906146*(Ae=.82521*B(Ae))),N(-.9787684*ve+1.9161415*fe+.033454*Ae),N(.0719453*ve-.2289914*fe+1.4052427*Ae),this.opacity)}})),v(J,j,m(x,{brighter:function(fe){return new J(this.h,this.c,this.l+18*(fe??1),this.opacity)},darker:function(fe){return new J(this.h,this.c,this.l-18*(fe??1),this.opacity)},rgb:function(){return X(this).rgb()}}));var ne=1.78277,le=-.29227,oe=-.90649,de=1.97294,se=de*oe,ge=de*ne,_e=ne*le- -.14861*oe;function Te(fe){if(fe instanceof Oe)return new Oe(fe.h,fe.s,fe.l,fe.opacity);fe instanceof w||(fe=T(fe));var Ae=fe.g/255,ke=fe.b/255,Pe=(_e*ke+se*(fe.r/255)-ge*Ae)/(_e+se-ge),Ne=ke-Pe,De=(de*(Ae-Pe)-le*Ne)/oe,ze=Math.sqrt(De*De+Ne*Ne)/(de*Pe*(1-Pe)),Me=ze?Math.atan2(De,Ne)*q-120:NaN;return new Oe(Me<0?Me+360:Me,ze,Pe,fe.opacity)}function we(fe,ve,Ae,ke){return 1===arguments.length?Te(fe):new Oe(fe,ve,Ae,ke??1)}function Oe(fe,ve,Ae,ke){this.h=+fe,this.s=+ve,this.l=+Ae,this.opacity=+ke}v(Oe,we,m(x,{brighter:function(fe){return fe=null==fe?1/.7:Math.pow(1/.7,fe),new Oe(this.h,this.s,this.l*fe,this.opacity)},darker:function(fe){return fe=null==fe?.7:Math.pow(.7,fe),new Oe(this.h,this.s,this.l*fe,this.opacity)},rgb:function(){var fe=isNaN(this.h)?0:(this.h+120)*R,ve=+this.l,Ae=isNaN(this.s)?0:this.s*ve*(1-ve),ke=Math.cos(fe),Pe=Math.sin(fe);return new w(255*(ve+Ae*(-.14861*ke+ne*Pe)),255*(ve+Ae*(le*ke+oe*Pe)),255*(ve+Ae*(de*ke)),this.opacity)}})),g.color=o,g.cubehelix=we,g.gray=function(fe,ve){return new Y(fe,0,0,ve??1)},g.hcl=j,g.hsl=S,g.lab=G,g.lch=function(fe,ve,Ae,ke){return 1===arguments.length?te(fe):new J(Ae,ve,fe,ke??1)},g.rgb=_,Object.defineProperty(g,"__esModule",{value:!0})},v("object"==typeof Q&&void 0!==ee?Q:(g=g||self).d3=g.d3||{})},{}],110:[function(y,ee,Q){var g,v;g=this,v=function(g){"use strict";var v={value:function(){}};function m(){for(var a,r=0,d=arguments.length,s={};r<d;++r){if(!(a=arguments[r]+"")||a in s||/[\s.]/.test(a))throw new Error("illegal type: "+a);s[a]=[]}return new x(s)}function x(a){this._=a}function e(a,r){return a.trim().split(/^|\s+/).map(function(d){var s="",i=d.indexOf(".");if(i>=0&&(s=d.slice(i+1),d=d.slice(0,i)),d&&!r.hasOwnProperty(d))throw new Error("unknown type: "+d);return{type:d,name:s}})}function n(a,r){for(var d,s=0,i=a.length;s<i;++s)if((d=a[s]).name===r)return d.value}function t(a,r,d){for(var s=0,i=a.length;s<i;++s)if(a[s].name===r){a[s]=v,a=a.slice(0,s).concat(a.slice(s+1));break}return null!=d&&a.push({name:r,value:d}),a}x.prototype=m.prototype={constructor:x,on:function(a,r){var d,s=this._,i=e(a+"",s),u=-1,f=i.length;if(!(arguments.length<2)){if(null!=r&&"function"!=typeof r)throw new Error("invalid callback: "+r);for(;++u<f;)if(d=(a=i[u]).type)s[d]=t(s[d],a.name,r);else if(null==r)for(d in s)s[d]=t(s[d],a.name,null);return this}for(;++u<f;)if((d=(a=i[u]).type)&&(d=n(s[d],a.name)))return d},copy:function(){var a={},r=this._;for(var d in r)a[d]=r[d].slice();return new x(a)},call:function(a,r){if((d=arguments.length-2)>0)for(var d,s,i=new Array(d),u=0;u<d;++u)i[u]=arguments[u+2];if(!this._.hasOwnProperty(a))throw new Error("unknown type: "+a);for(u=0,d=(s=this._[a]).length;u<d;++u)s[u].value.apply(r,i)},apply:function(a,r,d){if(!this._.hasOwnProperty(a))throw new Error("unknown type: "+a);for(var s=this._[a],i=0,u=s.length;i<u;++i)s[i].value.apply(r,d)}},g.dispatch=m,Object.defineProperty(g,"__esModule",{value:!0})},v("object"==typeof Q&&void 0!==ee?Q:(g=g||self).d3=g.d3||{})},{}],111:[function(y,ee,Q){var g,v;g=this,v=function(g,v,m,x,e){"use strict";function n(c){return function(){return c}}function t(){return 1e-6*(Math.random()-.5)}function a(c){return c.x+c.vx}function r(c){return c.y+c.vy}function d(c){return c.index}function s(c,h){var p=c.get(h);if(!p)throw new Error("missing: "+h);return p}function i(c){return c.x}function u(c){return c.y}var f=Math.PI*(3-Math.sqrt(5));g.forceCenter=function(c,h){var p;function o(){var b,l,T=p.length,_=0,w=0;for(b=0;b<T;++b)_+=(l=p[b]).x,w+=l.y;for(_=_/T-c,w=w/T-h,b=0;b<T;++b)(l=p[b]).x-=_,l.y-=w}return null==c&&(c=0),null==h&&(h=0),o.initialize=function(b){p=b},o.x=function(b){return arguments.length?(c=+b,o):c},o.y=function(b){return arguments.length?(h=+b,o):h},o},g.forceCollide=function(c){var h,p,o=1,b=1;function l(){for(var w,k,L,M,I,P,S,E=h.length,z=0;z<b;++z)for(k=v.quadtree(h,a,r).visitAfter(T),w=0;w<E;++w)S=(P=p[(L=h[w]).index])*P,M=L.x+L.vx,I=L.y+L.vy,k.visit(R);function R(q,V,W,K,G){var Y=q.data,$=q.r,B=P+$;if(!Y)return V>M+B||K<M-B||W>I+B||G<I-B;if(Y.index>L.index){var N=M-Y.x-Y.vx,U=I-Y.y-Y.vy,te=N*N+U*U;te<B*B&&(0===N&&(te+=(N=t())*N),0===U&&(te+=(U=t())*U),te=(B-(te=Math.sqrt(te)))/te*o,L.vx+=(N*=te)*(B=($*=$)/(S+$)),L.vy+=(U*=te)*B,Y.vx-=N*(B=1-B),Y.vy-=U*B)}}}function T(w){if(w.data)return w.r=p[w.data.index];for(var k=w.r=0;k<4;++k)w[k]&&w[k].r>w.r&&(w.r=w[k].r)}function _(){if(h){var w,k,L=h.length;for(p=new Array(L),w=0;w<L;++w)p[(k=h[w]).index]=+c(k,w,h)}}return"function"!=typeof c&&(c=n(null==c?1:+c)),l.initialize=function(w){h=w,_()},l.iterations=function(w){return arguments.length?(b=+w,l):b},l.strength=function(w){return arguments.length?(o=+w,l):o},l.radius=function(w){return arguments.length?(c="function"==typeof w?w:n(+w),_(),l):c},l},g.forceLink=function(c){var h,p,o,b,l,T=d,_=function(S){return 1/Math.min(b[S.source.index],b[S.target.index])},w=n(30),k=1;function L(S){for(var E=0,z=c.length;E<k;++E)for(var R,q,V,W,K,G,Y,$=0;$<z;++$)q=(R=c[$]).source,W=(V=R.target).x+V.vx-q.x-q.vx||t(),K=V.y+V.vy-q.y-q.vy||t(),W*=G=((G=Math.sqrt(W*W+K*K))-p[$])/G*S*h[$],K*=G,V.vx-=W*(Y=l[$]),V.vy-=K*Y,q.vx+=W*(Y=1-Y),q.vy+=K*Y}function M(){if(o){var S,E,z=o.length,R=c.length,q=m.map(o,T);for(S=0,b=new Array(z);S<R;++S)(E=c[S]).index=S,"object"!=typeof E.source&&(E.source=s(q,E.source)),"object"!=typeof E.target&&(E.target=s(q,E.target)),b[E.source.index]=(b[E.source.index]||0)+1,b[E.target.index]=(b[E.target.index]||0)+1;for(S=0,l=new Array(R);S<R;++S)l[S]=b[(E=c[S]).source.index]/(b[E.source.index]+b[E.target.index]);h=new Array(R),I(),p=new Array(R),P()}}function I(){if(o)for(var S=0,E=c.length;S<E;++S)h[S]=+_(c[S],S,c)}function P(){if(o)for(var S=0,E=c.length;S<E;++S)p[S]=+w(c[S],S,c)}return null==c&&(c=[]),L.initialize=function(S){o=S,M()},L.links=function(S){return arguments.length?(c=S,M(),L):c},L.id=function(S){return arguments.length?(T=S,L):T},L.iterations=function(S){return arguments.length?(k=+S,L):k},L.strength=function(S){return arguments.length?(_="function"==typeof S?S:n(+S),I(),L):_},L.distance=function(S){return arguments.length?(w="function"==typeof S?S:n(+S),P(),L):w},L},g.forceManyBody=function(){var c,h,p,o,b=n(-30),l=1,T=1/0,_=.81;function w(I){var P,S=c.length,E=v.quadtree(c,i,u).visitAfter(L);for(p=I,P=0;P<S;++P)h=c[P],E.visit(M)}function k(){if(c){var I,P,S=c.length;for(o=new Array(S),I=0;I<S;++I)o[(P=c[I]).index]=+b(P,I,c)}}function L(I){var P,S,E,z,R,q=0,V=0;if(I.length){for(E=z=R=0;R<4;++R)(P=I[R])&&(S=Math.abs(P.value))&&(q+=P.value,V+=S,E+=S*P.x,z+=S*P.y);I.x=E/V,I.y=z/V}else{(P=I).x=P.data.x,P.y=P.data.y;do{q+=o[P.data.index]}while(P=P.next)}I.value=q}function M(I,P,S,E){if(!I.value)return!0;var z=I.x-h.x,R=I.y-h.y,q=E-P,V=z*z+R*R;if(q*q/_<V)return V<T&&(0===z&&(V+=(z=t())*z),0===R&&(V+=(R=t())*R),V<l&&(V=Math.sqrt(l*V)),h.vx+=z*I.value*p/V,h.vy+=R*I.value*p/V),!0;if(!(I.length||V>=T)){(I.data!==h||I.next)&&(0===z&&(V+=(z=t())*z),0===R&&(V+=(R=t())*R),V<l&&(V=Math.sqrt(l*V)));do{I.data!==h&&(h.vx+=z*(q=o[I.data.index]*p/V),h.vy+=R*q)}while(I=I.next)}}return w.initialize=function(I){c=I,k()},w.strength=function(I){return arguments.length?(b="function"==typeof I?I:n(+I),k(),w):b},w.distanceMin=function(I){return arguments.length?(l=I*I,w):Math.sqrt(l)},w.distanceMax=function(I){return arguments.length?(T=I*I,w):Math.sqrt(T)},w.theta=function(I){return arguments.length?(_=I*I,w):Math.sqrt(_)},w},g.forceRadial=function(c,h,p){var o,b,l,T=n(.1);function _(k){for(var L=0,M=o.length;L<M;++L){var I=o[L],P=I.x-h||1e-6,S=I.y-p||1e-6,E=Math.sqrt(P*P+S*S),z=(l[L]-E)*b[L]*k/E;I.vx+=P*z,I.vy+=S*z}}function w(){if(o){var k,L=o.length;for(b=new Array(L),l=new Array(L),k=0;k<L;++k)l[k]=+c(o[k],k,o),b[k]=isNaN(l[k])?0:+T(o[k],k,o)}}return"function"!=typeof c&&(c=n(+c)),null==h&&(h=0),null==p&&(p=0),_.initialize=function(k){o=k,w()},_.strength=function(k){return arguments.length?(T="function"==typeof k?k:n(+k),w(),_):T},_.radius=function(k){return arguments.length?(c="function"==typeof k?k:n(+k),w(),_):c},_.x=function(k){return arguments.length?(h=+k,_):h},_.y=function(k){return arguments.length?(p=+k,_):p},_},g.forceSimulation=function(c){var h,p=1,o=.001,b=1-Math.pow(o,1/300),l=0,T=.6,_=m.map(),w=e.timer(L),k=x.dispatch("tick","end");function L(){M(),k.call("tick",h),p<o&&(w.stop(),k.call("end",h))}function M(S){var E,z,R=c.length;void 0===S&&(S=1);for(var q=0;q<S;++q)for(p+=(l-p)*b,_.each(function(V){V(p)}),E=0;E<R;++E)null==(z=c[E]).fx?z.x+=z.vx*=T:(z.x=z.fx,z.vx=0),null==z.fy?z.y+=z.vy*=T:(z.y=z.fy,z.vy=0);return h}function I(){for(var S,E=0,z=c.length;E<z;++E){if((S=c[E]).index=E,null!=S.fx&&(S.x=S.fx),null!=S.fy&&(S.y=S.fy),isNaN(S.x)||isNaN(S.y)){var R=10*Math.sqrt(E),q=E*f;S.x=R*Math.cos(q),S.y=R*Math.sin(q)}(isNaN(S.vx)||isNaN(S.vy))&&(S.vx=S.vy=0)}}function P(S){return S.initialize&&S.initialize(c),S}return null==c&&(c=[]),I(),h={tick:M,restart:function(){return w.restart(L),h},stop:function(){return w.stop(),h},nodes:function(S){return arguments.length?(c=S,I(),_.each(P),h):c},alpha:function(S){return arguments.length?(p=+S,h):p},alphaMin:function(S){return arguments.length?(o=+S,h):o},alphaDecay:function(S){return arguments.length?(b=+S,h):+b},alphaTarget:function(S){return arguments.length?(l=+S,h):l},velocityDecay:function(S){return arguments.length?(T=1-S,h):1-T},force:function(S,E){return arguments.length>1?(null==E?_.remove(S):_.set(S,P(E)),h):_.get(S)},find:function(S,E,z){var R,q,V,W,K,G=0,Y=c.length;for(null==z?z=1/0:z*=z,G=0;G<Y;++G)(V=(R=S-(W=c[G]).x)*R+(q=E-W.y)*q)<z&&(K=W,z=V);return K},on:function(S,E){return arguments.length>1?(k.on(S,E),h):k.on(S)}}},g.forceX=function(c){var h,p,o,b=n(.1);function l(_){for(var w,k=0,L=h.length;k<L;++k)(w=h[k]).vx+=(o[k]-w.x)*p[k]*_}function T(){if(h){var _,w=h.length;for(p=new Array(w),o=new Array(w),_=0;_<w;++_)p[_]=isNaN(o[_]=+c(h[_],_,h))?0:+b(h[_],_,h)}}return"function"!=typeof c&&(c=n(null==c?0:+c)),l.initialize=function(_){h=_,T()},l.strength=function(_){return arguments.length?(b="function"==typeof _?_:n(+_),T(),l):b},l.x=function(_){return arguments.length?(c="function"==typeof _?_:n(+_),T(),l):c},l},g.forceY=function(c){var h,p,o,b=n(.1);function l(_){for(var w,k=0,L=h.length;k<L;++k)(w=h[k]).vy+=(o[k]-w.y)*p[k]*_}function T(){if(h){var _,w=h.length;for(p=new Array(w),o=new Array(w),_=0;_<w;++_)p[_]=isNaN(o[_]=+c(h[_],_,h))?0:+b(h[_],_,h)}}return"function"!=typeof c&&(c=n(null==c?0:+c)),l.initialize=function(_){h=_,T()},l.strength=function(_){return arguments.length?(b="function"==typeof _?_:n(+_),T(),l):b},l.y=function(_){return arguments.length?(c="function"==typeof _?_:n(+_),T(),l):c},l},Object.defineProperty(g,"__esModule",{value:!0})},"object"==typeof Q&&void 0!==ee?v(Q,y("d3-quadtree"),y("d3-collection"),y("d3-dispatch"),y("d3-timer")):v(g.d3=g.d3||{},g.d3,g.d3,g.d3,g.d3)},{"d3-collection":108,"d3-dispatch":110,"d3-quadtree":118,"d3-timer":123}],112:[function(y,ee,Q){var g,v;g=this,v=function(g){"use strict";function v(h,p){if((o=(h=p?h.toExponential(p-1):h.toExponential()).indexOf("e"))<0)return null;var o,b=h.slice(0,o);return[b.length>1?b[0]+b.slice(2):b,+h.slice(o+1)]}function m(h){return(h=v(Math.abs(h)))?h[1]:NaN}var x,e=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function n(h){if(!(p=e.exec(h)))throw new Error("invalid format: "+h);var p;return new t({fill:p[1],align:p[2],sign:p[3],symbol:p[4],zero:p[5],width:p[6],comma:p[7],precision:p[8]&&p[8].slice(1),trim:p[9],type:p[10]})}function t(h){this.fill=void 0===h.fill?" ":h.fill+"",this.align=void 0===h.align?">":h.align+"",this.sign=void 0===h.sign?"-":h.sign+"",this.symbol=void 0===h.symbol?"":h.symbol+"",this.zero=!!h.zero,this.width=void 0===h.width?void 0:+h.width,this.comma=!!h.comma,this.precision=void 0===h.precision?void 0:+h.precision,this.trim=!!h.trim,this.type=void 0===h.type?"":h.type+""}function a(h,p){var o=v(h,p);if(!o)return h+"";var b=o[0],l=o[1];return l<0?"0."+new Array(-l).join("0")+b:b.length>l+1?b.slice(0,l+1)+"."+b.slice(l+1):b+new Array(l-b.length+2).join("0")}n.prototype=t.prototype,t.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(void 0===this.width?"":Math.max(1,0|this.width))+(this.comma?",":"")+(void 0===this.precision?"":"."+Math.max(0,0|this.precision))+(this.trim?"~":"")+this.type};var r={"%":function(h,p){return(100*h).toFixed(p)},b:function(h){return Math.round(h).toString(2)},c:function(h){return h+""},d:function(h){return Math.abs(h=Math.round(h))>=1e21?h.toLocaleString("en").replace(/,/g,""):h.toString(10)},e:function(h,p){return h.toExponential(p)},f:function(h,p){return h.toFixed(p)},g:function(h,p){return h.toPrecision(p)},o:function(h){return Math.round(h).toString(8)},p:function(h,p){return a(100*h,p)},r:a,s:function(h,p){var o=v(h,p);if(!o)return h+"";var b=o[0],l=o[1],T=l-(x=3*Math.max(-8,Math.min(8,Math.floor(l/3))))+1,_=b.length;return T===_?b:T>_?b+new Array(T-_+1).join("0"):T>0?b.slice(0,T)+"."+b.slice(T):"0."+new Array(1-T).join("0")+v(h,Math.max(0,p+T-1))[0]},X:function(h){return Math.round(h).toString(16).toUpperCase()},x:function(h){return Math.round(h).toString(16)}};function d(h){return h}var s,i=Array.prototype.map,u=["y","z","a","f","p","n","\xb5","m","","k","M","G","T","P","E","Z","Y"];function f(h){var p,o,P,b=void 0===h.grouping||void 0===h.thousands?d:(p=i.call(h.grouping,Number),o=h.thousands+"",function(P,S){for(var E=P.length,z=[],R=0,q=p[0],V=0;E>0&&q>0&&(V+q+1>S&&(q=Math.max(1,S-V)),z.push(P.substring(E-=q,E+q)),!((V+=q+1)>S));)q=p[R=(R+1)%p.length];return z.reverse().join(o)}),l=void 0===h.currency?"":h.currency[0]+"",T=void 0===h.currency?"":h.currency[1]+"",_=void 0===h.decimal?".":h.decimal+"",w=void 0===h.numerals?d:(P=i.call(h.numerals,String),function(S){return S.replace(/[0-9]/g,function(E){return P[+E]})}),k=void 0===h.percent?"%":h.percent+"",L=void 0===h.minus?"-":h.minus+"",M=void 0===h.nan?"NaN":h.nan+"";function I(P){var S=(P=n(P)).fill,E=P.align,z=P.sign,R=P.symbol,q=P.zero,V=P.width,W=P.comma,K=P.precision,G=P.trim,Y=P.type;"n"===Y?(W=!0,Y="g"):r[Y]||(void 0===K&&(K=12),G=!0,Y="g"),(q||"0"===S&&"="===E)&&(q=!0,S="0",E="=");var $="$"===R?l:"#"===R&&/[boxX]/.test(Y)?"0"+Y.toLowerCase():"",B="$"===R?T:/[%p]/.test(Y)?k:"",N=r[Y],U=/[defgprs%]/.test(Y);function te(j){var J,X,re,ne=$,le=B;if("c"===Y)le=N(j)+le,j="";else{var oe=(j=+j)<0||1/j<0;if(j=isNaN(j)?M:N(Math.abs(j),K),G&&(j=function(ge){e:for(var _e,Te=ge.length,we=1,Oe=-1;we<Te;++we)switch(ge[we]){case".":Oe=_e=we;break;case"0":0===Oe&&(Oe=we),_e=we;break;default:if(!+ge[we])break e;Oe>0&&(Oe=0)}return Oe>0?ge.slice(0,Oe)+ge.slice(_e+1):ge}(j)),oe&&0==+j&&"+"!==z&&(oe=!1),ne=(oe?"("===z?z:L:"-"===z||"("===z?"":z)+ne,le=("s"===Y?u[8+x/3]:"")+le+(oe&&"("===z?")":""),U)for(J=-1,X=j.length;++J<X;)if(48>(re=j.charCodeAt(J))||re>57){le=(46===re?_+j.slice(J+1):j.slice(J))+le,j=j.slice(0,J);break}}W&&!q&&(j=b(j,1/0));var de=ne.length+j.length+le.length,se=de<V?new Array(V-de+1).join(S):"";switch(W&&q&&(j=b(se+j,se.length?V-le.length:1/0),se=""),E){case"<":j=ne+j+le+se;break;case"=":j=ne+se+j+le;break;case"^":j=se.slice(0,de=se.length>>1)+ne+j+le+se.slice(de);break;default:j=se+ne+j+le}return w(j)}return K=void 0===K?6:/[gprs]/.test(Y)?Math.max(1,Math.min(21,K)):Math.max(0,Math.min(20,K)),te.toString=function(){return P+""},te}return{format:I,formatPrefix:function(P,S){var E=I(((P=n(P)).type="f",P)),z=3*Math.max(-8,Math.min(8,Math.floor(m(S)/3))),R=Math.pow(10,-z),q=u[8+z/3];return function(V){return E(R*V)+q}}}}function c(h){return s=f(h),g.format=s.format,g.formatPrefix=s.formatPrefix,s}c({decimal:".",thousands:",",grouping:[3],currency:["$",""],minus:"-"}),g.FormatSpecifier=t,g.formatDefaultLocale=c,g.formatLocale=f,g.formatSpecifier=n,g.precisionFixed=function(h){return Math.max(0,-m(Math.abs(h)))},g.precisionPrefix=function(h,p){return Math.max(0,3*Math.max(-8,Math.min(8,Math.floor(m(p)/3)))-m(Math.abs(h)))},g.precisionRound=function(h,p){return h=Math.abs(h),p=Math.abs(p)-h,Math.max(0,m(p)-m(h))+1},Object.defineProperty(g,"__esModule",{value:!0})},v("object"==typeof Q&&void 0!==ee?Q:(g=typeof globalThis<"u"?globalThis:g||self).d3=g.d3||{})},{}],113:[function(y,ee,Q){var g,v;g=this,v=function(g,v,m){"use strict";var x=Math.abs,e=Math.atan,n=Math.atan2,t=Math.cos,a=Math.exp,r=Math.floor,d=Math.log,s=Math.max,i=Math.min,u=Math.pow,f=Math.round,c=Math.sign||function(Ue){return Ue>0?1:Ue<0?-1:0},h=Math.sin,p=Math.tan,o=1e-6,b=Math.PI,l=b/2,T=b/4,_=Math.SQRT1_2,w=E(2),k=E(b),L=2*b,M=180/b,I=b/180;function P(Ue){return Ue>1?l:Ue<-1?-l:Math.asin(Ue)}function S(Ue){return Ue>1?0:Ue<-1?b:Math.acos(Ue)}function E(Ue){return Ue>0?Math.sqrt(Ue):0}function z(Ue){return(a(Ue)-a(-Ue))/2}function R(Ue){return(a(Ue)+a(-Ue))/2}function q(Ue){var Ze=p(Ue/2),et=2*d(t(Ue/2))/(Ze*Ze);function lt(yt,gt){var St=t(yt),Xt=t(gt),Kt=h(gt),Zt=Xt*St,ir=-((1-Zt?d((1+Zt)/2)/(1-Zt):-.5)+et/(1+Zt));return[ir*Xt*h(yt),ir*Kt]}return lt.invert=function(yt,gt){var St,Xt=E(yt*yt+gt*gt),Kt=-Ue/2,Zt=50;if(!Xt)return[0,0];do{var ir=Kt/2,pr=t(ir),br=h(ir),_r=br/pr,Or=-d(x(pr));Kt-=St=(2/_r*Or-et*_r-Xt)/(-Or/(br*br)+1-et/(2*pr*pr))*(pr<0?.7:1)}while(x(St)>o&&--Zt>0);var tn=h(Kt);return[n(yt*tn,Xt*t(Kt)),P(gt*tn/Xt)]},lt}function V(Ue,Ze){var yt,et=t(Ze),lt=(yt=S(et*t(Ue/=2)))?yt/Math.sin(yt):1;return[2*et*h(Ue)*lt,h(Ze)*lt]}function W(Ue){var Ze=h(Ue),et=t(Ue),lt=Ue>=0?1:-1,yt=p(lt*Ue),gt=(1+Ze-et)/2;function St(Xt,Kt){var Zt=t(Kt),ir=t(Xt/=2);return[(1+Zt)*h(Xt),(lt*Kt>-n(ir,yt)-.001?0:10*-lt)+gt+h(Kt)*et-(1+Zt)*Ze*ir]}return St.invert=function(Xt,Kt){var Zt=0,ir=0,pr=50;do{var br=t(Zt),_r=h(Zt),Or=t(ir),tn=h(ir),fn=1+Or,En=fn*_r-Xt,On=gt+tn*et-fn*Ze*br-Kt,qn=fn*br/2,Dn=-_r*tn,gi=Ze*fn*_r/2,Ai=et*Or+Ze*br*tn,Ni=Dn*gi-Ai*qn,Bi=(On*Dn-En*Ai)/Ni/2,ji=(En*gi-On*qn)/Ni;x(ji)>2&&(ji/=2),Zt-=Bi,ir-=ji}while((x(Bi)>o||x(ji)>o)&&--pr>0);return lt*ir>-n(t(Zt),yt)-.001?[2*Zt,ir]:null},St}function K(Ue,Ze){var et=p(Ze/2),lt=E(1-et*et),yt=1+lt*t(Ue/=2),gt=h(Ue)*lt/yt,St=et/yt,Xt=gt*gt,Kt=St*St;return[4/3*gt*(3+Xt-3*Kt),4/3*St*(3+3*Xt-Kt)]}V.invert=function(Ue,Ze){if(!(Ue*Ue+4*Ze*Ze>b*b+o)){var et=Ue,lt=Ze,yt=25;do{var gt,St=h(et),Xt=h(et/2),Kt=t(et/2),Zt=h(lt),ir=t(lt),pr=h(2*lt),br=Zt*Zt,_r=ir*ir,Or=Xt*Xt,tn=1-_r*Kt*Kt,fn=tn?S(ir*Kt)*E(gt=1/tn):gt=0,En=2*fn*ir*Xt-Ue,On=fn*Zt-Ze,qn=gt*(_r*Or+fn*ir*Kt*br),Dn=gt*(.5*St*pr-2*fn*Zt*Xt),gi=.25*gt*(pr*Xt-fn*Zt*_r*St),Ai=gt*(br*Kt+fn*Or*ir),Ni=Dn*gi-Ai*qn;if(!Ni)break;var Bi=(On*Dn-En*Ai)/Ni,ji=(En*gi-On*qn)/Ni;et-=Bi,lt-=ji}while((x(Bi)>o||x(ji)>o)&&--yt>0);return[et,lt]}},K.invert=function(Ue,Ze){if(Ze*=3/8,!(Ue*=3/8)&&x(Ze)>1)return null;var Zt,et=1+Ue*Ue+Ze*Ze,lt=E((et-E(et*et-4*Ze*Ze))/2),yt=P(lt)/3,gt=lt?(Zt=x(Ze/lt),d(Zt+E(Zt*Zt-1))/3):function(Zt){return d(Zt+E(Zt*Zt+1))}(x(Ue))/3,St=t(yt),Xt=R(gt),Kt=Xt*Xt-St*St;return[2*c(Ue)*n(z(gt)*St,.25-Kt),2*c(Ze)*n(Xt*h(yt),.25+Kt)]};var G=E(8),Y=d(1+w);function $(Ue,Ze){var et=x(Ze);return et<T?[Ue,d(p(T+Ze/2))]:[Ue*t(et)*(2*w-1/h(et)),c(Ze)*(2*w*(et-T)-d(p(et/2)))]}function B(Ue){var Ze=2*b/Ue;function et(lt,yt){var gt=v.geoAzimuthalEquidistantRaw(lt,yt);if(x(lt)>l){var St=n(gt[1],gt[0]),Xt=E(gt[0]*gt[0]+gt[1]*gt[1]),Kt=Ze*f((St-l)/Ze)+l,Zt=n(h(St-=Kt),2-t(St));St=Kt+P(b/Xt*h(Zt))-Zt,gt[0]=Xt*t(St),gt[1]=Xt*h(St)}return gt}return et.invert=function(lt,yt){var gt=E(lt*lt+yt*yt);if(gt>l){var St=n(yt,lt),Xt=Ze*f((St-l)/Ze)+l,Kt=St>Xt?-1:1,Zt=gt*t(Xt-St),ir=1/p(Kt*S((Zt-b)/E(b*(b-2*Zt)+gt*gt)));St=Xt+2*e((ir+Kt*E(ir*ir-3))/3),lt=gt*t(St),yt=gt*h(St)}return v.geoAzimuthalEquidistantRaw.invert(lt,yt)},et}function N(Ue,Ze){if(arguments.length<2&&(Ze=Ue),1===Ze)return v.geoAzimuthalEqualAreaRaw;if(Ze===1/0)return U;function et(lt,yt){var gt=v.geoAzimuthalEqualAreaRaw(lt/Ze,yt);return gt[0]*=Ue,gt}return et.invert=function(lt,yt){var gt=v.geoAzimuthalEqualAreaRaw.invert(lt/Ue,yt);return gt[0]*=Ze,gt},et}function U(Ue,Ze){return[Ue*t(Ze)/t(Ze/=2),2*h(Ze)]}function te(Ue,Ze,et){var lt,yt,gt,St=100;et=void 0===et?0:+et,Ze=+Ze;do{(yt=Ue(et))===(gt=Ue(et+o))&&(gt=yt+o),et-=lt=-1*o*(yt-Ze)/(yt-gt)}while(St-- >0&&x(lt)>o);return St<0?NaN:et}function j(Ue,Ze,et){return void 0===Ze&&(Ze=40),void 0===et&&(et=1e-12),function(lt,yt,gt,St){var Xt,Kt,Zt;gt=void 0===gt?0:+gt,St=void 0===St?0:+St;for(var ir=0;ir<Ze;ir++){var pr=Ue(gt,St),br=pr[0]-lt,_r=pr[1]-yt;if(x(br)<et&&x(_r)<et)break;var Or=br*br+_r*_r;if(Or>Xt)gt-=Kt/=2,St-=Zt/=2;else{Xt=Or;var tn=(gt>0?-1:1)*et,fn=(St>0?-1:1)*et,En=Ue(gt+tn,St),On=Ue(gt,St+fn),qn=(En[0]-pr[0])/tn,Dn=(En[1]-pr[1])/tn,gi=(On[0]-pr[0])/fn,Ai=(On[1]-pr[1])/fn,Ni=Ai*qn-Dn*gi,Bi=(x(Ni)<.5?.5:1)/Ni;if(gt+=Kt=(_r*gi-br*Ai)*Bi,St+=Zt=(br*Dn-_r*qn)*Bi,x(Kt)<et&&x(Zt)<et)break}}return[gt,St]}}function J(){var Ue=N(1.68,2);function Ze(et,lt){if(et+lt<-1.4){var yt=(et-lt+1.6)*(et+lt+1.4)/8;et+=yt,lt-=.8*yt*h(lt+b/2)}var gt=Ue(et,lt),St=(1-t(et*lt))/12;return gt[1]<0&&(gt[0]*=1+St),gt[1]>0&&(gt[1]*=1+St/1.5*gt[0]*gt[0]),gt}return Ze.invert=j(Ze),Ze}function X(Ue,Ze){var et,lt=Ue*h(Ze),yt=30;do{Ze-=et=(Ze+h(Ze)-lt)/(1+t(Ze))}while(x(et)>o&&--yt>0);return Ze/2}function re(Ue,Ze,et){function lt(yt,gt){return[Ue*yt*t(gt=X(et,gt)),Ze*h(gt)]}return lt.invert=function(yt,gt){return gt=P(gt/Ze),[yt/(Ue*t(gt)),P((2*gt+h(2*gt))/et)]},lt}$.invert=function(Ue,Ze){if((lt=x(Ze))<Y)return[Ue,2*e(a(Ze))-l];var et,lt,yt=T,gt=25;do{var St=t(yt/2),Xt=p(yt/2);yt-=et=(G*(yt-T)-d(Xt)-lt)/(G-St*St/(2*Xt))}while(x(et)>1e-12&&--gt>0);return[Ue/(t(yt)*(G-1/h(yt))),c(Ze)*yt]},U.invert=function(Ue,Ze){var et=2*P(Ze/2);return[Ue*t(et/2)/t(et),et]};var ne=re(w/l,w,b),le=2.00276;function de(Ue,Ze){var et=X(b,Ze);return[le*Ue/(1/t(Ze)+1.11072/t(et)),(Ze+w*h(et))/le]}function se(Ue){var Ze=0,et=v.geoProjectionMutator(Ue),lt=et(Ze);return lt.parallel=function(yt){return arguments.length?et(Ze=yt*I):Ze*M},lt}function ge(Ue,Ze){return[Ue*t(Ze),Ze]}function _e(Ue){if(!Ue)return ge;var Ze=1/p(Ue);function et(lt,yt){var gt=Ze+Ue-yt,St=gt&&lt*t(yt)/gt;return[gt*h(St),Ze-gt*t(St)]}return et.invert=function(lt,yt){var gt=E(lt*lt+(yt=Ze-yt)*yt),St=Ze+Ue-gt;return[gt/t(St)*n(lt,yt),St]},et}function Te(Ue){function Ze(et,lt){var yt=l-lt,gt=yt&&et*Ue*h(yt)/yt;return[yt*h(gt)/Ue,l-yt*t(gt)]}return Ze.invert=function(et,lt){var yt=et*Ue,gt=l-lt,St=E(yt*yt+gt*gt),Xt=n(yt,gt);return[(St?St/h(St):1)*Xt/Ue,l-St]},Ze}de.invert=function(Ue,Ze){var et,lt,yt=le*Ze,gt=Ze<0?-T:T,St=25;do{lt=yt-w*h(gt),gt-=et=(h(2*gt)+2*gt-b*h(lt))/(2*t(2*gt)+2+b*t(lt)*w*t(gt))}while(x(et)>o&&--St>0);return lt=yt-w*h(gt),[Ue*(1/t(lt)+1.11072/t(gt))/le,lt]},ge.invert=function(Ue,Ze){return[Ue/t(Ze),Ze]};var we=re(1,4/b,b);function Oe(Ue,Ze,et,lt,yt,gt){var St,Xt=t(gt);if(x(Ue)>1||x(gt)>1)St=S(et*yt+Ze*lt*Xt);else{var Kt=h(Ue/2),Zt=h(gt/2);St=2*P(E(Kt*Kt+Ze*lt*Zt*Zt))}return x(St)>o?[St,n(lt*h(gt),Ze*yt-et*lt*Xt)]:[0,0]}function fe(Ue,Ze,et){return S((Ue*Ue+Ze*Ze-et*et)/(2*Ue*Ze))}function ve(Ue){return Ue-2*b*r((Ue+b)/(2*b))}function Ae(Ue,Ze,et){for(var lt,yt=[[Ue[0],Ue[1],h(Ue[1]),t(Ue[1])],[Ze[0],Ze[1],h(Ze[1]),t(Ze[1])],[et[0],et[1],h(et[1]),t(et[1])]],gt=yt[2],St=0;St<3;++St,gt=lt)gt.v=Oe((lt=yt[St])[1]-gt[1],gt[3],gt[2],lt[3],lt[2],lt[0]-gt[0]),gt.point=[0,0];var Xt=fe(yt[0].v[0],yt[2].v[0],yt[1].v[0]),Kt=fe(yt[0].v[0],yt[1].v[0],yt[2].v[0]),Zt=b-Xt;yt[2].point[1]=0,yt[0].point[0]=-(yt[1].point[0]=yt[0].v[0]/2);var ir=[yt[2].point[0]=yt[0].point[0]+yt[2].v[0]*t(Xt),2*(yt[0].point[1]=yt[1].point[1]=yt[2].v[0]*h(Xt))];return function(pr,br){var _r,Or=h(br),tn=t(br),fn=new Array(3);for(_r=0;_r<3;++_r){var En=yt[_r];if(fn[_r]=Oe(br-En[1],En[3],En[2],tn,Or,pr-En[0]),!fn[_r][0])return En.point;fn[_r][1]=ve(fn[_r][1]-En.v[1])}var On=ir.slice();for(_r=0;_r<3;++_r){var Dn=fe(yt[_r].v[0],fn[_r][0],fn[2==_r?0:_r+1][0]);fn[_r][1]<0&&(Dn=-Dn),_r?1==_r?(On[0]-=fn[_r][0]*t(Dn=Kt-Dn),On[1]-=fn[_r][0]*h(Dn)):(On[0]+=fn[_r][0]*t(Dn=Zt-Dn),On[1]+=fn[_r][0]*h(Dn)):(On[0]+=fn[_r][0]*t(Dn),On[1]-=fn[_r][0]*h(Dn))}return On[0]/=3,On[1]/=3,On}}function ke(Ue){return Ue[0]*=I,Ue[1]*=I,Ue}function Pe(Ue,Ze,et){var lt=v.geoCentroid({type:"MultiPoint",coordinates:[Ue,Ze,et]}),yt=[-lt[0],-lt[1]],gt=v.geoRotation(yt),St=Ae(ke(gt(Ue)),ke(gt(Ze)),ke(gt(et)));St.invert=j(St);var Xt=v.geoProjection(St).rotate(yt),Kt=Xt.center;return delete Xt.rotate,Xt.center=function(Zt){return arguments.length?Kt(gt(Zt)):gt.invert(Kt())},Xt.clipAngle(90)}function Ne(Ue,Ze){var et=E(1-h(Ze));return[2/k*Ue*et,k*(1-et)]}function De(Ue){var Ze=p(Ue);function et(lt,yt){return[lt,(lt?lt/h(lt):1)*(h(yt)*t(lt)-Ze*t(yt))]}return et.invert=Ze?function(lt,yt){lt&&(yt*=h(lt)/lt);var gt=t(lt);return[lt,2*n(E(gt*gt+Ze*Ze-yt*yt)-gt,Ze-yt)]}:function(lt,yt){return[lt,P(lt?yt*p(lt)/lt:yt)]},et}Ne.invert=function(Ue,Ze){var et=(et=Ze/k-1)*et;return[et>0?Ue*E(b/et)/2:0,P(1-et)]};var ze=E(3);function Me(Ue,Ze){return[ze*Ue*(2*t(2*Ze/3)-1)/k,ze*k*h(Ze/3)]}function Se(Ue){var Ze=t(Ue);function et(lt,yt){return[lt*Ze,h(yt)/Ze]}return et.invert=function(lt,yt){return[lt/Ze,P(yt*Ze)]},et}function Ie(Ue){var Ze=t(Ue);function et(lt,yt){return[lt*Ze,(1+Ze)*p(yt/2)]}return et.invert=function(lt,yt){return[lt/Ze,2*e(yt/(1+Ze))]},et}function Fe(Ue,Ze){var et=E(8/(3*b));return[et*Ue*(1-x(Ze)/b),et*Ze]}function Re(Ue,Ze){var et=E(4-3*h(x(Ze)));return[2/E(6*b)*Ue*et,c(Ze)*E(2*b/3)*(2-et)]}function Xe(Ue,Ze){var et=E(b*(4+b));return[2/et*Ue*(1+E(1-4*Ze*Ze/(b*b))),4/et*Ze]}function nt(Ue,Ze){var et=(2+l)*h(Ze);Ze/=2;for(var lt=0,yt=1/0;lt<10&&x(yt)>o;lt++){var gt=t(Ze);Ze-=yt=(Ze+h(Ze)*(gt+2)-et)/(2*gt*(1+gt))}return[2/E(b*(4+b))*Ue*(1+t(Ze)),2*E(b/(4+b))*h(Ze)]}function ct(Ue,Ze){return[Ue*(1+t(Ze))/E(2+b),2*Ze/E(2+b)]}function xt(Ue,Ze){for(var et=(1+l)*h(Ze),lt=0,yt=1/0;lt<10&&x(yt)>o;lt++)Ze-=yt=(Ze+h(Ze)-et)/(1+t(Ze));return et=E(2+b),[Ue*(1+t(Ze))/et,2*Ze/et]}Me.invert=function(Ue,Ze){var et=3*P(Ze/(ze*k));return[k*Ue/(ze*(2*t(2*et/3)-1)),et]},Fe.invert=function(Ue,Ze){var et=E(8/(3*b)),lt=Ze/et;return[Ue/(et*(1-x(lt)/b)),lt]},Re.invert=function(Ue,Ze){var et=2-x(Ze)/E(2*b/3);return[Ue*E(6*b)/(2*et),c(Ze)*P((4-et*et)/3)]},Xe.invert=function(Ue,Ze){var et=E(b*(4+b))/2;return[Ue*et/(1+E(1-Ze*Ze*(4+b)/(4*b))),Ze*et/2]},nt.invert=function(Ue,Ze){var et=Ze*E((4+b)/b)/2,lt=P(et),yt=t(lt);return[Ue/(2/E(b*(4+b))*(1+yt)),P((lt+et*(yt+2))/(2+l))]},ct.invert=function(Ue,Ze){var et=E(2+b),lt=Ze*et/2;return[et*Ue/(1+t(lt)),lt]},xt.invert=function(Ue,Ze){var et=1+l,lt=E(et/2);return[2*Ue*lt/(1+t(Ze*=lt)),P((Ze+h(Ze))/et)]};var dt=3+2*w;function tt(Ue,Ze){var et=h(Ue/=2),lt=t(Ue),yt=E(t(Ze)),gt=t(Ze/=2),St=h(Ze)/(gt+w*lt*yt),Xt=E(2/(1+St*St)),Kt=E((w*gt+(lt+et)*yt)/(w*gt+(lt-et)*yt));return[dt*(Xt*(Kt-1/Kt)-2*d(Kt)),dt*(Xt*St*(Kt+1/Kt)-2*e(St))]}tt.invert=function(Ue,Ze){if(!(et=K.invert(Ue/1.2,1.065*Ze)))return null;var et,lt=et[0],yt=et[1],gt=20;Ue/=dt,Ze/=dt;do{var St=lt/2,Xt=yt/2,Kt=h(St),Zt=t(St),ir=h(Xt),pr=t(Xt),br=t(yt),_r=E(br),Or=ir/(pr+w*Zt*_r),tn=Or*Or,fn=E(2/(1+tn)),En=(w*pr+(Zt+Kt)*_r)/(w*pr+(Zt-Kt)*_r),On=E(En),qn=On-1/On,Dn=On+1/On,gi=fn*qn-2*d(On)-Ue,Ai=fn*Or*Dn-2*e(Or)-Ze,Ni=ir&&_*_r*Kt*tn/ir,Bi=(w*Zt*pr+_r)/(2*(pr+w*Zt*_r)*(pr+w*Zt*_r)*_r),ji=-.5*Or*fn*fn*fn,_a=ji*Ni,ya=ji*Bi,aa=(aa=2*pr+w*_r*(Zt-Kt))*aa*On,oa=(w*Zt*pr*_r+br)/aa,xa=-w*Kt*ir/(_r*aa),Fa=qn*_a-2*oa/On+fn*(oa+oa/En),Xa=qn*ya-2*xa/On+fn*(xa+xa/En),Ja=Or*Dn*_a-2*Ni/(1+tn)+fn*Dn*Ni+fn*Or*(oa-oa/En),Ka=Or*Dn*ya-2*Bi/(1+tn)+fn*Dn*Bi+fn*Or*(xa-xa/En),Qa=Xa*Ja-Ka*Fa;if(!Qa)break;var Oi=(Ai*Xa-gi*Ka)/Qa,pt=(gi*Ja-Ai*Fa)/Qa;lt-=Oi,yt=s(-l,i(l,yt-pt))}while((x(Oi)>o||x(pt)>o)&&--gt>0);return x(x(yt)-l)<o?[0,yt]:gt&&[lt,yt]};var Ke=t(35*I);function mt(Ue,Ze){var et=p(Ze/2);return[Ue*Ke*E(1-et*et),(1+Ke)*et]}function Bt(Ue,Ze){var et=Ze/2,lt=t(et);return[2*Ue/k*t(Ze)*lt*lt,k*p(et)]}function Ut(Ue){var Ze=1-Ue,et=yt(b,0)[0]-yt(-b,0)[0],lt=E(2*(yt(0,l)[1]-yt(0,-l)[1])/et);function yt(Xt,Kt){var Zt=t(Kt),ir=h(Kt);return[Zt/(Ze+Ue*Zt)*Xt,Ze*Kt+Ue*ir]}function gt(Xt,Kt){var Zt=yt(Xt,Kt);return[Zt[0]*lt,Zt[1]/lt]}function St(Xt){return gt(0,Xt)[1]}return gt.invert=function(Xt,Kt){var Zt=te(St,Kt);return[Xt/lt*(Ue+Ze/t(Zt)),Zt]},gt}function er(Ue){return[Ue[0]/2,P(p(Ue[1]/2*I))*M]}function Wt(Ue){return[2*Ue[0],2*e(h(Ue[1]*I))*M]}function rr(Ue,Ze){var et=2*b/Ze,lt=Ue*Ue;function yt(gt,St){var Xt=v.geoAzimuthalEquidistantRaw(gt,St),Kt=Xt[0],Zt=Xt[1],ir=Kt*Kt+Zt*Zt;if(ir>lt){var pr=E(ir),br=n(Zt,Kt),_r=et*f(br/et),Or=br-_r,tn=Ue*t(Or),fn=(Ue*h(Or)-Or*h(tn))/(l-tn),En=Ht(Or,fn),On=(b-Ue)/Ve(En,tn,b);Kt=pr;var qn,Dn=50;do{Kt-=qn=(Ue+Ve(En,tn,Kt)*On-pr)/(En(Kt)*On)}while(x(qn)>o&&--Dn>0);Zt=Or*h(Kt),Kt<l&&(Zt-=fn*(Kt-l));var gi=h(_r),Ai=t(_r);Xt[0]=Kt*Ai-Zt*gi,Xt[1]=Kt*gi+Zt*Ai}return Xt}return yt.invert=function(gt,St){var Xt=gt*gt+St*St;if(Xt>lt){var Kt=E(Xt),Zt=n(St,gt),ir=et*f(Zt/et),pr=Zt-ir;gt=Kt*t(pr),St=Kt*h(pr);for(var br=gt-l,_r=h(gt),Or=St/_r,tn=gt<l?1/0:0,fn=10;;){var En=Ue*h(Or),On=Ue*t(Or),qn=h(On),Dn=l-On,gi=(En-Or*qn)/Dn,Ai=Ht(Or,gi);if(x(tn)<1e-12||!--fn)break;Or-=tn=(Or*_r-gi*br-St)/(_r-2*br*(Dn*(On+Or*En*t(On)-qn)-En*(En-Or*qn))/(Dn*Dn))}gt=(Kt=Ue+Ve(Ai,On,gt)*(b-Ue)/Ve(Ai,On,b))*t(Zt=ir+Or),St=Kt*h(Zt)}return v.geoAzimuthalEquidistantRaw.invert(gt,St)},yt}function Ht(Ue,Ze){return function(et){var lt=Ue*t(et);return et<l&&(lt-=Ze),E(1+lt*lt)}}function Ve(Ue,Ze,et){for(var lt=(et-Ze)/50,yt=Ue(Ze)+Ue(et),gt=1,St=Ze;gt<50;++gt)yt+=2*Ue(St+=lt);return.5*yt*lt}function We(Ue,Ze,et,lt,yt,gt,St,Xt){function Kt(Zt,ir){if(!ir)return[Ue*Zt/b,0];var pr=ir*ir,br=Ue+pr*(Ze+pr*(et+pr*lt)),_r=ir*(yt-1+pr*(gt-Xt+pr*St)),Or=(br*br+_r*_r)/(2*_r),tn=Zt*P(br/Or)/b;return[Or*h(tn),ir*(1+pr*Xt)+Or*(1-t(tn))]}return arguments.length<8&&(Xt=0),Kt.invert=function(Zt,ir){var pr,br,_r=b*Zt/Ue,Or=ir,tn=50;do{var fn=Or*Or,En=Ue+fn*(Ze+fn*(et+fn*lt)),On=Or*(yt-1+fn*(gt-Xt+fn*St)),qn=En*En+On*On,Dn=2*On,gi=qn/Dn,Ai=gi*gi,Ni=P(En/gi)/b,Bi=_r*Ni,ji=En*En,_a=(2*Ze+fn*(4*et+6*fn*lt))*Or,ya=yt+fn*(3*gt+5*fn*St),aa=(2*(En*_a+On*(ya-1))*Dn-qn*(2*(ya-1)))/(Dn*Dn),oa=t(Bi),xa=h(Bi),Fa=gi*oa,Xa=gi*xa,Ja=_r/b*(1/E(1-ji/Ai))*(_a*gi-En*aa)/Ai,Ka=Xa-Zt,Qa=Or*(1+fn*Xt)+gi-Fa-ir,Oi=aa*xa+Fa*Ja,pt=Fa*Ni,Ot=1+aa-(aa*oa-Xa*Ja),sr=Xa*Ni,Vt=Oi*sr-Ot*pt;if(!Vt)break;_r-=pr=(Qa*Oi-Ka*Ot)/Vt,Or-=br=(Ka*sr-Qa*pt)/Vt}while((x(pr)>o||x(br)>o)&&--tn>0);return[_r,Or]},Kt}mt.invert=function(Ue,Ze){var et=Ze/(1+Ke);return[Ue&&Ue/(Ke*E(1-et*et)),2*e(et)]},Bt.invert=function(Ue,Ze){var et=e(Ze/k),lt=t(et),yt=2*et;return[Ue*k/2/(t(yt)*lt*lt),yt]};var he=We(2.8284,-1.6988,.75432,-.18071,1.76003,-.38914,.042555),ye=We(2.583819,-.835827,.170354,-.038094,1.543313,-.411435,.082742),Be=We(5/6*b,-.62636,-.0344,0,1.3493,-.05524,0,.045);function Ge(Ue,Ze){var et=Ue*Ue,lt=Ze*Ze;return[Ue*(1-.162388*lt)*(.87-952426e-9*et*et),Ze*(1+lt/12)]}Ge.invert=function(Ue,Ze){var et,lt=Ue,yt=Ze,gt=50;do{var St=yt*yt;yt-=et=(yt*(1+St/12)-Ze)/(1+St/4)}while(x(et)>o&&--gt>0);gt=50,Ue/=1-.162388*St;do{var Xt=(Xt=lt*lt)*Xt;lt-=et=(lt*(.87-952426e-9*Xt)-Ue)/(.87-.00476213*Xt)}while(x(et)>o&&--gt>0);return[lt,yt]};var Je=We(2.6516,-.76534,.19123,-.047094,1.36289,-.13965,.031762);function He(Ue){var Ze=Ue(l,0)[0]-Ue(-l,0)[0];function et(lt,yt){var gt=lt>0?-.5:.5,St=Ue(lt+gt*b,yt);return St[0]-=gt*Ze,St}return Ue.invert&&(et.invert=function(lt,yt){var gt=lt>0?-.5:.5,St=Ue.invert(lt+gt*Ze,yt),Xt=St[0]-gt*b;return Xt<-b?Xt+=2*b:Xt>b&&(Xt-=2*b),St[0]=Xt,St}),et}function st(Ue,Ze){var et=c(Ue),lt=c(Ze),yt=t(Ze),gt=t(Ue)*yt,St=h(Ue)*yt,Xt=h(lt*Ze);Ue=x(n(St,Xt)),Ze=P(gt),x(Ue-l)>o&&(Ue%=l);var Kt=function(Zt,ir){if(ir===l)return[0,0];var pr,br,_r=h(ir),Or=_r*_r,tn=Or*Or,fn=1+tn,En=1+3*tn,On=1-tn,qn=P(1/E(fn)),Dn=On+Or*fn*qn,gi=(1-_r)/Dn,Ai=E(gi),Ni=gi*fn,Bi=E(Ni),ji=Ai*On;if(0===Zt)return[0,-(ji+Or*Bi)];var _a,ya=t(ir),aa=1/ya,oa=2*_r*ya,xa=(-Dn*ya-(-3*Or+qn*En)*oa*(1-_r))/(Dn*Dn),Fa=-aa*oa,Xa=-aa*(Or*fn*xa+gi*En*oa),Ja=-2*aa*(On*(.5*xa/Ai)-2*Or*Ai*oa),Ka=4*Zt/b;if(Zt>.222*b||ir<b/4&&Zt>.175*b){if(pr=(ji+Or*E(Ni*(1+tn)-ji*ji))/(1+tn),Zt>b/4)return[pr,pr];var Qa=pr,Oi=.5*pr;pr=.5*(Oi+Qa),br=50;do{var Ot=pr*(Ja+Fa*E(Ni-pr*pr))+Xa*P(pr/Bi)-Ka;if(!Ot)break;Ot<0?Oi=pr:Qa=pr,pr=.5*(Oi+Qa)}while(x(Qa-Oi)>o&&--br>0)}else{pr=o,br=25;do{var sr=pr*pr,Vt=E(Ni-sr),lr=Ja+Fa*Vt,Pr=pr*lr+Xa*P(pr/Bi)-Ka;pr-=_a=Vt?Pr/(lr+(Xa-Fa*sr)/Vt):0}while(x(_a)>o&&--br>0)}return[pr,-ji-Or*E(Ni-pr*pr)]}(Ue>b/4?l-Ue:Ue,Ze);return Ue>b/4&&(Xt=Kt[0],Kt[0]=-Kt[1],Kt[1]=-Xt),Kt[0]*=et,Kt[1]*=-lt,Kt}function ot(Ue,Ze){var et,lt,yt,gt,St,Xt;if(Ze<o)return[(gt=h(Ue))-(et=Ze*(Ue-gt*(lt=t(Ue)))/4)*lt,lt+et*gt,1-Ze*gt*gt/2,Ue-et];if(Ze>=1-o)return et=(1-Ze)/4,yt=1/(lt=R(Ue)),[(gt=((Xt=a(2*(Xt=Ue)))-1)/(Xt+1))+et*((St=lt*z(Ue))-Ue)/(lt*lt),yt-et*gt*yt*(St-Ue),yt+et*gt*yt*(St+Ue),2*e(a(Ue))-l+et*(St-Ue)/lt];var Kt=[1,0,0,0,0,0,0,0,0],Zt=[E(Ze),0,0,0,0,0,0,0,0],ir=0;for(lt=E(1-Ze),St=1;x(Zt[ir]/Kt[ir])>o&&ir<8;)et=Kt[ir++],Zt[ir]=(et-lt)/2,Kt[ir]=(et+lt)/2,lt=E(et*lt),St*=2;yt=St*Kt[ir]*Ue;do{yt=(P(gt=Zt[ir]*h(lt=yt)/Kt[ir])+yt)/2}while(--ir);return[h(yt),gt=t(yt),gt/t(yt-lt),yt]}function wt(Ue,Ze){if(!Ze)return Ue;if(1===Ze)return d(p(Ue/2+T));for(var et=1,lt=E(1-Ze),yt=E(Ze),gt=0;x(yt)>o;gt++){if(Ue%b){var St=e(lt*p(Ue)/et);St<0&&(St+=b),Ue+=St+~~(Ue/b)*b}else Ue+=Ue;yt=(et+lt)/2,lt=E(et*lt),yt=((et=yt)-lt)/2}return Ue/(u(2,gt)*et)}function Ct(Ue,Ze){var Zt,ir,pr,br,_r,et=(w-1)/(w+1),lt=E(1-et*et),yt=wt(l,lt*lt),gt=d(p(b/4+x(Ze)/2)),St=a(-1*gt)/E(et),Xt=(Zt=St*t(-1*Ue),br=(ir=St*h(-1*Ue))+1,[.5*((Zt>=0?l:-l)-n(_r=1-(pr=Zt*Zt)-ir*ir,2*Zt)),-.25*d(_r*_r+4*pr)+.5*d(br*br+pr)]),Kt=function(Zt,ir,pr){var br=x(Zt),_r=z(x(ir));if(br){var Or=1/h(br),tn=1/(p(br)*p(br)),fn=-(tn+pr*(_r*_r*Or*Or)-1+pr),En=(-fn+E(fn*fn-(pr-1)*tn*4))/2;return[wt(e(1/E(En)),pr)*c(Zt),wt(e(E((En/tn-1)/pr)),1-pr)*c(ir)]}return[0,wt(e(_r),1-pr)*c(ir)]}(Xt[0],Xt[1],lt*lt);return[-Kt[1],(Ze>=0?1:-1)*(.5*yt-Kt[0])]}function rt(Ue){var Ze=h(Ue),et=t(Ue),lt=ft(Ue);function yt(gt,St){var Xt=lt(gt,St);gt=Xt[0];var Kt=h(St=Xt[1]),Zt=t(St),ir=t(gt),pr=S(Ze*Kt+et*Zt*ir),br=h(pr),_r=x(br)>o?pr/br:1;return[_r*et*h(gt),(x(gt)>l?_r:-_r)*(Ze*Zt-et*Kt*ir)]}return lt.invert=ft(-Ue),yt.invert=function(gt,St){var Xt=E(gt*gt+St*St),Kt=-h(Xt),Zt=t(Xt),ir=Xt*Zt,pr=-St*Kt,br=Xt*Ze,_r=E(ir*ir+pr*pr-br*br),Or=n(ir*br+pr*_r,pr*br-ir*_r),tn=(Xt>l?-1:1)*n(gt*Kt,Xt*t(Or)*Zt+St*h(Or)*Kt);return lt.invert(tn,Or)},yt}function ft(Ue){var Ze=h(Ue),et=t(Ue);return function(lt,yt){var gt=t(yt),St=t(lt)*gt,Xt=h(lt)*gt,Kt=h(yt);return[n(Xt,St*et-Kt*Ze),P(Kt*et+St*Ze)]}}st.invert=function(Ue,Ze){x(Ue)>1&&(Ue=2*c(Ue)-Ue),x(Ze)>1&&(Ze=2*c(Ze)-Ze);var et=c(Ue),lt=c(Ze),yt=-et*Ue,gt=-lt*Ze,St=gt/yt<1,Xt=function(pr,br){for(var _r=0,Or=1,tn=.5,fn=50;;){var En=tn*tn,On=E(tn),qn=P(1/E(1+En)),Dn=1-En+tn*(1+En)*qn,gi=(1-On)/Dn,Ai=E(gi),Ni=gi*(1+En),Bi=Ai*(1-En),ji=E(Ni-pr*pr),_a=br+Bi+tn*ji;if(x(Or-_r)<1e-12||0==--fn||0===_a)break;_a>0?_r=tn:Or=tn,tn=.5*(_r+Or)}if(!fn)return null;var ya=P(On),aa=t(ya),oa=1/aa,xa=2*On*aa,Fa=(-Dn*aa-(-3*tn+qn*(1+3*En))*xa*(1-On))/(Dn*Dn);return[b/4*(pr*(-2*oa*(.5*Fa/Ai*(1-En)-2*tn*Ai*xa)+-oa*xa*ji)+-oa*(tn*(1+En)*Fa+gi*(1+3*En)*xa)*P(pr/E(Ni))),ya]}(St?gt:yt,St?yt:gt),Kt=Xt[0],Zt=Xt[1],ir=t(Zt);return St&&(Kt=-l-Kt),[et*(n(h(Kt)*ir,-h(Zt))+b),lt*P(t(Kt)*ir)]},Ct.invert=function(Ue,Ze){var et,lt,yt,gt,St,Xt,_r,Or,tn,Kt=(w-1)/(w+1),Zt=E(1-Kt*Kt),pr=(lt=-Ue,yt=Zt*Zt,(et=.5*wt(l,Zt*Zt)-Ze)?(gt=ot(et,yt),lt?(Xt=(St=ot(lt,1-yt))[1]*St[1]+yt*gt[0]*gt[0]*St[0]*St[0],[[gt[0]*St[2]/Xt,gt[1]*gt[2]*St[0]*St[1]/Xt],[gt[1]*St[1]/Xt,-gt[0]*gt[2]*St[0]*St[2]/Xt],[gt[2]*St[1]*St[2]/Xt,-yt*gt[0]*gt[1]*St[0]/Xt]]):[[gt[0],0],[gt[1],0],[gt[2],0]]):[[0,(St=ot(lt,1-yt))[0]/St[1]],[1/St[1],0],[St[2]/St[1],0]]),br=[((_r=pr[0])[0]*(Or=pr[1])[0]+_r[1]*Or[1])/(tn=Or[0]*Or[0]+Or[1]*Or[1]),(_r[1]*Or[0]-_r[0]*Or[1])/tn];return[n(br[1],br[0])/-1,2*e(a(-.5*d(Kt*br[0]*br[0]+Kt*br[1]*br[1])))-l]};var Rt=P(1-1/3)*M,kt=Se(0);function Lt(Ue){var Ze=Rt*I,et=Ne(b,Ze)[0]-Ne(-b,Ze)[0],lt=kt(0,Ze)[1],yt=Ne(0,Ze)[1],gt=k-yt,St=L/Ue,Xt=4/L,Kt=lt+gt*gt*4/L;function Zt(ir,pr){var br,_r=x(pr);if(_r>Ze){var Or=i(Ue-1,s(0,r((ir+b)/St)));(br=Ne(ir+=b*(Ue-1)/Ue-Or*St,_r))[0]=br[0]*L/et-L*(Ue-1)/(2*Ue)+Or*L/Ue,br[1]=lt+4*(br[1]-yt)*gt/L,pr<0&&(br[1]=-br[1])}else br=kt(ir,pr);return br[0]*=Xt,br[1]/=Kt,br}return Zt.invert=function(ir,pr){ir/=Xt;var br=x(pr*=Kt);if(br>lt){var _r=i(Ue-1,s(0,r((ir+b)/St))),Or=Ne.invert(ir=(ir+b*(Ue-1)/Ue-_r*St)*et/L,.25*(br-lt)*L/gt+yt);return Or[0]-=b*(Ue-1)/Ue-_r*St,pr<0&&(Or[1]=-Or[1]),Or}return kt.invert(ir,pr)},Zt}function Ee(Ue,Ze){return[Ue,1&Ze?90-o:Rt]}function Ye(Ue,Ze){return[Ue,1&Ze?-90+o:-Rt]}function it(Ue){return[Ue[0]*(1-o),Ue[1]]}function ht(Ue){var Ze,et=1+Ue,lt=P(h(1/et)),yt=2*E(b/(Ze=b+4*lt*et)),gt=.5*yt*(et+E(Ue*(2+Ue))),St=Ue*Ue,Xt=et*et;function Kt(Zt,ir){var pr,br,_r=1-h(ir);if(_r&&_r<2){var Or,tn=l-ir,fn=25;do{var En=h(tn),On=t(tn),qn=lt+n(En,et-On),Dn=1+Xt-2*et*On;tn-=Or=(tn-St*lt-et*En+Dn*qn-.5*_r*Ze)/(2*et*En*qn)}while(x(Or)>1e-12&&--fn>0);pr=yt*E(Dn),br=Zt*qn/b}else pr=yt*(Ue+_r),br=Zt*lt/b;return[pr*h(br),gt-pr*t(br)]}return Kt.invert=function(Zt,ir){var pr=Zt*Zt+(ir-=gt)*ir,br=(1+Xt-pr/(yt*yt))/(2*et),_r=S(br),Or=h(_r),tn=lt+n(Or,et-br);return[P(Zt/E(pr))*b/tn,P(1-2*(_r-St*lt-et*Or+(1+Xt-2*et*br)*tn)/Ze)]},Kt}function At(Ue,Ze){return Ze>-.7109889596207567?((Ue=ne(Ue,Ze))[1]+=.0528035274542,Ue):ge(Ue,Ze)}function Ft(Ue,Ze){return x(Ze)>.7109889596207567?((Ue=ne(Ue,Ze))[1]-=Ze>0?.0528035274542:-.0528035274542,Ue):ge(Ue,Ze)}function Gt(Ue,Ze,et,lt){var yt=E(4*b/(2*et+(1+Ue-Ze/2)*h(2*et)+(Ue+Ze)/2*h(4*et)+Ze/2*h(6*et))),gt=E(lt*h(et)*E((1+Ue*t(2*et)+Ze*t(4*et))/(1+Ue+Ze))),St=et*Kt(1);function Xt(pr){return E(1+Ue*t(2*pr)+Ze*t(4*pr))}function Kt(pr){var br=pr*et;return(2*br+(1+Ue-Ze/2)*h(2*br)+(Ue+Ze)/2*h(4*br)+Ze/2*h(6*br))/et}function Zt(pr){return Xt(pr)*h(pr)}var ir=function(pr,br){var _r=et*te(Kt,St*h(br)/et,br/b);isNaN(_r)&&(_r=et*c(br));var Or=yt*Xt(_r);return[Or*gt*pr/b*t(_r),Or/gt*h(_r)]};return ir.invert=function(pr,br){var _r=te(Zt,br*gt/yt);return[pr*b/(t(_r)*yt*gt*Xt(_r)),P(et*Kt(_r/et)/St)]},0===et&&(yt=E(lt/b),(ir=function(pr,br){return[pr*yt,h(br)/yt]}).invert=function(pr,br){return[pr/yt,P(br*yt)]}),ir}function fr(Ue,Ze,et){function lt(_r){return Ue+(1-Ue)*u(1-u(_r,Ze),1/Ze)}function yt(_r){return function jt(Ue,Ze,et,lt,yt){void 0===lt&&(lt=1e-8),void 0===yt&&(yt=20);var gt=Ue(Ze),St=Ue(.5*(Ze+et)),Xt=Ue(et);return function Kt(Zt,ir,pr,br,_r,Or,tn,fn,En,On,qn){if(qn.nanEncountered)return NaN;var Dn,gi,Ai,Ni,Bi,ji,_a,ya,aa,oa;if(gi=Zt(ir+.25*(Dn=pr-ir)),Ai=Zt(pr-.25*Dn),isNaN(gi))qn.nanEncountered=!0;else{if(!isNaN(Ai))return oa=((ji=(Ni=Dn*(br+4*gi+_r)/12)+(Bi=Dn*(_r+4*Ai+Or)/12))-tn)/15,On>En?(qn.maxDepthCount++,ji+oa):Math.abs(oa)<fn?ji+oa:(ya=Kt(Zt,ir,_a=ir+.5*Dn,br,gi,_r,Ni,.5*fn,En,On+1,qn),isNaN(ya)?(qn.nanEncountered=!0,NaN):(aa=Kt(Zt,_a,pr,_r,Ai,Or,Bi,.5*fn,En,On+1,qn),isNaN(aa)?(qn.nanEncountered=!0,NaN):ya+aa));qn.nanEncountered=!0}}(Ue,Ze,et,gt,St,Xt,(gt+4*St+Xt)*(et-Ze)/6,lt,yt,1,{maxDepthCount:0,nanEncountered:!1})}(lt,0,_r,1e-4)}for(var gt=1/yt(1),Xt=(1+1e-8)*gt,Kt=[],Zt=0;Zt<=1e3;Zt++)Kt.push(yt(Zt/1e3)*Xt);function ir(_r){var Or=0,tn=1e3,fn=500;do{Kt[fn]>_r?tn=fn:Or=fn,fn=Or+tn>>1}while(fn>Or);var En=Kt[fn+1]-Kt[fn];return En&&(En=(_r-Kt[fn+1])/En),(fn+1+En)/1e3}var pr=2*ir(1)/b*gt/et,br=function(_r,Or){var tn=ir(x(h(Or))),fn=lt(tn)*_r;return tn/=pr,[fn,Or>=0?tn:-tn]};return br.invert=function(_r,Or){var tn;return x(Or*=pr)<1&&(tn=c(Or)*P(yt(x(Or))*gt)),[_r/lt(x(Or)),tn]},br}function kr(Ue,Ze){return x(Ue[0]-Ze[0])<o&&x(Ue[1]-Ze[1])<o}function ur(Ue,Ze){for(var et,lt,yt,gt=-1,St=Ue.length,Xt=Ue[0],Kt=[];++gt<St;){lt=((et=Ue[gt])[0]-Xt[0])/Ze,yt=(et[1]-Xt[1])/Ze;for(var Zt=0;Zt<Ze;++Zt)Kt.push([Xt[0]+Zt*lt,Xt[1]+Zt*yt]);Xt=et}return Kt.push(et),Kt}function Jt(Ue){var Ze,et,yt,gt,Xt,Kt=[],Zt=Ue[0].length;for(Xt=0;Xt<Zt;++Xt)et=(Ze=Ue[0][Xt])[0][0],Kt.push(ur([[et+o,Ze[0][1]+o],[et+o,(yt=Ze[1][1])-o],[(gt=Ze[2][0])-o,yt-o],[gt-o,Ze[2][1]+o]],30));for(Xt=Ue[1].length-1;Xt>=0;--Xt)et=(Ze=Ue[1][Xt])[0][0],Kt.push(ur([[(gt=Ze[2][0])-o,Ze[2][1]-o],[gt-o,(yt=Ze[1][1])+o],[et+o,yt+o],[et+o,Ze[0][1]-o]],30));return{type:"Polygon",coordinates:[m.merge(Kt)]}}function $t(Ue,Ze,et){var lt,yt;function gt(Kt,Zt){for(var ir=Zt<0?-1:1,pr=Ze[+(Zt<0)],br=0,_r=pr.length-1;br<_r&&Kt>pr[br][2][0];++br);var Or=Ue(Kt-pr[br][1][0],Zt);return Or[0]+=Ue(pr[br][1][0],ir*Zt>ir*pr[br][0][1]?pr[br][0][1]:Zt)[0],Or}et?gt.invert=et(gt):Ue.invert&&(gt.invert=function(Kt,Zt){for(var ir=yt[+(Zt<0)],pr=Ze[+(Zt<0)],br=0,_r=ir.length;br<_r;++br){var Or=ir[br];if(Or[0][0]<=Kt&&Kt<Or[1][0]&&Or[0][1]<=Zt&&Zt<Or[1][1]){var tn=Ue.invert(Kt-Ue(pr[br][1][0],0)[0],Zt);return tn[0]+=pr[br][1][0],kr(gt(tn[0],tn[1]),[Kt,Zt])?tn:null}}});var St=v.geoProjection(gt),Xt=St.stream;return St.stream=function(Kt){var Zt=St.rotate(),ir=Xt(Kt),pr=(St.rotate([0,0]),Xt(Kt));return St.rotate(Zt),ir.sphere=function(){v.geoStream(lt,pr)},ir},St.lobes=function(Kt){return arguments.length?(lt=Jt(Kt),Ze=Kt.map(function(Zt){return Zt.map(function(ir){return[[ir[0][0]*I,ir[0][1]*I],[ir[1][0]*I,ir[1][1]*I],[ir[2][0]*I,ir[2][1]*I]]})}),yt=Ze.map(function(Zt){return Zt.map(function(ir){var pr,br=Ue(ir[0][0],ir[0][1])[0],_r=Ue(ir[2][0],ir[2][1])[0],Or=Ue(ir[1][0],ir[0][1])[1],tn=Ue(ir[1][0],ir[1][1])[1];return Or>tn&&(pr=Or,Or=tn,tn=pr),[[br,Or],[_r,tn]]})}),St):Ze.map(function(Zt){return Zt.map(function(ir){return[[ir[0][0]*M,ir[0][1]*M],[ir[1][0]*M,ir[1][1]*M],[ir[2][0]*M,ir[2][1]*M]]})})},null!=Ze&&St.lobes(Ze),St}At.invert=function(Ue,Ze){return Ze>-.7109889596207567?ne.invert(Ue,Ze-.0528035274542):ge.invert(Ue,Ze)},Ft.invert=function(Ue,Ze){return x(Ze)>.7109889596207567?ne.invert(Ue,Ze+(Ze>0?.0528035274542:-.0528035274542)):ge.invert(Ue,Ze)};var Qt=[[[[-180,0],[-100,90],[-40,0]],[[-40,0],[30,90],[180,0]]],[[[-180,0],[-160,-90],[-100,0]],[[-100,0],[-60,-90],[-20,0]],[[-20,0],[20,-90],[80,0]],[[80,0],[140,-90],[180,0]]]],cr=[[[[-180,0],[-100,90],[-40,0]],[[-40,0],[30,90],[180,0]]],[[[-180,0],[-160,-90],[-100,0]],[[-100,0],[-60,-90],[-20,0]],[[-20,0],[20,-90],[80,0]],[[80,0],[140,-90],[180,0]]]],gr=[[[[-180,0],[-100,90],[-40,0]],[[-40,0],[30,90],[180,0]]],[[[-180,0],[-160,-90],[-100,0]],[[-100,0],[-60,-90],[-20,0]],[[-20,0],[20,-90],[80,0]],[[80,0],[140,-90],[180,0]]]],Tr=[[[[-180,0],[-90,90],[0,0]],[[0,0],[90,90],[180,0]]],[[[-180,0],[-90,-90],[0,0]],[[0,0],[90,-90],[180,0]]]],Fr=[[[[-180,35],[-30,90],[0,35]],[[0,35],[30,90],[180,35]]],[[[-180,-10],[-102,-90],[-65,-10]],[[-65,-10],[5,-90],[77,-10]],[[77,-10],[103,-90],[180,-10]]]],Nr=[[[[-180,0],[-110,90],[-40,0]],[[-40,0],[0,90],[40,0]],[[40,0],[110,90],[180,0]]],[[[-180,0],[-110,-90],[-40,0]],[[-40,0],[0,-90],[40,0]],[[40,0],[110,-90],[180,0]]]];function Xr(Ue,Ze){return[3/L*Ue*E(b*b/3-Ze*Ze),Ze]}function un(Ue){function Ze(et,lt){if(x(x(lt)-l)<o)return[0,lt<0?-2:2];var yt=h(lt),gt=u((1+yt)/(1-yt),Ue/2),St=.5*(gt+1/gt)+t(et*=Ue);return[2*h(et)/St,(gt-1/gt)/St]}return Ze.invert=function(et,lt){var yt=x(lt);if(x(yt-2)<o)return et?null:[0,c(lt)*l];if(yt>2)return null;var gt=(et/=2)*et,St=(lt/=2)*lt,Xt=2*lt/(1+gt+St);return Xt=u((1+Xt)/(1-Xt),1/Ue),[n(2*et,1-gt-St)/Ue,P((Xt-1)/(Xt+1))]},Ze}Xr.invert=function(Ue,Ze){return[L/3*Ue/E(b*b/3-Ze*Ze),Ze]};var $r=b/w;function Pn(Ue,Ze){return[Ue*(1+E(t(Ze)))/2,Ze/(t(Ze/2)*t(Ue/6))]}function gn(Ue,Ze){var et=Ue*Ue,lt=Ze*Ze;return[Ue*(.975534+lt*(-.0143059*et-.119161+-.0547009*lt)),Ze*(1.00384+et*(.0802894+-.02855*lt+199025e-9*et)+lt*(.0998909+-.0491032*lt))]}function dn(Ue,Ze){return[h(Ue)/t(Ze),p(Ze)*t(Ue)]}function An(Ue){var Ze=t(Ue),et=p(T+Ue/2);function lt(yt,gt){var St=gt-Ue,Xt=x(St)<o?yt*Ze:x(Xt=T+gt/2)<o||x(x(Xt)-l)<o?0:yt*St/d(p(Xt)/et);return[Xt,St]}return lt.invert=function(yt,gt){var St,Xt=gt+Ue;return[x(gt)<o?yt/Ze:x(St=T+Xt/2)<o||x(x(St)-l)<o?0:yt*d(p(St)/et)/gt,Xt]},lt}function Zn(Ue,Ze){return[Ue,1.25*d(p(T+.4*Ze))]}function Rr(Ue){var Ze=Ue.length-1;function et(lt,yt){for(var gt,St=t(yt),Xt=2/(1+St*t(lt)),Kt=Xt*St*h(lt),Zt=Xt*h(yt),ir=Ze,pr=Ue[ir],br=pr[0],_r=pr[1];--ir>=0;)br=(pr=Ue[ir])[0]+Kt*(gt=br)-Zt*_r,_r=pr[1]+Kt*_r+Zt*gt;return[br=Kt*(gt=br)-Zt*_r,_r=Kt*_r+Zt*gt]}return et.invert=function(lt,yt){var gt=20,St=lt,Xt=yt;do{for(var Kt,Zt=Ze,ir=Ue[Zt],pr=ir[0],br=ir[1],_r=0,Or=0;--Zt>=0;)_r=pr+St*(Kt=_r)-Xt*Or,Or=br+St*Or+Xt*Kt,pr=(ir=Ue[Zt])[0]+St*(Kt=pr)-Xt*br,br=ir[1]+St*br+Xt*Kt;var tn,fn,En=(_r=pr+St*(Kt=_r)-Xt*Or)*_r+(Or=br+St*Or+Xt*Kt)*Or;St-=tn=((pr=St*(Kt=pr)-Xt*br-lt)*_r+(br=St*br+Xt*Kt-yt)*Or)/En,Xt-=fn=(br*_r-pr*Or)/En}while(x(tn)+x(fn)>1e-12&&--gt>0);if(gt){var On=E(St*St+Xt*Xt),qn=2*e(.5*On),Dn=h(qn);return[n(St*Dn,On*t(qn)),On?P(Xt*Dn/On):0]}},et}Pn.invert=function(Ue,Ze){var et=x(Ue),lt=x(Ze),yt=o,gt=l;lt<$r?gt*=lt/$r:yt+=6*S($r/lt);for(var St=0;St<25;St++){var Xt=h(gt),Kt=E(t(gt)),Zt=h(gt/2),ir=t(gt/2),pr=h(yt/6),br=t(yt/6),_r=.5*yt*(1+Kt)-et,Or=gt/(ir*br)-lt,tn=Kt?-.25*yt*Xt/Kt:0,fn=.5*(1+Kt),En=(1+.5*gt*Zt/ir)/(ir*br),On=gt/ir*(pr/6)/(br*br),qn=tn*On-En*fn,Dn=(_r*On-Or*fn)/qn,gi=(Or*tn-_r*En)/qn;if(gt-=Dn,yt-=gi,x(Dn)<o&&x(gi)<o)break}return[Ue<0?-yt:yt,Ze<0?-gt:gt]},gn.invert=function(Ue,Ze){var et=c(Ue)*b,lt=Ze/2,yt=50;do{var gt=et*et,St=lt*lt,Xt=et*lt,Kt=et*(.975534+St*(-.0143059*gt-.119161+-.0547009*St))-Ue,Zt=lt*(1.00384+gt*(.0802894+-.02855*St+199025e-9*gt)+St*(.0998909+-.0491032*St))-Ze,ir=.975534-St*(.119161+3*gt*.0143059+.0547009*St),pr=-Xt*(.238322+.2188036*St+.0286118*gt),br=Xt*(.1605788+7961e-7*gt+-.0571*St),_r=1.00384+gt*(.0802894+199025e-9*gt)+St*(3*(.0998909-.02855*gt)-.245516*St),Or=pr*br-_r*ir,tn=(Zt*pr-Kt*_r)/Or,fn=(Kt*br-Zt*ir)/Or;et-=tn,lt-=fn}while((x(tn)>o||x(fn)>o)&&--yt>0);return yt&&[et,lt]},dn.invert=function(Ue,Ze){var et=Ue*Ue,lt=Ze*Ze+1,yt=et+lt,gt=Ue?_*E((yt-E(yt*yt-4*et))/et):1/E(lt);return[P(Ue*gt),c(Ze)*S(gt)]},Zn.invert=function(Ue,Ze){return[Ue,2.5*e(a(.8*Ze))-.625*b]};var hn=[[.9972523,0],[.0052513,-.0041175],[.0074606,.0048125],[-.0153783,-.1968253],[.0636871,-.1408027],[.3660976,-.2937382]],nn=[[.98879,0],[0,0],[-.050909,0],[0,0],[.075528,0]],Hr=[[.984299,0],[.0211642,.0037608],[-.1036018,-.0575102],[-.0329095,-.0320119],[.0499471,.1223335],[.026046,.0899805],[7388e-7,-.1435792],[.0075848,-.1334108],[-.0216473,.0776645],[-.0225161,.0853673]],Fn=[[.9245,0],[0,0],[.01943,0]],Un=[[.721316,0],[0,0],[-.00881625,-.00617325]];function vn(Ue,Ze){var et=v.geoProjection(Rr(Ue)).rotate(Ze).clipAngle(90),lt=v.geoRotation(Ze),yt=et.center;return delete et.rotate,et.center=function(gt){return arguments.length?yt(lt(gt)):lt.invert(yt())},et}var Cn=E(6),li=E(7);function tr(Ue,Ze){var et=P(7*h(Ze)/(3*Cn));return[Cn*Ue*(2*t(2*et/3)-1)/li,9*h(et/3)/li]}function mr(Ue,Ze){for(var et,lt=(1+_)*h(Ze),yt=Ze,gt=0;gt<25&&(yt-=et=(h(yt/2)+h(yt)-lt)/(.5*t(yt/2)+t(yt)),!(x(et)<o));gt++);return[Ue*(1+2*t(yt)/t(yt/2))/(3*w),2*E(3)*h(yt/2)/E(2+w)]}function Pt(Ue,Ze){for(var et,lt=E(6/(4+b)),yt=(1+b/4)*h(Ze),gt=Ze/2,St=0;St<25&&(gt-=et=(gt/2+h(gt)-yt)/(.5+t(gt)),!(x(et)<o));St++);return[lt*(.5+t(gt))*Ue/1.5,lt*gt]}function or(Ue,Ze){var et=Ze*Ze,lt=et*et,yt=et*lt;return[Ue*(.84719-.13063*et+yt*yt*(.05494*et-.04515-.02326*lt+.00331*yt)),Ze*(1.01183+lt*lt*(.01926*et-.02625-.00396*lt))]}function hr(Ue,Ze){return[Ue*(1+t(Ze))/2,2*(Ze-p(Ze/2))]}tr.invert=function(Ue,Ze){var et=3*P(Ze*li/9);return[Ue*li/(Cn*(2*t(2*et/3)-1)),P(3*h(et)*Cn/7)]},mr.invert=function(Ue,Ze){var et=Ze*E(2+w)/(2*E(3)),lt=2*P(et);return[3*w*Ue/(1+2*t(lt)/t(lt/2)),P((et+h(lt))/(1+_))]},Pt.invert=function(Ue,Ze){var et=E(6/(4+b)),lt=Ze/et;return x(x(lt)-l)<o&&(lt=lt<0?-l:l),[1.5*Ue/(et*(.5+t(lt))),P((lt/2+h(lt))/(1+b/4))]},or.invert=function(Ue,Ze){var et,lt,yt,gt,St=Ze,Xt=25;do{St-=et=(St*(1.01183+(yt=(lt=St*St)*lt)*yt*(.01926*lt-.02625-.00396*yt))-Ze)/(1.01183+yt*yt*(.21186*lt-.23625+-.05148*yt))}while(x(et)>1e-12&&--Xt>0);return[Ue/(.84719-.13063*(lt=St*St)+(gt=lt*(yt=lt*lt))*gt*(.05494*lt-.04515-.02326*yt+.00331*gt)),St]},hr.invert=function(Ue,Ze){for(var et=Ze/2,lt=0,yt=1/0;lt<10&&x(yt)>o;++lt){var gt=t(Ze/2);Ze-=yt=(Ze-p(Ze/2)-et)/(1-.5/(gt*gt))}return[2*Ue/(1+t(Ze)),Ze]};var zr=[[[[-180,0],[-90,90],[0,0]],[[0,0],[90,90],[180,0]]],[[[-180,0],[-90,-90],[0,0]],[[0,0],[90,-90],[180,0]]]];function Dr(Ue,Ze){var et=h(Ze),lt=t(Ze),yt=c(Ue);if(0===Ue||x(Ze)===l)return[0,Ze];if(0===Ze)return[Ue,0];if(x(Ue)===l)return[Ue*lt,l*et];var gt=b/(2*Ue)-2*Ue/b,St=2*Ze/b,Xt=(1-St*St)/(et-St),Kt=gt*gt,Zt=Xt*Xt,ir=1+Kt/Zt,pr=1+Zt/Kt,br=(gt*et/Xt-gt/2)/ir,_r=(Zt*et/Kt+Xt/2)/pr,Or=_r*_r-(Zt*et*et/Kt+Xt*et-1)/pr;return[l*(br+E(br*br+lt*lt/ir)*yt),l*(_r+E(Or<0?0:Or)*c(-Ze*gt)*yt)]}function Ir(Ue,Ze){var et=Ze*Ze;return[Ue,Ze*(1.0148+et*et*(.23185+et*(.02406*et-.14499)))]}function Mr(Ue,Ze){if(x(Ze)<o)return[Ue,0];var et=p(Ze),lt=Ue*h(Ze);return[h(lt)/et,Ze+(1-t(lt))/et]}function xr(Ue,Ze){return[Ue[0]*Ze[0]+Ue[1]*Ze[3],Ue[0]*Ze[1]+Ue[1]*Ze[4],Ue[0]*Ze[2]+Ue[1]*Ze[5]+Ue[2],Ue[3]*Ze[0]+Ue[4]*Ze[3],Ue[3]*Ze[1]+Ue[4]*Ze[4],Ue[3]*Ze[2]+Ue[4]*Ze[5]+Ue[5]]}function wr(Ue,Ze){return[Ue[0]-Ze[0],Ue[1]-Ze[1]]}function Er(Ue){return E(Ue[0]*Ue[0]+Ue[1]*Ue[1])}function qr(Ue,Ze,et){function lt(St,Xt){var Kt,Zt=Ze(St,Xt),ir=Zt.project([St*M,Xt*M]);return(Kt=Zt.transform)?[Kt[0]*ir[0]+Kt[1]*ir[1]+Kt[2],-(Kt[3]*ir[0]+Kt[4]*ir[1]+Kt[5])]:(ir[1]=-ir[1],ir)}(function St(Xt,Kt){if(Xt.edges=function(Or){for(var tn=Or.length,fn=[],En=Or[tn-1],On=0;On<tn;++On)fn.push([En,En=Or[On]]);return fn}(Xt.face),Kt.face){var Zt=Xt.shared=function(Or,tn){for(var fn,En,On=Or.length,qn=null,Dn=0;Dn<On;++Dn){fn=Or[Dn];for(var gi=tn.length;--gi>=0;)if(fn[0]===(En=tn[gi])[0]&&fn[1]===En[1]){if(qn)return[qn,fn];qn=fn}}}(Xt.face,Kt.face),ir=function vr(Ue,Ze){var St,Xt,et=wr(Ue[1],Ue[0]),lt=wr(Ze[1],Ze[0]),yt=n((St=et)[0]*(Xt=lt)[1]-St[1]*Xt[0],St[0]*Xt[0]+St[1]*Xt[1]),gt=Er(et)/Er(lt);return xr([1,0,Ue[0][0],0,1,Ue[0][1]],xr([gt,0,0,0,gt,0],xr([t(yt),h(yt),0,-h(yt),t(yt),0],[1,0,-Ze[0][0],0,1,-Ze[0][1]])))}(Zt.map(Kt.project),Zt.map(Xt.project));Xt.transform=Kt.transform?xr(Kt.transform,ir):ir;for(var pr=Kt.edges,br=0,_r=pr.length;br<_r;++br)Vr(Zt[0],pr[br][1])&&Vr(Zt[1],pr[br][0])&&(pr[br]=Xt),Vr(Zt[0],pr[br][0])&&Vr(Zt[1],pr[br][1])&&(pr[br]=Xt);for(br=0,_r=(pr=Xt.edges).length;br<_r;++br)Vr(Zt[0],pr[br][0])&&Vr(Zt[1],pr[br][1])&&(pr[br]=Kt),Vr(Zt[0],pr[br][1])&&Vr(Zt[1],pr[br][0])&&(pr[br]=Kt)}else Xt.transform=Kt.transform;return Xt.children&&Xt.children.forEach(function(Or){St(Or,Xt)}),Xt})(Ue,{transform:null}),Qr(Ue)&&(lt.invert=function(St,Xt){var Kt=function Zt(ir,pr){var qn,Dn,br=ir.project.invert,_r=ir.transform,Or=pr;if(_r&&(Or=[(_r=[(Dn=1/((qn=_r)[0]*qn[4]-qn[1]*qn[3]))*qn[4],-Dn*qn[1],Dn*(qn[1]*qn[5]-qn[2]*qn[4]),-Dn*qn[3],Dn*qn[0],Dn*(qn[2]*qn[3]-qn[0]*qn[5])])[0]*Or[0]+_r[1]*Or[1]+_r[2],_r[3]*Or[0]+_r[4]*Or[1]+_r[5]]),br&&ir===function(qn){return Ze(qn[0]*I,qn[1]*I)}(tn=br(Or)))return tn;for(var tn,fn=ir.children,En=0,On=fn&&fn.length;En<On;++En)if(tn=Zt(fn[En],pr))return tn}(Ue,[St,-Xt]);return Kt&&(Kt[0]*=I,Kt[1]*=I,Kt)});var yt=v.geoProjection(lt),gt=yt.stream;return yt.stream=function(St){var Xt=yt.rotate(),Kt=gt(St),Zt=(yt.rotate([0,0]),gt(St));return yt.rotate(Xt),Kt.sphere=function(){Zt.polygonStart(),Zt.lineStart(),function ir(pr,br,_r){var Or,tn,fn=br.edges,En=fn.length,On={type:"MultiPoint",coordinates:br.face},qn=br.face.filter(function(_a){return 90!==x(_a[1])}),Dn=v.geoBounds({type:"MultiPoint",coordinates:qn}),gi=!1,Ai=-1,Ni=Dn[1][0]-Dn[0][0],Bi=180===Ni||360===Ni?[(Dn[0][0]+Dn[1][0])/2,(Dn[0][1]+Dn[1][1])/2]:v.geoCentroid(On);if(_r)for(;++Ai<En&&fn[Ai]!==_r;);++Ai;for(var ji=0;ji<En;++ji)tn=fn[(ji+Ai)%En],Array.isArray(tn)?(gi||(pr.point((Or=v.geoInterpolate(tn[0],Bi)(o))[0],Or[1]),gi=!0),pr.point((Or=v.geoInterpolate(tn[1],Bi)(o))[0],Or[1])):(gi=!1,tn!==_r&&ir(pr,tn,br))}(Zt,Ue),Zt.lineEnd(),Zt.polygonEnd()},Kt},yt.angle(null==et?-30:et*M)}function Vr(Ue,Ze){return Ue&&Ze&&Ue[0]===Ze[0]&&Ue[1]===Ze[1]}function Qr(Ue){return Ue.project.invert||Ue.children&&Ue.children.some(Qr)}Dr.invert=function(Ue,Ze){var et=(Ue/=l)*Ue,lt=et+(Ze/=l)*Ze,yt=b*b;return[Ue?(lt-1+E((1-lt)*(1-lt)+4*et))/(2*Ue)*l:0,te(function(gt){return lt*(b*h(gt)-2*gt)*b+4*gt*gt*(Ze-h(gt))+2*b*gt-yt*Ze},0)]},Ir.invert=function(Ue,Ze){Ze>1.790857183?Ze=1.790857183:Ze<-1.790857183&&(Ze=-1.790857183);var et,lt=Ze;do{var yt=lt*lt;lt-=et=(lt*(1.0148+yt*yt*(.23185+yt*(.02406*yt-.14499)))-Ze)/(1.0148+yt*yt*(5*.23185+yt*(.21654*yt-1.01493)))}while(x(et)>o);return[Ue,lt]},Mr.invert=function(Ue,Ze){if(x(Ze)<o)return[Ue,0];var et,lt=Ue*Ue+Ze*Ze,yt=.5*Ze,gt=10;do{var St=p(yt),Xt=1/t(yt),Kt=lt-2*Ze*yt+yt*yt;yt-=et=(St*Kt+2*(yt-Ze))/(2+Kt*Xt*Xt+2*(yt-Ze)*St)}while(x(et)>o&&--gt>0);return St=p(yt),[(x(Ze)<x(yt+1/St)?P(Ue*St):c(Ze)*c(Ue)*(S(x(Ue*St))+l))/h(yt),yt]};var en=[[0,90],[-90,0],[0,0],[90,0],[180,0],[0,-90]],mn=[[0,2,1],[0,3,2],[5,1,2],[5,2,3],[0,1,4],[0,4,3],[5,4,1],[5,3,4]].map(function(Ue){return Ue.map(function(Ze){return en[Ze]})}),xn=2/E(3);function bn(Ue,Ze){var et=Ne(Ue,Ze);return[et[0]*xn,et[1]]}function Sn(Ue,Ze){for(var et=0,lt=Ue.length,yt=0;et<lt;++et)yt+=Ue[et]*Ze[et];return yt}function In(Ue){return[n(Ue[1],Ue[0])*M,P(s(-1,i(1,Ue[2])))*M]}function Yn(Ue){var Ze=Ue[0]*I,et=Ue[1]*I,lt=t(et);return[lt*t(Ze),lt*h(Ze),h(et)]}function ki(){}function Ti(Ue,Ze){return{type:"FeatureCollection",features:Ue.features.map(function(et){return kn(et,Ze)})}}function kn(Ue,Ze){return{type:"Feature",id:Ue.id,properties:Ue.properties,geometry:Qn(Ue.geometry,Ze)}}function Qn(Ue,Ze){if(!Ue)return null;if("GeometryCollection"===Ue.type)return yt=Ze,{type:"GeometryCollection",geometries:Ue.geometries.map(function(gt){return Qn(gt,yt)})};var yt,et;switch(Ue.type){case"Point":case"MultiPoint":et=ha;break;case"LineString":case"MultiLineString":et=Ia;break;case"Polygon":case"MultiPolygon":case"Sphere":et=oo;break;default:return null}return v.geoStream(Ue,Ze(et)),et.result()}bn.invert=function(Ue,Ze){return Ne.invert(Ue/xn,Ze)};var Jn=[],Ii=[],ha={point:function(Ue,Ze){Jn.push([Ue,Ze])},result:function(){var Ue=Jn.length?Jn.length<2?{type:"Point",coordinates:Jn[0]}:{type:"MultiPoint",coordinates:Jn}:null;return Jn=[],Ue}},Ia={lineStart:ki,point:function(Ue,Ze){Jn.push([Ue,Ze])},lineEnd:function(){Jn.length&&(Ii.push(Jn),Jn=[])},result:function(){var Ue=Ii.length?Ii.length<2?{type:"LineString",coordinates:Ii[0]}:{type:"MultiLineString",coordinates:Ii}:null;return Ii=[],Ue}},oo={polygonStart:ki,lineStart:ki,point:function(Ue,Ze){Jn.push([Ue,Ze])},lineEnd:function(){var Ue=Jn.length;if(Ue){do{Jn.push(Jn[0].slice())}while(++Ue<4);Ii.push(Jn),Jn=[]}},polygonEnd:ki,result:function(){if(!Ii.length)return null;var Ue=[],Ze=[];return Ii.forEach(function(et){!function(lt){if((yt=lt.length)<4)return!1;for(var yt,gt=0,St=lt[yt-1][1]*lt[0][0]-lt[yt-1][0]*lt[0][1];++gt<yt;)St+=lt[gt-1][1]*lt[gt][0]-lt[gt-1][0]*lt[gt][1];return St<=0}(et)?Ze.push(et):Ue.push([et])}),Ze.forEach(function(et){var lt=et[0];Ue.some(function(yt){if(function(gt,St){for(var Xt=St[0],Kt=St[1],Zt=!1,ir=0,pr=gt.length,br=pr-1;ir<pr;br=ir++){var _r=gt[ir],Or=_r[0],tn=_r[1],fn=gt[br],On=fn[1];tn>Kt^On>Kt&&Xt<(fn[0]-Or)*(Kt-tn)/(On-tn)+Or&&(Zt=!Zt)}return Zt}(yt[0],lt))return yt.push(et),!0})||Ue.push([et])}),Ii=[],Ue.length?Ue.length>1?{type:"MultiPolygon",coordinates:Ue}:{type:"Polygon",coordinates:Ue[0]}:null}};function Gi(Ue){var Ze=Ue(l,0)[0]-Ue(-l,0)[0];function et(lt,yt){var gt=x(lt)<l,St=Ue(gt?lt:lt>0?lt-b:lt+b,yt),Xt=(St[0]-St[1])*_,Kt=(St[0]+St[1])*_;if(gt)return[Xt,Kt];var Zt=Ze*_,ir=Xt>0^Kt>0?-1:1;return[ir*Xt-c(Kt)*Zt,ir*Kt-c(Xt)*Zt]}return Ue.invert&&(et.invert=function(lt,yt){var gt=(lt+yt)*_,St=(yt-lt)*_,Xt=x(gt)<.5*Ze&&x(St)<.5*Ze;if(!Xt){var Kt=Ze*_,Zt=gt>0^St>0?-1:1,ir=-Zt*lt+(St>0?1:-1)*Kt,pr=-Zt*yt+(gt>0?1:-1)*Kt;gt=(-ir-pr)*_,St=(ir-pr)*_}var br=Ue.invert(gt,St);return Xt||(br[0]+=gt>0?b:-b),br}),v.geoProjection(et).rotate([-90,-90,45]).clipAngle(179.999)}function Zi(){return Gi(Ct).scale(111.48)}function Ya(Ue){var Ze=h(Ue);function et(lt,yt){var gt=Ze?p(lt*Ze/2)/Ze:lt/2;if(!yt)return[2*gt,-Ue];var St=2*e(gt*h(yt)),Xt=1/p(yt);return[h(St)*Xt,yt+(1-t(St))*Xt-Ue]}return et.invert=function(lt,yt){if(x(yt+=Ue)<o)return[Ze?2*e(Ze*lt/2)/Ze:lt,0];var gt,St=lt*lt+yt*yt,Xt=0,Kt=10;do{var Zt=p(Xt),ir=1/t(Xt),pr=St-2*yt*Xt+Xt*Xt;Xt-=gt=(Zt*pr+2*(Xt-yt))/(2+pr*ir*ir+2*(Xt-yt)*Zt)}while(x(gt)>o&&--Kt>0);var br=lt*(Zt=p(Xt)),_r=p(x(yt)<x(Xt+1/Zt)?.5*P(br):.5*S(br)+b/4)/h(Xt);return[Ze?2*e(Ze*_r)/Ze:2*_r,Xt]},et}var Fi=[[.9986,-.062],[1,0],[.9986,.062],[.9954,.124],[.99,.186],[.9822,.248],[.973,.31],[.96,.372],[.9427,.434],[.9216,.4958],[.8962,.5571],[.8679,.6176],[.835,.6769],[.7986,.7346],[.7597,.7903],[.7186,.8435],[.6732,.8936],[.6213,.9394],[.5722,.9761],[.5322,1]];function so(Ue,Ze){var et,lt=i(18,36*x(Ze)/b),yt=r(lt),gt=lt-yt,St=(et=Fi[yt])[0],Xt=et[1],Kt=(et=Fi[++yt])[0],Zt=et[1],ir=(et=Fi[i(19,++yt)])[0],pr=et[1];return[Ue*(Kt+gt*(ir-St)/2+gt*gt*(ir-2*Kt+St)/2),(Ze>0?l:-l)*(Zt+gt*(pr-Xt)/2+gt*gt*(pr-2*Zt+Xt)/2)]}function fo(Ue,Ze){var et=function(St){function Xt(Kt,Zt){var ir=t(Zt),pr=(St-1)/(St-ir*t(Kt));return[pr*ir*h(Kt),pr*h(Zt)]}return Xt.invert=function(Kt,Zt){var ir=Kt*Kt+Zt*Zt,pr=E(ir),br=(St-E(1-ir*(St+1)/(St-1)))/((St-1)/pr+pr/(St-1));return[n(Kt*br,pr*E(1-br*br)),pr?P(Zt*br/pr):0]},Xt}(Ue);if(!Ze)return et;var lt=t(Ze),yt=h(Ze);function gt(St,Xt){var Kt=et(St,Xt),Zt=Kt[1],ir=Zt*yt/(Ue-1)+lt;return[Kt[0]*lt/ir,Zt/ir]}return gt.invert=function(St,Xt){var Kt=(Ue-1)/(Ue-1-Xt*yt);return et.invert(Kt*St,Kt*Xt*lt)},gt}Fi.forEach(function(Ue){Ue[1]*=1.0144}),so.invert=function(Ue,Ze){var et=Ze/l,lt=90*et,yt=i(18,x(lt/5)),gt=s(0,r(yt));do{var St=Fi[gt][1],Xt=Fi[gt+1][1],Kt=Fi[i(19,gt+2)][1],Zt=Kt-St,ir=Kt-2*Xt+St,pr=2*(x(et)-Xt)/Zt,br=ir/Zt,_r=pr*(1-br*pr*(1-2*br*pr));if(_r>=0||1===gt){lt=(Ze>=0?5:-5)*(_r+yt);var Or,tn=50;do{_r=(yt=i(18,x(lt)/5))-(gt=r(yt)),St=Fi[gt][1],Xt=Fi[gt+1][1],Kt=Fi[i(19,gt+2)][1],lt-=(Or=(Ze>=0?l:-l)*(Xt+_r*(Kt-St)/2+_r*_r*(Kt-2*Xt+St)/2)-Ze)*M}while(x(Or)>1e-12&&--tn>0);break}}while(--gt>=0);var fn=Fi[gt][0],En=Fi[gt+1][0],On=Fi[i(19,gt+2)][0];return[Ue/(En+_r*(On-fn)/2+_r*_r*(On-2*En+fn)/2),lt*I]};var ba=-179.9999,Wa=179.9999,ho=-89.9999;function wo(Ue){return Ue.length>0}function Ra(Ue){return-90===Ue||90===Ue?[0,Ue]:[-180,(Ze=Ue,Math.floor(1e4*Ze)/1e4)];var Ze}function pa(Ue){var Ze=Ue[0],et=Ue[1],lt=!1;return Ze<=ba?(Ze=-180,lt=!0):Ze>=Wa&&(Ze=180,lt=!0),et<=ho?(et=-90,lt=!0):et>=89.9999&&(et=90,lt=!0),lt?[Ze,et]:Ue}function Ga(Ue){return Ue.map(pa)}function ps(Ue,Ze,et){for(var lt=0,yt=Ue.length;lt<yt;++lt){var gt=Ue[lt].slice();et.push({index:-1,polygon:Ze,ring:gt});for(var St=0,Xt=gt.length;St<Xt;++St){var Kt=gt[St],Zt=Kt[0],ir=Kt[1];if(Zt<=ba||Zt>=Wa||ir<=ho||ir>=89.9999){gt[St]=pa(Kt);for(var pr=St+1;pr<Xt;++pr){var br=gt[pr],_r=br[0],Or=br[1];if(_r>ba&&_r<Wa&&Or>ho&&Or<89.9999)break}if(pr===St+1)continue;if(St){var tn={index:-1,polygon:Ze,ring:gt.slice(0,St+1)};tn.ring[tn.ring.length-1]=Ra(ir),et[et.length-1]=tn}else et.pop();if(pr>=Xt)break;et.push({index:-1,polygon:Ze,ring:gt=gt.slice(pr-1)}),gt[0]=Ra(gt[0][1]),St=-1,Xt=gt.length}}}}function vs(Ue){var Ze,et,lt,yt,gt,St,Xt=Ue.length,Kt={},Zt={};for(Ze=0;Ze<Xt;++Ze)(lt=(et=Ue[Ze]).ring[0])[0]!==(gt=et.ring[et.ring.length-1])[0]||lt[1]!==gt[1]?(et.index=Ze,Kt[lt]=Zt[gt]=et):(et.polygon.push(et.ring),Ue[Ze]=null);for(Ze=0;Ze<Xt;++Ze)if(et=Ue[Ze]){if(yt=Zt[lt=et.ring[0]],St=Kt[gt=et.ring[et.ring.length-1]],delete Kt[lt],delete Zt[gt],lt[0]===gt[0]&&lt[1]===gt[1]){et.polygon.push(et.ring);continue}yt?(delete Zt[lt],delete Kt[yt.ring[0]],yt.ring.pop(),Ue[yt.index]=null,et={index:-1,polygon:yt.polygon,ring:yt.ring.concat(et.ring)},yt===St?et.polygon.push(et.ring):(et.index=Xt++,Ue.push(Kt[et.ring[0]]=Zt[et.ring[et.ring.length-1]]=et))):St?(delete Kt[gt],delete Zt[St.ring[St.ring.length-1]],et.ring.pop(),et={index:Xt++,polygon:St.polygon,ring:et.ring.concat(St.ring)},Ue[St.index]=null,Ue.push(Kt[et.ring[0]]=Zt[et.ring[et.ring.length-1]]=et)):(et.ring.push(et.ring[0]),et.polygon.push(et.ring))}}function Yi(Ue){var Ze={type:"Feature",geometry:ss(Ue.geometry)};return null!=Ue.id&&(Ze.id=Ue.id),null!=Ue.bbox&&(Ze.bbox=Ue.bbox),null!=Ue.properties&&(Ze.properties=Ue.properties),Ze}function ss(Ue){if(null==Ue)return Ue;var Ze,et,lt,yt;switch(Ue.type){case"GeometryCollection":Ze={type:"GeometryCollection",geometries:Ue.geometries.map(ss)};break;case"Point":Ze={type:"Point",coordinates:pa(Ue.coordinates)};break;case"MultiPoint":case"LineString":Ze={type:Ue.type,coordinates:Ga(Ue.coordinates)};break;case"MultiLineString":Ze={type:"MultiLineString",coordinates:Ue.coordinates.map(Ga)};break;case"Polygon":var gt=[];ps(Ue.coordinates,gt,et=[]),vs(et),Ze={type:"Polygon",coordinates:gt};break;case"MultiPolygon":et=[],lt=-1,yt=Ue.coordinates.length;for(var St=new Array(yt);++lt<yt;)ps(Ue.coordinates[lt],St[lt]=[],et);vs(et),Ze={type:"MultiPolygon",coordinates:St.filter(wo)};break;default:return Ue}return null!=Ue.bbox&&(Ze.bbox=Ue.bbox),Ze}function Wo(Ue,Ze){var et=p(Ze/2),lt=h(T*et);return[Ue*(.74482-.34588*lt*lt),1.70711*et]}function ys(Ue,Ze,et){var lt=v.geoInterpolate(Ze,et),yt=lt(.5),gt=v.geoRotation([-yt[0],-yt[1]])(Ze),St=lt.distance/2,Xt=-P(h(gt[1]*I)/h(St)),Kt=[-yt[0],-yt[1],-(gt[0]>0?b-Xt:Xt)*M],Zt=v.geoProjection(Ue(St)).rotate(Kt),ir=v.geoRotation(Kt),pr=Zt.center;return delete Zt.rotate,Zt.center=function(br){return arguments.length?pr(ir(br)):ir.invert(pr())},Zt.clipAngle(90)}function xs(Ue){var Ze=t(Ue);function et(lt,yt){var gt=v.geoGnomonicRaw(lt,yt);return gt[0]*=Ze,gt}return et.invert=function(lt,yt){return v.geoGnomonicRaw.invert(lt/Ze,yt)},et}function ds(Ue,Ze){return ys(xs,Ue,Ze)}function bs(Ue){if(!(Ue*=2))return v.geoAzimuthalEquidistantRaw;var Ze=-Ue/2,et=-Ze,lt=Ue*Ue,yt=p(et),gt=.5/h(et);function St(Xt,Kt){var Zt=S(t(Kt)*t(Xt-Ze)),ir=S(t(Kt)*t(Xt-et));return[((Zt*=Zt)-(ir*=ir))/(2*Ue),(Kt<0?-1:1)*E(4*lt*ir-(lt-Zt+ir)*(lt-Zt+ir))/(2*Ue)]}return St.invert=function(Xt,Kt){var Zt,ir,pr=Kt*Kt,br=t(E(pr+(Zt=Xt+Ze)*Zt)),_r=t(E(pr+(Zt=Xt+et)*Zt));return[n(ir=br-_r,Zt=(br+_r)*yt),(Kt<0?-1:1)*S(E(Zt*Zt+ir*ir)*gt)]},St}function Ao(Ue,Ze){return ys(bs,Ue,Ze)}function Mo(Ue,Ze){if(x(Ze)<o)return[Ue,0];var et=x(Ze/l),lt=P(et);if(x(Ue)<o||x(x(Ze)-l)<o)return[0,c(Ze)*b*p(lt/2)];var yt=t(lt),gt=x(b/Ue-Ue/b)/2,St=gt*gt,Xt=yt/(et+yt-1),Kt=Xt*(2/et-1),Zt=Kt*Kt,ir=Zt+St,pr=Xt-Zt,br=St+Xt;return[c(Ue)*b*(gt*pr+E(St*pr*pr-ir*(Xt*Xt-Zt)))/ir,c(Ze)*b*(Kt*br-gt*E((St+1)*ir-br*br))/ir]}function Fo(Ue,Ze){if(x(Ze)<o)return[Ue,0];var et=x(Ze/l),lt=P(et);if(x(Ue)<o||x(x(Ze)-l)<o)return[0,c(Ze)*b*p(lt/2)];var yt=t(lt),gt=x(b/Ue-Ue/b)/2,St=gt*gt,Xt=yt*(E(1+St)-gt*yt)/(1+St*et*et);return[c(Ue)*b*Xt,c(Ze)*b*E(1-Xt*(2*gt+Xt))]}function Bo(Ue,Ze){if(x(Ze)<o)return[Ue,0];var et=Ze/l,lt=P(et);if(x(Ue)<o||x(x(Ze)-l)<o)return[0,b*p(lt/2)];var yt=(b/Ue-Ue/b)/2,gt=et/(1+t(lt));return[b*(c(Ue)*E(yt*yt+1-gt*gt)-yt),b*gt]}function No(Ue,Ze){if(!Ze)return[Ue,0];var et=x(Ze);if(!Ue||et===l)return[0,Ze];var lt=et/l,yt=lt*lt,gt=(8*lt-yt*(yt+2)-5)/(2*yt*(lt-1)),St=gt*gt,Xt=lt*gt,Kt=yt+St+2*Xt,Zt=lt+3*gt,ir=Ue/l,pr=ir+1/ir,br=c(x(Ue)-l)*E(pr*pr-4),_r=br*br,Or=(br*(Kt+St-1)+2*E(Kt*(yt+St*_r-1)+(1-yt)*(yt*(Zt*Zt+4*St)+12*Xt*St+4*St*St)))/(4*Kt+_r);return[c(Ue)*l*Or,c(Ze)*l*E(1+br*x(Or)-Or*Or)]}function Xo(Ue,Ze,et,lt){var yt=b/3;Ue=s(Ue,o),Ze=s(Ze,o),Ue=i(Ue,l),Ze=i(Ze,b-o),et=s(et,0),et=i(et,100-o);var gt=(lt=s(lt,o))/100,St=S((et/100+1)*t(yt))/yt,Xt=h(Ue)/h(St*l),Kt=Ze/b,Zt=E(gt*h(Ue/2)/h(Ze/2));return function(ir,pr,br,_r,Or){function tn(fn,En){var On=br*h(_r*En),qn=E(1-On*On),Dn=E(2/(1+qn*t(fn*=Or)));return[ir*qn*Dn*h(fn),pr*On*Dn]}return tn.invert=function(fn,En){var On=fn/ir,qn=En/pr,Dn=E(On*On+qn*qn),gi=2*P(Dn/2);return[n(fn*p(gi),ir*Dn)/Or,Dn&&P(En*h(gi)/(pr*br*Dn))/_r]},tn}(Zt/E(Kt*Xt*St),1/(Zt*E(Kt*Xt*St)),Xt,St,Kt)}function po(){var Ue=65*I,Ze=60*I,et=20,lt=200,yt=v.geoProjectionMutator(Xo),gt=yt(Ue,Ze,et,lt);return gt.poleline=function(St){return arguments.length?yt(Ue=+St*I,Ze,et,lt):Ue*M},gt.parallels=function(St){return arguments.length?yt(Ue,Ze=+St*I,et,lt):Ze*M},gt.inflation=function(St){return arguments.length?yt(Ue,Ze,et=+St,lt):et},gt.ratio=function(St){return arguments.length?yt(Ue,Ze,et,lt=+St):lt},gt.scale(163.775)}Wo.invert=function(Ue,Ze){var et=Ze/1.70711,lt=h(T*et);return[Ue/(.74482-.34588*lt*lt),2*e(et)]},Mo.invert=function(Ue,Ze){if(x(Ze)<o)return[Ue,0];if(x(Ue)<o)return[0,l*h(2*e(Ze/b))];var et=(Ue/=b)*Ue,lt=(Ze/=b)*Ze,yt=et+lt,gt=yt*yt,St=-x(Ze)*(1+yt),Xt=St-2*lt+et,Kt=-2*St+1+2*lt+gt,Zt=lt/Kt+(2*Xt*Xt*Xt/(Kt*Kt*Kt)-9*St*Xt/(Kt*Kt))/27,ir=(St-Xt*Xt/(3*Kt))/Kt,pr=2*E(-ir/3),br=S(3*Zt/(ir*pr))/3;return[b*(yt-1+E(1+2*(et-lt)+gt))/(2*Ue),c(Ze)*b*(-pr*t(br+b/3)-Xt/(3*Kt))]},Fo.invert=function(Ue,Ze){if(!Ue)return[0,l*h(2*e(Ze/b))];var et=x(Ue/b),lt=(1-et*et-(Ze/=b)*Ze)/(2*et),yt=E(lt*lt+1);return[c(Ue)*b*(yt-lt),c(Ze)*l*h(2*n(E((1-2*lt*et)*(lt+yt)-et),E(yt+lt+et)))]},Bo.invert=function(Ue,Ze){if(!Ze)return[Ue,0];var et=Ze/b,lt=(b*b*(1-et*et)-Ue*Ue)/(2*b*Ue);return[Ue?b*(c(Ue)*E(lt*lt+1)-lt):0,l*h(2*e(et))]},No.invert=function(Ue,Ze){var et;if(!Ue||!Ze)return[Ue,Ze];Ze/=b;var lt=c(Ue)*Ue/l,yt=(lt*lt-1+4*Ze*Ze)/x(lt),gt=yt*yt,St=2*Ze,Xt=50;do{var Kt=St*St,Zt=(8*St-Kt*(Kt+2)-5)/(2*Kt*(St-1)),ir=(3*St-Kt*St-10)/(2*Kt*St),pr=Zt*Zt,br=St*Zt,_r=St+Zt,Or=_r*_r,tn=St+3*Zt,fn=-2*_r*(4*br*pr+(1-4*Kt+3*Kt*Kt)*(1+ir)+pr*(14*Kt-6-gt+(8*Kt-8-2*gt)*ir)+br*(12*Kt-8+(10*Kt-10-gt)*ir)),En=E(Or*(Kt+pr*gt-1)+(1-Kt)*(Kt*(tn*tn+4*pr)+pr*(12*br+4*pr)));St-=et=(yt*(Or+pr-1)+2*En-lt*(4*Or+gt))/(yt*(2*Zt*ir+2*_r*(1+ir))+fn/En-8*_r*(yt*(-1+pr+Or)+2*En)*(1+ir)/(gt+4*Or))}while(et>o&&--Xt>0);return[c(Ue)*(E(yt*yt+4)+yt)*b/4,l*St]};var ls=4*b+3*E(3),lo=2*E(2*b*E(3)/ls),jo=re(lo*E(3)/b,lo,ls/6);function cs(Ue,Ze){return[Ue*E(1-3*Ze*Ze/(b*b)),Ze]}function So(Ue,Ze){var et=t(Ze),lt=t(Ue)*et,yt=1-lt,gt=t(Ue=n(h(Ue)*et,-h(Ze))),St=h(Ue);return[St*(et=E(1-lt*lt))-gt*yt,-gt*et-St*yt]}function qi(Ue,Ze){var et=V(Ue,Ze);return[(et[0]+Ue/l)/2,(et[1]+Ze)/2]}cs.invert=function(Ue,Ze){return[Ue/E(1-3*Ze*Ze/(b*b)),Ze]},So.invert=function(Ue,Ze){var et=(Ue*Ue+Ze*Ze)/-2,lt=E(-et*(2+et)),yt=Ze*et+Ue*lt,gt=Ue*et-Ze*lt,St=E(gt*gt+yt*yt);return[n(lt*yt,St*(1+et)),St?-P(lt*gt/St):0]},qi.invert=function(Ue,Ze){var et=Ue,lt=Ze,yt=25;do{var gt,St=t(lt),Xt=h(lt),Kt=h(2*lt),Zt=Xt*Xt,ir=St*St,pr=h(et),br=t(et/2),_r=h(et/2),Or=_r*_r,tn=1-ir*br*br,fn=tn?S(St*br)*E(gt=1/tn):gt=0,En=.5*(2*fn*St*_r+et/l)-Ue,On=.5*(fn*Xt+lt)-Ze,qn=.5*gt*(ir*Or+fn*St*br*Zt)+.5/l,Dn=gt*(pr*Kt/4-fn*Xt*_r),gi=.125*gt*(Kt*_r-fn*Xt*ir*pr),Ai=.5*gt*(Zt*br+fn*Or*St)+.5,Ni=Dn*gi-Ai*qn,Bi=(On*Dn-En*Ai)/Ni,ji=(En*gi-On*qn)/Ni;et-=Bi,lt-=ji}while((x(Bi)>o||x(ji)>o)&&--yt>0);return[et,lt]},g.geoNaturalEarth=v.geoNaturalEarth1,g.geoNaturalEarthRaw=v.geoNaturalEarth1Raw,g.geoAiry=function(){var Ue=l,Ze=v.geoProjectionMutator(q),et=Ze(Ue);return et.radius=function(lt){return arguments.length?Ze(Ue=lt*I):Ue*M},et.scale(179.976).clipAngle(147)},g.geoAiryRaw=q,g.geoAitoff=function(){return v.geoProjection(V).scale(152.63)},g.geoAitoffRaw=V,g.geoArmadillo=function(){var Ue=20*I,Ze=Ue>=0?1:-1,et=p(Ze*Ue),lt=v.geoProjectionMutator(W),yt=lt(Ue),gt=yt.stream;return yt.parallel=function(St){return arguments.length?(et=p((Ze=(Ue=St*I)>=0?1:-1)*Ue),lt(Ue)):Ue*M},yt.stream=function(St){var Xt=yt.rotate(),Kt=gt(St),Zt=(yt.rotate([0,0]),gt(St)),ir=yt.precision();return yt.rotate(Xt),Kt.sphere=function(){Zt.polygonStart(),Zt.lineStart();for(var pr=-180*Ze;Ze*pr<180;pr+=90*Ze)Zt.point(pr,90*Ze);if(Ue)for(;Ze*(pr-=3*Ze*ir)>=-180;)Zt.point(pr,Ze*-n(t(pr*I/2),et)*M);Zt.lineEnd(),Zt.polygonEnd()},Kt},yt.scale(218.695).center([0,28.0974])},g.geoArmadilloRaw=W,g.geoAugust=function(){return v.geoProjection(K).scale(66.1603)},g.geoAugustRaw=K,g.geoBaker=function(){return v.geoProjection($).scale(112.314)},g.geoBakerRaw=$,g.geoBerghaus=function(){var Ue=5,Ze=v.geoProjectionMutator(B),et=Ze(Ue),lt=et.stream,yt=-t(.01*I),gt=h(.01*I);return et.lobes=function(St){return arguments.length?Ze(Ue=+St):Ue},et.stream=function(St){var Xt=et.rotate(),Kt=lt(St),Zt=(et.rotate([0,0]),lt(St));return et.rotate(Xt),Kt.sphere=function(){Zt.polygonStart(),Zt.lineStart();for(var ir=0,pr=360/Ue,br=2*b/Ue,_r=90-180/Ue,Or=l;ir<Ue;++ir,_r-=pr,Or-=br)Zt.point(n(gt*t(Or),yt)*M,P(gt*h(Or))*M),_r<-90?(Zt.point(-90,-180-_r-.01),Zt.point(-90,-180-_r+.01)):(Zt.point(90,_r+.01),Zt.point(90,_r-.01));Zt.lineEnd(),Zt.polygonEnd()},Kt},et.scale(87.8076).center([0,17.1875]).clipAngle(179.999)},g.geoBerghausRaw=B,g.geoBertin1953=function(){return v.geoProjection(J()).rotate([-16.5,-42]).scale(176.57).center([7.93,.09])},g.geoBertin1953Raw=J,g.geoBoggs=function(){return v.geoProjection(de).scale(160.857)},g.geoBoggsRaw=de,g.geoBonne=function(){return se(_e).scale(123.082).center([0,26.1441]).parallel(45)},g.geoBonneRaw=_e,g.geoBottomley=function(){var Ue=.5,Ze=v.geoProjectionMutator(Te),et=Ze(Ue);return et.fraction=function(lt){return arguments.length?Ze(Ue=+lt):Ue},et.scale(158.837)},g.geoBottomleyRaw=Te,g.geoBromley=function(){return v.geoProjection(we).scale(152.63)},g.geoBromleyRaw=we,g.geoChamberlin=Pe,g.geoChamberlinRaw=Ae,g.geoChamberlinAfrica=function(){return Pe([0,22],[45,22],[22.5,-22]).scale(380).center([22.5,2])},g.geoCollignon=function(){return v.geoProjection(Ne).scale(95.6464).center([0,30])},g.geoCollignonRaw=Ne,g.geoCraig=function(){return se(De).scale(249.828).clipAngle(90)},g.geoCraigRaw=De,g.geoCraster=function(){return v.geoProjection(Me).scale(156.19)},g.geoCrasterRaw=Me,g.geoCylindricalEqualArea=function(){return se(Se).parallel(38.58).scale(195.044)},g.geoCylindricalEqualAreaRaw=Se,g.geoCylindricalStereographic=function(){return se(Ie).scale(124.75)},g.geoCylindricalStereographicRaw=Ie,g.geoEckert1=function(){return v.geoProjection(Fe).scale(165.664)},g.geoEckert1Raw=Fe,g.geoEckert2=function(){return v.geoProjection(Re).scale(165.664)},g.geoEckert2Raw=Re,g.geoEckert3=function(){return v.geoProjection(Xe).scale(180.739)},g.geoEckert3Raw=Xe,g.geoEckert4=function(){return v.geoProjection(nt).scale(180.739)},g.geoEckert4Raw=nt,g.geoEckert5=function(){return v.geoProjection(ct).scale(173.044)},g.geoEckert5Raw=ct,g.geoEckert6=function(){return v.geoProjection(xt).scale(173.044)},g.geoEckert6Raw=xt,g.geoEisenlohr=function(){return v.geoProjection(tt).scale(62.5271)},g.geoEisenlohrRaw=tt,g.geoFahey=function(){return v.geoProjection(mt).scale(137.152)},g.geoFaheyRaw=mt,g.geoFoucaut=function(){return v.geoProjection(Bt).scale(135.264)},g.geoFoucautRaw=Bt,g.geoFoucautSinusoidal=function(){var Ue=.5,Ze=v.geoProjectionMutator(Ut),et=Ze(Ue);return et.alpha=function(lt){return arguments.length?Ze(Ue=+lt):Ue},et.scale(168.725)},g.geoFoucautSinusoidalRaw=Ut,g.geoGilbert=function(Ue){null==Ue&&(Ue=v.geoOrthographic);var Ze=Ue(),et=v.geoEquirectangular().scale(M).precision(0).clipAngle(null).translate([0,0]);function lt(gt){return Ze(er(gt))}function yt(gt){lt[gt]=function(){return arguments.length?(Ze[gt].apply(Ze,arguments),lt):Ze[gt]()}}return Ze.invert&&(lt.invert=function(gt){return Wt(Ze.invert(gt))}),lt.stream=function(gt){var St=Ze.stream(gt),Xt=et.stream({point:function(Kt,Zt){St.point(Kt/2,P(p(-Zt/2*I))*M)},lineStart:function(){St.lineStart()},lineEnd:function(){St.lineEnd()},polygonStart:function(){St.polygonStart()},polygonEnd:function(){St.polygonEnd()}});return Xt.sphere=St.sphere,Xt},lt.rotate=function(gt){return arguments.length?(et.rotate(gt),lt):et.rotate()},lt.center=function(gt){return arguments.length?(Ze.center(er(gt)),lt):Wt(Ze.center())},yt("angle"),yt("clipAngle"),yt("clipExtent"),yt("fitExtent"),yt("fitHeight"),yt("fitSize"),yt("fitWidth"),yt("scale"),yt("translate"),yt("precision"),lt.scale(249.5)},g.geoGingery=function(){var Ue=6,Ze=30*I,et=t(Ze),lt=h(Ze),yt=v.geoProjectionMutator(rr),gt=yt(Ze,Ue),St=gt.stream,Xt=-t(.01*I),Kt=h(.01*I);return gt.radius=function(Zt){return arguments.length?(et=t(Ze=Zt*I),lt=h(Ze),yt(Ze,Ue)):Ze*M},gt.lobes=function(Zt){return arguments.length?yt(Ze,Ue=+Zt):Ue},gt.stream=function(Zt){var ir=gt.rotate(),pr=St(Zt),br=(gt.rotate([0,0]),St(Zt));return gt.rotate(ir),pr.sphere=function(){br.polygonStart(),br.lineStart();for(var _r=0,Or=2*b/Ue,tn=0;_r<Ue;++_r,tn-=Or)br.point(n(Kt*t(tn),Xt)*M,P(Kt*h(tn))*M),br.point(n(lt*t(tn-Or/2),et)*M,P(lt*h(tn-Or/2))*M);br.lineEnd(),br.polygonEnd()},pr},gt.rotate([90,-40]).scale(91.7095).clipAngle(179.999)},g.geoGingeryRaw=rr,g.geoGinzburg4=function(){return v.geoProjection(he).scale(149.995)},g.geoGinzburg4Raw=he,g.geoGinzburg5=function(){return v.geoProjection(ye).scale(153.93)},g.geoGinzburg5Raw=ye,g.geoGinzburg6=function(){return v.geoProjection(Be).scale(130.945)},g.geoGinzburg6Raw=Be,g.geoGinzburg8=function(){return v.geoProjection(Ge).scale(131.747)},g.geoGinzburg8Raw=Ge,g.geoGinzburg9=function(){return v.geoProjection(Je).scale(131.087)},g.geoGinzburg9Raw=Je,g.geoGringorten=function(){return v.geoProjection(He(st)).scale(239.75)},g.geoGringortenRaw=st,g.geoGuyou=function(){return v.geoProjection(He(Ct)).scale(151.496)},g.geoGuyouRaw=Ct,g.geoHammer=function(){var Ue=2,Ze=v.geoProjectionMutator(N),et=Ze(Ue);return et.coefficient=function(lt){return arguments.length?Ze(Ue=+lt):Ue},et.scale(169.529)},g.geoHammerRaw=N,g.geoHammerRetroazimuthal=function(){var Ue=0,Ze=v.geoProjectionMutator(rt),et=Ze(Ue),lt=et.rotate,yt=et.stream,gt=v.geoCircle();return et.parallel=function(St){if(!arguments.length)return Ue*M;var Xt=et.rotate();return Ze(Ue=St*I).rotate(Xt)},et.rotate=function(St){return arguments.length?(lt.call(et,[St[0],St[1]-Ue*M]),gt.center([-St[0],-St[1]]),et):((St=lt.call(et))[1]+=Ue*M,St)},et.stream=function(St){return(St=yt(St)).sphere=function(){St.polygonStart();var Xt,Kt=gt.radius(89.99)().coordinates[0],Zt=Kt.length-1,ir=-1;for(St.lineStart();++ir<Zt;)St.point((Xt=Kt[ir])[0],Xt[1]);for(St.lineEnd(),Zt=(Kt=gt.radius(90.01)().coordinates[0]).length-1,St.lineStart();--ir>=0;)St.point((Xt=Kt[ir])[0],Xt[1]);St.lineEnd(),St.polygonEnd()},St},et.scale(79.4187).parallel(45).clipAngle(179.999)},g.geoHammerRetroazimuthalRaw=rt,g.geoHealpix=function(){var Ue=4,Ze=v.geoProjectionMutator(Lt),et=Ze(Ue),lt=et.stream;return et.lobes=function(yt){return arguments.length?Ze(Ue=+yt):Ue},et.stream=function(yt){var gt=et.rotate(),St=lt(yt),Xt=(et.rotate([0,0]),lt(yt));return et.rotate(gt),St.sphere=function(){var Kt,Zt;v.geoStream((Zt=[].concat(m.range(-180,180+(Kt=180/Ue)/2,Kt).map(Ee),m.range(180,-180-Kt/2,-Kt).map(Ye)),{type:"Polygon",coordinates:[180===Kt?Zt.map(it):Zt]}),Xt)},St},et.scale(239.75)},g.geoHealpixRaw=Lt,g.geoHill=function(){var Ue=1,Ze=v.geoProjectionMutator(ht),et=Ze(Ue);return et.ratio=function(lt){return arguments.length?Ze(Ue=+lt):Ue},et.scale(167.774).center([0,18.67])},g.geoHillRaw=ht,g.geoHomolosine=function(){return v.geoProjection(Ft).scale(152.63)},g.geoHomolosineRaw=Ft,g.geoHufnagel=function(){var Ue=1,Ze=0,et=45*I,lt=2,yt=v.geoProjectionMutator(Gt),gt=yt(Ue,Ze,et,lt);return gt.a=function(St){return arguments.length?yt(Ue=+St,Ze,et,lt):Ue},gt.b=function(St){return arguments.length?yt(Ue,Ze=+St,et,lt):Ze},gt.psiMax=function(St){return arguments.length?yt(Ue,Ze,et=+St*I,lt):et*M},gt.ratio=function(St){return arguments.length?yt(Ue,Ze,et,lt=+St):lt},gt.scale(180.739)},g.geoHufnagelRaw=Gt,g.geoHyperelliptical=function(){var Ue=0,Ze=2.5,et=1.183136,lt=v.geoProjectionMutator(fr),yt=lt(Ue,Ze,et);return yt.alpha=function(gt){return arguments.length?lt(Ue=+gt,Ze,et):Ue},yt.k=function(gt){return arguments.length?lt(Ue,Ze=+gt,et):Ze},yt.gamma=function(gt){return arguments.length?lt(Ue,Ze,et=+gt):et},yt.scale(152.63)},g.geoHyperellipticalRaw=fr,g.geoInterrupt=$t,g.geoInterruptedBoggs=function(){return $t(de,Qt).scale(160.857)},g.geoInterruptedHomolosine=function(){return $t(Ft,cr).scale(152.63)},g.geoInterruptedMollweide=function(){return $t(ne,gr).scale(169.529)},g.geoInterruptedMollweideHemispheres=function(){return $t(ne,Tr).scale(169.529).rotate([20,0])},g.geoInterruptedSinuMollweide=function(){return $t(At,Fr,j).rotate([-20,-55]).scale(164.263).center([0,-5.4036])},g.geoInterruptedSinusoidal=function(){return $t(ge,Nr).scale(152.63).rotate([-20,0])},g.geoKavrayskiy7=function(){return v.geoProjection(Xr).scale(158.837)},g.geoKavrayskiy7Raw=Xr,g.geoLagrange=function(){var Ue=.5,Ze=v.geoProjectionMutator(un),et=Ze(Ue);return et.spacing=function(lt){return arguments.length?Ze(Ue=+lt):Ue},et.scale(124.75)},g.geoLagrangeRaw=un,g.geoLarrivee=function(){return v.geoProjection(Pn).scale(97.2672)},g.geoLarriveeRaw=Pn,g.geoLaskowski=function(){return v.geoProjection(gn).scale(139.98)},g.geoLaskowskiRaw=gn,g.geoLittrow=function(){return v.geoProjection(dn).scale(144.049).clipAngle(89.999)},g.geoLittrowRaw=dn,g.geoLoximuthal=function(){return se(An).parallel(40).scale(158.837)},g.geoLoximuthalRaw=An,g.geoMiller=function(){return v.geoProjection(Zn).scale(108.318)},g.geoMillerRaw=Zn,g.geoModifiedStereographic=vn,g.geoModifiedStereographicRaw=Rr,g.geoModifiedStereographicAlaska=function(){return vn(hn,[152,-64]).scale(1400).center([-160.908,62.4864]).clipAngle(30).angle(7.8)},g.geoModifiedStereographicGs48=function(){return vn(nn,[95,-38]).scale(1e3).clipAngle(55).center([-96.5563,38.8675])},g.geoModifiedStereographicGs50=function(){return vn(Hr,[120,-45]).scale(359.513).clipAngle(55).center([-117.474,53.0628])},g.geoModifiedStereographicMiller=function(){return vn(Fn,[-20,-18]).scale(209.091).center([20,16.7214]).clipAngle(82)},g.geoModifiedStereographicLee=function(){return vn(Un,[165,10]).scale(250).clipAngle(130).center([-165,-10])},g.geoMollweide=function(){return v.geoProjection(ne).scale(169.529)},g.geoMollweideRaw=ne,g.geoMtFlatPolarParabolic=function(){return v.geoProjection(tr).scale(164.859)},g.geoMtFlatPolarParabolicRaw=tr,g.geoMtFlatPolarQuartic=function(){return v.geoProjection(mr).scale(188.209)},g.geoMtFlatPolarQuarticRaw=mr,g.geoMtFlatPolarSinusoidal=function(){return v.geoProjection(Pt).scale(166.518)},g.geoMtFlatPolarSinusoidalRaw=Pt,g.geoNaturalEarth2=function(){return v.geoProjection(or).scale(175.295)},g.geoNaturalEarth2Raw=or,g.geoNellHammer=function(){return v.geoProjection(hr).scale(152.63)},g.geoNellHammerRaw=hr,g.geoInterruptedQuarticAuthalic=function(){return $t(N(1/0),zr).rotate([20,0]).scale(152.63)},g.geoNicolosi=function(){return v.geoProjection(Dr).scale(127.267)},g.geoNicolosiRaw=Dr,g.geoPatterson=function(){return v.geoProjection(Ir).scale(139.319)},g.geoPattersonRaw=Ir,g.geoPolyconic=function(){return v.geoProjection(Mr).scale(103.74)},g.geoPolyconicRaw=Mr,g.geoPolyhedral=qr,g.geoPolyhedralButterfly=function(Ue){Ue=Ue||function(et){var lt=v.geoCentroid({type:"MultiPoint",coordinates:et});return v.geoGnomonic().scale(1).translate([0,0]).rotate([-lt[0],-lt[1]])};var Ze=mn.map(function(et){return{face:et,project:Ue(et)}});return[-1,0,0,1,0,1,4,5].forEach(function(et,lt){var yt=Ze[et];yt&&(yt.children||(yt.children=[])).push(Ze[lt])}),qr(Ze[0],function(et,lt){return Ze[et<-b/2?lt<0?6:4:et<0?lt<0?2:0:et<b/2?lt<0?3:1:lt<0?7:5]}).angle(-30).scale(101.858).center([0,45])},g.geoPolyhedralCollignon=function(Ue){Ue=Ue||function(et){var lt=v.geoCentroid({type:"MultiPoint",coordinates:et});return v.geoProjection(bn).translate([0,0]).scale(1).rotate(lt[1]>0?[-lt[0],0]:[180-lt[0],180])};var Ze=mn.map(function(et){return{face:et,project:Ue(et)}});return[-1,0,0,1,0,1,4,5].forEach(function(et,lt){var yt=Ze[et];yt&&(yt.children||(yt.children=[])).push(Ze[lt])}),qr(Ze[0],function(et,lt){return Ze[et<-b/2?lt<0?6:4:et<0?lt<0?2:0:et<b/2?lt<0?3:1:lt<0?7:5]}).angle(-30).scale(121.906).center([0,48.5904])},g.geoPolyhedralWaterman=function(Ue){Ue=Ue||function(gt){var St=6===gt.length?v.geoCentroid({type:"MultiPoint",coordinates:gt}):gt[0];return v.geoGnomonic().scale(1).translate([0,0]).rotate([-St[0],-St[1]])};var Ze=mn.map(function(gt){for(var St,Xt=gt.map(Yn),Kt=Xt.length,Zt=Xt[Kt-1],ir=[],pr=0;pr<Kt;++pr)ir.push(In([.9486832980505138*Zt[0]+.31622776601683794*(St=Xt[pr])[0],.9486832980505138*Zt[1]+.31622776601683794*St[1],.9486832980505138*Zt[2]+.31622776601683794*St[2]]),In([.9486832980505138*St[0]+.31622776601683794*Zt[0],.9486832980505138*St[1]+.31622776601683794*Zt[1],.9486832980505138*St[2]+.31622776601683794*Zt[2]])),Zt=St;return ir}),et=[],lt=[-1,0,0,1,0,1,4,5];Ze.forEach(function(gt,St){for(var Xt,Kt,Zt=mn[St],ir=Zt.length,pr=et[St]=[],br=0;br<ir;++br)Ze.push([Zt[br],gt[(2*br+2)%(2*ir)],gt[(2*br+1)%(2*ir)]]),lt.push(St),pr.push((Xt=Yn(gt[(2*br+2)%(2*ir)]),Kt=Yn(gt[(2*br+1)%(2*ir)]),[Xt[1]*Kt[2]-Xt[2]*Kt[1],Xt[2]*Kt[0]-Xt[0]*Kt[2],Xt[0]*Kt[1]-Xt[1]*Kt[0]]))});var yt=Ze.map(function(gt){return{project:Ue(gt),face:gt}});return lt.forEach(function(gt,St){var Xt=yt[gt];Xt&&(Xt.children||(Xt.children=[])).push(yt[St])}),qr(yt[0],function(gt,St){var Xt=t(St),Kt=[Xt*t(gt),Xt*h(gt),h(St)],Zt=gt<-b/2?St<0?6:4:gt<0?St<0?2:0:gt<b/2?St<0?3:1:St<0?7:5,ir=et[Zt];return yt[Sn(ir[0],Kt)<0?8+3*Zt:Sn(ir[1],Kt)<0?8+3*Zt+1:Sn(ir[2],Kt)<0?8+3*Zt+2:Zt]}).angle(-30).scale(110.625).center([0,45])},g.geoProject=function(Ue,Ze){var et,lt=Ze.stream;if(!lt)throw new Error("invalid projection");switch(Ue&&Ue.type){case"Feature":et=kn;break;case"FeatureCollection":et=Ti;break;default:et=Qn}return et(Ue,lt)},g.geoGringortenQuincuncial=function(){return Gi(st).scale(176.423)},g.geoPeirceQuincuncial=Zi,g.geoPierceQuincuncial=Zi,g.geoQuantize=function(Ue,Ze){if(!(0<=(Ze=+Ze)&&Ze<=20))throw new Error("invalid digits");function et(Zt){var ir=Zt.length,pr=2,br=new Array(ir);for(br[0]=+Zt[0].toFixed(Ze),br[1]=+Zt[1].toFixed(Ze);pr<ir;)br[pr]=Zt[pr],++pr;return br}function lt(Zt){return Zt.map(et)}function yt(Zt){for(var ir=et(Zt[0]),pr=[ir],br=1;br<Zt.length;br++){var _r=et(Zt[br]);(_r.length>2||_r[0]!=ir[0]||_r[1]!=ir[1])&&(pr.push(_r),ir=_r)}return 1===pr.length&&Zt.length>1&&pr.push(et(Zt[Zt.length-1])),pr}function gt(Zt){return Zt.map(yt)}function St(Zt){if(null==Zt)return Zt;var ir;switch(Zt.type){case"GeometryCollection":ir={type:"GeometryCollection",geometries:Zt.geometries.map(St)};break;case"Point":ir={type:"Point",coordinates:et(Zt.coordinates)};break;case"MultiPoint":ir={type:Zt.type,coordinates:lt(Zt.coordinates)};break;case"LineString":ir={type:Zt.type,coordinates:yt(Zt.coordinates)};break;case"MultiLineString":case"Polygon":ir={type:Zt.type,coordinates:gt(Zt.coordinates)};break;case"MultiPolygon":ir={type:"MultiPolygon",coordinates:Zt.coordinates.map(gt)};break;default:return Zt}return null!=Zt.bbox&&(ir.bbox=Zt.bbox),ir}function Xt(Zt){var ir={type:"Feature",properties:Zt.properties,geometry:St(Zt.geometry)};return null!=Zt.id&&(ir.id=Zt.id),null!=Zt.bbox&&(ir.bbox=Zt.bbox),ir}if(null!=Ue)switch(Ue.type){case"Feature":return Xt(Ue);case"FeatureCollection":var Kt={type:"FeatureCollection",features:Ue.features.map(Xt)};return null!=Ue.bbox&&(Kt.bbox=Ue.bbox),Kt;default:return St(Ue)}return Ue},g.geoQuincuncial=Gi,g.geoRectangularPolyconic=function(){return se(Ya).scale(131.215)},g.geoRectangularPolyconicRaw=Ya,g.geoRobinson=function(){return v.geoProjection(so).scale(152.63)},g.geoRobinsonRaw=so,g.geoSatellite=function(){var Ue=2,Ze=0,et=v.geoProjectionMutator(fo),lt=et(Ue,Ze);return lt.distance=function(yt){return arguments.length?et(Ue=+yt,Ze):Ue},lt.tilt=function(yt){return arguments.length?et(Ue,Ze=yt*I):Ze*M},lt.scale(432.147).clipAngle(S(1/Ue)*M-1e-6)},g.geoSatelliteRaw=fo,g.geoSinuMollweide=function(){return v.geoProjection(At).rotate([-20,-55]).scale(164.263).center([0,-5.4036])},g.geoSinuMollweideRaw=At,g.geoSinusoidal=function(){return v.geoProjection(ge).scale(152.63)},g.geoSinusoidalRaw=ge,g.geoStitch=function(Ue){if(null==Ue)return Ue;switch(Ue.type){case"Feature":return Yi(Ue);case"FeatureCollection":var Ze={type:"FeatureCollection",features:Ue.features.map(Yi)};return null!=Ue.bbox&&(Ze.bbox=Ue.bbox),Ze;default:return ss(Ue)}},g.geoTimes=function(){return v.geoProjection(Wo).scale(146.153)},g.geoTimesRaw=Wo,g.geoTwoPointAzimuthal=ds,g.geoTwoPointAzimuthalRaw=xs,g.geoTwoPointAzimuthalUsa=function(){return ds([-158,21.5],[-77,39]).clipAngle(60).scale(400)},g.geoTwoPointEquidistant=Ao,g.geoTwoPointEquidistantRaw=bs,g.geoTwoPointEquidistantUsa=function(){return Ao([-158,21.5],[-77,39]).clipAngle(130).scale(122.571)},g.geoVanDerGrinten=function(){return v.geoProjection(Mo).scale(79.4183)},g.geoVanDerGrintenRaw=Mo,g.geoVanDerGrinten2=function(){return v.geoProjection(Fo).scale(79.4183)},g.geoVanDerGrinten2Raw=Fo,g.geoVanDerGrinten3=function(){return v.geoProjection(Bo).scale(79.4183)},g.geoVanDerGrinten3Raw=Bo,g.geoVanDerGrinten4=function(){return v.geoProjection(No).scale(127.16)},g.geoVanDerGrinten4Raw=No,g.geoWagner=po,g.geoWagner7=function(){return po().poleline(65).parallels(60).inflation(0).ratio(200).scale(172.633)},g.geoWagnerRaw=Xo,g.geoWagner4=function(){return v.geoProjection(jo).scale(176.84)},g.geoWagner4Raw=jo,g.geoWagner6=function(){return v.geoProjection(cs).scale(152.63)},g.geoWagner6Raw=cs,g.geoWiechel=function(){return v.geoProjection(So).rotate([0,-90,45]).scale(124.75).clipAngle(179.999)},g.geoWiechelRaw=So,g.geoWinkel3=function(){return v.geoProjection(qi).scale(158.837)},g.geoWinkel3Raw=qi,Object.defineProperty(g,"__esModule",{value:!0})},"object"==typeof Q&&void 0!==ee?v(Q,y("d3-geo"),y("d3-array")):v(g.d3=g.d3||{},g.d3,g.d3)},{"d3-array":107,"d3-geo":114}],114:[function(y,ee,Q){var g,v;g=this,v=function(g,v){"use strict";function m(){return new x}function x(){this.reset()}x.prototype={constructor:x,reset:function(){this.s=this.t=0},add:function(pt){n(e,pt,this.t),n(this,e.s,this.s),this.s?this.t+=e.t:this.s=e.t},valueOf:function(){return this.s}};var e=new x;function n(pt,Ot,sr){var Vt=pt.s=Ot+sr,lr=Vt-Ot;pt.t=Ot-(Vt-lr)+(sr-lr)}var t=1e-6,a=Math.PI,r=a/2,d=a/4,s=2*a,i=180/a,u=a/180,f=Math.abs,c=Math.atan,h=Math.atan2,p=Math.cos,o=Math.ceil,b=Math.exp,l=Math.log,T=Math.pow,_=Math.sin,w=Math.sign||function(pt){return pt>0?1:pt<0?-1:0},k=Math.sqrt,L=Math.tan;function M(pt){return pt>1?0:pt<-1?a:Math.acos(pt)}function I(pt){return pt>1?r:pt<-1?-r:Math.asin(pt)}function P(pt){return(pt=_(pt/2))*pt}function S(){}function E(pt,Ot){pt&&R.hasOwnProperty(pt.type)&&R[pt.type](pt,Ot)}var z={Feature:function(pt,Ot){E(pt.geometry,Ot)},FeatureCollection:function(pt,Ot){for(var sr=pt.features,Vt=-1,lr=sr.length;++Vt<lr;)E(sr[Vt].geometry,Ot)}},R={Sphere:function(pt,Ot){Ot.sphere()},Point:function(pt,Ot){Ot.point((pt=pt.coordinates)[0],pt[1],pt[2])},MultiPoint:function(pt,Ot){for(var sr=pt.coordinates,Vt=-1,lr=sr.length;++Vt<lr;)Ot.point((pt=sr[Vt])[0],pt[1],pt[2])},LineString:function(pt,Ot){q(pt.coordinates,Ot,0)},MultiLineString:function(pt,Ot){for(var sr=pt.coordinates,Vt=-1,lr=sr.length;++Vt<lr;)q(sr[Vt],Ot,0)},Polygon:function(pt,Ot){V(pt.coordinates,Ot)},MultiPolygon:function(pt,Ot){for(var sr=pt.coordinates,Vt=-1,lr=sr.length;++Vt<lr;)V(sr[Vt],Ot)},GeometryCollection:function(pt,Ot){for(var sr=pt.geometries,Vt=-1,lr=sr.length;++Vt<lr;)E(sr[Vt],Ot)}};function q(pt,Ot,sr){var Vt,lr=-1,Pr=pt.length-sr;for(Ot.lineStart();++lr<Pr;)Ot.point((Vt=pt[lr])[0],Vt[1],Vt[2]);Ot.lineEnd()}function V(pt,Ot){var sr=-1,Vt=pt.length;for(Ot.polygonStart();++sr<Vt;)q(pt[sr],Ot,1);Ot.polygonEnd()}function W(pt,Ot){pt&&z.hasOwnProperty(pt.type)?z[pt.type](pt,Ot):E(pt,Ot)}var K,G,Y,$,B,N=m(),U=m(),te={point:S,lineStart:S,lineEnd:S,polygonStart:function(){N.reset(),te.lineStart=j,te.lineEnd=J},polygonEnd:function(){var pt=+N;U.add(pt<0?s+pt:pt),this.lineStart=this.lineEnd=this.point=S},sphere:function(){U.add(s)}};function j(){te.point=X}function J(){re(K,G)}function X(pt,Ot){te.point=re,K=pt,G=Ot,Y=pt*=u,$=p(Ot=(Ot*=u)/2+d),B=_(Ot)}function re(pt,Ot){var sr=(pt*=u)-Y,Vt=sr>=0?1:-1,lr=Vt*sr,Pr=p(Ot=(Ot*=u)/2+d),Br=_(Ot),Yr=B*Br,on=$*Pr+Yr*p(lr),rn=Yr*Vt*_(lr);N.add(h(rn,on)),Y=pt,$=Pr,B=Br}function ne(pt){return[h(pt[1],pt[0]),I(pt[2])]}function le(pt){var Ot=pt[0],sr=pt[1],Vt=p(sr);return[Vt*p(Ot),Vt*_(Ot),_(sr)]}function oe(pt,Ot){return pt[0]*Ot[0]+pt[1]*Ot[1]+pt[2]*Ot[2]}function de(pt,Ot){return[pt[1]*Ot[2]-pt[2]*Ot[1],pt[2]*Ot[0]-pt[0]*Ot[2],pt[0]*Ot[1]-pt[1]*Ot[0]]}function se(pt,Ot){pt[0]+=Ot[0],pt[1]+=Ot[1],pt[2]+=Ot[2]}function ge(pt,Ot){return[pt[0]*Ot,pt[1]*Ot,pt[2]*Ot]}function _e(pt){var Ot=k(pt[0]*pt[0]+pt[1]*pt[1]+pt[2]*pt[2]);pt[0]/=Ot,pt[1]/=Ot,pt[2]/=Ot}var Te,we,Oe,fe,ve,Ae,ke,Pe,Ne,De,ze,Me,Se,Ie,Fe,Re,Xe,nt,ct,xt,dt,tt,Ke,mt,Bt,Ut,er=m(),Wt={point:rr,lineStart:Ve,lineEnd:We,polygonStart:function(){Wt.point=he,Wt.lineStart=ye,Wt.lineEnd=Be,er.reset(),te.polygonStart()},polygonEnd:function(){te.polygonEnd(),Wt.point=rr,Wt.lineStart=Ve,Wt.lineEnd=We,N<0?(Te=-(Oe=180),we=-(fe=90)):er>t?fe=90:er<-t&&(we=-90),De[0]=Te,De[1]=Oe},sphere:function(){Te=-(Oe=180),we=-(fe=90)}};function rr(pt,Ot){Ne.push(De=[Te=pt,Oe=pt]),Ot<we&&(we=Ot),Ot>fe&&(fe=Ot)}function Ht(pt,Ot){var sr=le([pt*u,Ot*u]);if(Pe){var Vt=de(Pe,sr),lr=de([Vt[1],-Vt[0],0],Vt);_e(lr),lr=ne(lr);var Pr,Br=pt-ve,Yr=Br>0?1:-1,on=lr[0]*i*Yr,rn=f(Br)>180;rn^(Yr*ve<on&&on<Yr*pt)?(Pr=lr[1]*i)>fe&&(fe=Pr):rn^(Yr*ve<(on=(on+360)%360-180)&&on<Yr*pt)?(Pr=-lr[1]*i)<we&&(we=Pr):(Ot<we&&(we=Ot),Ot>fe&&(fe=Ot)),rn?pt<ve?Ge(Te,pt)>Ge(Te,Oe)&&(Oe=pt):Ge(pt,Oe)>Ge(Te,Oe)&&(Te=pt):Oe>=Te?(pt<Te&&(Te=pt),pt>Oe&&(Oe=pt)):pt>ve?Ge(Te,pt)>Ge(Te,Oe)&&(Oe=pt):Ge(pt,Oe)>Ge(Te,Oe)&&(Te=pt)}else Ne.push(De=[Te=pt,Oe=pt]);Ot<we&&(we=Ot),Ot>fe&&(fe=Ot),Pe=sr,ve=pt}function Ve(){Wt.point=Ht}function We(){De[0]=Te,De[1]=Oe,Wt.point=rr,Pe=null}function he(pt,Ot){if(Pe){var sr=pt-ve;er.add(f(sr)>180?sr+(sr>0?360:-360):sr)}else Ae=pt,ke=Ot;te.point(pt,Ot),Ht(pt,Ot)}function ye(){te.lineStart()}function Be(){he(Ae,ke),te.lineEnd(),f(er)>t&&(Te=-(Oe=180)),De[0]=Te,De[1]=Oe,Pe=null}function Ge(pt,Ot){return(Ot-=pt)<0?Ot+360:Ot}function Je(pt,Ot){return pt[0]-Ot[0]}function He(pt,Ot){return pt[0]<=pt[1]?pt[0]<=Ot&&Ot<=pt[1]:Ot<pt[0]||pt[1]<Ot}var st={sphere:S,point:ot,lineStart:Ct,lineEnd:Rt,polygonStart:function(){st.lineStart=kt,st.lineEnd=Lt},polygonEnd:function(){st.lineStart=Ct,st.lineEnd=Rt}};function ot(pt,Ot){pt*=u;var sr=p(Ot*=u);wt(sr*p(pt),sr*_(pt),_(Ot))}function wt(pt,Ot,sr){++ze,Se+=(pt-Se)/ze,Ie+=(Ot-Ie)/ze,Fe+=(sr-Fe)/ze}function Ct(){st.point=rt}function rt(pt,Ot){pt*=u;var sr=p(Ot*=u);mt=sr*p(pt),Bt=sr*_(pt),Ut=_(Ot),st.point=ft,wt(mt,Bt,Ut)}function ft(pt,Ot){pt*=u;var sr=p(Ot*=u),Vt=sr*p(pt),lr=sr*_(pt),Pr=_(Ot),Br=h(k((Br=Bt*Pr-Ut*lr)*Br+(Br=Ut*Vt-mt*Pr)*Br+(Br=mt*lr-Bt*Vt)*Br),mt*Vt+Bt*lr+Ut*Pr);Me+=Br,Re+=Br*(mt+(mt=Vt)),Xe+=Br*(Bt+(Bt=lr)),nt+=Br*(Ut+(Ut=Pr)),wt(mt,Bt,Ut)}function Rt(){st.point=ot}function kt(){st.point=Ee}function Lt(){Ye(tt,Ke),st.point=ot}function Ee(pt,Ot){tt=pt,Ke=Ot,pt*=u,Ot*=u,st.point=Ye;var sr=p(Ot);mt=sr*p(pt),Bt=sr*_(pt),Ut=_(Ot),wt(mt,Bt,Ut)}function Ye(pt,Ot){pt*=u;var sr=p(Ot*=u),Vt=sr*p(pt),lr=sr*_(pt),Pr=_(Ot),Br=Bt*Pr-Ut*lr,Yr=Ut*Vt-mt*Pr,on=mt*lr-Bt*Vt,rn=k(Br*Br+Yr*Yr+on*on),pn=I(rn),_n=rn&&-pn/rn;ct+=_n*Br,xt+=_n*Yr,dt+=_n*on,Me+=pn,Re+=pn*(mt+(mt=Vt)),Xe+=pn*(Bt+(Bt=lr)),nt+=pn*(Ut+(Ut=Pr)),wt(mt,Bt,Ut)}function it(pt){return function(){return pt}}function ht(pt,Ot){function sr(Vt,lr){return Vt=pt(Vt,lr),Ot(Vt[0],Vt[1])}return pt.invert&&Ot.invert&&(sr.invert=function(Vt,lr){return(Vt=Ot.invert(Vt,lr))&&pt.invert(Vt[0],Vt[1])}),sr}function At(pt,Ot){return[f(pt)>a?pt+Math.round(-pt/s)*s:pt,Ot]}function Ft(pt,Ot,sr){return(pt%=s)?Ot||sr?ht(jt(pt),fr(Ot,sr)):jt(pt):Ot||sr?fr(Ot,sr):At}function Gt(pt){return function(Ot,sr){return[(Ot+=pt)>a?Ot-s:Ot<-a?Ot+s:Ot,sr]}}function jt(pt){var Ot=Gt(pt);return Ot.invert=Gt(-pt),Ot}function fr(pt,Ot){var sr=p(pt),Vt=_(pt),lr=p(Ot),Pr=_(Ot);function Br(Yr,on){var rn=p(on),pn=p(Yr)*rn,_n=_(Yr)*rn,sn=_(on),wn=sn*sr+pn*Vt;return[h(_n*lr-wn*Pr,pn*sr-sn*Vt),I(wn*lr+_n*Pr)]}return Br.invert=function(Yr,on){var rn=p(on),pn=p(Yr)*rn,_n=_(Yr)*rn,sn=_(on),wn=sn*lr-_n*Pr;return[h(_n*lr+sn*Pr,pn*sr+wn*Vt),I(wn*sr-pn*Vt)]},Br}function kr(pt){function Ot(sr){return(sr=pt(sr[0]*u,sr[1]*u))[0]*=i,sr[1]*=i,sr}return pt=Ft(pt[0]*u,pt[1]*u,pt.length>2?pt[2]*u:0),Ot.invert=function(sr){return(sr=pt.invert(sr[0]*u,sr[1]*u))[0]*=i,sr[1]*=i,sr},Ot}function ur(pt,Ot,sr,Vt,lr,Pr){if(sr){var Br=p(Ot),Yr=_(Ot),on=Vt*sr;null==lr?(lr=Ot+Vt*s,Pr=Ot-on/2):(lr=Jt(Br,lr),Pr=Jt(Br,Pr),(Vt>0?lr<Pr:lr>Pr)&&(lr+=Vt*s));for(var rn,pn=lr;Vt>0?pn>Pr:pn<Pr;pn-=on)rn=ne([Br,-Yr*p(pn),-Yr*_(pn)]),pt.point(rn[0],rn[1])}}function Jt(pt,Ot){(Ot=le(Ot))[0]-=pt,_e(Ot);var sr=M(-Ot[1]);return((-Ot[2]<0?-sr:sr)+s-t)%s}function $t(){var pt,Ot=[];return{point:function(sr,Vt,lr){pt.push([sr,Vt,lr])},lineStart:function(){Ot.push(pt=[])},lineEnd:S,rejoin:function(){Ot.length>1&&Ot.push(Ot.pop().concat(Ot.shift()))},result:function(){var sr=Ot;return Ot=[],pt=null,sr}}}function Qt(pt,Ot){return f(pt[0]-Ot[0])<t&&f(pt[1]-Ot[1])<t}function cr(pt,Ot,sr,Vt){this.x=pt,this.z=Ot,this.o=sr,this.e=Vt,this.v=!1,this.n=this.p=null}function gr(pt,Ot,sr,Vt,lr){var Pr,Br,Yr=[],on=[];if(pt.forEach(function(zn){if(!((Vn=zn.length-1)<=0)){var Vn,ii,Wr=zn[0],ti=zn[Vn];if(Qt(Wr,ti)){if(!Wr[2]&&!ti[2]){for(lr.lineStart(),Pr=0;Pr<Vn;++Pr)lr.point((Wr=zn[Pr])[0],Wr[1]);return void lr.lineEnd()}ti[0]+=2*t}Yr.push(ii=new cr(Wr,zn,null,!0)),on.push(ii.o=new cr(Wr,null,ii,!1)),Yr.push(ii=new cr(ti,zn,null,!1)),on.push(ii.o=new cr(ti,null,ii,!0))}}),Yr.length){for(on.sort(Ot),Tr(Yr),Tr(on),Pr=0,Br=on.length;Pr<Br;++Pr)on[Pr].e=sr=!sr;for(var rn,pn,_n=Yr[0];;){for(var sn=_n,wn=!0;sn.v;)if((sn=sn.n)===_n)return;rn=sn.z,lr.lineStart();do{if(sn.v=sn.o.v=!0,sn.e){if(wn)for(Pr=0,Br=rn.length;Pr<Br;++Pr)lr.point((pn=rn[Pr])[0],pn[1]);else Vt(sn.x,sn.n.x,1,lr);sn=sn.n}else{if(wn)for(Pr=(rn=sn.p.z).length-1;Pr>=0;--Pr)lr.point((pn=rn[Pr])[0],pn[1]);else Vt(sn.x,sn.p.x,-1,lr);sn=sn.p}rn=(sn=sn.o).z,wn=!wn}while(!sn.v);lr.lineEnd()}}}function Tr(pt){if(Ot=pt.length){for(var Ot,sr,Vt=0,lr=pt[0];++Vt<Ot;)lr.n=sr=pt[Vt],sr.p=lr,lr=sr;lr.n=sr=pt[0],sr.p=lr}}At.invert=At;var Fr=m();function Nr(pt){return f(pt[0])<=a?pt[0]:w(pt[0])*((f(pt[0])+a)%s-a)}function Xr(pt,Ot){var sr=Nr(Ot),Vt=Ot[1],lr=_(Vt),Pr=[_(sr),-p(sr),0],Br=0,Yr=0;Fr.reset(),1===lr?Vt=r+t:-1===lr&&(Vt=-r-t);for(var on=0,rn=pt.length;on<rn;++on)if(_n=(pn=pt[on]).length)for(var pn,_n,sn=pn[_n-1],wn=Nr(sn),zn=sn[1]/2+d,Vn=_(zn),ii=p(zn),Wr=0;Wr<_n;++Wr,wn=Ln,Vn=ei,ii=wi,sn=ti){var ti=pn[Wr],Ln=Nr(ti),Nn=ti[1]/2+d,ei=_(Nn),wi=p(Nn),Li=Ln-wn,Mn=Li>=0?1:-1,Di=Mn*Li,Ei=Di>a,di=Vn*ei;if(Fr.add(h(di*Mn*_(Di),ii*wi+di*p(Di))),Br+=Ei?Li+Mn*s:Li,Ei^wn>=sr^Ln>=sr){var zi=de(le(sn),le(ti));_e(zi);var Mi=de(Pr,zi);_e(Mi);var $i=(Ei^Li>=0?-1:1)*I(Mi[2]);(Vt>$i||Vt===$i&&(zi[0]||zi[1]))&&(Yr+=Ei^Li>=0?1:-1)}}return(Br<-t||Br<t&&Fr<-t)^1&Yr}function un(pt,Ot,sr,Vt){return function(lr){var Pr,Br,Yr,on=Ot(lr),rn=$t(),pn=Ot(rn),_n=!1,sn={point:wn,lineStart:Vn,lineEnd:ii,polygonStart:function(){sn.point=Wr,sn.lineStart=ti,sn.lineEnd=Ln,Br=[],Pr=[]},polygonEnd:function(){sn.point=wn,sn.lineStart=Vn,sn.lineEnd=ii,Br=v.merge(Br);var Nn=Xr(Pr,Vt);Br.length?(_n||(lr.polygonStart(),_n=!0),gr(Br,Pn,Nn,sr,lr)):Nn&&(_n||(lr.polygonStart(),_n=!0),lr.lineStart(),sr(null,null,1,lr),lr.lineEnd()),_n&&(lr.polygonEnd(),_n=!1),Br=Pr=null},sphere:function(){lr.polygonStart(),lr.lineStart(),sr(null,null,1,lr),lr.lineEnd(),lr.polygonEnd()}};function wn(Nn,ei){pt(Nn,ei)&&lr.point(Nn,ei)}function zn(Nn,ei){on.point(Nn,ei)}function Vn(){sn.point=zn,on.lineStart()}function ii(){sn.point=wn,on.lineEnd()}function Wr(Nn,ei){Yr.push([Nn,ei]),pn.point(Nn,ei)}function ti(){pn.lineStart(),Yr=[]}function Ln(){Wr(Yr[0][0],Yr[0][1]),pn.lineEnd();var Nn,ei,wi,Li,Mn=pn.clean(),Di=rn.result(),Ei=Di.length;if(Yr.pop(),Pr.push(Yr),Yr=null,Ei)if(1&Mn){if((ei=(wi=Di[0]).length-1)>0){for(_n||(lr.polygonStart(),_n=!0),lr.lineStart(),Nn=0;Nn<ei;++Nn)lr.point((Li=wi[Nn])[0],Li[1]);lr.lineEnd()}}else Ei>1&&2&Mn&&Di.push(Di.pop().concat(Di.shift())),Br.push(Di.filter($r))}return sn}}function $r(pt){return pt.length>1}function Pn(pt,Ot){return((pt=pt.x)[0]<0?pt[1]-r-t:r-pt[1])-((Ot=Ot.x)[0]<0?Ot[1]-r-t:r-Ot[1])}var gn=un(function(){return!0},function(pt){var Ot,sr=NaN,Vt=NaN,lr=NaN;return{lineStart:function(){pt.lineStart(),Ot=1},point:function(Pr,Br){var rn,pn,_n,sn,wn,zn,Vn,Yr=Pr>0?a:-a,on=f(Pr-sr);f(on-a)<t?(pt.point(sr,Vt=(Vt+Br)/2>0?r:-r),pt.point(lr,Vt),pt.lineEnd(),pt.lineStart(),pt.point(Yr,Vt),pt.point(Pr,Vt),Ot=0):lr!==Yr&&on>=a&&(f(sr-lr)<t&&(sr-=lr*t),f(Pr-Yr)<t&&(Pr-=Yr*t),pn=Vt,sn=Br,Vn=_((rn=sr)-(_n=Pr)),Vt=f(Vn)>t?c((_(pn)*(zn=p(sn))*_(_n)-_(sn)*(wn=p(pn))*_(rn))/(wn*zn*Vn)):(pn+sn)/2,pt.point(lr,Vt),pt.lineEnd(),pt.lineStart(),pt.point(Yr,Vt),Ot=0),pt.point(sr=Pr,Vt=Br),lr=Yr},lineEnd:function(){pt.lineEnd(),sr=Vt=NaN},clean:function(){return 2-Ot}}},function(pt,Ot,sr,Vt){var lr;if(null==pt)Vt.point(-a,lr=sr*r),Vt.point(0,lr),Vt.point(a,lr),Vt.point(a,0),Vt.point(a,-lr),Vt.point(0,-lr),Vt.point(-a,-lr),Vt.point(-a,0),Vt.point(-a,lr);else if(f(pt[0]-Ot[0])>t){var Pr=pt[0]<Ot[0]?a:-a;Vt.point(-Pr,lr=sr*Pr/2),Vt.point(0,lr),Vt.point(Pr,lr)}else Vt.point(Ot[0],Ot[1])},[-a,-r]);function dn(pt){var Ot=p(pt),sr=6*u,Vt=Ot>0,lr=f(Ot)>t;function Pr(on,rn){return p(on)*p(rn)>Ot}function Br(on,rn,pn){var _n=[1,0,0],sn=de(le(on),le(rn)),wn=oe(sn,sn),zn=sn[0],Vn=wn-zn*zn;if(!Vn)return!pn&&on;var ii=Ot*wn/Vn,Wr=-Ot*zn/Vn,ti=de(_n,sn),Ln=ge(_n,ii);se(Ln,ge(sn,Wr));var Nn=ti,ei=oe(Ln,Nn),wi=oe(Nn,Nn),Li=ei*ei-wi*(oe(Ln,Ln)-1);if(!(Li<0)){var Mn=k(Li),Di=ge(Nn,(-ei-Mn)/wi);if(se(Di,Ln),Di=ne(Di),!pn)return Di;var Ei,di=on[0],zi=rn[0],Mi=on[1],$i=rn[1];zi<di&&(Ei=di,di=zi,zi=Ei);var ri=zi-di,Wi=f(ri-a)<t;if(!Wi&&$i<Mi&&(Ei=Mi,Mi=$i,$i=Ei),Wi||ri<t?Wi?Mi+$i>0^Di[1]<(f(Di[0]-di)<t?Mi:$i):Mi<=Di[1]&&Di[1]<=$i:ri>a^(di<=Di[0]&&Di[0]<=zi)){var Ba=ge(Nn,(-ei+Mn)/wi);return se(Ba,Ln),[Di,ne(Ba)]}}}function Yr(on,rn){var pn=Vt?pt:a-pt,_n=0;return on<-pn?_n|=1:on>pn&&(_n|=2),rn<-pn?_n|=4:rn>pn&&(_n|=8),_n}return un(Pr,function(on){var rn,pn,_n,sn,wn;return{lineStart:function(){sn=_n=!1,wn=1},point:function(zn,Vn){var ii,Wr=[zn,Vn],ti=Pr(zn,Vn),Ln=Vt?ti?0:Yr(zn,Vn):ti?Yr(zn+(zn<0?a:-a),Vn):0;if(!rn&&(sn=_n=ti)&&on.lineStart(),ti!==_n&&(!(ii=Br(rn,Wr))||Qt(rn,ii)||Qt(Wr,ii))&&(Wr[2]=1),ti!==_n)wn=0,ti?(on.lineStart(),ii=Br(Wr,rn),on.point(ii[0],ii[1])):(ii=Br(rn,Wr),on.point(ii[0],ii[1],2),on.lineEnd()),rn=ii;else if(lr&&rn&&Vt^ti){var Nn;Ln&pn||!(Nn=Br(Wr,rn,!0))||(wn=0,Vt?(on.lineStart(),on.point(Nn[0][0],Nn[0][1]),on.point(Nn[1][0],Nn[1][1]),on.lineEnd()):(on.point(Nn[1][0],Nn[1][1]),on.lineEnd(),on.lineStart(),on.point(Nn[0][0],Nn[0][1],3)))}!ti||rn&&Qt(rn,Wr)||on.point(Wr[0],Wr[1]),rn=Wr,_n=ti,pn=Ln},lineEnd:function(){_n&&on.lineEnd(),rn=null},clean:function(){return wn|(sn&&_n)<<1}}},function(on,rn,pn,_n){ur(_n,pt,sr,pn,on,rn)},Vt?[0,-pt]:[-a,pt-a])}function An(pt,Ot,sr,Vt){function lr(rn,pn){return pt<=rn&&rn<=sr&&Ot<=pn&&pn<=Vt}function Pr(rn,pn,_n,sn){var wn=0,zn=0;if(null==rn||(wn=Br(rn,_n))!==(zn=Br(pn,_n))||on(rn,pn)<0^_n>0)do{sn.point(0===wn||3===wn?pt:sr,wn>1?Vt:Ot)}while((wn=(wn+_n+4)%4)!==zn);else sn.point(pn[0],pn[1])}function Br(rn,pn){return f(rn[0]-pt)<t?pn>0?0:3:f(rn[0]-sr)<t?pn>0?2:1:f(rn[1]-Ot)<t?pn>0?1:0:pn>0?3:2}function Yr(rn,pn){return on(rn.x,pn.x)}function on(rn,pn){var _n=Br(rn,1),sn=Br(pn,1);return _n!==sn?_n-sn:0===_n?pn[1]-rn[1]:1===_n?rn[0]-pn[0]:2===_n?rn[1]-pn[1]:pn[0]-rn[0]}return function(rn){var pn,_n,sn,wn,zn,Vn,ii,Wr,ti,Ln,Nn,ei=rn,wi=$t(),Li={point:Mn,lineStart:function(){Li.point=Di,_n&&_n.push(sn=[]),Ln=!0,ti=!1,ii=Wr=NaN},lineEnd:function(){pn&&(Di(wn,zn),Vn&&ti&&wi.rejoin(),pn.push(wi.result())),Li.point=Mn,ti&&ei.lineEnd()},polygonStart:function(){ei=wi,pn=[],_n=[],Nn=!0},polygonEnd:function(){var Ei=function(){for(var Mi=0,$i=0,ri=_n.length;$i<ri;++$i)for(var Wi,Ba,Ho=_n[$i],Io=1,go=Ho.length,vi=Ho[0],da=vi[0],mo=vi[1];Io<go;++Io)Wi=da,Ba=mo,da=(vi=Ho[Io])[0],mo=vi[1],Ba<=Vt?mo>Vt&&(da-Wi)*(Vt-Ba)>(mo-Ba)*(pt-Wi)&&++Mi:mo<=Vt&&(da-Wi)*(Vt-Ba)<(mo-Ba)*(pt-Wi)&&--Mi;return Mi}(),di=Nn&&Ei,zi=(pn=v.merge(pn)).length;(di||zi)&&(rn.polygonStart(),di&&(rn.lineStart(),Pr(null,null,1,rn),rn.lineEnd()),zi&&gr(pn,Yr,Ei,Pr,rn),rn.polygonEnd()),ei=rn,pn=_n=sn=null}};function Mn(Ei,di){lr(Ei,di)&&ei.point(Ei,di)}function Di(Ei,di){var zi=lr(Ei,di);if(_n&&sn.push([Ei,di]),Ln)wn=Ei,zn=di,Vn=zi,Ln=!1,zi&&(ei.lineStart(),ei.point(Ei,di));else if(zi&&ti)ei.point(Ei,di);else{var Mi=[ii=Math.max(-1e9,Math.min(1e9,ii)),Wr=Math.max(-1e9,Math.min(1e9,Wr))],$i=[Ei=Math.max(-1e9,Math.min(1e9,Ei)),di=Math.max(-1e9,Math.min(1e9,di))];!function(ri,Wi,Ba,Ho,Io,go){var vi,da=ri[0],mo=ri[1],Xi=0,wa=1,Va=Wi[0]-da,ta=Wi[1]-mo;if(vi=Ba-da,Va||!(vi>0)){if(vi/=Va,Va<0){if(vi<Xi)return;vi<wa&&(wa=vi)}else if(Va>0){if(vi>wa)return;vi>Xi&&(Xi=vi)}if(vi=Io-da,Va||!(vi<0)){if(vi/=Va,Va<0){if(vi>wa)return;vi>Xi&&(Xi=vi)}else if(Va>0){if(vi<Xi)return;vi<wa&&(wa=vi)}if(vi=Ho-mo,ta||!(vi>0)){if(vi/=ta,ta<0){if(vi<Xi)return;vi<wa&&(wa=vi)}else if(ta>0){if(vi>wa)return;vi>Xi&&(Xi=vi)}if(vi=go-mo,ta||!(vi<0)){if(vi/=ta,ta<0){if(vi>wa)return;vi>Xi&&(Xi=vi)}else if(ta>0){if(vi<Xi)return;vi<wa&&(wa=vi)}return Xi>0&&(ri[0]=da+Xi*Va,ri[1]=mo+Xi*ta),wa<1&&(Wi[0]=da+wa*Va,Wi[1]=mo+wa*ta),!0}}}}}(Mi,$i,pt,Ot,sr,Vt)?zi&&(ei.lineStart(),ei.point(Ei,di),Nn=!1):(ti||(ei.lineStart(),ei.point(Mi[0],Mi[1])),ei.point($i[0],$i[1]),zi||ei.lineEnd(),Nn=!1)}ii=Ei,Wr=di,ti=zi}return Li}}var Zn,Rr,hn,nn=m(),Hr={sphere:S,point:S,lineStart:function(){Hr.point=Un,Hr.lineEnd=Fn},lineEnd:S,polygonStart:S,polygonEnd:S};function Fn(){Hr.point=Hr.lineEnd=S}function Un(pt,Ot){Zn=pt*=u,Rr=_(Ot*=u),hn=p(Ot),Hr.point=vn}function vn(pt,Ot){pt*=u;var sr=_(Ot*=u),Vt=p(Ot),lr=f(pt-Zn),Pr=p(lr),Br=Vt*_(lr),Yr=hn*sr-Rr*Vt*Pr,on=Rr*sr+hn*Vt*Pr;nn.add(h(k(Br*Br+Yr*Yr),on)),Zn=pt,Rr=sr,hn=Vt}function Cn(pt){return nn.reset(),W(pt,Hr),+nn}var li=[null,null],tr={type:"LineString",coordinates:li};function mr(pt,Ot){return li[0]=pt,li[1]=Ot,Cn(tr)}var Pt={Feature:function(pt,Ot){return hr(pt.geometry,Ot)},FeatureCollection:function(pt,Ot){for(var sr=pt.features,Vt=-1,lr=sr.length;++Vt<lr;)if(hr(sr[Vt].geometry,Ot))return!0;return!1}},or={Sphere:function(){return!0},Point:function(pt,Ot){return zr(pt.coordinates,Ot)},MultiPoint:function(pt,Ot){for(var sr=pt.coordinates,Vt=-1,lr=sr.length;++Vt<lr;)if(zr(sr[Vt],Ot))return!0;return!1},LineString:function(pt,Ot){return Dr(pt.coordinates,Ot)},MultiLineString:function(pt,Ot){for(var sr=pt.coordinates,Vt=-1,lr=sr.length;++Vt<lr;)if(Dr(sr[Vt],Ot))return!0;return!1},Polygon:function(pt,Ot){return Ir(pt.coordinates,Ot)},MultiPolygon:function(pt,Ot){for(var sr=pt.coordinates,Vt=-1,lr=sr.length;++Vt<lr;)if(Ir(sr[Vt],Ot))return!0;return!1},GeometryCollection:function(pt,Ot){for(var sr=pt.geometries,Vt=-1,lr=sr.length;++Vt<lr;)if(hr(sr[Vt],Ot))return!0;return!1}};function hr(pt,Ot){return!(!pt||!or.hasOwnProperty(pt.type))&&or[pt.type](pt,Ot)}function zr(pt,Ot){return 0===mr(pt,Ot)}function Dr(pt,Ot){for(var sr,Vt,lr,Pr=0,Br=pt.length;Pr<Br;Pr++){if(0===(Vt=mr(pt[Pr],Ot))||Pr>0&&(lr=mr(pt[Pr],pt[Pr-1]))>0&&sr<=lr&&Vt<=lr&&(sr+Vt-lr)*(1-Math.pow((sr-Vt)/lr,2))<1e-12*lr)return!0;sr=Vt}return!1}function Ir(pt,Ot){return!!Xr(pt.map(Mr),vr(Ot))}function Mr(pt){return(pt=pt.map(vr)).pop(),pt}function vr(pt){return[pt[0]*u,pt[1]*u]}function xr(pt,Ot,sr){var Vt=v.range(pt,Ot-t,sr).concat(Ot);return function(lr){return Vt.map(function(Pr){return[lr,Pr]})}}function wr(pt,Ot,sr){var Vt=v.range(pt,Ot-t,sr).concat(Ot);return function(lr){return Vt.map(function(Pr){return[Pr,lr]})}}function Er(){var pt,Ot,sr,Vt,lr,Pr,Br,Yr,on,rn,pn,_n,sn=10,wn=sn,zn=90,Vn=360,ii=2.5;function Wr(){return{type:"MultiLineString",coordinates:ti()}}function ti(){return v.range(o(Vt/zn)*zn,sr,zn).map(pn).concat(v.range(o(Yr/Vn)*Vn,Br,Vn).map(_n)).concat(v.range(o(Ot/sn)*sn,pt,sn).filter(function(Ln){return f(Ln%zn)>t}).map(on)).concat(v.range(o(Pr/wn)*wn,lr,wn).filter(function(Ln){return f(Ln%Vn)>t}).map(rn))}return Wr.lines=function(){return ti().map(function(Ln){return{type:"LineString",coordinates:Ln}})},Wr.outline=function(){return{type:"Polygon",coordinates:[pn(Vt).concat(_n(Br).slice(1),pn(sr).reverse().slice(1),_n(Yr).reverse().slice(1))]}},Wr.extent=function(Ln){return arguments.length?Wr.extentMajor(Ln).extentMinor(Ln):Wr.extentMinor()},Wr.extentMajor=function(Ln){return arguments.length?(Yr=+Ln[0][1],Br=+Ln[1][1],(Vt=+Ln[0][0])>(sr=+Ln[1][0])&&(Ln=Vt,Vt=sr,sr=Ln),Yr>Br&&(Ln=Yr,Yr=Br,Br=Ln),Wr.precision(ii)):[[Vt,Yr],[sr,Br]]},Wr.extentMinor=function(Ln){return arguments.length?(Pr=+Ln[0][1],lr=+Ln[1][1],(Ot=+Ln[0][0])>(pt=+Ln[1][0])&&(Ln=Ot,Ot=pt,pt=Ln),Pr>lr&&(Ln=Pr,Pr=lr,lr=Ln),Wr.precision(ii)):[[Ot,Pr],[pt,lr]]},Wr.step=function(Ln){return arguments.length?Wr.stepMajor(Ln).stepMinor(Ln):Wr.stepMinor()},Wr.stepMajor=function(Ln){return arguments.length?(zn=+Ln[0],Vn=+Ln[1],Wr):[zn,Vn]},Wr.stepMinor=function(Ln){return arguments.length?(sn=+Ln[0],wn=+Ln[1],Wr):[sn,wn]},Wr.precision=function(Ln){return arguments.length?(ii=+Ln,on=xr(Pr,lr,90),rn=wr(Ot,pt,ii),pn=xr(Yr,Br,90),_n=wr(Vt,sr,ii),Wr):ii},Wr.extentMajor([[-180,-90+t],[180,90-t]]).extentMinor([[-180,-80-t],[180,80+t]])}function qr(pt){return pt}var Vr,Qr,en,mn,xn=m(),bn=m(),Sn={point:S,lineStart:S,lineEnd:S,polygonStart:function(){Sn.lineStart=In,Sn.lineEnd=Ti},polygonEnd:function(){Sn.lineStart=Sn.lineEnd=Sn.point=S,xn.add(f(bn)),bn.reset()},result:function(){var pt=xn/2;return xn.reset(),pt}};function In(){Sn.point=Yn}function Yn(pt,Ot){Sn.point=ki,Vr=en=pt,Qr=mn=Ot}function ki(pt,Ot){bn.add(mn*pt-en*Ot),en=pt,mn=Ot}function Ti(){ki(Vr,Qr)}var Ia,oo,Gi,Zi,kn=1/0,Qn=kn,Jn=-kn,Ii=Jn,ha={point:function(pt,Ot){pt<kn&&(kn=pt),pt>Jn&&(Jn=pt),Ot<Qn&&(Qn=Ot),Ot>Ii&&(Ii=Ot)},lineStart:S,lineEnd:S,polygonStart:S,polygonEnd:S,result:function(){var pt=[[kn,Qn],[Jn,Ii]];return Jn=Ii=-(Qn=kn=1/0),pt}},Ya=0,Fi=0,so=0,fo=0,ba=0,Wa=0,ho=0,wo=0,Ra=0,pa={point:Ga,lineStart:ps,lineEnd:ss,polygonStart:function(){pa.lineStart=Wo,pa.lineEnd=ys},polygonEnd:function(){pa.point=Ga,pa.lineStart=ps,pa.lineEnd=ss},result:function(){var pt=Ra?[ho/Ra,wo/Ra]:Wa?[fo/Wa,ba/Wa]:so?[Ya/so,Fi/so]:[NaN,NaN];return Ya=Fi=so=fo=ba=Wa=ho=wo=Ra=0,pt}};function Ga(pt,Ot){Ya+=pt,Fi+=Ot,++so}function ps(){pa.point=vs}function vs(pt,Ot){pa.point=Yi,Ga(Gi=pt,Zi=Ot)}function Yi(pt,Ot){var sr=pt-Gi,Vt=Ot-Zi,lr=k(sr*sr+Vt*Vt);fo+=lr*(Gi+pt)/2,ba+=lr*(Zi+Ot)/2,Wa+=lr,Ga(Gi=pt,Zi=Ot)}function ss(){pa.point=Ga}function Wo(){pa.point=xs}function ys(){ds(Ia,oo)}function xs(pt,Ot){pa.point=ds,Ga(Ia=Gi=pt,oo=Zi=Ot)}function ds(pt,Ot){var sr=pt-Gi,Vt=Ot-Zi,lr=k(sr*sr+Vt*Vt);fo+=lr*(Gi+pt)/2,ba+=lr*(Zi+Ot)/2,Wa+=lr,ho+=(lr=Zi*pt-Gi*Ot)*(Gi+pt),wo+=lr*(Zi+Ot),Ra+=3*lr,Ga(Gi=pt,Zi=Ot)}function bs(pt){this._context=pt}bs.prototype={_radius:4.5,pointRadius:function(pt){return this._radius=pt,this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){0===this._line&&this._context.closePath(),this._point=NaN},point:function(pt,Ot){switch(this._point){case 0:this._context.moveTo(pt,Ot),this._point=1;break;case 1:this._context.lineTo(pt,Ot);break;default:this._context.moveTo(pt+this._radius,Ot),this._context.arc(pt,Ot,this._radius,0,s)}},result:S};var Ao,Mo,Fo,Bo,No,Xo=m(),po={point:S,lineStart:function(){po.point=ls},lineEnd:function(){Ao&&lo(Mo,Fo),po.point=S},polygonStart:function(){Ao=!0},polygonEnd:function(){Ao=null},result:function(){var pt=+Xo;return Xo.reset(),pt}};function ls(pt,Ot){po.point=lo,Mo=Bo=pt,Fo=No=Ot}function lo(pt,Ot){Xo.add(k((Bo-=pt)*Bo+(No-=Ot)*No)),Bo=pt,No=Ot}function jo(){this._string=[]}function cs(pt){return"m0,"+pt+"a"+pt+","+pt+" 0 1,1 0,"+-2*pt+"a"+pt+","+pt+" 0 1,1 0,"+2*pt+"z"}function So(pt){return function(Ot){var sr=new qi;for(var Vt in pt)sr[Vt]=pt[Vt];return sr.stream=Ot,sr}}function qi(){}function Ue(pt,Ot,sr){var Vt=pt.clipExtent&&pt.clipExtent();return pt.scale(150).translate([0,0]),null!=Vt&&pt.clipExtent(null),W(sr,pt.stream(ha)),Ot(ha.result()),null!=Vt&&pt.clipExtent(Vt),pt}function Ze(pt,Ot,sr){return Ue(pt,function(Vt){var lr=Ot[1][0]-Ot[0][0],Pr=Ot[1][1]-Ot[0][1],Br=Math.min(lr/(Vt[1][0]-Vt[0][0]),Pr/(Vt[1][1]-Vt[0][1])),Yr=+Ot[0][0]+(lr-Br*(Vt[1][0]+Vt[0][0]))/2,on=+Ot[0][1]+(Pr-Br*(Vt[1][1]+Vt[0][1]))/2;pt.scale(150*Br).translate([Yr,on])},sr)}function et(pt,Ot,sr){return Ze(pt,[[0,0],Ot],sr)}function lt(pt,Ot,sr){return Ue(pt,function(Vt){var lr=+Ot,Pr=lr/(Vt[1][0]-Vt[0][0]),Br=(lr-Pr*(Vt[1][0]+Vt[0][0]))/2,Yr=-Pr*Vt[0][1];pt.scale(150*Pr).translate([Br,Yr])},sr)}function yt(pt,Ot,sr){return Ue(pt,function(Vt){var lr=+Ot,Pr=lr/(Vt[1][1]-Vt[0][1]),Br=-Pr*Vt[0][0],Yr=(lr-Pr*(Vt[1][1]+Vt[0][1]))/2;pt.scale(150*Pr).translate([Br,Yr])},sr)}jo.prototype={_radius:4.5,_circle:cs(4.5),pointRadius:function(pt){return(pt=+pt)!==this._radius&&(this._radius=pt,this._circle=null),this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){0===this._line&&this._string.push("Z"),this._point=NaN},point:function(pt,Ot){switch(this._point){case 0:this._string.push("M",pt,",",Ot),this._point=1;break;case 1:this._string.push("L",pt,",",Ot);break;default:null==this._circle&&(this._circle=cs(this._radius)),this._string.push("M",pt,",",Ot,this._circle)}},result:function(){if(this._string.length){var pt=this._string.join("");return this._string=[],pt}return null}},qi.prototype={constructor:qi,point:function(pt,Ot){this.stream.point(pt,Ot)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}};var gt=p(30*u);function St(pt,Ot){return+Ot?function(sr,Vt){function lr(Pr,Br,Yr,on,rn,pn,_n,sn,wn,zn,Vn,ii,Wr,ti){var Ln=_n-Pr,Nn=sn-Br,ei=Ln*Ln+Nn*Nn;if(ei>4*Vt&&Wr--){var wi=on+zn,Li=rn+Vn,Mn=pn+ii,Di=k(wi*wi+Li*Li+Mn*Mn),Ei=I(Mn/=Di),di=f(f(Mn)-1)<t||f(Yr-wn)<t?(Yr+wn)/2:h(Li,wi),zi=sr(di,Ei),Mi=zi[0],$i=zi[1],ri=Mi-Pr,Wi=$i-Br,Ba=Nn*ri-Ln*Wi;(Ba*Ba/ei>Vt||f((Ln*ri+Nn*Wi)/ei-.5)>.3||on*zn+rn*Vn+pn*ii<gt)&&(lr(Pr,Br,Yr,on,rn,pn,Mi,$i,di,wi/=Di,Li/=Di,Mn,Wr,ti),ti.point(Mi,$i),lr(Mi,$i,di,wi,Li,Mn,_n,sn,wn,zn,Vn,ii,Wr,ti))}}return function(Pr){var Br,Yr,on,rn,pn,_n,sn,wn,zn,Vn,ii,Wr,ti={point:Ln,lineStart:Nn,lineEnd:wi,polygonStart:function(){Pr.polygonStart(),ti.lineStart=Li},polygonEnd:function(){Pr.polygonEnd(),ti.lineStart=Nn}};function Ln(Ei,di){Ei=sr(Ei,di),Pr.point(Ei[0],Ei[1])}function Nn(){wn=NaN,ti.point=ei,Pr.lineStart()}function ei(Ei,di){var zi=le([Ei,di]),Mi=sr(Ei,di);lr(wn,zn,sn,Vn,ii,Wr,wn=Mi[0],zn=Mi[1],sn=Ei,Vn=zi[0],ii=zi[1],Wr=zi[2],16,Pr),Pr.point(wn,zn)}function wi(){ti.point=Ln,Pr.lineEnd()}function Li(){Nn(),ti.point=Mn,ti.lineEnd=Di}function Mn(Ei,di){ei(Br=Ei,di),Yr=wn,on=zn,rn=Vn,pn=ii,_n=Wr,ti.point=ei}function Di(){lr(wn,zn,sn,Vn,ii,Wr,Yr,on,Br,rn,pn,_n,16,Pr),ti.lineEnd=wi,wi()}return ti}}(pt,Ot):(sr=pt,So({point:function(Vt,lr){Vt=sr(Vt,lr),this.stream.point(Vt[0],Vt[1])}}));var sr}var Xt=So({point:function(pt,Ot){this.stream.point(pt*u,Ot*u)}});function Kt(pt,Ot,sr,Vt,lr){function Pr(Br,Yr){return[Ot+pt*(Br*=Vt),sr-pt*(Yr*=lr)]}return Pr.invert=function(Br,Yr){return[(Br-Ot)/pt*Vt,(sr-Yr)/pt*lr]},Pr}function Zt(pt,Ot,sr,Vt,lr,Pr){var Br=p(Pr),Yr=_(Pr),on=Br*pt,rn=Yr*pt,pn=Br/pt,_n=Yr/pt,sn=(Yr*sr-Br*Ot)/pt,wn=(Yr*Ot+Br*sr)/pt;function zn(Vn,ii){return[on*(Vn*=Vt)-rn*(ii*=lr)+Ot,sr-rn*Vn-on*ii]}return zn.invert=function(Vn,ii){return[Vt*(pn*Vn-_n*ii+sn),lr*(wn-_n*Vn-pn*ii)]},zn}function ir(pt){return pr(function(){return pt})()}function pr(pt){var Ot,sr,Vt,lr,Pr,Br,Yr,on,rn,pn,_n=150,sn=480,wn=250,zn=0,Vn=0,ii=0,Wr=0,ti=0,Ln=0,Nn=1,ei=1,wi=null,Li=gn,Mn=null,Di=qr,Ei=.5;function di(ri){return on(ri[0]*u,ri[1]*u)}function zi(ri){return(ri=on.invert(ri[0],ri[1]))&&[ri[0]*i,ri[1]*i]}function Mi(){var ri=Zt(_n,0,0,Nn,ei,Ln).apply(null,Ot(zn,Vn)),Wi=(Ln?Zt:Kt)(_n,sn-ri[0],wn-ri[1],Nn,ei,Ln);return sr=Ft(ii,Wr,ti),Yr=ht(Ot,Wi),on=ht(sr,Yr),Br=St(Yr,Ei),$i()}function $i(){return rn=pn=null,di}return di.stream=function(ri){return rn&&pn===ri?rn:rn=Xt((Wi=sr,So({point:function(Ba,Ho){var Io=Wi(Ba,Ho);return this.stream.point(Io[0],Io[1])}}))(Li(Br(Di(pn=ri)))));var Wi},di.preclip=function(ri){return arguments.length?(Li=ri,wi=void 0,$i()):Li},di.postclip=function(ri){return arguments.length?(Di=ri,Mn=Vt=lr=Pr=null,$i()):Di},di.clipAngle=function(ri){return arguments.length?(Li=+ri?dn(wi=ri*u):(wi=null,gn),$i()):wi*i},di.clipExtent=function(ri){return arguments.length?(Di=null==ri?(Mn=Vt=lr=Pr=null,qr):An(Mn=+ri[0][0],Vt=+ri[0][1],lr=+ri[1][0],Pr=+ri[1][1]),$i()):null==Mn?null:[[Mn,Vt],[lr,Pr]]},di.scale=function(ri){return arguments.length?(_n=+ri,Mi()):_n},di.translate=function(ri){return arguments.length?(sn=+ri[0],wn=+ri[1],Mi()):[sn,wn]},di.center=function(ri){return arguments.length?(zn=ri[0]%360*u,Vn=ri[1]%360*u,Mi()):[zn*i,Vn*i]},di.rotate=function(ri){return arguments.length?(ii=ri[0]%360*u,Wr=ri[1]%360*u,ti=ri.length>2?ri[2]%360*u:0,Mi()):[ii*i,Wr*i,ti*i]},di.angle=function(ri){return arguments.length?(Ln=ri%360*u,Mi()):Ln*i},di.reflectX=function(ri){return arguments.length?(Nn=ri?-1:1,Mi()):Nn<0},di.reflectY=function(ri){return arguments.length?(ei=ri?-1:1,Mi()):ei<0},di.precision=function(ri){return arguments.length?(Br=St(Yr,Ei=ri*ri),$i()):k(Ei)},di.fitExtent=function(ri,Wi){return Ze(di,ri,Wi)},di.fitSize=function(ri,Wi){return et(di,ri,Wi)},di.fitWidth=function(ri,Wi){return lt(di,ri,Wi)},di.fitHeight=function(ri,Wi){return yt(di,ri,Wi)},function(){return Ot=pt.apply(this,arguments),di.invert=Ot.invert&&zi,Mi()}}function br(pt){var Ot=0,sr=a/3,Vt=pr(pt),lr=Vt(Ot,sr);return lr.parallels=function(Pr){return arguments.length?Vt(Ot=Pr[0]*u,sr=Pr[1]*u):[Ot*i,sr*i]},lr}function _r(pt,Ot){var sr=_(pt),Vt=(sr+_(Ot))/2;if(f(Vt)<t)return function(Yr){var on=p(Yr);function rn(pn,_n){return[pn*on,_(_n)/on]}return rn.invert=function(pn,_n){return[pn/on,I(_n*on)]},rn}(pt);var lr=1+sr*(2*Vt-sr),Pr=k(lr)/Vt;function Br(Yr,on){var rn=k(lr-2*Vt*_(on))/Vt;return[rn*_(Yr*=Vt),Pr-rn*p(Yr)]}return Br.invert=function(Yr,on){var rn=Pr-on,pn=h(Yr,f(rn))*w(rn);return rn*Vt<0&&(pn-=a*w(Yr)*w(rn)),[pn/Vt,I((lr-(Yr*Yr+rn*rn)*Vt*Vt)/(2*Vt))]},Br}function Or(){return br(_r).scale(155.424).center([0,33.6442])}function tn(){return Or().parallels([29.5,45.5]).scale(1070).translate([480,250]).rotate([96,0]).center([-.6,38.7])}function fn(pt){return function(Ot,sr){var Vt=p(Ot),lr=p(sr),Pr=pt(Vt*lr);return[Pr*lr*_(Ot),Pr*_(sr)]}}function En(pt){return function(Ot,sr){var Vt=k(Ot*Ot+sr*sr),lr=pt(Vt),Pr=_(lr),Br=p(lr);return[h(Ot*Pr,Vt*Br),I(Vt&&sr*Pr/Vt)]}}var On=fn(function(pt){return k(2/(1+pt))});On.invert=En(function(pt){return 2*I(pt/2)});var qn=fn(function(pt){return(pt=M(pt))&&pt/_(pt)});function Dn(pt,Ot){return[pt,l(L((r+Ot)/2))]}function gi(pt){var Ot,sr,Vt,lr=ir(pt),Pr=lr.center,Br=lr.scale,Yr=lr.translate,on=lr.clipExtent,rn=null;function pn(){var _n=a*Br(),sn=lr(kr(lr.rotate()).invert([0,0]));return on(null==rn?[[sn[0]-_n,sn[1]-_n],[sn[0]+_n,sn[1]+_n]]:pt===Dn?[[Math.max(sn[0]-_n,rn),Ot],[Math.min(sn[0]+_n,sr),Vt]]:[[rn,Math.max(sn[1]-_n,Ot)],[sr,Math.min(sn[1]+_n,Vt)]])}return lr.scale=function(_n){return arguments.length?(Br(_n),pn()):Br()},lr.translate=function(_n){return arguments.length?(Yr(_n),pn()):Yr()},lr.center=function(_n){return arguments.length?(Pr(_n),pn()):Pr()},lr.clipExtent=function(_n){return arguments.length?(null==_n?rn=Ot=sr=Vt=null:(rn=+_n[0][0],Ot=+_n[0][1],sr=+_n[1][0],Vt=+_n[1][1]),pn()):null==rn?null:[[rn,Ot],[sr,Vt]]},pn()}function Ai(pt){return L((r+pt)/2)}function Ni(pt,Ot){var sr=p(pt),Vt=pt===Ot?_(pt):l(sr/p(Ot))/l(Ai(Ot)/Ai(pt)),lr=sr*T(Ai(pt),Vt)/Vt;if(!Vt)return Dn;function Pr(Br,Yr){lr>0?Yr<-r+t&&(Yr=-r+t):Yr>r-t&&(Yr=r-t);var on=lr/T(Ai(Yr),Vt);return[on*_(Vt*Br),lr-on*p(Vt*Br)]}return Pr.invert=function(Br,Yr){var on=lr-Yr,rn=w(Vt)*k(Br*Br+on*on),pn=h(Br,f(on))*w(on);return on*Vt<0&&(pn-=a*w(Br)*w(on)),[pn/Vt,2*c(T(lr/rn,1/Vt))-r]},Pr}function Bi(pt,Ot){return[pt,Ot]}function ji(pt,Ot){var sr=p(pt),Vt=pt===Ot?_(pt):(sr-p(Ot))/(Ot-pt),lr=sr/Vt+pt;if(f(Vt)<t)return Bi;function Pr(Br,Yr){var on=lr-Yr,rn=Vt*Br;return[on*_(rn),lr-on*p(rn)]}return Pr.invert=function(Br,Yr){var on=lr-Yr,rn=h(Br,f(on))*w(on);return on*Vt<0&&(rn-=a*w(Br)*w(on)),[rn/Vt,lr-w(Vt)*k(Br*Br+on*on)]},Pr}qn.invert=En(function(pt){return pt}),Dn.invert=function(pt,Ot){return[pt,2*c(b(Ot))-r]},Bi.invert=Bi;var _a=1.340264,ya=-.081106,aa=893e-6,oa=.003796,xa=k(3)/2;function Fa(pt,Ot){var sr=I(xa*_(Ot)),Vt=sr*sr,lr=Vt*Vt*Vt;return[pt*p(sr)/(xa*(_a+3*ya*Vt+lr*(7*aa+9*oa*Vt))),sr*(_a+ya*Vt+lr*(aa+oa*Vt))]}function Xa(pt,Ot){var sr=p(Ot),Vt=p(pt)*sr;return[sr*_(pt)/Vt,_(Ot)/Vt]}function Ja(pt,Ot){var sr=Ot*Ot,Vt=sr*sr;return[pt*(.8707-.131979*sr+Vt*(Vt*(.003971*sr-.001529*Vt)-.013791)),Ot*(1.007226+sr*(.015085+Vt*(.028874*sr-.044475-.005916*Vt)))]}function Ka(pt,Ot){return[p(Ot)*_(pt),_(Ot)]}function Qa(pt,Ot){var sr=p(Ot),Vt=1+p(pt)*sr;return[sr*_(pt)/Vt,_(Ot)/Vt]}function Oi(pt,Ot){return[l(L((r+Ot)/2)),-pt]}Fa.invert=function(pt,Ot){for(var sr,Vt=Ot,lr=Vt*Vt,Pr=lr*lr*lr,Br=0;Br<12&&(Pr=(lr=(Vt-=sr=(Vt*(_a+ya*lr+Pr*(aa+oa*lr))-Ot)/(_a+3*ya*lr+Pr*(7*aa+9*oa*lr)))*Vt)*lr*lr,!(f(sr)<1e-12));++Br);return[xa*pt*(_a+3*ya*lr+Pr*(7*aa+9*oa*lr))/p(Vt),I(_(Vt)/xa)]},Xa.invert=En(c),Ja.invert=function(pt,Ot){var sr,Vt=Ot,lr=25;do{var Pr=Vt*Vt,Br=Pr*Pr;Vt-=sr=(Vt*(1.007226+Pr*(.015085+Br*(.028874*Pr-.044475-.005916*Br)))-Ot)/(1.007226+Pr*(.045255+Br*(.259866*Pr-.311325-.005916*11*Br)))}while(f(sr)>t&&--lr>0);return[pt/(.8707+(Pr=Vt*Vt)*(Pr*(Pr*Pr*Pr*(.003971-.001529*Pr)-.013791)-.131979)),Vt]},Ka.invert=En(I),Qa.invert=En(function(pt){return 2*c(pt)}),Oi.invert=function(pt,Ot){return[-Ot,2*c(b(pt))-r]},g.geoAlbers=tn,g.geoAlbersUsa=function(){var pt,Ot,sr,Vt,lr,Pr,Br=tn(),Yr=Or().rotate([154,0]).center([-2,58.5]).parallels([55,65]),on=Or().rotate([157,0]).center([-3,19.9]).parallels([8,18]),rn={point:function(sn,wn){Pr=[sn,wn]}};function pn(sn){var wn=sn[0],zn=sn[1];return Pr=null,sr.point(wn,zn),Pr||(Vt.point(wn,zn),Pr)||(lr.point(wn,zn),Pr)}function _n(){return pt=Ot=null,pn}return pn.invert=function(sn){var wn=Br.scale(),zn=Br.translate(),Vn=(sn[0]-zn[0])/wn,ii=(sn[1]-zn[1])/wn;return(ii>=.12&&ii<.234&&Vn>=-.425&&Vn<-.214?Yr:ii>=.166&&ii<.234&&Vn>=-.214&&Vn<-.115?on:Br).invert(sn)},pn.stream=function(sn){return pt&&Ot===sn?pt:(wn=[Br.stream(Ot=sn),Yr.stream(sn),on.stream(sn)],zn=wn.length,pt={point:function(Vn,ii){for(var Wr=-1;++Wr<zn;)wn[Wr].point(Vn,ii)},sphere:function(){for(var Vn=-1;++Vn<zn;)wn[Vn].sphere()},lineStart:function(){for(var Vn=-1;++Vn<zn;)wn[Vn].lineStart()},lineEnd:function(){for(var Vn=-1;++Vn<zn;)wn[Vn].lineEnd()},polygonStart:function(){for(var Vn=-1;++Vn<zn;)wn[Vn].polygonStart()},polygonEnd:function(){for(var Vn=-1;++Vn<zn;)wn[Vn].polygonEnd()}});var wn,zn},pn.precision=function(sn){return arguments.length?(Br.precision(sn),Yr.precision(sn),on.precision(sn),_n()):Br.precision()},pn.scale=function(sn){return arguments.length?(Br.scale(sn),Yr.scale(.35*sn),on.scale(sn),pn.translate(Br.translate())):Br.scale()},pn.translate=function(sn){if(!arguments.length)return Br.translate();var wn=Br.scale(),zn=+sn[0],Vn=+sn[1];return sr=Br.translate(sn).clipExtent([[zn-.455*wn,Vn-.238*wn],[zn+.455*wn,Vn+.238*wn]]).stream(rn),Vt=Yr.translate([zn-.307*wn,Vn+.201*wn]).clipExtent([[zn-.425*wn+t,Vn+.12*wn+t],[zn-.214*wn-t,Vn+.234*wn-t]]).stream(rn),lr=on.translate([zn-.205*wn,Vn+.212*wn]).clipExtent([[zn-.214*wn+t,Vn+.166*wn+t],[zn-.115*wn-t,Vn+.234*wn-t]]).stream(rn),_n()},pn.fitExtent=function(sn,wn){return Ze(pn,sn,wn)},pn.fitSize=function(sn,wn){return et(pn,sn,wn)},pn.fitWidth=function(sn,wn){return lt(pn,sn,wn)},pn.fitHeight=function(sn,wn){return yt(pn,sn,wn)},pn.scale(1070)},g.geoArea=function(pt){return U.reset(),W(pt,te),2*U},g.geoAzimuthalEqualArea=function(){return ir(On).scale(124.75).clipAngle(179.999)},g.geoAzimuthalEqualAreaRaw=On,g.geoAzimuthalEquidistant=function(){return ir(qn).scale(79.4188).clipAngle(179.999)},g.geoAzimuthalEquidistantRaw=qn,g.geoBounds=function(pt){var Ot,sr,Vt,lr,Pr,Br,Yr;if(fe=Oe=-(Te=we=1/0),Ne=[],W(pt,Wt),sr=Ne.length){for(Ne.sort(Je),Ot=1,Pr=[Vt=Ne[0]];Ot<sr;++Ot)He(Vt,(lr=Ne[Ot])[0])||He(Vt,lr[1])?(Ge(Vt[0],lr[1])>Ge(Vt[0],Vt[1])&&(Vt[1]=lr[1]),Ge(lr[0],Vt[1])>Ge(Vt[0],Vt[1])&&(Vt[0]=lr[0])):Pr.push(Vt=lr);for(Br=-1/0,Ot=0,Vt=Pr[sr=Pr.length-1];Ot<=sr;Vt=lr,++Ot)(Yr=Ge(Vt[1],(lr=Pr[Ot])[0]))>Br&&(Br=Yr,Te=lr[0],Oe=Vt[1])}return Ne=De=null,Te===1/0||we===1/0?[[NaN,NaN],[NaN,NaN]]:[[Te,we],[Oe,fe]]},g.geoCentroid=function(pt){ze=Me=Se=Ie=Fe=Re=Xe=nt=ct=xt=dt=0,W(pt,st);var Ot=ct,sr=xt,Vt=dt,lr=Ot*Ot+sr*sr+Vt*Vt;return lr<1e-12&&(Ot=Re,sr=Xe,Vt=nt,Me<t&&(Ot=Se,sr=Ie,Vt=Fe),(lr=Ot*Ot+sr*sr+Vt*Vt)<1e-12)?[NaN,NaN]:[h(sr,Ot)*i,I(Vt/k(lr))*i]},g.geoCircle=function(){var pt,Ot,sr=it([0,0]),Vt=it(90),lr=it(6),Pr={point:function(Yr,on){pt.push(Yr=Ot(Yr,on)),Yr[0]*=i,Yr[1]*=i}};function Br(){var Yr=sr.apply(this,arguments),on=Vt.apply(this,arguments)*u,rn=lr.apply(this,arguments)*u;return pt=[],Ot=Ft(-Yr[0]*u,-Yr[1]*u,0).invert,ur(Pr,on,rn,1),Yr={type:"Polygon",coordinates:[pt]},pt=Ot=null,Yr}return Br.center=function(Yr){return arguments.length?(sr="function"==typeof Yr?Yr:it([+Yr[0],+Yr[1]]),Br):sr},Br.radius=function(Yr){return arguments.length?(Vt="function"==typeof Yr?Yr:it(+Yr),Br):Vt},Br.precision=function(Yr){return arguments.length?(lr="function"==typeof Yr?Yr:it(+Yr),Br):lr},Br},g.geoClipAntimeridian=gn,g.geoClipCircle=dn,g.geoClipExtent=function(){var pt,Ot,sr,Vt=0,lr=0,Pr=960,Br=500;return sr={stream:function(Yr){return pt&&Ot===Yr?pt:pt=An(Vt,lr,Pr,Br)(Ot=Yr)},extent:function(Yr){return arguments.length?(Vt=+Yr[0][0],lr=+Yr[0][1],Pr=+Yr[1][0],Br=+Yr[1][1],pt=Ot=null,sr):[[Vt,lr],[Pr,Br]]}}},g.geoClipRectangle=An,g.geoConicConformal=function(){return br(Ni).scale(109.5).parallels([30,30])},g.geoConicConformalRaw=Ni,g.geoConicEqualArea=Or,g.geoConicEqualAreaRaw=_r,g.geoConicEquidistant=function(){return br(ji).scale(131.154).center([0,13.9389])},g.geoConicEquidistantRaw=ji,g.geoContains=function(pt,Ot){return(pt&&Pt.hasOwnProperty(pt.type)?Pt[pt.type]:hr)(pt,Ot)},g.geoDistance=mr,g.geoEqualEarth=function(){return ir(Fa).scale(177.158)},g.geoEqualEarthRaw=Fa,g.geoEquirectangular=function(){return ir(Bi).scale(152.63)},g.geoEquirectangularRaw=Bi,g.geoGnomonic=function(){return ir(Xa).scale(144.049).clipAngle(60)},g.geoGnomonicRaw=Xa,g.geoGraticule=Er,g.geoGraticule10=function(){return Er()()},g.geoIdentity=function(){var pt,Ot,sr,Vt,lr,Pr,Br,Yr=1,on=0,rn=0,pn=1,_n=1,sn=0,wn=null,zn=1,Vn=1,ii=So({point:function(Nn,ei){var wi=Ln([Nn,ei]);this.stream.point(wi[0],wi[1])}}),Wr=qr;function ti(){return zn=Yr*pn,Vn=Yr*_n,Pr=Br=null,Ln}function Ln(Nn){var ei=Nn[0]*zn,wi=Nn[1]*Vn;if(sn){var Li=wi*pt-ei*Ot;ei=ei*pt+wi*Ot,wi=Li}return[ei+on,wi+rn]}return Ln.invert=function(Nn){var ei=Nn[0]-on,wi=Nn[1]-rn;if(sn){var Li=wi*pt+ei*Ot;ei=ei*pt-wi*Ot,wi=Li}return[ei/zn,wi/Vn]},Ln.stream=function(Nn){return Pr&&Br===Nn?Pr:Pr=ii(Wr(Br=Nn))},Ln.postclip=function(Nn){return arguments.length?(Wr=Nn,wn=sr=Vt=lr=null,ti()):Wr},Ln.clipExtent=function(Nn){return arguments.length?(Wr=null==Nn?(wn=sr=Vt=lr=null,qr):An(wn=+Nn[0][0],sr=+Nn[0][1],Vt=+Nn[1][0],lr=+Nn[1][1]),ti()):null==wn?null:[[wn,sr],[Vt,lr]]},Ln.scale=function(Nn){return arguments.length?(Yr=+Nn,ti()):Yr},Ln.translate=function(Nn){return arguments.length?(on=+Nn[0],rn=+Nn[1],ti()):[on,rn]},Ln.angle=function(Nn){return arguments.length?(Ot=_(sn=Nn%360*u),pt=p(sn),ti()):sn*i},Ln.reflectX=function(Nn){return arguments.length?(pn=Nn?-1:1,ti()):pn<0},Ln.reflectY=function(Nn){return arguments.length?(_n=Nn?-1:1,ti()):_n<0},Ln.fitExtent=function(Nn,ei){return Ze(Ln,Nn,ei)},Ln.fitSize=function(Nn,ei){return et(Ln,Nn,ei)},Ln.fitWidth=function(Nn,ei){return lt(Ln,Nn,ei)},Ln.fitHeight=function(Nn,ei){return yt(Ln,Nn,ei)},Ln},g.geoInterpolate=function(pt,Ot){var sr=pt[0]*u,Vt=pt[1]*u,lr=Ot[0]*u,Pr=Ot[1]*u,Br=p(Vt),Yr=_(Vt),on=p(Pr),rn=_(Pr),pn=Br*p(sr),_n=Br*_(sr),sn=on*p(lr),wn=on*_(lr),zn=2*I(k(P(Pr-Vt)+Br*on*P(lr-sr))),Vn=_(zn),ii=zn?function(Wr){var ti=_(Wr*=zn)/Vn,Ln=_(zn-Wr)/Vn,Nn=Ln*pn+ti*sn,ei=Ln*_n+ti*wn,wi=Ln*Yr+ti*rn;return[h(ei,Nn)*i,h(wi,k(Nn*Nn+ei*ei))*i]}:function(){return[sr*i,Vt*i]};return ii.distance=zn,ii},g.geoLength=Cn,g.geoMercator=function(){return gi(Dn).scale(961/s)},g.geoMercatorRaw=Dn,g.geoNaturalEarth1=function(){return ir(Ja).scale(175.295)},g.geoNaturalEarth1Raw=Ja,g.geoOrthographic=function(){return ir(Ka).scale(249.5).clipAngle(90+t)},g.geoOrthographicRaw=Ka,g.geoPath=function(pt,Ot){var sr,Vt,lr=4.5;function Pr(Br){return Br&&("function"==typeof lr&&Vt.pointRadius(+lr.apply(this,arguments)),W(Br,sr(Vt))),Vt.result()}return Pr.area=function(Br){return W(Br,sr(Sn)),Sn.result()},Pr.measure=function(Br){return W(Br,sr(po)),po.result()},Pr.bounds=function(Br){return W(Br,sr(ha)),ha.result()},Pr.centroid=function(Br){return W(Br,sr(pa)),pa.result()},Pr.projection=function(Br){return arguments.length?(sr=null==Br?(pt=null,qr):(pt=Br).stream,Pr):pt},Pr.context=function(Br){return arguments.length?(Vt=null==Br?(Ot=null,new jo):new bs(Ot=Br),"function"!=typeof lr&&Vt.pointRadius(lr),Pr):Ot},Pr.pointRadius=function(Br){return arguments.length?(lr="function"==typeof Br?Br:(Vt.pointRadius(+Br),+Br),Pr):lr},Pr.projection(pt).context(Ot)},g.geoProjection=ir,g.geoProjectionMutator=pr,g.geoRotation=kr,g.geoStereographic=function(){return ir(Qa).scale(250).clipAngle(142)},g.geoStereographicRaw=Qa,g.geoStream=W,g.geoTransform=function(pt){return{stream:So(pt)}},g.geoTransverseMercator=function(){var pt=gi(Oi),Ot=pt.center,sr=pt.rotate;return pt.center=function(Vt){return arguments.length?Ot([-Vt[1],Vt[0]]):[(Vt=Ot())[1],-Vt[0]]},pt.rotate=function(Vt){return arguments.length?sr([Vt[0],Vt[1],Vt.length>2?Vt[2]+90:90]):[(Vt=sr())[0],Vt[1],Vt[2]-90]},sr([0,0,90]).scale(159.155)},g.geoTransverseMercatorRaw=Oi,Object.defineProperty(g,"__esModule",{value:!0})},"object"==typeof Q&&void 0!==ee?v(Q,y("d3-array")):v((g=g||self).d3=g.d3||{},g.d3)},{"d3-array":107}],115:[function(y,ee,Q){var g,v;g=this,v=function(g){"use strict";function v(oe,de){return oe.parent===de.parent?1:2}function m(oe,de){return oe+de.x}function x(oe,de){return Math.max(oe,de.y)}function e(oe){var de=0,se=oe.children,ge=se&&se.length;if(ge)for(;--ge>=0;)de+=se[ge].value;else de=1;oe.value=de}function n(oe,de){var se,ge,_e,Te,we,Oe=new d(oe),fe=+oe.value&&(Oe.value=oe.value),ve=[Oe];for(null==de&&(de=t);se=ve.pop();)if(fe&&(se.value=+se.data.value),(_e=de(se.data))&&(we=_e.length))for(se.children=new Array(we),Te=we-1;Te>=0;--Te)ve.push(ge=se.children[Te]=new d(_e[Te])),ge.parent=se,ge.depth=se.depth+1;return Oe.eachBefore(r)}function t(oe){return oe.children}function a(oe){oe.data=oe.data.data}function r(oe){var de=0;do{oe.height=de}while((oe=oe.parent)&&oe.height<++de)}function d(oe){this.data=oe,this.depth=this.height=0,this.parent=null}d.prototype=n.prototype={constructor:d,count:function(){return this.eachAfter(e)},each:function(oe){var de,se,ge,_e,Te=this,we=[Te];do{for(de=we.reverse(),we=[];Te=de.pop();)if(oe(Te),se=Te.children)for(ge=0,_e=se.length;ge<_e;++ge)we.push(se[ge])}while(we.length);return this},eachAfter:function(oe){for(var de,se,ge,_e=this,Te=[_e],we=[];_e=Te.pop();)if(we.push(_e),de=_e.children)for(se=0,ge=de.length;se<ge;++se)Te.push(de[se]);for(;_e=we.pop();)oe(_e);return this},eachBefore:function(oe){for(var de,se,ge=this,_e=[ge];ge=_e.pop();)if(oe(ge),de=ge.children)for(se=de.length-1;se>=0;--se)_e.push(de[se]);return this},sum:function(oe){return this.eachAfter(function(de){for(var se=+oe(de.data)||0,ge=de.children,_e=ge&&ge.length;--_e>=0;)se+=ge[_e].value;de.value=se})},sort:function(oe){return this.eachBefore(function(de){de.children&&de.children.sort(oe)})},path:function(oe){for(var de=this,se=function(Te,we){if(Te===we)return Te;var Oe=Te.ancestors(),fe=we.ancestors(),ve=null;for(Te=Oe.pop(),we=fe.pop();Te===we;)ve=Te,Te=Oe.pop(),we=fe.pop();return ve}(de,oe),ge=[de];de!==se;)ge.push(de=de.parent);for(var _e=ge.length;oe!==se;)ge.splice(_e,0,oe),oe=oe.parent;return ge},ancestors:function(){for(var oe=this,de=[oe];oe=oe.parent;)de.push(oe);return de},descendants:function(){var oe=[];return this.each(function(de){oe.push(de)}),oe},leaves:function(){var oe=[];return this.eachBefore(function(de){de.children||oe.push(de)}),oe},links:function(){var oe=this,de=[];return oe.each(function(se){se!==oe&&de.push({source:se.parent,target:se})}),de},copy:function(){return n(this).eachBefore(a)}};var s=Array.prototype.slice;function i(oe){for(var de,se,ge=0,_e=(oe=function(we){for(var Oe,fe,ve=we.length;ve;)fe=Math.random()*ve--|0,Oe=we[ve],we[ve]=we[fe],we[fe]=Oe;return we}(s.call(oe))).length,Te=[];ge<_e;)de=oe[ge],se&&c(se,de)?++ge:(se=p(Te=u(Te,de)),ge=0);return se}function u(oe,de){var se,ge;if(h(de,oe))return[de];for(se=0;se<oe.length;++se)if(f(de,oe[se])&&h(o(oe[se],de),oe))return[oe[se],de];for(se=0;se<oe.length-1;++se)for(ge=se+1;ge<oe.length;++ge)if(f(o(oe[se],oe[ge]),de)&&f(o(oe[se],de),oe[ge])&&f(o(oe[ge],de),oe[se])&&h(b(oe[se],oe[ge],de),oe))return[oe[se],oe[ge],de];throw new Error}function f(oe,de){var se=oe.r-de.r,ge=de.x-oe.x,_e=de.y-oe.y;return se<0||se*se<ge*ge+_e*_e}function c(oe,de){var se=oe.r-de.r+1e-6,ge=de.x-oe.x,_e=de.y-oe.y;return se>0&&se*se>ge*ge+_e*_e}function h(oe,de){for(var se=0;se<de.length;++se)if(!c(oe,de[se]))return!1;return!0}function p(oe){switch(oe.length){case 1:return{x:(de=oe[0]).x,y:de.y,r:de.r};case 2:return o(oe[0],oe[1]);case 3:return b(oe[0],oe[1],oe[2])}var de}function o(oe,de){var se=oe.x,ge=oe.y,_e=oe.r,Te=de.x,we=de.y,Oe=de.r,fe=Te-se,ve=we-ge,Ae=Oe-_e,ke=Math.sqrt(fe*fe+ve*ve);return{x:(se+Te+fe/ke*Ae)/2,y:(ge+we+ve/ke*Ae)/2,r:(ke+_e+Oe)/2}}function b(oe,de,se){var ge=oe.x,_e=oe.y,Te=oe.r,we=de.x,Oe=de.y,fe=de.r,ve=se.x,Ae=se.y,ke=se.r,Pe=ge-we,Ne=ge-ve,De=_e-Oe,ze=_e-Ae,Me=fe-Te,Se=ke-Te,Ie=ge*ge+_e*_e-Te*Te,Fe=Ie-we*we-Oe*Oe+fe*fe,Re=Ie-ve*ve-Ae*Ae+ke*ke,Xe=Ne*De-Pe*ze,nt=(De*Re-ze*Fe)/(2*Xe)-ge,ct=(ze*Me-De*Se)/Xe,xt=(Ne*Fe-Pe*Re)/(2*Xe)-_e,dt=(Pe*Se-Ne*Me)/Xe,tt=ct*ct+dt*dt-1,Ke=2*(Te+nt*ct+xt*dt),mt=nt*nt+xt*xt-Te*Te,Bt=-(tt?(Ke+Math.sqrt(Ke*Ke-4*tt*mt))/(2*tt):mt/Ke);return{x:ge+nt+ct*Bt,y:_e+xt+dt*Bt,r:Bt}}function l(oe,de,se){var ge,_e,Te,we,Oe=oe.x-de.x,fe=oe.y-de.y,ve=Oe*Oe+fe*fe;ve?(_e=de.r+se.r,we=oe.r+se.r,(_e*=_e)>(we*=we)?(ge=(ve+we-_e)/(2*ve),Te=Math.sqrt(Math.max(0,we/ve-ge*ge)),se.x=oe.x-ge*Oe-Te*fe,se.y=oe.y-ge*fe+Te*Oe):(ge=(ve+_e-we)/(2*ve),Te=Math.sqrt(Math.max(0,_e/ve-ge*ge)),se.x=de.x+ge*Oe-Te*fe,se.y=de.y+ge*fe+Te*Oe)):(se.x=de.x+se.r,se.y=de.y)}function T(oe,de){var se=oe.r+de.r-1e-6,ge=de.x-oe.x,_e=de.y-oe.y;return se>0&&se*se>ge*ge+_e*_e}function _(oe){var de=oe._,se=oe.next._,ge=de.r+se.r,_e=(de.x*se.r+se.x*de.r)/ge,Te=(de.y*se.r+se.y*de.r)/ge;return _e*_e+Te*Te}function w(oe){this._=oe,this.next=null,this.previous=null}function k(oe){if(!(_e=oe.length))return 0;var de,se,ge,_e,Te,we,Oe,fe,ve,Ae,ke;if((de=oe[0]).x=0,de.y=0,!(_e>1))return de.r;if(de.x=-(se=oe[1]).r,se.x=de.r,se.y=0,!(_e>2))return de.r+se.r;l(se,de,ge=oe[2]),de=new w(de),se=new w(se),ge=new w(ge),de.next=ge.previous=se,se.next=de.previous=ge,ge.next=se.previous=de;e:for(Oe=3;Oe<_e;++Oe){l(de._,se._,ge=oe[Oe]),ge=new w(ge),fe=se.next,ve=de.previous,Ae=se._.r,ke=de._.r;do{if(Ae<=ke){if(T(fe._,ge._)){de.next=se=fe,se.previous=de,--Oe;continue e}Ae+=fe._.r,fe=fe.next}else{if(T(ve._,ge._)){(de=ve).next=se,se.previous=de,--Oe;continue e}ke+=ve._.r,ve=ve.previous}}while(fe!==ve.next);for(ge.previous=de,ge.next=se,de.next=se.previous=se=ge,Te=_(de);(ge=ge.next)!==se;)(we=_(ge))<Te&&(de=ge,Te=we);se=de.next}for(de=[se._],ge=se;(ge=ge.next)!==se;)de.push(ge._);for(ge=i(de),Oe=0;Oe<_e;++Oe)(de=oe[Oe]).x-=ge.x,de.y-=ge.y;return ge.r}function L(oe){return null==oe?null:M(oe)}function M(oe){if("function"!=typeof oe)throw new Error;return oe}function I(){return 0}function P(oe){return function(){return oe}}function S(oe){return Math.sqrt(oe.value)}function E(oe){return function(de){de.children||(de.r=Math.max(0,+oe(de)||0))}}function z(oe,de){return function(se){if(ge=se.children){var ge,_e,Te,we=ge.length,Oe=oe(se)*de||0;if(Oe)for(_e=0;_e<we;++_e)ge[_e].r+=Oe;if(Te=k(ge),Oe)for(_e=0;_e<we;++_e)ge[_e].r-=Oe;se.r=Te+Oe}}}function R(oe){return function(de){var se=de.parent;de.r*=oe,se&&(de.x=se.x+oe*de.x,de.y=se.y+oe*de.y)}}function q(oe){oe.x0=Math.round(oe.x0),oe.y0=Math.round(oe.y0),oe.x1=Math.round(oe.x1),oe.y1=Math.round(oe.y1)}function V(oe,de,se,ge,_e){for(var Te,we=oe.children,Oe=-1,fe=we.length,ve=oe.value&&(ge-de)/oe.value;++Oe<fe;)(Te=we[Oe]).y0=se,Te.y1=_e,Te.x0=de,Te.x1=de+=Te.value*ve}var W={depth:-1},K={};function G(oe){return oe.id}function Y(oe){return oe.parentId}function $(oe,de){return oe.parent===de.parent?1:2}function B(oe){var de=oe.children;return de?de[0]:oe.t}function N(oe){var de=oe.children;return de?de[de.length-1]:oe.t}function U(oe,de,se){var ge=se/(de.i-oe.i);de.c-=ge,de.s+=se,oe.c+=ge,de.z+=se,de.m+=se}function te(oe,de,se){return oe.a.parent===de.parent?oe.a:se}function j(oe,de){this._=oe,this.parent=null,this.children=null,this.A=null,this.a=this,this.z=0,this.m=0,this.c=0,this.s=0,this.t=null,this.i=de}function J(oe,de,se,ge,_e){for(var Te,we=oe.children,Oe=-1,fe=we.length,ve=oe.value&&(_e-se)/oe.value;++Oe<fe;)(Te=we[Oe]).x0=de,Te.x1=ge,Te.y0=se,Te.y1=se+=Te.value*ve}j.prototype=Object.create(d.prototype);var X=(1+Math.sqrt(5))/2;function re(oe,de,se,ge,_e,Te){for(var we,Oe,fe,ve,Ae,ke,Pe,Ne,De,ze,Me,Se=[],Ie=de.children,Fe=0,Re=0,Xe=Ie.length,nt=de.value;Fe<Xe;){fe=_e-se,ve=Te-ge;do{Ae=Ie[Re++].value}while(!Ae&&Re<Xe);for(ke=Pe=Ae,Me=Ae*Ae*(ze=Math.max(ve/fe,fe/ve)/(nt*oe)),De=Math.max(Pe/Me,Me/ke);Re<Xe;++Re){if(Ae+=Oe=Ie[Re].value,Oe<ke&&(ke=Oe),Oe>Pe&&(Pe=Oe),Me=Ae*Ae*ze,(Ne=Math.max(Pe/Me,Me/ke))>De){Ae-=Oe;break}De=Ne}Se.push(we={value:Ae,dice:fe<ve,children:Ie.slice(Fe,Re)}),we.dice?V(we,se,ge,_e,nt?ge+=ve*Ae/nt:Te):J(we,se,ge,nt?se+=fe*Ae/nt:_e,Te),nt-=Ae,Fe=Re}return Se}var ne=function oe(de){function se(ge,_e,Te,we,Oe){re(de,ge,_e,Te,we,Oe)}return se.ratio=function(ge){return oe((ge=+ge)>1?ge:1)},se}(X),le=function oe(de){function se(ge,_e,Te,we,Oe){if((fe=ge._squarify)&&fe.ratio===de)for(var fe,ve,Ae,ke,Pe,Ne=-1,De=fe.length,ze=ge.value;++Ne<De;){for(Ae=(ve=fe[Ne]).children,ke=ve.value=0,Pe=Ae.length;ke<Pe;++ke)ve.value+=Ae[ke].value;ve.dice?V(ve,_e,Te,we,Te+=(Oe-Te)*ve.value/ze):J(ve,_e,Te,_e+=(we-_e)*ve.value/ze,Oe),ze-=ve.value}else ge._squarify=fe=re(de,ge,_e,Te,we,Oe),fe.ratio=de}return se.ratio=function(ge){return oe((ge=+ge)>1?ge:1)},se}(X);g.cluster=function(){var oe=v,de=1,se=1,ge=!1;function _e(Te){var we,Oe=0;Te.eachAfter(function(Pe){var De,Ne=Pe.children;Ne?(Pe.x=(De=Ne).reduce(m,0)/De.length,Pe.y=function(De){return 1+De.reduce(x,0)}(Ne)):(Pe.x=we?Oe+=oe(Pe,we):0,Pe.y=0,we=Pe)});var fe=function(Pe){for(var Ne;Ne=Pe.children;)Pe=Ne[0];return Pe}(Te),ve=function(Pe){for(var Ne;Ne=Pe.children;)Pe=Ne[Ne.length-1];return Pe}(Te),Ae=fe.x-oe(fe,ve)/2,ke=ve.x+oe(ve,fe)/2;return Te.eachAfter(ge?function(Pe){Pe.x=(Pe.x-Te.x)*de,Pe.y=(Te.y-Pe.y)*se}:function(Pe){Pe.x=(Pe.x-Ae)/(ke-Ae)*de,Pe.y=(1-(Te.y?Pe.y/Te.y:1))*se})}return _e.separation=function(Te){return arguments.length?(oe=Te,_e):oe},_e.size=function(Te){return arguments.length?(ge=!1,de=+Te[0],se=+Te[1],_e):ge?null:[de,se]},_e.nodeSize=function(Te){return arguments.length?(ge=!0,de=+Te[0],se=+Te[1],_e):ge?[de,se]:null},_e},g.hierarchy=n,g.pack=function(){var oe=null,de=1,se=1,ge=I;function _e(Te){return Te.x=de/2,Te.y=se/2,oe?Te.eachBefore(E(oe)).eachAfter(z(ge,.5)).eachBefore(R(1)):Te.eachBefore(E(S)).eachAfter(z(I,1)).eachAfter(z(ge,Te.r/Math.min(de,se))).eachBefore(R(Math.min(de,se)/(2*Te.r))),Te}return _e.radius=function(Te){return arguments.length?(oe=L(Te),_e):oe},_e.size=function(Te){return arguments.length?(de=+Te[0],se=+Te[1],_e):[de,se]},_e.padding=function(Te){return arguments.length?(ge="function"==typeof Te?Te:P(+Te),_e):ge},_e},g.packEnclose=i,g.packSiblings=function(oe){return k(oe),oe},g.partition=function(){var oe=1,de=1,se=0,ge=!1;function _e(Te){var Oe,fe,we=Te.height+1;return Te.x0=Te.y0=se,Te.x1=oe,Te.y1=de/we,Te.eachBefore((Oe=de,fe=we,function(ve){ve.children&&V(ve,ve.x0,Oe*(ve.depth+1)/fe,ve.x1,Oe*(ve.depth+2)/fe);var Ae=ve.x0,ke=ve.y0,Pe=ve.x1-se,Ne=ve.y1-se;Pe<Ae&&(Ae=Pe=(Ae+Pe)/2),Ne<ke&&(ke=Ne=(ke+Ne)/2),ve.x0=Ae,ve.y0=ke,ve.x1=Pe,ve.y1=Ne})),ge&&Te.eachBefore(q),Te}return _e.round=function(Te){return arguments.length?(ge=!!Te,_e):ge},_e.size=function(Te){return arguments.length?(oe=+Te[0],de=+Te[1],_e):[oe,de]},_e.padding=function(Te){return arguments.length?(se=+Te,_e):se},_e},g.stratify=function(){var oe=G,de=Y;function se(ge){var _e,Te,we,Oe,fe,ve,Ae,ke=ge.length,Pe=new Array(ke),Ne={};for(Te=0;Te<ke;++Te)fe=Pe[Te]=new d(_e=ge[Te]),null!=(ve=oe(_e,Te,ge))&&(ve+="")&&(Ne[Ae="$"+(fe.id=ve)]=Ae in Ne?K:fe);for(Te=0;Te<ke;++Te)if(fe=Pe[Te],null!=(ve=de(ge[Te],Te,ge))&&(ve+="")){if(!(Oe=Ne["$"+ve]))throw new Error("missing: "+ve);if(Oe===K)throw new Error("ambiguous: "+ve);Oe.children?Oe.children.push(fe):Oe.children=[fe],fe.parent=Oe}else{if(we)throw new Error("multiple roots");we=fe}if(!we)throw new Error("no root");if(we.parent=W,we.eachBefore(function(De){De.depth=De.parent.depth+1,--ke}).eachBefore(r),we.parent=null,ke>0)throw new Error("cycle");return we}return se.id=function(ge){return arguments.length?(oe=M(ge),se):oe},se.parentId=function(ge){return arguments.length?(de=M(ge),se):de},se},g.tree=function(){var oe=$,de=1,se=1,ge=null;function _e(fe){var ve=function(Se){for(var Ie,Fe,Re,Xe,nt,ct=new j(Se,0),xt=[ct];Ie=xt.pop();)if(Re=Ie._.children)for(Ie.children=new Array(nt=Re.length),Xe=nt-1;Xe>=0;--Xe)xt.push(Fe=Ie.children[Xe]=new j(Re[Xe],Xe)),Fe.parent=Ie;return(ct.parent=new j(null,0)).children=[ct],ct}(fe);if(ve.eachAfter(Te),ve.parent.m=-ve.z,ve.eachBefore(we),ge)fe.eachBefore(Oe);else{var Ae=fe,ke=fe,Pe=fe;fe.eachBefore(function(Se){Se.x<Ae.x&&(Ae=Se),Se.x>ke.x&&(ke=Se),Se.depth>Pe.depth&&(Pe=Se)});var Ne=Ae===ke?1:oe(Ae,ke)/2,De=Ne-Ae.x,ze=de/(ke.x+Ne+De),Me=se/(Pe.depth||1);fe.eachBefore(function(Se){Se.x=(Se.x+De)*ze,Se.y=Se.depth*Me})}return fe}function Te(fe){var ve=fe.children,Ae=fe.parent.children,ke=fe.i?Ae[fe.i-1]:null;if(ve){!function(Ne){for(var De,ze=0,Me=0,Se=Ne.children,Ie=Se.length;--Ie>=0;)(De=Se[Ie]).z+=ze,De.m+=ze,ze+=De.s+(Me+=De.c)}(fe);var Pe=(ve[0].z+ve[ve.length-1].z)/2;ke?(fe.z=ke.z+oe(fe._,ke._),fe.m=fe.z-Pe):fe.z=Pe}else ke&&(fe.z=ke.z+oe(fe._,ke._));fe.parent.A=function(Ne,De,ze){if(De){for(var Me,Se=Ne,Ie=Ne,Fe=De,Re=Se.parent.children[0],Xe=Se.m,nt=Ie.m,ct=Fe.m,xt=Re.m;Fe=N(Fe),Se=B(Se),Fe&&Se;)Re=B(Re),(Ie=N(Ie)).a=Ne,(Me=Fe.z+ct-Se.z-Xe+oe(Fe._,Se._))>0&&(U(te(Fe,Ne,ze),Ne,Me),Xe+=Me,nt+=Me),ct+=Fe.m,Xe+=Se.m,xt+=Re.m,nt+=Ie.m;Fe&&!N(Ie)&&(Ie.t=Fe,Ie.m+=ct-nt),Se&&!B(Re)&&(Re.t=Se,Re.m+=Xe-xt,ze=Ne)}return ze}(fe,ke,fe.parent.A||Ae[0])}function we(fe){fe._.x=fe.z+fe.parent.m,fe.m+=fe.parent.m}function Oe(fe){fe.x*=de,fe.y=fe.depth*se}return _e.separation=function(fe){return arguments.length?(oe=fe,_e):oe},_e.size=function(fe){return arguments.length?(ge=!1,de=+fe[0],se=+fe[1],_e):ge?null:[de,se]},_e.nodeSize=function(fe){return arguments.length?(ge=!0,de=+fe[0],se=+fe[1],_e):ge?[de,se]:null},_e},g.treemap=function(){var oe=ne,de=!1,se=1,ge=1,_e=[0],Te=I,we=I,Oe=I,fe=I,ve=I;function Ae(Pe){return Pe.x0=Pe.y0=0,Pe.x1=se,Pe.y1=ge,Pe.eachBefore(ke),_e=[0],de&&Pe.eachBefore(q),Pe}function ke(Pe){var Ne=_e[Pe.depth],De=Pe.x0+Ne,ze=Pe.y0+Ne,Me=Pe.x1-Ne,Se=Pe.y1-Ne;Me<De&&(De=Me=(De+Me)/2),Se<ze&&(ze=Se=(ze+Se)/2),Pe.x0=De,Pe.y0=ze,Pe.x1=Me,Pe.y1=Se,Pe.children&&(Ne=_e[Pe.depth+1]=Te(Pe)/2,De+=ve(Pe)-Ne,ze+=we(Pe)-Ne,(Me-=Oe(Pe)-Ne)<De&&(De=Me=(De+Me)/2),(Se-=fe(Pe)-Ne)<ze&&(ze=Se=(ze+Se)/2),oe(Pe,De,ze,Me,Se))}return Ae.round=function(Pe){return arguments.length?(de=!!Pe,Ae):de},Ae.size=function(Pe){return arguments.length?(se=+Pe[0],ge=+Pe[1],Ae):[se,ge]},Ae.tile=function(Pe){return arguments.length?(oe=M(Pe),Ae):oe},Ae.padding=function(Pe){return arguments.length?Ae.paddingInner(Pe).paddingOuter(Pe):Ae.paddingInner()},Ae.paddingInner=function(Pe){return arguments.length?(Te="function"==typeof Pe?Pe:P(+Pe),Ae):Te},Ae.paddingOuter=function(Pe){return arguments.length?Ae.paddingTop(Pe).paddingRight(Pe).paddingBottom(Pe).paddingLeft(Pe):Ae.paddingTop()},Ae.paddingTop=function(Pe){return arguments.length?(we="function"==typeof Pe?Pe:P(+Pe),Ae):we},Ae.paddingRight=function(Pe){return arguments.length?(Oe="function"==typeof Pe?Pe:P(+Pe),Ae):Oe},Ae.paddingBottom=function(Pe){return arguments.length?(fe="function"==typeof Pe?Pe:P(+Pe),Ae):fe},Ae.paddingLeft=function(Pe){return arguments.length?(ve="function"==typeof Pe?Pe:P(+Pe),Ae):ve},Ae},g.treemapBinary=function(oe,de,se,ge,_e){var Te,we,Oe=oe.children,fe=Oe.length,ve=new Array(fe+1);for(ve[0]=we=Te=0;Te<fe;++Te)ve[Te+1]=we+=Oe[Te].value;!function Ae(ke,Pe,Ne,De,ze,Me,Se){if(ke>=Pe-1){var Ie=Oe[ke];return Ie.x0=De,Ie.y0=ze,Ie.x1=Me,void(Ie.y1=Se)}for(var Fe=ve[ke],Re=Ne/2+Fe,Xe=ke+1,nt=Pe-1;Xe<nt;){var ct=Xe+nt>>>1;ve[ct]<Re?Xe=ct+1:nt=ct}Re-ve[Xe-1]<ve[Xe]-Re&&ke+1<Xe&&--Xe;var xt=ve[Xe]-Fe,dt=Ne-xt;if(Me-De>Se-ze){var tt=(De*dt+Me*xt)/Ne;Ae(ke,Xe,xt,De,ze,tt,Se),Ae(Xe,Pe,dt,tt,ze,Me,Se)}else{var Ke=(ze*dt+Se*xt)/Ne;Ae(ke,Xe,xt,De,ze,Me,Ke),Ae(Xe,Pe,dt,De,Ke,Me,Se)}}(0,fe,oe.value,de,se,ge,_e)},g.treemapDice=V,g.treemapResquarify=le,g.treemapSlice=J,g.treemapSliceDice=function(oe,de,se,ge,_e){(1&oe.depth?J:V)(oe,de,se,ge,_e)},g.treemapSquarify=ne,Object.defineProperty(g,"__esModule",{value:!0})},v("object"==typeof Q&&void 0!==ee?Q:(g=g||self).d3=g.d3||{})},{}],116:[function(y,ee,Q){var g,v;g=this,v=function(g,v){"use strict";function m(X,re,ne,le,oe){var de=X*X,se=de*X;return((1-3*X+3*de-se)*re+(4-6*de+3*se)*ne+(1+3*X+3*de-3*se)*le+se*oe)/6}function x(X){var re=X.length-1;return function(ne){var le=ne<=0?ne=0:ne>=1?(ne=1,re-1):Math.floor(ne*re),oe=X[le],de=X[le+1];return m((ne-le/re)*re,le>0?X[le-1]:2*oe-de,oe,de,le<re-1?X[le+2]:2*de-oe)}}function e(X){var re=X.length;return function(ne){var le=Math.floor(((ne%=1)<0?++ne:ne)*re);return m((ne-le/re)*re,X[(le+re-1)%re],X[le%re],X[(le+1)%re],X[(le+2)%re])}}function n(X){return function(){return X}}function t(X,re){return function(ne){return X+ne*re}}function a(X,re){var ne=re-X;return ne?t(X,ne>180||ne<-180?ne-360*Math.round(ne/360):ne):n(isNaN(X)?re:X)}function d(X,re){var ne=re-X;return ne?t(X,ne):n(isNaN(X)?re:X)}var s=function X(re){var ne=function r(X){return 1==(X=+X)?d:function(re,ne){return ne-re?(le=re,oe=ne,de=X,le=Math.pow(le,de),oe=Math.pow(oe,de)-le,de=1/de,function(se){return Math.pow(le+se*oe,de)}):n(isNaN(re)?ne:re);var le,oe,de}}(re);function le(oe,de){var se=ne((oe=v.rgb(oe)).r,(de=v.rgb(de)).r),ge=ne(oe.g,de.g),_e=ne(oe.b,de.b),Te=d(oe.opacity,de.opacity);return function(we){return oe.r=se(we),oe.g=ge(we),oe.b=_e(we),oe.opacity=Te(we),oe+""}}return le.gamma=X,le}(1);function i(X){return function(re){var ne,le,oe=re.length,de=new Array(oe),se=new Array(oe),ge=new Array(oe);for(ne=0;ne<oe;++ne)le=v.rgb(re[ne]),de[ne]=le.r||0,se[ne]=le.g||0,ge[ne]=le.b||0;return de=X(de),se=X(se),ge=X(ge),le.opacity=1,function(_e){return le.r=de(_e),le.g=se(_e),le.b=ge(_e),le+""}}}var u=i(x),f=i(e);function c(X,re){re||(re=[]);var ne,le=X?Math.min(re.length,X.length):0,oe=re.slice();return function(de){for(ne=0;ne<le;++ne)oe[ne]=X[ne]*(1-de)+re[ne]*de;return oe}}function h(X){return ArrayBuffer.isView(X)&&!(X instanceof DataView)}function p(X,re){var ne,le=re?re.length:0,oe=X?Math.min(le,X.length):0,de=new Array(oe),se=new Array(le);for(ne=0;ne<oe;++ne)de[ne]=k(X[ne],re[ne]);for(;ne<le;++ne)se[ne]=re[ne];return function(ge){for(ne=0;ne<oe;++ne)se[ne]=de[ne](ge);return se}}function o(X,re){var ne=new Date;return X=+X,re=+re,function(le){return ne.setTime(X*(1-le)+re*le),ne}}function b(X,re){return X=+X,re=+re,function(ne){return X*(1-ne)+re*ne}}function l(X,re){var ne,le={},oe={};for(ne in null!==X&&"object"==typeof X||(X={}),null!==re&&"object"==typeof re||(re={}),re)ne in X?le[ne]=k(X[ne],re[ne]):oe[ne]=re[ne];return function(de){for(ne in le)oe[ne]=le[ne](de);return oe}}var T=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,_=new RegExp(T.source,"g");function w(X,re){var ne,le,oe,Te,de=T.lastIndex=_.lastIndex=0,se=-1,ge=[],_e=[];for(X+="",re+="";(ne=T.exec(X))&&(le=_.exec(re));)(oe=le.index)>de&&(oe=re.slice(de,oe),ge[se]?ge[se]+=oe:ge[++se]=oe),(ne=ne[0])===(le=le[0])?ge[se]?ge[se]+=le:ge[++se]=le:(ge[++se]=null,_e.push({i:se,x:b(ne,le)})),de=_.lastIndex;return de<re.length&&(oe=re.slice(de),ge[se]?ge[se]+=oe:ge[++se]=oe),ge.length<2?_e[0]?(Te=_e[0].x,function(we){return Te(we)+""}):function(Te){return function(){return Te}}(re):(re=_e.length,function(Te){for(var we,Oe=0;Oe<re;++Oe)ge[(we=_e[Oe]).i]=we.x(Te);return ge.join("")})}function k(X,re){var ne,le=typeof re;return null==re||"boolean"===le?n(re):("number"===le?b:"string"===le?(ne=v.color(re))?(re=ne,s):w:re instanceof v.color?s:re instanceof Date?o:h(re)?c:Array.isArray(re)?p:"function"!=typeof re.valueOf&&"function"!=typeof re.toString||isNaN(re)?l:b)(X,re)}var L,M,I,P,S=180/Math.PI,E={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function z(X,re,ne,le,oe,de){var se,ge,_e;return(se=Math.sqrt(X*X+re*re))&&(X/=se,re/=se),(_e=X*ne+re*le)&&(ne-=X*_e,le-=re*_e),(ge=Math.sqrt(ne*ne+le*le))&&(ne/=ge,le/=ge,_e/=ge),X*le<re*ne&&(X=-X,re=-re,_e=-_e,se=-se),{translateX:oe,translateY:de,rotate:Math.atan2(re,X)*S,skewX:Math.atan(_e)*S,scaleX:se,scaleY:ge}}function R(X,re,ne,le){function oe(de){return de.length?de.pop()+" ":""}return function(de,se){var Te,we,Oe,ge=[],_e=[];return de=X(de),se=X(se),function(Te,we,Oe,fe,ve,Ae){if(Te!==Oe||we!==fe){var ke=ve.push("translate(",null,re,null,ne);Ae.push({i:ke-4,x:b(Te,Oe)},{i:ke-2,x:b(we,fe)})}else(Oe||fe)&&ve.push("translate("+Oe+re+fe+ne)}(de.translateX,de.translateY,se.translateX,se.translateY,ge,_e),Oe=ge,(Te=de.rotate)!==(we=se.rotate)?(Te-we>180?we+=360:we-Te>180&&(Te+=360),_e.push({i:Oe.push(oe(Oe)+"rotate(",null,le)-2,x:b(Te,we)})):we&&Oe.push(oe(Oe)+"rotate("+we+le),function(Te,we,Oe,fe){Te!==we?fe.push({i:Oe.push(oe(Oe)+"skewX(",null,le)-2,x:b(Te,we)}):we&&Oe.push(oe(Oe)+"skewX("+we+le)}(de.skewX,se.skewX,ge,_e),function(Te,we,Oe,fe,ve,Ae){if(Te!==Oe||we!==fe){var ke=ve.push(oe(ve)+"scale(",null,",",null,")");Ae.push({i:ke-4,x:b(Te,Oe)},{i:ke-2,x:b(we,fe)})}else 1===Oe&&1===fe||ve.push(oe(ve)+"scale("+Oe+","+fe+")")}(de.scaleX,de.scaleY,se.scaleX,se.scaleY,ge,_e),de=se=null,function(Te){for(var we,Oe=-1,fe=_e.length;++Oe<fe;)ge[(we=_e[Oe]).i]=we.x(Te);return ge.join("")}}}var q=R(function(X){return"none"===X?E:(L||(L=document.createElement("DIV"),M=document.documentElement,I=document.defaultView),L.style.transform=X,X=I.getComputedStyle(M.appendChild(L),null).getPropertyValue("transform"),M.removeChild(L),z(+(X=X.slice(7,-1).split(","))[0],+X[1],+X[2],+X[3],+X[4],+X[5]))},"px, ","px)","deg)"),V=R(function(X){return null==X?E:(P||(P=document.createElementNS("http://www.w3.org/2000/svg","g")),P.setAttribute("transform",X),(X=P.transform.baseVal.consolidate())?z((X=X.matrix).a,X.b,X.c,X.d,X.e,X.f):E)},", ",")",")"),W=Math.SQRT2;function K(X){return((X=Math.exp(X))+1/X)/2}function G(X){return function(re,ne){var le=X((re=v.hsl(re)).h,(ne=v.hsl(ne)).h),oe=d(re.s,ne.s),de=d(re.l,ne.l),se=d(re.opacity,ne.opacity);return function(ge){return re.h=le(ge),re.s=oe(ge),re.l=de(ge),re.opacity=se(ge),re+""}}}var Y=G(a),$=G(d);function B(X){return function(re,ne){var le=X((re=v.hcl(re)).h,(ne=v.hcl(ne)).h),oe=d(re.c,ne.c),de=d(re.l,ne.l),se=d(re.opacity,ne.opacity);return function(ge){return re.h=le(ge),re.c=oe(ge),re.l=de(ge),re.opacity=se(ge),re+""}}}var N=B(a),U=B(d);function te(X){return function re(ne){function le(oe,de){var se=X((oe=v.cubehelix(oe)).h,(de=v.cubehelix(de)).h),ge=d(oe.s,de.s),_e=d(oe.l,de.l),Te=d(oe.opacity,de.opacity);return function(we){return oe.h=se(we),oe.s=ge(we),oe.l=_e(Math.pow(we,ne)),oe.opacity=Te(we),oe+""}}return ne=+ne,le.gamma=re,le}(1)}var j=te(a),J=te(d);g.interpolate=k,g.interpolateArray=function(X,re){return(h(re)?c:p)(X,re)},g.interpolateBasis=x,g.interpolateBasisClosed=e,g.interpolateCubehelix=j,g.interpolateCubehelixLong=J,g.interpolateDate=o,g.interpolateDiscrete=function(X){var re=X.length;return function(ne){return X[Math.max(0,Math.min(re-1,Math.floor(ne*re)))]}},g.interpolateHcl=N,g.interpolateHclLong=U,g.interpolateHsl=Y,g.interpolateHslLong=$,g.interpolateHue=function(X,re){var ne=a(+X,+re);return function(le){var oe=ne(le);return oe-360*Math.floor(oe/360)}},g.interpolateLab=function(X,re){var ne=d((X=v.lab(X)).l,(re=v.lab(re)).l),le=d(X.a,re.a),oe=d(X.b,re.b),de=d(X.opacity,re.opacity);return function(se){return X.l=ne(se),X.a=le(se),X.b=oe(se),X.opacity=de(se),X+""}},g.interpolateNumber=b,g.interpolateNumberArray=c,g.interpolateObject=l,g.interpolateRgb=s,g.interpolateRgbBasis=u,g.interpolateRgbBasisClosed=f,g.interpolateRound=function(X,re){return X=+X,re=+re,function(ne){return Math.round(X*(1-ne)+re*ne)}},g.interpolateString=w,g.interpolateTransformCss=q,g.interpolateTransformSvg=V,g.interpolateZoom=function(X,re){var ne,le,oe=X[0],de=X[1],se=X[2],Te=re[2],we=re[0]-oe,Oe=re[1]-de,fe=we*we+Oe*Oe;if(fe<1e-12)le=Math.log(Te/se)/W,ne=function(De){return[oe+De*we,de+De*Oe,se*Math.exp(W*De*le)]};else{var ve=Math.sqrt(fe),Ae=(Te*Te-se*se+4*fe)/(2*se*2*ve),ke=(Te*Te-se*se-4*fe)/(2*Te*2*ve),Pe=Math.log(Math.sqrt(Ae*Ae+1)-Ae),Ne=Math.log(Math.sqrt(ke*ke+1)-ke);le=(Ne-Pe)/W,ne=function(De){var ze,Fe,Me=De*le,Se=K(Pe),Ie=se/(2*ve)*(Se*(ze=W*Me+Pe,((ze=Math.exp(2*ze))-1)/(ze+1))-(Fe=Pe,((Fe=Math.exp(Fe))-1/Fe)/2));return[oe+Ie*we,de+Ie*Oe,se*Se/K(W*Me+Pe)]}}return ne.duration=1e3*le,ne},g.piecewise=function(X,re){for(var ne=0,le=re.length-1,oe=re[0],de=new Array(le<0?0:le);ne<le;)de[ne]=X(oe,oe=re[++ne]);return function(se){var ge=Math.max(0,Math.min(le-1,Math.floor(se*=le)));return de[ge](se-ge)}},g.quantize=function(X,re){for(var ne=new Array(re),le=0;le<re;++le)ne[le]=X(le/(re-1));return ne},Object.defineProperty(g,"__esModule",{value:!0})},"object"==typeof Q&&void 0!==ee?v(Q,y("d3-color")):v((g=g||self).d3=g.d3||{},g.d3)},{"d3-color":109}],117:[function(y,ee,Q){var g,v;g=this,v=function(g){"use strict";var v=Math.PI,m=2*v,x=m-1e-6;function e(){this._x0=this._y0=this._x1=this._y1=null,this._=""}function n(){return new e}e.prototype=n.prototype={constructor:e,moveTo:function(t,a){this._+="M"+(this._x0=this._x1=+t)+","+(this._y0=this._y1=+a)},closePath:function(){null!==this._x1&&(this._x1=this._x0,this._y1=this._y0,this._+="Z")},lineTo:function(t,a){this._+="L"+(this._x1=+t)+","+(this._y1=+a)},quadraticCurveTo:function(t,a,r,d){this._+="Q"+ +t+","+ +a+","+(this._x1=+r)+","+(this._y1=+d)},bezierCurveTo:function(t,a,r,d,s,i){this._+="C"+ +t+","+ +a+","+ +r+","+ +d+","+(this._x1=+s)+","+(this._y1=+i)},arcTo:function(t,a,r,d,s){var i=this._x1,u=this._y1,f=(r=+r)-(t=+t),c=(d=+d)-(a=+a),h=i-t,p=u-a,o=h*h+p*p;if((s=+s)<0)throw new Error("negative radius: "+s);if(null===this._x1)this._+="M"+(this._x1=t)+","+(this._y1=a);else if(o>1e-6)if(Math.abs(p*f-c*h)>1e-6&&s){var b=r-i,l=d-u,T=f*f+c*c,_=b*b+l*l,w=Math.sqrt(T),k=Math.sqrt(o),L=s*Math.tan((v-Math.acos((T+o-_)/(2*w*k)))/2),M=L/k,I=L/w;Math.abs(M-1)>1e-6&&(this._+="L"+(t+M*h)+","+(a+M*p)),this._+="A"+s+","+s+",0,0,"+ +(p*b>h*l)+","+(this._x1=t+I*f)+","+(this._y1=a+I*c)}else this._+="L"+(this._x1=t)+","+(this._y1=a)},arc:function(t,a,r,d,s,i){t=+t,a=+a,i=!!i;var u=(r=+r)*Math.cos(d),f=r*Math.sin(d),c=t+u,h=a+f,p=1^i,o=i?d-s:s-d;if(r<0)throw new Error("negative radius: "+r);null===this._x1?this._+="M"+c+","+h:(Math.abs(this._x1-c)>1e-6||Math.abs(this._y1-h)>1e-6)&&(this._+="L"+c+","+h),r&&(o<0&&(o=o%m+m),o>x?this._+="A"+r+","+r+",0,1,"+p+","+(t-u)+","+(a-f)+"A"+r+","+r+",0,1,"+p+","+(this._x1=c)+","+(this._y1=h):o>1e-6&&(this._+="A"+r+","+r+",0,"+ +(o>=v)+","+p+","+(this._x1=t+r*Math.cos(s))+","+(this._y1=a+r*Math.sin(s))))},rect:function(t,a,r,d){this._+="M"+(this._x0=this._x1=+t)+","+(this._y0=this._y1=+a)+"h"+ +r+"v"+ +d+"h"+-r+"Z"},toString:function(){return this._}},g.path=n,Object.defineProperty(g,"__esModule",{value:!0})},v("object"==typeof Q&&void 0!==ee?Q:(g=g||self).d3=g.d3||{})},{}],118:[function(y,ee,Q){var g,v;g=this,v=function(g){"use strict";function v(d,s,i,u){if(isNaN(s)||isNaN(i))return d;var f,c,h,p,o,b,l,T,_,w=d._root,k={data:u},L=d._x0,M=d._y0,I=d._x1,P=d._y1;if(!w)return d._root=k,d;for(;w.length;)if((b=s>=(c=(L+I)/2))?L=c:I=c,(l=i>=(h=(M+P)/2))?M=h:P=h,f=w,!(w=w[T=l<<1|b]))return f[T]=k,d;if(p=+d._x.call(null,w.data),o=+d._y.call(null,w.data),s===p&&i===o)return k.next=w,f?f[T]=k:d._root=k,d;do{f=f?f[T]=new Array(4):d._root=new Array(4),(b=s>=(c=(L+I)/2))?L=c:I=c,(l=i>=(h=(M+P)/2))?M=h:P=h}while((T=l<<1|b)==(_=(o>=h)<<1|p>=c));return f[_]=w,f[T]=k,d}function m(d,s,i,u,f){this.node=d,this.x0=s,this.y0=i,this.x1=u,this.y1=f}function x(d){return d[0]}function e(d){return d[1]}function n(d,s,i){var u=new t(s??x,i??e,NaN,NaN,NaN,NaN);return null==d?u:u.addAll(d)}function t(d,s,i,u,f,c){this._x=d,this._y=s,this._x0=i,this._y0=u,this._x1=f,this._y1=c,this._root=void 0}function a(d){for(var s={data:d.data},i=s;d=d.next;)i=i.next={data:d.data};return s}var r=n.prototype=t.prototype;r.copy=function(){var d,s,i=new t(this._x,this._y,this._x0,this._y0,this._x1,this._y1),u=this._root;if(!u)return i;if(!u.length)return i._root=a(u),i;for(d=[{source:u,target:i._root=new Array(4)}];u=d.pop();)for(var f=0;f<4;++f)(s=u.source[f])&&(s.length?d.push({source:s,target:u.target[f]=new Array(4)}):u.target[f]=a(s));return i},r.add=function(d){var s=+this._x.call(null,d),i=+this._y.call(null,d);return v(this.cover(s,i),s,i,d)},r.addAll=function(d){var s,i,u,f,c=d.length,h=new Array(c),p=new Array(c),o=1/0,b=1/0,l=-1/0,T=-1/0;for(i=0;i<c;++i)isNaN(u=+this._x.call(null,s=d[i]))||isNaN(f=+this._y.call(null,s))||(h[i]=u,p[i]=f,u<o&&(o=u),u>l&&(l=u),f<b&&(b=f),f>T&&(T=f));if(o>l||b>T)return this;for(this.cover(o,b).cover(l,T),i=0;i<c;++i)v(this,h[i],p[i],d[i]);return this},r.cover=function(d,s){if(isNaN(d=+d)||isNaN(s=+s))return this;var i=this._x0,u=this._y0,f=this._x1,c=this._y1;if(isNaN(i))f=(i=Math.floor(d))+1,c=(u=Math.floor(s))+1;else{for(var h,p,o=f-i,b=this._root;i>d||d>=f||u>s||s>=c;)switch(p=(s<u)<<1|d<i,(h=new Array(4))[p]=b,b=h,o*=2,p){case 0:f=i+o,c=u+o;break;case 1:i=f-o,c=u+o;break;case 2:f=i+o,u=c-o;break;case 3:i=f-o,u=c-o}this._root&&this._root.length&&(this._root=b)}return this._x0=i,this._y0=u,this._x1=f,this._y1=c,this},r.data=function(){var d=[];return this.visit(function(s){if(!s.length)do{d.push(s.data)}while(s=s.next)}),d},r.extent=function(d){return arguments.length?this.cover(+d[0][0],+d[0][1]).cover(+d[1][0],+d[1][1]):isNaN(this._x0)?void 0:[[this._x0,this._y0],[this._x1,this._y1]]},r.find=function(d,s,i){var u,f,c,h,p,o,b,l=this._x0,T=this._y0,_=this._x1,w=this._y1,k=[],L=this._root;for(L&&k.push(new m(L,l,T,_,w)),null==i?i=1/0:(l=d-i,T=s-i,_=d+i,w=s+i,i*=i);o=k.pop();)if(!(!(L=o.node)||(f=o.x0)>_||(c=o.y0)>w||(h=o.x1)<l||(p=o.y1)<T))if(L.length){var M=(f+h)/2,I=(c+p)/2;k.push(new m(L[3],M,I,h,p),new m(L[2],f,I,M,p),new m(L[1],M,c,h,I),new m(L[0],f,c,M,I)),(b=(s>=I)<<1|d>=M)&&(o=k[k.length-1],k[k.length-1]=k[k.length-1-b],k[k.length-1-b]=o)}else{var P=d-+this._x.call(null,L.data),S=s-+this._y.call(null,L.data),E=P*P+S*S;if(E<i){var z=Math.sqrt(i=E);l=d-z,T=s-z,_=d+z,w=s+z,u=L.data}}return u},r.remove=function(d){if(isNaN(c=+this._x.call(null,d))||isNaN(h=+this._y.call(null,d)))return this;var s,i,u,f,c,h,p,o,b,l,T,_,w=this._root,k=this._x0,L=this._y0,M=this._x1,I=this._y1;if(!w)return this;if(w.length)for(;;){if((b=c>=(p=(k+M)/2))?k=p:M=p,(l=h>=(o=(L+I)/2))?L=o:I=o,s=w,!(w=w[T=l<<1|b]))return this;if(!w.length)break;(s[T+1&3]||s[T+2&3]||s[T+3&3])&&(i=s,_=T)}for(;w.data!==d;)if(u=w,!(w=w.next))return this;return(f=w.next)&&delete w.next,u?(f?u.next=f:delete u.next,this):s?(f?s[T]=f:delete s[T],(w=s[0]||s[1]||s[2]||s[3])&&w===(s[3]||s[2]||s[1]||s[0])&&!w.length&&(i?i[_]=w:this._root=w),this):(this._root=f,this)},r.removeAll=function(d){for(var s=0,i=d.length;s<i;++s)this.remove(d[s]);return this},r.root=function(){return this._root},r.size=function(){var d=0;return this.visit(function(s){if(!s.length)do{++d}while(s=s.next)}),d},r.visit=function(d){var s,i,u,f,c,h,p=[],o=this._root;for(o&&p.push(new m(o,this._x0,this._y0,this._x1,this._y1));s=p.pop();)if(!d(o=s.node,u=s.x0,f=s.y0,c=s.x1,h=s.y1)&&o.length){var b=(u+c)/2,l=(f+h)/2;(i=o[3])&&p.push(new m(i,b,l,c,h)),(i=o[2])&&p.push(new m(i,u,l,b,h)),(i=o[1])&&p.push(new m(i,b,f,c,l)),(i=o[0])&&p.push(new m(i,u,f,b,l))}return this},r.visitAfter=function(d){var s,i=[],u=[];for(this._root&&i.push(new m(this._root,this._x0,this._y0,this._x1,this._y1));s=i.pop();){var f=s.node;if(f.length){var c,h=s.x0,p=s.y0,o=s.x1,b=s.y1,l=(h+o)/2,T=(p+b)/2;(c=f[0])&&i.push(new m(c,h,p,l,T)),(c=f[1])&&i.push(new m(c,l,p,o,T)),(c=f[2])&&i.push(new m(c,h,T,l,b)),(c=f[3])&&i.push(new m(c,l,T,o,b))}u.push(s)}for(;s=u.pop();)d(s.node,s.x0,s.y0,s.x1,s.y1);return this},r.x=function(d){return arguments.length?(this._x=d,this):this._x},r.y=function(d){return arguments.length?(this._y=d,this):this._y},g.quadtree=n,Object.defineProperty(g,"__esModule",{value:!0})},v("object"==typeof Q&&void 0!==ee?Q:(g=g||self).d3=g.d3||{})},{}],119:[function(y,ee,Q){var g,v;g=this,v=function(g,v){"use strict";function m(Ee){return function(){return Ee}}var x=Math.abs,e=Math.atan2,n=Math.cos,t=Math.max,a=Math.min,r=Math.sin,d=Math.sqrt,s=Math.PI,i=s/2,u=2*s;function f(Ee){return Ee>1?0:Ee<-1?s:Math.acos(Ee)}function c(Ee){return Ee>=1?i:Ee<=-1?-i:Math.asin(Ee)}function h(Ee){return Ee.innerRadius}function p(Ee){return Ee.outerRadius}function o(Ee){return Ee.startAngle}function b(Ee){return Ee.endAngle}function l(Ee){return Ee&&Ee.padAngle}function T(Ee,Ye,it,ht,At,Ft,Gt,jt){var fr=it-Ee,kr=ht-Ye,ur=Gt-At,Jt=jt-Ft,$t=Jt*fr-ur*kr;if(!($t*$t<1e-12))return[Ee+($t=(ur*(Ye-Ft)-Jt*(Ee-At))/$t)*fr,Ye+$t*kr]}function _(Ee,Ye,it,ht,At,Ft,Gt){var jt=Ee-it,fr=Ye-ht,kr=(Gt?Ft:-Ft)/d(jt*jt+fr*fr),ur=kr*fr,Jt=-kr*jt,$t=Ee+ur,Qt=Ye+Jt,cr=it+ur,gr=ht+Jt,Tr=($t+cr)/2,Fr=(Qt+gr)/2,Nr=cr-$t,Xr=gr-Qt,un=Nr*Nr+Xr*Xr,$r=At-Ft,Pn=$t*gr-cr*Qt,gn=(Xr<0?-1:1)*d(t(0,$r*$r*un-Pn*Pn)),dn=(Pn*Xr-Nr*gn)/un,An=(-Pn*Nr-Xr*gn)/un,Zn=(Pn*Xr+Nr*gn)/un,Rr=(-Pn*Nr+Xr*gn)/un,hn=dn-Tr,nn=An-Fr,Hr=Zn-Tr,Fn=Rr-Fr;return hn*hn+nn*nn>Hr*Hr+Fn*Fn&&(dn=Zn,An=Rr),{cx:dn,cy:An,x01:-ur,y01:-Jt,x11:dn*(At/$r-1),y11:An*(At/$r-1)}}function w(Ee){this._context=Ee}function k(Ee){return new w(Ee)}function L(Ee){return Ee[0]}function M(Ee){return Ee[1]}function I(){var Ee=L,Ye=M,it=m(!0),ht=null,At=k,Ft=null;function Gt(jt){var fr,kr,ur,Jt=jt.length,$t=!1;for(null==ht&&(Ft=At(ur=v.path())),fr=0;fr<=Jt;++fr)!(fr<Jt&&it(kr=jt[fr],fr,jt))===$t&&(($t=!$t)?Ft.lineStart():Ft.lineEnd()),$t&&Ft.point(+Ee(kr,fr,jt),+Ye(kr,fr,jt));if(ur)return Ft=null,ur+""||null}return Gt.x=function(jt){return arguments.length?(Ee="function"==typeof jt?jt:m(+jt),Gt):Ee},Gt.y=function(jt){return arguments.length?(Ye="function"==typeof jt?jt:m(+jt),Gt):Ye},Gt.defined=function(jt){return arguments.length?(it="function"==typeof jt?jt:m(!!jt),Gt):it},Gt.curve=function(jt){return arguments.length?(At=jt,null!=ht&&(Ft=At(ht)),Gt):At},Gt.context=function(jt){return arguments.length?(null==jt?ht=Ft=null:Ft=At(ht=jt),Gt):ht},Gt}function P(){var Ee=L,Ye=null,it=m(0),ht=M,At=m(!0),Ft=null,Gt=k,jt=null;function fr(ur){var Jt,$t,Qt,cr,gr,Tr=ur.length,Fr=!1,Nr=new Array(Tr),Xr=new Array(Tr);for(null==Ft&&(jt=Gt(gr=v.path())),Jt=0;Jt<=Tr;++Jt){if(!(Jt<Tr&&At(cr=ur[Jt],Jt,ur))===Fr)if(Fr=!Fr)$t=Jt,jt.areaStart(),jt.lineStart();else{for(jt.lineEnd(),jt.lineStart(),Qt=Jt-1;Qt>=$t;--Qt)jt.point(Nr[Qt],Xr[Qt]);jt.lineEnd(),jt.areaEnd()}Fr&&(Nr[Jt]=+Ee(cr,Jt,ur),Xr[Jt]=+it(cr,Jt,ur),jt.point(Ye?+Ye(cr,Jt,ur):Nr[Jt],ht?+ht(cr,Jt,ur):Xr[Jt]))}if(gr)return jt=null,gr+""||null}function kr(){return I().defined(At).curve(Gt).context(Ft)}return fr.x=function(ur){return arguments.length?(Ee="function"==typeof ur?ur:m(+ur),Ye=null,fr):Ee},fr.x0=function(ur){return arguments.length?(Ee="function"==typeof ur?ur:m(+ur),fr):Ee},fr.x1=function(ur){return arguments.length?(Ye=null==ur?null:"function"==typeof ur?ur:m(+ur),fr):Ye},fr.y=function(ur){return arguments.length?(it="function"==typeof ur?ur:m(+ur),ht=null,fr):it},fr.y0=function(ur){return arguments.length?(it="function"==typeof ur?ur:m(+ur),fr):it},fr.y1=function(ur){return arguments.length?(ht=null==ur?null:"function"==typeof ur?ur:m(+ur),fr):ht},fr.lineX0=fr.lineY0=function(){return kr().x(Ee).y(it)},fr.lineY1=function(){return kr().x(Ee).y(ht)},fr.lineX1=function(){return kr().x(Ye).y(it)},fr.defined=function(ur){return arguments.length?(At="function"==typeof ur?ur:m(!!ur),fr):At},fr.curve=function(ur){return arguments.length?(Gt=ur,null!=Ft&&(jt=Gt(Ft)),fr):Gt},fr.context=function(ur){return arguments.length?(null==ur?Ft=jt=null:jt=Gt(Ft=ur),fr):Ft},fr}function S(Ee,Ye){return Ye<Ee?-1:Ye>Ee?1:Ye>=Ee?0:NaN}function E(Ee){return Ee}w.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(Ee,Ye){switch(Ee=+Ee,Ye=+Ye,this._point){case 0:this._point=1,this._line?this._context.lineTo(Ee,Ye):this._context.moveTo(Ee,Ye);break;case 1:this._point=2;default:this._context.lineTo(Ee,Ye)}}};var z=q(k);function R(Ee){this._curve=Ee}function q(Ee){function Ye(it){return new R(Ee(it))}return Ye._curve=Ee,Ye}function V(Ee){var Ye=Ee.curve;return Ee.angle=Ee.x,delete Ee.x,Ee.radius=Ee.y,delete Ee.y,Ee.curve=function(it){return arguments.length?Ye(q(it)):Ye()._curve},Ee}function W(){return V(I().curve(z))}function K(){var Ee=P().curve(z),Ye=Ee.curve,it=Ee.lineX0,ht=Ee.lineX1,At=Ee.lineY0,Ft=Ee.lineY1;return Ee.angle=Ee.x,delete Ee.x,Ee.startAngle=Ee.x0,delete Ee.x0,Ee.endAngle=Ee.x1,delete Ee.x1,Ee.radius=Ee.y,delete Ee.y,Ee.innerRadius=Ee.y0,delete Ee.y0,Ee.outerRadius=Ee.y1,delete Ee.y1,Ee.lineStartAngle=function(){return V(it())},delete Ee.lineX0,Ee.lineEndAngle=function(){return V(ht())},delete Ee.lineX1,Ee.lineInnerRadius=function(){return V(At())},delete Ee.lineY0,Ee.lineOuterRadius=function(){return V(Ft())},delete Ee.lineY1,Ee.curve=function(Gt){return arguments.length?Ye(q(Gt)):Ye()._curve},Ee}function G(Ee,Ye){return[(Ye=+Ye)*Math.cos(Ee-=Math.PI/2),Ye*Math.sin(Ee)]}R.prototype={areaStart:function(){this._curve.areaStart()},areaEnd:function(){this._curve.areaEnd()},lineStart:function(){this._curve.lineStart()},lineEnd:function(){this._curve.lineEnd()},point:function(Ee,Ye){this._curve.point(Ye*Math.sin(Ee),Ye*-Math.cos(Ee))}};var Y=Array.prototype.slice;function $(Ee){return Ee.source}function B(Ee){return Ee.target}function N(Ee){var Ye=$,it=B,ht=L,At=M,Ft=null;function Gt(){var jt,fr=Y.call(arguments),kr=Ye.apply(this,fr),ur=it.apply(this,fr);if(Ft||(Ft=jt=v.path()),Ee(Ft,+ht.apply(this,(fr[0]=kr,fr)),+At.apply(this,fr),+ht.apply(this,(fr[0]=ur,fr)),+At.apply(this,fr)),jt)return Ft=null,jt+""||null}return Gt.source=function(jt){return arguments.length?(Ye=jt,Gt):Ye},Gt.target=function(jt){return arguments.length?(it=jt,Gt):it},Gt.x=function(jt){return arguments.length?(ht="function"==typeof jt?jt:m(+jt),Gt):ht},Gt.y=function(jt){return arguments.length?(At="function"==typeof jt?jt:m(+jt),Gt):At},Gt.context=function(jt){return arguments.length?(Ft=jt??null,Gt):Ft},Gt}function U(Ee,Ye,it,ht,At){Ee.moveTo(Ye,it),Ee.bezierCurveTo(Ye=(Ye+ht)/2,it,Ye,At,ht,At)}function te(Ee,Ye,it,ht,At){Ee.moveTo(Ye,it),Ee.bezierCurveTo(Ye,it=(it+At)/2,ht,it,ht,At)}function j(Ee,Ye,it,ht,At){var Ft=G(Ye,it),Gt=G(Ye,it=(it+At)/2),jt=G(ht,it),fr=G(ht,At);Ee.moveTo(Ft[0],Ft[1]),Ee.bezierCurveTo(Gt[0],Gt[1],jt[0],jt[1],fr[0],fr[1])}var J={draw:function(Ee,Ye){var it=Math.sqrt(Ye/s);Ee.moveTo(it,0),Ee.arc(0,0,it,0,u)}},X={draw:function(Ee,Ye){var it=Math.sqrt(Ye/5)/2;Ee.moveTo(-3*it,-it),Ee.lineTo(-it,-it),Ee.lineTo(-it,-3*it),Ee.lineTo(it,-3*it),Ee.lineTo(it,-it),Ee.lineTo(3*it,-it),Ee.lineTo(3*it,it),Ee.lineTo(it,it),Ee.lineTo(it,3*it),Ee.lineTo(-it,3*it),Ee.lineTo(-it,it),Ee.lineTo(-3*it,it),Ee.closePath()}},re=Math.sqrt(1/3),ne=2*re,le={draw:function(Ee,Ye){var it=Math.sqrt(Ye/ne),ht=it*re;Ee.moveTo(0,-it),Ee.lineTo(ht,0),Ee.lineTo(0,it),Ee.lineTo(-ht,0),Ee.closePath()}},oe=Math.sin(s/10)/Math.sin(7*s/10),de=Math.sin(u/10)*oe,se=-Math.cos(u/10)*oe,ge={draw:function(Ee,Ye){var it=Math.sqrt(.8908130915292852*Ye),ht=de*it,At=se*it;Ee.moveTo(0,-it),Ee.lineTo(ht,At);for(var Ft=1;Ft<5;++Ft){var Gt=u*Ft/5,jt=Math.cos(Gt),fr=Math.sin(Gt);Ee.lineTo(fr*it,-jt*it),Ee.lineTo(jt*ht-fr*At,fr*ht+jt*At)}Ee.closePath()}},_e={draw:function(Ee,Ye){var it=Math.sqrt(Ye),ht=-it/2;Ee.rect(ht,ht,it,it)}},Te=Math.sqrt(3),we={draw:function(Ee,Ye){var it=-Math.sqrt(Ye/(3*Te));Ee.moveTo(0,2*it),Ee.lineTo(-Te*it,-it),Ee.lineTo(Te*it,-it),Ee.closePath()}},Oe=-.5,fe=Math.sqrt(3)/2,ve=1/Math.sqrt(12),Ae=3*(ve/2+1),ke={draw:function(Ee,Ye){var it=Math.sqrt(Ye/Ae),ht=it/2,At=it*ve,Ft=ht,Gt=it*ve+it,jt=-Ft,fr=Gt;Ee.moveTo(ht,At),Ee.lineTo(Ft,Gt),Ee.lineTo(jt,fr),Ee.lineTo(Oe*ht-fe*At,fe*ht+Oe*At),Ee.lineTo(Oe*Ft-fe*Gt,fe*Ft+Oe*Gt),Ee.lineTo(Oe*jt-fe*fr,fe*jt+Oe*fr),Ee.lineTo(Oe*ht+fe*At,Oe*At-fe*ht),Ee.lineTo(Oe*Ft+fe*Gt,Oe*Gt-fe*Ft),Ee.lineTo(Oe*jt+fe*fr,Oe*fr-fe*jt),Ee.closePath()}},Pe=[J,X,le,_e,ge,we,ke];function Ne(){}function De(Ee,Ye,it){Ee._context.bezierCurveTo((2*Ee._x0+Ee._x1)/3,(2*Ee._y0+Ee._y1)/3,(Ee._x0+2*Ee._x1)/3,(Ee._y0+2*Ee._y1)/3,(Ee._x0+4*Ee._x1+Ye)/6,(Ee._y0+4*Ee._y1+it)/6)}function ze(Ee){this._context=Ee}function Me(Ee){this._context=Ee}function Se(Ee){this._context=Ee}function Ie(Ee,Ye){this._basis=new ze(Ee),this._beta=Ye}ze.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:De(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1)}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(Ee,Ye){switch(Ee=+Ee,Ye=+Ye,this._point){case 0:this._point=1,this._line?this._context.lineTo(Ee,Ye):this._context.moveTo(Ee,Ye);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:De(this,Ee,Ye)}this._x0=this._x1,this._x1=Ee,this._y0=this._y1,this._y1=Ye}},Me.prototype={areaStart:Ne,areaEnd:Ne,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:this._context.moveTo(this._x2,this._y2),this._context.closePath();break;case 2:this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break;case 3:this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4)}},point:function(Ee,Ye){switch(Ee=+Ee,Ye=+Ye,this._point){case 0:this._point=1,this._x2=Ee,this._y2=Ye;break;case 1:this._point=2,this._x3=Ee,this._y3=Ye;break;case 2:this._point=3,this._x4=Ee,this._y4=Ye,this._context.moveTo((this._x0+4*this._x1+Ee)/6,(this._y0+4*this._y1+Ye)/6);break;default:De(this,Ee,Ye)}this._x0=this._x1,this._x1=Ee,this._y0=this._y1,this._y1=Ye}},Se.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||0!==this._line&&3===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(Ee,Ye){switch(Ee=+Ee,Ye=+Ye,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var it=(this._x0+4*this._x1+Ee)/6,ht=(this._y0+4*this._y1+Ye)/6;this._line?this._context.lineTo(it,ht):this._context.moveTo(it,ht);break;case 3:this._point=4;default:De(this,Ee,Ye)}this._x0=this._x1,this._x1=Ee,this._y0=this._y1,this._y1=Ye}},Ie.prototype={lineStart:function(){this._x=[],this._y=[],this._basis.lineStart()},lineEnd:function(){var Ee=this._x,Ye=this._y,it=Ee.length-1;if(it>0)for(var ht,At=Ee[0],Ft=Ye[0],Gt=Ee[it]-At,jt=Ye[it]-Ft,fr=-1;++fr<=it;)this._basis.point(this._beta*Ee[fr]+(1-this._beta)*(At+(ht=fr/it)*Gt),this._beta*Ye[fr]+(1-this._beta)*(Ft+ht*jt));this._x=this._y=null,this._basis.lineEnd()},point:function(Ee,Ye){this._x.push(+Ee),this._y.push(+Ye)}};var Fe=function Ee(Ye){function it(ht){return 1===Ye?new ze(ht):new Ie(ht,Ye)}return it.beta=function(ht){return Ee(+ht)},it}(.85);function Re(Ee,Ye,it){Ee._context.bezierCurveTo(Ee._x1+Ee._k*(Ee._x2-Ee._x0),Ee._y1+Ee._k*(Ee._y2-Ee._y0),Ee._x2+Ee._k*(Ee._x1-Ye),Ee._y2+Ee._k*(Ee._y1-it),Ee._x2,Ee._y2)}function Xe(Ee,Ye){this._context=Ee,this._k=(1-Ye)/6}Xe.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:Re(this,this._x1,this._y1)}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(Ee,Ye){switch(Ee=+Ee,Ye=+Ye,this._point){case 0:this._point=1,this._line?this._context.lineTo(Ee,Ye):this._context.moveTo(Ee,Ye);break;case 1:this._point=2,this._x1=Ee,this._y1=Ye;break;case 2:this._point=3;default:Re(this,Ee,Ye)}this._x0=this._x1,this._x1=this._x2,this._x2=Ee,this._y0=this._y1,this._y1=this._y2,this._y2=Ye}};var nt=function Ee(Ye){function it(ht){return new Xe(ht,Ye)}return it.tension=function(ht){return Ee(+ht)},it}(0);function ct(Ee,Ye){this._context=Ee,this._k=(1-Ye)/6}ct.prototype={areaStart:Ne,areaEnd:Ne,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:this._context.moveTo(this._x3,this._y3),this._context.closePath();break;case 2:this._context.lineTo(this._x3,this._y3),this._context.closePath();break;case 3:this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5)}},point:function(Ee,Ye){switch(Ee=+Ee,Ye=+Ye,this._point){case 0:this._point=1,this._x3=Ee,this._y3=Ye;break;case 1:this._point=2,this._context.moveTo(this._x4=Ee,this._y4=Ye);break;case 2:this._point=3,this._x5=Ee,this._y5=Ye;break;default:Re(this,Ee,Ye)}this._x0=this._x1,this._x1=this._x2,this._x2=Ee,this._y0=this._y1,this._y1=this._y2,this._y2=Ye}};var xt=function Ee(Ye){function it(ht){return new ct(ht,Ye)}return it.tension=function(ht){return Ee(+ht)},it}(0);function dt(Ee,Ye){this._context=Ee,this._k=(1-Ye)/6}dt.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){(this._line||0!==this._line&&3===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(Ee,Ye){switch(Ee=+Ee,Ye=+Ye,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:Re(this,Ee,Ye)}this._x0=this._x1,this._x1=this._x2,this._x2=Ee,this._y0=this._y1,this._y1=this._y2,this._y2=Ye}};var tt=function Ee(Ye){function it(ht){return new dt(ht,Ye)}return it.tension=function(ht){return Ee(+ht)},it}(0);function Ke(Ee,Ye,it){var ht=Ee._x1,At=Ee._y1,Ft=Ee._x2,Gt=Ee._y2;if(Ee._l01_a>1e-12){var jt=2*Ee._l01_2a+3*Ee._l01_a*Ee._l12_a+Ee._l12_2a,fr=3*Ee._l01_a*(Ee._l01_a+Ee._l12_a);ht=(ht*jt-Ee._x0*Ee._l12_2a+Ee._x2*Ee._l01_2a)/fr,At=(At*jt-Ee._y0*Ee._l12_2a+Ee._y2*Ee._l01_2a)/fr}if(Ee._l23_a>1e-12){var kr=2*Ee._l23_2a+3*Ee._l23_a*Ee._l12_a+Ee._l12_2a,ur=3*Ee._l23_a*(Ee._l23_a+Ee._l12_a);Ft=(Ft*kr+Ee._x1*Ee._l23_2a-Ye*Ee._l12_2a)/ur,Gt=(Gt*kr+Ee._y1*Ee._l23_2a-it*Ee._l12_2a)/ur}Ee._context.bezierCurveTo(ht,At,Ft,Gt,Ee._x2,Ee._y2)}function mt(Ee,Ye){this._context=Ee,this._alpha=Ye}mt.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:this.point(this._x2,this._y2)}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(Ee,Ye){if(Ee=+Ee,Ye=+Ye,this._point){var it=this._x2-Ee,ht=this._y2-Ye;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(it*it+ht*ht,this._alpha))}switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(Ee,Ye):this._context.moveTo(Ee,Ye);break;case 1:this._point=2;break;case 2:this._point=3;default:Ke(this,Ee,Ye)}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=Ee,this._y0=this._y1,this._y1=this._y2,this._y2=Ye}};var Bt=function Ee(Ye){function it(ht){return Ye?new mt(ht,Ye):new Xe(ht,0)}return it.alpha=function(ht){return Ee(+ht)},it}(.5);function Ut(Ee,Ye){this._context=Ee,this._alpha=Ye}Ut.prototype={areaStart:Ne,areaEnd:Ne,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 1:this._context.moveTo(this._x3,this._y3),this._context.closePath();break;case 2:this._context.lineTo(this._x3,this._y3),this._context.closePath();break;case 3:this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5)}},point:function(Ee,Ye){if(Ee=+Ee,Ye=+Ye,this._point){var it=this._x2-Ee,ht=this._y2-Ye;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(it*it+ht*ht,this._alpha))}switch(this._point){case 0:this._point=1,this._x3=Ee,this._y3=Ye;break;case 1:this._point=2,this._context.moveTo(this._x4=Ee,this._y4=Ye);break;case 2:this._point=3,this._x5=Ee,this._y5=Ye;break;default:Ke(this,Ee,Ye)}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=Ee,this._y0=this._y1,this._y1=this._y2,this._y2=Ye}};var er=function Ee(Ye){function it(ht){return Ye?new Ut(ht,Ye):new ct(ht,0)}return it.alpha=function(ht){return Ee(+ht)},it}(.5);function Wt(Ee,Ye){this._context=Ee,this._alpha=Ye}Wt.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){(this._line||0!==this._line&&3===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(Ee,Ye){if(Ee=+Ee,Ye=+Ye,this._point){var it=this._x2-Ee,ht=this._y2-Ye;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(it*it+ht*ht,this._alpha))}switch(this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:Ke(this,Ee,Ye)}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=Ee,this._y0=this._y1,this._y1=this._y2,this._y2=Ye}};var rr=function Ee(Ye){function it(ht){return Ye?new Wt(ht,Ye):new dt(ht,0)}return it.alpha=function(ht){return Ee(+ht)},it}(.5);function Ht(Ee){this._context=Ee}function Ve(Ee){return Ee<0?-1:1}function We(Ee,Ye,it){var ht=Ee._x1-Ee._x0,At=Ye-Ee._x1,Ft=(Ee._y1-Ee._y0)/(ht||At<0&&-0),Gt=(it-Ee._y1)/(At||ht<0&&-0),jt=(Ft*At+Gt*ht)/(ht+At);return(Ve(Ft)+Ve(Gt))*Math.min(Math.abs(Ft),Math.abs(Gt),.5*Math.abs(jt))||0}function he(Ee,Ye){var it=Ee._x1-Ee._x0;return it?(3*(Ee._y1-Ee._y0)/it-Ye)/2:Ye}function ye(Ee,Ye,it){var ht=Ee._x0,Ft=Ee._x1,Gt=Ee._y1,jt=(Ft-ht)/3;Ee._context.bezierCurveTo(ht+jt,Ee._y0+jt*Ye,Ft-jt,Gt-jt*it,Ft,Gt)}function Be(Ee){this._context=Ee}function Ge(Ee){this._context=new Je(Ee)}function Je(Ee){this._context=Ee}function He(Ee){this._context=Ee}function st(Ee){var Ye,it,ht=Ee.length-1,At=new Array(ht),Ft=new Array(ht),Gt=new Array(ht);for(At[0]=0,Ft[0]=2,Gt[0]=Ee[0]+2*Ee[1],Ye=1;Ye<ht-1;++Ye)At[Ye]=1,Ft[Ye]=4,Gt[Ye]=4*Ee[Ye]+2*Ee[Ye+1];for(At[ht-1]=2,Ft[ht-1]=7,Gt[ht-1]=8*Ee[ht-1]+Ee[ht],Ye=1;Ye<ht;++Ye)Ft[Ye]-=it=At[Ye]/Ft[Ye-1],Gt[Ye]-=it*Gt[Ye-1];for(At[ht-1]=Gt[ht-1]/Ft[ht-1],Ye=ht-2;Ye>=0;--Ye)At[Ye]=(Gt[Ye]-At[Ye+1])/Ft[Ye];for(Ft[ht-1]=(Ee[ht]+At[ht-1])/2,Ye=0;Ye<ht-1;++Ye)Ft[Ye]=2*Ee[Ye+1]-At[Ye+1];return[At,Ft]}function ot(Ee,Ye){this._context=Ee,this._t=Ye}function wt(Ee,Ye){if((At=Ee.length)>1)for(var it,ht,At,Ft=1,Gt=Ee[Ye[0]],jt=Gt.length;Ft<At;++Ft)for(ht=Gt,Gt=Ee[Ye[Ft]],it=0;it<jt;++it)Gt[it][1]+=Gt[it][0]=isNaN(ht[it][1])?ht[it][0]:ht[it][1]}function Ct(Ee){for(var Ye=Ee.length,it=new Array(Ye);--Ye>=0;)it[Ye]=Ye;return it}function rt(Ee,Ye){return Ee[Ye]}function ft(Ee){var Ye=Ee.map(Rt);return Ct(Ee).sort(function(it,ht){return Ye[it]-Ye[ht]})}function Rt(Ee){for(var Ye,it=-1,ht=0,At=Ee.length,Ft=-1/0;++it<At;)(Ye=+Ee[it][1])>Ft&&(Ft=Ye,ht=it);return ht}function kt(Ee){var Ye=Ee.map(Lt);return Ct(Ee).sort(function(it,ht){return Ye[it]-Ye[ht]})}function Lt(Ee){for(var Ye,it=0,ht=-1,At=Ee.length;++ht<At;)(Ye=+Ee[ht][1])&&(it+=Ye);return it}Ht.prototype={areaStart:Ne,areaEnd:Ne,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(Ee,Ye){Ee=+Ee,Ye=+Ye,this._point?this._context.lineTo(Ee,Ye):(this._point=1,this._context.moveTo(Ee,Ye))}},Be.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:ye(this,this._t0,he(this,this._t0))}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(Ee,Ye){var it=NaN;if(Ye=+Ye,(Ee=+Ee)!==this._x1||Ye!==this._y1){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(Ee,Ye):this._context.moveTo(Ee,Ye);break;case 1:this._point=2;break;case 2:this._point=3,ye(this,he(this,it=We(this,Ee,Ye)),it);break;default:ye(this,this._t0,it=We(this,Ee,Ye))}this._x0=this._x1,this._x1=Ee,this._y0=this._y1,this._y1=Ye,this._t0=it}}},(Ge.prototype=Object.create(Be.prototype)).point=function(Ee,Ye){Be.prototype.point.call(this,Ye,Ee)},Je.prototype={moveTo:function(Ee,Ye){this._context.moveTo(Ye,Ee)},closePath:function(){this._context.closePath()},lineTo:function(Ee,Ye){this._context.lineTo(Ye,Ee)},bezierCurveTo:function(Ee,Ye,it,ht,At,Ft){this._context.bezierCurveTo(Ye,Ee,ht,it,Ft,At)}},He.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var Ee=this._x,Ye=this._y,it=Ee.length;if(it)if(this._line?this._context.lineTo(Ee[0],Ye[0]):this._context.moveTo(Ee[0],Ye[0]),2===it)this._context.lineTo(Ee[1],Ye[1]);else for(var ht=st(Ee),At=st(Ye),Ft=0,Gt=1;Gt<it;++Ft,++Gt)this._context.bezierCurveTo(ht[0][Ft],At[0][Ft],ht[1][Ft],At[1][Ft],Ee[Gt],Ye[Gt]);(this._line||0!==this._line&&1===it)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(Ee,Ye){this._x.push(+Ee),this._y.push(+Ye)}},ot.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&2===this._point&&this._context.lineTo(this._x,this._y),(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(Ee,Ye){switch(Ee=+Ee,Ye=+Ye,this._point){case 0:this._point=1,this._line?this._context.lineTo(Ee,Ye):this._context.moveTo(Ee,Ye);break;case 1:this._point=2;default:if(this._t<=0)this._context.lineTo(this._x,Ye),this._context.lineTo(Ee,Ye);else{var it=this._x*(1-this._t)+Ee*this._t;this._context.lineTo(it,this._y),this._context.lineTo(it,Ye)}}this._x=Ee,this._y=Ye}},g.arc=function(){var Ee=h,Ye=p,it=m(0),ht=null,At=o,Ft=b,Gt=l,jt=null;function fr(){var kr,ur,Jt=+Ee.apply(this,arguments),$t=+Ye.apply(this,arguments),Qt=At.apply(this,arguments)-i,cr=Ft.apply(this,arguments)-i,gr=x(cr-Qt),Tr=cr>Qt;if(jt||(jt=kr=v.path()),$t<Jt&&(ur=$t,$t=Jt,Jt=ur),$t>1e-12)if(gr>u-1e-12)jt.moveTo($t*n(Qt),$t*r(Qt)),jt.arc(0,0,$t,Qt,cr,!Tr),Jt>1e-12&&(jt.moveTo(Jt*n(cr),Jt*r(cr)),jt.arc(0,0,Jt,cr,Qt,Tr));else{var Fr,Nr,Xr=Qt,un=cr,$r=Qt,Pn=cr,gn=gr,dn=gr,An=Gt.apply(this,arguments)/2,Zn=An>1e-12&&(ht?+ht.apply(this,arguments):d(Jt*Jt+$t*$t)),Rr=a(x($t-Jt)/2,+it.apply(this,arguments)),hn=Rr,nn=Rr;if(Zn>1e-12){var Hr=c(Zn/Jt*r(An)),Fn=c(Zn/$t*r(An));(gn-=2*Hr)>1e-12?($r+=Hr*=Tr?1:-1,Pn-=Hr):(gn=0,$r=Pn=(Qt+cr)/2),(dn-=2*Fn)>1e-12?(Xr+=Fn*=Tr?1:-1,un-=Fn):(dn=0,Xr=un=(Qt+cr)/2)}var Un=$t*n(Xr),vn=$t*r(Xr),Cn=Jt*n(Pn),li=Jt*r(Pn);if(Rr>1e-12){var tr,mr=$t*n(un),Pt=$t*r(un),or=Jt*n($r),hr=Jt*r($r);if(gr<s&&(tr=T(Un,vn,or,hr,mr,Pt,Cn,li))){var zr=Un-tr[0],Dr=vn-tr[1],Ir=mr-tr[0],Mr=Pt-tr[1],vr=1/r(f((zr*Ir+Dr*Mr)/(d(zr*zr+Dr*Dr)*d(Ir*Ir+Mr*Mr)))/2),xr=d(tr[0]*tr[0]+tr[1]*tr[1]);hn=a(Rr,(Jt-xr)/(vr-1)),nn=a(Rr,($t-xr)/(vr+1))}}dn>1e-12?nn>1e-12?(Fr=_(or,hr,Un,vn,$t,nn,Tr),Nr=_(mr,Pt,Cn,li,$t,nn,Tr),jt.moveTo(Fr.cx+Fr.x01,Fr.cy+Fr.y01),nn<Rr?jt.arc(Fr.cx,Fr.cy,nn,e(Fr.y01,Fr.x01),e(Nr.y01,Nr.x01),!Tr):(jt.arc(Fr.cx,Fr.cy,nn,e(Fr.y01,Fr.x01),e(Fr.y11,Fr.x11),!Tr),jt.arc(0,0,$t,e(Fr.cy+Fr.y11,Fr.cx+Fr.x11),e(Nr.cy+Nr.y11,Nr.cx+Nr.x11),!Tr),jt.arc(Nr.cx,Nr.cy,nn,e(Nr.y11,Nr.x11),e(Nr.y01,Nr.x01),!Tr))):(jt.moveTo(Un,vn),jt.arc(0,0,$t,Xr,un,!Tr)):jt.moveTo(Un,vn),Jt>1e-12&&gn>1e-12?hn>1e-12?(Fr=_(Cn,li,mr,Pt,Jt,-hn,Tr),Nr=_(Un,vn,or,hr,Jt,-hn,Tr),jt.lineTo(Fr.cx+Fr.x01,Fr.cy+Fr.y01),hn<Rr?jt.arc(Fr.cx,Fr.cy,hn,e(Fr.y01,Fr.x01),e(Nr.y01,Nr.x01),!Tr):(jt.arc(Fr.cx,Fr.cy,hn,e(Fr.y01,Fr.x01),e(Fr.y11,Fr.x11),!Tr),jt.arc(0,0,Jt,e(Fr.cy+Fr.y11,Fr.cx+Fr.x11),e(Nr.cy+Nr.y11,Nr.cx+Nr.x11),Tr),jt.arc(Nr.cx,Nr.cy,hn,e(Nr.y11,Nr.x11),e(Nr.y01,Nr.x01),!Tr))):jt.arc(0,0,Jt,Pn,$r,Tr):jt.lineTo(Cn,li)}else jt.moveTo(0,0);if(jt.closePath(),kr)return jt=null,kr+""||null}return fr.centroid=function(){var kr=(+Ee.apply(this,arguments)+ +Ye.apply(this,arguments))/2,ur=(+At.apply(this,arguments)+ +Ft.apply(this,arguments))/2-s/2;return[n(ur)*kr,r(ur)*kr]},fr.innerRadius=function(kr){return arguments.length?(Ee="function"==typeof kr?kr:m(+kr),fr):Ee},fr.outerRadius=function(kr){return arguments.length?(Ye="function"==typeof kr?kr:m(+kr),fr):Ye},fr.cornerRadius=function(kr){return arguments.length?(it="function"==typeof kr?kr:m(+kr),fr):it},fr.padRadius=function(kr){return arguments.length?(ht=null==kr?null:"function"==typeof kr?kr:m(+kr),fr):ht},fr.startAngle=function(kr){return arguments.length?(At="function"==typeof kr?kr:m(+kr),fr):At},fr.endAngle=function(kr){return arguments.length?(Ft="function"==typeof kr?kr:m(+kr),fr):Ft},fr.padAngle=function(kr){return arguments.length?(Gt="function"==typeof kr?kr:m(+kr),fr):Gt},fr.context=function(kr){return arguments.length?(jt=kr??null,fr):jt},fr},g.area=P,g.areaRadial=K,g.curveBasis=function(Ee){return new ze(Ee)},g.curveBasisClosed=function(Ee){return new Me(Ee)},g.curveBasisOpen=function(Ee){return new Se(Ee)},g.curveBundle=Fe,g.curveCardinal=nt,g.curveCardinalClosed=xt,g.curveCardinalOpen=tt,g.curveCatmullRom=Bt,g.curveCatmullRomClosed=er,g.curveCatmullRomOpen=rr,g.curveLinear=k,g.curveLinearClosed=function(Ee){return new Ht(Ee)},g.curveMonotoneX=function(Ee){return new Be(Ee)},g.curveMonotoneY=function(Ee){return new Ge(Ee)},g.curveNatural=function(Ee){return new He(Ee)},g.curveStep=function(Ee){return new ot(Ee,.5)},g.curveStepAfter=function(Ee){return new ot(Ee,1)},g.curveStepBefore=function(Ee){return new ot(Ee,0)},g.line=I,g.lineRadial=W,g.linkHorizontal=function(){return N(U)},g.linkRadial=function(){var Ee=N(j);return Ee.angle=Ee.x,delete Ee.x,Ee.radius=Ee.y,delete Ee.y,Ee},g.linkVertical=function(){return N(te)},g.pie=function(){var Ee=E,Ye=S,it=null,ht=m(0),At=m(u),Ft=m(0);function Gt(jt){var fr,kr,ur,Jt,$t,Qt=jt.length,cr=0,gr=new Array(Qt),Tr=new Array(Qt),Fr=+ht.apply(this,arguments),Nr=Math.min(u,Math.max(-u,At.apply(this,arguments)-Fr)),Xr=Math.min(Math.abs(Nr)/Qt,Ft.apply(this,arguments)),un=Xr*(Nr<0?-1:1);for(fr=0;fr<Qt;++fr)($t=Tr[gr[fr]=fr]=+Ee(jt[fr],fr,jt))>0&&(cr+=$t);for(null!=Ye?gr.sort(function($r,Pn){return Ye(Tr[$r],Tr[Pn])}):null!=it&&gr.sort(function($r,Pn){return it(jt[$r],jt[Pn])}),fr=0,ur=cr?(Nr-Qt*un)/cr:0;fr<Qt;++fr,Fr=Jt)Jt=Fr+(($t=Tr[kr=gr[fr]])>0?$t*ur:0)+un,Tr[kr]={data:jt[kr],index:fr,value:$t,startAngle:Fr,endAngle:Jt,padAngle:Xr};return Tr}return Gt.value=function(jt){return arguments.length?(Ee="function"==typeof jt?jt:m(+jt),Gt):Ee},Gt.sortValues=function(jt){return arguments.length?(Ye=jt,it=null,Gt):Ye},Gt.sort=function(jt){return arguments.length?(it=jt,Ye=null,Gt):it},Gt.startAngle=function(jt){return arguments.length?(ht="function"==typeof jt?jt:m(+jt),Gt):ht},Gt.endAngle=function(jt){return arguments.length?(At="function"==typeof jt?jt:m(+jt),Gt):At},Gt.padAngle=function(jt){return arguments.length?(Ft="function"==typeof jt?jt:m(+jt),Gt):Ft},Gt},g.pointRadial=G,g.radialArea=K,g.radialLine=W,g.stack=function(){var Ee=m([]),Ye=Ct,it=wt,ht=rt;function At(Ft){var Gt,jt,fr=Ee.apply(this,arguments),kr=Ft.length,ur=fr.length,Jt=new Array(ur);for(Gt=0;Gt<ur;++Gt){for(var $t,Qt=fr[Gt],cr=Jt[Gt]=new Array(kr),gr=0;gr<kr;++gr)cr[gr]=$t=[0,+ht(Ft[gr],Qt,gr,Ft)],$t.data=Ft[gr];cr.key=Qt}for(Gt=0,jt=Ye(Jt);Gt<ur;++Gt)Jt[jt[Gt]].index=Gt;return it(Jt,jt),Jt}return At.keys=function(Ft){return arguments.length?(Ee="function"==typeof Ft?Ft:m(Y.call(Ft)),At):Ee},At.value=function(Ft){return arguments.length?(ht="function"==typeof Ft?Ft:m(+Ft),At):ht},At.order=function(Ft){return arguments.length?(Ye=null==Ft?Ct:"function"==typeof Ft?Ft:m(Y.call(Ft)),At):Ye},At.offset=function(Ft){return arguments.length?(it=Ft??wt,At):it},At},g.stackOffsetDiverging=function(Ee,Ye){if((jt=Ee.length)>0)for(var it,ht,At,Ft,Gt,jt,fr=0,kr=Ee[Ye[0]].length;fr<kr;++fr)for(Ft=Gt=0,it=0;it<jt;++it)(At=(ht=Ee[Ye[it]][fr])[1]-ht[0])>0?(ht[0]=Ft,ht[1]=Ft+=At):At<0?(ht[1]=Gt,ht[0]=Gt+=At):(ht[0]=0,ht[1]=At)},g.stackOffsetExpand=function(Ee,Ye){if((ht=Ee.length)>0){for(var it,ht,At,Ft=0,Gt=Ee[0].length;Ft<Gt;++Ft){for(At=it=0;it<ht;++it)At+=Ee[it][Ft][1]||0;if(At)for(it=0;it<ht;++it)Ee[it][Ft][1]/=At}wt(Ee,Ye)}},g.stackOffsetNone=wt,g.stackOffsetSilhouette=function(Ee,Ye){if((it=Ee.length)>0){for(var it,ht=0,At=Ee[Ye[0]],Ft=At.length;ht<Ft;++ht){for(var Gt=0,jt=0;Gt<it;++Gt)jt+=Ee[Gt][ht][1]||0;At[ht][1]+=At[ht][0]=-jt/2}wt(Ee,Ye)}},g.stackOffsetWiggle=function(Ee,Ye){if((At=Ee.length)>0&&(ht=(it=Ee[Ye[0]]).length)>0){for(var it,ht,At,Ft=0,Gt=1;Gt<ht;++Gt){for(var jt=0,fr=0,kr=0;jt<At;++jt){for(var ur=Ee[Ye[jt]],Jt=ur[Gt][1]||0,$t=(Jt-(ur[Gt-1][1]||0))/2,Qt=0;Qt<jt;++Qt){var cr=Ee[Ye[Qt]];$t+=(cr[Gt][1]||0)-(cr[Gt-1][1]||0)}fr+=Jt,kr+=$t*Jt}it[Gt-1][1]+=it[Gt-1][0]=Ft,fr&&(Ft-=kr/fr)}it[Gt-1][1]+=it[Gt-1][0]=Ft,wt(Ee,Ye)}},g.stackOrderAppearance=ft,g.stackOrderAscending=kt,g.stackOrderDescending=function(Ee){return kt(Ee).reverse()},g.stackOrderInsideOut=function(Ee){var Ye,it,ht=Ee.length,At=Ee.map(Lt),Ft=ft(Ee),Gt=0,jt=0,fr=[],kr=[];for(Ye=0;Ye<ht;++Ye)it=Ft[Ye],Gt<jt?(Gt+=At[it],fr.push(it)):(jt+=At[it],kr.push(it));return kr.reverse().concat(fr)},g.stackOrderNone=Ct,g.stackOrderReverse=function(Ee){return Ct(Ee).reverse()},g.symbol=function(){var Ee=m(J),Ye=m(64),it=null;function ht(){var At;if(it||(it=At=v.path()),Ee.apply(this,arguments).draw(it,+Ye.apply(this,arguments)),At)return it=null,At+""||null}return ht.type=function(At){return arguments.length?(Ee="function"==typeof At?At:m(At),ht):Ee},ht.size=function(At){return arguments.length?(Ye="function"==typeof At?At:m(+At),ht):Ye},ht.context=function(At){return arguments.length?(it=At??null,ht):it},ht},g.symbolCircle=J,g.symbolCross=X,g.symbolDiamond=le,g.symbolSquare=_e,g.symbolStar=ge,g.symbolTriangle=we,g.symbolWye=ke,g.symbols=Pe,Object.defineProperty(g,"__esModule",{value:!0})},"object"==typeof Q&&void 0!==ee?v(Q,y("d3-path")):v((g=g||self).d3=g.d3||{},g.d3)},{"d3-path":117}],120:[function(y,ee,Q){var g,v;g=this,v=function(g,v){"use strict";function m(tt){if(0<=tt.y&&tt.y<100){var Ke=new Date(-1,tt.m,tt.d,tt.H,tt.M,tt.S,tt.L);return Ke.setFullYear(tt.y),Ke}return new Date(tt.y,tt.m,tt.d,tt.H,tt.M,tt.S,tt.L)}function x(tt){if(0<=tt.y&&tt.y<100){var Ke=new Date(Date.UTC(-1,tt.m,tt.d,tt.H,tt.M,tt.S,tt.L));return Ke.setUTCFullYear(tt.y),Ke}return new Date(Date.UTC(tt.y,tt.m,tt.d,tt.H,tt.M,tt.S,tt.L))}function e(tt,Ke,mt){return{y:tt,m:Ke,d:mt,H:0,M:0,S:0,L:0}}function n(tt){var Ke=tt.dateTime,mt=tt.date,Bt=tt.time,Ut=tt.periods,er=tt.days,Wt=tt.shortDays,rr=tt.months,Ht=tt.shortMonths,Ve=f(Ut),We=c(Ut),he=f(er),ye=c(er),Be=f(Wt),Ge=c(Wt),Je=f(rr),He=c(rr),st=f(Ht),ot=c(Ht),wt={a:function(Lt){return Wt[Lt.getDay()]},A:function(Lt){return er[Lt.getDay()]},b:function(Lt){return Ht[Lt.getMonth()]},B:function(Lt){return rr[Lt.getMonth()]},c:null,d:K,e:K,f:N,H:G,I:Y,j:$,L:B,m:U,M:te,p:function(Lt){return Ut[+(Lt.getHours()>=12)]},q:function(Lt){return 1+~~(Lt.getMonth()/3)},Q:Xe,s:nt,S:j,u:J,U:X,V:re,w:ne,W:le,x:null,X:null,y:oe,Y:de,Z:se,"%":Re},Ct={a:function(Lt){return Wt[Lt.getUTCDay()]},A:function(Lt){return er[Lt.getUTCDay()]},b:function(Lt){return Ht[Lt.getUTCMonth()]},B:function(Lt){return rr[Lt.getUTCMonth()]},c:null,d:ge,e:ge,f:fe,H:_e,I:Te,j:we,L:Oe,m:ve,M:Ae,p:function(Lt){return Ut[+(Lt.getUTCHours()>=12)]},q:function(Lt){return 1+~~(Lt.getUTCMonth()/3)},Q:Xe,s:nt,S:ke,u:Pe,U:Ne,V:De,w:ze,W:Me,x:null,X:null,y:Se,Y:Ie,Z:Fe,"%":Re},rt={a:function(Lt,Ee,Ye){var it=Be.exec(Ee.slice(Ye));return it?(Lt.w=Ge[it[0].toLowerCase()],Ye+it[0].length):-1},A:function(Lt,Ee,Ye){var it=he.exec(Ee.slice(Ye));return it?(Lt.w=ye[it[0].toLowerCase()],Ye+it[0].length):-1},b:function(Lt,Ee,Ye){var it=st.exec(Ee.slice(Ye));return it?(Lt.m=ot[it[0].toLowerCase()],Ye+it[0].length):-1},B:function(Lt,Ee,Ye){var it=Je.exec(Ee.slice(Ye));return it?(Lt.m=He[it[0].toLowerCase()],Ye+it[0].length):-1},c:function(Lt,Ee,Ye){return kt(Lt,Ke,Ee,Ye)},d:M,e:M,f:R,H:P,I:P,j:I,L:z,m:L,M:S,p:function(Lt,Ee,Ye){var it=Ve.exec(Ee.slice(Ye));return it?(Lt.p=We[it[0].toLowerCase()],Ye+it[0].length):-1},q:k,Q:V,s:W,S:E,u:p,U:o,V:b,w:h,W:l,x:function(Lt,Ee,Ye){return kt(Lt,mt,Ee,Ye)},X:function(Lt,Ee,Ye){return kt(Lt,Bt,Ee,Ye)},y:_,Y:T,Z:w,"%":q};function ft(Lt,Ee){return function(Ye){var it,ht,At,Ft=[],Gt=-1,jt=0,fr=Lt.length;for(Ye instanceof Date||(Ye=new Date(+Ye));++Gt<fr;)37===Lt.charCodeAt(Gt)&&(Ft.push(Lt.slice(jt,Gt)),null!=(ht=a[it=Lt.charAt(++Gt)])?it=Lt.charAt(++Gt):ht="e"===it?" ":"0",(At=Ee[it])&&(it=At(Ye,ht)),Ft.push(it),jt=Gt+1);return Ft.push(Lt.slice(jt,Gt)),Ft.join("")}}function Rt(Lt,Ee){return function(Ye){var it,ht,At=e(1900,void 0,1);if(kt(At,Lt,Ye+="",0)!=Ye.length)return null;if("Q"in At)return new Date(At.Q);if("s"in At)return new Date(1e3*At.s+("L"in At?At.L:0));if(Ee&&!("Z"in At)&&(At.Z=0),"p"in At&&(At.H=At.H%12+12*At.p),void 0===At.m&&(At.m="q"in At?At.q:0),"V"in At){if(At.V<1||At.V>53)return null;"w"in At||(At.w=1),"Z"in At?(ht=(it=x(e(At.y,0,1))).getUTCDay(),it=ht>4||0===ht?v.utcMonday.ceil(it):v.utcMonday(it),it=v.utcDay.offset(it,7*(At.V-1)),At.y=it.getUTCFullYear(),At.m=it.getUTCMonth(),At.d=it.getUTCDate()+(At.w+6)%7):(ht=(it=m(e(At.y,0,1))).getDay(),it=ht>4||0===ht?v.timeMonday.ceil(it):v.timeMonday(it),it=v.timeDay.offset(it,7*(At.V-1)),At.y=it.getFullYear(),At.m=it.getMonth(),At.d=it.getDate()+(At.w+6)%7)}else("W"in At||"U"in At)&&("w"in At||(At.w="u"in At?At.u%7:"W"in At?1:0),ht="Z"in At?x(e(At.y,0,1)).getUTCDay():m(e(At.y,0,1)).getDay(),At.m=0,At.d="W"in At?(At.w+6)%7+7*At.W-(ht+5)%7:At.w+7*At.U-(ht+6)%7);return"Z"in At?(At.H+=At.Z/100|0,At.M+=At.Z%100,x(At)):m(At)}}function kt(Lt,Ee,Ye,it){for(var ht,At,Ft=0,Gt=Ee.length,jt=Ye.length;Ft<Gt;){if(it>=jt)return-1;if(37===(ht=Ee.charCodeAt(Ft++))){if(ht=Ee.charAt(Ft++),!(At=rt[ht in a?Ee.charAt(Ft++):ht])||(it=At(Lt,Ye,it))<0)return-1}else if(ht!=Ye.charCodeAt(it++))return-1}return it}return wt.x=ft(mt,wt),wt.X=ft(Bt,wt),wt.c=ft(Ke,wt),Ct.x=ft(mt,Ct),Ct.X=ft(Bt,Ct),Ct.c=ft(Ke,Ct),{format:function(Lt){var Ee=ft(Lt+="",wt);return Ee.toString=function(){return Lt},Ee},parse:function(Lt){var Ee=Rt(Lt+="",!1);return Ee.toString=function(){return Lt},Ee},utcFormat:function(Lt){var Ee=ft(Lt+="",Ct);return Ee.toString=function(){return Lt},Ee},utcParse:function(Lt){var Ee=Rt(Lt+="",!0);return Ee.toString=function(){return Lt},Ee}}}var t,a={"-":"",_:" ",0:"0"},r=/^\s*\d+/,d=/^%/,s=/[\\^$*+?|[\]().{}]/g;function i(tt,Ke,mt){var Bt=tt<0?"-":"",Ut=(Bt?-tt:tt)+"",er=Ut.length;return Bt+(er<mt?new Array(mt-er+1).join(Ke)+Ut:Ut)}function u(tt){return tt.replace(s,"\\$&")}function f(tt){return new RegExp("^(?:"+tt.map(u).join("|")+")","i")}function c(tt){for(var Ke={},mt=-1,Bt=tt.length;++mt<Bt;)Ke[tt[mt].toLowerCase()]=mt;return Ke}function h(tt,Ke,mt){var Bt=r.exec(Ke.slice(mt,mt+1));return Bt?(tt.w=+Bt[0],mt+Bt[0].length):-1}function p(tt,Ke,mt){var Bt=r.exec(Ke.slice(mt,mt+1));return Bt?(tt.u=+Bt[0],mt+Bt[0].length):-1}function o(tt,Ke,mt){var Bt=r.exec(Ke.slice(mt,mt+2));return Bt?(tt.U=+Bt[0],mt+Bt[0].length):-1}function b(tt,Ke,mt){var Bt=r.exec(Ke.slice(mt,mt+2));return Bt?(tt.V=+Bt[0],mt+Bt[0].length):-1}function l(tt,Ke,mt){var Bt=r.exec(Ke.slice(mt,mt+2));return Bt?(tt.W=+Bt[0],mt+Bt[0].length):-1}function T(tt,Ke,mt){var Bt=r.exec(Ke.slice(mt,mt+4));return Bt?(tt.y=+Bt[0],mt+Bt[0].length):-1}function _(tt,Ke,mt){var Bt=r.exec(Ke.slice(mt,mt+2));return Bt?(tt.y=+Bt[0]+(+Bt[0]>68?1900:2e3),mt+Bt[0].length):-1}function w(tt,Ke,mt){var Bt=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(Ke.slice(mt,mt+6));return Bt?(tt.Z=Bt[1]?0:-(Bt[2]+(Bt[3]||"00")),mt+Bt[0].length):-1}function k(tt,Ke,mt){var Bt=r.exec(Ke.slice(mt,mt+1));return Bt?(tt.q=3*Bt[0]-3,mt+Bt[0].length):-1}function L(tt,Ke,mt){var Bt=r.exec(Ke.slice(mt,mt+2));return Bt?(tt.m=Bt[0]-1,mt+Bt[0].length):-1}function M(tt,Ke,mt){var Bt=r.exec(Ke.slice(mt,mt+2));return Bt?(tt.d=+Bt[0],mt+Bt[0].length):-1}function I(tt,Ke,mt){var Bt=r.exec(Ke.slice(mt,mt+3));return Bt?(tt.m=0,tt.d=+Bt[0],mt+Bt[0].length):-1}function P(tt,Ke,mt){var Bt=r.exec(Ke.slice(mt,mt+2));return Bt?(tt.H=+Bt[0],mt+Bt[0].length):-1}function S(tt,Ke,mt){var Bt=r.exec(Ke.slice(mt,mt+2));return Bt?(tt.M=+Bt[0],mt+Bt[0].length):-1}function E(tt,Ke,mt){var Bt=r.exec(Ke.slice(mt,mt+2));return Bt?(tt.S=+Bt[0],mt+Bt[0].length):-1}function z(tt,Ke,mt){var Bt=r.exec(Ke.slice(mt,mt+3));return Bt?(tt.L=+Bt[0],mt+Bt[0].length):-1}function R(tt,Ke,mt){var Bt=r.exec(Ke.slice(mt,mt+6));return Bt?(tt.L=Math.floor(Bt[0]/1e3),mt+Bt[0].length):-1}function q(tt,Ke,mt){var Bt=d.exec(Ke.slice(mt,mt+1));return Bt?mt+Bt[0].length:-1}function V(tt,Ke,mt){var Bt=r.exec(Ke.slice(mt));return Bt?(tt.Q=+Bt[0],mt+Bt[0].length):-1}function W(tt,Ke,mt){var Bt=r.exec(Ke.slice(mt));return Bt?(tt.s=+Bt[0],mt+Bt[0].length):-1}function K(tt,Ke){return i(tt.getDate(),Ke,2)}function G(tt,Ke){return i(tt.getHours(),Ke,2)}function Y(tt,Ke){return i(tt.getHours()%12||12,Ke,2)}function $(tt,Ke){return i(1+v.timeDay.count(v.timeYear(tt),tt),Ke,3)}function B(tt,Ke){return i(tt.getMilliseconds(),Ke,3)}function N(tt,Ke){return B(tt,Ke)+"000"}function U(tt,Ke){return i(tt.getMonth()+1,Ke,2)}function te(tt,Ke){return i(tt.getMinutes(),Ke,2)}function j(tt,Ke){return i(tt.getSeconds(),Ke,2)}function J(tt){var Ke=tt.getDay();return 0===Ke?7:Ke}function X(tt,Ke){return i(v.timeSunday.count(v.timeYear(tt)-1,tt),Ke,2)}function re(tt,Ke){var mt=tt.getDay();return tt=mt>=4||0===mt?v.timeThursday(tt):v.timeThursday.ceil(tt),i(v.timeThursday.count(v.timeYear(tt),tt)+(4===v.timeYear(tt).getDay()),Ke,2)}function ne(tt){return tt.getDay()}function le(tt,Ke){return i(v.timeMonday.count(v.timeYear(tt)-1,tt),Ke,2)}function oe(tt,Ke){return i(tt.getFullYear()%100,Ke,2)}function de(tt,Ke){return i(tt.getFullYear()%1e4,Ke,4)}function se(tt){var Ke=tt.getTimezoneOffset();return(Ke>0?"-":(Ke*=-1,"+"))+i(Ke/60|0,"0",2)+i(Ke%60,"0",2)}function ge(tt,Ke){return i(tt.getUTCDate(),Ke,2)}function _e(tt,Ke){return i(tt.getUTCHours(),Ke,2)}function Te(tt,Ke){return i(tt.getUTCHours()%12||12,Ke,2)}function we(tt,Ke){return i(1+v.utcDay.count(v.utcYear(tt),tt),Ke,3)}function Oe(tt,Ke){return i(tt.getUTCMilliseconds(),Ke,3)}function fe(tt,Ke){return Oe(tt,Ke)+"000"}function ve(tt,Ke){return i(tt.getUTCMonth()+1,Ke,2)}function Ae(tt,Ke){return i(tt.getUTCMinutes(),Ke,2)}function ke(tt,Ke){return i(tt.getUTCSeconds(),Ke,2)}function Pe(tt){var Ke=tt.getUTCDay();return 0===Ke?7:Ke}function Ne(tt,Ke){return i(v.utcSunday.count(v.utcYear(tt)-1,tt),Ke,2)}function De(tt,Ke){var mt=tt.getUTCDay();return tt=mt>=4||0===mt?v.utcThursday(tt):v.utcThursday.ceil(tt),i(v.utcThursday.count(v.utcYear(tt),tt)+(4===v.utcYear(tt).getUTCDay()),Ke,2)}function ze(tt){return tt.getUTCDay()}function Me(tt,Ke){return i(v.utcMonday.count(v.utcYear(tt)-1,tt),Ke,2)}function Se(tt,Ke){return i(tt.getUTCFullYear()%100,Ke,2)}function Ie(tt,Ke){return i(tt.getUTCFullYear()%1e4,Ke,4)}function Fe(){return"+0000"}function Re(){return"%"}function Xe(tt){return+tt}function nt(tt){return Math.floor(+tt/1e3)}function ct(tt){return t=n(tt),g.timeFormat=t.format,g.timeParse=t.parse,g.utcFormat=t.utcFormat,g.utcParse=t.utcParse,t}ct({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});var xt=Date.prototype.toISOString?function(tt){return tt.toISOString()}:g.utcFormat("%Y-%m-%dT%H:%M:%S.%LZ"),dt=+new Date("2000-01-01T00:00:00.000Z")?function(tt){var Ke=new Date(tt);return isNaN(Ke)?null:Ke}:g.utcParse("%Y-%m-%dT%H:%M:%S.%LZ");g.isoFormat=xt,g.isoParse=dt,g.timeFormatDefaultLocale=ct,g.timeFormatLocale=n,Object.defineProperty(g,"__esModule",{value:!0})},"object"==typeof Q&&void 0!==ee?v(Q,y("d3-time")):v((g=g||self).d3=g.d3||{},g.d3)},{"d3-time":121}],121:[function(y,ee,Q){var g,v;g=this,v=function(g){"use strict";var v=new Date,m=new Date;function x(ve,Ae,ke,Pe){function Ne(De){return ve(De=0===arguments.length?new Date:new Date(+De)),De}return Ne.floor=function(De){return ve(De=new Date(+De)),De},Ne.ceil=function(De){return ve(De=new Date(De-1)),Ae(De,1),ve(De),De},Ne.round=function(De){var ze=Ne(De),Me=Ne.ceil(De);return De-ze<Me-De?ze:Me},Ne.offset=function(De,ze){return Ae(De=new Date(+De),null==ze?1:Math.floor(ze)),De},Ne.range=function(De,ze,Me){var Se,Ie=[];if(De=Ne.ceil(De),Me=null==Me?1:Math.floor(Me),!(De<ze&&Me>0))return Ie;do{Ie.push(Se=new Date(+De)),Ae(De,Me),ve(De)}while(Se<De&&De<ze);return Ie},Ne.filter=function(De){return x(function(ze){if(ze>=ze)for(;ve(ze),!De(ze);)ze.setTime(ze-1)},function(ze,Me){if(ze>=ze)if(Me<0)for(;++Me<=0;)for(;Ae(ze,-1),!De(ze););else for(;--Me>=0;)for(;Ae(ze,1),!De(ze););})},ke&&(Ne.count=function(De,ze){return v.setTime(+De),m.setTime(+ze),ve(v),ve(m),Math.floor(ke(v,m))},Ne.every=function(De){return De=Math.floor(De),isFinite(De)&&De>0?De>1?Ne.filter(Pe?function(ze){return Pe(ze)%De==0}:function(ze){return Ne.count(0,ze)%De==0}):Ne:null}),Ne}var e=x(function(){},function(ve,Ae){ve.setTime(+ve+Ae)},function(ve,Ae){return Ae-ve});e.every=function(ve){return ve=Math.floor(ve),isFinite(ve)&&ve>0?ve>1?x(function(Ae){Ae.setTime(Math.floor(Ae/ve)*ve)},function(Ae,ke){Ae.setTime(+Ae+ke*ve)},function(Ae,ke){return(ke-Ae)/ve}):e:null};var n=e.range,t=x(function(ve){ve.setTime(ve-ve.getMilliseconds())},function(ve,Ae){ve.setTime(+ve+1e3*Ae)},function(ve,Ae){return(Ae-ve)/1e3},function(ve){return ve.getUTCSeconds()}),a=t.range,r=x(function(ve){ve.setTime(ve-ve.getMilliseconds()-1e3*ve.getSeconds())},function(ve,Ae){ve.setTime(+ve+6e4*Ae)},function(ve,Ae){return(Ae-ve)/6e4},function(ve){return ve.getMinutes()}),d=r.range,s=x(function(ve){ve.setTime(ve-ve.getMilliseconds()-1e3*ve.getSeconds()-6e4*ve.getMinutes())},function(ve,Ae){ve.setTime(+ve+36e5*Ae)},function(ve,Ae){return(Ae-ve)/36e5},function(ve){return ve.getHours()}),i=s.range,u=x(function(ve){ve.setHours(0,0,0,0)},function(ve,Ae){ve.setDate(ve.getDate()+Ae)},function(ve,Ae){return(Ae-ve-6e4*(Ae.getTimezoneOffset()-ve.getTimezoneOffset()))/864e5},function(ve){return ve.getDate()-1}),f=u.range;function c(ve){return x(function(Ae){Ae.setDate(Ae.getDate()-(Ae.getDay()+7-ve)%7),Ae.setHours(0,0,0,0)},function(Ae,ke){Ae.setDate(Ae.getDate()+7*ke)},function(Ae,ke){return(ke-Ae-6e4*(ke.getTimezoneOffset()-Ae.getTimezoneOffset()))/6048e5})}var h=c(0),p=c(1),o=c(2),b=c(3),l=c(4),T=c(5),_=c(6),w=h.range,k=p.range,L=o.range,M=b.range,I=l.range,P=T.range,S=_.range,E=x(function(ve){ve.setDate(1),ve.setHours(0,0,0,0)},function(ve,Ae){ve.setMonth(ve.getMonth()+Ae)},function(ve,Ae){return Ae.getMonth()-ve.getMonth()+12*(Ae.getFullYear()-ve.getFullYear())},function(ve){return ve.getMonth()}),z=E.range,R=x(function(ve){ve.setMonth(0,1),ve.setHours(0,0,0,0)},function(ve,Ae){ve.setFullYear(ve.getFullYear()+Ae)},function(ve,Ae){return Ae.getFullYear()-ve.getFullYear()},function(ve){return ve.getFullYear()});R.every=function(ve){return isFinite(ve=Math.floor(ve))&&ve>0?x(function(Ae){Ae.setFullYear(Math.floor(Ae.getFullYear()/ve)*ve),Ae.setMonth(0,1),Ae.setHours(0,0,0,0)},function(Ae,ke){Ae.setFullYear(Ae.getFullYear()+ke*ve)}):null};var q=R.range,V=x(function(ve){ve.setUTCSeconds(0,0)},function(ve,Ae){ve.setTime(+ve+6e4*Ae)},function(ve,Ae){return(Ae-ve)/6e4},function(ve){return ve.getUTCMinutes()}),W=V.range,K=x(function(ve){ve.setUTCMinutes(0,0,0)},function(ve,Ae){ve.setTime(+ve+36e5*Ae)},function(ve,Ae){return(Ae-ve)/36e5},function(ve){return ve.getUTCHours()}),G=K.range,Y=x(function(ve){ve.setUTCHours(0,0,0,0)},function(ve,Ae){ve.setUTCDate(ve.getUTCDate()+Ae)},function(ve,Ae){return(Ae-ve)/864e5},function(ve){return ve.getUTCDate()-1}),$=Y.range;function B(ve){return x(function(Ae){Ae.setUTCDate(Ae.getUTCDate()-(Ae.getUTCDay()+7-ve)%7),Ae.setUTCHours(0,0,0,0)},function(Ae,ke){Ae.setUTCDate(Ae.getUTCDate()+7*ke)},function(Ae,ke){return(ke-Ae)/6048e5})}var N=B(0),U=B(1),te=B(2),j=B(3),J=B(4),X=B(5),re=B(6),ne=N.range,le=U.range,oe=te.range,de=j.range,se=J.range,ge=X.range,_e=re.range,Te=x(function(ve){ve.setUTCDate(1),ve.setUTCHours(0,0,0,0)},function(ve,Ae){ve.setUTCMonth(ve.getUTCMonth()+Ae)},function(ve,Ae){return Ae.getUTCMonth()-ve.getUTCMonth()+12*(Ae.getUTCFullYear()-ve.getUTCFullYear())},function(ve){return ve.getUTCMonth()}),we=Te.range,Oe=x(function(ve){ve.setUTCMonth(0,1),ve.setUTCHours(0,0,0,0)},function(ve,Ae){ve.setUTCFullYear(ve.getUTCFullYear()+Ae)},function(ve,Ae){return Ae.getUTCFullYear()-ve.getUTCFullYear()},function(ve){return ve.getUTCFullYear()});Oe.every=function(ve){return isFinite(ve=Math.floor(ve))&&ve>0?x(function(Ae){Ae.setUTCFullYear(Math.floor(Ae.getUTCFullYear()/ve)*ve),Ae.setUTCMonth(0,1),Ae.setUTCHours(0,0,0,0)},function(Ae,ke){Ae.setUTCFullYear(Ae.getUTCFullYear()+ke*ve)}):null};var fe=Oe.range;g.timeDay=u,g.timeDays=f,g.timeFriday=T,g.timeFridays=P,g.timeHour=s,g.timeHours=i,g.timeInterval=x,g.timeMillisecond=e,g.timeMilliseconds=n,g.timeMinute=r,g.timeMinutes=d,g.timeMonday=p,g.timeMondays=k,g.timeMonth=E,g.timeMonths=z,g.timeSaturday=_,g.timeSaturdays=S,g.timeSecond=t,g.timeSeconds=a,g.timeSunday=h,g.timeSundays=w,g.timeThursday=l,g.timeThursdays=I,g.timeTuesday=o,g.timeTuesdays=L,g.timeWednesday=b,g.timeWednesdays=M,g.timeWeek=h,g.timeWeeks=w,g.timeYear=R,g.timeYears=q,g.utcDay=Y,g.utcDays=$,g.utcFriday=X,g.utcFridays=ge,g.utcHour=K,g.utcHours=G,g.utcMillisecond=e,g.utcMilliseconds=n,g.utcMinute=V,g.utcMinutes=W,g.utcMonday=U,g.utcMondays=le,g.utcMonth=Te,g.utcMonths=we,g.utcSaturday=re,g.utcSaturdays=_e,g.utcSecond=t,g.utcSeconds=a,g.utcSunday=N,g.utcSundays=ne,g.utcThursday=J,g.utcThursdays=se,g.utcTuesday=te,g.utcTuesdays=oe,g.utcWednesday=j,g.utcWednesdays=de,g.utcWeek=N,g.utcWeeks=ne,g.utcYear=Oe,g.utcYears=fe,Object.defineProperty(g,"__esModule",{value:!0})},v("object"==typeof Q&&void 0!==ee?Q:(g=g||self).d3=g.d3||{})},{}],122:[function(y,ee,Q){arguments[4][121][0].apply(Q,arguments)},{dup:121}],123:[function(y,ee,Q){var g,v;g=this,v=function(g){"use strict";var v,m,x=0,e=0,n=0,t=0,a=0,r=0,d="object"==typeof performance&&performance.now?performance:Date,s="object"==typeof window&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(l){setTimeout(l,17)};function i(){return a||(s(u),a=d.now()+r)}function u(){a=0}function f(){this._call=this._time=this._next=null}function c(l,T,_){var w=new f;return w.restart(l,T,_),w}function h(){i(),++x;for(var l,T=v;T;)(l=a-T._time)>=0&&T._call.call(null,l),T=T._next;--x}function p(){a=(t=d.now())+r,x=e=0;try{h()}finally{x=0,function(){for(var l,T,_=v,w=1/0;_;)_._call?(w>_._time&&(w=_._time),l=_,_=_._next):(T=_._next,_._next=null,_=l?l._next=T:v=T);m=l,b(w)}(),a=0}}function o(){var l=d.now(),T=l-t;T>1e3&&(r-=T,t=l)}function b(l){x||(e&&(e=clearTimeout(e)),l-a>24?(l<1/0&&(e=setTimeout(p,l-d.now()-r)),n&&(n=clearInterval(n))):(n||(t=d.now(),n=setInterval(o,1e3)),x=1,s(p)))}f.prototype=c.prototype={constructor:f,restart:function(l,T,_){if("function"!=typeof l)throw new TypeError("callback is not a function");_=(null==_?i():+_)+(null==T?0:+T),this._next||m===this||(m?m._next=this:v=this,m=this),this._call=l,this._time=_,b()},stop:function(){this._call&&(this._call=null,this._time=1/0,b())}},g.interval=function(l,T,_){var w=new f,k=T;return null==T?(w.restart(l,T,_),w):(T=+T,_=null==_?i():+_,w.restart(function L(M){M+=k,w.restart(L,k+=T,_),l(M)},T,_),w)},g.now=i,g.timeout=function(l,T,_){var w=new f;return w.restart(function(k){w.stop(),l(k+T)},T=null==T?0:+T,_),w},g.timer=c,g.timerFlush=h,Object.defineProperty(g,"__esModule",{value:!0})},v("object"==typeof Q&&void 0!==ee?Q:(g=g||self).d3=g.d3||{})},{}],124:[function(y,ee,Q){ee.exports=function(){for(var g=0;g<arguments.length;g++)if(void 0!==arguments[g])return arguments[g]}},{}],125:[function(y,ee,Q){"use strict";ee.exports=m;var g=(m.canvas=document.createElement("canvas")).getContext("2d"),v=x([32,126]);function m(e,n){Array.isArray(e)&&(e=e.join(", "));var t,a={},r=16,d=.05;n&&(2===n.length&&"number"==typeof n[0]?t=x(n):Array.isArray(n)?t=n:(n.o?t=x(n.o):n.pairs&&(t=n.pairs),n.fontSize&&(r=n.fontSize),null!=n.threshold&&(d=n.threshold))),t||(t=v),g.font=r+"px "+e;for(var s=0;s<t.length;s++){var i=t[s],u=g.measureText(i[0]).width+g.measureText(i[1]).width,f=g.measureText(i).width;Math.abs(u-f)>r*d&&(a[i]=(f-u)/r*1e3)}return a}function x(e){for(var n=[],t=e[0];t<=e[1];t++)for(var a=String.fromCharCode(t),r=e[0];r<e[1];r++){var d=a+String.fromCharCode(r);n.push(d)}return n}m.createPairs=x,m.ascii=v},{}],126:[function(y,ee,Q){var g=y("abs-svg-path"),v=y("normalize-svg-path"),m={M:"moveTo",C:"bezierCurveTo"};ee.exports=function(x,e){x.beginPath(),v(g(e)).forEach(function(n){var t=n[0],a=n.slice(1);x[m[t]].apply(x,a)}),x.closePath()}},{"abs-svg-path":70,"normalize-svg-path":246}],127:[function(y,ee,Q){ee.exports=function(g){switch(g){case"int8":return Int8Array;case"int16":return Int16Array;case"int32":return Int32Array;case"uint8":return Uint8Array;case"uint16":return Uint16Array;case"uint32":return Uint32Array;case"float32":return Float32Array;case"float64":return Float64Array;case"array":return Array;case"uint8_clamped":return Uint8ClampedArray}}},{}],128:[function(y,ee,Q){"use strict";ee.exports=function(g,v){switch(void 0===v&&(v=0),typeof g){case"number":if(g>0)return function(m,x){var e,n;for(e=new Array(m),n=0;n<m;++n)e[n]=x;return e}(0|g,v);break;case"object":if("number"==typeof g.length)return function m(x,e,n){var t=0|x[n];if(t<=0)return[];var a,r=new Array(t);if(n===x.length-1)for(a=0;a<t;++a)r[a]=e;else for(a=0;a<t;++a)r[a]=m(x,e,n+1);return r}(g,v,0)}return[]}},{}],129:[function(y,ee,Q){"use strict";function g(I,P,S){S=S||2;var E,z,R,q,V,W,K,G=P&&P.length,Y=G?P[0]*S:I.length,$=v(I,0,Y,S,!0),B=[];if(!$||$.next===$.prev)return B;if(G&&($=function(U,te,j,J){var X,re,oe,de=[];for(X=0,re=te.length;X<re;X++)(oe=v(U,te[X]*J,X<re-1?te[X+1]*J:U.length,J,!1))===oe.next&&(oe.steiner=!0),de.push(u(oe));for(de.sort(r),X=0;X<de.length;X++)d(de[X],j),j=m(j,j.next);return j}(I,P,$,S)),I.length>80*S){E=R=I[0],z=q=I[1];for(var N=S;N<Y;N+=S)(V=I[N])<E&&(E=V),(W=I[N+1])<z&&(z=W),V>R&&(R=V),W>q&&(q=W);K=0!==(K=Math.max(R-E,q-z))?1/K:0}return x($,B,S,E,z,K),B}function v(I,P,S,E,z){var R,q;if(z===M(I,P,S,E)>0)for(R=P;R<S;R+=E)q=w(R,I[R],I[R+1],q);else for(R=S-E;R>=P;R-=E)q=w(R,I[R],I[R+1],q);return q&&p(q,q.next)&&(k(q),q=q.next),q}function m(I,P){if(!I)return I;P||(P=I);var S,E=I;do{if(S=!1,E.steiner||!p(E,E.next)&&0!==h(E.prev,E,E.next))E=E.next;else{if(k(E),(E=P=E.prev)===E.next)break;S=!0}}while(S||E!==P);return P}function x(I,P,S,E,z,R,q){if(I){!q&&R&&function(G,Y,$,B){var N=G;do{null===N.z&&(N.z=i(N.x,N.y,Y,$,B)),N.prevZ=N.prev,N.nextZ=N.next,N=N.next}while(N!==G);N.prevZ.nextZ=null,N.prevZ=null,function(U){var te,j,J,X,re,ne,le,oe,de=1;do{for(j=U,U=null,re=null,ne=0;j;){for(ne++,J=j,le=0,te=0;te<de&&(le++,J=J.nextZ);te++);for(oe=de;le>0||oe>0&&J;)0!==le&&(0===oe||!J||j.z<=J.z)?(X=j,j=j.nextZ,le--):(X=J,J=J.nextZ,oe--),re?re.nextZ=X:U=X,X.prevZ=re,re=X;j=J}re.nextZ=null,de*=2}while(ne>1)}(N)}(I,E,z,R);for(var V,W,K=I;I.prev!==I.next;)if(V=I.prev,W=I.next,R?n(I,E,z,R):e(I))P.push(V.i/S),P.push(I.i/S),P.push(W.i/S),k(I),I=W.next,K=W.next;else if((I=W)===K){q?1===q?x(I=t(m(I),P,S),P,S,E,z,R,2):2===q&&a(I,P,S,E,z,R):x(m(I),P,S,E,z,R,1);break}}}function e(I){var P=I.prev,S=I,E=I.next;if(h(P,S,E)>=0)return!1;for(var z=I.next.next;z!==I.prev;){if(f(P.x,P.y,S.x,S.y,E.x,E.y,z.x,z.y)&&h(z.prev,z,z.next)>=0)return!1;z=z.next}return!0}function n(I,P,S,E){var z=I.prev,R=I,q=I.next;if(h(z,R,q)>=0)return!1;for(var K=z.x>R.x?z.x>q.x?z.x:q.x:R.x>q.x?R.x:q.x,G=z.y>R.y?z.y>q.y?z.y:q.y:R.y>q.y?R.y:q.y,Y=i(z.x<R.x?z.x<q.x?z.x:q.x:R.x<q.x?R.x:q.x,z.y<R.y?z.y<q.y?z.y:q.y:R.y<q.y?R.y:q.y,P,S,E),$=i(K,G,P,S,E),B=I.prevZ,N=I.nextZ;B&&B.z>=Y&&N&&N.z<=$;){if(B!==I.prev&&B!==I.next&&f(z.x,z.y,R.x,R.y,q.x,q.y,B.x,B.y)&&h(B.prev,B,B.next)>=0||(B=B.prevZ,N!==I.prev&&N!==I.next&&f(z.x,z.y,R.x,R.y,q.x,q.y,N.x,N.y)&&h(N.prev,N,N.next)>=0))return!1;N=N.nextZ}for(;B&&B.z>=Y;){if(B!==I.prev&&B!==I.next&&f(z.x,z.y,R.x,R.y,q.x,q.y,B.x,B.y)&&h(B.prev,B,B.next)>=0)return!1;B=B.prevZ}for(;N&&N.z<=$;){if(N!==I.prev&&N!==I.next&&f(z.x,z.y,R.x,R.y,q.x,q.y,N.x,N.y)&&h(N.prev,N,N.next)>=0)return!1;N=N.nextZ}return!0}function t(I,P,S){var E=I;do{var z=E.prev,R=E.next.next;!p(z,R)&&o(z,E,E.next,R)&&T(z,R)&&T(R,z)&&(P.push(z.i/S),P.push(E.i/S),P.push(R.i/S),k(E),k(E.next),E=I=R),E=E.next}while(E!==I);return m(E)}function a(I,P,S,E,z,R){var q=I;do{for(var V=q.next.next;V!==q.prev;){if(q.i!==V.i&&c(q,V)){var W=_(q,V);return q=m(q,q.next),W=m(W,W.next),x(q,P,S,E,z,R),void x(W,P,S,E,z,R)}V=V.next}q=q.next}while(q!==I)}function r(I,P){return I.x-P.x}function d(I,P){if(P=function(E,z){var R,q=z,V=E.x,W=E.y,K=-1/0;do{if(W<=q.y&&W>=q.next.y&&q.next.y!==q.y){var G=q.x+(W-q.y)*(q.next.x-q.x)/(q.next.y-q.y);if(G<=V&&G>K){if(K=G,G===V){if(W===q.y)return q;if(W===q.next.y)return q.next}R=q.x<q.next.x?q:q.next}}q=q.next}while(q!==z);if(!R)return null;if(V===K)return R;var Y,$=R,B=R.x,N=R.y,U=1/0;q=R;do{V>=q.x&&q.x>=B&&V!==q.x&&f(W<N?V:K,W,B,N,W<N?K:V,W,q.x,q.y)&&(Y=Math.abs(W-q.y)/(V-q.x),T(q,E)&&(Y<U||Y===U&&(q.x>R.x||q.x===R.x&&s(R,q)))&&(R=q,U=Y)),q=q.next}while(q!==$);return R}(I,P)){var S=_(P,I);m(P,P.next),m(S,S.next)}}function s(I,P){return h(I.prev,I,P.prev)<0&&h(P.next,I,I.next)<0}function i(I,P,S,E,z){return(I=1431655765&((I=858993459&((I=252645135&((I=16711935&((I=32767*(I-S)*z)|I<<8))|I<<4))|I<<2))|I<<1))|(P=1431655765&((P=858993459&((P=252645135&((P=16711935&((P=32767*(P-E)*z)|P<<8))|P<<4))|P<<2))|P<<1))<<1}function u(I){var P=I,S=I;do{(P.x<S.x||P.x===S.x&&P.y<S.y)&&(S=P),P=P.next}while(P!==I);return S}function f(I,P,S,E,z,R,q,V){return(z-q)*(P-V)-(I-q)*(R-V)>=0&&(I-q)*(E-V)-(S-q)*(P-V)>=0&&(S-q)*(R-V)-(z-q)*(E-V)>=0}function c(I,P){return I.next.i!==P.i&&I.prev.i!==P.i&&!function(S,E){var z=S;do{if(z.i!==S.i&&z.next.i!==S.i&&z.i!==E.i&&z.next.i!==E.i&&o(z,z.next,S,E))return!0;z=z.next}while(z!==S);return!1}(I,P)&&(T(I,P)&&T(P,I)&&function(S,E){var z=S,R=!1,q=(S.x+E.x)/2,V=(S.y+E.y)/2;do{z.y>V!=z.next.y>V&&z.next.y!==z.y&&q<(z.next.x-z.x)*(V-z.y)/(z.next.y-z.y)+z.x&&(R=!R),z=z.next}while(z!==S);return R}(I,P)&&(h(I.prev,I,P.prev)||h(I,P.prev,P))||p(I,P)&&h(I.prev,I,I.next)>0&&h(P.prev,P,P.next)>0)}function h(I,P,S){return(P.y-I.y)*(S.x-P.x)-(P.x-I.x)*(S.y-P.y)}function p(I,P){return I.x===P.x&&I.y===P.y}function o(I,P,S,E){var z=l(h(I,P,S)),R=l(h(I,P,E)),q=l(h(S,E,I)),V=l(h(S,E,P));return z!==R&&q!==V||!(0!==z||!b(I,S,P))||!(0!==R||!b(I,E,P))||!(0!==q||!b(S,I,E))||!(0!==V||!b(S,P,E))}function b(I,P,S){return P.x<=Math.max(I.x,S.x)&&P.x>=Math.min(I.x,S.x)&&P.y<=Math.max(I.y,S.y)&&P.y>=Math.min(I.y,S.y)}function l(I){return I>0?1:I<0?-1:0}function T(I,P){return h(I.prev,I,I.next)<0?h(I,P,I.next)>=0&&h(I,I.prev,P)>=0:h(I,P,I.prev)<0||h(I,I.next,P)<0}function _(I,P){var S=new L(I.i,I.x,I.y),E=new L(P.i,P.x,P.y),z=I.next,R=P.prev;return I.next=P,P.prev=I,S.next=z,z.prev=S,E.next=S,S.prev=E,R.next=E,E.prev=R,E}function w(I,P,S,E){var z=new L(I,P,S);return E?(z.next=E.next,z.prev=E,E.next.prev=z,E.next=z):(z.prev=z,z.next=z),z}function k(I){I.next.prev=I.prev,I.prev.next=I.next,I.prevZ&&(I.prevZ.nextZ=I.nextZ),I.nextZ&&(I.nextZ.prevZ=I.prevZ)}function L(I,P,S){this.i=I,this.x=P,this.y=S,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function M(I,P,S,E){for(var z=0,R=P,q=S-E;R<S;R+=E)z+=(I[q]-I[R])*(I[R+1]+I[q+1]),q=R;return z}ee.exports=g,ee.exports.default=g,g.deviation=function(I,P,S,E){var z=P&&P.length,q=Math.abs(M(I,0,z?P[0]*S:I.length,S));if(z)for(var V=0,W=P.length;V<W;V++)q-=Math.abs(M(I,P[V]*S,V<W-1?P[V+1]*S:I.length,S));var Y=0;for(V=0;V<E.length;V+=3){var $=E[V]*S,B=E[V+1]*S,N=E[V+2]*S;Y+=Math.abs((I[$]-I[N])*(I[B+1]-I[$+1])-(I[$]-I[B])*(I[N+1]-I[$+1]))}return 0===q&&0===Y?0:Math.abs((Y-q)/q)},g.flatten=function(I){for(var P=I[0][0].length,S={vertices:[],holes:[],dimensions:P},E=0,z=0;z<I.length;z++){for(var R=0;R<I[z].length;R++)for(var q=0;q<P;q++)S.vertices.push(I[z][R][q]);z>0&&S.holes.push(E+=I[z-1].length)}return S}},{}],130:[function(y,ee,Q){var g=y("strongly-connected-components");ee.exports=function(v,m){var x,e=[],n=[],t=[],a={},r=[];function d(o){var b,l,T=!1;for(n.push(o),t[o]=!0,b=0;b<r[o].length;b++)(l=r[o][b])===x?(s(x,n),T=!0):t[l]||(T=d(l));if(T)!function w(k){t[k]=!1,a.hasOwnProperty(k)&&Object.keys(a[k]).forEach(function(L){delete a[k][L],t[L]&&w(L)})}(o);else for(b=0;b<r[o].length;b++){var _=a[l=r[o][b]];_||(a[l]=_={}),_[l]=!0}return n.pop(),T}function s(o,b){var l=[].concat(b).concat(o);m?m(d):e.push(l)}function i(o){!function(L){for(var M=0;M<v.length;M++)M<L&&(v[M]=[]),v[M]=v[M].filter(function(I){return I>=L})}(o);for(var b,l=g(v).components.filter(function(L){return L.length>1}),T=1/0,_=0;_<l.length;_++)for(var w=0;w<l[_].length;w++)l[_][w]<T&&(T=l[_][w],b=_);var k=l[b];return!!k&&{leastVertex:T,adjList:v.map(function(L,M){return-1===k.indexOf(M)?[]:L.filter(function(I){return-1!==k.indexOf(I)})})}}x=0;for(var u=v.length;x<u;){var f=i(x);if(x=f.leastVertex,r=f.adjList){for(var c=0;c<r.length;c++)for(var h=0;h<r[c].length;h++){var p=r[c][h];t[+p]=!1,a[p]={}}d(x),x+=1}else x=u}return m?void 0:e}},{"strongly-connected-components":307}],131:[function(y,ee,Q){"use strict";var g=y("../../object/valid-value");ee.exports=function(){return g(this).length=0,this}},{"../../object/valid-value":162}],132:[function(y,ee,Q){"use strict";ee.exports=y("./is-implemented")()?Array.from:y("./shim")},{"./is-implemented":133,"./shim":134}],133:[function(y,ee,Q){"use strict";ee.exports=function(){var g,v,m=Array.from;return"function"==typeof m&&(v=m(g=["raz","dwa"]),Boolean(v&&v!==g&&"dwa"===v[1]))}},{}],134:[function(y,ee,Q){"use strict";var g=y("es6-symbol").iterator,v=y("../../function/is-arguments"),m=y("../../function/is-function"),x=y("../../number/to-pos-integer"),e=y("../../object/valid-callable"),n=y("../../object/valid-value"),t=y("../../object/is-value"),a=y("../../string/is-string"),r=Array.isArray,d=Function.prototype.call,s={configurable:!0,enumerable:!0,writable:!0,value:null},i=Object.defineProperty;ee.exports=function(u){var f,c,h,p,o,b,l,T,_,w,k=arguments[1],L=arguments[2];if(u=Object(n(u)),t(k)&&e(k),this&&this!==Array&&m(this))f=this;else{if(!k){if(v(u))return 1!==(o=u.length)?Array.apply(null,u):((p=new Array(1))[0]=u[0],p);if(r(u)){for(p=new Array(o=u.length),c=0;c<o;++c)p[c]=u[c];return p}}p=[]}if(!r(u))if(void 0!==(_=u[g])){for(l=e(_).call(u),f&&(p=new f),T=l.next(),c=0;!T.done;)w=k?d.call(k,L,T.value,c):T.value,f?(s.value=w,i(p,c,s)):p[c]=w,T=l.next(),++c;o=c}else if(a(u)){for(o=u.length,f&&(p=new f),c=0,h=0;c<o;++c)w=u[c],c+1<o&&(b=w.charCodeAt(0))>=55296&&b<=56319&&(w+=u[++c]),w=k?d.call(k,L,w,h):w,f?(s.value=w,i(p,h,s)):p[h]=w,++h;o=h}if(void 0===o)for(o=x(u.length),f&&(p=new f(o)),c=0;c<o;++c)w=k?d.call(k,L,u[c],c):u[c],f?(s.value=w,i(p,c,s)):p[c]=w;return f&&(s.value=null,p.length=o),p}},{"../../function/is-arguments":135,"../../function/is-function":136,"../../number/to-pos-integer":142,"../../object/is-value":151,"../../object/valid-callable":160,"../../object/valid-value":162,"../../string/is-string":166,"es6-symbol":175}],135:[function(y,ee,Q){"use strict";var g=Object.prototype.toString,v=g.call(function(){return arguments}());ee.exports=function(m){return g.call(m)===v}},{}],136:[function(y,ee,Q){"use strict";var g=Object.prototype.toString,v=RegExp.prototype.test.bind(/^[object [A-Za-z0-9]*Function]$/);ee.exports=function(m){return"function"==typeof m&&v(g.call(m))}},{}],137:[function(y,ee,Q){"use strict";ee.exports=function(){}},{}],138:[function(y,ee,Q){"use strict";ee.exports=y("./is-implemented")()?Math.sign:y("./shim")},{"./is-implemented":139,"./shim":140}],139:[function(y,ee,Q){"use strict";ee.exports=function(){var g=Math.sign;return"function"==typeof g&&1===g(10)&&-1===g(-20)}},{}],140:[function(y,ee,Q){"use strict";ee.exports=function(g){return g=Number(g),isNaN(g)||0===g?g:g>0?1:-1}},{}],141:[function(y,ee,Q){"use strict";var g=y("../math/sign"),v=Math.abs,m=Math.floor;ee.exports=function(x){return isNaN(x)?0:0!==(x=Number(x))&&isFinite(x)?g(x)*m(v(x)):x}},{"../math/sign":138}],142:[function(y,ee,Q){"use strict";var g=y("./to-integer"),v=Math.max;ee.exports=function(m){return v(0,g(m))}},{"./to-integer":141}],143:[function(y,ee,Q){"use strict";var g=y("./valid-callable"),v=y("./valid-value"),m=Function.prototype.bind,x=Function.prototype.call,e=Object.keys,n=Object.prototype.propertyIsEnumerable;ee.exports=function(t,a){return function(r,d){var s,i=arguments[2],u=arguments[3];return r=Object(v(r)),g(d),s=e(r),u&&s.sort("function"==typeof u?m.call(u,r):void 0),"function"!=typeof t&&(t=s[t]),x.call(t,s,function(f,c){return n.call(r,f)?x.call(d,i,r[f],f,r,c):a})}}},{"./valid-callable":160,"./valid-value":162}],144:[function(y,ee,Q){"use strict";ee.exports=y("./is-implemented")()?Object.assign:y("./shim")},{"./is-implemented":145,"./shim":146}],145:[function(y,ee,Q){"use strict";ee.exports=function(){var g,v=Object.assign;return"function"==typeof v&&(v(g={foo:"raz"},{bar:"dwa"},{trzy:"trzy"}),g.foo+g.bar+g.trzy==="razdwatrzy")}},{}],146:[function(y,ee,Q){"use strict";var g=y("../keys"),v=y("../valid-value"),m=Math.max;ee.exports=function(x,e){var n,t,a,r=m(arguments.length,2);for(x=Object(v(x)),a=function(d){try{x[d]=e[d]}catch(s){n||(n=s)}},t=1;t<r;++t)g(e=arguments[t]).forEach(a);if(void 0!==n)throw n;return x}},{"../keys":152,"../valid-value":162}],147:[function(y,ee,Q){"use strict";var g=y("../array/from"),v=y("./assign"),m=y("./valid-value");ee.exports=function(x){var e=Object(m(x)),n=arguments[1],t=Object(arguments[2]);if(e!==x&&!n)return e;var a={};return n?g(n,function(r){(t.ensure||r in x)&&(a[r]=x[r])}):v(a,x),a}},{"../array/from":132,"./assign":144,"./valid-value":162}],148:[function(y,ee,Q){"use strict";var g,v,m,x,e=Object.create;y("./set-prototype-of/is-implemented")()||(g=y("./set-prototype-of/shim")),ee.exports=g?1!==g.level?e:(v={},m={},x={configurable:!1,enumerable:!1,writable:!0,value:void 0},Object.getOwnPropertyNames(Object.prototype).forEach(function(n){m[n]="__proto__"!==n?x:{configurable:!0,enumerable:!1,writable:!0,value:void 0}}),Object.defineProperties(v,m),Object.defineProperty(g,"nullPolyfill",{configurable:!1,enumerable:!1,writable:!1,value:v}),function(n,t){return e(null===n?v:n,t)}):e},{"./set-prototype-of/is-implemented":158,"./set-prototype-of/shim":159}],149:[function(y,ee,Q){"use strict";ee.exports=y("./_iterate")("forEach")},{"./_iterate":143}],150:[function(y,ee,Q){"use strict";var g=y("./is-value"),v={function:!0,object:!0};ee.exports=function(m){return g(m)&&v[typeof m]||!1}},{"./is-value":151}],151:[function(y,ee,Q){"use strict";var g=y("../function/noop")();ee.exports=function(v){return v!==g&&null!==v}},{"../function/noop":137}],152:[function(y,ee,Q){"use strict";ee.exports=y("./is-implemented")()?Object.keys:y("./shim")},{"./is-implemented":153,"./shim":154}],153:[function(y,ee,Q){"use strict";ee.exports=function(){try{return Object.keys("primitive"),!0}catch{return!1}}},{}],154:[function(y,ee,Q){"use strict";var g=y("../is-value"),v=Object.keys;ee.exports=function(m){return v(g(m)?Object(m):m)}},{"../is-value":151}],155:[function(y,ee,Q){"use strict";var g=y("./valid-callable"),v=y("./for-each"),m=Function.prototype.call;ee.exports=function(x,e){var n={},t=arguments[2];return g(e),v(x,function(a,r,d,s){n[r]=m.call(e,t,a,r,d,s)}),n}},{"./for-each":149,"./valid-callable":160}],156:[function(y,ee,Q){"use strict";var g=y("./is-value"),v=Array.prototype.forEach,m=Object.create,x=function(e,n){var t;for(t in e)n[t]=e[t]};ee.exports=function(e){var n=m(null);return v.call(arguments,function(t){g(t)&&x(Object(t),n)}),n}},{"./is-value":151}],157:[function(y,ee,Q){"use strict";ee.exports=y("./is-implemented")()?Object.setPrototypeOf:y("./shim")},{"./is-implemented":158,"./shim":159}],158:[function(y,ee,Q){"use strict";var g=Object.create,v=Object.getPrototypeOf,m={};ee.exports=function(){var x=Object.setPrototypeOf;return"function"==typeof x&&v(x((arguments[0]||g)(null),m))===m}},{}],159:[function(y,ee,Q){"use strict";var g,t,a,r,v=y("../is-object"),m=y("../valid-value"),x=Object.prototype.isPrototypeOf,e=Object.defineProperty,n={configurable:!0,enumerable:!1,writable:!0,value:void 0};g=function(t,a){if(m(t),null===a||v(a))return t;throw new TypeError("Prototype must be null or an object")},ee.exports=(t=function(){var t,a=Object.create(null),r={},d=Object.getOwnPropertyDescriptor(Object.prototype,"__proto__");if(d){try{(t=d.set).call(a,r)}catch{}if(Object.getPrototypeOf(a)===r)return{set:t,level:2}}return a.__proto__=r,Object.getPrototypeOf(a)===r?{level:2}:((a={}).__proto__=r,Object.getPrototypeOf(a)===r&&{level:1})}(),t?(2===t.level?t.set?(r=t.set,a=function(d,s){return r.call(g(d,s),s),d}):a=function(d,s){return g(d,s).__proto__=s,d}:a=function d(s,i){var u;return g(s,i),(u=x.call(d.nullPolyfill,s))&&delete d.nullPolyfill.__proto__,null===i&&(i=d.nullPolyfill),s.__proto__=i,u&&e(d.nullPolyfill,"__proto__",n),s},Object.defineProperty(a,"level",{configurable:!1,enumerable:!1,writable:!1,value:t.level})):null),y("../create")},{"../create":148,"../is-object":150,"../valid-value":162}],160:[function(y,ee,Q){"use strict";ee.exports=function(g){if("function"!=typeof g)throw new TypeError(g+" is not a function");return g}},{}],161:[function(y,ee,Q){"use strict";var g=y("./is-object");ee.exports=function(v){if(!g(v))throw new TypeError(v+" is not an Object");return v}},{"./is-object":150}],162:[function(y,ee,Q){"use strict";var g=y("./is-value");ee.exports=function(v){if(!g(v))throw new TypeError("Cannot use null or undefined");return v}},{"./is-value":151}],163:[function(y,ee,Q){"use strict";ee.exports=y("./is-implemented")()?String.prototype.contains:y("./shim")},{"./is-implemented":164,"./shim":165}],164:[function(y,ee,Q){"use strict";var g="razdwatrzy";ee.exports=function(){return"function"==typeof g.contains&&!0===g.contains("dwa")&&!1===g.contains("foo")}},{}],165:[function(y,ee,Q){"use strict";var g=String.prototype.indexOf;ee.exports=function(v){return g.call(this,v,arguments[1])>-1}},{}],166:[function(y,ee,Q){"use strict";var g=Object.prototype.toString,v=g.call("");ee.exports=function(m){return"string"==typeof m||m&&"object"==typeof m&&(m instanceof String||g.call(m)===v)||!1}},{}],167:[function(y,ee,Q){"use strict";var g=Object.create(null),v=Math.random;ee.exports=function(){var m;do{m=v().toString(36).slice(2)}while(g[m]);return m}},{}],168:[function(y,ee,Q){"use strict";var g,v=y("es5-ext/object/set-prototype-of"),m=y("es5-ext/string/#/contains"),x=y("d"),e=y("es6-symbol"),n=y("./"),t=Object.defineProperty;g=ee.exports=function(a,r){if(!(this instanceof g))throw new TypeError("Constructor requires 'new'");n.call(this,a),r=r?m.call(r,"key+value")?"key+value":m.call(r,"key")?"key":"value":"value",t(this,"__kind__",x("",r))},v&&v(g,n),delete g.prototype.constructor,g.prototype=Object.create(n.prototype,{_resolve:x(function(a){return"value"===this.__kind__?this.__list__[a]:"key+value"===this.__kind__?[a,this.__list__[a]]:a})}),t(g.prototype,e.toStringTag,x("c","Array Iterator"))},{"./":171,d:106,"es5-ext/object/set-prototype-of":157,"es5-ext/string/#/contains":163,"es6-symbol":175}],169:[function(y,ee,Q){"use strict";var g=y("es5-ext/function/is-arguments"),v=y("es5-ext/object/valid-callable"),m=y("es5-ext/string/is-string"),x=y("./get"),e=Array.isArray,n=Function.prototype.call,t=Array.prototype.some;ee.exports=function(a,r){var d,s,i,u,f,c,h,p,o=arguments[2];if(e(a)||g(a)?d="array":m(a)?d="string":a=x(a),v(r),i=function(){u=!0},"array"!==d)if("string"!==d)for(s=a.next();!s.done;){if(n.call(r,o,s.value,i),u)return;s=a.next()}else for(c=a.length,f=0;f<c&&(h=a[f],f+1<c&&(p=h.charCodeAt(0))>=55296&&p<=56319&&(h+=a[++f]),n.call(r,o,h,i),!u);++f);else t.call(a,function(b){return n.call(r,o,b,i),u})}},{"./get":170,"es5-ext/function/is-arguments":135,"es5-ext/object/valid-callable":160,"es5-ext/string/is-string":166}],170:[function(y,ee,Q){"use strict";var g=y("es5-ext/function/is-arguments"),v=y("es5-ext/string/is-string"),m=y("./array"),x=y("./string"),e=y("./valid-iterable"),n=y("es6-symbol").iterator;ee.exports=function(t){return"function"==typeof e(t)[n]?t[n]():g(t)?new m(t):v(t)?new x(t):new m(t)}},{"./array":168,"./string":173,"./valid-iterable":174,"es5-ext/function/is-arguments":135,"es5-ext/string/is-string":166,"es6-symbol":175}],171:[function(y,ee,Q){"use strict";var g,v=y("es5-ext/array/#/clear"),m=y("es5-ext/object/assign"),x=y("es5-ext/object/valid-callable"),e=y("es5-ext/object/valid-value"),n=y("d"),t=y("d/auto-bind"),a=y("es6-symbol"),r=Object.defineProperty,d=Object.defineProperties;ee.exports=g=function(s,i){if(!(this instanceof g))throw new TypeError("Constructor requires 'new'");d(this,{__list__:n("w",e(s)),__context__:n("w",i),__nextIndex__:n("w",0)}),i&&(x(i.on),i.on("_add",this._onAdd),i.on("_delete",this._onDelete),i.on("_clear",this._onClear))},delete g.prototype.constructor,d(g.prototype,m({_next:n(function(){var s;if(this.__list__)return this.__redo__&&void 0!==(s=this.__redo__.shift())?s:this.__nextIndex__<this.__list__.length?this.__nextIndex__++:void this._unBind()}),next:n(function(){return this._createResult(this._next())}),_createResult:n(function(s){return void 0===s?{done:!0,value:void 0}:{done:!1,value:this._resolve(s)}}),_resolve:n(function(s){return this.__list__[s]}),_unBind:n(function(){this.__list__=null,delete this.__redo__,this.__context__&&(this.__context__.off("_add",this._onAdd),this.__context__.off("_delete",this._onDelete),this.__context__.off("_clear",this._onClear),this.__context__=null)}),toString:n(function(){return"[object "+(this[a.toStringTag]||"Object")+"]"})},t({_onAdd:n(function(s){s>=this.__nextIndex__||(++this.__nextIndex__,this.__redo__?(this.__redo__.forEach(function(i,u){i>=s&&(this.__redo__[u]=++i)},this),this.__redo__.push(s)):r(this,"__redo__",n("c",[s])))}),_onDelete:n(function(s){var i;s>=this.__nextIndex__||(--this.__nextIndex__,this.__redo__&&(-1!==(i=this.__redo__.indexOf(s))&&this.__redo__.splice(i,1),this.__redo__.forEach(function(u,f){u>s&&(this.__redo__[f]=--u)},this)))}),_onClear:n(function(){this.__redo__&&v.call(this.__redo__),this.__nextIndex__=0})}))),r(g.prototype,a.iterator,n(function(){return this}))},{d:106,"d/auto-bind":105,"es5-ext/array/#/clear":131,"es5-ext/object/assign":144,"es5-ext/object/valid-callable":160,"es5-ext/object/valid-value":162,"es6-symbol":175}],172:[function(y,ee,Q){"use strict";var g=y("es5-ext/function/is-arguments"),v=y("es5-ext/object/is-value"),m=y("es5-ext/string/is-string"),x=y("es6-symbol").iterator,e=Array.isArray;ee.exports=function(n){return!(!v(n)||!e(n)&&!m(n)&&!g(n)&&"function"!=typeof n[x])}},{"es5-ext/function/is-arguments":135,"es5-ext/object/is-value":151,"es5-ext/string/is-string":166,"es6-symbol":175}],173:[function(y,ee,Q){"use strict";var g,v=y("es5-ext/object/set-prototype-of"),m=y("d"),x=y("es6-symbol"),e=y("./"),n=Object.defineProperty;g=ee.exports=function(t){if(!(this instanceof g))throw new TypeError("Constructor requires 'new'");t=String(t),e.call(this,t),n(this,"__length__",m("",t.length))},v&&v(g,e),delete g.prototype.constructor,g.prototype=Object.create(e.prototype,{_next:m(function(){if(this.__list__)return this.__nextIndex__<this.__length__?this.__nextIndex__++:void this._unBind()}),_resolve:m(function(t){var a,r=this.__list__[t];return this.__nextIndex__===this.__length__?r:(a=r.charCodeAt(0))>=55296&&a<=56319?r+this.__list__[this.__nextIndex__++]:r})}),n(g.prototype,x.toStringTag,m("c","String Iterator"))},{"./":171,d:106,"es5-ext/object/set-prototype-of":157,"es6-symbol":175}],174:[function(y,ee,Q){"use strict";var g=y("./is-iterable");ee.exports=function(v){if(!g(v))throw new TypeError(v+" is not iterable");return v}},{"./is-iterable":172}],175:[function(y,ee,Q){"use strict";ee.exports=y("./is-implemented")()?y("ext/global-this").Symbol:y("./polyfill")},{"./is-implemented":176,"./polyfill":181,"ext/global-this":188}],176:[function(y,ee,Q){"use strict";var g=y("ext/global-this"),v={object:!0,symbol:!0};ee.exports=function(){var m,x=g.Symbol;if("function"!=typeof x)return!1;m=x("test symbol");try{String(m)}catch{return!1}return!!v[typeof x.iterator]&&!!v[typeof x.toPrimitive]&&!!v[typeof x.toStringTag]}},{"ext/global-this":188}],177:[function(y,ee,Q){"use strict";ee.exports=function(g){return!!g&&("symbol"==typeof g||!!g.constructor&&"Symbol"===g.constructor.name&&"Symbol"===g[g.constructor.toStringTag])}},{}],178:[function(y,ee,Q){"use strict";var g=y("d"),m=Object.defineProperty,x=Object.prototype,e=(0,Object.create)(null);ee.exports=function(n){for(var t,a,r=0;e[n+(r||"")];)++r;return e[n+=r||""]=!0,m(x,t="@@"+n,g.gs(null,function(d){a||(a=!0,m(this,t,g(d)),a=!1)})),t}},{d:106}],179:[function(y,ee,Q){"use strict";var g=y("d"),v=y("ext/global-this").Symbol;ee.exports=function(m){return Object.defineProperties(m,{hasInstance:g("",v&&v.hasInstance||m("hasInstance")),isConcatSpreadable:g("",v&&v.isConcatSpreadable||m("isConcatSpreadable")),iterator:g("",v&&v.iterator||m("iterator")),match:g("",v&&v.match||m("match")),replace:g("",v&&v.replace||m("replace")),search:g("",v&&v.search||m("search")),species:g("",v&&v.species||m("species")),split:g("",v&&v.split||m("split")),toPrimitive:g("",v&&v.toPrimitive||m("toPrimitive")),toStringTag:g("",v&&v.toStringTag||m("toStringTag")),unscopables:g("",v&&v.unscopables||m("unscopables"))})}},{d:106,"ext/global-this":188}],180:[function(y,ee,Q){"use strict";var g=y("d"),v=y("../../../validate-symbol"),m=Object.create(null);ee.exports=function(x){return Object.defineProperties(x,{for:g(function(e){return m[e]?m[e]:m[e]=x(String(e))}),keyFor:g(function(e){var n;for(n in v(e),m)if(m[n]===e)return n})})}},{"../../../validate-symbol":182,d:106}],181:[function(y,ee,Q){"use strict";var g,v,m,x=y("d"),e=y("./validate-symbol"),n=y("ext/global-this").Symbol,t=y("./lib/private/generate-name"),a=y("./lib/private/setup/standard-symbols"),r=y("./lib/private/setup/symbol-registry"),d=Object.create,s=Object.defineProperties,i=Object.defineProperty;if("function"==typeof n)try{String(n()),m=!0}catch{}else n=null;v=function(u){if(this instanceof v)throw new TypeError("Symbol is not a constructor");return g(u)},ee.exports=g=function u(f){var c;if(this instanceof u)throw new TypeError("Symbol is not a constructor");return m?n(f):(c=d(v.prototype),f=void 0===f?"":String(f),s(c,{__description__:x("",f),__name__:x("",t(f))}))},a(g),r(g),s(v.prototype,{constructor:x(g),toString:x("",function(){return this.__name__})}),s(g.prototype,{toString:x(function(){return"Symbol ("+e(this).__description__+")"}),valueOf:x(function(){return e(this)})}),i(g.prototype,g.toPrimitive,x("",function(){var u=e(this);return"symbol"==typeof u?u:u.toString()})),i(g.prototype,g.toStringTag,x("c","Symbol")),i(v.prototype,g.toStringTag,x("c",g.prototype[g.toStringTag])),i(v.prototype,g.toPrimitive,x("c",g.prototype[g.toPrimitive]))},{"./lib/private/generate-name":178,"./lib/private/setup/standard-symbols":179,"./lib/private/setup/symbol-registry":180,"./validate-symbol":182,d:106,"ext/global-this":188}],182:[function(y,ee,Q){"use strict";var g=y("./is-symbol");ee.exports=function(v){if(!g(v))throw new TypeError(v+" is not a symbol");return v}},{"./is-symbol":177}],183:[function(y,ee,Q){"use strict";ee.exports=y("./is-implemented")()?WeakMap:y("./polyfill")},{"./is-implemented":184,"./polyfill":186}],184:[function(y,ee,Q){"use strict";ee.exports=function(){var g,v;if("function"!=typeof WeakMap)return!1;try{g=new WeakMap([[v={},"one"],[{},"two"],[{},"three"]])}catch{return!1}return"[object WeakMap]"===String(g)&&"function"==typeof g.set&&g.set({},1)===g&&"function"==typeof g.delete&&"function"==typeof g.has&&"one"===g.get(v)}},{}],185:[function(y,ee,Q){"use strict";ee.exports="function"==typeof WeakMap&&"[object WeakMap]"===Object.prototype.toString.call(new WeakMap)},{}],186:[function(y,ee,Q){"use strict";var g,v=y("es5-ext/object/is-value"),m=y("es5-ext/object/set-prototype-of"),x=y("es5-ext/object/valid-object"),e=y("es5-ext/object/valid-value"),n=y("es5-ext/string/random-uniq"),t=y("d"),a=y("es6-iterator/get"),r=y("es6-iterator/for-of"),d=y("es6-symbol").toStringTag,s=y("./is-native-implemented"),i=Array.isArray,u=Object.defineProperty,f=Object.prototype.hasOwnProperty,c=Object.getPrototypeOf;ee.exports=g=function(){var h,p=arguments[0];if(!(this instanceof g))throw new TypeError("Constructor requires 'new'");return h=s&&m&&WeakMap!==g?m(new WeakMap,c(this)):this,v(p)&&(i(p)||(p=a(p))),u(h,"__weakMapData__",t("c","$weakMap$"+n())),p&&r(p,function(o){e(o),h.set(o[0],o[1])}),h},s&&(m&&m(g,WeakMap),g.prototype=Object.create(WeakMap.prototype,{constructor:t(g)})),Object.defineProperties(g.prototype,{delete:t(function(h){return!!f.call(x(h),this.__weakMapData__)&&(delete h[this.__weakMapData__],!0)}),get:t(function(h){if(f.call(x(h),this.__weakMapData__))return h[this.__weakMapData__]}),has:t(function(h){return f.call(x(h),this.__weakMapData__)}),set:t(function(h,p){return u(x(h),this.__weakMapData__,t("c",p)),this}),toString:t(function(){return"[object WeakMap]"})}),u(g.prototype,d,t("c","WeakMap"))},{"./is-native-implemented":185,d:106,"es5-ext/object/is-value":151,"es5-ext/object/set-prototype-of":157,"es5-ext/object/valid-object":161,"es5-ext/object/valid-value":162,"es5-ext/string/random-uniq":167,"es6-iterator/for-of":169,"es6-iterator/get":170,"es6-symbol":175}],187:[function(y,ee,Q){var g=function(){if("object"==typeof self&&self)return self;if("object"==typeof window&&window)return window;throw new Error("Unable to resolve global `this`")};ee.exports=function(){if(this)return this;try{Object.defineProperty(Object.prototype,"__global__",{get:function(){return this},configurable:!0})}catch{return g()}try{return __global__||g()}finally{delete Object.prototype.__global__}}()},{}],188:[function(y,ee,Q){"use strict";ee.exports=y("./is-implemented")()?globalThis:y("./implementation")},{"./implementation":187,"./is-implemented":189}],189:[function(y,ee,Q){"use strict";ee.exports=function(){return"object"==typeof globalThis&&!!globalThis&&globalThis.Array===Array}},{}],190:[function(y,ee,Q){"use strict";var g=y("is-string-blank");ee.exports=function(v){var m=typeof v;if("string"===m){var x=v;if(0==(v=+v)&&g(x))return!1}else if("number"!==m)return!1;return v-v<1}},{"is-string-blank":237}],191:[function(y,ee,Q){var g=y("dtype");ee.exports=function(v,m,x){if(!v)throw new TypeError("must specify data as first parameter");if(x=0|+(x||0),Array.isArray(v)&&v[0]&&"number"==typeof v[0][0]){var e,n,t,a,r=v[0].length,d=v.length*r;m&&"string"!=typeof m||(m=new(g(m||"float32"))(d+x));var s=m.length-x;if(d!==s)throw new Error("source length "+d+" ("+r+"x"+v.length+") does not match destination length "+s);for(e=0,t=x;e<v.length;e++)for(n=0;n<r;n++)m[t++]=null===v[e][n]?NaN:v[e][n]}else if(m&&"string"!=typeof m)m.set(v,x);else{var i=g(m||"float32");if(Array.isArray(v)||"array"===m)for(e=0,t=x,a=(m=new i(v.length+x)).length;t<a;t++,e++)m[t]=null===v[e]?NaN:v[e];else 0===x?m=new i(v):(m=new i(v.length+x)).set(v,x)}return m}},{dtype:127}],192:[function(y,ee,Q){"use strict";var g=y("css-font/stringify"),v=[32,126];ee.exports=function(m){var x=(m=m||{}).shape?m.shape:m.canvas?[m.canvas.width,m.canvas.height]:[512,512],e=m.canvas||document.createElement("canvas"),n=m.font,t="number"==typeof m.step?[m.step,m.step]:m.step||[32,32],a=m.chars||v;if(n&&"string"!=typeof n&&(n=g(n)),Array.isArray(a)){if(2===a.length&&"number"==typeof a[0]&&"number"==typeof a[1]){for(var r=[],d=a[0],s=0;d<=a[1];d++)r[s++]=String.fromCharCode(d);a=r}}else a=String(a).split("");x=x.slice(),e.width=x[0],e.height=x[1];var i=e.getContext("2d");i.fillStyle="#000",i.fillRect(0,0,e.width,e.height),i.font=n,i.textAlign="center",i.textBaseline="middle",i.fillStyle="#fff";var u=t[0]/2,f=t[1]/2;for(d=0;d<a.length;d++)i.fillText(a[d],u,f),(u+=t[0])>x[0]-t[0]/2&&(u=t[0]/2,f+=t[1]);return e}},{"css-font/stringify":102}],193:[function(y,ee,Q){"use strict";function g(e,n){n||(n={}),("string"==typeof e||Array.isArray(e))&&(n.family=e);var t=Array.isArray(n.family)?n.family.join(", "):n.family;if(!t)throw Error("`family` must be defined");var a=n.size||n.fontSize||n.em||48,d=(e=[n.style||n.fontStyle||"",n.weight||n.fontWeight||"",a].join(" ")+"px "+t,n.origin||"top");if(g.cache[t]&&a<=g.cache[t].em)return v(g.cache[t],d);var s=n.canvas||g.canvas,i=s.getContext("2d"),u={upper:void 0!==n.upper?n.upper:"H",lower:void 0!==n.lower?n.lower:"x",descent:void 0!==n.descent?n.descent:"p",ascent:void 0!==n.ascent?n.ascent:"h",tittle:void 0!==n.tittle?n.tittle:"i",overshoot:void 0!==n.overshoot?n.overshoot:"O"},f=Math.ceil(1.5*a);s.height=f,s.width=.5*f,i.font=e;var c={top:0};i.clearRect(0,0,f,f),i.textBaseline="top",i.fillStyle="black",i.fillText("H",0,0);var h=m(i.getImageData(0,0,f,f));i.clearRect(0,0,f,f),i.textBaseline="bottom",i.fillText("H",0,f);var p=m(i.getImageData(0,0,f,f));c.lineHeight=c.bottom=f-p+h,i.clearRect(0,0,f,f),i.textBaseline="alphabetic",i.fillText("H",0,f);var o=f-m(i.getImageData(0,0,f,f))-1+h;c.baseline=c.alphabetic=o,i.clearRect(0,0,f,f),i.textBaseline="middle",i.fillText("H",0,.5*f);var b=m(i.getImageData(0,0,f,f));c.median=c.middle=f-b-1+h-.5*f,i.clearRect(0,0,f,f),i.textBaseline="hanging",i.fillText("H",0,.5*f);var l=m(i.getImageData(0,0,f,f));c.hanging=f-l-1+h-.5*f,i.clearRect(0,0,f,f),i.textBaseline="ideographic",i.fillText("H",0,f);var T=m(i.getImageData(0,0,f,f));if(c.ideographic=f-T-1+h,u.upper&&(i.clearRect(0,0,f,f),i.textBaseline="top",i.fillText(u.upper,0,0),c.upper=m(i.getImageData(0,0,f,f)),c.capHeight=c.baseline-c.upper),u.lower&&(i.clearRect(0,0,f,f),i.textBaseline="top",i.fillText(u.lower,0,0),c.lower=m(i.getImageData(0,0,f,f)),c.xHeight=c.baseline-c.lower),u.tittle&&(i.clearRect(0,0,f,f),i.textBaseline="top",i.fillText(u.tittle,0,0),c.tittle=m(i.getImageData(0,0,f,f))),u.ascent&&(i.clearRect(0,0,f,f),i.textBaseline="top",i.fillText(u.ascent,0,0),c.ascent=m(i.getImageData(0,0,f,f))),u.descent&&(i.clearRect(0,0,f,f),i.textBaseline="top",i.fillText(u.descent,0,0),c.descent=x(i.getImageData(0,0,f,f))),u.overshoot){i.clearRect(0,0,f,f),i.textBaseline="top",i.fillText(u.overshoot,0,0);var _=x(i.getImageData(0,0,f,f));c.overshoot=_-o}for(var w in c)c[w]/=a;return c.em=a,g.cache[t]=c,v(c,d)}function v(e,n){var t={};for(var a in"string"==typeof n&&(n=e[n]),e)"em"!==a&&(t[a]=e[a]-n);return t}function m(e){for(var n=e.height,t=e.data,a=3;a<t.length;a+=4)if(0!==t[a])return Math.floor(.25*(a-3)/n)}function x(e){for(var n=e.height,t=e.data,a=t.length-1;a>0;a-=4)if(0!==t[a])return Math.floor(.25*(a-3)/n)}ee.exports=g,g.canvas=document.createElement("canvas"),g.cache={}},{}],194:[function(y,ee,Q){ee.exports=function(g,v){if("string"!=typeof g)throw new TypeError("must specify type string");if(v=v||{},typeof document>"u"&&!v.canvas)return null;var m=v.canvas||document.createElement("canvas");"number"==typeof v.width&&(m.width=v.width),"number"==typeof v.height&&(m.height=v.height);var x,e=v;try{var n=[g];0===g.indexOf("webgl")&&n.push("experimental-"+g);for(var t=0;t<n.length;t++)if(x=m.getContext(n[t],e))return x}catch{x=null}return x||null}},{}],195:[function(y,ee,Q){ee.exports=function(g,v){var m=v[0],x=v[1],e=v[2],n=v[3],t=v[4],a=v[5],r=v[6],d=v[7],s=v[8],i=v[9],u=v[10],f=v[11],c=v[12],h=v[13],p=v[14],o=v[15];return g[0]=a*(u*o-f*p)-i*(r*o-d*p)+h*(r*f-d*u),g[1]=-(x*(u*o-f*p)-i*(e*o-n*p)+h*(e*f-n*u)),g[2]=x*(r*o-d*p)-a*(e*o-n*p)+h*(e*d-n*r),g[3]=-(x*(r*f-d*u)-a*(e*f-n*u)+i*(e*d-n*r)),g[4]=-(t*(u*o-f*p)-s*(r*o-d*p)+c*(r*f-d*u)),g[5]=m*(u*o-f*p)-s*(e*o-n*p)+c*(e*f-n*u),g[6]=-(m*(r*o-d*p)-t*(e*o-n*p)+c*(e*d-n*r)),g[7]=m*(r*f-d*u)-t*(e*f-n*u)+s*(e*d-n*r),g[8]=t*(i*o-f*h)-s*(a*o-d*h)+c*(a*f-d*i),g[9]=-(m*(i*o-f*h)-s*(x*o-n*h)+c*(x*f-n*i)),g[10]=m*(a*o-d*h)-t*(x*o-n*h)+c*(x*d-n*a),g[11]=-(m*(a*f-d*i)-t*(x*f-n*i)+s*(x*d-n*a)),g[12]=-(t*(i*p-u*h)-s*(a*p-r*h)+c*(a*u-r*i)),g[13]=m*(i*p-u*h)-s*(x*p-e*h)+c*(x*u-e*i),g[14]=-(m*(a*p-r*h)-t*(x*p-e*h)+c*(x*r-e*a)),g[15]=m*(a*u-r*i)-t*(x*u-e*i)+s*(x*r-e*a),g}},{}],196:[function(y,ee,Q){ee.exports=function(g){var v=new Float32Array(16);return v[0]=g[0],v[1]=g[1],v[2]=g[2],v[3]=g[3],v[4]=g[4],v[5]=g[5],v[6]=g[6],v[7]=g[7],v[8]=g[8],v[9]=g[9],v[10]=g[10],v[11]=g[11],v[12]=g[12],v[13]=g[13],v[14]=g[14],v[15]=g[15],v}},{}],197:[function(y,ee,Q){ee.exports=function(g,v){return g[0]=v[0],g[1]=v[1],g[2]=v[2],g[3]=v[3],g[4]=v[4],g[5]=v[5],g[6]=v[6],g[7]=v[7],g[8]=v[8],g[9]=v[9],g[10]=v[10],g[11]=v[11],g[12]=v[12],g[13]=v[13],g[14]=v[14],g[15]=v[15],g}},{}],198:[function(y,ee,Q){ee.exports=function(){var g=new Float32Array(16);return g[0]=1,g[1]=0,g[2]=0,g[3]=0,g[4]=0,g[5]=1,g[6]=0,g[7]=0,g[8]=0,g[9]=0,g[10]=1,g[11]=0,g[12]=0,g[13]=0,g[14]=0,g[15]=1,g}},{}],199:[function(y,ee,Q){ee.exports=function(g){var v=g[0],m=g[1],x=g[2],e=g[3],n=g[4],t=g[5],a=g[6],r=g[7],d=g[8],s=g[9],i=g[10],u=g[11],f=g[12],c=g[13],h=g[14],p=g[15];return(v*t-m*n)*(i*p-u*h)-(v*a-x*n)*(s*p-u*c)+(v*r-e*n)*(s*h-i*c)+(m*a-x*t)*(d*p-u*f)-(m*r-e*t)*(d*h-i*f)+(x*r-e*a)*(d*c-s*f)}},{}],200:[function(y,ee,Q){ee.exports=function(g,v){var m=v[0],x=v[1],e=v[2],n=v[3],t=m+m,a=x+x,r=e+e,d=m*t,s=x*t,i=x*a,u=e*t,f=e*a,c=e*r,h=n*t,p=n*a,o=n*r;return g[0]=1-i-c,g[1]=s+o,g[2]=u-p,g[3]=0,g[4]=s-o,g[5]=1-d-c,g[6]=f+h,g[7]=0,g[8]=u+p,g[9]=f-h,g[10]=1-d-i,g[11]=0,g[12]=0,g[13]=0,g[14]=0,g[15]=1,g}},{}],201:[function(y,ee,Q){ee.exports=function(g,v,m){var x,e,n,t=m[0],a=m[1],r=m[2],d=Math.sqrt(t*t+a*a+r*r);return Math.abs(d)<1e-6?null:(t*=d=1/d,a*=d,r*=d,x=Math.sin(v),e=Math.cos(v),g[0]=t*t*(n=1-e)+e,g[1]=a*t*n+r*x,g[2]=r*t*n-a*x,g[3]=0,g[4]=t*a*n-r*x,g[5]=a*a*n+e,g[6]=r*a*n+t*x,g[7]=0,g[8]=t*r*n+a*x,g[9]=a*r*n-t*x,g[10]=r*r*n+e,g[11]=0,g[12]=0,g[13]=0,g[14]=0,g[15]=1,g)}},{}],202:[function(y,ee,Q){ee.exports=function(g,v,m){var x=v[0],e=v[1],n=v[2],t=v[3],a=x+x,r=e+e,d=n+n,s=x*a,i=x*r,u=x*d,f=e*r,c=e*d,h=n*d,p=t*a,o=t*r,b=t*d;return g[0]=1-(f+h),g[1]=i+b,g[2]=u-o,g[3]=0,g[4]=i-b,g[5]=1-(s+h),g[6]=c+p,g[7]=0,g[8]=u+o,g[9]=c-p,g[10]=1-(s+f),g[11]=0,g[12]=m[0],g[13]=m[1],g[14]=m[2],g[15]=1,g}},{}],203:[function(y,ee,Q){ee.exports=function(g,v){return g[0]=v[0],g[1]=0,g[2]=0,g[3]=0,g[4]=0,g[5]=v[1],g[6]=0,g[7]=0,g[8]=0,g[9]=0,g[10]=v[2],g[11]=0,g[12]=0,g[13]=0,g[14]=0,g[15]=1,g}},{}],204:[function(y,ee,Q){ee.exports=function(g,v){return g[0]=1,g[1]=0,g[2]=0,g[3]=0,g[4]=0,g[5]=1,g[6]=0,g[7]=0,g[8]=0,g[9]=0,g[10]=1,g[11]=0,g[12]=v[0],g[13]=v[1],g[14]=v[2],g[15]=1,g}},{}],205:[function(y,ee,Q){ee.exports=function(g,v){var m=Math.sin(v),x=Math.cos(v);return g[0]=1,g[1]=0,g[2]=0,g[3]=0,g[4]=0,g[5]=x,g[6]=m,g[7]=0,g[8]=0,g[9]=-m,g[10]=x,g[11]=0,g[12]=0,g[13]=0,g[14]=0,g[15]=1,g}},{}],206:[function(y,ee,Q){ee.exports=function(g,v){var m=Math.sin(v),x=Math.cos(v);return g[0]=x,g[1]=0,g[2]=-m,g[3]=0,g[4]=0,g[5]=1,g[6]=0,g[7]=0,g[8]=m,g[9]=0,g[10]=x,g[11]=0,g[12]=0,g[13]=0,g[14]=0,g[15]=1,g}},{}],207:[function(y,ee,Q){ee.exports=function(g,v){var m=Math.sin(v),x=Math.cos(v);return g[0]=x,g[1]=m,g[2]=0,g[3]=0,g[4]=-m,g[5]=x,g[6]=0,g[7]=0,g[8]=0,g[9]=0,g[10]=1,g[11]=0,g[12]=0,g[13]=0,g[14]=0,g[15]=1,g}},{}],208:[function(y,ee,Q){ee.exports=function(g,v,m,x,e,n,t){var a=1/(m-v),r=1/(e-x),d=1/(n-t);return g[0]=2*n*a,g[1]=0,g[2]=0,g[3]=0,g[4]=0,g[5]=2*n*r,g[6]=0,g[7]=0,g[8]=(m+v)*a,g[9]=(e+x)*r,g[10]=(t+n)*d,g[11]=-1,g[12]=0,g[13]=0,g[14]=t*n*2*d,g[15]=0,g}},{}],209:[function(y,ee,Q){ee.exports=function(g){return g[0]=1,g[1]=0,g[2]=0,g[3]=0,g[4]=0,g[5]=1,g[6]=0,g[7]=0,g[8]=0,g[9]=0,g[10]=1,g[11]=0,g[12]=0,g[13]=0,g[14]=0,g[15]=1,g}},{}],210:[function(y,ee,Q){ee.exports={create:y("./create"),clone:y("./clone"),copy:y("./copy"),identity:y("./identity"),transpose:y("./transpose"),invert:y("./invert"),adjoint:y("./adjoint"),determinant:y("./determinant"),multiply:y("./multiply"),translate:y("./translate"),scale:y("./scale"),rotate:y("./rotate"),rotateX:y("./rotateX"),rotateY:y("./rotateY"),rotateZ:y("./rotateZ"),fromRotation:y("./fromRotation"),fromRotationTranslation:y("./fromRotationTranslation"),fromScaling:y("./fromScaling"),fromTranslation:y("./fromTranslation"),fromXRotation:y("./fromXRotation"),fromYRotation:y("./fromYRotation"),fromZRotation:y("./fromZRotation"),fromQuat:y("./fromQuat"),frustum:y("./frustum"),perspective:y("./perspective"),perspectiveFromFieldOfView:y("./perspectiveFromFieldOfView"),ortho:y("./ortho"),lookAt:y("./lookAt"),str:y("./str")}},{"./adjoint":195,"./clone":196,"./copy":197,"./create":198,"./determinant":199,"./fromQuat":200,"./fromRotation":201,"./fromRotationTranslation":202,"./fromScaling":203,"./fromTranslation":204,"./fromXRotation":205,"./fromYRotation":206,"./fromZRotation":207,"./frustum":208,"./identity":209,"./invert":211,"./lookAt":212,"./multiply":213,"./ortho":214,"./perspective":215,"./perspectiveFromFieldOfView":216,"./rotate":217,"./rotateX":218,"./rotateY":219,"./rotateZ":220,"./scale":221,"./str":222,"./translate":223,"./transpose":224}],211:[function(y,ee,Q){ee.exports=function(g,v){var m=v[0],x=v[1],e=v[2],n=v[3],t=v[4],a=v[5],r=v[6],d=v[7],s=v[8],i=v[9],u=v[10],f=v[11],c=v[12],h=v[13],p=v[14],o=v[15],b=m*a-x*t,l=m*r-e*t,T=m*d-n*t,_=x*r-e*a,w=x*d-n*a,k=e*d-n*r,L=s*h-i*c,M=s*p-u*c,I=s*o-f*c,P=i*p-u*h,S=i*o-f*h,E=u*o-f*p,z=b*E-l*S+T*P+_*I-w*M+k*L;return z?(g[0]=(a*E-r*S+d*P)*(z=1/z),g[1]=(e*S-x*E-n*P)*z,g[2]=(h*k-p*w+o*_)*z,g[3]=(u*w-i*k-f*_)*z,g[4]=(r*I-t*E-d*M)*z,g[5]=(m*E-e*I+n*M)*z,g[6]=(p*T-c*k-o*l)*z,g[7]=(s*k-u*T+f*l)*z,g[8]=(t*S-a*I+d*L)*z,g[9]=(x*I-m*S-n*L)*z,g[10]=(c*w-h*T+o*b)*z,g[11]=(i*T-s*w-f*b)*z,g[12]=(a*M-t*P-r*L)*z,g[13]=(m*P-x*M+e*L)*z,g[14]=(h*l-c*_-p*b)*z,g[15]=(s*_-i*l+u*b)*z,g):null}},{}],212:[function(y,ee,Q){var g=y("./identity");ee.exports=function(v,m,x,e){var n,t,a,r,d,s,i,u,f,c,h=m[0],p=m[1],o=m[2],b=e[0],l=e[1],T=e[2],_=x[0],w=x[1],k=x[2];return Math.abs(h-_)<1e-6&&Math.abs(p-w)<1e-6&&Math.abs(o-k)<1e-6?g(v):(i=h-_,u=p-w,f=o-k,n=l*(f*=c=1/Math.sqrt(i*i+u*u+f*f))-T*(u*=c),t=T*(i*=c)-b*f,a=b*u-l*i,(c=Math.sqrt(n*n+t*t+a*a))?(n*=c=1/c,t*=c,a*=c):(n=0,t=0,a=0),r=u*a-f*t,d=f*n-i*a,s=i*t-u*n,(c=Math.sqrt(r*r+d*d+s*s))?(r*=c=1/c,d*=c,s*=c):(r=0,d=0,s=0),v[0]=n,v[1]=r,v[2]=i,v[3]=0,v[4]=t,v[5]=d,v[6]=u,v[7]=0,v[8]=a,v[9]=s,v[10]=f,v[11]=0,v[12]=-(n*h+t*p+a*o),v[13]=-(r*h+d*p+s*o),v[14]=-(i*h+u*p+f*o),v[15]=1,v)}},{"./identity":209}],213:[function(y,ee,Q){ee.exports=function(g,v,m){var x=v[0],e=v[1],n=v[2],t=v[3],a=v[4],r=v[5],d=v[6],s=v[7],i=v[8],u=v[9],f=v[10],c=v[11],h=v[12],p=v[13],o=v[14],b=v[15],l=m[0],T=m[1],_=m[2],w=m[3];return g[0]=l*x+T*a+_*i+w*h,g[1]=l*e+T*r+_*u+w*p,g[2]=l*n+T*d+_*f+w*o,g[3]=l*t+T*s+_*c+w*b,g[4]=(l=m[4])*x+(T=m[5])*a+(_=m[6])*i+(w=m[7])*h,g[5]=l*e+T*r+_*u+w*p,g[6]=l*n+T*d+_*f+w*o,g[7]=l*t+T*s+_*c+w*b,g[8]=(l=m[8])*x+(T=m[9])*a+(_=m[10])*i+(w=m[11])*h,g[9]=l*e+T*r+_*u+w*p,g[10]=l*n+T*d+_*f+w*o,g[11]=l*t+T*s+_*c+w*b,g[12]=(l=m[12])*x+(T=m[13])*a+(_=m[14])*i+(w=m[15])*h,g[13]=l*e+T*r+_*u+w*p,g[14]=l*n+T*d+_*f+w*o,g[15]=l*t+T*s+_*c+w*b,g}},{}],214:[function(y,ee,Q){ee.exports=function(g,v,m,x,e,n,t){var a=1/(v-m),r=1/(x-e),d=1/(n-t);return g[0]=-2*a,g[1]=0,g[2]=0,g[3]=0,g[4]=0,g[5]=-2*r,g[6]=0,g[7]=0,g[8]=0,g[9]=0,g[10]=2*d,g[11]=0,g[12]=(v+m)*a,g[13]=(e+x)*r,g[14]=(t+n)*d,g[15]=1,g}},{}],215:[function(y,ee,Q){ee.exports=function(g,v,m,x,e){var n=1/Math.tan(v/2),t=1/(x-e);return g[0]=n/m,g[1]=0,g[2]=0,g[3]=0,g[4]=0,g[5]=n,g[6]=0,g[7]=0,g[8]=0,g[9]=0,g[10]=(e+x)*t,g[11]=-1,g[12]=0,g[13]=0,g[14]=2*e*x*t,g[15]=0,g}},{}],216:[function(y,ee,Q){ee.exports=function(g,v,m,x){var e=Math.tan(v.upDegrees*Math.PI/180),n=Math.tan(v.downDegrees*Math.PI/180),t=Math.tan(v.leftDegrees*Math.PI/180),a=Math.tan(v.rightDegrees*Math.PI/180),r=2/(t+a),d=2/(e+n);return g[0]=r,g[1]=0,g[2]=0,g[3]=0,g[4]=0,g[5]=d,g[6]=0,g[7]=0,g[8]=-(t-a)*r*.5,g[9]=(e-n)*d*.5,g[10]=x/(m-x),g[11]=-1,g[12]=0,g[13]=0,g[14]=x*m/(m-x),g[15]=0,g}},{}],217:[function(y,ee,Q){ee.exports=function(g,v,m,x){var e,n,t,a,r,d,s,i,u,f,c,h,p,o,b,l,T,_,w,k,L,M,I,P,S=x[0],E=x[1],z=x[2],R=Math.sqrt(S*S+E*E+z*z);return Math.abs(R)<1e-6?null:(S*=R=1/R,E*=R,z*=R,e=Math.sin(m),n=Math.cos(m),r=v[1],d=v[2],s=v[3],u=v[5],f=v[6],c=v[7],p=v[9],o=v[10],b=v[11],w=S*E*(t=1-n)-z*e,k=E*E*t+n,L=z*E*t+S*e,M=S*z*t+E*e,I=E*z*t-S*e,P=z*z*t+n,g[0]=(a=v[0])*(l=S*S*t+n)+(i=v[4])*(T=E*S*t+z*e)+(h=v[8])*(_=z*S*t-E*e),g[1]=r*l+u*T+p*_,g[2]=d*l+f*T+o*_,g[3]=s*l+c*T+b*_,g[4]=a*w+i*k+h*L,g[5]=r*w+u*k+p*L,g[6]=d*w+f*k+o*L,g[7]=s*w+c*k+b*L,g[8]=a*M+i*I+h*P,g[9]=r*M+u*I+p*P,g[10]=d*M+f*I+o*P,g[11]=s*M+c*I+b*P,v!==g&&(g[12]=v[12],g[13]=v[13],g[14]=v[14],g[15]=v[15]),g)}},{}],218:[function(y,ee,Q){ee.exports=function(g,v,m){var x=Math.sin(m),e=Math.cos(m),n=v[4],t=v[5],a=v[6],r=v[7],d=v[8],s=v[9],i=v[10],u=v[11];return v!==g&&(g[0]=v[0],g[1]=v[1],g[2]=v[2],g[3]=v[3],g[12]=v[12],g[13]=v[13],g[14]=v[14],g[15]=v[15]),g[4]=n*e+d*x,g[5]=t*e+s*x,g[6]=a*e+i*x,g[7]=r*e+u*x,g[8]=d*e-n*x,g[9]=s*e-t*x,g[10]=i*e-a*x,g[11]=u*e-r*x,g}},{}],219:[function(y,ee,Q){ee.exports=function(g,v,m){var x=Math.sin(m),e=Math.cos(m),n=v[0],t=v[1],a=v[2],r=v[3],d=v[8],s=v[9],i=v[10],u=v[11];return v!==g&&(g[4]=v[4],g[5]=v[5],g[6]=v[6],g[7]=v[7],g[12]=v[12],g[13]=v[13],g[14]=v[14],g[15]=v[15]),g[0]=n*e-d*x,g[1]=t*e-s*x,g[2]=a*e-i*x,g[3]=r*e-u*x,g[8]=n*x+d*e,g[9]=t*x+s*e,g[10]=a*x+i*e,g[11]=r*x+u*e,g}},{}],220:[function(y,ee,Q){ee.exports=function(g,v,m){var x=Math.sin(m),e=Math.cos(m),n=v[0],t=v[1],a=v[2],r=v[3],d=v[4],s=v[5],i=v[6],u=v[7];return v!==g&&(g[8]=v[8],g[9]=v[9],g[10]=v[10],g[11]=v[11],g[12]=v[12],g[13]=v[13],g[14]=v[14],g[15]=v[15]),g[0]=n*e+d*x,g[1]=t*e+s*x,g[2]=a*e+i*x,g[3]=r*e+u*x,g[4]=d*e-n*x,g[5]=s*e-t*x,g[6]=i*e-a*x,g[7]=u*e-r*x,g}},{}],221:[function(y,ee,Q){ee.exports=function(g,v,m){var x=m[0],e=m[1],n=m[2];return g[0]=v[0]*x,g[1]=v[1]*x,g[2]=v[2]*x,g[3]=v[3]*x,g[4]=v[4]*e,g[5]=v[5]*e,g[6]=v[6]*e,g[7]=v[7]*e,g[8]=v[8]*n,g[9]=v[9]*n,g[10]=v[10]*n,g[11]=v[11]*n,g[12]=v[12],g[13]=v[13],g[14]=v[14],g[15]=v[15],g}},{}],222:[function(y,ee,Q){ee.exports=function(g){return"mat4("+g[0]+", "+g[1]+", "+g[2]+", "+g[3]+", "+g[4]+", "+g[5]+", "+g[6]+", "+g[7]+", "+g[8]+", "+g[9]+", "+g[10]+", "+g[11]+", "+g[12]+", "+g[13]+", "+g[14]+", "+g[15]+")"}},{}],223:[function(y,ee,Q){ee.exports=function(g,v,m){var x,e,n,t,a,r,d,s,i,u,f,c,h=m[0],p=m[1],o=m[2];return v===g?(g[12]=v[0]*h+v[4]*p+v[8]*o+v[12],g[13]=v[1]*h+v[5]*p+v[9]*o+v[13],g[14]=v[2]*h+v[6]*p+v[10]*o+v[14],g[15]=v[3]*h+v[7]*p+v[11]*o+v[15]):(e=v[1],n=v[2],t=v[3],a=v[4],r=v[5],d=v[6],s=v[7],i=v[8],u=v[9],f=v[10],c=v[11],g[0]=x=v[0],g[1]=e,g[2]=n,g[3]=t,g[4]=a,g[5]=r,g[6]=d,g[7]=s,g[8]=i,g[9]=u,g[10]=f,g[11]=c,g[12]=x*h+a*p+i*o+v[12],g[13]=e*h+r*p+u*o+v[13],g[14]=n*h+d*p+f*o+v[14],g[15]=t*h+s*p+c*o+v[15]),g}},{}],224:[function(y,ee,Q){ee.exports=function(g,v){if(g===v){var m=v[1],x=v[2],e=v[3],n=v[6],t=v[7],a=v[11];g[1]=v[4],g[2]=v[8],g[3]=v[12],g[4]=m,g[6]=v[9],g[7]=v[13],g[8]=x,g[9]=n,g[11]=v[14],g[12]=e,g[13]=t,g[14]=a}else g[0]=v[0],g[1]=v[4],g[2]=v[8],g[3]=v[12],g[4]=v[1],g[5]=v[5],g[6]=v[9],g[7]=v[13],g[8]=v[2],g[9]=v[6],g[10]=v[10],g[11]=v[14],g[12]=v[3],g[13]=v[7],g[14]=v[11],g[15]=v[15];return g}},{}],225:[function(y,ee,Q){"use strict";var g=y("css-font"),v=y("pick-by-alias"),m=y("regl"),x=y("gl-util/context"),e=y("es6-weak-map"),n=y("color-normalize"),t=y("font-atlas"),a=y("typedarray-pool"),r=y("parse-rect"),d=y("is-plain-obj"),s=y("parse-unit"),i=y("to-px"),u=y("detect-kerning"),f=y("object-assign"),c=y("font-measure"),h=y("flatten-vertex-data"),p=y("bit-twiddle").nextPow2,o=new e,b=!1;if(document.body){var l=document.body.appendChild(document.createElement("div"));l.style.font="italic small-caps bold condensed 16px/2 cursive",getComputedStyle(l).fontStretch&&(b=!0),document.body.removeChild(l)}var T=function(_){var w;this.gl="function"==typeof(w=_)&&w._gl&&w.prop&&w.texture&&w.buffer?(_={regl:_}).regl._gl:x(_),this.shader=o.get(this.gl),this.regl=this.shader?this.shader.regl:_.regl||m({gl:this.gl}),this.charBuffer=this.regl.buffer({type:"uint8",usage:"stream"}),this.sizeBuffer=this.regl.buffer({type:"float",usage:"stream"}),this.shader||(this.shader=this.createShader(),o.set(this.gl,this.shader)),this.batch=[],this.fontSize=[],this.font=[],this.fontAtlas=[],this.draw=this.shader.draw.bind(this),this.render=function(){this.regl._refresh(),this.draw(this.batch)},this.canvas=this.gl.canvas,this.update(d(_)?_:{})};T.prototype.createShader=function(){var _=this.regl,w=_({blend:{enable:!0,color:[0,0,0,1],func:{srcRGB:"src alpha",dstRGB:"one minus src alpha",srcAlpha:"one minus dst alpha",dstAlpha:"one"}},stencil:{enable:!1},depth:{enable:!1},count:_.prop("count"),offset:_.prop("offset"),attributes:{charOffset:{offset:4,stride:8,buffer:_.this("sizeBuffer")},width:{offset:0,stride:8,buffer:_.this("sizeBuffer")},char:_.this("charBuffer"),position:_.this("position")},uniforms:{atlasSize:function(k,L){return[L.atlas.width,L.atlas.height]},atlasDim:function(k,L){return[L.atlas.cols,L.atlas.rows]},atlas:function(k,L){return L.atlas.texture},charStep:function(k,L){return L.atlas.step},em:function(k,L){return L.atlas.em},color:_.prop("color"),opacity:_.prop("opacity"),viewport:_.this("viewportArray"),scale:_.this("scale"),align:_.prop("align"),baseline:_.prop("baseline"),translate:_.this("translate"),positionOffset:_.prop("positionOffset")},primitive:"points",viewport:_.this("viewport"),vert:"\n\t\t\tprecision highp float;\n\t\t\tattribute float width, charOffset, char;\n\t\t\tattribute vec2 position;\n\t\t\tuniform float fontSize, charStep, em, align, baseline;\n\t\t\tuniform vec4 viewport;\n\t\t\tuniform vec4 color;\n\t\t\tuniform vec2 atlasSize, atlasDim, scale, translate, positionOffset;\n\t\t\tvarying vec2 charCoord, charId;\n\t\t\tvarying float charWidth;\n\t\t\tvarying vec4 fontColor;\n\t\t\tvoid main () {\n\t\t\t\tvec2 offset = floor(em * (vec2(align + charOffset, baseline)\n\t\t\t\t\t+ vec2(positionOffset.x, -positionOffset.y)))\n\t\t\t\t\t/ (viewport.zw * scale.xy);\n\n\t\t\t\tvec2 position = (position + translate) * scale;\n\t\t\t\tposition += offset * scale;\n\n\t\t\t\tcharCoord = position * viewport.zw + viewport.xy;\n\n\t\t\t\tgl_Position = vec4(position * 2. - 1., 0, 1);\n\n\t\t\t\tgl_PointSize = charStep;\n\n\t\t\t\tcharId.x = mod(char, atlasDim.x);\n\t\t\t\tcharId.y = floor(char / atlasDim.x);\n\n\t\t\t\tcharWidth = width * em;\n\n\t\t\t\tfontColor = color / 255.;\n\t\t\t}",frag:"\n\t\t\tprecision highp float;\n\t\t\tuniform float fontSize, charStep, opacity;\n\t\t\tuniform vec2 atlasSize;\n\t\t\tuniform vec4 viewport;\n\t\t\tuniform sampler2D atlas;\n\t\t\tvarying vec4 fontColor;\n\t\t\tvarying vec2 charCoord, charId;\n\t\t\tvarying float charWidth;\n\n\t\t\tfloat lightness(vec4 color) {\n\t\t\t\treturn color.r * 0.299 + color.g * 0.587 + color.b * 0.114;\n\t\t\t}\n\n\t\t\tvoid main () {\n\t\t\t\tvec2 uv = gl_FragCoord.xy - charCoord + charStep * .5;\n\t\t\t\tfloat halfCharStep = floor(charStep * .5 + .5);\n\n\t\t\t\t// invert y and shift by 1px (FF expecially needs that)\n\t\t\t\tuv.y = charStep - uv.y;\n\n\t\t\t\t// ignore points outside of character bounding box\n\t\t\t\tfloat halfCharWidth = ceil(charWidth * .5);\n\t\t\t\tif (floor(uv.x) > halfCharStep + halfCharWidth ||\n\t\t\t\t\tfloor(uv.x) < halfCharStep - halfCharWidth) return;\n\n\t\t\t\tuv += charId * charStep;\n\t\t\t\tuv = uv / atlasSize;\n\n\t\t\t\tvec4 color = fontColor;\n\t\t\t\tvec4 mask = texture2D(atlas, uv);\n\n\t\t\t\tfloat maskY = lightness(mask);\n\t\t\t\t// float colorY = lightness(color);\n\t\t\t\tcolor.a *= maskY;\n\t\t\t\tcolor.a *= opacity;\n\n\t\t\t\t// color.a += .1;\n\n\t\t\t\t// antialiasing, see yiq color space y-channel formula\n\t\t\t\t// color.rgb += (1. - color.rgb) * (1. - mask.rgb);\n\n\t\t\t\tgl_FragColor = color;\n\t\t\t}"});return{regl:_,draw:w,atlas:{}}},T.prototype.update=function(_){var w=this;if("string"==typeof _)_={text:_};else if(!_)return;null!=(_=v(_,{position:"position positions coord coords coordinates",font:"font fontFace fontface typeface cssFont css-font family fontFamily",fontSize:"fontSize fontsize size font-size",text:"text texts chars characters value values symbols",align:"align alignment textAlign textbaseline",baseline:"baseline textBaseline textbaseline",direction:"dir direction textDirection",color:"color colour fill fill-color fillColor textColor textcolor",kerning:"kerning kern",range:"range dataBox",viewport:"vp viewport viewBox viewbox viewPort",opacity:"opacity alpha transparency visible visibility opaque",offset:"offset positionOffset padding shift indent indentation"},!0)).opacity&&(this.opacity=Array.isArray(_.opacity)?_.opacity.map(function(ve){return parseFloat(ve)}):parseFloat(_.opacity)),null!=_.viewport&&(this.viewport=r(_.viewport),this.viewportArray=[this.viewport.x,this.viewport.y,this.viewport.width,this.viewport.height]),null==this.viewport&&(this.viewport={x:0,y:0,width:this.gl.drawingBufferWidth,height:this.gl.drawingBufferHeight},this.viewportArray=[this.viewport.x,this.viewport.y,this.viewport.width,this.viewport.height]),null!=_.kerning&&(this.kerning=_.kerning),null!=_.offset&&("number"==typeof _.offset&&(_.offset=[_.offset,0]),this.positionOffset=h(_.offset)),_.direction&&(this.direction=_.direction),_.range&&(this.range=_.range,this.scale=[1/(_.range[2]-_.range[0]),1/(_.range[3]-_.range[1])],this.translate=[-_.range[0],-_.range[1]]),_.scale&&(this.scale=_.scale),_.translate&&(this.translate=_.translate),this.scale||(this.scale=[1/this.viewport.width,1/this.viewport.height]),this.translate||(this.translate=[0,0]),this.font.length||_.font||(_.font=T.baseFontSize+"px sans-serif");var k,L=!1,M=!1;if(_.font&&(Array.isArray(_.font)?_.font:[_.font]).forEach(function(ve,Ae){if("string"==typeof ve)try{ve=g.parse(ve)}catch{ve=g.parse(T.baseFontSize+"px "+ve)}else ve=g.parse(g.stringify(ve));var ke=g.stringify({size:T.baseFontSize,family:ve.family,stretch:b?ve.stretch:void 0,variant:ve.variant,weight:ve.weight,style:ve.style}),Pe=s(ve.size),Ne=Math.round(Pe[0]*i(Pe[1]));if(Ne!==w.fontSize[Ae]&&(M=!0,w.fontSize[Ae]=Ne),!(w.font[Ae]&&ke==w.font[Ae].baseString||(L=!0,w.font[Ae]=T.fonts[ke],w.font[Ae]))){var De=ve.family.join(", "),ze=[ve.style];ve.style!=ve.variant&&ze.push(ve.variant),ve.variant!=ve.weight&&ze.push(ve.weight),b&&ve.weight!=ve.stretch&&ze.push(ve.stretch),w.font[Ae]={baseString:ke,family:De,weight:ve.weight,stretch:ve.stretch,style:ve.style,variant:ve.variant,width:{},kerning:{},metrics:c(De,{origin:"top",fontSize:T.baseFontSize,fontStyle:ze.join(" ")})},T.fonts[ke]=w.font[Ae]}}),(L||M)&&this.font.forEach(function(ve,Ae){var ke=g.stringify({size:w.fontSize[Ae],family:ve.family,stretch:b?ve.stretch:void 0,variant:ve.variant,weight:ve.weight,style:ve.style});w.fontAtlas[Ae]=w.shader.atlas[ke],w.fontAtlas[Ae]||(w.shader.atlas[ke]=w.fontAtlas[Ae]={fontString:ke,step:2*Math.ceil(w.fontSize[Ae]*ve.metrics.bottom*.5),em:w.fontSize[Ae],cols:0,rows:0,height:0,width:0,chars:[],ids:{},texture:w.regl.texture()}),null==_.text&&(_.text=w.text)}),"string"==typeof _.text&&_.position&&_.position.length>2){for(var I=Array(.5*_.position.length),P=0;P<I.length;P++)I[P]=_.text;_.text=I}if(null!=_.text||L){if(this.textOffsets=[0],Array.isArray(_.text)){this.count=_.text[0].length,this.counts=[this.count];for(var S=1;S<_.text.length;S++)this.textOffsets[S]=this.textOffsets[S-1]+_.text[S-1].length,this.count+=_.text[S].length,this.counts.push(_.text[S].length);this.text=_.text.join("")}else this.text=_.text,this.count=this.text.length,this.counts=[this.count];k=[],this.font.forEach(function(ve,Ae){T.atlasContext.font=ve.baseString;for(var ke=w.fontAtlas[Ae],Pe=0;Pe<w.text.length;Pe++){var Ne=w.text.charAt(Pe);if(null==ke.ids[Ne]&&(ke.ids[Ne]=ke.chars.length,ke.chars.push(Ne),k.push(Ne)),null==ve.width[Ne]&&(ve.width[Ne]=T.atlasContext.measureText(Ne).width/T.baseFontSize,w.kerning)){var De=[];for(var ze in ve.width)De.push(ze+Ne,Ne+ze);f(ve.kerning,u(ve.family,{pairs:De}))}}})}if(_.position)if(_.position.length>2){for(var E=!_.position[0].length,z=a.mallocFloat(2*this.count),R=0,q=0;R<this.counts.length;R++){var V=this.counts[R];if(E)for(var W=0;W<V;W++)z[q++]=_.position[2*R],z[q++]=_.position[2*R+1];else for(var K=0;K<V;K++)z[q++]=_.position[R][0],z[q++]=_.position[R][1]}this.position.call?this.position({type:"float",data:z}):this.position=this.regl.buffer({type:"float",data:z}),a.freeFloat(z)}else this.position.destroy&&this.position.destroy(),this.position={constant:_.position};if(_.text||L){var G=a.mallocUint8(this.count),Y=a.mallocFloat(2*this.count);this.textWidth=[];for(var $=0,B=0;$<this.counts.length;$++){for(var N=this.counts[$],U=this.font[$]||this.font[0],te=this.fontAtlas[$]||this.fontAtlas[0],j=0;j<N;j++){var J=this.text.charAt(B),X=this.text.charAt(B-1);if(G[B]=te.ids[J],Y[2*B]=U.width[J],j){var le=Y[2*B-1]+.5*Y[2*B-2]+.5*Y[2*B];if(this.kerning){var oe=U.kerning[X+J];oe&&(le+=.001*oe)}Y[2*B+1]=le}else Y[2*B+1]=.5*Y[2*B];B++}this.textWidth.push(Y.length?.5*Y[2*B-2]+Y[2*B-1]:0)}_.align||(_.align=this.align),this.charBuffer({data:G,type:"uint8",usage:"stream"}),this.sizeBuffer({data:Y,type:"float",usage:"stream"}),a.freeUint8(G),a.freeFloat(Y),k.length&&this.font.forEach(function(ve,Ae){var ke=w.fontAtlas[Ae],Pe=ke.step,Ne=Math.floor(T.maxAtlasSize/Pe),De=Math.min(Ne,ke.chars.length),ze=Math.ceil(ke.chars.length/De),Me=p(De*Pe),Se=p(ze*Pe);ke.width=Me,ke.height=Se,ke.rows=ze,ke.cols=De,ke.em&&ke.texture({data:t({canvas:T.atlasCanvas,font:ke.fontString,chars:ke.chars,shape:[Me,Se],step:[Pe,Pe]})})})}if(_.align&&(this.align=_.align,this.alignOffset=this.textWidth.map(function(ve,Ae){var ke=Array.isArray(w.align)?w.align.length>1?w.align[Ae]:w.align[0]:w.align;if("number"==typeof ke)return ke;switch(ke){case"right":case"end":return-ve;case"center":case"centre":case"middle":return.5*-ve}return 0})),null==this.baseline&&null==_.baseline&&(_.baseline=0),null!=_.baseline&&(this.baseline=_.baseline,Array.isArray(this.baseline)||(this.baseline=[this.baseline]),this.baselineOffset=this.baseline.map(function(ve,Ae){var ke=(w.font[Ae]||w.font[0]).metrics,Pe=0;return-1*((Pe+=.5*ke.bottom)+("number"==typeof ve?ve-ke.baseline:-ke[ve]))})),null!=_.color)if(_.color||(_.color="transparent"),"string"!=typeof _.color&&isNaN(_.color)){var de;if("number"==typeof _.color[0]&&_.color.length>this.counts.length){var se=_.color.length;de=a.mallocUint8(se);for(var ge=(_.color.subarray||_.color.slice).bind(_.color),_e=0;_e<se;_e+=4)de.set(n(ge(_e,_e+4),"uint8"),_e)}else{var Te=_.color.length;de=a.mallocUint8(4*Te);for(var we=0;we<Te;we++)de.set(n(_.color[we]||0,"uint8"),4*we)}this.color=de}else this.color=n(_.color,"uint8");if(_.position||_.text||_.color||_.baseline||_.align||_.font||_.offset||_.opacity)if(this.color.length>4||this.baselineOffset.length>1||this.align&&this.align.length>1||this.fontAtlas.length>1||this.positionOffset.length>2){var Oe=Math.max(.5*this.position.length||0,.25*this.color.length||0,this.baselineOffset.length||0,this.alignOffset.length||0,this.font.length||0,this.opacity.length||0,.5*this.positionOffset.length||0);this.batch=Array(Oe);for(var fe=0;fe<this.batch.length;fe++)this.batch[fe]={count:this.counts.length>1?this.counts[fe]:this.counts[0],offset:this.textOffsets.length>1?this.textOffsets[fe]:this.textOffsets[0],color:this.color?this.color.length<=4?this.color:this.color.subarray(4*fe,4*fe+4):[0,0,0,255],opacity:Array.isArray(this.opacity)?this.opacity[fe]:this.opacity,baseline:null!=this.baselineOffset[fe]?this.baselineOffset[fe]:this.baselineOffset[0],align:this.align?null!=this.alignOffset[fe]?this.alignOffset[fe]:this.alignOffset[0]:0,atlas:this.fontAtlas[fe]||this.fontAtlas[0],positionOffset:this.positionOffset.length>2?this.positionOffset.subarray(2*fe,2*fe+2):this.positionOffset}}else this.batch=this.count?[{count:this.count,offset:0,color:this.color||[0,0,0,255],opacity:Array.isArray(this.opacity)?this.opacity[0]:this.opacity,baseline:this.baselineOffset[0],align:this.alignOffset?this.alignOffset[0]:0,atlas:this.fontAtlas[0],positionOffset:this.positionOffset}]:[]},T.prototype.destroy=function(){},T.prototype.kerning=!0,T.prototype.position={constant:new Float32Array(2)},T.prototype.translate=null,T.prototype.scale=null,T.prototype.font=null,T.prototype.text="",T.prototype.positionOffset=[0,0],T.prototype.opacity=1,T.prototype.color=new Uint8Array([0,0,0,255]),T.prototype.alignOffset=[0,0],T.maxAtlasSize=1024,T.atlasCanvas=document.createElement("canvas"),T.atlasContext=T.atlasCanvas.getContext("2d",{alpha:!1}),T.baseFontSize=64,T.fonts={},ee.exports=T},{"bit-twiddle":81,"color-normalize":89,"css-font":99,"detect-kerning":125,"es6-weak-map":183,"flatten-vertex-data":191,"font-atlas":192,"font-measure":193,"gl-util/context":226,"is-plain-obj":236,"object-assign":247,"parse-rect":249,"parse-unit":251,"pick-by-alias":253,regl:284,"to-px":315,"typedarray-pool":328}],226:[function(y,ee,Q){(function(g){(function(){"use strict";var v=y("pick-by-alias");function m(n){if(n.container)if(n.container==document.body)document.body.style.width||(n.canvas.width=n.width||n.pixelRatio*g.innerWidth),document.body.style.height||(n.canvas.height=n.height||n.pixelRatio*g.innerHeight);else{var t=n.container.getBoundingClientRect();n.canvas.width=n.width||t.right-t.left,n.canvas.height=n.height||t.bottom-t.top}}function x(n){return"function"==typeof n.getContext&&"width"in n&&"height"in n}function e(){var n=document.createElement("canvas");return n.style.position="absolute",n.style.top=0,n.style.left=0,n}ee.exports=function(n){var t,r;if(n?"string"==typeof n&&(n={container:n}):n={},(n=x(n)||"string"==typeof(t=n).nodeName&&"function"==typeof t.appendChild&&"function"==typeof t.getBoundingClientRect?{container:n}:"function"==typeof(r=n).drawArrays||"function"==typeof r.drawElements?{gl:n}:v(n,{container:"container target element el canvas holder parent parentNode wrapper use ref root node",gl:"gl context webgl glContext",attrs:"attributes attrs contextAttributes",pixelRatio:"pixelRatio pxRatio px ratio pxratio pixelratio",width:"w width",height:"h height"},!0)).pixelRatio||(n.pixelRatio=g.pixelRatio||1),n.gl)return n.gl;if(n.canvas&&(n.container=n.canvas.parentNode),n.container){if("string"==typeof n.container){var a=document.querySelector(n.container);if(!a)throw Error("Element "+n.container+" is not found");n.container=a}x(n.container)?(n.canvas=n.container,n.container=n.canvas.parentNode):n.canvas||(n.canvas=e(),n.container.appendChild(n.canvas),m(n))}else if(!n.canvas){if(typeof document>"u")throw Error("Not DOM environment. Use headless-gl.");n.container=document.body||document.documentElement,n.canvas=e(),n.container.appendChild(n.canvas),m(n)}return n.gl||["webgl","experimental-webgl","webgl-experimental"].some(function(r){try{n.gl=n.canvas.getContext(r,n.attrs)}catch{}return n.gl}),n.gl}}).call(this)}).call(this,typeof global<"u"?global:typeof self<"u"?self:typeof window<"u"?window:{})},{"pick-by-alias":253}],227:[function(y,ee,Q){ee.exports=function(g){"string"==typeof g&&(g=[g]);for(var v=[].slice.call(arguments,1),m=[],x=0;x<g.length-1;x++)m.push(g[x],v[x]||"");return m.push(g[x]),m.join("")}},{}],228:[function(y,ee,Q){(function(g){(function(){"use strict";var v,m=y("is-browser");v="function"==typeof g.matchMedia?!g.matchMedia("(hover: none)").matches:m,ee.exports=v}).call(this)}).call(this,typeof global<"u"?global:typeof self<"u"?self:typeof window<"u"?window:{})},{"is-browser":232}],229:[function(y,ee,Q){"use strict";var g=y("is-browser");ee.exports=g&&function(){var v=!1;try{var m=Object.defineProperty({},"passive",{get:function(){v=!0}});window.addEventListener("test",null,m),window.removeEventListener("test",null,m)}catch{v=!1}return v}()},{"is-browser":232}],230:[function(y,ee,Q){Q.read=function(g,v,m,x,e){var n,t,a=8*e-x-1,r=(1<<a)-1,d=r>>1,s=-7,i=m?e-1:0,u=m?-1:1,f=g[v+i];for(i+=u,n=f&(1<<-s)-1,f>>=-s,s+=a;s>0;n=256*n+g[v+i],i+=u,s-=8);for(t=n&(1<<-s)-1,n>>=-s,s+=x;s>0;t=256*t+g[v+i],i+=u,s-=8);if(0===n)n=1-d;else{if(n===r)return t?NaN:1/0*(f?-1:1);t+=Math.pow(2,x),n-=d}return(f?-1:1)*t*Math.pow(2,n-x)},Q.write=function(g,v,m,x,e,n){var t,a,r,d=8*n-e-1,s=(1<<d)-1,i=s>>1,u=23===e?Math.pow(2,-24)-Math.pow(2,-77):0,f=x?0:n-1,c=x?1:-1,h=v<0||0===v&&1/v<0?1:0;for(v=Math.abs(v),isNaN(v)||v===1/0?(a=isNaN(v)?1:0,t=s):(t=Math.floor(Math.log(v)/Math.LN2),v*(r=Math.pow(2,-t))<1&&(t--,r*=2),(v+=t+i>=1?u/r:u*Math.pow(2,1-i))*r>=2&&(t++,r/=2),t+i>=s?(a=0,t=s):t+i>=1?(a=(v*r-1)*Math.pow(2,e),t+=i):(a=v*Math.pow(2,i-1)*Math.pow(2,e),t=0));e>=8;g[m+f]=255&a,f+=c,a/=256,e-=8);for(t=t<<e|a,d+=e;d>0;g[m+f]=255&t,f+=c,t/=256,d-=8);g[m+f-c]|=128*h}},{}],231:[function(y,ee,Q){ee.exports="function"==typeof Object.create?function(g,v){v&&(g.super_=v,g.prototype=Object.create(v.prototype,{constructor:{value:g,enumerable:!1,writable:!0,configurable:!0}}))}:function(g,v){if(v){g.super_=v;var m=function(){};m.prototype=v.prototype,g.prototype=new m,g.prototype.constructor=g}}},{}],232:[function(y,ee,Q){ee.exports=!0},{}],233:[function(y,ee,Q){"use strict";ee.exports=typeof navigator<"u"&&(/MSIE/.test(navigator.userAgent)||/Trident\//.test(navigator.appVersion))},{}],234:[function(y,ee,Q){"use strict";ee.exports=m,ee.exports.isMobile=m,ee.exports.default=m;var g=/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series[46]0|symbian|treo|up\.(browser|link)|vodafone|wap|windows (ce|phone)|xda|xiino/i,v=/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series[46]0|symbian|treo|up\.(browser|link)|vodafone|wap|windows (ce|phone)|xda|xiino|android|ipad|playbook|silk/i;function m(x){x||(x={});var e=x.ua;if(e||typeof navigator>"u"||(e=navigator.userAgent),e&&e.headers&&"string"==typeof e.headers["user-agent"]&&(e=e.headers["user-agent"]),"string"!=typeof e)return!1;var n=x.tablet?v.test(e):g.test(e);return!n&&x.tablet&&x.featureDetect&&navigator&&navigator.maxTouchPoints>1&&-1!==e.indexOf("Macintosh")&&-1!==e.indexOf("Safari")&&(n=!0),n}},{}],235:[function(y,ee,Q){"use strict";ee.exports=function(g){var v=typeof g;return null!==g&&("object"===v||"function"===v)}},{}],236:[function(y,ee,Q){"use strict";var g=Object.prototype.toString;ee.exports=function(v){var m;return"[object Object]"===g.call(v)&&(null===(m=Object.getPrototypeOf(v))||m===Object.getPrototypeOf({}))}},{}],237:[function(y,ee,Q){"use strict";ee.exports=function(g){for(var v,m=g.length,x=0;x<m;x++)if(((v=g.charCodeAt(x))<9||v>13)&&32!==v&&133!==v&&160!==v&&5760!==v&&6158!==v&&(v<8192||v>8205)&&8232!==v&&8233!==v&&8239!==v&&8287!==v&&8288!==v&&12288!==v&&65279!==v)return!1;return!0}},{}],238:[function(y,ee,Q){"use strict";ee.exports=function(g){return"string"==typeof g&&(g=g.trim(),!!(/^[mzlhvcsqta]\s*[-+.0-9][^mlhvzcsqta]+/i.test(g)&&/[\dz]$/i.test(g)&&g.length>4))}},{}],239:[function(y,ee,Q){var g,v;g=this,v=function(){"use strict";var g,v,m;function x(e,n){if(g)if(v){var t="var sharedChunk = {}; ("+g+")(sharedChunk); ("+v+")(sharedChunk);",a={};g(a),(m=n(a)).workerUrl=window.URL.createObjectURL(new Blob([t],{type:"text/javascript"}))}else v=n;else g=n}return x(0,function(e){function n(A,O){return A(O={exports:{}},O.exports),O.exports}var t=a;function a(A,O,Z,ie){this.cx=3*A,this.bx=3*(Z-A)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*O,this.by=3*(ie-O)-this.cy,this.ay=1-this.cy-this.by,this.p1x=A,this.p1y=ie,this.p2x=Z,this.p2y=ie}a.prototype.sampleCurveX=function(A){return((this.ax*A+this.bx)*A+this.cx)*A},a.prototype.sampleCurveY=function(A){return((this.ay*A+this.by)*A+this.cy)*A},a.prototype.sampleCurveDerivativeX=function(A){return(3*this.ax*A+2*this.bx)*A+this.cx},a.prototype.solveCurveX=function(A,O){var Z,ie,pe,xe,Ce;for(void 0===O&&(O=1e-6),pe=A,Ce=0;Ce<8;Ce++){if(xe=this.sampleCurveX(pe)-A,Math.abs(xe)<O)return pe;var je=this.sampleCurveDerivativeX(pe);if(Math.abs(je)<1e-6)break;pe-=xe/je}if((pe=A)<(Z=0))return Z;if(pe>(ie=1))return ie;for(;Z<ie;){if(xe=this.sampleCurveX(pe),Math.abs(xe-A)<O)return pe;A>xe?Z=pe:ie=pe,pe=.5*(ie-Z)+Z}return pe},a.prototype.solve=function(A,O){return this.sampleCurveY(this.solveCurveX(A,O))};var r=d;function d(A,O){this.x=A,this.y=O}function s(A,O,Z,ie){var pe=new t(A,O,Z,ie);return function(xe){return pe.solve(xe)}}d.prototype={clone:function(){return new d(this.x,this.y)},add:function(A){return this.clone()._add(A)},sub:function(A){return this.clone()._sub(A)},multByPoint:function(A){return this.clone()._multByPoint(A)},divByPoint:function(A){return this.clone()._divByPoint(A)},mult:function(A){return this.clone()._mult(A)},div:function(A){return this.clone()._div(A)},rotate:function(A){return this.clone()._rotate(A)},rotateAround:function(A,O){return this.clone()._rotateAround(A,O)},matMult:function(A){return this.clone()._matMult(A)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(A){return this.x===A.x&&this.y===A.y},dist:function(A){return Math.sqrt(this.distSqr(A))},distSqr:function(A){var O=A.x-this.x,Z=A.y-this.y;return O*O+Z*Z},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(A){return Math.atan2(this.y-A.y,this.x-A.x)},angleWith:function(A){return this.angleWithSep(A.x,A.y)},angleWithSep:function(A,O){return Math.atan2(this.x*O-this.y*A,this.x*A+this.y*O)},_matMult:function(A){var Z=A[2]*this.x+A[3]*this.y;return this.x=A[0]*this.x+A[1]*this.y,this.y=Z,this},_add:function(A){return this.x+=A.x,this.y+=A.y,this},_sub:function(A){return this.x-=A.x,this.y-=A.y,this},_mult:function(A){return this.x*=A,this.y*=A,this},_div:function(A){return this.x/=A,this.y/=A,this},_multByPoint:function(A){return this.x*=A.x,this.y*=A.y,this},_divByPoint:function(A){return this.x/=A.x,this.y/=A.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var A=this.y;return this.y=this.x,this.x=-A,this},_rotate:function(A){var O=Math.cos(A),Z=Math.sin(A),pe=Z*this.x+O*this.y;return this.x=O*this.x-Z*this.y,this.y=pe,this},_rotateAround:function(A,O){var Z=Math.cos(A),ie=Math.sin(A),xe=O.y+ie*(this.x-O.x)+Z*(this.y-O.y);return this.x=O.x+Z*(this.x-O.x)-ie*(this.y-O.y),this.y=xe,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},d.convert=function(A){return A instanceof d?A:Array.isArray(A)?new d(A[0],A[1]):A};var i=s(.25,.1,.25,1);function u(A,O,Z){return Math.min(Z,Math.max(O,A))}function f(A,O,Z){var ie=Z-O,pe=((A-O)%ie+ie)%ie+O;return pe===O?Z:pe}function c(A){for(var O=[],Z=arguments.length-1;Z-- >0;)O[Z]=arguments[Z+1];for(var ie=0,pe=O;ie<pe.length;ie+=1){var xe=pe[ie];for(var Ce in xe)A[Ce]=xe[Ce]}return A}var h=1;function p(){return h++}function o(){return function A(O){return O?(O^16*Math.random()>>O/4).toString(16):([1e7]+-[1e3]+-4e3+-8e3+-1e11).replace(/[018]/g,A)}()}function b(A){return!!A&&/^[0-9a-f]{8}-[0-9a-f]{4}-[4][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(A)}function l(A,O){A.forEach(function(Z){O[Z]&&(O[Z]=O[Z].bind(O))})}function T(A,O){return-1!==A.indexOf(O,A.length-O.length)}function _(A,O,Z){var ie={};for(var pe in A)ie[pe]=O.call(Z||this,A[pe],pe,A);return ie}function w(A,O,Z){var ie={};for(var pe in A)O.call(Z||this,A[pe],pe,A)&&(ie[pe]=A[pe]);return ie}function k(A){return Array.isArray(A)?A.map(k):"object"==typeof A&&A?_(A,k):A}var L={};function M(A){L[A]||(typeof console<"u"&&console.warn(A),L[A]=!0)}function I(A,O,Z){return(Z.y-A.y)*(O.x-A.x)>(O.y-A.y)*(Z.x-A.x)}function P(A){for(var O=0,Z=0,ie=A.length,pe=ie-1,xe=void 0,Ce=void 0;Z<ie;pe=Z++)O+=((Ce=A[pe]).x-(xe=A[Z]).x)*(xe.y+Ce.y);return O}function S(){return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope}function E(A){var O={};if(A.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,function(ie,pe,xe,Ce){var je=xe||Ce;return O[pe]=!je||je.toLowerCase(),""}),O["max-age"]){var Z=parseInt(O["max-age"],10);isNaN(Z)?delete O["max-age"]:O["max-age"]=Z}return O}var z=null;function R(A){if(null==z){var O=A.navigator?A.navigator.userAgent:null;z=!!A.safari||!(!O||!(/\b(iPad|iPhone|iPod)\b/.test(O)||O.match("Safari")&&!O.match("Chrome")))}return z}function q(A){try{var O=self[A];return O.setItem("_mapbox_test_",1),O.removeItem("_mapbox_test_"),!0}catch{return!1}}var V,W,K,G,Y=self.performance&&self.performance.now?self.performance.now.bind(self.performance):Date.now.bind(Date),$=self.requestAnimationFrame||self.mozRequestAnimationFrame||self.webkitRequestAnimationFrame||self.msRequestAnimationFrame,B=self.cancelAnimationFrame||self.mozCancelAnimationFrame||self.webkitCancelAnimationFrame||self.msCancelAnimationFrame,N={now:Y,frame:function(A){var O=$(A);return{cancel:function(){return B(O)}}},getImageData:function(A,O){void 0===O&&(O=0);var Z=self.document.createElement("canvas"),ie=Z.getContext("2d");if(!ie)throw new Error("failed to create canvas 2d context");return Z.width=A.width,Z.height=A.height,ie.drawImage(A,0,0,A.width,A.height),ie.getImageData(-O,-O,A.width+2*O,A.height+2*O)},resolveURL:function(A){return V||(V=self.document.createElement("a")),V.href=A,V.href},hardwareConcurrency:self.navigator.hardwareConcurrency||4,get devicePixelRatio(){return self.devicePixelRatio},get prefersReducedMotion(){return!!self.matchMedia&&(null==W&&(W=self.matchMedia("(prefers-reduced-motion: reduce)")),W.matches)}},U={API_URL:"https://api.mapbox.com",get EVENTS_URL(){return this.API_URL?0===this.API_URL.indexOf("https://api.mapbox.cn")?"https://events.mapbox.cn/events/v2":0===this.API_URL.indexOf("https://api.mapbox.com")?"https://events.mapbox.com/events/v2":null:null},FEEDBACK_URL:"https://apps.mapbox.com/feedback",REQUIRE_ACCESS_TOKEN:!0,ACCESS_TOKEN:null,MAX_PARALLEL_IMAGE_REQUESTS:16},te={supported:!1,testSupport:function(A){j||!G||(J?X(A):K=A)}},j=!1,J=!1;function X(A){var O=A.createTexture();A.bindTexture(A.TEXTURE_2D,O);try{if(A.texImage2D(A.TEXTURE_2D,0,A.RGBA,A.RGBA,A.UNSIGNED_BYTE,G),A.isContextLost())return;te.supported=!0}catch{}A.deleteTexture(O),j=!0}self.document&&((G=self.document.createElement("img")).onload=function(){K&&X(K),K=null,J=!0},G.onerror=function(){j=!0,K=null},G.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA=");var re="01",ne=function(A,O){this._transformRequestFn=A,this._customAccessToken=O,this._createSkuToken()};function le(A){return 0===A.indexOf("mapbox:")}ne.prototype._createSkuToken=function(){var A=function(){for(var O="",Z=0;Z<10;Z++)O+="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"[Math.floor(62*Math.random())];return{token:["1",re,O].join(""),tokenExpiresAt:Date.now()+432e5}}();this._skuToken=A.token,this._skuTokenExpiresAt=A.tokenExpiresAt},ne.prototype._isSkuTokenExpired=function(){return Date.now()>this._skuTokenExpiresAt},ne.prototype.transformRequest=function(A,O){return this._transformRequestFn&&this._transformRequestFn(A,O)||{url:A}},ne.prototype.normalizeStyleURL=function(A,O){if(!le(A))return A;var Z=ge(A);return Z.path="/styles/v1"+Z.path,this._makeAPIURL(Z,this._customAccessToken||O)},ne.prototype.normalizeGlyphsURL=function(A,O){if(!le(A))return A;var Z=ge(A);return Z.path="/fonts/v1"+Z.path,this._makeAPIURL(Z,this._customAccessToken||O)},ne.prototype.normalizeSourceURL=function(A,O){if(!le(A))return A;var Z=ge(A);return Z.path="/v4/"+Z.authority+".json",Z.params.push("secure"),this._makeAPIURL(Z,this._customAccessToken||O)},ne.prototype.normalizeSpriteURL=function(A,O,Z,ie){var pe=ge(A);return le(A)?(pe.path="/styles/v1"+pe.path+"/sprite"+O+Z,this._makeAPIURL(pe,this._customAccessToken||ie)):(pe.path+=""+O+Z,_e(pe))},ne.prototype.normalizeTileURL=function(A,O){if(this._isSkuTokenExpired()&&this._createSkuToken(),A&&!le(A))return A;var Z=ge(A);Z.path=Z.path.replace(/(\.(png|jpg)\d*)(?=$)/,(N.devicePixelRatio>=2||512===O?"@2x":"")+(te.supported?".webp":"$1")),Z.path=Z.path.replace(/^.+\/v4\//,"/"),Z.path="/v4"+Z.path;var xe=this._customAccessToken||function(Ce){for(var je=0,$e=Ce;je<$e.length;je+=1){var ut=$e[je].match(/^access_token=(.*)$/);if(ut)return ut[1]}return null}(Z.params)||U.ACCESS_TOKEN;return U.REQUIRE_ACCESS_TOKEN&&xe&&this._skuToken&&Z.params.push("sku="+this._skuToken),this._makeAPIURL(Z,xe)},ne.prototype.canonicalizeTileURL=function(A,O){var Z=ge(A);if(!Z.path.match(/(^\/v4\/)/)||!Z.path.match(/\.[\w]+$/))return A;var ie="mapbox://tiles/";ie+=Z.path.replace("/v4/","");var pe=Z.params;return O&&(pe=pe.filter(function(xe){return!xe.match(/^access_token=/)})),pe.length&&(ie+="?"+pe.join("&")),ie},ne.prototype.canonicalizeTileset=function(A,O){for(var Z=!!O&&le(O),ie=[],pe=0,xe=A.tiles||[];pe<xe.length;pe+=1){var Ce=xe[pe];de(Ce)?ie.push(this.canonicalizeTileURL(Ce,Z)):ie.push(Ce)}return ie},ne.prototype._makeAPIURL=function(A,O){var Z="See https://www.mapbox.com/api-documentation/#access-tokens-and-token-scopes",ie=ge(U.API_URL);if(A.protocol=ie.protocol,A.authority=ie.authority,"/"!==ie.path&&(A.path=""+ie.path+A.path),!U.REQUIRE_ACCESS_TOKEN)return _e(A);if(!(O=O||U.ACCESS_TOKEN))throw new Error("An API access token is required to use Mapbox GL. "+Z);if("s"===O[0])throw new Error("Use a public access token (pk.*) with Mapbox GL, not a secret access token (sk.*). "+Z);return A.params=A.params.filter(function(pe){return-1===pe.indexOf("access_token")}),A.params.push("access_token="+O),_e(A)};var oe=/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/|\?|$)/i;function de(A){return oe.test(A)}var se=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;function ge(A){var O=A.match(se);if(!O)throw new Error("Unable to parse URL object");return{protocol:O[1],authority:O[2],path:O[3]||"/",params:O[4]?O[4].split("&"):[]}}function _e(A){var O=A.params.length?"?"+A.params.join("&"):"";return A.protocol+"://"+A.authority+A.path+O}function Te(A){if(!A)return null;var Z=A.split(".");if(!Z||3!==Z.length)return null;try{return JSON.parse(decodeURIComponent(self.atob(Z[1]).split("").map(function(ie){return"%"+("00"+ie.charCodeAt(0).toString(16)).slice(-2)}).join("")))}catch{return null}}var we=function(A){this.type=A,this.anonId=null,this.eventData={},this.queue=[],this.pendingRequest=null};we.prototype.getStorageKey=function(A){var ie,Z=Te(U.ACCESS_TOKEN);return ie=Z&&Z.u?self.btoa(encodeURIComponent(Z.u).replace(/%([0-9A-F]{2})/g,function(pe,xe){return String.fromCharCode(Number("0x"+xe))})):U.ACCESS_TOKEN||"",A?"mapbox.eventData."+A+":"+ie:"mapbox.eventData:"+ie},we.prototype.fetchEventData=function(){var A=q("localStorage"),O=this.getStorageKey(),Z=this.getStorageKey("uuid");if(A)try{var ie=self.localStorage.getItem(O);ie&&(this.eventData=JSON.parse(ie));var pe=self.localStorage.getItem(Z);pe&&(this.anonId=pe)}catch{M("Unable to read from LocalStorage")}},we.prototype.saveEventData=function(){var A=q("localStorage"),O=this.getStorageKey(),Z=this.getStorageKey("uuid");if(A)try{self.localStorage.setItem(Z,this.anonId),Object.keys(this.eventData).length>=1&&self.localStorage.setItem(O,JSON.stringify(this.eventData))}catch{M("Unable to write to LocalStorage")}},we.prototype.processRequests=function(A){},we.prototype.postEvent=function(A,O,Z,ie){var pe=this;if(U.EVENTS_URL){var xe=ge(U.EVENTS_URL);xe.params.push("access_token="+(ie||U.ACCESS_TOKEN||""));var Ce={event:this.type,created:new Date(A).toISOString(),sdkIdentifier:"mapbox-gl-js",sdkVersion:"1.10.1",skuId:re,userId:this.anonId},je=O?c(Ce,O):Ce,$e={url:_e(xe),headers:{"Content-Type":"text/plain"},body:JSON.stringify([je])};this.pendingRequest=Bt($e,function(ut){pe.pendingRequest=null,Z(ut),pe.saveEventData(),pe.processRequests(ie)})}},we.prototype.queueRequest=function(A,O){this.queue.push(A),this.processRequests(O)};var Oe,fe,ve=function(A){function O(){A.call(this,"map.load"),this.success={},this.skuToken=""}return A&&(O.__proto__=A),(O.prototype=Object.create(A&&A.prototype)).constructor=O,O.prototype.postMapLoadEvent=function(Z,ie,pe,xe){this.skuToken=pe,(U.EVENTS_URL&&xe||U.ACCESS_TOKEN&&Array.isArray(Z)&&Z.some(function(Ce){return le(Ce)||de(Ce)}))&&this.queueRequest({id:ie,timestamp:Date.now()},xe)},O.prototype.processRequests=function(Z){var ie=this;if(!this.pendingRequest&&0!==this.queue.length){var pe=this.queue.shift(),xe=pe.id,Ce=pe.timestamp;xe&&this.success[xe]||(this.anonId||this.fetchEventData(),b(this.anonId)||(this.anonId=o()),this.postEvent(Ce,{skuToken:this.skuToken},function(je){je||xe&&(ie.success[xe]=!0)},Z))}},O}(we),Ae=new(function(A){function O(Z){A.call(this,"appUserTurnstile"),this._customAccessToken=Z}return A&&(O.__proto__=A),(O.prototype=Object.create(A&&A.prototype)).constructor=O,O.prototype.postTurnstileEvent=function(Z,ie){U.EVENTS_URL&&U.ACCESS_TOKEN&&Array.isArray(Z)&&Z.some(function(pe){return le(pe)||de(pe)})&&this.queueRequest(Date.now(),ie)},O.prototype.processRequests=function(Z){var ie=this;if(!this.pendingRequest&&0!==this.queue.length){this.anonId&&this.eventData.lastSuccess&&this.eventData.tokenU||this.fetchEventData();var pe=Te(U.ACCESS_TOKEN),xe=pe?pe.u:U.ACCESS_TOKEN,Ce=xe!==this.eventData.tokenU;b(this.anonId)||(this.anonId=o(),Ce=!0);var je=this.queue.shift();if(this.eventData.lastSuccess){var $e=new Date(this.eventData.lastSuccess),ut=new Date(je),vt=(je-this.eventData.lastSuccess)/864e5;Ce=Ce||vt>=1||vt<-1||$e.getDate()!==ut.getDate()}else Ce=!0;if(!Ce)return this.processRequests();this.postEvent(je,{"enabled.telemetry":!1},function(zt){zt||(ie.eventData.lastSuccess=je,ie.eventData.tokenU=xe)},Z)}},O}(we)),ke=Ae.postTurnstileEvent.bind(Ae),Pe=new ve,Ne=Pe.postMapLoadEvent.bind(Pe),De=500,ze=50;function Me(){self.caches&&!Oe&&(Oe=self.caches.open("mapbox-tiles"))}function Ie(A){var O=A.indexOf("?");return O<0?A:A.slice(0,O)}var Re,Xe=1/0;function nt(){return null==Re&&(Re=self.OffscreenCanvas&&new self.OffscreenCanvas(1,1).getContext("2d")&&"function"==typeof self.createImageBitmap),Re}var ct={Unknown:"Unknown",Style:"Style",Source:"Source",Tile:"Tile",Glyphs:"Glyphs",SpriteImage:"SpriteImage",SpriteJSON:"SpriteJSON",Image:"Image"};"function"==typeof Object.freeze&&Object.freeze(ct);var xt=function(A){function O(Z,ie,pe){401===ie&&de(pe)&&(Z+=": you may have provided an invalid Mapbox access token. See https://www.mapbox.com/api-documentation/#access-tokens-and-token-scopes"),A.call(this,Z),this.status=ie,this.url=pe,this.name=this.constructor.name,this.message=Z}return A&&(O.__proto__=A),(O.prototype=Object.create(A&&A.prototype)).constructor=O,O.prototype.toString=function(){return this.name+": "+this.message+" ("+this.status+"): "+this.url},O}(Error),dt=S()?function(){return self.worker&&self.worker.referrer}:function(){return("blob:"===self.location.protocol?self.parent:self).location.href};function tt(A,O){var Z,ie=new self.AbortController,pe=new self.Request(A.url,{method:A.method||"GET",body:A.body,credentials:A.credentials,headers:A.headers,referrer:dt(),signal:ie.signal}),xe=!1,Ce=!1,je=(Z=pe.url).indexOf("sku=")>0&&de(Z);"json"===A.type&&pe.headers.set("Accept","application/json");var $e=function(vt,zt,Yt){if(!Ce){if(vt&&"SecurityError"!==vt.message&&M(vt),zt&&Yt)return ut(zt);var qt=Date.now();self.fetch(pe).then(function(ar){if(ar.ok){var yr=je?ar.clone():null;return ut(ar,yr,qt)}return O(new xt(ar.statusText,ar.status,A.url))}).catch(function(ar){20!==ar.code&&O(new Error(ar.message))})}},ut=function(vt,zt,Yt){("arrayBuffer"===A.type?vt.arrayBuffer():"json"===A.type?vt.json():vt.text()).then(function(qt){Ce||(zt&&Yt&&function Se(A,O,Z){if(Me(),Oe){var ie={status:O.status,statusText:O.statusText,headers:new self.Headers};O.headers.forEach(function(xe,Ce){return ie.headers.set(Ce,xe)});var pe=E(O.headers.get("Cache-Control")||"");pe["no-store"]||(pe["max-age"]&&ie.headers.set("Expires",new Date(Z+1e3*pe["max-age"]).toUTCString()),new Date(ie.headers.get("Expires")).getTime()-Z<42e4||function(xe,Ce){if(void 0===fe)try{new Response(new ReadableStream),fe=!0}catch{fe=!1}fe?Ce(xe.body):xe.blob().then(Ce)}(O,function(xe){var Ce=new self.Response(xe,ie);Me(),Oe&&Oe.then(function(je){return je.put(Ie(A.url),Ce)}).catch(function(je){return M(je.message)})}))}}(pe,zt,Yt),xe=!0,O(null,qt,vt.headers.get("Cache-Control"),vt.headers.get("Expires")))}).catch(function(qt){Ce||O(new Error(qt.message))})};return je?function Fe(A,O){if(Me(),!Oe)return O(null);var Z=Ie(A.url);Oe.then(function(ie){ie.match(Z).then(function(pe){var xe=function(Ce){if(!Ce)return!1;var je=new Date(Ce.headers.get("Expires")||0),$e=E(Ce.headers.get("Cache-Control")||"");return je>Date.now()&&!$e["no-cache"]}(pe);ie.delete(Z),xe&&ie.put(Z,pe.clone()),O(null,pe,xe)}).catch(O)}).catch(O)}(pe,$e):$e(null,null),{cancel:function(){Ce=!0,xe||ie.abort()}}}var Ut,er,Ke=function(A,O){if(!(/^file:/.test(Z=A.url)||/^file:/.test(dt())&&!/^\w+:/.test(Z))){if(self.fetch&&self.Request&&self.AbortController&&self.Request.prototype.hasOwnProperty("signal"))return tt(A,O);if(S()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",A,O,void 0,!0)}var Z;return function(ie,pe){var xe=new self.XMLHttpRequest;for(var Ce in xe.open(ie.method||"GET",ie.url,!0),"arrayBuffer"===ie.type&&(xe.responseType="arraybuffer"),ie.headers)xe.setRequestHeader(Ce,ie.headers[Ce]);return"json"===ie.type&&(xe.responseType="text",xe.setRequestHeader("Accept","application/json")),xe.withCredentials="include"===ie.credentials,xe.onerror=function(){pe(new Error(xe.statusText))},xe.onload=function(){if((xe.status>=200&&xe.status<300||0===xe.status)&&null!==xe.response){var je=xe.response;if("json"===ie.type)try{je=JSON.parse(xe.response)}catch($e){return pe($e)}pe(null,je,xe.getResponseHeader("Cache-Control"),xe.getResponseHeader("Expires"))}else pe(new xt(xe.statusText,xe.status,ie.url))},xe.send(ie.body),{cancel:function(){return xe.abort()}}}(A,O)},mt=function(A,O){return Ke(c(A,{type:"arrayBuffer"}),O)},Bt=function(A,O){return Ke(c(A,{method:"POST"}),O)};Ut=[],er=0;var Wt=function(A,O){if(te.supported&&(A.headers||(A.headers={}),A.headers.accept="image/webp,*/*"),er>=U.MAX_PARALLEL_IMAGE_REQUESTS){var Z={requestParameters:A,callback:O,cancelled:!1,cancel:function(){this.cancelled=!0}};return Ut.push(Z),Z}er++;var ie=!1,pe=function(){if(!ie)for(ie=!0,er--;Ut.length&&er<U.MAX_PARALLEL_IMAGE_REQUESTS;){var Ce=Ut.shift();Ce.cancelled||(Ce.cancel=Wt(Ce.requestParameters,Ce.callback).cancel)}},xe=mt(A,function(Ce,je,$e,ut){var zt,Yt;pe(),Ce?O(Ce):je&&(nt()?(zt=O,Yt=new self.Blob([new Uint8Array(je)],{type:"image/png"}),self.createImageBitmap(Yt).then(function(qt){zt(null,qt)}).catch(function(qt){zt(new Error("Could not load image because of "+qt.message+". Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))})):function(vt,zt,Yt,qt){var ar=new self.Image,yr=self.URL;ar.onload=function(){zt(null,ar),yr.revokeObjectURL(ar.src)},ar.onerror=function(){return zt(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))};var Cr=new self.Blob([new Uint8Array(vt)],{type:"image/png"});ar.cacheControl=Yt,ar.expires=qt,ar.src=vt.byteLength?yr.createObjectURL(Cr):"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII="}(je,O,$e,ut))});return{cancel:function(){xe.cancel(),pe()}}};function rr(A,O,Z){Z[A]&&-1!==Z[A].indexOf(O)||(Z[A]=Z[A]||[],Z[A].push(O))}function Ht(A,O,Z){if(Z&&Z[A]){var ie=Z[A].indexOf(O);-1!==ie&&Z[A].splice(ie,1)}}var Ve=function(A,O){void 0===O&&(O={}),c(this,O),this.type=A},We=function(A){function O(Z,ie){void 0===ie&&(ie={}),A.call(this,"error",c({error:Z},ie))}return A&&(O.__proto__=A),(O.prototype=Object.create(A&&A.prototype)).constructor=O,O}(Ve),he=function(){};he.prototype.on=function(A,O){return this._listeners=this._listeners||{},rr(A,O,this._listeners),this},he.prototype.off=function(A,O){return Ht(A,O,this._listeners),Ht(A,O,this._oneTimeListeners),this},he.prototype.once=function(A,O){return this._oneTimeListeners=this._oneTimeListeners||{},rr(A,O,this._oneTimeListeners),this},he.prototype.fire=function(A,O){"string"==typeof A&&(A=new Ve(A,O||{}));var Z=A.type;if(this.listens(Z)){A.target=this;for(var ie=0,pe=this._listeners&&this._listeners[Z]?this._listeners[Z].slice():[];ie<pe.length;ie+=1)pe[ie].call(this,A);for(var xe=0,Ce=this._oneTimeListeners&&this._oneTimeListeners[Z]?this._oneTimeListeners[Z].slice():[];xe<Ce.length;xe+=1){var je=Ce[xe];Ht(Z,je,this._oneTimeListeners),je.call(this,A)}var $e=this._eventedParent;$e&&(c(A,"function"==typeof this._eventedParentData?this._eventedParentData():this._eventedParentData),$e.fire(A))}else A instanceof We&&console.error(A.error);return this},he.prototype.listens=function(A){return this._listeners&&this._listeners[A]&&this._listeners[A].length>0||this._oneTimeListeners&&this._oneTimeListeners[A]&&this._oneTimeListeners[A].length>0||this._eventedParent&&this._eventedParent.listens(A)},he.prototype.setEventedParent=function(A,O){return this._eventedParent=A,this._eventedParentData=O,this};var ye={$version:8,$root:{version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},light:{type:"light"},sources:{required:!0,type:"sources"},sprite:{type:"string"},glyphs:{type:"string"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},sources:{"*":{type:"source"}},source:["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],source_vector:{type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},promoteId:{type:"promoteId"},"*":{type:"*"}},source_raster:{type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},"*":{type:"*"}},source_raster_dem:{type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{}},default:"mapbox"},"*":{type:"*"}},source_geojson:{type:{required:!0,type:"enum",values:{geojson:{}}},data:{type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1},promoteId:{type:"promoteId"}},source_video:{type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_image:{type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},layer:{id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},background:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},layout:["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background"],layout_background:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_fill:{"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_circle:{"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_heatmap:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_line:{"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_symbol:{"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_raster:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_hillshade:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},filter:{type:"array",value:"*"},filter_operator:{type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{},within:{}}},geometry_type:{type:"enum",values:{Point:{},LineString:{},Polygon:{}}},function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:{type:"array",minimum:0,maximum:24,value:["number","color"],length:2},expression:{type:"array",value:"*",minimum:1},expression_name:{type:"enum",values:{let:{group:"Variable binding"},var:{group:"Variable binding"},literal:{group:"Types"},array:{group:"Types"},at:{group:"Lookup"},in:{group:"Lookup"},"index-of":{group:"Lookup"},slice:{group:"Lookup"},case:{group:"Decision"},match:{group:"Decision"},coalesce:{group:"Decision"},step:{group:"Ramps, scales, curves"},interpolate:{group:"Ramps, scales, curves"},"interpolate-hcl":{group:"Ramps, scales, curves"},"interpolate-lab":{group:"Ramps, scales, curves"},ln2:{group:"Math"},pi:{group:"Math"},e:{group:"Math"},typeof:{group:"Types"},string:{group:"Types"},number:{group:"Types"},boolean:{group:"Types"},object:{group:"Types"},collator:{group:"Types"},format:{group:"Types"},image:{group:"Types"},"number-format":{group:"Types"},"to-string":{group:"Types"},"to-number":{group:"Types"},"to-boolean":{group:"Types"},"to-rgba":{group:"Color"},"to-color":{group:"Types"},rgb:{group:"Color"},rgba:{group:"Color"},get:{group:"Lookup"},has:{group:"Lookup"},length:{group:"Lookup"},properties:{group:"Feature data"},"feature-state":{group:"Feature data"},"geometry-type":{group:"Feature data"},id:{group:"Feature data"},zoom:{group:"Zoom"},"heatmap-density":{group:"Heatmap"},"line-progress":{group:"Feature data"},accumulated:{group:"Feature data"},"+":{group:"Math"},"*":{group:"Math"},"-":{group:"Math"},"/":{group:"Math"},"%":{group:"Math"},"^":{group:"Math"},sqrt:{group:"Math"},log10:{group:"Math"},ln:{group:"Math"},log2:{group:"Math"},sin:{group:"Math"},cos:{group:"Math"},tan:{group:"Math"},asin:{group:"Math"},acos:{group:"Math"},atan:{group:"Math"},min:{group:"Math"},max:{group:"Math"},round:{group:"Math"},abs:{group:"Math"},ceil:{group:"Math"},floor:{group:"Math"},distance:{group:"Math"},"==":{group:"Decision"},"!=":{group:"Decision"},">":{group:"Decision"},"<":{group:"Decision"},">=":{group:"Decision"},"<=":{group:"Decision"},all:{group:"Decision"},any:{group:"Decision"},"!":{group:"Decision"},within:{group:"Decision"},"is-supported-script":{group:"String"},upcase:{group:"String"},downcase:{group:"String"},concat:{group:"String"},"resolved-locale":{group:"String"}}},light:{anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},paint:["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background"],paint_fill:{"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:{"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"line-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},paint_circle:{"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},paint_heatmap:{"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_symbol:{"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_raster:{"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_hillshade:{"hillshade-illumination-direction":{type:"number",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"color",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_background:{"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},transition:{duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:{"*":{type:"string"}}},Be=function(A,O,Z,ie){this.message=(A?A+": ":"")+Z,ie&&(this.identifier=ie),null!=O&&O.__line__&&(this.line=O.__line__)};function Ge(A){var Z=A.value;return Z?[new Be(A.key,Z,"constants have been deprecated as of v8")]:[]}function Je(A){for(var O=[],Z=arguments.length-1;Z-- >0;)O[Z]=arguments[Z+1];for(var ie=0,pe=O;ie<pe.length;ie+=1){var xe=pe[ie];for(var Ce in xe)A[Ce]=xe[Ce]}return A}function He(A){return A instanceof Number||A instanceof String||A instanceof Boolean?A.valueOf():A}function st(A){if(Array.isArray(A))return A.map(st);if(A instanceof Object&&!(A instanceof Number||A instanceof String||A instanceof Boolean)){var O={};for(var Z in A)O[Z]=st(A[Z]);return O}return He(A)}var ot=function(A){function O(Z,ie){A.call(this,ie),this.message=ie,this.key=Z}return A&&(O.__proto__=A),(O.prototype=Object.create(A&&A.prototype)).constructor=O,O}(Error),wt=function(A,O){void 0===O&&(O=[]),this.parent=A,this.bindings={};for(var Z=0,ie=O;Z<ie.length;Z+=1){var pe=ie[Z];this.bindings[pe[0]]=pe[1]}};wt.prototype.concat=function(A){return new wt(this,A)},wt.prototype.get=function(A){if(this.bindings[A])return this.bindings[A];if(this.parent)return this.parent.get(A);throw new Error(A+" not found in scope.")},wt.prototype.has=function(A){return!!this.bindings[A]||!!this.parent&&this.parent.has(A)};var Ct={kind:"null"},rt={kind:"number"},ft={kind:"string"},Rt={kind:"boolean"},kt={kind:"color"},Lt={kind:"object"},Ee={kind:"value"},Ye={kind:"collator"},it={kind:"formatted"},ht={kind:"resolvedImage"};function At(A,O){return{kind:"array",itemType:A,N:O}}function Ft(A){if("array"===A.kind){var O=Ft(A.itemType);return"number"==typeof A.N?"array<"+O+", "+A.N+">":"value"===A.itemType.kind?"array":"array<"+O+">"}return A.kind}var Gt=[Ct,rt,ft,Rt,kt,it,Lt,At(Ee),ht];function jt(A,O){if("error"===O.kind)return null;if("array"===A.kind){if("array"===O.kind&&(0===O.N&&"value"===O.itemType.kind||!jt(A.itemType,O.itemType))&&("number"!=typeof A.N||A.N===O.N))return null}else{if(A.kind===O.kind)return null;if("value"===A.kind)for(var Z=0,ie=Gt;Z<ie.length;Z+=1)if(!jt(ie[Z],O))return null}return"Expected "+Ft(A)+" but found "+Ft(O)+" instead."}function fr(A,O){return O.some(function(Z){return Z.kind===A.kind})}function kr(A,O){return O.some(function(Z){return"null"===Z?null===A:"array"===Z?Array.isArray(A):"object"===Z?A&&!Array.isArray(A)&&"object"==typeof A:Z===typeof A})}var ur=n(function(A,O){var Z={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function ie($e){return($e=Math.round($e))<0?0:$e>255?255:$e}function xe($e){return ie("%"===$e[$e.length-1]?parseFloat($e)/100*255:parseInt($e))}function Ce($e){return function pe($e){return $e<0?0:$e>1?1:$e}("%"===$e[$e.length-1]?parseFloat($e)/100:parseFloat($e))}function je($e,ut,vt){return vt<0?vt+=1:vt>1&&(vt-=1),6*vt<1?$e+(ut-$e)*vt*6:2*vt<1?ut:3*vt<2?$e+(ut-$e)*(2/3-vt)*6:$e}try{O.parseCSSColor=function($e){var ut,vt=$e.replace(/ /g,"").toLowerCase();if(vt in Z)return Z[vt].slice();if("#"===vt[0])return 4===vt.length?(ut=parseInt(vt.substr(1),16))>=0&&ut<=4095?[(3840&ut)>>4|(3840&ut)>>8,240&ut|(240&ut)>>4,15&ut|(15&ut)<<4,1]:null:7===vt.length&&(ut=parseInt(vt.substr(1),16))>=0&&ut<=16777215?[(16711680&ut)>>16,(65280&ut)>>8,255&ut,1]:null;var zt=vt.indexOf("("),Yt=vt.indexOf(")");if(-1!==zt&&Yt+1===vt.length){var qt=vt.substr(0,zt),ar=vt.substr(zt+1,Yt-(zt+1)).split(","),yr=1;switch(qt){case"rgba":if(4!==ar.length)return null;yr=Ce(ar.pop());case"rgb":return 3!==ar.length?null:[xe(ar[0]),xe(ar[1]),xe(ar[2]),yr];case"hsla":if(4!==ar.length)return null;yr=Ce(ar.pop());case"hsl":if(3!==ar.length)return null;var Cr=(parseFloat(ar[0])%360+360)%360/360,Lr=Ce(ar[1]),jr=Ce(ar[2]),Ur=jr<=.5?jr*(Lr+1):jr+Lr-jr*Lr,Zr=2*jr-Ur;return[ie(255*je(Zr,Ur,Cr+1/3)),ie(255*je(Zr,Ur,Cr)),ie(255*je(Zr,Ur,Cr-1/3)),yr];default:return null}}return null}}catch{}}).parseCSSColor,Jt=function(A,O,Z,ie){void 0===ie&&(ie=1),this.r=A,this.g=O,this.b=Z,this.a=ie};Jt.parse=function(A){if(A){if(A instanceof Jt)return A;if("string"==typeof A){var O=ur(A);if(O)return new Jt(O[0]/255*O[3],O[1]/255*O[3],O[2]/255*O[3],O[3])}}},Jt.prototype.toString=function(){var A=this.toArray(),Z=A[1],ie=A[2],pe=A[3];return"rgba("+Math.round(A[0])+","+Math.round(Z)+","+Math.round(ie)+","+pe+")"},Jt.prototype.toArray=function(){var ie=this.a;return 0===ie?[0,0,0,0]:[255*this.r/ie,255*this.g/ie,255*this.b/ie,ie]},Jt.black=new Jt(0,0,0,1),Jt.white=new Jt(1,1,1,1),Jt.transparent=new Jt(0,0,0,0),Jt.red=new Jt(1,0,0,1);var $t=function(A,O,Z){this.sensitivity=A?O?"variant":"case":O?"accent":"base",this.locale=Z,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})};$t.prototype.compare=function(A,O){return this.collator.compare(A,O)},$t.prototype.resolvedLocale=function(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale};var Qt=function(A,O,Z,ie,pe){this.text=A,this.image=O,this.scale=Z,this.fontStack=ie,this.textColor=pe},cr=function(A){this.sections=A};cr.fromString=function(A){return new cr([new Qt(A,null,null,null,null)])},cr.prototype.isEmpty=function(){return 0===this.sections.length||!this.sections.some(function(A){return 0!==A.text.length||A.image&&0!==A.image.name.length})},cr.factory=function(A){return A instanceof cr?A:cr.fromString(A)},cr.prototype.toString=function(){return 0===this.sections.length?"":this.sections.map(function(A){return A.text}).join("")},cr.prototype.serialize=function(){for(var A=["format"],O=0,Z=this.sections;O<Z.length;O+=1){var ie=Z[O];if(ie.image)A.push(["image",ie.image.name]);else{A.push(ie.text);var pe={};ie.fontStack&&(pe["text-font"]=["literal",ie.fontStack.split(",")]),ie.scale&&(pe["font-scale"]=ie.scale),ie.textColor&&(pe["text-color"]=["rgba"].concat(ie.textColor.toArray())),A.push(pe)}}return A};var gr=function(A){this.name=A.name,this.available=A.available};function Tr(A,O,Z,ie){return"number"==typeof A&&A>=0&&A<=255&&"number"==typeof O&&O>=0&&O<=255&&"number"==typeof Z&&Z>=0&&Z<=255?void 0===ie||"number"==typeof ie&&ie>=0&&ie<=1?null:"Invalid rgba value ["+[A,O,Z,ie].join(", ")+"]: 'a' must be between 0 and 1.":"Invalid rgba value ["+("number"==typeof ie?[A,O,Z,ie]:[A,O,Z]).join(", ")+"]: 'r', 'g', and 'b' must be between 0 and 255."}function Fr(A){if(null===A||"string"==typeof A||"boolean"==typeof A||"number"==typeof A||A instanceof Jt||A instanceof $t||A instanceof cr||A instanceof gr)return!0;if(Array.isArray(A)){for(var O=0,Z=A;O<Z.length;O+=1)if(!Fr(Z[O]))return!1;return!0}if("object"==typeof A){for(var ie in A)if(!Fr(A[ie]))return!1;return!0}return!1}function Nr(A){if(null===A)return Ct;if("string"==typeof A)return ft;if("boolean"==typeof A)return Rt;if("number"==typeof A)return rt;if(A instanceof Jt)return kt;if(A instanceof $t)return Ye;if(A instanceof cr)return it;if(A instanceof gr)return ht;if(Array.isArray(A)){for(var O,Z=A.length,ie=0,pe=A;ie<pe.length;ie+=1){var xe=Nr(pe[ie]);if(O){if(O===xe)continue;O=Ee;break}O=xe}return At(O||Ee,Z)}return Lt}function Xr(A){var O=typeof A;return null===A?"":"string"===O||"number"===O||"boolean"===O?String(A):A instanceof Jt||A instanceof cr||A instanceof gr?A.toString():JSON.stringify(A)}gr.prototype.toString=function(){return this.name},gr.fromString=function(A){return A?new gr({name:A,available:!1}):null},gr.prototype.serialize=function(){return["image",this.name]};var un=function(A,O){this.type=A,this.value=O};un.parse=function(A,O){if(2!==A.length)return O.error("'literal' expression requires exactly one argument, but found "+(A.length-1)+" instead.");if(!Fr(A[1]))return O.error("invalid value");var Z=A[1],ie=Nr(Z),pe=O.expectedType;return"array"!==ie.kind||0!==ie.N||!pe||"array"!==pe.kind||"number"==typeof pe.N&&0!==pe.N||(ie=pe),new un(ie,Z)},un.prototype.evaluate=function(){return this.value},un.prototype.eachChild=function(){},un.prototype.outputDefined=function(){return!0},un.prototype.serialize=function(){return"array"===this.type.kind||"object"===this.type.kind?["literal",this.value]:this.value instanceof Jt?["rgba"].concat(this.value.toArray()):this.value instanceof cr?this.value.serialize():this.value};var $r=function(A){this.name="ExpressionEvaluationError",this.message=A};$r.prototype.toJSON=function(){return this.message};var Pn={string:ft,number:rt,boolean:Rt,object:Lt},gn=function(A,O){this.type=A,this.args=O};gn.parse=function(A,O){if(A.length<2)return O.error("Expected at least one argument.");var Z,ie=1,pe=A[0];if("array"===pe){var xe,Ce;if(A.length>2){var je=A[1];if("string"!=typeof je||!(je in Pn)||"object"===je)return O.error('The item type argument of "array" must be one of string, number, boolean',1);xe=Pn[je],ie++}else xe=Ee;if(A.length>3){if(null!==A[2]&&("number"!=typeof A[2]||A[2]<0||A[2]!==Math.floor(A[2])))return O.error('The length argument to "array" must be a positive integer literal',2);Ce=A[2],ie++}Z=At(xe,Ce)}else Z=Pn[pe];for(var $e=[];ie<A.length;ie++){var ut=O.parse(A[ie],ie,Ee);if(!ut)return null;$e.push(ut)}return new gn(Z,$e)},gn.prototype.evaluate=function(A){for(var O=0;O<this.args.length;O++){var Z=this.args[O].evaluate(A);if(!jt(this.type,Nr(Z)))return Z;if(O===this.args.length-1)throw new $r("Expected value to be of type "+Ft(this.type)+", but found "+Ft(Nr(Z))+" instead.")}return null},gn.prototype.eachChild=function(A){this.args.forEach(A)},gn.prototype.outputDefined=function(){return this.args.every(function(A){return A.outputDefined()})},gn.prototype.serialize=function(){var A=this.type,O=[A.kind];if("array"===A.kind){var Z=A.itemType;if("string"===Z.kind||"number"===Z.kind||"boolean"===Z.kind){O.push(Z.kind);var ie=A.N;("number"==typeof ie||this.args.length>1)&&O.push(ie)}}return O.concat(this.args.map(function(pe){return pe.serialize()}))};var dn=function(A){this.type=it,this.sections=A};dn.parse=function(A,O){if(A.length<2)return O.error("Expected at least one argument.");var Z=A[1];if(!Array.isArray(Z)&&"object"==typeof Z)return O.error("First argument must be an image or text section.");for(var ie=[],pe=!1,xe=1;xe<=A.length-1;++xe){var Ce=A[xe];if(pe&&"object"==typeof Ce&&!Array.isArray(Ce)){pe=!1;var je=null;if(Ce["font-scale"]&&!(je=O.parse(Ce["font-scale"],1,rt)))return null;var $e=null;if(Ce["text-font"]&&!($e=O.parse(Ce["text-font"],1,At(ft))))return null;var ut=null;if(Ce["text-color"]&&!(ut=O.parse(Ce["text-color"],1,kt)))return null;var vt=ie[ie.length-1];vt.scale=je,vt.font=$e,vt.textColor=ut}else{var zt=O.parse(A[xe],1,Ee);if(!zt)return null;var Yt=zt.type.kind;if("string"!==Yt&&"value"!==Yt&&"null"!==Yt&&"resolvedImage"!==Yt)return O.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");pe=!0,ie.push({content:zt,scale:null,font:null,textColor:null})}}return new dn(ie)},dn.prototype.evaluate=function(A){return new cr(this.sections.map(function(O){var Z=O.content.evaluate(A);return Nr(Z)===ht?new Qt("",Z,null,null,null):new Qt(Xr(Z),null,O.scale?O.scale.evaluate(A):null,O.font?O.font.evaluate(A).join(","):null,O.textColor?O.textColor.evaluate(A):null)}))},dn.prototype.eachChild=function(A){for(var O=0,Z=this.sections;O<Z.length;O+=1){var ie=Z[O];A(ie.content),ie.scale&&A(ie.scale),ie.font&&A(ie.font),ie.textColor&&A(ie.textColor)}},dn.prototype.outputDefined=function(){return!1},dn.prototype.serialize=function(){for(var A=["format"],O=0,Z=this.sections;O<Z.length;O+=1){var ie=Z[O];A.push(ie.content.serialize());var pe={};ie.scale&&(pe["font-scale"]=ie.scale.serialize()),ie.font&&(pe["text-font"]=ie.font.serialize()),ie.textColor&&(pe["text-color"]=ie.textColor.serialize()),A.push(pe)}return A};var An=function(A){this.type=ht,this.input=A};An.parse=function(A,O){if(2!==A.length)return O.error("Expected two arguments.");var Z=O.parse(A[1],1,ft);return Z?new An(Z):O.error("No image name provided.")},An.prototype.evaluate=function(A){var O=this.input.evaluate(A),Z=gr.fromString(O);return Z&&A.availableImages&&(Z.available=A.availableImages.indexOf(O)>-1),Z},An.prototype.eachChild=function(A){A(this.input)},An.prototype.outputDefined=function(){return!1},An.prototype.serialize=function(){return["image",this.input.serialize()]};var Zn={"to-boolean":Rt,"to-color":kt,"to-number":rt,"to-string":ft},Rr=function(A,O){this.type=A,this.args=O};Rr.parse=function(A,O){if(A.length<2)return O.error("Expected at least one argument.");var Z=A[0];if(("to-boolean"===Z||"to-string"===Z)&&2!==A.length)return O.error("Expected one argument.");for(var ie=Zn[Z],pe=[],xe=1;xe<A.length;xe++){var Ce=O.parse(A[xe],xe,Ee);if(!Ce)return null;pe.push(Ce)}return new Rr(ie,pe)},Rr.prototype.evaluate=function(A){if("boolean"===this.type.kind)return Boolean(this.args[0].evaluate(A));if("color"===this.type.kind){for(var O,Z,ie=0,pe=this.args;ie<pe.length;ie+=1){if(Z=null,(O=pe[ie].evaluate(A))instanceof Jt)return O;if("string"==typeof O){var xe=A.parseColor(O);if(xe)return xe}else if(Array.isArray(O)&&!(Z=O.length<3||O.length>4?"Invalid rbga value "+JSON.stringify(O)+": expected an array containing either three or four numeric values.":Tr(O[0],O[1],O[2],O[3])))return new Jt(O[0]/255,O[1]/255,O[2]/255,O[3])}throw new $r(Z||"Could not parse color from value '"+("string"==typeof O?O:String(JSON.stringify(O)))+"'")}if("number"===this.type.kind){for(var Ce=null,je=0,$e=this.args;je<$e.length;je+=1){if(null===(Ce=$e[je].evaluate(A)))return 0;var ut=Number(Ce);if(!isNaN(ut))return ut}throw new $r("Could not convert "+JSON.stringify(Ce)+" to number.")}return"formatted"===this.type.kind?cr.fromString(Xr(this.args[0].evaluate(A))):"resolvedImage"===this.type.kind?gr.fromString(Xr(this.args[0].evaluate(A))):Xr(this.args[0].evaluate(A))},Rr.prototype.eachChild=function(A){this.args.forEach(A)},Rr.prototype.outputDefined=function(){return this.args.every(function(A){return A.outputDefined()})},Rr.prototype.serialize=function(){if("formatted"===this.type.kind)return new dn([{content:this.args[0],scale:null,font:null,textColor:null}]).serialize();if("resolvedImage"===this.type.kind)return new An(this.args[0]).serialize();var A=["to-"+this.type.kind];return this.eachChild(function(O){A.push(O.serialize())}),A};var hn=["Unknown","Point","LineString","Polygon"],nn=function(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null};nn.prototype.id=function(){return this.feature&&"id"in this.feature?this.feature.id:null},nn.prototype.geometryType=function(){return this.feature?"number"==typeof this.feature.type?hn[this.feature.type]:this.feature.type:null},nn.prototype.geometry=function(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null},nn.prototype.canonicalID=function(){return this.canonical},nn.prototype.properties=function(){return this.feature&&this.feature.properties||{}},nn.prototype.parseColor=function(A){var O=this._parseColorCache[A];return O||(O=this._parseColorCache[A]=Jt.parse(A)),O};var Hr=function(A,O,Z,ie){this.name=A,this.type=O,this._evaluate=Z,this.args=ie};Hr.prototype.evaluate=function(A){return this._evaluate(A,this.args)},Hr.prototype.eachChild=function(A){this.args.forEach(A)},Hr.prototype.outputDefined=function(){return!1},Hr.prototype.serialize=function(){return[this.name].concat(this.args.map(function(A){return A.serialize()}))},Hr.parse=function(A,O){var Z,ie=A[0],pe=Hr.definitions[ie];if(!pe)return O.error('Unknown expression "'+ie+'". If you wanted a literal array, use ["literal", [...]].',0);for(var xe=Array.isArray(pe)?pe[0]:pe.type,Ce=Array.isArray(pe)?[[pe[1],pe[2]]]:pe.overloads,je=Ce.filter(function(oi){var Kn=oi[0];return!Array.isArray(Kn)||Kn.length===A.length-1}),$e=null,ut=0,vt=je;ut<vt.length;ut+=1){var zt=vt[ut],Yt=zt[0],qt=zt[1];$e=new en(O.registry,O.path,null,O.scope);for(var ar=[],yr=!1,Cr=1;Cr<A.length;Cr++){var Lr=A[Cr],jr=Array.isArray(Yt)?Yt[Cr-1]:Yt.type,Ur=$e.parse(Lr,1+ar.length,jr);if(!Ur){yr=!0;break}ar.push(Ur)}if(!yr)if(Array.isArray(Yt)&&Yt.length!==ar.length)$e.error("Expected "+Yt.length+" arguments, but found "+ar.length+" instead.");else{for(var Zr=0;Zr<ar.length;Zr++){var ln=Array.isArray(Yt)?Yt[Zr]:Yt.type,yn=ar[Zr];$e.concat(Zr+1).checkSubtype(ln,yn.type)}if(0===$e.errors.length)return new Hr(ie,xe,qt,ar)}}if(1===je.length)(Z=O.errors).push.apply(Z,$e.errors);else{for(var Bn=(je.length?je:Ce).map(function(oi){var Kn;return Kn=oi[0],Array.isArray(Kn)?"("+Kn.map(Ft).join(", ")+")":"("+Ft(Kn.type)+"...)"}).join(" | "),Rn=[],Gn=1;Gn<A.length;Gn++){var ai=O.parse(A[Gn],1+Rn.length);if(!ai)return null;Rn.push(Ft(ai.type))}O.error("Expected arguments of type "+Bn+", but found ("+Rn.join(", ")+") instead.")}return null},Hr.register=function(A,O){for(var Z in Hr.definitions=O,O)A[Z]=Hr};var Fn=function(A,O,Z){this.type=Ye,this.locale=Z,this.caseSensitive=A,this.diacriticSensitive=O};function Un(A,O){A[0]=Math.min(A[0],O[0]),A[1]=Math.min(A[1],O[1]),A[2]=Math.max(A[2],O[0]),A[3]=Math.max(A[3],O[1])}function vn(A,O){return!(A[0]<=O[0]||A[2]>=O[2]||A[1]<=O[1]||A[3]>=O[3])}function Cn(A,O){var ie=(180+A[0])/360,pe=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+A[1]*Math.PI/360)))/360,xe=Math.pow(2,O.z);return[Math.round(ie*xe*8192),Math.round(pe*xe*8192)]}function li(A,O,Z){return O[1]>A[1]!=Z[1]>A[1]&&A[0]<(Z[0]-O[0])*(A[1]-O[1])/(Z[1]-O[1])+O[0]}function tr(A,O){for(var Z,ie,pe,xe,Ce,je,$e,ut=!1,vt=0,zt=O.length;vt<zt;vt++)for(var Yt=O[vt],qt=0,ar=Yt.length;qt<ar-1;qt++){if(void 0,void 0,void 0,void 0,(xe=(Z=A)[0]-(ie=Yt[qt])[0])*($e=Z[1]-(pe=Yt[qt+1])[1])-(je=Z[0]-pe[0])*(Ce=Z[1]-ie[1])==0&&xe*je<=0&&Ce*$e<=0)return!1;li(A,Yt[qt],Yt[qt+1])&&(ut=!ut)}return ut}function mr(A,O){for(var Z=0;Z<O.length;Z++)if(tr(A,O[Z]))return!0;return!1}function Pt(A,O,Z,ie){var $e=ie[0]-Z[0],ut=ie[1]-Z[1],vt=(A[0]-Z[0])*ut-$e*(A[1]-Z[1]),zt=(O[0]-Z[0])*ut-$e*(O[1]-Z[1]);return vt>0&&zt<0||vt<0&&zt>0}function or(A,O,Z){for(var ie=0,pe=Z;ie<pe.length;ie+=1)for(var xe=pe[ie],Ce=0;Ce<xe.length-1;++Ce)if(void 0,void 0,(zt=[(vt=xe[Ce+1])[0]-(ut=xe[Ce])[0],vt[1]-ut[1]])[0]*(Yt=[($e=O)[0]-(je=A)[0],$e[1]-je[1]])[1]-zt[1]*Yt[0]!=0&&Pt(je,$e,ut,vt)&&Pt(ut,vt,je,$e))return!0;var je,$e,ut,vt,zt,Yt;return!1}function hr(A,O){for(var Z=0;Z<A.length;++Z)if(!tr(A[Z],O))return!1;for(var ie=0;ie<A.length-1;++ie)if(or(A[ie],A[ie+1],O))return!1;return!0}function zr(A,O){for(var Z=0;Z<O.length;Z++)if(hr(A,O[Z]))return!0;return!1}function Dr(A,O,Z){for(var ie=[],pe=0;pe<A.length;pe++){for(var xe=[],Ce=0;Ce<A[pe].length;Ce++){var je=Cn(A[pe][Ce],Z);Un(O,je),xe.push(je)}ie.push(xe)}return ie}function Ir(A,O,Z){for(var ie=[],pe=0;pe<A.length;pe++){var xe=Dr(A[pe],O,Z);ie.push(xe)}return ie}function Mr(A,O,Z,ie){if(A[0]<Z[0]||A[0]>Z[2]){var pe=.5*ie,xe=A[0]-Z[0]>pe?-ie:Z[0]-A[0]>pe?ie:0;0===xe&&(xe=A[0]-Z[2]>pe?-ie:Z[2]-A[0]>pe?ie:0),A[0]+=xe}Un(O,A)}function vr(A,O,Z,ie){for(var pe=8192*Math.pow(2,ie.z),xe=[8192*ie.x,8192*ie.y],Ce=[],je=0,$e=A;je<$e.length;je+=1)for(var ut=0,vt=$e[je];ut<vt.length;ut+=1){var zt=vt[ut],Yt=[zt.x+xe[0],zt.y+xe[1]];Mr(Yt,O,Z,pe),Ce.push(Yt)}return Ce}function xr(A,O,Z,ie){for(var pe,xe=8192*Math.pow(2,ie.z),Ce=[8192*ie.x,8192*ie.y],je=[],$e=0,ut=A;$e<ut.length;$e+=1){for(var vt=[],zt=0,Yt=ut[$e];zt<Yt.length;zt+=1){var qt=Yt[zt],ar=[qt.x+Ce[0],qt.y+Ce[1]];Un(O,ar),vt.push(ar)}je.push(vt)}if(O[2]-O[0]<=xe/2){(pe=O)[0]=pe[1]=1/0,pe[2]=pe[3]=-1/0;for(var yr=0,Cr=je;yr<Cr.length;yr+=1)for(var Lr=0,jr=Cr[yr];Lr<jr.length;Lr+=1)Mr(jr[Lr],O,Z,xe)}return je}Fn.parse=function(A,O){if(2!==A.length)return O.error("Expected one argument.");var Z=A[1];if("object"!=typeof Z||Array.isArray(Z))return O.error("Collator options argument must be an object.");var ie=O.parse(void 0!==Z["case-sensitive"]&&Z["case-sensitive"],1,Rt);if(!ie)return null;var pe=O.parse(void 0!==Z["diacritic-sensitive"]&&Z["diacritic-sensitive"],1,Rt);if(!pe)return null;var xe=null;return Z.locale&&!(xe=O.parse(Z.locale,1,ft))?null:new Fn(ie,pe,xe)},Fn.prototype.evaluate=function(A){return new $t(this.caseSensitive.evaluate(A),this.diacriticSensitive.evaluate(A),this.locale?this.locale.evaluate(A):null)},Fn.prototype.eachChild=function(A){A(this.caseSensitive),A(this.diacriticSensitive),this.locale&&A(this.locale)},Fn.prototype.outputDefined=function(){return!1},Fn.prototype.serialize=function(){var A={};return A["case-sensitive"]=this.caseSensitive.serialize(),A["diacritic-sensitive"]=this.diacriticSensitive.serialize(),this.locale&&(A.locale=this.locale.serialize()),["collator",A]};var wr=function(A,O){this.type=Rt,this.geojson=A,this.geometries=O};function Er(A){if(A instanceof Hr&&("get"===A.name&&1===A.args.length||"feature-state"===A.name||"has"===A.name&&1===A.args.length||"properties"===A.name||"geometry-type"===A.name||"id"===A.name||/^filter-/.test(A.name))||A instanceof wr)return!1;var O=!0;return A.eachChild(function(Z){O&&!Er(Z)&&(O=!1)}),O}function qr(A){if(A instanceof Hr&&"feature-state"===A.name)return!1;var O=!0;return A.eachChild(function(Z){O&&!qr(Z)&&(O=!1)}),O}function Vr(A,O){if(A instanceof Hr&&O.indexOf(A.name)>=0)return!1;var Z=!0;return A.eachChild(function(ie){Z&&!Vr(ie,O)&&(Z=!1)}),Z}wr.parse=function(A,O){if(2!==A.length)return O.error("'within' expression requires exactly one argument, but found "+(A.length-1)+" instead.");if(Fr(A[1])){var Z=A[1];if("FeatureCollection"===Z.type)for(var ie=0;ie<Z.features.length;++ie){var pe=Z.features[ie].geometry.type;if("Polygon"===pe||"MultiPolygon"===pe)return new wr(Z,Z.features[ie].geometry)}else if("Feature"===Z.type){var xe=Z.geometry.type;if("Polygon"===xe||"MultiPolygon"===xe)return new wr(Z,Z.geometry)}else if("Polygon"===Z.type||"MultiPolygon"===Z.type)return new wr(Z,Z)}return O.error("'within' expression requires valid geojson object that contains polygon geometry type.")},wr.prototype.evaluate=function(A){if(null!=A.geometry()&&null!=A.canonicalID()){if("Point"===A.geometryType())return function(O,Z){var ie=[1/0,1/0,-1/0,-1/0],pe=[1/0,1/0,-1/0,-1/0],xe=O.canonicalID();if("Polygon"===Z.type){var Ce=Dr(Z.coordinates,pe,xe),je=vr(O.geometry(),ie,pe,xe);if(!vn(ie,pe))return!1;for(var $e=0,ut=je;$e<ut.length;$e+=1)if(!tr(ut[$e],Ce))return!1}if("MultiPolygon"===Z.type){var vt=Ir(Z.coordinates,pe,xe),zt=vr(O.geometry(),ie,pe,xe);if(!vn(ie,pe))return!1;for(var Yt=0,qt=zt;Yt<qt.length;Yt+=1)if(!mr(qt[Yt],vt))return!1}return!0}(A,this.geometries);if("LineString"===A.geometryType())return function(O,Z){var ie=[1/0,1/0,-1/0,-1/0],pe=[1/0,1/0,-1/0,-1/0],xe=O.canonicalID();if("Polygon"===Z.type){var Ce=Dr(Z.coordinates,pe,xe),je=xr(O.geometry(),ie,pe,xe);if(!vn(ie,pe))return!1;for(var $e=0,ut=je;$e<ut.length;$e+=1)if(!hr(ut[$e],Ce))return!1}if("MultiPolygon"===Z.type){var vt=Ir(Z.coordinates,pe,xe),zt=xr(O.geometry(),ie,pe,xe);if(!vn(ie,pe))return!1;for(var Yt=0,qt=zt;Yt<qt.length;Yt+=1)if(!zr(qt[Yt],vt))return!1}return!0}(A,this.geometries)}return!1},wr.prototype.eachChild=function(){},wr.prototype.outputDefined=function(){return!0},wr.prototype.serialize=function(){return["within",this.geojson]};var Qr=function(A,O){this.type=O.type,this.name=A,this.boundExpression=O};Qr.parse=function(A,O){if(2!==A.length||"string"!=typeof A[1])return O.error("'var' expression requires exactly one string literal argument.");var Z=A[1];return O.scope.has(Z)?new Qr(Z,O.scope.get(Z)):O.error('Unknown variable "'+Z+'". Make sure "'+Z+'" has been bound in an enclosing "let" expression before using it.',1)},Qr.prototype.evaluate=function(A){return this.boundExpression.evaluate(A)},Qr.prototype.eachChild=function(){},Qr.prototype.outputDefined=function(){return!1},Qr.prototype.serialize=function(){return["var",this.name]};var en=function(A,O,Z,ie,pe){void 0===O&&(O=[]),void 0===ie&&(ie=new wt),void 0===pe&&(pe=[]),this.registry=A,this.path=O,this.key=O.map(function(xe){return"["+xe+"]"}).join(""),this.scope=ie,this.errors=pe,this.expectedType=Z};function mn(A,O){for(var Z,pe=A.length-1,xe=0,Ce=pe,je=0;xe<=Ce;)if((Z=A[je=Math.floor((xe+Ce)/2)])<=O){if(je===pe||O<A[je+1])return je;xe=je+1}else{if(!(Z>O))throw new $r("Input is not a number.");Ce=je-1}return 0}en.prototype.parse=function(A,O,Z,ie,pe){return void 0===pe&&(pe={}),O?this.concat(O,Z,ie)._parse(A,pe):this._parse(A,pe)},en.prototype._parse=function(A,O){function Z(ut,vt,zt){return"assert"===zt?new gn(vt,[ut]):"coerce"===zt?new Rr(vt,[ut]):ut}if(null!==A&&"string"!=typeof A&&"boolean"!=typeof A&&"number"!=typeof A||(A=["literal",A]),Array.isArray(A)){if(0===A.length)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');var ie=A[0];if("string"!=typeof ie)return this.error("Expression name must be a string, but found "+typeof ie+' instead. If you wanted a literal array, use ["literal", [...]].',0),null;var pe=this.registry[ie];if(pe){var xe=pe.parse(A,this);if(!xe)return null;if(this.expectedType){var Ce=this.expectedType,je=xe.type;if("string"!==Ce.kind&&"number"!==Ce.kind&&"boolean"!==Ce.kind&&"object"!==Ce.kind&&"array"!==Ce.kind||"value"!==je.kind)if("color"!==Ce.kind&&"formatted"!==Ce.kind&&"resolvedImage"!==Ce.kind||"value"!==je.kind&&"string"!==je.kind){if(this.checkSubtype(Ce,je))return null}else xe=Z(xe,Ce,O.typeAnnotation||"coerce");else xe=Z(xe,Ce,O.typeAnnotation||"assert")}if(!(xe instanceof un)&&"resolvedImage"!==xe.type.kind&&function ut(vt){if(vt instanceof Qr)return ut(vt.boundExpression);if(vt instanceof Hr&&"error"===vt.name||vt instanceof Fn||vt instanceof wr)return!1;var zt=vt instanceof Rr||vt instanceof gn,Yt=!0;return vt.eachChild(function(qt){Yt=zt?Yt&&ut(qt):Yt&&qt instanceof un}),!!Yt&&Er(vt)&&Vr(vt,["zoom","heatmap-density","line-progress","accumulated","is-supported-script"])}(xe)){var $e=new nn;try{xe=new un(xe.type,xe.evaluate($e))}catch(ut){return this.error(ut.message),null}}return xe}return this.error('Unknown expression "'+ie+'". If you wanted a literal array, use ["literal", [...]].',0)}return this.error(void 0===A?"'undefined' value invalid. Use null instead.":"object"==typeof A?'Bare objects invalid. Use ["literal", {...}] instead.':"Expected an array, but found "+typeof A+" instead.")},en.prototype.concat=function(A,O,Z){var ie="number"==typeof A?this.path.concat(A):this.path,pe=Z?this.scope.concat(Z):this.scope;return new en(this.registry,ie,O||null,pe,this.errors)},en.prototype.error=function(A){for(var O=[],Z=arguments.length-1;Z-- >0;)O[Z]=arguments[Z+1];var ie=""+this.key+O.map(function(pe){return"["+pe+"]"}).join("");this.errors.push(new ot(ie,A))},en.prototype.checkSubtype=function(A,O){var Z=jt(A,O);return Z&&this.error(Z),Z};var xn=function(A,O,Z){this.type=A,this.input=O,this.labels=[],this.outputs=[];for(var ie=0,pe=Z;ie<pe.length;ie+=1){var xe=pe[ie],je=xe[1];this.labels.push(xe[0]),this.outputs.push(je)}};function bn(A,O,Z){return A*(1-Z)+O*Z}xn.parse=function(A,O){if(A.length-1<4)return O.error("Expected at least 4 arguments, but found only "+(A.length-1)+".");if((A.length-1)%2!=0)return O.error("Expected an even number of arguments.");var Z=O.parse(A[1],1,rt);if(!Z)return null;var ie=[],pe=null;O.expectedType&&"value"!==O.expectedType.kind&&(pe=O.expectedType);for(var xe=1;xe<A.length;xe+=2){var Ce=1===xe?-1/0:A[xe],je=A[xe+1],$e=xe,ut=xe+1;if("number"!=typeof Ce)return O.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',$e);if(ie.length&&ie[ie.length-1][0]>=Ce)return O.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',$e);var vt=O.parse(je,ut,pe);if(!vt)return null;pe=pe||vt.type,ie.push([Ce,vt])}return new xn(pe,Z,ie)},xn.prototype.evaluate=function(A){var O=this.labels,Z=this.outputs;if(1===O.length)return Z[0].evaluate(A);var ie=this.input.evaluate(A);if(ie<=O[0])return Z[0].evaluate(A);var pe=O.length;return ie>=O[pe-1]?Z[pe-1].evaluate(A):Z[mn(O,ie)].evaluate(A)},xn.prototype.eachChild=function(A){A(this.input);for(var O=0,Z=this.outputs;O<Z.length;O+=1)A(Z[O])},xn.prototype.outputDefined=function(){return this.outputs.every(function(A){return A.outputDefined()})},xn.prototype.serialize=function(){for(var A=["step",this.input.serialize()],O=0;O<this.labels.length;O++)O>0&&A.push(this.labels[O]),A.push(this.outputs[O].serialize());return A};var Sn=Object.freeze({__proto__:null,number:bn,color:function(A,O,Z){return new Jt(bn(A.r,O.r,Z),bn(A.g,O.g,Z),bn(A.b,O.b,Z),bn(A.a,O.a,Z))},array:function(A,O,Z){return A.map(function(ie,pe){return bn(ie,O[pe],Z)})}}),In=6/29,Yn=3*In*In,ki=Math.PI/180,Ti=180/Math.PI;function kn(A){return A>.008856451679035631?Math.pow(A,1/3):A/Yn+4/29}function Qn(A){return A>In?A*A*A:Yn*(A-4/29)}function Jn(A){return 255*(A<=.0031308?12.92*A:1.055*Math.pow(A,1/2.4)-.055)}function Ii(A){return(A/=255)<=.04045?A/12.92:Math.pow((A+.055)/1.055,2.4)}function ha(A){var O=Ii(A.r),Z=Ii(A.g),ie=Ii(A.b),pe=kn((.4124564*O+.3575761*Z+.1804375*ie)/.95047),xe=kn((.2126729*O+.7151522*Z+.072175*ie)/1);return{l:116*xe-16,a:500*(pe-xe),b:200*(xe-kn((.0193339*O+.119192*Z+.9503041*ie)/1.08883)),alpha:A.a}}function Ia(A){var O=(A.l+16)/116,Z=isNaN(A.a)?O:O+A.a/500,ie=isNaN(A.b)?O:O-A.b/200;return O=1*Qn(O),Z=.95047*Qn(Z),ie=1.08883*Qn(ie),new Jt(Jn(3.2404542*Z-1.5371385*O-.4985314*ie),Jn(-.969266*Z+1.8760108*O+.041556*ie),Jn(.0556434*Z-.2040259*O+1.0572252*ie),A.alpha)}function oo(A,O,Z){var ie=O-A;return A+Z*(ie>180||ie<-180?ie-360*Math.round(ie/360):ie)}var Gi={forward:ha,reverse:Ia,interpolate:function(A,O,Z){return{l:bn(A.l,O.l,Z),a:bn(A.a,O.a,Z),b:bn(A.b,O.b,Z),alpha:bn(A.alpha,O.alpha,Z)}}},Zi={forward:function(A){var O=ha(A),Z=O.l,ie=O.a,pe=O.b,xe=Math.atan2(pe,ie)*Ti;return{h:xe<0?xe+360:xe,c:Math.sqrt(ie*ie+pe*pe),l:Z,alpha:A.a}},reverse:function(A){var O=A.h*ki,Z=A.c;return Ia({l:A.l,a:Math.cos(O)*Z,b:Math.sin(O)*Z,alpha:A.alpha})},interpolate:function(A,O,Z){return{h:oo(A.h,O.h,Z),c:bn(A.c,O.c,Z),l:bn(A.l,O.l,Z),alpha:bn(A.alpha,O.alpha,Z)}}},Ya=Object.freeze({__proto__:null,lab:Gi,hcl:Zi}),Fi=function(A,O,Z,ie,pe){this.type=A,this.operator=O,this.interpolation=Z,this.input=ie,this.labels=[],this.outputs=[];for(var xe=0,Ce=pe;xe<Ce.length;xe+=1){var je=Ce[xe],ut=je[1];this.labels.push(je[0]),this.outputs.push(ut)}};function so(A,O,Z,ie){var pe=ie-Z,xe=A-Z;return 0===pe?0:1===O?xe/pe:(Math.pow(O,xe)-1)/(Math.pow(O,pe)-1)}Fi.interpolationFactor=function(A,O,Z,ie){var pe=0;if("exponential"===A.name)pe=so(O,A.base,Z,ie);else if("linear"===A.name)pe=so(O,1,Z,ie);else if("cubic-bezier"===A.name){var xe=A.controlPoints;pe=new t(xe[0],xe[1],xe[2],xe[3]).solve(so(O,1,Z,ie))}return pe},Fi.parse=function(A,O){var Z=A[0],ie=A[1],pe=A[2],xe=A.slice(3);if(!Array.isArray(ie)||0===ie.length)return O.error("Expected an interpolation type expression.",1);if("linear"===ie[0])ie={name:"linear"};else if("exponential"===ie[0]){var Ce=ie[1];if("number"!=typeof Ce)return O.error("Exponential interpolation requires a numeric base.",1,1);ie={name:"exponential",base:Ce}}else{if("cubic-bezier"!==ie[0])return O.error("Unknown interpolation type "+String(ie[0]),1,0);var je=ie.slice(1);if(4!==je.length||je.some(function(Cr){return"number"!=typeof Cr||Cr<0||Cr>1}))return O.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);ie={name:"cubic-bezier",controlPoints:je}}if(A.length-1<4)return O.error("Expected at least 4 arguments, but found only "+(A.length-1)+".");if((A.length-1)%2!=0)return O.error("Expected an even number of arguments.");if(!(pe=O.parse(pe,2,rt)))return null;var $e=[],ut=null;"interpolate-hcl"===Z||"interpolate-lab"===Z?ut=kt:O.expectedType&&"value"!==O.expectedType.kind&&(ut=O.expectedType);for(var vt=0;vt<xe.length;vt+=2){var zt=xe[vt],Yt=xe[vt+1],qt=vt+3,ar=vt+4;if("number"!=typeof zt)return O.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',qt);if($e.length&&$e[$e.length-1][0]>=zt)return O.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',qt);var yr=O.parse(Yt,ar,ut);if(!yr)return null;ut=ut||yr.type,$e.push([zt,yr])}return"number"===ut.kind||"color"===ut.kind||"array"===ut.kind&&"number"===ut.itemType.kind&&"number"==typeof ut.N?new Fi(ut,Z,ie,pe,$e):O.error("Type "+Ft(ut)+" is not interpolatable.")},Fi.prototype.evaluate=function(A){var O=this.labels,Z=this.outputs;if(1===O.length)return Z[0].evaluate(A);var ie=this.input.evaluate(A);if(ie<=O[0])return Z[0].evaluate(A);var pe=O.length;if(ie>=O[pe-1])return Z[pe-1].evaluate(A);var xe=mn(O,ie),$e=Fi.interpolationFactor(this.interpolation,ie,O[xe],O[xe+1]),ut=Z[xe].evaluate(A),vt=Z[xe+1].evaluate(A);return"interpolate"===this.operator?Sn[this.type.kind.toLowerCase()](ut,vt,$e):"interpolate-hcl"===this.operator?Zi.reverse(Zi.interpolate(Zi.forward(ut),Zi.forward(vt),$e)):Gi.reverse(Gi.interpolate(Gi.forward(ut),Gi.forward(vt),$e))},Fi.prototype.eachChild=function(A){A(this.input);for(var O=0,Z=this.outputs;O<Z.length;O+=1)A(Z[O])},Fi.prototype.outputDefined=function(){return this.outputs.every(function(A){return A.outputDefined()})},Fi.prototype.serialize=function(){var A;A="linear"===this.interpolation.name?["linear"]:"exponential"===this.interpolation.name?1===this.interpolation.base?["linear"]:["exponential",this.interpolation.base]:["cubic-bezier"].concat(this.interpolation.controlPoints);for(var O=[this.operator,A,this.input.serialize()],Z=0;Z<this.labels.length;Z++)O.push(this.labels[Z],this.outputs[Z].serialize());return O};var fo=function(A,O){this.type=A,this.args=O};fo.parse=function(A,O){if(A.length<2)return O.error("Expectected at least one argument.");var Z=null,ie=O.expectedType;ie&&"value"!==ie.kind&&(Z=ie);for(var pe=[],xe=0,Ce=A.slice(1);xe<Ce.length;xe+=1){var $e=O.parse(Ce[xe],1+pe.length,Z,void 0,{typeAnnotation:"omit"});if(!$e)return null;Z=Z||$e.type,pe.push($e)}var ut=ie&&pe.some(function(vt){return jt(ie,vt.type)});return new fo(ut?Ee:Z,pe)},fo.prototype.evaluate=function(A){for(var O,Z=null,ie=0,pe=0,xe=this.args;pe<xe.length&&(ie++,(Z=xe[pe].evaluate(A))&&Z instanceof gr&&!Z.available&&(O||(O=Z.name),Z=null,ie===this.args.length&&(Z=O)),null===Z);pe+=1);return Z},fo.prototype.eachChild=function(A){this.args.forEach(A)},fo.prototype.outputDefined=function(){return this.args.every(function(A){return A.outputDefined()})},fo.prototype.serialize=function(){var A=["coalesce"];return this.eachChild(function(O){A.push(O.serialize())}),A};var ba=function(A,O){this.type=O.type,this.bindings=[].concat(A),this.result=O};ba.prototype.evaluate=function(A){return this.result.evaluate(A)},ba.prototype.eachChild=function(A){for(var O=0,Z=this.bindings;O<Z.length;O+=1)A(Z[O][1]);A(this.result)},ba.parse=function(A,O){if(A.length<4)return O.error("Expected at least 3 arguments, but found "+(A.length-1)+" instead.");for(var Z=[],ie=1;ie<A.length-1;ie+=2){var pe=A[ie];if("string"!=typeof pe)return O.error("Expected string, but found "+typeof pe+" instead.",ie);if(/[^a-zA-Z0-9_]/.test(pe))return O.error("Variable names must contain only alphanumeric characters or '_'.",ie);var xe=O.parse(A[ie+1],ie+1);if(!xe)return null;Z.push([pe,xe])}var Ce=O.parse(A[A.length-1],A.length-1,O.expectedType,Z);return Ce?new ba(Z,Ce):null},ba.prototype.outputDefined=function(){return this.result.outputDefined()},ba.prototype.serialize=function(){for(var A=["let"],O=0,Z=this.bindings;O<Z.length;O+=1){var ie=Z[O];A.push(ie[0],ie[1].serialize())}return A.push(this.result.serialize()),A};var Wa=function(A,O,Z){this.type=A,this.index=O,this.input=Z};Wa.parse=function(A,O){if(3!==A.length)return O.error("Expected 2 arguments, but found "+(A.length-1)+" instead.");var Z=O.parse(A[1],1,rt),ie=O.parse(A[2],2,At(O.expectedType||Ee));return Z&&ie?new Wa(ie.type.itemType,Z,ie):null},Wa.prototype.evaluate=function(A){var O=this.index.evaluate(A),Z=this.input.evaluate(A);if(O<0)throw new $r("Array index out of bounds: "+O+" < 0.");if(O>=Z.length)throw new $r("Array index out of bounds: "+O+" > "+(Z.length-1)+".");if(O!==Math.floor(O))throw new $r("Array index must be an integer, but found "+O+" instead.");return Z[O]},Wa.prototype.eachChild=function(A){A(this.index),A(this.input)},Wa.prototype.outputDefined=function(){return!1},Wa.prototype.serialize=function(){return["at",this.index.serialize(),this.input.serialize()]};var ho=function(A,O){this.type=Rt,this.needle=A,this.haystack=O};ho.parse=function(A,O){if(3!==A.length)return O.error("Expected 2 arguments, but found "+(A.length-1)+" instead.");var Z=O.parse(A[1],1,Ee),ie=O.parse(A[2],2,Ee);return Z&&ie?fr(Z.type,[Rt,ft,rt,Ct,Ee])?new ho(Z,ie):O.error("Expected first argument to be of type boolean, string, number or null, but found "+Ft(Z.type)+" instead"):null},ho.prototype.evaluate=function(A){var O=this.needle.evaluate(A),Z=this.haystack.evaluate(A);if(!Z)return!1;if(!kr(O,["boolean","string","number","null"]))throw new $r("Expected first argument to be of type boolean, string, number or null, but found "+Ft(Nr(O))+" instead.");if(!kr(Z,["string","array"]))throw new $r("Expected second argument to be of type array or string, but found "+Ft(Nr(Z))+" instead.");return Z.indexOf(O)>=0},ho.prototype.eachChild=function(A){A(this.needle),A(this.haystack)},ho.prototype.outputDefined=function(){return!0},ho.prototype.serialize=function(){return["in",this.needle.serialize(),this.haystack.serialize()]};var wo=function(A,O,Z){this.type=rt,this.needle=A,this.haystack=O,this.fromIndex=Z};wo.parse=function(A,O){if(A.length<=2||A.length>=5)return O.error("Expected 3 or 4 arguments, but found "+(A.length-1)+" instead.");var Z=O.parse(A[1],1,Ee),ie=O.parse(A[2],2,Ee);if(!Z||!ie)return null;if(!fr(Z.type,[Rt,ft,rt,Ct,Ee]))return O.error("Expected first argument to be of type boolean, string, number or null, but found "+Ft(Z.type)+" instead");if(4===A.length){var pe=O.parse(A[3],3,rt);return pe?new wo(Z,ie,pe):null}return new wo(Z,ie)},wo.prototype.evaluate=function(A){var O=this.needle.evaluate(A),Z=this.haystack.evaluate(A);if(!kr(O,["boolean","string","number","null"]))throw new $r("Expected first argument to be of type boolean, string, number or null, but found "+Ft(Nr(O))+" instead.");if(!kr(Z,["string","array"]))throw new $r("Expected second argument to be of type array or string, but found "+Ft(Nr(Z))+" instead.");if(this.fromIndex){var ie=this.fromIndex.evaluate(A);return Z.indexOf(O,ie)}return Z.indexOf(O)},wo.prototype.eachChild=function(A){A(this.needle),A(this.haystack),this.fromIndex&&A(this.fromIndex)},wo.prototype.outputDefined=function(){return!1},wo.prototype.serialize=function(){if(null!=this.fromIndex&&void 0!==this.fromIndex){var A=this.fromIndex.serialize();return["index-of",this.needle.serialize(),this.haystack.serialize(),A]}return["index-of",this.needle.serialize(),this.haystack.serialize()]};var Ra=function(A,O,Z,ie,pe,xe){this.inputType=A,this.type=O,this.input=Z,this.cases=ie,this.outputs=pe,this.otherwise=xe};Ra.parse=function(A,O){if(A.length<5)return O.error("Expected at least 4 arguments, but found only "+(A.length-1)+".");if(A.length%2!=1)return O.error("Expected an even number of arguments.");var Z,ie;O.expectedType&&"value"!==O.expectedType.kind&&(ie=O.expectedType);for(var pe={},xe=[],Ce=2;Ce<A.length-1;Ce+=2){var je=A[Ce],$e=A[Ce+1];Array.isArray(je)||(je=[je]);var ut=O.concat(Ce);if(0===je.length)return ut.error("Expected at least one branch label.");for(var vt=0,zt=je;vt<zt.length;vt+=1){var Yt=zt[vt];if("number"!=typeof Yt&&"string"!=typeof Yt)return ut.error("Branch labels must be numbers or strings.");if("number"==typeof Yt&&Math.abs(Yt)>Number.MAX_SAFE_INTEGER)return ut.error("Branch labels must be integers no larger than "+Number.MAX_SAFE_INTEGER+".");if("number"==typeof Yt&&Math.floor(Yt)!==Yt)return ut.error("Numeric branch labels must be integer values.");if(Z){if(ut.checkSubtype(Z,Nr(Yt)))return null}else Z=Nr(Yt);if(void 0!==pe[String(Yt)])return ut.error("Branch labels must be unique.");pe[String(Yt)]=xe.length}var qt=O.parse($e,Ce,ie);if(!qt)return null;ie=ie||qt.type,xe.push(qt)}var ar=O.parse(A[1],1,Ee);if(!ar)return null;var yr=O.parse(A[A.length-1],A.length-1,ie);return yr?"value"!==ar.type.kind&&O.concat(1).checkSubtype(Z,ar.type)?null:new Ra(Z,ie,ar,pe,xe,yr):null},Ra.prototype.evaluate=function(A){var O=this.input.evaluate(A);return(Nr(O)===this.inputType&&this.outputs[this.cases[O]]||this.otherwise).evaluate(A)},Ra.prototype.eachChild=function(A){A(this.input),this.outputs.forEach(A),A(this.otherwise)},Ra.prototype.outputDefined=function(){return this.outputs.every(function(A){return A.outputDefined()})&&this.otherwise.outputDefined()},Ra.prototype.serialize=function(){for(var A=this,O=["match",this.input.serialize()],Z=[],ie={},pe=0,xe=Object.keys(this.cases).sort();pe<xe.length;pe+=1){var Ce=xe[pe];void 0===(zt=ie[this.cases[Ce]])?(ie[this.cases[Ce]]=Z.length,Z.push([this.cases[Ce],[Ce]])):Z[zt][1].push(Ce)}for(var je=function(qt){return"number"===A.inputType.kind?Number(qt):qt},$e=0,ut=Z;$e<ut.length;$e+=1){var vt=ut[$e],zt=vt[0],Yt=vt[1];O.push(1===Yt.length?je(Yt[0]):Yt.map(je)),O.push(this.outputs[outputIndex$1].serialize())}return O.push(this.otherwise.serialize()),O};var pa=function(A,O,Z){this.type=A,this.branches=O,this.otherwise=Z};pa.parse=function(A,O){if(A.length<4)return O.error("Expected at least 3 arguments, but found only "+(A.length-1)+".");if(A.length%2!=0)return O.error("Expected an odd number of arguments.");var Z;O.expectedType&&"value"!==O.expectedType.kind&&(Z=O.expectedType);for(var ie=[],pe=1;pe<A.length-1;pe+=2){var xe=O.parse(A[pe],pe,Rt);if(!xe)return null;var Ce=O.parse(A[pe+1],pe+1,Z);if(!Ce)return null;ie.push([xe,Ce]),Z=Z||Ce.type}var je=O.parse(A[A.length-1],A.length-1,Z);return je?new pa(Z,ie,je):null},pa.prototype.evaluate=function(A){for(var O=0,Z=this.branches;O<Z.length;O+=1){var ie=Z[O],xe=ie[1];if(ie[0].evaluate(A))return xe.evaluate(A)}return this.otherwise.evaluate(A)},pa.prototype.eachChild=function(A){for(var O=0,Z=this.branches;O<Z.length;O+=1){var ie=Z[O],xe=ie[1];A(ie[0]),A(xe)}A(this.otherwise)},pa.prototype.outputDefined=function(){return this.branches.every(function(A){return A[1].outputDefined()})&&this.otherwise.outputDefined()},pa.prototype.serialize=function(){var A=["case"];return this.eachChild(function(O){A.push(O.serialize())}),A};var Ga=function(A,O,Z,ie){this.type=A,this.input=O,this.beginIndex=Z,this.endIndex=ie};function ps(A,O){return"=="===A||"!="===A?"boolean"===O.kind||"string"===O.kind||"number"===O.kind||"null"===O.kind||"value"===O.kind:"string"===O.kind||"number"===O.kind||"value"===O.kind}function vs(A,O,Z,ie){return 0===ie.compare(O,Z)}function Yi(A,O,Z){var ie="=="!==A&&"!="!==A;return function(){function pe(xe,Ce,je){this.type=Rt,this.lhs=xe,this.rhs=Ce,this.collator=je,this.hasUntypedArgument="value"===xe.type.kind||"value"===Ce.type.kind}return pe.parse=function(xe,Ce){if(3!==xe.length&&4!==xe.length)return Ce.error("Expected two or three arguments.");var je=xe[0],$e=Ce.parse(xe[1],1,Ee);if(!$e)return null;if(!ps(je,$e.type))return Ce.concat(1).error('"'+je+"\" comparisons are not supported for type '"+Ft($e.type)+"'.");var ut=Ce.parse(xe[2],2,Ee);if(!ut)return null;if(!ps(je,ut.type))return Ce.concat(2).error('"'+je+"\" comparisons are not supported for type '"+Ft(ut.type)+"'.");if($e.type.kind!==ut.type.kind&&"value"!==$e.type.kind&&"value"!==ut.type.kind)return Ce.error("Cannot compare types '"+Ft($e.type)+"' and '"+Ft(ut.type)+"'.");ie&&("value"===$e.type.kind&&"value"!==ut.type.kind?$e=new gn(ut.type,[$e]):"value"!==$e.type.kind&&"value"===ut.type.kind&&(ut=new gn($e.type,[ut])));var vt=null;if(4===xe.length){if("string"!==$e.type.kind&&"string"!==ut.type.kind&&"value"!==$e.type.kind&&"value"!==ut.type.kind)return Ce.error("Cannot use collator to compare non-string types.");if(!(vt=Ce.parse(xe[3],3,Ye)))return null}return new pe($e,ut,vt)},pe.prototype.evaluate=function(xe){var Ce=this.lhs.evaluate(xe),je=this.rhs.evaluate(xe);if(ie&&this.hasUntypedArgument){var $e=Nr(Ce),ut=Nr(je);if($e.kind!==ut.kind||"string"!==$e.kind&&"number"!==$e.kind)throw new $r('Expected arguments for "'+A+'" to be (string, string) or (number, number), but found ('+$e.kind+", "+ut.kind+") instead.")}if(this.collator&&!ie&&this.hasUntypedArgument){var vt=Nr(Ce),zt=Nr(je);if("string"!==vt.kind||"string"!==zt.kind)return O(xe,Ce,je)}return this.collator?Z(xe,Ce,je,this.collator.evaluate(xe)):O(xe,Ce,je)},pe.prototype.eachChild=function(xe){xe(this.lhs),xe(this.rhs),this.collator&&xe(this.collator)},pe.prototype.outputDefined=function(){return!0},pe.prototype.serialize=function(){var xe=[A];return this.eachChild(function(Ce){xe.push(Ce.serialize())}),xe},pe}()}Ga.parse=function(A,O){if(A.length<=2||A.length>=5)return O.error("Expected 3 or 4 arguments, but found "+(A.length-1)+" instead.");var Z=O.parse(A[1],1,Ee),ie=O.parse(A[2],2,rt);if(!Z||!ie)return null;if(!fr(Z.type,[At(Ee),ft,Ee]))return O.error("Expected first argument to be of type array or string, but found "+Ft(Z.type)+" instead");if(4===A.length){var pe=O.parse(A[3],3,rt);return pe?new Ga(Z.type,Z,ie,pe):null}return new Ga(Z.type,Z,ie)},Ga.prototype.evaluate=function(A){var O=this.input.evaluate(A),Z=this.beginIndex.evaluate(A);if(!kr(O,["string","array"]))throw new $r("Expected first argument to be of type array or string, but found "+Ft(Nr(O))+" instead.");if(this.endIndex){var ie=this.endIndex.evaluate(A);return O.slice(Z,ie)}return O.slice(Z)},Ga.prototype.eachChild=function(A){A(this.input),A(this.beginIndex),this.endIndex&&A(this.endIndex)},Ga.prototype.outputDefined=function(){return!1},Ga.prototype.serialize=function(){if(null!=this.endIndex&&void 0!==this.endIndex){var A=this.endIndex.serialize();return["slice",this.input.serialize(),this.beginIndex.serialize(),A]}return["slice",this.input.serialize(),this.beginIndex.serialize()]};var ss=Yi("==",function(A,O,Z){return O===Z},vs),Wo=Yi("!=",function(A,O,Z){return O!==Z},function(A,O,Z,ie){return!vs(0,O,Z,ie)}),ys=Yi("<",function(A,O,Z){return O<Z},function(A,O,Z,ie){return ie.compare(O,Z)<0}),xs=Yi(">",function(A,O,Z){return O>Z},function(A,O,Z,ie){return ie.compare(O,Z)>0}),ds=Yi("<=",function(A,O,Z){return O<=Z},function(A,O,Z,ie){return ie.compare(O,Z)<=0}),bs=Yi(">=",function(A,O,Z){return O>=Z},function(A,O,Z,ie){return ie.compare(O,Z)>=0}),Ao=function(A,O,Z,ie,pe){this.type=ft,this.number=A,this.locale=O,this.currency=Z,this.minFractionDigits=ie,this.maxFractionDigits=pe};Ao.parse=function(A,O){if(3!==A.length)return O.error("Expected two arguments.");var Z=O.parse(A[1],1,rt);if(!Z)return null;var ie=A[2];if("object"!=typeof ie||Array.isArray(ie))return O.error("NumberFormat options argument must be an object.");var pe=null;if(ie.locale&&!(pe=O.parse(ie.locale,1,ft)))return null;var xe=null;if(ie.currency&&!(xe=O.parse(ie.currency,1,ft)))return null;var Ce=null;if(ie["min-fraction-digits"]&&!(Ce=O.parse(ie["min-fraction-digits"],1,rt)))return null;var je=null;return ie["max-fraction-digits"]&&!(je=O.parse(ie["max-fraction-digits"],1,rt))?null:new Ao(Z,pe,xe,Ce,je)},Ao.prototype.evaluate=function(A){return new Intl.NumberFormat(this.locale?this.locale.evaluate(A):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(A):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(A):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(A):void 0}).format(this.number.evaluate(A))},Ao.prototype.eachChild=function(A){A(this.number),this.locale&&A(this.locale),this.currency&&A(this.currency),this.minFractionDigits&&A(this.minFractionDigits),this.maxFractionDigits&&A(this.maxFractionDigits)},Ao.prototype.outputDefined=function(){return!1},Ao.prototype.serialize=function(){var A={};return this.locale&&(A.locale=this.locale.serialize()),this.currency&&(A.currency=this.currency.serialize()),this.minFractionDigits&&(A["min-fraction-digits"]=this.minFractionDigits.serialize()),this.maxFractionDigits&&(A["max-fraction-digits"]=this.maxFractionDigits.serialize()),["number-format",this.number.serialize(),A]};var Mo=function(A){this.type=rt,this.input=A};Mo.parse=function(A,O){if(2!==A.length)return O.error("Expected 1 argument, but found "+(A.length-1)+" instead.");var Z=O.parse(A[1],1);return Z?"array"!==Z.type.kind&&"string"!==Z.type.kind&&"value"!==Z.type.kind?O.error("Expected argument of type string or array, but found "+Ft(Z.type)+" instead."):new Mo(Z):null},Mo.prototype.evaluate=function(A){var O=this.input.evaluate(A);if("string"==typeof O||Array.isArray(O))return O.length;throw new $r("Expected value to be of type string or array, but found "+Ft(Nr(O))+" instead.")},Mo.prototype.eachChild=function(A){A(this.input)},Mo.prototype.outputDefined=function(){return!1},Mo.prototype.serialize=function(){var A=["length"];return this.eachChild(function(O){A.push(O.serialize())}),A};var Fo={"==":ss,"!=":Wo,">":xs,"<":ys,">=":bs,"<=":ds,array:gn,at:Wa,boolean:gn,case:pa,coalesce:fo,collator:Fn,format:dn,image:An,in:ho,"index-of":wo,interpolate:Fi,"interpolate-hcl":Fi,"interpolate-lab":Fi,length:Mo,let:ba,literal:un,match:Ra,number:gn,"number-format":Ao,object:gn,slice:Ga,step:xn,string:gn,"to-boolean":Rr,"to-color":Rr,"to-number":Rr,"to-string":Rr,var:Qr,within:wr};function Bo(A,O){var Z=O[0],ie=O[1],pe=O[2],xe=O[3];Z=Z.evaluate(A),ie=ie.evaluate(A),pe=pe.evaluate(A);var Ce=xe?xe.evaluate(A):1,je=Tr(Z,ie,pe,Ce);if(je)throw new $r(je);return new Jt(Z/255*Ce,ie/255*Ce,pe/255*Ce,Ce)}function No(A,O){return A in O}function Xo(A,O){var Z=O[A];return void 0===Z?null:Z}function po(A){return{type:A}}function ls(A){return{result:"success",value:A}}function lo(A){return{result:"error",value:A}}function jo(A){return"data-driven"===A["property-type"]||"cross-faded-data-driven"===A["property-type"]}function cs(A){return!!A.expression&&A.expression.parameters.indexOf("zoom")>-1}function So(A){return!!A.expression&&A.expression.interpolated}function qi(A){return A instanceof Number?"number":A instanceof String?"string":A instanceof Boolean?"boolean":Array.isArray(A)?"array":null===A?"null":typeof A}function Ue(A){return"object"==typeof A&&null!==A&&!Array.isArray(A)}function Ze(A){return A}function et(A,O,Z){return void 0!==A?A:void 0!==O?O:void 0!==Z?Z:void 0}function lt(A,O,Z,ie,pe){return et(typeof Z===pe?ie[Z]:void 0,A.default,O.default)}function yt(A,O,Z){if("number"!==qi(Z))return et(A.default,O.default);var ie=A.stops.length;if(1===ie||Z<=A.stops[0][0])return A.stops[0][1];if(Z>=A.stops[ie-1][0])return A.stops[ie-1][1];var pe=mn(A.stops.map(function(xe){return xe[0]}),Z);return A.stops[pe][1]}function gt(A,O,Z){var ie=void 0!==A.base?A.base:1;if("number"!==qi(Z))return et(A.default,O.default);var pe=A.stops.length;if(1===pe||Z<=A.stops[0][0])return A.stops[0][1];if(Z>=A.stops[pe-1][0])return A.stops[pe-1][1];var Yt,qt,yr,Cr,xe=mn(A.stops.map(function(zt){return zt[0]}),Z),Ce=(Yt=ie,Cr=Z-(qt=A.stops[xe][0]),0==(yr=A.stops[xe+1][0]-qt)?0:1===Yt?Cr/yr:(Math.pow(Yt,Cr)-1)/(Math.pow(Yt,yr)-1)),je=A.stops[xe][1],$e=A.stops[xe+1][1],ut=Sn[O.type]||Ze;if(A.colorSpace&&"rgb"!==A.colorSpace){var vt=Ya[A.colorSpace];ut=function(zt,Yt){return vt.reverse(vt.interpolate(vt.forward(zt),vt.forward(Yt),Ce))}}return"function"==typeof je.evaluate?{evaluate:function(){for(var zt=[],Yt=arguments.length;Yt--;)zt[Yt]=arguments[Yt];var qt=je.evaluate.apply(void 0,zt),ar=$e.evaluate.apply(void 0,zt);if(void 0!==qt&&void 0!==ar)return ut(qt,ar,Ce)}}:ut(je,$e,Ce)}function St(A,O,Z){return"color"===O.type?Z=Jt.parse(Z):"formatted"===O.type?Z=cr.fromString(Z.toString()):"resolvedImage"===O.type?Z=gr.fromString(Z.toString()):qi(Z)===O.type||"enum"===O.type&&O.values[Z]||(Z=void 0),et(Z,A.default,O.default)}Hr.register(Fo,{error:[{kind:"error"},[ft],function(A,O){throw new $r(O[0].evaluate(A))}],typeof:[ft,[Ee],function(A,O){return Ft(Nr(O[0].evaluate(A)))}],"to-rgba":[At(rt,4),[kt],function(A,O){return O[0].evaluate(A).toArray()}],rgb:[kt,[rt,rt,rt],Bo],rgba:[kt,[rt,rt,rt,rt],Bo],has:{type:Rt,overloads:[[[ft],function(A,O){return No(O[0].evaluate(A),A.properties())}],[[ft,Lt],function(A,O){var ie=O[1];return No(O[0].evaluate(A),ie.evaluate(A))}]]},get:{type:Ee,overloads:[[[ft],function(A,O){return Xo(O[0].evaluate(A),A.properties())}],[[ft,Lt],function(A,O){var ie=O[1];return Xo(O[0].evaluate(A),ie.evaluate(A))}]]},"feature-state":[Ee,[ft],function(A,O){return Xo(O[0].evaluate(A),A.featureState||{})}],properties:[Lt,[],function(A){return A.properties()}],"geometry-type":[ft,[],function(A){return A.geometryType()}],id:[Ee,[],function(A){return A.id()}],zoom:[rt,[],function(A){return A.globals.zoom}],"heatmap-density":[rt,[],function(A){return A.globals.heatmapDensity||0}],"line-progress":[rt,[],function(A){return A.globals.lineProgress||0}],accumulated:[Ee,[],function(A){return void 0===A.globals.accumulated?null:A.globals.accumulated}],"+":[rt,po(rt),function(A,O){for(var Z=0,ie=0,pe=O;ie<pe.length;ie+=1)Z+=pe[ie].evaluate(A);return Z}],"*":[rt,po(rt),function(A,O){for(var Z=1,ie=0,pe=O;ie<pe.length;ie+=1)Z*=pe[ie].evaluate(A);return Z}],"-":{type:rt,overloads:[[[rt,rt],function(A,O){var ie=O[1];return O[0].evaluate(A)-ie.evaluate(A)}],[[rt],function(A,O){return-O[0].evaluate(A)}]]},"/":[rt,[rt,rt],function(A,O){var ie=O[1];return O[0].evaluate(A)/ie.evaluate(A)}],"%":[rt,[rt,rt],function(A,O){var ie=O[1];return O[0].evaluate(A)%ie.evaluate(A)}],ln2:[rt,[],function(){return Math.LN2}],pi:[rt,[],function(){return Math.PI}],e:[rt,[],function(){return Math.E}],"^":[rt,[rt,rt],function(A,O){var ie=O[1];return Math.pow(O[0].evaluate(A),ie.evaluate(A))}],sqrt:[rt,[rt],function(A,O){return Math.sqrt(O[0].evaluate(A))}],log10:[rt,[rt],function(A,O){return Math.log(O[0].evaluate(A))/Math.LN10}],ln:[rt,[rt],function(A,O){return Math.log(O[0].evaluate(A))}],log2:[rt,[rt],function(A,O){return Math.log(O[0].evaluate(A))/Math.LN2}],sin:[rt,[rt],function(A,O){return Math.sin(O[0].evaluate(A))}],cos:[rt,[rt],function(A,O){return Math.cos(O[0].evaluate(A))}],tan:[rt,[rt],function(A,O){return Math.tan(O[0].evaluate(A))}],asin:[rt,[rt],function(A,O){return Math.asin(O[0].evaluate(A))}],acos:[rt,[rt],function(A,O){return Math.acos(O[0].evaluate(A))}],atan:[rt,[rt],function(A,O){return Math.atan(O[0].evaluate(A))}],min:[rt,po(rt),function(A,O){return Math.min.apply(Math,O.map(function(Z){return Z.evaluate(A)}))}],max:[rt,po(rt),function(A,O){return Math.max.apply(Math,O.map(function(Z){return Z.evaluate(A)}))}],abs:[rt,[rt],function(A,O){return Math.abs(O[0].evaluate(A))}],round:[rt,[rt],function(A,O){var Z=O[0].evaluate(A);return Z<0?-Math.round(-Z):Math.round(Z)}],floor:[rt,[rt],function(A,O){return Math.floor(O[0].evaluate(A))}],ceil:[rt,[rt],function(A,O){return Math.ceil(O[0].evaluate(A))}],"filter-==":[Rt,[ft,Ee],function(A,O){var Z=O[0],ie=O[1];return A.properties()[Z.value]===ie.value}],"filter-id-==":[Rt,[Ee],function(A,O){var Z=O[0];return A.id()===Z.value}],"filter-type-==":[Rt,[ft],function(A,O){var Z=O[0];return A.geometryType()===Z.value}],"filter-<":[Rt,[ft,Ee],function(A,O){var Z=O[0],ie=O[1],pe=A.properties()[Z.value],xe=ie.value;return typeof pe==typeof xe&&pe<xe}],"filter-id-<":[Rt,[Ee],function(A,O){var Z=O[0],ie=A.id(),pe=Z.value;return typeof ie==typeof pe&&ie<pe}],"filter->":[Rt,[ft,Ee],function(A,O){var Z=O[0],ie=O[1],pe=A.properties()[Z.value],xe=ie.value;return typeof pe==typeof xe&&pe>xe}],"filter-id->":[Rt,[Ee],function(A,O){var Z=O[0],ie=A.id(),pe=Z.value;return typeof ie==typeof pe&&ie>pe}],"filter-<=":[Rt,[ft,Ee],function(A,O){var Z=O[0],ie=O[1],pe=A.properties()[Z.value],xe=ie.value;return typeof pe==typeof xe&&pe<=xe}],"filter-id-<=":[Rt,[Ee],function(A,O){var Z=O[0],ie=A.id(),pe=Z.value;return typeof ie==typeof pe&&ie<=pe}],"filter->=":[Rt,[ft,Ee],function(A,O){var Z=O[0],ie=O[1],pe=A.properties()[Z.value],xe=ie.value;return typeof pe==typeof xe&&pe>=xe}],"filter-id->=":[Rt,[Ee],function(A,O){var Z=O[0],ie=A.id(),pe=Z.value;return typeof ie==typeof pe&&ie>=pe}],"filter-has":[Rt,[Ee],function(A,O){return O[0].value in A.properties()}],"filter-has-id":[Rt,[],function(A){return null!==A.id()&&void 0!==A.id()}],"filter-type-in":[Rt,[At(ft)],function(A,O){return O[0].value.indexOf(A.geometryType())>=0}],"filter-id-in":[Rt,[At(Ee)],function(A,O){return O[0].value.indexOf(A.id())>=0}],"filter-in-small":[Rt,[ft,At(Ee)],function(A,O){var Z=O[0];return O[1].value.indexOf(A.properties()[Z.value])>=0}],"filter-in-large":[Rt,[ft,At(Ee)],function(A,O){var Z=O[0],ie=O[1];return function(pe,xe,Ce,je){for(;Ce<=je;){var $e=Ce+je>>1;if(xe[$e]===pe)return!0;xe[$e]>pe?je=$e-1:Ce=$e+1}return!1}(A.properties()[Z.value],ie.value,0,ie.value.length-1)}],all:{type:Rt,overloads:[[[Rt,Rt],function(A,O){var ie=O[1];return O[0].evaluate(A)&&ie.evaluate(A)}],[po(Rt),function(A,O){for(var Z=0,ie=O;Z<ie.length;Z+=1)if(!ie[Z].evaluate(A))return!1;return!0}]]},any:{type:Rt,overloads:[[[Rt,Rt],function(A,O){var ie=O[1];return O[0].evaluate(A)||ie.evaluate(A)}],[po(Rt),function(A,O){for(var Z=0,ie=O;Z<ie.length;Z+=1)if(ie[Z].evaluate(A))return!0;return!1}]]},"!":[Rt,[Rt],function(A,O){return!O[0].evaluate(A)}],"is-supported-script":[Rt,[ft],function(A,O){var ie=A.globals&&A.globals.isSupportedScript;return!ie||ie(O[0].evaluate(A))}],upcase:[ft,[ft],function(A,O){return O[0].evaluate(A).toUpperCase()}],downcase:[ft,[ft],function(A,O){return O[0].evaluate(A).toLowerCase()}],concat:[ft,po(Ee),function(A,O){return O.map(function(Z){return Xr(Z.evaluate(A))}).join("")}],"resolved-locale":[ft,[Ye],function(A,O){return O[0].evaluate(A).resolvedLocale()}]});var Xt=function(A,O){var Z;this.expression=A,this._warningHistory={},this._evaluator=new nn,this._defaultValue=O?"color"===(Z=O).type&&Ue(Z.default)?new Jt(0,0,0,0):"color"===Z.type?Jt.parse(Z.default)||null:void 0===Z.default?null:Z.default:null,this._enumValues=O&&"enum"===O.type?O.values:null};function Kt(A){return Array.isArray(A)&&A.length>0&&"string"==typeof A[0]&&A[0]in Fo}function Zt(A,O){var pe,xe,Z=new en(Fo,[],O?(xe={color:kt,string:ft,number:rt,enum:ft,boolean:Rt,formatted:it,resolvedImage:ht},"array"===(pe=O).type?At(xe[pe.value]||Ee,pe.length):xe[pe.type]):void 0),ie=Z.parse(A,void 0,void 0,void 0,O&&"string"===O.type?{typeAnnotation:"coerce"}:void 0);return ie?ls(new Xt(ie,O)):lo(Z.errors)}Xt.prototype.evaluateWithoutErrorHandling=function(A,O,Z,ie,pe,xe){return this._evaluator.globals=A,this._evaluator.feature=O,this._evaluator.featureState=Z,this._evaluator.canonical=ie,this._evaluator.availableImages=pe||null,this._evaluator.formattedSection=xe,this.expression.evaluate(this._evaluator)},Xt.prototype.evaluate=function(A,O,Z,ie,pe,xe){this._evaluator.globals=A,this._evaluator.feature=O||null,this._evaluator.featureState=Z||null,this._evaluator.canonical=ie,this._evaluator.availableImages=pe||null,this._evaluator.formattedSection=xe||null;try{var Ce=this.expression.evaluate(this._evaluator);if(null==Ce||"number"==typeof Ce&&Ce!=Ce)return this._defaultValue;if(this._enumValues&&!(Ce in this._enumValues))throw new $r("Expected value to be one of "+Object.keys(this._enumValues).map(function(je){return JSON.stringify(je)}).join(", ")+", but found "+JSON.stringify(Ce)+" instead.");return Ce}catch(je){return this._warningHistory[je.message]||(this._warningHistory[je.message]=!0,typeof console<"u"&&console.warn(je.message)),this._defaultValue}};var ir=function(A,O){this.kind=A,this._styleExpression=O,this.isStateDependent="constant"!==A&&!qr(O.expression)};ir.prototype.evaluateWithoutErrorHandling=function(A,O,Z,ie,pe,xe){return this._styleExpression.evaluateWithoutErrorHandling(A,O,Z,ie,pe,xe)},ir.prototype.evaluate=function(A,O,Z,ie,pe,xe){return this._styleExpression.evaluate(A,O,Z,ie,pe,xe)};var pr=function(A,O,Z,ie){this.kind=A,this.zoomStops=Z,this._styleExpression=O,this.isStateDependent="camera"!==A&&!qr(O.expression),this.interpolationType=ie};function br(A,O){if("error"===(A=Zt(A,O)).result)return A;var Z=A.value.expression,ie=Er(Z);if(!ie&&!jo(O))return lo([new ot("","data expressions not supported")]);var pe=Vr(Z,["zoom"]);if(!pe&&!cs(O))return lo([new ot("","zoom expressions not supported")]);var xe=function je($e){var ut=null;if($e instanceof ba)ut=je($e.result);else if($e instanceof fo)for(var vt=0,zt=$e.args;vt<zt.length&&!(ut=je(zt[vt]));vt+=1);else($e instanceof xn||$e instanceof Fi)&&$e.input instanceof Hr&&"zoom"===$e.input.name&&(ut=$e);return ut instanceof ot||$e.eachChild(function(qt){var ar=je(qt);ar instanceof ot?ut=ar:!ut&&ar?ut=new ot("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):ut&&ar&&ut!==ar&&(ut=new ot("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),ut}(Z);return xe||pe?xe instanceof ot?lo([xe]):xe instanceof Fi&&!So(O)?lo([new ot("",'"interpolate" expressions cannot be used with this property')]):ls(xe?new pr(ie?"camera":"composite",A.value,xe.labels,xe instanceof Fi?xe.interpolation:void 0):new ir(ie?"constant":"source",A.value)):lo([new ot("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}pr.prototype.evaluateWithoutErrorHandling=function(A,O,Z,ie,pe,xe){return this._styleExpression.evaluateWithoutErrorHandling(A,O,Z,ie,pe,xe)},pr.prototype.evaluate=function(A,O,Z,ie,pe,xe){return this._styleExpression.evaluate(A,O,Z,ie,pe,xe)},pr.prototype.interpolationFactor=function(A,O,Z){return this.interpolationType?Fi.interpolationFactor(this.interpolationType,A,O,Z):0};var _r=function(A,O){this._parameters=A,this._specification=O,Je(this,function Z(ie,pe){var xe,Ce,je,$e="color"===pe.type,ut=ie.stops&&"object"==typeof ie.stops[0][0],zt=ut||!(ut||void 0!==ie.property),Yt=ie.type||(So(pe)?"exponential":"interval");if($e&&((ie=Je({},ie)).stops&&(ie.stops=ie.stops.map(function(oi){return[oi[0],Jt.parse(oi[1])]})),ie.default=Jt.parse(ie.default?ie.default:pe.default)),ie.colorSpace&&"rgb"!==ie.colorSpace&&!Ya[ie.colorSpace])throw new Error("Unknown color space: "+ie.colorSpace);if("exponential"===Yt)xe=gt;else if("interval"===Yt)xe=yt;else if("categorical"===Yt){xe=lt,Ce=Object.create(null);for(var qt=0,ar=ie.stops;qt<ar.length;qt+=1){var yr=ar[qt];Ce[yr[0]]=yr[1]}je=typeof ie.stops[0][0]}else{if("identity"!==Yt)throw new Error('Unknown function type "'+Yt+'"');xe=St}if(ut){for(var Cr={},Lr=[],jr=0;jr<ie.stops.length;jr++){var Ur=ie.stops[jr],Zr=Ur[0].zoom;void 0===Cr[Zr]&&(Cr[Zr]={zoom:Zr,type:ie.type,property:ie.property,default:ie.default,stops:[]},Lr.push(Zr)),Cr[Zr].stops.push([Ur[0].value,Ur[1]])}for(var ln=[],yn=0,Bn=Lr;yn<Bn.length;yn+=1){var Rn=Bn[yn];ln.push([Cr[Rn].zoom,Z(Cr[Rn],pe)])}var Gn={name:"linear"};return{kind:"composite",interpolationType:Gn,interpolationFactor:Fi.interpolationFactor.bind(void 0,Gn),zoomStops:ln.map(function(oi){return oi[0]}),evaluate:function(oi,Kn){var pi=oi.zoom;return gt({stops:ln,base:ie.base},pe,pi).evaluate(pi,Kn)}}}if(zt){var ai="exponential"===Yt?{name:"exponential",base:void 0!==ie.base?ie.base:1}:null;return{kind:"camera",interpolationType:ai,interpolationFactor:Fi.interpolationFactor.bind(void 0,ai),zoomStops:ie.stops.map(function(oi){return oi[0]}),evaluate:function(oi){return xe(ie,pe,oi.zoom,Ce,je)}}}return{kind:"source",evaluate:function(oi,Kn){var pi=Kn&&Kn.properties?Kn.properties[ie.property]:void 0;return void 0===pi?et(ie.default,pe.default):xe(ie,pe,pi,Ce,je)}}}(this._parameters,this._specification))};function Or(A){var O=A.key,Z=A.value,ie=A.valueSpec||{},pe=A.objectElementValidators||{},xe=A.style,Ce=A.styleSpec,je=[],$e=qi(Z);if("object"!==$e)return[new Be(O,Z,"object expected, "+$e+" found")];for(var ut in Z){var vt=ut.split(".")[0],zt=ie[vt]||ie["*"],Yt=void 0;if(pe[vt])Yt=pe[vt];else if(ie[vt])Yt=sr;else if(pe["*"])Yt=pe["*"];else{if(!ie["*"]){je.push(new Be(O,Z[ut],'unknown property "'+ut+'"'));continue}Yt=sr}je=je.concat(Yt({key:(O&&O+".")+ut,value:Z[ut],valueSpec:zt,style:xe,styleSpec:Ce,object:Z,objectKey:ut},Z))}for(var qt in ie)pe[qt]||ie[qt].required&&void 0===ie[qt].default&&void 0===Z[qt]&&je.push(new Be(O,Z,'missing required property "'+qt+'"'));return je}function tn(A){var O=A.value,Z=A.valueSpec,ie=A.style,pe=A.styleSpec,xe=A.key,Ce=A.arrayElementValidator||sr;if("array"!==qi(O))return[new Be(xe,O,"array expected, "+qi(O)+" found")];if(Z.length&&O.length!==Z.length)return[new Be(xe,O,"array length "+Z.length+" expected, length "+O.length+" found")];if(Z["min-length"]&&O.length<Z["min-length"])return[new Be(xe,O,"array length at least "+Z["min-length"]+" expected, length "+O.length+" found")];var je={type:Z.value,values:Z.values};pe.$version<7&&(je.function=Z.function),"object"===qi(Z.value)&&(je=Z.value);for(var $e=[],ut=0;ut<O.length;ut++)$e=$e.concat(Ce({array:O,arrayIndex:ut,value:O[ut],valueSpec:je,style:ie,styleSpec:pe,key:xe+"["+ut+"]"}));return $e}function fn(A){var O=A.key,Z=A.value,ie=A.valueSpec,pe=qi(Z);return"number"===pe&&Z!=Z&&(pe="NaN"),"number"!==pe?[new Be(O,Z,"number expected, "+pe+" found")]:"minimum"in ie&&Z<ie.minimum?[new Be(O,Z,Z+" is less than the minimum value "+ie.minimum)]:"maximum"in ie&&Z>ie.maximum?[new Be(O,Z,Z+" is greater than the maximum value "+ie.maximum)]:[]}function En(A){var O,Z,ie,pe=A.valueSpec,xe=He(A.value.type),Ce={},je="categorical"!==xe&&void 0===A.value.property,$e=!je,ut="array"===qi(A.value.stops)&&"array"===qi(A.value.stops[0])&&"object"===qi(A.value.stops[0][0]),vt=Or({key:A.key,value:A.value,valueSpec:A.styleSpec.function,style:A.style,styleSpec:A.styleSpec,objectElementValidators:{stops:function(qt){if("identity"===xe)return[new Be(qt.key,qt.value,'identity function may not have a "stops" property')];var ar=[],yr=qt.value;return ar=ar.concat(tn({key:qt.key,value:yr,valueSpec:qt.valueSpec,style:qt.style,styleSpec:qt.styleSpec,arrayElementValidator:zt})),"array"===qi(yr)&&0===yr.length&&ar.push(new Be(qt.key,yr,"array must have at least one stop")),ar},default:function(qt){return sr({key:qt.key,value:qt.value,valueSpec:pe,style:qt.style,styleSpec:qt.styleSpec})}}});return"identity"===xe&&je&&vt.push(new Be(A.key,A.value,'missing required property "property"')),"identity"===xe||A.value.stops||vt.push(new Be(A.key,A.value,'missing required property "stops"')),"exponential"===xe&&A.valueSpec.expression&&!So(A.valueSpec)&&vt.push(new Be(A.key,A.value,"exponential functions not supported")),A.styleSpec.$version>=8&&($e&&!jo(A.valueSpec)?vt.push(new Be(A.key,A.value,"property functions not supported")):je&&!cs(A.valueSpec)&&vt.push(new Be(A.key,A.value,"zoom functions not supported"))),"categorical"!==xe&&!ut||void 0!==A.value.property||vt.push(new Be(A.key,A.value,'"property" property is required')),vt;function zt(qt){var ar=[],yr=qt.value,Cr=qt.key;if("array"!==qi(yr))return[new Be(Cr,yr,"array expected, "+qi(yr)+" found")];if(2!==yr.length)return[new Be(Cr,yr,"array length 2 expected, length "+yr.length+" found")];if(ut){if("object"!==qi(yr[0]))return[new Be(Cr,yr,"object expected, "+qi(yr[0])+" found")];if(void 0===yr[0].zoom)return[new Be(Cr,yr,"object stop key must have zoom")];if(void 0===yr[0].value)return[new Be(Cr,yr,"object stop key must have value")];if(ie&&ie>He(yr[0].zoom))return[new Be(Cr,yr[0].zoom,"stop zoom values must appear in ascending order")];He(yr[0].zoom)!==ie&&(ie=He(yr[0].zoom),Z=void 0,Ce={}),ar=ar.concat(Or({key:Cr+"[0]",value:yr[0],valueSpec:{zoom:{}},style:qt.style,styleSpec:qt.styleSpec,objectElementValidators:{zoom:fn,value:Yt}}))}else ar=ar.concat(Yt({key:Cr+"[0]",value:yr[0],valueSpec:{},style:qt.style,styleSpec:qt.styleSpec},yr));return Kt(st(yr[1]))?ar.concat([new Be(Cr+"[1]",yr[1],"expressions are not allowed in function stops.")]):ar.concat(sr({key:Cr+"[1]",value:yr[1],valueSpec:pe,style:qt.style,styleSpec:qt.styleSpec}))}function Yt(qt,ar){var yr=qi(qt.value),Cr=He(qt.value),Lr=null!==qt.value?qt.value:ar;if(O){if(yr!==O)return[new Be(qt.key,Lr,yr+" stop domain type must match previous stop domain type "+O)]}else O=yr;if("number"!==yr&&"string"!==yr&&"boolean"!==yr)return[new Be(qt.key,Lr,"stop domain value must be a number, string, or boolean")];if("number"!==yr&&"categorical"!==xe){var jr="number expected, "+yr+" found";return jo(pe)&&void 0===xe&&(jr+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new Be(qt.key,Lr,jr)]}return"categorical"!==xe||"number"!==yr||isFinite(Cr)&&Math.floor(Cr)===Cr?"categorical"!==xe&&"number"===yr&&void 0!==Z&&Cr<Z?[new Be(qt.key,Lr,"stop domain values must appear in ascending order")]:(Z=Cr,"categorical"===xe&&Cr in Ce?[new Be(qt.key,Lr,"stop domain values must be unique")]:(Ce[Cr]=!0,[])):[new Be(qt.key,Lr,"integer expected, found "+Cr)]}}function On(A){var O=("property"===A.expressionContext?br:Zt)(st(A.value),A.valueSpec);if("error"===O.result)return O.value.map(function(ie){return new Be(""+A.key+ie.key,A.value,ie.message)});var Z=O.value.expression||O.value._styleExpression.expression;if("property"===A.expressionContext&&"text-font"===A.propertyKey&&!Z.outputDefined())return[new Be(A.key,A.value,'Invalid data expression for "'+A.propertyKey+'". Output values must be contained as literals within the expression.')];if("property"===A.expressionContext&&"layout"===A.propertyType&&!qr(Z))return[new Be(A.key,A.value,'"feature-state" data expressions are not supported with layout properties.')];if("filter"===A.expressionContext&&!qr(Z))return[new Be(A.key,A.value,'"feature-state" data expressions are not supported with filters.')];if(A.expressionContext&&0===A.expressionContext.indexOf("cluster")){if(!Vr(Z,["zoom","feature-state"]))return[new Be(A.key,A.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if("cluster-initial"===A.expressionContext&&!Er(Z))return[new Be(A.key,A.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function qn(A){var O=A.key,Z=A.value,ie=A.valueSpec,pe=[];return Array.isArray(ie.values)?-1===ie.values.indexOf(He(Z))&&pe.push(new Be(O,Z,"expected one of ["+ie.values.join(", ")+"], "+JSON.stringify(Z)+" found")):-1===Object.keys(ie.values).indexOf(He(Z))&&pe.push(new Be(O,Z,"expected one of ["+Object.keys(ie.values).join(", ")+"], "+JSON.stringify(Z)+" found")),pe}function Dn(A){if(!0===A||!1===A)return!0;if(!Array.isArray(A)||0===A.length)return!1;switch(A[0]){case"has":return A.length>=2&&"$id"!==A[1]&&"$type"!==A[1];case"in":return A.length>=3&&("string"!=typeof A[1]||Array.isArray(A[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return 3!==A.length||Array.isArray(A[1])||Array.isArray(A[2]);case"any":case"all":for(var O=0,Z=A.slice(1);O<Z.length;O+=1){var ie=Z[O];if(!Dn(ie)&&"boolean"!=typeof ie)return!1}return!0;default:return!0}}_r.deserialize=function(A){return new _r(A._parameters,A._specification)},_r.serialize=function(A){return{_parameters:A._parameters,_specification:A._specification}};var gi={type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}};function Ai(A){if(null==A)return{filter:function(){return!0},needGeometry:!1};Dn(A)||(A=Bi(A));var O=Zt(A,gi);if("error"===O.result)throw new Error(O.value.map(function(Z){return Z.key+": "+Z.message}).join(", "));return{filter:function(Z,ie,pe){return O.value.evaluate(Z,ie,{},pe)},needGeometry:function Z(ie){if(!Array.isArray(ie))return!1;if("within"===ie[0])return!0;for(var pe=1;pe<ie.length;pe++)if(Z(ie[pe]))return!0;return!1}(A)}}function Ni(A,O){return A<O?-1:A>O?1:0}function Bi(A){if(!A)return!0;var O,Z=A[0];return A.length<=1?"any"!==Z:"=="===Z?ji(A[1],A[2],"=="):"!="===Z?aa(ji(A[1],A[2],"==")):"<"===Z||">"===Z||"<="===Z||">="===Z?ji(A[1],A[2],Z):"any"===Z?(O=A.slice(1),["any"].concat(O.map(Bi))):"all"===Z?["all"].concat(A.slice(1).map(Bi)):"none"===Z?["all"].concat(A.slice(1).map(Bi).map(aa)):"in"===Z?_a(A[1],A.slice(2)):"!in"===Z?aa(_a(A[1],A.slice(2))):"has"===Z?ya(A[1]):"!has"===Z?aa(ya(A[1])):"within"!==Z||A}function ji(A,O,Z){switch(A){case"$type":return["filter-type-"+Z,O];case"$id":return["filter-id-"+Z,O];default:return["filter-"+Z,A,O]}}function _a(A,O){if(0===O.length)return!1;switch(A){case"$type":return["filter-type-in",["literal",O]];case"$id":return["filter-id-in",["literal",O]];default:return O.length>200&&!O.some(function(Z){return typeof Z!=typeof O[0]})?["filter-in-large",A,["literal",O.sort(Ni)]]:["filter-in-small",A,["literal",O]]}}function ya(A){switch(A){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",A]}}function aa(A){return["!",A]}function oa(A){return Dn(st(A.value))?On(Je({},A,{expressionContext:"filter",valueSpec:{value:"boolean"}})):function O(Z){var ie=Z.value,pe=Z.key;if("array"!==qi(ie))return[new Be(pe,ie,"array expected, "+qi(ie)+" found")];var xe,Ce=Z.styleSpec,je=[];if(ie.length<1)return[new Be(pe,ie,"filter array must have at least 1 element")];switch(je=je.concat(qn({key:pe+"[0]",value:ie[0],valueSpec:Ce.filter_operator,style:Z.style,styleSpec:Z.styleSpec})),He(ie[0])){case"<":case"<=":case">":case">=":ie.length>=2&&"$type"===He(ie[1])&&je.push(new Be(pe,ie,'"$type" cannot be use with operator "'+ie[0]+'"'));case"==":case"!=":3!==ie.length&&je.push(new Be(pe,ie,'filter array for operator "'+ie[0]+'" must have 3 elements'));case"in":case"!in":ie.length>=2&&"string"!==(xe=qi(ie[1]))&&je.push(new Be(pe+"[1]",ie[1],"string expected, "+xe+" found"));for(var $e=2;$e<ie.length;$e++)xe=qi(ie[$e]),"$type"===He(ie[1])?je=je.concat(qn({key:pe+"["+$e+"]",value:ie[$e],valueSpec:Ce.geometry_type,style:Z.style,styleSpec:Z.styleSpec})):"string"!==xe&&"number"!==xe&&"boolean"!==xe&&je.push(new Be(pe+"["+$e+"]",ie[$e],"string, number, or boolean expected, "+xe+" found"));break;case"any":case"all":case"none":for(var ut=1;ut<ie.length;ut++)je=je.concat(O({key:pe+"["+ut+"]",value:ie[ut],style:Z.style,styleSpec:Z.styleSpec}));break;case"has":case"!has":xe=qi(ie[1]),2!==ie.length?je.push(new Be(pe,ie,'filter array for "'+ie[0]+'" operator must have 2 elements')):"string"!==xe&&je.push(new Be(pe+"[1]",ie[1],"string expected, "+xe+" found"));break;case"within":xe=qi(ie[1]),2!==ie.length?je.push(new Be(pe,ie,'filter array for "'+ie[0]+'" operator must have 2 elements')):"object"!==xe&&je.push(new Be(pe+"[1]",ie[1],"object expected, "+xe+" found"))}return je}(A)}function xa(A,O){var Z=A.key,ie=A.style,pe=A.styleSpec,xe=A.value,Ce=A.objectKey,je=pe[O+"_"+A.layerType];if(!je)return[];var $e=Ce.match(/^(.*)-transition$/);if("paint"===O&&$e&&je[$e[1]]&&je[$e[1]].transition)return sr({key:Z,value:xe,valueSpec:pe.transition,style:ie,styleSpec:pe});var ut,vt=A.valueSpec||je[Ce];if(!vt)return[new Be(Z,xe,'unknown property "'+Ce+'"')];if("string"===qi(xe)&&jo(vt)&&!vt.tokens&&(ut=/^{([^}]+)}$/.exec(xe)))return[new Be(Z,xe,'"'+Ce+'" does not support interpolation syntax\nUse an identity property function instead: `{ "type": "identity", "property": '+JSON.stringify(ut[1])+" }`.")];var zt=[];return"symbol"===A.layerType&&("text-field"===Ce&&ie&&!ie.glyphs&&zt.push(new Be(Z,xe,'use of "text-field" requires a style "glyphs" property')),"text-font"===Ce&&Ue(st(xe))&&"identity"===He(xe.type)&&zt.push(new Be(Z,xe,'"text-font" does not support identity functions'))),zt.concat(sr({key:A.key,value:xe,valueSpec:vt,style:ie,styleSpec:pe,expressionContext:"property",propertyType:O,propertyKey:Ce}))}function Fa(A){return xa(A,"paint")}function Xa(A){return xa(A,"layout")}function Ja(A){var O=[],Z=A.value,ie=A.key,pe=A.style,xe=A.styleSpec;Z.type||Z.ref||O.push(new Be(ie,Z,'either "type" or "ref" is required'));var Ce,je=He(Z.type),$e=He(Z.ref);if(Z.id)for(var ut=He(Z.id),vt=0;vt<A.arrayIndex;vt++){var zt=pe.layers[vt];He(zt.id)===ut&&O.push(new Be(ie,Z.id,'duplicate layer id "'+Z.id+'", previously used at line '+zt.id.__line__))}if("ref"in Z)["type","source","source-layer","filter","layout"].forEach(function(ar){ar in Z&&O.push(new Be(ie,Z[ar],'"'+ar+'" is prohibited for ref layers'))}),pe.layers.forEach(function(ar){He(ar.id)===$e&&(Ce=ar)}),Ce?Ce.ref?O.push(new Be(ie,Z.ref,"ref cannot reference another ref layer")):je=He(Ce.type):O.push(new Be(ie,Z.ref,'ref layer "'+$e+'" not found'));else if("background"!==je)if(Z.source){var Yt=pe.sources&&pe.sources[Z.source],qt=Yt&&He(Yt.type);Yt?"vector"===qt&&"raster"===je?O.push(new Be(ie,Z.source,'layer "'+Z.id+'" requires a raster source')):"raster"===qt&&"raster"!==je?O.push(new Be(ie,Z.source,'layer "'+Z.id+'" requires a vector source')):"vector"!==qt||Z["source-layer"]?"raster-dem"===qt&&"hillshade"!==je?O.push(new Be(ie,Z.source,"raster-dem source can only be used with layer type 'hillshade'.")):"line"!==je||!Z.paint||!Z.paint["line-gradient"]||"geojson"===qt&&Yt.lineMetrics||O.push(new Be(ie,Z,'layer "'+Z.id+'" specifies a line-gradient, which requires a GeoJSON source with `lineMetrics` enabled.')):O.push(new Be(ie,Z,'layer "'+Z.id+'" must specify a "source-layer"')):O.push(new Be(ie,Z.source,'source "'+Z.source+'" not found'))}else O.push(new Be(ie,Z,'missing required property "source"'));return O=O.concat(Or({key:ie,value:Z,valueSpec:xe.layer,style:A.style,styleSpec:A.styleSpec,objectElementValidators:{"*":function(){return[]},type:function(){return sr({key:ie+".type",value:Z.type,valueSpec:xe.layer.type,style:A.style,styleSpec:A.styleSpec,object:Z,objectKey:"type"})},filter:oa,layout:function(ar){return Or({layer:Z,key:ar.key,value:ar.value,style:ar.style,styleSpec:ar.styleSpec,objectElementValidators:{"*":function(yr){return Xa(Je({layerType:je},yr))}}})},paint:function(ar){return Or({layer:Z,key:ar.key,value:ar.value,style:ar.style,styleSpec:ar.styleSpec,objectElementValidators:{"*":function(yr){return Fa(Je({layerType:je},yr))}}})}}}))}function Ka(A){var O=A.value,Z=A.key,ie=qi(O);return"string"!==ie?[new Be(Z,O,"string expected, "+ie+" found")]:[]}var Qa={promoteId:function(A){var O=A.key,Z=A.value;if("string"===qi(Z))return Ka({key:O,value:Z});var ie=[];for(var pe in Z)ie.push.apply(ie,Ka({key:O+"."+pe,value:Z[pe]}));return ie}};function Oi(A){var O=A.value,Z=A.key,ie=A.styleSpec,pe=A.style;if(!O.type)return[new Be(Z,O,'"type" is required')];var xe,Ce=He(O.type);switch(Ce){case"vector":case"raster":case"raster-dem":return Or({key:Z,value:O,valueSpec:ie["source_"+Ce.replace("-","_")],style:A.style,styleSpec:ie,objectElementValidators:Qa});case"geojson":if(xe=Or({key:Z,value:O,valueSpec:ie.source_geojson,style:pe,styleSpec:ie,objectElementValidators:Qa}),O.cluster)for(var je in O.clusterProperties){var $e=O.clusterProperties[je],ut=$e[0],zt="string"==typeof ut?[ut,["accumulated"],["get",je]]:ut;xe.push.apply(xe,On({key:Z+"."+je+".map",value:$e[1],expressionContext:"cluster-map"})),xe.push.apply(xe,On({key:Z+"."+je+".reduce",value:zt,expressionContext:"cluster-reduce"}))}return xe;case"video":return Or({key:Z,value:O,valueSpec:ie.source_video,style:pe,styleSpec:ie});case"image":return Or({key:Z,value:O,valueSpec:ie.source_image,style:pe,styleSpec:ie});case"canvas":return[new Be(Z,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return qn({key:Z+".type",value:O.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]},style:pe,styleSpec:ie})}}function pt(A){var O=A.value,Z=A.styleSpec,ie=Z.light,pe=A.style,xe=[],Ce=qi(O);if(void 0===O)return xe;if("object"!==Ce)return xe.concat([new Be("light",O,"object expected, "+Ce+" found")]);for(var je in O){var $e=je.match(/^(.*)-transition$/);xe=xe.concat($e&&ie[$e[1]]&&ie[$e[1]].transition?sr({key:je,value:O[je],valueSpec:Z.transition,style:pe,styleSpec:Z}):ie[je]?sr({key:je,value:O[je],valueSpec:ie[je],style:pe,styleSpec:Z}):[new Be(je,O[je],'unknown property "'+je+'"')])}return xe}var Ot={"*":function(){return[]},array:tn,boolean:function(A){var O=A.value,Z=A.key,ie=qi(O);return"boolean"!==ie?[new Be(Z,O,"boolean expected, "+ie+" found")]:[]},number:fn,color:function(A){var O=A.key,Z=A.value,ie=qi(Z);return"string"!==ie?[new Be(O,Z,"color expected, "+ie+" found")]:null===ur(Z)?[new Be(O,Z,'color expected, "'+Z+'" found')]:[]},constants:Ge,enum:qn,filter:oa,function:En,layer:Ja,object:Or,source:Oi,light:pt,string:Ka,formatted:function(A){return 0===Ka(A).length?[]:On(A)},resolvedImage:function(A){return 0===Ka(A).length?[]:On(A)}};function sr(A){var O=A.value,Z=A.valueSpec,ie=A.styleSpec;return Z.expression&&Ue(He(O))?En(A):Z.expression&&Kt(st(O))?On(A):Z.type&&Ot[Z.type]?Ot[Z.type](A):Or(Je({},A,{valueSpec:Z.type?ie[Z.type]:Z}))}function Vt(A){var O=A.value,Z=A.key,ie=Ka(A);return ie.length||(-1===O.indexOf("{fontstack}")&&ie.push(new Be(Z,O,'"glyphs" url must include a "{fontstack}" token')),-1===O.indexOf("{range}")&&ie.push(new Be(Z,O,'"glyphs" url must include a "{range}" token'))),ie}function lr(A,O){void 0===O&&(O=ye);var Z=[];return Z=Z.concat(sr({key:"",value:A,valueSpec:O.$root,styleSpec:O,style:A,objectElementValidators:{glyphs:Vt,"*":function(){return[]}}})),A.constants&&(Z=Z.concat(Ge({key:"constants",value:A.constants,style:A,styleSpec:O}))),Pr(Z)}function Pr(A){return[].concat(A).sort(function(O,Z){return O.line-Z.line})}function Br(A){return function(){for(var O=[],Z=arguments.length;Z--;)O[Z]=arguments[Z];return Pr(A.apply(this,O))}}lr.source=Br(Oi),lr.light=Br(pt),lr.layer=Br(Ja),lr.filter=Br(oa),lr.paintProperty=Br(Fa),lr.layoutProperty=Br(Xa);var Yr=lr,on=Yr.light,rn=Yr.paintProperty,pn=Yr.layoutProperty;function _n(A,O){var Z=!1;if(O&&O.length)for(var ie=0,pe=O;ie<pe.length;ie+=1)A.fire(new We(new Error(pe[ie].message))),Z=!0;return Z}var sn=wn;function wn(A,O,Z){var ie=this.cells=[];if(A instanceof ArrayBuffer){this.arrayBuffer=A;var pe=new Int32Array(this.arrayBuffer);A=pe[0],this.d=(O=pe[1])+2*(Z=pe[2]);for(var xe=0;xe<this.d*this.d;xe++){var Ce=pe[3+xe],je=pe[3+xe+1];ie.push(Ce===je?null:pe.subarray(Ce,je))}var ut=pe[3+ie.length+1];this.keys=pe.subarray(pe[3+ie.length],ut),this.bboxes=pe.subarray(ut),this.insert=this._insertReadonly}else{this.d=O+2*Z;for(var vt=0;vt<this.d*this.d;vt++)ie.push([]);this.keys=[],this.bboxes=[]}this.n=O,this.extent=A,this.padding=Z,this.scale=O/A,this.uid=0;var zt=Z/O*A;this.min=-zt,this.max=A+zt}wn.prototype.insert=function(A,O,Z,ie,pe){this._forEachCell(O,Z,ie,pe,this._insertCell,this.uid++),this.keys.push(A),this.bboxes.push(O),this.bboxes.push(Z),this.bboxes.push(ie),this.bboxes.push(pe)},wn.prototype._insertReadonly=function(){throw"Cannot insert into a GridIndex created from an ArrayBuffer."},wn.prototype._insertCell=function(A,O,Z,ie,pe,xe){this.cells[pe].push(xe)},wn.prototype.query=function(A,O,Z,ie,pe){var xe=this.min,Ce=this.max;if(A<=xe&&O<=xe&&Ce<=Z&&Ce<=ie&&!pe)return Array.prototype.slice.call(this.keys);var je=[];return this._forEachCell(A,O,Z,ie,this._queryCell,je,{},pe),je},wn.prototype._queryCell=function(A,O,Z,ie,pe,xe,Ce,je){var $e=this.cells[pe];if(null!==$e)for(var ut=this.keys,vt=this.bboxes,zt=0;zt<$e.length;zt++){var Yt=$e[zt];if(void 0===Ce[Yt]){var qt=4*Yt;(je?je(vt[qt+0],vt[qt+1],vt[qt+2],vt[qt+3]):A<=vt[qt+2]&&O<=vt[qt+3]&&Z>=vt[qt+0]&&ie>=vt[qt+1])?(Ce[Yt]=!0,xe.push(ut[Yt])):Ce[Yt]=!1}}},wn.prototype._forEachCell=function(A,O,Z,ie,pe,xe,Ce,je){for(var $e=this._convertToCellCoord(A),ut=this._convertToCellCoord(O),vt=this._convertToCellCoord(Z),zt=this._convertToCellCoord(ie),Yt=$e;Yt<=vt;Yt++)for(var qt=ut;qt<=zt;qt++){var ar=this.d*qt+Yt;if((!je||je(this._convertFromCellCoord(Yt),this._convertFromCellCoord(qt),this._convertFromCellCoord(Yt+1),this._convertFromCellCoord(qt+1)))&&pe.call(this,A,O,Z,ie,ar,xe,Ce,je))return}},wn.prototype._convertFromCellCoord=function(A){return(A-this.padding)/this.scale},wn.prototype._convertToCellCoord=function(A){return Math.max(0,Math.min(this.d-1,Math.floor(A*this.scale)+this.padding))},wn.prototype.toArrayBuffer=function(){if(this.arrayBuffer)return this.arrayBuffer;for(var A=this.cells,O=3+this.cells.length+1+1,Z=0,ie=0;ie<this.cells.length;ie++)Z+=this.cells[ie].length;var pe=new Int32Array(O+Z+this.keys.length+this.bboxes.length);pe[0]=this.extent,pe[1]=this.n,pe[2]=this.padding;for(var xe=O,Ce=0;Ce<A.length;Ce++){var je=A[Ce];pe[3+Ce]=xe,pe.set(je,xe),xe+=je.length}return pe[3+A.length]=xe,pe.set(this.keys,xe),pe[3+A.length+1]=xe+=this.keys.length,pe.set(this.bboxes,xe),xe+=this.bboxes.length,pe.buffer};var zn=self.ImageData,Vn=self.ImageBitmap,ii={};function Wr(A,O,Z){void 0===Z&&(Z={}),Object.defineProperty(O,"_classRegistryKey",{value:A,writeable:!1}),ii[A]={klass:O,omit:Z.omit||[],shallow:Z.shallow||[]}}for(var ti in Wr("Object",Object),sn.serialize=function(A,O){var Z=A.toArrayBuffer();return O&&O.push(Z),{buffer:Z}},sn.deserialize=function(A){return new sn(A.buffer)},Wr("Grid",sn),Wr("Color",Jt),Wr("Error",Error),Wr("ResolvedImage",gr),Wr("StylePropertyFunction",_r),Wr("StyleExpression",Xt,{omit:["_evaluator"]}),Wr("ZoomDependentExpression",pr),Wr("ZoomConstantExpression",ir),Wr("CompoundExpression",Hr,{omit:["_evaluate"]}),Fo)Fo[ti]._classRegistryKey||Wr("Expression_"+ti,Fo[ti]);function Ln(A){return A&&typeof ArrayBuffer<"u"&&(A instanceof ArrayBuffer||A.constructor&&"ArrayBuffer"===A.constructor.name)}function Nn(A){return Vn&&A instanceof Vn}function ei(A,O){if(null==A||"boolean"==typeof A||"number"==typeof A||"string"==typeof A||A instanceof Boolean||A instanceof Number||A instanceof String||A instanceof Date||A instanceof RegExp)return A;if(Ln(A)||Nn(A))return O&&O.push(A),A;if(ArrayBuffer.isView(A)){var Z=A;return O&&O.push(Z.buffer),Z}if(A instanceof zn)return O&&O.push(A.data.buffer),A;if(Array.isArray(A)){for(var ie=[],pe=0,xe=A;pe<xe.length;pe+=1)ie.push(ei(xe[pe],O));return ie}if("object"==typeof A){var je=A.constructor,$e=je._classRegistryKey;if(!$e)throw new Error("can't serialize object of unregistered class");var ut=je.serialize?je.serialize(A,O):{};if(!je.serialize){for(var vt in A)if(A.hasOwnProperty(vt)&&!(ii[$e].omit.indexOf(vt)>=0)){var zt=A[vt];ut[vt]=ii[$e].shallow.indexOf(vt)>=0?zt:ei(zt,O)}A instanceof Error&&(ut.message=A.message)}if(ut.$name)throw new Error("$name property is reserved for worker serialization logic.");return"Object"!==$e&&(ut.$name=$e),ut}throw new Error("can't serialize object of type "+typeof A)}function wi(A){if(null==A||"boolean"==typeof A||"number"==typeof A||"string"==typeof A||A instanceof Boolean||A instanceof Number||A instanceof String||A instanceof Date||A instanceof RegExp||Ln(A)||Nn(A)||ArrayBuffer.isView(A)||A instanceof zn)return A;if(Array.isArray(A))return A.map(wi);if("object"==typeof A){var O=A.$name||"Object",Z=ii[O].klass;if(!Z)throw new Error("can't deserialize unregistered class "+O);if(Z.deserialize)return Z.deserialize(A);for(var ie=Object.create(Z.prototype),pe=0,xe=Object.keys(A);pe<xe.length;pe+=1){var Ce=xe[pe];if("$name"!==Ce){var je=A[Ce];ie[Ce]=ii[O].shallow.indexOf(Ce)>=0?je:wi(je)}}return ie}throw new Error("can't deserialize object of type "+typeof A)}var Li=function(){this.first=!0};Li.prototype.update=function(A,O){var Z=Math.floor(A);return this.first?(this.first=!1,this.lastIntegerZoom=Z,this.lastIntegerZoomTime=0,this.lastZoom=A,this.lastFloorZoom=Z,!0):(this.lastFloorZoom>Z?(this.lastIntegerZoom=Z+1,this.lastIntegerZoomTime=O):this.lastFloorZoom<Z&&(this.lastIntegerZoom=Z,this.lastIntegerZoomTime=O),A!==this.lastZoom&&(this.lastZoom=A,this.lastFloorZoom=Z,!0))};var Mn={"Latin-1 Supplement":function(A){return A>=128&&A<=255},Arabic:function(A){return A>=1536&&A<=1791},"Arabic Supplement":function(A){return A>=1872&&A<=1919},"Arabic Extended-A":function(A){return A>=2208&&A<=2303},"Hangul Jamo":function(A){return A>=4352&&A<=4607},"Unified Canadian Aboriginal Syllabics":function(A){return A>=5120&&A<=5759},Khmer:function(A){return A>=6016&&A<=6143},"Unified Canadian Aboriginal Syllabics Extended":function(A){return A>=6320&&A<=6399},"General Punctuation":function(A){return A>=8192&&A<=8303},"Letterlike Symbols":function(A){return A>=8448&&A<=8527},"Number Forms":function(A){return A>=8528&&A<=8591},"Miscellaneous Technical":function(A){return A>=8960&&A<=9215},"Control Pictures":function(A){return A>=9216&&A<=9279},"Optical Character Recognition":function(A){return A>=9280&&A<=9311},"Enclosed Alphanumerics":function(A){return A>=9312&&A<=9471},"Geometric Shapes":function(A){return A>=9632&&A<=9727},"Miscellaneous Symbols":function(A){return A>=9728&&A<=9983},"Miscellaneous Symbols and Arrows":function(A){return A>=11008&&A<=11263},"CJK Radicals Supplement":function(A){return A>=11904&&A<=12031},"Kangxi Radicals":function(A){return A>=12032&&A<=12255},"Ideographic Description Characters":function(A){return A>=12272&&A<=12287},"CJK Symbols and Punctuation":function(A){return A>=12288&&A<=12351},Hiragana:function(A){return A>=12352&&A<=12447},Katakana:function(A){return A>=12448&&A<=12543},Bopomofo:function(A){return A>=12544&&A<=12591},"Hangul Compatibility Jamo":function(A){return A>=12592&&A<=12687},Kanbun:function(A){return A>=12688&&A<=12703},"Bopomofo Extended":function(A){return A>=12704&&A<=12735},"CJK Strokes":function(A){return A>=12736&&A<=12783},"Katakana Phonetic Extensions":function(A){return A>=12784&&A<=12799},"Enclosed CJK Letters and Months":function(A){return A>=12800&&A<=13055},"CJK Compatibility":function(A){return A>=13056&&A<=13311},"CJK Unified Ideographs Extension A":function(A){return A>=13312&&A<=19903},"Yijing Hexagram Symbols":function(A){return A>=19904&&A<=19967},"CJK Unified Ideographs":function(A){return A>=19968&&A<=40959},"Yi Syllables":function(A){return A>=40960&&A<=42127},"Yi Radicals":function(A){return A>=42128&&A<=42191},"Hangul Jamo Extended-A":function(A){return A>=43360&&A<=43391},"Hangul Syllables":function(A){return A>=44032&&A<=55215},"Hangul Jamo Extended-B":function(A){return A>=55216&&A<=55295},"Private Use Area":function(A){return A>=57344&&A<=63743},"CJK Compatibility Ideographs":function(A){return A>=63744&&A<=64255},"Arabic Presentation Forms-A":function(A){return A>=64336&&A<=65023},"Vertical Forms":function(A){return A>=65040&&A<=65055},"CJK Compatibility Forms":function(A){return A>=65072&&A<=65103},"Small Form Variants":function(A){return A>=65104&&A<=65135},"Arabic Presentation Forms-B":function(A){return A>=65136&&A<=65279},"Halfwidth and Fullwidth Forms":function(A){return A>=65280&&A<=65519}};function Di(A){for(var O=0,Z=A;O<Z.length;O+=1)if(di(Z[O].charCodeAt(0)))return!0;return!1}function Ei(A){return!(Mn.Arabic(A)||Mn["Arabic Supplement"](A)||Mn["Arabic Extended-A"](A)||Mn["Arabic Presentation Forms-A"](A)||Mn["Arabic Presentation Forms-B"](A))}function di(A){return!(746!==A&&747!==A&&(A<4352||!(Mn["Bopomofo Extended"](A)||Mn.Bopomofo(A)||Mn["CJK Compatibility Forms"](A)&&!(A>=65097&&A<=65103)||Mn["CJK Compatibility Ideographs"](A)||Mn["CJK Compatibility"](A)||Mn["CJK Radicals Supplement"](A)||Mn["CJK Strokes"](A)||!(!Mn["CJK Symbols and Punctuation"](A)||A>=12296&&A<=12305||A>=12308&&A<=12319||12336===A)||Mn["CJK Unified Ideographs Extension A"](A)||Mn["CJK Unified Ideographs"](A)||Mn["Enclosed CJK Letters and Months"](A)||Mn["Hangul Compatibility Jamo"](A)||Mn["Hangul Jamo Extended-A"](A)||Mn["Hangul Jamo Extended-B"](A)||Mn["Hangul Jamo"](A)||Mn["Hangul Syllables"](A)||Mn.Hiragana(A)||Mn["Ideographic Description Characters"](A)||Mn.Kanbun(A)||Mn["Kangxi Radicals"](A)||Mn["Katakana Phonetic Extensions"](A)||Mn.Katakana(A)&&12540!==A||!(!Mn["Halfwidth and Fullwidth Forms"](A)||65288===A||65289===A||65293===A||A>=65306&&A<=65310||65339===A||65341===A||65343===A||A>=65371&&A<=65503||65507===A||A>=65512&&A<=65519)||!(!Mn["Small Form Variants"](A)||A>=65112&&A<=65118||A>=65123&&A<=65126)||Mn["Unified Canadian Aboriginal Syllabics"](A)||Mn["Unified Canadian Aboriginal Syllabics Extended"](A)||Mn["Vertical Forms"](A)||Mn["Yijing Hexagram Symbols"](A)||Mn["Yi Syllables"](A)||Mn["Yi Radicals"](A))))}function zi(A){return!(di(A)||(O=A,Mn["Latin-1 Supplement"](O)&&(167===O||169===O||174===O||177===O||188===O||189===O||190===O||215===O||247===O)||Mn["General Punctuation"](O)&&(8214===O||8224===O||8225===O||8240===O||8241===O||8251===O||8252===O||8258===O||8263===O||8264===O||8265===O||8273===O)||Mn["Letterlike Symbols"](O)||Mn["Number Forms"](O)||Mn["Miscellaneous Technical"](O)&&(O>=8960&&O<=8967||O>=8972&&O<=8991||O>=8996&&O<=9e3||9003===O||O>=9085&&O<=9114||O>=9150&&O<=9165||9167===O||O>=9169&&O<=9179||O>=9186&&O<=9215)||Mn["Control Pictures"](O)&&9251!==O||Mn["Optical Character Recognition"](O)||Mn["Enclosed Alphanumerics"](O)||Mn["Geometric Shapes"](O)||Mn["Miscellaneous Symbols"](O)&&!(O>=9754&&O<=9759)||Mn["Miscellaneous Symbols and Arrows"](O)&&(O>=11026&&O<=11055||O>=11088&&O<=11097||O>=11192&&O<=11243)||Mn["CJK Symbols and Punctuation"](O)||Mn.Katakana(O)||Mn["Private Use Area"](O)||Mn["CJK Compatibility Forms"](O)||Mn["Small Form Variants"](O)||Mn["Halfwidth and Fullwidth Forms"](O)||8734===O||8756===O||8757===O||O>=9984&&O<=10087||O>=10102&&O<=10131||65532===O||65533===O));var O}function Mi(A){return A>=1424&&A<=2303||Mn["Arabic Presentation Forms-A"](A)||Mn["Arabic Presentation Forms-B"](A)}function $i(A,O){return!(!O&&Mi(A)||A>=2304&&A<=3583||A>=3840&&A<=4255||Mn.Khmer(A))}function ri(A){for(var O=0,Z=A;O<Z.length;O+=1)if(Mi(Z[O].charCodeAt(0)))return!0;return!1}var Wi="deferred",Ba="loading",Ho="loaded",go=null,vi="unavailable",da=null,mo=function(A){A&&"string"==typeof A&&A.indexOf("NetworkError")>-1&&(vi="error"),go&&go(A)};function Xi(){wa.fire(new Ve("pluginStateChange",{pluginStatus:vi,pluginURL:da}))}var wa=new he,Va=function(){return vi},ta=function(){if(vi!==Wi||!da)throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");vi=Ba,Xi(),da&&mt({url:da},function(A){A?mo(A):(vi=Ho,Xi())})},co={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:function(){return vi===Ho||null!=co.applyArabicShaping},isLoading:function(){return vi===Ba},setState:function(A){vi=A.pluginStatus,da=A.pluginURL},isParsed:function(){return null!=co.applyArabicShaping&&null!=co.processBidirectionalText&&null!=co.processStyledBidirectionalText},getPluginURL:function(){return da}},ra=function(A,O){this.zoom=A,O?(this.now=O.now,this.fadeDuration=O.fadeDuration,this.zoomHistory=O.zoomHistory,this.transition=O.transition):(this.now=0,this.fadeDuration=0,this.zoomHistory=new Li,this.transition={})};ra.prototype.isSupportedScript=function(A){return function(O,Z){for(var ie=0,pe=O;ie<pe.length;ie+=1)if(!$i(pe[ie].charCodeAt(0),Z))return!1;return!0}(A,co.isLoaded())},ra.prototype.crossFadingFactor=function(){return 0===this.fadeDuration?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)},ra.prototype.getCrossfadeParameters=function(){var A=this.zoom,O=A-Math.floor(A),Z=this.crossFadingFactor();return A>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:O+(1-O)*Z}:{fromScale:.5,toScale:1,t:1-(1-Z)*O}};var $a=function(A,O){this.property=A,this.value=O,this.expression=function(Z,ie){if(Ue(Z))return new _r(Z,ie);if(Kt(Z)){var pe=br(Z,ie);if("error"===pe.result)throw new Error(pe.value.map(function(Ce){return Ce.key+": "+Ce.message}).join(", "));return pe.value}var xe=Z;return"string"==typeof Z&&"color"===ie.type&&(xe=Jt.parse(Z)),{kind:"constant",evaluate:function(){return xe}}}(void 0===O?A.specification.default:O,A.specification)};$a.prototype.isDataDriven=function(){return"source"===this.expression.kind||"composite"===this.expression.kind},$a.prototype.possiblyEvaluate=function(A,O,Z){return this.property.possiblyEvaluate(this,A,O,Z)};var rs=function(A){this.property=A,this.value=new $a(A,void 0)};rs.prototype.transitioned=function(A,O){return new Is(this.property,this.value,O,c({},A.transition,this.transition),A.now)},rs.prototype.untransitioned=function(){return new Is(this.property,this.value,null,{},0)};var Jo=function(A){this._properties=A,this._values=Object.create(A.defaultTransitionablePropertyValues)};Jo.prototype.getValue=function(A){return k(this._values[A].value.value)},Jo.prototype.setValue=function(A,O){this._values.hasOwnProperty(A)||(this._values[A]=new rs(this._values[A].property)),this._values[A].value=new $a(this._values[A].property,null===O?void 0:k(O))},Jo.prototype.getTransition=function(A){return k(this._values[A].transition)},Jo.prototype.setTransition=function(A,O){this._values.hasOwnProperty(A)||(this._values[A]=new rs(this._values[A].property)),this._values[A].transition=k(O)||void 0},Jo.prototype.serialize=function(){for(var A={},O=0,Z=Object.keys(this._values);O<Z.length;O+=1){var ie=Z[O],pe=this.getValue(ie);void 0!==pe&&(A[ie]=pe);var xe=this.getTransition(ie);void 0!==xe&&(A[ie+"-transition"]=xe)}return A},Jo.prototype.transitioned=function(A,O){for(var Z=new Oa(this._properties),ie=0,pe=Object.keys(this._values);ie<pe.length;ie+=1){var xe=pe[ie];Z._values[xe]=this._values[xe].transitioned(A,O._values[xe])}return Z},Jo.prototype.untransitioned=function(){for(var A=new Oa(this._properties),O=0,Z=Object.keys(this._values);O<Z.length;O+=1){var ie=Z[O];A._values[ie]=this._values[ie].untransitioned()}return A};var Is=function(A,O,Z,ie,pe){this.property=A,this.value=O,this.begin=pe+ie.delay||0,this.end=this.begin+ie.duration||0,A.specification.transition&&(ie.delay||ie.duration)&&(this.prior=Z)};Is.prototype.possiblyEvaluate=function(A,O,Z){var ie=A.now||0,pe=this.value.possiblyEvaluate(A,O,Z),xe=this.prior;if(xe){if(ie>this.end)return this.prior=null,pe;if(this.value.isDataDriven())return this.prior=null,pe;if(ie<this.begin)return xe.possiblyEvaluate(A,O,Z);var Ce=(ie-this.begin)/(this.end-this.begin);return this.property.interpolate(xe.possiblyEvaluate(A,O,Z),pe,function(je){if(je<=0)return 0;if(je>=1)return 1;var $e=je*je,ut=$e*je;return 4*(je<.5?ut:3*(je-$e)+ut-.75)}(Ce))}return pe};var Oa=function(A){this._properties=A,this._values=Object.create(A.defaultTransitioningPropertyValues)};Oa.prototype.possiblyEvaluate=function(A,O,Z){for(var ie=new Ko(this._properties),pe=0,xe=Object.keys(this._values);pe<xe.length;pe+=1){var Ce=xe[pe];ie._values[Ce]=this._values[Ce].possiblyEvaluate(A,O,Z)}return ie},Oa.prototype.hasTransition=function(){for(var A=0,O=Object.keys(this._values);A<O.length;A+=1)if(this._values[O[A]].prior)return!0;return!1};var Os=function(A){this._properties=A,this._values=Object.create(A.defaultPropertyValues)};Os.prototype.getValue=function(A){return k(this._values[A].value)},Os.prototype.setValue=function(A,O){this._values[A]=new $a(this._values[A].property,null===O?void 0:k(O))},Os.prototype.serialize=function(){for(var A={},O=0,Z=Object.keys(this._values);O<Z.length;O+=1){var ie=Z[O],pe=this.getValue(ie);void 0!==pe&&(A[ie]=pe)}return A},Os.prototype.possiblyEvaluate=function(A,O,Z){for(var ie=new Ko(this._properties),pe=0,xe=Object.keys(this._values);pe<xe.length;pe+=1){var Ce=xe[pe];ie._values[Ce]=this._values[Ce].possiblyEvaluate(A,O,Z)}return ie};var Da=function(A,O,Z){this.property=A,this.value=O,this.parameters=Z};Da.prototype.isConstant=function(){return"constant"===this.value.kind},Da.prototype.constantOr=function(A){return"constant"===this.value.kind?this.value.value:A},Da.prototype.evaluate=function(A,O,Z,ie){return this.property.evaluate(this.value,this.parameters,A,O,Z,ie)};var Ko=function(A){this._properties=A,this._values=Object.create(A.defaultPossiblyEvaluatedValues)};Ko.prototype.get=function(A){return this._values[A]};var ci=function(A){this.specification=A};ci.prototype.possiblyEvaluate=function(A,O){return A.expression.evaluate(O)},ci.prototype.interpolate=function(A,O,Z){var ie=Sn[this.specification.type];return ie?ie(A,O,Z):A};var yi=function(A,O){this.specification=A,this.overrides=O};yi.prototype.possiblyEvaluate=function(A,O,Z,ie){return new Da(this,"constant"===A.expression.kind||"camera"===A.expression.kind?{kind:"constant",value:A.expression.evaluate(O,null,{},Z,ie)}:A.expression,O)},yi.prototype.interpolate=function(A,O,Z){if("constant"!==A.value.kind||"constant"!==O.value.kind)return A;if(void 0===A.value.value||void 0===O.value.value)return new Da(this,{kind:"constant",value:void 0},A.parameters);var ie=Sn[this.specification.type];return ie?new Da(this,{kind:"constant",value:ie(A.value.value,O.value.value,Z)},A.parameters):A},yi.prototype.evaluate=function(A,O,Z,ie,pe,xe){return"constant"===A.kind?A.value:A.evaluate(O,Z,ie,pe,xe)};var Ds=function(A){function O(){A.apply(this,arguments)}return A&&(O.__proto__=A),(O.prototype=Object.create(A&&A.prototype)).constructor=O,O.prototype.possiblyEvaluate=function(Z,ie,pe,xe){if(void 0===Z.value)return new Da(this,{kind:"constant",value:void 0},ie);if("constant"===Z.expression.kind){var Ce=Z.expression.evaluate(ie,null,{},pe,xe),je="resolvedImage"===Z.property.specification.type&&"string"!=typeof Ce?Ce.name:Ce,$e=this._calculate(je,je,je,ie);return new Da(this,{kind:"constant",value:$e},ie)}if("camera"===Z.expression.kind){var ut=this._calculate(Z.expression.evaluate({zoom:ie.zoom-1}),Z.expression.evaluate({zoom:ie.zoom}),Z.expression.evaluate({zoom:ie.zoom+1}),ie);return new Da(this,{kind:"constant",value:ut},ie)}return new Da(this,Z.expression,ie)},O.prototype.evaluate=function(Z,ie,pe,xe,Ce,je){if("source"===Z.kind){var $e=Z.evaluate(ie,pe,xe,Ce,je);return this._calculate($e,$e,$e,ie)}return"composite"===Z.kind?this._calculate(Z.evaluate({zoom:Math.floor(ie.zoom)-1},pe,xe),Z.evaluate({zoom:Math.floor(ie.zoom)},pe,xe),Z.evaluate({zoom:Math.floor(ie.zoom)+1},pe,xe),ie):Z.value},O.prototype._calculate=function(Z,ie,pe,xe){return xe.zoom>xe.zoomHistory.lastIntegerZoom?{from:Z,to:ie}:{from:pe,to:ie}},O.prototype.interpolate=function(Z){return Z},O}(yi),zs=function(A){this.specification=A};zs.prototype.possiblyEvaluate=function(A,O,Z,ie){if(void 0!==A.value){if("constant"===A.expression.kind){var pe=A.expression.evaluate(O,null,{},Z,ie);return this._calculate(pe,pe,pe,O)}return this._calculate(A.expression.evaluate(new ra(Math.floor(O.zoom-1),O)),A.expression.evaluate(new ra(Math.floor(O.zoom),O)),A.expression.evaluate(new ra(Math.floor(O.zoom+1),O)),O)}},zs.prototype._calculate=function(A,O,Z,ie){return ie.zoom>ie.zoomHistory.lastIntegerZoom?{from:A,to:O}:{from:Z,to:O}},zs.prototype.interpolate=function(A){return A};var Qo=function(A){this.specification=A};Qo.prototype.possiblyEvaluate=function(A,O,Z,ie){return!!A.expression.evaluate(O,null,{},Z,ie)},Qo.prototype.interpolate=function(){return!1};var Eo=function(A){for(var O in this.properties=A,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[],A){var Z=A[O];Z.specification.overridable&&this.overridableProperties.push(O);var ie=this.defaultPropertyValues[O]=new $a(Z,void 0),pe=this.defaultTransitionablePropertyValues[O]=new rs(Z);this.defaultTransitioningPropertyValues[O]=pe.untransitioned(),this.defaultPossiblyEvaluatedValues[O]=ie.possiblyEvaluate({})}};Wr("DataDrivenProperty",yi),Wr("DataConstantProperty",ci),Wr("CrossFadedDataDrivenProperty",Ds),Wr("CrossFadedProperty",zs),Wr("ColorRampProperty",Qo);var Uo=function(A){function O(Z,ie){if(A.call(this),this.id=Z.id,this.type=Z.type,this._featureFilter={filter:function(){return!0},needGeometry:!1},"custom"!==Z.type&&(this.metadata=Z.metadata,this.minzoom=Z.minzoom,this.maxzoom=Z.maxzoom,"background"!==Z.type&&(this.source=Z.source,this.sourceLayer=Z["source-layer"],this.filter=Z.filter),ie.layout&&(this._unevaluatedLayout=new Os(ie.layout)),ie.paint)){for(var pe in this._transitionablePaint=new Jo(ie.paint),Z.paint)this.setPaintProperty(pe,Z.paint[pe],{validate:!1});for(var xe in Z.layout)this.setLayoutProperty(xe,Z.layout[xe],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new Ko(ie.paint)}}return A&&(O.__proto__=A),(O.prototype=Object.create(A&&A.prototype)).constructor=O,O.prototype.getCrossfadeParameters=function(){return this._crossfadeParameters},O.prototype.getLayoutProperty=function(Z){return"visibility"===Z?this.visibility:this._unevaluatedLayout.getValue(Z)},O.prototype.setLayoutProperty=function(Z,ie,pe){void 0===pe&&(pe={}),null!=ie&&this._validate(pn,"layers."+this.id+".layout."+Z,Z,ie,pe)||("visibility"!==Z?this._unevaluatedLayout.setValue(Z,ie):this.visibility=ie)},O.prototype.getPaintProperty=function(Z){return T(Z,"-transition")?this._transitionablePaint.getTransition(Z.slice(0,-11)):this._transitionablePaint.getValue(Z)},O.prototype.setPaintProperty=function(Z,ie,pe){if(void 0===pe&&(pe={}),null!=ie&&this._validate(rn,"layers."+this.id+".paint."+Z,Z,ie,pe))return!1;if(T(Z,"-transition"))return this._transitionablePaint.setTransition(Z.slice(0,-11),ie||void 0),!1;var Ce=this._transitionablePaint._values[Z],je="cross-faded-data-driven"===Ce.property.specification["property-type"],$e=Ce.value.isDataDriven(),ut=Ce.value;this._transitionablePaint.setValue(Z,ie),this._handleSpecialPaintPropertyUpdate(Z);var vt=this._transitionablePaint._values[Z].value;return vt.isDataDriven()||$e||je||this._handleOverridablePaintPropertyUpdate(Z,ut,vt)},O.prototype._handleSpecialPaintPropertyUpdate=function(Z){},O.prototype._handleOverridablePaintPropertyUpdate=function(Z,ie,pe){return!1},O.prototype.isHidden=function(Z){return!!(this.minzoom&&Z<this.minzoom)||!!(this.maxzoom&&Z>=this.maxzoom)||"none"===this.visibility},O.prototype.updateTransitions=function(Z){this._transitioningPaint=this._transitionablePaint.transitioned(Z,this._transitioningPaint)},O.prototype.hasTransition=function(){return this._transitioningPaint.hasTransition()},O.prototype.recalculate=function(Z,ie){Z.getCrossfadeParameters&&(this._crossfadeParameters=Z.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(Z,void 0,ie)),this.paint=this._transitioningPaint.possiblyEvaluate(Z,void 0,ie)},O.prototype.serialize=function(){var Z={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(Z.layout=Z.layout||{},Z.layout.visibility=this.visibility),w(Z,function(ie,pe){return!(void 0===ie||"layout"===pe&&!Object.keys(ie).length||"paint"===pe&&!Object.keys(ie).length)})},O.prototype._validate=function(Z,ie,pe,xe,Ce){return void 0===Ce&&(Ce={}),(!Ce||!1!==Ce.validate)&&_n(this,Z.call(Yr,{key:ie,layerType:this.type,objectKey:pe,value:xe,styleSpec:ye,style:{glyphs:!0,sprite:!0}}))},O.prototype.is3D=function(){return!1},O.prototype.isTileClipped=function(){return!1},O.prototype.hasOffscreenPass=function(){return!1},O.prototype.resize=function(){},O.prototype.isStateDependent=function(){for(var Z in this.paint._values){var ie=this.paint.get(Z);if(ie instanceof Da&&jo(ie.property.specification)&&("source"===ie.value.kind||"composite"===ie.value.kind)&&ie.value.isStateDependent)return!0}return!1},O}(he),Ys={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array},_s=function(A,O){this._structArray=A,this._pos1=O*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8},Ji=function(){this.isTransferred=!1,this.capacity=-1,this.resize(0)};function na(A,O){void 0===O&&(O=1);var Z=0,ie=0;return{members:A.map(function(pe){var Ce=Ys[pe.type].BYTES_PER_ELEMENT,je=Z=us(Z,Math.max(O,Ce)),$e=pe.components||1;return ie=Math.max(ie,Ce),Z+=Ce*$e,{name:pe.name,type:pe.type,components:$e,offset:je}}),size:us(Z,Math.max(ie,O)),alignment:O}}function us(A,O){return Math.ceil(A/O)*O}Ji.serialize=function(A,O){return A._trim(),O&&(A.isTransferred=!0,O.push(A.arrayBuffer)),{length:A.length,arrayBuffer:A.arrayBuffer}},Ji.deserialize=function(A){var O=Object.create(this.prototype);return O.arrayBuffer=A.arrayBuffer,O.length=A.length,O.capacity=A.arrayBuffer.byteLength/O.bytesPerElement,O._refreshViews(),O},Ji.prototype._trim=function(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())},Ji.prototype.clear=function(){this.length=0},Ji.prototype.resize=function(A){this.reserve(A),this.length=A},Ji.prototype.reserve=function(A){if(A>this.capacity){this.capacity=Math.max(A,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);var O=this.uint8;this._refreshViews(),O&&this.uint8.set(O)}},Ji.prototype._refreshViews=function(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")};var ns=function(A){function O(){A.apply(this,arguments)}return A&&(O.__proto__=A),(O.prototype=Object.create(A&&A.prototype)).constructor=O,O.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},O.prototype.emplaceBack=function(Z,ie){var pe=this.length;return this.resize(pe+1),this.emplace(pe,Z,ie)},O.prototype.emplace=function(Z,ie,pe){var xe=2*Z;return this.int16[xe+0]=ie,this.int16[xe+1]=pe,Z},O}(Ji);ns.prototype.bytesPerElement=4,Wr("StructArrayLayout2i4",ns);var La=function(A){function O(){A.apply(this,arguments)}return A&&(O.__proto__=A),(O.prototype=Object.create(A&&A.prototype)).constructor=O,O.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},O.prototype.emplaceBack=function(Z,ie,pe,xe){var Ce=this.length;return this.resize(Ce+1),this.emplace(Ce,Z,ie,pe,xe)},O.prototype.emplace=function(Z,ie,pe,xe,Ce){var je=4*Z;return this.int16[je+0]=ie,this.int16[je+1]=pe,this.int16[je+2]=xe,this.int16[je+3]=Ce,Z},O}(Ji);La.prototype.bytesPerElement=8,Wr("StructArrayLayout4i8",La);var fs=function(A){function O(){A.apply(this,arguments)}return A&&(O.__proto__=A),(O.prototype=Object.create(A&&A.prototype)).constructor=O,O.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},O.prototype.emplaceBack=function(Z,ie,pe,xe,Ce,je){var $e=this.length;return this.resize($e+1),this.emplace($e,Z,ie,pe,xe,Ce,je)},O.prototype.emplace=function(Z,ie,pe,xe,Ce,je,$e){var ut=6*Z;return this.int16[ut+0]=ie,this.int16[ut+1]=pe,this.int16[ut+2]=xe,this.int16[ut+3]=Ce,this.int16[ut+4]=je,this.int16[ut+5]=$e,Z},O}(Ji);fs.prototype.bytesPerElement=12,Wr("StructArrayLayout2i4i12",fs);var ws=function(A){function O(){A.apply(this,arguments)}return A&&(O.__proto__=A),(O.prototype=Object.create(A&&A.prototype)).constructor=O,O.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},O.prototype.emplaceBack=function(Z,ie,pe,xe,Ce,je){var $e=this.length;return this.resize($e+1),this.emplace($e,Z,ie,pe,xe,Ce,je)},O.prototype.emplace=function(Z,ie,pe,xe,Ce,je,$e){var ut=4*Z,vt=8*Z;return this.int16[ut+0]=ie,this.int16[ut+1]=pe,this.uint8[vt+4]=xe,this.uint8[vt+5]=Ce,this.uint8[vt+6]=je,this.uint8[vt+7]=$e,Z},O}(Ji);ws.prototype.bytesPerElement=8,Wr("StructArrayLayout2i4ub8",ws);var gs=function(A){function O(){A.apply(this,arguments)}return A&&(O.__proto__=A),(O.prototype=Object.create(A&&A.prototype)).constructor=O,O.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},O.prototype.emplaceBack=function(Z,ie,pe,xe,Ce,je,$e,ut,vt,zt){var Yt=this.length;return this.resize(Yt+1),this.emplace(Yt,Z,ie,pe,xe,Ce,je,$e,ut,vt,zt)},O.prototype.emplace=function(Z,ie,pe,xe,Ce,je,$e,ut,vt,zt,Yt){var qt=9*Z,ar=18*Z;return this.uint16[qt+0]=ie,this.uint16[qt+1]=pe,this.uint16[qt+2]=xe,this.uint16[qt+3]=Ce,this.uint16[qt+4]=je,this.uint16[qt+5]=$e,this.uint16[qt+6]=ut,this.uint16[qt+7]=vt,this.uint8[ar+16]=zt,this.uint8[ar+17]=Yt,Z},O}(Ji);gs.prototype.bytesPerElement=18,Wr("StructArrayLayout8ui2ub18",gs);var Ts=function(A){function O(){A.apply(this,arguments)}return A&&(O.__proto__=A),(O.prototype=Object.create(A&&A.prototype)).constructor=O,O.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},O.prototype.emplaceBack=function(Z,ie,pe,xe,Ce,je,$e,ut,vt,zt,Yt,qt){var ar=this.length;return this.resize(ar+1),this.emplace(ar,Z,ie,pe,xe,Ce,je,$e,ut,vt,zt,Yt,qt)},O.prototype.emplace=function(Z,ie,pe,xe,Ce,je,$e,ut,vt,zt,Yt,qt,ar){var yr=12*Z;return this.int16[yr+0]=ie,this.int16[yr+1]=pe,this.int16[yr+2]=xe,this.int16[yr+3]=Ce,this.uint16[yr+4]=je,this.uint16[yr+5]=$e,this.uint16[yr+6]=ut,this.uint16[yr+7]=vt,this.int16[yr+8]=zt,this.int16[yr+9]=Yt,this.int16[yr+10]=qt,this.int16[yr+11]=ar,Z},O}(Ji);Ts.prototype.bytesPerElement=24,Wr("StructArrayLayout4i4ui4i24",Ts);var is=function(A){function O(){A.apply(this,arguments)}return A&&(O.__proto__=A),(O.prototype=Object.create(A&&A.prototype)).constructor=O,O.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},O.prototype.emplaceBack=function(Z,ie,pe){var xe=this.length;return this.resize(xe+1),this.emplace(xe,Z,ie,pe)},O.prototype.emplace=function(Z,ie,pe,xe){var Ce=3*Z;return this.float32[Ce+0]=ie,this.float32[Ce+1]=pe,this.float32[Ce+2]=xe,Z},O}(Ji);is.prototype.bytesPerElement=12,Wr("StructArrayLayout3f12",is);var Ws=function(A){function O(){A.apply(this,arguments)}return A&&(O.__proto__=A),(O.prototype=Object.create(A&&A.prototype)).constructor=O,O.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)},O.prototype.emplaceBack=function(Z){var ie=this.length;return this.resize(ie+1),this.emplace(ie,Z)},O.prototype.emplace=function(Z,ie){return this.uint32[1*Z+0]=ie,Z},O}(Ji);Ws.prototype.bytesPerElement=4,Wr("StructArrayLayout1ul4",Ws);var il=function(A){function O(){A.apply(this,arguments)}return A&&(O.__proto__=A),(O.prototype=Object.create(A&&A.prototype)).constructor=O,O.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},O.prototype.emplaceBack=function(Z,ie,pe,xe,Ce,je,$e,ut,vt){var zt=this.length;return this.resize(zt+1),this.emplace(zt,Z,ie,pe,xe,Ce,je,$e,ut,vt)},O.prototype.emplace=function(Z,ie,pe,xe,Ce,je,$e,ut,vt,zt){var Yt=10*Z,qt=5*Z;return this.int16[Yt+0]=ie,this.int16[Yt+1]=pe,this.int16[Yt+2]=xe,this.int16[Yt+3]=Ce,this.int16[Yt+4]=je,this.int16[Yt+5]=$e,this.uint32[qt+3]=ut,this.uint16[Yt+8]=vt,this.uint16[Yt+9]=zt,Z},O}(Ji);il.prototype.bytesPerElement=20,Wr("StructArrayLayout6i1ul2ui20",il);var hs=function(A){function O(){A.apply(this,arguments)}return A&&(O.__proto__=A),(O.prototype=Object.create(A&&A.prototype)).constructor=O,O.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},O.prototype.emplaceBack=function(Z,ie,pe,xe,Ce,je){var $e=this.length;return this.resize($e+1),this.emplace($e,Z,ie,pe,xe,Ce,je)},O.prototype.emplace=function(Z,ie,pe,xe,Ce,je,$e){var ut=6*Z;return this.int16[ut+0]=ie,this.int16[ut+1]=pe,this.int16[ut+2]=xe,this.int16[ut+3]=Ce,this.int16[ut+4]=je,this.int16[ut+5]=$e,Z},O}(Ji);hs.prototype.bytesPerElement=12,Wr("StructArrayLayout2i2i2i12",hs);var Xs=function(A){function O(){A.apply(this,arguments)}return A&&(O.__proto__=A),(O.prototype=Object.create(A&&A.prototype)).constructor=O,O.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},O.prototype.emplaceBack=function(Z,ie,pe,xe,Ce){var je=this.length;return this.resize(je+1),this.emplace(je,Z,ie,pe,xe,Ce)},O.prototype.emplace=function(Z,ie,pe,xe,Ce,je){var $e=4*Z,ut=8*Z;return this.float32[$e+0]=ie,this.float32[$e+1]=pe,this.float32[$e+2]=xe,this.int16[ut+6]=Ce,this.int16[ut+7]=je,Z},O}(Ji);Xs.prototype.bytesPerElement=16,Wr("StructArrayLayout2f1f2i16",Xs);var ks=function(A){function O(){A.apply(this,arguments)}return A&&(O.__proto__=A),(O.prototype=Object.create(A&&A.prototype)).constructor=O,O.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},O.prototype.emplaceBack=function(Z,ie,pe,xe){var Ce=this.length;return this.resize(Ce+1),this.emplace(Ce,Z,ie,pe,xe)},O.prototype.emplace=function(Z,ie,pe,xe,Ce){var je=12*Z,$e=3*Z;return this.uint8[je+0]=ie,this.uint8[je+1]=pe,this.float32[$e+1]=xe,this.float32[$e+2]=Ce,Z},O}(Ji);ks.prototype.bytesPerElement=12,Wr("StructArrayLayout2ub2f12",ks);var eo=function(A){function O(){A.apply(this,arguments)}return A&&(O.__proto__=A),(O.prototype=Object.create(A&&A.prototype)).constructor=O,O.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},O.prototype.emplaceBack=function(Z,ie,pe){var xe=this.length;return this.resize(xe+1),this.emplace(xe,Z,ie,pe)},O.prototype.emplace=function(Z,ie,pe,xe){var Ce=3*Z;return this.uint16[Ce+0]=ie,this.uint16[Ce+1]=pe,this.uint16[Ce+2]=xe,Z},O}(Ji);eo.prototype.bytesPerElement=6,Wr("StructArrayLayout3ui6",eo);var al=function(A){function O(){A.apply(this,arguments)}return A&&(O.__proto__=A),(O.prototype=Object.create(A&&A.prototype)).constructor=O,O.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},O.prototype.emplaceBack=function(Z,ie,pe,xe,Ce,je,$e,ut,vt,zt,Yt,qt,ar,yr,Cr,Lr,jr){var Ur=this.length;return this.resize(Ur+1),this.emplace(Ur,Z,ie,pe,xe,Ce,je,$e,ut,vt,zt,Yt,qt,ar,yr,Cr,Lr,jr)},O.prototype.emplace=function(Z,ie,pe,xe,Ce,je,$e,ut,vt,zt,Yt,qt,ar,yr,Cr,Lr,jr,Ur){var Zr=24*Z,ln=12*Z,yn=48*Z;return this.int16[Zr+0]=ie,this.int16[Zr+1]=pe,this.uint16[Zr+2]=xe,this.uint16[Zr+3]=Ce,this.uint32[ln+2]=je,this.uint32[ln+3]=$e,this.uint32[ln+4]=ut,this.uint16[Zr+10]=vt,this.uint16[Zr+11]=zt,this.uint16[Zr+12]=Yt,this.float32[ln+7]=qt,this.float32[ln+8]=ar,this.uint8[yn+36]=yr,this.uint8[yn+37]=Cr,this.uint8[yn+38]=Lr,this.uint32[ln+10]=jr,this.int16[Zr+22]=Ur,Z},O}(Ji);al.prototype.bytesPerElement=48,Wr("StructArrayLayout2i2ui3ul3ui2f3ub1ul1i48",al);var ol=function(A){function O(){A.apply(this,arguments)}return A&&(O.__proto__=A),(O.prototype=Object.create(A&&A.prototype)).constructor=O,O.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},O.prototype.emplaceBack=function(Z,ie,pe,xe,Ce,je,$e,ut,vt,zt,Yt,qt,ar,yr,Cr,Lr,jr,Ur,Zr,ln,yn,Bn,Rn,Gn,ai,oi,Kn,pi){var fi=this.length;return this.resize(fi+1),this.emplace(fi,Z,ie,pe,xe,Ce,je,$e,ut,vt,zt,Yt,qt,ar,yr,Cr,Lr,jr,Ur,Zr,ln,yn,Bn,Rn,Gn,ai,oi,Kn,pi)},O.prototype.emplace=function(Z,ie,pe,xe,Ce,je,$e,ut,vt,zt,Yt,qt,ar,yr,Cr,Lr,jr,Ur,Zr,ln,yn,Bn,Rn,Gn,ai,oi,Kn,pi,fi){var si=34*Z,Ki=17*Z;return this.int16[si+0]=ie,this.int16[si+1]=pe,this.int16[si+2]=xe,this.int16[si+3]=Ce,this.int16[si+4]=je,this.int16[si+5]=$e,this.int16[si+6]=ut,this.int16[si+7]=vt,this.uint16[si+8]=zt,this.uint16[si+9]=Yt,this.uint16[si+10]=qt,this.uint16[si+11]=ar,this.uint16[si+12]=yr,this.uint16[si+13]=Cr,this.uint16[si+14]=Lr,this.uint16[si+15]=jr,this.uint16[si+16]=Ur,this.uint16[si+17]=Zr,this.uint16[si+18]=ln,this.uint16[si+19]=yn,this.uint16[si+20]=Bn,this.uint16[si+21]=Rn,this.uint16[si+22]=Gn,this.uint32[Ki+12]=ai,this.float32[Ki+13]=oi,this.float32[Ki+14]=Kn,this.float32[Ki+15]=pi,this.float32[Ki+16]=fi,Z},O}(Ji);ol.prototype.bytesPerElement=68,Wr("StructArrayLayout8i15ui1ul4f68",ol);var ce=function(A){function O(){A.apply(this,arguments)}return A&&(O.__proto__=A),(O.prototype=Object.create(A&&A.prototype)).constructor=O,O.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},O.prototype.emplaceBack=function(Z){var ie=this.length;return this.resize(ie+1),this.emplace(ie,Z)},O.prototype.emplace=function(Z,ie){return this.float32[1*Z+0]=ie,Z},O}(Ji);ce.prototype.bytesPerElement=4,Wr("StructArrayLayout1f4",ce);var C=function(A){function O(){A.apply(this,arguments)}return A&&(O.__proto__=A),(O.prototype=Object.create(A&&A.prototype)).constructor=O,O.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},O.prototype.emplaceBack=function(Z,ie,pe){var xe=this.length;return this.resize(xe+1),this.emplace(xe,Z,ie,pe)},O.prototype.emplace=function(Z,ie,pe,xe){var Ce=3*Z;return this.int16[Ce+0]=ie,this.int16[Ce+1]=pe,this.int16[Ce+2]=xe,Z},O}(Ji);C.prototype.bytesPerElement=6,Wr("StructArrayLayout3i6",C);var D=function(A){function O(){A.apply(this,arguments)}return A&&(O.__proto__=A),(O.prototype=Object.create(A&&A.prototype)).constructor=O,O.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},O.prototype.emplaceBack=function(Z,ie,pe){var xe=this.length;return this.resize(xe+1),this.emplace(xe,Z,ie,pe)},O.prototype.emplace=function(Z,ie,pe,xe){var je=4*Z;return this.uint32[2*Z+0]=ie,this.uint16[je+2]=pe,this.uint16[je+3]=xe,Z},O}(Ji);D.prototype.bytesPerElement=8,Wr("StructArrayLayout1ul2ui8",D);var F=function(A){function O(){A.apply(this,arguments)}return A&&(O.__proto__=A),(O.prototype=Object.create(A&&A.prototype)).constructor=O,O.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},O.prototype.emplaceBack=function(Z,ie){var pe=this.length;return this.resize(pe+1),this.emplace(pe,Z,ie)},O.prototype.emplace=function(Z,ie,pe){var xe=2*Z;return this.uint16[xe+0]=ie,this.uint16[xe+1]=pe,Z},O}(Ji);F.prototype.bytesPerElement=4,Wr("StructArrayLayout2ui4",F);var H=function(A){function O(){A.apply(this,arguments)}return A&&(O.__proto__=A),(O.prototype=Object.create(A&&A.prototype)).constructor=O,O.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},O.prototype.emplaceBack=function(Z){var ie=this.length;return this.resize(ie+1),this.emplace(ie,Z)},O.prototype.emplace=function(Z,ie){return this.uint16[1*Z+0]=ie,Z},O}(Ji);H.prototype.bytesPerElement=2,Wr("StructArrayLayout1ui2",H);var ae=function(A){function O(){A.apply(this,arguments)}return A&&(O.__proto__=A),(O.prototype=Object.create(A&&A.prototype)).constructor=O,O.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},O.prototype.emplaceBack=function(Z,ie){var pe=this.length;return this.resize(pe+1),this.emplace(pe,Z,ie)},O.prototype.emplace=function(Z,ie,pe){var xe=2*Z;return this.float32[xe+0]=ie,this.float32[xe+1]=pe,Z},O}(Ji);ae.prototype.bytesPerElement=8,Wr("StructArrayLayout2f8",ae);var ue=function(A){function O(){A.apply(this,arguments)}return A&&(O.__proto__=A),(O.prototype=Object.create(A&&A.prototype)).constructor=O,O.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},O.prototype.emplaceBack=function(Z,ie,pe,xe){var Ce=this.length;return this.resize(Ce+1),this.emplace(Ce,Z,ie,pe,xe)},O.prototype.emplace=function(Z,ie,pe,xe,Ce){var je=4*Z;return this.float32[je+0]=ie,this.float32[je+1]=pe,this.float32[je+2]=xe,this.float32[je+3]=Ce,Z},O}(Ji);ue.prototype.bytesPerElement=16,Wr("StructArrayLayout4f16",ue);var me=function(A){function O(){A.apply(this,arguments)}A&&(O.__proto__=A),(O.prototype=Object.create(A&&A.prototype)).constructor=O;var Z={anchorPointX:{configurable:!0},anchorPointY:{configurable:!0},x1:{configurable:!0},y1:{configurable:!0},x2:{configurable:!0},y2:{configurable:!0},featureIndex:{configurable:!0},sourceLayerIndex:{configurable:!0},bucketIndex:{configurable:!0},anchorPoint:{configurable:!0}};return Z.anchorPointX.get=function(){return this._structArray.int16[this._pos2+0]},Z.anchorPointY.get=function(){return this._structArray.int16[this._pos2+1]},Z.x1.get=function(){return this._structArray.int16[this._pos2+2]},Z.y1.get=function(){return this._structArray.int16[this._pos2+3]},Z.x2.get=function(){return this._structArray.int16[this._pos2+4]},Z.y2.get=function(){return this._structArray.int16[this._pos2+5]},Z.featureIndex.get=function(){return this._structArray.uint32[this._pos4+3]},Z.sourceLayerIndex.get=function(){return this._structArray.uint16[this._pos2+8]},Z.bucketIndex.get=function(){return this._structArray.uint16[this._pos2+9]},Z.anchorPoint.get=function(){return new r(this.anchorPointX,this.anchorPointY)},Object.defineProperties(O.prototype,Z),O}(_s);me.prototype.size=20;var be=function(A){function O(){A.apply(this,arguments)}return A&&(O.__proto__=A),(O.prototype=Object.create(A&&A.prototype)).constructor=O,O.prototype.get=function(Z){return new me(this,Z)},O}(il);Wr("CollisionBoxArray",be);var Le=function(A){function O(){A.apply(this,arguments)}A&&(O.__proto__=A),(O.prototype=Object.create(A&&A.prototype)).constructor=O;var Z={anchorX:{configurable:!0},anchorY:{configurable:!0},glyphStartIndex:{configurable:!0},numGlyphs:{configurable:!0},vertexStartIndex:{configurable:!0},lineStartIndex:{configurable:!0},lineLength:{configurable:!0},segment:{configurable:!0},lowerSize:{configurable:!0},upperSize:{configurable:!0},lineOffsetX:{configurable:!0},lineOffsetY:{configurable:!0},writingMode:{configurable:!0},placedOrientation:{configurable:!0},hidden:{configurable:!0},crossTileID:{configurable:!0},associatedIconIndex:{configurable:!0}};return Z.anchorX.get=function(){return this._structArray.int16[this._pos2+0]},Z.anchorY.get=function(){return this._structArray.int16[this._pos2+1]},Z.glyphStartIndex.get=function(){return this._structArray.uint16[this._pos2+2]},Z.numGlyphs.get=function(){return this._structArray.uint16[this._pos2+3]},Z.vertexStartIndex.get=function(){return this._structArray.uint32[this._pos4+2]},Z.lineStartIndex.get=function(){return this._structArray.uint32[this._pos4+3]},Z.lineLength.get=function(){return this._structArray.uint32[this._pos4+4]},Z.segment.get=function(){return this._structArray.uint16[this._pos2+10]},Z.lowerSize.get=function(){return this._structArray.uint16[this._pos2+11]},Z.upperSize.get=function(){return this._structArray.uint16[this._pos2+12]},Z.lineOffsetX.get=function(){return this._structArray.float32[this._pos4+7]},Z.lineOffsetY.get=function(){return this._structArray.float32[this._pos4+8]},Z.writingMode.get=function(){return this._structArray.uint8[this._pos1+36]},Z.placedOrientation.get=function(){return this._structArray.uint8[this._pos1+37]},Z.placedOrientation.set=function(ie){this._structArray.uint8[this._pos1+37]=ie},Z.hidden.get=function(){return this._structArray.uint8[this._pos1+38]},Z.hidden.set=function(ie){this._structArray.uint8[this._pos1+38]=ie},Z.crossTileID.get=function(){return this._structArray.uint32[this._pos4+10]},Z.crossTileID.set=function(ie){this._structArray.uint32[this._pos4+10]=ie},Z.associatedIconIndex.get=function(){return this._structArray.int16[this._pos2+22]},Object.defineProperties(O.prototype,Z),O}(_s);Le.prototype.size=48;var qe=function(A){function O(){A.apply(this,arguments)}return A&&(O.__proto__=A),(O.prototype=Object.create(A&&A.prototype)).constructor=O,O.prototype.get=function(Z){return new Le(this,Z)},O}(al);Wr("PlacedSymbolArray",qe);var Qe=function(A){function O(){A.apply(this,arguments)}A&&(O.__proto__=A),(O.prototype=Object.create(A&&A.prototype)).constructor=O;var Z={anchorX:{configurable:!0},anchorY:{configurable:!0},rightJustifiedTextSymbolIndex:{configurable:!0},centerJustifiedTextSymbolIndex:{configurable:!0},leftJustifiedTextSymbolIndex:{configurable:!0},verticalPlacedTextSymbolIndex:{configurable:!0},placedIconSymbolIndex:{configurable:!0},verticalPlacedIconSymbolIndex:{configurable:!0},key:{configurable:!0},textBoxStartIndex:{configurable:!0},textBoxEndIndex:{configurable:!0},verticalTextBoxStartIndex:{configurable:!0},verticalTextBoxEndIndex:{configurable:!0},iconBoxStartIndex:{configurable:!0},iconBoxEndIndex:{configurable:!0},verticalIconBoxStartIndex:{configurable:!0},verticalIconBoxEndIndex:{configurable:!0},featureIndex:{configurable:!0},numHorizontalGlyphVertices:{configurable:!0},numVerticalGlyphVertices:{configurable:!0},numIconVertices:{configurable:!0},numVerticalIconVertices:{configurable:!0},useRuntimeCollisionCircles:{configurable:!0},crossTileID:{configurable:!0},textBoxScale:{configurable:!0},textOffset0:{configurable:!0},textOffset1:{configurable:!0},collisionCircleDiameter:{configurable:!0}};return Z.anchorX.get=function(){return this._structArray.int16[this._pos2+0]},Z.anchorY.get=function(){return this._structArray.int16[this._pos2+1]},Z.rightJustifiedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+2]},Z.centerJustifiedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+3]},Z.leftJustifiedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+4]},Z.verticalPlacedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+5]},Z.placedIconSymbolIndex.get=function(){return this._structArray.int16[this._pos2+6]},Z.verticalPlacedIconSymbolIndex.get=function(){return this._structArray.int16[this._pos2+7]},Z.key.get=function(){return this._structArray.uint16[this._pos2+8]},Z.textBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+9]},Z.textBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+10]},Z.verticalTextBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+11]},Z.verticalTextBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+12]},Z.iconBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+13]},Z.iconBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+14]},Z.verticalIconBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+15]},Z.verticalIconBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+16]},Z.featureIndex.get=function(){return this._structArray.uint16[this._pos2+17]},Z.numHorizontalGlyphVertices.get=function(){return this._structArray.uint16[this._pos2+18]},Z.numVerticalGlyphVertices.get=function(){return this._structArray.uint16[this._pos2+19]},Z.numIconVertices.get=function(){return this._structArray.uint16[this._pos2+20]},Z.numVerticalIconVertices.get=function(){return this._structArray.uint16[this._pos2+21]},Z.useRuntimeCollisionCircles.get=function(){return this._structArray.uint16[this._pos2+22]},Z.crossTileID.get=function(){return this._structArray.uint32[this._pos4+12]},Z.crossTileID.set=function(ie){this._structArray.uint32[this._pos4+12]=ie},Z.textBoxScale.get=function(){return this._structArray.float32[this._pos4+13]},Z.textOffset0.get=function(){return this._structArray.float32[this._pos4+14]},Z.textOffset1.get=function(){return this._structArray.float32[this._pos4+15]},Z.collisionCircleDiameter.get=function(){return this._structArray.float32[this._pos4+16]},Object.defineProperties(O.prototype,Z),O}(_s);Qe.prototype.size=68;var at=function(A){function O(){A.apply(this,arguments)}return A&&(O.__proto__=A),(O.prototype=Object.create(A&&A.prototype)).constructor=O,O.prototype.get=function(Z){return new Qe(this,Z)},O}(ol);Wr("SymbolInstanceArray",at);var _t=function(A){function O(){A.apply(this,arguments)}return A&&(O.__proto__=A),(O.prototype=Object.create(A&&A.prototype)).constructor=O,O.prototype.getoffsetX=function(Z){return this.float32[1*Z+0]},O}(ce);Wr("GlyphOffsetArray",_t);var Et=function(A){function O(){A.apply(this,arguments)}return A&&(O.__proto__=A),(O.prototype=Object.create(A&&A.prototype)).constructor=O,O.prototype.getx=function(Z){return this.int16[3*Z+0]},O.prototype.gety=function(Z){return this.int16[3*Z+1]},O.prototype.gettileUnitDistanceFromAnchor=function(Z){return this.int16[3*Z+2]},O}(C);Wr("SymbolLineVertexArray",Et);var Tt=function(A){function O(){A.apply(this,arguments)}A&&(O.__proto__=A),(O.prototype=Object.create(A&&A.prototype)).constructor=O;var Z={featureIndex:{configurable:!0},sourceLayerIndex:{configurable:!0},bucketIndex:{configurable:!0}};return Z.featureIndex.get=function(){return this._structArray.uint32[this._pos4+0]},Z.sourceLayerIndex.get=function(){return this._structArray.uint16[this._pos2+2]},Z.bucketIndex.get=function(){return this._structArray.uint16[this._pos2+3]},Object.defineProperties(O.prototype,Z),O}(_s);Tt.prototype.size=8;var Mt=function(A){function O(){A.apply(this,arguments)}return A&&(O.__proto__=A),(O.prototype=Object.create(A&&A.prototype)).constructor=O,O.prototype.get=function(Z){return new Tt(this,Z)},O}(D);Wr("FeatureIndexArray",Mt);var bt=na([{name:"a_pos",components:2,type:"Int16"}],4).members,Dt=function(A){void 0===A&&(A=[]),this.segments=A};function It(A,O){return 256*(A=u(Math.floor(A),0,255))+u(Math.floor(O),0,255)}Dt.prototype.prepareSegment=function(A,O,Z,ie){var pe=this.segments[this.segments.length-1];return A>Dt.MAX_VERTEX_ARRAY_LENGTH&&M("Max vertices per segment is "+Dt.MAX_VERTEX_ARRAY_LENGTH+": bucket requested "+A),(!pe||pe.vertexLength+A>Dt.MAX_VERTEX_ARRAY_LENGTH||pe.sortKey!==ie)&&(pe={vertexOffset:O.length,primitiveOffset:Z.length,vertexLength:0,primitiveLength:0},void 0!==ie&&(pe.sortKey=ie),this.segments.push(pe)),pe},Dt.prototype.get=function(){return this.segments},Dt.prototype.destroy=function(){for(var A=0,O=this.segments;A<O.length;A+=1){var Z=O[A];for(var ie in Z.vaos)Z.vaos[ie].destroy()}},Dt.simpleSegment=function(A,O,Z,ie){return new Dt([{vertexOffset:A,primitiveOffset:O,vertexLength:Z,primitiveLength:ie,vaos:{},sortKey:0}])},Dt.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,Wr("SegmentVector",Dt);var Nt=na([{name:"a_pattern_from",components:4,type:"Uint16"},{name:"a_pattern_to",components:4,type:"Uint16"},{name:"a_pixel_ratio_from",components:1,type:"Uint8"},{name:"a_pixel_ratio_to",components:1,type:"Uint8"}]),nr=n(function(A){A.exports=function(O,Z){var ie,pe,xe,Ce,je,$e,ut,vt;for(pe=O.length-(ie=3&O.length),xe=Z,je=3432918353,$e=461845907,vt=0;vt<pe;)ut=255&O.charCodeAt(vt)|(255&O.charCodeAt(++vt))<<8|(255&O.charCodeAt(++vt))<<16|(255&O.charCodeAt(++vt))<<24,++vt,xe=27492+(65535&(Ce=5*(65535&(xe=(xe^=ut=(65535&(ut=(ut=(65535&ut)*je+(((ut>>>16)*je&65535)<<16)&4294967295)<<15|ut>>>17))*$e+(((ut>>>16)*$e&65535)<<16)&4294967295)<<13|xe>>>19))+((5*(xe>>>16)&65535)<<16)&4294967295))+((58964+(Ce>>>16)&65535)<<16);switch(ut=0,ie){case 3:ut^=(255&O.charCodeAt(vt+2))<<16;case 2:ut^=(255&O.charCodeAt(vt+1))<<8;case 1:xe^=ut=(65535&(ut=(ut=(65535&(ut^=255&O.charCodeAt(vt)))*je+(((ut>>>16)*je&65535)<<16)&4294967295)<<15|ut>>>17))*$e+(((ut>>>16)*$e&65535)<<16)&4294967295}return xe^=O.length,xe=2246822507*(65535&(xe^=xe>>>16))+((2246822507*(xe>>>16)&65535)<<16)&4294967295,xe=3266489909*(65535&(xe^=xe>>>13))+((3266489909*(xe>>>16)&65535)<<16)&4294967295,(xe^=xe>>>16)>>>0}}),dr=n(function(A){A.exports=function(O,Z){for(var ie,pe=O.length,xe=Z^pe,Ce=0;pe>=4;)ie=1540483477*(65535&(ie=255&O.charCodeAt(Ce)|(255&O.charCodeAt(++Ce))<<8|(255&O.charCodeAt(++Ce))<<16|(255&O.charCodeAt(++Ce))<<24))+((1540483477*(ie>>>16)&65535)<<16),xe=1540483477*(65535&xe)+((1540483477*(xe>>>16)&65535)<<16)^(ie=1540483477*(65535&(ie^=ie>>>24))+((1540483477*(ie>>>16)&65535)<<16)),pe-=4,++Ce;switch(pe){case 3:xe^=(255&O.charCodeAt(Ce+2))<<16;case 2:xe^=(255&O.charCodeAt(Ce+1))<<8;case 1:xe=1540483477*(65535&(xe^=255&O.charCodeAt(Ce)))+((1540483477*(xe>>>16)&65535)<<16)}return xe=1540483477*(65535&(xe^=xe>>>13))+((1540483477*(xe>>>16)&65535)<<16),(xe^=xe>>>15)>>>0}}),Sr=nr,Kr=dr;Sr.murmur3=nr,Sr.murmur2=Kr;var Jr=function(){this.ids=[],this.positions=[],this.indexed=!1};Jr.prototype.add=function(A,O,Z,ie){this.ids.push(an(A)),this.positions.push(O,Z,ie)},Jr.prototype.getPositions=function(A){for(var O=an(A),Z=0,ie=this.ids.length-1;Z<ie;){var pe=Z+ie>>1;this.ids[pe]>=O?ie=pe:Z=pe+1}for(var xe=[];this.ids[Z]===O;)xe.push({index:this.positions[3*Z],start:this.positions[3*Z+1],end:this.positions[3*Z+2]}),Z++;return xe},Jr.serialize=function(A,O){var Z=new Float64Array(A.ids),ie=new Uint32Array(A.positions);return function pe(xe,Ce,je,$e){for(;je<$e;){for(var ut=xe[je+$e>>1],vt=je-1,zt=$e+1;;){do{vt++}while(xe[vt]<ut);do{zt--}while(xe[zt]>ut);if(vt>=zt)break;jn(xe,vt,zt),jn(Ce,3*vt,3*zt),jn(Ce,3*vt+1,3*zt+1),jn(Ce,3*vt+2,3*zt+2)}zt-je<$e-zt?(pe(xe,Ce,je,zt),je=zt+1):(pe(xe,Ce,zt+1,$e),$e=zt)}}(Z,ie,0,Z.length-1),O&&O.push(Z.buffer,ie.buffer),{ids:Z,positions:ie}},Jr.deserialize=function(A){var O=new Jr;return O.ids=A.ids,O.positions=A.positions,O.indexed=!0,O};var cn=Math.pow(2,53)-1;function an(A){var O=+A;return!isNaN(O)&&O<=cn?O:Sr(String(A))}function jn(A,O,Z){var ie=A[O];A[O]=A[Z],A[Z]=ie}Wr("FeaturePositionMap",Jr);var Wn=function(A,O){this.gl=A.gl,this.location=O},ui=function(A){function O(Z,ie){A.call(this,Z,ie),this.current=0}return A&&(O.__proto__=A),(O.prototype=Object.create(A&&A.prototype)).constructor=O,O.prototype.set=function(Z){this.current!==Z&&(this.current=Z,this.gl.uniform1i(this.location,Z))},O}(Wn),Gr=function(A){function O(Z,ie){A.call(this,Z,ie),this.current=0}return A&&(O.__proto__=A),(O.prototype=Object.create(A&&A.prototype)).constructor=O,O.prototype.set=function(Z){this.current!==Z&&(this.current=Z,this.gl.uniform1f(this.location,Z))},O}(Wn),Tn=function(A){function O(Z,ie){A.call(this,Z,ie),this.current=[0,0]}return A&&(O.__proto__=A),(O.prototype=Object.create(A&&A.prototype)).constructor=O,O.prototype.set=function(Z){Z[0]===this.current[0]&&Z[1]===this.current[1]||(this.current=Z,this.gl.uniform2f(this.location,Z[0],Z[1]))},O}(Wn),Xn=function(A){function O(Z,ie){A.call(this,Z,ie),this.current=[0,0,0]}return A&&(O.__proto__=A),(O.prototype=Object.create(A&&A.prototype)).constructor=O,O.prototype.set=function(Z){Z[0]===this.current[0]&&Z[1]===this.current[1]&&Z[2]===this.current[2]||(this.current=Z,this.gl.uniform3f(this.location,Z[0],Z[1],Z[2]))},O}(Wn),Hn=function(A){function O(Z,ie){A.call(this,Z,ie),this.current=[0,0,0,0]}return A&&(O.__proto__=A),(O.prototype=Object.create(A&&A.prototype)).constructor=O,O.prototype.set=function(Z){Z[0]===this.current[0]&&Z[1]===this.current[1]&&Z[2]===this.current[2]&&Z[3]===this.current[3]||(this.current=Z,this.gl.uniform4f(this.location,Z[0],Z[1],Z[2],Z[3]))},O}(Wn),ni=function(A){function O(Z,ie){A.call(this,Z,ie),this.current=Jt.transparent}return A&&(O.__proto__=A),(O.prototype=Object.create(A&&A.prototype)).constructor=O,O.prototype.set=function(Z){Z.r===this.current.r&&Z.g===this.current.g&&Z.b===this.current.b&&Z.a===this.current.a||(this.current=Z,this.gl.uniform4f(this.location,Z.r,Z.g,Z.b,Z.a))},O}(Wn),hi=new Float32Array(16),Si=function(A){function O(Z,ie){A.call(this,Z,ie),this.current=hi}return A&&(O.__proto__=A),(O.prototype=Object.create(A&&A.prototype)).constructor=O,O.prototype.set=function(Z){if(Z[12]!==this.current[12]||Z[0]!==this.current[0])return this.current=Z,void this.gl.uniformMatrix4fv(this.location,!1,Z);for(var ie=1;ie<16;ie++)if(Z[ie]!==this.current[ie]){this.current=Z,this.gl.uniformMatrix4fv(this.location,!1,Z);break}},O}(Wn);function $n(A){return[It(255*A.r,255*A.g),It(255*A.b,255*A.a)]}var xi=function(A,O,Z){this.value=A,this.uniformNames=O.map(function(ie){return"u_"+ie}),this.type=Z};xi.prototype.setUniform=function(A,O,Z){A.set(Z.constantOr(this.value))},xi.prototype.getBinding=function(A,O,Z){return"color"===this.type?new ni(A,O):new Gr(A,O)};var mi=function(A,O){this.uniformNames=O.map(function(Z){return"u_"+Z}),this.patternFrom=null,this.patternTo=null,this.pixelRatioFrom=1,this.pixelRatioTo=1};mi.prototype.setConstantPatternPositions=function(A,O){this.pixelRatioFrom=O.pixelRatio,this.pixelRatioTo=A.pixelRatio,this.patternFrom=O.tlbr,this.patternTo=A.tlbr},mi.prototype.setUniform=function(A,O,Z,ie){var pe="u_pattern_to"===ie?this.patternTo:"u_pattern_from"===ie?this.patternFrom:"u_pixel_ratio_to"===ie?this.pixelRatioTo:"u_pixel_ratio_from"===ie?this.pixelRatioFrom:null;pe&&A.set(pe)},mi.prototype.getBinding=function(A,O,Z){return"u_pattern"===Z.substr(0,9)?new Hn(A,O):new Gr(A,O)};var Ci=function(A,O,Z,ie){this.expression=A,this.type=Z,this.maxValue=0,this.paintVertexAttributes=O.map(function(pe){return{name:"a_"+pe,type:"Float32",components:"color"===Z?2:1,offset:0}}),this.paintVertexArray=new ie};Ci.prototype.populatePaintArray=function(A,O,Z,ie,pe){var xe=this.paintVertexArray.length,Ce=this.expression.evaluate(new ra(0),O,{},ie,[],pe);this.paintVertexArray.resize(A),this._setPaintValue(xe,A,Ce)},Ci.prototype.updatePaintArray=function(A,O,Z,ie){var pe=this.expression.evaluate({zoom:0},Z,ie);this._setPaintValue(A,O,pe)},Ci.prototype._setPaintValue=function(A,O,Z){if("color"===this.type)for(var ie=$n(Z),pe=A;pe<O;pe++)this.paintVertexArray.emplace(pe,ie[0],ie[1]);else{for(var xe=A;xe<O;xe++)this.paintVertexArray.emplace(xe,Z);this.maxValue=Math.max(this.maxValue,Math.abs(Z))}},Ci.prototype.upload=function(A){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=A.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))},Ci.prototype.destroy=function(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()};var bi=function(A,O,Z,ie,pe,xe){this.expression=A,this.uniformNames=O.map(function(Ce){return"u_"+Ce+"_t"}),this.type=Z,this.useIntegerZoom=ie,this.zoom=pe,this.maxValue=0,this.paintVertexAttributes=O.map(function(Ce){return{name:"a_"+Ce,type:"Float32",components:"color"===Z?4:2,offset:0}}),this.paintVertexArray=new xe};bi.prototype.populatePaintArray=function(A,O,Z,ie,pe){var xe=this.expression.evaluate(new ra(this.zoom),O,{},ie,[],pe),Ce=this.expression.evaluate(new ra(this.zoom+1),O,{},ie,[],pe),je=this.paintVertexArray.length;this.paintVertexArray.resize(A),this._setPaintValue(je,A,xe,Ce)},bi.prototype.updatePaintArray=function(A,O,Z,ie){var pe=this.expression.evaluate({zoom:this.zoom},Z,ie),xe=this.expression.evaluate({zoom:this.zoom+1},Z,ie);this._setPaintValue(A,O,pe,xe)},bi.prototype._setPaintValue=function(A,O,Z,ie){if("color"===this.type)for(var pe=$n(Z),xe=$n(ie),Ce=A;Ce<O;Ce++)this.paintVertexArray.emplace(Ce,pe[0],pe[1],xe[0],xe[1]);else{for(var je=A;je<O;je++)this.paintVertexArray.emplace(je,Z,ie);this.maxValue=Math.max(this.maxValue,Math.abs(Z),Math.abs(ie))}},bi.prototype.upload=function(A){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=A.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))},bi.prototype.destroy=function(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()},bi.prototype.setUniform=function(A,O){var Z=this.useIntegerZoom?Math.floor(O.zoom):O.zoom,ie=u(this.expression.interpolationFactor(Z,this.zoom,this.zoom+1),0,1);A.set(ie)},bi.prototype.getBinding=function(A,O,Z){return new Gr(A,O)};var Pi=function(A,O,Z,ie,pe,xe){this.expression=A,this.type=O,this.useIntegerZoom=Z,this.zoom=ie,this.layerId=xe,this.zoomInPaintVertexArray=new pe,this.zoomOutPaintVertexArray=new pe};Pi.prototype.populatePaintArray=function(A,O,Z){var ie=this.zoomInPaintVertexArray.length;this.zoomInPaintVertexArray.resize(A),this.zoomOutPaintVertexArray.resize(A),this._setPaintValues(ie,A,O.patterns&&O.patterns[this.layerId],Z)},Pi.prototype.updatePaintArray=function(A,O,Z,ie,pe){this._setPaintValues(A,O,Z.patterns&&Z.patterns[this.layerId],pe)},Pi.prototype._setPaintValues=function(A,O,Z,ie){if(ie&&Z){var je=ie[Z.min],$e=ie[Z.mid],ut=ie[Z.max];if(je&&$e&&ut)for(var vt=A;vt<O;vt++)this.zoomInPaintVertexArray.emplace(vt,$e.tl[0],$e.tl[1],$e.br[0],$e.br[1],je.tl[0],je.tl[1],je.br[0],je.br[1],$e.pixelRatio,je.pixelRatio),this.zoomOutPaintVertexArray.emplace(vt,$e.tl[0],$e.tl[1],$e.br[0],$e.br[1],ut.tl[0],ut.tl[1],ut.br[0],ut.br[1],$e.pixelRatio,ut.pixelRatio)}},Pi.prototype.upload=function(A){this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer&&(this.zoomInPaintVertexBuffer=A.createVertexBuffer(this.zoomInPaintVertexArray,Nt.members,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=A.createVertexBuffer(this.zoomOutPaintVertexArray,Nt.members,this.expression.isStateDependent))},Pi.prototype.destroy=function(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()};var Ui=function(A,O,Z,ie){this.binders={},this.layoutAttributes=ie,this._buffers=[];var pe=[];for(var xe in A.paint._values)if(Z(xe)){var Ce=A.paint.get(xe);if(Ce instanceof Da&&jo(Ce.property.specification)){var je=Ca(xe,A.type),$e=Ce.value,ut=Ce.property.specification.type,vt=Ce.property.useIntegerZoom,zt=Ce.property.specification["property-type"],Yt="cross-faded"===zt||"cross-faded-data-driven"===zt;if("constant"===$e.kind)this.binders[xe]=Yt?new mi($e.value,je):new xi($e.value,je,ut),pe.push("/u_"+xe);else if("source"===$e.kind||Yt){var qt=Pa(xe,ut,"source");this.binders[xe]=Yt?new Pi($e,ut,vt,O,qt,A.id):new Ci($e,je,ut,qt),pe.push("/a_"+xe)}else{var ar=Pa(xe,ut,"composite");this.binders[xe]=new bi($e,je,ut,vt,O,ar),pe.push("/z_"+xe)}}}this.cacheKey=pe.sort().join("")};Ui.prototype.getMaxValue=function(A){var O=this.binders[A];return O instanceof Ci||O instanceof bi?O.maxValue:0},Ui.prototype.populatePaintArrays=function(A,O,Z,ie,pe){for(var xe in this.binders){var Ce=this.binders[xe];(Ce instanceof Ci||Ce instanceof bi||Ce instanceof Pi)&&Ce.populatePaintArray(A,O,Z,ie,pe)}},Ui.prototype.setConstantPatternPositions=function(A,O){for(var Z in this.binders){var ie=this.binders[Z];ie instanceof mi&&ie.setConstantPatternPositions(A,O)}},Ui.prototype.updatePaintArrays=function(A,O,Z,ie,pe){var xe=!1;for(var Ce in A)for(var je=0,$e=O.getPositions(Ce);je<$e.length;je+=1){var ut=$e[je],vt=Z.feature(ut.index);for(var zt in this.binders){var Yt=this.binders[zt];if((Yt instanceof Ci||Yt instanceof bi||Yt instanceof Pi)&&!0===Yt.expression.isStateDependent){var qt=ie.paint.get(zt);Yt.expression=qt.value,Yt.updatePaintArray(ut.start,ut.end,vt,A[Ce],pe),xe=!0}}}return xe},Ui.prototype.defines=function(){var A=[];for(var O in this.binders){var Z=this.binders[O];(Z instanceof xi||Z instanceof mi)&&A.push.apply(A,Z.uniformNames.map(function(ie){return"#define HAS_UNIFORM_"+ie}))}return A},Ui.prototype.getPaintVertexBuffers=function(){return this._buffers},Ui.prototype.getUniforms=function(A,O){var Z=[];for(var ie in this.binders){var pe=this.binders[ie];if(pe instanceof xi||pe instanceof mi||pe instanceof bi)for(var xe=0,Ce=pe.uniformNames;xe<Ce.length;xe+=1){var je=Ce[xe];if(O[je]){var $e=pe.getBinding(A,O[je],je);Z.push({name:je,property:ie,binding:$e})}}}return Z},Ui.prototype.setUniforms=function(A,O,Z,ie){for(var pe=0,xe=O;pe<xe.length;pe+=1){var Ce=xe[pe],je=Ce.name,$e=Ce.property;this.binders[$e].setUniform(Ce.binding,ie,Z.get($e),je)}},Ui.prototype.updatePaintBuffers=function(A){for(var O in this._buffers=[],this.binders){var Z=this.binders[O];if(A&&Z instanceof Pi){var ie=2===A.fromScale?Z.zoomInPaintVertexBuffer:Z.zoomOutPaintVertexBuffer;ie&&this._buffers.push(ie)}else(Z instanceof Ci||Z instanceof bi)&&Z.paintVertexBuffer&&this._buffers.push(Z.paintVertexBuffer)}},Ui.prototype.upload=function(A){for(var O in this.binders){var Z=this.binders[O];(Z instanceof Ci||Z instanceof bi||Z instanceof Pi)&&Z.upload(A)}this.updatePaintBuffers()},Ui.prototype.destroy=function(){for(var A in this.binders){var O=this.binders[A];(O instanceof Ci||O instanceof bi||O instanceof Pi)&&O.destroy()}};var ca=function(A,O,Z,ie){void 0===ie&&(ie=function(){return!0}),this.programConfigurations={};for(var pe=0,xe=O;pe<xe.length;pe+=1){var Ce=xe[pe];this.programConfigurations[Ce.id]=new Ui(Ce,Z,ie,A)}this.needsUpload=!1,this._featureMap=new Jr,this._bufferOffset=0};function Ca(A,O){return{"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-extrusion-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"]}[A]||[A.replace(O+"-","").replace(/-/g,"_")]}function Pa(A,O,Z){var pe={"line-pattern":{source:gs,composite:gs},"fill-pattern":{source:gs,composite:gs},"fill-extrusion-pattern":{source:gs,composite:gs}}[A];return pe&&pe[Z]||{color:{source:ae,composite:ue},number:{source:ce,composite:ae}}[O][Z]}ca.prototype.populatePaintArrays=function(A,O,Z,ie,pe,xe){for(var Ce in this.programConfigurations)this.programConfigurations[Ce].populatePaintArrays(A,O,ie,pe,xe);void 0!==O.id&&this._featureMap.add(O.id,Z,this._bufferOffset,A),this._bufferOffset=A,this.needsUpload=!0},ca.prototype.updatePaintArrays=function(A,O,Z,ie){for(var pe=0,xe=Z;pe<xe.length;pe+=1){var Ce=xe[pe];this.needsUpload=this.programConfigurations[Ce.id].updatePaintArrays(A,this._featureMap,O,Ce,ie)||this.needsUpload}},ca.prototype.get=function(A){return this.programConfigurations[A]},ca.prototype.upload=function(A){if(this.needsUpload){for(var O in this.programConfigurations)this.programConfigurations[O].upload(A);this.needsUpload=!1}},ca.prototype.destroy=function(){for(var A in this.programConfigurations)this.programConfigurations[A].destroy()},Wr("ConstantBinder",xi),Wr("CrossFadedConstantBinder",mi),Wr("SourceExpressionBinder",Ci),Wr("CrossFadedCompositeBinder",Pi),Wr("CompositeExpressionBinder",bi),Wr("ProgramConfiguration",Ui,{omit:["_buffers"]}),Wr("ProgramConfigurationSet",ca);var Ta=(15,{min:-1*Math.pow(2,14),max:Math.pow(2,14)-1});function ga(A){for(var O=8192/A.extent,Z=A.loadGeometry(),ie=0;ie<Z.length;ie++)for(var pe=Z[ie],xe=0;xe<pe.length;xe++){var Ce=pe[xe];Ce.x=Math.round(Ce.x*O),Ce.y=Math.round(Ce.y*O),(Ce.x<Ta.min||Ce.x>Ta.max||Ce.y<Ta.min||Ce.y>Ta.max)&&(M("Geometry exceeds allowed extent, reduce your vector tile buffer size"),Ce.x=u(Ce.x,Ta.min,Ta.max),Ce.y=u(Ce.y,Ta.min,Ta.max))}return Z}function vo(A,O,Z,ie,pe){A.emplaceBack(2*O+(ie+1)/2,2*Z+(pe+1)/2)}var qa=function(A){this.zoom=A.zoom,this.overscaling=A.overscaling,this.layers=A.layers,this.layerIds=this.layers.map(function(O){return O.id}),this.index=A.index,this.hasPattern=!1,this.layoutVertexArray=new ns,this.indexArray=new eo,this.segments=new Dt,this.programConfigurations=new ca(bt,A.layers,A.zoom),this.stateDependentLayerIds=this.layers.filter(function(O){return O.isStateDependent()}).map(function(O){return O.id})};function Oo(A,O){for(var Z=0;Z<A.length;Z++)if($o(O,A[Z]))return!0;for(var ie=0;ie<O.length;ie++)if($o(A,O[ie]))return!0;return!!Js(A,O)}function ms(A,O,Z){return!!$o(A,O)||!!yo(O,A,Z)}function Rs(A,O){if(1===A.length)return ll(O,A[0]);for(var Z=0;Z<O.length;Z++)for(var ie=O[Z],pe=0;pe<ie.length;pe++)if($o(A,ie[pe]))return!0;for(var xe=0;xe<A.length;xe++)if(ll(O,A[xe]))return!0;for(var Ce=0;Ce<O.length;Ce++)if(Js(A,O[Ce]))return!0;return!1}function sl(A,O,Z){if(A.length>1){if(Js(A,O))return!0;for(var ie=0;ie<O.length;ie++)if(yo(O[ie],A,Z))return!0}for(var pe=0;pe<A.length;pe++)if(yo(A[pe],O,Z))return!0;return!1}function Js(A,O){if(0===A.length||0===O.length)return!1;for(var Z=0;Z<A.length-1;Z++)for(var ie=A[Z],pe=A[Z+1],xe=0;xe<O.length-1;xe++)if(Ks(ie,pe,O[xe],O[xe+1]))return!0;return!1}function Ks(A,O,Z,ie){return I(A,Z,ie)!==I(O,Z,ie)&&I(A,O,Z)!==I(A,O,ie)}function yo(A,O,Z){var ie=Z*Z;if(1===O.length)return A.distSqr(O[0])<ie;for(var pe=1;pe<O.length;pe++)if(Us(A,O[pe-1],O[pe])<ie)return!0;return!1}function Us(A,O,Z){var ie=O.distSqr(Z);if(0===ie)return A.distSqr(O);var pe=((A.x-O.x)*(Z.x-O.x)+(A.y-O.y)*(Z.y-O.y))/ie;return A.distSqr(pe<0?O:pe>1?Z:Z.sub(O)._mult(pe)._add(O))}function ll(A,O){for(var Z,ie,pe,xe=!1,Ce=0;Ce<A.length;Ce++)for(var je=0,$e=(Z=A[Ce]).length-1;je<Z.length;$e=je++)(ie=Z[je]).y>O.y!=(pe=Z[$e]).y>O.y&&O.x<(pe.x-ie.x)*(O.y-ie.y)/(pe.y-ie.y)+ie.x&&(xe=!xe);return xe}function $o(A,O){for(var Z=!1,ie=0,pe=A.length-1;ie<A.length;pe=ie++){var xe=A[ie],Ce=A[pe];xe.y>O.y!=Ce.y>O.y&&O.x<(Ce.x-xe.x)*(O.y-xe.y)/(Ce.y-xe.y)+xe.x&&(Z=!Z)}return Z}function cl(A,O,Z){var ie=Z[0],pe=Z[2];if(A.x<ie.x&&O.x<ie.x||A.x>pe.x&&O.x>pe.x||A.y<ie.y&&O.y<ie.y||A.y>pe.y&&O.y>pe.y)return!1;var xe=I(A,O,Z[0]);return xe!==I(A,O,Z[1])||xe!==I(A,O,Z[2])||xe!==I(A,O,Z[3])}function ka(A,O,Z){var ie=O.paint.get(A).value;return"constant"===ie.kind?ie.value:Z.programConfigurations.get(O.id).getMaxValue(A)}function Lo(A){return Math.sqrt(A[0]*A[0]+A[1]*A[1])}function Co(A,O,Z,ie,pe){if(!O[0]&&!O[1])return A;var xe=r.convert(O)._mult(pe);"viewport"===Z&&xe._rotate(-ie);for(var Ce=[],je=0;je<A.length;je++)Ce.push(A[je].sub(xe));return Ce}qa.prototype.populate=function(A,O,Z){var ie=this.layers[0],pe=[],xe=null;"circle"===ie.type&&(xe=ie.layout.get("circle-sort-key"));for(var Ce=0,je=A;Ce<je.length;Ce+=1){var $e=je[Ce],ut=$e.feature,vt=$e.id,zt=$e.index,Yt=$e.sourceLayerIndex,qt=this.layers[0]._featureFilter.needGeometry,ar={type:ut.type,id:vt,properties:ut.properties,geometry:qt?ga(ut):[]};if(this.layers[0]._featureFilter.filter(new ra(this.zoom),ar,Z)){qt||(ar.geometry=ga(ut));var yr=xe?xe.evaluate(ar,{},Z):void 0;pe.push({id:vt,properties:ut.properties,type:ut.type,sourceLayerIndex:Yt,index:zt,geometry:ar.geometry,patterns:{},sortKey:yr})}}xe&&pe.sort(function(Gn,ai){return Gn.sortKey-ai.sortKey});for(var Lr=0,jr=pe;Lr<jr.length;Lr+=1){var Ur=jr[Lr],ln=Ur.geometry,yn=Ur.index,Bn=Ur.sourceLayerIndex,Rn=A[yn].feature;this.addFeature(Ur,ln,yn,Z),O.featureIndex.insert(Rn,ln,yn,Bn,this.index)}},qa.prototype.update=function(A,O,Z){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(A,O,this.stateDependentLayers,Z)},qa.prototype.isEmpty=function(){return 0===this.layoutVertexArray.length},qa.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},qa.prototype.upload=function(A){this.uploaded||(this.layoutVertexBuffer=A.createVertexBuffer(this.layoutVertexArray,bt),this.indexBuffer=A.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(A),this.uploaded=!0},qa.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())},qa.prototype.addFeature=function(A,O,Z,ie){for(var pe=0,xe=O;pe<xe.length;pe+=1)for(var Ce=0,je=xe[pe];Ce<je.length;Ce+=1){var $e=je[Ce],ut=$e.x,vt=$e.y;if(!(ut<0||ut>=8192||vt<0||vt>=8192)){var zt=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,A.sortKey),Yt=zt.vertexLength;vo(this.layoutVertexArray,ut,vt,-1,-1),vo(this.layoutVertexArray,ut,vt,1,-1),vo(this.layoutVertexArray,ut,vt,1,1),vo(this.layoutVertexArray,ut,vt,-1,1),this.indexArray.emplaceBack(Yt,Yt+1,Yt+2),this.indexArray.emplaceBack(Yt,Yt+3,Yt+2),zt.vertexLength+=4,zt.primitiveLength+=2}}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,A,Z,{},ie)},Wr("CircleBucket",qa,{omit:["layers"]});var yl=new Eo({"circle-sort-key":new yi(ye.layout_circle["circle-sort-key"])}),Xc={paint:new Eo({"circle-radius":new yi(ye.paint_circle["circle-radius"]),"circle-color":new yi(ye.paint_circle["circle-color"]),"circle-blur":new yi(ye.paint_circle["circle-blur"]),"circle-opacity":new yi(ye.paint_circle["circle-opacity"]),"circle-translate":new ci(ye.paint_circle["circle-translate"]),"circle-translate-anchor":new ci(ye.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new ci(ye.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new ci(ye.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new yi(ye.paint_circle["circle-stroke-width"]),"circle-stroke-color":new yi(ye.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new yi(ye.paint_circle["circle-stroke-opacity"])}),layout:yl},Go=typeof Float32Array<"u"?Float32Array:Array;function Hl(A){return A[0]=1,A[1]=0,A[2]=0,A[3]=0,A[4]=0,A[5]=1,A[6]=0,A[7]=0,A[8]=0,A[9]=0,A[10]=1,A[11]=0,A[12]=0,A[13]=0,A[14]=0,A[15]=1,A}function ul(A,O,Z){var ie=O[0],pe=O[1],xe=O[2],Ce=O[3],je=O[4],$e=O[5],ut=O[6],vt=O[7],zt=O[8],Yt=O[9],qt=O[10],ar=O[11],yr=O[12],Cr=O[13],Lr=O[14],jr=O[15],Ur=Z[0],Zr=Z[1],ln=Z[2],yn=Z[3];return A[0]=Ur*ie+Zr*je+ln*zt+yn*yr,A[1]=Ur*pe+Zr*$e+ln*Yt+yn*Cr,A[2]=Ur*xe+Zr*ut+ln*qt+yn*Lr,A[3]=Ur*Ce+Zr*vt+ln*ar+yn*jr,A[4]=(Ur=Z[4])*ie+(Zr=Z[5])*je+(ln=Z[6])*zt+(yn=Z[7])*yr,A[5]=Ur*pe+Zr*$e+ln*Yt+yn*Cr,A[6]=Ur*xe+Zr*ut+ln*qt+yn*Lr,A[7]=Ur*Ce+Zr*vt+ln*ar+yn*jr,A[8]=(Ur=Z[8])*ie+(Zr=Z[9])*je+(ln=Z[10])*zt+(yn=Z[11])*yr,A[9]=Ur*pe+Zr*$e+ln*Yt+yn*Cr,A[10]=Ur*xe+Zr*ut+ln*qt+yn*Lr,A[11]=Ur*Ce+Zr*vt+ln*ar+yn*jr,A[12]=(Ur=Z[12])*ie+(Zr=Z[13])*je+(ln=Z[14])*zt+(yn=Z[15])*yr,A[13]=Ur*pe+Zr*$e+ln*Yt+yn*Cr,A[14]=Ur*xe+Zr*ut+ln*qt+yn*Lr,A[15]=Ur*Ce+Zr*vt+ln*ar+yn*jr,A}Math.hypot||(Math.hypot=function(){for(var A=arguments,O=0,Z=arguments.length;Z--;)O+=A[Z]*A[Z];return Math.sqrt(O)});var Fs,O,Jc=ul;function Qs(A,O,Z){var ie=O[0],pe=O[1],xe=O[2],Ce=O[3];return A[0]=Z[0]*ie+Z[4]*pe+Z[8]*xe+Z[12]*Ce,A[1]=Z[1]*ie+Z[5]*pe+Z[9]*xe+Z[13]*Ce,A[2]=Z[2]*ie+Z[6]*pe+Z[10]*xe+Z[14]*Ce,A[3]=Z[3]*ie+Z[7]*pe+Z[11]*xe+Z[15]*Ce,A}Fs=new Go(3),Go!=Float32Array&&(Fs[0]=0,Fs[1]=0,Fs[2]=0),O=new Go(4),Go!=Float32Array&&(O[0]=0,O[1]=0,O[2]=0,O[3]=0);var ch=(function(){var O=new Go(2);Go!=Float32Array&&(O[0]=0,O[1]=0)}(),function(A){function O(Z){A.call(this,Z,Xc)}return A&&(O.__proto__=A),(O.prototype=Object.create(A&&A.prototype)).constructor=O,O.prototype.createBucket=function(Z){return new qa(Z)},O.prototype.queryRadius=function(Z){var ie=Z;return ka("circle-radius",this,ie)+ka("circle-stroke-width",this,ie)+Lo(this.paint.get("circle-translate"))},O.prototype.queryIntersectsFeature=function(Z,ie,pe,xe,Ce,je,$e,ut){for(var vt=Co(Z,this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),je.angle,$e),zt=this.paint.get("circle-radius").evaluate(ie,pe)+this.paint.get("circle-stroke-width").evaluate(ie,pe),Yt="map"===this.paint.get("circle-pitch-alignment"),qt=Yt?vt:function(Bn,Rn){return Bn.map(function(Gn){return zu(Gn,Rn)})}(vt,ut),ar=Yt?zt*$e:zt,yr=0,Cr=xe;yr<Cr.length;yr+=1)for(var Lr=0,jr=Cr[yr];Lr<jr.length;Lr+=1){var Ur=jr[Lr],Zr=Yt?Ur:zu(Ur,ut),ln=ar,yn=Qs([],[Ur.x,Ur.y,0,1],ut);if("viewport"===this.paint.get("circle-pitch-scale")&&"map"===this.paint.get("circle-pitch-alignment")?ln*=yn[3]/je.cameraToCenterDistance:"map"===this.paint.get("circle-pitch-scale")&&"viewport"===this.paint.get("circle-pitch-alignment")&&(ln*=je.cameraToCenterDistance/yn[3]),ms(qt,Zr,ln))return!0}return!1},O}(Uo));function zu(A,O){var Z=Qs([],[A.x,A.y,0,1],O);return new r(Z[0]/Z[3],Z[1]/Z[3])}var Ru=function(A){function O(){A.apply(this,arguments)}return A&&(O.__proto__=A),(O.prototype=Object.create(A&&A.prototype)).constructor=O,O}(qa);function $c(A,O,Z,ie){var pe=O.width,xe=O.height;if(ie){if(ie instanceof Uint8ClampedArray)ie=new Uint8Array(ie.buffer);else if(ie.length!==pe*xe*Z)throw new RangeError("mismatched image size")}else ie=new Uint8Array(pe*xe*Z);return A.width=pe,A.height=xe,A.data=ie,A}function Fu(A,O,Z){var ie=O.width,pe=O.height;if(ie!==A.width||pe!==A.height){var xe=$c({},{width:ie,height:pe},Z);eu(A,xe,{x:0,y:0},{x:0,y:0},{width:Math.min(A.width,ie),height:Math.min(A.height,pe)},Z),A.width=ie,A.height=pe,A.data=xe.data}}function eu(A,O,Z,ie,pe,xe){if(0===pe.width||0===pe.height)return O;if(pe.width>A.width||pe.height>A.height||Z.x>A.width-pe.width||Z.y>A.height-pe.height)throw new RangeError("out of range source coordinates for image copy");if(pe.width>O.width||pe.height>O.height||ie.x>O.width-pe.width||ie.y>O.height-pe.height)throw new RangeError("out of range destination coordinates for image copy");for(var Ce=A.data,je=O.data,$e=0;$e<pe.height;$e++)for(var ut=((Z.y+$e)*A.width+Z.x)*xe,vt=((ie.y+$e)*O.width+ie.x)*xe,zt=0;zt<pe.width*xe;zt++)je[vt+zt]=Ce[ut+zt];return O}Wr("HeatmapBucket",Ru,{omit:["layers"]});var fl=function(A,O){$c(this,A,1,O)};fl.prototype.resize=function(A){Fu(this,A,1)},fl.prototype.clone=function(){return new fl({width:this.width,height:this.height},new Uint8Array(this.data))},fl.copy=function(A,O,Z,ie,pe){eu(A,O,Z,ie,pe,1)};var Zo=function(A,O){$c(this,A,4,O)};Zo.prototype.resize=function(A){Fu(this,A,4)},Zo.prototype.replace=function(A,O){O?this.data.set(A):this.data=A instanceof Uint8ClampedArray?new Uint8Array(A.buffer):A},Zo.prototype.clone=function(){return new Zo({width:this.width,height:this.height},new Uint8Array(this.data))},Zo.copy=function(A,O,Z,ie,pe){eu(A,O,Z,ie,pe,4)},Wr("AlphaImage",fl),Wr("RGBAImage",Zo);var uh={paint:new Eo({"heatmap-radius":new yi(ye.paint_heatmap["heatmap-radius"]),"heatmap-weight":new yi(ye.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new ci(ye.paint_heatmap["heatmap-intensity"]),"heatmap-color":new Qo(ye.paint_heatmap["heatmap-color"]),"heatmap-opacity":new ci(ye.paint_heatmap["heatmap-opacity"])})};function Bu(A,O){for(var Z=new Uint8Array(1024),ie={},pe=0,xe=0;pe<256;pe++,xe+=4){ie[O]=pe/255;var Ce=A.evaluate(ie);Z[xe+0]=Math.floor(255*Ce.r/Ce.a),Z[xe+1]=Math.floor(255*Ce.g/Ce.a),Z[xe+2]=Math.floor(255*Ce.b/Ce.a),Z[xe+3]=Math.floor(255*Ce.a)}return new Zo({width:256,height:1},Z)}var fh=function(A){function O(Z){A.call(this,Z,uh),this._updateColorRamp()}return A&&(O.__proto__=A),(O.prototype=Object.create(A&&A.prototype)).constructor=O,O.prototype.createBucket=function(Z){return new Ru(Z)},O.prototype._handleSpecialPaintPropertyUpdate=function(Z){"heatmap-color"===Z&&this._updateColorRamp()},O.prototype._updateColorRamp=function(){this.colorRamp=Bu(this._transitionablePaint._values["heatmap-color"].value.expression,"heatmapDensity"),this.colorRampTexture=null},O.prototype.resize=function(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)},O.prototype.queryRadius=function(){return 0},O.prototype.queryIntersectsFeature=function(){return!1},O.prototype.hasOffscreenPass=function(){return 0!==this.paint.get("heatmap-opacity")&&"none"!==this.visibility},O}(Uo),hh={paint:new Eo({"hillshade-illumination-direction":new ci(ye.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new ci(ye.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new ci(ye.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new ci(ye.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new ci(ye.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new ci(ye.paint_hillshade["hillshade-accent-color"])})},ph=function(A){function O(Z){A.call(this,Z,hh)}return A&&(O.__proto__=A),(O.prototype=Object.create(A&&A.prototype)).constructor=O,O.prototype.hasOffscreenPass=function(){return 0!==this.paint.get("hillshade-exaggeration")&&"none"!==this.visibility},O}(Uo),Nu=na([{name:"a_pos",components:2,type:"Int16"}],4).members,tu=hc,dh=hc;function hc(A,O,Z){Z=Z||2;var ie,pe,xe,Ce,je,$e,ut,vt=O&&O.length,zt=vt?O[0]*Z:A.length,Yt=ju(A,0,zt,Z,!0),qt=[];if(!Yt||Yt.next===Yt.prev)return qt;if(vt&&(Yt=function(yr,Cr,Lr,jr){var Ur,Zr,Bn,Rn=[];for(Ur=0,Zr=Cr.length;Ur<Zr;Ur++)(Bn=ju(yr,Cr[Ur]*jr,Ur<Zr-1?Cr[Ur+1]*jr:yr.length,jr,!1))===Bn.next&&(Bn.steiner=!0),Rn.push(wh(Bn));for(Rn.sort(xh),Ur=0;Ur<Rn.length;Ur++)bh(Rn[Ur],Lr),Lr=$s(Lr,Lr.next);return Lr}(A,O,Yt,Z)),A.length>80*Z){ie=xe=A[0],pe=Ce=A[1];for(var ar=Z;ar<zt;ar+=Z)(je=A[ar])<ie&&(ie=je),($e=A[ar+1])<pe&&(pe=$e),je>xe&&(xe=je),$e>Ce&&(Ce=$e);ut=0!==(ut=Math.max(xe-ie,Ce-pe))?1/ut:0}return Gl(Yt,qt,Z,ie,pe,ut),qt}function ju(A,O,Z,ie,pe){var xe,Ce;if(pe===iu(A,O,Z,ie)>0)for(xe=O;xe<Z;xe+=ie)Ce=qu(xe,A[xe],A[xe+1],Ce);else for(xe=Z-ie;xe>=O;xe-=ie)Ce=qu(xe,A[xe],A[xe+1],Ce);return Ce&&pc(Ce,Ce.next)&&(Yl(Ce),Ce=Ce.next),Ce}function $s(A,O){if(!A)return A;O||(O=A);var Z,ie=A;do{if(Z=!1,ie.steiner||!pc(ie,ie.next)&&0!==to(ie.prev,ie,ie.next))ie=ie.next;else{if(Yl(ie),(ie=O=ie.prev)===ie.next)break;Z=!0}}while(Z||ie!==O);return O}function Gl(A,O,Z,ie,pe,xe,Ce){if(A){!Ce&&xe&&function(vt,zt,Yt,qt){var ar=vt;do{null===ar.z&&(ar.z=ru(ar.x,ar.y,zt,Yt,qt)),ar.prevZ=ar.prev,ar.nextZ=ar.next,ar=ar.next}while(ar!==vt);ar.prevZ.nextZ=null,ar.prevZ=null,function(yr){var Cr,Lr,jr,Ur,Zr,ln,yn,Bn,Rn=1;do{for(Lr=yr,yr=null,Zr=null,ln=0;Lr;){for(ln++,jr=Lr,yn=0,Cr=0;Cr<Rn&&(yn++,jr=jr.nextZ);Cr++);for(Bn=Rn;yn>0||Bn>0&&jr;)0!==yn&&(0===Bn||!jr||Lr.z<=jr.z)?(Ur=Lr,Lr=Lr.nextZ,yn--):(Ur=jr,jr=jr.nextZ,Bn--),Zr?Zr.nextZ=Ur:yr=Ur,Ur.prevZ=Zr,Zr=Ur;Lr=jr}Zr.nextZ=null,Rn*=2}while(ln>1)}(ar)}(A,ie,pe,xe);for(var je,$e,ut=A;A.prev!==A.next;)if(je=A.prev,$e=A.next,xe?mh(A,ie,pe,xe):gh(A))O.push(je.i/Z),O.push(A.i/Z),O.push($e.i/Z),Yl(A),A=$e.next,ut=$e.next;else if((A=$e)===ut){Ce?1===Ce?Gl(A=vh($s(A),O,Z),O,Z,ie,pe,xe,2):2===Ce&&yh(A,O,Z,ie,pe,xe):Gl($s(A),O,Z,ie,pe,xe,1);break}}}function gh(A){var O=A.prev,Z=A,ie=A.next;if(to(O,Z,ie)>=0)return!1;for(var pe=A.next.next;pe!==A.prev;){if(xl(O.x,O.y,Z.x,Z.y,ie.x,ie.y,pe.x,pe.y)&&to(pe.prev,pe,pe.next)>=0)return!1;pe=pe.next}return!0}function mh(A,O,Z,ie){var pe=A.prev,xe=A,Ce=A.next;if(to(pe,xe,Ce)>=0)return!1;for(var ut=pe.x>xe.x?pe.x>Ce.x?pe.x:Ce.x:xe.x>Ce.x?xe.x:Ce.x,vt=pe.y>xe.y?pe.y>Ce.y?pe.y:Ce.y:xe.y>Ce.y?xe.y:Ce.y,zt=ru(pe.x<xe.x?pe.x<Ce.x?pe.x:Ce.x:xe.x<Ce.x?xe.x:Ce.x,pe.y<xe.y?pe.y<Ce.y?pe.y:Ce.y:xe.y<Ce.y?xe.y:Ce.y,O,Z,ie),Yt=ru(ut,vt,O,Z,ie),qt=A.prevZ,ar=A.nextZ;qt&&qt.z>=zt&&ar&&ar.z<=Yt;){if(qt!==A.prev&&qt!==A.next&&xl(pe.x,pe.y,xe.x,xe.y,Ce.x,Ce.y,qt.x,qt.y)&&to(qt.prev,qt,qt.next)>=0||(qt=qt.prevZ,ar!==A.prev&&ar!==A.next&&xl(pe.x,pe.y,xe.x,xe.y,Ce.x,Ce.y,ar.x,ar.y)&&to(ar.prev,ar,ar.next)>=0))return!1;ar=ar.nextZ}for(;qt&&qt.z>=zt;){if(qt!==A.prev&&qt!==A.next&&xl(pe.x,pe.y,xe.x,xe.y,Ce.x,Ce.y,qt.x,qt.y)&&to(qt.prev,qt,qt.next)>=0)return!1;qt=qt.prevZ}for(;ar&&ar.z<=Yt;){if(ar!==A.prev&&ar!==A.next&&xl(pe.x,pe.y,xe.x,xe.y,Ce.x,Ce.y,ar.x,ar.y)&&to(ar.prev,ar,ar.next)>=0)return!1;ar=ar.nextZ}return!0}function vh(A,O,Z){var ie=A;do{var pe=ie.prev,xe=ie.next.next;!pc(pe,xe)&&Uu(pe,ie,ie.next,xe)&&Zl(pe,xe)&&Zl(xe,pe)&&(O.push(pe.i/Z),O.push(ie.i/Z),O.push(xe.i/Z),Yl(ie),Yl(ie.next),ie=A=xe),ie=ie.next}while(ie!==A);return $s(ie)}function yh(A,O,Z,ie,pe,xe){var Ce=A;do{for(var je=Ce.next.next;je!==Ce.prev;){if(Ce.i!==je.i&&Th(Ce,je)){var $e=Vu(Ce,je);return Ce=$s(Ce,Ce.next),$e=$s($e,$e.next),Gl(Ce,O,Z,ie,pe,xe),void Gl($e,O,Z,ie,pe,xe)}je=je.next}Ce=Ce.next}while(Ce!==A)}function xh(A,O){return A.x-O.x}function bh(A,O){if(O=function(ie,pe){var xe,Ce=pe,je=ie.x,$e=ie.y,ut=-1/0;do{if($e<=Ce.y&&$e>=Ce.next.y&&Ce.next.y!==Ce.y){var vt=Ce.x+($e-Ce.y)*(Ce.next.x-Ce.x)/(Ce.next.y-Ce.y);if(vt<=je&&vt>ut){if(ut=vt,vt===je){if($e===Ce.y)return Ce;if($e===Ce.next.y)return Ce.next}xe=Ce.x<Ce.next.x?Ce:Ce.next}}Ce=Ce.next}while(Ce!==pe);if(!xe)return null;if(je===ut)return xe;var zt,Yt=xe,qt=xe.x,ar=xe.y,yr=1/0;Ce=xe;do{je>=Ce.x&&Ce.x>=qt&&je!==Ce.x&&xl($e<ar?je:ut,$e,qt,ar,$e<ar?ut:je,$e,Ce.x,Ce.y)&&(zt=Math.abs($e-Ce.y)/(je-Ce.x),Zl(Ce,ie)&&(zt<yr||zt===yr&&(Ce.x>xe.x||Ce.x===xe.x&&_h(xe,Ce)))&&(xe=Ce,yr=zt)),Ce=Ce.next}while(Ce!==Yt);return xe}(A,O)){var Z=Vu(O,A);$s(O,O.next),$s(Z,Z.next)}}function _h(A,O){return to(A.prev,A,O.prev)<0&&to(O.next,A,A.next)<0}function ru(A,O,Z,ie,pe){return(A=1431655765&((A=858993459&((A=252645135&((A=16711935&((A=32767*(A-Z)*pe)|A<<8))|A<<4))|A<<2))|A<<1))|(O=1431655765&((O=858993459&((O=252645135&((O=16711935&((O=32767*(O-ie)*pe)|O<<8))|O<<4))|O<<2))|O<<1))<<1}function wh(A){var O=A,Z=A;do{(O.x<Z.x||O.x===Z.x&&O.y<Z.y)&&(Z=O),O=O.next}while(O!==A);return Z}function xl(A,O,Z,ie,pe,xe,Ce,je){return(pe-Ce)*(O-je)-(A-Ce)*(xe-je)>=0&&(A-Ce)*(ie-je)-(Z-Ce)*(O-je)>=0&&(Z-Ce)*(xe-je)-(pe-Ce)*(ie-je)>=0}function Th(A,O){return A.next.i!==O.i&&A.prev.i!==O.i&&!function(Z,ie){var pe=Z;do{if(pe.i!==Z.i&&pe.next.i!==Z.i&&pe.i!==ie.i&&pe.next.i!==ie.i&&Uu(pe,pe.next,Z,ie))return!0;pe=pe.next}while(pe!==Z);return!1}(A,O)&&(Zl(A,O)&&Zl(O,A)&&function(Z,ie){var pe=Z,xe=!1,Ce=(Z.x+ie.x)/2,je=(Z.y+ie.y)/2;do{pe.y>je!=pe.next.y>je&&pe.next.y!==pe.y&&Ce<(pe.next.x-pe.x)*(je-pe.y)/(pe.next.y-pe.y)+pe.x&&(xe=!xe),pe=pe.next}while(pe!==Z);return xe}(A,O)&&(to(A.prev,A,O.prev)||to(A,O.prev,O))||pc(A,O)&&to(A.prev,A,A.next)>0&&to(O.prev,O,O.next)>0)}function to(A,O,Z){return(O.y-A.y)*(Z.x-O.x)-(O.x-A.x)*(Z.y-O.y)}function pc(A,O){return A.x===O.x&&A.y===O.y}function Uu(A,O,Z,ie){var pe=gc(to(A,O,Z)),xe=gc(to(A,O,ie)),Ce=gc(to(Z,ie,A)),je=gc(to(Z,ie,O));return pe!==xe&&Ce!==je||!(0!==pe||!dc(A,Z,O))||!(0!==xe||!dc(A,ie,O))||!(0!==Ce||!dc(Z,A,ie))||!(0!==je||!dc(Z,O,ie))}function dc(A,O,Z){return O.x<=Math.max(A.x,Z.x)&&O.x>=Math.min(A.x,Z.x)&&O.y<=Math.max(A.y,Z.y)&&O.y>=Math.min(A.y,Z.y)}function gc(A){return A>0?1:A<0?-1:0}function Zl(A,O){return to(A.prev,A,A.next)<0?to(A,O,A.next)>=0&&to(A,A.prev,O)>=0:to(A,O,A.prev)<0||to(A,A.next,O)<0}function Vu(A,O){var Z=new nu(A.i,A.x,A.y),ie=new nu(O.i,O.x,O.y),pe=A.next,xe=O.prev;return A.next=O,O.prev=A,Z.next=pe,pe.prev=Z,ie.next=Z,Z.prev=ie,xe.next=ie,ie.prev=xe,ie}function qu(A,O,Z,ie){var pe=new nu(A,O,Z);return ie?(pe.next=ie.next,pe.prev=ie,ie.next.prev=pe,ie.next=pe):(pe.prev=pe,pe.next=pe),pe}function Yl(A){A.next.prev=A.prev,A.prev.next=A.next,A.prevZ&&(A.prevZ.nextZ=A.nextZ),A.nextZ&&(A.nextZ.prevZ=A.prevZ)}function nu(A,O,Z){this.i=A,this.x=O,this.y=Z,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function iu(A,O,Z,ie){for(var pe=0,xe=O,Ce=Z-ie;xe<Z;xe+=ie)pe+=(A[Ce]-A[xe])*(A[xe+1]+A[Ce+1]),Ce=xe;return pe}function kh(A,O,Z,ie,pe){!function xe(Ce,je,$e,ut,vt){for(;ut>$e;){if(ut-$e>600){var zt=ut-$e+1,Yt=je-$e+1,qt=Math.log(zt),ar=.5*Math.exp(2*qt/3),yr=.5*Math.sqrt(qt*ar*(zt-ar)/zt)*(Yt-zt/2<0?-1:1);xe(Ce,je,Math.max($e,Math.floor(je-Yt*ar/zt+yr)),Math.min(ut,Math.floor(je+(zt-Yt)*ar/zt+yr)),vt)}var jr=Ce[je],Ur=$e,Zr=ut;for(Wl(Ce,$e,je),vt(Ce[ut],jr)>0&&Wl(Ce,$e,ut);Ur<Zr;){for(Wl(Ce,Ur,Zr),Ur++,Zr--;vt(Ce[Ur],jr)<0;)Ur++;for(;vt(Ce[Zr],jr)>0;)Zr--}0===vt(Ce[$e],jr)?Wl(Ce,$e,Zr):Wl(Ce,++Zr,ut),Zr<=je&&($e=Zr+1),je<=Zr&&(ut=Zr-1)}}(A,O,Z||0,ie||A.length-1,pe||Ah)}function Wl(A,O,Z){var ie=A[O];A[O]=A[Z],A[Z]=ie}function Ah(A,O){return A<O?-1:A>O?1:0}function au(A,O){var Z=A.length;if(Z<=1)return[A];for(var ie,pe,xe=[],Ce=0;Ce<Z;Ce++){var je=P(A[Ce]);0!==je&&(A[Ce].area=Math.abs(je),void 0===pe&&(pe=je<0),pe===je<0?(ie&&xe.push(ie),ie=[A[Ce]]):ie.push(A[Ce]))}if(ie&&xe.push(ie),O>1)for(var $e=0;$e<xe.length;$e++)xe[$e].length<=O||(kh(xe[$e],O,1,xe[$e].length-1,Mh),xe[$e]=xe[$e].slice(0,O));return xe}function Mh(A,O){return O.area-A.area}function ou(A,O,Z){for(var ie=Z.patternDependencies,pe=!1,xe=0,Ce=O;xe<Ce.length;xe+=1){var je=Ce[xe].paint.get(A+"-pattern");je.isConstant()||(pe=!0);var $e=je.constantOr(null);$e&&(pe=!0,ie[$e.to]=!0,ie[$e.from]=!0)}return pe}function su(A,O,Z,ie,pe){for(var xe=pe.patternDependencies,Ce=0,je=O;Ce<je.length;Ce+=1){var $e=je[Ce],ut=$e.paint.get(A+"-pattern").value;if("constant"!==ut.kind){var vt=ut.evaluate({zoom:ie-1},Z,{},pe.availableImages),zt=ut.evaluate({zoom:ie},Z,{},pe.availableImages),Yt=ut.evaluate({zoom:ie+1},Z,{},pe.availableImages);zt=zt&&zt.name?zt.name:zt,Yt=Yt&&Yt.name?Yt.name:Yt,xe[vt=vt&&vt.name?vt.name:vt]=!0,xe[zt]=!0,xe[Yt]=!0,Z.patterns[$e.id]={min:vt,mid:zt,max:Yt}}}return Z}hc.deviation=function(A,O,Z,ie){var pe=O&&O.length,Ce=Math.abs(iu(A,0,pe?O[0]*Z:A.length,Z));if(pe)for(var je=0,$e=O.length;je<$e;je++)Ce-=Math.abs(iu(A,O[je]*Z,je<$e-1?O[je+1]*Z:A.length,Z));var zt=0;for(je=0;je<ie.length;je+=3){var Yt=ie[je]*Z,qt=ie[je+1]*Z,ar=ie[je+2]*Z;zt+=Math.abs((A[Yt]-A[ar])*(A[qt+1]-A[Yt+1])-(A[Yt]-A[qt])*(A[ar+1]-A[Yt+1]))}return 0===Ce&&0===zt?0:Math.abs((zt-Ce)/Ce)},hc.flatten=function(A){for(var O=A[0][0].length,Z={vertices:[],holes:[],dimensions:O},ie=0,pe=0;pe<A.length;pe++){for(var xe=0;xe<A[pe].length;xe++)for(var Ce=0;Ce<O;Ce++)Z.vertices.push(A[pe][xe][Ce]);pe>0&&Z.holes.push(ie+=A[pe-1].length)}return Z},tu.default=dh;var As=function(A){this.zoom=A.zoom,this.overscaling=A.overscaling,this.layers=A.layers,this.layerIds=this.layers.map(function(O){return O.id}),this.index=A.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new ns,this.indexArray=new eo,this.indexArray2=new F,this.programConfigurations=new ca(Nu,A.layers,A.zoom),this.segments=new Dt,this.segments2=new Dt,this.stateDependentLayerIds=this.layers.filter(function(O){return O.isStateDependent()}).map(function(O){return O.id})};As.prototype.populate=function(A,O,Z){this.hasPattern=ou("fill",this.layers,O);for(var ie=this.layers[0].layout.get("fill-sort-key"),pe=[],xe=0,Ce=A;xe<Ce.length;xe+=1){var je=Ce[xe],$e=je.feature,ut=je.id,vt=je.index,zt=je.sourceLayerIndex,Yt=this.layers[0]._featureFilter.needGeometry,qt={type:$e.type,id:ut,properties:$e.properties,geometry:Yt?ga($e):[]};if(this.layers[0]._featureFilter.filter(new ra(this.zoom),qt,Z)){Yt||(qt.geometry=ga($e));var ar=ie?ie.evaluate(qt,{},Z,O.availableImages):void 0;pe.push({id:ut,properties:$e.properties,type:$e.type,sourceLayerIndex:zt,index:vt,geometry:qt.geometry,patterns:{},sortKey:ar})}}ie&&pe.sort(function(Gn,ai){return Gn.sortKey-ai.sortKey});for(var Cr=0,Lr=pe;Cr<Lr.length;Cr+=1){var jr=Lr[Cr],Zr=jr.geometry,ln=jr.index,yn=jr.sourceLayerIndex;if(this.hasPattern){var Bn=su("fill",this.layers,jr,this.zoom,O);this.patternFeatures.push(Bn)}else this.addFeature(jr,Zr,ln,Z,{});O.featureIndex.insert(A[ln].feature,Zr,ln,yn,this.index)}},As.prototype.update=function(A,O,Z){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(A,O,this.stateDependentLayers,Z)},As.prototype.addFeatures=function(A,O,Z){for(var ie=0,pe=this.patternFeatures;ie<pe.length;ie+=1){var xe=pe[ie];this.addFeature(xe,xe.geometry,xe.index,O,Z)}},As.prototype.isEmpty=function(){return 0===this.layoutVertexArray.length},As.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},As.prototype.upload=function(A){this.uploaded||(this.layoutVertexBuffer=A.createVertexBuffer(this.layoutVertexArray,Nu),this.indexBuffer=A.createIndexBuffer(this.indexArray),this.indexBuffer2=A.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(A),this.uploaded=!0},As.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())},As.prototype.addFeature=function(A,O,Z,ie,pe){for(var xe=0,Ce=au(O,500);xe<Ce.length;xe+=1){for(var je=Ce[xe],$e=0,ut=0,vt=je;ut<vt.length;ut+=1)$e+=vt[ut].length;for(var zt=this.segments.prepareSegment($e,this.layoutVertexArray,this.indexArray),Yt=zt.vertexLength,qt=[],ar=[],yr=0,Cr=je;yr<Cr.length;yr+=1){var Lr=Cr[yr];if(0!==Lr.length){Lr!==je[0]&&ar.push(qt.length/2);var jr=this.segments2.prepareSegment(Lr.length,this.layoutVertexArray,this.indexArray2),Ur=jr.vertexLength;this.layoutVertexArray.emplaceBack(Lr[0].x,Lr[0].y),this.indexArray2.emplaceBack(Ur+Lr.length-1,Ur),qt.push(Lr[0].x),qt.push(Lr[0].y);for(var Zr=1;Zr<Lr.length;Zr++)this.layoutVertexArray.emplaceBack(Lr[Zr].x,Lr[Zr].y),this.indexArray2.emplaceBack(Ur+Zr-1,Ur+Zr),qt.push(Lr[Zr].x),qt.push(Lr[Zr].y);jr.vertexLength+=Lr.length,jr.primitiveLength+=Lr.length}}for(var ln=tu(qt,ar),yn=0;yn<ln.length;yn+=3)this.indexArray.emplaceBack(Yt+ln[yn],Yt+ln[yn+1],Yt+ln[yn+2]);zt.vertexLength+=$e,zt.primitiveLength+=ln.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,A,Z,pe,ie)},Wr("FillBucket",As,{omit:["layers","patternFeatures"]});var Sh=new Eo({"fill-sort-key":new yi(ye.layout_fill["fill-sort-key"])}),Eh={paint:new Eo({"fill-antialias":new ci(ye.paint_fill["fill-antialias"]),"fill-opacity":new yi(ye.paint_fill["fill-opacity"]),"fill-color":new yi(ye.paint_fill["fill-color"]),"fill-outline-color":new yi(ye.paint_fill["fill-outline-color"]),"fill-translate":new ci(ye.paint_fill["fill-translate"]),"fill-translate-anchor":new ci(ye.paint_fill["fill-translate-anchor"]),"fill-pattern":new Ds(ye.paint_fill["fill-pattern"])}),layout:Sh},Lh=function(A){function O(Z){A.call(this,Z,Eh)}return A&&(O.__proto__=A),(O.prototype=Object.create(A&&A.prototype)).constructor=O,O.prototype.recalculate=function(Z,ie){A.prototype.recalculate.call(this,Z,ie);var pe=this.paint._values["fill-outline-color"];"constant"===pe.value.kind&&void 0===pe.value.value&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])},O.prototype.createBucket=function(Z){return new As(Z)},O.prototype.queryRadius=function(){return Lo(this.paint.get("fill-translate"))},O.prototype.queryIntersectsFeature=function(Z,ie,pe,xe,Ce,je,$e){return Rs(Co(Z,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),je.angle,$e),xe)},O.prototype.isTileClipped=function(){return!0},O}(Uo),Hu=na([{name:"a_pos",components:2,type:"Int16"},{name:"a_normal_ed",components:4,type:"Int16"}],4).members,Gu=bl;function bl(A,O,Z,ie,pe){this.properties={},this.extent=Z,this.type=0,this._pbf=A,this._geometry=-1,this._keys=ie,this._values=pe,A.readFields(Ch,this,O)}function Ch(A,O,Z){1==A?O.id=Z.readVarint():2==A?function(ie,pe){for(var xe=ie.readVarint()+ie.pos;ie.pos<xe;){var Ce=pe._keys[ie.readVarint()],je=pe._values[ie.readVarint()];pe.properties[Ce]=je}}(Z,O):3==A?O.type=Z.readVarint():4==A&&(O._geometry=Z.pos)}function Ph(A){for(var O,Z,ie=0,pe=0,xe=A.length,Ce=xe-1;pe<xe;Ce=pe++)ie+=((Z=A[Ce]).x-(O=A[pe]).x)*(O.y+Z.y);return ie}bl.types=["Unknown","Point","LineString","Polygon"],bl.prototype.loadGeometry=function(){var A=this._pbf;A.pos=this._geometry;for(var O,Z=A.readVarint()+A.pos,ie=1,pe=0,xe=0,Ce=0,je=[];A.pos<Z;){if(pe<=0){var $e=A.readVarint();ie=7&$e,pe=$e>>3}if(pe--,1===ie||2===ie)xe+=A.readSVarint(),Ce+=A.readSVarint(),1===ie&&(O&&je.push(O),O=[]),O.push(new r(xe,Ce));else{if(7!==ie)throw new Error("unknown command "+ie);O&&O.push(O[0].clone())}}return O&&je.push(O),je},bl.prototype.bbox=function(){var A=this._pbf;A.pos=this._geometry;for(var O=A.readVarint()+A.pos,Z=1,ie=0,pe=0,xe=0,Ce=1/0,je=-1/0,$e=1/0,ut=-1/0;A.pos<O;){if(ie<=0){var vt=A.readVarint();Z=7&vt,ie=vt>>3}if(ie--,1===Z||2===Z)(pe+=A.readSVarint())<Ce&&(Ce=pe),pe>je&&(je=pe),(xe+=A.readSVarint())<$e&&($e=xe),xe>ut&&(ut=xe);else if(7!==Z)throw new Error("unknown command "+Z)}return[Ce,$e,je,ut]},bl.prototype.toGeoJSON=function(A,O,Z){var ie,pe,xe=this.extent*Math.pow(2,Z),Ce=this.extent*A,je=this.extent*O,$e=this.loadGeometry(),ut=bl.types[this.type];function vt(qt){for(var ar=0;ar<qt.length;ar++){var yr=qt[ar];qt[ar]=[360*(yr.x+Ce)/xe-180,360/Math.PI*Math.atan(Math.exp((180-360*(yr.y+je)/xe)*Math.PI/180))-90]}}switch(this.type){case 1:var zt=[];for(ie=0;ie<$e.length;ie++)zt[ie]=$e[ie][0];vt($e=zt);break;case 2:for(ie=0;ie<$e.length;ie++)vt($e[ie]);break;case 3:for($e=function(qt){var ar=qt.length;if(ar<=1)return[qt];for(var yr,Cr,Lr=[],jr=0;jr<ar;jr++){var Ur=Ph(qt[jr]);0!==Ur&&(void 0===Cr&&(Cr=Ur<0),Cr===Ur<0?(yr&&Lr.push(yr),yr=[qt[jr]]):yr.push(qt[jr]))}return yr&&Lr.push(yr),Lr}($e),ie=0;ie<$e.length;ie++)for(pe=0;pe<$e[ie].length;pe++)vt($e[ie][pe])}1===$e.length?$e=$e[0]:ut="Multi"+ut;var Yt={type:"Feature",geometry:{type:ut,coordinates:$e},properties:this.properties};return"id"in this&&(Yt.id=this.id),Yt};var Zu=Yu;function Yu(A,O){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=A,this._keys=[],this._values=[],this._features=[],A.readFields(Ih,this,O),this.length=this._features.length}function Ih(A,O,Z){15===A?O.version=Z.readVarint():1===A?O.name=Z.readString():5===A?O.extent=Z.readVarint():2===A?O._features.push(Z.pos):3===A?O._keys.push(Z.readString()):4===A&&O._values.push(function(ie){for(var pe=null,xe=ie.readVarint()+ie.pos;ie.pos<xe;){var Ce=ie.readVarint()>>3;pe=1===Ce?ie.readString():2===Ce?ie.readFloat():3===Ce?ie.readDouble():4===Ce?ie.readVarint64():5===Ce?ie.readVarint():6===Ce?ie.readSVarint():7===Ce?ie.readBoolean():null}return pe}(Z))}function Oh(A,O,Z){if(3===A){var ie=new Zu(Z,Z.readVarint()+Z.pos);ie.length&&(O[ie.name]=ie)}}Yu.prototype.feature=function(A){if(A<0||A>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[A];var O=this._pbf.readVarint()+this._pbf.pos;return new Gu(this._pbf,O,this.extent,this._keys,this._values)};var _l={VectorTile:function(A,O){this.layers=A.readFields(Oh,{},O)},VectorTileFeature:Gu,VectorTileLayer:Zu},Dh=_l.VectorTileFeature.types,lu=Math.pow(2,13);function Xl(A,O,Z,ie,pe,xe,Ce,je){A.emplaceBack(O,Z,2*Math.floor(ie*lu)+Ce,pe*lu*2,xe*lu*2,Math.round(je))}var Ms=function(A){this.zoom=A.zoom,this.overscaling=A.overscaling,this.layers=A.layers,this.layerIds=this.layers.map(function(O){return O.id}),this.index=A.index,this.hasPattern=!1,this.layoutVertexArray=new fs,this.indexArray=new eo,this.programConfigurations=new ca(Hu,A.layers,A.zoom),this.segments=new Dt,this.stateDependentLayerIds=this.layers.filter(function(O){return O.isStateDependent()}).map(function(O){return O.id})};function zh(A,O){return A.x===O.x&&(A.x<0||A.x>8192)||A.y===O.y&&(A.y<0||A.y>8192)}function Rh(A){return A.every(function(O){return O.x<0})||A.every(function(O){return O.x>8192})||A.every(function(O){return O.y<0})||A.every(function(O){return O.y>8192})}Ms.prototype.populate=function(A,O,Z){this.features=[],this.hasPattern=ou("fill-extrusion",this.layers,O);for(var ie=0,pe=A;ie<pe.length;ie+=1){var xe=pe[ie],Ce=xe.feature,je=xe.id,$e=xe.index,ut=xe.sourceLayerIndex,vt=this.layers[0]._featureFilter.needGeometry,zt={type:Ce.type,id:je,properties:Ce.properties,geometry:vt?ga(Ce):[]};if(this.layers[0]._featureFilter.filter(new ra(this.zoom),zt,Z)){var Yt={id:je,sourceLayerIndex:ut,index:$e,geometry:vt?zt.geometry:ga(Ce),properties:Ce.properties,type:Ce.type,patterns:{}};void 0!==Ce.id&&(Yt.id=Ce.id),this.hasPattern?this.features.push(su("fill-extrusion",this.layers,Yt,this.zoom,O)):this.addFeature(Yt,Yt.geometry,$e,Z,{}),O.featureIndex.insert(Ce,Yt.geometry,$e,ut,this.index,!0)}}},Ms.prototype.addFeatures=function(A,O,Z){for(var ie=0,pe=this.features;ie<pe.length;ie+=1){var xe=pe[ie];this.addFeature(xe,xe.geometry,xe.index,O,Z)}},Ms.prototype.update=function(A,O,Z){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(A,O,this.stateDependentLayers,Z)},Ms.prototype.isEmpty=function(){return 0===this.layoutVertexArray.length},Ms.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},Ms.prototype.upload=function(A){this.uploaded||(this.layoutVertexBuffer=A.createVertexBuffer(this.layoutVertexArray,Hu),this.indexBuffer=A.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(A),this.uploaded=!0},Ms.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())},Ms.prototype.addFeature=function(A,O,Z,ie,pe){for(var xe=0,Ce=au(O,500);xe<Ce.length;xe+=1){for(var je=Ce[xe],$e=0,ut=0,vt=je;ut<vt.length;ut+=1)$e+=vt[ut].length;for(var zt=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray),Yt=0,qt=je;Yt<qt.length;Yt+=1){var ar=qt[Yt];if(0!==ar.length&&!Rh(ar))for(var yr=0,Cr=0;Cr<ar.length;Cr++){var Lr=ar[Cr];if(Cr>=1){var jr=ar[Cr-1];if(!zh(Lr,jr)){zt.vertexLength+4>Dt.MAX_VERTEX_ARRAY_LENGTH&&(zt=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));var Ur=Lr.sub(jr)._perp()._unit(),Zr=jr.dist(Lr);yr+Zr>32768&&(yr=0),Xl(this.layoutVertexArray,Lr.x,Lr.y,Ur.x,Ur.y,0,0,yr),Xl(this.layoutVertexArray,Lr.x,Lr.y,Ur.x,Ur.y,0,1,yr),Xl(this.layoutVertexArray,jr.x,jr.y,Ur.x,Ur.y,0,0,yr+=Zr),Xl(this.layoutVertexArray,jr.x,jr.y,Ur.x,Ur.y,0,1,yr);var ln=zt.vertexLength;this.indexArray.emplaceBack(ln,ln+2,ln+1),this.indexArray.emplaceBack(ln+1,ln+2,ln+3),zt.vertexLength+=4,zt.primitiveLength+=2}}}}if(zt.vertexLength+$e>Dt.MAX_VERTEX_ARRAY_LENGTH&&(zt=this.segments.prepareSegment($e,this.layoutVertexArray,this.indexArray)),"Polygon"===Dh[A.type]){for(var yn=[],Bn=[],Rn=zt.vertexLength,Gn=0,ai=je;Gn<ai.length;Gn+=1){var oi=ai[Gn];if(0!==oi.length){oi!==je[0]&&Bn.push(yn.length/2);for(var Kn=0;Kn<oi.length;Kn++){var pi=oi[Kn];Xl(this.layoutVertexArray,pi.x,pi.y,0,0,1,1,0),yn.push(pi.x),yn.push(pi.y)}}}for(var fi=tu(yn,Bn),si=0;si<fi.length;si+=3)this.indexArray.emplaceBack(Rn+fi[si],Rn+fi[si+2],Rn+fi[si+1]);zt.primitiveLength+=fi.length/3,zt.vertexLength+=$e}}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,A,Z,pe,ie)},Wr("FillExtrusionBucket",Ms,{omit:["layers","features"]});var Fh={paint:new Eo({"fill-extrusion-opacity":new ci(ye["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new yi(ye["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new ci(ye["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new ci(ye["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new Ds(ye["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new yi(ye["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new yi(ye["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new ci(ye["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])})},Bh=function(A){function O(Z){A.call(this,Z,Fh)}return A&&(O.__proto__=A),(O.prototype=Object.create(A&&A.prototype)).constructor=O,O.prototype.createBucket=function(Z){return new Ms(Z)},O.prototype.queryRadius=function(){return Lo(this.paint.get("fill-extrusion-translate"))},O.prototype.is3D=function(){return!0},O.prototype.queryIntersectsFeature=function(Z,ie,pe,xe,Ce,je,$e,ut){var vt=Co(Z,this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),je.angle,$e),zt=this.paint.get("fill-extrusion-height").evaluate(ie,pe),Yt=this.paint.get("fill-extrusion-base").evaluate(ie,pe),qt=function(yr,Cr,Lr,jr){for(var Ur=[],Zr=0,ln=yr;Zr<ln.length;Zr+=1){var yn=ln[Zr],Bn=[yn.x,yn.y,0,1];Qs(Bn,Bn,Cr),Ur.push(new r(Bn[0]/Bn[3],Bn[1]/Bn[3]))}return Ur}(vt,ut),ar=function(yr,Cr,Lr,jr){for(var Ur=[],Zr=[],ln=jr[8]*Cr,yn=jr[9]*Cr,Bn=jr[10]*Cr,Rn=jr[11]*Cr,Gn=jr[8]*Lr,ai=jr[9]*Lr,oi=jr[10]*Lr,Kn=jr[11]*Lr,pi=0,fi=yr;pi<fi.length;pi+=1){for(var Ki=[],Vi=[],ea=0,_i=fi[pi];ea<_i.length;ea+=1){var Hi=_i[ea],va=Hi.x,ua=Hi.y,Ma=jr[0]*va+jr[4]*ua+jr[12],fa=jr[1]*va+jr[5]*ua+jr[13],io=jr[2]*va+jr[6]*ua+jr[14],Sa=jr[3]*va+jr[7]*ua+jr[15],Po=io+Bn,bo=Sa+Rn,To=Ma+Gn,Vo=fa+ai,zo=io+oi,ao=Sa+Kn,ko=new r((Ma+ln)/bo,(fa+yn)/bo);ko.z=Po/bo,Ki.push(ko);var Za=new r(To/ao,Vo/ao);Za.z=zo/ao,Vi.push(Za)}Ur.push(Ki),Zr.push(Vi)}return[Ur,Zr]}(xe,Yt,zt,ut);return function(yr,Cr,Lr){var jr=1/0;Rs(Lr,Cr)&&(jr=Wu(Lr,Cr[0]));for(var Ur=0;Ur<Cr.length;Ur++)for(var Zr=Cr[Ur],ln=yr[Ur],yn=0;yn<Zr.length-1;yn++){var Bn=Zr[yn],oi=[Bn,Zr[yn+1],ln[yn+1],ln[yn],Bn];Oo(Lr,oi)&&(jr=Math.min(jr,Wu(Lr,oi)))}return jr!==1/0&&jr}(ar[0],ar[1],qt)},O}(Uo);function Jl(A,O){return A.x*O.x+A.y*O.y}function Wu(A,O){if(1===A.length){for(var Z,ie=0,pe=O[ie++];!Z||pe.equals(Z);)if(!(Z=O[ie++]))return 1/0;for(;ie<O.length;ie++){var xe=O[ie],Ce=A[0],je=Z.sub(pe),$e=xe.sub(pe),ut=Ce.sub(pe),vt=Jl(je,je),zt=Jl(je,$e),Yt=Jl($e,$e),qt=Jl(ut,je),ar=Jl(ut,$e),yr=vt*Yt-zt*zt,Cr=(Yt*qt-zt*ar)/yr,Lr=(vt*ar-zt*qt)/yr,Ur=pe.z*(1-Cr-Lr)+Z.z*Cr+xe.z*Lr;if(isFinite(Ur))return Ur}return 1/0}for(var Zr=1/0,ln=0,yn=O;ln<yn.length;ln+=1)Zr=Math.min(Zr,yn[ln].z);return Zr}var Xu=na([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"}],4).members,Nh=_l.VectorTileFeature.types,jh=Math.cos(Math.PI/180*37.5),Ju=Math.pow(2,14)/.5,Yo=function(A){this.zoom=A.zoom,this.overscaling=A.overscaling,this.layers=A.layers,this.layerIds=this.layers.map(function(O){return O.id}),this.index=A.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new ws,this.indexArray=new eo,this.programConfigurations=new ca(Xu,A.layers,A.zoom),this.segments=new Dt,this.stateDependentLayerIds=this.layers.filter(function(O){return O.isStateDependent()}).map(function(O){return O.id})};Yo.prototype.populate=function(A,O,Z){this.hasPattern=ou("line",this.layers,O);for(var ie=this.layers[0].layout.get("line-sort-key"),pe=[],xe=0,Ce=A;xe<Ce.length;xe+=1){var je=Ce[xe],$e=je.feature,ut=je.id,vt=je.index,zt=je.sourceLayerIndex,Yt=this.layers[0]._featureFilter.needGeometry,qt={type:$e.type,id:ut,properties:$e.properties,geometry:Yt?ga($e):[]};if(this.layers[0]._featureFilter.filter(new ra(this.zoom),qt,Z)){Yt||(qt.geometry=ga($e));var ar=ie?ie.evaluate(qt,{},Z):void 0;pe.push({id:ut,properties:$e.properties,type:$e.type,sourceLayerIndex:zt,index:vt,geometry:qt.geometry,patterns:{},sortKey:ar})}}ie&&pe.sort(function(Gn,ai){return Gn.sortKey-ai.sortKey});for(var Cr=0,Lr=pe;Cr<Lr.length;Cr+=1){var jr=Lr[Cr],Zr=jr.geometry,ln=jr.index,yn=jr.sourceLayerIndex;if(this.hasPattern){var Bn=su("line",this.layers,jr,this.zoom,O);this.patternFeatures.push(Bn)}else this.addFeature(jr,Zr,ln,Z,{});O.featureIndex.insert(A[ln].feature,Zr,ln,yn,this.index)}},Yo.prototype.update=function(A,O,Z){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(A,O,this.stateDependentLayers,Z)},Yo.prototype.addFeatures=function(A,O,Z){for(var ie=0,pe=this.patternFeatures;ie<pe.length;ie+=1){var xe=pe[ie];this.addFeature(xe,xe.geometry,xe.index,O,Z)}},Yo.prototype.isEmpty=function(){return 0===this.layoutVertexArray.length},Yo.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},Yo.prototype.upload=function(A){this.uploaded||(this.layoutVertexBuffer=A.createVertexBuffer(this.layoutVertexArray,Xu),this.indexBuffer=A.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(A),this.uploaded=!0},Yo.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())},Yo.prototype.addFeature=function(A,O,Z,ie,pe){for(var xe=this.layers[0].layout,Ce=xe.get("line-join").evaluate(A,{}),je=xe.get("line-cap"),$e=xe.get("line-miter-limit"),ut=xe.get("line-round-limit"),vt=0,zt=O;vt<zt.length;vt+=1)this.addLine(zt[vt],A,Ce,je,$e,ut);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,A,Z,pe,ie)},Yo.prototype.addLine=function(A,O,Z,ie,pe,xe){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,O.properties&&O.properties.hasOwnProperty("mapbox_clip_start")&&O.properties.hasOwnProperty("mapbox_clip_end")){this.clipStart=+O.properties.mapbox_clip_start,this.clipEnd=+O.properties.mapbox_clip_end;for(var Ce=0;Ce<A.length-1;Ce++)this.totalDistance+=A[Ce].dist(A[Ce+1]);this.updateScaledDistance()}for(var je="Polygon"===Nh[O.type],$e=A.length;$e>=2&&A[$e-1].equals(A[$e-2]);)$e--;for(var ut=0;ut<$e-1&&A[ut].equals(A[ut+1]);)ut++;if(!($e<(je?3:2))){"bevel"===Z&&(pe=1.05);var vt,zt=this.overscaling<=16?122880/(512*this.overscaling):0,Yt=this.segments.prepareSegment(10*$e,this.layoutVertexArray,this.indexArray),qt=void 0,ar=void 0,yr=void 0,Cr=void 0;this.e1=this.e2=-1,je&&(Cr=A[ut].sub(vt=A[$e-2])._unit()._perp());for(var Lr=ut;Lr<$e;Lr++)if(!(ar=Lr===$e-1?je?A[ut+1]:void 0:A[Lr+1])||!A[Lr].equals(ar)){Cr&&(yr=Cr),vt&&(qt=vt),vt=A[Lr],Cr=ar?ar.sub(vt)._unit()._perp():yr;var jr=(yr=yr||Cr).add(Cr);0===jr.x&&0===jr.y||jr._unit();var Ur=yr.x*Cr.x+yr.y*Cr.y,Zr=jr.x*Cr.x+jr.y*Cr.y,ln=0!==Zr?1/Zr:1/0,yn=2*Math.sqrt(2-2*Zr),Bn=Zr<jh&&qt&&ar,Rn=yr.x*Cr.y-yr.y*Cr.x>0;if(Bn&&Lr>ut){var Gn=vt.dist(qt);if(Gn>2*zt){var ai=vt.sub(vt.sub(qt)._mult(zt/Gn)._round());this.updateDistance(qt,ai),this.addCurrentVertex(ai,yr,0,0,Yt),qt=ai}}var oi=qt&&ar,Kn=oi?Z:je?"butt":ie;if(oi&&"round"===Kn&&(ln<xe?Kn="miter":ln<=2&&(Kn="fakeround")),"miter"===Kn&&ln>pe&&(Kn="bevel"),"bevel"===Kn&&(ln>2&&(Kn="flipbevel"),ln<pe&&(Kn="miter")),qt&&this.updateDistance(qt,vt),"miter"===Kn)jr._mult(ln),this.addCurrentVertex(vt,jr,0,0,Yt);else if("flipbevel"===Kn){if(ln>100)jr=Cr.mult(-1);else{var pi=ln*yr.add(Cr).mag()/yr.sub(Cr).mag();jr._perp()._mult(pi*(Rn?-1:1))}this.addCurrentVertex(vt,jr,0,0,Yt),this.addCurrentVertex(vt,jr.mult(-1),0,0,Yt)}else if("bevel"===Kn||"fakeround"===Kn){var fi=-Math.sqrt(ln*ln-1),si=Rn?fi:0,Ki=Rn?0:fi;if(qt&&this.addCurrentVertex(vt,yr,si,Ki,Yt),"fakeround"===Kn)for(var Vi=Math.round(180*yn/Math.PI/20),ea=1;ea<Vi;ea++){var _i=ea/Vi;if(.5!==_i){var Hi=_i-.5;_i+=_i*Hi*(_i-1)*((1.0904+Ur*(Ur*(3.55645-1.43519*Ur)-3.2452))*Hi*Hi+(.848013+Ur*(.215638*Ur-1.06021)))}var va=Cr.sub(yr)._mult(_i)._add(yr)._unit()._mult(Rn?-1:1);this.addHalfVertex(vt,va.x,va.y,!1,Rn,0,Yt)}ar&&this.addCurrentVertex(vt,Cr,-si,-Ki,Yt)}else if("butt"===Kn)this.addCurrentVertex(vt,jr,0,0,Yt);else if("square"===Kn){var ua=qt?1:-1;this.addCurrentVertex(vt,jr,ua,ua,Yt)}else"round"===Kn&&(qt&&(this.addCurrentVertex(vt,yr,0,0,Yt),this.addCurrentVertex(vt,yr,1,1,Yt,!0)),ar&&(this.addCurrentVertex(vt,Cr,-1,-1,Yt,!0),this.addCurrentVertex(vt,Cr,0,0,Yt)));if(Bn&&Lr<$e-1){var Ma=vt.dist(ar);if(Ma>2*zt){var fa=vt.add(ar.sub(vt)._mult(zt/Ma)._round());this.updateDistance(vt,fa),this.addCurrentVertex(fa,Cr,0,0,Yt),vt=fa}}}}},Yo.prototype.addCurrentVertex=function(A,O,Z,ie,pe,xe){void 0===xe&&(xe=!1);var $e=O.y*ie-O.x,ut=-O.y-O.x*ie;this.addHalfVertex(A,O.x+O.y*Z,O.y-O.x*Z,xe,!1,Z,pe),this.addHalfVertex(A,$e,ut,xe,!0,-ie,pe),this.distance>Ju/2&&0===this.totalDistance&&(this.distance=0,this.addCurrentVertex(A,O,Z,ie,pe,xe))},Yo.prototype.addHalfVertex=function(A,O,Z,ie,pe,xe,Ce){var ut=.5*this.scaledDistance;this.layoutVertexArray.emplaceBack((A.x<<1)+(ie?1:0),(A.y<<1)+(pe?1:0),Math.round(63*O)+128,Math.round(63*Z)+128,1+(0===xe?0:xe<0?-1:1)|(63&ut)<<2,ut>>6);var vt=Ce.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,vt),Ce.primitiveLength++),pe?this.e2=vt:this.e1=vt},Yo.prototype.updateScaledDistance=function(){this.scaledDistance=this.totalDistance>0?(this.clipStart+(this.clipEnd-this.clipStart)*this.distance/this.totalDistance)*(Ju-1):this.distance},Yo.prototype.updateDistance=function(A,O){this.distance+=A.dist(O),this.updateScaledDistance()},Wr("LineBucket",Yo,{omit:["layers","patternFeatures"]});var Uh=new Eo({"line-cap":new ci(ye.layout_line["line-cap"]),"line-join":new yi(ye.layout_line["line-join"]),"line-miter-limit":new ci(ye.layout_line["line-miter-limit"]),"line-round-limit":new ci(ye.layout_line["line-round-limit"]),"line-sort-key":new yi(ye.layout_line["line-sort-key"])}),Ku={paint:new Eo({"line-opacity":new yi(ye.paint_line["line-opacity"]),"line-color":new yi(ye.paint_line["line-color"]),"line-translate":new ci(ye.paint_line["line-translate"]),"line-translate-anchor":new ci(ye.paint_line["line-translate-anchor"]),"line-width":new yi(ye.paint_line["line-width"]),"line-gap-width":new yi(ye.paint_line["line-gap-width"]),"line-offset":new yi(ye.paint_line["line-offset"]),"line-blur":new yi(ye.paint_line["line-blur"]),"line-dasharray":new zs(ye.paint_line["line-dasharray"]),"line-pattern":new Ds(ye.paint_line["line-pattern"]),"line-gradient":new Qo(ye.paint_line["line-gradient"])}),layout:Uh},Qu=new(function(A){function O(){A.apply(this,arguments)}return A&&(O.__proto__=A),(O.prototype=Object.create(A&&A.prototype)).constructor=O,O.prototype.possiblyEvaluate=function(Z,ie){return ie=new ra(Math.floor(ie.zoom),{now:ie.now,fadeDuration:ie.fadeDuration,zoomHistory:ie.zoomHistory,transition:ie.transition}),A.prototype.possiblyEvaluate.call(this,Z,ie)},O.prototype.evaluate=function(Z,ie,pe,xe){return ie=c({},ie,{zoom:Math.floor(ie.zoom)}),A.prototype.evaluate.call(this,Z,ie,pe,xe)},O}(yi))(Ku.paint.properties["line-width"].specification);Qu.useIntegerZoom=!0;var Vh=function(A){function O(Z){A.call(this,Z,Ku)}return A&&(O.__proto__=A),(O.prototype=Object.create(A&&A.prototype)).constructor=O,O.prototype._handleSpecialPaintPropertyUpdate=function(Z){"line-gradient"===Z&&this._updateGradient()},O.prototype._updateGradient=function(){this.gradient=Bu(this._transitionablePaint._values["line-gradient"].value.expression,"lineProgress"),this.gradientTexture=null},O.prototype.recalculate=function(Z,ie){A.prototype.recalculate.call(this,Z,ie),this.paint._values["line-floorwidth"]=Qu.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,Z)},O.prototype.createBucket=function(Z){return new Yo(Z)},O.prototype.queryRadius=function(Z){var ie=Z,pe=$u(ka("line-width",this,ie),ka("line-gap-width",this,ie)),xe=ka("line-offset",this,ie);return pe/2+Math.abs(xe)+Lo(this.paint.get("line-translate"))},O.prototype.queryIntersectsFeature=function(Z,ie,pe,xe,Ce,je,$e){var ut=Co(Z,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),je.angle,$e),vt=$e/2*$u(this.paint.get("line-width").evaluate(ie,pe),this.paint.get("line-gap-width").evaluate(ie,pe)),zt=this.paint.get("line-offset").evaluate(ie,pe);return zt&&(xe=function(Yt,qt){for(var ar=[],yr=new r(0,0),Cr=0;Cr<Yt.length;Cr++){for(var Lr=Yt[Cr],jr=[],Ur=0;Ur<Lr.length;Ur++){var ln=Lr[Ur],yn=Lr[Ur+1],Bn=0===Ur?yr:ln.sub(Lr[Ur-1])._unit()._perp(),Rn=Ur===Lr.length-1?yr:yn.sub(ln)._unit()._perp(),Gn=Bn._add(Rn)._unit();Gn._mult(1/(Gn.x*Rn.x+Gn.y*Rn.y)),jr.push(Gn._mult(qt)._add(ln))}ar.push(jr)}return ar}(xe,zt*$e)),function(Yt,qt,ar){for(var yr=0;yr<qt.length;yr++){var Cr=qt[yr];if(Yt.length>=3)for(var Lr=0;Lr<Cr.length;Lr++)if($o(Yt,Cr[Lr]))return!0;if(sl(Yt,Cr,ar))return!0}return!1}(ut,xe,vt)},O.prototype.isTileClipped=function(){return!0},O}(Uo);function $u(A,O){return O>0?O+2*A:A}var cu=na([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),qh=na([{name:"a_projected_pos",components:3,type:"Float32"}],4),Hh=(na([{name:"a_fade_opacity",components:1,type:"Uint32"}],4),na([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"}])),ef=(na([{type:"Int16",name:"anchorPointX"},{type:"Int16",name:"anchorPointY"},{type:"Int16",name:"x1"},{type:"Int16",name:"y1"},{type:"Int16",name:"x2"},{type:"Int16",name:"y2"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]),na([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4)),Gh=na([{name:"a_pos",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);function Zh(A,O,Z){return A.sections.forEach(function(ie){var pe,Ce,je;ie.text=(pe=ie.text,Ce=Z,"uppercase"===(je=O.layout.get("text-transform").evaluate(Ce,{}))?pe=pe.toLocaleUpperCase():"lowercase"===je&&(pe=pe.toLocaleLowerCase()),co.applyArabicShaping&&(pe=co.applyArabicShaping(pe)),pe)}),A}na([{name:"triangle",components:3,type:"Uint16"}]),na([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"}]),na([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",name:"textBoxScale"},{type:"Float32",components:2,name:"textOffset"},{type:"Float32",name:"collisionCircleDiameter"}]),na([{type:"Float32",name:"offsetX"}]),na([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]);var Kl={"!":"\ufe15","#":"\uff03",$:"\uff04","%":"\uff05","&":"\uff06","(":"\ufe35",")":"\ufe36","*":"\uff0a","+":"\uff0b",",":"\ufe10","-":"\ufe32",".":"\u30fb","/":"\uff0f",":":"\ufe13",";":"\ufe14","<":"\ufe3f","=":"\uff1d",">":"\ufe40","?":"\ufe16","@":"\uff20","[":"\ufe47","\\":"\uff3c","]":"\ufe48","^":"\uff3e",_:"\ufe33","`":"\uff40","{":"\ufe37","|":"\u2015","}":"\ufe38","~":"\uff5e","\xa2":"\uffe0","\xa3":"\uffe1","\xa5":"\uffe5","\xa6":"\uffe4","\xac":"\uffe2","\xaf":"\uffe3","\u2013":"\ufe32","\u2014":"\ufe31","\u2018":"\ufe43","\u2019":"\ufe44","\u201c":"\ufe41","\u201d":"\ufe42","\u2026":"\ufe19","\u2027":"\u30fb","\u20a9":"\uffe6","\u3001":"\ufe11","\u3002":"\ufe12","\u3008":"\ufe3f","\u3009":"\ufe40","\u300a":"\ufe3d","\u300b":"\ufe3e","\u300c":"\ufe41","\u300d":"\ufe42","\u300e":"\ufe43","\u300f":"\ufe44","\u3010":"\ufe3b","\u3011":"\ufe3c","\u3014":"\ufe39","\u3015":"\ufe3a","\u3016":"\ufe17","\u3017":"\ufe18","\uff01":"\ufe15","\uff08":"\ufe35","\uff09":"\ufe36","\uff0c":"\ufe10","\uff0d":"\ufe32","\uff0e":"\u30fb","\uff1a":"\ufe13","\uff1b":"\ufe14","\uff1c":"\ufe3f","\uff1e":"\ufe40","\uff1f":"\ufe16","\uff3b":"\ufe47","\uff3d":"\ufe48","\uff3f":"\ufe33","\uff5b":"\ufe37","\uff5c":"\u2015","\uff5d":"\ufe38","\uff5f":"\ufe35","\uff60":"\ufe36","\uff61":"\ufe12","\uff62":"\ufe41","\uff63":"\ufe42"},tf=function(A,O,Z,ie,pe){var xe,Ce,je=8*pe-ie-1,$e=(1<<je)-1,ut=$e>>1,vt=-7,zt=Z?pe-1:0,Yt=Z?-1:1,qt=A[O+zt];for(zt+=Yt,xe=qt&(1<<-vt)-1,qt>>=-vt,vt+=je;vt>0;xe=256*xe+A[O+zt],zt+=Yt,vt-=8);for(Ce=xe&(1<<-vt)-1,xe>>=-vt,vt+=ie;vt>0;Ce=256*Ce+A[O+zt],zt+=Yt,vt-=8);if(0===xe)xe=1-ut;else{if(xe===$e)return Ce?NaN:1/0*(qt?-1:1);Ce+=Math.pow(2,ie),xe-=ut}return(qt?-1:1)*Ce*Math.pow(2,xe-ie)},rf=function(A,O,Z,ie,pe,xe){var Ce,je,$e,ut=8*xe-pe-1,vt=(1<<ut)-1,zt=vt>>1,Yt=23===pe?Math.pow(2,-24)-Math.pow(2,-77):0,qt=ie?0:xe-1,ar=ie?1:-1,yr=O<0||0===O&&1/O<0?1:0;for(O=Math.abs(O),isNaN(O)||O===1/0?(je=isNaN(O)?1:0,Ce=vt):(Ce=Math.floor(Math.log(O)/Math.LN2),O*($e=Math.pow(2,-Ce))<1&&(Ce--,$e*=2),(O+=Ce+zt>=1?Yt/$e:Yt*Math.pow(2,1-zt))*$e>=2&&(Ce++,$e/=2),Ce+zt>=vt?(je=0,Ce=vt):Ce+zt>=1?(je=(O*$e-1)*Math.pow(2,pe),Ce+=zt):(je=O*Math.pow(2,zt-1)*Math.pow(2,pe),Ce=0));pe>=8;A[Z+qt]=255&je,qt+=ar,je/=256,pe-=8);for(Ce=Ce<<pe|je,ut+=pe;ut>0;A[Z+qt]=255&Ce,qt+=ar,Ce/=256,ut-=8);A[Z+qt-ar]|=128*yr},mc=ma;function ma(A){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(A)?A:new Uint8Array(A||0),this.pos=0,this.type=0,this.length=this.buf.length}ma.Varint=0,ma.Fixed64=1,ma.Bytes=2,ma.Fixed32=5;var nf=typeof TextDecoder>"u"?null:new TextDecoder("utf8");function Vs(A){return A.type===ma.Bytes?A.readVarint()+A.pos:A.pos+1}function af(A,O,Z){var ie=O<=16383?1:O<=2097151?2:O<=268435455?3:Math.floor(Math.log(O)/(7*Math.LN2));Z.realloc(ie);for(var pe=Z.pos-1;pe>=A;pe--)Z.buf[pe+ie]=Z.buf[pe]}function Yh(A,O){for(var Z=0;Z<A.length;Z++)O.writeVarint(A[Z])}function Wh(A,O){for(var Z=0;Z<A.length;Z++)O.writeSVarint(A[Z])}function Xh(A,O){for(var Z=0;Z<A.length;Z++)O.writeFloat(A[Z])}function Jh(A,O){for(var Z=0;Z<A.length;Z++)O.writeDouble(A[Z])}function Kh(A,O){for(var Z=0;Z<A.length;Z++)O.writeBoolean(A[Z])}function Qh(A,O){for(var Z=0;Z<A.length;Z++)O.writeFixed32(A[Z])}function $h(A,O){for(var Z=0;Z<A.length;Z++)O.writeSFixed32(A[Z])}function ep(A,O){for(var Z=0;Z<A.length;Z++)O.writeFixed64(A[Z])}function tp(A,O){for(var Z=0;Z<A.length;Z++)O.writeSFixed64(A[Z])}function vc(A,O){return(A[O]|A[O+1]<<8|A[O+2]<<16)+16777216*A[O+3]}function Tl(A,O,Z){A[Z]=O,A[Z+1]=O>>>8,A[Z+2]=O>>>16,A[Z+3]=O>>>24}function of(A,O){return(A[O]|A[O+1]<<8|A[O+2]<<16)+(A[O+3]<<24)}function rp(A,O,Z){1===A&&Z.readMessage(np,O)}function np(A,O,Z){if(3===A){var ie=Z.readMessage(ip,{}),Ce=ie.width,je=ie.height,$e=ie.left,ut=ie.top,vt=ie.advance;O.push({id:ie.id,bitmap:new fl({width:Ce+6,height:je+6},ie.bitmap),metrics:{width:Ce,height:je,left:$e,top:ut,advance:vt}})}}function ip(A,O,Z){1===A?O.id=Z.readVarint():2===A?O.bitmap=Z.readBytes():3===A?O.width=Z.readVarint():4===A?O.height=Z.readVarint():5===A?O.left=Z.readSVarint():6===A?O.top=Z.readSVarint():7===A&&(O.advance=Z.readVarint())}function sf(A){for(var O=0,Z=0,ie=0,pe=A;ie<pe.length;ie+=1){var xe=pe[ie];O+=xe.w*xe.h,Z=Math.max(Z,xe.w)}A.sort(function(yr,Cr){return Cr.h-yr.h});for(var Ce=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(O/.95)),Z),h:1/0}],je=0,$e=0,ut=0,vt=A;ut<vt.length;ut+=1)for(var zt=vt[ut],Yt=Ce.length-1;Yt>=0;Yt--){var qt=Ce[Yt];if(!(zt.w>qt.w||zt.h>qt.h)){if(zt.x=qt.x,zt.y=qt.y,$e=Math.max($e,zt.y+zt.h),je=Math.max(je,zt.x+zt.w),zt.w===qt.w&&zt.h===qt.h){var ar=Ce.pop();Yt<Ce.length&&(Ce[Yt]=ar)}else zt.h===qt.h?(qt.x+=zt.w,qt.w-=zt.w):zt.w===qt.w?(qt.y+=zt.h,qt.h-=zt.h):(Ce.push({x:qt.x+zt.w,y:qt.y,w:qt.w-zt.w,h:zt.h}),qt.y+=zt.h,qt.h-=zt.h);break}}return{w:je,h:$e,fill:O/(je*$e)||0}}ma.prototype={destroy:function(){this.buf=null},readFields:function(A,O,Z){for(Z=Z||this.length;this.pos<Z;){var ie=this.readVarint(),pe=ie>>3,xe=this.pos;this.type=7&ie,A(pe,O,this),this.pos===xe&&this.skip(ie)}return O},readMessage:function(A,O){return this.readFields(A,O,this.readVarint()+this.pos)},readFixed32:function(){var A=vc(this.buf,this.pos);return this.pos+=4,A},readSFixed32:function(){var A=of(this.buf,this.pos);return this.pos+=4,A},readFixed64:function(){var A=vc(this.buf,this.pos)+4294967296*vc(this.buf,this.pos+4);return this.pos+=8,A},readSFixed64:function(){var A=vc(this.buf,this.pos)+4294967296*of(this.buf,this.pos+4);return this.pos+=8,A},readFloat:function(){var A=tf(this.buf,this.pos,!0,23,4);return this.pos+=4,A},readDouble:function(){var A=tf(this.buf,this.pos,!0,52,8);return this.pos+=8,A},readVarint:function(A){var O,Z,ie=this.buf;return O=127&(Z=ie[this.pos++]),Z<128?O:(O|=(127&(Z=ie[this.pos++]))<<7,Z<128?O:(O|=(127&(Z=ie[this.pos++]))<<14,Z<128?O:(O|=(127&(Z=ie[this.pos++]))<<21,Z<128?O:function(pe,xe,Ce){var je,$e,ut=Ce.buf;if(je=(112&($e=ut[Ce.pos++]))>>4,$e<128||(je|=(127&($e=ut[Ce.pos++]))<<3,$e<128)||(je|=(127&($e=ut[Ce.pos++]))<<10,$e<128)||(je|=(127&($e=ut[Ce.pos++]))<<17,$e<128)||(je|=(127&($e=ut[Ce.pos++]))<<24,$e<128)||(je|=(1&($e=ut[Ce.pos++]))<<31,$e<128))return function wl(A,O,Z){return Z?4294967296*O+(A>>>0):4294967296*(O>>>0)+(A>>>0)}(pe,je,xe);throw new Error("Expected varint not more than 10 bytes")}(O|=(15&(Z=ie[this.pos]))<<28,A,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var A=this.readVarint();return A%2==1?(A+1)/-2:A/2},readBoolean:function(){return Boolean(this.readVarint())},readString:function(){var A=this.readVarint()+this.pos,O=this.pos;return this.pos=A,A-O>=12&&nf?nf.decode(this.buf.subarray(O,A)):function(Z,ie,pe){for(var xe="",Ce=ie;Ce<pe;){var je,$e,ut,vt=Z[Ce],zt=null,Yt=vt>239?4:vt>223?3:vt>191?2:1;if(Ce+Yt>pe)break;1===Yt?vt<128&&(zt=vt):2===Yt?128==(192&(je=Z[Ce+1]))&&(zt=(31&vt)<<6|63&je)<=127&&(zt=null):3===Yt?($e=Z[Ce+2],128==(192&(je=Z[Ce+1]))&&128==(192&$e)&&((zt=(15&vt)<<12|(63&je)<<6|63&$e)<=2047||zt>=55296&&zt<=57343)&&(zt=null)):4===Yt&&($e=Z[Ce+2],ut=Z[Ce+3],128==(192&(je=Z[Ce+1]))&&128==(192&$e)&&128==(192&ut)&&((zt=(15&vt)<<18|(63&je)<<12|(63&$e)<<6|63&ut)<=65535||zt>=1114112)&&(zt=null)),null===zt?(zt=65533,Yt=1):zt>65535&&(zt-=65536,xe+=String.fromCharCode(zt>>>10&1023|55296),zt=56320|1023&zt),xe+=String.fromCharCode(zt),Ce+=Yt}return xe}(this.buf,O,A)},readBytes:function(){var A=this.readVarint()+this.pos,O=this.buf.subarray(this.pos,A);return this.pos=A,O},readPackedVarint:function(A,O){if(this.type!==ma.Bytes)return A.push(this.readVarint(O));var Z=Vs(this);for(A=A||[];this.pos<Z;)A.push(this.readVarint(O));return A},readPackedSVarint:function(A){if(this.type!==ma.Bytes)return A.push(this.readSVarint());var O=Vs(this);for(A=A||[];this.pos<O;)A.push(this.readSVarint());return A},readPackedBoolean:function(A){if(this.type!==ma.Bytes)return A.push(this.readBoolean());var O=Vs(this);for(A=A||[];this.pos<O;)A.push(this.readBoolean());return A},readPackedFloat:function(A){if(this.type!==ma.Bytes)return A.push(this.readFloat());var O=Vs(this);for(A=A||[];this.pos<O;)A.push(this.readFloat());return A},readPackedDouble:function(A){if(this.type!==ma.Bytes)return A.push(this.readDouble());var O=Vs(this);for(A=A||[];this.pos<O;)A.push(this.readDouble());return A},readPackedFixed32:function(A){if(this.type!==ma.Bytes)return A.push(this.readFixed32());var O=Vs(this);for(A=A||[];this.pos<O;)A.push(this.readFixed32());return A},readPackedSFixed32:function(A){if(this.type!==ma.Bytes)return A.push(this.readSFixed32());var O=Vs(this);for(A=A||[];this.pos<O;)A.push(this.readSFixed32());return A},readPackedFixed64:function(A){if(this.type!==ma.Bytes)return A.push(this.readFixed64());var O=Vs(this);for(A=A||[];this.pos<O;)A.push(this.readFixed64());return A},readPackedSFixed64:function(A){if(this.type!==ma.Bytes)return A.push(this.readSFixed64());var O=Vs(this);for(A=A||[];this.pos<O;)A.push(this.readSFixed64());return A},skip:function(A){var O=7&A;if(O===ma.Varint)for(;this.buf[this.pos++]>127;);else if(O===ma.Bytes)this.pos=this.readVarint()+this.pos;else if(O===ma.Fixed32)this.pos+=4;else{if(O!==ma.Fixed64)throw new Error("Unimplemented type: "+O);this.pos+=8}},writeTag:function(A,O){this.writeVarint(A<<3|O)},realloc:function(A){for(var O=this.length||16;O<this.pos+A;)O*=2;if(O!==this.length){var Z=new Uint8Array(O);Z.set(this.buf),this.buf=Z,this.length=O}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(A){this.realloc(4),Tl(this.buf,A,this.pos),this.pos+=4},writeSFixed32:function(A){this.realloc(4),Tl(this.buf,A,this.pos),this.pos+=4},writeFixed64:function(A){this.realloc(8),Tl(this.buf,-1&A,this.pos),Tl(this.buf,Math.floor(A*(1/4294967296)),this.pos+4),this.pos+=8},writeSFixed64:function(A){this.realloc(8),Tl(this.buf,-1&A,this.pos),Tl(this.buf,Math.floor(A*(1/4294967296)),this.pos+4),this.pos+=8},writeVarint:function(A){(A=+A||0)>268435455||A<0?function(O,Z){var ie,pe,xe,je;if(O>=0?(ie=O%4294967296|0,pe=O/4294967296|0):(pe=~(-O/4294967296),4294967295^(ie=~(-O%4294967296))?ie=ie+1|0:(ie=0,pe=pe+1|0)),O>=0x10000000000000000||O<-0x10000000000000000)throw new Error("Given varint doesn't fit into 10 bytes");Z.realloc(10),xe=ie,(je=Z).buf[je.pos++]=127&xe|128,xe>>>=7,je.buf[je.pos++]=127&xe|128,xe>>>=7,je.buf[je.pos++]=127&xe|128,xe>>>=7,je.buf[je.pos++]=127&xe|128,je.buf[je.pos]=127&(xe>>>=7),function(xe,Ce){var je=(7&xe)<<4;Ce.buf[Ce.pos++]|=je|((xe>>>=3)?128:0),xe&&(Ce.buf[Ce.pos++]=127&xe|((xe>>>=7)?128:0),xe&&(Ce.buf[Ce.pos++]=127&xe|((xe>>>=7)?128:0),xe&&(Ce.buf[Ce.pos++]=127&xe|((xe>>>=7)?128:0),xe&&(Ce.buf[Ce.pos++]=127&xe|((xe>>>=7)?128:0),xe&&(Ce.buf[Ce.pos++]=127&xe)))))}(pe,Z)}(A,this):(this.realloc(4),this.buf[this.pos++]=127&A|(A>127?128:0),A<=127||(this.buf[this.pos++]=127&(A>>>=7)|(A>127?128:0),A<=127||(this.buf[this.pos++]=127&(A>>>=7)|(A>127?128:0),A<=127||(this.buf[this.pos++]=A>>>7&127))))},writeSVarint:function(A){this.writeVarint(A<0?2*-A-1:2*A)},writeBoolean:function(A){this.writeVarint(Boolean(A))},writeString:function(A){A=String(A),this.realloc(4*A.length),this.pos++;var O=this.pos;this.pos=function(ie,pe,xe){for(var Ce,je,$e=0;$e<pe.length;$e++){if((Ce=pe.charCodeAt($e))>55295&&Ce<57344){if(!je){Ce>56319||$e+1===pe.length?(ie[xe++]=239,ie[xe++]=191,ie[xe++]=189):je=Ce;continue}if(Ce<56320){ie[xe++]=239,ie[xe++]=191,ie[xe++]=189,je=Ce;continue}Ce=je-55296<<10|Ce-56320|65536,je=null}else je&&(ie[xe++]=239,ie[xe++]=191,ie[xe++]=189,je=null);Ce<128?ie[xe++]=Ce:(Ce<2048?ie[xe++]=Ce>>6|192:(Ce<65536?ie[xe++]=Ce>>12|224:(ie[xe++]=Ce>>18|240,ie[xe++]=Ce>>12&63|128),ie[xe++]=Ce>>6&63|128),ie[xe++]=63&Ce|128)}return xe}(this.buf,A,this.pos);var Z=this.pos-O;Z>=128&&af(O,Z,this),this.pos=O-1,this.writeVarint(Z),this.pos+=Z},writeFloat:function(A){this.realloc(4),rf(this.buf,A,this.pos,!0,23,4),this.pos+=4},writeDouble:function(A){this.realloc(8),rf(this.buf,A,this.pos,!0,52,8),this.pos+=8},writeBytes:function(A){var O=A.length;this.writeVarint(O),this.realloc(O);for(var Z=0;Z<O;Z++)this.buf[this.pos++]=A[Z]},writeRawMessage:function(A,O){this.pos++;var Z=this.pos;A(O,this);var ie=this.pos-Z;ie>=128&&af(Z,ie,this),this.pos=Z-1,this.writeVarint(ie),this.pos+=ie},writeMessage:function(A,O,Z){this.writeTag(A,ma.Bytes),this.writeRawMessage(O,Z)},writePackedVarint:function(A,O){O.length&&this.writeMessage(A,Yh,O)},writePackedSVarint:function(A,O){O.length&&this.writeMessage(A,Wh,O)},writePackedBoolean:function(A,O){O.length&&this.writeMessage(A,Kh,O)},writePackedFloat:function(A,O){O.length&&this.writeMessage(A,Xh,O)},writePackedDouble:function(A,O){O.length&&this.writeMessage(A,Jh,O)},writePackedFixed32:function(A,O){O.length&&this.writeMessage(A,Qh,O)},writePackedSFixed32:function(A,O){O.length&&this.writeMessage(A,$h,O)},writePackedFixed64:function(A,O){O.length&&this.writeMessage(A,ep,O)},writePackedSFixed64:function(A,O){O.length&&this.writeMessage(A,tp,O)},writeBytesField:function(A,O){this.writeTag(A,ma.Bytes),this.writeBytes(O)},writeFixed32Field:function(A,O){this.writeTag(A,ma.Fixed32),this.writeFixed32(O)},writeSFixed32Field:function(A,O){this.writeTag(A,ma.Fixed32),this.writeSFixed32(O)},writeFixed64Field:function(A,O){this.writeTag(A,ma.Fixed64),this.writeFixed64(O)},writeSFixed64Field:function(A,O){this.writeTag(A,ma.Fixed64),this.writeSFixed64(O)},writeVarintField:function(A,O){this.writeTag(A,ma.Varint),this.writeVarint(O)},writeSVarintField:function(A,O){this.writeTag(A,ma.Varint),this.writeSVarint(O)},writeStringField:function(A,O){this.writeTag(A,ma.Bytes),this.writeString(O)},writeFloatField:function(A,O){this.writeTag(A,ma.Fixed32),this.writeFloat(O)},writeDoubleField:function(A,O){this.writeTag(A,ma.Fixed64),this.writeDouble(O)},writeBooleanField:function(A,O){this.writeVarintField(A,Boolean(O))}};var yc=function(A,O){var Z=O.pixelRatio,ie=O.version,pe=O.stretchX,xe=O.stretchY,Ce=O.content;this.paddedRect=A,this.pixelRatio=Z,this.stretchX=pe,this.stretchY=xe,this.content=Ce,this.version=ie},Ql={tl:{configurable:!0},br:{configurable:!0},tlbr:{configurable:!0},displaySize:{configurable:!0}};Ql.tl.get=function(){return[this.paddedRect.x+1,this.paddedRect.y+1]},Ql.br.get=function(){return[this.paddedRect.x+this.paddedRect.w-1,this.paddedRect.y+this.paddedRect.h-1]},Ql.tlbr.get=function(){return this.tl.concat(this.br)},Ql.displaySize.get=function(){return[(this.paddedRect.w-2)/this.pixelRatio,(this.paddedRect.h-2)/this.pixelRatio]},Object.defineProperties(yc.prototype,Ql);var $l=function(A,O){var Z={},ie={};this.haveRenderCallbacks=[];var pe=[];this.addImages(A,Z,pe),this.addImages(O,ie,pe);var xe=sf(pe),$e=new Zo({width:xe.w||1,height:xe.h||1});for(var ut in A){var vt=A[ut],zt=Z[ut].paddedRect;Zo.copy(vt.data,$e,{x:0,y:0},{x:zt.x+1,y:zt.y+1},vt.data)}for(var Yt in O){var qt=O[Yt],ar=ie[Yt].paddedRect,yr=ar.x+1,Cr=ar.y+1,Lr=qt.data.width,jr=qt.data.height;Zo.copy(qt.data,$e,{x:0,y:0},{x:yr,y:Cr},qt.data),Zo.copy(qt.data,$e,{x:0,y:jr-1},{x:yr,y:Cr-1},{width:Lr,height:1}),Zo.copy(qt.data,$e,{x:0,y:0},{x:yr,y:Cr+jr},{width:Lr,height:1}),Zo.copy(qt.data,$e,{x:Lr-1,y:0},{x:yr-1,y:Cr},{width:1,height:jr}),Zo.copy(qt.data,$e,{x:0,y:0},{x:yr+Lr,y:Cr},{width:1,height:jr})}this.image=$e,this.iconPositions=Z,this.patternPositions=ie};$l.prototype.addImages=function(A,O,Z){for(var ie in A){var pe=A[ie],xe={x:0,y:0,w:pe.data.width+2,h:pe.data.height+2};Z.push(xe),O[ie]=new yc(xe,pe),pe.hasRenderCallback&&this.haveRenderCallbacks.push(ie)}},$l.prototype.patchUpdatedImages=function(A,O){for(var Z in A.dispatchRenderCallbacks(this.haveRenderCallbacks),A.updatedImages)this.patchUpdatedImage(this.iconPositions[Z],A.getImage(Z),O),this.patchUpdatedImage(this.patternPositions[Z],A.getImage(Z),O)},$l.prototype.patchUpdatedImage=function(A,O,Z){if(A&&O&&A.version!==O.version){A.version=O.version;var ie=A.tl;Z.update(O.data,void 0,{x:ie[0],y:ie[1]})}},Wr("ImagePosition",yc),Wr("ImageAtlas",$l);var as={horizontal:1,vertical:2,horizontalOnly:3},kl=function(){this.scale=1,this.fontStack="",this.imageName=null};kl.forText=function(A,O){var Z=new kl;return Z.scale=A||1,Z.fontStack=O,Z},kl.forImage=function(A){var O=new kl;return O.imageName=A,O};var Do=function(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null};function xc(A,O,Z,ie,pe,xe,Ce,je,$e,ut,vt,zt,Yt,qt,ar,yr){var Cr,Lr=Do.fromFeature(A,pe);zt===as.vertical&&Lr.verticalizePunctuation();var jr=co.processBidirectionalText,Ur=co.processStyledBidirectionalText;if(jr&&1===Lr.sections.length){Cr=[];for(var Zr=0,ln=jr(Lr.toString(),uu(Lr,ut,xe,O,ie,qt,ar));Zr<ln.length;Zr+=1){var yn=ln[Zr],Bn=new Do;Bn.text=yn,Bn.sections=Lr.sections;for(var Rn=0;Rn<yn.length;Rn++)Bn.sectionIndex.push(0);Cr.push(Bn)}}else if(Ur){Cr=[];for(var Gn=0,ai=Ur(Lr.text,Lr.sectionIndex,uu(Lr,ut,xe,O,ie,qt,ar));Gn<ai.length;Gn+=1){var oi=ai[Gn],Kn=new Do;Kn.text=oi[0],Kn.sectionIndex=oi[1],Kn.sections=Lr.sections,Cr.push(Kn)}}else Cr=function(si,Ki){for(var Vi=[],ea=si.text,_i=0,Hi=0,va=Ki;Hi<va.length;Hi+=1){var ua=va[Hi];Vi.push(si.substring(_i,ua)),_i=ua}return _i<ea.length&&Vi.push(si.substring(_i,ea.length)),Vi}(Lr,uu(Lr,ut,xe,O,ie,qt,ar));var pi=[],fi={positionedLines:pi,text:Lr.toString(),top:vt[1],bottom:vt[1],left:vt[0],right:vt[0],writingMode:zt,iconsInText:!1,verticalizable:!1};return function(si,Ki,Vi,ea,_i,Hi,va,ua,Ma,fa,io,Sa){for(var Po=0,bo=-17,To=0,Vo=0,zo="right"===ua?1:"left"===ua?0:.5,ao=0,ko=0,Za=_i;ko<Za.length;ko+=1){var uo=Za[ko];uo.trim();var Ri=uo.getMaxScale(),Qi=24*(Ri-1),Na={positionedGlyphs:[],lineOffset:0};si.positionedLines[ao]=Na;var ja=Na.positionedGlyphs,za=0;if(uo.length()){for(var Ea=0;Ea<uo.length();Ea++){var ia=uo.getSection(Ea),Ua=uo.getSectionIndex(Ea),qo=uo.getCharCode(Ea),ts=0,Ro=null,Ss=null,Gs=null,_o=24,Es=!(Ma===as.horizontal||!io&&!di(qo)||io&&(bc[qo]||(tl=qo,Mn.Arabic(tl)||Mn["Arabic Supplement"](tl)||Mn["Arabic Extended-A"](tl)||Mn["Arabic Presentation Forms-A"](tl)||Mn["Arabic Presentation Forms-B"](tl))));if(ia.imageName){var Ls=ea[ia.imageName];if(!Ls)continue;Gs=ia.imageName,si.iconsInText=si.iconsInText||!0,Ss=Ls.paddedRect;var Cs=Ls.displaySize;ia.scale=24*ia.scale/Sa,ts=Qi+(24-Cs[1]*ia.scale),_o=(Ro={width:Cs[0],height:Cs[1],left:1,top:-3,advance:Es?Cs[1]:Cs[0]}).advance;var Il=Es?Cs[0]*ia.scale-24*Ri:Cs[1]*ia.scale-24*Ri;Il>0&&Il>za&&(za=Il)}else{var Lc=Vi[ia.fontStack],ml=Lc&&Lc[qo];if(ml&&ml.rect)Ss=ml.rect,Ro=ml.metrics;else{var Cc=Ki[ia.fontStack],Pc=Cc&&Cc[qo];if(!Pc)continue;Ro=Pc.metrics}ts=24*(Ri-ia.scale)}Es?(si.verticalizable=!0,ja.push({glyph:qo,imageName:Gs,x:Po,y:bo+ts,vertical:Es,scale:ia.scale,fontStack:ia.fontStack,sectionIndex:Ua,metrics:Ro,rect:Ss}),Po+=_o*ia.scale+fa):(ja.push({glyph:qo,imageName:Gs,x:Po,y:bo+ts,vertical:Es,scale:ia.scale,fontStack:ia.fontStack,sectionIndex:Ua,metrics:Ro,rect:Ss}),Po+=Ro.advance*ia.scale+fa)}0!==ja.length&&(To=Math.max(Po-fa,To),op(ja,0,ja.length-1,zo,za)),Po=0;var Oc=Hi*Ri+za;Na.lineOffset=Math.max(za,Qi),bo+=Oc,Vo=Math.max(Oc,Vo),++ao}else bo+=Hi,++ao}var tl,Ol=bo- -17,Dc=fu(va),Dl=Dc.horizontalAlign,rl=Dc.verticalAlign;(function(rc,zc,Rc,Fc,nc,Bc,ic,Nc,ac){var zl,jc=(zc-Rc)*nc;zl=Bc!==ic?-Nc*Fc- -17:(-Fc*ac+.5)*ic;for(var Rl=0,Fl=rc;Rl<Fl.length;Rl+=1)for(var Bl=0,oc=Fl[Rl].positionedGlyphs;Bl<oc.length;Bl+=1){var Nl=oc[Bl];Nl.x+=jc,Nl.y+=zl}})(si.positionedLines,zo,Dl,rl,To,Vo,Hi,Ol,_i.length),si.top+=-rl*Ol,si.bottom=si.top+Ol,si.left+=-Dl*To,si.right=si.left+To}(fi,O,Z,ie,Cr,Ce,je,$e,zt,ut,Yt,yr),!function(si){for(var Ki=0,Vi=si;Ki<Vi.length;Ki+=1)if(0!==Vi[Ki].positionedGlyphs.length)return!1;return!0}(pi)&&fi}Do.fromFeature=function(A,O){for(var Z=new Do,ie=0;ie<A.sections.length;ie++){var pe=A.sections[ie];pe.image?Z.addImageSection(pe):Z.addTextSection(pe,O)}return Z},Do.prototype.length=function(){return this.text.length},Do.prototype.getSection=function(A){return this.sections[this.sectionIndex[A]]},Do.prototype.getSectionIndex=function(A){return this.sectionIndex[A]},Do.prototype.getCharCode=function(A){return this.text.charCodeAt(A)},Do.prototype.verticalizePunctuation=function(){this.text=function(A){for(var O="",Z=0;Z<A.length;Z++){var ie=A.charCodeAt(Z+1)||null,pe=A.charCodeAt(Z-1)||null;ie&&zi(ie)&&!Kl[A[Z+1]]||pe&&zi(pe)&&!Kl[A[Z-1]]||!Kl[A[Z]]?O+=A[Z]:O+=Kl[A[Z]]}return O}(this.text)},Do.prototype.trim=function(){for(var A=0,O=0;O<this.text.length&&bc[this.text.charCodeAt(O)];O++)A++;for(var Z=this.text.length,ie=this.text.length-1;ie>=0&&ie>=A&&bc[this.text.charCodeAt(ie)];ie--)Z--;this.text=this.text.substring(A,Z),this.sectionIndex=this.sectionIndex.slice(A,Z)},Do.prototype.substring=function(A,O){var Z=new Do;return Z.text=this.text.substring(A,O),Z.sectionIndex=this.sectionIndex.slice(A,O),Z.sections=this.sections,Z},Do.prototype.toString=function(){return this.text},Do.prototype.getMaxScale=function(){var A=this;return this.sectionIndex.reduce(function(O,Z){return Math.max(O,A.sections[Z].scale)},0)},Do.prototype.addTextSection=function(A,O){this.text+=A.text,this.sections.push(kl.forText(A.scale,A.fontStack||O));for(var Z=this.sections.length-1,ie=0;ie<A.text.length;++ie)this.sectionIndex.push(Z)},Do.prototype.addImageSection=function(A){var O=A.image?A.image.name:"";if(0!==O.length){var Z=this.getNextImageSectionCharCode();Z?(this.text+=String.fromCharCode(Z),this.sections.push(kl.forImage(O)),this.sectionIndex.push(this.sections.length-1)):M("Reached maximum number of images 6401")}else M("Can't add FormattedSection with an empty image.")},Do.prototype.getNextImageSectionCharCode=function(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)};var bc={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},es={};function lf(A,O,Z,ie,pe,xe){if(O.imageName){var Ce=ie[O.imageName];return Ce?Ce.displaySize[0]*O.scale*24/xe+pe:0}var je=Z[O.fontStack],$e=je&&je[A];return $e?$e.metrics.advance*O.scale+pe:0}function cf(A,O,Z,ie){var pe=Math.pow(A-O,2);return ie?A<O?pe/2:2*pe:pe+Math.abs(Z)*Z}function ap(A,O,Z){var ie=0;return 10===A&&(ie-=1e4),Z&&(ie+=150),40!==A&&65288!==A||(ie+=50),41!==O&&65289!==O||(ie+=50),ie}function uf(A,O,Z,ie,pe,xe){for(var Ce=null,je=cf(O,Z,pe,xe),$e=0,ut=ie;$e<ut.length;$e+=1){var vt=ut[$e],zt=cf(O-vt.x,Z,pe,xe)+vt.badness;zt<=je&&(Ce=vt,je=zt)}return{index:A,x:O,priorBreak:Ce,badness:je}}function uu(A,O,Z,ie,pe,xe,Ce){if("point"!==xe)return[];if(!A)return[];for(var je,$e=[],ut=function(Cr,Lr,jr,Ur,Zr,ln){for(var yn=0,Bn=0;Bn<Cr.length();Bn++){var Rn=Cr.getSection(Bn);yn+=lf(Cr.getCharCode(Bn),Rn,Ur,Zr,Lr,ln)}return yn/Math.max(1,Math.ceil(yn/jr))}(A,O,Z,ie,pe,Ce),vt=A.text.indexOf("\u200b")>=0,zt=0,Yt=0;Yt<A.length();Yt++){var qt=A.getSection(Yt),ar=A.getCharCode(Yt);if(bc[ar]||(zt+=lf(ar,qt,ie,pe,O,Ce)),Yt<A.length()-1){var yr=!((je=ar)<11904||!(Mn["Bopomofo Extended"](je)||Mn.Bopomofo(je)||Mn["CJK Compatibility Forms"](je)||Mn["CJK Compatibility Ideographs"](je)||Mn["CJK Compatibility"](je)||Mn["CJK Radicals Supplement"](je)||Mn["CJK Strokes"](je)||Mn["CJK Symbols and Punctuation"](je)||Mn["CJK Unified Ideographs Extension A"](je)||Mn["CJK Unified Ideographs"](je)||Mn["Enclosed CJK Letters and Months"](je)||Mn["Halfwidth and Fullwidth Forms"](je)||Mn.Hiragana(je)||Mn["Ideographic Description Characters"](je)||Mn["Kangxi Radicals"](je)||Mn["Katakana Phonetic Extensions"](je)||Mn.Katakana(je)||Mn["Vertical Forms"](je)||Mn["Yi Radicals"](je)||Mn["Yi Syllables"](je)));(es[ar]||yr||qt.imageName)&&$e.push(uf(Yt+1,zt,ut,$e,ap(ar,A.getCharCode(Yt+1),yr&&vt),!1))}}return function Cr(Lr){return Lr?Cr(Lr.priorBreak).concat(Lr.index):[]}(uf(A.length(),zt,ut,$e,0,!0))}function fu(A){var O=.5,Z=.5;switch(A){case"right":case"top-right":case"bottom-right":O=1;break;case"left":case"top-left":case"bottom-left":O=0}switch(A){case"bottom":case"bottom-right":case"bottom-left":Z=1;break;case"top":case"top-right":case"top-left":Z=0}return{horizontalAlign:O,verticalAlign:Z}}function op(A,O,Z,ie,pe){if(ie||pe)for(var xe=A[Z],je=(A[Z].x+xe.metrics.advance*xe.scale)*ie,$e=O;$e<=Z;$e++)A[$e].x-=je,A[$e].y+=pe}function ff(A,O,Z,ie,pe,xe){var Ce,je=A.image;if(je.content){var $e=je.content,ut=je.pixelRatio||1;Ce=[$e[0]/ut,$e[1]/ut,je.displaySize[0]-$e[2]/ut,je.displaySize[1]-$e[3]/ut]}var vt,zt,Yt,qt,ar=O.left*xe,yr=O.right*xe;"width"===Z||"both"===Z?(qt=pe[0]+ar-ie[3],zt=pe[0]+yr+ie[1]):zt=(qt=pe[0]+(ar+yr-je.displaySize[0])/2)+je.displaySize[0];var Cr=O.top*xe,Lr=O.bottom*xe;return"height"===Z||"both"===Z?(vt=pe[1]+Cr-ie[0],Yt=pe[1]+Lr+ie[2]):Yt=(vt=pe[1]+(Cr+Lr-je.displaySize[1])/2)+je.displaySize[1],{image:je,top:vt,right:zt,bottom:Yt,left:qt,collisionPadding:Ce}}es[10]=!0,es[32]=!0,es[38]=!0,es[40]=!0,es[41]=!0,es[43]=!0,es[45]=!0,es[47]=!0,es[173]=!0,es[183]=!0,es[8203]=!0,es[8208]=!0,es[8211]=!0,es[8231]=!0;var Al=function(A){function O(Z,ie,pe,xe){A.call(this,Z,ie),this.angle=pe,void 0!==xe&&(this.segment=xe)}return A&&(O.__proto__=A),(O.prototype=Object.create(A&&A.prototype)).constructor=O,O.prototype.clone=function(){return new O(this.x,this.y,this.angle,this.segment)},O}(r);function hu(A,O){var Z=O.expression;if("constant"===Z.kind)return{kind:"constant",layoutSize:Z.evaluate(new ra(A+1))};if("source"===Z.kind)return{kind:"source"};for(var ie=Z.zoomStops,pe=Z.interpolationType,xe=0;xe<ie.length&&ie[xe]<=A;)xe++;for(var Ce=xe=Math.max(0,xe-1);Ce<ie.length&&ie[Ce]<A+1;)Ce++;Ce=Math.min(ie.length-1,Ce);var je=ie[xe],$e=ie[Ce];return"composite"===Z.kind?{kind:"composite",minZoom:je,maxZoom:$e,interpolationType:pe}:{kind:"camera",minZoom:je,maxZoom:$e,minSize:Z.evaluate(new ra(je)),maxSize:Z.evaluate(new ra($e)),interpolationType:pe}}function hf(A,O,Z){var ie=O.uSize,xe=Z.lowerSize;return"source"===A.kind?xe/128:"composite"===A.kind?bn(xe/128,Z.upperSize/128,O.uSizeT):ie}function pf(A,O){var Z=0,ie=0;if("constant"===A.kind)ie=A.layoutSize;else if("source"!==A.kind){var pe=A.interpolationType,je=pe?u(Fi.interpolationFactor(pe,O,A.minZoom,A.maxZoom),0,1):0;"camera"===A.kind?ie=bn(A.minSize,A.maxSize,je):Z=je}return{uSizeT:Z,uSize:ie}}Wr("Anchor",Al);var sp=Object.freeze({__proto__:null,getSizeData:hu,evaluateSizeForFeature:hf,evaluateSizeForZoom:pf,SIZE_PACK_FACTOR:128});function df(A,O,Z,ie,pe){if(void 0===O.segment)return!0;for(var xe=O,Ce=O.segment+1,je=0;je>-Z/2;){if(--Ce<0)return!1;je-=A[Ce].dist(xe),xe=A[Ce]}je+=A[Ce].dist(A[Ce+1]),Ce++;for(var $e=[],ut=0;je<Z/2;){var zt=A[Ce],Yt=A[Ce+1];if(!Yt)return!1;var qt=A[Ce-1].angleTo(zt)-zt.angleTo(Yt);for(qt=Math.abs((qt+3*Math.PI)%(2*Math.PI)-Math.PI),$e.push({distance:je,angleDelta:qt}),ut+=qt;je-$e[0].distance>ie;)ut-=$e.shift().angleDelta;if(ut>pe)return!1;Ce++,je+=zt.dist(Yt)}return!0}function gf(A){for(var O=0,Z=0;Z<A.length-1;Z++)O+=A[Z].dist(A[Z+1]);return O}function mf(A,O,Z){return A?.6*O*Z:0}function vf(A,O){return Math.max(A?A.right-A.left:0,O?O.right-O.left:0)}function lp(A,O,Z,ie,pe,xe){for(var Ce=mf(Z,pe,xe),je=vf(Z,ie)*xe,$e=0,ut=gf(A)/2,vt=0;vt<A.length-1;vt++){var zt=A[vt],Yt=A[vt+1],qt=zt.dist(Yt);if($e+qt>ut){var ar=(ut-$e)/qt,yr=bn(zt.x,Yt.x,ar),Cr=bn(zt.y,Yt.y,ar),Lr=new Al(yr,Cr,Yt.angleTo(zt),vt);return Lr._round(),!Ce||df(A,Lr,je,Ce,O)?Lr:void 0}$e+=qt}}function cp(A,O,Z,ie,pe,xe,Ce,je,$e){var ut=mf(ie,xe,Ce),vt=vf(ie,pe),zt=vt*Ce,Yt=0===A[0].x||A[0].x===$e||0===A[0].y||A[0].y===$e;return O-zt<O/4&&(O=zt+O/4),function qt(ar,yr,Cr,Lr,jr,Ur,Zr,ln,yn){for(var Bn=Ur/2,Rn=gf(ar),Gn=0,ai=yr-Cr,oi=[],Kn=0;Kn<ar.length-1;Kn++){for(var pi=ar[Kn],fi=ar[Kn+1],si=pi.dist(fi),Ki=fi.angleTo(pi);ai+Cr<Gn+si;){var Vi=((ai+=Cr)-Gn)/si,ea=bn(pi.x,fi.x,Vi),_i=bn(pi.y,fi.y,Vi);if(ea>=0&&ea<yn&&_i>=0&&_i<yn&&ai-Bn>=0&&ai+Bn<=Rn){var Hi=new Al(ea,_i,Ki,Kn);Hi._round(),Lr&&!df(ar,Hi,Ur,Lr,jr)||oi.push(Hi)}}Gn+=si}return ln||oi.length||Zr||(oi=qt(ar,Gn/2,Cr,Lr,jr,Ur,Zr,!0,yn)),oi}(A,Yt?O/2*je%O:(vt/2+2*xe)*Ce*je%O,O,ut,Z,zt,Yt,!1,$e)}function yf(A,O,Z,ie,pe){for(var xe=[],Ce=0;Ce<A.length;Ce++)for(var je=A[Ce],$e=void 0,ut=0;ut<je.length-1;ut++){var vt=je[ut],zt=je[ut+1];vt.x<O&&zt.x<O||(vt.x<O?vt=new r(O,vt.y+(O-vt.x)/(zt.x-vt.x)*(zt.y-vt.y))._round():zt.x<O&&(zt=new r(O,vt.y+(O-vt.x)/(zt.x-vt.x)*(zt.y-vt.y))._round()),vt.y<Z&&zt.y<Z||(vt.y<Z?vt=new r(vt.x+(Z-vt.y)/(zt.y-vt.y)*(zt.x-vt.x),Z)._round():zt.y<Z&&(zt=new r(vt.x+(Z-vt.y)/(zt.y-vt.y)*(zt.x-vt.x),Z)._round()),vt.x>=ie&&zt.x>=ie||(vt.x>=ie?vt=new r(ie,vt.y+(ie-vt.x)/(zt.x-vt.x)*(zt.y-vt.y))._round():zt.x>=ie&&(zt=new r(ie,vt.y+(ie-vt.x)/(zt.x-vt.x)*(zt.y-vt.y))._round()),vt.y>=pe&&zt.y>=pe||(vt.y>=pe?vt=new r(vt.x+(pe-vt.y)/(zt.y-vt.y)*(zt.x-vt.x),pe)._round():zt.y>=pe&&(zt=new r(vt.x+(pe-vt.y)/(zt.y-vt.y)*(zt.x-vt.x),pe)._round()),$e&&vt.equals($e[$e.length-1])||xe.push($e=[vt]),$e.push(zt)))))}return xe}function xf(A,O,Z,ie){var pe=[],xe=A.image,Ce=xe.pixelRatio,je=xe.paddedRect.w-2,$e=xe.paddedRect.h-2,ut=A.right-A.left,vt=A.bottom-A.top,zt=xe.stretchX||[[0,je]],Yt=xe.stretchY||[[0,$e]],qt=function(Hi,va){return Hi+va[1]-va[0]},ar=zt.reduce(qt,0),yr=Yt.reduce(qt,0),Cr=je-ar,Lr=$e-yr,jr=0,Ur=ar,Zr=0,ln=yr,yn=0,Bn=Cr,Rn=0,Gn=Lr;if(xe.content&&ie){var ai=xe.content;jr=_c(zt,0,ai[0]),Zr=_c(Yt,0,ai[1]),Ur=_c(zt,ai[0],ai[2]),ln=_c(Yt,ai[1],ai[3]),yn=ai[0]-jr,Rn=ai[1]-Zr,Bn=ai[2]-ai[0]-Ur,Gn=ai[3]-ai[1]-ln}var oi=function(Hi,va,ua,Ma){var fa=wc(Hi.stretch-jr,Ur,ut,A.left),io=Tc(Hi.fixed-yn,Bn,Hi.stretch,ar),Sa=wc(va.stretch-Zr,ln,vt,A.top),Po=Tc(va.fixed-Rn,Gn,va.stretch,yr),bo=wc(ua.stretch-jr,Ur,ut,A.left),To=Tc(ua.fixed-yn,Bn,ua.stretch,ar),Vo=wc(Ma.stretch-Zr,ln,vt,A.top),zo=Tc(Ma.fixed-Rn,Gn,Ma.stretch,yr),ao=new r(fa,Sa),ko=new r(bo,Sa),Za=new r(bo,Vo),uo=new r(fa,Vo),Ri=new r(io/Ce,Po/Ce),Qi=new r(To/Ce,zo/Ce),Na=O*Math.PI/180;if(Na){var ja=Math.sin(Na),za=Math.cos(Na),Ea=[za,-ja,ja,za];ao._matMult(Ea),ko._matMult(Ea),uo._matMult(Ea),Za._matMult(Ea)}var ia=Hi.stretch+Hi.fixed,qo=va.stretch+va.fixed;return{tl:ao,tr:ko,bl:uo,br:Za,tex:{x:xe.paddedRect.x+1+ia,y:xe.paddedRect.y+1+qo,w:ua.stretch+ua.fixed-ia,h:Ma.stretch+Ma.fixed-qo},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:Ri,pixelOffsetBR:Qi,minFontScaleX:Bn/Ce/ut,minFontScaleY:Gn/Ce/vt,isSDF:Z}};if(ie&&(xe.stretchX||xe.stretchY))for(var Kn=bf(zt,Cr,ar),pi=bf(Yt,Lr,yr),fi=0;fi<Kn.length-1;fi++)for(var si=Kn[fi],Ki=Kn[fi+1],Vi=0;Vi<pi.length-1;Vi++)pe.push(oi(si,pi[Vi],Ki,pi[Vi+1]));else pe.push(oi({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:je+1},{fixed:0,stretch:$e+1}));return pe}function _c(A,O,Z){for(var ie=0,pe=0,xe=A;pe<xe.length;pe+=1){var Ce=xe[pe];ie+=Math.max(O,Math.min(Z,Ce[1]))-Math.max(O,Math.min(Z,Ce[0]))}return ie}function bf(A,O,Z){for(var ie=[{fixed:-1,stretch:0}],pe=0,xe=A;pe<xe.length;pe+=1){var Ce=xe[pe],je=Ce[0],$e=Ce[1],ut=ie[ie.length-1];ie.push({fixed:je-ut.stretch,stretch:ut.stretch}),ie.push({fixed:je-ut.stretch,stretch:ut.stretch+($e-je)})}return ie.push({fixed:O+1,stretch:Z}),ie}function wc(A,O,Z,ie){return A/O*Z+ie}function Tc(A,O,Z,ie){return A-O*Z/ie}var kc=function(A,O,Z,ie,pe,xe,Ce,je,$e,ut){if(this.boxStartIndex=A.length,$e){var vt=xe.top,zt=xe.bottom,Yt=xe.collisionPadding;Yt&&(vt-=Yt[1],zt+=Yt[3]);var qt=zt-vt;qt>0&&(qt=Math.max(10,qt),this.circleDiameter=qt)}else{var ar=xe.top*Ce-je,yr=xe.bottom*Ce+je,Cr=xe.left*Ce-je,Lr=xe.right*Ce+je,jr=xe.collisionPadding;if(jr&&(Cr-=jr[0]*Ce,ar-=jr[1]*Ce,Lr+=jr[2]*Ce,yr+=jr[3]*Ce),ut){var Ur=new r(Cr,ar),Zr=new r(Lr,ar),ln=new r(Cr,yr),yn=new r(Lr,yr),Bn=ut*Math.PI/180;Ur._rotate(Bn),Zr._rotate(Bn),ln._rotate(Bn),yn._rotate(Bn),Cr=Math.min(Ur.x,Zr.x,ln.x,yn.x),Lr=Math.max(Ur.x,Zr.x,ln.x,yn.x),ar=Math.min(Ur.y,Zr.y,ln.y,yn.y),yr=Math.max(Ur.y,Zr.y,ln.y,yn.y)}A.emplaceBack(O.x,O.y,Cr,ar,Lr,yr,Z,ie,pe)}this.boxEndIndex=A.length},Ml=function(A,O){if(void 0===A&&(A=[]),void 0===O&&(O=up),this.data=A,this.length=this.data.length,this.compare=O,this.length>0)for(var Z=(this.length>>1)-1;Z>=0;Z--)this._down(Z)};function up(A,O){return A<O?-1:A>O?1:0}function fp(A,O,Z){void 0===O&&(O=1),void 0===Z&&(Z=!1);for(var ie=1/0,pe=1/0,xe=-1/0,Ce=-1/0,je=A[0],$e=0;$e<je.length;$e++){var ut=je[$e];(!$e||ut.x<ie)&&(ie=ut.x),(!$e||ut.y<pe)&&(pe=ut.y),(!$e||ut.x>xe)&&(xe=ut.x),(!$e||ut.y>Ce)&&(Ce=ut.y)}var Yt=Math.min(xe-ie,Ce-pe),qt=Yt/2,ar=new Ml([],hp);if(0===Yt)return new r(ie,pe);for(var yr=ie;yr<xe;yr+=Yt)for(var Cr=pe;Cr<Ce;Cr+=Yt)ar.push(new Sl(yr+qt,Cr+qt,qt,A));for(var Lr=function(Zr){for(var ln=0,yn=0,Bn=0,Rn=Zr[0],Gn=0,ai=Rn.length,oi=ai-1;Gn<ai;oi=Gn++){var Kn=Rn[Gn],pi=Rn[oi],fi=Kn.x*pi.y-pi.x*Kn.y;yn+=(Kn.x+pi.x)*fi,Bn+=(Kn.y+pi.y)*fi,ln+=3*fi}return new Sl(yn/ln,Bn/ln,0,Zr)}(A),jr=ar.length;ar.length;){var Ur=ar.pop();(Ur.d>Lr.d||!Lr.d)&&(Lr=Ur,Z&&console.log("found best %d after %d probes",Math.round(1e4*Ur.d)/1e4,jr)),Ur.max-Lr.d<=O||(ar.push(new Sl(Ur.p.x-(qt=Ur.h/2),Ur.p.y-qt,qt,A)),ar.push(new Sl(Ur.p.x+qt,Ur.p.y-qt,qt,A)),ar.push(new Sl(Ur.p.x-qt,Ur.p.y+qt,qt,A)),ar.push(new Sl(Ur.p.x+qt,Ur.p.y+qt,qt,A)),jr+=4)}return Z&&(console.log("num probes: "+jr),console.log("best distance: "+Lr.d)),Lr.p}function hp(A,O){return O.max-A.max}function Sl(A,O,Z,ie){this.p=new r(A,O),this.h=Z,this.d=function(pe,xe){for(var Ce=!1,je=1/0,$e=0;$e<xe.length;$e++)for(var ut=xe[$e],vt=0,zt=ut.length,Yt=zt-1;vt<zt;Yt=vt++){var qt=ut[vt],ar=ut[Yt];qt.y>pe.y!=ar.y>pe.y&&pe.x<(ar.x-qt.x)*(pe.y-qt.y)/(ar.y-qt.y)+qt.x&&(Ce=!Ce),je=Math.min(je,Us(pe,qt,ar))}return(Ce?1:-1)*Math.sqrt(je)}(this.p,ie),this.max=this.d+this.h*Math.SQRT2}Ml.prototype.push=function(A){this.data.push(A),this.length++,this._up(this.length-1)},Ml.prototype.pop=function(){if(0!==this.length){var A=this.data[0],O=this.data.pop();return this.length--,this.length>0&&(this.data[0]=O,this._down(0)),A}},Ml.prototype.peek=function(){return this.data[0]},Ml.prototype._up=function(A){for(var O=this.data,Z=this.compare,ie=O[A];A>0;){var pe=A-1>>1,xe=O[pe];if(Z(ie,xe)>=0)break;O[A]=xe,A=pe}O[A]=ie},Ml.prototype._down=function(A){for(var O=this.data,Z=this.compare,ie=this.length>>1,pe=O[A];A<ie;){var xe=1+(A<<1),Ce=O[xe],je=xe+1;if(je<this.length&&Z(O[je],Ce)<0&&(xe=je,Ce=O[je]),Z(Ce,pe)>=0)break;O[A]=Ce,A=xe}O[A]=pe};var pu=Number.POSITIVE_INFINITY;function _f(A,O){return O[1]!==pu?function(Z,ie,pe){var xe=0,Ce=0;switch(ie=Math.abs(ie),pe=Math.abs(pe),Z){case"top-right":case"top-left":case"top":Ce=pe-7;break;case"bottom-right":case"bottom-left":case"bottom":Ce=7-pe}switch(Z){case"top-right":case"bottom-right":case"right":xe=-ie;break;case"top-left":case"bottom-left":case"left":xe=ie}return[xe,Ce]}(A,O[0],O[1]):function(Z,ie){var pe=0,xe=0;ie<0&&(ie=0);var Ce=ie/Math.sqrt(2);switch(Z){case"top-right":case"top-left":xe=Ce-7;break;case"bottom-right":case"bottom-left":xe=7-Ce;break;case"bottom":xe=7-ie;break;case"top":xe=ie-7}switch(Z){case"top-right":case"bottom-right":pe=-Ce;break;case"top-left":case"bottom-left":pe=Ce;break;case"left":pe=ie;break;case"right":pe=-ie}return[pe,xe]}(A,O[0])}function du(A){switch(A){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function wf(A,O,Z,ie,pe,xe,Ce,je,$e,ut,vt,zt,Yt,qt,ar){var yr=function(Zr,ln,yn,Bn,Rn,Gn,ai,oi){for(var Kn=Bn.layout.get("text-rotate").evaluate(Gn,{})*Math.PI/180,pi=[],fi=0,si=ln.positionedLines;fi<si.length;fi+=1)for(var Ki=si[fi],Vi=0,ea=Ki.positionedGlyphs;Vi<ea.length;Vi+=1){var _i=ea[Vi];if(_i.rect){var Hi=_i.rect||{},va=4,ua=!0,Ma=1,fa=0,io=(Rn||oi)&&_i.vertical,Sa=_i.metrics.advance*_i.scale/2;if(oi&&ln.verticalizable&&(fa=Ki.lineOffset/2-(_i.imageName?-(24-_i.metrics.width*_i.scale)/2:24*(_i.scale-1))),_i.imageName){var To=ai[_i.imageName];ua=To.sdf,va=1/(Ma=To.pixelRatio)}var Vo=Rn?[_i.x+Sa,_i.y]:[0,0],zo=Rn?[0,0]:[_i.x+Sa+yn[0],_i.y+yn[1]-fa],ao=[0,0];io&&(ao=zo,zo=[0,0]);var ko=(_i.metrics.left-va)*_i.scale-Sa+zo[0],Za=(-_i.metrics.top-va)*_i.scale+zo[1],uo=ko+Hi.w*_i.scale/Ma,Ri=Za+Hi.h*_i.scale/Ma,Qi=new r(ko,Za),Na=new r(uo,Za),ja=new r(ko,Ri),za=new r(uo,Ri);if(io){var Ea=new r(-Sa,Sa- -17),ia=-Math.PI/2,Ua=12-Sa,ts=new r(22-Ua,-(_i.imageName?Ua:0)),Ro=new(Function.prototype.bind.apply(r,[null].concat(ao)));Qi._rotateAround(ia,Ea)._add(ts)._add(Ro),Na._rotateAround(ia,Ea)._add(ts)._add(Ro),ja._rotateAround(ia,Ea)._add(ts)._add(Ro),za._rotateAround(ia,Ea)._add(ts)._add(Ro)}if(Kn){var Ss=Math.sin(Kn),Gs=Math.cos(Kn),_o=[Gs,-Ss,Ss,Gs];Qi._matMult(_o),Na._matMult(_o),ja._matMult(_o),za._matMult(_o)}var Es=new r(0,0),Ls=new r(0,0);pi.push({tl:Qi,tr:Na,bl:ja,br:za,tex:Hi,writingMode:ln.writingMode,glyphOffset:Vo,sectionIndex:_i.sectionIndex,isSDF:ua,pixelOffsetTL:Es,pixelOffsetBR:Ls,minFontScaleX:0,minFontScaleY:0})}}return pi}(0,Z,je,pe,xe,Ce,ie,A.allowVerticalPlacement),Cr=A.textSizeData,Lr=null;"source"===Cr.kind?(Lr=[128*pe.layout.get("text-size").evaluate(Ce,{})])[0]>32640&&M(A.layerIds[0]+': Value for "text-size" is >= 255. Reduce your "text-size".'):"composite"===Cr.kind&&((Lr=[128*qt.compositeTextSizes[0].evaluate(Ce,{},ar),128*qt.compositeTextSizes[1].evaluate(Ce,{},ar)])[0]>32640||Lr[1]>32640)&&M(A.layerIds[0]+': Value for "text-size" is >= 255. Reduce your "text-size".'),A.addSymbols(A.text,yr,Lr,je,xe,Ce,ut,O,$e.lineStartIndex,$e.lineLength,Yt,ar);for(var jr=0,Ur=vt;jr<Ur.length;jr+=1)zt[Ur[jr]]=A.text.placedSymbolArray.length-1;return 4*yr.length}function Tf(A){for(var O in A)return A[O];return null}function pp(A,O,Z,ie){var pe=A.compareText;if(O in pe){for(var xe=pe[O],Ce=xe.length-1;Ce>=0;Ce--)if(ie.dist(xe[Ce])<Z)return!0}else pe[O]=[];return pe[O].push(ie),!1}var dp=_l.VectorTileFeature.types,gp=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function Ac(A,O,Z,ie,pe,xe,Ce,je,$e,ut,vt,zt,Yt){var qt=je?Math.min(32640,Math.round(je[0])):0,ar=je?Math.min(32640,Math.round(je[1])):0;A.emplaceBack(O,Z,Math.round(32*ie),Math.round(32*pe),xe,Ce,(qt<<1)+($e?1:0),ar,16*ut,16*vt,256*zt,256*Yt)}function gu(A,O,Z){A.emplaceBack(O.x,O.y,Z),A.emplaceBack(O.x,O.y,Z),A.emplaceBack(O.x,O.y,Z),A.emplaceBack(O.x,O.y,Z)}function mp(A){for(var O=0,Z=A.sections;O<Z.length;O+=1)if(ri(Z[O].text))return!0;return!1}var El=function(A){this.layoutVertexArray=new Ts,this.indexArray=new eo,this.programConfigurations=A,this.segments=new Dt,this.dynamicLayoutVertexArray=new is,this.opacityVertexArray=new Ws,this.placedSymbolArray=new qe};El.prototype.isEmpty=function(){return 0===this.layoutVertexArray.length&&0===this.indexArray.length&&0===this.dynamicLayoutVertexArray.length&&0===this.opacityVertexArray.length},El.prototype.upload=function(A,O,Z,ie){this.isEmpty()||(Z&&(this.layoutVertexBuffer=A.createVertexBuffer(this.layoutVertexArray,cu.members),this.indexBuffer=A.createIndexBuffer(this.indexArray,O),this.dynamicLayoutVertexBuffer=A.createVertexBuffer(this.dynamicLayoutVertexArray,qh.members,!0),this.opacityVertexBuffer=A.createVertexBuffer(this.opacityVertexArray,gp,!0),this.opacityVertexBuffer.itemSize=1),(Z||ie)&&this.programConfigurations.upload(A))},El.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())},Wr("SymbolBuffers",El);var ec=function(A,O,Z){this.layoutVertexArray=new A,this.layoutAttributes=O,this.indexArray=new Z,this.segments=new Dt,this.collisionVertexArray=new ks};ec.prototype.upload=function(A){this.layoutVertexBuffer=A.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=A.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=A.createVertexBuffer(this.collisionVertexArray,Hh.members,!0)},ec.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy())},Wr("CollisionBuffers",ec);var sa=function(A){this.collisionBoxArray=A.collisionBoxArray,this.zoom=A.zoom,this.overscaling=A.overscaling,this.layers=A.layers,this.layerIds=this.layers.map(function(Ce){return Ce.id}),this.index=A.index,this.pixelRatio=A.pixelRatio,this.sourceLayerIndex=A.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=Hl([]),this.placementViewportMatrix=Hl([]);var O=this.layers[0]._unevaluatedLayout._values;this.textSizeData=hu(this.zoom,O["text-size"]),this.iconSizeData=hu(this.zoom,O["icon-size"]);var Z=this.layers[0].layout,ie=Z.get("symbol-sort-key"),pe=Z.get("symbol-z-order");this.sortFeaturesByKey="viewport-y"!==pe&&void 0!==ie.constantOr(1),this.sortFeaturesByY=("viewport-y"===pe||"auto"===pe&&!this.sortFeaturesByKey)&&(Z.get("text-allow-overlap")||Z.get("icon-allow-overlap")||Z.get("text-ignore-placement")||Z.get("icon-ignore-placement")),"point"===Z.get("symbol-placement")&&(this.writingModes=Z.get("text-writing-mode").map(function(Ce){return as[Ce]})),this.stateDependentLayerIds=this.layers.filter(function(Ce){return Ce.isStateDependent()}).map(function(Ce){return Ce.id}),this.sourceID=A.sourceID};sa.prototype.createArrays=function(){this.text=new El(new ca(cu.members,this.layers,this.zoom,function(A){return/^text/.test(A)})),this.icon=new El(new ca(cu.members,this.layers,this.zoom,function(A){return/^icon/.test(A)})),this.glyphOffsetArray=new _t,this.lineVertexArray=new Et,this.symbolInstances=new at},sa.prototype.calculateGlyphDependencies=function(A,O,Z,ie,pe){for(var xe=0;xe<A.length;xe++)if(O[A.charCodeAt(xe)]=!0,(Z||ie)&&pe){var Ce=Kl[A.charAt(xe)];Ce&&(O[Ce.charCodeAt(0)]=!0)}},sa.prototype.populate=function(A,O,Z){var ie=this.layers[0],pe=ie.layout,xe=pe.get("text-font"),Ce=pe.get("text-field"),je=pe.get("icon-image"),$e=("constant"!==Ce.value.kind||Ce.value.value instanceof cr&&!Ce.value.value.isEmpty()||Ce.value.value.toString().length>0)&&("constant"!==xe.value.kind||xe.value.value.length>0),ut="constant"!==je.value.kind||!!je.value.value||Object.keys(je.parameters).length>0,vt=pe.get("symbol-sort-key");if(this.features=[],$e||ut){for(var zt=O.iconDependencies,Yt=O.glyphDependencies,qt=O.availableImages,ar=new ra(this.zoom),yr=0,Cr=A;yr<Cr.length;yr+=1){var Lr=Cr[yr],jr=Lr.feature,Ur=Lr.id,Zr=Lr.index,ln=Lr.sourceLayerIndex,yn=ie._featureFilter.needGeometry,Bn={type:jr.type,id:Ur,properties:jr.properties,geometry:yn?ga(jr):[]};if(ie._featureFilter.filter(ar,Bn,Z)){yn||(Bn.geometry=ga(jr));var Rn=void 0;if($e){var Gn=ie.getValueAndResolveTokens("text-field",Bn,Z,qt),ai=cr.factory(Gn);mp(ai)&&(this.hasRTLText=!0),(!this.hasRTLText||"unavailable"===Va()||this.hasRTLText&&co.isParsed())&&(Rn=Zh(ai,ie,Bn))}var oi=void 0;if(ut){var Kn=ie.getValueAndResolveTokens("icon-image",Bn,Z,qt);oi=Kn instanceof gr?Kn:gr.fromString(Kn)}if(Rn||oi){var pi=this.sortFeaturesByKey?vt.evaluate(Bn,{},Z):void 0,fi={id:Ur,text:Rn,icon:oi,index:Zr,sourceLayerIndex:ln,geometry:ga(jr),properties:jr.properties,type:dp[jr.type],sortKey:pi};if(this.features.push(fi),oi&&(zt[oi.name]=!0),Rn){var si=xe.evaluate(Bn,{},Z).join(","),Ki="map"===pe.get("text-rotation-alignment")&&"point"!==pe.get("symbol-placement");this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(as.vertical)>=0;for(var Vi=0,ea=Rn.sections;Vi<ea.length;Vi+=1){var _i=ea[Vi];if(_i.image)zt[_i.image.name]=!0;else{var Hi=Di(Rn.toString()),va=_i.fontStack||si,ua=Yt[va]=Yt[va]||{};this.calculateGlyphDependencies(_i.text,ua,Ki,this.allowVerticalPlacement,Hi)}}}}}}"line"===pe.get("symbol-placement")&&(this.features=function(Ma){var fa={},io={},Sa=[],Po=0;function bo(za){Sa.push(Ma[za]),Po++}function To(za,Ea,ia){var Ua=io[za];return delete io[za],io[Ea]=Ua,Sa[Ua].geometry[0].pop(),Sa[Ua].geometry[0]=Sa[Ua].geometry[0].concat(ia[0]),Ua}function Vo(za,Ea,ia){var Ua=fa[Ea];return delete fa[Ea],fa[za]=Ua,Sa[Ua].geometry[0].shift(),Sa[Ua].geometry[0]=ia[0].concat(Sa[Ua].geometry[0]),Ua}function zo(za,Ea,ia){var Ua=ia?Ea[0][Ea[0].length-1]:Ea[0][0];return za+":"+Ua.x+":"+Ua.y}for(var ao=0;ao<Ma.length;ao++){var ko=Ma[ao],Za=ko.geometry,uo=ko.text?ko.text.toString():null;if(uo){var Ri=zo(uo,Za),Qi=zo(uo,Za,!0);if(Ri in io&&Qi in fa&&io[Ri]!==fa[Qi]){var Na=Vo(Ri,Qi,Za),ja=To(Ri,Qi,Sa[Na].geometry);delete fa[Ri],delete io[Qi],io[zo(uo,Sa[ja].geometry,!0)]=ja,Sa[Na].geometry=null}else Ri in io?To(Ri,Qi,Za):Qi in fa?Vo(Ri,Qi,Za):(bo(ao),fa[Ri]=Po-1,io[Qi]=Po-1)}else bo(ao)}return Sa.filter(function(za){return za.geometry})}(this.features)),this.sortFeaturesByKey&&this.features.sort(function(Ma,fa){return Ma.sortKey-fa.sortKey})}},sa.prototype.update=function(A,O,Z){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(A,O,this.layers,Z),this.icon.programConfigurations.updatePaintArrays(A,O,this.layers,Z))},sa.prototype.isEmpty=function(){return 0===this.symbolInstances.length&&!this.hasRTLText},sa.prototype.uploadPending=function(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload},sa.prototype.upload=function(A){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(A),this.iconCollisionBox.upload(A)),this.text.upload(A,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(A,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0},sa.prototype.destroyDebugData=function(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()},sa.prototype.destroy=function(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()},sa.prototype.addToLineVertexArray=function(A,O){var Z=this.lineVertexArray.length;if(void 0!==A.segment){for(var ie=A.dist(O[A.segment+1]),pe=A.dist(O[A.segment]),xe={},Ce=A.segment+1;Ce<O.length;Ce++)xe[Ce]={x:O[Ce].x,y:O[Ce].y,tileUnitDistanceFromAnchor:ie},Ce<O.length-1&&(ie+=O[Ce+1].dist(O[Ce]));for(var je=A.segment||0;je>=0;je--)xe[je]={x:O[je].x,y:O[je].y,tileUnitDistanceFromAnchor:pe},je>0&&(pe+=O[je-1].dist(O[je]));for(var $e=0;$e<O.length;$e++){var ut=xe[$e];this.lineVertexArray.emplaceBack(ut.x,ut.y,ut.tileUnitDistanceFromAnchor)}}return{lineStartIndex:Z,lineLength:this.lineVertexArray.length-Z}},sa.prototype.addSymbols=function(A,O,Z,ie,pe,xe,Ce,je,$e,ut,vt,zt){for(var Yt=A.indexArray,qt=A.layoutVertexArray,ar=A.segments.prepareSegment(4*O.length,qt,Yt,xe.sortKey),yr=this.glyphOffsetArray.length,Cr=ar.vertexLength,Lr=this.allowVerticalPlacement&&Ce===as.vertical?Math.PI/2:0,jr=xe.text&&xe.text.sections,Ur=0;Ur<O.length;Ur++){var Zr=O[Ur],ln=Zr.tl,yn=Zr.tr,Bn=Zr.bl,Rn=Zr.br,Gn=Zr.tex,ai=Zr.pixelOffsetTL,oi=Zr.pixelOffsetBR,Kn=Zr.minFontScaleX,pi=Zr.minFontScaleY,fi=Zr.glyphOffset,si=Zr.isSDF,Ki=Zr.sectionIndex,Vi=ar.vertexLength,ea=fi[1];Ac(qt,je.x,je.y,ln.x,ea+ln.y,Gn.x,Gn.y,Z,si,ai.x,ai.y,Kn,pi),Ac(qt,je.x,je.y,yn.x,ea+yn.y,Gn.x+Gn.w,Gn.y,Z,si,oi.x,ai.y,Kn,pi),Ac(qt,je.x,je.y,Bn.x,ea+Bn.y,Gn.x,Gn.y+Gn.h,Z,si,ai.x,oi.y,Kn,pi),Ac(qt,je.x,je.y,Rn.x,ea+Rn.y,Gn.x+Gn.w,Gn.y+Gn.h,Z,si,oi.x,oi.y,Kn,pi),gu(A.dynamicLayoutVertexArray,je,Lr),Yt.emplaceBack(Vi,Vi+1,Vi+2),Yt.emplaceBack(Vi+1,Vi+2,Vi+3),ar.vertexLength+=4,ar.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(fi[0]),Ur!==O.length-1&&Ki===O[Ur+1].sectionIndex||A.programConfigurations.populatePaintArrays(qt.length,xe,xe.index,{},zt,jr&&jr[Ki])}A.placedSymbolArray.emplaceBack(je.x,je.y,yr,this.glyphOffsetArray.length-yr,Cr,$e,ut,je.segment,Z?Z[0]:0,Z?Z[1]:0,ie[0],ie[1],Ce,0,!1,0,vt)},sa.prototype._addCollisionDebugVertex=function(A,O,Z,ie,pe,xe){return O.emplaceBack(0,0),A.emplaceBack(Z.x,Z.y,ie,pe,Math.round(xe.x),Math.round(xe.y))},sa.prototype.addCollisionDebugVertices=function(A,O,Z,ie,pe,xe,Ce){var je=pe.segments.prepareSegment(4,pe.layoutVertexArray,pe.indexArray),$e=je.vertexLength,ut=pe.layoutVertexArray,vt=pe.collisionVertexArray,zt=Ce.anchorX,Yt=Ce.anchorY;this._addCollisionDebugVertex(ut,vt,xe,zt,Yt,new r(A,O)),this._addCollisionDebugVertex(ut,vt,xe,zt,Yt,new r(Z,O)),this._addCollisionDebugVertex(ut,vt,xe,zt,Yt,new r(Z,ie)),this._addCollisionDebugVertex(ut,vt,xe,zt,Yt,new r(A,ie)),je.vertexLength+=4;var qt=pe.indexArray;qt.emplaceBack($e,$e+1),qt.emplaceBack($e+1,$e+2),qt.emplaceBack($e+2,$e+3),qt.emplaceBack($e+3,$e),je.primitiveLength+=4},sa.prototype.addDebugCollisionBoxes=function(A,O,Z,ie){for(var pe=A;pe<O;pe++){var xe=this.collisionBoxArray.get(pe);this.addCollisionDebugVertices(xe.x1,xe.y1,xe.x2,xe.y2,ie?this.textCollisionBox:this.iconCollisionBox,xe.anchorPoint,Z)}},sa.prototype.generateCollisionDebugBuffers=function(){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new ec(hs,ef.members,F),this.iconCollisionBox=new ec(hs,ef.members,F);for(var A=0;A<this.symbolInstances.length;A++){var O=this.symbolInstances.get(A);this.addDebugCollisionBoxes(O.textBoxStartIndex,O.textBoxEndIndex,O,!0),this.addDebugCollisionBoxes(O.verticalTextBoxStartIndex,O.verticalTextBoxEndIndex,O,!0),this.addDebugCollisionBoxes(O.iconBoxStartIndex,O.iconBoxEndIndex,O,!1),this.addDebugCollisionBoxes(O.verticalIconBoxStartIndex,O.verticalIconBoxEndIndex,O,!1)}},sa.prototype._deserializeCollisionBoxesForSymbol=function(A,O,Z,ie,pe,xe,Ce,je,$e){for(var ut={},vt=O;vt<Z;vt++){var zt=A.get(vt);ut.textBox={x1:zt.x1,y1:zt.y1,x2:zt.x2,y2:zt.y2,anchorPointX:zt.anchorPointX,anchorPointY:zt.anchorPointY},ut.textFeatureIndex=zt.featureIndex;break}for(var Yt=ie;Yt<pe;Yt++){var qt=A.get(Yt);ut.verticalTextBox={x1:qt.x1,y1:qt.y1,x2:qt.x2,y2:qt.y2,anchorPointX:qt.anchorPointX,anchorPointY:qt.anchorPointY},ut.verticalTextFeatureIndex=qt.featureIndex;break}for(var ar=xe;ar<Ce;ar++){var yr=A.get(ar);ut.iconBox={x1:yr.x1,y1:yr.y1,x2:yr.x2,y2:yr.y2,anchorPointX:yr.anchorPointX,anchorPointY:yr.anchorPointY},ut.iconFeatureIndex=yr.featureIndex;break}for(var Cr=je;Cr<$e;Cr++){var Lr=A.get(Cr);ut.verticalIconBox={x1:Lr.x1,y1:Lr.y1,x2:Lr.x2,y2:Lr.y2,anchorPointX:Lr.anchorPointX,anchorPointY:Lr.anchorPointY},ut.verticalIconFeatureIndex=Lr.featureIndex;break}return ut},sa.prototype.deserializeCollisionBoxes=function(A){this.collisionArrays=[];for(var O=0;O<this.symbolInstances.length;O++){var Z=this.symbolInstances.get(O);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(A,Z.textBoxStartIndex,Z.textBoxEndIndex,Z.verticalTextBoxStartIndex,Z.verticalTextBoxEndIndex,Z.iconBoxStartIndex,Z.iconBoxEndIndex,Z.verticalIconBoxStartIndex,Z.verticalIconBoxEndIndex))}},sa.prototype.hasTextData=function(){return this.text.segments.get().length>0},sa.prototype.hasIconData=function(){return this.icon.segments.get().length>0},sa.prototype.hasDebugData=function(){return this.textCollisionBox&&this.iconCollisionBox},sa.prototype.hasTextCollisionBoxData=function(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0},sa.prototype.hasIconCollisionBoxData=function(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0},sa.prototype.addIndicesForPlacedSymbol=function(A,O){for(var Z=A.placedSymbolArray.get(O),ie=Z.vertexStartIndex+4*Z.numGlyphs,pe=Z.vertexStartIndex;pe<ie;pe+=4)A.indexArray.emplaceBack(pe,pe+1,pe+2),A.indexArray.emplaceBack(pe+1,pe+2,pe+3)},sa.prototype.getSortedSymbolIndexes=function(A){if(this.sortedAngle===A&&void 0!==this.symbolInstanceIndexes)return this.symbolInstanceIndexes;for(var O=Math.sin(A),Z=Math.cos(A),ie=[],pe=[],xe=[],Ce=0;Ce<this.symbolInstances.length;++Ce){xe.push(Ce);var je=this.symbolInstances.get(Ce);ie.push(0|Math.round(O*je.anchorX+Z*je.anchorY)),pe.push(je.featureIndex)}return xe.sort(function($e,ut){return ie[$e]-ie[ut]||pe[ut]-pe[$e]}),xe},sa.prototype.addToSortKeyRanges=function(A,O){var Z=this.sortKeyRanges[this.sortKeyRanges.length-1];Z&&Z.sortKey===O?Z.symbolInstanceEnd=A+1:this.sortKeyRanges.push({sortKey:O,symbolInstanceStart:A,symbolInstanceEnd:A+1})},sa.prototype.sortFeatures=function(A){var O=this;if(this.sortFeaturesByY&&this.sortedAngle!==A&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(A),this.sortedAngle=A,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(var Z=0,ie=this.symbolInstanceIndexes;Z<ie.length;Z+=1){var xe=this.symbolInstances.get(ie[Z]);this.featureSortOrder.push(xe.featureIndex),[xe.rightJustifiedTextSymbolIndex,xe.centerJustifiedTextSymbolIndex,xe.leftJustifiedTextSymbolIndex].forEach(function(Ce,je,$e){Ce>=0&&$e.indexOf(Ce)===je&&O.addIndicesForPlacedSymbol(O.text,Ce)}),xe.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.text,xe.verticalPlacedTextSymbolIndex),xe.placedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,xe.placedIconSymbolIndex),xe.verticalPlacedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,xe.verticalPlacedIconSymbolIndex)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}},Wr("SymbolBucket",sa,{omit:["layers","collisionBoxArray","features","compareText"]}),sa.MAX_GLYPHS=65535,sa.addDynamicAttributes=gu;var vp=new Eo({"symbol-placement":new ci(ye.layout_symbol["symbol-placement"]),"symbol-spacing":new ci(ye.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new ci(ye.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new yi(ye.layout_symbol["symbol-sort-key"]),"symbol-z-order":new ci(ye.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new ci(ye.layout_symbol["icon-allow-overlap"]),"icon-ignore-placement":new ci(ye.layout_symbol["icon-ignore-placement"]),"icon-optional":new ci(ye.layout_symbol["icon-optional"]),"icon-rotation-alignment":new ci(ye.layout_symbol["icon-rotation-alignment"]),"icon-size":new yi(ye.layout_symbol["icon-size"]),"icon-text-fit":new ci(ye.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new ci(ye.layout_symbol["icon-text-fit-padding"]),"icon-image":new yi(ye.layout_symbol["icon-image"]),"icon-rotate":new yi(ye.layout_symbol["icon-rotate"]),"icon-padding":new ci(ye.layout_symbol["icon-padding"]),"icon-keep-upright":new ci(ye.layout_symbol["icon-keep-upright"]),"icon-offset":new yi(ye.layout_symbol["icon-offset"]),"icon-anchor":new yi(ye.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new ci(ye.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new ci(ye.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new ci(ye.layout_symbol["text-rotation-alignment"]),"text-field":new yi(ye.layout_symbol["text-field"]),"text-font":new yi(ye.layout_symbol["text-font"]),"text-size":new yi(ye.layout_symbol["text-size"]),"text-max-width":new yi(ye.layout_symbol["text-max-width"]),"text-line-height":new ci(ye.layout_symbol["text-line-height"]),"text-letter-spacing":new yi(ye.layout_symbol["text-letter-spacing"]),"text-justify":new yi(ye.layout_symbol["text-justify"]),"text-radial-offset":new yi(ye.layout_symbol["text-radial-offset"]),"text-variable-anchor":new ci(ye.layout_symbol["text-variable-anchor"]),"text-anchor":new yi(ye.layout_symbol["text-anchor"]),"text-max-angle":new ci(ye.layout_symbol["text-max-angle"]),"text-writing-mode":new ci(ye.layout_symbol["text-writing-mode"]),"text-rotate":new yi(ye.layout_symbol["text-rotate"]),"text-padding":new ci(ye.layout_symbol["text-padding"]),"text-keep-upright":new ci(ye.layout_symbol["text-keep-upright"]),"text-transform":new yi(ye.layout_symbol["text-transform"]),"text-offset":new yi(ye.layout_symbol["text-offset"]),"text-allow-overlap":new ci(ye.layout_symbol["text-allow-overlap"]),"text-ignore-placement":new ci(ye.layout_symbol["text-ignore-placement"]),"text-optional":new ci(ye.layout_symbol["text-optional"])}),mu={paint:new Eo({"icon-opacity":new yi(ye.paint_symbol["icon-opacity"]),"icon-color":new yi(ye.paint_symbol["icon-color"]),"icon-halo-color":new yi(ye.paint_symbol["icon-halo-color"]),"icon-halo-width":new yi(ye.paint_symbol["icon-halo-width"]),"icon-halo-blur":new yi(ye.paint_symbol["icon-halo-blur"]),"icon-translate":new ci(ye.paint_symbol["icon-translate"]),"icon-translate-anchor":new ci(ye.paint_symbol["icon-translate-anchor"]),"text-opacity":new yi(ye.paint_symbol["text-opacity"]),"text-color":new yi(ye.paint_symbol["text-color"],{runtimeType:kt,getOverride:function(A){return A.textColor},hasOverride:function(A){return!!A.textColor}}),"text-halo-color":new yi(ye.paint_symbol["text-halo-color"]),"text-halo-width":new yi(ye.paint_symbol["text-halo-width"]),"text-halo-blur":new yi(ye.paint_symbol["text-halo-blur"]),"text-translate":new ci(ye.paint_symbol["text-translate"]),"text-translate-anchor":new ci(ye.paint_symbol["text-translate-anchor"])}),layout:vp},Ll=function(A){this.type=A.property.overrides?A.property.overrides.runtimeType:Ct,this.defaultValue=A};Ll.prototype.evaluate=function(A){if(A.formattedSection){var O=this.defaultValue.property.overrides;if(O&&O.hasOverride(A.formattedSection))return O.getOverride(A.formattedSection)}return A.feature&&A.featureState?this.defaultValue.evaluate(A.feature,A.featureState):this.defaultValue.property.specification.default},Ll.prototype.eachChild=function(A){this.defaultValue.isConstant()||A(this.defaultValue.value._styleExpression.expression)},Ll.prototype.outputDefined=function(){return!1},Ll.prototype.serialize=function(){return null},Wr("FormatSectionOverride",Ll,{omit:["defaultValue"]});var yp=function(A){function O(Z){A.call(this,Z,mu)}return A&&(O.__proto__=A),(O.prototype=Object.create(A&&A.prototype)).constructor=O,O.prototype.recalculate=function(Z,ie){if(A.prototype.recalculate.call(this,Z,ie),"auto"===this.layout.get("icon-rotation-alignment")&&(this.layout._values["icon-rotation-alignment"]="point"!==this.layout.get("symbol-placement")?"map":"viewport"),"auto"===this.layout.get("text-rotation-alignment")&&(this.layout._values["text-rotation-alignment"]="point"!==this.layout.get("symbol-placement")?"map":"viewport"),"auto"===this.layout.get("text-pitch-alignment")&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")),"auto"===this.layout.get("icon-pitch-alignment")&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment")),"point"===this.layout.get("symbol-placement")){var pe=this.layout.get("text-writing-mode");if(pe){for(var xe=[],Ce=0,je=pe;Ce<je.length;Ce+=1){var $e=je[Ce];xe.indexOf($e)<0&&xe.push($e)}this.layout._values["text-writing-mode"]=xe}else this.layout._values["text-writing-mode"]=["horizontal"]}this._setPaintOverrides()},O.prototype.getValueAndResolveTokens=function(Z,ie,pe,xe){var $e,Ce=this.layout.get(Z).evaluate(ie,{},pe,xe),je=this._unevaluatedLayout._values[Z];return je.isDataDriven()||Kt(je.value)||!Ce?Ce:($e=ie.properties,Ce.replace(/{([^{}]+)}/g,function(vt,zt){return zt in $e?String($e[zt]):""}))},O.prototype.createBucket=function(Z){return new sa(Z)},O.prototype.queryRadius=function(){return 0},O.prototype.queryIntersectsFeature=function(){return!1},O.prototype._setPaintOverrides=function(){for(var Z=0,ie=mu.paint.overridableProperties;Z<ie.length;Z+=1){var pe=ie[Z];if(O.hasPaintOverride(this.layout,pe)){var $e,xe=this.paint.get(pe),Ce=new Ll(xe),je=new Xt(Ce,xe.property.specification);$e="constant"===xe.value.kind||"source"===xe.value.kind?new ir("source",je):new pr("composite",je,xe.value.zoomStops,xe.value._interpolationType),this.paint._values[pe]=new Da(xe.property,$e,xe.parameters)}}},O.prototype._handleOverridablePaintPropertyUpdate=function(Z,ie,pe){return!(!this.layout||ie.isDataDriven()||pe.isDataDriven())&&O.hasPaintOverride(this.layout,Z)},O.hasPaintOverride=function(Z,ie){var pe=Z.get("text-field"),xe=mu.paint.properties[ie],Ce=!1,je=function(vt){for(var zt=0,Yt=vt;zt<Yt.length;zt+=1)if(xe.overrides&&xe.overrides.hasOverride(Yt[zt]))return void(Ce=!0)};if("constant"===pe.value.kind&&pe.value.value instanceof cr)je(pe.value.value.sections);else if("source"===pe.value.kind){var $e=function(vt){Ce||(vt instanceof un&&Nr(vt.value)===it?je(vt.value.sections):vt instanceof dn?je(vt.sections):vt.eachChild($e))},ut=pe.value;ut._styleExpression&&$e(ut._styleExpression.expression)}return Ce},O}(Uo),xp={paint:new Eo({"background-color":new ci(ye.paint_background["background-color"]),"background-pattern":new zs(ye.paint_background["background-pattern"]),"background-opacity":new ci(ye.paint_background["background-opacity"])})},bp=function(A){function O(Z){A.call(this,Z,xp)}return A&&(O.__proto__=A),(O.prototype=Object.create(A&&A.prototype)).constructor=O,O}(Uo),_p={paint:new Eo({"raster-opacity":new ci(ye.paint_raster["raster-opacity"]),"raster-hue-rotate":new ci(ye.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new ci(ye.paint_raster["raster-brightness-min"]),"raster-brightness-max":new ci(ye.paint_raster["raster-brightness-max"]),"raster-saturation":new ci(ye.paint_raster["raster-saturation"]),"raster-contrast":new ci(ye.paint_raster["raster-contrast"]),"raster-resampling":new ci(ye.paint_raster["raster-resampling"]),"raster-fade-duration":new ci(ye.paint_raster["raster-fade-duration"])})},wp=function(A){function O(Z){A.call(this,Z,_p)}return A&&(O.__proto__=A),(O.prototype=Object.create(A&&A.prototype)).constructor=O,O}(Uo),Tp=function(A){function O(Z){A.call(this,Z,{}),this.implementation=Z}return A&&(O.__proto__=A),(O.prototype=Object.create(A&&A.prototype)).constructor=O,O.prototype.is3D=function(){return"3d"===this.implementation.renderingMode},O.prototype.hasOffscreenPass=function(){return void 0!==this.implementation.prerender},O.prototype.recalculate=function(){},O.prototype.updateTransitions=function(){},O.prototype.hasTransition=function(){},O.prototype.serialize=function(){},O.prototype.onAdd=function(Z){this.implementation.onAdd&&this.implementation.onAdd(Z,Z.painter.context.gl)},O.prototype.onRemove=function(Z){this.implementation.onRemove&&this.implementation.onRemove(Z,Z.painter.context.gl)},O}(Uo),kp={circle:ch,heatmap:fh,hillshade:ph,fill:Lh,"fill-extrusion":Bh,line:Vh,symbol:yp,background:bp,raster:wp},kf=self.HTMLImageElement,Af=self.HTMLCanvasElement,Mf=self.HTMLVideoElement,Sf=self.ImageData,Mc=self.ImageBitmap,hl=function(A,O,Z,ie){this.context=A,this.format=Z,this.texture=A.gl.createTexture(),this.update(O,ie)};hl.prototype.update=function(A,O,Z){var ie=A.width,pe=A.height,xe=!(this.size&&this.size[0]===ie&&this.size[1]===pe||Z),Ce=this.context,je=Ce.gl;if(this.useMipmap=Boolean(O&&O.useMipmap),je.bindTexture(je.TEXTURE_2D,this.texture),Ce.pixelStoreUnpackFlipY.set(!1),Ce.pixelStoreUnpack.set(1),Ce.pixelStoreUnpackPremultiplyAlpha.set(this.format===je.RGBA&&(!O||!1!==O.premultiply)),xe)this.size=[ie,pe],A instanceof kf||A instanceof Af||A instanceof Mf||A instanceof Sf||Mc&&A instanceof Mc?je.texImage2D(je.TEXTURE_2D,0,this.format,this.format,je.UNSIGNED_BYTE,A):je.texImage2D(je.TEXTURE_2D,0,this.format,ie,pe,0,this.format,je.UNSIGNED_BYTE,A.data);else{var $e=Z||{x:0,y:0},ut=$e.x,vt=$e.y;A instanceof kf||A instanceof Af||A instanceof Mf||A instanceof Sf||Mc&&A instanceof Mc?je.texSubImage2D(je.TEXTURE_2D,0,ut,vt,je.RGBA,je.UNSIGNED_BYTE,A):je.texSubImage2D(je.TEXTURE_2D,0,ut,vt,ie,pe,je.RGBA,je.UNSIGNED_BYTE,A.data)}this.useMipmap&&this.isSizePowerOfTwo()&&je.generateMipmap(je.TEXTURE_2D)},hl.prototype.bind=function(A,O,Z){var ie=this.context.gl;ie.bindTexture(ie.TEXTURE_2D,this.texture),Z!==ie.LINEAR_MIPMAP_NEAREST||this.isSizePowerOfTwo()||(Z=ie.LINEAR),A!==this.filter&&(ie.texParameteri(ie.TEXTURE_2D,ie.TEXTURE_MAG_FILTER,A),ie.texParameteri(ie.TEXTURE_2D,ie.TEXTURE_MIN_FILTER,Z||A),this.filter=A),O!==this.wrap&&(ie.texParameteri(ie.TEXTURE_2D,ie.TEXTURE_WRAP_S,O),ie.texParameteri(ie.TEXTURE_2D,ie.TEXTURE_WRAP_T,O),this.wrap=O)},hl.prototype.isSizePowerOfTwo=function(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0},hl.prototype.destroy=function(){this.context.gl.deleteTexture(this.texture),this.texture=null};var vu=function(A){var O=this;this._callback=A,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=function(){O._triggered=!1,O._callback()})};vu.prototype.trigger=function(){var A=this;this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(function(){A._triggered=!1,A._callback()},0))},vu.prototype.remove=function(){delete this._channel,this._callback=function(){}};var Cl=function(A,O,Z){this.target=A,this.parent=O,this.mapId=Z,this.callbacks={},this.tasks={},this.taskQueue=[],this.cancelCallbacks={},l(["receive","process"],this),this.invoker=new vu(this.process),this.target.addEventListener("message",this.receive,!1),this.globalScope=S()?A:self};function Ef(A,O,Z){var ie=2*Math.PI*6378137/256/Math.pow(2,Z);return[A*ie-2*Math.PI*6378137/2,O*ie-2*Math.PI*6378137/2]}Cl.prototype.send=function(A,O,Z,ie,pe){var xe=this;void 0===pe&&(pe=!1);var Ce=Math.round(1e18*Math.random()).toString(36).substring(0,10);Z&&(this.callbacks[Ce]=Z);var je=R(this.globalScope)?void 0:[];return this.target.postMessage({id:Ce,type:A,hasCallback:!!Z,targetMapId:ie,mustQueue:pe,sourceMapId:this.mapId,data:ei(O,je)},je),{cancel:function(){Z&&delete xe.callbacks[Ce],xe.target.postMessage({id:Ce,type:"<cancel>",targetMapId:ie,sourceMapId:xe.mapId})}}},Cl.prototype.receive=function(A){var O=A.data,Z=O.id;if(Z&&(!O.targetMapId||this.mapId===O.targetMapId))if("<cancel>"===O.type){delete this.tasks[Z];var ie=this.cancelCallbacks[Z];delete this.cancelCallbacks[Z],ie&&ie()}else S()||O.mustQueue?(this.tasks[Z]=O,this.taskQueue.push(Z),this.invoker.trigger()):this.processTask(Z,O)},Cl.prototype.process=function(){if(this.taskQueue.length){var A=this.taskQueue.shift(),O=this.tasks[A];delete this.tasks[A],this.taskQueue.length&&this.invoker.trigger(),O&&this.processTask(A,O)}},Cl.prototype.processTask=function(A,O){var Z=this;if("<response>"===O.type){var ie=this.callbacks[A];delete this.callbacks[A],ie&&(O.error?ie(wi(O.error)):ie(null,wi(O.data)))}else{var pe=!1,xe=R(this.globalScope)?void 0:[],Ce=O.hasCallback?function(vt,zt){pe=!0,delete Z.cancelCallbacks[A],Z.target.postMessage({id:A,type:"<response>",sourceMapId:Z.mapId,error:vt?ei(vt):null,data:ei(zt,xe)},xe)}:function(vt){pe=!0},je=null,$e=wi(O.data);if(this.parent[O.type])je=this.parent[O.type](O.sourceMapId,$e,Ce);else if(this.parent.getWorkerSource){var ut=O.type.split(".");je=this.parent.getWorkerSource(O.sourceMapId,ut[0],$e.source)[ut[1]]($e,Ce)}else Ce(new Error("Could not find function "+O.type));!pe&&je&&je.cancel&&(this.cancelCallbacks[A]=je.cancel)}},Cl.prototype.remove=function(){this.invoker.remove(),this.target.removeEventListener("message",this.receive,!1)};var ro=function(A,O){A&&(O?this.setSouthWest(A).setNorthEast(O):4===A.length?this.setSouthWest([A[0],A[1]]).setNorthEast([A[2],A[3]]):this.setSouthWest(A[0]).setNorthEast(A[1]))};ro.prototype.setNorthEast=function(A){return this._ne=A instanceof Aa?new Aa(A.lng,A.lat):Aa.convert(A),this},ro.prototype.setSouthWest=function(A){return this._sw=A instanceof Aa?new Aa(A.lng,A.lat):Aa.convert(A),this},ro.prototype.extend=function(A){var O,Z,ie=this._sw,pe=this._ne;if(A instanceof Aa)O=A,Z=A;else{if(!(A instanceof ro))return Array.isArray(A)?4===A.length||A.every(Array.isArray)?this.extend(ro.convert(A)):this.extend(Aa.convert(A)):this;if(Z=A._ne,!(O=A._sw)||!Z)return this}return ie||pe?(ie.lng=Math.min(O.lng,ie.lng),ie.lat=Math.min(O.lat,ie.lat),pe.lng=Math.max(Z.lng,pe.lng),pe.lat=Math.max(Z.lat,pe.lat)):(this._sw=new Aa(O.lng,O.lat),this._ne=new Aa(Z.lng,Z.lat)),this},ro.prototype.getCenter=function(){return new Aa((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)},ro.prototype.getSouthWest=function(){return this._sw},ro.prototype.getNorthEast=function(){return this._ne},ro.prototype.getNorthWest=function(){return new Aa(this.getWest(),this.getNorth())},ro.prototype.getSouthEast=function(){return new Aa(this.getEast(),this.getSouth())},ro.prototype.getWest=function(){return this._sw.lng},ro.prototype.getSouth=function(){return this._sw.lat},ro.prototype.getEast=function(){return this._ne.lng},ro.prototype.getNorth=function(){return this._ne.lat},ro.prototype.toArray=function(){return[this._sw.toArray(),this._ne.toArray()]},ro.prototype.toString=function(){return"LngLatBounds("+this._sw.toString()+", "+this._ne.toString()+")"},ro.prototype.isEmpty=function(){return!(this._sw&&this._ne)},ro.prototype.contains=function(A){var O=Aa.convert(A),Z=O.lng,ie=O.lat,xe=this._sw.lng<=Z&&Z<=this._ne.lng;return this._sw.lng>this._ne.lng&&(xe=this._sw.lng>=Z&&Z>=this._ne.lng),this._sw.lat<=ie&&ie<=this._ne.lat&&xe},ro.convert=function(A){return!A||A instanceof ro?A:new ro(A)};var Aa=function(A,O){if(isNaN(A)||isNaN(O))throw new Error("Invalid LngLat object: ("+A+", "+O+")");if(this.lng=+A,this.lat=+O,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")};Aa.prototype.wrap=function(){return new Aa(f(this.lng,-180,180),this.lat)},Aa.prototype.toArray=function(){return[this.lng,this.lat]},Aa.prototype.toString=function(){return"LngLat("+this.lng+", "+this.lat+")"},Aa.prototype.distanceTo=function(A){var O=Math.PI/180,Z=this.lat*O,ie=A.lat*O,pe=Math.sin(Z)*Math.sin(ie)+Math.cos(Z)*Math.cos(ie)*Math.cos((A.lng-this.lng)*O);return 6371008.8*Math.acos(Math.min(pe,1))},Aa.prototype.toBounds=function(A){void 0===A&&(A=0);var O=360*A/40075017,Z=O/Math.cos(Math.PI/180*this.lat);return new ro(new Aa(this.lng-Z,this.lat-O),new Aa(this.lng+Z,this.lat+O))},Aa.convert=function(A){if(A instanceof Aa)return A;if(Array.isArray(A)&&(2===A.length||3===A.length))return new Aa(Number(A[0]),Number(A[1]));if(!Array.isArray(A)&&"object"==typeof A&&null!==A)return new Aa(Number("lng"in A?A.lng:A.lon),Number(A.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")};var Lf=2*Math.PI*6371008.8;function Cf(A){return Lf*Math.cos(A*Math.PI/180)}function Pf(A){return(180+A)/360}function If(A){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+A*Math.PI/360)))/360}function Of(A,O){return A/Cf(O)}function yu(A){return 360/Math.PI*Math.atan(Math.exp((180-360*A)*Math.PI/180))-90}var pl=function(A,O,Z){void 0===Z&&(Z=0),this.x=+A,this.y=+O,this.z=+Z};pl.fromLngLat=function(A,O){void 0===O&&(O=0);var Z=Aa.convert(A);return new pl(Pf(Z.lng),If(Z.lat),Of(O,Z.lat))},pl.prototype.toLngLat=function(){return new Aa(360*this.x-180,yu(this.y))},pl.prototype.toAltitude=function(){return this.z*Cf(yu(this.y))},pl.prototype.meterInMercatorCoordinateUnits=function(){return 1/Lf*(A=yu(this.y),1/Math.cos(A*Math.PI/180));var A};var dl=function(A,O,Z){this.z=A,this.x=O,this.y=Z,this.key=tc(0,A,A,O,Z)};dl.prototype.equals=function(A){return this.z===A.z&&this.x===A.x&&this.y===A.y},dl.prototype.url=function(A,O){var Z,ie,pe,xe,Ce,je=(ie=this.y,pe=this.z,xe=Ef(256*(Z=this.x),256*(ie=Math.pow(2,pe)-ie-1),pe),Ce=Ef(256*(Z+1),256*(ie+1),pe),xe[0]+","+xe[1]+","+Ce[0]+","+Ce[1]),$e=function(ut,vt,zt){for(var Yt,qt="",ar=ut;ar>0;ar--)qt+=(vt&(Yt=1<<ar-1)?1:0)+(zt&Yt?2:0);return qt}(this.z,this.x,this.y);return A[(this.x+this.y)%A.length].replace("{prefix}",(this.x%16).toString(16)+(this.y%16).toString(16)).replace("{z}",String(this.z)).replace("{x}",String(this.x)).replace("{y}",String("tms"===O?Math.pow(2,this.z)-this.y-1:this.y)).replace("{quadkey}",$e).replace("{bbox-epsg-3857}",je)},dl.prototype.getTilePoint=function(A){var O=Math.pow(2,this.z);return new r(8192*(A.x*O-this.x),8192*(A.y*O-this.y))},dl.prototype.toString=function(){return this.z+"/"+this.x+"/"+this.y};var Df=function(A,O){this.wrap=A,this.canonical=O,this.key=tc(A,O.z,O.z,O.x,O.y)},no=function(A,O,Z,ie,pe){this.overscaledZ=A,this.wrap=O,this.canonical=new dl(Z,+ie,+pe),this.key=tc(O,A,Z,ie,pe)};function tc(A,O,Z,ie,pe){(A*=2)<0&&(A=-1*A-1);var xe=1<<Z;return(xe*xe*A+xe*pe+ie).toString(36)+Z.toString(36)+O.toString(36)}no.prototype.equals=function(A){return this.overscaledZ===A.overscaledZ&&this.wrap===A.wrap&&this.canonical.equals(A.canonical)},no.prototype.scaledTo=function(A){var O=this.canonical.z-A;return A>this.canonical.z?new no(A,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new no(A,this.wrap,A,this.canonical.x>>O,this.canonical.y>>O)},no.prototype.calculateScaledKey=function(A,O){var Z=this.canonical.z-A;return A>this.canonical.z?tc(this.wrap*+O,A,this.canonical.z,this.canonical.x,this.canonical.y):tc(this.wrap*+O,A,A,this.canonical.x>>Z,this.canonical.y>>Z)},no.prototype.isChildOf=function(A){if(A.wrap!==this.wrap)return!1;var O=this.canonical.z-A.canonical.z;return 0===A.overscaledZ||A.overscaledZ<this.overscaledZ&&A.canonical.x===this.canonical.x>>O&&A.canonical.y===this.canonical.y>>O},no.prototype.children=function(A){if(this.overscaledZ>=A)return[new no(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];var O=this.canonical.z+1,Z=2*this.canonical.x,ie=2*this.canonical.y;return[new no(O,this.wrap,O,Z,ie),new no(O,this.wrap,O,Z+1,ie),new no(O,this.wrap,O,Z,ie+1),new no(O,this.wrap,O,Z+1,ie+1)]},no.prototype.isLessThan=function(A){return this.wrap<A.wrap||!(this.wrap>A.wrap)&&(this.overscaledZ<A.overscaledZ||!(this.overscaledZ>A.overscaledZ)&&(this.canonical.x<A.canonical.x||!(this.canonical.x>A.canonical.x)&&this.canonical.y<A.canonical.y))},no.prototype.wrapped=function(){return new no(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)},no.prototype.unwrapTo=function(A){return new no(this.overscaledZ,A,this.canonical.z,this.canonical.x,this.canonical.y)},no.prototype.overscaleFactor=function(){return Math.pow(2,this.overscaledZ-this.canonical.z)},no.prototype.toUnwrapped=function(){return new Df(this.wrap,this.canonical)},no.prototype.toString=function(){return this.overscaledZ+"/"+this.canonical.x+"/"+this.canonical.y},no.prototype.getTilePoint=function(A){return this.canonical.getTilePoint(new pl(A.x-this.wrap,A.y))},Wr("CanonicalTileID",dl),Wr("OverscaledTileID",no,{omit:["posMatrix"]});var qs=function(A,O,Z){if(this.uid=A,O.height!==O.width)throw new RangeError("DEM tiles must be square");if(Z&&"mapbox"!==Z&&"terrarium"!==Z)return M('"'+Z+'" is not a valid encoding type. Valid types include "mapbox" and "terrarium".');this.stride=O.height;var ie=this.dim=O.height-2;this.data=new Uint32Array(O.data.buffer),this.encoding=Z||"mapbox";for(var pe=0;pe<ie;pe++)this.data[this._idx(-1,pe)]=this.data[this._idx(0,pe)],this.data[this._idx(ie,pe)]=this.data[this._idx(ie-1,pe)],this.data[this._idx(pe,-1)]=this.data[this._idx(pe,0)],this.data[this._idx(pe,ie)]=this.data[this._idx(pe,ie-1)];this.data[this._idx(-1,-1)]=this.data[this._idx(0,0)],this.data[this._idx(ie,-1)]=this.data[this._idx(ie-1,0)],this.data[this._idx(-1,ie)]=this.data[this._idx(0,ie-1)],this.data[this._idx(ie,ie)]=this.data[this._idx(ie-1,ie-1)]};qs.prototype.get=function(A,O){var Z=new Uint8Array(this.data.buffer),ie=4*this._idx(A,O);return("terrarium"===this.encoding?this._unpackTerrarium:this._unpackMapbox)(Z[ie],Z[ie+1],Z[ie+2])},qs.prototype.getUnpackVector=function(){return"terrarium"===this.encoding?[256,1,1/256,32768]:[6553.6,25.6,.1,1e4]},qs.prototype._idx=function(A,O){if(A<-1||A>=this.dim+1||O<-1||O>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(O+1)*this.stride+(A+1)},qs.prototype._unpackMapbox=function(A,O,Z){return(256*A*256+256*O+Z)/10-1e4},qs.prototype._unpackTerrarium=function(A,O,Z){return 256*A+O+Z/256-32768},qs.prototype.getPixels=function(){return new Zo({width:this.stride,height:this.stride},new Uint8Array(this.data.buffer))},qs.prototype.backfillBorder=function(A,O,Z){if(this.dim!==A.dim)throw new Error("dem dimension mismatch");var ie=O*this.dim,pe=O*this.dim+this.dim,xe=Z*this.dim,Ce=Z*this.dim+this.dim;switch(O){case-1:ie=pe-1;break;case 1:pe=ie+1}switch(Z){case-1:xe=Ce-1;break;case 1:Ce=xe+1}for(var je=-O*this.dim,$e=-Z*this.dim,ut=xe;ut<Ce;ut++)for(var vt=ie;vt<pe;vt++)this.data[this._idx(vt,ut)]=A.data[this._idx(vt+je,ut+$e)]},Wr("DEMData",qs);var Sc=function(A){this._stringToNumber={},this._numberToString=[];for(var O=0;O<A.length;O++){var Z=A[O];this._stringToNumber[Z]=O,this._numberToString[O]=Z}};Sc.prototype.encode=function(A){return this._stringToNumber[A]},Sc.prototype.decode=function(A){return this._numberToString[A]};var Ec=function(A,O,Z,ie,pe){this.type="Feature",this._vectorTileFeature=A,A._z=O,A._x=Z,A._y=ie,this.properties=A.properties,this.id=pe},xu={geometry:{configurable:!0}};xu.geometry.get=function(){return void 0===this._geometry&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._vectorTileFeature._x,this._vectorTileFeature._y,this._vectorTileFeature._z).geometry),this._geometry},xu.geometry.set=function(A){this._geometry=A},Ec.prototype.toJSON=function(){var A={geometry:this.geometry};for(var O in this)"_geometry"!==O&&"_vectorTileFeature"!==O&&(A[O]=this[O]);return A},Object.defineProperties(Ec.prototype,xu);var Pl=function(){this.state={},this.stateChanges={},this.deletedStates={}};Pl.prototype.updateState=function(A,O,Z){var ie=String(O);if(this.stateChanges[A]=this.stateChanges[A]||{},this.stateChanges[A][ie]=this.stateChanges[A][ie]||{},c(this.stateChanges[A][ie],Z),null===this.deletedStates[A])for(var pe in this.deletedStates[A]={},this.state[A])pe!==ie&&(this.deletedStates[A][pe]=null);else if(this.deletedStates[A]&&null===this.deletedStates[A][ie])for(var xe in this.deletedStates[A][ie]={},this.state[A][ie])Z[xe]||(this.deletedStates[A][ie][xe]=null);else for(var Ce in Z)this.deletedStates[A]&&this.deletedStates[A][ie]&&null===this.deletedStates[A][ie][Ce]&&delete this.deletedStates[A][ie][Ce]},Pl.prototype.removeFeatureState=function(A,O,Z){if(null!==this.deletedStates[A]){var ie=String(O);if(this.deletedStates[A]=this.deletedStates[A]||{},Z&&void 0!==O)null!==this.deletedStates[A][ie]&&(this.deletedStates[A][ie]=this.deletedStates[A][ie]||{},this.deletedStates[A][ie][Z]=null);else if(void 0!==O)if(this.stateChanges[A]&&this.stateChanges[A][ie])for(Z in this.deletedStates[A][ie]={},this.stateChanges[A][ie])this.deletedStates[A][ie][Z]=null;else this.deletedStates[A][ie]=null;else this.deletedStates[A]=null}},Pl.prototype.getState=function(A,O){var Z=String(O),xe=c({},(this.state[A]||{})[Z],(this.stateChanges[A]||{})[Z]);if(null===this.deletedStates[A])return{};if(this.deletedStates[A]){var Ce=this.deletedStates[A][O];if(null===Ce)return{};for(var je in Ce)delete xe[je]}return xe},Pl.prototype.initializeTileState=function(A,O){A.setFeatureState(this.state,O)},Pl.prototype.coalesceChanges=function(A,O){var Z={};for(var ie in this.stateChanges){this.state[ie]=this.state[ie]||{};var pe={};for(var xe in this.stateChanges[ie])this.state[ie][xe]||(this.state[ie][xe]={}),c(this.state[ie][xe],this.stateChanges[ie][xe]),pe[xe]=this.state[ie][xe];Z[ie]=pe}for(var Ce in this.deletedStates){this.state[Ce]=this.state[Ce]||{};var je={};if(null===this.deletedStates[Ce])for(var $e in this.state[Ce])je[$e]={},this.state[Ce][$e]={};else for(var ut in this.deletedStates[Ce]){if(null===this.deletedStates[Ce][ut])this.state[Ce][ut]={};else for(var vt=0,zt=Object.keys(this.deletedStates[Ce][ut]);vt<zt.length;vt+=1)delete this.state[Ce][ut][zt[vt]];je[ut]=this.state[Ce][ut]}Z[Ce]=Z[Ce]||{},c(Z[Ce],je)}if(this.stateChanges={},this.deletedStates={},0!==Object.keys(Z).length)for(var qt in A)A[qt].setFeatureState(Z,O)};var Hs=function(A,O){this.tileID=A,this.x=A.canonical.x,this.y=A.canonical.y,this.z=A.canonical.z,this.grid=new sn(8192,16,0),this.grid3D=new sn(8192,16,0),this.featureIndexArray=new Mt,this.promoteId=O};function zf(A,O,Z,ie,pe){return _(A,function(xe,Ce){var je=O instanceof Ko?O.get(Ce):null;return je&&je.evaluate?je.evaluate(Z,ie,pe):je})}function Rf(A){for(var O=1/0,Z=1/0,ie=-1/0,pe=-1/0,xe=0,Ce=A;xe<Ce.length;xe+=1){var je=Ce[xe];O=Math.min(O,je.x),Z=Math.min(Z,je.y),ie=Math.max(ie,je.x),pe=Math.max(pe,je.y)}return{minX:O,minY:Z,maxX:ie,maxY:pe}}function Ap(A,O){return O-A}Hs.prototype.insert=function(A,O,Z,ie,pe,xe){var Ce=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(Z,ie,pe);for(var je=xe?this.grid3D:this.grid,$e=0;$e<O.length;$e++){for(var ut=O[$e],vt=[1/0,1/0,-1/0,-1/0],zt=0;zt<ut.length;zt++){var Yt=ut[zt];vt[0]=Math.min(vt[0],Yt.x),vt[1]=Math.min(vt[1],Yt.y),vt[2]=Math.max(vt[2],Yt.x),vt[3]=Math.max(vt[3],Yt.y)}vt[0]<8192&&vt[1]<8192&&vt[2]>=0&&vt[3]>=0&&je.insert(Ce,vt[0],vt[1],vt[2],vt[3])}},Hs.prototype.loadVTLayers=function(){return this.vtLayers||(this.vtLayers=new _l.VectorTile(new mc(this.rawTileData)).layers,this.sourceLayerCoder=new Sc(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"])),this.vtLayers},Hs.prototype.query=function(A,O,Z,ie){var pe=this;this.loadVTLayers();for(var xe=A.params||{},Ce=8192/A.tileSize/A.scale,je=Ai(xe.filter),$e=A.queryGeometry,ut=A.queryPadding*Ce,vt=Rf($e),zt=this.grid.query(vt.minX-ut,vt.minY-ut,vt.maxX+ut,vt.maxY+ut),Yt=Rf(A.cameraQueryGeometry),ar=0,yr=this.grid3D.query(Yt.minX-ut,Yt.minY-ut,Yt.maxX+ut,Yt.maxY+ut,function(ln,yn,Bn,Rn){return function(Gn,ai,oi,Kn,pi){for(var fi=0,si=Gn;fi<si.length;fi+=1){var Ki=si[fi];if(ai<=Ki.x&&oi<=Ki.y&&Kn>=Ki.x&&pi>=Ki.y)return!0}var Vi=[new r(ai,oi),new r(ai,pi),new r(Kn,pi),new r(Kn,oi)];if(Gn.length>2)for(var ea=0,_i=Vi;ea<_i.length;ea+=1)if($o(Gn,_i[ea]))return!0;for(var Hi=0;Hi<Gn.length-1;Hi++)if(cl(Gn[Hi],Gn[Hi+1],Vi))return!0;return!1}(A.cameraQueryGeometry,ln-ut,yn-ut,Bn+ut,Rn+ut)});ar<yr.length;ar+=1)zt.push(yr[ar]);zt.sort(Ap);for(var Lr,jr={},Ur=function(ln){var yn=zt[ln];if(yn!==Lr){Lr=yn;var Bn=pe.featureIndexArray.get(yn),Rn=null;pe.loadMatchingFeature(jr,Bn.bucketIndex,Bn.sourceLayerIndex,Bn.featureIndex,je,xe.layers,xe.availableImages,O,Z,ie,function(Gn,ai,oi){return Rn||(Rn=ga(Gn)),ai.queryIntersectsFeature($e,Gn,oi,Rn,pe.z,A.transform,Ce,A.pixelPosMatrix)})}},Zr=0;Zr<zt.length;Zr++)Ur(Zr);return jr},Hs.prototype.loadMatchingFeature=function(A,O,Z,ie,pe,xe,Ce,je,$e,ut,vt){var zt=this.bucketLayerIDs[O];if(!xe||function(Bn,Rn){for(var Gn=0;Gn<Bn.length;Gn++)if(Rn.indexOf(Bn[Gn])>=0)return!0;return!1}(xe,zt)){var Yt=this.sourceLayerCoder.decode(Z),qt=this.vtLayers[Yt].feature(ie);if(pe.filter(new ra(this.tileID.overscaledZ),qt))for(var ar=this.getId(qt,Yt),yr=0;yr<zt.length;yr++){var Cr=zt[yr];if(!(xe&&xe.indexOf(Cr)<0)){var Lr=je[Cr];if(Lr){var jr={};void 0!==ar&&ut&&(jr=ut.getState(Lr.sourceLayer||"_geojsonTileLayer",ar));var Ur=$e[Cr];Ur.paint=zf(Ur.paint,Lr.paint,qt,jr,Ce),Ur.layout=zf(Ur.layout,Lr.layout,qt,jr,Ce);var Zr=!vt||vt(qt,Lr,jr);if(Zr){var ln=new Ec(qt,this.z,this.x,this.y,ar);ln.layer=Ur;var yn=A[Cr];void 0===yn&&(yn=A[Cr]=[]),yn.push({featureIndex:ie,feature:ln,intersectionZ:Zr})}}}}}},Hs.prototype.lookupSymbolFeatures=function(A,O,Z,ie,pe,xe,Ce,je){var $e={};this.loadVTLayers();for(var ut=Ai(pe),vt=0,zt=A;vt<zt.length;vt+=1)this.loadMatchingFeature($e,Z,ie,zt[vt],ut,xe,Ce,je,O);return $e},Hs.prototype.hasLayer=function(A){for(var O=0,Z=this.bucketLayerIDs;O<Z.length;O+=1)for(var ie=0,pe=Z[O];ie<pe.length;ie+=1)if(A===pe[ie])return!0;return!1},Hs.prototype.getId=function(A,O){var Z=A.id;return this.promoteId&&"boolean"==typeof(Z=A.properties["string"==typeof this.promoteId?this.promoteId:this.promoteId[O]])&&(Z=Number(Z)),Z},Wr("FeatureIndex",Hs,{omit:["rawTileData","sourceLayerCoder"]});var xo=function(A,O){this.tileID=A,this.uid=p(),this.uses=0,this.tileSize=O,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.expiredRequestCount=0,this.state="loading"};xo.prototype.registerFadeDuration=function(A){var O=A+this.timeAdded;O<N.now()||this.fadeEndTime&&O<this.fadeEndTime||(this.fadeEndTime=O)},xo.prototype.wasRequested=function(){return"errored"===this.state||"loaded"===this.state||"reloading"===this.state},xo.prototype.loadVectorData=function(A,O,Z){if(this.hasData()&&this.unloadVectorData(),this.state="loaded",A){for(var ie in A.featureIndex&&(this.latestFeatureIndex=A.featureIndex,A.rawTileData?(this.latestRawTileData=A.rawTileData,this.latestFeatureIndex.rawTileData=A.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=A.collisionBoxArray,this.buckets=function(ut,vt){var zt={};if(!vt)return zt;for(var Yt=function(){var yr=ar[qt],Cr=yr.layerIds.map(function(Zr){return vt.getLayer(Zr)}).filter(Boolean);if(0!==Cr.length){yr.layers=Cr,yr.stateDependentLayerIds&&(yr.stateDependentLayers=yr.stateDependentLayerIds.map(function(Zr){return Cr.filter(function(ln){return ln.id===Zr})[0]}));for(var Lr=0,jr=Cr;Lr<jr.length;Lr+=1)zt[jr[Lr].id]=yr}},qt=0,ar=ut;qt<ar.length;qt+=1)Yt();return zt}(A.buckets,O.style),this.hasSymbolBuckets=!1,this.buckets){var pe=this.buckets[ie];if(pe instanceof sa){if(this.hasSymbolBuckets=!0,!Z)break;pe.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(var xe in this.buckets){var Ce=this.buckets[xe];if(Ce instanceof sa&&Ce.hasRTLText){this.hasRTLText=!0,co.isLoading()||co.isLoaded()||"deferred"!==Va()||ta();break}}for(var je in this.queryPadding=0,this.buckets){var $e=this.buckets[je];this.queryPadding=Math.max(this.queryPadding,O.style.getLayer(je).queryRadius($e))}A.imageAtlas&&(this.imageAtlas=A.imageAtlas),A.glyphAtlasImage&&(this.glyphAtlasImage=A.glyphAtlasImage)}else this.collisionBoxArray=new be},xo.prototype.unloadVectorData=function(){for(var A in this.buckets)this.buckets[A].destroy();this.buckets={},this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.imageAtlas&&(this.imageAtlas=null),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.latestFeatureIndex=null,this.state="unloaded"},xo.prototype.getBucket=function(A){return this.buckets[A.id]},xo.prototype.upload=function(A){for(var O in this.buckets){var Z=this.buckets[O];Z.uploadPending()&&Z.upload(A)}var ie=A.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new hl(A,this.imageAtlas.image,ie.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new hl(A,this.glyphAtlasImage,ie.ALPHA),this.glyphAtlasImage=null)},xo.prototype.prepare=function(A){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(A,this.imageAtlasTexture)},xo.prototype.queryRenderedFeatures=function(A,O,Z,ie,pe,xe,Ce,je,$e,ut){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({queryGeometry:ie,cameraQueryGeometry:pe,scale:xe,tileSize:this.tileSize,pixelPosMatrix:ut,transform:je,params:Ce,queryPadding:this.queryPadding*$e},A,O,Z):{}},xo.prototype.querySourceFeatures=function(A,O){var Z=this.latestFeatureIndex;if(Z&&Z.rawTileData){var ie=Z.loadVTLayers(),pe=O?O.sourceLayer:"",xe=ie._geojsonTileLayer||ie[pe];if(xe)for(var Ce=Ai(O&&O.filter),je=this.tileID.canonical,$e=je.z,ut=je.x,vt=je.y,zt={z:$e,x:ut,y:vt},Yt=0;Yt<xe.length;Yt++){var qt=xe.feature(Yt);if(Ce.filter(new ra(this.tileID.overscaledZ),qt)){var ar=Z.getId(qt,pe),yr=new Ec(qt,$e,ut,vt,ar);yr.tile=zt,A.push(yr)}}}},xo.prototype.hasData=function(){return"loaded"===this.state||"reloading"===this.state||"expired"===this.state},xo.prototype.patternsLoaded=function(){return this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length},xo.prototype.setExpiryData=function(A){var O=this.expirationTime;if(A.cacheControl){var Z=E(A.cacheControl);Z["max-age"]&&(this.expirationTime=Date.now()+1e3*Z["max-age"])}else A.expires&&(this.expirationTime=new Date(A.expires).getTime());if(this.expirationTime){var ie=Date.now(),pe=!1;if(this.expirationTime>ie)pe=!1;else if(O)if(this.expirationTime<O)pe=!0;else{var xe=this.expirationTime-O;xe?this.expirationTime=ie+Math.max(xe,3e4):pe=!0}else pe=!0;pe?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}},xo.prototype.getExpiryTimeout=function(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-(new Date).getTime(),Math.pow(2,31)-1)},xo.prototype.setFeatureState=function(A,O){if(this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData&&0!==Object.keys(A).length){var Z=this.latestFeatureIndex.loadVTLayers();for(var ie in this.buckets)if(O.style.hasLayer(ie)){var pe=this.buckets[ie],xe=pe.layers[0].sourceLayer||"_geojsonTileLayer",Ce=Z[xe],je=A[xe];if(Ce&&je&&0!==Object.keys(je).length){pe.update(je,Ce,this.imageAtlas&&this.imageAtlas.patternPositions||{});var $e=O&&O.style&&O.style.getLayer(ie);$e&&(this.queryPadding=Math.max(this.queryPadding,$e.queryRadius(pe)))}}}},xo.prototype.holdingForFade=function(){return void 0!==this.symbolFadeHoldUntil},xo.prototype.symbolFadeFinished=function(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<N.now()},xo.prototype.clearFadeHold=function(){this.symbolFadeHoldUntil=void 0},xo.prototype.setHoldDuration=function(A){this.symbolFadeHoldUntil=N.now()+A},xo.prototype.setDependencies=function(A,O){for(var Z={},ie=0,pe=O;ie<pe.length;ie+=1)Z[pe[ie]]=!0;this.dependencies[A]=Z},xo.prototype.hasDependency=function(A,O){for(var Z=0,ie=A;Z<ie.length;Z+=1){var xe=this.dependencies[ie[Z]];if(xe)for(var Ce=0,je=O;Ce<je.length;Ce+=1)if(xe[je[Ce]])return!0}return!1};var el=self.performance,Ff=function(A){this._marks={start:[A.url,"start"].join("#"),end:[A.url,"end"].join("#"),measure:A.url.toString()},el.mark(this._marks.start)};Ff.prototype.finish=function(){el.mark(this._marks.end);var A=el.getEntriesByName(this._marks.measure);return 0===A.length&&(el.measure(this._marks.measure,this._marks.start,this._marks.end),A=el.getEntriesByName(this._marks.measure),el.clearMarks(this._marks.start),el.clearMarks(this._marks.end),el.clearMeasures(this._marks.measure)),A},e.Actor=Cl,e.AlphaImage=fl,e.CanonicalTileID=dl,e.CollisionBoxArray=be,e.Color=Jt,e.DEMData=qs,e.DataConstantProperty=ci,e.DictionaryCoder=Sc,e.EXTENT=8192,e.ErrorEvent=We,e.EvaluationParameters=ra,e.Event=Ve,e.Evented=he,e.FeatureIndex=Hs,e.FillBucket=As,e.FillExtrusionBucket=Ms,e.ImageAtlas=$l,e.ImagePosition=yc,e.LineBucket=Yo,e.LngLat=Aa,e.LngLatBounds=ro,e.MercatorCoordinate=pl,e.ONE_EM=24,e.OverscaledTileID=no,e.Point=r,e.Point$1=r,e.Properties=Eo,e.Protobuf=mc,e.RGBAImage=Zo,e.RequestManager=ne,e.RequestPerformance=Ff,e.ResourceType=ct,e.SegmentVector=Dt,e.SourceFeatureState=Pl,e.StructArrayLayout1ui2=H,e.StructArrayLayout2f1f2i16=Xs,e.StructArrayLayout2i4=ns,e.StructArrayLayout3ui6=eo,e.StructArrayLayout4i8=La,e.SymbolBucket=sa,e.Texture=hl,e.Tile=xo,e.Transitionable=Jo,e.Uniform1f=Gr,e.Uniform1i=ui,e.Uniform2f=Tn,e.Uniform3f=Xn,e.Uniform4f=Hn,e.UniformColor=ni,e.UniformMatrix4f=Si,e.UnwrappedTileID=Df,e.ValidationError=Be,e.WritingMode=as,e.ZoomHistory=Li,e.add=function(A,O,Z){return A[0]=O[0]+Z[0],A[1]=O[1]+Z[1],A[2]=O[2]+Z[2],A},e.addDynamicAttributes=gu,e.asyncAll=function(A,O,Z){if(!A.length)return Z(null,[]);var ie=A.length,pe=new Array(A.length),xe=null;A.forEach(function(Ce,je){O(Ce,function($e,ut){$e&&(xe=$e),pe[je]=ut,0==--ie&&Z(xe,pe)})})},e.bezier=s,e.bindAll=l,e.browser=N,e.cacheEntryPossiblyAdded=function(A){++Xe>ze&&(A.getActor().send("enforceCacheSizeLimit",De),Xe=0)},e.clamp=u,e.clearTileCache=function(A){var O=self.caches.delete("mapbox-tiles");A&&O.catch(A).then(function(){return A()})},e.clipLine=yf,e.clone=function(A){var O=new Go(16);return O[0]=A[0],O[1]=A[1],O[2]=A[2],O[3]=A[3],O[4]=A[4],O[5]=A[5],O[6]=A[6],O[7]=A[7],O[8]=A[8],O[9]=A[9],O[10]=A[10],O[11]=A[11],O[12]=A[12],O[13]=A[13],O[14]=A[14],O[15]=A[15],O},e.clone$1=k,e.clone$2=function(A){var O=new Go(3);return O[0]=A[0],O[1]=A[1],O[2]=A[2],O},e.collisionCircleLayout=Gh,e.config=U,e.create=function(){var A=new Go(16);return Go!=Float32Array&&(A[1]=0,A[2]=0,A[3]=0,A[4]=0,A[6]=0,A[7]=0,A[8]=0,A[9]=0,A[11]=0,A[12]=0,A[13]=0,A[14]=0),A[0]=1,A[5]=1,A[10]=1,A[15]=1,A},e.create$1=function(){var A=new Go(9);return Go!=Float32Array&&(A[1]=0,A[2]=0,A[3]=0,A[5]=0,A[6]=0,A[7]=0),A[0]=1,A[4]=1,A[8]=1,A},e.create$2=function(){var A=new Go(4);return Go!=Float32Array&&(A[1]=0,A[2]=0),A[0]=1,A[3]=1,A},e.createCommonjsModule=n,e.createExpression=Zt,e.createLayout=na,e.createStyleLayer=function(A){return"custom"===A.type?new Tp(A):new kp[A.type](A)},e.cross=function(A,O,Z){var ie=O[0],pe=O[1],xe=O[2],Ce=Z[0],je=Z[1],$e=Z[2];return A[0]=pe*$e-xe*je,A[1]=xe*Ce-ie*$e,A[2]=ie*je-pe*Ce,A},e.deepEqual=function A(O,Z){if(Array.isArray(O)){if(!Array.isArray(Z)||O.length!==Z.length)return!1;for(var ie=0;ie<O.length;ie++)if(!A(O[ie],Z[ie]))return!1;return!0}if("object"==typeof O&&null!==O&&null!==Z){if("object"!=typeof Z||Object.keys(O).length!==Object.keys(Z).length)return!1;for(var pe in O)if(!A(O[pe],Z[pe]))return!1;return!0}return O===Z},e.dot=function(A,O){return A[0]*O[0]+A[1]*O[1]+A[2]*O[2]},e.dot$1=function(A,O){return A[0]*O[0]+A[1]*O[1]+A[2]*O[2]+A[3]*O[3]},e.ease=i,e.emitValidationErrors=_n,e.endsWith=T,e.enforceCacheSizeLimit=function(A){Me(),Oe&&Oe.then(function(O){O.keys().then(function(Z){for(var ie=0;ie<Z.length-A;ie++)O.delete(Z[ie])})})},e.evaluateSizeForFeature=hf,e.evaluateSizeForZoom=pf,e.evaluateVariableOffset=_f,e.evented=wa,e.extend=c,e.featureFilter=Ai,e.filterObject=w,e.fromRotation=function(A,O){var Z=Math.sin(O),ie=Math.cos(O);return A[0]=ie,A[1]=Z,A[2]=0,A[3]=-Z,A[4]=ie,A[5]=0,A[6]=0,A[7]=0,A[8]=1,A},e.getAnchorAlignment=fu,e.getAnchorJustification=du,e.getArrayBuffer=mt,e.getImage=Wt,e.getJSON=function(A,O){return Ke(c(A,{type:"json"}),O)},e.getRTLTextPluginStatus=Va,e.getReferrer=dt,e.getVideo=function(A,O){var Z,ie,pe=self.document.createElement("video");pe.muted=!0,pe.onloadstart=function(){O(null,pe)};for(var xe=0;xe<A.length;xe++){var Ce=self.document.createElement("source");Z=A[xe],ie=void 0,(ie=self.document.createElement("a")).href=Z,(ie.protocol!==self.document.location.protocol||ie.host!==self.document.location.host)&&(pe.crossOrigin="Anonymous"),Ce.src=A[xe],pe.appendChild(Ce)}return{cancel:function(){}}},e.identity=Hl,e.invert=function(A,O){var Z=O[0],ie=O[1],pe=O[2],xe=O[3],Ce=O[4],je=O[5],$e=O[6],ut=O[7],vt=O[8],zt=O[9],Yt=O[10],qt=O[11],ar=O[12],yr=O[13],Cr=O[14],Lr=O[15],jr=Z*je-ie*Ce,Ur=Z*$e-pe*Ce,Zr=Z*ut-xe*Ce,ln=ie*$e-pe*je,yn=ie*ut-xe*je,Bn=pe*ut-xe*$e,Rn=vt*yr-zt*ar,Gn=vt*Cr-Yt*ar,ai=vt*Lr-qt*ar,oi=zt*Cr-Yt*yr,Kn=zt*Lr-qt*yr,pi=Yt*Lr-qt*Cr,fi=jr*pi-Ur*Kn+Zr*oi+ln*ai-yn*Gn+Bn*Rn;return fi?(A[0]=(je*pi-$e*Kn+ut*oi)*(fi=1/fi),A[1]=(pe*Kn-ie*pi-xe*oi)*fi,A[2]=(yr*Bn-Cr*yn+Lr*ln)*fi,A[3]=(Yt*yn-zt*Bn-qt*ln)*fi,A[4]=($e*ai-Ce*pi-ut*Gn)*fi,A[5]=(Z*pi-pe*ai+xe*Gn)*fi,A[6]=(Cr*Zr-ar*Bn-Lr*Ur)*fi,A[7]=(vt*Bn-Yt*Zr+qt*Ur)*fi,A[8]=(Ce*Kn-je*ai+ut*Rn)*fi,A[9]=(ie*ai-Z*Kn-xe*Rn)*fi,A[10]=(ar*yn-yr*Zr+Lr*jr)*fi,A[11]=(zt*Zr-vt*yn-qt*jr)*fi,A[12]=(je*Gn-Ce*oi-$e*Rn)*fi,A[13]=(Z*oi-ie*Gn+pe*Rn)*fi,A[14]=(yr*Ur-ar*ln-Cr*jr)*fi,A[15]=(vt*ln-zt*Ur+Yt*jr)*fi,A):null},e.isChar=Mn,e.isMapboxURL=le,e.keysDifference=function(A,O){var Z=[];for(var ie in A)ie in O||Z.push(ie);return Z},e.makeRequest=Ke,e.mapObject=_,e.mercatorXfromLng=Pf,e.mercatorYfromLat=If,e.mercatorZfromAltitude=Of,e.mul=Jc,e.multiply=ul,e.mvt=_l,e.normalize=function(A,O){var Z=O[0],ie=O[1],pe=O[2],xe=Z*Z+ie*ie+pe*pe;return xe>0&&(xe=1/Math.sqrt(xe)),A[0]=O[0]*xe,A[1]=O[1]*xe,A[2]=O[2]*xe,A},e.number=bn,e.offscreenCanvasSupported=nt,e.ortho=function(A,O,Z,ie,pe,xe,Ce){var je=1/(O-Z),$e=1/(ie-pe),ut=1/(xe-Ce);return A[0]=-2*je,A[1]=0,A[2]=0,A[3]=0,A[4]=0,A[5]=-2*$e,A[6]=0,A[7]=0,A[8]=0,A[9]=0,A[10]=2*ut,A[11]=0,A[12]=(O+Z)*je,A[13]=(pe+ie)*$e,A[14]=(Ce+xe)*ut,A[15]=1,A},e.parseGlyphPBF=function(A){return new mc(A).readFields(rp,[])},e.pbf=mc,e.performSymbolLayout=function(A,O,Z,ie,pe,xe,Ce){A.createArrays(),A.tilePixelRatio=8192/(512*A.overscaling),A.compareText={},A.iconsNeedLinear=!1;var $e=A.layers[0].layout,ut=A.layers[0]._unevaluatedLayout._values,vt={};if("composite"===A.textSizeData.kind){var zt=A.textSizeData,qt=zt.maxZoom;vt.compositeTextSizes=[ut["text-size"].possiblyEvaluate(new ra(zt.minZoom),Ce),ut["text-size"].possiblyEvaluate(new ra(qt),Ce)]}if("composite"===A.iconSizeData.kind){var ar=A.iconSizeData,Cr=ar.maxZoom;vt.compositeIconSizes=[ut["icon-size"].possiblyEvaluate(new ra(ar.minZoom),Ce),ut["icon-size"].possiblyEvaluate(new ra(Cr),Ce)]}vt.layoutTextSize=ut["text-size"].possiblyEvaluate(new ra(A.zoom+1),Ce),vt.layoutIconSize=ut["icon-size"].possiblyEvaluate(new ra(A.zoom+1),Ce),vt.textMaxSize=ut["text-size"].possiblyEvaluate(new ra(18));for(var Lr=24*$e.get("text-line-height"),jr="map"===$e.get("text-rotation-alignment")&&"point"!==$e.get("symbol-placement"),Ur=$e.get("text-keep-upright"),Zr=$e.get("text-size"),ln=function(){var Rn=Bn[yn],Gn=$e.get("text-font").evaluate(Rn,{},Ce).join(","),ai=Zr.evaluate(Rn,{},Ce),oi=vt.layoutTextSize.evaluate(Rn,{},Ce),Kn=vt.layoutIconSize.evaluate(Rn,{},Ce),pi={horizontal:{},vertical:void 0},fi=Rn.text,si=[0,0];if(fi){var Ki=fi.toString(),Vi=24*$e.get("text-letter-spacing").evaluate(Rn,{},Ce),ea=function(Ri){for(var Qi=0,Na=Ri;Qi<Na.length;Qi+=1)if(!Ei(Na[Qi].charCodeAt(0)))return!1;return!0}(Ki)?Vi:0,_i=$e.get("text-anchor").evaluate(Rn,{},Ce),Hi=$e.get("text-variable-anchor");if(!Hi){var va=$e.get("text-radial-offset").evaluate(Rn,{},Ce);si=va?_f(_i,[24*va,pu]):$e.get("text-offset").evaluate(Rn,{},Ce).map(function(Ri){return 24*Ri})}var ua=jr?"center":$e.get("text-justify").evaluate(Rn,{},Ce),Ma=$e.get("symbol-placement"),fa="point"===Ma?24*$e.get("text-max-width").evaluate(Rn,{},Ce):0,io=function(){A.allowVerticalPlacement&&Di(Ki)&&(pi.vertical=xc(fi,O,Z,pe,Gn,fa,Lr,_i,"left",ea,si,as.vertical,!0,Ma,oi,ai))};if(!jr&&Hi){for(var Sa="auto"===ua?Hi.map(function(Ri){return du(Ri)}):[ua],Po=!1,bo=0;bo<Sa.length;bo++){var To=Sa[bo];if(!pi.horizontal[To])if(Po)pi.horizontal[To]=pi.horizontal[0];else{var Vo=xc(fi,O,Z,pe,Gn,fa,Lr,"center",To,ea,si,as.horizontal,!1,Ma,oi,ai);Vo&&(pi.horizontal[To]=Vo,Po=1===Vo.positionedLines.length)}}io()}else{"auto"===ua&&(ua=du(_i));var zo=xc(fi,O,Z,pe,Gn,fa,Lr,_i,ua,ea,si,as.horizontal,!1,Ma,oi,ai);zo&&(pi.horizontal[ua]=zo),io(),Di(Ki)&&jr&&Ur&&(pi.vertical=xc(fi,O,Z,pe,Gn,fa,Lr,_i,ua,ea,si,as.vertical,!1,Ma,oi,ai))}}var Ri,Qi,ja,qo,Ro,ao=void 0,ko=!1;if(Rn.icon&&Rn.icon.name){var Za=ie[Rn.icon.name];Za&&(Ri=pe[Rn.icon.name],Qi=$e.get("icon-offset").evaluate(Rn,{},Ce),ja=fu($e.get("icon-anchor").evaluate(Rn,{},Ce)),ao={image:Ri,top:Ro=Qi[1]-Ri.displaySize[1]*ja.verticalAlign,bottom:Ro+Ri.displaySize[1],left:qo=Qi[0]-Ri.displaySize[0]*ja.horizontalAlign,right:qo+Ri.displaySize[0]},ko=Za.sdf,void 0===A.sdfIcons?A.sdfIcons=Za.sdf:A.sdfIcons!==Za.sdf&&M("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(Za.pixelRatio!==A.pixelRatio||0!==$e.get("icon-rotate").constantOr(1))&&(A.iconsNeedLinear=!0))}var uo=Tf(pi.horizontal)||pi.vertical;A.iconsInText=!!uo&&uo.iconsInText,(uo||ao)&&function(Ri,Qi,Na,ja,za,Ea,ia,Ua,qo,ts,Ro){var Ss=Ea.textMaxSize.evaluate(Qi,{});void 0===Ss&&(Ss=ia);var Gs,_o=Ri.layers[0].layout,Es=_o.get("icon-offset").evaluate(Qi,{},Ro),Ls=Tf(Na.horizontal),Cs=ia/24,bu=Ri.tilePixelRatio*Cs,Il=Ri.tilePixelRatio*Ss/24,Lc=Ri.tilePixelRatio*Ua,ml=Ri.tilePixelRatio*_o.get("symbol-spacing"),Cc=_o.get("text-padding")*Ri.tilePixelRatio,Pc=_o.get("icon-padding")*Ri.tilePixelRatio,Ic=_o.get("text-max-angle")/180*Math.PI,Oc="map"===_o.get("text-rotation-alignment")&&"point"!==_o.get("symbol-placement"),tl="map"===_o.get("icon-rotation-alignment")&&"point"!==_o.get("symbol-placement"),Ol=_o.get("symbol-placement"),Dc=ml/2,Dl=_o.get("icon-text-fit");ja&&"none"!==Dl&&(Ri.allowVerticalPlacement&&Na.vertical&&(Gs=ff(ja,Na.vertical,Dl,_o.get("icon-text-fit-padding"),Es,Cs)),Ls&&(ja=ff(ja,Ls,Dl,_o.get("icon-text-fit-padding"),Es,Cs)));var rl=function(Sp,sc){sc.x<0||sc.x>=8192||sc.y<0||sc.y>=8192||function(Ha,Ps,Ep,nl,Au,Uf,Vc,Bs,qc,lc,Hc,Gc,Mu,Vf,cc,qf,Hf,Gf,Zf,Yf,os,Zc,Wf,Ns,Lp){var Su,vl,jl,Ul,Vl,ql=Ha.addToLineVertexArray(Ps,Ep),Xf=0,Jf=0,Kf=0,Qf=0,Eu=-1,Lu=-1,Zs={},$f=Sr(""),Cu=0,Pu=0;if(void 0===Bs._unevaluatedLayout.getValue("text-radial-offset")?(Cu=(Su=Bs.layout.get("text-offset").evaluate(os,{},Ns).map(function(fc){return 24*fc}))[0],Pu=Su[1]):(Cu=24*Bs.layout.get("text-radial-offset").evaluate(os,{},Ns),Pu=pu),Ha.allowVerticalPlacement&&nl.vertical){var eh=Bs.layout.get("text-rotate").evaluate(os,{},Ns)+90;Ul=new kc(qc,Ps,lc,Hc,Gc,nl.vertical,Mu,Vf,cc,eh),Vc&&(Vl=new kc(qc,Ps,lc,Hc,Gc,Vc,Hf,Gf,cc,eh))}if(Au){var Iu=Bs.layout.get("icon-rotate").evaluate(os,{}),th="none"!==Bs.layout.get("icon-text-fit"),rh=xf(Au,Iu,Wf,th),Ou=Vc?xf(Vc,Iu,Wf,th):void 0;jl=new kc(qc,Ps,lc,Hc,Gc,Au,Hf,Gf,!1,Iu),Xf=4*rh.length;var nh=Ha.iconSizeData,uc=null;"source"===nh.kind?(uc=[128*Bs.layout.get("icon-size").evaluate(os,{})])[0]>32640&&M(Ha.layerIds[0]+': Value for "icon-size" is >= 255. Reduce your "icon-size".'):"composite"===nh.kind&&((uc=[128*Zc.compositeIconSizes[0].evaluate(os,{},Ns),128*Zc.compositeIconSizes[1].evaluate(os,{},Ns)])[0]>32640||uc[1]>32640)&&M(Ha.layerIds[0]+': Value for "icon-size" is >= 255. Reduce your "icon-size".'),Ha.addSymbols(Ha.icon,rh,uc,Yf,Zf,os,!1,Ps,ql.lineStartIndex,ql.lineLength,-1,Ns),Eu=Ha.icon.placedSymbolArray.length-1,Ou&&(Jf=4*Ou.length,Ha.addSymbols(Ha.icon,Ou,uc,Yf,Zf,os,as.vertical,Ps,ql.lineStartIndex,ql.lineLength,-1,Ns),Lu=Ha.icon.placedSymbolArray.length-1)}for(var ih in nl.horizontal){var Yc=nl.horizontal[ih];if(!vl){$f=Sr(Yc.text);var Pp=Bs.layout.get("text-rotate").evaluate(os,{},Ns);vl=new kc(qc,Ps,lc,Hc,Gc,Yc,Mu,Vf,cc,Pp)}var ah=1===Yc.positionedLines.length;if(Kf+=wf(Ha,Ps,Yc,Uf,Bs,cc,os,qf,ql,nl.vertical?as.horizontal:as.horizontalOnly,ah?Object.keys(nl.horizontal):[ih],Zs,Eu,Zc,Ns),ah)break}nl.vertical&&(Qf+=wf(Ha,Ps,nl.vertical,Uf,Bs,cc,os,qf,ql,as.vertical,["vertical"],Zs,Lu,Zc,Ns));var Ip=vl?vl.boxStartIndex:Ha.collisionBoxArray.length,Op=vl?vl.boxEndIndex:Ha.collisionBoxArray.length,Dp=Ul?Ul.boxStartIndex:Ha.collisionBoxArray.length,zp=Ul?Ul.boxEndIndex:Ha.collisionBoxArray.length,Rp=jl?jl.boxStartIndex:Ha.collisionBoxArray.length,Fp=jl?jl.boxEndIndex:Ha.collisionBoxArray.length,Bp=Vl?Vl.boxStartIndex:Ha.collisionBoxArray.length,Np=Vl?Vl.boxEndIndex:Ha.collisionBoxArray.length,js=-1,Wc=function(fc,sh){return fc&&fc.circleDiameter?Math.max(fc.circleDiameter,sh):sh};js=Wc(vl,js),js=Wc(Ul,js),js=Wc(jl,js);var oh=(js=Wc(Vl,js))>-1?1:0;oh&&(js*=Lp/24),Ha.glyphOffsetArray.length>=sa.MAX_GLYPHS&&M("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),void 0!==os.sortKey&&Ha.addToSortKeyRanges(Ha.symbolInstances.length,os.sortKey),Ha.symbolInstances.emplaceBack(Ps.x,Ps.y,Zs.right>=0?Zs.right:-1,Zs.center>=0?Zs.center:-1,Zs.left>=0?Zs.left:-1,Zs.vertical||-1,Eu,Lu,$f,Ip,Op,Dp,zp,Rp,Fp,Bp,Np,lc,Kf,Qf,Xf,Jf,oh,0,Mu,Cu,Pu,js)}(Ri,sc,Sp,Na,ja,za,Gs,Ri.layers[0],Ri.collisionBoxArray,Qi.index,Qi.sourceLayerIndex,Ri.index,bu,Cc,Oc,qo,Lc,Pc,tl,Es,Qi,Ea,ts,Ro,ia)};if("line"===Ol)for(var rc=0,zc=yf(Qi.geometry,0,0,8192,8192);rc<zc.length;rc+=1)for(var Rc=zc[rc],nc=0,Bc=cp(Rc,ml,Ic,Na.vertical||Ls,ja,24,Il,Ri.overscaling,8192);nc<Bc.length;nc+=1){var ic=Bc[nc];Ls&&pp(Ri,Ls.text,Dc,ic)||rl(Rc,ic)}else if("line-center"===Ol)for(var ac=0,jc=Qi.geometry;ac<jc.length;ac+=1){var zl=jc[ac];if(zl.length>1){var Rl=lp(zl,Ic,Na.vertical||Ls,ja,24,Il);Rl&&rl(zl,Rl)}}else if("Polygon"===Qi.type)for(var Fl=0,Uc=au(Qi.geometry,0);Fl<Uc.length;Fl+=1){var Bl=Uc[Fl],oc=fp(Bl,16);rl(Bl[0],new Al(oc.x,oc.y,0))}else if("LineString"===Qi.type)for(var Nl=0,Bf=Qi.geometry;Nl<Bf.length;Nl+=1){var _u=Bf[Nl];rl(_u,new Al(_u[0].x,_u[0].y,0))}else if("Point"===Qi.type)for(var wu=0,Nf=Qi.geometry;wu<Nf.length;wu+=1)for(var Tu=0,jf=Nf[wu];Tu<jf.length;Tu+=1){var ku=jf[Tu];rl([ku],new Al(ku.x,ku.y,0))}}(A,Rn,pi,ao,ie,vt,oi,Kn,si,ko,Ce)},yn=0,Bn=A.features;yn<Bn.length;yn+=1)ln();xe&&A.generateCollisionDebugBuffers()},e.perspective=function(A,O,Z,ie,pe){var xe,Ce=1/Math.tan(O/2);return A[0]=Ce/Z,A[1]=0,A[2]=0,A[3]=0,A[4]=0,A[5]=Ce,A[6]=0,A[7]=0,A[8]=0,A[9]=0,A[11]=-1,A[12]=0,A[13]=0,A[15]=0,null!=pe&&pe!==1/0?(A[10]=(pe+ie)*(xe=1/(ie-pe)),A[14]=2*pe*ie*xe):(A[10]=-1,A[14]=-2*ie),A},e.pick=function(A,O){for(var Z={},ie=0;ie<O.length;ie++){var pe=O[ie];pe in A&&(Z[pe]=A[pe])}return Z},e.plugin=co,e.polygonIntersectsPolygon=Oo,e.postMapLoadEvent=Ne,e.postTurnstileEvent=ke,e.potpack=sf,e.refProperties=["type","source","source-layer","minzoom","maxzoom","filter","layout"],e.register=Wr,e.registerForPluginStateChange=function(A){return A({pluginStatus:vi,pluginURL:da}),wa.on("pluginStateChange",A),A},e.rotate=function(A,O,Z){var ie=O[0],pe=O[1],xe=O[2],Ce=O[3],je=Math.sin(Z),$e=Math.cos(Z);return A[0]=ie*$e+xe*je,A[1]=pe*$e+Ce*je,A[2]=ie*-je+xe*$e,A[3]=pe*-je+Ce*$e,A},e.rotateX=function(A,O,Z){var ie=Math.sin(Z),pe=Math.cos(Z),xe=O[4],Ce=O[5],je=O[6],$e=O[7],ut=O[8],vt=O[9],zt=O[10],Yt=O[11];return O!==A&&(A[0]=O[0],A[1]=O[1],A[2]=O[2],A[3]=O[3],A[12]=O[12],A[13]=O[13],A[14]=O[14],A[15]=O[15]),A[4]=xe*pe+ut*ie,A[5]=Ce*pe+vt*ie,A[6]=je*pe+zt*ie,A[7]=$e*pe+Yt*ie,A[8]=ut*pe-xe*ie,A[9]=vt*pe-Ce*ie,A[10]=zt*pe-je*ie,A[11]=Yt*pe-$e*ie,A},e.rotateZ=function(A,O,Z){var ie=Math.sin(Z),pe=Math.cos(Z),xe=O[0],Ce=O[1],je=O[2],$e=O[3],ut=O[4],vt=O[5],zt=O[6],Yt=O[7];return O!==A&&(A[8]=O[8],A[9]=O[9],A[10]=O[10],A[11]=O[11],A[12]=O[12],A[13]=O[13],A[14]=O[14],A[15]=O[15]),A[0]=xe*pe+ut*ie,A[1]=Ce*pe+vt*ie,A[2]=je*pe+zt*ie,A[3]=$e*pe+Yt*ie,A[4]=ut*pe-xe*ie,A[5]=vt*pe-Ce*ie,A[6]=zt*pe-je*ie,A[7]=Yt*pe-$e*ie,A},e.scale=function(A,O,Z){var ie=Z[0],pe=Z[1],xe=Z[2];return A[0]=O[0]*ie,A[1]=O[1]*ie,A[2]=O[2]*ie,A[3]=O[3]*ie,A[4]=O[4]*pe,A[5]=O[5]*pe,A[6]=O[6]*pe,A[7]=O[7]*pe,A[8]=O[8]*xe,A[9]=O[9]*xe,A[10]=O[10]*xe,A[11]=O[11]*xe,A[12]=O[12],A[13]=O[13],A[14]=O[14],A[15]=O[15],A},e.scale$1=function(A,O,Z){return A[0]=O[0]*Z,A[1]=O[1]*Z,A[2]=O[2]*Z,A[3]=O[3]*Z,A},e.scale$2=function(A,O,Z){return A[0]=O[0]*Z,A[1]=O[1]*Z,A[2]=O[2]*Z,A},e.setCacheLimits=function(A,O){De=A,ze=O},e.setRTLTextPlugin=function(A,O,Z){if(void 0===Z&&(Z=!1),vi===Wi||vi===Ba||vi===Ho)throw new Error("setRTLTextPlugin cannot be called multiple times.");da=N.resolveURL(A),vi=Wi,go=O,Xi(),Z||ta()},e.sphericalToCartesian=function(A){var O=A[0],Z=A[1],ie=A[2];return Z+=90,Z*=Math.PI/180,ie*=Math.PI/180,{x:O*Math.cos(Z)*Math.sin(ie),y:O*Math.sin(Z)*Math.sin(ie),z:O*Math.cos(ie)}},e.sqrLen=function(A){var O=A[0],Z=A[1];return O*O+Z*Z},e.styleSpec=ye,e.sub=function(A,O,Z){return A[0]=O[0]-Z[0],A[1]=O[1]-Z[1],A[2]=O[2]-Z[2],A},e.symbolSize=sp,e.transformMat3=function(A,O,Z){var ie=O[0],pe=O[1],xe=O[2];return A[0]=ie*Z[0]+pe*Z[3]+xe*Z[6],A[1]=ie*Z[1]+pe*Z[4]+xe*Z[7],A[2]=ie*Z[2]+pe*Z[5]+xe*Z[8],A},e.transformMat4=Qs,e.translate=function(A,O,Z){var ie,pe,xe,Ce,je,$e,ut,vt,zt,Yt,qt,ar,yr=Z[0],Cr=Z[1],Lr=Z[2];return O===A?(A[12]=O[0]*yr+O[4]*Cr+O[8]*Lr+O[12],A[13]=O[1]*yr+O[5]*Cr+O[9]*Lr+O[13],A[14]=O[2]*yr+O[6]*Cr+O[10]*Lr+O[14],A[15]=O[3]*yr+O[7]*Cr+O[11]*Lr+O[15]):(pe=O[1],xe=O[2],Ce=O[3],je=O[4],$e=O[5],ut=O[6],vt=O[7],zt=O[8],Yt=O[9],qt=O[10],ar=O[11],A[0]=ie=O[0],A[1]=pe,A[2]=xe,A[3]=Ce,A[4]=je,A[5]=$e,A[6]=ut,A[7]=vt,A[8]=zt,A[9]=Yt,A[10]=qt,A[11]=ar,A[12]=ie*yr+je*Cr+zt*Lr+O[12],A[13]=pe*yr+$e*Cr+Yt*Lr+O[13],A[14]=xe*yr+ut*Cr+qt*Lr+O[14],A[15]=Ce*yr+vt*Cr+ar*Lr+O[15]),A},e.triggerPluginCompletionEvent=mo,e.uniqueId=p,e.validateCustomStyleLayer=function(A){var O=[],Z=A.id;return void 0===Z&&O.push({message:"layers."+Z+': missing required property "id"'}),void 0===A.render&&O.push({message:"layers."+Z+': missing required method "render"'}),A.renderingMode&&"2d"!==A.renderingMode&&"3d"!==A.renderingMode&&O.push({message:"layers."+Z+': property "renderingMode" must be either "2d" or "3d"'}),O},e.validateLight=on,e.validateStyle=Yr,e.values=function(A){var O=[];for(var Z in A)O.push(A[Z]);return O},e.vectorTile=_l,e.version="1.10.1",e.warnOnce=M,e.webpSupported=te,e.window=self,e.wrap=f}),x(0,function(e){function n(Ve){var We=typeof Ve;if("number"===We||"boolean"===We||"string"===We||null==Ve)return JSON.stringify(Ve);if(Array.isArray(Ve)){for(var he="[",ye=0,Be=Ve;ye<Be.length;ye+=1)he+=n(Be[ye])+",";return he+"]"}for(var Ge=Object.keys(Ve).sort(),Je="{",He=0;He<Ge.length;He++)Je+=JSON.stringify(Ge[He])+":"+n(Ve[Ge[He]])+",";return Je+"}"}function t(Ve){for(var We="",he=0,ye=e.refProperties;he<ye.length;he+=1)We+="/"+n(Ve[ye[he]]);return We}var a=function(Ve){this.keyCache={},Ve&&this.replace(Ve)};a.prototype.replace=function(Ve){this._layerConfigs={},this._layers={},this.update(Ve,[])},a.prototype.update=function(Ve,We){for(var he=this,ye=0,Be=Ve;ye<Be.length;ye+=1){var Ge=Be[ye];this._layerConfigs[Ge.id]=Ge;var Je=this._layers[Ge.id]=e.createStyleLayer(Ge);Je._featureFilter=e.featureFilter(Je.filter),this.keyCache[Ge.id]&&delete this.keyCache[Ge.id]}for(var He=0,st=We;He<st.length;He+=1){var ot=st[He];delete this.keyCache[ot],delete this._layerConfigs[ot],delete this._layers[ot]}this.familiesBySource={};for(var wt=0,Ct=function(Ye,it){for(var ht={},At=0;At<Ye.length;At++){var Ft=it&&it[Ye[At].id]||t(Ye[At]);it&&(it[Ye[At].id]=Ft);var Gt=ht[Ft];Gt||(Gt=ht[Ft]=[]),Gt.push(Ye[At])}var jt=[];for(var fr in ht)jt.push(ht[fr]);return jt}(e.values(this._layerConfigs),this.keyCache);wt<Ct.length;wt+=1){var rt=Ct[wt].map(function(Ye){return he._layers[Ye.id]}),ft=rt[0];if("none"!==ft.visibility){var Rt=ft.source||"",kt=this.familiesBySource[Rt];kt||(kt=this.familiesBySource[Rt]={});var Lt=ft.sourceLayer||"_geojsonTileLayer",Ee=kt[Lt];Ee||(Ee=kt[Lt]=[]),Ee.push(rt)}}};var r=function(Ve){var We={},he=[];for(var ye in Ve){var Be=Ve[ye],Ge=We[ye]={};for(var Je in Be){var He=Be[+Je];if(He&&0!==He.bitmap.width&&0!==He.bitmap.height){var st={x:0,y:0,w:He.bitmap.width+2,h:He.bitmap.height+2};he.push(st),Ge[Je]={rect:st,metrics:He.metrics}}}}var ot=e.potpack(he),rt=new e.AlphaImage({width:ot.w||1,height:ot.h||1});for(var ft in Ve){var Rt=Ve[ft];for(var kt in Rt){var Lt=Rt[+kt];if(Lt&&0!==Lt.bitmap.width&&0!==Lt.bitmap.height){var Ee=We[ft][kt].rect;e.AlphaImage.copy(Lt.bitmap,rt,{x:0,y:0},{x:Ee.x+1,y:Ee.y+1},Lt.bitmap)}}}this.image=rt,this.positions=We};e.register("GlyphAtlas",r);var d=function(Ve){this.tileID=new e.OverscaledTileID(Ve.tileID.overscaledZ,Ve.tileID.wrap,Ve.tileID.canonical.z,Ve.tileID.canonical.x,Ve.tileID.canonical.y),this.uid=Ve.uid,this.zoom=Ve.zoom,this.pixelRatio=Ve.pixelRatio,this.tileSize=Ve.tileSize,this.source=Ve.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=Ve.showCollisionBoxes,this.collectResourceTiming=!!Ve.collectResourceTiming,this.returnDependencies=!!Ve.returnDependencies,this.promoteId=Ve.promoteId};function s(Ve,We,he){for(var ye=new e.EvaluationParameters(We),Be=0,Ge=Ve;Be<Ge.length;Be+=1)Ge[Be].recalculate(ye,he)}function i(Ve,We){var he=e.getArrayBuffer(Ve.request,function(ye,Be,Ge,Je){ye?We(ye):Be&&We(null,{vectorTile:new e.vectorTile.VectorTile(new e.pbf(Be)),rawData:Be,cacheControl:Ge,expires:Je})});return function(){he.cancel(),We()}}d.prototype.parse=function(Ve,We,he,ye,Be){var Ge=this;this.status="parsing",this.data=Ve,this.collisionBoxArray=new e.CollisionBoxArray;var Je=new e.DictionaryCoder(Object.keys(Ve.layers).sort()),He=new e.FeatureIndex(this.tileID,this.promoteId);He.bucketLayerIDs=[];var st,ot,wt,Ct,rt={},ft={featureIndex:He,iconDependencies:{},patternDependencies:{},glyphDependencies:{},availableImages:he},Rt=We.familiesBySource[this.source];for(var kt in Rt){var Lt=Ve.layers[kt];if(Lt){1===Lt.version&&e.warnOnce('Vector tile source "'+this.source+'" layer "'+kt+'" does not use vector tile spec v2 and therefore may have some rendering errors.');for(var Ee=Je.encode(kt),Ye=[],it=0;it<Lt.length;it++){var ht=Lt.feature(it),At=He.getId(ht,kt);Ye.push({feature:ht,id:At,index:it,sourceLayerIndex:Ee})}for(var Ft=0,Gt=Rt[kt];Ft<Gt.length;Ft+=1){var jt=Gt[Ft],fr=jt[0];fr.minzoom&&this.zoom<Math.floor(fr.minzoom)||fr.maxzoom&&this.zoom>=fr.maxzoom||"none"!==fr.visibility&&(s(jt,this.zoom,he),(rt[fr.id]=fr.createBucket({index:He.bucketLayerIDs.length,layers:jt,zoom:this.zoom,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:Ee,sourceID:this.source})).populate(Ye,ft,this.tileID.canonical),He.bucketLayerIDs.push(jt.map(function(Qt){return Qt.id})))}}}var kr=e.mapObject(ft.glyphDependencies,function(Qt){return Object.keys(Qt).map(Number)});Object.keys(kr).length?ye.send("getGlyphs",{uid:this.uid,stacks:kr},function(Qt,cr){st||(st=Qt,ot=cr,$t.call(Ge))}):ot={};var ur=Object.keys(ft.iconDependencies);ur.length?ye.send("getImages",{icons:ur,source:this.source,tileID:this.tileID,type:"icons"},function(Qt,cr){st||(st=Qt,wt=cr,$t.call(Ge))}):wt={};var Jt=Object.keys(ft.patternDependencies);function $t(){if(st)return Be(st);if(ot&&wt&&Ct){var Qt=new r(ot),cr=new e.ImageAtlas(wt,Ct);for(var gr in rt){var Tr=rt[gr];Tr instanceof e.SymbolBucket?(s(Tr.layers,this.zoom,he),e.performSymbolLayout(Tr,ot,Qt.positions,wt,cr.iconPositions,this.showCollisionBoxes,this.tileID.canonical)):Tr.hasPattern&&(Tr instanceof e.LineBucket||Tr instanceof e.FillBucket||Tr instanceof e.FillExtrusionBucket)&&(s(Tr.layers,this.zoom,he),Tr.addFeatures(ft,this.tileID.canonical,cr.patternPositions))}this.status="done",Be(null,{buckets:e.values(rt).filter(function(Fr){return!Fr.isEmpty()}),featureIndex:He,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:Qt.image,imageAtlas:cr,glyphMap:this.returnDependencies?ot:null,iconMap:this.returnDependencies?wt:null,glyphPositions:this.returnDependencies?Qt.positions:null})}}Jt.length?ye.send("getImages",{icons:Jt,source:this.source,tileID:this.tileID,type:"patterns"},function(Qt,cr){st||(st=Qt,Ct=cr,$t.call(Ge))}):Ct={},$t.call(this)};var u=function(Ve,We,he,ye){this.actor=Ve,this.layerIndex=We,this.availableImages=he,this.loadVectorData=ye||i,this.loading={},this.loaded={}};u.prototype.loadTile=function(Ve,We){var he=this,ye=Ve.uid;this.loading||(this.loading={});var Be=!!(Ve&&Ve.request&&Ve.request.collectResourceTiming)&&new e.RequestPerformance(Ve.request),Ge=this.loading[ye]=new d(Ve);Ge.abort=this.loadVectorData(Ve,function(Je,He){if(delete he.loading[ye],Je||!He)return Ge.status="done",he.loaded[ye]=Ge,We(Je);var st=He.rawData,ot={};He.expires&&(ot.expires=He.expires),He.cacheControl&&(ot.cacheControl=He.cacheControl);var wt={};if(Be){var Ct=Be.finish();Ct&&(wt.resourceTiming=JSON.parse(JSON.stringify(Ct)))}Ge.vectorTile=He.vectorTile,Ge.parse(He.vectorTile,he.layerIndex,he.availableImages,he.actor,function(rt,ft){if(rt||!ft)return We(rt);We(null,e.extend({rawTileData:st.slice(0)},ft,ot,wt))}),he.loaded=he.loaded||{},he.loaded[ye]=Ge})},u.prototype.reloadTile=function(Ve,We){var he=this,ye=this.loaded,Be=Ve.uid,Ge=this;if(ye&&ye[Be]){var Je=ye[Be];Je.showCollisionBoxes=Ve.showCollisionBoxes;var He=function(st,ot){var wt=Je.reloadCallback;wt&&(delete Je.reloadCallback,Je.parse(Je.vectorTile,Ge.layerIndex,he.availableImages,Ge.actor,wt)),We(st,ot)};"parsing"===Je.status?Je.reloadCallback=He:"done"===Je.status&&(Je.vectorTile?Je.parse(Je.vectorTile,this.layerIndex,this.availableImages,this.actor,He):He())}},u.prototype.abortTile=function(Ve,We){var he=this.loading,ye=Ve.uid;he&&he[ye]&&he[ye].abort&&(he[ye].abort(),delete he[ye]),We()},u.prototype.removeTile=function(Ve,We){var he=this.loaded,ye=Ve.uid;he&&he[ye]&&delete he[ye],We()};var f=e.window.ImageBitmap,c=function(){this.loaded={}};c.prototype.loadTile=function(Ve,We){var he=Ve.uid,ye=Ve.encoding,Be=Ve.rawImageData,Ge=f&&Be instanceof f?this.getImageData(Be):Be,Je=new e.DEMData(he,Ge,ye);this.loaded=this.loaded||{},this.loaded[he]=Je,We(null,Je)},c.prototype.getImageData=function(Ve){this.offscreenCanvas&&this.offscreenCanvasContext||(this.offscreenCanvas=new OffscreenCanvas(Ve.width,Ve.height),this.offscreenCanvasContext=this.offscreenCanvas.getContext("2d")),this.offscreenCanvas.width=Ve.width,this.offscreenCanvas.height=Ve.height,this.offscreenCanvasContext.drawImage(Ve,0,0,Ve.width,Ve.height);var We=this.offscreenCanvasContext.getImageData(-1,-1,Ve.width+2,Ve.height+2);return this.offscreenCanvasContext.clearRect(0,0,this.offscreenCanvas.width,this.offscreenCanvas.height),new e.RGBAImage({width:We.width,height:We.height},We.data)},c.prototype.removeTile=function(Ve){var We=this.loaded,he=Ve.uid;We&&We[he]&&delete We[he]};var h=function Ve(We,he){var ye,Be=We&&We.type;if("FeatureCollection"===Be)for(ye=0;ye<We.features.length;ye++)Ve(We.features[ye],he);else if("GeometryCollection"===Be)for(ye=0;ye<We.geometries.length;ye++)Ve(We.geometries[ye],he);else if("Feature"===Be)Ve(We.geometry,he);else if("Polygon"===Be)p(We.coordinates,he);else if("MultiPolygon"===Be)for(ye=0;ye<We.coordinates.length;ye++)p(We.coordinates[ye],he);return We};function p(Ve,We){if(0!==Ve.length){o(Ve[0],We);for(var he=1;he<Ve.length;he++)o(Ve[he],!We)}}function o(Ve,We){for(var he=0,ye=0,Be=Ve.length,Ge=Be-1;ye<Be;Ge=ye++)he+=(Ve[ye][0]-Ve[Ge][0])*(Ve[Ge][1]+Ve[ye][1]);he>=0!=!!We&&Ve.reverse()}var b=e.vectorTile.VectorTileFeature.prototype.toGeoJSON,l=function(Ve){this._feature=Ve,this.extent=e.EXTENT,this.type=Ve.type,this.properties=Ve.tags,"id"in Ve&&!isNaN(Ve.id)&&(this.id=parseInt(Ve.id,10))};l.prototype.loadGeometry=function(){if(1===this._feature.type){for(var Ve=[],We=0,he=this._feature.geometry;We<he.length;We+=1){var ye=he[We];Ve.push([new e.Point$1(ye[0],ye[1])])}return Ve}for(var Be=[],Ge=0,Je=this._feature.geometry;Ge<Je.length;Ge+=1){for(var He=[],st=0,ot=Je[Ge];st<ot.length;st+=1){var wt=ot[st];He.push(new e.Point$1(wt[0],wt[1]))}Be.push(He)}return Be},l.prototype.toGeoJSON=function(Ve,We,he){return b.call(this,Ve,We,he)};var T=function(Ve){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=e.EXTENT,this.length=Ve.length,this._features=Ve};T.prototype.feature=function(Ve){return new l(this._features[Ve])};var _=e.vectorTile.VectorTileFeature,w=k;function k(Ve,We){this.options=We||{},this.features=Ve,this.length=Ve.length}function L(Ve,We){this.id="number"==typeof Ve.id?Ve.id:void 0,this.type=Ve.type,this.rawGeometry=1===Ve.type?[Ve.geometry]:Ve.geometry,this.properties=Ve.tags,this.extent=We||4096}k.prototype.feature=function(Ve){return new L(this.features[Ve],this.options.extent)},L.prototype.loadGeometry=function(){var Ve=this.rawGeometry;this.geometry=[];for(var We=0;We<Ve.length;We++){for(var he=Ve[We],ye=[],Be=0;Be<he.length;Be++)ye.push(new e.Point$1(he[Be][0],he[Be][1]));this.geometry.push(ye)}return this.geometry},L.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var Ve=this.geometry,We=1/0,he=-1/0,ye=1/0,Be=-1/0,Ge=0;Ge<Ve.length;Ge++)for(var Je=Ve[Ge],He=0;He<Je.length;He++){var st=Je[He];We=Math.min(We,st.x),he=Math.max(he,st.x),ye=Math.min(ye,st.y),Be=Math.max(Be,st.y)}return[We,ye,he,Be]},L.prototype.toGeoJSON=_.prototype.toGeoJSON;var M=E,S=w;function E(Ve){var We=new e.pbf;return function(he,ye){for(var Be in he.layers)ye.writeMessage(3,z,he.layers[Be])}(Ve,We),We.finish()}function z(Ve,We){var he;We.writeVarintField(15,Ve.version||1),We.writeStringField(1,Ve.name||""),We.writeVarintField(5,Ve.extent||4096);var ye={keys:[],values:[],keycache:{},valuecache:{}};for(he=0;he<Ve.length;he++)ye.feature=Ve.feature(he),We.writeMessage(2,R,ye);var Be=ye.keys;for(he=0;he<Be.length;he++)We.writeStringField(3,Be[he]);var Ge=ye.values;for(he=0;he<Ge.length;he++)We.writeMessage(4,G,Ge[he])}function R(Ve,We){var he=Ve.feature;void 0!==he.id&&We.writeVarintField(1,he.id),We.writeMessage(2,q,Ve),We.writeVarintField(3,he.type),We.writeMessage(4,K,he)}function q(Ve,We){var he=Ve.feature,ye=Ve.keys,Be=Ve.values,Ge=Ve.keycache,Je=Ve.valuecache;for(var He in he.properties){var st=Ge[He];void 0===st&&(ye.push(He),Ge[He]=st=ye.length-1),We.writeVarint(st);var ot=he.properties[He],wt=typeof ot;"string"!==wt&&"boolean"!==wt&&"number"!==wt&&(ot=JSON.stringify(ot));var Ct=wt+":"+ot,rt=Je[Ct];void 0===rt&&(Be.push(ot),Je[Ct]=rt=Be.length-1),We.writeVarint(rt)}}function V(Ve,We){return(We<<3)+(7&Ve)}function W(Ve){return Ve<<1^Ve>>31}function K(Ve,We){for(var he=Ve.loadGeometry(),ye=Ve.type,Be=0,Ge=0,Je=he.length,He=0;He<Je;He++){var st=he[He],ot=1;1===ye&&(ot=st.length),We.writeVarint(V(1,ot));for(var wt=3===ye?st.length-1:st.length,Ct=0;Ct<wt;Ct++){1===Ct&&1!==ye&&We.writeVarint(V(2,wt-1));var rt=st[Ct].x-Be,ft=st[Ct].y-Ge;We.writeVarint(W(rt)),We.writeVarint(W(ft)),Be+=rt,Ge+=ft}3===ye&&We.writeVarint(V(7,1))}}function G(Ve,We){var he=typeof Ve;"string"===he?We.writeStringField(1,Ve):"boolean"===he?We.writeBooleanField(7,Ve):"number"===he&&(Ve%1!=0?We.writeDoubleField(3,Ve):Ve<0?We.writeSVarintField(6,Ve):We.writeVarintField(5,Ve))}function Y(Ve,We,he,ye,Be,Ge){if(!(Be-ye<=he)){var Je=ye+Be>>1;(function He(st,ot,wt,Ct,rt,ft){for(;rt>Ct;){if(rt-Ct>600){var Rt=rt-Ct+1,kt=wt-Ct+1,Lt=Math.log(Rt),Ee=.5*Math.exp(2*Lt/3),Ye=.5*Math.sqrt(Lt*Ee*(Rt-Ee)/Rt)*(kt-Rt/2<0?-1:1);He(st,ot,wt,Math.max(Ct,Math.floor(wt-kt*Ee/Rt+Ye)),Math.min(rt,Math.floor(wt+(Rt-kt)*Ee/Rt+Ye)),ft)}var At=ot[2*wt+ft],Ft=Ct,Gt=rt;for($(st,ot,Ct,wt),ot[2*rt+ft]>At&&$(st,ot,Ct,rt);Ft<Gt;){for($(st,ot,Ft,Gt),Ft++,Gt--;ot[2*Ft+ft]<At;)Ft++;for(;ot[2*Gt+ft]>At;)Gt--}ot[2*Ct+ft]===At?$(st,ot,Ct,Gt):$(st,ot,++Gt,rt),Gt<=wt&&(Ct=Gt+1),wt<=Gt&&(rt=Gt-1)}})(Ve,We,Je,ye,Be,Ge%2),Y(Ve,We,he,ye,Je-1,Ge+1),Y(Ve,We,he,Je+1,Be,Ge+1)}}function $(Ve,We,he,ye){B(Ve,he,ye),B(We,2*he,2*ye),B(We,2*he+1,2*ye+1)}function B(Ve,We,he){var ye=Ve[We];Ve[We]=Ve[he],Ve[he]=ye}function N(Ve,We,he,ye){var Be=Ve-he,Ge=We-ye;return Be*Be+Ge*Ge}M.fromVectorTileJs=E,M.fromGeojsonVt=function(Ve,We){We=We||{};var he={};for(var ye in Ve)he[ye]=new w(Ve[ye].features,We),he[ye].name=ye,he[ye].version=We.version,he[ye].extent=We.extent;return E({layers:he})},M.GeoJSONWrapper=S;var U=function(Ve){return Ve[0]},te=function(Ve){return Ve[1]},j=function(Ve,We,he,ye,Be){void 0===We&&(We=U),void 0===he&&(he=te),void 0===ye&&(ye=64),void 0===Be&&(Be=Float64Array),this.nodeSize=ye,this.points=Ve;for(var Ge=Ve.length<65536?Uint16Array:Uint32Array,Je=this.ids=new Ge(Ve.length),He=this.coords=new Be(2*Ve.length),st=0;st<Ve.length;st++)Je[st]=st,He[2*st]=We(Ve[st]),He[2*st+1]=he(Ve[st]);Y(Je,He,ye,0,Je.length-1,0)};j.prototype.range=function(Ve,We,he,ye){return function(Be,Ge,Je,He,st,ot,wt){for(var Ct,rt,ft=[0,Be.length-1,0],Rt=[];ft.length;){var kt=ft.pop(),Lt=ft.pop(),Ee=ft.pop();if(Lt-Ee<=wt)for(var Ye=Ee;Ye<=Lt;Ye++)rt=Ge[2*Ye+1],(Ct=Ge[2*Ye])>=Je&&Ct<=st&&rt>=He&&rt<=ot&&Rt.push(Be[Ye]);else{var it=Math.floor((Ee+Lt)/2);rt=Ge[2*it+1],(Ct=Ge[2*it])>=Je&&Ct<=st&&rt>=He&&rt<=ot&&Rt.push(Be[it]);var ht=(kt+1)%2;(0===kt?Je<=Ct:He<=rt)&&(ft.push(Ee),ft.push(it-1),ft.push(ht)),(0===kt?st>=Ct:ot>=rt)&&(ft.push(it+1),ft.push(Lt),ft.push(ht))}}return Rt}(this.ids,this.coords,Ve,We,he,ye,this.nodeSize)},j.prototype.within=function(Ve,We,he){return function(ye,Be,Ge,Je,He,st){for(var ot=[0,ye.length-1,0],wt=[],Ct=He*He;ot.length;){var rt=ot.pop(),ft=ot.pop(),Rt=ot.pop();if(ft-Rt<=st)for(var kt=Rt;kt<=ft;kt++)N(Be[2*kt],Be[2*kt+1],Ge,Je)<=Ct&&wt.push(ye[kt]);else{var Lt=Math.floor((Rt+ft)/2),Ee=Be[2*Lt],Ye=Be[2*Lt+1];N(Ee,Ye,Ge,Je)<=Ct&&wt.push(ye[Lt]);var it=(rt+1)%2;(0===rt?Ge-He<=Ee:Je-He<=Ye)&&(ot.push(Rt),ot.push(Lt-1),ot.push(it)),(0===rt?Ge+He>=Ee:Je+He>=Ye)&&(ot.push(Lt+1),ot.push(ft),ot.push(it))}}return wt}(this.ids,this.coords,Ve,We,he,this.nodeSize)};var J={minZoom:0,maxZoom:16,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:function(Ve){return Ve}},X=function(Ve){this.options=ge(Object.create(J),Ve),this.trees=new Array(this.options.maxZoom+1)};function re(Ve,We,he,ye,Be){return{x:Ve,y:We,zoom:1/0,id:he,parentId:-1,numPoints:ye,properties:Be}}function ne(Ve,We){var he=Ve.geometry.coordinates,Be=he[1];return{x:de(he[0]),y:se(Be),zoom:1/0,index:We,parentId:-1}}function le(Ve){return{type:"Feature",id:Ve.id,properties:oe(Ve),geometry:{type:"Point",coordinates:[(ye=Ve.x,360*(ye-.5)),(We=Ve.y,he=(180-360*We)*Math.PI/180,360*Math.atan(Math.exp(he))/Math.PI-90)]}};var We,he,ye}function oe(Ve){var We=Ve.numPoints,he=We>=1e4?Math.round(We/1e3)+"k":We>=1e3?Math.round(We/100)/10+"k":We;return ge(ge({},Ve.properties),{cluster:!0,cluster_id:Ve.id,point_count:We,point_count_abbreviated:he})}function de(Ve){return Ve/360+.5}function se(Ve){var We=Math.sin(Ve*Math.PI/180),he=.5-.25*Math.log((1+We)/(1-We))/Math.PI;return he<0?0:he>1?1:he}function ge(Ve,We){for(var he in We)Ve[he]=We[he];return Ve}function _e(Ve){return Ve.x}function Te(Ve){return Ve.y}function we(Ve,We,he,ye,Be,Ge){var Je=Be-he,He=Ge-ye;if(0!==Je||0!==He){var st=((Ve-he)*Je+(We-ye)*He)/(Je*Je+He*He);st>1?(he=Be,ye=Ge):st>0&&(he+=Je*st,ye+=He*st)}return(Je=Ve-he)*Je+(He=We-ye)*He}function Oe(Ve,We,he,ye){var Be={id:void 0===Ve?null:Ve,type:We,geometry:he,tags:ye,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return function(Ge){var Je=Ge.geometry,He=Ge.type;if("Point"===He||"MultiPoint"===He||"LineString"===He)fe(Ge,Je);else if("Polygon"===He||"MultiLineString"===He)for(var st=0;st<Je.length;st++)fe(Ge,Je[st]);else if("MultiPolygon"===He)for(st=0;st<Je.length;st++)for(var ot=0;ot<Je[st].length;ot++)fe(Ge,Je[st][ot])}(Be),Be}function fe(Ve,We){for(var he=0;he<We.length;he+=3)Ve.minX=Math.min(Ve.minX,We[he]),Ve.minY=Math.min(Ve.minY,We[he+1]),Ve.maxX=Math.max(Ve.maxX,We[he]),Ve.maxY=Math.max(Ve.maxY,We[he+1])}function ve(Ve,We,he,ye){if(We.geometry){var Be=We.geometry.coordinates,Ge=We.geometry.type,Je=Math.pow(he.tolerance/((1<<he.maxZoom)*he.extent),2),He=[],st=We.id;if(he.promoteId?st=We.properties[he.promoteId]:he.generateId&&(st=ye||0),"Point"===Ge)Ae(Be,He);else if("MultiPoint"===Ge)for(var ot=0;ot<Be.length;ot++)Ae(Be[ot],He);else if("LineString"===Ge)ke(Be,He,Je,!1);else if("MultiLineString"===Ge){if(he.lineMetrics){for(ot=0;ot<Be.length;ot++)ke(Be[ot],He=[],Je,!1),Ve.push(Oe(st,"LineString",He,We.properties));return}Pe(Be,He,Je,!1)}else if("Polygon"===Ge)Pe(Be,He,Je,!0);else{if("MultiPolygon"!==Ge){if("GeometryCollection"===Ge){for(ot=0;ot<We.geometry.geometries.length;ot++)ve(Ve,{id:st,geometry:We.geometry.geometries[ot],properties:We.properties},he,ye);return}throw new Error("Input data is not a valid GeoJSON object.")}for(ot=0;ot<Be.length;ot++){var wt=[];Pe(Be[ot],wt,Je,!0),He.push(wt)}}Ve.push(Oe(st,Ge,He,We.properties))}}function Ae(Ve,We){We.push(Ne(Ve[0])),We.push(De(Ve[1])),We.push(0)}function ke(Ve,We,he,ye){for(var Be,Ge,Je=0,He=0;He<Ve.length;He++){var st=Ne(Ve[He][0]),ot=De(Ve[He][1]);We.push(st),We.push(ot),We.push(0),He>0&&(Je+=ye?(Be*ot-st*Ge)/2:Math.sqrt(Math.pow(st-Be,2)+Math.pow(ot-Ge,2))),Be=st,Ge=ot}var wt=We.length-3;We[2]=1,function Ct(rt,ft,Rt,kt){for(var Lt,Ee=kt,Ye=Rt-ft>>1,it=Rt-ft,ht=rt[ft],At=rt[ft+1],Ft=rt[Rt],Gt=rt[Rt+1],jt=ft+3;jt<Rt;jt+=3){var fr=we(rt[jt],rt[jt+1],ht,At,Ft,Gt);if(fr>Ee)Lt=jt,Ee=fr;else if(fr===Ee){var kr=Math.abs(jt-Ye);kr<it&&(Lt=jt,it=kr)}}Ee>kt&&(Lt-ft>3&&Ct(rt,ft,Lt,kt),rt[Lt+2]=Ee,Rt-Lt>3&&Ct(rt,Lt,Rt,kt))}(We,0,wt,he),We[wt+2]=1,We.size=Math.abs(Je),We.start=0,We.end=We.size}function Pe(Ve,We,he,ye){for(var Be=0;Be<Ve.length;Be++){var Ge=[];ke(Ve[Be],Ge,he,ye),We.push(Ge)}}function Ne(Ve){return Ve/360+.5}function De(Ve){var We=Math.sin(Ve*Math.PI/180),he=.5-.25*Math.log((1+We)/(1-We))/Math.PI;return he<0?0:he>1?1:he}function ze(Ve,We,he,ye,Be,Ge,Je,He){if(ye/=We,Ge>=(he/=We)&&Je<ye)return Ve;if(Je<he||Ge>=ye)return null;for(var st=[],ot=0;ot<Ve.length;ot++){var wt=Ve[ot],Ct=wt.geometry,rt=wt.type,ft=0===Be?wt.minX:wt.minY,Rt=0===Be?wt.maxX:wt.maxY;if(ft>=he&&Rt<ye)st.push(wt);else if(!(Rt<he||ft>=ye)){var kt=[];if("Point"===rt||"MultiPoint"===rt)Me(Ct,kt,he,ye,Be);else if("LineString"===rt)Se(Ct,kt,he,ye,Be,!1,He.lineMetrics);else if("MultiLineString"===rt)Fe(Ct,kt,he,ye,Be,!1);else if("Polygon"===rt)Fe(Ct,kt,he,ye,Be,!0);else if("MultiPolygon"===rt)for(var Lt=0;Lt<Ct.length;Lt++){var Ee=[];Fe(Ct[Lt],Ee,he,ye,Be,!0),Ee.length&&kt.push(Ee)}if(kt.length){if(He.lineMetrics&&"LineString"===rt){for(Lt=0;Lt<kt.length;Lt++)st.push(Oe(wt.id,rt,kt[Lt],wt.tags));continue}"LineString"!==rt&&"MultiLineString"!==rt||(1===kt.length?(rt="LineString",kt=kt[0]):rt="MultiLineString"),"Point"!==rt&&"MultiPoint"!==rt||(rt=3===kt.length?"Point":"MultiPoint"),st.push(Oe(wt.id,rt,kt,wt.tags))}}}return st.length?st:null}function Me(Ve,We,he,ye,Be){for(var Ge=0;Ge<Ve.length;Ge+=3){var Je=Ve[Ge+Be];Je>=he&&Je<=ye&&(We.push(Ve[Ge]),We.push(Ve[Ge+1]),We.push(Ve[Ge+2]))}}function Se(Ve,We,he,ye,Be,Ge,Je){for(var He,st,ot=Ie(Ve),wt=0===Be?Xe:nt,Ct=Ve.start,rt=0;rt<Ve.length-3;rt+=3){var ft=Ve[rt],Rt=Ve[rt+1],kt=Ve[rt+2],Lt=Ve[rt+3],Ee=Ve[rt+4],Ye=0===Be?ft:Rt,it=0===Be?Lt:Ee,ht=!1;Je&&(He=Math.sqrt(Math.pow(ft-Lt,2)+Math.pow(Rt-Ee,2))),Ye<he?it>he&&(st=wt(ot,ft,Rt,Lt,Ee,he),Je&&(ot.start=Ct+He*st)):Ye>ye?it<ye&&(st=wt(ot,ft,Rt,Lt,Ee,ye),Je&&(ot.start=Ct+He*st)):Re(ot,ft,Rt,kt),it<he&&Ye>=he&&(st=wt(ot,ft,Rt,Lt,Ee,he),ht=!0),it>ye&&Ye<=ye&&(st=wt(ot,ft,Rt,Lt,Ee,ye),ht=!0),!Ge&&ht&&(Je&&(ot.end=Ct+He*st),We.push(ot),ot=Ie(Ve)),Je&&(Ct+=He)}var At=Ve.length-3;ft=Ve[At],Rt=Ve[At+1],kt=Ve[At+2],(Ye=0===Be?ft:Rt)>=he&&Ye<=ye&&Re(ot,ft,Rt,kt),At=ot.length-3,Ge&&At>=3&&(ot[At]!==ot[0]||ot[At+1]!==ot[1])&&Re(ot,ot[0],ot[1],ot[2]),ot.length&&We.push(ot)}function Ie(Ve){var We=[];return We.size=Ve.size,We.start=Ve.start,We.end=Ve.end,We}function Fe(Ve,We,he,ye,Be,Ge){for(var Je=0;Je<Ve.length;Je++)Se(Ve[Je],We,he,ye,Be,Ge,!1)}function Re(Ve,We,he,ye){Ve.push(We),Ve.push(he),Ve.push(ye)}function Xe(Ve,We,he,ye,Be,Ge){var Je=(Ge-We)/(ye-We);return Ve.push(Ge),Ve.push(he+(Be-he)*Je),Ve.push(1),Je}function nt(Ve,We,he,ye,Be,Ge){var Je=(Ge-he)/(Be-he);return Ve.push(We+(ye-We)*Je),Ve.push(Ge),Ve.push(1),Je}function ct(Ve,We){for(var he=[],ye=0;ye<Ve.length;ye++){var Be,Ge=Ve[ye],Je=Ge.type;if("Point"===Je||"MultiPoint"===Je||"LineString"===Je)Be=xt(Ge.geometry,We);else if("MultiLineString"===Je||"Polygon"===Je){Be=[];for(var He=0;He<Ge.geometry.length;He++)Be.push(xt(Ge.geometry[He],We))}else if("MultiPolygon"===Je)for(Be=[],He=0;He<Ge.geometry.length;He++){for(var st=[],ot=0;ot<Ge.geometry[He].length;ot++)st.push(xt(Ge.geometry[He][ot],We));Be.push(st)}he.push(Oe(Ge.id,Je,Be,Ge.tags))}return he}function xt(Ve,We){var he=[];he.size=Ve.size,void 0!==Ve.start&&(he.start=Ve.start,he.end=Ve.end);for(var ye=0;ye<Ve.length;ye+=3)he.push(Ve[ye]+We,Ve[ye+1],Ve[ye+2]);return he}function dt(Ve,We){if(Ve.transformed)return Ve;var he,ye,Be,Ge=1<<Ve.z,Je=Ve.x,He=Ve.y;for(he=0;he<Ve.features.length;he++){var st=Ve.features[he],ot=st.geometry,wt=st.type;if(st.geometry=[],1===wt)for(ye=0;ye<ot.length;ye+=2)st.geometry.push(tt(ot[ye],ot[ye+1],We,Ge,Je,He));else for(ye=0;ye<ot.length;ye++){var Ct=[];for(Be=0;Be<ot[ye].length;Be+=2)Ct.push(tt(ot[ye][Be],ot[ye][Be+1],We,Ge,Je,He));st.geometry.push(Ct)}}return Ve.transformed=!0,Ve}function tt(Ve,We,he,ye,Be,Ge){return[Math.round(he*(Ve*ye-Be)),Math.round(he*(We*ye-Ge))]}function Ke(Ve,We,he,ye,Be){for(var Ge=We===Be.maxZoom?0:Be.tolerance/((1<<We)*Be.extent),Je={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:he,y:ye,z:We,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},He=0;He<Ve.length;He++){Je.numFeatures++,mt(Je,Ve[He],Ge,Be);var st=Ve[He].minX,ot=Ve[He].minY,wt=Ve[He].maxX,Ct=Ve[He].maxY;st<Je.minX&&(Je.minX=st),ot<Je.minY&&(Je.minY=ot),wt>Je.maxX&&(Je.maxX=wt),Ct>Je.maxY&&(Je.maxY=Ct)}return Je}function mt(Ve,We,he,ye){var Be=We.geometry,Ge=We.type,Je=[];if("Point"===Ge||"MultiPoint"===Ge)for(var He=0;He<Be.length;He+=3)Je.push(Be[He]),Je.push(Be[He+1]),Ve.numPoints++,Ve.numSimplified++;else if("LineString"===Ge)Bt(Je,Be,Ve,he,!1,!1);else if("MultiLineString"===Ge||"Polygon"===Ge)for(He=0;He<Be.length;He++)Bt(Je,Be[He],Ve,he,"Polygon"===Ge,0===He);else if("MultiPolygon"===Ge)for(var st=0;st<Be.length;st++){var ot=Be[st];for(He=0;He<ot.length;He++)Bt(Je,ot[He],Ve,he,!0,0===He)}if(Je.length){var wt=We.tags||null;if("LineString"===Ge&&ye.lineMetrics){for(var Ct in wt={},We.tags)wt[Ct]=We.tags[Ct];wt.mapbox_clip_start=Be.start/Be.size,wt.mapbox_clip_end=Be.end/Be.size}var rt={geometry:Je,type:"Polygon"===Ge||"MultiPolygon"===Ge?3:"LineString"===Ge||"MultiLineString"===Ge?2:1,tags:wt};null!==We.id&&(rt.id=We.id),Ve.features.push(rt)}}function Bt(Ve,We,he,ye,Be,Ge){var Je=ye*ye;if(ye>0&&We.size<(Be?Je:ye))he.numPoints+=We.length/3;else{for(var He=[],st=0;st<We.length;st+=3)(0===ye||We[st+2]>Je)&&(he.numSimplified++,He.push(We[st]),He.push(We[st+1])),he.numPoints++;Be&&function(ot,wt){for(var Ct=0,rt=0,ft=ot.length,Rt=ft-2;rt<ft;Rt=rt,rt+=2)Ct+=(ot[rt]-ot[Rt])*(ot[rt+1]+ot[Rt+1]);if(Ct>0===wt)for(rt=0,ft=ot.length;rt<ft/2;rt+=2){var kt=ot[rt],Lt=ot[rt+1];ot[rt]=ot[ft-2-rt],ot[rt+1]=ot[ft-1-rt],ot[ft-2-rt]=kt,ot[ft-1-rt]=Lt}}(He,Ge),Ve.push(He)}}function Ut(Ve,We){var he=(We=this.options=function(Be,Ge){for(var Je in Ge)Be[Je]=Ge[Je];return Be}(Object.create(this.options),We)).debug;if(he&&console.time("preprocess data"),We.maxZoom<0||We.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(We.promoteId&&We.generateId)throw new Error("promoteId and generateId cannot be used together.");var Be,Ge,Je,He,st,ot,ye=function(Be,Ge){var Je=[];if("FeatureCollection"===Be.type)for(var He=0;He<Be.features.length;He++)ve(Je,Be.features[He],Ge,He);else ve(Je,"Feature"===Be.type?Be:{geometry:Be},Ge);return Je}(Ve,We);this.tiles={},this.tileCoords=[],he&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",We.indexMaxZoom,We.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),(Be=ye,Ge=We,Je=Ge.buffer/Ge.extent,He=Be,st=ze(Be,1,-1-Je,Je,0,-1,2,Ge),ot=ze(Be,1,1-Je,2+Je,0,-1,2,Ge),(st||ot)&&(He=ze(Be,1,-Je,1+Je,0,-1,2,Ge)||[],st&&(He=ct(st,1).concat(He)),ot&&(He=He.concat(ct(ot,-1)))),ye=He).length&&this.splitTile(ye,0,0,0),he&&(ye.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}function er(Ve,We,he){return 32*((1<<Ve)*he+We)+Ve}function Wt(Ve,We){var he=Ve.tileID.canonical;if(!this._geoJSONIndex)return We(null,null);var ye=this._geoJSONIndex.getTile(he.z,he.x,he.y);if(!ye)return We(null,null);var Be=new T(ye.features),Ge=M(Be);0===Ge.byteOffset&&Ge.byteLength===Ge.buffer.byteLength||(Ge=new Uint8Array(Ge)),We(null,{vectorTile:Be,rawData:Ge.buffer})}X.prototype.load=function(Ve){var We=this.options,he=We.log,ye=We.minZoom,Be=We.maxZoom,Ge=We.nodeSize;he&&console.time("total time");var Je="prepare "+Ve.length+" points";he&&console.time(Je),this.points=Ve;for(var He=[],st=0;st<Ve.length;st++)Ve[st].geometry&&He.push(ne(Ve[st],st));this.trees[Be+1]=new j(He,_e,Te,Ge,Float32Array),he&&console.timeEnd(Je);for(var ot=Be;ot>=ye;ot--){var wt=+Date.now();He=this._cluster(He,ot),this.trees[ot]=new j(He,_e,Te,Ge,Float32Array),he&&console.log("z%d: %d clusters in %dms",ot,He.length,+Date.now()-wt)}return he&&console.timeEnd("total time"),this},X.prototype.getClusters=function(Ve,We){var he=((Ve[0]+180)%360+360)%360-180,ye=Math.max(-90,Math.min(90,Ve[1])),Be=180===Ve[2]?180:((Ve[2]+180)%360+360)%360-180,Ge=Math.max(-90,Math.min(90,Ve[3]));if(Ve[2]-Ve[0]>=360)he=-180,Be=180;else if(he>Be){var Je=this.getClusters([he,ye,180,Ge],We),He=this.getClusters([-180,ye,Be,Ge],We);return Je.concat(He)}for(var st=this.trees[this._limitZoom(We)],ot=[],wt=0,Ct=st.range(de(he),se(Ge),de(Be),se(ye));wt<Ct.length;wt+=1){var ft=st.points[Ct[wt]];ot.push(ft.numPoints?le(ft):this.points[ft.index])}return ot},X.prototype.getChildren=function(Ve){var We=this._getOriginId(Ve),he=this._getOriginZoom(Ve),ye="No cluster with the specified id.",Be=this.trees[he];if(!Be)throw new Error(ye);var Ge=Be.points[We];if(!Ge)throw new Error(ye);for(var Je=this.options.radius/(this.options.extent*Math.pow(2,he-1)),He=[],st=0,ot=Be.within(Ge.x,Ge.y,Je);st<ot.length;st+=1){var Ct=Be.points[ot[st]];Ct.parentId===Ve&&He.push(Ct.numPoints?le(Ct):this.points[Ct.index])}if(0===He.length)throw new Error(ye);return He},X.prototype.getLeaves=function(Ve,We,he){var ye=[];return this._appendLeaves(ye,Ve,We=We||10,he=he||0,0),ye},X.prototype.getTile=function(Ve,We,he){var ye=this.trees[this._limitZoom(Ve)],Be=Math.pow(2,Ve),Ge=this.options,He=Ge.radius/Ge.extent,st=(he-He)/Be,ot=(he+1+He)/Be,wt={features:[]};return this._addTileFeatures(ye.range((We-He)/Be,st,(We+1+He)/Be,ot),ye.points,We,he,Be,wt),0===We&&this._addTileFeatures(ye.range(1-He/Be,st,1,ot),ye.points,Be,he,Be,wt),We===Be-1&&this._addTileFeatures(ye.range(0,st,He/Be,ot),ye.points,-1,he,Be,wt),wt.features.length?wt:null},X.prototype.getClusterExpansionZoom=function(Ve){for(var We=this._getOriginZoom(Ve)-1;We<=this.options.maxZoom;){var he=this.getChildren(Ve);if(We++,1!==he.length)break;Ve=he[0].properties.cluster_id}return We},X.prototype._appendLeaves=function(Ve,We,he,ye,Be){for(var Ge=0,Je=this.getChildren(We);Ge<Je.length;Ge+=1){var He=Je[Ge],st=He.properties;if(st&&st.cluster?Be+st.point_count<=ye?Be+=st.point_count:Be=this._appendLeaves(Ve,st.cluster_id,he,ye,Be):Be<ye?Be++:Ve.push(He),Ve.length===he)break}return Be},X.prototype._addTileFeatures=function(Ve,We,he,ye,Be,Ge){for(var Je=0,He=Ve;Je<He.length;Je+=1){var st=We[He[Je]],ot=st.numPoints,wt={type:1,geometry:[[Math.round(this.options.extent*(st.x*Be-he)),Math.round(this.options.extent*(st.y*Be-ye))]],tags:ot?oe(st):this.points[st.index].properties},Ct=void 0;ot?Ct=st.id:this.options.generateId?Ct=st.index:this.points[st.index].id&&(Ct=this.points[st.index].id),void 0!==Ct&&(wt.id=Ct),Ge.features.push(wt)}},X.prototype._limitZoom=function(Ve){return Math.max(this.options.minZoom,Math.min(Ve,this.options.maxZoom+1))},X.prototype._cluster=function(Ve,We){for(var he=[],ye=this.options,Je=ye.reduce,He=ye.radius/(ye.extent*Math.pow(2,We)),st=0;st<Ve.length;st++){var ot=Ve[st];if(!(ot.zoom<=We)){ot.zoom=We;for(var wt=this.trees[We+1],Ct=wt.within(ot.x,ot.y,He),rt=ot.numPoints||1,ft=ot.x*rt,Rt=ot.y*rt,kt=Je&&rt>1?this._map(ot,!0):null,Lt=(st<<5)+(We+1)+this.points.length,Ee=0,Ye=Ct;Ee<Ye.length;Ee+=1){var ht=wt.points[Ye[Ee]];if(!(ht.zoom<=We)){ht.zoom=We;var At=ht.numPoints||1;ft+=ht.x*At,Rt+=ht.y*At,rt+=At,ht.parentId=Lt,Je&&(kt||(kt=this._map(ot,!0)),Je(kt,this._map(ht)))}}1===rt?he.push(ot):(ot.parentId=Lt,he.push(re(ft/rt,Rt/rt,Lt,rt,kt)))}}return he},X.prototype._getOriginId=function(Ve){return Ve-this.points.length>>5},X.prototype._getOriginZoom=function(Ve){return(Ve-this.points.length)%32},X.prototype._map=function(Ve,We){if(Ve.numPoints)return We?ge({},Ve.properties):Ve.properties;var he=this.points[Ve.index].properties,ye=this.options.map(he);return We&&ye===he?ge({},ye):ye},Ut.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},Ut.prototype.splitTile=function(Ve,We,he,ye,Be,Ge,Je){for(var He=[Ve,We,he,ye],st=this.options,ot=st.debug;He.length;){ye=He.pop(),he=He.pop(),We=He.pop(),Ve=He.pop();var wt=1<<We,Ct=er(We,he,ye),rt=this.tiles[Ct];if(!rt&&(ot>1&&console.time("creation"),rt=this.tiles[Ct]=Ke(Ve,We,he,ye,st),this.tileCoords.push({z:We,x:he,y:ye}),ot)){ot>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",We,he,ye,rt.numFeatures,rt.numPoints,rt.numSimplified),console.timeEnd("creation"));var ft="z"+We;this.stats[ft]=(this.stats[ft]||0)+1,this.total++}if(rt.source=Ve,Be){if(We===st.maxZoom||We===Be)continue;var Rt=1<<Be-We;if(he!==Math.floor(Ge/Rt)||ye!==Math.floor(Je/Rt))continue}else if(We===st.indexMaxZoom||rt.numPoints<=st.indexMaxPoints)continue;if(rt.source=null,0!==Ve.length){ot>1&&console.time("clipping");var kt,Lt,Ee,Ye,it,ht,At=.5*st.buffer/st.extent,Ft=.5-At,Gt=.5+At,jt=1+At;kt=Lt=Ee=Ye=null,it=ze(Ve,wt,he-At,he+Gt,0,rt.minX,rt.maxX,st),ht=ze(Ve,wt,he+Ft,he+jt,0,rt.minX,rt.maxX,st),Ve=null,it&&(kt=ze(it,wt,ye-At,ye+Gt,1,rt.minY,rt.maxY,st),Lt=ze(it,wt,ye+Ft,ye+jt,1,rt.minY,rt.maxY,st),it=null),ht&&(Ee=ze(ht,wt,ye-At,ye+Gt,1,rt.minY,rt.maxY,st),Ye=ze(ht,wt,ye+Ft,ye+jt,1,rt.minY,rt.maxY,st),ht=null),ot>1&&console.timeEnd("clipping"),He.push(kt||[],We+1,2*he,2*ye),He.push(Lt||[],We+1,2*he,2*ye+1),He.push(Ee||[],We+1,2*he+1,2*ye),He.push(Ye||[],We+1,2*he+1,2*ye+1)}}},Ut.prototype.getTile=function(Ve,We,he){var ye=this.options,Be=ye.extent,Ge=ye.debug;if(Ve<0||Ve>24)return null;var Je=1<<Ve,He=er(Ve,We=(We%Je+Je)%Je,he);if(this.tiles[He])return dt(this.tiles[He],Be);Ge>1&&console.log("drilling down to z%d-%d-%d",Ve,We,he);for(var st,ot=Ve,wt=We,Ct=he;!st&&ot>0;)ot--,wt=Math.floor(wt/2),Ct=Math.floor(Ct/2),st=this.tiles[er(ot,wt,Ct)];return st&&st.source?(Ge>1&&console.log("found parent tile z%d-%d-%d",ot,wt,Ct),Ge>1&&console.time("drilling down"),this.splitTile(st.source,ot,wt,Ct,Ve,We,he),Ge>1&&console.timeEnd("drilling down"),this.tiles[He]?dt(this.tiles[He],Be):null):null};var rr=function(Ve){function We(he,ye,Be,Ge){Ve.call(this,he,ye,Be,Wt),Ge&&(this.loadGeoJSON=Ge)}return Ve&&(We.__proto__=Ve),(We.prototype=Object.create(Ve&&Ve.prototype)).constructor=We,We.prototype.loadData=function(he,ye){this._pendingCallback&&this._pendingCallback(null,{abandoned:!0}),this._pendingCallback=ye,this._pendingLoadDataParams=he,this._state&&"Idle"!==this._state?this._state="NeedsLoadData":(this._state="Coalescing",this._loadData())},We.prototype._loadData=function(){var he=this;if(this._pendingCallback&&this._pendingLoadDataParams){var ye=this._pendingCallback,Be=this._pendingLoadDataParams;delete this._pendingCallback,delete this._pendingLoadDataParams;var Ge=!!(Be&&Be.request&&Be.request.collectResourceTiming)&&new e.RequestPerformance(Be.request);this.loadGeoJSON(Be,function(Je,He){if(Je||!He)return ye(Je);if("object"!=typeof He)return ye(new Error("Input data given to '"+Be.source+"' is not a valid GeoJSON object."));h(He,!0);try{he._geoJSONIndex=Be.cluster?new X(function(wt){var Ct=wt.superclusterOptions,rt=wt.clusterProperties;if(!rt||!Ct)return Ct;for(var ft={},Rt={},kt={accumulated:null,zoom:0},Lt={properties:null},Ee=Object.keys(rt),Ye=0,it=Ee;Ye<it.length;Ye+=1){var ht=it[Ye],At=rt[ht],Ft=At[0],jt=e.createExpression(At[1]),fr=e.createExpression("string"==typeof Ft?[Ft,["accumulated"],["get",ht]]:Ft);ft[ht]=jt.value,Rt[ht]=fr.value}return Ct.map=function(kr){Lt.properties=kr;for(var ur={},Jt=0,$t=Ee;Jt<$t.length;Jt+=1){var Qt=$t[Jt];ur[Qt]=ft[Qt].evaluate(kt,Lt)}return ur},Ct.reduce=function(kr,ur){Lt.properties=ur;for(var Jt=0,$t=Ee;Jt<$t.length;Jt+=1){var Qt=$t[Jt];kt.accumulated=kr[Qt],kr[Qt]=Rt[Qt].evaluate(kt,Lt)}},Ct}(Be)).load(He.features):new Ut(wt=He,Be.geojsonVtOptions)}catch(wt){return ye(wt)}var wt;he.loaded={};var st={};if(Ge){var ot=Ge.finish();ot&&(st.resourceTiming={},st.resourceTiming[Be.source]=JSON.parse(JSON.stringify(ot)))}ye(null,st)})}},We.prototype.coalesce=function(){"Coalescing"===this._state?this._state="Idle":"NeedsLoadData"===this._state&&(this._state="Coalescing",this._loadData())},We.prototype.reloadTile=function(he,ye){var Be=this.loaded;return Be&&Be[he.uid]?Ve.prototype.reloadTile.call(this,he,ye):this.loadTile(he,ye)},We.prototype.loadGeoJSON=function(he,ye){if(he.request)e.getJSON(he.request,ye);else{if("string"!=typeof he.data)return ye(new Error("Input data given to '"+he.source+"' is not a valid GeoJSON object."));try{return ye(null,JSON.parse(he.data))}catch{return ye(new Error("Input data given to '"+he.source+"' is not a valid GeoJSON object."))}}},We.prototype.removeSource=function(he,ye){this._pendingCallback&&this._pendingCallback(null,{abandoned:!0}),ye()},We.prototype.getClusterExpansionZoom=function(he,ye){try{ye(null,this._geoJSONIndex.getClusterExpansionZoom(he.clusterId))}catch(Be){ye(Be)}},We.prototype.getClusterChildren=function(he,ye){try{ye(null,this._geoJSONIndex.getChildren(he.clusterId))}catch(Be){ye(Be)}},We.prototype.getClusterLeaves=function(he,ye){try{ye(null,this._geoJSONIndex.getLeaves(he.clusterId,he.limit,he.offset))}catch(Be){ye(Be)}},We}(u),Ht=function(Ve){var We=this;this.self=Ve,this.actor=new e.Actor(Ve,this),this.layerIndexes={},this.availableImages={},this.workerSourceTypes={vector:u,geojson:rr},this.workerSources={},this.demWorkerSources={},this.self.registerWorkerSource=function(he,ye){if(We.workerSourceTypes[he])throw new Error('Worker source with name "'+he+'" already registered.');We.workerSourceTypes[he]=ye},this.self.registerRTLTextPlugin=function(he){if(e.plugin.isParsed())throw new Error("RTL text plugin already registered.");e.plugin.applyArabicShaping=he.applyArabicShaping,e.plugin.processBidirectionalText=he.processBidirectionalText,e.plugin.processStyledBidirectionalText=he.processStyledBidirectionalText}};return Ht.prototype.setReferrer=function(Ve,We){this.referrer=We},Ht.prototype.setImages=function(Ve,We,he){for(var ye in this.availableImages[Ve]=We,this.workerSources[Ve]){var Be=this.workerSources[Ve][ye];for(var Ge in Be)Be[Ge].availableImages=We}he()},Ht.prototype.setLayers=function(Ve,We,he){this.getLayerIndex(Ve).replace(We),he()},Ht.prototype.updateLayers=function(Ve,We,he){this.getLayerIndex(Ve).update(We.layers,We.removedIds),he()},Ht.prototype.loadTile=function(Ve,We,he){this.getWorkerSource(Ve,We.type,We.source).loadTile(We,he)},Ht.prototype.loadDEMTile=function(Ve,We,he){this.getDEMWorkerSource(Ve,We.source).loadTile(We,he)},Ht.prototype.reloadTile=function(Ve,We,he){this.getWorkerSource(Ve,We.type,We.source).reloadTile(We,he)},Ht.prototype.abortTile=function(Ve,We,he){this.getWorkerSource(Ve,We.type,We.source).abortTile(We,he)},Ht.prototype.removeTile=function(Ve,We,he){this.getWorkerSource(Ve,We.type,We.source).removeTile(We,he)},Ht.prototype.removeDEMTile=function(Ve,We){this.getDEMWorkerSource(Ve,We.source).removeTile(We)},Ht.prototype.removeSource=function(Ve,We,he){if(this.workerSources[Ve]&&this.workerSources[Ve][We.type]&&this.workerSources[Ve][We.type][We.source]){var ye=this.workerSources[Ve][We.type][We.source];delete this.workerSources[Ve][We.type][We.source],void 0!==ye.removeSource?ye.removeSource(We,he):he()}},Ht.prototype.loadWorkerSource=function(Ve,We,he){try{this.self.importScripts(We.url),he()}catch(ye){he(ye.toString())}},Ht.prototype.syncRTLPluginState=function(Ve,We,he){try{e.plugin.setState(We);var ye=e.plugin.getPluginURL();if(e.plugin.isLoaded()&&!e.plugin.isParsed()&&null!=ye){this.self.importScripts(ye);var Be=e.plugin.isParsed();he(Be?void 0:new Error("RTL Text Plugin failed to import scripts from "+ye),Be)}}catch(Ge){he(Ge.toString())}},Ht.prototype.getAvailableImages=function(Ve){var We=this.availableImages[Ve];return We||(We=[]),We},Ht.prototype.getLayerIndex=function(Ve){var We=this.layerIndexes[Ve];return We||(We=this.layerIndexes[Ve]=new a),We},Ht.prototype.getWorkerSource=function(Ve,We,he){var ye=this;return this.workerSources[Ve]||(this.workerSources[Ve]={}),this.workerSources[Ve][We]||(this.workerSources[Ve][We]={}),this.workerSources[Ve][We][he]||(this.workerSources[Ve][We][he]=new this.workerSourceTypes[We]({send:function(Ge,Je,He){ye.actor.send(Ge,Je,He,Ve)}},this.getLayerIndex(Ve),this.getAvailableImages(Ve))),this.workerSources[Ve][We][he]},Ht.prototype.getDEMWorkerSource=function(Ve,We){return this.demWorkerSources[Ve]||(this.demWorkerSources[Ve]={}),this.demWorkerSources[Ve][We]||(this.demWorkerSources[Ve][We]=new c),this.demWorkerSources[Ve][We]},Ht.prototype.enforceCacheSizeLimit=function(Ve,We){e.enforceCacheSizeLimit(We)},typeof WorkerGlobalScope<"u"&&void 0!==e.window&&e.window instanceof WorkerGlobalScope&&(e.window.worker=new Ht(e.window)),Ht}),x(0,function(e){var n=e.createCommonjsModule(function(C){function D(ae){return!F(ae)}function F(ae){return typeof window>"u"||typeof document>"u"?"not a browser":Array.prototype&&Array.prototype.every&&Array.prototype.filter&&Array.prototype.forEach&&Array.prototype.indexOf&&Array.prototype.lastIndexOf&&Array.prototype.map&&Array.prototype.some&&Array.prototype.reduce&&Array.prototype.reduceRight&&Array.isArray?Function.prototype&&Function.prototype.bind?Object.keys&&Object.create&&Object.getPrototypeOf&&Object.getOwnPropertyNames&&Object.isSealed&&Object.isFrozen&&Object.isExtensible&&Object.getOwnPropertyDescriptor&&Object.defineProperty&&Object.defineProperties&&Object.seal&&Object.freeze&&Object.preventExtensions?"JSON"in window&&"parse"in JSON&&"stringify"in JSON?function(){if(!("Worker"in window&&"Blob"in window&&"URL"in window))return!1;var ue,me,be=new Blob([""],{type:"text/javascript"}),Le=URL.createObjectURL(be);try{me=new Worker(Le),ue=!0}catch{ue=!1}return me&&me.terminate(),URL.revokeObjectURL(Le),ue}()?"Uint8ClampedArray"in window?ArrayBuffer.isView?function(){var ue=document.createElement("canvas");ue.width=ue.height=1;var me=ue.getContext("2d");if(!me)return!1;var be=me.getImageData(0,0,1,1);return be&&be.width===ue.width}()?(void 0===H[ue=ae&&ae.failIfMajorPerformanceCaveat]&&(H[ue]=function(me){var qe,Qe,at,be=(qe=me,Qe=document.createElement("canvas"),(at=Object.create(D.webGLContextAttributes)).failIfMajorPerformanceCaveat=qe,Qe.probablySupportsContext?Qe.probablySupportsContext("webgl",at)||Qe.probablySupportsContext("experimental-webgl",at):Qe.supportsContext?Qe.supportsContext("webgl",at)||Qe.supportsContext("experimental-webgl",at):Qe.getContext("webgl",at)||Qe.getContext("experimental-webgl",at));if(!be)return!1;var Le=be.createShader(be.VERTEX_SHADER);return!(!Le||be.isContextLost())&&(be.shaderSource(Le,"void main() {}"),be.compileShader(Le),!0===be.getShaderParameter(Le,be.COMPILE_STATUS))}(ue)),H[ue]?void 0:"insufficient WebGL support"):"insufficient Canvas/getImageData support":"insufficient ArrayBuffer support":"insufficient Uint8ClampedArray support":"insufficient worker support":"insufficient JSON support":"insufficient Object support":"insufficient Function support":"insufficent Array support";var ue}C.exports?C.exports=D:window&&(window.mapboxgl=window.mapboxgl||{},window.mapboxgl.supported=D,window.mapboxgl.notSupportedReason=F);var H={};D.webGLContextAttributes={antialias:!1,alpha:!0,stencil:!0,depth:!0}}),t={create:function(C,D,F){var H=e.window.document.createElement(C);return void 0!==D&&(H.className=D),F&&F.appendChild(H),H},createNS:function(C,D){return e.window.document.createElementNS(C,D)}},a=e.window.document.documentElement.style;function r(C){if(!a)return C[0];for(var D=0;D<C.length;D++)if(C[D]in a)return C[D];return C[0]}var d,s=r(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]);t.disableDrag=function(){a&&s&&(d=a[s],a[s]="none")},t.enableDrag=function(){a&&s&&(a[s]=d)};var i=r(["transform","WebkitTransform"]);t.setTransform=function(C,D){C.style[i]=D};var u=!1;try{var f=Object.defineProperty({},"passive",{get:function(){u=!0}});e.window.addEventListener("test",f,f),e.window.removeEventListener("test",f,f)}catch{u=!1}t.addEventListener=function(C,D,F,H){void 0===H&&(H={}),C.addEventListener(D,F,"passive"in H&&u?H:H.capture)},t.removeEventListener=function(C,D,F,H){void 0===H&&(H={}),C.removeEventListener(D,F,"passive"in H&&u?H:H.capture)};var c=function(C){C.preventDefault(),C.stopPropagation(),e.window.removeEventListener("click",c,!0)};function h(C){var D=C.userImage;return!!(D&&D.render&&D.render())&&(C.data.replace(new Uint8Array(D.data.buffer)),!0)}t.suppressClick=function(){e.window.addEventListener("click",c,!0),e.window.setTimeout(function(){e.window.removeEventListener("click",c,!0)},0)},t.mousePos=function(C,D){var F=C.getBoundingClientRect();return new e.Point(D.clientX-F.left-C.clientLeft,D.clientY-F.top-C.clientTop)},t.touchPos=function(C,D){for(var F=C.getBoundingClientRect(),H=[],ae=0;ae<D.length;ae++)H.push(new e.Point(D[ae].clientX-F.left-C.clientLeft,D[ae].clientY-F.top-C.clientTop));return H},t.mouseButton=function(C){return void 0!==e.window.InstallTrigger&&2===C.button&&C.ctrlKey&&e.window.navigator.platform.toUpperCase().indexOf("MAC")>=0?0:C.button},t.remove=function(C){C.parentNode&&C.parentNode.removeChild(C)};var p=function(C){function D(){C.call(this),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new e.RGBAImage({width:1,height:1}),this.dirty=!0}return C&&(D.__proto__=C),(D.prototype=Object.create(C&&C.prototype)).constructor=D,D.prototype.isLoaded=function(){return this.loaded},D.prototype.setLoaded=function(F){if(this.loaded!==F&&(this.loaded=F,F)){for(var H=0,ae=this.requestors;H<ae.length;H+=1){var ue=ae[H];this._notify(ue.ids,ue.callback)}this.requestors=[]}},D.prototype.getImage=function(F){return this.images[F]},D.prototype.addImage=function(F,H){this._validate(F,H)&&(this.images[F]=H)},D.prototype._validate=function(F,H){var ae=!0;return this._validateStretch(H.stretchX,H.data&&H.data.width)||(this.fire(new e.ErrorEvent(new Error('Image "'+F+'" has invalid "stretchX" value'))),ae=!1),this._validateStretch(H.stretchY,H.data&&H.data.height)||(this.fire(new e.ErrorEvent(new Error('Image "'+F+'" has invalid "stretchY" value'))),ae=!1),this._validateContent(H.content,H)||(this.fire(new e.ErrorEvent(new Error('Image "'+F+'" has invalid "content" value'))),ae=!1),ae},D.prototype._validateStretch=function(F,H){if(!F)return!0;for(var ae=0,ue=0,me=F;ue<me.length;ue+=1){var be=me[ue];if(be[0]<ae||be[1]<be[0]||H<be[1])return!1;ae=be[1]}return!0},D.prototype._validateContent=function(F,H){return!(F&&(4!==F.length||F[0]<0||H.data.width<F[0]||F[1]<0||H.data.height<F[1]||F[2]<0||H.data.width<F[2]||F[3]<0||H.data.height<F[3]||F[2]<F[0]||F[3]<F[1]))},D.prototype.updateImage=function(F,H){H.version=this.images[F].version+1,this.images[F]=H,this.updatedImages[F]=!0},D.prototype.removeImage=function(F){var H=this.images[F];delete this.images[F],delete this.patterns[F],H.userImage&&H.userImage.onRemove&&H.userImage.onRemove()},D.prototype.listImages=function(){return Object.keys(this.images)},D.prototype.getImages=function(F,H){var ae=!0;if(!this.isLoaded())for(var ue=0,me=F;ue<me.length;ue+=1)this.images[me[ue]]||(ae=!1);this.isLoaded()||ae?this._notify(F,H):this.requestors.push({ids:F,callback:H})},D.prototype._notify=function(F,H){for(var ae={},ue=0,me=F;ue<me.length;ue+=1){var be=me[ue];this.images[be]||this.fire(new e.Event("styleimagemissing",{id:be}));var Le=this.images[be];Le?ae[be]={data:Le.data.clone(),pixelRatio:Le.pixelRatio,sdf:Le.sdf,version:Le.version,stretchX:Le.stretchX,stretchY:Le.stretchY,content:Le.content,hasRenderCallback:Boolean(Le.userImage&&Le.userImage.render)}:e.warnOnce('Image "'+be+'" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.')}H(null,ae)},D.prototype.getPixelSize=function(){var F=this.atlasImage;return{width:F.width,height:F.height}},D.prototype.getPattern=function(F){var H=this.patterns[F],ae=this.getImage(F);if(!ae)return null;if(H&&H.position.version===ae.version)return H.position;if(H)H.position.version=ae.version;else{var ue={w:ae.data.width+2,h:ae.data.height+2,x:0,y:0},me=new e.ImagePosition(ue,ae);this.patterns[F]={bin:ue,position:me}}return this._updatePatternAtlas(),this.patterns[F].position},D.prototype.bind=function(F){var H=F.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new e.Texture(F,this.atlasImage,H.RGBA),this.atlasTexture.bind(H.LINEAR,H.CLAMP_TO_EDGE)},D.prototype._updatePatternAtlas=function(){var F=[];for(var H in this.patterns)F.push(this.patterns[H].bin);var ae=e.potpack(F),ue=ae.w,me=ae.h,be=this.atlasImage;for(var Le in be.resize({width:ue||1,height:me||1}),this.patterns){var qe=this.patterns[Le].bin,Qe=qe.x+1,at=qe.y+1,_t=this.images[Le].data,Et=_t.width,Tt=_t.height;e.RGBAImage.copy(_t,be,{x:0,y:0},{x:Qe,y:at},{width:Et,height:Tt}),e.RGBAImage.copy(_t,be,{x:0,y:Tt-1},{x:Qe,y:at-1},{width:Et,height:1}),e.RGBAImage.copy(_t,be,{x:0,y:0},{x:Qe,y:at+Tt},{width:Et,height:1}),e.RGBAImage.copy(_t,be,{x:Et-1,y:0},{x:Qe-1,y:at},{width:1,height:Tt}),e.RGBAImage.copy(_t,be,{x:0,y:0},{x:Qe+Et,y:at},{width:1,height:Tt})}this.dirty=!0},D.prototype.beginFrame=function(){this.callbackDispatchedThisFrame={}},D.prototype.dispatchRenderCallbacks=function(F){for(var H=0,ae=F;H<ae.length;H+=1){var ue=ae[H];if(!this.callbackDispatchedThisFrame[ue]){this.callbackDispatchedThisFrame[ue]=!0;var me=this.images[ue];h(me)&&this.updateImage(ue,me)}}},D}(e.Evented),o=T,b=T,l=1e20;function T(C,D,F,H,ae,ue){this.fontSize=C||24,this.buffer=void 0===D?3:D,this.cutoff=H||.25,this.fontFamily=ae||"sans-serif",this.fontWeight=ue||"normal",this.radius=F||8;var me=this.size=this.fontSize+2*this.buffer;this.canvas=document.createElement("canvas"),this.canvas.width=this.canvas.height=me,this.ctx=this.canvas.getContext("2d"),this.ctx.font=this.fontWeight+" "+this.fontSize+"px "+this.fontFamily,this.ctx.textBaseline="middle",this.ctx.fillStyle="black",this.gridOuter=new Float64Array(me*me),this.gridInner=new Float64Array(me*me),this.f=new Float64Array(me),this.d=new Float64Array(me),this.z=new Float64Array(me+1),this.v=new Int16Array(me),this.middle=Math.round(me/2*(navigator.userAgent.indexOf("Gecko/")>=0?1.2:1))}function _(C,D,F,H,ae,ue,me){for(var be=0;be<D;be++){for(var Le=0;Le<F;Le++)H[Le]=C[Le*D+be];for(w(H,ae,ue,me,F),Le=0;Le<F;Le++)C[Le*D+be]=ae[Le]}for(Le=0;Le<F;Le++){for(be=0;be<D;be++)H[be]=C[Le*D+be];for(w(H,ae,ue,me,D),be=0;be<D;be++)C[Le*D+be]=Math.sqrt(ae[be])}}function w(C,D,F,H,ae){F[0]=0,H[0]=-l,H[1]=+l;for(var ue=1,me=0;ue<ae;ue++){for(var be=(C[ue]+ue*ue-(C[F[me]]+F[me]*F[me]))/(2*ue-2*F[me]);be<=H[me];)me--,be=(C[ue]+ue*ue-(C[F[me]]+F[me]*F[me]))/(2*ue-2*F[me]);F[++me]=ue,H[me]=be,H[me+1]=+l}for(ue=0,me=0;ue<ae;ue++){for(;H[me+1]<ue;)me++;D[ue]=(ue-F[me])*(ue-F[me])+C[F[me]]}}T.prototype.draw=function(C){this.ctx.clearRect(0,0,this.size,this.size),this.ctx.fillText(C,this.buffer,this.middle);for(var D=this.ctx.getImageData(0,0,this.size,this.size),F=new Uint8ClampedArray(this.size*this.size),H=0;H<this.size*this.size;H++){var ae=D.data[4*H+3]/255;this.gridOuter[H]=1===ae?0:0===ae?l:Math.pow(Math.max(0,.5-ae),2),this.gridInner[H]=1===ae?l:0===ae?0:Math.pow(Math.max(0,ae-.5),2)}for(_(this.gridOuter,this.size,this.size,this.f,this.d,this.v,this.z),_(this.gridInner,this.size,this.size,this.f,this.d,this.v,this.z),H=0;H<this.size*this.size;H++)F[H]=Math.max(0,Math.min(255,Math.round(255-255*((this.gridOuter[H]-this.gridInner[H])/this.radius+this.cutoff))));return F},o.default=b;var k=function(C,D){this.requestManager=C,this.localIdeographFontFamily=D,this.entries={}};k.prototype.setURL=function(C){this.url=C},k.prototype.getGlyphs=function(C,D){var F=this,H=[];for(var ae in C)for(var ue=0,me=C[ae];ue<me.length;ue+=1)H.push({stack:ae,id:me[ue]});e.asyncAll(H,function(Le,qe){var Qe=Le.stack,at=Le.id,_t=F.entries[Qe];_t||(_t=F.entries[Qe]={glyphs:{},requests:{},ranges:{}});var Et=_t.glyphs[at];if(void 0===Et){if(Et=F._tinySDF(_t,Qe,at))return _t.glyphs[at]=Et,void qe(null,{stack:Qe,id:at,glyph:Et});var Tt=Math.floor(at/256);if(256*Tt>65535)qe(new Error("glyphs > 65535 not supported"));else if(_t.ranges[Tt])qe(null,{stack:Qe,id:at,glyph:Et});else{var Mt=_t.requests[Tt];Mt||(Mt=_t.requests[Tt]=[],k.loadGlyphRange(Qe,Tt,F.url,F.requestManager,function(bt,Dt){if(Dt){for(var It in Dt)F._doesCharSupportLocalGlyph(+It)||(_t.glyphs[+It]=Dt[+It]);_t.ranges[Tt]=!0}for(var Nt=0,nr=Mt;Nt<nr.length;Nt+=1)(0,nr[Nt])(bt,Dt);delete _t.requests[Tt]})),Mt.push(function(bt,Dt){bt?qe(bt):Dt&&qe(null,{stack:Qe,id:at,glyph:Dt[at]||null})})}}else qe(null,{stack:Qe,id:at,glyph:Et})},function(Le,qe){if(Le)D(Le);else if(qe){for(var Qe={},at=0,_t=qe;at<_t.length;at+=1){var Et=_t[at],Tt=Et.stack,Mt=Et.id,bt=Et.glyph;(Qe[Tt]||(Qe[Tt]={}))[Mt]=bt&&{id:bt.id,bitmap:bt.bitmap.clone(),metrics:bt.metrics}}D(null,Qe)}})},k.prototype._doesCharSupportLocalGlyph=function(C){return!!this.localIdeographFontFamily&&(e.isChar["CJK Unified Ideographs"](C)||e.isChar["Hangul Syllables"](C)||e.isChar.Hiragana(C)||e.isChar.Katakana(C))},k.prototype._tinySDF=function(C,D,F){var H=this.localIdeographFontFamily;if(H&&this._doesCharSupportLocalGlyph(F)){var ae=C.tinySDF;if(!ae){var ue="400";/bold/i.test(D)?ue="900":/medium/i.test(D)?ue="500":/light/i.test(D)&&(ue="200"),ae=C.tinySDF=new k.TinySDF(24,3,8,.25,H,ue)}return{id:F,bitmap:new e.AlphaImage({width:30,height:30},ae.draw(String.fromCharCode(F))),metrics:{width:24,height:24,left:0,top:-8,advance:24}}}},k.loadGlyphRange=function(C,D,F,H,ae){var ue=256*D,me=ue+255,be=H.transformRequest(H.normalizeGlyphsURL(F).replace("{fontstack}",C).replace("{range}",ue+"-"+me),e.ResourceType.Glyphs);e.getArrayBuffer(be,function(Le,qe){if(Le)ae(Le);else if(qe){for(var Qe={},at=0,_t=e.parseGlyphPBF(qe);at<_t.length;at+=1){var Et=_t[at];Qe[Et.id]=Et}ae(null,Qe)}})},k.TinySDF=o;var L=function(){this.specification=e.styleSpec.light.position};L.prototype.possiblyEvaluate=function(C,D){return e.sphericalToCartesian(C.expression.evaluate(D))},L.prototype.interpolate=function(C,D,F){return{x:e.number(C.x,D.x,F),y:e.number(C.y,D.y,F),z:e.number(C.z,D.z,F)}};var M=new e.Properties({anchor:new e.DataConstantProperty(e.styleSpec.light.anchor),position:new L,color:new e.DataConstantProperty(e.styleSpec.light.color),intensity:new e.DataConstantProperty(e.styleSpec.light.intensity)}),I=function(C){function D(F){C.call(this),this._transitionable=new e.Transitionable(M),this.setLight(F),this._transitioning=this._transitionable.untransitioned()}return C&&(D.__proto__=C),(D.prototype=Object.create(C&&C.prototype)).constructor=D,D.prototype.getLight=function(){return this._transitionable.serialize()},D.prototype.setLight=function(F,H){if(void 0===H&&(H={}),!this._validate(e.validateLight,F,H))for(var ae in F){var ue=F[ae];e.endsWith(ae,"-transition")?this._transitionable.setTransition(ae.slice(0,-11),ue):this._transitionable.setValue(ae,ue)}},D.prototype.updateTransitions=function(F){this._transitioning=this._transitionable.transitioned(F,this._transitioning)},D.prototype.hasTransition=function(){return this._transitioning.hasTransition()},D.prototype.recalculate=function(F){this.properties=this._transitioning.possiblyEvaluate(F)},D.prototype._validate=function(F,H,ae){return(!ae||!1!==ae.validate)&&e.emitValidationErrors(this,F.call(e.validateStyle,e.extend({value:H,style:{glyphs:!0,sprite:!0},styleSpec:e.styleSpec})))},D}(e.Evented),P=function(C,D){this.width=C,this.height=D,this.nextRow=0,this.data=new Uint8Array(this.width*this.height),this.dashEntry={}};P.prototype.getDash=function(C,D){var F=C.join(",")+String(D);return this.dashEntry[F]||(this.dashEntry[F]=this.addDash(C,D)),this.dashEntry[F]},P.prototype.getDashRanges=function(C,D,F){var H=[],ae=C.length%2==1?-C[C.length-1]*F:0,ue=C[0]*F,me=!0;H.push({left:ae,right:ue,isDash:me,zeroLength:0===C[0]});for(var be=C[0],Le=1;Le<C.length;Le++){var qe=C[Le];ae=be*F,ue=(be+=qe)*F,H.push({left:ae,right:ue,isDash:me=!me,zeroLength:0===qe})}return H},P.prototype.addRoundDash=function(C,D,F){for(var H=D/2,ae=-F;ae<=F;ae++)for(var me=this.width*(this.nextRow+F+ae),be=0,Le=C[be],qe=0;qe<this.width;qe++){qe/Le.right>1&&(Le=C[++be]);var Qe=Math.abs(qe-Le.left),at=Math.abs(qe-Le.right),_t=Math.min(Qe,at),Et=void 0,Tt=ae/F*(H+1);if(Le.isDash){var Mt=H-Math.abs(Tt);Et=Math.sqrt(_t*_t+Mt*Mt)}else Et=H-Math.sqrt(_t*_t+Tt*Tt);this.data[me+qe]=Math.max(0,Math.min(255,Et+128))}},P.prototype.addRegularDash=function(C){for(var D=C.length-1;D>=0;--D){var F=C[D],H=C[D+1];F.zeroLength?C.splice(D,1):H&&H.isDash===F.isDash&&(H.left=F.left,C.splice(D,1))}var ae=C[0],ue=C[C.length-1];ae.isDash===ue.isDash&&(ae.left=ue.left-this.width,ue.right=ae.right+this.width);for(var me=this.width*this.nextRow,be=0,Le=C[be],qe=0;qe<this.width;qe++){qe/Le.right>1&&(Le=C[++be]);var Qe=Math.abs(qe-Le.left),at=Math.abs(qe-Le.right),_t=Math.min(Qe,at);this.data[me+qe]=Math.max(0,Math.min(255,(Le.isDash?_t:-_t)+128))}},P.prototype.addDash=function(C,D){var F=D?7:0,H=2*F+1;if(this.nextRow+H>this.height)return e.warnOnce("LineAtlas out of space"),null;for(var ae=0,ue=0;ue<C.length;ue++)ae+=C[ue];if(0!==ae){var me=this.width/ae,be=this.getDashRanges(C,this.width,me);D?this.addRoundDash(be,me,F):this.addRegularDash(be)}var Le={y:(this.nextRow+F+.5)/this.height,height:2*F/this.height,width:ae};return this.nextRow+=H,this.dirty=!0,Le},P.prototype.bind=function(C){var D=C.gl;this.texture?(D.bindTexture(D.TEXTURE_2D,this.texture),this.dirty&&(this.dirty=!1,D.texSubImage2D(D.TEXTURE_2D,0,0,0,this.width,this.height,D.ALPHA,D.UNSIGNED_BYTE,this.data))):(this.texture=D.createTexture(),D.bindTexture(D.TEXTURE_2D,this.texture),D.texParameteri(D.TEXTURE_2D,D.TEXTURE_WRAP_S,D.REPEAT),D.texParameteri(D.TEXTURE_2D,D.TEXTURE_WRAP_T,D.REPEAT),D.texParameteri(D.TEXTURE_2D,D.TEXTURE_MIN_FILTER,D.LINEAR),D.texParameteri(D.TEXTURE_2D,D.TEXTURE_MAG_FILTER,D.LINEAR),D.texImage2D(D.TEXTURE_2D,0,D.ALPHA,this.width,this.height,0,D.ALPHA,D.UNSIGNED_BYTE,this.data))};var S=function C(D,F){this.workerPool=D,this.actors=[],this.currentActor=0,this.id=e.uniqueId();for(var H=this.workerPool.acquire(this.id),ae=0;ae<H.length;ae++){var me=new C.Actor(H[ae],F,this.id);me.name="Worker "+ae,this.actors.push(me)}};function E(C,D,F){var H=function(ae,ue){if(ae)return F(ae);if(ue){var me=e.pick(e.extend(ue,C),["tiles","minzoom","maxzoom","attribution","mapbox_logo","bounds","scheme","tileSize","encoding"]);ue.vector_layers&&(me.vectorLayers=ue.vector_layers,me.vectorLayerIds=me.vectorLayers.map(function(be){return be.id})),me.tiles=D.canonicalizeTileset(me,C.url),F(null,me)}};return C.url?e.getJSON(D.transformRequest(D.normalizeSourceURL(C.url),e.ResourceType.Source),H):e.browser.frame(function(){return H(null,C)})}S.prototype.broadcast=function(C,D,F){e.asyncAll(this.actors,function(H,ae){H.send(C,D,ae)},F=F||function(){})},S.prototype.getActor=function(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]},S.prototype.remove=function(){this.actors.forEach(function(C){C.remove()}),this.actors=[],this.workerPool.release(this.id)},S.Actor=e.Actor;var z=function(C,D,F){this.bounds=e.LngLatBounds.convert(this.validateBounds(C)),this.minzoom=D||0,this.maxzoom=F||24};z.prototype.validateBounds=function(C){return Array.isArray(C)&&4===C.length?[Math.max(-180,C[0]),Math.max(-90,C[1]),Math.min(180,C[2]),Math.min(90,C[3])]:[-180,-90,180,90]},z.prototype.contains=function(C){var D=Math.pow(2,C.z),F=Math.floor(e.mercatorXfromLng(this.bounds.getWest())*D),H=Math.floor(e.mercatorYfromLat(this.bounds.getNorth())*D),ae=Math.ceil(e.mercatorXfromLng(this.bounds.getEast())*D),ue=Math.ceil(e.mercatorYfromLat(this.bounds.getSouth())*D);return C.x>=F&&C.x<ae&&C.y>=H&&C.y<ue};var R=function(C){function D(F,H,ae,ue){if(C.call(this),this.id=F,this.dispatcher=ae,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,e.extend(this,e.pick(H,["url","scheme","tileSize","promoteId"])),this._options=e.extend({type:"vector"},H),this._collectResourceTiming=H.collectResourceTiming,512!==this.tileSize)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(ue)}return C&&(D.__proto__=C),(D.prototype=Object.create(C&&C.prototype)).constructor=D,D.prototype.load=function(){var F=this;this._loaded=!1,this.fire(new e.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=E(this._options,this.map._requestManager,function(H,ae){F._tileJSONRequest=null,F._loaded=!0,H?F.fire(new e.ErrorEvent(H)):ae&&(e.extend(F,ae),ae.bounds&&(F.tileBounds=new z(ae.bounds,F.minzoom,F.maxzoom)),e.postTurnstileEvent(ae.tiles,F.map._requestManager._customAccessToken),e.postMapLoadEvent(ae.tiles,F.map._getMapId(),F.map._requestManager._skuToken,F.map._requestManager._customAccessToken),F.fire(new e.Event("data",{dataType:"source",sourceDataType:"metadata"})),F.fire(new e.Event("data",{dataType:"source",sourceDataType:"content"})))})},D.prototype.loaded=function(){return this._loaded},D.prototype.hasTile=function(F){return!this.tileBounds||this.tileBounds.contains(F.canonical)},D.prototype.onAdd=function(F){this.map=F,this.load()},D.prototype.onRemove=function(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)},D.prototype.serialize=function(){return e.extend({},this._options)},D.prototype.loadTile=function(F,H){var ae=this.map._requestManager.normalizeTileURL(F.tileID.canonical.url(this.tiles,this.scheme)),ue={request:this.map._requestManager.transformRequest(ae,e.ResourceType.Tile),uid:F.uid,tileID:F.tileID,zoom:F.tileID.overscaledZ,tileSize:this.tileSize*F.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:e.browser.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};function me(be,Le){return delete F.request,F.aborted?H(null):be&&404!==be.status?H(be):(Le&&Le.resourceTiming&&(F.resourceTiming=Le.resourceTiming),this.map._refreshExpiredTiles&&Le&&F.setExpiryData(Le),F.loadVectorData(Le,this.map.painter),e.cacheEntryPossiblyAdded(this.dispatcher),H(null),void(F.reloadCallback&&(this.loadTile(F,F.reloadCallback),F.reloadCallback=null)))}ue.request.collectResourceTiming=this._collectResourceTiming,F.actor&&"expired"!==F.state?"loading"===F.state?F.reloadCallback=H:F.request=F.actor.send("reloadTile",ue,me.bind(this)):(F.actor=this.dispatcher.getActor(),F.request=F.actor.send("loadTile",ue,me.bind(this)))},D.prototype.abortTile=function(F){F.request&&(F.request.cancel(),delete F.request),F.actor&&F.actor.send("abortTile",{uid:F.uid,type:this.type,source:this.id},void 0)},D.prototype.unloadTile=function(F){F.unloadVectorData(),F.actor&&F.actor.send("removeTile",{uid:F.uid,type:this.type,source:this.id},void 0)},D.prototype.hasTransition=function(){return!1},D}(e.Evented),q=function(C){function D(F,H,ae,ue){C.call(this),this.id=F,this.dispatcher=ae,this.setEventedParent(ue),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=e.extend({type:"raster"},H),e.extend(this,e.pick(H,["url","scheme","tileSize"]))}return C&&(D.__proto__=C),(D.prototype=Object.create(C&&C.prototype)).constructor=D,D.prototype.load=function(){var F=this;this._loaded=!1,this.fire(new e.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=E(this._options,this.map._requestManager,function(H,ae){F._tileJSONRequest=null,F._loaded=!0,H?F.fire(new e.ErrorEvent(H)):ae&&(e.extend(F,ae),ae.bounds&&(F.tileBounds=new z(ae.bounds,F.minzoom,F.maxzoom)),e.postTurnstileEvent(ae.tiles),e.postMapLoadEvent(ae.tiles,F.map._getMapId(),F.map._requestManager._skuToken),F.fire(new e.Event("data",{dataType:"source",sourceDataType:"metadata"})),F.fire(new e.Event("data",{dataType:"source",sourceDataType:"content"})))})},D.prototype.loaded=function(){return this._loaded},D.prototype.onAdd=function(F){this.map=F,this.load()},D.prototype.onRemove=function(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)},D.prototype.serialize=function(){return e.extend({},this._options)},D.prototype.hasTile=function(F){return!this.tileBounds||this.tileBounds.contains(F.canonical)},D.prototype.loadTile=function(F,H){var ae=this,ue=this.map._requestManager.normalizeTileURL(F.tileID.canonical.url(this.tiles,this.scheme),this.tileSize);F.request=e.getImage(this.map._requestManager.transformRequest(ue,e.ResourceType.Tile),function(me,be){if(delete F.request,F.aborted)F.state="unloaded",H(null);else if(me)F.state="errored",H(me);else if(be){ae.map._refreshExpiredTiles&&F.setExpiryData(be),delete be.cacheControl,delete be.expires;var Le=ae.map.painter.context,qe=Le.gl;F.texture=ae.map.painter.getTileTexture(be.width),F.texture?F.texture.update(be,{useMipmap:!0}):(F.texture=new e.Texture(Le,be,qe.RGBA,{useMipmap:!0}),F.texture.bind(qe.LINEAR,qe.CLAMP_TO_EDGE,qe.LINEAR_MIPMAP_NEAREST),Le.extTextureFilterAnisotropic&&qe.texParameterf(qe.TEXTURE_2D,Le.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,Le.extTextureFilterAnisotropicMax)),F.state="loaded",e.cacheEntryPossiblyAdded(ae.dispatcher),H(null)}})},D.prototype.abortTile=function(F,H){F.request&&(F.request.cancel(),delete F.request),H()},D.prototype.unloadTile=function(F,H){F.texture&&this.map.painter.saveTileTexture(F.texture),H()},D.prototype.hasTransition=function(){return!1},D}(e.Evented),V=function(C){function D(F,H,ae,ue){C.call(this,F,H,ae,ue),this.type="raster-dem",this.maxzoom=22,this._options=e.extend({type:"raster-dem"},H),this.encoding=H.encoding||"mapbox"}return C&&(D.__proto__=C),(D.prototype=Object.create(C&&C.prototype)).constructor=D,D.prototype.serialize=function(){return{type:"raster-dem",url:this.url,tileSize:this.tileSize,tiles:this.tiles,bounds:this.bounds,encoding:this.encoding}},D.prototype.loadTile=function(F,H){var ae=this.map._requestManager.normalizeTileURL(F.tileID.canonical.url(this.tiles,this.scheme),this.tileSize);function ue(me,be){me&&(F.state="errored",H(me)),be&&(F.dem=be,F.needsHillshadePrepare=!0,F.state="loaded",H(null))}F.request=e.getImage(this.map._requestManager.transformRequest(ae,e.ResourceType.Tile),function(me,be){if(delete F.request,F.aborted)F.state="unloaded",H(null);else if(me)F.state="errored",H(me);else if(be){this.map._refreshExpiredTiles&&F.setExpiryData(be),delete be.cacheControl,delete be.expires;var Le=e.window.ImageBitmap&&be instanceof e.window.ImageBitmap&&e.offscreenCanvasSupported()?be:e.browser.getImageData(be,1),qe={uid:F.uid,coord:F.tileID,source:this.id,rawImageData:Le,encoding:this.encoding};F.actor&&"expired"!==F.state||(F.actor=this.dispatcher.getActor(),F.actor.send("loadDEMTile",qe,ue.bind(this)))}}.bind(this)),F.neighboringTiles=this._getNeighboringTiles(F.tileID)},D.prototype._getNeighboringTiles=function(F){var H=F.canonical,ae=Math.pow(2,H.z),ue=(H.x-1+ae)%ae,me=0===H.x?F.wrap-1:F.wrap,be=(H.x+1+ae)%ae,Le=H.x+1===ae?F.wrap+1:F.wrap,qe={};return qe[new e.OverscaledTileID(F.overscaledZ,me,H.z,ue,H.y).key]={backfilled:!1},qe[new e.OverscaledTileID(F.overscaledZ,Le,H.z,be,H.y).key]={backfilled:!1},H.y>0&&(qe[new e.OverscaledTileID(F.overscaledZ,me,H.z,ue,H.y-1).key]={backfilled:!1},qe[new e.OverscaledTileID(F.overscaledZ,F.wrap,H.z,H.x,H.y-1).key]={backfilled:!1},qe[new e.OverscaledTileID(F.overscaledZ,Le,H.z,be,H.y-1).key]={backfilled:!1}),H.y+1<ae&&(qe[new e.OverscaledTileID(F.overscaledZ,me,H.z,ue,H.y+1).key]={backfilled:!1},qe[new e.OverscaledTileID(F.overscaledZ,F.wrap,H.z,H.x,H.y+1).key]={backfilled:!1},qe[new e.OverscaledTileID(F.overscaledZ,Le,H.z,be,H.y+1).key]={backfilled:!1}),qe},D.prototype.unloadTile=function(F){F.demTexture&&this.map.painter.saveTileTexture(F.demTexture),F.fbo&&(F.fbo.destroy(),delete F.fbo),F.dem&&delete F.dem,delete F.neighboringTiles,F.state="unloaded",F.actor&&F.actor.send("removeDEMTile",{uid:F.uid,source:this.id})},D}(q),W=function(C){function D(F,H,ae,ue){C.call(this),this.id=F,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._removed=!1,this._loaded=!1,this.actor=ae.getActor(),this.setEventedParent(ue),this._data=H.data,this._options=e.extend({},H),this._collectResourceTiming=H.collectResourceTiming,this._resourceTiming=[],void 0!==H.maxzoom&&(this.maxzoom=H.maxzoom),H.type&&(this.type=H.type),H.attribution&&(this.attribution=H.attribution),this.promoteId=H.promoteId;var me=e.EXTENT/this.tileSize;this.workerOptions=e.extend({source:this.id,cluster:H.cluster||!1,geojsonVtOptions:{buffer:(void 0!==H.buffer?H.buffer:128)*me,tolerance:(void 0!==H.tolerance?H.tolerance:.375)*me,extent:e.EXTENT,maxZoom:this.maxzoom,lineMetrics:H.lineMetrics||!1,generateId:H.generateId||!1},superclusterOptions:{maxZoom:void 0!==H.clusterMaxZoom?Math.min(H.clusterMaxZoom,this.maxzoom-1):this.maxzoom-1,extent:e.EXTENT,radius:(H.clusterRadius||50)*me,log:!1,generateId:H.generateId||!1},clusterProperties:H.clusterProperties},H.workerOptions)}return C&&(D.__proto__=C),(D.prototype=Object.create(C&&C.prototype)).constructor=D,D.prototype.load=function(){var F=this;this.fire(new e.Event("dataloading",{dataType:"source"})),this._updateWorkerData(function(H){if(H)F.fire(new e.ErrorEvent(H));else{var ae={dataType:"source",sourceDataType:"metadata"};F._collectResourceTiming&&F._resourceTiming&&F._resourceTiming.length>0&&(ae.resourceTiming=F._resourceTiming,F._resourceTiming=[]),F.fire(new e.Event("data",ae))}})},D.prototype.onAdd=function(F){this.map=F,this.load()},D.prototype.setData=function(F){var H=this;return this._data=F,this.fire(new e.Event("dataloading",{dataType:"source"})),this._updateWorkerData(function(ae){if(ae)H.fire(new e.ErrorEvent(ae));else{var ue={dataType:"source",sourceDataType:"content"};H._collectResourceTiming&&H._resourceTiming&&H._resourceTiming.length>0&&(ue.resourceTiming=H._resourceTiming,H._resourceTiming=[]),H.fire(new e.Event("data",ue))}}),this},D.prototype.getClusterExpansionZoom=function(F,H){return this.actor.send("geojson.getClusterExpansionZoom",{clusterId:F,source:this.id},H),this},D.prototype.getClusterChildren=function(F,H){return this.actor.send("geojson.getClusterChildren",{clusterId:F,source:this.id},H),this},D.prototype.getClusterLeaves=function(F,H,ae,ue){return this.actor.send("geojson.getClusterLeaves",{source:this.id,clusterId:F,limit:H,offset:ae},ue),this},D.prototype._updateWorkerData=function(F){var H=this;this._loaded=!1;var ae=e.extend({},this.workerOptions),ue=this._data;"string"==typeof ue?(ae.request=this.map._requestManager.transformRequest(e.browser.resolveURL(ue),e.ResourceType.Source),ae.request.collectResourceTiming=this._collectResourceTiming):ae.data=JSON.stringify(ue),this.actor.send(this.type+".loadData",ae,function(me,be){H._removed||be&&be.abandoned||(H._loaded=!0,be&&be.resourceTiming&&be.resourceTiming[H.id]&&(H._resourceTiming=be.resourceTiming[H.id].slice(0)),H.actor.send(H.type+".coalesce",{source:ae.source},null),F(me))})},D.prototype.loaded=function(){return this._loaded},D.prototype.loadTile=function(F,H){var ae=this,ue=F.actor?"reloadTile":"loadTile";F.actor=this.actor,F.request=this.actor.send(ue,{type:this.type,uid:F.uid,tileID:F.tileID,zoom:F.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:e.browser.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId},function(be,Le){return delete F.request,F.unloadVectorData(),F.aborted?H(null):be?H(be):(F.loadVectorData(Le,ae.map.painter,"reloadTile"===ue),H(null))})},D.prototype.abortTile=function(F){F.request&&(F.request.cancel(),delete F.request),F.aborted=!0},D.prototype.unloadTile=function(F){F.unloadVectorData(),this.actor.send("removeTile",{uid:F.uid,type:this.type,source:this.id})},D.prototype.onRemove=function(){this._removed=!0,this.actor.send("removeSource",{type:this.type,source:this.id})},D.prototype.serialize=function(){return e.extend({},this._options,{type:this.type,data:this._data})},D.prototype.hasTransition=function(){return!1},D}(e.Evented),K=e.createLayout([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]),G=function(C){function D(F,H,ae,ue){C.call(this),this.id=F,this.dispatcher=ae,this.coordinates=H.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(ue),this.options=H}return C&&(D.__proto__=C),(D.prototype=Object.create(C&&C.prototype)).constructor=D,D.prototype.load=function(F,H){var ae=this;this._loaded=!1,this.fire(new e.Event("dataloading",{dataType:"source"})),this.url=this.options.url,e.getImage(this.map._requestManager.transformRequest(this.url,e.ResourceType.Image),function(ue,me){ae._loaded=!0,ue?ae.fire(new e.ErrorEvent(ue)):me&&(ae.image=me,F&&(ae.coordinates=F),H&&H(),ae._finishLoading())})},D.prototype.loaded=function(){return this._loaded},D.prototype.updateImage=function(F){var H=this;return this.image&&F.url?(this.options.url=F.url,this.load(F.coordinates,function(){H.texture=null}),this):this},D.prototype._finishLoading=function(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new e.Event("data",{dataType:"source",sourceDataType:"metadata"})))},D.prototype.onAdd=function(F){this.map=F,this.load()},D.prototype.setCoordinates=function(F){var H=this;this.coordinates=F;var ae=F.map(e.MercatorCoordinate.fromLngLat);this.tileID=function(me){for(var be=1/0,Le=1/0,qe=-1/0,Qe=-1/0,at=0,_t=me;at<_t.length;at+=1){var Et=_t[at];be=Math.min(be,Et.x),Le=Math.min(Le,Et.y),qe=Math.max(qe,Et.x),Qe=Math.max(Qe,Et.y)}var bt=Math.max(qe-be,Qe-Le),Dt=Math.max(0,Math.floor(-Math.log(bt)/Math.LN2)),It=Math.pow(2,Dt);return new e.CanonicalTileID(Dt,Math.floor((be+qe)/2*It),Math.floor((Le+Qe)/2*It))}(ae),this.minzoom=this.maxzoom=this.tileID.z;var ue=ae.map(function(me){return H.tileID.getTilePoint(me)._round()});return this._boundsArray=new e.StructArrayLayout4i8,this._boundsArray.emplaceBack(ue[0].x,ue[0].y,0,0),this._boundsArray.emplaceBack(ue[1].x,ue[1].y,e.EXTENT,0),this._boundsArray.emplaceBack(ue[3].x,ue[3].y,0,e.EXTENT),this._boundsArray.emplaceBack(ue[2].x,ue[2].y,e.EXTENT,e.EXTENT),this.boundsBuffer&&(this.boundsBuffer.destroy(),delete this.boundsBuffer),this.fire(new e.Event("data",{dataType:"source",sourceDataType:"content"})),this},D.prototype.prepare=function(){if(0!==Object.keys(this.tiles).length&&this.image){var F=this.map.painter.context,H=F.gl;for(var ae in this.boundsBuffer||(this.boundsBuffer=F.createVertexBuffer(this._boundsArray,K.members)),this.boundsSegments||(this.boundsSegments=e.SegmentVector.simpleSegment(0,0,4,2)),this.texture||(this.texture=new e.Texture(F,this.image,H.RGBA),this.texture.bind(H.LINEAR,H.CLAMP_TO_EDGE)),this.tiles){var ue=this.tiles[ae];"loaded"!==ue.state&&(ue.state="loaded",ue.texture=this.texture)}}},D.prototype.loadTile=function(F,H){this.tileID&&this.tileID.equals(F.tileID.canonical)?(this.tiles[String(F.tileID.wrap)]=F,F.buckets={},H(null)):(F.state="errored",H(null))},D.prototype.serialize=function(){return{type:"image",url:this.options.url,coordinates:this.coordinates}},D.prototype.hasTransition=function(){return!1},D}(e.Evented),Y=function(C){function D(F,H,ae,ue){C.call(this,F,H,ae,ue),this.roundZoom=!0,this.type="video",this.options=H}return C&&(D.__proto__=C),(D.prototype=Object.create(C&&C.prototype)).constructor=D,D.prototype.load=function(){var F=this;this._loaded=!1;var H=this.options;this.urls=[];for(var ae=0,ue=H.urls;ae<ue.length;ae+=1)this.urls.push(this.map._requestManager.transformRequest(ue[ae],e.ResourceType.Source).url);e.getVideo(this.urls,function(be,Le){F._loaded=!0,be?F.fire(new e.ErrorEvent(be)):Le&&(F.video=Le,F.video.loop=!0,F.video.addEventListener("playing",function(){F.map.triggerRepaint()}),F.map&&F.video.play(),F._finishLoading())})},D.prototype.pause=function(){this.video&&this.video.pause()},D.prototype.play=function(){this.video&&this.video.play()},D.prototype.seek=function(F){if(this.video){var H=this.video.seekable;F<H.start(0)||F>H.end(0)?this.fire(new e.ErrorEvent(new e.ValidationError("sources."+this.id,null,"Playback for this video can be set only between the "+H.start(0)+" and "+H.end(0)+"-second mark."))):this.video.currentTime=F}},D.prototype.getVideo=function(){return this.video},D.prototype.onAdd=function(F){this.map||(this.map=F,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))},D.prototype.prepare=function(){if(!(0===Object.keys(this.tiles).length||this.video.readyState<2)){var F=this.map.painter.context,H=F.gl;for(var ae in this.boundsBuffer||(this.boundsBuffer=F.createVertexBuffer(this._boundsArray,K.members)),this.boundsSegments||(this.boundsSegments=e.SegmentVector.simpleSegment(0,0,4,2)),this.texture?this.video.paused||(this.texture.bind(H.LINEAR,H.CLAMP_TO_EDGE),H.texSubImage2D(H.TEXTURE_2D,0,0,0,H.RGBA,H.UNSIGNED_BYTE,this.video)):(this.texture=new e.Texture(F,this.video,H.RGBA),this.texture.bind(H.LINEAR,H.CLAMP_TO_EDGE)),this.tiles){var ue=this.tiles[ae];"loaded"!==ue.state&&(ue.state="loaded",ue.texture=this.texture)}}},D.prototype.serialize=function(){return{type:"video",urls:this.urls,coordinates:this.coordinates}},D.prototype.hasTransition=function(){return this.video&&!this.video.paused},D}(G),$=function(C){function D(F,H,ae,ue){C.call(this,F,H,ae,ue),H.coordinates?Array.isArray(H.coordinates)&&4===H.coordinates.length&&!H.coordinates.some(function(me){return!Array.isArray(me)||2!==me.length||me.some(function(be){return"number"!=typeof be})})||this.fire(new e.ErrorEvent(new e.ValidationError("sources."+F,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new e.ErrorEvent(new e.ValidationError("sources."+F,null,'missing required property "coordinates"'))),H.animate&&"boolean"!=typeof H.animate&&this.fire(new e.ErrorEvent(new e.ValidationError("sources."+F,null,'optional "animate" property must be a boolean value'))),H.canvas?"string"==typeof H.canvas||H.canvas instanceof e.window.HTMLCanvasElement||this.fire(new e.ErrorEvent(new e.ValidationError("sources."+F,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new e.ErrorEvent(new e.ValidationError("sources."+F,null,'missing required property "canvas"'))),this.options=H,this.animate=void 0===H.animate||H.animate}return C&&(D.__proto__=C),(D.prototype=Object.create(C&&C.prototype)).constructor=D,D.prototype.load=function(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof e.window.HTMLCanvasElement?this.options.canvas:e.window.document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new e.ErrorEvent(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())},D.prototype.getCanvas=function(){return this.canvas},D.prototype.onAdd=function(F){this.map=F,this.load(),this.canvas&&this.animate&&this.play()},D.prototype.onRemove=function(){this.pause()},D.prototype.prepare=function(){var F=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,F=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,F=!0),!this._hasInvalidDimensions()&&0!==Object.keys(this.tiles).length){var H=this.map.painter.context,ae=H.gl;for(var ue in this.boundsBuffer||(this.boundsBuffer=H.createVertexBuffer(this._boundsArray,K.members)),this.boundsSegments||(this.boundsSegments=e.SegmentVector.simpleSegment(0,0,4,2)),this.texture?(F||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new e.Texture(H,this.canvas,ae.RGBA,{premultiply:!0}),this.tiles){var me=this.tiles[ue];"loaded"!==me.state&&(me.state="loaded",me.texture=this.texture)}}},D.prototype.serialize=function(){return{type:"canvas",coordinates:this.coordinates}},D.prototype.hasTransition=function(){return this._playing},D.prototype._hasInvalidDimensions=function(){for(var F=0,H=[this.canvas.width,this.canvas.height];F<H.length;F+=1){var ae=H[F];if(isNaN(ae)||ae<=0)return!0}return!1},D}(G),B={vector:R,raster:q,"raster-dem":V,geojson:W,video:Y,image:G,canvas:$};function N(C,D){var F=e.identity([]);return e.translate(F,F,[1,1,0]),e.scale(F,F,[.5*C.width,.5*C.height,1]),e.multiply(F,F,C.calculatePosMatrix(D.toUnwrapped()))}function U(C,D,F,H,ae,ue){var me=function(Mt,bt,Dt){if(Mt)for(var It=0,Nt=Mt;It<Nt.length;It+=1){var nr=bt[Nt[It]];if(nr&&nr.source===Dt&&"fill-extrusion"===nr.type)return!0}else for(var dr in bt){var Sr=bt[dr];if(Sr.source===Dt&&"fill-extrusion"===Sr.type)return!0}return!1}(ae&&ae.layers,D,C.id),be=ue.maxPitchScaleFactor(),Le=C.tilesIn(H,be,me);Le.sort(te);for(var qe=[],Qe=0,at=Le;Qe<at.length;Qe+=1){var _t=at[Qe];qe.push({wrappedTileID:_t.tileID.wrapped().key,queryResults:_t.tile.queryRenderedFeatures(D,F,C._state,_t.queryGeometry,_t.cameraQueryGeometry,_t.scale,ae,ue,be,N(C.transform,_t.tileID))})}var Et=function(Mt){for(var bt={},Dt={},It=0,Nt=Mt;It<Nt.length;It+=1){var nr=Nt[It],dr=nr.queryResults,Sr=nr.wrappedTileID,Ar=Dt[Sr]=Dt[Sr]||{};for(var Kr in dr)for(var Jr=dr[Kr],cn=Ar[Kr]=Ar[Kr]||{},an=bt[Kr]=bt[Kr]||[],jn=0,Wn=Jr;jn<Wn.length;jn+=1){var ui=Wn[jn];cn[ui.featureIndex]||(cn[ui.featureIndex]=!0,an.push(ui))}}return bt}(qe);for(var Tt in Et)Et[Tt].forEach(function(Mt){var bt=Mt.feature,Dt=C.getFeatureState(bt.layer["source-layer"],bt.id);bt.source=bt.layer.source,bt.layer["source-layer"]&&(bt.sourceLayer=bt.layer["source-layer"]),bt.state=Dt});return Et}function te(C,D){var F=C.tileID,H=D.tileID;return F.overscaledZ-H.overscaledZ||F.canonical.y-H.canonical.y||F.wrap-H.wrap||F.canonical.x-H.canonical.x}var j=function(C,D){this.max=C,this.onRemove=D,this.reset()};j.prototype.reset=function(){for(var C in this.data)for(var D=0,F=this.data[C];D<F.length;D+=1){var H=F[D];H.timeout&&clearTimeout(H.timeout),this.onRemove(H.value)}return this.data={},this.order=[],this},j.prototype.add=function(C,D,F){var H=this,ae=C.wrapped().key;void 0===this.data[ae]&&(this.data[ae]=[]);var ue={value:D,timeout:void 0};if(void 0!==F&&(ue.timeout=setTimeout(function(){H.remove(C,ue)},F)),this.data[ae].push(ue),this.order.push(ae),this.order.length>this.max){var me=this._getAndRemoveByKey(this.order[0]);me&&this.onRemove(me)}return this},j.prototype.has=function(C){return C.wrapped().key in this.data},j.prototype.getAndRemove=function(C){return this.has(C)?this._getAndRemoveByKey(C.wrapped().key):null},j.prototype._getAndRemoveByKey=function(C){var D=this.data[C].shift();return D.timeout&&clearTimeout(D.timeout),0===this.data[C].length&&delete this.data[C],this.order.splice(this.order.indexOf(C),1),D.value},j.prototype.getByKey=function(C){var D=this.data[C];return D?D[0].value:null},j.prototype.get=function(C){return this.has(C)?this.data[C.wrapped().key][0].value:null},j.prototype.remove=function(C,D){if(!this.has(C))return this;var F=C.wrapped().key,H=void 0===D?0:this.data[F].indexOf(D),ae=this.data[F][H];return this.data[F].splice(H,1),ae.timeout&&clearTimeout(ae.timeout),0===this.data[F].length&&delete this.data[F],this.onRemove(ae.value),this.order.splice(this.order.indexOf(F),1),this},j.prototype.setMaxSize=function(C){for(this.max=C;this.order.length>this.max;){var D=this._getAndRemoveByKey(this.order[0]);D&&this.onRemove(D)}return this},j.prototype.filter=function(C){var D=[];for(var F in this.data)for(var H=0,ae=this.data[F];H<ae.length;H+=1){var ue=ae[H];C(ue.value)||D.push(ue)}for(var me=0,be=D;me<be.length;me+=1){var Le=be[me];this.remove(Le.value.tileID,Le)}};var J=function(C,D,F){this.context=C;var H=C.gl;this.buffer=H.createBuffer(),this.dynamicDraw=Boolean(F),this.context.unbindVAO(),C.bindElementBuffer.set(this.buffer),H.bufferData(H.ELEMENT_ARRAY_BUFFER,D.arrayBuffer,this.dynamicDraw?H.DYNAMIC_DRAW:H.STATIC_DRAW),this.dynamicDraw||delete D.arrayBuffer};J.prototype.bind=function(){this.context.bindElementBuffer.set(this.buffer)},J.prototype.updateData=function(C){var D=this.context.gl;this.context.unbindVAO(),this.bind(),D.bufferSubData(D.ELEMENT_ARRAY_BUFFER,0,C.arrayBuffer)},J.prototype.destroy=function(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)};var X={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"},re=function(C,D,F,H){this.length=D.length,this.attributes=F,this.itemSize=D.bytesPerElement,this.dynamicDraw=H,this.context=C;var ae=C.gl;this.buffer=ae.createBuffer(),C.bindVertexBuffer.set(this.buffer),ae.bufferData(ae.ARRAY_BUFFER,D.arrayBuffer,this.dynamicDraw?ae.DYNAMIC_DRAW:ae.STATIC_DRAW),this.dynamicDraw||delete D.arrayBuffer};re.prototype.bind=function(){this.context.bindVertexBuffer.set(this.buffer)},re.prototype.updateData=function(C){var D=this.context.gl;this.bind(),D.bufferSubData(D.ARRAY_BUFFER,0,C.arrayBuffer)},re.prototype.enableAttributes=function(C,D){for(var F=0;F<this.attributes.length;F++){var ae=D.attributes[this.attributes[F].name];void 0!==ae&&C.enableVertexAttribArray(ae)}},re.prototype.setVertexAttribPointers=function(C,D,F){for(var H=0;H<this.attributes.length;H++){var ae=this.attributes[H],ue=D.attributes[ae.name];void 0!==ue&&C.vertexAttribPointer(ue,ae.components,C[X[ae.type]],!1,this.itemSize,ae.offset+this.itemSize*(F||0))}},re.prototype.destroy=function(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)};var ne=function(C){this.gl=C.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1};ne.prototype.get=function(){return this.current},ne.prototype.set=function(C){},ne.prototype.getDefault=function(){return this.default},ne.prototype.setDefault=function(){this.set(this.default)};var le=function(C){function D(){C.apply(this,arguments)}return C&&(D.__proto__=C),(D.prototype=Object.create(C&&C.prototype)).constructor=D,D.prototype.getDefault=function(){return e.Color.transparent},D.prototype.set=function(F){var H=this.current;(F.r!==H.r||F.g!==H.g||F.b!==H.b||F.a!==H.a||this.dirty)&&(this.gl.clearColor(F.r,F.g,F.b,F.a),this.current=F,this.dirty=!1)},D}(ne),oe=function(C){function D(){C.apply(this,arguments)}return C&&(D.__proto__=C),(D.prototype=Object.create(C&&C.prototype)).constructor=D,D.prototype.getDefault=function(){return 1},D.prototype.set=function(F){(F!==this.current||this.dirty)&&(this.gl.clearDepth(F),this.current=F,this.dirty=!1)},D}(ne),de=function(C){function D(){C.apply(this,arguments)}return C&&(D.__proto__=C),(D.prototype=Object.create(C&&C.prototype)).constructor=D,D.prototype.getDefault=function(){return 0},D.prototype.set=function(F){(F!==this.current||this.dirty)&&(this.gl.clearStencil(F),this.current=F,this.dirty=!1)},D}(ne),se=function(C){function D(){C.apply(this,arguments)}return C&&(D.__proto__=C),(D.prototype=Object.create(C&&C.prototype)).constructor=D,D.prototype.getDefault=function(){return[!0,!0,!0,!0]},D.prototype.set=function(F){var H=this.current;(F[0]!==H[0]||F[1]!==H[1]||F[2]!==H[2]||F[3]!==H[3]||this.dirty)&&(this.gl.colorMask(F[0],F[1],F[2],F[3]),this.current=F,this.dirty=!1)},D}(ne),ge=function(C){function D(){C.apply(this,arguments)}return C&&(D.__proto__=C),(D.prototype=Object.create(C&&C.prototype)).constructor=D,D.prototype.getDefault=function(){return!0},D.prototype.set=function(F){(F!==this.current||this.dirty)&&(this.gl.depthMask(F),this.current=F,this.dirty=!1)},D}(ne),_e=function(C){function D(){C.apply(this,arguments)}return C&&(D.__proto__=C),(D.prototype=Object.create(C&&C.prototype)).constructor=D,D.prototype.getDefault=function(){return 255},D.prototype.set=function(F){(F!==this.current||this.dirty)&&(this.gl.stencilMask(F),this.current=F,this.dirty=!1)},D}(ne),Te=function(C){function D(){C.apply(this,arguments)}return C&&(D.__proto__=C),(D.prototype=Object.create(C&&C.prototype)).constructor=D,D.prototype.getDefault=function(){return{func:this.gl.ALWAYS,ref:0,mask:255}},D.prototype.set=function(F){var H=this.current;(F.func!==H.func||F.ref!==H.ref||F.mask!==H.mask||this.dirty)&&(this.gl.stencilFunc(F.func,F.ref,F.mask),this.current=F,this.dirty=!1)},D}(ne),we=function(C){function D(){C.apply(this,arguments)}return C&&(D.__proto__=C),(D.prototype=Object.create(C&&C.prototype)).constructor=D,D.prototype.getDefault=function(){var F=this.gl;return[F.KEEP,F.KEEP,F.KEEP]},D.prototype.set=function(F){var H=this.current;(F[0]!==H[0]||F[1]!==H[1]||F[2]!==H[2]||this.dirty)&&(this.gl.stencilOp(F[0],F[1],F[2]),this.current=F,this.dirty=!1)},D}(ne),Oe=function(C){function D(){C.apply(this,arguments)}return C&&(D.__proto__=C),(D.prototype=Object.create(C&&C.prototype)).constructor=D,D.prototype.getDefault=function(){return!1},D.prototype.set=function(F){if(F!==this.current||this.dirty){var H=this.gl;F?H.enable(H.STENCIL_TEST):H.disable(H.STENCIL_TEST),this.current=F,this.dirty=!1}},D}(ne),fe=function(C){function D(){C.apply(this,arguments)}return C&&(D.__proto__=C),(D.prototype=Object.create(C&&C.prototype)).constructor=D,D.prototype.getDefault=function(){return[0,1]},D.prototype.set=function(F){var H=this.current;(F[0]!==H[0]||F[1]!==H[1]||this.dirty)&&(this.gl.depthRange(F[0],F[1]),this.current=F,this.dirty=!1)},D}(ne),ve=function(C){function D(){C.apply(this,arguments)}return C&&(D.__proto__=C),(D.prototype=Object.create(C&&C.prototype)).constructor=D,D.prototype.getDefault=function(){return!1},D.prototype.set=function(F){if(F!==this.current||this.dirty){var H=this.gl;F?H.enable(H.DEPTH_TEST):H.disable(H.DEPTH_TEST),this.current=F,this.dirty=!1}},D}(ne),Ae=function(C){function D(){C.apply(this,arguments)}return C&&(D.__proto__=C),(D.prototype=Object.create(C&&C.prototype)).constructor=D,D.prototype.getDefault=function(){return this.gl.LESS},D.prototype.set=function(F){(F!==this.current||this.dirty)&&(this.gl.depthFunc(F),this.current=F,this.dirty=!1)},D}(ne),ke=function(C){function D(){C.apply(this,arguments)}return C&&(D.__proto__=C),(D.prototype=Object.create(C&&C.prototype)).constructor=D,D.prototype.getDefault=function(){return!1},D.prototype.set=function(F){if(F!==this.current||this.dirty){var H=this.gl;F?H.enable(H.BLEND):H.disable(H.BLEND),this.current=F,this.dirty=!1}},D}(ne),Pe=function(C){function D(){C.apply(this,arguments)}return C&&(D.__proto__=C),(D.prototype=Object.create(C&&C.prototype)).constructor=D,D.prototype.getDefault=function(){var F=this.gl;return[F.ONE,F.ZERO]},D.prototype.set=function(F){var H=this.current;(F[0]!==H[0]||F[1]!==H[1]||this.dirty)&&(this.gl.blendFunc(F[0],F[1]),this.current=F,this.dirty=!1)},D}(ne),Ne=function(C){function D(){C.apply(this,arguments)}return C&&(D.__proto__=C),(D.prototype=Object.create(C&&C.prototype)).constructor=D,D.prototype.getDefault=function(){return e.Color.transparent},D.prototype.set=function(F){var H=this.current;(F.r!==H.r||F.g!==H.g||F.b!==H.b||F.a!==H.a||this.dirty)&&(this.gl.blendColor(F.r,F.g,F.b,F.a),this.current=F,this.dirty=!1)},D}(ne),De=function(C){function D(){C.apply(this,arguments)}return C&&(D.__proto__=C),(D.prototype=Object.create(C&&C.prototype)).constructor=D,D.prototype.getDefault=function(){return this.gl.FUNC_ADD},D.prototype.set=function(F){(F!==this.current||this.dirty)&&(this.gl.blendEquation(F),this.current=F,this.dirty=!1)},D}(ne),ze=function(C){function D(){C.apply(this,arguments)}return C&&(D.__proto__=C),(D.prototype=Object.create(C&&C.prototype)).constructor=D,D.prototype.getDefault=function(){return!1},D.prototype.set=function(F){if(F!==this.current||this.dirty){var H=this.gl;F?H.enable(H.CULL_FACE):H.disable(H.CULL_FACE),this.current=F,this.dirty=!1}},D}(ne),Me=function(C){function D(){C.apply(this,arguments)}return C&&(D.__proto__=C),(D.prototype=Object.create(C&&C.prototype)).constructor=D,D.prototype.getDefault=function(){return this.gl.BACK},D.prototype.set=function(F){(F!==this.current||this.dirty)&&(this.gl.cullFace(F),this.current=F,this.dirty=!1)},D}(ne),Se=function(C){function D(){C.apply(this,arguments)}return C&&(D.__proto__=C),(D.prototype=Object.create(C&&C.prototype)).constructor=D,D.prototype.getDefault=function(){return this.gl.CCW},D.prototype.set=function(F){(F!==this.current||this.dirty)&&(this.gl.frontFace(F),this.current=F,this.dirty=!1)},D}(ne),Ie=function(C){function D(){C.apply(this,arguments)}return C&&(D.__proto__=C),(D.prototype=Object.create(C&&C.prototype)).constructor=D,D.prototype.getDefault=function(){return null},D.prototype.set=function(F){(F!==this.current||this.dirty)&&(this.gl.useProgram(F),this.current=F,this.dirty=!1)},D}(ne),Fe=function(C){function D(){C.apply(this,arguments)}return C&&(D.__proto__=C),(D.prototype=Object.create(C&&C.prototype)).constructor=D,D.prototype.getDefault=function(){return this.gl.TEXTURE0},D.prototype.set=function(F){(F!==this.current||this.dirty)&&(this.gl.activeTexture(F),this.current=F,this.dirty=!1)},D}(ne),Re=function(C){function D(){C.apply(this,arguments)}return C&&(D.__proto__=C),(D.prototype=Object.create(C&&C.prototype)).constructor=D,D.prototype.getDefault=function(){var F=this.gl;return[0,0,F.drawingBufferWidth,F.drawingBufferHeight]},D.prototype.set=function(F){var H=this.current;(F[0]!==H[0]||F[1]!==H[1]||F[2]!==H[2]||F[3]!==H[3]||this.dirty)&&(this.gl.viewport(F[0],F[1],F[2],F[3]),this.current=F,this.dirty=!1)},D}(ne),Xe=function(C){function D(){C.apply(this,arguments)}return C&&(D.__proto__=C),(D.prototype=Object.create(C&&C.prototype)).constructor=D,D.prototype.getDefault=function(){return null},D.prototype.set=function(F){if(F!==this.current||this.dirty){var H=this.gl;H.bindFramebuffer(H.FRAMEBUFFER,F),this.current=F,this.dirty=!1}},D}(ne),nt=function(C){function D(){C.apply(this,arguments)}return C&&(D.__proto__=C),(D.prototype=Object.create(C&&C.prototype)).constructor=D,D.prototype.getDefault=function(){return null},D.prototype.set=function(F){if(F!==this.current||this.dirty){var H=this.gl;H.bindRenderbuffer(H.RENDERBUFFER,F),this.current=F,this.dirty=!1}},D}(ne),ct=function(C){function D(){C.apply(this,arguments)}return C&&(D.__proto__=C),(D.prototype=Object.create(C&&C.prototype)).constructor=D,D.prototype.getDefault=function(){return null},D.prototype.set=function(F){if(F!==this.current||this.dirty){var H=this.gl;H.bindTexture(H.TEXTURE_2D,F),this.current=F,this.dirty=!1}},D}(ne),xt=function(C){function D(){C.apply(this,arguments)}return C&&(D.__proto__=C),(D.prototype=Object.create(C&&C.prototype)).constructor=D,D.prototype.getDefault=function(){return null},D.prototype.set=function(F){if(F!==this.current||this.dirty){var H=this.gl;H.bindBuffer(H.ARRAY_BUFFER,F),this.current=F,this.dirty=!1}},D}(ne),dt=function(C){function D(){C.apply(this,arguments)}return C&&(D.__proto__=C),(D.prototype=Object.create(C&&C.prototype)).constructor=D,D.prototype.getDefault=function(){return null},D.prototype.set=function(F){var H=this.gl;H.bindBuffer(H.ELEMENT_ARRAY_BUFFER,F),this.current=F,this.dirty=!1},D}(ne),tt=function(C){function D(F){C.call(this,F),this.vao=F.extVertexArrayObject}return C&&(D.__proto__=C),(D.prototype=Object.create(C&&C.prototype)).constructor=D,D.prototype.getDefault=function(){return null},D.prototype.set=function(F){this.vao&&(F!==this.current||this.dirty)&&(this.vao.bindVertexArrayOES(F),this.current=F,this.dirty=!1)},D}(ne),Ke=function(C){function D(){C.apply(this,arguments)}return C&&(D.__proto__=C),(D.prototype=Object.create(C&&C.prototype)).constructor=D,D.prototype.getDefault=function(){return 4},D.prototype.set=function(F){if(F!==this.current||this.dirty){var H=this.gl;H.pixelStorei(H.UNPACK_ALIGNMENT,F),this.current=F,this.dirty=!1}},D}(ne),mt=function(C){function D(){C.apply(this,arguments)}return C&&(D.__proto__=C),(D.prototype=Object.create(C&&C.prototype)).constructor=D,D.prototype.getDefault=function(){return!1},D.prototype.set=function(F){if(F!==this.current||this.dirty){var H=this.gl;H.pixelStorei(H.UNPACK_PREMULTIPLY_ALPHA_WEBGL,F),this.current=F,this.dirty=!1}},D}(ne),Bt=function(C){function D(){C.apply(this,arguments)}return C&&(D.__proto__=C),(D.prototype=Object.create(C&&C.prototype)).constructor=D,D.prototype.getDefault=function(){return!1},D.prototype.set=function(F){if(F!==this.current||this.dirty){var H=this.gl;H.pixelStorei(H.UNPACK_FLIP_Y_WEBGL,F),this.current=F,this.dirty=!1}},D}(ne),Ut=function(C){function D(F,H){C.call(this,F),this.context=F,this.parent=H}return C&&(D.__proto__=C),(D.prototype=Object.create(C&&C.prototype)).constructor=D,D.prototype.getDefault=function(){return null},D}(ne),er=function(C){function D(){C.apply(this,arguments)}return C&&(D.__proto__=C),(D.prototype=Object.create(C&&C.prototype)).constructor=D,D.prototype.setDirty=function(){this.dirty=!0},D.prototype.set=function(F){if(F!==this.current||this.dirty){this.context.bindFramebuffer.set(this.parent);var H=this.gl;H.framebufferTexture2D(H.FRAMEBUFFER,H.COLOR_ATTACHMENT0,H.TEXTURE_2D,F,0),this.current=F,this.dirty=!1}},D}(Ut),Wt=function(C){function D(){C.apply(this,arguments)}return C&&(D.__proto__=C),(D.prototype=Object.create(C&&C.prototype)).constructor=D,D.prototype.set=function(F){if(F!==this.current||this.dirty){this.context.bindFramebuffer.set(this.parent);var H=this.gl;H.framebufferRenderbuffer(H.FRAMEBUFFER,H.DEPTH_ATTACHMENT,H.RENDERBUFFER,F),this.current=F,this.dirty=!1}},D}(Ut),rr=function(C,D,F,H){this.context=C,this.width=D,this.height=F;var ue=this.framebuffer=C.gl.createFramebuffer();this.colorAttachment=new er(C,ue),H&&(this.depthAttachment=new Wt(C,ue))};rr.prototype.destroy=function(){var C=this.context.gl,D=this.colorAttachment.get();if(D&&C.deleteTexture(D),this.depthAttachment){var F=this.depthAttachment.get();F&&C.deleteRenderbuffer(F)}C.deleteFramebuffer(this.framebuffer)};var Ht=function(C,D,F){this.func=C,this.mask=D,this.range=F};Ht.ReadOnly=!1,Ht.ReadWrite=!0,Ht.disabled=new Ht(519,Ht.ReadOnly,[0,1]);var Ve=function(C,D,F,H,ae,ue){this.test=C,this.ref=D,this.mask=F,this.fail=H,this.depthFail=ae,this.pass=ue};Ve.disabled=new Ve({func:519,mask:0},0,0,7680,7680,7680);var We=function(C,D,F){this.blendFunction=C,this.blendColor=D,this.mask=F};We.disabled=new We(We.Replace=[1,0],e.Color.transparent,[!1,!1,!1,!1]),We.unblended=new We(We.Replace,e.Color.transparent,[!0,!0,!0,!0]),We.alphaBlended=new We([1,771],e.Color.transparent,[!0,!0,!0,!0]);var he=function(C,D,F){this.enable=C,this.mode=D,this.frontFace=F};he.disabled=new he(!1,1029,2305),he.backCCW=new he(!0,1029,2305);var ye=function(C){this.gl=C,this.extVertexArrayObject=this.gl.getExtension("OES_vertex_array_object"),this.clearColor=new le(this),this.clearDepth=new oe(this),this.clearStencil=new de(this),this.colorMask=new se(this),this.depthMask=new ge(this),this.stencilMask=new _e(this),this.stencilFunc=new Te(this),this.stencilOp=new we(this),this.stencilTest=new Oe(this),this.depthRange=new fe(this),this.depthTest=new ve(this),this.depthFunc=new Ae(this),this.blend=new ke(this),this.blendFunc=new Pe(this),this.blendColor=new Ne(this),this.blendEquation=new De(this),this.cullFace=new ze(this),this.cullFaceSide=new Me(this),this.frontFace=new Se(this),this.program=new Ie(this),this.activeTexture=new Fe(this),this.viewport=new Re(this),this.bindFramebuffer=new Xe(this),this.bindRenderbuffer=new nt(this),this.bindTexture=new ct(this),this.bindVertexBuffer=new xt(this),this.bindElementBuffer=new dt(this),this.bindVertexArrayOES=this.extVertexArrayObject&&new tt(this),this.pixelStoreUnpack=new Ke(this),this.pixelStoreUnpackPremultiplyAlpha=new mt(this),this.pixelStoreUnpackFlipY=new Bt(this),this.extTextureFilterAnisotropic=C.getExtension("EXT_texture_filter_anisotropic")||C.getExtension("MOZ_EXT_texture_filter_anisotropic")||C.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=C.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.extTextureHalfFloat=C.getExtension("OES_texture_half_float"),this.extTextureHalfFloat&&(C.getExtension("OES_texture_half_float_linear"),this.extRenderToTextureHalfFloat=C.getExtension("EXT_color_buffer_half_float")),this.extTimerQuery=C.getExtension("EXT_disjoint_timer_query")};ye.prototype.setDefault=function(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()},ye.prototype.setDirty=function(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.extVertexArrayObject&&(this.bindVertexArrayOES.dirty=!0),this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0},ye.prototype.createIndexBuffer=function(C,D){return new J(this,C,D)},ye.prototype.createVertexBuffer=function(C,D,F){return new re(this,C,D,F)},ye.prototype.createRenderbuffer=function(C,D,F){var H=this.gl,ae=H.createRenderbuffer();return this.bindRenderbuffer.set(ae),H.renderbufferStorage(H.RENDERBUFFER,C,D,F),this.bindRenderbuffer.set(null),ae},ye.prototype.createFramebuffer=function(C,D,F){return new rr(this,C,D,F)},ye.prototype.clear=function(C){var D=C.color,F=C.depth,H=this.gl,ae=0;D&&(ae|=H.COLOR_BUFFER_BIT,this.clearColor.set(D),this.colorMask.set([!0,!0,!0,!0])),void 0!==F&&(ae|=H.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(F),this.depthMask.set(!0)),H.clear(ae)},ye.prototype.setCullFace=function(C){!1===C.enable?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(C.mode),this.frontFace.set(C.frontFace))},ye.prototype.setDepthMode=function(C){C.func!==this.gl.ALWAYS||C.mask?(this.depthTest.set(!0),this.depthFunc.set(C.func),this.depthMask.set(C.mask),this.depthRange.set(C.range)):this.depthTest.set(!1)},ye.prototype.setStencilMode=function(C){C.test.func!==this.gl.ALWAYS||C.mask?(this.stencilTest.set(!0),this.stencilMask.set(C.mask),this.stencilOp.set([C.fail,C.depthFail,C.pass]),this.stencilFunc.set({func:C.test.func,ref:C.ref,mask:C.test.mask})):this.stencilTest.set(!1)},ye.prototype.setColorMode=function(C){e.deepEqual(C.blendFunction,We.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(C.blendFunction),this.blendColor.set(C.blendColor)),this.colorMask.set(C.mask)},ye.prototype.unbindVAO=function(){this.extVertexArrayObject&&this.bindVertexArrayOES.set(null)};var Be=function(C){function D(F,H,ae){var ue=this;C.call(this),this.id=F,this.dispatcher=ae,this.on("data",function(me){"source"===me.dataType&&"metadata"===me.sourceDataType&&(ue._sourceLoaded=!0),ue._sourceLoaded&&!ue._paused&&"source"===me.dataType&&"content"===me.sourceDataType&&(ue.reload(),ue.transform&&ue.update(ue.transform))}),this.on("error",function(){ue._sourceErrored=!0}),this._source=function(me,be,Le,qe){var Qe=new B[be.type](me,be,Le,qe);if(Qe.id!==me)throw new Error("Expected Source id to be "+me+" instead of "+Qe.id);return e.bindAll(["load","abort","unload","serialize","prepare"],Qe),Qe}(F,H,ae,this),this._tiles={},this._cache=new j(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._maxTileCacheSize=null,this._loadedParentTiles={},this._coveredTiles={},this._state=new e.SourceFeatureState}return C&&(D.__proto__=C),(D.prototype=Object.create(C&&C.prototype)).constructor=D,D.prototype.onAdd=function(F){this.map=F,this._maxTileCacheSize=F?F._maxTileCacheSize:null,this._source&&this._source.onAdd&&this._source.onAdd(F)},D.prototype.onRemove=function(F){this._source&&this._source.onRemove&&this._source.onRemove(F)},D.prototype.loaded=function(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;for(var F in this._tiles){var H=this._tiles[F];if("loaded"!==H.state&&"errored"!==H.state)return!1}return!0},D.prototype.getSource=function(){return this._source},D.prototype.pause=function(){this._paused=!0},D.prototype.resume=function(){if(this._paused){var F=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,F&&this.reload(),this.transform&&this.update(this.transform)}},D.prototype._loadTile=function(F,H){return this._source.loadTile(F,H)},D.prototype._unloadTile=function(F){if(this._source.unloadTile)return this._source.unloadTile(F,function(){})},D.prototype._abortTile=function(F){if(this._source.abortTile)return this._source.abortTile(F,function(){})},D.prototype.serialize=function(){return this._source.serialize()},D.prototype.prepare=function(F){for(var H in this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null),this._tiles){var ae=this._tiles[H];ae.upload(F),ae.prepare(this.map.style.imageManager)}},D.prototype.getIds=function(){return e.values(this._tiles).map(function(F){return F.tileID}).sort(Ge).map(function(F){return F.key})},D.prototype.getRenderableIds=function(F){var H=this,ae=[];for(var ue in this._tiles)this._isIdRenderable(ue,F)&&ae.push(this._tiles[ue]);return F?ae.sort(function(me,be){var Le=me.tileID,qe=be.tileID,Qe=new e.Point(Le.canonical.x,Le.canonical.y)._rotate(H.transform.angle),at=new e.Point(qe.canonical.x,qe.canonical.y)._rotate(H.transform.angle);return Le.overscaledZ-qe.overscaledZ||at.y-Qe.y||at.x-Qe.x}).map(function(me){return me.tileID.key}):ae.map(function(me){return me.tileID}).sort(Ge).map(function(me){return me.key})},D.prototype.hasRenderableParent=function(F){var H=this.findLoadedParent(F,0);return!!H&&this._isIdRenderable(H.tileID.key)},D.prototype._isIdRenderable=function(F,H){return this._tiles[F]&&this._tiles[F].hasData()&&!this._coveredTiles[F]&&(H||!this._tiles[F].holdingForFade())},D.prototype.reload=function(){if(this._paused)this._shouldReloadOnResume=!0;else for(var F in this._cache.reset(),this._tiles)"errored"!==this._tiles[F].state&&this._reloadTile(F,"reloading")},D.prototype._reloadTile=function(F,H){var ae=this._tiles[F];ae&&("loading"!==ae.state&&(ae.state=H),this._loadTile(ae,this._tileLoaded.bind(this,ae,F,H)))},D.prototype._tileLoaded=function(F,H,ae,ue){if(ue)return F.state="errored",void(404!==ue.status?this._source.fire(new e.ErrorEvent(ue,{tile:F})):this.update(this.transform));F.timeAdded=e.browser.now(),"expired"===ae&&(F.refreshedUponExpiration=!0),this._setTileReloadTimer(H,F),"raster-dem"===this.getSource().type&&F.dem&&this._backfillDEM(F),this._state.initializeTileState(F,this.map?this.map.painter:null),this._source.fire(new e.Event("data",{dataType:"source",tile:F,coord:F.tileID}))},D.prototype._backfillDEM=function(F){for(var H=this.getRenderableIds(),ae=0;ae<H.length;ae++){var ue=H[ae];if(F.neighboringTiles&&F.neighboringTiles[ue]){var me=this.getTileByID(ue);be(F,me),be(me,F)}}function be(Le,qe){Le.needsHillshadePrepare=!0;var Qe=qe.tileID.canonical.x-Le.tileID.canonical.x,at=qe.tileID.canonical.y-Le.tileID.canonical.y,_t=Math.pow(2,Le.tileID.canonical.z),Et=qe.tileID.key;0===Qe&&0===at||Math.abs(at)>1||(Math.abs(Qe)>1&&(1===Math.abs(Qe+_t)?Qe+=_t:1===Math.abs(Qe-_t)&&(Qe-=_t)),qe.dem&&Le.dem&&(Le.dem.backfillBorder(qe.dem,Qe,at),Le.neighboringTiles&&Le.neighboringTiles[Et]&&(Le.neighboringTiles[Et].backfilled=!0)))}},D.prototype.getTile=function(F){return this.getTileByID(F.key)},D.prototype.getTileByID=function(F){return this._tiles[F]},D.prototype._retainLoadedChildren=function(F,H,ae,ue){for(var me in this._tiles){var be=this._tiles[me];if(!(ue[me]||!be.hasData()||be.tileID.overscaledZ<=H||be.tileID.overscaledZ>ae)){for(var Le=be.tileID;be&&be.tileID.overscaledZ>H+1;){var qe=be.tileID.scaledTo(be.tileID.overscaledZ-1);(be=this._tiles[qe.key])&&be.hasData()&&(Le=qe)}for(var Qe=Le;Qe.overscaledZ>H;)if(F[(Qe=Qe.scaledTo(Qe.overscaledZ-1)).key]){ue[Le.key]=Le;break}}}},D.prototype.findLoadedParent=function(F,H){if(F.key in this._loadedParentTiles){var ae=this._loadedParentTiles[F.key];return ae&&ae.tileID.overscaledZ>=H?ae:null}for(var ue=F.overscaledZ-1;ue>=H;ue--){var me=F.scaledTo(ue),be=this._getLoadedTile(me);if(be)return be}},D.prototype._getLoadedTile=function(F){var H=this._tiles[F.key];return H&&H.hasData()?H:this._cache.getByKey(F.wrapped().key)},D.prototype.updateCacheSize=function(F){var H=(Math.ceil(F.width/this._source.tileSize)+1)*(Math.ceil(F.height/this._source.tileSize)+1),ae=Math.floor(5*H),ue="number"==typeof this._maxTileCacheSize?Math.min(this._maxTileCacheSize,ae):ae;this._cache.setMaxSize(ue)},D.prototype.handleWrapJump=function(F){var ae=Math.round((F-(void 0===this._prevLng?F:this._prevLng))/360);if(this._prevLng=F,ae){var ue={};for(var me in this._tiles){var be=this._tiles[me];be.tileID=be.tileID.unwrapTo(be.tileID.wrap+ae),ue[be.tileID.key]=be}for(var Le in this._tiles=ue,this._timers)clearTimeout(this._timers[Le]),delete this._timers[Le];for(var qe in this._tiles)this._setTileReloadTimer(qe,this._tiles[qe])}},D.prototype.update=function(F){var H=this;if(this.transform=F,this._sourceLoaded&&!this._paused){var ae;this.updateCacheSize(F),this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used?this._source.tileID?ae=F.getVisibleUnwrappedCoordinates(this._source.tileID).map(function(Ar){return new e.OverscaledTileID(Ar.canonical.z,Ar.wrap,Ar.canonical.z,Ar.canonical.x,Ar.canonical.y)}):(ae=F.coveringTiles({tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled}),this._source.hasTile&&(ae=ae.filter(function(Ar){return H._source.hasTile(Ar)}))):ae=[];var ue=F.coveringZoomLevel(this._source),me=Math.max(ue-D.maxOverzooming,this._source.minzoom),be=Math.max(ue+D.maxUnderzooming,this._source.minzoom),Le=this._updateRetainedTiles(ae,ue);if(Je(this._source.type)){for(var qe={},Qe={},at=0,_t=Object.keys(Le);at<_t.length;at+=1){var Et=_t[at],Tt=Le[Et],Mt=this._tiles[Et];if(Mt&&!(Mt.fadeEndTime&&Mt.fadeEndTime<=e.browser.now())){var bt=this.findLoadedParent(Tt,me);bt&&(this._addTile(bt.tileID),qe[bt.tileID.key]=bt.tileID),Qe[Et]=Tt}}for(var Dt in this._retainLoadedChildren(Qe,ue,be,Le),qe)Le[Dt]||(this._coveredTiles[Dt]=!0,Le[Dt]=qe[Dt])}for(var It in Le)this._tiles[It].clearFadeHold();for(var Nt=0,nr=e.keysDifference(this._tiles,Le);Nt<nr.length;Nt+=1){var dr=nr[Nt],Sr=this._tiles[dr];Sr.hasSymbolBuckets&&!Sr.holdingForFade()?Sr.setHoldDuration(this.map._fadeDuration):Sr.hasSymbolBuckets&&!Sr.symbolFadeFinished()||this._removeTile(dr)}this._updateLoadedParentTileCache()}},D.prototype.releaseSymbolFadeTiles=function(){for(var F in this._tiles)this._tiles[F].holdingForFade()&&this._removeTile(F)},D.prototype._updateRetainedTiles=function(F,H){for(var ae={},ue={},me=Math.max(H-D.maxOverzooming,this._source.minzoom),be=Math.max(H+D.maxUnderzooming,this._source.minzoom),Le={},qe=0,Qe=F;qe<Qe.length;qe+=1){var at=Qe[qe],_t=this._addTile(at);ae[at.key]=at,_t.hasData()||H<this._source.maxzoom&&(Le[at.key]=at)}this._retainLoadedChildren(Le,H,be,ae);for(var Et=0,Tt=F;Et<Tt.length;Et+=1){var Mt=Tt[Et],bt=this._tiles[Mt.key];if(!bt.hasData()){if(H+1>this._source.maxzoom){var Dt=Mt.children(this._source.maxzoom)[0],It=this.getTile(Dt);if(It&&It.hasData()){ae[Dt.key]=Dt;continue}}else{var Nt=Mt.children(this._source.maxzoom);if(ae[Nt[0].key]&&ae[Nt[1].key]&&ae[Nt[2].key]&&ae[Nt[3].key])continue}for(var nr=bt.wasRequested(),dr=Mt.overscaledZ-1;dr>=me;--dr){var Sr=Mt.scaledTo(dr);if(ue[Sr.key]||(ue[Sr.key]=!0,!(bt=this.getTile(Sr))&&nr&&(bt=this._addTile(Sr)),bt&&(ae[Sr.key]=Sr,nr=bt.wasRequested(),bt.hasData())))break}}}return ae},D.prototype._updateLoadedParentTileCache=function(){for(var F in this._loadedParentTiles={},this._tiles){for(var H=[],ae=void 0,ue=this._tiles[F].tileID;ue.overscaledZ>0;){if(ue.key in this._loadedParentTiles){ae=this._loadedParentTiles[ue.key];break}H.push(ue.key);var me=ue.scaledTo(ue.overscaledZ-1);if(ae=this._getLoadedTile(me))break;ue=me}for(var be=0,Le=H;be<Le.length;be+=1)this._loadedParentTiles[Le[be]]=ae}},D.prototype._addTile=function(F){var H=this._tiles[F.key];if(H)return H;(H=this._cache.getAndRemove(F))&&(this._setTileReloadTimer(F.key,H),H.tileID=F,this._state.initializeTileState(H,this.map?this.map.painter:null),this._cacheTimers[F.key]&&(clearTimeout(this._cacheTimers[F.key]),delete this._cacheTimers[F.key],this._setTileReloadTimer(F.key,H)));var ae=Boolean(H);return ae||(H=new e.Tile(F,this._source.tileSize*F.overscaleFactor()),this._loadTile(H,this._tileLoaded.bind(this,H,F.key,H.state))),H?(H.uses++,this._tiles[F.key]=H,ae||this._source.fire(new e.Event("dataloading",{tile:H,coord:H.tileID,dataType:"source"})),H):null},D.prototype._setTileReloadTimer=function(F,H){var ae=this;F in this._timers&&(clearTimeout(this._timers[F]),delete this._timers[F]);var ue=H.getExpiryTimeout();ue&&(this._timers[F]=setTimeout(function(){ae._reloadTile(F,"expired"),delete ae._timers[F]},ue))},D.prototype._removeTile=function(F){var H=this._tiles[F];H&&(H.uses--,delete this._tiles[F],this._timers[F]&&(clearTimeout(this._timers[F]),delete this._timers[F]),H.uses>0||(H.hasData()&&"reloading"!==H.state?this._cache.add(H.tileID,H,H.getExpiryTimeout()):(H.aborted=!0,this._abortTile(H),this._unloadTile(H))))},D.prototype.clearTiles=function(){for(var F in this._shouldReloadOnResume=!1,this._paused=!1,this._tiles)this._removeTile(F);this._cache.reset()},D.prototype.tilesIn=function(F,H,ae){var ue=this,me=[],be=this.transform;if(!be)return me;for(var Le=ae?be.getCameraQueryGeometry(F):F,qe=F.map(function(dr){return be.pointCoordinate(dr)}),Qe=Le.map(function(dr){return be.pointCoordinate(dr)}),at=this.getIds(),_t=1/0,Et=1/0,Tt=-1/0,Mt=-1/0,bt=0,Dt=Qe;bt<Dt.length;bt+=1){var It=Dt[bt];_t=Math.min(_t,It.x),Et=Math.min(Et,It.y),Tt=Math.max(Tt,It.x),Mt=Math.max(Mt,It.y)}for(var Nt=function(dr){var Sr=ue._tiles[at[dr]];if(!Sr.holdingForFade()){var Ar=Sr.tileID,Kr=Math.pow(2,be.zoom-Sr.tileID.overscaledZ),Jr=H*Sr.queryPadding*e.EXTENT/Sr.tileSize/Kr,cn=[Ar.getTilePoint(new e.MercatorCoordinate(_t,Et)),Ar.getTilePoint(new e.MercatorCoordinate(Tt,Mt))];if(cn[0].x-Jr<e.EXTENT&&cn[0].y-Jr<e.EXTENT&&cn[1].x+Jr>=0&&cn[1].y+Jr>=0){var an=qe.map(function(Wn){return Ar.getTilePoint(Wn)}),jn=Qe.map(function(Wn){return Ar.getTilePoint(Wn)});me.push({tile:Sr,tileID:Ar,queryGeometry:an,cameraQueryGeometry:jn,scale:Kr})}}},nr=0;nr<at.length;nr++)Nt(nr);return me},D.prototype.getVisibleCoordinates=function(F){for(var H=this,ae=this.getRenderableIds(F).map(function(Le){return H._tiles[Le].tileID}),ue=0,me=ae;ue<me.length;ue+=1){var be=me[ue];be.posMatrix=this.transform.calculatePosMatrix(be.toUnwrapped())}return ae},D.prototype.hasTransition=function(){if(this._source.hasTransition())return!0;if(Je(this._source.type))for(var F in this._tiles){var H=this._tiles[F];if(void 0!==H.fadeEndTime&&H.fadeEndTime>=e.browser.now())return!0}return!1},D.prototype.setFeatureState=function(F,H,ae){this._state.updateState(F=F||"_geojsonTileLayer",H,ae)},D.prototype.removeFeatureState=function(F,H,ae){this._state.removeFeatureState(F=F||"_geojsonTileLayer",H,ae)},D.prototype.getFeatureState=function(F,H){return this._state.getState(F=F||"_geojsonTileLayer",H)},D.prototype.setDependencies=function(F,H,ae){var ue=this._tiles[F];ue&&ue.setDependencies(H,ae)},D.prototype.reloadTilesForDependencies=function(F,H){for(var ae in this._tiles)this._tiles[ae].hasDependency(F,H)&&this._reloadTile(ae,"reloading");this._cache.filter(function(ue){return!ue.hasDependency(F,H)})},D}(e.Evented);function Ge(C,D){var F=Math.abs(2*C.wrap)-+(C.wrap<0),H=Math.abs(2*D.wrap)-+(D.wrap<0);return C.overscaledZ-D.overscaledZ||H-F||D.canonical.y-C.canonical.y||D.canonical.x-C.canonical.x}function Je(C){return"raster"===C||"image"===C||"video"===C}function He(){return new e.window.Worker(ce.workerUrl)}Be.maxOverzooming=10,Be.maxUnderzooming=3;var st="mapboxgl_preloaded_worker_pool",ot=function(){this.active={}};ot.prototype.acquire=function(C){if(!this.workers)for(this.workers=[];this.workers.length<ot.workerCount;)this.workers.push(new He);return this.active[C]=!0,this.workers.slice()},ot.prototype.release=function(C){delete this.active[C],0===this.numActive()&&(this.workers.forEach(function(D){D.terminate()}),this.workers=null)},ot.prototype.isPreloaded=function(){return!!this.active[st]},ot.prototype.numActive=function(){return Object.keys(this.active).length};var wt,Ct=Math.floor(e.browser.hardwareConcurrency/2);function rt(){return wt||(wt=new ot),wt}function ft(C,D){var F={};for(var H in C)"ref"!==H&&(F[H]=C[H]);return e.refProperties.forEach(function(ae){ae in D&&(F[ae]=D[ae])}),F}function Rt(C){C=C.slice();for(var D=Object.create(null),F=0;F<C.length;F++)D[C[F].id]=C[F];for(var H=0;H<C.length;H++)"ref"in C[H]&&(C[H]=ft(C[H],D[C[H].ref]));return C}ot.workerCount=Math.max(Math.min(Ct,6),1);var kt={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight"};function Lt(C,D,F){F.push({command:kt.addSource,args:[C,D[C]]})}function Ee(C,D,F){D.push({command:kt.removeSource,args:[C]}),F[C]=!0}function Ye(C,D,F,H){Ee(C,F,H),Lt(C,D,F)}function it(C,D,F){var H;for(H in C[F])if(C[F].hasOwnProperty(H)&&"data"!==H&&!e.deepEqual(C[F][H],D[F][H]))return!1;for(H in D[F])if(D[F].hasOwnProperty(H)&&"data"!==H&&!e.deepEqual(C[F][H],D[F][H]))return!1;return!0}function ht(C,D,F,H,ae,ue){var me;for(me in D=D||{},C=C||{})C.hasOwnProperty(me)&&(e.deepEqual(C[me],D[me])||F.push({command:ue,args:[H,me,D[me],ae]}));for(me in D)D.hasOwnProperty(me)&&!C.hasOwnProperty(me)&&(e.deepEqual(C[me],D[me])||F.push({command:ue,args:[H,me,D[me],ae]}))}function At(C){return C.id}function Ft(C,D){return C[D.id]=D,C}var jt=function(C,D){this.reset(C,D)};jt.prototype.reset=function(C,D){this.points=C||[],this._distances=[0];for(var F=1;F<this.points.length;F++)this._distances[F]=this._distances[F-1]+this.points[F].dist(this.points[F-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(D||0,.5*this.length),this.paddedLength=this.length-2*this.padding},jt.prototype.lerp=function(C){if(1===this.points.length)return this.points[0];C=e.clamp(C,0,1);for(var D=1,F=this._distances[D],H=C*this.paddedLength+this.padding;F<H&&D<this._distances.length;)F=this._distances[++D];var ae=D-1,ue=this._distances[ae],me=F-ue,be=me>0?(H-ue)/me:0;return this.points[ae].mult(1-be).add(this.points[D].mult(be))};var fr=function(C,D,F){var H=this.boxCells=[],ae=this.circleCells=[];this.xCellCount=Math.ceil(C/F),this.yCellCount=Math.ceil(D/F);for(var ue=0;ue<this.xCellCount*this.yCellCount;ue++)H.push([]),ae.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=C,this.height=D,this.xScale=this.xCellCount/C,this.yScale=this.yCellCount/D,this.boxUid=0,this.circleUid=0};function kr(C,D,F,H,ae){var ue=e.create();return D?(e.scale(ue,ue,[1/ae,1/ae,1]),F||e.rotateZ(ue,ue,H.angle)):e.multiply(ue,H.labelPlaneMatrix,C),ue}function ur(C,D,F,H,ae){if(D){var ue=e.clone(C);return e.scale(ue,ue,[ae,ae,1]),F||e.rotateZ(ue,ue,-H.angle),ue}return H.glCoordMatrix}function Jt(C,D){var F=[C.x,C.y,0,1];Pn(F,F,D);var H=F[3];return{point:new e.Point(F[0]/H,F[1]/H),signedDistanceFromCamera:H}}function $t(C,D){return.5+C/D*.5}function Qt(C,D){var F=C[0]/C[3],H=C[1]/C[3];return F>=-D[0]&&F<=D[0]&&H>=-D[1]&&H<=D[1]}function cr(C,D,F,H,ae,ue,me,be){var Le=H?C.textSizeData:C.iconSizeData,qe=e.evaluateSizeForZoom(Le,F.transform.zoom),Qe=[256/F.width*2+1,256/F.height*2+1],at=H?C.text.dynamicLayoutVertexArray:C.icon.dynamicLayoutVertexArray;at.clear();for(var _t=C.lineVertexArray,Et=H?C.text.placedSymbolArray:C.icon.placedSymbolArray,Tt=F.transform.width/F.transform.height,Mt=!1,bt=0;bt<Et.length;bt++){var Dt=Et.get(bt);if(Dt.hidden||Dt.writingMode===e.WritingMode.vertical&&!Mt)$r(Dt.numGlyphs,at);else{Mt=!1;var It=[Dt.anchorX,Dt.anchorY,0,1];if(e.transformMat4(It,It,D),Qt(It,Qe)){var nr=$t(F.transform.cameraToCenterDistance,It[3]),dr=e.evaluateSizeForFeature(Le,qe,Dt),Sr=me?dr/nr:dr*nr,Ar=new e.Point(Dt.anchorX,Dt.anchorY),Kr=Jt(Ar,ae).point,Jr={},cn=Fr(Dt,Sr,!1,be,D,ae,ue,C.glyphOffsetArray,_t,at,Kr,Ar,Jr,Tt);Mt=cn.useVertical,(cn.notEnoughRoom||Mt||cn.needsFlipping&&Fr(Dt,Sr,!0,be,D,ae,ue,C.glyphOffsetArray,_t,at,Kr,Ar,Jr,Tt).notEnoughRoom)&&$r(Dt.numGlyphs,at)}else $r(Dt.numGlyphs,at)}}H?C.text.dynamicLayoutVertexBuffer.updateData(at):C.icon.dynamicLayoutVertexBuffer.updateData(at)}function gr(C,D,F,H,ae,ue,me,be,Le,qe,Qe){var at=be.glyphStartIndex+be.numGlyphs,_t=be.lineStartIndex,Et=be.lineStartIndex+be.lineLength,Tt=D.getoffsetX(be.glyphStartIndex),Mt=D.getoffsetX(at-1),bt=Xr(C*Tt,F,H,ae,ue,me,be.segment,_t,Et,Le,qe,Qe);if(!bt)return null;var Dt=Xr(C*Mt,F,H,ae,ue,me,be.segment,_t,Et,Le,qe,Qe);return Dt?{first:bt,last:Dt}:null}function Tr(C,D,F,H){return C===e.WritingMode.horizontal&&Math.abs(F.y-D.y)>Math.abs(F.x-D.x)*H?{useVertical:!0}:(C===e.WritingMode.vertical?D.y<F.y:D.x>F.x)?{needsFlipping:!0}:null}function Fr(C,D,F,H,ae,ue,me,be,Le,qe,Qe,at,_t,Et){var Tt,Mt=D/24,bt=C.lineOffsetX*Mt,Dt=C.lineOffsetY*Mt;if(C.numGlyphs>1){var It=C.glyphStartIndex+C.numGlyphs,Nt=C.lineStartIndex,nr=C.lineStartIndex+C.lineLength,dr=gr(Mt,be,bt,Dt,F,Qe,at,C,Le,ue,_t);if(!dr)return{notEnoughRoom:!0};var Sr=Jt(dr.first.point,me).point,Ar=Jt(dr.last.point,me).point;if(H&&!F){var Kr=Tr(C.writingMode,Sr,Ar,Et);if(Kr)return Kr}Tt=[dr.first];for(var Jr=C.glyphStartIndex+1;Jr<It-1;Jr++)Tt.push(Xr(Mt*be.getoffsetX(Jr),bt,Dt,F,Qe,at,C.segment,Nt,nr,Le,ue,_t));Tt.push(dr.last)}else{if(H&&!F){var cn=Jt(at,ae).point,an=C.lineStartIndex+C.segment+1,jn=new e.Point(Le.getx(an),Le.gety(an)),Wn=Jt(jn,ae),ui=Wn.signedDistanceFromCamera>0?Wn.point:Nr(at,jn,cn,1,ae),Gr=Tr(C.writingMode,cn,ui,Et);if(Gr)return Gr}var Tn=Xr(Mt*be.getoffsetX(C.glyphStartIndex),bt,Dt,F,Qe,at,C.segment,C.lineStartIndex,C.lineStartIndex+C.lineLength,Le,ue,_t);if(!Tn)return{notEnoughRoom:!0};Tt=[Tn]}for(var Xn=0,Hn=Tt;Xn<Hn.length;Xn+=1){var ni=Hn[Xn];e.addDynamicAttributes(qe,ni.point,ni.angle)}return{}}function Nr(C,D,F,H,ae){var ue=Jt(C.add(C.sub(D)._unit()),ae).point,me=F.sub(ue);return F.add(me._mult(H/me.mag()))}function Xr(C,D,F,H,ae,ue,me,be,Le,qe,Qe,at){var _t=H?C-D:C+D,Et=_t>0?1:-1,Tt=0;H&&(Et*=-1,Tt=Math.PI),Et<0&&(Tt+=Math.PI);for(var Mt=Et>0?be+me:be+me+1,bt=ae,Dt=ae,It=0,Nt=0,nr=Math.abs(_t),dr=[];It+Nt<=nr;){if((Mt+=Et)<be||Mt>=Le)return null;if(Dt=bt,dr.push(bt),void 0===(bt=at[Mt])){var Sr=new e.Point(qe.getx(Mt),qe.gety(Mt)),Ar=Jt(Sr,Qe);if(Ar.signedDistanceFromCamera>0)bt=at[Mt]=Ar.point;else{var Kr=Mt-Et;bt=Nr(0===It?ue:new e.Point(qe.getx(Kr),qe.gety(Kr)),Sr,Dt,nr-It+1,Qe)}}It+=Nt,Nt=Dt.dist(bt)}var Jr=(nr-It)/Nt,cn=bt.sub(Dt),an=cn.mult(Jr)._add(Dt);an._add(cn._unit()._perp()._mult(F*Et));var jn=Tt+Math.atan2(bt.y-Dt.y,bt.x-Dt.x);return dr.push(an),{point:an,angle:jn,path:dr}}fr.prototype.keysLength=function(){return this.boxKeys.length+this.circleKeys.length},fr.prototype.insert=function(C,D,F,H,ae){this._forEachCell(D,F,H,ae,this._insertBoxCell,this.boxUid++),this.boxKeys.push(C),this.bboxes.push(D),this.bboxes.push(F),this.bboxes.push(H),this.bboxes.push(ae)},fr.prototype.insertCircle=function(C,D,F,H){this._forEachCell(D-H,F-H,D+H,F+H,this._insertCircleCell,this.circleUid++),this.circleKeys.push(C),this.circles.push(D),this.circles.push(F),this.circles.push(H)},fr.prototype._insertBoxCell=function(C,D,F,H,ae,ue){this.boxCells[ae].push(ue)},fr.prototype._insertCircleCell=function(C,D,F,H,ae,ue){this.circleCells[ae].push(ue)},fr.prototype._query=function(C,D,F,H,ae,ue){if(F<0||C>this.width||H<0||D>this.height)return!ae&&[];var me=[];if(C<=0&&D<=0&&this.width<=F&&this.height<=H){if(ae)return!0;for(var be=0;be<this.boxKeys.length;be++)me.push({key:this.boxKeys[be],x1:this.bboxes[4*be],y1:this.bboxes[4*be+1],x2:this.bboxes[4*be+2],y2:this.bboxes[4*be+3]});for(var Le=0;Le<this.circleKeys.length;Le++){var qe=this.circles[3*Le],Qe=this.circles[3*Le+1],at=this.circles[3*Le+2];me.push({key:this.circleKeys[Le],x1:qe-at,y1:Qe-at,x2:qe+at,y2:Qe+at})}return ue?me.filter(ue):me}return this._forEachCell(C,D,F,H,this._queryCell,me,{hitTest:ae,seenUids:{box:{},circle:{}}},ue),ae?me.length>0:me},fr.prototype._queryCircle=function(C,D,F,H,ae){var ue=C-F,me=C+F,be=D-F,Le=D+F;if(me<0||ue>this.width||Le<0||be>this.height)return!H&&[];var qe=[];return this._forEachCell(ue,be,me,Le,this._queryCellCircle,qe,{hitTest:H,circle:{x:C,y:D,radius:F},seenUids:{box:{},circle:{}}},ae),H?qe.length>0:qe},fr.prototype.query=function(C,D,F,H,ae){return this._query(C,D,F,H,!1,ae)},fr.prototype.hitTest=function(C,D,F,H,ae){return this._query(C,D,F,H,!0,ae)},fr.prototype.hitTestCircle=function(C,D,F,H){return this._queryCircle(C,D,F,!0,H)},fr.prototype._queryCell=function(C,D,F,H,ae,ue,me,be){var Le=me.seenUids,qe=this.boxCells[ae];if(null!==qe)for(var Qe=this.bboxes,at=0,_t=qe;at<_t.length;at+=1){var Et=_t[at];if(!Le.box[Et]){Le.box[Et]=!0;var Tt=4*Et;if(C<=Qe[Tt+2]&&D<=Qe[Tt+3]&&F>=Qe[Tt+0]&&H>=Qe[Tt+1]&&(!be||be(this.boxKeys[Et]))){if(me.hitTest)return ue.push(!0),!0;ue.push({key:this.boxKeys[Et],x1:Qe[Tt],y1:Qe[Tt+1],x2:Qe[Tt+2],y2:Qe[Tt+3]})}}}var Mt=this.circleCells[ae];if(null!==Mt)for(var bt=this.circles,Dt=0,It=Mt;Dt<It.length;Dt+=1){var Nt=It[Dt];if(!Le.circle[Nt]){Le.circle[Nt]=!0;var nr=3*Nt;if(this._circleAndRectCollide(bt[nr],bt[nr+1],bt[nr+2],C,D,F,H)&&(!be||be(this.circleKeys[Nt]))){if(me.hitTest)return ue.push(!0),!0;var dr=bt[nr],Sr=bt[nr+1],Ar=bt[nr+2];ue.push({key:this.circleKeys[Nt],x1:dr-Ar,y1:Sr-Ar,x2:dr+Ar,y2:Sr+Ar})}}}},fr.prototype._queryCellCircle=function(C,D,F,H,ae,ue,me,be){var Le=me.circle,qe=me.seenUids,Qe=this.boxCells[ae];if(null!==Qe)for(var at=this.bboxes,_t=0,Et=Qe;_t<Et.length;_t+=1){var Tt=Et[_t];if(!qe.box[Tt]){qe.box[Tt]=!0;var Mt=4*Tt;if(this._circleAndRectCollide(Le.x,Le.y,Le.radius,at[Mt+0],at[Mt+1],at[Mt+2],at[Mt+3])&&(!be||be(this.boxKeys[Tt])))return ue.push(!0),!0}}var bt=this.circleCells[ae];if(null!==bt)for(var Dt=this.circles,It=0,Nt=bt;It<Nt.length;It+=1){var nr=Nt[It];if(!qe.circle[nr]){qe.circle[nr]=!0;var dr=3*nr;if(this._circlesCollide(Dt[dr],Dt[dr+1],Dt[dr+2],Le.x,Le.y,Le.radius)&&(!be||be(this.circleKeys[nr])))return ue.push(!0),!0}}},fr.prototype._forEachCell=function(C,D,F,H,ae,ue,me,be){for(var Le=this._convertToXCellCoord(C),qe=this._convertToYCellCoord(D),Qe=this._convertToXCellCoord(F),at=this._convertToYCellCoord(H),_t=Le;_t<=Qe;_t++)for(var Et=qe;Et<=at;Et++)if(ae.call(this,C,D,F,H,this.xCellCount*Et+_t,ue,me,be))return},fr.prototype._convertToXCellCoord=function(C){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(C*this.xScale)))},fr.prototype._convertToYCellCoord=function(C){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(C*this.yScale)))},fr.prototype._circlesCollide=function(C,D,F,H,ae,ue){var me=H-C,be=ae-D,Le=F+ue;return Le*Le>me*me+be*be},fr.prototype._circleAndRectCollide=function(C,D,F,H,ae,ue,me){var be=(ue-H)/2,Le=Math.abs(C-(H+be));if(Le>be+F)return!1;var qe=(me-ae)/2,Qe=Math.abs(D-(ae+qe));if(Qe>qe+F)return!1;if(Le<=be||Qe<=qe)return!0;var at=Le-be,_t=Qe-qe;return at*at+_t*_t<=F*F};var un=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function $r(C,D){for(var F=0;F<C;F++){var H=D.length;D.resize(H+4),D.float32.set(un,3*H)}}function Pn(C,D,F){var H=D[0],ae=D[1];return C[0]=F[0]*H+F[4]*ae+F[12],C[1]=F[1]*H+F[5]*ae+F[13],C[3]=F[3]*H+F[7]*ae+F[15],C}var gn=function(C,D,F){void 0===D&&(D=new fr(C.width+200,C.height+200,25)),void 0===F&&(F=new fr(C.width+200,C.height+200,25)),this.transform=C,this.grid=D,this.ignoredGrid=F,this.pitchfactor=Math.cos(C._pitch)*C.cameraToCenterDistance,this.screenRightBoundary=C.width+100,this.screenBottomBoundary=C.height+100,this.gridRightBoundary=C.width+200,this.gridBottomBoundary=C.height+200};function dn(C,D,F){return D*(e.EXTENT/(C.tileSize*Math.pow(2,F-C.tileID.overscaledZ)))}gn.prototype.placeCollisionBox=function(C,D,F,H,ae){var ue=this.projectAndGetPerspectiveRatio(H,C.anchorPointX,C.anchorPointY),me=F*ue.perspectiveRatio,be=C.x1*me+ue.point.x,Le=C.y1*me+ue.point.y,qe=C.x2*me+ue.point.x,Qe=C.y2*me+ue.point.y;return!this.isInsideGrid(be,Le,qe,Qe)||!D&&this.grid.hitTest(be,Le,qe,Qe,ae)?{box:[],offscreen:!1}:{box:[be,Le,qe,Qe],offscreen:this.isOffscreen(be,Le,qe,Qe)}},gn.prototype.placeCollisionCircles=function(C,D,F,H,ae,ue,me,be,Le,qe,Qe,at,_t){var Et=[],Tt=new e.Point(D.anchorX,D.anchorY),Mt=Jt(Tt,ue),bt=$t(this.transform.cameraToCenterDistance,Mt.signedDistanceFromCamera),Dt=(qe?ae/bt:ae*bt)/e.ONE_EM,It=Jt(Tt,me).point,Nt=gr(Dt,H,D.lineOffsetX*Dt,D.lineOffsetY*Dt,!1,It,Tt,D,F,me,{}),nr=!1,dr=!1,Sr=!0;if(Nt){for(var Ar=.5*at*bt+_t,Kr=new e.Point(-100,-100),Jr=new e.Point(this.screenRightBoundary,this.screenBottomBoundary),cn=new jt,an=Nt.first,jn=Nt.last,Wn=[],ui=an.path.length-1;ui>=1;ui--)Wn.push(an.path[ui]);for(var Gr=1;Gr<jn.path.length;Gr++)Wn.push(jn.path[Gr]);var Tn=2.5*Ar;if(be){var Xn=Wn.map(function(vo){return Jt(vo,be)});Wn=Xn.some(function(vo){return vo.signedDistanceFromCamera<=0})?[]:Xn.map(function(vo){return vo.point})}var Hn=[];if(Wn.length>0){for(var ni=Wn[0].clone(),hi=Wn[0].clone(),Si=1;Si<Wn.length;Si++)ni.x=Math.min(ni.x,Wn[Si].x),ni.y=Math.min(ni.y,Wn[Si].y),hi.x=Math.max(hi.x,Wn[Si].x),hi.y=Math.max(hi.y,Wn[Si].y);Hn=ni.x>=Kr.x&&hi.x<=Jr.x&&ni.y>=Kr.y&&hi.y<=Jr.y?[Wn]:hi.x<Kr.x||ni.x>Jr.x||hi.y<Kr.y||ni.y>Jr.y?[]:e.clipLine([Wn],Kr.x,Kr.y,Jr.x,Jr.y)}for(var $n=0,xi=Hn;$n<xi.length;$n+=1){cn.reset(xi[$n],.25*Ar);var Ci;Ci=cn.length<=.5*Ar?1:Math.ceil(cn.paddedLength/Tn)+1;for(var bi=0;bi<Ci;bi++){var Pi=bi/Math.max(Ci-1,1),Ui=cn.lerp(Pi),ca=Ui.x+100,Ca=Ui.y+100;Et.push(ca,Ca,Ar,0);var Pa=ca-Ar,la=Ca-Ar,Ta=ca+Ar,ga=Ca+Ar;if(Sr=Sr&&this.isOffscreen(Pa,la,Ta,ga),dr=dr||this.isInsideGrid(Pa,la,Ta,ga),!C&&this.grid.hitTestCircle(ca,Ca,Ar,Qe)&&(nr=!0,!Le))return{circles:[],offscreen:!1,collisionDetected:nr}}}}return{circles:!Le&&nr||!dr?[]:Et,offscreen:Sr,collisionDetected:nr}},gn.prototype.queryRenderedSymbols=function(C){if(0===C.length||0===this.grid.keysLength()&&0===this.ignoredGrid.keysLength())return{};for(var D=[],F=1/0,H=1/0,ae=-1/0,ue=-1/0,me=0,be=C;me<be.length;me+=1){var Le=be[me],qe=new e.Point(Le.x+100,Le.y+100);F=Math.min(F,qe.x),H=Math.min(H,qe.y),ae=Math.max(ae,qe.x),ue=Math.max(ue,qe.y),D.push(qe)}for(var Qe={},at={},_t=0,Et=this.grid.query(F,H,ae,ue).concat(this.ignoredGrid.query(F,H,ae,ue));_t<Et.length;_t+=1){var Tt=Et[_t],Mt=Tt.key;if(void 0===Qe[Mt.bucketInstanceId]&&(Qe[Mt.bucketInstanceId]={}),!Qe[Mt.bucketInstanceId][Mt.featureIndex]){var bt=[new e.Point(Tt.x1,Tt.y1),new e.Point(Tt.x2,Tt.y1),new e.Point(Tt.x2,Tt.y2),new e.Point(Tt.x1,Tt.y2)];e.polygonIntersectsPolygon(D,bt)&&(Qe[Mt.bucketInstanceId][Mt.featureIndex]=!0,void 0===at[Mt.bucketInstanceId]&&(at[Mt.bucketInstanceId]=[]),at[Mt.bucketInstanceId].push(Mt.featureIndex))}}return at},gn.prototype.insertCollisionBox=function(C,D,F,H,ae){(D?this.ignoredGrid:this.grid).insert({bucketInstanceId:F,featureIndex:H,collisionGroupID:ae},C[0],C[1],C[2],C[3])},gn.prototype.insertCollisionCircles=function(C,D,F,H,ae){for(var ue=D?this.ignoredGrid:this.grid,me={bucketInstanceId:F,featureIndex:H,collisionGroupID:ae},be=0;be<C.length;be+=4)ue.insertCircle(me,C[be],C[be+1],C[be+2])},gn.prototype.projectAndGetPerspectiveRatio=function(C,D,F){var H=[D,F,0,1];return Pn(H,H,C),{point:new e.Point((H[0]/H[3]+1)/2*this.transform.width+100,(-H[1]/H[3]+1)/2*this.transform.height+100),perspectiveRatio:.5+this.transform.cameraToCenterDistance/H[3]*.5}},gn.prototype.isOffscreen=function(C,D,F,H){return F<100||C>=this.screenRightBoundary||H<100||D>this.screenBottomBoundary},gn.prototype.isInsideGrid=function(C,D,F,H){return F>=0&&C<this.gridRightBoundary&&H>=0&&D<this.gridBottomBoundary},gn.prototype.getViewportMatrix=function(){var C=e.identity([]);return e.translate(C,C,[-100,-100,0]),C};var An=function(C,D,F,H){this.opacity=C?Math.max(0,Math.min(1,C.opacity+(C.placed?D:-D))):H&&F?1:0,this.placed=F};An.prototype.isHidden=function(){return 0===this.opacity&&!this.placed};var Zn=function(C,D,F,H,ae){this.text=new An(C?C.text:null,D,F,ae),this.icon=new An(C?C.icon:null,D,H,ae)};Zn.prototype.isHidden=function(){return this.text.isHidden()&&this.icon.isHidden()};var Rr=function(C,D,F){this.text=C,this.icon=D,this.skipFade=F},hn=function(){this.invProjMatrix=e.create(),this.viewportMatrix=e.create(),this.circles=[]},nn=function(C,D,F,H,ae){this.bucketInstanceId=C,this.featureIndex=D,this.sourceLayerIndex=F,this.bucketIndex=H,this.tileID=ae},Hr=function(C){this.crossSourceCollisions=C,this.maxGroupID=0,this.collisionGroups={}};function Fn(C,D,F,H,ae){var ue=e.getAnchorAlignment(C),me=-(ue.horizontalAlign-.5)*D,be=-(ue.verticalAlign-.5)*F,Le=e.evaluateVariableOffset(C,H);return new e.Point(me+Le[0]*ae,be+Le[1]*ae)}function Un(C,D,F,H,ae,ue){var me=C.x1,be=C.x2,Le=C.y1,qe=C.y2,Qe=C.anchorPointX,at=C.anchorPointY,_t=new e.Point(D,F);return H&&_t._rotate(ae?ue:-ue),{x1:me+_t.x,y1:Le+_t.y,x2:be+_t.x,y2:qe+_t.y,anchorPointX:Qe,anchorPointY:at}}Hr.prototype.get=function(C){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[C]){var D=++this.maxGroupID;this.collisionGroups[C]={ID:D,predicate:function(F){return F.collisionGroupID===D}}}return this.collisionGroups[C]};var vn=function(C,D,F,H){this.transform=C.clone(),this.collisionIndex=new gn(this.transform),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=D,this.retainedQueryData={},this.collisionGroups=new Hr(F),this.collisionCircleArrays={},this.prevPlacement=H,H&&(H.prevPlacement=void 0),this.placedOrientations={}};function Cn(C,D,F,H,ae){C.emplaceBack(D?1:0,F?1:0,H||0,ae||0),C.emplaceBack(D?1:0,F?1:0,H||0,ae||0),C.emplaceBack(D?1:0,F?1:0,H||0,ae||0),C.emplaceBack(D?1:0,F?1:0,H||0,ae||0)}vn.prototype.getBucketParts=function(C,D,F,H){var ae=F.getBucket(D),ue=F.latestFeatureIndex;if(ae&&ue&&D.id===ae.layerIds[0]){var me=F.collisionBoxArray,be=ae.layers[0].layout,Le=Math.pow(2,this.transform.zoom-F.tileID.overscaledZ),qe=F.tileSize/e.EXTENT,Qe=this.transform.calculatePosMatrix(F.tileID.toUnwrapped()),at="map"===be.get("text-pitch-alignment"),_t="map"===be.get("text-rotation-alignment"),Et=dn(F,1,this.transform.zoom),Tt=kr(Qe,at,_t,this.transform,Et),Mt=null;if(at){var bt=ur(Qe,at,_t,this.transform,Et);Mt=e.multiply([],this.transform.labelPlaneMatrix,bt)}this.retainedQueryData[ae.bucketInstanceId]=new nn(ae.bucketInstanceId,ue,ae.sourceLayerIndex,ae.index,F.tileID);var Dt={bucket:ae,layout:be,posMatrix:Qe,textLabelPlaneMatrix:Tt,labelToScreenMatrix:Mt,scale:Le,textPixelRatio:qe,holdingForFade:F.holdingForFade(),collisionBoxArray:me,partiallyEvaluatedTextSize:e.evaluateSizeForZoom(ae.textSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(ae.sourceID)};if(H)for(var It=0,Nt=ae.sortKeyRanges;It<Nt.length;It+=1){var nr=Nt[It];C.push({sortKey:nr.sortKey,symbolInstanceStart:nr.symbolInstanceStart,symbolInstanceEnd:nr.symbolInstanceEnd,parameters:Dt})}else C.push({symbolInstanceStart:0,symbolInstanceEnd:ae.symbolInstances.length,parameters:Dt})}},vn.prototype.attemptAnchorPlacement=function(C,D,F,H,ae,ue,me,be,Le,qe,Qe,at,_t,Et,Tt){var Mt,bt=[at.textOffset0,at.textOffset1],Dt=Fn(C,F,H,bt,ae),It=this.collisionIndex.placeCollisionBox(Un(D,Dt.x,Dt.y,ue,me,this.transform.angle),Qe,be,Le,qe.predicate);if((!Tt||0!==this.collisionIndex.placeCollisionBox(Un(Tt,Dt.x,Dt.y,ue,me,this.transform.angle),Qe,be,Le,qe.predicate).box.length)&&It.box.length>0)return this.prevPlacement&&this.prevPlacement.variableOffsets[at.crossTileID]&&this.prevPlacement.placements[at.crossTileID]&&this.prevPlacement.placements[at.crossTileID].text&&(Mt=this.prevPlacement.variableOffsets[at.crossTileID].anchor),this.variableOffsets[at.crossTileID]={textOffset:bt,width:F,height:H,anchor:C,textBoxScale:ae,prevAnchor:Mt},this.markUsedJustification(_t,C,at,Et),_t.allowVerticalPlacement&&(this.markUsedOrientation(_t,Et,at),this.placedOrientations[at.crossTileID]=Et),{shift:Dt,placedGlyphBoxes:It}},vn.prototype.placeLayerBucketPart=function(C,D,F){var H=this,ae=C.parameters,ue=ae.bucket,me=ae.layout,be=ae.posMatrix,Le=ae.textLabelPlaneMatrix,qe=ae.labelToScreenMatrix,Qe=ae.textPixelRatio,at=ae.holdingForFade,_t=ae.collisionBoxArray,Et=ae.partiallyEvaluatedTextSize,Tt=ae.collisionGroup,Mt=me.get("text-optional"),bt=me.get("icon-optional"),Dt=me.get("text-allow-overlap"),It=me.get("icon-allow-overlap"),Nt="map"===me.get("text-rotation-alignment"),nr="map"===me.get("text-pitch-alignment"),dr="none"!==me.get("icon-text-fit"),Sr="viewport-y"===me.get("symbol-z-order"),Ar=Dt&&(It||!ue.hasIconData()||bt),Kr=It&&(Dt||!ue.hasTextData()||Mt);!ue.collisionArrays&&_t&&ue.deserializeCollisionBoxes(_t);var Jr=function(Gr,Tn){if(!D[Gr.crossTileID])if(at)H.placements[Gr.crossTileID]=new Rr(!1,!1,!1);else{var Xn,Hn=!1,ni=!1,hi=!0,Si=null,$n={box:null,offscreen:null},xi={box:null,offscreen:null},mi=null,Ci=null,bi=0,Pi=0,Ui=0;Tn.textFeatureIndex?bi=Tn.textFeatureIndex:Gr.useRuntimeCollisionCircles&&(bi=Gr.featureIndex),Tn.verticalTextFeatureIndex&&(Pi=Tn.verticalTextFeatureIndex);var ca=Tn.textBox;if(ca){var Ca=function(ka){var Lo=e.WritingMode.horizontal;if(ue.allowVerticalPlacement&&!ka&&H.prevPlacement){var Co=H.prevPlacement.placedOrientations[Gr.crossTileID];Co&&(H.placedOrientations[Gr.crossTileID]=Co,H.markUsedOrientation(ue,Lo=Co,Gr))}return Lo},Pa=function(ka,Lo){if(ue.allowVerticalPlacement&&Gr.numVerticalGlyphVertices>0&&Tn.verticalTextBox)for(var Co=0,yl=ue.writingModes;Co<yl.length&&(yl[Co]===e.WritingMode.vertical?($n=Lo(),xi=$n):$n=ka(),!($n&&$n.box&&$n.box.length));Co+=1);else $n=ka()};if(me.get("text-variable-anchor")){var la=me.get("text-variable-anchor");if(H.prevPlacement&&H.prevPlacement.variableOffsets[Gr.crossTileID]){var Ta=H.prevPlacement.variableOffsets[Gr.crossTileID];la.indexOf(Ta.anchor)>0&&(la=la.filter(function(ka){return ka!==Ta.anchor})).unshift(Ta.anchor)}var ga=function(ka,Lo,Co){for(var yl=ka.x2-ka.x1,Xc=ka.y2-ka.y1,Go=Gr.textBoxScale,Hl=dr&&!It?Lo:null,ul={box:[],offscreen:!1},Jc=Dt?2*la.length:la.length,Fs=0;Fs<Jc;++Fs){var Qs=H.attemptAnchorPlacement(la[Fs%la.length],ka,yl,Xc,Go,Nt,nr,Qe,be,Tt,Fs>=la.length,Gr,ue,Co,Hl);if(Qs&&(ul=Qs.placedGlyphBoxes)&&ul.box&&ul.box.length){Hn=!0,Si=Qs.shift;break}}return ul};Pa(function(){return ga(ca,Tn.iconBox,e.WritingMode.horizontal)},function(){var ka=Tn.verticalTextBox;return ue.allowVerticalPlacement&&!($n&&$n.box&&$n.box.length)&&Gr.numVerticalGlyphVertices>0&&ka?ga(ka,Tn.verticalIconBox,e.WritingMode.vertical):{box:null,offscreen:null}}),$n&&(Hn=$n.box,hi=$n.offscreen);var vo=Ca($n&&$n.box);if(!Hn&&H.prevPlacement){var qa=H.prevPlacement.variableOffsets[Gr.crossTileID];qa&&(H.variableOffsets[Gr.crossTileID]=qa,H.markUsedJustification(ue,qa.anchor,Gr,vo))}}else{var Oo=function(ka,Lo){var Co=H.collisionIndex.placeCollisionBox(ka,Dt,Qe,be,Tt.predicate);return Co&&Co.box&&Co.box.length&&(H.markUsedOrientation(ue,Lo,Gr),H.placedOrientations[Gr.crossTileID]=Lo),Co};Pa(function(){return Oo(ca,e.WritingMode.horizontal)},function(){var ka=Tn.verticalTextBox;return ue.allowVerticalPlacement&&Gr.numVerticalGlyphVertices>0&&ka?Oo(ka,e.WritingMode.vertical):{box:null,offscreen:null}}),Ca($n&&$n.box&&$n.box.length)}}if(Hn=(Xn=$n)&&Xn.box&&Xn.box.length>0,hi=Xn&&Xn.offscreen,Gr.useRuntimeCollisionCircles){var ms=ue.text.placedSymbolArray.get(Gr.centerJustifiedTextSymbolIndex),Rs=e.evaluateSizeForFeature(ue.textSizeData,Et,ms),sl=me.get("text-padding");mi=H.collisionIndex.placeCollisionCircles(Dt,ms,ue.lineVertexArray,ue.glyphOffsetArray,Rs,be,Le,qe,F,nr,Tt.predicate,Gr.collisionCircleDiameter,sl),Hn=Dt||mi.circles.length>0&&!mi.collisionDetected,hi=hi&&mi.offscreen}if(Tn.iconFeatureIndex&&(Ui=Tn.iconFeatureIndex),Tn.iconBox){var Ks=function(ka){var Lo=dr&&Si?Un(ka,Si.x,Si.y,Nt,nr,H.transform.angle):ka;return H.collisionIndex.placeCollisionBox(Lo,It,Qe,be,Tt.predicate)};ni=xi&&xi.box&&xi.box.length&&Tn.verticalIconBox?(Ci=Ks(Tn.verticalIconBox)).box.length>0:(Ci=Ks(Tn.iconBox)).box.length>0,hi=hi&&Ci.offscreen}var yo=Mt||0===Gr.numHorizontalGlyphVertices&&0===Gr.numVerticalGlyphVertices,Us=bt||0===Gr.numIconVertices;if(yo||Us?Us?yo||(ni=ni&&Hn):Hn=ni&&Hn:ni=Hn=ni&&Hn,Hn&&Xn&&Xn.box&&H.collisionIndex.insertCollisionBox(Xn.box,me.get("text-ignore-placement"),ue.bucketInstanceId,xi&&xi.box&&Pi?Pi:bi,Tt.ID),ni&&Ci&&H.collisionIndex.insertCollisionBox(Ci.box,me.get("icon-ignore-placement"),ue.bucketInstanceId,Ui,Tt.ID),mi&&(Hn&&H.collisionIndex.insertCollisionCircles(mi.circles,me.get("text-ignore-placement"),ue.bucketInstanceId,bi,Tt.ID),F)){var ll=ue.bucketInstanceId,$o=H.collisionCircleArrays[ll];void 0===$o&&($o=H.collisionCircleArrays[ll]=new hn);for(var cl=0;cl<mi.circles.length;cl+=4)$o.circles.push(mi.circles[cl+0]),$o.circles.push(mi.circles[cl+1]),$o.circles.push(mi.circles[cl+2]),$o.circles.push(mi.collisionDetected?1:0)}H.placements[Gr.crossTileID]=new Rr(Hn||Ar,ni||Kr,hi||ue.justReloaded),D[Gr.crossTileID]=!0}};if(Sr)for(var cn=ue.getSortedSymbolIndexes(this.transform.angle),an=cn.length-1;an>=0;--an){var jn=cn[an];Jr(ue.symbolInstances.get(jn),ue.collisionArrays[jn])}else for(var Wn=C.symbolInstanceStart;Wn<C.symbolInstanceEnd;Wn++)Jr(ue.symbolInstances.get(Wn),ue.collisionArrays[Wn]);if(F&&ue.bucketInstanceId in this.collisionCircleArrays){var ui=this.collisionCircleArrays[ue.bucketInstanceId];e.invert(ui.invProjMatrix,be),ui.viewportMatrix=this.collisionIndex.getViewportMatrix()}ue.justReloaded=!1},vn.prototype.markUsedJustification=function(C,D,F,H){var ae;ae=H===e.WritingMode.vertical?F.verticalPlacedTextSymbolIndex:{left:F.leftJustifiedTextSymbolIndex,center:F.centerJustifiedTextSymbolIndex,right:F.rightJustifiedTextSymbolIndex}[e.getAnchorJustification(D)];for(var me=0,be=[F.leftJustifiedTextSymbolIndex,F.centerJustifiedTextSymbolIndex,F.rightJustifiedTextSymbolIndex,F.verticalPlacedTextSymbolIndex];me<be.length;me+=1){var Le=be[me];Le>=0&&(C.text.placedSymbolArray.get(Le).crossTileID=ae>=0&&Le!==ae?0:F.crossTileID)}},vn.prototype.markUsedOrientation=function(C,D,F){for(var H=D===e.WritingMode.horizontal||D===e.WritingMode.horizontalOnly?D:0,ae=D===e.WritingMode.vertical?D:0,ue=0,me=[F.leftJustifiedTextSymbolIndex,F.centerJustifiedTextSymbolIndex,F.rightJustifiedTextSymbolIndex];ue<me.length;ue+=1)C.text.placedSymbolArray.get(me[ue]).placedOrientation=H;F.verticalPlacedTextSymbolIndex&&(C.text.placedSymbolArray.get(F.verticalPlacedTextSymbolIndex).placedOrientation=ae)},vn.prototype.commit=function(C){this.commitTime=C,this.zoomAtLastRecencyCheck=this.transform.zoom;var D=this.prevPlacement,F=!1;this.prevZoomAdjustment=D?D.zoomAdjustment(this.transform.zoom):0;var H=D?D.symbolFadeChange(C):1,ae=D?D.opacities:{},ue=D?D.variableOffsets:{},me=D?D.placedOrientations:{};for(var be in this.placements){var Le=this.placements[be],qe=ae[be];qe?(this.opacities[be]=new Zn(qe,H,Le.text,Le.icon),F=F||Le.text!==qe.text.placed||Le.icon!==qe.icon.placed):(this.opacities[be]=new Zn(null,H,Le.text,Le.icon,Le.skipFade),F=F||Le.text||Le.icon)}for(var Qe in ae){var at=ae[Qe];if(!this.opacities[Qe]){var _t=new Zn(at,H,!1,!1);_t.isHidden()||(this.opacities[Qe]=_t,F=F||at.text.placed||at.icon.placed)}}for(var Et in ue)this.variableOffsets[Et]||!this.opacities[Et]||this.opacities[Et].isHidden()||(this.variableOffsets[Et]=ue[Et]);for(var Tt in me)this.placedOrientations[Tt]||!this.opacities[Tt]||this.opacities[Tt].isHidden()||(this.placedOrientations[Tt]=me[Tt]);F?this.lastPlacementChangeTime=C:"number"!=typeof this.lastPlacementChangeTime&&(this.lastPlacementChangeTime=D?D.lastPlacementChangeTime:C)},vn.prototype.updateLayerOpacities=function(C,D){for(var F={},H=0,ae=D;H<ae.length;H+=1){var ue=ae[H],me=ue.getBucket(C);me&&ue.latestFeatureIndex&&C.id===me.layerIds[0]&&this.updateBucketOpacities(me,F,ue.collisionBoxArray)}},vn.prototype.updateBucketOpacities=function(C,D,F){var H=this;C.hasTextData()&&C.text.opacityVertexArray.clear(),C.hasIconData()&&C.icon.opacityVertexArray.clear(),C.hasIconCollisionBoxData()&&C.iconCollisionBox.collisionVertexArray.clear(),C.hasTextCollisionBoxData()&&C.textCollisionBox.collisionVertexArray.clear();var ae=C.layers[0].layout,ue=new Zn(null,0,!1,!1,!0),me=ae.get("text-allow-overlap"),be=ae.get("icon-allow-overlap"),Le=ae.get("text-variable-anchor"),qe="map"===ae.get("text-rotation-alignment"),Qe="map"===ae.get("text-pitch-alignment"),at="none"!==ae.get("icon-text-fit"),_t=new Zn(null,0,me&&(be||!C.hasIconData()||ae.get("icon-optional")),be&&(me||!C.hasTextData()||ae.get("text-optional")),!0);!C.collisionArrays&&F&&(C.hasIconCollisionBoxData()||C.hasTextCollisionBoxData())&&C.deserializeCollisionBoxes(F);for(var Et=function(Dt,It,Nt){for(var nr=0;nr<It/4;nr++)Dt.opacityVertexArray.emplaceBack(Nt)},Tt=function(Dt){var It=C.symbolInstances.get(Dt),Nt=It.numHorizontalGlyphVertices,nr=It.numVerticalGlyphVertices,dr=It.crossTileID,Ar=H.opacities[dr];D[dr]?Ar=ue:Ar||(H.opacities[dr]=Ar=_t),D[dr]=!0;var Jr=It.numIconVertices>0,cn=H.placedOrientations[It.crossTileID],an=cn===e.WritingMode.vertical,jn=cn===e.WritingMode.horizontal||cn===e.WritingMode.horizontalOnly;if(Nt>0||nr>0){var Wn=Dr(Ar.text);Et(C.text,Nt,an?Ir:Wn),Et(C.text,nr,jn?Ir:Wn);var Tn=Ar.text.isHidden();[It.rightJustifiedTextSymbolIndex,It.centerJustifiedTextSymbolIndex,It.leftJustifiedTextSymbolIndex].forEach(function(Ui){Ui>=0&&(C.text.placedSymbolArray.get(Ui).hidden=Tn||an?1:0)}),It.verticalPlacedTextSymbolIndex>=0&&(C.text.placedSymbolArray.get(It.verticalPlacedTextSymbolIndex).hidden=Tn||jn?1:0);var Xn=H.variableOffsets[It.crossTileID];Xn&&H.markUsedJustification(C,Xn.anchor,It,cn);var Hn=H.placedOrientations[It.crossTileID];Hn&&(H.markUsedJustification(C,"left",It,Hn),H.markUsedOrientation(C,Hn,It))}if(Jr){var ni=Dr(Ar.icon),hi=!(at&&It.verticalPlacedIconSymbolIndex&&an);It.placedIconSymbolIndex>=0&&(Et(C.icon,It.numIconVertices,hi?ni:Ir),C.icon.placedSymbolArray.get(It.placedIconSymbolIndex).hidden=Ar.icon.isHidden()),It.verticalPlacedIconSymbolIndex>=0&&(Et(C.icon,It.numVerticalIconVertices,hi?Ir:ni),C.icon.placedSymbolArray.get(It.verticalPlacedIconSymbolIndex).hidden=Ar.icon.isHidden())}if(C.hasIconCollisionBoxData()||C.hasTextCollisionBoxData()){var xi=C.collisionArrays[Dt];if(xi){var mi=new e.Point(0,0);if(xi.textBox||xi.verticalTextBox){var Ci=!0;if(Le){var bi=H.variableOffsets[dr];bi?(mi=Fn(bi.anchor,bi.width,bi.height,bi.textOffset,bi.textBoxScale),qe&&mi._rotate(Qe?H.transform.angle:-H.transform.angle)):Ci=!1}xi.textBox&&Cn(C.textCollisionBox.collisionVertexArray,Ar.text.placed,!Ci||an,mi.x,mi.y),xi.verticalTextBox&&Cn(C.textCollisionBox.collisionVertexArray,Ar.text.placed,!Ci||jn,mi.x,mi.y)}var Pi=Boolean(!jn&&xi.verticalIconBox);xi.iconBox&&Cn(C.iconCollisionBox.collisionVertexArray,Ar.icon.placed,Pi,at?mi.x:0,at?mi.y:0),xi.verticalIconBox&&Cn(C.iconCollisionBox.collisionVertexArray,Ar.icon.placed,!Pi,at?mi.x:0,at?mi.y:0)}}},Mt=0;Mt<C.symbolInstances.length;Mt++)Tt(Mt);if(C.sortFeatures(this.transform.angle),this.retainedQueryData[C.bucketInstanceId]&&(this.retainedQueryData[C.bucketInstanceId].featureSortOrder=C.featureSortOrder),C.hasTextData()&&C.text.opacityVertexBuffer&&C.text.opacityVertexBuffer.updateData(C.text.opacityVertexArray),C.hasIconData()&&C.icon.opacityVertexBuffer&&C.icon.opacityVertexBuffer.updateData(C.icon.opacityVertexArray),C.hasIconCollisionBoxData()&&C.iconCollisionBox.collisionVertexBuffer&&C.iconCollisionBox.collisionVertexBuffer.updateData(C.iconCollisionBox.collisionVertexArray),C.hasTextCollisionBoxData()&&C.textCollisionBox.collisionVertexBuffer&&C.textCollisionBox.collisionVertexBuffer.updateData(C.textCollisionBox.collisionVertexArray),C.bucketInstanceId in this.collisionCircleArrays){var bt=this.collisionCircleArrays[C.bucketInstanceId];C.placementInvProjMatrix=bt.invProjMatrix,C.placementViewportMatrix=bt.viewportMatrix,C.collisionCircleArray=bt.circles,delete this.collisionCircleArrays[C.bucketInstanceId]}},vn.prototype.symbolFadeChange=function(C){return 0===this.fadeDuration?1:(C-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment},vn.prototype.zoomAdjustment=function(C){return Math.max(0,(this.transform.zoom-C)/1.5)},vn.prototype.hasTransitions=function(C){return this.stale||C-this.lastPlacementChangeTime<this.fadeDuration},vn.prototype.stillRecent=function(C,D){var F=this.zoomAtLastRecencyCheck===D?1-this.zoomAdjustment(D):1;return this.zoomAtLastRecencyCheck=D,this.commitTime+this.fadeDuration*F>C},vn.prototype.setStale=function(){this.stale=!0};var li=Math.pow(2,25),tr=Math.pow(2,24),mr=Math.pow(2,17),Pt=Math.pow(2,16),or=Math.pow(2,9),hr=Math.pow(2,8),zr=Math.pow(2,1);function Dr(C){if(0===C.opacity&&!C.placed)return 0;if(1===C.opacity&&C.placed)return 4294967295;var D=C.placed?1:0,F=Math.floor(127*C.opacity);return F*li+D*tr+F*mr+D*Pt+F*or+D*hr+F*zr+D}var Ir=0,Mr=function(C){this._sortAcrossTiles="viewport-y"!==C.layout.get("symbol-z-order")&&void 0!==C.layout.get("symbol-sort-key").constantOr(1),this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]};Mr.prototype.continuePlacement=function(C,D,F,H,ae){for(var ue=this._bucketParts;this._currentTileIndex<C.length;)if(D.getBucketParts(ue,H,C[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,ae())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,ue.sort(function(Le,qe){return Le.sortKey-qe.sortKey}));this._currentPartIndex<ue.length;)if(D.placeLayerBucketPart(ue[this._currentPartIndex],this._seenCrossTileIDs,F),this._currentPartIndex++,ae())return!0;return!1};var vr=function(C,D,F,H,ae,ue,me){this.placement=new vn(C,ae,ue,me),this._currentPlacementIndex=D.length-1,this._forceFullPlacement=F,this._showCollisionBoxes=H,this._done=!1};vr.prototype.isDone=function(){return this._done},vr.prototype.continuePlacement=function(C,D,F){for(var H=this,ae=e.browser.now(),ue=function(){var Le=e.browser.now()-ae;return!H._forceFullPlacement&&Le>2};this._currentPlacementIndex>=0;){var me=D[C[this._currentPlacementIndex]],be=this.placement.collisionIndex.transform.zoom;if("symbol"===me.type&&(!me.minzoom||me.minzoom<=be)&&(!me.maxzoom||me.maxzoom>be)){if(this._inProgressLayer||(this._inProgressLayer=new Mr(me)),this._inProgressLayer.continuePlacement(F[me.source],this.placement,this._showCollisionBoxes,me,ue))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0},vr.prototype.commit=function(C){return this.placement.commit(C),this.placement};var xr=512/e.EXTENT/2,wr=function(C,D,F){this.tileID=C,this.indexedSymbolInstances={},this.bucketInstanceId=F;for(var H=0;H<D.length;H++){var ae=D.get(H),ue=ae.key;this.indexedSymbolInstances[ue]||(this.indexedSymbolInstances[ue]=[]),this.indexedSymbolInstances[ue].push({crossTileID:ae.crossTileID,coord:this.getScaledCoordinates(ae,C)})}};wr.prototype.getScaledCoordinates=function(C,D){var H=xr/Math.pow(2,D.canonical.z-this.tileID.canonical.z);return{x:Math.floor((D.canonical.x*e.EXTENT+C.anchorX)*H),y:Math.floor((D.canonical.y*e.EXTENT+C.anchorY)*H)}},wr.prototype.findMatches=function(C,D,F){for(var H=this.tileID.canonical.z<D.canonical.z?1:Math.pow(2,this.tileID.canonical.z-D.canonical.z),ae=0;ae<C.length;ae++){var ue=C.get(ae);if(!ue.crossTileID){var me=this.indexedSymbolInstances[ue.key];if(me)for(var be=this.getScaledCoordinates(ue,D),Le=0,qe=me;Le<qe.length;Le+=1){var Qe=qe[Le];if(Math.abs(Qe.coord.x-be.x)<=H&&Math.abs(Qe.coord.y-be.y)<=H&&!F[Qe.crossTileID]){F[Qe.crossTileID]=!0,ue.crossTileID=Qe.crossTileID;break}}}}};var Er=function(){this.maxCrossTileID=0};Er.prototype.generate=function(){return++this.maxCrossTileID};var qr=function(){this.indexes={},this.usedCrossTileIDs={},this.lng=0};qr.prototype.handleWrapJump=function(C){var D=Math.round((C-this.lng)/360);if(0!==D)for(var F in this.indexes){var H=this.indexes[F],ae={};for(var ue in H){var me=H[ue];me.tileID=me.tileID.unwrapTo(me.tileID.wrap+D),ae[me.tileID.key]=me}this.indexes[F]=ae}this.lng=C},qr.prototype.addBucket=function(C,D,F){if(this.indexes[C.overscaledZ]&&this.indexes[C.overscaledZ][C.key]){if(this.indexes[C.overscaledZ][C.key].bucketInstanceId===D.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(C.overscaledZ,this.indexes[C.overscaledZ][C.key])}for(var H=0;H<D.symbolInstances.length;H++)D.symbolInstances.get(H).crossTileID=0;this.usedCrossTileIDs[C.overscaledZ]||(this.usedCrossTileIDs[C.overscaledZ]={});var ae=this.usedCrossTileIDs[C.overscaledZ];for(var ue in this.indexes){var me=this.indexes[ue];if(Number(ue)>C.overscaledZ)for(var be in me){var Le=me[be];Le.tileID.isChildOf(C)&&Le.findMatches(D.symbolInstances,C,ae)}else{var qe=me[C.scaledTo(Number(ue)).key];qe&&qe.findMatches(D.symbolInstances,C,ae)}}for(var Qe=0;Qe<D.symbolInstances.length;Qe++){var at=D.symbolInstances.get(Qe);at.crossTileID||(at.crossTileID=F.generate(),ae[at.crossTileID]=!0)}return void 0===this.indexes[C.overscaledZ]&&(this.indexes[C.overscaledZ]={}),this.indexes[C.overscaledZ][C.key]=new wr(C,D.symbolInstances,D.bucketInstanceId),!0},qr.prototype.removeBucketCrossTileIDs=function(C,D){for(var F in D.indexedSymbolInstances)for(var H=0,ae=D.indexedSymbolInstances[F];H<ae.length;H+=1)delete this.usedCrossTileIDs[C][ae[H].crossTileID]},qr.prototype.removeStaleBuckets=function(C){var D=!1;for(var F in this.indexes){var H=this.indexes[F];for(var ae in H)C[H[ae].bucketInstanceId]||(this.removeBucketCrossTileIDs(F,H[ae]),delete H[ae],D=!0)}return D};var Vr=function(){this.layerIndexes={},this.crossTileIDs=new Er,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}};Vr.prototype.addLayer=function(C,D,F){var H=this.layerIndexes[C.id];void 0===H&&(H=this.layerIndexes[C.id]=new qr);var ae=!1,ue={};H.handleWrapJump(F);for(var me=0,be=D;me<be.length;me+=1){var Le=be[me],qe=Le.getBucket(C);qe&&C.id===qe.layerIds[0]&&(qe.bucketInstanceId||(qe.bucketInstanceId=++this.maxBucketInstanceId),H.addBucket(Le.tileID,qe,this.crossTileIDs)&&(ae=!0),ue[qe.bucketInstanceId]=!0)}return H.removeStaleBuckets(ue)&&(ae=!0),ae},Vr.prototype.pruneUnusedLayers=function(C){var D={};for(var F in C.forEach(function(H){D[H]=!0}),this.layerIndexes)D[F]||delete this.layerIndexes[F]};var Qr=function(C,D){return e.emitValidationErrors(C,D&&D.filter(function(F){return"source.canvas"!==F.identifier}))},en=e.pick(kt,["addLayer","removeLayer","setPaintProperty","setLayoutProperty","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData"]),mn=e.pick(kt,["setCenter","setZoom","setBearing","setPitch"]),xn=function(){var C={},D=e.styleSpec.$version;for(var F in e.styleSpec.$root){var H=e.styleSpec.$root[F];if(H.required){var ae;null!=(ae="version"===F?D:"array"===H.type?[]:{})&&(C[F]=ae)}}return C}(),bn=function(C){function D(F,H){var ae=this;void 0===H&&(H={}),C.call(this),this.map=F,this.dispatcher=new S(rt(),this),this.imageManager=new p,this.imageManager.setEventedParent(this),this.glyphManager=new k(F._requestManager,H.localIdeographFontFamily),this.lineAtlas=new P(256,512),this.crossTileSymbolIndex=new Vr,this._layers={},this._serializedLayers={},this._order=[],this.sourceCaches={},this.zoomHistory=new e.ZoomHistory,this._loaded=!1,this._availableImages=[],this._resetUpdates(),this.dispatcher.broadcast("setReferrer",e.getReferrer());var ue=this;this._rtlTextPluginCallback=D.registerForPluginStateChange(function(me){ue.dispatcher.broadcast("syncRTLPluginState",{pluginStatus:me.pluginStatus,pluginURL:me.pluginURL},function(Le,qe){if(e.triggerPluginCompletionEvent(Le),qe&&qe.every(function(at){return at}))for(var Qe in ue.sourceCaches)ue.sourceCaches[Qe].reload()})}),this.on("data",function(me){if("source"===me.dataType&&"metadata"===me.sourceDataType){var be=ae.sourceCaches[me.sourceId];if(be){var Le=be.getSource();if(Le&&Le.vectorLayerIds)for(var qe in ae._layers){var Qe=ae._layers[qe];Qe.source===Le.id&&ae._validateLayer(Qe)}}}})}return C&&(D.__proto__=C),(D.prototype=Object.create(C&&C.prototype)).constructor=D,D.prototype.loadURL=function(F,H){var ae=this;void 0===H&&(H={}),this.fire(new e.Event("dataloading",{dataType:"style"}));var ue="boolean"==typeof H.validate?H.validate:!e.isMapboxURL(F);F=this.map._requestManager.normalizeStyleURL(F,H.accessToken);var me=this.map._requestManager.transformRequest(F,e.ResourceType.Style);this._request=e.getJSON(me,function(be,Le){ae._request=null,be?ae.fire(new e.ErrorEvent(be)):Le&&ae._load(Le,ue)})},D.prototype.loadJSON=function(F,H){var ae=this;void 0===H&&(H={}),this.fire(new e.Event("dataloading",{dataType:"style"})),this._request=e.browser.frame(function(){ae._request=null,ae._load(F,!1!==H.validate)})},D.prototype.loadEmpty=function(){this.fire(new e.Event("dataloading",{dataType:"style"})),this._load(xn,!1)},D.prototype._load=function(F,H){if(!H||!Qr(this,e.validateStyle(F))){for(var ae in this._loaded=!0,this.stylesheet=F,F.sources)this.addSource(ae,F.sources[ae],{validate:!1});F.sprite?this._loadSprite(F.sprite):this.imageManager.setLoaded(!0),this.glyphManager.setURL(F.glyphs);var ue=Rt(this.stylesheet.layers);this._order=ue.map(function(qe){return qe.id}),this._layers={},this._serializedLayers={};for(var me=0,be=ue;me<be.length;me+=1){var Le=be[me];(Le=e.createStyleLayer(Le)).setEventedParent(this,{layer:{id:Le.id}}),this._layers[Le.id]=Le,this._serializedLayers[Le.id]=Le.serialize()}this.dispatcher.broadcast("setLayers",this._serializeLayers(this._order)),this.light=new I(this.stylesheet.light),this.fire(new e.Event("data",{dataType:"style"})),this.fire(new e.Event("style.load"))}},D.prototype._loadSprite=function(F){var H=this;this._spriteRequest=function(ae,ue,me){var be,Le,qe,Qe=e.browser.devicePixelRatio>1?"@2x":"",at=e.getJSON(ue.transformRequest(ue.normalizeSpriteURL(ae,Qe,".json"),e.ResourceType.SpriteJSON),function(Tt,Mt){at=null,qe||(qe=Tt,be=Mt,Et())}),_t=e.getImage(ue.transformRequest(ue.normalizeSpriteURL(ae,Qe,".png"),e.ResourceType.SpriteImage),function(Tt,Mt){_t=null,qe||(qe=Tt,Le=Mt,Et())});function Et(){if(qe)me(qe);else if(be&&Le){var Tt=e.browser.getImageData(Le),Mt={};for(var bt in be){var Dt=be[bt],It=Dt.width,Nt=Dt.height,nr=Dt.x,dr=Dt.y,Sr=Dt.sdf,Ar=Dt.pixelRatio,Kr=Dt.stretchX,Jr=Dt.stretchY,cn=Dt.content,an=new e.RGBAImage({width:It,height:Nt});e.RGBAImage.copy(Tt,an,{x:nr,y:dr},{x:0,y:0},{width:It,height:Nt}),Mt[bt]={data:an,pixelRatio:Ar,sdf:Sr,stretchX:Kr,stretchY:Jr,content:cn}}me(null,Mt)}}return{cancel:function(){at&&(at.cancel(),at=null),_t&&(_t.cancel(),_t=null)}}}(F,this.map._requestManager,function(ae,ue){if(H._spriteRequest=null,ae)H.fire(new e.ErrorEvent(ae));else if(ue)for(var me in ue)H.imageManager.addImage(me,ue[me]);H.imageManager.setLoaded(!0),H._availableImages=H.imageManager.listImages(),H.dispatcher.broadcast("setImages",H._availableImages),H.fire(new e.Event("data",{dataType:"style"}))})},D.prototype._validateLayer=function(F){var H=this.sourceCaches[F.source];if(H){var ae=F.sourceLayer;if(ae){var ue=H.getSource();("geojson"===ue.type||ue.vectorLayerIds&&-1===ue.vectorLayerIds.indexOf(ae))&&this.fire(new e.ErrorEvent(new Error('Source layer "'+ae+'" does not exist on source "'+ue.id+'" as specified by style layer "'+F.id+'"')))}}},D.prototype.loaded=function(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(var F in this.sourceCaches)if(!this.sourceCaches[F].loaded())return!1;return!!this.imageManager.isLoaded()},D.prototype._serializeLayers=function(F){for(var H=[],ae=0,ue=F;ae<ue.length;ae+=1){var be=this._layers[ue[ae]];"custom"!==be.type&&H.push(be.serialize())}return H},D.prototype.hasTransitions=function(){if(this.light&&this.light.hasTransition())return!0;for(var F in this.sourceCaches)if(this.sourceCaches[F].hasTransition())return!0;for(var H in this._layers)if(this._layers[H].hasTransition())return!0;return!1},D.prototype._checkLoaded=function(){if(!this._loaded)throw new Error("Style is not done loading")},D.prototype.update=function(F){if(this._loaded){var H=this._changed;if(this._changed){var ae=Object.keys(this._updatedLayers),ue=Object.keys(this._removedLayers);for(var me in(ae.length||ue.length)&&this._updateWorkerLayers(ae,ue),this._updatedSources){var be=this._updatedSources[me];"reload"===be?this._reloadSource(me):"clear"===be&&this._clearSource(me)}for(var Le in this._updateTilesForChangedImages(),this._updatedPaintProps)this._layers[Le].updateTransitions(F);this.light.updateTransitions(F),this._resetUpdates()}for(var qe in this.sourceCaches)this.sourceCaches[qe].used=!1;for(var Qe=0,at=this._order;Qe<at.length;Qe+=1){var Et=this._layers[at[Qe]];Et.recalculate(F,this._availableImages),!Et.isHidden(F.zoom)&&Et.source&&(this.sourceCaches[Et.source].used=!0)}this.light.recalculate(F),this.z=F.zoom,H&&this.fire(new e.Event("data",{dataType:"style"}))}},D.prototype._updateTilesForChangedImages=function(){var F=Object.keys(this._changedImages);if(F.length){for(var H in this.sourceCaches)this.sourceCaches[H].reloadTilesForDependencies(["icons","patterns"],F);this._changedImages={}}},D.prototype._updateWorkerLayers=function(F,H){this.dispatcher.broadcast("updateLayers",{layers:this._serializeLayers(F),removedIds:H})},D.prototype._resetUpdates=function(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={}},D.prototype.setState=function(F){var H=this;if(this._checkLoaded(),Qr(this,e.validateStyle(F)))return!1;(F=e.clone$1(F)).layers=Rt(F.layers);var ae=function Gt(C,D){if(!C)return[{command:kt.setStyle,args:[D]}];var F=[];try{if(!e.deepEqual(C.version,D.version))return[{command:kt.setStyle,args:[D]}];e.deepEqual(C.center,D.center)||F.push({command:kt.setCenter,args:[D.center]}),e.deepEqual(C.zoom,D.zoom)||F.push({command:kt.setZoom,args:[D.zoom]}),e.deepEqual(C.bearing,D.bearing)||F.push({command:kt.setBearing,args:[D.bearing]}),e.deepEqual(C.pitch,D.pitch)||F.push({command:kt.setPitch,args:[D.pitch]}),e.deepEqual(C.sprite,D.sprite)||F.push({command:kt.setSprite,args:[D.sprite]}),e.deepEqual(C.glyphs,D.glyphs)||F.push({command:kt.setGlyphs,args:[D.glyphs]}),e.deepEqual(C.transition,D.transition)||F.push({command:kt.setTransition,args:[D.transition]}),e.deepEqual(C.light,D.light)||F.push({command:kt.setLight,args:[D.light]});var H={},ae=[];!function(me,be,Le,qe){var Qe;for(Qe in be=be||{},me=me||{})me.hasOwnProperty(Qe)&&(be.hasOwnProperty(Qe)||Ee(Qe,Le,qe));for(Qe in be)be.hasOwnProperty(Qe)&&(me.hasOwnProperty(Qe)?e.deepEqual(me[Qe],be[Qe])||("geojson"===me[Qe].type&&"geojson"===be[Qe].type&&it(me,be,Qe)?Le.push({command:kt.setGeoJSONSourceData,args:[Qe,be[Qe].data]}):Ye(Qe,be,Le,qe)):Lt(Qe,be,Le))}(C.sources,D.sources,ae,H);var ue=[];C.layers&&C.layers.forEach(function(me){H[me.source]?F.push({command:kt.removeLayer,args:[me.id]}):ue.push(me)}),F=F.concat(ae),function(me,be,Le){be=be||[];var qe,Qe,at,_t,Et,Tt,Mt,bt=(me=me||[]).map(At),Dt=be.map(At),It=me.reduce(Ft,{}),Nt=be.reduce(Ft,{}),nr=bt.slice(),dr=Object.create(null);for(qe=0,Qe=0;qe<bt.length;qe++)Nt.hasOwnProperty(at=bt[qe])?Qe++:(Le.push({command:kt.removeLayer,args:[at]}),nr.splice(nr.indexOf(at,Qe),1));for(qe=0,Qe=0;qe<Dt.length;qe++)nr[nr.length-1-qe]!==(at=Dt[Dt.length-1-qe])&&(It.hasOwnProperty(at)?(Le.push({command:kt.removeLayer,args:[at]}),nr.splice(nr.lastIndexOf(at,nr.length-Qe),1)):Qe++,Le.push({command:kt.addLayer,args:[Nt[at],Tt=nr[nr.length-qe]]}),nr.splice(nr.length-qe,0,at),dr[at]=!0);for(qe=0;qe<Dt.length;qe++)if(_t=It[at=Dt[qe]],Et=Nt[at],!dr[at]&&!e.deepEqual(_t,Et))if(e.deepEqual(_t.source,Et.source)&&e.deepEqual(_t["source-layer"],Et["source-layer"])&&e.deepEqual(_t.type,Et.type)){for(Mt in ht(_t.layout,Et.layout,Le,at,null,kt.setLayoutProperty),ht(_t.paint,Et.paint,Le,at,null,kt.setPaintProperty),e.deepEqual(_t.filter,Et.filter)||Le.push({command:kt.setFilter,args:[at,Et.filter]}),e.deepEqual(_t.minzoom,Et.minzoom)&&e.deepEqual(_t.maxzoom,Et.maxzoom)||Le.push({command:kt.setLayerZoomRange,args:[at,Et.minzoom,Et.maxzoom]}),_t)_t.hasOwnProperty(Mt)&&"layout"!==Mt&&"paint"!==Mt&&"filter"!==Mt&&"metadata"!==Mt&&"minzoom"!==Mt&&"maxzoom"!==Mt&&(0===Mt.indexOf("paint.")?ht(_t[Mt],Et[Mt],Le,at,Mt.slice(6),kt.setPaintProperty):e.deepEqual(_t[Mt],Et[Mt])||Le.push({command:kt.setLayerProperty,args:[at,Mt,Et[Mt]]}));for(Mt in Et)Et.hasOwnProperty(Mt)&&!_t.hasOwnProperty(Mt)&&"layout"!==Mt&&"paint"!==Mt&&"filter"!==Mt&&"metadata"!==Mt&&"minzoom"!==Mt&&"maxzoom"!==Mt&&(0===Mt.indexOf("paint.")?ht(_t[Mt],Et[Mt],Le,at,Mt.slice(6),kt.setPaintProperty):e.deepEqual(_t[Mt],Et[Mt])||Le.push({command:kt.setLayerProperty,args:[at,Mt,Et[Mt]]}))}else Le.push({command:kt.removeLayer,args:[at]}),Tt=nr[nr.lastIndexOf(at)+1],Le.push({command:kt.addLayer,args:[Et,Tt]})}(ue,D.layers,F)}catch(me){console.warn("Unable to compute style diff:",me),F=[{command:kt.setStyle,args:[D]}]}return F}(this.serialize(),F).filter(function(me){return!(me.command in mn)});if(0===ae.length)return!1;var ue=ae.filter(function(me){return!(me.command in en)});if(ue.length>0)throw new Error("Unimplemented: "+ue.map(function(me){return me.command}).join(", ")+".");return ae.forEach(function(me){"setTransition"!==me.command&&H[me.command].apply(H,me.args)}),this.stylesheet=F,!0},D.prototype.addImage=function(F,H){if(this.getImage(F))return this.fire(new e.ErrorEvent(new Error("An image with this name already exists.")));this.imageManager.addImage(F,H),this._availableImages=this.imageManager.listImages(),this._changedImages[F]=!0,this._changed=!0,this.fire(new e.Event("data",{dataType:"style"}))},D.prototype.updateImage=function(F,H){this.imageManager.updateImage(F,H)},D.prototype.getImage=function(F){return this.imageManager.getImage(F)},D.prototype.removeImage=function(F){if(!this.getImage(F))return this.fire(new e.ErrorEvent(new Error("No image with this name exists.")));this.imageManager.removeImage(F),this._availableImages=this.imageManager.listImages(),this._changedImages[F]=!0,this._changed=!0,this.fire(new e.Event("data",{dataType:"style"}))},D.prototype.listImages=function(){return this._checkLoaded(),this.imageManager.listImages()},D.prototype.addSource=function(F,H,ae){var ue=this;if(void 0===ae&&(ae={}),this._checkLoaded(),void 0!==this.sourceCaches[F])throw new Error("There is already a source with this ID");if(!H.type)throw new Error("The type property must be defined, but the only the following properties were given: "+Object.keys(H).join(", ")+".");if(!(["vector","raster","geojson","video","image"].indexOf(H.type)>=0&&this._validate(e.validateStyle.source,"sources."+F,H,null,ae))){this.map&&this.map._collectResourceTiming&&(H.collectResourceTiming=!0);var me=this.sourceCaches[F]=new Be(F,H,this.dispatcher);me.style=this,me.setEventedParent(this,function(){return{isSourceLoaded:ue.loaded(),source:me.serialize(),sourceId:F}}),me.onAdd(this.map),this._changed=!0}},D.prototype.removeSource=function(F){if(this._checkLoaded(),void 0===this.sourceCaches[F])throw new Error("There is no source with this ID");for(var H in this._layers)if(this._layers[H].source===F)return this.fire(new e.ErrorEvent(new Error('Source "'+F+'" cannot be removed while layer "'+H+'" is using it.')));var ae=this.sourceCaches[F];delete this.sourceCaches[F],delete this._updatedSources[F],ae.fire(new e.Event("data",{sourceDataType:"metadata",dataType:"source",sourceId:F})),ae.setEventedParent(null),ae.clearTiles(),ae.onRemove&&ae.onRemove(this.map),this._changed=!0},D.prototype.setGeoJSONSourceData=function(F,H){this._checkLoaded(),this.sourceCaches[F].getSource().setData(H),this._changed=!0},D.prototype.getSource=function(F){return this.sourceCaches[F]&&this.sourceCaches[F].getSource()},D.prototype.addLayer=function(F,H,ae){void 0===ae&&(ae={}),this._checkLoaded();var ue=F.id;if(this.getLayer(ue))this.fire(new e.ErrorEvent(new Error('Layer with id "'+ue+'" already exists on this map')));else{var me;if("custom"===F.type){if(Qr(this,e.validateCustomStyleLayer(F)))return;me=e.createStyleLayer(F)}else{if("object"==typeof F.source&&(this.addSource(ue,F.source),F=e.clone$1(F),F=e.extend(F,{source:ue})),this._validate(e.validateStyle.layer,"layers."+ue,F,{arrayIndex:-1},ae))return;me=e.createStyleLayer(F),this._validateLayer(me),me.setEventedParent(this,{layer:{id:ue}}),this._serializedLayers[me.id]=me.serialize()}var be=H?this._order.indexOf(H):this._order.length;if(H&&-1===be)this.fire(new e.ErrorEvent(new Error('Layer with id "'+H+'" does not exist on this map.')));else{if(this._order.splice(be,0,ue),this._layerOrderChanged=!0,this._layers[ue]=me,this._removedLayers[ue]&&me.source&&"custom"!==me.type){var Le=this._removedLayers[ue];delete this._removedLayers[ue],Le.type!==me.type?this._updatedSources[me.source]="clear":(this._updatedSources[me.source]="reload",this.sourceCaches[me.source].pause())}this._updateLayer(me),me.onAdd&&me.onAdd(this.map)}}},D.prototype.moveLayer=function(F,H){if(this._checkLoaded(),this._changed=!0,this._layers[F]){if(F!==H){var ae=this._order.indexOf(F);this._order.splice(ae,1);var ue=H?this._order.indexOf(H):this._order.length;H&&-1===ue?this.fire(new e.ErrorEvent(new Error('Layer with id "'+H+'" does not exist on this map.'))):(this._order.splice(ue,0,F),this._layerOrderChanged=!0)}}else this.fire(new e.ErrorEvent(new Error("The layer '"+F+"' does not exist in the map's style and cannot be moved.")))},D.prototype.removeLayer=function(F){this._checkLoaded();var H=this._layers[F];if(H){H.setEventedParent(null);var ae=this._order.indexOf(F);this._order.splice(ae,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[F]=H,delete this._layers[F],delete this._serializedLayers[F],delete this._updatedLayers[F],delete this._updatedPaintProps[F],H.onRemove&&H.onRemove(this.map)}else this.fire(new e.ErrorEvent(new Error("The layer '"+F+"' does not exist in the map's style and cannot be removed.")))},D.prototype.getLayer=function(F){return this._layers[F]},D.prototype.hasLayer=function(F){return F in this._layers},D.prototype.setLayerZoomRange=function(F,H,ae){this._checkLoaded();var ue=this.getLayer(F);ue?ue.minzoom===H&&ue.maxzoom===ae||(null!=H&&(ue.minzoom=H),null!=ae&&(ue.maxzoom=ae),this._updateLayer(ue)):this.fire(new e.ErrorEvent(new Error("The layer '"+F+"' does not exist in the map's style and cannot have zoom extent.")))},D.prototype.setFilter=function(F,H,ae){void 0===ae&&(ae={}),this._checkLoaded();var ue=this.getLayer(F);if(ue){if(!e.deepEqual(ue.filter,H))return null==H?(ue.filter=void 0,void this._updateLayer(ue)):void(this._validate(e.validateStyle.filter,"layers."+ue.id+".filter",H,null,ae)||(ue.filter=e.clone$1(H),this._updateLayer(ue)))}else this.fire(new e.ErrorEvent(new Error("The layer '"+F+"' does not exist in the map's style and cannot be filtered.")))},D.prototype.getFilter=function(F){return e.clone$1(this.getLayer(F).filter)},D.prototype.setLayoutProperty=function(F,H,ae,ue){void 0===ue&&(ue={}),this._checkLoaded();var me=this.getLayer(F);me?e.deepEqual(me.getLayoutProperty(H),ae)||(me.setLayoutProperty(H,ae,ue),this._updateLayer(me)):this.fire(new e.ErrorEvent(new Error("The layer '"+F+"' does not exist in the map's style and cannot be styled.")))},D.prototype.getLayoutProperty=function(F,H){var ae=this.getLayer(F);if(ae)return ae.getLayoutProperty(H);this.fire(new e.ErrorEvent(new Error("The layer '"+F+"' does not exist in the map's style.")))},D.prototype.setPaintProperty=function(F,H,ae,ue){void 0===ue&&(ue={}),this._checkLoaded();var me=this.getLayer(F);me?e.deepEqual(me.getPaintProperty(H),ae)||(me.setPaintProperty(H,ae,ue)&&this._updateLayer(me),this._changed=!0,this._updatedPaintProps[F]=!0):this.fire(new e.ErrorEvent(new Error("The layer '"+F+"' does not exist in the map's style and cannot be styled.")))},D.prototype.getPaintProperty=function(F,H){return this.getLayer(F).getPaintProperty(H)},D.prototype.setFeatureState=function(F,H){this._checkLoaded();var ae=F.source,ue=F.sourceLayer,me=this.sourceCaches[ae];if(void 0!==me){var be=me.getSource().type;"geojson"===be&&ue?this.fire(new e.ErrorEvent(new Error("GeoJSON sources cannot have a sourceLayer parameter."))):"vector"!==be||ue?(void 0===F.id&&this.fire(new e.ErrorEvent(new Error("The feature id parameter must be provided."))),me.setFeatureState(ue,F.id,H)):this.fire(new e.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new e.ErrorEvent(new Error("The source '"+ae+"' does not exist in the map's style.")))},D.prototype.removeFeatureState=function(F,H){this._checkLoaded();var ae=F.source,ue=this.sourceCaches[ae];if(void 0!==ue){var me=ue.getSource().type,be="vector"===me?F.sourceLayer:void 0;"vector"!==me||be?H&&"string"!=typeof F.id&&"number"!=typeof F.id?this.fire(new e.ErrorEvent(new Error("A feature id is requred to remove its specific state property."))):ue.removeFeatureState(be,F.id,H):this.fire(new e.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new e.ErrorEvent(new Error("The source '"+ae+"' does not exist in the map's style.")))},D.prototype.getFeatureState=function(F){this._checkLoaded();var H=F.source,ae=F.sourceLayer,ue=this.sourceCaches[H];if(void 0!==ue){if("vector"!==ue.getSource().type||ae)return void 0===F.id&&this.fire(new e.ErrorEvent(new Error("The feature id parameter must be provided."))),ue.getFeatureState(ae,F.id);this.fire(new e.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new e.ErrorEvent(new Error("The source '"+H+"' does not exist in the map's style.")))},D.prototype.getTransition=function(){return e.extend({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)},D.prototype.serialize=function(){return e.filterObject({version:this.stylesheet.version,name:this.stylesheet.name,metadata:this.stylesheet.metadata,light:this.stylesheet.light,center:this.stylesheet.center,zoom:this.stylesheet.zoom,bearing:this.stylesheet.bearing,pitch:this.stylesheet.pitch,sprite:this.stylesheet.sprite,glyphs:this.stylesheet.glyphs,transition:this.stylesheet.transition,sources:e.mapObject(this.sourceCaches,function(F){return F.serialize()}),layers:this._serializeLayers(this._order)},function(F){return void 0!==F})},D.prototype._updateLayer=function(F){this._updatedLayers[F.id]=!0,F.source&&!this._updatedSources[F.source]&&"raster"!==this.sourceCaches[F.source].getSource().type&&(this._updatedSources[F.source]="reload",this.sourceCaches[F.source].pause()),this._changed=!0},D.prototype._flattenAndSortRenderedFeatures=function(F){for(var H=this,ae=function(cn){return"fill-extrusion"===H._layers[cn].type},ue={},me=[],be=this._order.length-1;be>=0;be--){var Le=this._order[be];if(ae(Le)){ue[Le]=be;for(var qe=0,Qe=F;qe<Qe.length;qe+=1){var at=Qe[qe][Le];if(at)for(var _t=0,Et=at;_t<Et.length;_t+=1)me.push(Et[_t])}}}me.sort(function(cn,an){return an.intersectionZ-cn.intersectionZ});for(var Mt=[],bt=this._order.length-1;bt>=0;bt--){var Dt=this._order[bt];if(ae(Dt))for(var It=me.length-1;It>=0;It--){var Nt=me[It].feature;if(ue[Nt.layer.id]<bt)break;Mt.push(Nt),me.pop()}else for(var nr=0,dr=F;nr<dr.length;nr+=1){var Sr=dr[nr][Dt];if(Sr)for(var Ar=0,Kr=Sr;Ar<Kr.length;Ar+=1)Mt.push(Kr[Ar].feature)}}return Mt},D.prototype.queryRenderedFeatures=function(F,H,ae){H&&H.filter&&this._validate(e.validateStyle.filter,"queryRenderedFeatures.filter",H.filter,null,H);var ue={};if(H&&H.layers){if(!Array.isArray(H.layers))return this.fire(new e.ErrorEvent(new Error("parameters.layers must be an Array."))),[];for(var me=0,be=H.layers;me<be.length;me+=1){var Le=be[me],qe=this._layers[Le];if(!qe)return this.fire(new e.ErrorEvent(new Error("The layer '"+Le+"' does not exist in the map's style and cannot be queried for features."))),[];ue[qe.source]=!0}}var Qe=[];for(var at in H.availableImages=this._availableImages,this.sourceCaches)H.layers&&!ue[at]||Qe.push(U(this.sourceCaches[at],this._layers,this._serializedLayers,F,H,ae));return this.placement&&Qe.push(function(_t,Et,Tt,Mt,bt,Dt,It){for(var Nt={},nr=Dt.queryRenderedSymbols(Mt),dr=[],Sr=0,Ar=Object.keys(nr).map(Number);Sr<Ar.length;Sr+=1)dr.push(It[Ar[Sr]]);dr.sort(te);for(var Jr=function(){var ui=an[cn],Gr=ui.featureIndex.lookupSymbolFeatures(nr[ui.bucketInstanceId],Et,ui.bucketIndex,ui.sourceLayerIndex,bt.filter,bt.layers,bt.availableImages,_t);for(var Tn in Gr){var Xn=Nt[Tn]=Nt[Tn]||[],Hn=Gr[Tn];Hn.sort(function($n,xi){var mi=ui.featureSortOrder;if(mi){var Ci=mi.indexOf($n.featureIndex);return mi.indexOf(xi.featureIndex)-Ci}return xi.featureIndex-$n.featureIndex});for(var ni=0,hi=Hn;ni<hi.length;ni+=1)Xn.push(hi[ni])}},cn=0,an=dr;cn<an.length;cn+=1)Jr();var jn=function(ui){Nt[ui].forEach(function(Gr){var Tn=Gr.feature,Hn=Tt[_t[ui].source].getFeatureState(Tn.layer["source-layer"],Tn.id);Tn.source=Tn.layer.source,Tn.layer["source-layer"]&&(Tn.sourceLayer=Tn.layer["source-layer"]),Tn.state=Hn})};for(var Wn in Nt)jn(Wn);return Nt}(this._layers,this._serializedLayers,this.sourceCaches,F,H,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(Qe)},D.prototype.querySourceFeatures=function(F,H){H&&H.filter&&this._validate(e.validateStyle.filter,"querySourceFeatures.filter",H.filter,null,H);var ae=this.sourceCaches[F];return ae?function(ue,me){for(var be=ue.getRenderableIds().map(function(Et){return ue.getTileByID(Et)}),Le=[],qe={},Qe=0;Qe<be.length;Qe++){var at=be[Qe],_t=at.tileID.canonical.key;qe[_t]||(qe[_t]=!0,at.querySourceFeatures(Le,me))}return Le}(ae,H):[]},D.prototype.addSourceType=function(F,H,ae){return D.getSourceType(F)?ae(new Error('A source type called "'+F+'" already exists.')):(D.setSourceType(F,H),H.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:F,url:H.workerSourceURL},ae):ae(null,null))},D.prototype.getLight=function(){return this.light.getLight()},D.prototype.setLight=function(F,H){void 0===H&&(H={}),this._checkLoaded();var ae=this.light.getLight(),ue=!1;for(var me in F)if(!e.deepEqual(F[me],ae[me])){ue=!0;break}if(ue){var be={now:e.browser.now(),transition:e.extend({duration:300,delay:0},this.stylesheet.transition)};this.light.setLight(F,H),this.light.updateTransitions(be)}},D.prototype._validate=function(F,H,ae,ue,me){return void 0===me&&(me={}),(!me||!1!==me.validate)&&Qr(this,F.call(e.validateStyle,e.extend({key:H,style:this.serialize(),value:ae,styleSpec:e.styleSpec},ue)))},D.prototype._remove=function(){for(var F in this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),e.evented.off("pluginStateChange",this._rtlTextPluginCallback),this._layers)this._layers[F].setEventedParent(null);for(var H in this.sourceCaches)this.sourceCaches[H].clearTiles(),this.sourceCaches[H].setEventedParent(null);this.imageManager.setEventedParent(null),this.setEventedParent(null),this.dispatcher.remove()},D.prototype._clearSource=function(F){this.sourceCaches[F].clearTiles()},D.prototype._reloadSource=function(F){this.sourceCaches[F].resume(),this.sourceCaches[F].reload()},D.prototype._updateSources=function(F){for(var H in this.sourceCaches)this.sourceCaches[H].update(F)},D.prototype._generateCollisionBoxes=function(){for(var F in this.sourceCaches)this._reloadSource(F)},D.prototype._updatePlacement=function(F,H,ae,ue,me){void 0===me&&(me=!1);for(var be=!1,Le=!1,qe={},Qe=0,at=this._order;Qe<at.length;Qe+=1){var Et=this._layers[at[Qe]];if("symbol"===Et.type){if(!qe[Et.source]){var Tt=this.sourceCaches[Et.source];qe[Et.source]=Tt.getRenderableIds(!0).map(function(nr){return Tt.getTileByID(nr)}).sort(function(nr,dr){return dr.tileID.overscaledZ-nr.tileID.overscaledZ||(nr.tileID.isLessThan(dr.tileID)?-1:1)})}var Mt=this.crossTileSymbolIndex.addLayer(Et,qe[Et.source],F.center.lng);be=be||Mt}}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),((me=me||this._layerOrderChanged||0===ae)||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(e.browser.now(),F.zoom))&&(this.pauseablePlacement=new vr(F,this._order,me,H,ae,ue,this.placement),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,qe),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(e.browser.now()),Le=!0),be&&this.pauseablePlacement.placement.setStale()),Le||be)for(var bt=0,Dt=this._order;bt<Dt.length;bt+=1){var Nt=this._layers[Dt[bt]];"symbol"===Nt.type&&this.placement.updateLayerOpacities(Nt,qe[Nt.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(e.browser.now())},D.prototype._releaseSymbolFadeTiles=function(){for(var F in this.sourceCaches)this.sourceCaches[F].releaseSymbolFadeTiles()},D.prototype.getImages=function(F,H,ae){this.imageManager.getImages(H.icons,ae),this._updateTilesForChangedImages();var ue=this.sourceCaches[H.source];ue&&ue.setDependencies(H.tileID.key,H.type,H.icons)},D.prototype.getGlyphs=function(F,H,ae){this.glyphManager.getGlyphs(H.stacks,ae)},D.prototype.getResource=function(F,H,ae){return e.makeRequest(H,ae)},D}(e.Evented);bn.getSourceType=function(C){return B[C]},bn.setSourceType=function(C,D){B[C]=D},bn.registerForPluginStateChange=e.registerForPluginStateChange;var Sn=e.createLayout([{name:"a_pos",type:"Int16",components:2}]),In=Yi("#ifdef GL_ES\nprecision mediump float;\n#else\n#if !defined(lowp)\n#define lowp\n#endif\n#if !defined(mediump)\n#define mediump\n#endif\n#if !defined(highp)\n#define highp\n#endif\n#endif","#ifdef GL_ES\nprecision highp float;\n#else\n#if !defined(lowp)\n#define lowp\n#endif\n#if !defined(mediump)\n#define mediump\n#endif\n#if !defined(highp)\n#define highp\n#endif\n#endif\nvec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0\n);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}"),Yn=Yi("uniform vec4 u_color;uniform float u_opacity;void main() {gl_FragColor=u_color*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),ki=Yi("uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_mix)*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);}"),Ti=Yi("varying vec3 v_data;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define mediump float radius\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define highp vec4 stroke_color\n#pragma mapbox: define mediump float stroke_width\n#pragma mapbox: define lowp float stroke_opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize mediump float radius\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize highp vec4 stroke_color\n#pragma mapbox: initialize mediump float stroke_width\n#pragma mapbox: initialize lowp float stroke_opacity\nvec2 extrude=v_data.xy;float extrude_length=length(extrude);lowp float antialiasblur=v_data.z;float antialiased_blur=-max(blur,antialiasblur);float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width));gl_FragColor=opacity_t*mix(color*opacity,stroke_color*stroke_opacity,color_t);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform bool u_scale_with_map;uniform bool u_pitch_with_map;uniform vec2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;attribute vec2 a_pos;varying vec3 v_data;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define mediump float radius\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define highp vec4 stroke_color\n#pragma mapbox: define mediump float stroke_width\n#pragma mapbox: define lowp float stroke_opacity\nvoid main(void) {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize mediump float radius\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize highp vec4 stroke_color\n#pragma mapbox: initialize mediump float stroke_width\n#pragma mapbox: initialize lowp float stroke_opacity\nvec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);if (u_pitch_with_map) {vec2 corner_position=circle_center;if (u_scale_with_map) {corner_position+=extrude*(radius+stroke_width)*u_extrude_scale;} else {vec4 projected_center=u_matrix*vec4(circle_center,0,1);corner_position+=extrude*(radius+stroke_width)*u_extrude_scale*(projected_center.w/u_camera_to_center_distance);}gl_Position=u_matrix*vec4(corner_position,0,1);} else {gl_Position=u_matrix*vec4(circle_center,0,1);if (u_scale_with_map) {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*u_camera_to_center_distance;} else {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*gl_Position.w;}}lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);}"),kn=Yi("void main() {gl_FragColor=vec4(1.0);}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),Qn=Yi("uniform highp float u_intensity;varying vec2 v_extrude;\n#pragma mapbox: define highp float weight\n#define GAUSS_COEF 0.3989422804014327\nvoid main() {\n#pragma mapbox: initialize highp float weight\nfloat d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);gl_FragColor=vec4(val,1.0,1.0,1.0);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;attribute vec2 a_pos;varying vec2 v_extrude;\n#pragma mapbox: define highp float weight\n#pragma mapbox: define mediump float radius\nconst highp float ZERO=1.0/255.0/16.0;\n#define GAUSS_COEF 0.3989422804014327\nvoid main(void) {\n#pragma mapbox: initialize highp float weight\n#pragma mapbox: initialize mediump float radius\nvec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec4 pos=vec4(floor(a_pos*0.5)+extrude,0,1);gl_Position=u_matrix*pos;}"),Jn=Yi("uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;varying vec2 v_pos;void main() {float t=texture2D(u_image,v_pos).r;vec4 color=texture2D(u_color_ramp,vec2(t,0.5));gl_FragColor=color*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(0.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_world;attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos*u_world,0,1);v_pos.x=a_pos.x;v_pos.y=1.0-a_pos.y;}"),Ii=Yi("varying float v_placed;varying float v_notUsed;void main() {float alpha=0.5;gl_FragColor=vec4(1.0,0.0,0.0,1.0)*alpha;if (v_placed > 0.5) {gl_FragColor=vec4(0.0,0.0,1.0,0.5)*alpha;}if (v_notUsed > 0.5) {gl_FragColor*=.1;}}","attribute vec2 a_pos;attribute vec2 a_anchor_pos;attribute vec2 a_extrude;attribute vec2 a_placed;attribute vec2 a_shift;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;varying float v_placed;varying float v_notUsed;void main() {vec4 projectedPoint=u_matrix*vec4(a_anchor_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);gl_Position=u_matrix*vec4(a_pos,0.0,1.0);gl_Position.xy+=(a_extrude+a_shift)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}"),ha=Yi("varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);gl_FragColor=color*alpha*opacity_t;}","attribute vec2 a_pos;attribute float a_radius;attribute vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),Ia=Yi("uniform highp vec4 u_color;uniform sampler2D u_overlay;varying vec2 v_uv;void main() {vec4 overlay_color=texture2D(u_overlay,v_uv);gl_FragColor=mix(u_color,overlay_color,overlay_color.a);}","attribute vec2 a_pos;varying vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {v_uv=a_pos/8192.0;gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,0,1);}"),oo=Yi("#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float opacity\ngl_FragColor=color*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec2 a_pos;uniform mat4 u_matrix;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float opacity\ngl_Position=u_matrix*vec4(a_pos,0,1);}"),Gi=Yi("varying vec2 v_pos;\n#pragma mapbox: define highp vec4 outline_color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 outline_color\n#pragma mapbox: initialize lowp float opacity\nfloat dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=outline_color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;varying vec2 v_pos;\n#pragma mapbox: define highp vec4 outline_color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 outline_color\n#pragma mapbox: initialize lowp float opacity\ngl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}"),Zi=Yi("uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=mix(color1,color2,u_fade)*alpha*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}"),Ya=Yi("uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_fade)*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);}"),Fi=Yi("varying vec4 v_color;void main() {gl_FragColor=v_color;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;attribute vec2 a_pos;attribute vec4 a_normal_ed;varying vec4 v_color;\n#pragma mapbox: define highp float base\n#pragma mapbox: define highp float height\n#pragma mapbox: define highp vec4 color\nvoid main() {\n#pragma mapbox: initialize highp float base\n#pragma mapbox: initialize highp float height\n#pragma mapbox: initialize highp vec4 color\nvec3 normal=a_normal_ed.xyz;base=max(0.0,base);height=max(0.0,height);float t=mod(normal.x,2.0);gl_Position=u_matrix*vec4(a_pos,t > 0.0 ? height : base,1);float colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;float directional=clamp(dot(normal/16384.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_color.r+=clamp(color.r*directional*u_lightcolor.r,mix(0.0,0.3,1.0-u_lightcolor.r),1.0);v_color.g+=clamp(color.g*directional*u_lightcolor.g,mix(0.0,0.3,1.0-u_lightcolor.g),1.0);v_color.b+=clamp(color.b*directional*u_lightcolor.b,mix(0.0,0.3,1.0-u_lightcolor.b),1.0);v_color*=u_opacity;}"),so=Yi("uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;\n#pragma mapbox: define lowp float base\n#pragma mapbox: define lowp float height\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float base\n#pragma mapbox: initialize lowp float height\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);vec4 mixedColor=mix(color1,color2,u_fade);gl_FragColor=mixedColor*v_lighting;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec3 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;attribute vec2 a_pos;attribute vec4 a_normal_ed;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;\n#pragma mapbox: define lowp float base\n#pragma mapbox: define lowp float height\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float base\n#pragma mapbox: initialize lowp float height\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec3 normal=a_normal_ed.xyz;float edgedistance=a_normal_ed.w;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;base=max(0.0,base);height=max(0.0,height);float t=mod(normal.x,2.0);float z=t > 0.0 ? height : base;gl_Position=u_matrix*vec4(a_pos,z,1);vec2 pos=normal.x==1.0 && normal.y==0.0 && normal.z==16384.0\n? a_pos\n: vec2(edgedistance,z*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal/16383.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;}"),fo=Yi("#ifdef GL_ES\nprecision highp float;\n#endif\nuniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform float u_maxzoom;uniform vec4 u_unpack;float getElevation(vec2 coord,float bias) {vec4 data=texture2D(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y),0.0);float b=getElevation(v_pos+vec2(0,-epsilon.y),0.0);float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y),0.0);float d=getElevation(v_pos+vec2(-epsilon.x,0),0.0);float e=getElevation(v_pos,0.0);float f=getElevation(v_pos+vec2(epsilon.x,0),0.0);float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y),0.0);float h=getElevation(v_pos+vec2(0,epsilon.y),0.0);float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y),0.0);float exaggeration=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;vec2 deriv=vec2((c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c))/ pow(2.0,(u_zoom-u_maxzoom)*exaggeration+19.2562-u_zoom);gl_FragColor=clamp(vec4(deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_dimension;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),ba=Yi("uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;\n#define PI 3.141592653589793\nvoid main() {vec4 pixel=texture2D(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);gl_FragColor=accent_color*(1.0-shade_color.a)+shade_color;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;}"),Wa=Yi("uniform lowp float u_device_pixel_ratio;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\nfloat dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);gl_FragColor=color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","\n#define scale 0.015873016\nattribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp float v_linesofar;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float width\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float width\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_width2=vec2(outset,inset);}"),ho=Yi("uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;varying highp float v_lineprogress;\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\nfloat dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture2D(u_image,vec2(v_lineprogress,0.5));gl_FragColor=color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","\n#define MAX_LINE_DISTANCE 32767.0\n#define scale 0.015873016\nattribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp float v_lineprogress;\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float width\nvoid main() {\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float width\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_lineprogress=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0/MAX_LINE_DISTANCE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_width2=vec2(outset,inset);}"),wo=Yi("uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec3 u_scale;uniform sampler2D u_image;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float aspect_a=display_size_a.y/v_width;float aspect_b=display_size_b.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x*aspect_a,1.0);float x_b=mod(v_linesofar/pattern_size_b.x*aspect_b,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos_a=mix(pattern_tl_a*texel_size-texel_size,pattern_br_a*texel_size+texel_size,vec2(x_a,y));vec2 pos_b=mix(pattern_tl_b*texel_size-texel_size,pattern_br_b*texel_size+texel_size,vec2(x_b,y));vec4 color=mix(texture2D(u_image,pos_a),texture2D(u_image,pos_b),u_fade);gl_FragColor=color*alpha*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","\n#define scale 0.015873016\n#define LINE_DISTANCE_SCALE 2.0\nattribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define mediump float width\n#pragma mapbox: define lowp float floorwidth\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize mediump float width\n#pragma mapbox: initialize lowp float floorwidth\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;}"),Ra=Yi("uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;uniform float u_sdfgamma;uniform float u_mix;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float width\n#pragma mapbox: define lowp float floorwidth\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float width\n#pragma mapbox: initialize lowp float floorwidth\nfloat dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float sdfdist_a=texture2D(u_image,v_tex_a).a;float sdfdist_b=texture2D(u_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);alpha*=smoothstep(0.5-u_sdfgamma/floorwidth,0.5+u_sdfgamma/floorwidth,sdfdist);gl_FragColor=color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","\n#define scale 0.015873016\n#define LINE_DISTANCE_SCALE 2.0\nattribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_patternscale_a;uniform float u_tex_y_a;uniform vec2 u_patternscale_b;uniform float u_tex_y_b;uniform vec2 u_units_to_pixels;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float width\n#pragma mapbox: define lowp float floorwidth\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float width\n#pragma mapbox: initialize lowp float floorwidth\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_tex_a=vec2(a_linesofar*u_patternscale_a.x/floorwidth,normal.y*u_patternscale_a.y+u_tex_y_a);v_tex_b=vec2(a_linesofar*u_patternscale_b.x/floorwidth,normal.y*u_patternscale_b.y+u_tex_y_b);v_width2=vec2(outset,inset);}"),pa=Yi("uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;varying vec2 v_pos0;varying vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture2D(u_image0,v_pos0);vec4 color1=texture2D(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);gl_FragColor=vec4(mix(u_high_vec,u_low_vec,rgb)*color.a,color.a);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_buffer_scale;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;varying vec2 v_pos1;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos0=(((a_texture_pos/8192.0)-0.5)/u_buffer_scale )+0.5;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}"),Ga=Yi("uniform sampler2D u_texture;varying vec2 v_tex;varying float v_fade_opacity;\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\nlowp float alpha=opacity*v_fade_opacity;gl_FragColor=texture2D(u_texture,v_tex)*alpha;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;varying vec2 v_tex;varying float v_fade_opacity;\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_minFontScale=a_pixeloffset.zw/256.0;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*max(a_minFontScale,fontScale)+a_pxoffset/16.0),0.0,1.0);v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;v_fade_opacity=max(0.0,min(1.0,fade_opacity[0]+fade_change));}"),ps=Yi("#define SDF_PX 8.0\nuniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;varying vec2 v_data0;varying vec3 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nfloat EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;varying vec2 v_data0;varying vec3 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset),0.0,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(1.0,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity);}"),vs=Yi("#define SDF_PX 8.0\n#define SDF 1.0\n#define ICON 0.0\nuniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;varying vec4 v_data0;varying vec4 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nfloat fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;gl_FragColor=texture2D(u_texture_icon,tex_icon)*alpha;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\nreturn;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_texsize_icon;varying vec4 v_data0;varying vec4 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale),0.0,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(1.0,fade_opacity[0]+fade_change));v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity,is_sdf);}");function Yi(C,D){var F=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,H={};return{fragmentSource:C=C.replace(F,function(ae,ue,me,be,Le){return H[Le]=!0,"define"===ue?"\n#ifndef HAS_UNIFORM_u_"+Le+"\nvarying "+me+" "+be+" "+Le+";\n#else\nuniform "+me+" "+be+" u_"+Le+";\n#endif\n":"\n#ifdef HAS_UNIFORM_u_"+Le+"\n    "+me+" "+be+" "+Le+" = u_"+Le+";\n#endif\n"}),vertexSource:D=D.replace(F,function(ae,ue,me,be,Le){var qe="float"===be?"vec2":"vec4",Qe=Le.match(/color/)?"color":qe;return H[Le]?"define"===ue?"\n#ifndef HAS_UNIFORM_u_"+Le+"\nuniform lowp float u_"+Le+"_t;\nattribute "+me+" "+qe+" a_"+Le+";\nvarying "+me+" "+be+" "+Le+";\n#else\nuniform "+me+" "+be+" u_"+Le+";\n#endif\n":"vec4"===Qe?"\n#ifndef HAS_UNIFORM_u_"+Le+"\n    "+Le+" = a_"+Le+";\n#else\n    "+me+" "+be+" "+Le+" = u_"+Le+";\n#endif\n":"\n#ifndef HAS_UNIFORM_u_"+Le+"\n    "+Le+" = unpack_mix_"+Qe+"(a_"+Le+", u_"+Le+"_t);\n#else\n    "+me+" "+be+" "+Le+" = u_"+Le+";\n#endif\n":"define"===ue?"\n#ifndef HAS_UNIFORM_u_"+Le+"\nuniform lowp float u_"+Le+"_t;\nattribute "+me+" "+qe+" a_"+Le+";\n#else\nuniform "+me+" "+be+" u_"+Le+";\n#endif\n":"vec4"===Qe?"\n#ifndef HAS_UNIFORM_u_"+Le+"\n    "+me+" "+be+" "+Le+" = a_"+Le+";\n#else\n    "+me+" "+be+" "+Le+" = u_"+Le+";\n#endif\n":"\n#ifndef HAS_UNIFORM_u_"+Le+"\n    "+me+" "+be+" "+Le+" = unpack_mix_"+Qe+"(a_"+Le+", u_"+Le+"_t);\n#else\n    "+me+" "+be+" "+Le+" = u_"+Le+";\n#endif\n"})}}var ss=Object.freeze({__proto__:null,prelude:In,background:Yn,backgroundPattern:ki,circle:Ti,clippingMask:kn,heatmap:Qn,heatmapTexture:Jn,collisionBox:Ii,collisionCircle:ha,debug:Ia,fill:oo,fillOutline:Gi,fillOutlinePattern:Zi,fillPattern:Ya,fillExtrusion:Fi,fillExtrusionPattern:so,hillshadePrepare:fo,hillshade:ba,line:Wa,lineGradient:ho,linePattern:wo,lineSDF:Ra,raster:pa,symbolIcon:Ga,symbolSDF:ps,symbolTextAndIcon:vs}),Wo=function(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null};Wo.prototype.bind=function(C,D,F,H,ae,ue,me,be){this.context=C;for(var Le=this.boundPaintVertexBuffers.length!==H.length,qe=0;!Le&&qe<H.length;qe++)this.boundPaintVertexBuffers[qe]!==H[qe]&&(Le=!0);C.extVertexArrayObject&&this.vao&&this.boundProgram===D&&this.boundLayoutVertexBuffer===F&&!Le&&this.boundIndexBuffer===ae&&this.boundVertexOffset===ue&&this.boundDynamicVertexBuffer===me&&this.boundDynamicVertexBuffer2===be?(C.bindVertexArrayOES.set(this.vao),me&&me.bind(),ae&&ae.dynamicDraw&&ae.bind(),be&&be.bind()):this.freshBind(D,F,H,ae,ue,me,be)},Wo.prototype.freshBind=function(C,D,F,H,ae,ue,me){var be,Le=C.numAttributes,qe=this.context,Qe=qe.gl;if(qe.extVertexArrayObject)this.vao&&this.destroy(),this.vao=qe.extVertexArrayObject.createVertexArrayOES(),qe.bindVertexArrayOES.set(this.vao),be=0,this.boundProgram=C,this.boundLayoutVertexBuffer=D,this.boundPaintVertexBuffers=F,this.boundIndexBuffer=H,this.boundVertexOffset=ae,this.boundDynamicVertexBuffer=ue,this.boundDynamicVertexBuffer2=me;else{be=qe.currentNumAttributes||0;for(var at=Le;at<be;at++)Qe.disableVertexAttribArray(at)}D.enableAttributes(Qe,C);for(var _t=0,Et=F;_t<Et.length;_t+=1)Et[_t].enableAttributes(Qe,C);ue&&ue.enableAttributes(Qe,C),me&&me.enableAttributes(Qe,C),D.bind(),D.setVertexAttribPointers(Qe,C,ae);for(var Tt=0,Mt=F;Tt<Mt.length;Tt+=1){var bt=Mt[Tt];bt.bind(),bt.setVertexAttribPointers(Qe,C,ae)}ue&&(ue.bind(),ue.setVertexAttribPointers(Qe,C,ae)),H&&H.bind(),me&&(me.bind(),me.setVertexAttribPointers(Qe,C,ae)),qe.currentNumAttributes=Le},Wo.prototype.destroy=function(){this.vao&&(this.context.extVertexArrayObject.deleteVertexArrayOES(this.vao),this.vao=null)};var ys=function(C,D,F,H,ae){var ue=C.gl;this.program=ue.createProgram();var me=F?F.defines():[];ae&&me.push("#define OVERDRAW_INSPECTOR;");var be=me.concat(In.fragmentSource,D.fragmentSource).join("\n"),Le=me.concat(In.vertexSource,D.vertexSource).join("\n"),qe=ue.createShader(ue.FRAGMENT_SHADER);if(ue.isContextLost())this.failedToCreate=!0;else{ue.shaderSource(qe,be),ue.compileShader(qe),ue.attachShader(this.program,qe);var Qe=ue.createShader(ue.VERTEX_SHADER);if(ue.isContextLost())this.failedToCreate=!0;else{ue.shaderSource(Qe,Le),ue.compileShader(Qe),ue.attachShader(this.program,Qe);for(var at=F?F.layoutAttributes:[],_t=0;_t<at.length;_t++)ue.bindAttribLocation(this.program,_t,at[_t].name);ue.linkProgram(this.program),ue.deleteShader(Qe),ue.deleteShader(qe),this.numAttributes=ue.getProgramParameter(this.program,ue.ACTIVE_ATTRIBUTES),this.attributes={};for(var Et={},Tt=0;Tt<this.numAttributes;Tt++){var Mt=ue.getActiveAttrib(this.program,Tt);Mt&&(this.attributes[Mt.name]=ue.getAttribLocation(this.program,Mt.name))}for(var bt=ue.getProgramParameter(this.program,ue.ACTIVE_UNIFORMS),Dt=0;Dt<bt;Dt++){var It=ue.getActiveUniform(this.program,Dt);It&&(Et[It.name]=ue.getUniformLocation(this.program,It.name))}this.fixedUniforms=H(C,Et),this.binderUniforms=F?F.getUniforms(C,Et):[]}}};function xs(C,D,F){var H=1/dn(F,1,D.transform.tileZoom),ae=Math.pow(2,F.tileID.overscaledZ),ue=F.tileSize*Math.pow(2,D.transform.tileZoom)/ae,me=ue*(F.tileID.canonical.x+F.tileID.wrap*ae),be=ue*F.tileID.canonical.y;return{u_image:0,u_texsize:F.imageAtlasTexture.size,u_scale:[H,C.fromScale,C.toScale],u_fade:C.t,u_pixel_coord_upper:[me>>16,be>>16],u_pixel_coord_lower:[65535&me,65535&be]}}ys.prototype.draw=function(C,D,F,H,ae,ue,me,be,Le,qe,Qe,at,_t,Et,Tt,Mt){var bt,Dt=C.gl;if(!this.failedToCreate){for(var It in C.program.set(this.program),C.setDepthMode(F),C.setStencilMode(H),C.setColorMode(ae),C.setCullFace(ue),this.fixedUniforms)this.fixedUniforms[It].set(me[It]);Et&&Et.setUniforms(C,this.binderUniforms,at,{zoom:_t});for(var Nt=(bt={},bt[Dt.LINES]=2,bt[Dt.TRIANGLES]=3,bt[Dt.LINE_STRIP]=1,bt)[D],nr=0,dr=Qe.get();nr<dr.length;nr+=1){var Sr=dr[nr],Ar=Sr.vaos||(Sr.vaos={});(Ar[be]||(Ar[be]=new Wo)).bind(C,this,Le,Et?Et.getPaintVertexBuffers():[],qe,Sr.vertexOffset,Tt,Mt),Dt.drawElements(D,Sr.primitiveLength*Nt,Dt.UNSIGNED_SHORT,Sr.primitiveOffset*Nt*2)}}};var ds=function(C,D,F,H){var ae=D.style.light,ue=ae.properties.get("position"),me=[ue.x,ue.y,ue.z],be=e.create$1();"viewport"===ae.properties.get("anchor")&&e.fromRotation(be,-D.transform.angle),e.transformMat3(me,me,be);var Le=ae.properties.get("color");return{u_matrix:C,u_lightpos:me,u_lightintensity:ae.properties.get("intensity"),u_lightcolor:[Le.r,Le.g,Le.b],u_vertical_gradient:+F,u_opacity:H}},bs=function(C,D,F,H,ae,ue,me){return e.extend(ds(C,D,F,H),xs(ue,D,me),{u_height_factor:-Math.pow(2,ae.overscaledZ)/me.tileSize/8})},Ao=function(C){return{u_matrix:C}},Mo=function(C,D,F,H){return e.extend(Ao(C),xs(F,D,H))},Fo=function(C,D){return{u_matrix:C,u_world:D}},Bo=function(C,D,F,H,ae){return e.extend(Mo(C,D,F,H),{u_world:ae})},No=function(C,D,F,H){var ae,ue,me=C.transform;if("map"===H.paint.get("circle-pitch-alignment")){var be=dn(F,1,me.zoom);ae=!0,ue=[be,be]}else ae=!1,ue=me.pixelsToGLUnits;return{u_camera_to_center_distance:me.cameraToCenterDistance,u_scale_with_map:+("map"===H.paint.get("circle-pitch-scale")),u_matrix:C.translatePosMatrix(D.posMatrix,F,H.paint.get("circle-translate"),H.paint.get("circle-translate-anchor")),u_pitch_with_map:+ae,u_device_pixel_ratio:e.browser.devicePixelRatio,u_extrude_scale:ue}},Xo=function(C,D,F){var H=dn(F,1,D.zoom),ae=Math.pow(2,D.zoom-F.tileID.overscaledZ),ue=F.tileID.overscaleFactor();return{u_matrix:C,u_camera_to_center_distance:D.cameraToCenterDistance,u_pixels_to_tile_units:H,u_extrude_scale:[D.pixelsToGLUnits[0]/(H*ae),D.pixelsToGLUnits[1]/(H*ae)],u_overscale_factor:ue}},po=function(C,D,F){return{u_matrix:C,u_inv_matrix:D,u_camera_to_center_distance:F.cameraToCenterDistance,u_viewport_size:[F.width,F.height]}},ls=function(C,D,F){return void 0===F&&(F=1),{u_matrix:C,u_color:D,u_overlay:0,u_overlay_scale:F}},lo=function(C){return{u_matrix:C}},jo=function(C,D,F,H){return{u_matrix:C,u_extrude_scale:dn(D,1,F),u_intensity:H}};function cs(C,D){var F=Math.pow(2,D.canonical.z),H=D.canonical.y;return[new e.MercatorCoordinate(0,H/F).toLngLat().lat,new e.MercatorCoordinate(0,(H+1)/F).toLngLat().lat]}var So=function(C,D,F){var H=C.transform;return{u_matrix:lt(C,D,F),u_ratio:1/dn(D,1,H.zoom),u_device_pixel_ratio:e.browser.devicePixelRatio,u_units_to_pixels:[1/H.pixelsToGLUnits[0],1/H.pixelsToGLUnits[1]]}},qi=function(C,D,F){return e.extend(So(C,D,F),{u_image:0})},Ue=function(C,D,F,H){var ae=C.transform,ue=et(D,ae);return{u_matrix:lt(C,D,F),u_texsize:D.imageAtlasTexture.size,u_ratio:1/dn(D,1,ae.zoom),u_device_pixel_ratio:e.browser.devicePixelRatio,u_image:0,u_scale:[ue,H.fromScale,H.toScale],u_fade:H.t,u_units_to_pixels:[1/ae.pixelsToGLUnits[0],1/ae.pixelsToGLUnits[1]]}},Ze=function(C,D,F,H,ae){var me=C.lineAtlas,be=et(D,C.transform),Le="round"===F.layout.get("line-cap"),qe=me.getDash(H.from,Le),Qe=me.getDash(H.to,Le),at=qe.width*ae.fromScale,_t=Qe.width*ae.toScale;return e.extend(So(C,D,F),{u_patternscale_a:[be/at,-qe.height/2],u_patternscale_b:[be/_t,-Qe.height/2],u_sdfgamma:me.width/(256*Math.min(at,_t)*e.browser.devicePixelRatio)/2,u_image:0,u_tex_y_a:qe.y,u_tex_y_b:Qe.y,u_mix:ae.t})};function et(C,D){return 1/dn(C,1,D.tileZoom)}function lt(C,D,F){return C.translatePosMatrix(D.tileID.posMatrix,D,F.paint.get("line-translate"),F.paint.get("line-translate-anchor"))}var yt=function(C,D,F,H,ae){return{u_matrix:C,u_tl_parent:D,u_scale_parent:F,u_buffer_scale:1,u_fade_t:H.mix,u_opacity:H.opacity*ae.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:ae.paint.get("raster-brightness-min"),u_brightness_high:ae.paint.get("raster-brightness-max"),u_saturation_factor:(me=ae.paint.get("raster-saturation"),me>0?1-1/(1.001-me):-me),u_contrast_factor:(ue=ae.paint.get("raster-contrast"),ue>0?1/(1-ue):1+ue),u_spin_weights:gt(ae.paint.get("raster-hue-rotate"))};var ue,me};function gt(C){C*=Math.PI/180;var D=Math.sin(C),F=Math.cos(C);return[(2*F+1)/3,(-Math.sqrt(3)*D-F+1)/3,(Math.sqrt(3)*D-F+1)/3]}var St,Xt=function(C,D,F,H,ae,ue,me,be,Le,qe){var Qe=ae.transform;return{u_is_size_zoom_constant:+("constant"===C||"source"===C),u_is_size_feature_constant:+("constant"===C||"camera"===C),u_size_t:D?D.uSizeT:0,u_size:D?D.uSize:0,u_camera_to_center_distance:Qe.cameraToCenterDistance,u_pitch:Qe.pitch/360*2*Math.PI,u_rotate_symbol:+F,u_aspect_ratio:Qe.width/Qe.height,u_fade_change:ae.options.fadeDuration?ae.symbolFadeChange:1,u_matrix:ue,u_label_plane_matrix:me,u_coord_matrix:be,u_is_text:+Le,u_pitch_with_map:+H,u_texsize:qe,u_texture:0}},Kt=function(C,D,F,H,ae,ue,me,be,Le,qe,Qe){var at=ae.transform;return e.extend(Xt(C,D,F,H,ae,ue,me,be,Le,qe),{u_gamma_scale:H?Math.cos(at._pitch)*at.cameraToCenterDistance:1,u_device_pixel_ratio:e.browser.devicePixelRatio,u_is_halo:+Qe})},Zt=function(C,D,F,H,ae,ue,me,be,Le,qe){return e.extend(Kt(C,D,F,H,ae,ue,me,be,!0,Le,!0),{u_texsize_icon:qe,u_texture_icon:1})},ir=function(C,D,F){return{u_matrix:C,u_opacity:D,u_color:F}},pr=function(C,D,F,H,ae,ue){return e.extend((be=ue,qe=ae,Qe=(Le=F).imageManager.getPattern((me=H).from.toString()),at=Le.imageManager.getPattern(me.to.toString()),Et=(_t=Le.imageManager.getPixelSize()).width,Tt=_t.height,Mt=Math.pow(2,qe.tileID.overscaledZ),Dt=(bt=qe.tileSize*Math.pow(2,Le.transform.tileZoom)/Mt)*(qe.tileID.canonical.x+qe.tileID.wrap*Mt),It=bt*qe.tileID.canonical.y,{u_image:0,u_pattern_tl_a:Qe.tl,u_pattern_br_a:Qe.br,u_pattern_tl_b:at.tl,u_pattern_br_b:at.br,u_texsize:[Et,Tt],u_mix:be.t,u_pattern_size_a:Qe.displaySize,u_pattern_size_b:at.displaySize,u_scale_a:be.fromScale,u_scale_b:be.toScale,u_tile_units_to_pixels:1/dn(qe,1,Le.transform.tileZoom),u_pixel_coord_upper:[Dt>>16,It>>16],u_pixel_coord_lower:[65535&Dt,65535&It]}),{u_matrix:C,u_opacity:D});var me,be,Le,qe,Qe,at,_t,Et,Tt,Mt,bt,Dt,It},br={fillExtrusion:function(C,D){return{u_matrix:new e.UniformMatrix4f(C,D.u_matrix),u_lightpos:new e.Uniform3f(C,D.u_lightpos),u_lightintensity:new e.Uniform1f(C,D.u_lightintensity),u_lightcolor:new e.Uniform3f(C,D.u_lightcolor),u_vertical_gradient:new e.Uniform1f(C,D.u_vertical_gradient),u_opacity:new e.Uniform1f(C,D.u_opacity)}},fillExtrusionPattern:function(C,D){return{u_matrix:new e.UniformMatrix4f(C,D.u_matrix),u_lightpos:new e.Uniform3f(C,D.u_lightpos),u_lightintensity:new e.Uniform1f(C,D.u_lightintensity),u_lightcolor:new e.Uniform3f(C,D.u_lightcolor),u_vertical_gradient:new e.Uniform1f(C,D.u_vertical_gradient),u_height_factor:new e.Uniform1f(C,D.u_height_factor),u_image:new e.Uniform1i(C,D.u_image),u_texsize:new e.Uniform2f(C,D.u_texsize),u_pixel_coord_upper:new e.Uniform2f(C,D.u_pixel_coord_upper),u_pixel_coord_lower:new e.Uniform2f(C,D.u_pixel_coord_lower),u_scale:new e.Uniform3f(C,D.u_scale),u_fade:new e.Uniform1f(C,D.u_fade),u_opacity:new e.Uniform1f(C,D.u_opacity)}},fill:function(C,D){return{u_matrix:new e.UniformMatrix4f(C,D.u_matrix)}},fillPattern:function(C,D){return{u_matrix:new e.UniformMatrix4f(C,D.u_matrix),u_image:new e.Uniform1i(C,D.u_image),u_texsize:new e.Uniform2f(C,D.u_texsize),u_pixel_coord_upper:new e.Uniform2f(C,D.u_pixel_coord_upper),u_pixel_coord_lower:new e.Uniform2f(C,D.u_pixel_coord_lower),u_scale:new e.Uniform3f(C,D.u_scale),u_fade:new e.Uniform1f(C,D.u_fade)}},fillOutline:function(C,D){return{u_matrix:new e.UniformMatrix4f(C,D.u_matrix),u_world:new e.Uniform2f(C,D.u_world)}},fillOutlinePattern:function(C,D){return{u_matrix:new e.UniformMatrix4f(C,D.u_matrix),u_world:new e.Uniform2f(C,D.u_world),u_image:new e.Uniform1i(C,D.u_image),u_texsize:new e.Uniform2f(C,D.u_texsize),u_pixel_coord_upper:new e.Uniform2f(C,D.u_pixel_coord_upper),u_pixel_coord_lower:new e.Uniform2f(C,D.u_pixel_coord_lower),u_scale:new e.Uniform3f(C,D.u_scale),u_fade:new e.Uniform1f(C,D.u_fade)}},circle:function(C,D){return{u_camera_to_center_distance:new e.Uniform1f(C,D.u_camera_to_center_distance),u_scale_with_map:new e.Uniform1i(C,D.u_scale_with_map),u_pitch_with_map:new e.Uniform1i(C,D.u_pitch_with_map),u_extrude_scale:new e.Uniform2f(C,D.u_extrude_scale),u_device_pixel_ratio:new e.Uniform1f(C,D.u_device_pixel_ratio),u_matrix:new e.UniformMatrix4f(C,D.u_matrix)}},collisionBox:function(C,D){return{u_matrix:new e.UniformMatrix4f(C,D.u_matrix),u_camera_to_center_distance:new e.Uniform1f(C,D.u_camera_to_center_distance),u_pixels_to_tile_units:new e.Uniform1f(C,D.u_pixels_to_tile_units),u_extrude_scale:new e.Uniform2f(C,D.u_extrude_scale),u_overscale_factor:new e.Uniform1f(C,D.u_overscale_factor)}},collisionCircle:function(C,D){return{u_matrix:new e.UniformMatrix4f(C,D.u_matrix),u_inv_matrix:new e.UniformMatrix4f(C,D.u_inv_matrix),u_camera_to_center_distance:new e.Uniform1f(C,D.u_camera_to_center_distance),u_viewport_size:new e.Uniform2f(C,D.u_viewport_size)}},debug:function(C,D){return{u_color:new e.UniformColor(C,D.u_color),u_matrix:new e.UniformMatrix4f(C,D.u_matrix),u_overlay:new e.Uniform1i(C,D.u_overlay),u_overlay_scale:new e.Uniform1f(C,D.u_overlay_scale)}},clippingMask:function(C,D){return{u_matrix:new e.UniformMatrix4f(C,D.u_matrix)}},heatmap:function(C,D){return{u_extrude_scale:new e.Uniform1f(C,D.u_extrude_scale),u_intensity:new e.Uniform1f(C,D.u_intensity),u_matrix:new e.UniformMatrix4f(C,D.u_matrix)}},heatmapTexture:function(C,D){return{u_matrix:new e.UniformMatrix4f(C,D.u_matrix),u_world:new e.Uniform2f(C,D.u_world),u_image:new e.Uniform1i(C,D.u_image),u_color_ramp:new e.Uniform1i(C,D.u_color_ramp),u_opacity:new e.Uniform1f(C,D.u_opacity)}},hillshade:function(C,D){return{u_matrix:new e.UniformMatrix4f(C,D.u_matrix),u_image:new e.Uniform1i(C,D.u_image),u_latrange:new e.Uniform2f(C,D.u_latrange),u_light:new e.Uniform2f(C,D.u_light),u_shadow:new e.UniformColor(C,D.u_shadow),u_highlight:new e.UniformColor(C,D.u_highlight),u_accent:new e.UniformColor(C,D.u_accent)}},hillshadePrepare:function(C,D){return{u_matrix:new e.UniformMatrix4f(C,D.u_matrix),u_image:new e.Uniform1i(C,D.u_image),u_dimension:new e.Uniform2f(C,D.u_dimension),u_zoom:new e.Uniform1f(C,D.u_zoom),u_maxzoom:new e.Uniform1f(C,D.u_maxzoom),u_unpack:new e.Uniform4f(C,D.u_unpack)}},line:function(C,D){return{u_matrix:new e.UniformMatrix4f(C,D.u_matrix),u_ratio:new e.Uniform1f(C,D.u_ratio),u_device_pixel_ratio:new e.Uniform1f(C,D.u_device_pixel_ratio),u_units_to_pixels:new e.Uniform2f(C,D.u_units_to_pixels)}},lineGradient:function(C,D){return{u_matrix:new e.UniformMatrix4f(C,D.u_matrix),u_ratio:new e.Uniform1f(C,D.u_ratio),u_device_pixel_ratio:new e.Uniform1f(C,D.u_device_pixel_ratio),u_units_to_pixels:new e.Uniform2f(C,D.u_units_to_pixels),u_image:new e.Uniform1i(C,D.u_image)}},linePattern:function(C,D){return{u_matrix:new e.UniformMatrix4f(C,D.u_matrix),u_texsize:new e.Uniform2f(C,D.u_texsize),u_ratio:new e.Uniform1f(C,D.u_ratio),u_device_pixel_ratio:new e.Uniform1f(C,D.u_device_pixel_ratio),u_image:new e.Uniform1i(C,D.u_image),u_units_to_pixels:new e.Uniform2f(C,D.u_units_to_pixels),u_scale:new e.Uniform3f(C,D.u_scale),u_fade:new e.Uniform1f(C,D.u_fade)}},lineSDF:function(C,D){return{u_matrix:new e.UniformMatrix4f(C,D.u_matrix),u_ratio:new e.Uniform1f(C,D.u_ratio),u_device_pixel_ratio:new e.Uniform1f(C,D.u_device_pixel_ratio),u_units_to_pixels:new e.Uniform2f(C,D.u_units_to_pixels),u_patternscale_a:new e.Uniform2f(C,D.u_patternscale_a),u_patternscale_b:new e.Uniform2f(C,D.u_patternscale_b),u_sdfgamma:new e.Uniform1f(C,D.u_sdfgamma),u_image:new e.Uniform1i(C,D.u_image),u_tex_y_a:new e.Uniform1f(C,D.u_tex_y_a),u_tex_y_b:new e.Uniform1f(C,D.u_tex_y_b),u_mix:new e.Uniform1f(C,D.u_mix)}},raster:function(C,D){return{u_matrix:new e.UniformMatrix4f(C,D.u_matrix),u_tl_parent:new e.Uniform2f(C,D.u_tl_parent),u_scale_parent:new e.Uniform1f(C,D.u_scale_parent),u_buffer_scale:new e.Uniform1f(C,D.u_buffer_scale),u_fade_t:new e.Uniform1f(C,D.u_fade_t),u_opacity:new e.Uniform1f(C,D.u_opacity),u_image0:new e.Uniform1i(C,D.u_image0),u_image1:new e.Uniform1i(C,D.u_image1),u_brightness_low:new e.Uniform1f(C,D.u_brightness_low),u_brightness_high:new e.Uniform1f(C,D.u_brightness_high),u_saturation_factor:new e.Uniform1f(C,D.u_saturation_factor),u_contrast_factor:new e.Uniform1f(C,D.u_contrast_factor),u_spin_weights:new e.Uniform3f(C,D.u_spin_weights)}},symbolIcon:function(C,D){return{u_is_size_zoom_constant:new e.Uniform1i(C,D.u_is_size_zoom_constant),u_is_size_feature_constant:new e.Uniform1i(C,D.u_is_size_feature_constant),u_size_t:new e.Uniform1f(C,D.u_size_t),u_size:new e.Uniform1f(C,D.u_size),u_camera_to_center_distance:new e.Uniform1f(C,D.u_camera_to_center_distance),u_pitch:new e.Uniform1f(C,D.u_pitch),u_rotate_symbol:new e.Uniform1i(C,D.u_rotate_symbol),u_aspect_ratio:new e.Uniform1f(C,D.u_aspect_ratio),u_fade_change:new e.Uniform1f(C,D.u_fade_change),u_matrix:new e.UniformMatrix4f(C,D.u_matrix),u_label_plane_matrix:new e.UniformMatrix4f(C,D.u_label_plane_matrix),u_coord_matrix:new e.UniformMatrix4f(C,D.u_coord_matrix),u_is_text:new e.Uniform1i(C,D.u_is_text),u_pitch_with_map:new e.Uniform1i(C,D.u_pitch_with_map),u_texsize:new e.Uniform2f(C,D.u_texsize),u_texture:new e.Uniform1i(C,D.u_texture)}},symbolSDF:function(C,D){return{u_is_size_zoom_constant:new e.Uniform1i(C,D.u_is_size_zoom_constant),u_is_size_feature_constant:new e.Uniform1i(C,D.u_is_size_feature_constant),u_size_t:new e.Uniform1f(C,D.u_size_t),u_size:new e.Uniform1f(C,D.u_size),u_camera_to_center_distance:new e.Uniform1f(C,D.u_camera_to_center_distance),u_pitch:new e.Uniform1f(C,D.u_pitch),u_rotate_symbol:new e.Uniform1i(C,D.u_rotate_symbol),u_aspect_ratio:new e.Uniform1f(C,D.u_aspect_ratio),u_fade_change:new e.Uniform1f(C,D.u_fade_change),u_matrix:new e.UniformMatrix4f(C,D.u_matrix),u_label_plane_matrix:new e.UniformMatrix4f(C,D.u_label_plane_matrix),u_coord_matrix:new e.UniformMatrix4f(C,D.u_coord_matrix),u_is_text:new e.Uniform1i(C,D.u_is_text),u_pitch_with_map:new e.Uniform1i(C,D.u_pitch_with_map),u_texsize:new e.Uniform2f(C,D.u_texsize),u_texture:new e.Uniform1i(C,D.u_texture),u_gamma_scale:new e.Uniform1f(C,D.u_gamma_scale),u_device_pixel_ratio:new e.Uniform1f(C,D.u_device_pixel_ratio),u_is_halo:new e.Uniform1i(C,D.u_is_halo)}},symbolTextAndIcon:function(C,D){return{u_is_size_zoom_constant:new e.Uniform1i(C,D.u_is_size_zoom_constant),u_is_size_feature_constant:new e.Uniform1i(C,D.u_is_size_feature_constant),u_size_t:new e.Uniform1f(C,D.u_size_t),u_size:new e.Uniform1f(C,D.u_size),u_camera_to_center_distance:new e.Uniform1f(C,D.u_camera_to_center_distance),u_pitch:new e.Uniform1f(C,D.u_pitch),u_rotate_symbol:new e.Uniform1i(C,D.u_rotate_symbol),u_aspect_ratio:new e.Uniform1f(C,D.u_aspect_ratio),u_fade_change:new e.Uniform1f(C,D.u_fade_change),u_matrix:new e.UniformMatrix4f(C,D.u_matrix),u_label_plane_matrix:new e.UniformMatrix4f(C,D.u_label_plane_matrix),u_coord_matrix:new e.UniformMatrix4f(C,D.u_coord_matrix),u_is_text:new e.Uniform1i(C,D.u_is_text),u_pitch_with_map:new e.Uniform1i(C,D.u_pitch_with_map),u_texsize:new e.Uniform2f(C,D.u_texsize),u_texsize_icon:new e.Uniform2f(C,D.u_texsize_icon),u_texture:new e.Uniform1i(C,D.u_texture),u_texture_icon:new e.Uniform1i(C,D.u_texture_icon),u_gamma_scale:new e.Uniform1f(C,D.u_gamma_scale),u_device_pixel_ratio:new e.Uniform1f(C,D.u_device_pixel_ratio),u_is_halo:new e.Uniform1i(C,D.u_is_halo)}},background:function(C,D){return{u_matrix:new e.UniformMatrix4f(C,D.u_matrix),u_opacity:new e.Uniform1f(C,D.u_opacity),u_color:new e.UniformColor(C,D.u_color)}},backgroundPattern:function(C,D){return{u_matrix:new e.UniformMatrix4f(C,D.u_matrix),u_opacity:new e.Uniform1f(C,D.u_opacity),u_image:new e.Uniform1i(C,D.u_image),u_pattern_tl_a:new e.Uniform2f(C,D.u_pattern_tl_a),u_pattern_br_a:new e.Uniform2f(C,D.u_pattern_br_a),u_pattern_tl_b:new e.Uniform2f(C,D.u_pattern_tl_b),u_pattern_br_b:new e.Uniform2f(C,D.u_pattern_br_b),u_texsize:new e.Uniform2f(C,D.u_texsize),u_mix:new e.Uniform1f(C,D.u_mix),u_pattern_size_a:new e.Uniform2f(C,D.u_pattern_size_a),u_pattern_size_b:new e.Uniform2f(C,D.u_pattern_size_b),u_scale_a:new e.Uniform1f(C,D.u_scale_a),u_scale_b:new e.Uniform1f(C,D.u_scale_b),u_pixel_coord_upper:new e.Uniform2f(C,D.u_pixel_coord_upper),u_pixel_coord_lower:new e.Uniform2f(C,D.u_pixel_coord_lower),u_tile_units_to_pixels:new e.Uniform1f(C,D.u_tile_units_to_pixels)}}};function _r(C,D,F,H,ae,ue,me){for(var be=C.context,Le=be.gl,qe=C.useProgram("collisionBox"),Qe=[],at=0,_t=0,Et=0;Et<H.length;Et++){var Tt=H[Et],Mt=D.getTile(Tt),bt=Mt.getBucket(F);if(bt){var Dt=Tt.posMatrix;0===ae[0]&&0===ae[1]||(Dt=C.translatePosMatrix(Tt.posMatrix,Mt,ae,ue));var It=me?bt.textCollisionBox:bt.iconCollisionBox,Nt=bt.collisionCircleArray;if(Nt.length>0){var nr=e.create(),dr=Dt;e.mul(nr,bt.placementInvProjMatrix,C.transform.glCoordMatrix),e.mul(nr,nr,bt.placementViewportMatrix),Qe.push({circleArray:Nt,circleOffset:_t,transform:dr,invTransform:nr}),_t=at+=Nt.length/4}It&&qe.draw(be,Le.LINES,Ht.disabled,Ve.disabled,C.colorModeForRenderPass(),he.disabled,Xo(Dt,C.transform,Mt),F.id,It.layoutVertexBuffer,It.indexBuffer,It.segments,null,C.transform.zoom,null,null,It.collisionVertexBuffer)}}if(me&&Qe.length){var Sr=C.useProgram("collisionCircle"),Ar=new e.StructArrayLayout2f1f2i16;Ar.resize(4*at),Ar._trim();for(var Kr=0,Jr=0,cn=Qe;Jr<cn.length;Jr+=1)for(var an=cn[Jr],jn=0;jn<an.circleArray.length/4;jn++){var Wn=4*jn,ui=an.circleArray[Wn+0],Gr=an.circleArray[Wn+1],Tn=an.circleArray[Wn+2],Xn=an.circleArray[Wn+3];Ar.emplace(Kr++,ui,Gr,Tn,Xn,0),Ar.emplace(Kr++,ui,Gr,Tn,Xn,1),Ar.emplace(Kr++,ui,Gr,Tn,Xn,2),Ar.emplace(Kr++,ui,Gr,Tn,Xn,3)}(!St||St.length<2*at)&&(St=function(mi){var Ci=2*mi,bi=new e.StructArrayLayout3ui6;bi.resize(Ci),bi._trim();for(var Pi=0;Pi<Ci;Pi++){var Ui=6*Pi;bi.uint16[Ui+0]=4*Pi+0,bi.uint16[Ui+1]=4*Pi+1,bi.uint16[Ui+2]=4*Pi+2,bi.uint16[Ui+3]=4*Pi+2,bi.uint16[Ui+4]=4*Pi+3,bi.uint16[Ui+5]=4*Pi+0}return bi}(at));for(var Hn=be.createIndexBuffer(St,!0),ni=be.createVertexBuffer(Ar,e.collisionCircleLayout.members,!0),hi=0,Si=Qe;hi<Si.length;hi+=1){var $n=Si[hi],xi=po($n.transform,$n.invTransform,C.transform);Sr.draw(be,Le.TRIANGLES,Ht.disabled,Ve.disabled,C.colorModeForRenderPass(),he.disabled,xi,F.id,ni,Hn,e.SegmentVector.simpleSegment(0,2*$n.circleOffset,$n.circleArray.length,$n.circleArray.length/2),null,C.transform.zoom,null,null,null)}ni.destroy(),Hn.destroy()}}var Or=e.identity(new Float32Array(16));function tn(C,D,F,H,ae,ue){var me=e.getAnchorAlignment(C),be=-(me.horizontalAlign-.5)*D,Le=-(me.verticalAlign-.5)*F,qe=e.evaluateVariableOffset(C,H);return new e.Point((be/ae+qe[0])*ue,(Le/ae+qe[1])*ue)}function fn(C,D,F,H,ae,ue,me,be,Le,qe,Qe){var at=C.text.placedSymbolArray,_t=C.text.dynamicLayoutVertexArray,Et=C.icon.dynamicLayoutVertexArray,Tt={};_t.clear();for(var Mt=0;Mt<at.length;Mt++){var bt=at.get(Mt),It=bt.hidden||!bt.crossTileID||C.allowVerticalPlacement&&!bt.placedOrientation?null:H[bt.crossTileID];if(It){var Nt=new e.Point(bt.anchorX,bt.anchorY),nr=Jt(Nt,F?be:me),dr=$t(ue.cameraToCenterDistance,nr.signedDistanceFromCamera),Sr=ae.evaluateSizeForFeature(C.textSizeData,qe,bt)*dr/e.ONE_EM;F&&(Sr*=C.tilePixelRatio/Le);for(var Jr=tn(It.anchor,It.width,It.height,It.textOffset,It.textBoxScale,Sr),cn=F?Jt(Nt.add(Jr),me).point:nr.point.add(D?Jr.rotate(-ue.angle):Jr),an=C.allowVerticalPlacement&&bt.placedOrientation===e.WritingMode.vertical?Math.PI/2:0,jn=0;jn<bt.numGlyphs;jn++)e.addDynamicAttributes(_t,cn,an);Qe&&bt.associatedIconIndex>=0&&(Tt[bt.associatedIconIndex]={shiftedAnchor:cn,angle:an})}else $r(bt.numGlyphs,_t)}if(Qe){Et.clear();for(var Wn=C.icon.placedSymbolArray,ui=0;ui<Wn.length;ui++){var Gr=Wn.get(ui);if(Gr.hidden)$r(Gr.numGlyphs,Et);else{var Tn=Tt[ui];if(Tn)for(var Xn=0;Xn<Gr.numGlyphs;Xn++)e.addDynamicAttributes(Et,Tn.shiftedAnchor,Tn.angle);else $r(Gr.numGlyphs,Et)}}C.icon.dynamicLayoutVertexBuffer.updateData(Et)}C.text.dynamicLayoutVertexBuffer.updateData(_t)}function En(C,D,F){return F.iconsInText&&D?"symbolTextAndIcon":C?"symbolSDF":"symbolIcon"}function On(C,D,F,H,ae,ue,me,be,Le,qe,Qe,at){for(var _t=C.context,Et=_t.gl,Tt=C.transform,Mt="map"===be,bt="map"===Le,Dt=Mt&&"point"!==F.layout.get("symbol-placement"),It=Mt&&!bt&&!Dt,Nt=void 0!==F.layout.get("symbol-sort-key").constantOr(1),nr=C.depthModeForSublayer(0,Ht.ReadOnly),dr=F.layout.get("text-variable-anchor"),Sr=[],Ar=0,Kr=H;Ar<Kr.length;Ar+=1){var Jr=Kr[Ar],cn=D.getTile(Jr),an=cn.getBucket(F);if(an){var jn=ae?an.text:an.icon;if(jn&&jn.segments.get().length){var Wn=jn.programConfigurations.get(F.id),ui=ae||an.sdfIcons,Gr=ae?an.textSizeData:an.iconSizeData,Tn=bt||0!==Tt.pitch,Xn=C.useProgram(En(ui,ae,an),Wn),Hn=e.evaluateSizeForZoom(Gr,Tt.zoom),ni=void 0,hi=[0,0],Si=void 0,$n=void 0,xi=null,mi=void 0;if(ae)Si=cn.glyphAtlasTexture,$n=Et.LINEAR,ni=cn.glyphAtlasTexture.size,an.iconsInText&&(hi=cn.imageAtlasTexture.size,xi=cn.imageAtlasTexture,mi=Tn||C.options.rotating||C.options.zooming||"composite"===Gr.kind||"camera"===Gr.kind?Et.LINEAR:Et.NEAREST);else{var bi=1!==F.layout.get("icon-size").constantOr(0)||an.iconsNeedLinear;Si=cn.imageAtlasTexture,$n=ui||C.options.rotating||C.options.zooming||bi||Tn?Et.LINEAR:Et.NEAREST,ni=cn.imageAtlasTexture.size}var Pi=dn(cn,1,C.transform.zoom),Ui=kr(Jr.posMatrix,bt,Mt,C.transform,Pi),ca=ur(Jr.posMatrix,bt,Mt,C.transform,Pi),Ca=dr&&an.hasTextData(),Pa="none"!==F.layout.get("icon-text-fit")&&Ca&&an.hasIconData();Dt&&cr(an,Jr.posMatrix,C,ae,Ui,ca,bt,qe);var la=C.translatePosMatrix(Jr.posMatrix,cn,ue,me),Ta=Dt||ae&&dr||Pa?Or:Ui,ga=C.translatePosMatrix(ca,cn,ue,me,!0),vo=ui&&0!==F.paint.get(ae?"text-halo-width":"icon-halo-width").constantOr(1),qa={program:Xn,buffers:jn,uniformValues:ui?an.iconsInText?Zt(Gr.kind,Hn,It,bt,C,la,Ta,ga,ni,hi):Kt(Gr.kind,Hn,It,bt,C,la,Ta,ga,ae,ni,!0):Xt(Gr.kind,Hn,It,bt,C,la,Ta,ga,ae,ni),atlasTexture:Si,atlasTextureIcon:xi,atlasInterpolation:$n,atlasInterpolationIcon:mi,isSDF:ui,hasHalo:vo};if(Nt)for(var Oo=0,ms=jn.segments.get();Oo<ms.length;Oo+=1){var Rs=ms[Oo];Sr.push({segments:new e.SegmentVector([Rs]),sortKey:Rs.sortKey,state:qa})}else Sr.push({segments:jn.segments,sortKey:0,state:qa})}}}Nt&&Sr.sort(function(ll,$o){return ll.sortKey-$o.sortKey});for(var sl=0,Js=Sr;sl<Js.length;sl+=1){var Ks=Js[sl],yo=Ks.state;if(_t.activeTexture.set(Et.TEXTURE0),yo.atlasTexture.bind(yo.atlasInterpolation,Et.CLAMP_TO_EDGE),yo.atlasTextureIcon&&(_t.activeTexture.set(Et.TEXTURE1),yo.atlasTextureIcon&&yo.atlasTextureIcon.bind(yo.atlasInterpolationIcon,Et.CLAMP_TO_EDGE)),yo.isSDF){var Us=yo.uniformValues;yo.hasHalo&&(Us.u_is_halo=1,qn(yo.buffers,Ks.segments,F,C,yo.program,nr,Qe,at,Us)),Us.u_is_halo=0}qn(yo.buffers,Ks.segments,F,C,yo.program,nr,Qe,at,yo.uniformValues)}}function qn(C,D,F,H,ae,ue,me,be,Le){var qe=H.context;ae.draw(qe,qe.gl.TRIANGLES,ue,me,be,he.disabled,Le,F.id,C.layoutVertexBuffer,C.indexBuffer,D,F.paint,H.transform.zoom,C.programConfigurations.get(F.id),C.dynamicLayoutVertexBuffer,C.opacityVertexBuffer)}function Dn(C,D,F,H,ae,ue,me){var be,Le,qe,Qe,at,_t=C.context.gl,Et=F.paint.get("fill-pattern"),Tt=Et&&Et.constantOr(1),Mt=F.getCrossfadeParameters();me?(Le=Tt&&!F.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",be=_t.LINES):(Le=Tt?"fillPattern":"fill",be=_t.TRIANGLES);for(var bt=0,Dt=H;bt<Dt.length;bt+=1){var It=Dt[bt],Nt=D.getTile(It);if(!Tt||Nt.patternsLoaded()){var nr=Nt.getBucket(F);if(nr){var dr=nr.programConfigurations.get(F.id),Sr=C.useProgram(Le,dr);Tt&&(C.context.activeTexture.set(_t.TEXTURE0),Nt.imageAtlasTexture.bind(_t.LINEAR,_t.CLAMP_TO_EDGE),dr.updatePaintBuffers(Mt));var Ar=Et.constantOr(null);if(Ar&&Nt.imageAtlas){var Kr=Nt.imageAtlas,Jr=Kr.patternPositions[Ar.to.toString()],cn=Kr.patternPositions[Ar.from.toString()];Jr&&cn&&dr.setConstantPatternPositions(Jr,cn)}var an=C.translatePosMatrix(It.posMatrix,Nt,F.paint.get("fill-translate"),F.paint.get("fill-translate-anchor"));if(me){Qe=nr.indexBuffer2,at=nr.segments2;var jn=[_t.drawingBufferWidth,_t.drawingBufferHeight];qe="fillOutlinePattern"===Le&&Tt?Bo(an,C,Mt,Nt,jn):Fo(an,jn)}else Qe=nr.indexBuffer,at=nr.segments,qe=Tt?Mo(an,C,Mt,Nt):Ao(an);Sr.draw(C.context,be,ae,C.stencilModeForClipping(It),ue,he.disabled,qe,F.id,nr.layoutVertexBuffer,Qe,at,F.paint,C.transform.zoom,dr)}}}}function gi(C,D,F,H,ae,ue,me){for(var be=C.context,Le=be.gl,qe=F.paint.get("fill-extrusion-pattern"),Qe=qe.constantOr(1),at=F.getCrossfadeParameters(),_t=F.paint.get("fill-extrusion-opacity"),Et=0,Tt=H;Et<Tt.length;Et+=1){var Mt=Tt[Et],bt=D.getTile(Mt),Dt=bt.getBucket(F);if(Dt){var It=Dt.programConfigurations.get(F.id),Nt=C.useProgram(Qe?"fillExtrusionPattern":"fillExtrusion",It);Qe&&(C.context.activeTexture.set(Le.TEXTURE0),bt.imageAtlasTexture.bind(Le.LINEAR,Le.CLAMP_TO_EDGE),It.updatePaintBuffers(at));var nr=qe.constantOr(null);if(nr&&bt.imageAtlas){var dr=bt.imageAtlas,Sr=dr.patternPositions[nr.to.toString()],Ar=dr.patternPositions[nr.from.toString()];Sr&&Ar&&It.setConstantPatternPositions(Sr,Ar)}var Kr=C.translatePosMatrix(Mt.posMatrix,bt,F.paint.get("fill-extrusion-translate"),F.paint.get("fill-extrusion-translate-anchor")),Jr=F.paint.get("fill-extrusion-vertical-gradient"),cn=Qe?bs(Kr,C,Jr,_t,Mt,at,bt):ds(Kr,C,Jr,_t);Nt.draw(be,be.gl.TRIANGLES,ae,ue,me,he.backCCW,cn,F.id,Dt.layoutVertexBuffer,Dt.indexBuffer,Dt.segments,F.paint,C.transform.zoom,It)}}}function Ai(C,D,F,H,ae,ue){var me=C.context,be=me.gl,Le=D.fbo;if(Le){var qe=C.useProgram("hillshade");me.activeTexture.set(be.TEXTURE0),be.bindTexture(be.TEXTURE_2D,Le.colorAttachment.get());var Qe=function(at,_t,Et){var Tt=Et.paint.get("hillshade-shadow-color"),Mt=Et.paint.get("hillshade-highlight-color"),bt=Et.paint.get("hillshade-accent-color"),Dt=Et.paint.get("hillshade-illumination-direction")*(Math.PI/180);"viewport"===Et.paint.get("hillshade-illumination-anchor")&&(Dt-=at.transform.angle);var It=!at.options.moving;return{u_matrix:at.transform.calculatePosMatrix(_t.tileID.toUnwrapped(),It),u_image:0,u_latrange:cs(0,_t.tileID),u_light:[Et.paint.get("hillshade-exaggeration"),Dt],u_shadow:Tt,u_highlight:Mt,u_accent:bt}}(C,D,F);qe.draw(me,be.TRIANGLES,H,ae,ue,he.disabled,Qe,F.id,C.rasterBoundsBuffer,C.quadTriangleIndexBuffer,C.rasterBoundsSegments)}}function Ni(C,D,F,H,ae,ue,me){var bt,Dt,It,Nt,nr,be=C.context,Le=be.gl,qe=D.dem;if(qe&&qe.data){var Qe=qe.dim,at=qe.stride,_t=qe.getPixels();if(be.activeTexture.set(Le.TEXTURE1),be.pixelStoreUnpackPremultiplyAlpha.set(!1),D.demTexture=D.demTexture||C.getTileTexture(at),D.demTexture){var Et=D.demTexture;Et.update(_t,{premultiply:!1}),Et.bind(Le.NEAREST,Le.CLAMP_TO_EDGE)}else D.demTexture=new e.Texture(be,_t,Le.RGBA,{premultiply:!1}),D.demTexture.bind(Le.NEAREST,Le.CLAMP_TO_EDGE);be.activeTexture.set(Le.TEXTURE0);var Tt=D.fbo;if(!Tt){var Mt=new e.Texture(be,{width:Qe,height:Qe,data:null},Le.RGBA);Mt.bind(Le.LINEAR,Le.CLAMP_TO_EDGE),(Tt=D.fbo=be.createFramebuffer(Qe,Qe,!0)).colorAttachment.set(Mt.texture)}be.bindFramebuffer.set(Tt.framebuffer),be.viewport.set([0,0,Qe,Qe]),C.useProgram("hillshadePrepare").draw(be,Le.TRIANGLES,ae,ue,me,he.disabled,(bt=D.tileID,It=H,Nt=(Dt=qe).stride,nr=e.create(),e.ortho(nr,0,e.EXTENT,-e.EXTENT,0,0,1),e.translate(nr,nr,[0,-e.EXTENT,0]),{u_matrix:nr,u_image:1,u_dimension:[Nt,Nt],u_zoom:bt.overscaledZ,u_maxzoom:It,u_unpack:Dt.getUnpackVector()}),F.id,C.rasterBoundsBuffer,C.quadTriangleIndexBuffer,C.rasterBoundsSegments),D.needsHillshadePrepare=!1}}function Bi(C,D,F,H,ae){var ue=H.paint.get("raster-fade-duration");if(ue>0){var me=e.browser.now(),be=(me-C.timeAdded)/ue,Le=D?(me-D.timeAdded)/ue:-1,qe=F.getSource(),Qe=ae.coveringZoomLevel({tileSize:qe.tileSize,roundZoom:qe.roundZoom}),at=!D||Math.abs(D.tileID.overscaledZ-Qe)>Math.abs(C.tileID.overscaledZ-Qe),_t=at&&C.refreshedUponExpiration?1:e.clamp(at?be:1-Le,0,1);return C.refreshedUponExpiration&&be>=1&&(C.refreshedUponExpiration=!1),D?{opacity:1,mix:1-_t}:{opacity:_t,mix:0}}return{opacity:1,mix:0}}var ji=new e.Color(1,0,0,1),_a=new e.Color(0,1,0,1),ya=new e.Color(0,0,1,1),aa=new e.Color(1,0,1,1),oa=new e.Color(0,1,1,1);function Fa(C,D,F,H){Ja(C,0,D+F/2,C.transform.width,F,H)}function Xa(C,D,F,H){Ja(C,D-F/2,0,F,C.transform.height,H)}function Ja(C,D,F,H,ae,ue){var me=C.context,be=me.gl;be.enable(be.SCISSOR_TEST),be.scissor(D*e.browser.devicePixelRatio,F*e.browser.devicePixelRatio,H*e.browser.devicePixelRatio,ae*e.browser.devicePixelRatio),me.clear({color:ue}),be.disable(be.SCISSOR_TEST)}function Ka(C,D,F){var H=C.context,ae=H.gl,ue=F.posMatrix,me=C.useProgram("debug"),be=Ht.disabled,Le=Ve.disabled,qe=C.colorModeForRenderPass();H.activeTexture.set(ae.TEXTURE0),C.emptyTexture.bind(ae.LINEAR,ae.CLAMP_TO_EDGE),me.draw(H,ae.LINE_STRIP,be,Le,qe,he.disabled,ls(ue,e.Color.red),"$debug",C.debugBuffer,C.tileBorderIndexBuffer,C.debugSegments);var Qe=D.getTileByID(F.key).latestRawTileData,_t=Math.floor((Qe&&Qe.byteLength||0)/1024),Et=D.getTile(F).tileSize,Tt=512/Math.min(Et,512)*(F.overscaledZ/C.transform.zoom)*.5,Mt=F.canonical.toString();F.overscaledZ!==F.canonical.z&&(Mt+=" => "+F.overscaledZ),function(bt,Dt){bt.initDebugOverlayCanvas();var It=bt.debugOverlayCanvas,Nt=bt.context.gl,nr=bt.debugOverlayCanvas.getContext("2d");nr.clearRect(0,0,It.width,It.height),nr.shadowColor="white",nr.shadowBlur=2,nr.lineWidth=1.5,nr.strokeStyle="white",nr.textBaseline="top",nr.font="bold 36px Open Sans, sans-serif",nr.fillText(Dt,5,5),nr.strokeText(Dt,5,5),bt.debugOverlayTexture.update(It),bt.debugOverlayTexture.bind(Nt.LINEAR,Nt.CLAMP_TO_EDGE)}(C,Mt+" "+_t+"kb"),me.draw(H,ae.TRIANGLES,be,Le,We.alphaBlended,he.disabled,ls(ue,e.Color.transparent,Tt),"$debug",C.debugBuffer,C.quadTriangleIndexBuffer,C.debugSegments)}var Qa={symbol:function(C,D,F,H,ae){if("translucent"===C.renderPass){var ue=Ve.disabled,me=C.colorModeForRenderPass();F.layout.get("text-variable-anchor")&&function(be,Le,qe,Qe,at,_t,Et){for(var Tt=Le.transform,Mt="map"===at,bt="map"===_t,Dt=0,It=be;Dt<It.length;Dt+=1){var Nt=It[Dt],nr=Qe.getTile(Nt),dr=nr.getBucket(qe);if(dr&&dr.text&&dr.text.segments.get().length){var Ar=e.evaluateSizeForZoom(dr.textSizeData,Tt.zoom),Kr=dn(nr,1,Le.transform.zoom),Jr=kr(Nt.posMatrix,bt,Mt,Le.transform,Kr),cn="none"!==qe.layout.get("icon-text-fit")&&dr.hasIconData();if(Ar){var an=Math.pow(2,Tt.zoom-nr.tileID.overscaledZ);fn(dr,Mt,bt,Et,e.symbolSize,Tt,Jr,Nt.posMatrix,an,Ar,cn)}}}}(H,C,F,D,F.layout.get("text-rotation-alignment"),F.layout.get("text-pitch-alignment"),ae),0!==F.paint.get("icon-opacity").constantOr(1)&&On(C,D,F,H,!1,F.paint.get("icon-translate"),F.paint.get("icon-translate-anchor"),F.layout.get("icon-rotation-alignment"),F.layout.get("icon-pitch-alignment"),F.layout.get("icon-keep-upright"),ue,me),0!==F.paint.get("text-opacity").constantOr(1)&&On(C,D,F,H,!0,F.paint.get("text-translate"),F.paint.get("text-translate-anchor"),F.layout.get("text-rotation-alignment"),F.layout.get("text-pitch-alignment"),F.layout.get("text-keep-upright"),ue,me),D.map.showCollisionBoxes&&(_r(C,D,F,H,F.paint.get("text-translate"),F.paint.get("text-translate-anchor"),!0),_r(C,D,F,H,F.paint.get("icon-translate"),F.paint.get("icon-translate-anchor"),!1))}},circle:function(C,D,F,H){if("translucent"===C.renderPass){var ae=F.paint.get("circle-opacity"),ue=F.paint.get("circle-stroke-width"),me=F.paint.get("circle-stroke-opacity"),be=void 0!==F.layout.get("circle-sort-key").constantOr(1);if(0!==ae.constantOr(1)||0!==ue.constantOr(1)&&0!==me.constantOr(1)){for(var Le=C.context,qe=Le.gl,Qe=C.depthModeForSublayer(0,Ht.ReadOnly),at=Ve.disabled,_t=C.colorModeForRenderPass(),Et=[],Tt=0;Tt<H.length;Tt++){var Mt=H[Tt],bt=D.getTile(Mt),Dt=bt.getBucket(F);if(Dt){var It=Dt.programConfigurations.get(F.id),Nt={programConfiguration:It,program:C.useProgram("circle",It),layoutVertexBuffer:Dt.layoutVertexBuffer,indexBuffer:Dt.indexBuffer,uniformValues:No(C,Mt,bt,F)};if(be)for(var nr=0,dr=Dt.segments.get();nr<dr.length;nr+=1){var Sr=dr[nr];Et.push({segments:new e.SegmentVector([Sr]),sortKey:Sr.sortKey,state:Nt})}else Et.push({segments:Dt.segments,sortKey:0,state:Nt})}}be&&Et.sort(function(Xn,Hn){return Xn.sortKey-Hn.sortKey});for(var Ar=0,Kr=Et;Ar<Kr.length;Ar+=1){var Jr=Kr[Ar],cn=Jr.state;cn.program.draw(Le,qe.TRIANGLES,Qe,at,_t,he.disabled,cn.uniformValues,F.id,cn.layoutVertexBuffer,cn.indexBuffer,Jr.segments,F.paint,C.transform.zoom,cn.programConfiguration)}}}},heatmap:function(C,D,F,H){if(0!==F.paint.get("heatmap-opacity"))if("offscreen"===C.renderPass){var ae=C.context,ue=ae.gl,me=Ve.disabled,be=new We([ue.ONE,ue.ONE],e.Color.transparent,[!0,!0,!0,!0]);(function(Mt,bt,Dt){var It=Mt.gl;Mt.activeTexture.set(It.TEXTURE1),Mt.viewport.set([0,0,bt.width/4,bt.height/4]);var dr,Sr,Ar,Kr,Jr,Nt=Dt.heatmapFbo;if(Nt)It.bindTexture(It.TEXTURE_2D,Nt.colorAttachment.get()),Mt.bindFramebuffer.set(Nt.framebuffer);else{var nr=It.createTexture();It.bindTexture(It.TEXTURE_2D,nr),It.texParameteri(It.TEXTURE_2D,It.TEXTURE_WRAP_S,It.CLAMP_TO_EDGE),It.texParameteri(It.TEXTURE_2D,It.TEXTURE_WRAP_T,It.CLAMP_TO_EDGE),It.texParameteri(It.TEXTURE_2D,It.TEXTURE_MIN_FILTER,It.LINEAR),It.texParameteri(It.TEXTURE_2D,It.TEXTURE_MAG_FILTER,It.LINEAR),Ar=nr,Kr=Nt=Dt.heatmapFbo=Mt.createFramebuffer(bt.width/4,bt.height/4,!1),(Jr=(dr=Mt).gl).texImage2D(Jr.TEXTURE_2D,0,Jr.RGBA,(Sr=bt).width/4,Sr.height/4,0,Jr.RGBA,dr.extRenderToTextureHalfFloat?dr.extTextureHalfFloat.HALF_FLOAT_OES:Jr.UNSIGNED_BYTE,null),Kr.colorAttachment.set(Ar)}})(ae,C,F),ae.clear({color:e.Color.transparent});for(var Le=0;Le<H.length;Le++){var qe=H[Le];if(!D.hasRenderableParent(qe)){var Qe=D.getTile(qe),at=Qe.getBucket(F);if(at){var _t=at.programConfigurations.get(F.id);C.useProgram("heatmap",_t).draw(ae,ue.TRIANGLES,Ht.disabled,me,be,he.disabled,jo(qe.posMatrix,Qe,C.transform.zoom,F.paint.get("heatmap-intensity")),F.id,at.layoutVertexBuffer,at.indexBuffer,at.segments,F.paint,C.transform.zoom,_t)}}}ae.viewport.set([0,0,C.width,C.height])}else"translucent"===C.renderPass&&(C.context.setColorMode(C.colorModeForRenderPass()),function(Mt,bt){var Dt=Mt.context,It=Dt.gl,Nt=bt.heatmapFbo;if(Nt){Dt.activeTexture.set(It.TEXTURE0),It.bindTexture(It.TEXTURE_2D,Nt.colorAttachment.get()),Dt.activeTexture.set(It.TEXTURE1);var nr=bt.colorRampTexture;nr||(nr=bt.colorRampTexture=new e.Texture(Dt,bt.colorRamp,It.RGBA)),nr.bind(It.LINEAR,It.CLAMP_TO_EDGE),Mt.useProgram("heatmapTexture").draw(Dt,It.TRIANGLES,Ht.disabled,Ve.disabled,Mt.colorModeForRenderPass(),he.disabled,function(dr,Sr,Ar,Kr){var Jr=e.create();e.ortho(Jr,0,dr.width,dr.height,0,0,1);var cn=dr.context.gl;return{u_matrix:Jr,u_world:[cn.drawingBufferWidth,cn.drawingBufferHeight],u_image:0,u_color_ramp:1,u_opacity:Sr.paint.get("heatmap-opacity")}}(Mt,bt),bt.id,Mt.viewportBuffer,Mt.quadTriangleIndexBuffer,Mt.viewportSegments,bt.paint,Mt.transform.zoom)}}(C,F))},line:function(C,D,F,H){if("translucent"===C.renderPass){var ae=F.paint.get("line-opacity"),ue=F.paint.get("line-width");if(0!==ae.constantOr(1)&&0!==ue.constantOr(1)){var me=C.depthModeForSublayer(0,Ht.ReadOnly),be=C.colorModeForRenderPass(),Le=F.paint.get("line-dasharray"),qe=F.paint.get("line-pattern"),Qe=qe.constantOr(1),at=F.paint.get("line-gradient"),_t=F.getCrossfadeParameters(),Et=Qe?"linePattern":Le?"lineSDF":at?"lineGradient":"line",Tt=C.context,Mt=Tt.gl,bt=!0;if(at){Tt.activeTexture.set(Mt.TEXTURE0);var Dt=F.gradientTexture;if(!F.gradient)return;Dt||(Dt=F.gradientTexture=new e.Texture(Tt,F.gradient,Mt.RGBA)),Dt.bind(Mt.LINEAR,Mt.CLAMP_TO_EDGE)}for(var It=0,Nt=H;It<Nt.length;It+=1){var nr=Nt[It],dr=D.getTile(nr);if(!Qe||dr.patternsLoaded()){var Sr=dr.getBucket(F);if(Sr){var Ar=Sr.programConfigurations.get(F.id),Kr=C.context.program.get(),Jr=C.useProgram(Et,Ar),cn=bt||Jr.program!==Kr,an=qe.constantOr(null);if(an&&dr.imageAtlas){var jn=dr.imageAtlas,Wn=jn.patternPositions[an.to.toString()],ui=jn.patternPositions[an.from.toString()];Wn&&ui&&Ar.setConstantPatternPositions(Wn,ui)}var Gr=Qe?Ue(C,dr,F,_t):Le?Ze(C,dr,F,Le,_t):at?qi(C,dr,F):So(C,dr,F);Qe?(Tt.activeTexture.set(Mt.TEXTURE0),dr.imageAtlasTexture.bind(Mt.LINEAR,Mt.CLAMP_TO_EDGE),Ar.updatePaintBuffers(_t)):Le&&(cn||C.lineAtlas.dirty)&&(Tt.activeTexture.set(Mt.TEXTURE0),C.lineAtlas.bind(Tt)),Jr.draw(Tt,Mt.TRIANGLES,me,C.stencilModeForClipping(nr),be,he.disabled,Gr,F.id,Sr.layoutVertexBuffer,Sr.indexBuffer,Sr.segments,F.paint,C.transform.zoom,Ar),bt=!1}}}}}},fill:function(C,D,F,H){var ae=F.paint.get("fill-color"),ue=F.paint.get("fill-opacity");if(0!==ue.constantOr(1)){var me=C.colorModeForRenderPass(),be=F.paint.get("fill-pattern"),Le=C.opaquePassEnabledForLayer()&&!be.constantOr(1)&&1===ae.constantOr(e.Color.transparent).a&&1===ue.constantOr(0)?"opaque":"translucent";if(C.renderPass===Le){var qe=C.depthModeForSublayer(1,"opaque"===C.renderPass?Ht.ReadWrite:Ht.ReadOnly);Dn(C,D,F,H,qe,me,!1)}if("translucent"===C.renderPass&&F.paint.get("fill-antialias")){var Qe=C.depthModeForSublayer(F.getPaintProperty("fill-outline-color")?2:0,Ht.ReadOnly);Dn(C,D,F,H,Qe,me,!0)}}},"fill-extrusion":function(C,D,F,H){var ae=F.paint.get("fill-extrusion-opacity");if(0!==ae&&"translucent"===C.renderPass){var ue=new Ht(C.context.gl.LEQUAL,Ht.ReadWrite,C.depthRangeFor3D);if(1!==ae||F.paint.get("fill-extrusion-pattern").constantOr(1))gi(C,D,F,H,ue,Ve.disabled,We.disabled),gi(C,D,F,H,ue,C.stencilModeFor3D(),C.colorModeForRenderPass());else{var me=C.colorModeForRenderPass();gi(C,D,F,H,ue,Ve.disabled,me)}}},hillshade:function(C,D,F,H){if("offscreen"===C.renderPass||"translucent"===C.renderPass){for(var ae=C.context,ue=D.getSource().maxzoom,me=C.depthModeForSublayer(0,Ht.ReadOnly),be=C.colorModeForRenderPass(),Le="translucent"===C.renderPass?C.stencilConfigForOverlap(H):[{},H],qe=Le[0],Qe=0,at=Le[1];Qe<at.length;Qe+=1){var _t=at[Qe],Et=D.getTile(_t);Et.needsHillshadePrepare&&"offscreen"===C.renderPass?Ni(C,Et,F,ue,me,Ve.disabled,be):"translucent"===C.renderPass&&Ai(C,Et,F,me,qe[_t.overscaledZ],be)}ae.viewport.set([0,0,C.width,C.height])}},raster:function(C,D,F,H){if("translucent"===C.renderPass&&0!==F.paint.get("raster-opacity")&&H.length)for(var ae=C.context,ue=ae.gl,me=D.getSource(),be=C.useProgram("raster"),Le=C.colorModeForRenderPass(),qe=me instanceof G?[{},H]:C.stencilConfigForOverlap(H),Qe=qe[0],at=qe[1],_t=at[at.length-1].overscaledZ,Et=!C.options.moving,Tt=0,Mt=at;Tt<Mt.length;Tt+=1){var bt=Mt[Tt],Dt=C.depthModeForSublayer(bt.overscaledZ-_t,1===F.paint.get("raster-opacity")?Ht.ReadWrite:Ht.ReadOnly,ue.LESS),It=D.getTile(bt),Nt=C.transform.calculatePosMatrix(bt.toUnwrapped(),Et);It.registerFadeDuration(F.paint.get("raster-fade-duration"));var nr=D.findLoadedParent(bt,0),dr=Bi(It,nr,D,F,C.transform),Sr=void 0,Ar=void 0,Kr="nearest"===F.paint.get("raster-resampling")?ue.NEAREST:ue.LINEAR;ae.activeTexture.set(ue.TEXTURE0),It.texture.bind(Kr,ue.CLAMP_TO_EDGE,ue.LINEAR_MIPMAP_NEAREST),ae.activeTexture.set(ue.TEXTURE1),nr?(nr.texture.bind(Kr,ue.CLAMP_TO_EDGE,ue.LINEAR_MIPMAP_NEAREST),Sr=Math.pow(2,nr.tileID.overscaledZ-It.tileID.overscaledZ),Ar=[It.tileID.canonical.x*Sr%1,It.tileID.canonical.y*Sr%1]):It.texture.bind(Kr,ue.CLAMP_TO_EDGE,ue.LINEAR_MIPMAP_NEAREST);var Jr=yt(Nt,Ar||[0,0],Sr||1,dr,F);me instanceof G?be.draw(ae,ue.TRIANGLES,Dt,Ve.disabled,Le,he.disabled,Jr,F.id,me.boundsBuffer,C.quadTriangleIndexBuffer,me.boundsSegments):be.draw(ae,ue.TRIANGLES,Dt,Qe[bt.overscaledZ],Le,he.disabled,Jr,F.id,C.rasterBoundsBuffer,C.quadTriangleIndexBuffer,C.rasterBoundsSegments)}},background:function(C,D,F){var H=F.paint.get("background-color"),ae=F.paint.get("background-opacity");if(0!==ae){var ue=C.context,me=ue.gl,be=C.transform,Le=be.tileSize,qe=F.paint.get("background-pattern");if(!C.isPatternMissing(qe)){var Qe=!qe&&1===H.a&&1===ae&&C.opaquePassEnabledForLayer()?"opaque":"translucent";if(C.renderPass===Qe){var at=Ve.disabled,_t=C.depthModeForSublayer(0,"opaque"===Qe?Ht.ReadWrite:Ht.ReadOnly),Et=C.colorModeForRenderPass(),Tt=C.useProgram(qe?"backgroundPattern":"background"),Mt=be.coveringTiles({tileSize:Le});qe&&(ue.activeTexture.set(me.TEXTURE0),C.imageManager.bind(C.context));for(var bt=F.getCrossfadeParameters(),Dt=0,It=Mt;Dt<It.length;Dt+=1){var Nt=It[Dt],nr=C.transform.calculatePosMatrix(Nt.toUnwrapped()),dr=qe?pr(nr,ae,C,qe,{tileID:Nt,tileSize:Le},bt):ir(nr,ae,H);Tt.draw(ue,me.TRIANGLES,_t,at,Et,he.disabled,dr,F.id,C.tileExtentBuffer,C.quadTriangleIndexBuffer,C.tileExtentSegments)}}}}},debug:function(C,D,F){for(var H=0;H<F.length;H++)Ka(C,D,F[H])},custom:function(C,D,F){var H=C.context,ae=F.implementation;if("offscreen"===C.renderPass){var ue=ae.prerender;ue&&(C.setCustomLayerDefaults(),H.setColorMode(C.colorModeForRenderPass()),ue.call(ae,H.gl,C.transform.customLayerMatrix()),H.setDirty(),C.setBaseState())}else if("translucent"===C.renderPass){C.setCustomLayerDefaults(),H.setColorMode(C.colorModeForRenderPass()),H.setStencilMode(Ve.disabled);var me="3d"===ae.renderingMode?new Ht(C.context.gl.LEQUAL,Ht.ReadWrite,C.depthRangeFor3D):C.depthModeForSublayer(0,Ht.ReadOnly);H.setDepthMode(me),ae.render(H.gl,C.transform.customLayerMatrix()),H.setDirty(),C.setBaseState(),H.bindFramebuffer.set(null)}}},Oi=function(C,D){this.context=new ye(C),this.transform=D,this._tileTextures={},this.setup(),this.numSublayers=Be.maxUnderzooming+Be.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new Vr,this.gpuTimers={}};Oi.prototype.resize=function(C,D){if(this.width=C*e.browser.devicePixelRatio,this.height=D*e.browser.devicePixelRatio,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(var F=0,H=this.style._order;F<H.length;F+=1)this.style._layers[H[F]].resize()},Oi.prototype.setup=function(){var C=this.context,D=new e.StructArrayLayout2i4;D.emplaceBack(0,0),D.emplaceBack(e.EXTENT,0),D.emplaceBack(0,e.EXTENT),D.emplaceBack(e.EXTENT,e.EXTENT),this.tileExtentBuffer=C.createVertexBuffer(D,Sn.members),this.tileExtentSegments=e.SegmentVector.simpleSegment(0,0,4,2);var F=new e.StructArrayLayout2i4;F.emplaceBack(0,0),F.emplaceBack(e.EXTENT,0),F.emplaceBack(0,e.EXTENT),F.emplaceBack(e.EXTENT,e.EXTENT),this.debugBuffer=C.createVertexBuffer(F,Sn.members),this.debugSegments=e.SegmentVector.simpleSegment(0,0,4,5);var H=new e.StructArrayLayout4i8;H.emplaceBack(0,0,0,0),H.emplaceBack(e.EXTENT,0,e.EXTENT,0),H.emplaceBack(0,e.EXTENT,0,e.EXTENT),H.emplaceBack(e.EXTENT,e.EXTENT,e.EXTENT,e.EXTENT),this.rasterBoundsBuffer=C.createVertexBuffer(H,K.members),this.rasterBoundsSegments=e.SegmentVector.simpleSegment(0,0,4,2);var ae=new e.StructArrayLayout2i4;ae.emplaceBack(0,0),ae.emplaceBack(1,0),ae.emplaceBack(0,1),ae.emplaceBack(1,1),this.viewportBuffer=C.createVertexBuffer(ae,Sn.members),this.viewportSegments=e.SegmentVector.simpleSegment(0,0,4,2);var ue=new e.StructArrayLayout1ui2;ue.emplaceBack(0),ue.emplaceBack(1),ue.emplaceBack(3),ue.emplaceBack(2),ue.emplaceBack(0),this.tileBorderIndexBuffer=C.createIndexBuffer(ue);var me=new e.StructArrayLayout3ui6;me.emplaceBack(0,1,2),me.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=C.createIndexBuffer(me),this.emptyTexture=new e.Texture(C,{width:1,height:1,data:new Uint8Array([0,0,0,0])},C.gl.RGBA);var be=this.context.gl;this.stencilClearMode=new Ve({func:be.ALWAYS,mask:0},0,255,be.ZERO,be.ZERO,be.ZERO)},Oi.prototype.clearStencil=function(){var C=this.context,D=C.gl;this.nextStencilID=1,this.currentStencilSource=void 0;var F=e.create();e.ortho(F,0,this.width,this.height,0,0,1),e.scale(F,F,[D.drawingBufferWidth,D.drawingBufferHeight,0]),this.useProgram("clippingMask").draw(C,D.TRIANGLES,Ht.disabled,this.stencilClearMode,We.disabled,he.disabled,lo(F),"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)},Oi.prototype._renderTileClippingMasks=function(C,D){if(this.currentStencilSource!==C.source&&C.isTileClipped()&&D&&D.length){this.currentStencilSource=C.source;var F=this.context,H=F.gl;this.nextStencilID+D.length>256&&this.clearStencil(),F.setColorMode(We.disabled),F.setDepthMode(Ht.disabled);var ae=this.useProgram("clippingMask");this._tileClippingMaskIDs={};for(var ue=0,me=D;ue<me.length;ue+=1){var be=me[ue],Le=this._tileClippingMaskIDs[be.key]=this.nextStencilID++;ae.draw(F,H.TRIANGLES,Ht.disabled,new Ve({func:H.ALWAYS,mask:0},Le,255,H.KEEP,H.KEEP,H.REPLACE),We.disabled,he.disabled,lo(be.posMatrix),"$clipping",this.tileExtentBuffer,this.quadTriangleIndexBuffer,this.tileExtentSegments)}}},Oi.prototype.stencilModeFor3D=function(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();var C=this.nextStencilID++,D=this.context.gl;return new Ve({func:D.NOTEQUAL,mask:255},C,255,D.KEEP,D.KEEP,D.REPLACE)},Oi.prototype.stencilModeForClipping=function(C){var D=this.context.gl;return new Ve({func:D.EQUAL,mask:255},this._tileClippingMaskIDs[C.key],0,D.KEEP,D.KEEP,D.REPLACE)},Oi.prototype.stencilConfigForOverlap=function(C){var D,F=this.context.gl,H=C.sort(function(Le,qe){return qe.overscaledZ-Le.overscaledZ}),ae=H[H.length-1].overscaledZ,ue=H[0].overscaledZ-ae+1;if(ue>1){this.currentStencilSource=void 0,this.nextStencilID+ue>256&&this.clearStencil();for(var me={},be=0;be<ue;be++)me[be+ae]=new Ve({func:F.GEQUAL,mask:255},be+this.nextStencilID,255,F.KEEP,F.KEEP,F.REPLACE);return this.nextStencilID+=ue,[me,H]}return[(D={},D[ae]=Ve.disabled,D),H]},Oi.prototype.colorModeForRenderPass=function(){var C=this.context.gl;return this._showOverdrawInspector?new We([C.CONSTANT_COLOR,C.ONE],new e.Color(1/8,1/8,1/8,0),[!0,!0,!0,!0]):"opaque"===this.renderPass?We.unblended:We.alphaBlended},Oi.prototype.depthModeForSublayer=function(C,D,F){if(!this.opaquePassEnabledForLayer())return Ht.disabled;var H=1-((1+this.currentLayer)*this.numSublayers+C)*this.depthEpsilon;return new Ht(F||this.context.gl.LEQUAL,D,[H,H])},Oi.prototype.opaquePassEnabledForLayer=function(){return this.currentLayer<this.opaquePassCutoff},Oi.prototype.render=function(C,D){var F=this;this.style=C,this.options=D,this.lineAtlas=C.lineAtlas,this.imageManager=C.imageManager,this.glyphManager=C.glyphManager,this.symbolFadeChange=C.placement.symbolFadeChange(e.browser.now()),this.imageManager.beginFrame();var H=this.style._order,ae=this.style.sourceCaches;for(var ue in ae){var me=ae[ue];me.used&&me.prepare(this.context)}var be,Le,qe={},Qe={},at={};for(var _t in ae){var Et=ae[_t];qe[_t]=Et.getVisibleCoordinates(),Qe[_t]=qe[_t].slice().reverse(),at[_t]=Et.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(var Tt=0;Tt<H.length;Tt++)if(this.style._layers[H[Tt]].is3D()){this.opaquePassCutoff=Tt;break}this.renderPass="offscreen";for(var bt=0,Dt=H;bt<Dt.length;bt+=1){var Nt=this.style._layers[Dt[bt]];if(Nt.hasOffscreenPass()&&!Nt.isHidden(this.transform.zoom)){var nr=Qe[Nt.source];("custom"===Nt.type||nr.length)&&this.renderLayer(this,ae[Nt.source],Nt,nr)}}for(this.context.bindFramebuffer.set(null),this.context.clear({color:D.showOverdrawInspector?e.Color.black:e.Color.transparent,depth:1}),this.clearStencil(),this._showOverdrawInspector=D.showOverdrawInspector,this.depthRangeFor3D=[0,1-(C._order.length+2)*this.numSublayers*this.depthEpsilon],this.renderPass="opaque",this.currentLayer=H.length-1;this.currentLayer>=0;this.currentLayer--){var dr=this.style._layers[H[this.currentLayer]],Sr=ae[dr.source],Ar=qe[dr.source];this._renderTileClippingMasks(dr,Ar),this.renderLayer(this,Sr,dr,Ar)}for(this.renderPass="translucent",this.currentLayer=0;this.currentLayer<H.length;this.currentLayer++){var Kr=this.style._layers[H[this.currentLayer]],Jr=ae[Kr.source],cn=("symbol"===Kr.type?at:Qe)[Kr.source];this._renderTileClippingMasks(Kr,qe[Kr.source]),this.renderLayer(this,Jr,Kr,cn)}this.options.showTileBoundaries&&(e.values(this.style._layers).forEach(function(an){an.source&&!an.isHidden(F.transform.zoom)&&(an.source!==(Le&&Le.id)&&(Le=F.style.sourceCaches[an.source]),(!be||be.getSource().maxzoom<Le.getSource().maxzoom)&&(be=Le))}),be&&Qa.debug(this,be,be.getVisibleCoordinates())),this.options.showPadding&&function xa(C){var D=C.transform.padding;Fa(C,C.transform.height-(D.top||0),3,ji),Fa(C,D.bottom||0,3,_a),Xa(C,D.left||0,3,ya),Xa(C,C.transform.width-(D.right||0),3,aa);var H,ae,ue,me,F=C.transform.centerPoint;Ja(H=C,(ae=F.x)-1,(ue=C.transform.height-F.y)-10,2,20,me=oa),Ja(H,ae-10,ue-1,20,2,me)}(this),this.context.setDefault()},Oi.prototype.renderLayer=function(C,D,F,H){F.isHidden(this.transform.zoom)||("background"===F.type||"custom"===F.type||H.length)&&(this.id=F.id,this.gpuTimingStart(F),Qa[F.type](C,D,F,H,this.style.placement.variableOffsets),this.gpuTimingEnd())},Oi.prototype.gpuTimingStart=function(C){if(this.options.gpuTiming){var D=this.context.extTimerQuery,F=this.gpuTimers[C.id];F||(F=this.gpuTimers[C.id]={calls:0,cpuTime:0,query:D.createQueryEXT()}),F.calls++,D.beginQueryEXT(D.TIME_ELAPSED_EXT,F.query)}},Oi.prototype.gpuTimingEnd=function(){if(this.options.gpuTiming){var C=this.context.extTimerQuery;C.endQueryEXT(C.TIME_ELAPSED_EXT)}},Oi.prototype.collectGpuTimers=function(){var C=this.gpuTimers;return this.gpuTimers={},C},Oi.prototype.queryGpuTimers=function(C){var D={};for(var F in C){var H=C[F],ae=this.context.extTimerQuery,ue=ae.getQueryObjectEXT(H.query,ae.QUERY_RESULT_EXT)/1e6;ae.deleteQueryEXT(H.query),D[F]=ue}return D},Oi.prototype.translatePosMatrix=function(C,D,F,H,ae){if(!F[0]&&!F[1])return C;var ue=ae?"map"===H?this.transform.angle:0:"viewport"===H?-this.transform.angle:0;if(ue){var me=Math.sin(ue),be=Math.cos(ue);F=[F[0]*be-F[1]*me,F[0]*me+F[1]*be]}var Le=[ae?F[0]:dn(D,F[0],this.transform.zoom),ae?F[1]:dn(D,F[1],this.transform.zoom),0],qe=new Float32Array(16);return e.translate(qe,C,Le),qe},Oi.prototype.saveTileTexture=function(C){var D=this._tileTextures[C.size[0]];D?D.push(C):this._tileTextures[C.size[0]]=[C]},Oi.prototype.getTileTexture=function(C){var D=this._tileTextures[C];return D&&D.length>0?D.pop():null},Oi.prototype.isPatternMissing=function(C){if(!C)return!1;if(!C.from||!C.to)return!0;var D=this.imageManager.getPattern(C.from.toString()),F=this.imageManager.getPattern(C.to.toString());return!D||!F},Oi.prototype.useProgram=function(C,D){this.cache=this.cache||{};var F=""+C+(D?D.cacheKey:"")+(this._showOverdrawInspector?"/overdraw":"");return this.cache[F]||(this.cache[F]=new ys(this.context,ss[C],D,br[C],this._showOverdrawInspector)),this.cache[F]},Oi.prototype.setCustomLayerDefaults=function(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()},Oi.prototype.setBaseState=function(){var C=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(C.FUNC_ADD)},Oi.prototype.initDebugOverlayCanvas=function(){null==this.debugOverlayCanvas&&(this.debugOverlayCanvas=e.window.document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new e.Texture(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))},Oi.prototype.destroy=function(){this.emptyTexture.destroy(),this.debugOverlayTexture&&this.debugOverlayTexture.destroy()};var pt=function(C,D){this.points=C,this.planes=D};pt.fromInvProjectionMatrix=function(C,D,F){var H=Math.pow(2,F),ae=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(function(me){return e.transformMat4([],me,C)}).map(function(me){return e.scale$1([],me,1/me[3]/D*H)}),ue=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(function(me){var be=e.sub([],ae[me[0]],ae[me[1]]),Le=e.sub([],ae[me[2]],ae[me[1]]),qe=e.normalize([],e.cross([],be,Le)),Qe=-e.dot(qe,ae[me[1]]);return qe.concat(Qe)});return new pt(ae,ue)};var Ot=function(C,D){this.min=C,this.max=D,this.center=e.scale$2([],e.add([],this.min,this.max),.5)};Ot.prototype.quadrant=function(C){for(var D=[C%2==0,C<2],F=e.clone$2(this.min),H=e.clone$2(this.max),ae=0;ae<D.length;ae++)F[ae]=D[ae]?this.min[ae]:this.center[ae],H[ae]=D[ae]?this.center[ae]:this.max[ae];return H[2]=this.max[2],new Ot(F,H)},Ot.prototype.distanceX=function(C){return Math.max(Math.min(this.max[0],C[0]),this.min[0])-C[0]},Ot.prototype.distanceY=function(C){return Math.max(Math.min(this.max[1],C[1]),this.min[1])-C[1]},Ot.prototype.intersects=function(C){for(var D=[[this.min[0],this.min[1],0,1],[this.max[0],this.min[1],0,1],[this.max[0],this.max[1],0,1],[this.min[0],this.max[1],0,1]],F=!0,H=0;H<C.planes.length;H++){for(var ae=C.planes[H],ue=0,me=0;me<D.length;me++)ue+=e.dot$1(ae,D[me])>=0;if(0===ue)return 0;ue!==D.length&&(F=!1)}if(F)return 2;for(var be=0;be<3;be++){for(var Le=Number.MAX_VALUE,qe=-Number.MAX_VALUE,Qe=0;Qe<C.points.length;Qe++){var at=C.points[Qe][be]-this.min[be];Le=Math.min(Le,at),qe=Math.max(qe,at)}if(qe<0||Le>this.max[be]-this.min[be])return 0}return 1};var sr=function(C,D,F,H){if(void 0===C&&(C=0),void 0===D&&(D=0),void 0===F&&(F=0),void 0===H&&(H=0),isNaN(C)||C<0||isNaN(D)||D<0||isNaN(F)||F<0||isNaN(H)||H<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=C,this.bottom=D,this.left=F,this.right=H};sr.prototype.interpolate=function(C,D,F){return null!=D.top&&null!=C.top&&(this.top=e.number(C.top,D.top,F)),null!=D.bottom&&null!=C.bottom&&(this.bottom=e.number(C.bottom,D.bottom,F)),null!=D.left&&null!=C.left&&(this.left=e.number(C.left,D.left,F)),null!=D.right&&null!=C.right&&(this.right=e.number(C.right,D.right,F)),this},sr.prototype.getCenter=function(C,D){var F=e.clamp((this.left+C-this.right)/2,0,C),H=e.clamp((this.top+D-this.bottom)/2,0,D);return new e.Point(F,H)},sr.prototype.equals=function(C){return this.top===C.top&&this.bottom===C.bottom&&this.left===C.left&&this.right===C.right},sr.prototype.clone=function(){return new sr(this.top,this.bottom,this.left,this.right)},sr.prototype.toJSON=function(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}};var Vt=function(C,D,F,H,ae){this.tileSize=512,this.maxValidLatitude=85.051129,this._renderWorldCopies=void 0===ae||ae,this._minZoom=C||0,this._maxZoom=D||22,this._minPitch=F??0,this._maxPitch=H??60,this.setMaxBounds(),this.width=0,this.height=0,this._center=new e.LngLat(0,0),this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._unmodified=!0,this._edgeInsets=new sr,this._posMatrixCache={},this._alignedPosMatrixCache={}},lr={minZoom:{configurable:!0},maxZoom:{configurable:!0},minPitch:{configurable:!0},maxPitch:{configurable:!0},renderWorldCopies:{configurable:!0},worldSize:{configurable:!0},centerOffset:{configurable:!0},size:{configurable:!0},bearing:{configurable:!0},pitch:{configurable:!0},fov:{configurable:!0},zoom:{configurable:!0},center:{configurable:!0},padding:{configurable:!0},centerPoint:{configurable:!0},unmodified:{configurable:!0},point:{configurable:!0}};Vt.prototype.clone=function(){var C=new Vt(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies);return C.tileSize=this.tileSize,C.latRange=this.latRange,C.width=this.width,C.height=this.height,C._center=this._center,C.zoom=this.zoom,C.angle=this.angle,C._fov=this._fov,C._pitch=this._pitch,C._unmodified=this._unmodified,C._edgeInsets=this._edgeInsets.clone(),C._calcMatrices(),C},lr.minZoom.get=function(){return this._minZoom},lr.minZoom.set=function(C){this._minZoom!==C&&(this._minZoom=C,this.zoom=Math.max(this.zoom,C))},lr.maxZoom.get=function(){return this._maxZoom},lr.maxZoom.set=function(C){this._maxZoom!==C&&(this._maxZoom=C,this.zoom=Math.min(this.zoom,C))},lr.minPitch.get=function(){return this._minPitch},lr.minPitch.set=function(C){this._minPitch!==C&&(this._minPitch=C,this.pitch=Math.max(this.pitch,C))},lr.maxPitch.get=function(){return this._maxPitch},lr.maxPitch.set=function(C){this._maxPitch!==C&&(this._maxPitch=C,this.pitch=Math.min(this.pitch,C))},lr.renderWorldCopies.get=function(){return this._renderWorldCopies},lr.renderWorldCopies.set=function(C){void 0===C?C=!0:null===C&&(C=!1),this._renderWorldCopies=C},lr.worldSize.get=function(){return this.tileSize*this.scale},lr.centerOffset.get=function(){return this.centerPoint._sub(this.size._div(2))},lr.size.get=function(){return new e.Point(this.width,this.height)},lr.bearing.get=function(){return-this.angle/Math.PI*180},lr.bearing.set=function(C){var D=-e.wrap(C,-180,180)*Math.PI/180;this.angle!==D&&(this._unmodified=!1,this.angle=D,this._calcMatrices(),this.rotationMatrix=e.create$2(),e.rotate(this.rotationMatrix,this.rotationMatrix,this.angle))},lr.pitch.get=function(){return this._pitch/Math.PI*180},lr.pitch.set=function(C){var D=e.clamp(C,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==D&&(this._unmodified=!1,this._pitch=D,this._calcMatrices())},lr.fov.get=function(){return this._fov/Math.PI*180},lr.fov.set=function(C){C=Math.max(.01,Math.min(60,C)),this._fov!==C&&(this._unmodified=!1,this._fov=C/180*Math.PI,this._calcMatrices())},lr.zoom.get=function(){return this._zoom},lr.zoom.set=function(C){var D=Math.min(Math.max(C,this.minZoom),this.maxZoom);this._zoom!==D&&(this._unmodified=!1,this._zoom=D,this.scale=this.zoomScale(D),this.tileZoom=Math.floor(D),this.zoomFraction=D-this.tileZoom,this._constrain(),this._calcMatrices())},lr.center.get=function(){return this._center},lr.center.set=function(C){C.lat===this._center.lat&&C.lng===this._center.lng||(this._unmodified=!1,this._center=C,this._constrain(),this._calcMatrices())},lr.padding.get=function(){return this._edgeInsets.toJSON()},lr.padding.set=function(C){this._edgeInsets.equals(C)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,C,1),this._calcMatrices())},lr.centerPoint.get=function(){return this._edgeInsets.getCenter(this.width,this.height)},Vt.prototype.isPaddingEqual=function(C){return this._edgeInsets.equals(C)},Vt.prototype.interpolatePadding=function(C,D,F){this._unmodified=!1,this._edgeInsets.interpolate(C,D,F),this._constrain(),this._calcMatrices()},Vt.prototype.coveringZoomLevel=function(C){var D=(C.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/C.tileSize));return Math.max(0,D)},Vt.prototype.getVisibleUnwrappedCoordinates=function(C){var D=[new e.UnwrappedTileID(0,C)];if(this._renderWorldCopies)for(var F=this.pointCoordinate(new e.Point(0,0)),H=this.pointCoordinate(new e.Point(this.width,0)),ae=this.pointCoordinate(new e.Point(this.width,this.height)),ue=this.pointCoordinate(new e.Point(0,this.height)),me=Math.floor(Math.min(F.x,H.x,ae.x,ue.x)),be=Math.floor(Math.max(F.x,H.x,ae.x,ue.x)),Le=me-1;Le<=be+1;Le++)0!==Le&&D.push(new e.UnwrappedTileID(Le,C));return D},Vt.prototype.coveringTiles=function(C){var D=this.coveringZoomLevel(C),F=D;if(void 0!==C.minzoom&&D<C.minzoom)return[];void 0!==C.maxzoom&&D>C.maxzoom&&(D=C.maxzoom);var H=e.MercatorCoordinate.fromLngLat(this.center),ae=Math.pow(2,D),ue=[ae*H.x,ae*H.y,0],me=pt.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,D),be=C.minzoom||0;this.pitch<=60&&this._edgeInsets.top<.1&&(be=D);var Le=function(cn){return{aabb:new Ot([cn*ae,0,0],[(cn+1)*ae,ae,0]),zoom:0,x:0,y:0,wrap:cn,fullyVisible:!1}},qe=[],Qe=[],at=D,_t=C.reparseOverscaled?F:D;if(this._renderWorldCopies)for(var Et=1;Et<=3;Et++)qe.push(Le(-Et)),qe.push(Le(Et));for(qe.push(Le(0));qe.length>0;){var Tt=qe.pop(),Mt=Tt.x,bt=Tt.y,Dt=Tt.fullyVisible;if(!Dt){var It=Tt.aabb.intersects(me);if(0===It)continue;Dt=2===It}var Nt=Tt.aabb.distanceX(ue),nr=Tt.aabb.distanceY(ue),dr=Math.max(Math.abs(Nt),Math.abs(nr));if(Tt.zoom===at||dr>3+(1<<at-Tt.zoom)-2&&Tt.zoom>=be)Qe.push({tileID:new e.OverscaledTileID(Tt.zoom===at?_t:Tt.zoom,Tt.wrap,Tt.zoom,Mt,bt),distanceSq:e.sqrLen([ue[0]-.5-Mt,ue[1]-.5-bt])});else for(var Ar=0;Ar<4;Ar++){var Kr=(Mt<<1)+Ar%2,Jr=(bt<<1)+(Ar>>1);qe.push({aabb:Tt.aabb.quadrant(Ar),zoom:Tt.zoom+1,x:Kr,y:Jr,wrap:Tt.wrap,fullyVisible:Dt})}}return Qe.sort(function(cn,an){return cn.distanceSq-an.distanceSq}).map(function(cn){return cn.tileID})},Vt.prototype.resize=function(C,D){this.width=C,this.height=D,this.pixelsToGLUnits=[2/C,-2/D],this._constrain(),this._calcMatrices()},lr.unmodified.get=function(){return this._unmodified},Vt.prototype.zoomScale=function(C){return Math.pow(2,C)},Vt.prototype.scaleZoom=function(C){return Math.log(C)/Math.LN2},Vt.prototype.project=function(C){var D=e.clamp(C.lat,-this.maxValidLatitude,this.maxValidLatitude);return new e.Point(e.mercatorXfromLng(C.lng)*this.worldSize,e.mercatorYfromLat(D)*this.worldSize)},Vt.prototype.unproject=function(C){return new e.MercatorCoordinate(C.x/this.worldSize,C.y/this.worldSize).toLngLat()},lr.point.get=function(){return this.project(this.center)},Vt.prototype.setLocationAtPoint=function(C,D){var F=this.pointCoordinate(D),H=this.pointCoordinate(this.centerPoint),ae=this.locationCoordinate(C),ue=new e.MercatorCoordinate(ae.x-(F.x-H.x),ae.y-(F.y-H.y));this.center=this.coordinateLocation(ue),this._renderWorldCopies&&(this.center=this.center.wrap())},Vt.prototype.locationPoint=function(C){return this.coordinatePoint(this.locationCoordinate(C))},Vt.prototype.pointLocation=function(C){return this.coordinateLocation(this.pointCoordinate(C))},Vt.prototype.locationCoordinate=function(C){return e.MercatorCoordinate.fromLngLat(C)},Vt.prototype.coordinateLocation=function(C){return C.toLngLat()},Vt.prototype.pointCoordinate=function(C){var D=[C.x,C.y,0,1],F=[C.x,C.y,1,1];e.transformMat4(D,D,this.pixelMatrixInverse),e.transformMat4(F,F,this.pixelMatrixInverse);var H=D[3],ae=F[3],be=D[1]/H,Le=F[1]/ae,qe=D[2]/H,Qe=F[2]/ae,at=qe===Qe?0:(0-qe)/(Qe-qe);return new e.MercatorCoordinate(e.number(D[0]/H,F[0]/ae,at)/this.worldSize,e.number(be,Le,at)/this.worldSize)},Vt.prototype.coordinatePoint=function(C){var D=[C.x*this.worldSize,C.y*this.worldSize,0,1];return e.transformMat4(D,D,this.pixelMatrix),new e.Point(D[0]/D[3],D[1]/D[3])},Vt.prototype.getBounds=function(){return(new e.LngLatBounds).extend(this.pointLocation(new e.Point(0,0))).extend(this.pointLocation(new e.Point(this.width,0))).extend(this.pointLocation(new e.Point(this.width,this.height))).extend(this.pointLocation(new e.Point(0,this.height)))},Vt.prototype.getMaxBounds=function(){return this.latRange&&2===this.latRange.length&&this.lngRange&&2===this.lngRange.length?new e.LngLatBounds([this.lngRange[0],this.latRange[0]],[this.lngRange[1],this.latRange[1]]):null},Vt.prototype.setMaxBounds=function(C){C?(this.lngRange=[C.getWest(),C.getEast()],this.latRange=[C.getSouth(),C.getNorth()],this._constrain()):(this.lngRange=null,this.latRange=[-this.maxValidLatitude,this.maxValidLatitude])},Vt.prototype.calculatePosMatrix=function(C,D){void 0===D&&(D=!1);var F=C.key,H=D?this._alignedPosMatrixCache:this._posMatrixCache;if(H[F])return H[F];var ae=C.canonical,ue=this.worldSize/this.zoomScale(ae.z),me=ae.x+Math.pow(2,ae.z)*C.wrap,be=e.identity(new Float64Array(16));return e.translate(be,be,[me*ue,ae.y*ue,0]),e.scale(be,be,[ue/e.EXTENT,ue/e.EXTENT,1]),e.multiply(be,D?this.alignedProjMatrix:this.projMatrix,be),H[F]=new Float32Array(be),H[F]},Vt.prototype.customLayerMatrix=function(){return this.mercatorMatrix.slice()},Vt.prototype._constrain=function(){if(this.center&&this.width&&this.height&&!this._constraining){this._constraining=!0;var C,D,F,H,ae=-90,ue=90,me=-180,be=180,Le=this.size,qe=this._unmodified;if(this.latRange){var Qe=this.latRange;ae=e.mercatorYfromLat(Qe[1])*this.worldSize,C=(ue=e.mercatorYfromLat(Qe[0])*this.worldSize)-ae<Le.y?Le.y/(ue-ae):0}if(this.lngRange){var at=this.lngRange;me=e.mercatorXfromLng(at[0])*this.worldSize,D=(be=e.mercatorXfromLng(at[1])*this.worldSize)-me<Le.x?Le.x/(be-me):0}var _t=this.point,Et=Math.max(D||0,C||0);if(Et)return this.center=this.unproject(new e.Point(D?(be+me)/2:_t.x,C?(ue+ae)/2:_t.y)),this.zoom+=this.scaleZoom(Et),this._unmodified=qe,void(this._constraining=!1);if(this.latRange){var Tt=_t.y,Mt=Le.y/2;Tt-Mt<ae&&(H=ae+Mt),Tt+Mt>ue&&(H=ue-Mt)}if(this.lngRange){var bt=_t.x,Dt=Le.x/2;bt-Dt<me&&(F=me+Dt),bt+Dt>be&&(F=be-Dt)}void 0===F&&void 0===H||(this.center=this.unproject(new e.Point(void 0!==F?F:_t.x,void 0!==H?H:_t.y))),this._unmodified=qe,this._constraining=!1}},Vt.prototype._calcMatrices=function(){if(this.height){var D=this.centerOffset;this.cameraToCenterDistance=.5/Math.tan(this._fov/2)*this.height;var F=Math.PI/2+this._pitch,H=this._fov*(.5+D.y/this.height),ae=Math.sin(H)*this.cameraToCenterDistance/Math.sin(e.clamp(Math.PI-F-H,.01,Math.PI-.01)),ue=this.point,me=ue.x,be=ue.y,Le=1.01*(Math.cos(Math.PI/2-this._pitch)*ae+this.cameraToCenterDistance),qe=this.height/50,Qe=new Float64Array(16);e.perspective(Qe,this._fov,this.width/this.height,qe,Le),Qe[8]=2*-D.x/this.width,Qe[9]=2*D.y/this.height,e.scale(Qe,Qe,[1,-1,1]),e.translate(Qe,Qe,[0,0,-this.cameraToCenterDistance]),e.rotateX(Qe,Qe,this._pitch),e.rotateZ(Qe,Qe,this.angle),e.translate(Qe,Qe,[-me,-be,0]),this.mercatorMatrix=e.scale([],Qe,[this.worldSize,this.worldSize,this.worldSize]),e.scale(Qe,Qe,[1,1,e.mercatorZfromAltitude(1,this.center.lat)*this.worldSize,1]),this.projMatrix=Qe,this.invProjMatrix=e.invert([],this.projMatrix);var at=this.width%2/2,_t=this.height%2/2,Et=Math.cos(this.angle),Tt=Math.sin(this.angle),Mt=me-Math.round(me)+Et*at+Tt*_t,bt=be-Math.round(be)+Et*_t+Tt*at,Dt=new Float64Array(Qe);if(e.translate(Dt,Dt,[Mt>.5?Mt-1:Mt,bt>.5?bt-1:bt,0]),this.alignedProjMatrix=Dt,Qe=e.create(),e.scale(Qe,Qe,[this.width/2,-this.height/2,1]),e.translate(Qe,Qe,[1,-1,0]),this.labelPlaneMatrix=Qe,Qe=e.create(),e.scale(Qe,Qe,[1,-1,1]),e.translate(Qe,Qe,[-1,-1,0]),e.scale(Qe,Qe,[2/this.width,2/this.height,1]),this.glCoordMatrix=Qe,this.pixelMatrix=e.multiply(new Float64Array(16),this.labelPlaneMatrix,this.projMatrix),!(Qe=e.invert(new Float64Array(16),this.pixelMatrix)))throw new Error("failed to invert matrix");this.pixelMatrixInverse=Qe,this._posMatrixCache={},this._alignedPosMatrixCache={}}},Vt.prototype.maxPitchScaleFactor=function(){if(!this.pixelMatrixInverse)return 1;var C=this.pointCoordinate(new e.Point(0,0)),D=[C.x*this.worldSize,C.y*this.worldSize,0,1];return e.transformMat4(D,D,this.pixelMatrix)[3]/this.cameraToCenterDistance},Vt.prototype.getCameraPoint=function(){var D=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new e.Point(0,D))},Vt.prototype.getCameraQueryGeometry=function(C){var D=this.getCameraPoint();if(1===C.length)return[C[0],D];for(var F=D.x,H=D.y,ae=D.x,ue=D.y,me=0,be=C;me<be.length;me+=1){var Le=be[me];F=Math.min(F,Le.x),H=Math.min(H,Le.y),ae=Math.max(ae,Le.x),ue=Math.max(ue,Le.y)}return[new e.Point(F,H),new e.Point(ae,H),new e.Point(ae,ue),new e.Point(F,ue),new e.Point(F,H)]},Object.defineProperties(Vt.prototype,lr);var Pr=function(C){var D,H,ae,ue;this._hashName=C&&encodeURIComponent(C),e.bindAll(["_getCurrentHash","_onHashChange","_updateHash"],this),this._updateHash=(D=this._updateHashUnthrottled.bind(this),300,H=!1,ae=null,ue=function(){ae=null,H&&(D(),ae=setTimeout(ue,300),H=!1)},function(){return H=!0,ae||ue(),ae})};Pr.prototype.addTo=function(C){return this._map=C,e.window.addEventListener("hashchange",this._onHashChange,!1),this._map.on("moveend",this._updateHash),this},Pr.prototype.remove=function(){return e.window.removeEventListener("hashchange",this._onHashChange,!1),this._map.off("moveend",this._updateHash),clearTimeout(this._updateHash()),delete this._map,this},Pr.prototype.getHashString=function(C){var D=this._map.getCenter(),F=Math.round(100*this._map.getZoom())/100,H=Math.ceil((F*Math.LN2+Math.log(512/360/.5))/Math.LN10),ae=Math.pow(10,H),ue=Math.round(D.lng*ae)/ae,me=Math.round(D.lat*ae)/ae,be=this._map.getBearing(),Le=this._map.getPitch(),qe="";if(qe+=C?"/"+ue+"/"+me+"/"+F:F+"/"+me+"/"+ue,(be||Le)&&(qe+="/"+Math.round(10*be)/10),Le&&(qe+="/"+Math.round(Le)),this._hashName){var Qe=this._hashName,at=!1,_t=e.window.location.hash.slice(1).split("&").map(function(Et){var Tt=Et.split("=")[0];return Tt===Qe?(at=!0,Tt+"="+qe):Et}).filter(function(Et){return Et});return at||_t.push(Qe+"="+qe),"#"+_t.join("&")}return"#"+qe},Pr.prototype._getCurrentHash=function(){var C,D=this,F=e.window.location.hash.replace("#","");return this._hashName?(F.split("&").map(function(H){return H.split("=")}).forEach(function(H){H[0]===D._hashName&&(C=H)}),(C&&C[1]||"").split("/")):F.split("/")},Pr.prototype._onHashChange=function(){var C=this._getCurrentHash();if(C.length>=3&&!C.some(function(F){return isNaN(F)})){var D=this._map.dragRotate.isEnabled()&&this._map.touchZoomRotate.isEnabled()?+(C[3]||0):this._map.getBearing();return this._map.jumpTo({center:[+C[2],+C[1]],zoom:+C[0],bearing:D,pitch:+(C[4]||0)}),!0}return!1},Pr.prototype._updateHashUnthrottled=function(){var C=this.getHashString();try{e.window.history.replaceState(e.window.history.state,"",C)}catch{}};var Br={linearity:.3,easing:e.bezier(0,0,.3,1)},Yr=e.extend({deceleration:2500,maxSpeed:1400},Br),on=e.extend({deceleration:20,maxSpeed:1400},Br),rn=e.extend({deceleration:1e3,maxSpeed:360},Br),pn=e.extend({deceleration:1e3,maxSpeed:90},Br),_n=function(C){this._map=C,this.clear()};function sn(C,D){(!C.duration||C.duration<D.duration)&&(C.duration=D.duration,C.easing=D.easing)}function wn(C,D,F){var H=F.maxSpeed,ae=F.linearity,ue=F.deceleration,me=e.clamp(C*ae/(D/1e3),-H,H),be=Math.abs(me)/(ue*ae);return{easing:F.easing,duration:1e3*be,amount:me*(be/2)}}_n.prototype.clear=function(){this._inertiaBuffer=[]},_n.prototype.record=function(C){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:e.browser.now(),settings:C})},_n.prototype._drainInertiaBuffer=function(){for(var C=this._inertiaBuffer,D=e.browser.now();C.length>0&&D-C[0].time>160;)C.shift()},_n.prototype._onMoveEnd=function(C){if(this._drainInertiaBuffer(),!(this._inertiaBuffer.length<2)){for(var D={zoom:0,bearing:0,pitch:0,pan:new e.Point(0,0),pinchAround:void 0,around:void 0},F=0,H=this._inertiaBuffer;F<H.length;F+=1){var ae=H[F].settings;D.zoom+=ae.zoomDelta||0,D.bearing+=ae.bearingDelta||0,D.pitch+=ae.pitchDelta||0,ae.panDelta&&D.pan._add(ae.panDelta),ae.around&&(D.around=ae.around),ae.pinchAround&&(D.pinchAround=ae.pinchAround)}var ue=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,me={};if(D.pan.mag()){var be=wn(D.pan.mag(),ue,e.extend({},Yr,C||{}));me.offset=D.pan.mult(be.amount/D.pan.mag()),me.center=this._map.transform.center,sn(me,be)}if(D.zoom){var Le=wn(D.zoom,ue,on);me.zoom=this._map.transform.zoom+Le.amount,sn(me,Le)}if(D.bearing){var qe=wn(D.bearing,ue,rn);me.bearing=this._map.transform.bearing+e.clamp(qe.amount,-179,179),sn(me,qe)}if(D.pitch){var Qe=wn(D.pitch,ue,pn);me.pitch=this._map.transform.pitch+Qe.amount,sn(me,Qe)}if(me.zoom||me.bearing){var at=void 0===D.pinchAround?D.around:D.pinchAround;me.around=at?this._map.unproject(at):this._map.getCenter()}return this.clear(),e.extend(me,{noMoveStart:!0})}};var zn=function(C){function D(H,ae,ue,me){void 0===me&&(me={});var be=t.mousePos(ae.getCanvasContainer(),ue),Le=ae.unproject(be);C.call(this,H,e.extend({point:be,lngLat:Le,originalEvent:ue},me)),this._defaultPrevented=!1,this.target=ae}C&&(D.__proto__=C),(D.prototype=Object.create(C&&C.prototype)).constructor=D;var F={defaultPrevented:{configurable:!0}};return D.prototype.preventDefault=function(){this._defaultPrevented=!0},F.defaultPrevented.get=function(){return this._defaultPrevented},Object.defineProperties(D.prototype,F),D}(e.Event),Vn=function(C){function D(H,ae,ue){var me="touchend"===H?ue.changedTouches:ue.touches,be=t.touchPos(ae.getCanvasContainer(),me),Le=be.map(function(at){return ae.unproject(at)}),qe=be.reduce(function(at,_t,Et,Tt){return at.add(_t.div(Tt.length))},new e.Point(0,0)),Qe=ae.unproject(qe);C.call(this,H,{points:be,point:qe,lngLats:Le,lngLat:Qe,originalEvent:ue}),this._defaultPrevented=!1}C&&(D.__proto__=C),(D.prototype=Object.create(C&&C.prototype)).constructor=D;var F={defaultPrevented:{configurable:!0}};return D.prototype.preventDefault=function(){this._defaultPrevented=!0},F.defaultPrevented.get=function(){return this._defaultPrevented},Object.defineProperties(D.prototype,F),D}(e.Event),ii=function(C){function D(H,ae,ue){C.call(this,H,{originalEvent:ue}),this._defaultPrevented=!1}C&&(D.__proto__=C),(D.prototype=Object.create(C&&C.prototype)).constructor=D;var F={defaultPrevented:{configurable:!0}};return D.prototype.preventDefault=function(){this._defaultPrevented=!0},F.defaultPrevented.get=function(){return this._defaultPrevented},Object.defineProperties(D.prototype,F),D}(e.Event),Wr=function(C,D){this._map=C,this._clickTolerance=D.clickTolerance};Wr.prototype.reset=function(){delete this._mousedownPos},Wr.prototype.wheel=function(C){return this._firePreventable(new ii(C.type,this._map,C))},Wr.prototype.mousedown=function(C,D){return this._mousedownPos=D,this._firePreventable(new zn(C.type,this._map,C))},Wr.prototype.mouseup=function(C){this._map.fire(new zn(C.type,this._map,C))},Wr.prototype.click=function(C,D){this._mousedownPos&&this._mousedownPos.dist(D)>=this._clickTolerance||this._map.fire(new zn(C.type,this._map,C))},Wr.prototype.dblclick=function(C){return this._firePreventable(new zn(C.type,this._map,C))},Wr.prototype.mouseover=function(C){this._map.fire(new zn(C.type,this._map,C))},Wr.prototype.mouseout=function(C){this._map.fire(new zn(C.type,this._map,C))},Wr.prototype.touchstart=function(C){return this._firePreventable(new Vn(C.type,this._map,C))},Wr.prototype.touchmove=function(C){this._map.fire(new Vn(C.type,this._map,C))},Wr.prototype.touchend=function(C){this._map.fire(new Vn(C.type,this._map,C))},Wr.prototype.touchcancel=function(C){this._map.fire(new Vn(C.type,this._map,C))},Wr.prototype._firePreventable=function(C){if(this._map.fire(C),C.defaultPrevented)return{}},Wr.prototype.isEnabled=function(){return!0},Wr.prototype.isActive=function(){return!1},Wr.prototype.enable=function(){},Wr.prototype.disable=function(){};var ti=function(C){this._map=C};ti.prototype.reset=function(){this._delayContextMenu=!1,delete this._contextMenuEvent},ti.prototype.mousemove=function(C){this._map.fire(new zn(C.type,this._map,C))},ti.prototype.mousedown=function(){this._delayContextMenu=!0},ti.prototype.mouseup=function(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new zn("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)},ti.prototype.contextmenu=function(C){this._delayContextMenu?this._contextMenuEvent=C:this._map.fire(new zn(C.type,this._map,C)),this._map.listens("contextmenu")&&C.preventDefault()},ti.prototype.isEnabled=function(){return!0},ti.prototype.isActive=function(){return!1},ti.prototype.enable=function(){},ti.prototype.disable=function(){};var Ln=function(C,D){this._map=C,this._el=C.getCanvasContainer(),this._container=C.getContainer(),this._clickTolerance=D.clickTolerance||1};function Nn(C,D){for(var F={},H=0;H<C.length;H++)F[C[H].identifier]=D[H];return F}Ln.prototype.isEnabled=function(){return!!this._enabled},Ln.prototype.isActive=function(){return!!this._active},Ln.prototype.enable=function(){this.isEnabled()||(this._enabled=!0)},Ln.prototype.disable=function(){this.isEnabled()&&(this._enabled=!1)},Ln.prototype.mousedown=function(C,D){this.isEnabled()&&C.shiftKey&&0===C.button&&(t.disableDrag(),this._startPos=this._lastPos=D,this._active=!0)},Ln.prototype.mousemoveWindow=function(C,D){if(this._active){var F=D;if(!(this._lastPos.equals(F)||!this._box&&F.dist(this._startPos)<this._clickTolerance)){var H=this._startPos;this._lastPos=F,this._box||(this._box=t.create("div","mapboxgl-boxzoom",this._container),this._container.classList.add("mapboxgl-crosshair"),this._fireEvent("boxzoomstart",C));var ae=Math.min(H.x,F.x),ue=Math.max(H.x,F.x),me=Math.min(H.y,F.y),be=Math.max(H.y,F.y);t.setTransform(this._box,"translate("+ae+"px,"+me+"px)"),this._box.style.width=ue-ae+"px",this._box.style.height=be-me+"px"}}},Ln.prototype.mouseupWindow=function(C,D){var F=this;if(this._active&&0===C.button){var H=this._startPos,ae=D;if(this.reset(),t.suppressClick(),H.x!==ae.x||H.y!==ae.y)return this._map.fire(new e.Event("boxzoomend",{originalEvent:C})),{cameraAnimation:function(ue){return ue.fitScreenCoordinates(H,ae,F._map.getBearing(),{linear:!0})}};this._fireEvent("boxzoomcancel",C)}},Ln.prototype.keydown=function(C){this._active&&27===C.keyCode&&(this.reset(),this._fireEvent("boxzoomcancel",C))},Ln.prototype.reset=function(){this._active=!1,this._container.classList.remove("mapboxgl-crosshair"),this._box&&(t.remove(this._box),this._box=null),t.enableDrag(),delete this._startPos,delete this._lastPos},Ln.prototype._fireEvent=function(C,D){return this._map.fire(new e.Event(C,{originalEvent:D}))};var ei=function(C){this.reset(),this.numTouches=C.numTouches};ei.prototype.reset=function(){delete this.centroid,delete this.startTime,delete this.touches,this.aborted=!1},ei.prototype.touchstart=function(C,D,F){(this.centroid||F.length>this.numTouches)&&(this.aborted=!0),this.aborted||(void 0===this.startTime&&(this.startTime=C.timeStamp),F.length===this.numTouches&&(this.centroid=function(H){for(var ae=new e.Point(0,0),ue=0,me=H;ue<me.length;ue+=1)ae._add(me[ue]);return ae.div(H.length)}(D),this.touches=Nn(F,D)))},ei.prototype.touchmove=function(C,D,F){if(!this.aborted&&this.centroid){var H=Nn(F,D);for(var ae in this.touches){var me=H[ae];(!me||me.dist(this.touches[ae])>30)&&(this.aborted=!0)}}},ei.prototype.touchend=function(C,D,F){if((!this.centroid||C.timeStamp-this.startTime>500)&&(this.aborted=!0),0===F.length){var H=!this.aborted&&this.centroid;if(this.reset(),H)return H}};var wi=function(C){this.singleTap=new ei(C),this.numTaps=C.numTaps,this.reset()};wi.prototype.reset=function(){this.lastTime=1/0,delete this.lastTap,this.count=0,this.singleTap.reset()},wi.prototype.touchstart=function(C,D,F){this.singleTap.touchstart(C,D,F)},wi.prototype.touchmove=function(C,D,F){this.singleTap.touchmove(C,D,F)},wi.prototype.touchend=function(C,D,F){var H=this.singleTap.touchend(C,D,F);if(H){var ae=C.timeStamp-this.lastTime<500,ue=!this.lastTap||this.lastTap.dist(H)<30;if(ae&&ue||this.reset(),this.count++,this.lastTime=C.timeStamp,this.lastTap=H,this.count===this.numTaps)return this.reset(),H}};var Li=function(){this._zoomIn=new wi({numTouches:1,numTaps:2}),this._zoomOut=new wi({numTouches:2,numTaps:1}),this.reset()};Li.prototype.reset=function(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()},Li.prototype.touchstart=function(C,D,F){this._zoomIn.touchstart(C,D,F),this._zoomOut.touchstart(C,D,F)},Li.prototype.touchmove=function(C,D,F){this._zoomIn.touchmove(C,D,F),this._zoomOut.touchmove(C,D,F)},Li.prototype.touchend=function(C,D,F){var H=this,ae=this._zoomIn.touchend(C,D,F),ue=this._zoomOut.touchend(C,D,F);return ae?(this._active=!0,C.preventDefault(),setTimeout(function(){return H.reset()},0),{cameraAnimation:function(me){return me.easeTo({duration:300,zoom:me.getZoom()+1,around:me.unproject(ae)},{originalEvent:C})}}):ue?(this._active=!0,C.preventDefault(),setTimeout(function(){return H.reset()},0),{cameraAnimation:function(me){return me.easeTo({duration:300,zoom:me.getZoom()-1,around:me.unproject(ue)},{originalEvent:C})}}):void 0},Li.prototype.touchcancel=function(){this.reset()},Li.prototype.enable=function(){this._enabled=!0},Li.prototype.disable=function(){this._enabled=!1,this.reset()},Li.prototype.isEnabled=function(){return this._enabled},Li.prototype.isActive=function(){return this._active};var Mn=function(C){this.reset(),this._clickTolerance=C.clickTolerance||1};Mn.prototype.reset=function(){this._active=!1,this._moved=!1,delete this._lastPoint,delete this._eventButton},Mn.prototype._correctButton=function(C,D){return!1},Mn.prototype._move=function(C,D){return{}},Mn.prototype.mousedown=function(C,D){if(!this._lastPoint){var F=t.mouseButton(C);this._correctButton(C,F)&&(this._lastPoint=D,this._eventButton=F)}},Mn.prototype.mousemoveWindow=function(C,D){var F=this._lastPoint;if(F&&(C.preventDefault(),this._moved||!(D.dist(F)<this._clickTolerance)))return this._moved=!0,this._lastPoint=D,this._move(F,D)},Mn.prototype.mouseupWindow=function(C){t.mouseButton(C)===this._eventButton&&(this._moved&&t.suppressClick(),this.reset())},Mn.prototype.enable=function(){this._enabled=!0},Mn.prototype.disable=function(){this._enabled=!1,this.reset()},Mn.prototype.isEnabled=function(){return this._enabled},Mn.prototype.isActive=function(){return this._active};var Di=function(C){function D(){C.apply(this,arguments)}return C&&(D.__proto__=C),(D.prototype=Object.create(C&&C.prototype)).constructor=D,D.prototype.mousedown=function(F,H){C.prototype.mousedown.call(this,F,H),this._lastPoint&&(this._active=!0)},D.prototype._correctButton=function(F,H){return 0===H&&!F.ctrlKey},D.prototype._move=function(F,H){return{around:H,panDelta:H.sub(F)}},D}(Mn),Ei=function(C){function D(){C.apply(this,arguments)}return C&&(D.__proto__=C),(D.prototype=Object.create(C&&C.prototype)).constructor=D,D.prototype._correctButton=function(F,H){return 0===H&&F.ctrlKey||2===H},D.prototype._move=function(F,H){var ae=.8*(H.x-F.x);if(ae)return this._active=!0,{bearingDelta:ae}},D.prototype.contextmenu=function(F){F.preventDefault()},D}(Mn),di=function(C){function D(){C.apply(this,arguments)}return C&&(D.__proto__=C),(D.prototype=Object.create(C&&C.prototype)).constructor=D,D.prototype._correctButton=function(F,H){return 0===H&&F.ctrlKey||2===H},D.prototype._move=function(F,H){var ae=-.5*(H.y-F.y);if(ae)return this._active=!0,{pitchDelta:ae}},D.prototype.contextmenu=function(F){F.preventDefault()},D}(Mn),zi=function(C){this._minTouches=1,this._clickTolerance=C.clickTolerance||1,this.reset()};zi.prototype.reset=function(){this._active=!1,this._touches={},this._sum=new e.Point(0,0)},zi.prototype.touchstart=function(C,D,F){return this._calculateTransform(C,D,F)},zi.prototype.touchmove=function(C,D,F){if(this._active)return C.preventDefault(),this._calculateTransform(C,D,F)},zi.prototype.touchend=function(C,D,F){this._calculateTransform(C,D,F),this._active&&F.length<this._minTouches&&this.reset()},zi.prototype.touchcancel=function(){this.reset()},zi.prototype._calculateTransform=function(C,D,F){F.length>0&&(this._active=!0);var H=Nn(F,D),ae=new e.Point(0,0),ue=new e.Point(0,0),me=0;for(var be in H){var Le=H[be],qe=this._touches[be];qe&&(ae._add(Le),ue._add(Le.sub(qe)),me++,H[be]=Le)}if(this._touches=H,!(me<this._minTouches)&&ue.mag()){var Qe=ue.div(me);if(this._sum._add(Qe),!(this._sum.mag()<this._clickTolerance))return{around:ae.div(me),panDelta:Qe}}},zi.prototype.enable=function(){this._enabled=!0},zi.prototype.disable=function(){this._enabled=!1,this.reset()},zi.prototype.isEnabled=function(){return this._enabled},zi.prototype.isActive=function(){return this._active};var Mi=function(){this.reset()};function $i(C,D,F){for(var H=0;H<C.length;H++)if(C[H].identifier===F)return D[H]}function ri(C,D){return Math.log(C/D)/Math.LN2}Mi.prototype.reset=function(){this._active=!1,delete this._firstTwoTouches},Mi.prototype._start=function(C){},Mi.prototype._move=function(C,D,F){return{}},Mi.prototype.touchstart=function(C,D,F){this._firstTwoTouches||F.length<2||(this._firstTwoTouches=[F[0].identifier,F[1].identifier],this._start([D[0],D[1]]))},Mi.prototype.touchmove=function(C,D,F){if(this._firstTwoTouches){C.preventDefault();var H=this._firstTwoTouches,ue=H[1],me=$i(F,D,H[0]),be=$i(F,D,ue);if(me&&be){var Le=this._aroundCenter?null:me.add(be).div(2);return this._move([me,be],Le,C)}}},Mi.prototype.touchend=function(C,D,F){if(this._firstTwoTouches){var H=this._firstTwoTouches,ue=H[1],me=$i(F,D,H[0]),be=$i(F,D,ue);me&&be||(this._active&&t.suppressClick(),this.reset())}},Mi.prototype.touchcancel=function(){this.reset()},Mi.prototype.enable=function(C){this._enabled=!0,this._aroundCenter=!!C&&"center"===C.around},Mi.prototype.disable=function(){this._enabled=!1,this.reset()},Mi.prototype.isEnabled=function(){return this._enabled},Mi.prototype.isActive=function(){return this._active};var Wi=function(C){function D(){C.apply(this,arguments)}return C&&(D.__proto__=C),(D.prototype=Object.create(C&&C.prototype)).constructor=D,D.prototype.reset=function(){C.prototype.reset.call(this),delete this._distance,delete this._startDistance},D.prototype._start=function(F){this._startDistance=this._distance=F[0].dist(F[1])},D.prototype._move=function(F,H){var ae=this._distance;if(this._distance=F[0].dist(F[1]),this._active||!(Math.abs(ri(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:ri(this._distance,ae),pinchAround:H}},D}(Mi);function Ba(C,D){return 180*C.angleWith(D)/Math.PI}var Ho=function(C){function D(){C.apply(this,arguments)}return C&&(D.__proto__=C),(D.prototype=Object.create(C&&C.prototype)).constructor=D,D.prototype.reset=function(){C.prototype.reset.call(this),delete this._minDiameter,delete this._startVector,delete this._vector},D.prototype._start=function(F){this._startVector=this._vector=F[0].sub(F[1]),this._minDiameter=F[0].dist(F[1])},D.prototype._move=function(F,H){var ae=this._vector;if(this._vector=F[0].sub(F[1]),this._active||!this._isBelowThreshold(this._vector))return this._active=!0,{bearingDelta:Ba(this._vector,ae),pinchAround:H}},D.prototype._isBelowThreshold=function(F){this._minDiameter=Math.min(this._minDiameter,F.mag());var H=25/(Math.PI*this._minDiameter)*360,ae=Ba(F,this._startVector);return Math.abs(ae)<H},D}(Mi);function Io(C){return Math.abs(C.y)>Math.abs(C.x)}var go=function(C){function D(){C.apply(this,arguments)}return C&&(D.__proto__=C),(D.prototype=Object.create(C&&C.prototype)).constructor=D,D.prototype.reset=function(){C.prototype.reset.call(this),this._valid=void 0,delete this._firstMove,delete this._lastPoints},D.prototype._start=function(F){this._lastPoints=F,Io(F[0].sub(F[1]))&&(this._valid=!1)},D.prototype._move=function(F,H,ae){var ue=F[0].sub(this._lastPoints[0]),me=F[1].sub(this._lastPoints[1]);if(this._valid=this.gestureBeginsVertically(ue,me,ae.timeStamp),this._valid)return this._lastPoints=F,this._active=!0,{pitchDelta:(ue.y+me.y)/2*-.5}},D.prototype.gestureBeginsVertically=function(F,H,ae){if(void 0!==this._valid)return this._valid;var ue=F.mag()>=2,me=H.mag()>=2;if(ue||me){if(!ue||!me)return void 0===this._firstMove&&(this._firstMove=ae),ae-this._firstMove<100&&void 0;var be=F.y>0==H.y>0;return Io(F)&&Io(H)&&be}},D}(Mi),vi={panStep:100,bearingStep:15,pitchStep:10},da=function(){var C=vi;this._panStep=C.panStep,this._bearingStep=C.bearingStep,this._pitchStep=C.pitchStep};function mo(C){return C*(2-C)}da.prototype.reset=function(){this._active=!1},da.prototype.keydown=function(C){var D=this;if(!(C.altKey||C.ctrlKey||C.metaKey)){var F=0,H=0,ae=0,ue=0,me=0;switch(C.keyCode){case 61:case 107:case 171:case 187:F=1;break;case 189:case 109:case 173:F=-1;break;case 37:C.shiftKey?H=-1:(C.preventDefault(),ue=-1);break;case 39:C.shiftKey?H=1:(C.preventDefault(),ue=1);break;case 38:C.shiftKey?ae=1:(C.preventDefault(),me=-1);break;case 40:C.shiftKey?ae=-1:(C.preventDefault(),me=1);break;default:return}return{cameraAnimation:function(be){var Le=be.getZoom();be.easeTo({duration:300,easeId:"keyboardHandler",easing:mo,zoom:F?Math.round(Le)+F*(C.shiftKey?2:1):Le,bearing:be.getBearing()+H*D._bearingStep,pitch:be.getPitch()+ae*D._pitchStep,offset:[-ue*D._panStep,-me*D._panStep],center:be.getCenter()},{originalEvent:C})}}}},da.prototype.enable=function(){this._enabled=!0},da.prototype.disable=function(){this._enabled=!1,this.reset()},da.prototype.isEnabled=function(){return this._enabled},da.prototype.isActive=function(){return this._active};var Xi=function(C,D){this._map=C,this._el=C.getCanvasContainer(),this._handler=D,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=1/450,e.bindAll(["_onWheel","_onTimeout","_onScrollFrame","_onScrollFinished"],this)};Xi.prototype.setZoomRate=function(C){this._defaultZoomRate=C},Xi.prototype.setWheelZoomRate=function(C){this._wheelZoomRate=C},Xi.prototype.isEnabled=function(){return!!this._enabled},Xi.prototype.isActive=function(){return!!this._active||void 0!==this._finishTimeout},Xi.prototype.isZooming=function(){return!!this._zooming},Xi.prototype.enable=function(C){this.isEnabled()||(this._enabled=!0,this._aroundCenter=C&&"center"===C.around)},Xi.prototype.disable=function(){this.isEnabled()&&(this._enabled=!1)},Xi.prototype.wheel=function(C){if(this.isEnabled()){var D=C.deltaMode===e.window.WheelEvent.DOM_DELTA_LINE?40*C.deltaY:C.deltaY,F=e.browser.now(),H=F-(this._lastWheelEventTime||0);this._lastWheelEventTime=F,0!==D&&D%4.000244140625==0?this._type="wheel":0!==D&&Math.abs(D)<4?this._type="trackpad":H>400?(this._type=null,this._lastValue=D,this._timeout=setTimeout(this._onTimeout,40,C)):this._type||(this._type=Math.abs(H*D)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,D+=this._lastValue)),C.shiftKey&&D&&(D/=4),this._type&&(this._lastWheelEvent=C,this._delta-=D,this._active||this._start(C)),C.preventDefault()}},Xi.prototype._onTimeout=function(C){this._type="wheel",this._delta-=this._lastValue,this._active||this._start(C)},Xi.prototype._start=function(C){if(this._delta){this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);var D=t.mousePos(this._el,C);this._around=e.LngLat.convert(this._aroundCenter?this._map.getCenter():this._map.unproject(D)),this._aroundPoint=this._map.transform.locationPoint(this._around),this._frameId||(this._frameId=!0,this._handler._triggerRenderFrame())}},Xi.prototype.renderFrame=function(){return this._onScrollFrame()},Xi.prototype._onScrollFrame=function(){var C=this;if(this._frameId&&(this._frameId=null,this.isActive())){var D=this._map.transform;if(0!==this._delta){var F="wheel"===this._type&&Math.abs(this._delta)>4.000244140625?this._wheelZoomRate:this._defaultZoomRate,H=2/(1+Math.exp(-Math.abs(this._delta*F)));this._delta<0&&0!==H&&(H=1/H);var ae="number"==typeof this._targetZoom?D.zoomScale(this._targetZoom):D.scale;this._targetZoom=Math.min(D.maxZoom,Math.max(D.minZoom,D.scaleZoom(ae*H))),"wheel"===this._type&&(this._startZoom=D.zoom,this._easing=this._smoothOutEasing(200)),this._delta=0}var ue,me="number"==typeof this._targetZoom?this._targetZoom:D.zoom,be=this._startZoom,Le=this._easing,qe=!1;if("wheel"===this._type&&be&&Le){var Qe=Math.min((e.browser.now()-this._lastWheelEventTime)/200,1),at=Le(Qe);ue=e.number(be,me,at),Qe<1?this._frameId||(this._frameId=!0):qe=!0}else ue=me,qe=!0;return this._active=!0,qe&&(this._active=!1,this._finishTimeout=setTimeout(function(){C._zooming=!1,C._handler._triggerRenderFrame(),delete C._targetZoom,delete C._finishTimeout},200)),{noInertia:!0,needsRenderFrame:!qe,zoomDelta:ue-D.zoom,around:this._aroundPoint,originalEvent:this._lastWheelEvent}}},Xi.prototype._smoothOutEasing=function(C){var D=e.ease;if(this._prevEase){var F=this._prevEase,H=(e.browser.now()-F.start)/F.duration,ae=F.easing(H+.01)-F.easing(H),ue=.27/Math.sqrt(ae*ae+1e-4)*.01,me=Math.sqrt(.0729-ue*ue);D=e.bezier(ue,me,.25,1)}return this._prevEase={start:e.browser.now(),duration:C,easing:D},D},Xi.prototype.reset=function(){this._active=!1};var wa=function(C,D){this._clickZoom=C,this._tapZoom=D};wa.prototype.enable=function(){this._clickZoom.enable(),this._tapZoom.enable()},wa.prototype.disable=function(){this._clickZoom.disable(),this._tapZoom.disable()},wa.prototype.isEnabled=function(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()},wa.prototype.isActive=function(){return this._clickZoom.isActive()||this._tapZoom.isActive()};var Va=function(){this.reset()};Va.prototype.reset=function(){this._active=!1},Va.prototype.dblclick=function(C,D){return C.preventDefault(),{cameraAnimation:function(F){F.easeTo({duration:300,zoom:F.getZoom()+(C.shiftKey?-1:1),around:F.unproject(D)},{originalEvent:C})}}},Va.prototype.enable=function(){this._enabled=!0},Va.prototype.disable=function(){this._enabled=!1,this.reset()},Va.prototype.isEnabled=function(){return this._enabled},Va.prototype.isActive=function(){return this._active};var ta=function(){this._tap=new wi({numTouches:1,numTaps:1}),this.reset()};ta.prototype.reset=function(){this._active=!1,delete this._swipePoint,delete this._swipeTouch,delete this._tapTime,this._tap.reset()},ta.prototype.touchstart=function(C,D,F){this._swipePoint||(this._tapTime&&C.timeStamp-this._tapTime>500&&this.reset(),this._tapTime?F.length>0&&(this._swipePoint=D[0],this._swipeTouch=F[0].identifier):this._tap.touchstart(C,D,F))},ta.prototype.touchmove=function(C,D,F){if(this._tapTime){if(this._swipePoint){if(F[0].identifier!==this._swipeTouch)return;var H=D[0],ae=H.y-this._swipePoint.y;return this._swipePoint=H,C.preventDefault(),this._active=!0,{zoomDelta:ae/128}}}else this._tap.touchmove(C,D,F)},ta.prototype.touchend=function(C,D,F){this._tapTime?this._swipePoint&&0===F.length&&this.reset():this._tap.touchend(C,D,F)&&(this._tapTime=C.timeStamp)},ta.prototype.touchcancel=function(){this.reset()},ta.prototype.enable=function(){this._enabled=!0},ta.prototype.disable=function(){this._enabled=!1,this.reset()},ta.prototype.isEnabled=function(){return this._enabled},ta.prototype.isActive=function(){return this._active};var co=function(C,D,F){this._el=C,this._mousePan=D,this._touchPan=F};co.prototype.enable=function(C){this._inertiaOptions=C||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("mapboxgl-touch-drag-pan")},co.prototype.disable=function(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("mapboxgl-touch-drag-pan")},co.prototype.isEnabled=function(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()},co.prototype.isActive=function(){return this._mousePan.isActive()||this._touchPan.isActive()};var ra=function(C,D,F){this._pitchWithRotate=C.pitchWithRotate,this._mouseRotate=D,this._mousePitch=F};ra.prototype.enable=function(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()},ra.prototype.disable=function(){this._mouseRotate.disable(),this._mousePitch.disable()},ra.prototype.isEnabled=function(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())},ra.prototype.isActive=function(){return this._mouseRotate.isActive()||this._mousePitch.isActive()};var $a=function(C,D,F,H){this._el=C,this._touchZoom=D,this._touchRotate=F,this._tapDragZoom=H,this._rotationDisabled=!1,this._enabled=!0};$a.prototype.enable=function(C){this._touchZoom.enable(C),this._rotationDisabled||this._touchRotate.enable(C),this._tapDragZoom.enable(),this._el.classList.add("mapboxgl-touch-zoom-rotate")},$a.prototype.disable=function(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("mapboxgl-touch-zoom-rotate")},$a.prototype.isEnabled=function(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()},$a.prototype.isActive=function(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()},$a.prototype.disableRotation=function(){this._rotationDisabled=!0,this._touchRotate.disable()},$a.prototype.enableRotation=function(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()};var rs=function(C){return C.zoom||C.drag||C.pitch||C.rotate},Jo=function(C){function D(){C.apply(this,arguments)}return C&&(D.__proto__=C),(D.prototype=Object.create(C&&C.prototype)).constructor=D,D}(e.Event);function Is(C){return C.panDelta&&C.panDelta.mag()||C.zoomDelta||C.bearingDelta||C.pitchDelta}var Oa=function(C,D){this._map=C,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new _n(C),this._bearingSnap=D.bearingSnap,this._previousActiveHandlers={},this._eventsInProgress={},this._addDefaultHandlers(D),e.bindAll(["handleEvent","handleWindowEvent"],this);var F=this._el;this._listeners=[[F,"touchstart",{passive:!1}],[F,"touchmove",{passive:!1}],[F,"touchend",void 0],[F,"touchcancel",void 0],[F,"mousedown",void 0],[F,"mousemove",void 0],[F,"mouseup",void 0],[e.window.document,"mousemove",{capture:!0}],[e.window.document,"mouseup",void 0],[F,"mouseover",void 0],[F,"mouseout",void 0],[F,"dblclick",void 0],[F,"click",void 0],[F,"keydown",{capture:!1}],[F,"keyup",void 0],[F,"wheel",{passive:!1}],[F,"contextmenu",void 0],[e.window,"blur",void 0]];for(var H=0,ae=this._listeners;H<ae.length;H+=1){var ue=ae[H],me=ue[0];t.addEventListener(me,ue[1],me===e.window.document?this.handleWindowEvent:this.handleEvent,ue[2])}};Oa.prototype.destroy=function(){for(var C=0,D=this._listeners;C<D.length;C+=1){var F=D[C],H=F[0];t.removeEventListener(H,F[1],H===e.window.document?this.handleWindowEvent:this.handleEvent,F[2])}},Oa.prototype._addDefaultHandlers=function(C){var D=this._map,F=D.getCanvasContainer();this._add("mapEvent",new Wr(D,C));var H=D.boxZoom=new Ln(D,C);this._add("boxZoom",H);var ae=new Li,ue=new Va;D.doubleClickZoom=new wa(ue,ae),this._add("tapZoom",ae),this._add("clickZoom",ue);var me=new ta;this._add("tapDragZoom",me);var be=D.touchPitch=new go;this._add("touchPitch",be);var Le=new Ei(C),qe=new di(C);D.dragRotate=new ra(C,Le,qe),this._add("mouseRotate",Le,["mousePitch"]),this._add("mousePitch",qe,["mouseRotate"]);var Qe=new Di(C),at=new zi(C);D.dragPan=new co(F,Qe,at),this._add("mousePan",Qe),this._add("touchPan",at,["touchZoom","touchRotate"]);var _t=new Ho,Et=new Wi;D.touchZoomRotate=new $a(F,Et,_t,me),this._add("touchRotate",_t,["touchPan","touchZoom"]),this._add("touchZoom",Et,["touchPan","touchRotate"]);var Tt=D.scrollZoom=new Xi(D,this);this._add("scrollZoom",Tt,["mousePan"]);var Mt=D.keyboard=new da;this._add("keyboard",Mt),this._add("blockableMapEvent",new ti(D));for(var bt=0,Dt=["boxZoom","doubleClickZoom","tapDragZoom","touchPitch","dragRotate","dragPan","touchZoomRotate","scrollZoom","keyboard"];bt<Dt.length;bt+=1){var It=Dt[bt];C.interactive&&C[It]&&D[It].enable(C[It])}},Oa.prototype._add=function(C,D,F){this._handlers.push({handlerName:C,handler:D,allowed:F}),this._handlersById[C]=D},Oa.prototype.stop=function(){if(!this._updatingCamera){for(var C=0,D=this._handlers;C<D.length;C+=1)D[C].handler.reset();this._inertia.clear(),this._fireEvents({},{}),this._changes=[]}},Oa.prototype.isActive=function(){for(var C=0,D=this._handlers;C<D.length;C+=1)if(D[C].handler.isActive())return!0;return!1},Oa.prototype.isZooming=function(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()},Oa.prototype.isRotating=function(){return!!this._eventsInProgress.rotate},Oa.prototype.isMoving=function(){return Boolean(rs(this._eventsInProgress))||this.isZooming()},Oa.prototype._blockedByActive=function(C,D,F){for(var H in C)if(H!==F&&(!D||D.indexOf(H)<0))return!0;return!1},Oa.prototype.handleWindowEvent=function(C){this.handleEvent(C,C.type+"Window")},Oa.prototype._getMapTouches=function(C){for(var D=[],F=0,H=C;F<H.length;F+=1){var ae=H[F];this._el.contains(ae.target)&&D.push(ae)}return D},Oa.prototype.handleEvent=function(C,D){if("blur"!==C.type){this._updatingCamera=!0;for(var F="renderFrame"===C.type?void 0:C,H={needsRenderFrame:!1},ae={},ue={},me=C.touches?this._getMapTouches(C.touches):void 0,be=me?t.touchPos(this._el,me):t.mousePos(this._el,C),Le=0,qe=this._handlers;Le<qe.length;Le+=1){var Qe=qe[Le],at=Qe.handlerName,_t=Qe.handler,Et=Qe.allowed;if(_t.isEnabled()){var Tt=void 0;this._blockedByActive(ue,Et,at)?_t.reset():_t[D||C.type]&&(Tt=_t[D||C.type](C,be,me),this.mergeHandlerResult(H,ae,Tt,at,F),Tt&&Tt.needsRenderFrame&&this._triggerRenderFrame()),(Tt||_t.isActive())&&(ue[at]=_t)}}var Mt={};for(var bt in this._previousActiveHandlers)ue[bt]||(Mt[bt]=F);this._previousActiveHandlers=ue,(Object.keys(Mt).length||Is(H))&&(this._changes.push([H,ae,Mt]),this._triggerRenderFrame()),(Object.keys(ue).length||Is(H))&&this._map._stop(!0),this._updatingCamera=!1;var Dt=H.cameraAnimation;Dt&&(this._inertia.clear(),this._fireEvents({},{}),this._changes=[],Dt(this._map))}else this.stop()},Oa.prototype.mergeHandlerResult=function(C,D,F,H,ae){if(F){e.extend(C,F);var ue={handlerName:H,originalEvent:F.originalEvent||ae};void 0!==F.zoomDelta&&(D.zoom=ue),void 0!==F.panDelta&&(D.drag=ue),void 0!==F.pitchDelta&&(D.pitch=ue),void 0!==F.bearingDelta&&(D.rotate=ue)}},Oa.prototype._applyChanges=function(){for(var C={},D={},F={},H=0,ae=this._changes;H<ae.length;H+=1){var ue=ae[H],me=ue[0],be=ue[1],Le=ue[2];me.panDelta&&(C.panDelta=(C.panDelta||new e.Point(0,0))._add(me.panDelta)),me.zoomDelta&&(C.zoomDelta=(C.zoomDelta||0)+me.zoomDelta),me.bearingDelta&&(C.bearingDelta=(C.bearingDelta||0)+me.bearingDelta),me.pitchDelta&&(C.pitchDelta=(C.pitchDelta||0)+me.pitchDelta),void 0!==me.around&&(C.around=me.around),void 0!==me.pinchAround&&(C.pinchAround=me.pinchAround),me.noInertia&&(C.noInertia=me.noInertia),e.extend(D,be),e.extend(F,Le)}this._updateMapTransform(C,D,F),this._changes=[]},Oa.prototype._updateMapTransform=function(C,D,F){var H=this._map,ae=H.transform;if(!Is(C))return this._fireEvents(D,F);var ue=C.panDelta,me=C.zoomDelta,be=C.bearingDelta,Le=C.pitchDelta,qe=C.around,Qe=C.pinchAround;void 0!==Qe&&(qe=Qe),H._stop(!0),qe=qe||H.transform.centerPoint;var at=ae.pointLocation(ue?qe.sub(ue):qe);be&&(ae.bearing+=be),Le&&(ae.pitch+=Le),me&&(ae.zoom+=me),ae.setLocationAtPoint(at,qe),this._map._update(),C.noInertia||this._inertia.record(C),this._fireEvents(D,F)},Oa.prototype._fireEvents=function(C,D){var F=this,H=rs(this._eventsInProgress),ae=rs(C),ue={};for(var me in C)this._eventsInProgress[me]||(ue[me+"start"]=C[me].originalEvent),this._eventsInProgress[me]=C[me];for(var Le in!H&&ae&&this._fireEvent("movestart",ae.originalEvent),ue)this._fireEvent(Le,ue[Le]);for(var qe in C.rotate&&(this._bearingChanged=!0),ae&&this._fireEvent("move",ae.originalEvent),C)this._fireEvent(qe,C[qe].originalEvent);var at,_t={};for(var Et in this._eventsInProgress){var Tt=this._eventsInProgress[Et],Mt=Tt.handlerName,bt=Tt.originalEvent;this._handlersById[Mt].isActive()||(delete this._eventsInProgress[Et],_t[Et+"end"]=at=D[Mt]||bt)}for(var Dt in _t)this._fireEvent(Dt,_t[Dt]);var It=rs(this._eventsInProgress);if((H||ae)&&!It){this._updatingCamera=!0;var Nt=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),nr=function(dr){return 0!==dr&&-F._bearingSnap<dr&&dr<F._bearingSnap};Nt?(nr(Nt.bearing||this._map.getBearing())&&(Nt.bearing=0),this._map.easeTo(Nt,{originalEvent:at})):(this._map.fire(new e.Event("moveend",{originalEvent:at})),nr(this._map.getBearing())&&this._map.resetNorth()),this._bearingChanged=!1,this._updatingCamera=!1}},Oa.prototype._fireEvent=function(C,D){this._map.fire(new e.Event(C,D?{originalEvent:D}:{}))},Oa.prototype._triggerRenderFrame=function(){var C=this;void 0===this._frameId&&(this._frameId=this._map._requestRenderFrame(function(D){delete C._frameId,C.handleEvent(new Jo("renderFrame",{timeStamp:D})),C._applyChanges()}))};var Os=function(C){function D(F,H){C.call(this),this._moving=!1,this._zooming=!1,this.transform=F,this._bearingSnap=H.bearingSnap,e.bindAll(["_renderFrameCallback"],this)}return C&&(D.__proto__=C),(D.prototype=Object.create(C&&C.prototype)).constructor=D,D.prototype.getCenter=function(){return new e.LngLat(this.transform.center.lng,this.transform.center.lat)},D.prototype.setCenter=function(F,H){return this.jumpTo({center:F},H)},D.prototype.panBy=function(F,H,ae){return F=e.Point.convert(F).mult(-1),this.panTo(this.transform.center,e.extend({offset:F},H),ae)},D.prototype.panTo=function(F,H,ae){return this.easeTo(e.extend({center:F},H),ae)},D.prototype.getZoom=function(){return this.transform.zoom},D.prototype.setZoom=function(F,H){return this.jumpTo({zoom:F},H),this},D.prototype.zoomTo=function(F,H,ae){return this.easeTo(e.extend({zoom:F},H),ae)},D.prototype.zoomIn=function(F,H){return this.zoomTo(this.getZoom()+1,F,H),this},D.prototype.zoomOut=function(F,H){return this.zoomTo(this.getZoom()-1,F,H),this},D.prototype.getBearing=function(){return this.transform.bearing},D.prototype.setBearing=function(F,H){return this.jumpTo({bearing:F},H),this},D.prototype.getPadding=function(){return this.transform.padding},D.prototype.setPadding=function(F,H){return this.jumpTo({padding:F},H),this},D.prototype.rotateTo=function(F,H,ae){return this.easeTo(e.extend({bearing:F},H),ae)},D.prototype.resetNorth=function(F,H){return this.rotateTo(0,e.extend({duration:1e3},F),H),this},D.prototype.resetNorthPitch=function(F,H){return this.easeTo(e.extend({bearing:0,pitch:0,duration:1e3},F),H),this},D.prototype.snapToNorth=function(F,H){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(F,H):this},D.prototype.getPitch=function(){return this.transform.pitch},D.prototype.setPitch=function(F,H){return this.jumpTo({pitch:F},H),this},D.prototype.cameraForBounds=function(F,H){return F=e.LngLatBounds.convert(F),this._cameraForBoxAndBearing(F.getNorthWest(),F.getSouthEast(),0,H)},D.prototype._cameraForBoxAndBearing=function(F,H,ae,ue){var me={top:0,bottom:0,right:0,left:0};if("number"==typeof(ue=e.extend({padding:me,offset:[0,0],maxZoom:this.transform.maxZoom},ue)).padding){var be=ue.padding;ue.padding={top:be,bottom:be,right:be,left:be}}ue.padding=e.extend(me,ue.padding);var Le=this.transform,qe=Le.padding,Qe=Le.project(e.LngLat.convert(F)),at=Le.project(e.LngLat.convert(H)),_t=Qe.rotate(-ae*Math.PI/180),Et=at.rotate(-ae*Math.PI/180),Tt=new e.Point(Math.max(_t.x,Et.x),Math.max(_t.y,Et.y)),Mt=new e.Point(Math.min(_t.x,Et.x),Math.min(_t.y,Et.y)),bt=Tt.sub(Mt),Dt=(Le.width-(qe.left+qe.right+ue.padding.left+ue.padding.right))/bt.x,It=(Le.height-(qe.top+qe.bottom+ue.padding.top+ue.padding.bottom))/bt.y;if(!(It<0||Dt<0)){var Nt=Math.min(Le.scaleZoom(Le.scale*Math.min(Dt,It)),ue.maxZoom),nr=e.Point.convert(ue.offset),Ar=new e.Point(nr.x+(ue.padding.left-ue.padding.right)/2,nr.y+(ue.padding.top-ue.padding.bottom)/2).mult(Le.scale/Le.zoomScale(Nt));return{center:Le.unproject(Qe.add(at).div(2).sub(Ar)),zoom:Nt,bearing:ae}}e.warnOnce("Map cannot fit within canvas with the given bounds, padding, and/or offset.")},D.prototype.fitBounds=function(F,H,ae){return this._fitInternal(this.cameraForBounds(F,H),H,ae)},D.prototype.fitScreenCoordinates=function(F,H,ae,ue,me){return this._fitInternal(this._cameraForBoxAndBearing(this.transform.pointLocation(e.Point.convert(F)),this.transform.pointLocation(e.Point.convert(H)),ae,ue),ue,me)},D.prototype._fitInternal=function(F,H,ae){return F?(delete(H=e.extend(F,H)).padding,H.linear?this.easeTo(H,ae):this.flyTo(H,ae)):this},D.prototype.jumpTo=function(F,H){this.stop();var ae=this.transform,ue=!1,me=!1,be=!1;return"zoom"in F&&ae.zoom!==+F.zoom&&(ue=!0,ae.zoom=+F.zoom),void 0!==F.center&&(ae.center=e.LngLat.convert(F.center)),"bearing"in F&&ae.bearing!==+F.bearing&&(me=!0,ae.bearing=+F.bearing),"pitch"in F&&ae.pitch!==+F.pitch&&(be=!0,ae.pitch=+F.pitch),null==F.padding||ae.isPaddingEqual(F.padding)||(ae.padding=F.padding),this.fire(new e.Event("movestart",H)).fire(new e.Event("move",H)),ue&&this.fire(new e.Event("zoomstart",H)).fire(new e.Event("zoom",H)).fire(new e.Event("zoomend",H)),me&&this.fire(new e.Event("rotatestart",H)).fire(new e.Event("rotate",H)).fire(new e.Event("rotateend",H)),be&&this.fire(new e.Event("pitchstart",H)).fire(new e.Event("pitch",H)).fire(new e.Event("pitchend",H)),this.fire(new e.Event("moveend",H))},D.prototype.easeTo=function(F,H){var ae=this;this._stop(!1,F.easeId),(!1===(F=e.extend({offset:[0,0],duration:500,easing:e.ease},F)).animate||!F.essential&&e.browser.prefersReducedMotion)&&(F.duration=0);var ue=this.transform,me=this.getZoom(),be=this.getBearing(),Le=this.getPitch(),qe=this.getPadding(),Qe="zoom"in F?+F.zoom:me,at="bearing"in F?this._normalizeBearing(F.bearing,be):be,_t="pitch"in F?+F.pitch:Le,Et="padding"in F?F.padding:ue.padding,Tt=e.Point.convert(F.offset),Mt=ue.centerPoint.add(Tt),bt=ue.pointLocation(Mt),Dt=e.LngLat.convert(F.center||bt);this._normalizeCenter(Dt);var It,Nt,nr=ue.project(bt),dr=ue.project(Dt).sub(nr),Sr=ue.zoomScale(Qe-me);F.around&&(It=e.LngLat.convert(F.around),Nt=ue.locationPoint(It));var Ar={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=this._zooming||Qe!==me,this._rotating=this._rotating||be!==at,this._pitching=this._pitching||_t!==Le,this._padding=!ue.isPaddingEqual(Et),this._easeId=F.easeId,this._prepareEase(H,F.noMoveStart,Ar),clearTimeout(this._easeEndTimeoutID),this._ease(function(Kr){if(ae._zooming&&(ue.zoom=e.number(me,Qe,Kr)),ae._rotating&&(ue.bearing=e.number(be,at,Kr)),ae._pitching&&(ue.pitch=e.number(Le,_t,Kr)),ae._padding&&(ue.interpolatePadding(qe,Et,Kr),Mt=ue.centerPoint.add(Tt)),It)ue.setLocationAtPoint(It,Nt);else{var Jr=ue.zoomScale(ue.zoom-me),cn=Qe>me?Math.min(2,Sr):Math.max(.5,Sr),an=Math.pow(cn,1-Kr),jn=ue.unproject(nr.add(dr.mult(Kr*an)).mult(Jr));ue.setLocationAtPoint(ue.renderWorldCopies?jn.wrap():jn,Mt)}ae._fireMoveEvents(H)},function(Kr){ae._afterEase(H,Kr)},F),this},D.prototype._prepareEase=function(F,H,ae){void 0===ae&&(ae={}),this._moving=!0,H||ae.moving||this.fire(new e.Event("movestart",F)),this._zooming&&!ae.zooming&&this.fire(new e.Event("zoomstart",F)),this._rotating&&!ae.rotating&&this.fire(new e.Event("rotatestart",F)),this._pitching&&!ae.pitching&&this.fire(new e.Event("pitchstart",F))},D.prototype._fireMoveEvents=function(F){this.fire(new e.Event("move",F)),this._zooming&&this.fire(new e.Event("zoom",F)),this._rotating&&this.fire(new e.Event("rotate",F)),this._pitching&&this.fire(new e.Event("pitch",F))},D.prototype._afterEase=function(F,H){if(!this._easeId||!H||this._easeId!==H){delete this._easeId;var ae=this._zooming,ue=this._rotating,me=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,ae&&this.fire(new e.Event("zoomend",F)),ue&&this.fire(new e.Event("rotateend",F)),me&&this.fire(new e.Event("pitchend",F)),this.fire(new e.Event("moveend",F))}},D.prototype.flyTo=function(F,H){var ae=this;if(!F.essential&&e.browser.prefersReducedMotion){var ue=e.pick(F,["center","zoom","bearing","pitch","around"]);return this.jumpTo(ue,H)}this.stop(),F=e.extend({offset:[0,0],speed:1.2,curve:1.42,easing:e.ease},F);var me=this.transform,be=this.getZoom(),Le=this.getBearing(),qe=this.getPitch(),Qe=this.getPadding(),at="zoom"in F?e.clamp(+F.zoom,me.minZoom,me.maxZoom):be,_t="bearing"in F?this._normalizeBearing(F.bearing,Le):Le,Et="pitch"in F?+F.pitch:qe,Tt="padding"in F?F.padding:me.padding,Mt=me.zoomScale(at-be),bt=e.Point.convert(F.offset),Dt=me.centerPoint.add(bt),It=me.pointLocation(Dt),Nt=e.LngLat.convert(F.center||It);this._normalizeCenter(Nt);var nr=me.project(It),dr=me.project(Nt).sub(nr),Sr=F.curve,Ar=Math.max(me.width,me.height),Kr=Ar/Mt,Jr=dr.mag();if("minZoom"in F){var cn=e.clamp(Math.min(F.minZoom,be,at),me.minZoom,me.maxZoom),an=Ar/me.zoomScale(cn-be);Sr=Math.sqrt(an/Jr*2)}var jn=Sr*Sr;function Wn($n){var xi=(Kr*Kr-Ar*Ar+($n?-1:1)*jn*jn*Jr*Jr)/(2*($n?Kr:Ar)*jn*Jr);return Math.log(Math.sqrt(xi*xi+1)-xi)}function ui($n){return(Math.exp($n)-Math.exp(-$n))/2}function Gr($n){return(Math.exp($n)+Math.exp(-$n))/2}var Tn=Wn(0),Xn=function($n){return Gr(Tn)/Gr(Tn+Sr*$n)},Hn=function($n){return Ar*((Gr(Tn)*(ui(xi=Tn+Sr*$n)/Gr(xi))-ui(Tn))/jn)/Jr;var xi},ni=(Wn(1)-Tn)/Sr;if(Math.abs(Jr)<1e-6||!isFinite(ni)){if(Math.abs(Ar-Kr)<1e-6)return this.easeTo(F,H);var hi=Kr<Ar?-1:1;ni=Math.abs(Math.log(Kr/Ar))/Sr,Hn=function(){return 0},Xn=function($n){return Math.exp(hi*Sr*$n)}}return F.duration="duration"in F?+F.duration:1e3*ni/("screenSpeed"in F?+F.screenSpeed/Sr:+F.speed),F.maxDuration&&F.duration>F.maxDuration&&(F.duration=0),this._zooming=!0,this._rotating=Le!==_t,this._pitching=Et!==qe,this._padding=!me.isPaddingEqual(Tt),this._prepareEase(H,!1),this._ease(function($n){var xi=$n*ni,mi=1/Xn(xi);me.zoom=1===$n?at:be+me.scaleZoom(mi),ae._rotating&&(me.bearing=e.number(Le,_t,$n)),ae._pitching&&(me.pitch=e.number(qe,Et,$n)),ae._padding&&(me.interpolatePadding(Qe,Tt,$n),Dt=me.centerPoint.add(bt));var Ci=1===$n?Nt:me.unproject(nr.add(dr.mult(Hn(xi))).mult(mi));me.setLocationAtPoint(me.renderWorldCopies?Ci.wrap():Ci,Dt),ae._fireMoveEvents(H)},function(){return ae._afterEase(H)},F),this},D.prototype.isEasing=function(){return!!this._easeFrameId},D.prototype.stop=function(){return this._stop()},D.prototype._stop=function(F,H){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),delete this._easeFrameId,delete this._onEaseFrame),this._onEaseEnd){var ae=this._onEaseEnd;delete this._onEaseEnd,ae.call(this,H)}if(!F){var ue=this.handlers;ue&&ue.stop()}return this},D.prototype._ease=function(F,H,ae){!1===ae.animate||0===ae.duration?(F(1),H()):(this._easeStart=e.browser.now(),this._easeOptions=ae,this._onEaseFrame=F,this._onEaseEnd=H,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))},D.prototype._renderFrameCallback=function(){var F=Math.min((e.browser.now()-this._easeStart)/this._easeOptions.duration,1);this._onEaseFrame(this._easeOptions.easing(F)),F<1?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()},D.prototype._normalizeBearing=function(F,H){F=e.wrap(F,-180,180);var ae=Math.abs(F-H);return Math.abs(F-360-H)<ae&&(F-=360),Math.abs(F+360-H)<ae&&(F+=360),F},D.prototype._normalizeCenter=function(F){var H=this.transform;if(H.renderWorldCopies&&!H.lngRange){var ae=F.lng-H.center.lng;F.lng+=ae>180?-360:ae<-180?360:0}},D}(e.Evented),Da=function(C){void 0===C&&(C={}),this.options=C,e.bindAll(["_updateEditLink","_updateData","_updateCompact"],this)};Da.prototype.getDefaultPosition=function(){return"bottom-right"},Da.prototype.onAdd=function(C){var D=this.options&&this.options.compact;return this._map=C,this._container=t.create("div","mapboxgl-ctrl mapboxgl-ctrl-attrib"),this._innerContainer=t.create("div","mapboxgl-ctrl-attrib-inner",this._container),D&&this._container.classList.add("mapboxgl-compact"),this._updateAttributions(),this._updateEditLink(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("moveend",this._updateEditLink),void 0===D&&(this._map.on("resize",this._updateCompact),this._updateCompact()),this._container},Da.prototype.onRemove=function(){t.remove(this._container),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("moveend",this._updateEditLink),this._map.off("resize",this._updateCompact),this._map=void 0,this._attribHTML=void 0},Da.prototype._updateEditLink=function(){var C=this._editLink;C||(C=this._editLink=this._container.querySelector(".mapbox-improve-map"));var D=[{key:"owner",value:this.styleOwner},{key:"id",value:this.styleId},{key:"access_token",value:this._map._requestManager._customAccessToken||e.config.ACCESS_TOKEN}];if(C){var F=D.reduce(function(H,ae,ue){return ae.value&&(H+=ae.key+"="+ae.value+(ue<D.length-1?"&":"")),H},"?");C.href=e.config.FEEDBACK_URL+"/"+F+(this._map._hash?this._map._hash.getHashString(!0):""),C.rel="noopener nofollow"}},Da.prototype._updateData=function(C){!C||"metadata"!==C.sourceDataType&&"style"!==C.dataType||(this._updateAttributions(),this._updateEditLink())},Da.prototype._updateAttributions=function(){if(this._map.style){var C=[];if(this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?C=C.concat(this.options.customAttribution.map(function(be){return"string"!=typeof be?"":be})):"string"==typeof this.options.customAttribution&&C.push(this.options.customAttribution)),this._map.style.stylesheet){var D=this._map.style.stylesheet;this.styleOwner=D.owner,this.styleId=D.id}var F=this._map.style.sourceCaches;for(var H in F){var ae=F[H];if(ae.used){var ue=ae.getSource();ue.attribution&&C.indexOf(ue.attribution)<0&&C.push(ue.attribution)}}C.sort(function(be,Le){return be.length-Le.length});var me=(C=C.filter(function(be,Le){for(var qe=Le+1;qe<C.length;qe++)if(C[qe].indexOf(be)>=0)return!1;return!0})).join(" | ");me!==this._attribHTML&&(this._attribHTML=me,C.length?(this._innerContainer.innerHTML=me,this._container.classList.remove("mapboxgl-attrib-empty")):this._container.classList.add("mapboxgl-attrib-empty"),this._editLink=null)}},Da.prototype._updateCompact=function(){this._map.getCanvasContainer().offsetWidth<=640?this._container.classList.add("mapboxgl-compact"):this._container.classList.remove("mapboxgl-compact")};var Ko=function(){e.bindAll(["_updateLogo"],this),e.bindAll(["_updateCompact"],this)};Ko.prototype.onAdd=function(C){this._map=C,this._container=t.create("div","mapboxgl-ctrl");var D=t.create("a","mapboxgl-ctrl-logo");return D.target="_blank",D.rel="noopener nofollow",D.href="https://www.mapbox.com/",D.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),D.setAttribute("rel","noopener nofollow"),this._container.appendChild(D),this._container.style.display="none",this._map.on("sourcedata",this._updateLogo),this._updateLogo(),this._map.on("resize",this._updateCompact),this._updateCompact(),this._container},Ko.prototype.onRemove=function(){t.remove(this._container),this._map.off("sourcedata",this._updateLogo),this._map.off("resize",this._updateCompact)},Ko.prototype.getDefaultPosition=function(){return"bottom-left"},Ko.prototype._updateLogo=function(C){C&&"metadata"!==C.sourceDataType||(this._container.style.display=this._logoRequired()?"block":"none")},Ko.prototype._logoRequired=function(){if(this._map.style){var C=this._map.style.sourceCaches;for(var D in C)if(C[D].getSource().mapbox_logo)return!0;return!1}},Ko.prototype._updateCompact=function(){var C=this._container.children;if(C.length){var D=C[0];this._map.getCanvasContainer().offsetWidth<250?D.classList.add("mapboxgl-compact"):D.classList.remove("mapboxgl-compact")}};var ci=function(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1};ci.prototype.add=function(C){var D=++this._id;return this._queue.push({callback:C,id:D,cancelled:!1}),D},ci.prototype.remove=function(C){for(var D=this._currentlyRunning,F=0,H=D?this._queue.concat(D):this._queue;F<H.length;F+=1){var ae=H[F];if(ae.id===C)return void(ae.cancelled=!0)}},ci.prototype.run=function(C){void 0===C&&(C=0);var D=this._currentlyRunning=this._queue;this._queue=[];for(var F=0,H=D;F<H.length;F+=1){var ae=H[F];if(!ae.cancelled&&(ae.callback(C),this._cleared))break}this._cleared=!1,this._currentlyRunning=!1},ci.prototype.clear=function(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]};var yi={"FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"Mapbox logo","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScaleControl.Feet":"ft","ScaleControl.Meters":"m","ScaleControl.Kilometers":"km","ScaleControl.Miles":"mi","ScaleControl.NauticalMiles":"nm"},Ds=e.window.HTMLImageElement,zs=e.window.HTMLElement,Qo=e.window.ImageBitmap,Eo={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:60,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:!0,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,maxTileCacheSize:null,localIdeographFontFamily:"sans-serif",transformRequest:null,accessToken:null,fadeDuration:300,crossSourceCollisions:!0},Uo=function(C){function D(H){var ae=this;if(null!=(H=e.extend({},Eo,H)).minZoom&&null!=H.maxZoom&&H.minZoom>H.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(null!=H.minPitch&&null!=H.maxPitch&&H.minPitch>H.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(null!=H.minPitch&&H.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(null!=H.maxPitch&&H.maxPitch>60)throw new Error("maxPitch must be less than or equal to 60");var ue=new Vt(H.minZoom,H.maxZoom,H.minPitch,H.maxPitch,H.renderWorldCopies);if(C.call(this,ue,H),this._interactive=H.interactive,this._maxTileCacheSize=H.maxTileCacheSize,this._failIfMajorPerformanceCaveat=H.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=H.preserveDrawingBuffer,this._antialias=H.antialias,this._trackResize=H.trackResize,this._bearingSnap=H.bearingSnap,this._refreshExpiredTiles=H.refreshExpiredTiles,this._fadeDuration=H.fadeDuration,this._crossSourceCollisions=H.crossSourceCollisions,this._crossFadingFactor=1,this._collectResourceTiming=H.collectResourceTiming,this._renderTaskQueue=new ci,this._controls=[],this._mapId=e.uniqueId(),this._locale=e.extend({},yi,H.locale),this._requestManager=new e.RequestManager(H.transformRequest,H.accessToken),"string"==typeof H.container){if(this._container=e.window.document.getElementById(H.container),!this._container)throw new Error("Container '"+H.container+"' not found.")}else{if(!(H.container instanceof zs))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=H.container}if(H.maxBounds&&this.setMaxBounds(H.maxBounds),e.bindAll(["_onWindowOnline","_onWindowResize","_contextLost","_contextRestored"],this),this._setupContainer(),this._setupPainter(),void 0===this.painter)throw new Error("Failed to initialize WebGL.");this.on("move",function(){return ae._update(!1)}),this.on("moveend",function(){return ae._update(!1)}),this.on("zoom",function(){return ae._update(!0)}),void 0!==e.window&&(e.window.addEventListener("online",this._onWindowOnline,!1),e.window.addEventListener("resize",this._onWindowResize,!1)),this.handlers=new Oa(this,H),this._hash=H.hash&&new Pr("string"==typeof H.hash&&H.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:H.center,zoom:H.zoom,bearing:H.bearing,pitch:H.pitch}),H.bounds&&(this.resize(),this.fitBounds(H.bounds,e.extend({},H.fitBoundsOptions,{duration:0})))),this.resize(),this._localIdeographFontFamily=H.localIdeographFontFamily,H.style&&this.setStyle(H.style,{localIdeographFontFamily:H.localIdeographFontFamily}),H.attributionControl&&this.addControl(new Da({customAttribution:H.customAttribution})),this.addControl(new Ko,H.logoPosition),this.on("style.load",function(){ae.transform.unmodified&&ae.jumpTo(ae.style.stylesheet)}),this.on("data",function(be){ae._update("style"===be.dataType),ae.fire(new e.Event(be.dataType+"data",be))}),this.on("dataloading",function(be){ae.fire(new e.Event(be.dataType+"dataloading",be))})}C&&(D.__proto__=C),(D.prototype=Object.create(C&&C.prototype)).constructor=D;var F={showTileBoundaries:{configurable:!0},showPadding:{configurable:!0},showCollisionBoxes:{configurable:!0},showOverdrawInspector:{configurable:!0},repaint:{configurable:!0},vertices:{configurable:!0},version:{configurable:!0}};return D.prototype._getMapId=function(){return this._mapId},D.prototype.addControl=function(H,ae){if(void 0===ae&&H.getDefaultPosition&&(ae=H.getDefaultPosition()),void 0===ae&&(ae="top-right"),!H||!H.onAdd)return this.fire(new e.ErrorEvent(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));var ue=H.onAdd(this);this._controls.push(H);var me=this._controlPositions[ae];return-1!==ae.indexOf("bottom")?me.insertBefore(ue,me.firstChild):me.appendChild(ue),this},D.prototype.removeControl=function(H){if(!H||!H.onRemove)return this.fire(new e.ErrorEvent(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));var ae=this._controls.indexOf(H);return ae>-1&&this._controls.splice(ae,1),H.onRemove(this),this},D.prototype.resize=function(H){var ae=this._containerDimensions(),ue=ae[0],me=ae[1];this._resizeCanvas(ue,me),this.transform.resize(ue,me),this.painter.resize(ue,me);var be=!this._moving;return be&&(this.stop(),this.fire(new e.Event("movestart",H)).fire(new e.Event("move",H))),this.fire(new e.Event("resize",H)),be&&this.fire(new e.Event("moveend",H)),this},D.prototype.getBounds=function(){return this.transform.getBounds()},D.prototype.getMaxBounds=function(){return this.transform.getMaxBounds()},D.prototype.setMaxBounds=function(H){return this.transform.setMaxBounds(e.LngLatBounds.convert(H)),this._update()},D.prototype.setMinZoom=function(H){if((H=H??-2)>=-2&&H<=this.transform.maxZoom)return this.transform.minZoom=H,this._update(),this.getZoom()<H&&this.setZoom(H),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")},D.prototype.getMinZoom=function(){return this.transform.minZoom},D.prototype.setMaxZoom=function(H){if((H=H??22)>=this.transform.minZoom)return this.transform.maxZoom=H,this._update(),this.getZoom()>H&&this.setZoom(H),this;throw new Error("maxZoom must be greater than the current minZoom")},D.prototype.getMaxZoom=function(){return this.transform.maxZoom},D.prototype.setMinPitch=function(H){if((H=H??0)<0)throw new Error("minPitch must be greater than or equal to 0");if(H>=0&&H<=this.transform.maxPitch)return this.transform.minPitch=H,this._update(),this.getPitch()<H&&this.setPitch(H),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")},D.prototype.getMinPitch=function(){return this.transform.minPitch},D.prototype.setMaxPitch=function(H){if((H=H??60)>60)throw new Error("maxPitch must be less than or equal to 60");if(H>=this.transform.minPitch)return this.transform.maxPitch=H,this._update(),this.getPitch()>H&&this.setPitch(H),this;throw new Error("maxPitch must be greater than the current minPitch")},D.prototype.getMaxPitch=function(){return this.transform.maxPitch},D.prototype.getRenderWorldCopies=function(){return this.transform.renderWorldCopies},D.prototype.setRenderWorldCopies=function(H){return this.transform.renderWorldCopies=H,this._update()},D.prototype.project=function(H){return this.transform.locationPoint(e.LngLat.convert(H))},D.prototype.unproject=function(H){return this.transform.pointLocation(e.Point.convert(H))},D.prototype.isMoving=function(){return this._moving||this.handlers.isMoving()},D.prototype.isZooming=function(){return this._zooming||this.handlers.isZooming()},D.prototype.isRotating=function(){return this._rotating||this.handlers.isRotating()},D.prototype._createDelegatedListener=function(H,ae,ue){var me,be=this;if("mouseenter"===H||"mouseover"===H){var Le=!1;return{layer:ae,listener:ue,delegates:{mousemove:function(Qe){var at=be.getLayer(ae)?be.queryRenderedFeatures(Qe.point,{layers:[ae]}):[];at.length?Le||(Le=!0,ue.call(be,new zn(H,be,Qe.originalEvent,{features:at}))):Le=!1},mouseout:function(){Le=!1}}}}if("mouseleave"===H||"mouseout"===H){var qe=!1;return{layer:ae,listener:ue,delegates:{mousemove:function(Qe){(be.getLayer(ae)?be.queryRenderedFeatures(Qe.point,{layers:[ae]}):[]).length?qe=!0:qe&&(qe=!1,ue.call(be,new zn(H,be,Qe.originalEvent)))},mouseout:function(Qe){qe&&(qe=!1,ue.call(be,new zn(H,be,Qe.originalEvent)))}}}}return{layer:ae,listener:ue,delegates:(me={},me[H]=function(Qe){var at=be.getLayer(ae)?be.queryRenderedFeatures(Qe.point,{layers:[ae]}):[];at.length&&(Qe.features=at,ue.call(be,Qe),delete Qe.features)},me)}},D.prototype.on=function(H,ae,ue){if(void 0===ue)return C.prototype.on.call(this,H,ae);var me=this._createDelegatedListener(H,ae,ue);for(var be in this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[H]=this._delegatedListeners[H]||[],this._delegatedListeners[H].push(me),me.delegates)this.on(be,me.delegates[be]);return this},D.prototype.once=function(H,ae,ue){if(void 0===ue)return C.prototype.once.call(this,H,ae);var me=this._createDelegatedListener(H,ae,ue);for(var be in me.delegates)this.once(be,me.delegates[be]);return this},D.prototype.off=function(H,ae,ue){var me=this;return void 0===ue?C.prototype.off.call(this,H,ae):(this._delegatedListeners&&this._delegatedListeners[H]&&function(be){for(var Le=be[H],qe=0;qe<Le.length;qe++){var Qe=Le[qe];if(Qe.layer===ae&&Qe.listener===ue){for(var at in Qe.delegates)me.off(at,Qe.delegates[at]);return Le.splice(qe,1),me}}}(this._delegatedListeners),this)},D.prototype.queryRenderedFeatures=function(H,ae){if(!this.style)return[];var ue;if(void 0!==ae||void 0===H||H instanceof e.Point||Array.isArray(H)||(ae=H,H=void 0),ae=ae||{},(H=H||[[0,0],[this.transform.width,this.transform.height]])instanceof e.Point||"number"==typeof H[0])ue=[e.Point.convert(H)];else{var me=e.Point.convert(H[0]),be=e.Point.convert(H[1]);ue=[me,new e.Point(be.x,me.y),be,new e.Point(me.x,be.y),me]}return this.style.queryRenderedFeatures(ue,ae,this.transform)},D.prototype.querySourceFeatures=function(H,ae){return this.style.querySourceFeatures(H,ae)},D.prototype.setStyle=function(H,ae){return!1!==(ae=e.extend({},{localIdeographFontFamily:this._localIdeographFontFamily},ae)).diff&&ae.localIdeographFontFamily===this._localIdeographFontFamily&&this.style&&H?(this._diffStyle(H,ae),this):(this._localIdeographFontFamily=ae.localIdeographFontFamily,this._updateStyle(H,ae))},D.prototype._getUIString=function(H){var ae=this._locale[H];if(null==ae)throw new Error("Missing UI string '"+H+"'");return ae},D.prototype._updateStyle=function(H,ae){return this.style&&(this.style.setEventedParent(null),this.style._remove()),H?(this.style=new bn(this,ae||{}),this.style.setEventedParent(this,{style:this.style}),"string"==typeof H?this.style.loadURL(H):this.style.loadJSON(H),this):(delete this.style,this)},D.prototype._lazyInitEmptyStyle=function(){this.style||(this.style=new bn(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())},D.prototype._diffStyle=function(H,ae){var ue=this;if("string"==typeof H){var me=this._requestManager.normalizeStyleURL(H),be=this._requestManager.transformRequest(me,e.ResourceType.Style);e.getJSON(be,function(Le,qe){Le?ue.fire(new e.ErrorEvent(Le)):qe&&ue._updateDiff(qe,ae)})}else"object"==typeof H&&this._updateDiff(H,ae)},D.prototype._updateDiff=function(H,ae){try{this.style.setState(H)&&this._update(!0)}catch(ue){e.warnOnce("Unable to perform style diff: "+(ue.message||ue.error||ue)+".  Rebuilding the style from scratch."),this._updateStyle(H,ae)}},D.prototype.getStyle=function(){if(this.style)return this.style.serialize()},D.prototype.isStyleLoaded=function(){return this.style?this.style.loaded():e.warnOnce("There is no style added to the map.")},D.prototype.addSource=function(H,ae){return this._lazyInitEmptyStyle(),this.style.addSource(H,ae),this._update(!0)},D.prototype.isSourceLoaded=function(H){var ae=this.style&&this.style.sourceCaches[H];if(void 0!==ae)return ae.loaded();this.fire(new e.ErrorEvent(new Error("There is no source with ID '"+H+"'")))},D.prototype.areTilesLoaded=function(){var H=this.style&&this.style.sourceCaches;for(var ae in H){var ue=H[ae]._tiles;for(var me in ue){var be=ue[me];if("loaded"!==be.state&&"errored"!==be.state)return!1}}return!0},D.prototype.addSourceType=function(H,ae,ue){return this._lazyInitEmptyStyle(),this.style.addSourceType(H,ae,ue)},D.prototype.removeSource=function(H){return this.style.removeSource(H),this._update(!0)},D.prototype.getSource=function(H){return this.style.getSource(H)},D.prototype.addImage=function(H,ae,ue){void 0===ue&&(ue={});var me=ue.pixelRatio;void 0===me&&(me=1);var be=ue.sdf;void 0===be&&(be=!1);var Le=ue.stretchX,qe=ue.stretchY,Qe=ue.content;if(this._lazyInitEmptyStyle(),ae instanceof Ds||Qo&&ae instanceof Qo){var at=e.browser.getImageData(ae);this.style.addImage(H,{data:new e.RGBAImage({width:at.width,height:at.height},at.data),pixelRatio:me,stretchX:Le,stretchY:qe,content:Qe,sdf:be,version:0})}else{if(void 0===ae.width||void 0===ae.height)return this.fire(new e.ErrorEvent(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));var It=ae;this.style.addImage(H,{data:new e.RGBAImage({width:ae.width,height:ae.height},new Uint8Array(ae.data)),pixelRatio:me,stretchX:Le,stretchY:qe,content:Qe,sdf:be,version:0,userImage:It}),It.onAdd&&It.onAdd(this,H)}},D.prototype.updateImage=function(H,ae){var ue=this.style.getImage(H);if(!ue)return this.fire(new e.ErrorEvent(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));var me=ae instanceof Ds||Qo&&ae instanceof Qo?e.browser.getImageData(ae):ae,be=me.width,Le=me.height,qe=me.data;return void 0===be||void 0===Le?this.fire(new e.ErrorEvent(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`"))):be!==ue.data.width||Le!==ue.data.height?this.fire(new e.ErrorEvent(new Error("The width and height of the updated image must be that same as the previous version of the image"))):(ue.data.replace(qe,!(ae instanceof Ds||Qo&&ae instanceof Qo)),void this.style.updateImage(H,ue))},D.prototype.hasImage=function(H){return H?!!this.style.getImage(H):(this.fire(new e.ErrorEvent(new Error("Missing required image id"))),!1)},D.prototype.removeImage=function(H){this.style.removeImage(H)},D.prototype.loadImage=function(H,ae){e.getImage(this._requestManager.transformRequest(H,e.ResourceType.Image),ae)},D.prototype.listImages=function(){return this.style.listImages()},D.prototype.addLayer=function(H,ae){return this._lazyInitEmptyStyle(),this.style.addLayer(H,ae),this._update(!0)},D.prototype.moveLayer=function(H,ae){return this.style.moveLayer(H,ae),this._update(!0)},D.prototype.removeLayer=function(H){return this.style.removeLayer(H),this._update(!0)},D.prototype.getLayer=function(H){return this.style.getLayer(H)},D.prototype.setLayerZoomRange=function(H,ae,ue){return this.style.setLayerZoomRange(H,ae,ue),this._update(!0)},D.prototype.setFilter=function(H,ae,ue){return void 0===ue&&(ue={}),this.style.setFilter(H,ae,ue),this._update(!0)},D.prototype.getFilter=function(H){return this.style.getFilter(H)},D.prototype.setPaintProperty=function(H,ae,ue,me){return void 0===me&&(me={}),this.style.setPaintProperty(H,ae,ue,me),this._update(!0)},D.prototype.getPaintProperty=function(H,ae){return this.style.getPaintProperty(H,ae)},D.prototype.setLayoutProperty=function(H,ae,ue,me){return void 0===me&&(me={}),this.style.setLayoutProperty(H,ae,ue,me),this._update(!0)},D.prototype.getLayoutProperty=function(H,ae){return this.style.getLayoutProperty(H,ae)},D.prototype.setLight=function(H,ae){return void 0===ae&&(ae={}),this._lazyInitEmptyStyle(),this.style.setLight(H,ae),this._update(!0)},D.prototype.getLight=function(){return this.style.getLight()},D.prototype.setFeatureState=function(H,ae){return this.style.setFeatureState(H,ae),this._update()},D.prototype.removeFeatureState=function(H,ae){return this.style.removeFeatureState(H,ae),this._update()},D.prototype.getFeatureState=function(H){return this.style.getFeatureState(H)},D.prototype.getContainer=function(){return this._container},D.prototype.getCanvasContainer=function(){return this._canvasContainer},D.prototype.getCanvas=function(){return this._canvas},D.prototype._containerDimensions=function(){var H=0,ae=0;return this._container&&(H=this._container.clientWidth||400,ae=this._container.clientHeight||300),[H,ae]},D.prototype._detectMissingCSS=function(){"rgb(250, 128, 114)"!==e.window.getComputedStyle(this._missingCSSCanary).getPropertyValue("background-color")&&e.warnOnce("This page appears to be missing CSS declarations for Mapbox GL JS, which may cause the map to display incorrectly. Please ensure your page includes mapbox-gl.css, as described in https://www.mapbox.com/mapbox-gl-js/api/.")},D.prototype._setupContainer=function(){var H=this._container;H.classList.add("mapboxgl-map"),(this._missingCSSCanary=t.create("div","mapboxgl-canary",H)).style.visibility="hidden",this._detectMissingCSS();var ae=this._canvasContainer=t.create("div","mapboxgl-canvas-container",H);this._interactive&&ae.classList.add("mapboxgl-interactive"),this._canvas=t.create("canvas","mapboxgl-canvas",ae),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex","0"),this._canvas.setAttribute("aria-label","Map");var ue=this._containerDimensions();this._resizeCanvas(ue[0],ue[1]);var me=this._controlContainer=t.create("div","mapboxgl-control-container",H),be=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(function(Le){be[Le]=t.create("div","mapboxgl-ctrl-"+Le,me)})},D.prototype._resizeCanvas=function(H,ae){var ue=e.browser.devicePixelRatio||1;this._canvas.width=ue*H,this._canvas.height=ue*ae,this._canvas.style.width=H+"px",this._canvas.style.height=ae+"px"},D.prototype._setupPainter=function(){var H=e.extend({},n.webGLContextAttributes,{failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1}),ae=this._canvas.getContext("webgl",H)||this._canvas.getContext("experimental-webgl",H);ae?(this.painter=new Oi(ae,this.transform),e.webpSupported.testSupport(ae)):this.fire(new e.ErrorEvent(new Error("Failed to initialize WebGL")))},D.prototype._contextLost=function(H){H.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new e.Event("webglcontextlost",{originalEvent:H}))},D.prototype._contextRestored=function(H){this._setupPainter(),this.resize(),this._update(),this.fire(new e.Event("webglcontextrestored",{originalEvent:H}))},D.prototype.loaded=function(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()},D.prototype._update=function(H){return this.style?(this._styleDirty=this._styleDirty||H,this._sourcesDirty=!0,this.triggerRepaint(),this):this},D.prototype._requestRenderFrame=function(H){return this._update(),this._renderTaskQueue.add(H)},D.prototype._cancelRenderFrame=function(H){this._renderTaskQueue.remove(H)},D.prototype._render=function(H){var ae,ue=this,me=0,be=this.painter.context.extTimerQuery;if(this.listens("gpu-timing-frame")&&(ae=be.createQueryEXT(),be.beginQueryEXT(be.TIME_ELAPSED_EXT,ae),me=e.browser.now()),this.painter.context.setDirty(),this.painter.setBaseState(),this._renderTaskQueue.run(H),!this._removed){var Le=!1;if(this.style&&this._styleDirty){this._styleDirty=!1;var qe=this.transform.zoom,Qe=e.browser.now();this.style.zoomHistory.update(qe,Qe);var at=new e.EvaluationParameters(qe,{now:Qe,fadeDuration:this._fadeDuration,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition()}),_t=at.crossFadingFactor();1===_t&&_t===this._crossFadingFactor||(Le=!0,this._crossFadingFactor=_t),this.style.update(at)}if(this.style&&this._sourcesDirty&&(this._sourcesDirty=!1,this.style._updateSources(this.transform)),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,this._fadeDuration,this._crossSourceCollisions),this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showOverdrawInspector:this._showOverdrawInspector,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:this._fadeDuration,showPadding:this.showPadding,gpuTiming:!!this.listens("gpu-timing-layer")}),this.fire(new e.Event("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,this.fire(new e.Event("load"))),this.style&&(this.style.hasTransitions()||Le)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles(),this.listens("gpu-timing-frame")){var Et=e.browser.now()-me;be.endQueryEXT(be.TIME_ELAPSED_EXT,ae),setTimeout(function(){var Mt=be.getQueryObjectEXT(ae,be.QUERY_RESULT_EXT)/1e6;be.deleteQueryEXT(ae),ue.fire(new e.Event("gpu-timing-frame",{cpuTime:Et,gpuTime:Mt}))},50)}if(this.listens("gpu-timing-layer")){var Tt=this.painter.collectGpuTimers();setTimeout(function(){var Mt=ue.painter.queryGpuTimers(Tt);ue.fire(new e.Event("gpu-timing-layer",{layerTimes:Mt}))},50)}return this._sourcesDirty||this._styleDirty||this._placementDirty||this._repaint?this.triggerRepaint():!this.isMoving()&&this.loaded()&&(this._fullyLoaded||(this._fullyLoaded=!0),this.fire(new e.Event("idle"))),this}},D.prototype.remove=function(){this._hash&&this._hash.remove();for(var H=0,ae=this._controls;H<ae.length;H+=1)ae[H].onRemove(this);this._controls=[],this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this.painter.destroy(),this.handlers.destroy(),delete this.handlers,this.setStyle(null),void 0!==e.window&&(e.window.removeEventListener("resize",this._onWindowResize,!1),e.window.removeEventListener("online",this._onWindowOnline,!1));var ue=this.painter.context.gl.getExtension("WEBGL_lose_context");ue&&ue.loseContext(),Ys(this._canvasContainer),Ys(this._controlContainer),Ys(this._missingCSSCanary),this._container.classList.remove("mapboxgl-map"),this._removed=!0,this.fire(new e.Event("remove"))},D.prototype.triggerRepaint=function(){var H=this;this.style&&!this._frame&&(this._frame=e.browser.frame(function(ae){H._frame=null,H._render(ae)}))},D.prototype._onWindowOnline=function(){this._update()},D.prototype._onWindowResize=function(H){this._trackResize&&this.resize({originalEvent:H})._update()},F.showTileBoundaries.get=function(){return!!this._showTileBoundaries},F.showTileBoundaries.set=function(H){this._showTileBoundaries!==H&&(this._showTileBoundaries=H,this._update())},F.showPadding.get=function(){return!!this._showPadding},F.showPadding.set=function(H){this._showPadding!==H&&(this._showPadding=H,this._update())},F.showCollisionBoxes.get=function(){return!!this._showCollisionBoxes},F.showCollisionBoxes.set=function(H){this._showCollisionBoxes!==H&&(this._showCollisionBoxes=H,H?this.style._generateCollisionBoxes():this._update())},F.showOverdrawInspector.get=function(){return!!this._showOverdrawInspector},F.showOverdrawInspector.set=function(H){this._showOverdrawInspector!==H&&(this._showOverdrawInspector=H,this._update())},F.repaint.get=function(){return!!this._repaint},F.repaint.set=function(H){this._repaint!==H&&(this._repaint=H,this.triggerRepaint())},F.vertices.get=function(){return!!this._vertices},F.vertices.set=function(H){this._vertices=H,this._update()},D.prototype._setCacheLimits=function(H,ae){e.setCacheLimits(H,ae)},F.version.get=function(){return e.version},Object.defineProperties(D.prototype,F),D}(Os);function Ys(C){C.parentNode&&C.parentNode.removeChild(C)}var _s={showCompass:!0,showZoom:!0,visualizePitch:!1},Ji=function(C){var D=this;this.options=e.extend({},_s,C),this._container=t.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._container.addEventListener("contextmenu",function(F){return F.preventDefault()}),this.options.showZoom&&(e.bindAll(["_setButtonTitle","_updateZoomButtons"],this),this._zoomInButton=this._createButton("mapboxgl-ctrl-zoom-in",function(F){return D._map.zoomIn({},{originalEvent:F})}),t.create("span","mapboxgl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden",!0),this._zoomOutButton=this._createButton("mapboxgl-ctrl-zoom-out",function(F){return D._map.zoomOut({},{originalEvent:F})}),t.create("span","mapboxgl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden",!0)),this.options.showCompass&&(e.bindAll(["_rotateCompassArrow"],this),this._compass=this._createButton("mapboxgl-ctrl-compass",function(F){D.options.visualizePitch?D._map.resetNorthPitch({},{originalEvent:F}):D._map.resetNorth({},{originalEvent:F})}),this._compassIcon=t.create("span","mapboxgl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden",!0))};Ji.prototype._updateZoomButtons=function(){var C=this._map.getZoom();this._zoomInButton.disabled=C===this._map.getMaxZoom(),this._zoomOutButton.disabled=C===this._map.getMinZoom()},Ji.prototype._rotateCompassArrow=function(){var C=this.options.visualizePitch?"scale("+1/Math.pow(Math.cos(this._map.transform.pitch*(Math.PI/180)),.5)+") rotateX("+this._map.transform.pitch+"deg) rotateZ("+this._map.transform.angle*(180/Math.PI)+"deg)":"rotate("+this._map.transform.angle*(180/Math.PI)+"deg)";this._compassIcon.style.transform=C},Ji.prototype.onAdd=function(C){return this._map=C,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),this._map.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&this._map.on("pitch",this._rotateCompassArrow),this._map.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new na(this._map,this._compass,this.options.visualizePitch)),this._container},Ji.prototype.onRemove=function(){t.remove(this._container),this.options.showZoom&&this._map.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&this._map.off("pitch",this._rotateCompassArrow),this._map.off("rotate",this._rotateCompassArrow),this._handler.off(),delete this._handler),delete this._map},Ji.prototype._createButton=function(C,D){var F=t.create("button",C,this._container);return F.type="button",F.addEventListener("click",D),F},Ji.prototype._setButtonTitle=function(C,D){var F=this._map._getUIString("NavigationControl."+D);C.title=F,C.setAttribute("aria-label",F)};var na=function(C,D,F){void 0===F&&(F=!1),this._clickTolerance=10,this.element=D,this.mouseRotate=new Ei({clickTolerance:C.dragRotate._mouseRotate._clickTolerance}),this.map=C,F&&(this.mousePitch=new di({clickTolerance:C.dragRotate._mousePitch._clickTolerance})),e.bindAll(["mousedown","mousemove","mouseup","touchstart","touchmove","touchend","reset"],this),t.addEventListener(D,"mousedown",this.mousedown),t.addEventListener(D,"touchstart",this.touchstart,{passive:!1}),t.addEventListener(D,"touchmove",this.touchmove),t.addEventListener(D,"touchend",this.touchend),t.addEventListener(D,"touchcancel",this.reset)};function us(C,D,F){if(C=new e.LngLat(C.lng,C.lat),D){var H=new e.LngLat(C.lng-360,C.lat),ae=new e.LngLat(C.lng+360,C.lat),ue=F.locationPoint(C).distSqr(D);F.locationPoint(H).distSqr(D)<ue?C=H:F.locationPoint(ae).distSqr(D)<ue&&(C=ae)}for(;Math.abs(C.lng-F.center.lng)>180;){var me=F.locationPoint(C);if(me.x>=0&&me.y>=0&&me.x<=F.width&&me.y<=F.height)break;C.lng>F.center.lng?C.lng-=360:C.lng+=360}return C}na.prototype.down=function(C,D){this.mouseRotate.mousedown(C,D),this.mousePitch&&this.mousePitch.mousedown(C,D),t.disableDrag()},na.prototype.move=function(C,D){var F=this.map,H=this.mouseRotate.mousemoveWindow(C,D);if(H&&H.bearingDelta&&F.setBearing(F.getBearing()+H.bearingDelta),this.mousePitch){var ae=this.mousePitch.mousemoveWindow(C,D);ae&&ae.pitchDelta&&F.setPitch(F.getPitch()+ae.pitchDelta)}},na.prototype.off=function(){var C=this.element;t.removeEventListener(C,"mousedown",this.mousedown),t.removeEventListener(C,"touchstart",this.touchstart,{passive:!1}),t.removeEventListener(C,"touchmove",this.touchmove),t.removeEventListener(C,"touchend",this.touchend),t.removeEventListener(C,"touchcancel",this.reset),this.offTemp()},na.prototype.offTemp=function(){t.enableDrag(),t.removeEventListener(e.window,"mousemove",this.mousemove),t.removeEventListener(e.window,"mouseup",this.mouseup)},na.prototype.mousedown=function(C){this.down(e.extend({},C,{ctrlKey:!0,preventDefault:function(){return C.preventDefault()}}),t.mousePos(this.element,C)),t.addEventListener(e.window,"mousemove",this.mousemove),t.addEventListener(e.window,"mouseup",this.mouseup)},na.prototype.mousemove=function(C){this.move(C,t.mousePos(this.element,C))},na.prototype.mouseup=function(C){this.mouseRotate.mouseupWindow(C),this.mousePitch&&this.mousePitch.mouseupWindow(C),this.offTemp()},na.prototype.touchstart=function(C){1!==C.targetTouches.length?this.reset():(this._startPos=this._lastPos=t.touchPos(this.element,C.targetTouches)[0],this.down({type:"mousedown",button:0,ctrlKey:!0,preventDefault:function(){return C.preventDefault()}},this._startPos))},na.prototype.touchmove=function(C){1!==C.targetTouches.length?this.reset():(this._lastPos=t.touchPos(this.element,C.targetTouches)[0],this.move({preventDefault:function(){return C.preventDefault()}},this._lastPos))},na.prototype.touchend=function(C){0===C.targetTouches.length&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),this.reset()},na.prototype.reset=function(){this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()};var ns={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function La(C,D,F){var H=C.classList;for(var ae in ns)H.remove("mapboxgl-"+F+"-anchor-"+ae);H.add("mapboxgl-"+F+"-anchor-"+D)}var fs,ws=function(C){function D(F,H){var ae=this;if(C.call(this),(F instanceof e.window.HTMLElement||H)&&(F=e.extend({element:F},H)),e.bindAll(["_update","_onMove","_onUp","_addDragHandler","_onMapClick","_onKeyPress"],this),this._anchor=F&&F.anchor||"center",this._color=F&&F.color||"#3FB1CE",this._draggable=F&&F.draggable||!1,this._state="inactive",this._rotation=F&&F.rotation||0,this._rotationAlignment=F&&F.rotationAlignment||"auto",this._pitchAlignment=F&&F.pitchAlignment&&"auto"!==F.pitchAlignment?F.pitchAlignment:this._rotationAlignment,F&&F.element)this._element=F.element,this._offset=e.Point.convert(F&&F.offset||[0,0]);else{this._defaultMarker=!0,this._element=t.create("div"),this._element.setAttribute("aria-label","Map marker");var ue=t.createNS("http://www.w3.org/2000/svg","svg");ue.setAttributeNS(null,"display","block"),ue.setAttributeNS(null,"height","41px"),ue.setAttributeNS(null,"width","27px"),ue.setAttributeNS(null,"viewBox","0 0 27 41");var me=t.createNS("http://www.w3.org/2000/svg","g");me.setAttributeNS(null,"stroke","none"),me.setAttributeNS(null,"stroke-width","1"),me.setAttributeNS(null,"fill","none"),me.setAttributeNS(null,"fill-rule","evenodd");var be=t.createNS("http://www.w3.org/2000/svg","g");be.setAttributeNS(null,"fill-rule","nonzero");var Le=t.createNS("http://www.w3.org/2000/svg","g");Le.setAttributeNS(null,"transform","translate(3.0, 29.0)"),Le.setAttributeNS(null,"fill","#000000");for(var qe=0,Qe=[{rx:"10.5",ry:"5.25002273"},{rx:"10.5",ry:"5.25002273"},{rx:"9.5",ry:"4.77275007"},{rx:"8.5",ry:"4.29549936"},{rx:"7.5",ry:"3.81822308"},{rx:"6.5",ry:"3.34094679"},{rx:"5.5",ry:"2.86367051"},{rx:"4.5",ry:"2.38636864"}];qe<Qe.length;qe+=1){var at=Qe[qe],_t=t.createNS("http://www.w3.org/2000/svg","ellipse");_t.setAttributeNS(null,"opacity","0.04"),_t.setAttributeNS(null,"cx","10.5"),_t.setAttributeNS(null,"cy","5.80029008"),_t.setAttributeNS(null,"rx",at.rx),_t.setAttributeNS(null,"ry",at.ry),Le.appendChild(_t)}var Et=t.createNS("http://www.w3.org/2000/svg","g");Et.setAttributeNS(null,"fill",this._color);var Tt=t.createNS("http://www.w3.org/2000/svg","path");Tt.setAttributeNS(null,"d","M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z"),Et.appendChild(Tt);var Mt=t.createNS("http://www.w3.org/2000/svg","g");Mt.setAttributeNS(null,"opacity","0.25"),Mt.setAttributeNS(null,"fill","#000000");var bt=t.createNS("http://www.w3.org/2000/svg","path");bt.setAttributeNS(null,"d","M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z"),Mt.appendChild(bt);var Dt=t.createNS("http://www.w3.org/2000/svg","g");Dt.setAttributeNS(null,"transform","translate(6.0, 7.0)"),Dt.setAttributeNS(null,"fill","#FFFFFF");var It=t.createNS("http://www.w3.org/2000/svg","g");It.setAttributeNS(null,"transform","translate(8.0, 8.0)");var Nt=t.createNS("http://www.w3.org/2000/svg","circle");Nt.setAttributeNS(null,"fill","#000000"),Nt.setAttributeNS(null,"opacity","0.25"),Nt.setAttributeNS(null,"cx","5.5"),Nt.setAttributeNS(null,"cy","5.5"),Nt.setAttributeNS(null,"r","5.4999962");var nr=t.createNS("http://www.w3.org/2000/svg","circle");nr.setAttributeNS(null,"fill","#FFFFFF"),nr.setAttributeNS(null,"cx","5.5"),nr.setAttributeNS(null,"cy","5.5"),nr.setAttributeNS(null,"r","5.4999962"),It.appendChild(Nt),It.appendChild(nr),be.appendChild(Le),be.appendChild(Et),be.appendChild(Mt),be.appendChild(Dt),be.appendChild(It),ue.appendChild(be),this._element.appendChild(ue),this._offset=e.Point.convert(F&&F.offset||[0,-14])}this._element.classList.add("mapboxgl-marker"),this._element.addEventListener("dragstart",function(dr){dr.preventDefault()}),this._element.addEventListener("mousedown",function(dr){dr.preventDefault()}),this._element.addEventListener("focus",function(){var dr=ae._map.getContainer();dr.scrollTop=0,dr.scrollLeft=0}),La(this._element,this._anchor,"marker"),this._popup=null}return C&&(D.__proto__=C),(D.prototype=Object.create(C&&C.prototype)).constructor=D,D.prototype.addTo=function(F){return this.remove(),this._map=F,F.getCanvasContainer().appendChild(this._element),F.on("move",this._update),F.on("moveend",this._update),this.setDraggable(this._draggable),this._update(),this._map.on("click",this._onMapClick),this},D.prototype.remove=function(){return this._map&&(this._map.off("click",this._onMapClick),this._map.off("move",this._update),this._map.off("moveend",this._update),this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler),this._map.off("mouseup",this._onUp),this._map.off("touchend",this._onUp),this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),delete this._map),t.remove(this._element),this._popup&&this._popup.remove(),this},D.prototype.getLngLat=function(){return this._lngLat},D.prototype.setLngLat=function(F){return this._lngLat=e.LngLat.convert(F),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(),this},D.prototype.getElement=function(){return this._element},D.prototype.setPopup=function(F){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),F){if(!("offset"in F.options)){var H=Math.sqrt(Math.pow(13.5,2)/2);F.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[H,-1*(24.6+H)],"bottom-right":[-H,-1*(24.6+H)],left:[13.5,-24.6],right:[-13.5,-24.6]}:this._offset}this._popup=F,this._lngLat&&this._popup.setLngLat(this._lngLat),this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress)}return this},D.prototype._onKeyPress=function(F){var H=F.code,ae=F.charCode||F.keyCode;"Space"!==H&&"Enter"!==H&&32!==ae&&13!==ae||this.togglePopup()},D.prototype._onMapClick=function(F){var H=F.originalEvent.target,ae=this._element;this._popup&&(H===ae||ae.contains(H))&&this.togglePopup()},D.prototype.getPopup=function(){return this._popup},D.prototype.togglePopup=function(){var F=this._popup;return F?(F.isOpen()?F.remove():F.addTo(this._map),this):this},D.prototype._update=function(F){if(this._map){this._map.transform.renderWorldCopies&&(this._lngLat=us(this._lngLat,this._pos,this._map.transform)),this._pos=this._map.project(this._lngLat)._add(this._offset);var H="";"viewport"===this._rotationAlignment||"auto"===this._rotationAlignment?H="rotateZ("+this._rotation+"deg)":"map"===this._rotationAlignment&&(H="rotateZ("+(this._rotation-this._map.getBearing())+"deg)");var ae="";"viewport"===this._pitchAlignment||"auto"===this._pitchAlignment?ae="rotateX(0deg)":"map"===this._pitchAlignment&&(ae="rotateX("+this._map.getPitch()+"deg)"),F&&"moveend"!==F.type||(this._pos=this._pos.round()),t.setTransform(this._element,ns[this._anchor]+" translate("+this._pos.x+"px, "+this._pos.y+"px) "+ae+" "+H)}},D.prototype.getOffset=function(){return this._offset},D.prototype.setOffset=function(F){return this._offset=e.Point.convert(F),this._update(),this},D.prototype._onMove=function(F){this._pos=F.point.sub(this._positionDelta),this._lngLat=this._map.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none","pending"===this._state&&(this._state="active",this.fire(new e.Event("dragstart"))),this.fire(new e.Event("drag"))},D.prototype._onUp=function(){this._element.style.pointerEvents="auto",this._positionDelta=null,this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),"active"===this._state&&this.fire(new e.Event("dragend")),this._state="inactive"},D.prototype._addDragHandler=function(F){this._element.contains(F.originalEvent.target)&&(F.preventDefault(),this._positionDelta=F.point.sub(this._pos).add(this._offset),this._state="pending",this._map.on("mousemove",this._onMove),this._map.on("touchmove",this._onMove),this._map.once("mouseup",this._onUp),this._map.once("touchend",this._onUp))},D.prototype.setDraggable=function(F){return this._draggable=!!F,this._map&&(F?(this._map.on("mousedown",this._addDragHandler),this._map.on("touchstart",this._addDragHandler)):(this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler))),this},D.prototype.isDraggable=function(){return this._draggable},D.prototype.setRotation=function(F){return this._rotation=F||0,this._update(),this},D.prototype.getRotation=function(){return this._rotation},D.prototype.setRotationAlignment=function(F){return this._rotationAlignment=F||"auto",this._update(),this},D.prototype.getRotationAlignment=function(){return this._rotationAlignment},D.prototype.setPitchAlignment=function(F){return this._pitchAlignment=F&&"auto"!==F?F:this._rotationAlignment,this._update(),this},D.prototype.getPitchAlignment=function(){return this._pitchAlignment},D}(e.Evented),gs={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0},Ts=0,is=!1,Ws=function(C){function D(F){C.call(this),this.options=e.extend({},gs,F),e.bindAll(["_onSuccess","_onError","_onZoom","_finish","_setupUI","_updateCamera","_updateMarker"],this)}return C&&(D.__proto__=C),(D.prototype=Object.create(C&&C.prototype)).constructor=D,D.prototype.onAdd=function(F){var H;return this._map=F,this._container=t.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),H=this._setupUI,void 0!==fs?H(fs):void 0!==e.window.navigator.permissions?e.window.navigator.permissions.query({name:"geolocation"}).then(function(ae){H(fs="denied"!==ae.state)}):H(fs=!!e.window.navigator.geolocation),this._container},D.prototype.onRemove=function(){void 0!==this._geolocationWatchID&&(e.window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),t.remove(this._container),this._map.off("zoom",this._onZoom),this._map=void 0,Ts=0,is=!1},D.prototype._isOutOfMapMaxBounds=function(F){var H=this._map.getMaxBounds(),ae=F.coords;return H&&(ae.longitude<H.getWest()||ae.longitude>H.getEast()||ae.latitude<H.getSouth()||ae.latitude>H.getNorth())},D.prototype._setErrorState=function(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting")}},D.prototype._onSuccess=function(F){if(this._map){if(this._isOutOfMapMaxBounds(F))return this._setErrorState(),this.fire(new e.Event("outofmaxbounds",F)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=F,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background")}this.options.showUserLocation&&"OFF"!==this._watchState&&this._updateMarker(F),this.options.trackUserLocation&&"ACTIVE_LOCK"!==this._watchState||this._updateCamera(F),this.options.showUserLocation&&this._dotElement.classList.remove("mapboxgl-user-location-dot-stale"),this.fire(new e.Event("geolocate",F)),this._finish()}},D.prototype._updateCamera=function(F){var H=new e.LngLat(F.coords.longitude,F.coords.latitude),ae=F.coords.accuracy,ue=this._map.getBearing(),me=e.extend({bearing:ue},this.options.fitBoundsOptions);this._map.fitBounds(H.toBounds(ae),me,{geolocateSource:!0})},D.prototype._updateMarker=function(F){if(F){var H=new e.LngLat(F.coords.longitude,F.coords.latitude);this._accuracyCircleMarker.setLngLat(H).addTo(this._map),this._userLocationDotMarker.setLngLat(H).addTo(this._map),this._accuracy=F.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()},D.prototype._updateCircleRadius=function(){var F=this._map._container.clientHeight/2,H=this._map.unproject([0,F]),ae=this._map.unproject([1,F]),ue=H.distanceTo(ae),me=Math.ceil(2*this._accuracy/ue);this._circleElement.style.width=me+"px",this._circleElement.style.height=me+"px"},D.prototype._onZoom=function(){this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()},D.prototype._onError=function(F){if(this._map){if(this.options.trackUserLocation)if(1===F.code){this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;var H=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.title=H,this._geolocateButton.setAttribute("aria-label",H),void 0!==this._geolocationWatchID&&this._clearWatch()}else{if(3===F.code&&is)return;this._setErrorState()}"OFF"!==this._watchState&&this.options.showUserLocation&&this._dotElement.classList.add("mapboxgl-user-location-dot-stale"),this.fire(new e.Event("error",F)),this._finish()}},D.prototype._finish=function(){this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0},D.prototype._setupUI=function(F){var H=this;if(this._container.addEventListener("contextmenu",function(me){return me.preventDefault()}),this._geolocateButton=t.create("button","mapboxgl-ctrl-geolocate",this._container),t.create("span","mapboxgl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden",!0),this._geolocateButton.type="button",!1===F){e.warnOnce("Geolocation support is not available so the GeolocateControl will be disabled.");var ae=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.title=ae,this._geolocateButton.setAttribute("aria-label",ae)}else{var ue=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.title=ue,this._geolocateButton.setAttribute("aria-label",ue)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=t.create("div","mapboxgl-user-location-dot"),this._userLocationDotMarker=new ws(this._dotElement),this._circleElement=t.create("div","mapboxgl-user-location-accuracy-circle"),this._accuracyCircleMarker=new ws({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",function(me){me.geolocateSource||"ACTIVE_LOCK"!==H._watchState||me.originalEvent&&"resize"===me.originalEvent.type||(H._watchState="BACKGROUND",H._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background"),H._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),H.fire(new e.Event("trackuserlocationend")))})},D.prototype.trigger=function(){if(!this._setup)return e.warnOnce("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new e.Event("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":Ts--,is=!1,this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this.fire(new e.Event("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new e.Event("trackuserlocationstart"))}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"BACKGROUND":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background");break;case"BACKGROUND_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error")}if("OFF"===this._watchState&&void 0!==this._geolocationWatchID)this._clearWatch();else if(void 0===this._geolocationWatchID){var F;this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),++Ts>1?(F={maximumAge:6e5,timeout:0},is=!0):(F=this.options.positionOptions,is=!1),this._geolocationWatchID=e.window.navigator.geolocation.watchPosition(this._onSuccess,this._onError,F)}}else e.window.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0},D.prototype._clearWatch=function(){e.window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)},D}(e.Evented),il={maxWidth:100,unit:"metric"},hs=function(C){this.options=e.extend({},il,C),e.bindAll(["_onMove","setUnit"],this)};function Xs(C,D,F){var H=F&&F.maxWidth||100,ae=C._container.clientHeight/2,ue=C.unproject([0,ae]),me=C.unproject([H,ae]),be=ue.distanceTo(me);if(F&&"imperial"===F.unit){var Le=3.2808*be;Le>5280?ks(D,H,Le/5280,C._getUIString("ScaleControl.Miles")):ks(D,H,Le,C._getUIString("ScaleControl.Feet"))}else F&&"nautical"===F.unit?ks(D,H,be/1852,C._getUIString("ScaleControl.NauticalMiles")):be>=1e3?ks(D,H,be/1e3,C._getUIString("ScaleControl.Kilometers")):ks(D,H,be,C._getUIString("ScaleControl.Meters"))}function ks(C,D,F,H){var ae,ue,me,qe,Qe,be=(ae=F,(ue=Math.pow(10,(""+Math.floor(ae)).length-1))*(me=(me=ae/ue)>=10?10:me>=5?5:me>=3?3:me>=2?2:me>=1?1:(qe=me,Qe=Math.pow(10,Math.ceil(-Math.log(qe)/Math.LN10)),Math.round(qe*Qe)/Qe)));C.style.width=D*(be/F)+"px",C.innerHTML=be+"&nbsp;"+H}hs.prototype.getDefaultPosition=function(){return"bottom-left"},hs.prototype._onMove=function(){Xs(this._map,this._container,this.options)},hs.prototype.onAdd=function(C){return this._map=C,this._container=t.create("div","mapboxgl-ctrl mapboxgl-ctrl-scale",C.getContainer()),this._map.on("move",this._onMove),this._onMove(),this._container},hs.prototype.onRemove=function(){t.remove(this._container),this._map.off("move",this._onMove),this._map=void 0},hs.prototype.setUnit=function(C){this.options.unit=C,Xs(this._map,this._container,this.options)};var eo=function(C){this._fullscreen=!1,C&&C.container&&(C.container instanceof e.window.HTMLElement?this._container=C.container:e.warnOnce("Full screen control 'container' must be a DOM element.")),e.bindAll(["_onClickFullscreen","_changeIcon"],this),"onfullscreenchange"in e.window.document?this._fullscreenchange="fullscreenchange":"onmozfullscreenchange"in e.window.document?this._fullscreenchange="mozfullscreenchange":"onwebkitfullscreenchange"in e.window.document?this._fullscreenchange="webkitfullscreenchange":"onmsfullscreenchange"in e.window.document&&(this._fullscreenchange="MSFullscreenChange")};eo.prototype.onAdd=function(C){return this._map=C,this._container||(this._container=this._map.getContainer()),this._controlContainer=t.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkFullscreenSupport()?this._setupUI():(this._controlContainer.style.display="none",e.warnOnce("This device does not support fullscreen mode.")),this._controlContainer},eo.prototype.onRemove=function(){t.remove(this._controlContainer),this._map=null,e.window.document.removeEventListener(this._fullscreenchange,this._changeIcon)},eo.prototype._checkFullscreenSupport=function(){return!!(e.window.document.fullscreenEnabled||e.window.document.mozFullScreenEnabled||e.window.document.msFullscreenEnabled||e.window.document.webkitFullscreenEnabled)},eo.prototype._setupUI=function(){var C=this._fullscreenButton=t.create("button","mapboxgl-ctrl-fullscreen",this._controlContainer);t.create("span","mapboxgl-ctrl-icon",C).setAttribute("aria-hidden",!0),C.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),e.window.document.addEventListener(this._fullscreenchange,this._changeIcon)},eo.prototype._updateTitle=function(){var C=this._getTitle();this._fullscreenButton.setAttribute("aria-label",C),this._fullscreenButton.title=C},eo.prototype._getTitle=function(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")},eo.prototype._isFullscreen=function(){return this._fullscreen},eo.prototype._changeIcon=function(){(e.window.document.fullscreenElement||e.window.document.mozFullScreenElement||e.window.document.webkitFullscreenElement||e.window.document.msFullscreenElement)===this._container!==this._fullscreen&&(this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("mapboxgl-ctrl-shrink"),this._fullscreenButton.classList.toggle("mapboxgl-ctrl-fullscreen"),this._updateTitle())},eo.prototype._onClickFullscreen=function(){this._isFullscreen()?e.window.document.exitFullscreen?e.window.document.exitFullscreen():e.window.document.mozCancelFullScreen?e.window.document.mozCancelFullScreen():e.window.document.msExitFullscreen?e.window.document.msExitFullscreen():e.window.document.webkitCancelFullScreen&&e.window.document.webkitCancelFullScreen():this._container.requestFullscreen?this._container.requestFullscreen():this._container.mozRequestFullScreen?this._container.mozRequestFullScreen():this._container.msRequestFullscreen?this._container.msRequestFullscreen():this._container.webkitRequestFullscreen&&this._container.webkitRequestFullscreen()};var al={closeButton:!0,closeOnClick:!0,className:"",maxWidth:"240px"},ol=function(C){function D(F){C.call(this),this.options=e.extend(Object.create(al),F),e.bindAll(["_update","_onClose","remove","_onMouseMove","_onMouseUp","_onDrag"],this)}return C&&(D.__proto__=C),(D.prototype=Object.create(C&&C.prototype)).constructor=D,D.prototype.addTo=function(F){return this._map&&this.remove(),this._map=F,this.options.closeOnClick&&this._map.on("click",this._onClose),this.options.closeOnMove&&this._map.on("move",this._onClose),this._map.on("remove",this.remove),this._update(),this._trackPointer?(this._map.on("mousemove",this._onMouseMove),this._map.on("mouseup",this._onMouseUp),this._container&&this._container.classList.add("mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.add("mapboxgl-track-pointer")):this._map.on("move",this._update),this.fire(new e.Event("open")),this},D.prototype.isOpen=function(){return!!this._map},D.prototype.remove=function(){return this._content&&t.remove(this._content),this._container&&(t.remove(this._container),delete this._container),this._map&&(this._map.off("move",this._update),this._map.off("move",this._onClose),this._map.off("click",this._onClose),this._map.off("remove",this.remove),this._map.off("mousemove",this._onMouseMove),this._map.off("mouseup",this._onMouseUp),this._map.off("drag",this._onDrag),delete this._map),this.fire(new e.Event("close")),this},D.prototype.getLngLat=function(){return this._lngLat},D.prototype.setLngLat=function(F){return this._lngLat=e.LngLat.convert(F),this._pos=null,this._trackPointer=!1,this._update(),this._map&&(this._map.on("move",this._update),this._map.off("mousemove",this._onMouseMove),this._container&&this._container.classList.remove("mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.remove("mapboxgl-track-pointer")),this},D.prototype.trackPointer=function(){return this._trackPointer=!0,this._pos=null,this._update(),this._map&&(this._map.off("move",this._update),this._map.on("mousemove",this._onMouseMove),this._map.on("drag",this._onDrag),this._container&&this._container.classList.add("mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.add("mapboxgl-track-pointer")),this},D.prototype.getElement=function(){return this._container},D.prototype.setText=function(F){return this.setDOMContent(e.window.document.createTextNode(F))},D.prototype.setHTML=function(F){var H,ae=e.window.document.createDocumentFragment(),ue=e.window.document.createElement("body");for(ue.innerHTML=F;H=ue.firstChild;)ae.appendChild(H);return this.setDOMContent(ae)},D.prototype.getMaxWidth=function(){return this._container&&this._container.style.maxWidth},D.prototype.setMaxWidth=function(F){return this.options.maxWidth=F,this._update(),this},D.prototype.setDOMContent=function(F){return this._createContent(),this._content.appendChild(F),this._update(),this},D.prototype.addClassName=function(F){this._container&&this._container.classList.add(F)},D.prototype.removeClassName=function(F){this._container&&this._container.classList.remove(F)},D.prototype.toggleClassName=function(F){if(this._container)return this._container.classList.toggle(F)},D.prototype._createContent=function(){this._content&&t.remove(this._content),this._content=t.create("div","mapboxgl-popup-content",this._container),this.options.closeButton&&(this._closeButton=t.create("button","mapboxgl-popup-close-button",this._content),this._closeButton.type="button",this._closeButton.setAttribute("aria-label","Close popup"),this._closeButton.innerHTML="&#215;",this._closeButton.addEventListener("click",this._onClose))},D.prototype._onMouseUp=function(F){this._update(F.point)},D.prototype._onMouseMove=function(F){this._update(F.point)},D.prototype._onDrag=function(F){this._update(F.point)},D.prototype._update=function(F){var H=this;if(this._map&&(this._lngLat||this._trackPointer)&&this._content&&(this._container||(this._container=t.create("div","mapboxgl-popup",this._map.getContainer()),this._tip=t.create("div","mapboxgl-popup-tip",this._container),this._container.appendChild(this._content),this.options.className&&this.options.className.split(" ").forEach(function(_t){return H._container.classList.add(_t)}),this._trackPointer&&this._container.classList.add("mapboxgl-popup-track-pointer")),this.options.maxWidth&&this._container.style.maxWidth!==this.options.maxWidth&&(this._container.style.maxWidth=this.options.maxWidth),this._map.transform.renderWorldCopies&&!this._trackPointer&&(this._lngLat=us(this._lngLat,this._pos,this._map.transform)),!this._trackPointer||F)){var ue=this._pos=this._trackPointer&&F?F:this._map.project(this._lngLat),me=this.options.anchor,be=function _t(Et){if(Et){if("number"==typeof Et){var Tt=Math.round(Math.sqrt(.5*Math.pow(Et,2)));return{center:new e.Point(0,0),top:new e.Point(0,Et),"top-left":new e.Point(Tt,Tt),"top-right":new e.Point(-Tt,Tt),bottom:new e.Point(0,-Et),"bottom-left":new e.Point(Tt,-Tt),"bottom-right":new e.Point(-Tt,-Tt),left:new e.Point(Et,0),right:new e.Point(-Et,0)}}if(Et instanceof e.Point||Array.isArray(Et)){var Mt=e.Point.convert(Et);return{center:Mt,top:Mt,"top-left":Mt,"top-right":Mt,bottom:Mt,"bottom-left":Mt,"bottom-right":Mt,left:Mt,right:Mt}}return{center:e.Point.convert(Et.center||[0,0]),top:e.Point.convert(Et.top||[0,0]),"top-left":e.Point.convert(Et["top-left"]||[0,0]),"top-right":e.Point.convert(Et["top-right"]||[0,0]),bottom:e.Point.convert(Et.bottom||[0,0]),"bottom-left":e.Point.convert(Et["bottom-left"]||[0,0]),"bottom-right":e.Point.convert(Et["bottom-right"]||[0,0]),left:e.Point.convert(Et.left||[0,0]),right:e.Point.convert(Et.right||[0,0])}}return _t(new e.Point(0,0))}(this.options.offset);if(!me){var Le,qe=this._container.offsetWidth,Qe=this._container.offsetHeight;Le=ue.y+be.bottom.y<Qe?["top"]:ue.y>this._map.transform.height-Qe?["bottom"]:[],ue.x<qe/2?Le.push("left"):ue.x>this._map.transform.width-qe/2&&Le.push("right"),me=0===Le.length?"bottom":Le.join("-")}var at=ue.add(be[me]).round();t.setTransform(this._container,ns[me]+" translate("+at.x+"px,"+at.y+"px)"),La(this._container,me,"popup")}},D.prototype._onClose=function(){this.remove()},D}(e.Evented),ce={version:e.version,supported:n,setRTLTextPlugin:e.setRTLTextPlugin,getRTLTextPluginStatus:e.getRTLTextPluginStatus,Map:Uo,NavigationControl:Ji,GeolocateControl:Ws,AttributionControl:Da,ScaleControl:hs,FullscreenControl:eo,Popup:ol,Marker:ws,Style:bn,LngLat:e.LngLat,LngLatBounds:e.LngLatBounds,Point:e.Point,MercatorCoordinate:e.MercatorCoordinate,Evented:e.Evented,config:e.config,prewarm:function(){rt().acquire(st)},clearPrewarmedResources:function(){var C=wt;C&&(C.isPreloaded()&&1===C.numActive()?(C.release(st),wt=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},get accessToken(){return e.config.ACCESS_TOKEN},set accessToken(C){e.config.ACCESS_TOKEN=C},get baseApiUrl(){return e.config.API_URL},set baseApiUrl(C){e.config.API_URL=C},get workerCount(){return ot.workerCount},set workerCount(C){ot.workerCount=C},get maxParallelImageRequests(){return e.config.MAX_PARALLEL_IMAGE_REQUESTS},set maxParallelImageRequests(C){e.config.MAX_PARALLEL_IMAGE_REQUESTS=C},clearStorage:function(C){e.clearTileCache(C)},workerUrl:""};return ce}),m},"object"==typeof Q&&void 0!==ee?ee.exports=v():(g=g||self).mapboxgl=v()},{}],240:[function(y,ee,Q){"use strict";ee.exports=Math.log2||function(g){return Math.log(g)*Math.LOG2E}},{}],241:[function(y,ee,Q){"use strict";ee.exports=function(v,m){m||(m=v,v=window);var x=0,e=0,n=0,t={shift:!1,alt:!1,control:!1,meta:!1},a=!1;function r(b){var l=!1;return"altKey"in b&&(l=l||b.altKey!==t.alt,t.alt=!!b.altKey),"shiftKey"in b&&(l=l||b.shiftKey!==t.shift,t.shift=!!b.shiftKey),"ctrlKey"in b&&(l=l||b.ctrlKey!==t.control,t.control=!!b.ctrlKey),"metaKey"in b&&(l=l||b.metaKey!==t.meta,t.meta=!!b.metaKey),l}function d(b,l){var T=g.x(l),_=g.y(l);"buttons"in l&&(b=0|l.buttons),(b!==x||T!==e||_!==n||r(l))&&(x=0|b,e=T||0,n=_||0,m&&m(x,e,n,t))}function s(b){d(0,b)}function i(){(x||e||n||t.shift||t.alt||t.meta||t.control)&&(e=n=0,x=0,t.shift=t.alt=t.control=t.meta=!1,m&&m(0,0,0,t))}function u(b){r(b)&&m&&m(x,e,n,t)}function f(b){0===g.buttons(b)?d(0,b):d(x,b)}function c(b){d(x|g.buttons(b),b)}function h(b){d(x&~g.buttons(b),b)}function p(){a||(a=!0,v.addEventListener("mousemove",f),v.addEventListener("mousedown",c),v.addEventListener("mouseup",h),v.addEventListener("mouseleave",s),v.addEventListener("mouseenter",s),v.addEventListener("mouseout",s),v.addEventListener("mouseover",s),v.addEventListener("blur",i),v.addEventListener("keyup",u),v.addEventListener("keydown",u),v.addEventListener("keypress",u),v!==window&&(window.addEventListener("blur",i),window.addEventListener("keyup",u),window.addEventListener("keydown",u),window.addEventListener("keypress",u)))}p();var o={element:v};return Object.defineProperties(o,{enabled:{get:function(){return a},set:function(b){b?p():!a||(a=!1,v.removeEventListener("mousemove",f),v.removeEventListener("mousedown",c),v.removeEventListener("mouseup",h),v.removeEventListener("mouseleave",s),v.removeEventListener("mouseenter",s),v.removeEventListener("mouseout",s),v.removeEventListener("mouseover",s),v.removeEventListener("blur",i),v.removeEventListener("keyup",u),v.removeEventListener("keydown",u),v.removeEventListener("keypress",u),v!==window&&(window.removeEventListener("blur",i),window.removeEventListener("keyup",u),window.removeEventListener("keydown",u),window.removeEventListener("keypress",u)))},enumerable:!0},buttons:{get:function(){return x},enumerable:!0},x:{get:function(){return e},enumerable:!0},y:{get:function(){return n},enumerable:!0},mods:{get:function(){return t},enumerable:!0}}),o};var g=y("mouse-event")},{"mouse-event":243}],242:[function(y,ee,Q){var g={left:0,top:0};ee.exports=function(v,m,x){m=m||v.currentTarget||v.srcElement,Array.isArray(x)||(x=[0,0]);var a,e=v.clientX||0,n=v.clientY||0,t=(a=m)===window||a===document||a===document.body?g:a.getBoundingClientRect();return x[0]=e-t.left,x[1]=n-t.top,x}},{}],243:[function(y,ee,Q){"use strict";function g(v){return v.target||v.srcElement||window}Q.buttons=function(v){if("object"==typeof v){if("buttons"in v)return v.buttons;if("which"in v){if(2===(m=v.which))return 4;if(3===m)return 2;if(m>0)return 1<<m-1}else if("button"in v){var m;if(1===(m=v.button))return 4;if(2===m)return 2;if(m>=0)return 1<<m}}return 0},Q.element=g,Q.x=function(v){if("object"==typeof v){if("offsetX"in v)return v.offsetX;var m=g(v).getBoundingClientRect();return v.clientX-m.left}return 0},Q.y=function(v){if("object"==typeof v){if("offsetY"in v)return v.offsetY;var m=g(v).getBoundingClientRect();return v.clientY-m.top}return 0}},{}],244:[function(y,ee,Q){"use strict";var g=y("to-px");ee.exports=function(v,m,x){"function"==typeof v&&(x=!!m,m=v,v=window);var e=g("ex",v),n=function(t){x&&t.preventDefault();var a=t.deltaX||0,r=t.deltaY||0,d=t.deltaZ||0,s=1;switch(t.deltaMode){case 1:s=e;break;case 2:s=window.innerHeight}if(r*=s,d*=s,(a*=s)||r||d)return m(a,r,d,t)};return v.addEventListener("wheel",n),n}},{"to-px":315}],245:[function(y,ee,Q){(function(g,v){(function(){var m,x,e;e=function(){"use strict";var m,x,e,n=Object.prototype.toString,t=void 0!==v?function(b){return v(b)}:setTimeout;try{Object.defineProperty({},"x",{}),m=function(b,l,T,_){return Object.defineProperty(b,l,{value:T,writable:!0,configurable:!1!==_})}}catch{m=function(l,T,_){return l[T]=_,l}}function a(b,l){e.add(b,l),x||(x=t(e.drain))}function r(b){var l,T=typeof b;return null==b||"object"!=T&&"function"!=T||(l=b.then),"function"==typeof l&&l}function d(){for(var b=0;b<this.chain.length;b++)s(this,1===this.state?this.chain[b].success:this.chain[b].failure,this.chain[b]);this.chain.length=0}function s(b,l,T){var _,w;try{!1===l?T.reject(b.msg):(_=!0===l?b.msg:l.call(void 0,b.msg))===T.promise?T.reject(TypeError("Promise-chain cycle")):(w=r(_))?w.call(_,T.resolve,T.reject):T.resolve(_)}catch(k){T.reject(k)}}function i(b){var l,T=this;if(!T.triggered){T.triggered=!0,T.def&&(T=T.def);try{(l=r(b))?a(function(){var _=new c(T);try{l.call(b,function(){i.apply(_,arguments)},function(){u.apply(_,arguments)})}catch(w){u.call(_,w)}}):(T.msg=b,T.state=1,T.chain.length>0&&a(d,T))}catch(_){u.call(new c(T),_)}}}function u(b){var l=this;l.triggered||(l.triggered=!0,l.def&&(l=l.def),l.msg=b,l.state=2,l.chain.length>0&&a(d,l))}function f(b,l,T,_){for(var w=0;w<l.length;w++)!function(k){b.resolve(l[k]).then(function(L){T(k,L)},_)}(w)}function c(b){this.def=b,this.triggered=!1}function h(b){this.promise=b,this.state=0,this.triggered=!1,this.chain=[],this.msg=void 0}function p(b){if("function"!=typeof b)throw TypeError("Not a function");if(0!==this.__NPO__)throw TypeError("Not a promise");this.__NPO__=1;var l=new h(this);this.then=function(T,_){var w={success:"function"!=typeof T||T,failure:"function"==typeof _&&_};return w.promise=new this.constructor(function(k,L){if("function"!=typeof k||"function"!=typeof L)throw TypeError("Not a function");w.resolve=k,w.reject=L}),l.chain.push(w),0!==l.state&&a(d,l),w.promise},this.catch=function(T){return this.then(void 0,T)};try{b.call(void 0,function(T){i.call(l,T)},function(T){u.call(l,T)})}catch(T){u.call(l,T)}}e=function(){var b,l,T;function _(w,k){this.fn=w,this.self=k,this.next=void 0}return{add:function(w,k){T=new _(w,k),l?l.next=T:b=T,l=T,T=void 0},drain:function(){var w=b;for(b=l=x=void 0;w;)w.fn.call(w.self),w=w.next}}}();var o=m({},"constructor",p,!1);return p.prototype=o,m(o,"__NPO__",0,!1),m(p,"resolve",function(b){return b&&"object"==typeof b&&1===b.__NPO__?b:new this(function(l,T){if("function"!=typeof l||"function"!=typeof T)throw TypeError("Not a function");l(b)})}),m(p,"reject",function(b){return new this(function(l,T){if("function"!=typeof l||"function"!=typeof T)throw TypeError("Not a function");T(b)})}),m(p,"all",function(b){var l=this;return"[object Array]"!=n.call(b)?l.reject(TypeError("Not an array")):0===b.length?l.resolve([]):new l(function(T,_){if("function"!=typeof T||"function"!=typeof _)throw TypeError("Not a function");var w=b.length,k=Array(w),L=0;f(l,b,function(M,I){k[M]=I,++L===w&&T(k)},_)})}),m(p,"race",function(b){var l=this;return"[object Array]"!=n.call(b)?l.reject(TypeError("Not an array")):new l(function(T,_){if("function"!=typeof T||"function"!=typeof _)throw TypeError("Not a function");f(l,b,function(w,k){T(k)},_)})}),p},(x=void 0!==g?g:this)[m="Promise"]=x[m]||e(),void 0!==ee&&ee.exports&&(ee.exports=x[m])}).call(this)}).call(this,typeof global<"u"?global:typeof self<"u"?self:typeof window<"u"?window:{},y("timers").setImmediate)},{timers:312}],246:[function(y,ee,Q){var g=Math.PI,v=t(120);function m(a,r,d,s){return["C",a,r,d,s,d,s]}function x(a,r,d,s,i,u){return["C",a/3+2/3*d,r/3+2/3*s,i/3+2/3*d,u/3+2/3*s,i,u]}function e(a,r,d,s,i,u,f,c,h,p){if(p)I=p[0],P=p[1],L=p[2],M=p[3];else{var o=n(a,r,-i);r=o.y;var b=((a=o.x)-(c=(o=n(c,h,-i)).x))/2,l=(r-(h=o.y))/2,T=b*b/(d*d)+l*l/(s*s);T>1&&(d*=T=Math.sqrt(T),s*=T);var _=d*d,w=s*s,k=(u==f?-1:1)*Math.sqrt(Math.abs((_*w-_*l*l-w*b*b)/(_*l*l+w*b*b)));k==1/0&&(k=1);var L=k*d*l/s+(a+c)/2,M=k*-s*b/d+(r+h)/2,I=Math.asin(((r-M)/s).toFixed(9)),P=Math.asin(((h-M)/s).toFixed(9));(I=a<L?g-I:I)<0&&(I=2*g+I),(P=c<L?g-P:P)<0&&(P=2*g+P),f&&I>P&&(I-=2*g),!f&&P>I&&(P-=2*g)}if(Math.abs(P-I)>v){var S=P,E=c,z=h;P=I+v*(f&&P>I?1:-1);var R=e(c=L+d*Math.cos(P),h=M+s*Math.sin(P),d,s,i,0,f,E,z,[P,S,L,M])}var q=Math.tan((P-I)/4),V=4/3*d*q,W=4/3*s*q,K=[2*a-(a+V*Math.sin(I)),2*r-(r-W*Math.cos(I)),c+V*Math.sin(P),h-W*Math.cos(P),c,h];if(p)return K;R&&(K=K.concat(R));for(var G=0;G<K.length;){var Y=n(K[G],K[G+1],i);K[G++]=Y.x,K[G++]=Y.y}return K}function n(a,r,d){return{x:a*Math.cos(d)-r*Math.sin(d),y:a*Math.sin(d)+r*Math.cos(d)}}function t(a){return a*(g/180)}ee.exports=function(a){for(var r,d=[],s=0,i=0,u=0,f=0,c=null,h=null,p=0,o=0,b=0,l=a.length;b<l;b++){var T=a[b],_=T[0];switch(_){case"M":u=T[1],f=T[2];break;case"A":(T=e(p,o,T[1],T[2],t(T[3]),T[4],T[5],T[6],T[7])).unshift("C"),T.length>7&&(d.push(T.splice(0,7)),T.unshift("C"));break;case"S":var w=p,k=o;"C"!=r&&"S"!=r||(w+=w-s,k+=k-i),T=["C",w,k,T[1],T[2],T[3],T[4]];break;case"T":"Q"==r||"T"==r?(c=2*p-c,h=2*o-h):(c=p,h=o),T=x(p,o,c,h,T[1],T[2]);break;case"Q":c=T[1],h=T[2],T=x(p,o,T[1],T[2],T[3],T[4]);break;case"L":T=m(p,o,T[1],T[2]);break;case"H":T=m(p,o,T[1],o);break;case"V":T=m(p,o,p,T[1]);break;case"Z":T=m(p,o,u,f)}r=_,p=T[T.length-2],o=T[T.length-1],T.length>4?(s=T[T.length-4],i=T[T.length-3]):(s=p,i=o),d.push(T)}return d}},{}],247:[function(y,ee,Q){"use strict";var g=Object.getOwnPropertySymbols,v=Object.prototype.hasOwnProperty,m=Object.prototype.propertyIsEnumerable;function x(e){if(null==e)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(e)}ee.exports=function(){try{if(!Object.assign)return!1;var e=new String("abc");if(e[5]="de","5"===Object.getOwnPropertyNames(e)[0])return!1;for(var n={},t=0;t<10;t++)n["_"+String.fromCharCode(t)]=t;if("0123456789"!==Object.getOwnPropertyNames(n).map(function(r){return n[r]}).join(""))return!1;var a={};return"abcdefghijklmnopqrst".split("").forEach(function(r){a[r]=r}),"abcdefghijklmnopqrst"===Object.keys(Object.assign({},a)).join("")}catch{return!1}}()?Object.assign:function(e,n){for(var t,a,r=x(e),d=1;d<arguments.length;d++){for(var s in t=Object(arguments[d]))v.call(t,s)&&(r[s]=t[s]);if(g){a=g(t);for(var i=0;i<a.length;i++)m.call(t,a[i])&&(r[a[i]]=t[a[i]])}}return r}},{}],248:[function(y,ee,Q){"use strict";function g(x,e){if("string"!=typeof x)return[x];var n=[x];"string"==typeof e||Array.isArray(e)?e={brackets:e}:e||(e={});var t=e.brackets?Array.isArray(e.brackets)?e.brackets:[e.brackets]:["{}","[]","()"],a=e.escape||"___",r=!!e.flat;t.forEach(function(s){var i=new RegExp(["\\",s[0],"[^\\",s[0],"\\",s[1],"]*\\",s[1]].join("")),u=[];function f(c,h,p){var o=n.push(c.slice(s[0].length,-s[1].length))-1;return u.push(o),a+o+a}n.forEach(function(c,h){for(var p,o=0;c!=p;)if(p=c,c=c.replace(i,f),o++>1e4)throw Error("References have circular dependency. Please, check them.");n[h]=c}),u=u.reverse(),n=n.map(function(c){return u.forEach(function(h){c=c.replace(new RegExp("(\\"+a+h+"\\"+a+")","g"),s[0]+"$1"+s[1])}),c})});var d=new RegExp("\\"+a+"([0-9]+)\\"+a);return r?n:function s(i,u,f){for(var c,h=[],p=0;c=d.exec(i);){if(p++>1e4)throw Error("Circular references in parenthesis");h.push(i.slice(0,c.index)),h.push(s(u[c[1]],u)),i=i.slice(c.index+c[0].length)}return h.push(i),h}(n[0],n)}function v(x,e){if(e&&e.flat){var n,t=e&&e.escape||"___",a=x[0];if(!a)return"";for(var r=new RegExp("\\"+t+"([0-9]+)\\"+t),d=0;a!=n;){if(d++>1e4)throw Error("Circular references in "+x);n=a,a=a.replace(r,s)}return a}return x.reduce(function i(u,f){return Array.isArray(f)&&(f=f.reduce(i,"")),u+f},"");function s(i,u){if(null==x[u])throw Error("Reference "+u+"is undefined");return x[u]}}function m(x,e){return Array.isArray(x)?v(x,e):g(x,e)}m.parse=g,m.stringify=v,ee.exports=m},{}],249:[function(y,ee,Q){"use strict";var g=y("pick-by-alias");ee.exports=function(v){var m;return arguments.length>1&&(v=arguments),"string"==typeof v?v=v.split(/\s/).map(parseFloat):"number"==typeof v&&(v=[v]),v.length&&"number"==typeof v[0]?m=1===v.length?{width:v[0],height:v[0],x:0,y:0}:2===v.length?{width:v[0],height:v[1],x:0,y:0}:{x:v[0],y:v[1],width:v[2]-v[0]||0,height:v[3]-v[1]||0}:v&&((m={x:(v=g(v,{left:"x l left Left",top:"y t top Top",width:"w width W Width",height:"h height W Width",bottom:"b bottom Bottom",right:"r right Right"})).left||0,y:v.top||0}).width=v.width??(v.right?v.right-m.x:0),m.height=v.height??(v.bottom?v.bottom-m.y:0)),m}},{"pick-by-alias":253}],250:[function(y,ee,Q){ee.exports=function(x){var e=[];return x.replace(v,function(n,t,a){var s,r=t.toLowerCase();for(s=void 0,a=(s=a.match(m))?s.map(Number):[],"m"==r&&a.length>2&&(e.push([t].concat(a.splice(0,2))),r="l",t="m"==t?"l":"L");;){if(a.length==g[r])return a.unshift(t),e.push(a);if(a.length<g[r])throw new Error("malformed path data");e.push([t].concat(a.splice(0,g[r])))}}),e};var g={a:7,c:6,h:1,l:2,m:2,q:4,s:4,t:2,v:1,z:0},v=/([astvzqmhlc])([^astvzqmhlc]*)/gi,m=/-?[0-9]*\.?[0-9]+(?:e[-+]?\d+)?/gi},{}],251:[function(y,ee,Q){ee.exports=function(g,v){v||(v=[0,""]),g=String(g);var m=parseFloat(g,10);return v[0]=m,v[1]=g.match(/[\d.\-\+]*\s*(.*)/)[1]||"",v}},{}],252:[function(y,ee,Q){(function(g){(function(){(function(){var v,m,x,e,n,t;typeof performance<"u"&&null!==performance&&performance.now?ee.exports=function(){return performance.now()}:null!=g&&g.hrtime?(ee.exports=function(){return(v()-n)/1e6},m=g.hrtime,e=(v=function(){var a;return 1e9*(a=m())[0]+a[1]})(),t=1e9*g.uptime(),n=e-t):Date.now?(ee.exports=function(){return Date.now()-x},x=Date.now()):(ee.exports=function(){return(new Date).getTime()-x},x=(new Date).getTime())}).call(this)}).call(this)}).call(this,y("_process"))},{_process:278}],253:[function(y,ee,Q){"use strict";ee.exports=function(m,x,e){var n,t,a={};if("string"==typeof x&&(x=v(x)),Array.isArray(x)){var r={};for(t=0;t<x.length;t++)r[x[t]]=!0;x=r}for(n in x)x[n]=v(x[n]);var d={};for(n in x){var s=x[n];if(Array.isArray(s))for(t=0;t<s.length;t++){var i=s[t];if(e&&(d[i]=!0),i in m){if(a[n]=m[i],e)for(var u=t;u<s.length;u++)d[s[u]]=!0;break}}else n in m&&(x[n]&&(a[n]=m[n]),e&&(d[n]=!0))}if(e)for(n in m)d[n]||(a[n]=m[n]);return a};var g={};function v(m){return g[m]?g[m]:("string"==typeof m&&(m=g[m]=m.split(/\s*,\s*|\s+/)),m)}},{}],254:[function(y,ee,Q){ee.exports=function(g,v,m,x){var e=g[0],n=g[1],t=!1;void 0===m&&(m=0),void 0===x&&(x=v.length);for(var a=x-m,r=0,d=a-1;r<a;d=r++){var s=v[r+m][0],i=v[r+m][1],f=v[d+m][1];i>n!=f>n&&e<(v[d+m][0]-s)*(n-i)/(f-i)+s&&(t=!t)}return t}},{}],255:[function(y,ee,Q){var g,v=y("./lib/build-log"),m=y("./lib/epsilon"),x=y("./lib/intersecter"),e=y("./lib/segment-chainer"),n=y("./lib/segment-selector"),t=y("./lib/geojson"),a=!1,r=m();function d(s,i,u){var f=g.segments(s),c=g.segments(i),h=u(g.combine(f,c));return g.polygon(h)}g={buildLog:function(s){return!0===s?a=v():!1===s&&(a=!1),!1!==a&&a.list},epsilon:function(s){return r.epsilon(s)},segments:function(s){var i=x(!0,r,a);return s.regions.forEach(i.addRegion),{segments:i.calculate(s.inverted),inverted:s.inverted}},combine:function(s,i){return{combined:x(!1,r,a).calculate(s.segments,s.inverted,i.segments,i.inverted),inverted1:s.inverted,inverted2:i.inverted}},selectUnion:function(s){return{segments:n.union(s.combined,a),inverted:s.inverted1||s.inverted2}},selectIntersect:function(s){return{segments:n.intersect(s.combined,a),inverted:s.inverted1&&s.inverted2}},selectDifference:function(s){return{segments:n.difference(s.combined,a),inverted:s.inverted1&&!s.inverted2}},selectDifferenceRev:function(s){return{segments:n.differenceRev(s.combined,a),inverted:!s.inverted1&&s.inverted2}},selectXor:function(s){return{segments:n.xor(s.combined,a),inverted:s.inverted1!==s.inverted2}},polygon:function(s){return{regions:e(s.segments,r,a),inverted:s.inverted}},polygonFromGeoJSON:function(s){return t.toPolygon(g,s)},polygonToGeoJSON:function(s){return t.fromPolygon(g,r,s)},union:function(s,i){return d(s,i,g.selectUnion)},intersect:function(s,i){return d(s,i,g.selectIntersect)},difference:function(s,i){return d(s,i,g.selectDifference)},differenceRev:function(s,i){return d(s,i,g.selectDifferenceRev)},xor:function(s,i){return d(s,i,g.selectXor)}},"object"==typeof window&&(window.PolyBool=g),ee.exports=g},{"./lib/build-log":256,"./lib/epsilon":257,"./lib/geojson":258,"./lib/intersecter":259,"./lib/segment-chainer":261,"./lib/segment-selector":262}],256:[function(y,ee,Q){ee.exports=function(){var g,v=0,m=!1;function x(e,n){return g.list.push({type:e,data:n?JSON.parse(JSON.stringify(n)):void 0}),g}return g={list:[],segmentId:function(){return v++},checkIntersection:function(e,n){return x("check",{seg1:e,seg2:n})},segmentChop:function(e,n){return x("div_seg",{seg:e,pt:n}),x("chop",{seg:e,pt:n})},statusRemove:function(e){return x("pop_seg",{seg:e})},segmentUpdate:function(e){return x("seg_update",{seg:e})},segmentNew:function(e,n){return x("new_seg",{seg:e,primary:n})},segmentRemove:function(e){return x("rem_seg",{seg:e})},tempStatus:function(e,n,t){return x("temp_status",{seg:e,above:n,below:t})},rewind:function(e){return x("rewind",{seg:e})},status:function(e,n,t){return x("status",{seg:e,above:n,below:t})},vert:function(e){return e===m?g:(m=e,x("vert",{x:e}))},log:function(e){return"string"!=typeof e&&(e=JSON.stringify(e,!1,"  ")),x("log",{txt:e})},reset:function(){return x("reset")},selected:function(e){return x("selected",{segs:e})},chainStart:function(e){return x("chain_start",{seg:e})},chainRemoveHead:function(e,n){return x("chain_rem_head",{index:e,pt:n})},chainRemoveTail:function(e,n){return x("chain_rem_tail",{index:e,pt:n})},chainNew:function(e,n){return x("chain_new",{pt1:e,pt2:n})},chainMatch:function(e){return x("chain_match",{index:e})},chainClose:function(e){return x("chain_close",{index:e})},chainAddHead:function(e,n){return x("chain_add_head",{index:e,pt:n})},chainAddTail:function(e,n){return x("chain_add_tail",{index:e,pt:n})},chainConnect:function(e,n){return x("chain_con",{index1:e,index2:n})},chainReverse:function(e){return x("chain_rev",{index:e})},chainJoin:function(e,n){return x("chain_join",{index1:e,index2:n})},done:function(){return x("done")}}}},{}],257:[function(y,ee,Q){ee.exports=function(g){"number"!=typeof g&&(g=1e-10);var v={epsilon:function(m){return"number"==typeof m&&(g=m),g},pointAboveOrOnLine:function(m,x,e){var n=x[0],t=x[1];return(e[0]-n)*(m[1]-t)-(e[1]-t)*(m[0]-n)>=-g},pointBetween:function(m,x,e){var t=e[0]-x[0],r=e[1]-x[1],d=(m[0]-x[0])*t+(m[1]-x[1])*r;return!(d<g||d-(t*t+r*r)>-g)},pointsSameX:function(m,x){return Math.abs(m[0]-x[0])<g},pointsSameY:function(m,x){return Math.abs(m[1]-x[1])<g},pointsSame:function(m,x){return v.pointsSameX(m,x)&&v.pointsSameY(m,x)},pointsCompare:function(m,x){return v.pointsSameX(m,x)?v.pointsSameY(m,x)?0:m[1]<x[1]?-1:1:m[0]<x[0]?-1:1},pointsCollinear:function(m,x,e){return Math.abs((m[0]-x[0])*(x[1]-e[1])-(x[0]-e[0])*(m[1]-x[1]))<g},linesIntersect:function(m,x,e,n){var t=x[0]-m[0],a=x[1]-m[1],r=n[0]-e[0],d=n[1]-e[1],s=t*d-a*r;if(Math.abs(s)<g)return!1;var i=m[0]-e[0],u=m[1]-e[1],f=(r*u-d*i)/s,c=(t*u-a*i)/s,h={alongA:0,alongB:0,pt:[m[0]+f*t,m[1]+f*a]};return h.alongA=f<=-g?-2:f<g?-1:f-1<=-g?0:f-1<g?1:2,h.alongB=c<=-g?-2:c<g?-1:c-1<=-g?0:c-1<g?1:2,h},pointInsideRegion:function(m,x){for(var e=m[0],n=m[1],t=x[x.length-1][0],a=x[x.length-1][1],r=!1,d=0;d<x.length;d++){var s=x[d][0],i=x[d][1];i-n>g!=a-n>g&&(t-s)*(n-i)/(a-i)+s-e>g&&(r=!r),t=s,a=i}return r}};return v}},{}],258:[function(y,ee,Q){ee.exports={toPolygon:function(v,m){function x(t){if(t.length<=0)return v.segments({inverted:!1,regions:[]});function a(s){var i=s.slice(0,s.length-1);return v.segments({inverted:!1,regions:[i]})}for(var r=a(t[0]),d=1;d<t.length;d++)r=v.selectDifference(v.combine(r,a(t[d])));return r}if("Polygon"===m.type)return v.polygon(x(m.coordinates));if("MultiPolygon"===m.type){for(var e=v.segments({inverted:!1,regions:[]}),n=0;n<m.coordinates.length;n++)e=v.selectUnion(v.combine(e,x(m.coordinates[n])));return v.polygon(e)}throw new Error("PolyBool: Cannot convert GeoJSON object to PolyBool polygon")},fromPolygon:function(v,m,x){function e(c,h){return m.pointInsideRegion([.5*(c[0][0]+c[1][0]),.5*(c[0][1]+c[1][1])],h)}function n(c){return{region:c,children:[]}}x=v.polygon(v.segments(x));var t=n(null);function a(c,h){for(var p=0;p<c.children.length;p++)if(e(h,(b=c.children[p]).region))return void a(b,h);var o=n(h);for(p=0;p<c.children.length;p++){var b;e((b=c.children[p]).region,h)&&(o.children.push(b),c.children.splice(p,1),p--)}c.children.push(o)}for(var r=0;r<x.regions.length;r++){var d=x.regions[r];d.length<3||a(t,d)}function s(c,h){for(var p=0,o=c[c.length-1][0],b=c[c.length-1][1],l=[],T=0;T<c.length;T++){var _=c[T][0],w=c[T][1];l.push([_,w]),p+=w*o-_*b,o=_,b=w}return p<0!==h&&l.reverse(),l.push([l[0][0],l[0][1]]),l}var i=[];function u(c){var h=[s(c.region,!1)];i.push(h);for(var p=0;p<c.children.length;p++)h.push(f(c.children[p]))}function f(c){for(var h=0;h<c.children.length;h++)u(c.children[h]);return s(c.region,!0)}for(r=0;r<t.children.length;r++)u(t.children[r]);return i.length<=0?{type:"Polygon",coordinates:[]}:1==i.length?{type:"Polygon",coordinates:i[0]}:{type:"MultiPolygon",coordinates:i}}}},{}],259:[function(y,ee,Q){var g=y("./linked-list");ee.exports=function(v,m,x){function e(s,i,u){return{id:x?x.segmentId():-1,start:s,end:i,myFill:{above:u.myFill.above,below:u.myFill.below},otherFill:null}}var n=g.create();function t(s,i){n.insertBefore(s,function(u){return f=s.isStart,h=i,p=u.isStart,b=u.other.pt,(0!==(l=m.pointsCompare(s.pt,o=u.pt))?l:m.pointsSame(h,b)?0:f!==p?f?1:-1:m.pointAboveOrOnLine(h,p?o:b,p?b:o)?1:-1)<0;var f,h,p,o,b,l})}function a(s,i){var f,h,u=(t(h=g.node({isStart:!0,pt:(f=s).start,seg:f,primary:i,other:null,status:null}),f.end),h);return function(f,c,h){var p=g.node({isStart:!1,pt:c.end,seg:c,primary:h,other:f,status:null});f.other=p,t(p,f.pt)}(u,s,i),u}function r(s,i){var f,c,u=e(i,s.seg.end,s.seg);return f=s,c=i,x&&x.segmentChop(f.seg,c),f.other.remove(),f.seg.end=c,f.other.pt=c,t(f.other,f.pt),a(u,s.primary)}function d(s,i){var u=g.create();function f(I){return u.findTransition(function(P){var S,E,z,R,q,V;return R=(S=I).seg.end,(m.pointsCollinear(z=S.seg.start,q=(E=P.ev).seg.start,V=E.seg.end)?m.pointsCollinear(R,q,V)||m.pointAboveOrOnLine(R,q,V)?1:-1:m.pointAboveOrOnLine(z,q,V)?1:-1)>0})}function c(I,P){var S=I.seg,E=P.seg,z=S.start,R=S.end,q=E.start,V=E.end;x&&x.checkIntersection(S,E);var W=m.linesIntersect(z,R,q,V);if(!1===W){if(!m.pointsCollinear(z,R,q)||m.pointsSame(z,V)||m.pointsSame(R,q))return!1;var K=m.pointsSame(z,q),G=m.pointsSame(R,V);if(K&&G)return P;var Y=!K&&m.pointBetween(z,q,V),$=!G&&m.pointBetween(R,q,V);if(K)return $?r(P,R):r(I,V),P;Y&&(G||($?r(P,R):r(I,V)),r(P,z))}else 0===W.alongA&&(-1===W.alongB?r(I,q):0===W.alongB?r(I,W.pt):1===W.alongB&&r(I,V)),0===W.alongB&&(-1===W.alongA?r(P,z):0===W.alongA?r(P,W.pt):1===W.alongA&&r(P,R));return!1}for(var h=[];!n.isEmpty();){var p=n.getHead();if(x&&x.vert(p.pt[0]),p.isStart){let I=function(){if(b){var P=c(p,b);if(P)return P}return!!l&&c(p,l)};x&&x.segmentNew(p.seg,p.primary);var o=f(p),b=o.before?o.before.ev:null,l=o.after?o.after.ev:null;x&&x.tempStatus(p.seg,!!b&&b.seg,!!l&&l.seg);var T,w,_=I();if(_&&(v?(w=null===p.seg.myFill.below||p.seg.myFill.above!==p.seg.myFill.below)&&(_.seg.myFill.above=!_.seg.myFill.above):_.seg.otherFill=p.seg.myFill,x&&x.segmentUpdate(_.seg),p.other.remove(),p.remove()),n.getHead()!==p){x&&x.rewind(p.seg);continue}v?(w=null===p.seg.myFill.below||p.seg.myFill.above!==p.seg.myFill.below,p.seg.myFill.below=l?l.seg.myFill.above:s,p.seg.myFill.above=w?!p.seg.myFill.below:p.seg.myFill.below):null===p.seg.otherFill&&(p.seg.otherFill={above:T=l?p.primary===l.primary?l.seg.otherFill.above:l.seg.myFill.above:p.primary?i:s,below:T}),x&&x.status(p.seg,!!b&&b.seg,!!l&&l.seg),p.other.status=o.insert(g.node({ev:p}))}else{var k=p.status;if(null===k)throw new Error("PolyBool: Zero-length segment detected; your epsilon is probably too small or too large");if(u.exists(k.prev)&&u.exists(k.next)&&c(k.prev.ev,k.next.ev),x&&x.statusRemove(k.ev.seg),k.remove(),!p.primary){var L=p.seg.myFill;p.seg.myFill=p.seg.otherFill,p.seg.otherFill=L}h.push(p.seg)}n.getHead().remove()}return x&&x.done(),h}return v?{addRegion:function(s){for(var i,u,f,c=s[s.length-1],h=0;h<s.length;h++){var p=m.pointsCompare(i=c,c=s[h]);0!==p&&a((u=p<0?i:c,f=p<0?c:i,{id:x?x.segmentId():-1,start:u,end:f,myFill:{above:null,below:null},otherFill:null}),!0)}},calculate:function(s){return d(s,!1)}}:{calculate:function(s,i,u,f){return s.forEach(function(c){a(e(c.start,c.end,c),!0)}),u.forEach(function(c){a(e(c.start,c.end,c),!1)}),d(i,f)}}}},{"./linked-list":260}],260:[function(y,ee,Q){ee.exports={create:function(){var g={root:{root:!0,next:null},exists:function(v){return null!==v&&v!==g.root},isEmpty:function(){return null===g.root.next},getHead:function(){return g.root.next},insertBefore:function(v,m){for(var x=g.root,e=g.root.next;null!==e;){if(m(e))return v.prev=e.prev,v.next=e,e.prev.next=v,void(e.prev=v);x=e,e=e.next}x.next=v,v.prev=x,v.next=null},findTransition:function(v){for(var m=g.root,x=g.root.next;null!==x&&!v(x);)m=x,x=x.next;return{before:m===g.root?null:m,after:x,insert:function(e){return e.prev=m,e.next=x,m.next=e,null!==x&&(x.prev=e),e}}}};return g},node:function(g){return g.prev=null,g.next=null,g.remove=function(){g.prev.next=g.next,g.next&&(g.next.prev=g.prev),g.prev=null,g.next=null},g}}},{}],261:[function(y,ee,Q){ee.exports=function(g,v,m){var x=[],e=[];return g.forEach(function(n){var t=n.start,a=n.end;if(v.pointsSame(t,a))console.warn("PolyBool: Warning: Zero-length segment detected; your epsilon is probably too small or too large");else{m&&m.chainStart(n);for(var r={index:0,matches_head:!1,matches_pt1:!1},d={index:0,matches_head:!1,matches_pt1:!1},s=r,i=0;i<x.length;i++){var u=(o=x[i])[0],f=o[o.length-1];if(v.pointsSame(u,t)){if(M(i,!0,!0))break}else if(v.pointsSame(u,a)){if(M(i,!0,!1))break}else if(v.pointsSame(f,t)){if(M(i,!1,!0))break}else if(v.pointsSame(f,a)&&M(i,!1,!1))break}if(s===r)return x.push([t,a]),void(m&&m.chainNew(t,a));if(s===d){m&&m.chainMatch(r.index);var c=r.index,h=r.matches_pt1?a:t,p=r.matches_head,o=x[c],b=p?o[0]:o[o.length-1],l=p?o[1]:o[o.length-2],T=p?o[o.length-1]:o[0],_=p?o[o.length-2]:o[1];return v.pointsCollinear(l,b,h)&&(p?(m&&m.chainRemoveHead(r.index,h),o.shift()):(m&&m.chainRemoveTail(r.index,h),o.pop()),b=l),v.pointsSame(T,h)?(x.splice(c,1),v.pointsCollinear(_,T,b)&&(p?(m&&m.chainRemoveTail(r.index,b),o.pop()):(m&&m.chainRemoveHead(r.index,b),o.shift())),m&&m.chainClose(r.index),void e.push(o)):void(p?(m&&m.chainAddHead(r.index,h),o.unshift(h)):(m&&m.chainAddTail(r.index,h),o.push(h)))}var w=r.index,k=d.index;m&&m.chainConnect(w,k);var L=x[w].length<x[k].length;r.matches_head?d.matches_head?L?(I(w),P(w,k)):(I(k),P(k,w)):P(k,w):d.matches_head?P(w,k):L?(I(w),P(k,w)):(I(k),P(w,k))}function M(S,E,z){return s.index=S,s.matches_head=E,s.matches_pt1=z,s===r?(s=d,!1):(s=null,!0)}function I(S){m&&m.chainReverse(S),x[S].reverse()}function P(S,E){var z=x[S],R=x[E],q=z[z.length-1],V=z[z.length-2],W=R[0],K=R[1];v.pointsCollinear(V,q,W)&&(m&&m.chainRemoveTail(S,q),z.pop(),q=V),v.pointsCollinear(q,W,K)&&(m&&m.chainRemoveHead(E,W),R.shift()),m&&m.chainJoin(S,E),x[S]=z.concat(R),x.splice(E,1)}}),e}},{}],262:[function(y,ee,Q){function g(m,x,e){var n=[];return m.forEach(function(t){var a=(t.myFill.above?8:0)+(t.myFill.below?4:0)+(t.otherFill&&t.otherFill.above?2:0)+(t.otherFill&&t.otherFill.below?1:0);0!==x[a]&&n.push({id:e?e.segmentId():-1,start:t.start,end:t.end,myFill:{above:1===x[a],below:2===x[a]},otherFill:null})}),e&&e.selected(n),n}ee.exports={union:function(m,x){return g(m,[0,2,1,0,2,2,0,0,1,0,1,0,0,0,0,0],x)},intersect:function(m,x){return g(m,[0,0,0,0,0,2,0,2,0,0,1,1,0,2,1,0],x)},difference:function(m,x){return g(m,[0,0,0,0,2,0,2,0,1,1,0,0,0,1,2,0],x)},differenceRev:function(m,x){return g(m,[0,2,1,0,0,0,1,1,0,2,0,2,0,0,0,0],x)},xor:function(m,x){return g(m,[0,2,1,0,2,0,0,1,1,0,0,2,0,1,2,0],x)}}},{}],263:[function(y,ee,Q){"use strict";var g=y("stream").Transform,v=y("stream-parser");function m(){g.call(this,{readableObjectMode:!0})}function x(e,n,t){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=(new Error).stack||"",this.name=this.constructor.name,this.message=e,n&&(this.code=n),t&&(this.statusCode=t)}(m.prototype=Object.create(g.prototype)).constructor=m,v(m.prototype),Q.ParserStream=m,Q.sliceEq=function(e,n,t){for(var a=n,r=0;r<t.length;)if(e[a++]!==t[r++])return!1;return!0},Q.str2arr=function(e,n){var t=[],a=0;if(n&&"hex"===n)for(;a<e.length;)t.push(parseInt(e.slice(a,a+2),16)),a+=2;else for(;a<e.length;a++)t.push(255&e.charCodeAt(a));return t},Q.readUInt16LE=function(e,n){return e[n]|e[n+1]<<8},Q.readUInt16BE=function(e,n){return e[n+1]|e[n]<<8},Q.readUInt32LE=function(e,n){return e[n]|e[n+1]<<8|e[n+2]<<16|16777216*e[n+3]},Q.readUInt32BE=function(e,n){return e[n+3]|e[n+2]<<8|e[n+1]<<16|16777216*e[n]},(x.prototype=Object.create(Error.prototype)).constructor=x,Q.ProbeError=x},{stream:286,"stream-parser":302}],264:[function(y,ee,Q){"use strict";function g(x,e){var n=new Error(x);return n.code=e,n}function v(x){try{return decodeURIComponent(escape(x))}catch{return x}}function m(x,e,n){this.input=x.subarray(e,n),this.start=e;var t=String.fromCharCode.apply(null,this.input.subarray(0,4));if("II*\0"!==t&&"MM\0*"!==t)throw g("invalid TIFF signature","EBADDATA");this.big_endian="M"===t[0]}m.prototype.each=function(x){this.aborted=!1;var e=this.read_uint32(4);for(this.ifds_to_read=[{id:0,offset:e}];this.ifds_to_read.length>0&&!this.aborted;){var n=this.ifds_to_read.shift();n.offset&&this.scan_ifd(n.id,n.offset,x)}},m.prototype.read_uint16=function(x){var e=this.input;if(x+2>e.length)throw g("unexpected EOF","EBADDATA");return this.big_endian?256*e[x]+e[x+1]:e[x]+256*e[x+1]},m.prototype.read_uint32=function(x){var e=this.input;if(x+4>e.length)throw g("unexpected EOF","EBADDATA");return this.big_endian?16777216*e[x]+65536*e[x+1]+256*e[x+2]+e[x+3]:e[x]+256*e[x+1]+65536*e[x+2]+16777216*e[x+3]},m.prototype.is_subifd_link=function(x,e){return 0===x&&34665===e||0===x&&34853===e||34665===x&&40965===e},m.prototype.exif_format_length=function(x){switch(x){case 1:case 2:case 6:case 7:return 1;case 3:case 8:return 2;case 4:case 9:case 11:return 4;case 5:case 10:case 12:return 8;default:return 0}},m.prototype.exif_format_read=function(x,e){var n;switch(x){case 1:case 2:return this.input[e];case 6:return(n=this.input[e])|33554430*(128&n);case 3:return this.read_uint16(e);case 8:return(n=this.read_uint16(e))|131070*(32768&n);case 4:return this.read_uint32(e);case 9:return 0|this.read_uint32(e);default:return null}},m.prototype.scan_ifd=function(x,e,n){var t=this.read_uint16(e);e+=2;for(var a=0;a<t;a++){var r=this.read_uint16(e),d=this.read_uint16(e+2),s=this.read_uint32(e+4),i=this.exif_format_length(d),u=s*i,f=u<=4?e+8:this.read_uint32(e+8),c=!1;if(f+u>this.input.length)throw g("unexpected EOF","EBADDATA");for(var h=[],p=f,o=0;o<s;o++,p+=i){var b=this.exif_format_read(d,p);if(null===b){h=null;break}h.push(b)}if(Array.isArray(h)&&2===d&&(h=v(String.fromCharCode.apply(null,h)))&&"\0"===h[h.length-1]&&(h=h.slice(0,-1)),this.is_subifd_link(x,r)&&Array.isArray(h)&&Number.isInteger(h[0])&&h[0]>0&&(this.ifds_to_read.push({id:r,offset:h[0]}),c=!0),!1===n({is_big_endian:this.big_endian,ifd:x,tag:r,format:d,count:s,entry_offset:e+this.start,data_length:u,data_offset:f+this.start,value:h,is_subifd_link:c}))return void(this.aborted=!0);e+=12}0===x&&this.ifds_to_read.push({id:1,offset:this.read_uint32(e)})},ee.exports.ExifParser=m,ee.exports.get_orientation=function(x){var e=0;try{return new m(x,0,x.length).each(function(n){if(0===n.ifd&&274===n.tag&&Array.isArray(n.value))return e=n.value[0],!1}),e}catch{return-1}}},{}],265:[function(y,ee,Q){"use strict";var g=y("./common").readUInt16BE,v=y("./common").readUInt32BE;function m(r,d){if(r.length<4+d)return null;var s=v(r,d);return r.length<s+d||s<8?null:{boxtype:String.fromCharCode.apply(null,r.slice(d+4,d+8)),data:r.slice(d+8,d+s),end:d+s}}function x(r,d){for(var s=0;;){var i=m(r,s);if(!i)break;switch(i.boxtype){case"ispe":d.sizes.push({width:v(i.data,4),height:v(i.data,8)});break;case"irot":d.transforms.push({type:"irot",value:3&i.data[0]});break;case"imir":d.transforms.push({type:"imir",value:1&i.data[0]})}s=i.end}}function e(r,d,s){for(var i=0,u=0;u<s;u++)i=256*i+(r[d+u]||0);return i}function n(r,d){for(var s=r[4]>>4&15,i=15&r[4],u=r[5]>>4&15,f=g(r,6),c=8,h=0;h<f;h++){var p=g(r,c),o=g(r,c+=2),b=e(r,c+=2,u),l=g(r,c+=u);if(c+=2,0===o&&1===l){var T=e(r,c,s),_=e(r,c+s,i);d.item_loc[p]={length:_,offset:T+b}}c+=l*(s+i)}}function t(r,d){for(var s=g(r,4),i=6,u=0;u<s;u++){var f=m(r,i);if(!f)break;if("infe"===f.boxtype){for(var c=g(f.data,4),h="",p=8;p<f.data.length&&f.data[p];p++)h+=String.fromCharCode(f.data[p]);d.item_inf[h]=c}i=f.end}}function a(r,d){for(var s=0;;){var i=m(r,s);if(!i)break;"ipco"===i.boxtype&&x(i.data,d),s=i.end}}ee.exports.unbox=m,ee.exports.readSizeFromMeta=function(r){var d={sizes:[],transforms:[],item_inf:{},item_loc:{}};if(function(p,o){for(var b=4;;){var l=m(p,b);if(!l)break;"iprp"===l.boxtype&&a(l.data,o),"iloc"===l.boxtype&&n(l.data,o),"iinf"===l.boxtype&&t(l.data,o),b=l.end}}(r,d),d.sizes.length){var s,i,u,f=(i=(s=d.sizes).reduce(function(p,o){return p.width>o.width||p.width===o.width&&p.height>o.height?p:o}),u=s.reduce(function(p,o){return p.height>o.height||p.height===o.height&&p.width>o.width?p:o}),i.width>u.height||i.width===u.height&&i.height>u.width?i:u),c=1;d.transforms.forEach(function(p){var o={1:6,2:5,3:8,4:7,5:4,6:3,7:2,8:1},b={1:4,2:3,3:2,4:1,5:6,6:5,7:8,8:7};if("imir"===p.type&&(c=0===p.value?b[c]:o[c=o[c=b[c]]]),"irot"===p.type)for(var l=0;l<p.value;l++)c=o[c]});var h=null;return d.item_inf.Exif&&(h=d.item_loc[d.item_inf.Exif]),{width:f.width,height:f.height,orientation:d.transforms.length?c:null,variants:d.sizes,exif_location:h}}},ee.exports.getMimeType=function(r){var d=String.fromCharCode.apply(null,r.slice(0,4)),s={};s[d]=!0;for(var i=8;i<r.length;i+=4)s[String.fromCharCode.apply(null,r.slice(i,i+4))]=!0;if(s.mif1||s.msf1||s.miaf)return"avif"===d||"avis"===d||"avio"===d?{type:"avif",mime:"image/avif"}:"heic"===d||"heix"===d?{type:"heic",mime:"image/heic"}:"hevc"===d||"hevx"===d?{type:"heic",mime:"image/heic-sequence"}:s.avif||s.avis?{type:"avif",mime:"image/avif"}:s.heic||s.heix||s.hevc||s.hevx||s.heis?s.msf1?{type:"heif",mime:"image/heif-sequence"}:{type:"heif",mime:"image/heif"}:{type:"avif",mime:"image/avif"}}},{"./common":263}],266:[function(y,ee,Q){"use strict";var g=y("../common").str2arr,v=y("../common").sliceEq,m=y("../common").readUInt32BE,x=y("../miaf_utils"),e=y("../exif_utils"),n=g("ftyp");ee.exports=function(t){if(v(t,4,n)){var a=x.unbox(t,0);if(a){var r=x.getMimeType(a.data);if(r){for(var d,s=a.end;;){var i=x.unbox(t,s);if(!i)break;if(s=i.end,"mdat"===i.boxtype)return;if("meta"===i.boxtype){d=i.data;break}}if(d){var u=x.readSizeFromMeta(d);if(u){var f={width:u.width,height:u.height,type:r.type,mime:r.mime,wUnits:"px",hUnits:"px"};if(u.variants.length>1&&(f.variants=u.variants),u.orientation&&(f.orientation=u.orientation),u.exif_location&&u.exif_location.offset+u.exif_location.length<=t.length){var c=m(t,u.exif_location.offset),h=t.slice(u.exif_location.offset+c+4,u.exif_location.offset+u.exif_location.length),p=e.get_orientation(h);p>0&&(f.orientation=p)}return f}}}}}}},{"../common":263,"../exif_utils":264,"../miaf_utils":265}],267:[function(y,ee,Q){"use strict";var g=y("../common").str2arr,v=y("../common").sliceEq,m=y("../common").readUInt16LE,x=g("BM");ee.exports=function(e){if(!(e.length<26)&&v(e,0,x))return{width:m(e,18),height:m(e,22),type:"bmp",mime:"image/bmp",wUnits:"px",hUnits:"px"}}},{"../common":263}],268:[function(y,ee,Q){"use strict";var g=y("../common").str2arr,v=y("../common").sliceEq,m=y("../common").readUInt16LE,x=g("GIF87a"),e=g("GIF89a");ee.exports=function(n){if(!(n.length<10)&&(v(n,0,x)||v(n,0,e)))return{width:m(n,6),height:m(n,8),type:"gif",mime:"image/gif",wUnits:"px",hUnits:"px"}}},{"../common":263}],269:[function(y,ee,Q){"use strict";var g=y("../common").readUInt16LE;ee.exports=function(v){var m=g(v,0),x=g(v,2),e=g(v,4);if(0===m&&1===x&&e){for(var n=[],t={width:0,height:0},a=0;a<e;a++){var r=v[6+16*a]||256,d=v[6+16*a+1]||256,s={width:r,height:d};n.push(s),(r>t.width||d>t.height)&&(t=s)}return{width:t.width,height:t.height,variants:n,type:"ico",mime:"image/x-icon",wUnits:"px",hUnits:"px"}}}},{"../common":263}],270:[function(y,ee,Q){"use strict";var g=y("../common").readUInt16BE,v=y("../common").str2arr,m=y("../common").sliceEq,x=y("../exif_utils"),e=v("Exif\0\0");ee.exports=function(n){if(!(n.length<2)&&255===n[0]&&216===n[1]&&255===n[2])for(var t=2;;){for(;;){if(n.length-t<2)return;if(255===n[t++])break}for(var a,r,d=n[t++];255===d;)d=n[t++];if(208<=d&&d<=217||1===d)a=0;else{if(!(192<=d&&d<=254)||n.length-t<2)return;a=g(n,t)-2,t+=2}if(217===d||218===d)return;if(225===d&&a>=10&&m(n,t,e)&&(r=x.get_orientation(n.slice(t+6,t+a))),a>=5&&192<=d&&d<=207&&196!==d&&200!==d&&204!==d){if(n.length-t<a)return;var s={width:g(n,t+3),height:g(n,t+1),type:"jpg",mime:"image/jpeg",wUnits:"px",hUnits:"px"};return r>0&&(s.orientation=r),s}t+=a}}},{"../common":263,"../exif_utils":264}],271:[function(y,ee,Q){"use strict";var g=y("../common").str2arr,v=y("../common").sliceEq,m=y("../common").readUInt32BE,x=g("\x89PNG\r\n\x1a\n"),e=g("IHDR");ee.exports=function(n){if(!(n.length<24)&&v(n,0,x)&&v(n,12,e))return{width:m(n,16),height:m(n,20),type:"png",mime:"image/png",wUnits:"px",hUnits:"px"}}},{"../common":263}],272:[function(y,ee,Q){"use strict";var g=y("../common").str2arr,v=y("../common").sliceEq,m=y("../common").readUInt32BE,x=g("8BPS\0\x01");ee.exports=function(e){if(!(e.length<22)&&v(e,0,x))return{width:m(e,18),height:m(e,14),type:"psd",mime:"image/vnd.adobe.photoshop",wUnits:"px",hUnits:"px"}}},{"../common":263}],273:[function(y,ee,Q){"use strict";function g(r){return"number"==typeof r&&isFinite(r)&&r>0}var v=/<[-_.:a-zA-Z0-9][^>]*>/,m=/^<([-_.:a-zA-Z0-9]+:)?svg\s/,x=/[^-]\bwidth="([^%]+?)"|[^-]\bwidth='([^%]+?)'/,e=/\bheight="([^%]+?)"|\bheight='([^%]+?)'/,n=/\bview[bB]ox="(.+?)"|\bview[bB]ox='(.+?)'/,t=/in$|mm$|cm$|pt$|pc$|px$|em$|ex$/;function a(r){return t.test(r)?r.match(t)[0]:"px"}ee.exports=function(r){if(function(T){var _,w=0,k=T.length;for(239===T[0]&&187===T[1]&&191===T[2]&&(w=3);w<k&&(32===(_=T[w])||9===_||13===_||10===_);)w++;return w!==k&&60===T[w]}(r)){for(var d="",s=0;s<r.length;s++)d+=String.fromCharCode(r[s]);var i=(d.match(v)||[""])[0];if(m.test(i)){var u=(_=(T=i).match(x),w=T.match(e),k=T.match(n),{width:_&&(_[1]||_[2]),height:w&&(w[1]||w[2]),viewbox:k&&(k[1]||k[2])}),f=parseFloat(u.width),c=parseFloat(u.height);if(u.width&&u.height)return g(f)&&g(c)?{width:f,height:c,type:"svg",mime:"image/svg+xml",wUnits:a(u.width),hUnits:a(u.height)}:void 0;var h=(u.viewbox||"").split(" "),p={width:h[2],height:h[3]},o=parseFloat(p.width),b=parseFloat(p.height);if(g(o)&&g(b)&&a(p.width)===a(p.height)){var l=o/b;return u.width?g(f)?{width:f,height:f/l,type:"svg",mime:"image/svg+xml",wUnits:a(u.width),hUnits:a(u.width)}:void 0:u.height?g(c)?{width:c*l,height:c,type:"svg",mime:"image/svg+xml",wUnits:a(u.height),hUnits:a(u.height)}:void 0:{width:o,height:b,type:"svg",mime:"image/svg+xml",wUnits:a(p.width),hUnits:a(p.height)}}}}var T,_,w,k}},{}],274:[function(y,ee,Q){"use strict";var g=y("../common").str2arr,v=y("../common").sliceEq,m=y("../common").readUInt16LE,x=y("../common").readUInt16BE,e=y("../common").readUInt32LE,n=y("../common").readUInt32BE,t=g("II*\0"),a=g("MM\0*");function r(i,u,f){return f?x(i,u):m(i,u)}function d(i,u,f){return f?n(i,u):e(i,u)}function s(i,u,f){var c=r(i,u+2,f);return 1!==d(i,u+4,f)||3!==c&&4!==c?null:3===c?r(i,u+8,f):d(i,u+8,f)}ee.exports=function(i){if(!(i.length<8)&&(v(i,0,t)||v(i,0,a))){var u=77===i[0],f=d(i,4,u)-8;if(!(f<0)){var c=f+8;if(!(i.length-c<2)){var h=12*r(i,c+0,u);if(!(h<=0||(c+=2,i.length-c<h))){var p,o,b,l;for(p=0;p<h;p+=12)256===(l=r(i,c+p,u))?o=s(i,c+p,u):257===l&&(b=s(i,c+p,u));return o&&b?{width:o,height:b,type:"tiff",mime:"image/tiff",wUnits:"px",hUnits:"px"}:void 0}}}}}},{"../common":263}],275:[function(y,ee,Q){"use strict";var g=y("../common").str2arr,v=y("../common").sliceEq,m=y("../common").readUInt16LE,x=y("../common").readUInt32LE,e=y("../exif_utils"),n=g("RIFF"),t=g("WEBP");function a(s,i){if(157===s[i+3]&&1===s[i+4]&&42===s[i+5])return{width:16383&m(s,i+6),height:16383&m(s,i+8),type:"webp",mime:"image/webp",wUnits:"px",hUnits:"px"}}function r(s,i){if(47===s[i]){var u=x(s,i+1);return{width:1+(16383&u),height:1+(u>>14&16383),type:"webp",mime:"image/webp",wUnits:"px",hUnits:"px"}}}function d(s,i){return{width:1+(s[i+6]<<16|s[i+5]<<8|s[i+4]),height:1+(s[i+9]<<i|s[i+8]<<8|s[i+7]),type:"webp",mime:"image/webp",wUnits:"px",hUnits:"px"}}ee.exports=function(s){if(!(s.length<16)&&(v(s,0,n)||v(s,8,t))){var i=12,u=null,f=0,c=x(s,4)+8;if(!(c>s.length)){for(;i+8<c;)if(0!==s[i]){var h=String.fromCharCode.apply(null,s.slice(i,i+4)),p=x(s,i+4);"VP8 "===h&&p>=10?u=u||a(s,i+8):"VP8L"===h&&p>=9?u=u||r(s,i+8):"VP8X"===h&&p>=10?u=u||d(s,i+8):"EXIF"===h&&(f=e.get_orientation(s.slice(i+8,i+8+p)),i=1/0),i+=8+p}else i++;if(u)return f>0&&(u.orientation=f),u}}}},{"../common":263,"../exif_utils":264}],276:[function(y,ee,Q){"use strict";ee.exports={avif:y("./parse_sync/avif"),bmp:y("./parse_sync/bmp"),gif:y("./parse_sync/gif"),ico:y("./parse_sync/ico"),jpeg:y("./parse_sync/jpeg"),png:y("./parse_sync/png"),psd:y("./parse_sync/psd"),svg:y("./parse_sync/svg"),tiff:y("./parse_sync/tiff"),webp:y("./parse_sync/webp")}},{"./parse_sync/avif":266,"./parse_sync/bmp":267,"./parse_sync/gif":268,"./parse_sync/ico":269,"./parse_sync/jpeg":270,"./parse_sync/png":271,"./parse_sync/psd":272,"./parse_sync/svg":273,"./parse_sync/tiff":274,"./parse_sync/webp":275}],277:[function(y,ee,Q){"use strict";var g=y("./lib/parsers_sync");ee.exports=function(v){return function(m){for(var x=Object.keys(g),e=0;e<x.length;e++){var n=g[x[e]](m);if(n)return n}return null}(v)},ee.exports.parsers=g},{"./lib/parsers_sync":276}],278:[function(y,ee,Q){var g,v,m=ee.exports={};function x(){throw new Error("setTimeout has not been defined")}function e(){throw new Error("clearTimeout has not been defined")}function n(c){if(g===setTimeout)return setTimeout(c,0);if((g===x||!g)&&setTimeout)return g=setTimeout,setTimeout(c,0);try{return g(c,0)}catch{try{return g.call(null,c,0)}catch{return g.call(this,c,0)}}}!function(){try{g="function"==typeof setTimeout?setTimeout:x}catch{g=x}try{v="function"==typeof clearTimeout?clearTimeout:e}catch{v=e}}();var t,a=[],r=!1,d=-1;function s(){r&&t&&(r=!1,t.length?a=t.concat(a):d=-1,a.length&&i())}function i(){if(!r){var c=n(s);r=!0;for(var h=a.length;h;){for(t=a,a=[];++d<h;)t&&t[d].run();d=-1,h=a.length}t=null,r=!1,function(p){if(v===clearTimeout)return clearTimeout(p);if((v===e||!v)&&clearTimeout)return v=clearTimeout,clearTimeout(p);try{v(p)}catch{try{return v.call(null,p)}catch{return v.call(this,p)}}}(c)}}function u(c,h){this.fun=c,this.array=h}function f(){}m.nextTick=function(c){var h=new Array(arguments.length-1);if(arguments.length>1)for(var p=1;p<arguments.length;p++)h[p-1]=arguments[p];a.push(new u(c,h)),1!==a.length||r||n(i)},u.prototype.run=function(){this.fun.apply(null,this.array)},m.title="browser",m.browser=!0,m.env={},m.argv=[],m.version="",m.versions={},m.on=f,m.addListener=f,m.once=f,m.off=f,m.removeListener=f,m.removeAllListeners=f,m.emit=f,m.prependListener=f,m.prependOnceListener=f,m.listeners=function(c){return[]},m.binding=function(c){throw new Error("process.binding is not supported")},m.cwd=function(){return"/"},m.chdir=function(c){throw new Error("process.chdir is not supported")},m.umask=function(){return 0}},{}],279:[function(y,ee,Q){(function(g){(function(){for(var v=y("performance-now"),m=typeof window>"u"?g:window,x=["moz","webkit"],e="AnimationFrame",n=m["request"+e],t=m["cancel"+e]||m["cancelRequest"+e],a=0;!n&&a<x.length;a++)n=m[x[a]+"Request"+e],t=m[x[a]+"Cancel"+e]||m[x[a]+"CancelRequest"+e];if(!n||!t){var r=0,d=0,s=[];n=function(i){if(0===s.length){var u=v(),f=Math.max(0,1e3/60-(u-r));r=f+u,setTimeout(function(){var c=s.slice(0);s.length=0;for(var h=0;h<c.length;h++)if(!c[h].cancelled)try{c[h].callback(r)}catch(p){setTimeout(function(){throw p},0)}},Math.round(f))}return s.push({handle:++d,callback:i,cancelled:!1}),d},t=function(i){for(var u=0;u<s.length;u++)s[u].handle===i&&(s[u].cancelled=!0)}}ee.exports=function(i){return n.call(m,i)},ee.exports.cancel=function(){t.apply(m,arguments)},ee.exports.polyfill=function(i){i||(i=m),i.requestAnimationFrame=n,i.cancelAnimationFrame=t}}).call(this)}).call(this,typeof global<"u"?global:typeof self<"u"?self:typeof window<"u"?window:{})},{"performance-now":252}],280:[function(y,ee,Q){"use strict";var g=y("array-bounds"),v=y("color-normalize"),m=y("update-diff"),x=y("pick-by-alias"),e=y("object-assign"),n=y("flatten-vertex-data"),t=y("to-float32"),a=t.float32,r=t.fract32;ee.exports=function(s,i){if("function"==typeof s?(i||(i={}),i.regl=s):i=s,i.length&&(i.positions=i),!(s=i.regl).hasExtension("ANGLE_instanced_arrays"))throw Error("regl-error2d: `ANGLE_instanced_arrays` extension should be enabled");var u,f,c,h,p,o,b=s._gl,l={color:"black",capSize:5,lineWidth:1,opacity:1,viewport:null,range:null,offset:0,count:0,bounds:null,positions:[],errors:[]},T=[];return h=s.buffer({usage:"dynamic",type:"uint8",data:new Uint8Array(0)}),f=s.buffer({usage:"dynamic",type:"float",data:new Uint8Array(0)}),c=s.buffer({usage:"dynamic",type:"float",data:new Uint8Array(0)}),p=s.buffer({usage:"dynamic",type:"float",data:new Uint8Array(0)}),o=s.buffer({usage:"static",type:"float",data:d}),L(i),u=s({vert:"\n\t\tprecision highp float;\n\n\t\tattribute vec2 position, positionFract;\n\t\tattribute vec4 error;\n\t\tattribute vec4 color;\n\n\t\tattribute vec2 direction, lineOffset, capOffset;\n\n\t\tuniform vec4 viewport;\n\t\tuniform float lineWidth, capSize;\n\t\tuniform vec2 scale, scaleFract, translate, translateFract;\n\n\t\tvarying vec4 fragColor;\n\n\t\tvoid main() {\n\t\t\tfragColor = color / 255.;\n\n\t\t\tvec2 pixelOffset = lineWidth * lineOffset + (capSize + lineWidth) * capOffset;\n\n\t\t\tvec2 dxy = -step(.5, direction.xy) * error.xz + step(direction.xy, vec2(-.5)) * error.yw;\n\n\t\t\tvec2 position = position + dxy;\n\n\t\t\tvec2 pos = (position + translate) * scale\n\t\t\t\t+ (positionFract + translateFract) * scale\n\t\t\t\t+ (position + translate) * scaleFract\n\t\t\t\t+ (positionFract + translateFract) * scaleFract;\n\n\t\t\tpos += pixelOffset / viewport.zw;\n\n\t\t\tgl_Position = vec4(pos * 2. - 1., 0, 1);\n\t\t}\n\t\t",frag:"\n\t\tprecision highp float;\n\n\t\tvarying vec4 fragColor;\n\n\t\tuniform float opacity;\n\n\t\tvoid main() {\n\t\t\tgl_FragColor = fragColor;\n\t\t\tgl_FragColor.a *= opacity;\n\t\t}\n\t\t",uniforms:{range:s.prop("range"),lineWidth:s.prop("lineWidth"),capSize:s.prop("capSize"),opacity:s.prop("opacity"),scale:s.prop("scale"),translate:s.prop("translate"),scaleFract:s.prop("scaleFract"),translateFract:s.prop("translateFract"),viewport:function(I,P){return[P.viewport.x,P.viewport.y,I.viewportWidth,I.viewportHeight]}},attributes:{color:{buffer:h,offset:function(I,P){return 4*P.offset},divisor:1},position:{buffer:f,offset:function(I,P){return 8*P.offset},divisor:1},positionFract:{buffer:c,offset:function(I,P){return 8*P.offset},divisor:1},error:{buffer:p,offset:function(I,P){return 16*P.offset},divisor:1},direction:{buffer:o,stride:24,offset:0},lineOffset:{buffer:o,stride:24,offset:8},capOffset:{buffer:o,stride:24,offset:16}},primitive:"triangles",blend:{enable:!0,color:[0,0,0,0],equation:{rgb:"add",alpha:"add"},func:{srcRGB:"src alpha",dstRGB:"one minus src alpha",srcAlpha:"one minus dst alpha",dstAlpha:"one"}},depth:{enable:!1},scissor:{enable:!0,box:s.prop("viewport")},viewport:s.prop("viewport"),stencil:!1,instances:s.prop("count"),count:d.length}),e(_,{update:L,draw:w,destroy:M,regl:s,gl:b,canvas:b.canvas,groups:T}),_;function _(I){I?L(I):null===I&&M(),w()}function w(I){if("number"==typeof I)return k(I);I&&!Array.isArray(I)&&(I=[I]),s._refresh(),T.forEach(function(P,S){P&&(I&&(P.draw=!!I[S]),P.draw?k(S):P.draw=!0)})}function k(I){"number"==typeof I&&(I=T[I]),null!=I&&I&&I.count&&I.color&&I.opacity&&I.positions&&I.positions.length>1&&(I.scaleRatio=[I.scale[0]*I.viewport.width,I.scale[1]*I.viewport.height],u(I),I.after&&I.after(I))}function L(I){if(I){null!=I.length?"number"==typeof I[0]&&(I=[{positions:I}]):Array.isArray(I)||(I=[I]);var P=0,S=0;if(_.groups=T=I.map(function(K,G){var Y=T[G];return K&&("function"==typeof K?K={after:K}:"number"==typeof K[0]&&(K={positions:K}),K=x(K,{color:"color colors fill",capSize:"capSize cap capsize cap-size",lineWidth:"lineWidth line-width width line thickness",opacity:"opacity alpha",range:"range dataBox",viewport:"viewport viewBox",errors:"errors error",positions:"positions position data points"}),Y||(T[G]=Y={id:G,scale:null,translate:null,scaleFract:null,translateFract:null,draw:!0},K=e({},l,K)),m(Y,K,[{lineWidth:function($){return.5*+$},capSize:function($){return.5*+$},opacity:parseFloat,errors:function($){return $=n($),S+=$.length,$},positions:function($,B){return $=n($,"float64"),B.count=Math.floor($.length/2),B.bounds=g($,2),B.offset=P,P+=B.count,$}},{color:function($,B){var N=B.count;if($||($="transparent"),!Array.isArray($)||"number"==typeof $[0]){var U=$;$=Array(N);for(var te=0;te<N;te++)$[te]=U}if($.length<N)throw Error("Not enough colors");for(var j=new Uint8Array(4*N),J=0;J<N;J++){var X=v($[J],"uint8");j.set(X,4*J)}return j},range:function($,B,N){return $||($=B.bounds),B.scale=[1/($[2]-$[0]),1/($[3]-$[1])],B.translate=[-$[0],-$[1]],B.scaleFract=r(B.scale),B.translateFract=r(B.translate),$},viewport:function($){var B;return Array.isArray($)?B={x:$[0],y:$[1],width:$[2]-$[0],height:$[3]-$[1]}:$?((B={x:$.x||$.left||0,y:$.y||$.top||0}).width=$.right?$.right-B.x:$.w||$.width||0,B.height=$.bottom?$.bottom-B.y:$.h||$.height||0):B={x:0,y:0,width:b.drawingBufferWidth,height:b.drawingBufferHeight},B}}])),Y}),P||S){var E=T.reduce(function(K,G,Y){return K+(G?G.count:0)},0),z=new Float64Array(2*E),R=new Uint8Array(4*E),q=new Float32Array(4*E);T.forEach(function(K,G){if(K){var Y=K.positions,B=K.offset,U=K.errors;K.count&&(R.set(K.color,4*B),q.set(U,4*B),z.set(Y,2*B))}});var V=a(z);f(V);var W=r(z,V);c(W),h(R),p(q)}}}function M(){f.destroy(),c.destroy(),h.destroy(),p.destroy(),o.destroy()}};var d=[[1,0,0,1,0,0],[1,0,0,-1,0,0],[-1,0,0,-1,0,0],[-1,0,0,-1,0,0],[-1,0,0,1,0,0],[1,0,0,1,0,0],[1,0,-1,0,0,1],[1,0,-1,0,0,-1],[1,0,1,0,0,-1],[1,0,1,0,0,-1],[1,0,1,0,0,1],[1,0,-1,0,0,1],[-1,0,-1,0,0,1],[-1,0,-1,0,0,-1],[-1,0,1,0,0,-1],[-1,0,1,0,0,-1],[-1,0,1,0,0,1],[-1,0,-1,0,0,1],[0,1,1,0,0,0],[0,1,-1,0,0,0],[0,-1,-1,0,0,0],[0,-1,-1,0,0,0],[0,1,1,0,0,0],[0,-1,1,0,0,0],[0,1,0,-1,1,0],[0,1,0,-1,-1,0],[0,1,0,1,-1,0],[0,1,0,1,1,0],[0,1,0,-1,1,0],[0,1,0,1,-1,0],[0,-1,0,-1,1,0],[0,-1,0,-1,-1,0],[0,-1,0,1,-1,0],[0,-1,0,1,1,0],[0,-1,0,-1,1,0],[0,-1,0,1,-1,0]]},{"array-bounds":71,"color-normalize":89,"flatten-vertex-data":191,"object-assign":247,"pick-by-alias":253,"to-float32":314,"update-diff":330}],281:[function(y,ee,Q){"use strict";var g=y("color-normalize"),v=y("array-bounds"),m=y("object-assign"),x=y("glslify"),e=y("pick-by-alias"),n=y("flatten-vertex-data"),t=y("earcut"),a=y("array-normalize"),r=y("to-float32"),d=r.float32,s=r.fract32,i=y("es6-weak-map"),u=y("parse-rect"),f=y("array-find-index");function c(h,p){if(!(this instanceof c))return new c(h,p);if("function"==typeof h?(p||(p={}),p.regl=h):p=h,p.length&&(p.positions=p),!(h=p.regl).hasExtension("ANGLE_instanced_arrays"))throw Error("regl-error2d: `ANGLE_instanced_arrays` extension should be enabled");this.gl=h._gl,this.regl=h,this.passes=[],this.shaders=c.shaders.has(h)?c.shaders.get(h):c.shaders.set(h,c.createShaders(h)).get(h),this.update(p)}ee.exports=c,c.dashMult=2,c.maxPatternLength=256,c.precisionThreshold=3e6,c.maxPoints=1e4,c.maxLines=2048,c.shaders=new i,c.createShaders=function(h){var p,o=h.buffer({usage:"static",type:"float",data:[0,1,0,0,1,1,1,0]}),b={primitive:"triangle strip",instances:h.prop("count"),count:4,offset:0,uniforms:{miterMode:function(T,_){return"round"===_.join?2:1},miterLimit:h.prop("miterLimit"),scale:h.prop("scale"),scaleFract:h.prop("scaleFract"),translateFract:h.prop("translateFract"),translate:h.prop("translate"),thickness:h.prop("thickness"),dashTexture:h.prop("dashTexture"),opacity:h.prop("opacity"),pixelRatio:h.context("pixelRatio"),id:h.prop("id"),dashLength:h.prop("dashLength"),viewport:function(T,_){return[_.viewport.x,_.viewport.y,T.viewportWidth,T.viewportHeight]},depth:h.prop("depth")},blend:{enable:!0,color:[0,0,0,0],equation:{rgb:"add",alpha:"add"},func:{srcRGB:"src alpha",dstRGB:"one minus src alpha",srcAlpha:"one minus dst alpha",dstAlpha:"one"}},depth:{enable:function(T,_){return!_.overlay}},stencil:{enable:!1},scissor:{enable:!0,box:h.prop("viewport")},viewport:h.prop("viewport")},l=h(m({vert:x(["precision highp float;\n#define GLSLIFY 1\n\nattribute vec2 aCoord, bCoord, aCoordFract, bCoordFract;\nattribute vec4 color;\nattribute float lineEnd, lineTop;\n\nuniform vec2 scale, scaleFract, translate, translateFract;\nuniform float thickness, pixelRatio, id, depth;\nuniform vec4 viewport;\n\nvarying vec4 fragColor;\nvarying vec2 tangent;\n\nvec2 project(vec2 position, vec2 positionFract, vec2 scale, vec2 scaleFract, vec2 translate, vec2 translateFract) {\n\t// the order is important\n\treturn position * scale + translate\n       + positionFract * scale + translateFract\n       + position * scaleFract\n       + positionFract * scaleFract;\n}\n\nvoid main() {\n\tfloat lineStart = 1. - lineEnd;\n\tfloat lineOffset = lineTop * 2. - 1.;\n\n\tvec2 diff = (bCoord + bCoordFract - aCoord - aCoordFract);\n\ttangent = normalize(diff * scale * viewport.zw);\n\tvec2 normal = vec2(-tangent.y, tangent.x);\n\n\tvec2 position = project(aCoord, aCoordFract, scale, scaleFract, translate, translateFract) * lineStart\n\t\t+ project(bCoord, bCoordFract, scale, scaleFract, translate, translateFract) * lineEnd\n\n\t\t+ thickness * normal * .5 * lineOffset / viewport.zw;\n\n\tgl_Position = vec4(position * 2.0 - 1.0, depth, 1);\n\n\tfragColor = color / 255.;\n}\n"]),frag:x(["precision highp float;\n#define GLSLIFY 1\n\nuniform float dashLength, pixelRatio, thickness, opacity, id;\nuniform sampler2D dashTexture;\n\nvarying vec4 fragColor;\nvarying vec2 tangent;\n\nvoid main() {\n\tfloat alpha = 1.;\n\n\tfloat t = fract(dot(tangent, gl_FragCoord.xy) / dashLength) * .5 + .25;\n\tfloat dash = texture2D(dashTexture, vec2(t, .5)).r;\n\n\tgl_FragColor = fragColor;\n\tgl_FragColor.a *= alpha * opacity * dash;\n}\n"]),attributes:{lineEnd:{buffer:o,divisor:0,stride:8,offset:0},lineTop:{buffer:o,divisor:0,stride:8,offset:4},aCoord:{buffer:h.prop("positionBuffer"),stride:8,offset:8,divisor:1},bCoord:{buffer:h.prop("positionBuffer"),stride:8,offset:16,divisor:1},aCoordFract:{buffer:h.prop("positionFractBuffer"),stride:8,offset:8,divisor:1},bCoordFract:{buffer:h.prop("positionFractBuffer"),stride:8,offset:16,divisor:1},color:{buffer:h.prop("colorBuffer"),stride:4,offset:0,divisor:1}}},b));try{p=h(m({cull:{enable:!0,face:"back"},vert:x(["precision highp float;\n#define GLSLIFY 1\n\nattribute vec2 aCoord, bCoord, nextCoord, prevCoord;\nattribute vec4 aColor, bColor;\nattribute float lineEnd, lineTop;\n\nuniform vec2 scale, translate;\nuniform float thickness, pixelRatio, id, depth;\nuniform vec4 viewport;\nuniform float miterLimit, miterMode;\n\nvarying vec4 fragColor;\nvarying vec4 startCutoff, endCutoff;\nvarying vec2 tangent;\nvarying vec2 startCoord, endCoord;\nvarying float enableStartMiter, enableEndMiter;\n\nconst float REVERSE_THRESHOLD = -.875;\nconst float MIN_DIFF = 1e-6;\n\n// TODO: possible optimizations: avoid overcalculating all for vertices and calc just one instead\n// TODO: precalculate dot products, normalize things beforehead etc.\n// TODO: refactor to rectangular algorithm\n\nfloat distToLine(vec2 p, vec2 a, vec2 b) {\n\tvec2 diff = b - a;\n\tvec2 perp = normalize(vec2(-diff.y, diff.x));\n\treturn dot(p - a, perp);\n}\n\nbool isNaN( float val ){\n  return ( val < 0.0 || 0.0 < val || val == 0.0 ) ? false : true;\n}\n\nvoid main() {\n\tvec2 aCoord = aCoord, bCoord = bCoord, prevCoord = prevCoord, nextCoord = nextCoord;\n\n  vec2 adjustedScale;\n  adjustedScale.x = (abs(scale.x) < MIN_DIFF) ? MIN_DIFF : scale.x;\n  adjustedScale.y = (abs(scale.y) < MIN_DIFF) ? MIN_DIFF : scale.y;\n\n  vec2 scaleRatio = adjustedScale * viewport.zw;\n\tvec2 normalWidth = thickness / scaleRatio;\n\n\tfloat lineStart = 1. - lineEnd;\n\tfloat lineBot = 1. - lineTop;\n\n\tfragColor = (lineStart * aColor + lineEnd * bColor) / 255.;\n\n\tif (isNaN(aCoord.x) || isNaN(aCoord.y) || isNaN(bCoord.x) || isNaN(bCoord.y)) return;\n\n\tif (aCoord == prevCoord) prevCoord = aCoord + normalize(bCoord - aCoord);\n\tif (bCoord == nextCoord) nextCoord = bCoord - normalize(bCoord - aCoord);\n\n\tvec2 prevDiff = aCoord - prevCoord;\n\tvec2 currDiff = bCoord - aCoord;\n\tvec2 nextDiff = nextCoord - bCoord;\n\n\tvec2 prevTangent = normalize(prevDiff * scaleRatio);\n\tvec2 currTangent = normalize(currDiff * scaleRatio);\n\tvec2 nextTangent = normalize(nextDiff * scaleRatio);\n\n\tvec2 prevNormal = vec2(-prevTangent.y, prevTangent.x);\n\tvec2 currNormal = vec2(-currTangent.y, currTangent.x);\n\tvec2 nextNormal = vec2(-nextTangent.y, nextTangent.x);\n\n\tvec2 startJoinDirection = normalize(prevTangent - currTangent);\n\tvec2 endJoinDirection = normalize(currTangent - nextTangent);\n\n\t// collapsed/unidirectional segment cases\n\t// FIXME: there should be more elegant solution\n\tvec2 prevTanDiff = abs(prevTangent - currTangent);\n\tvec2 nextTanDiff = abs(nextTangent - currTangent);\n\tif (max(prevTanDiff.x, prevTanDiff.y) < MIN_DIFF) {\n\t\tstartJoinDirection = currNormal;\n\t}\n\tif (max(nextTanDiff.x, nextTanDiff.y) < MIN_DIFF) {\n\t\tendJoinDirection = currNormal;\n\t}\n\tif (aCoord == bCoord) {\n\t\tendJoinDirection = startJoinDirection;\n\t\tcurrNormal = prevNormal;\n\t\tcurrTangent = prevTangent;\n\t}\n\n\ttangent = currTangent;\n\n\t//calculate join shifts relative to normals\n\tfloat startJoinShift = dot(currNormal, startJoinDirection);\n\tfloat endJoinShift = dot(currNormal, endJoinDirection);\n\n\tfloat startMiterRatio = abs(1. / startJoinShift);\n\tfloat endMiterRatio = abs(1. / endJoinShift);\n\n\tvec2 startJoin = startJoinDirection * startMiterRatio;\n\tvec2 endJoin = endJoinDirection * endMiterRatio;\n\n\tvec2 startTopJoin, startBotJoin, endTopJoin, endBotJoin;\n\tstartTopJoin = sign(startJoinShift) * startJoin * .5;\n\tstartBotJoin = -startTopJoin;\n\n\tendTopJoin = sign(endJoinShift) * endJoin * .5;\n\tendBotJoin = -endTopJoin;\n\n\tvec2 aTopCoord = aCoord + normalWidth * startTopJoin;\n\tvec2 bTopCoord = bCoord + normalWidth * endTopJoin;\n\tvec2 aBotCoord = aCoord + normalWidth * startBotJoin;\n\tvec2 bBotCoord = bCoord + normalWidth * endBotJoin;\n\n\t//miter anti-clipping\n\tfloat baClipping = distToLine(bCoord, aCoord, aBotCoord) / dot(normalize(normalWidth * endBotJoin), normalize(normalWidth.yx * vec2(-startBotJoin.y, startBotJoin.x)));\n\tfloat abClipping = distToLine(aCoord, bCoord, bTopCoord) / dot(normalize(normalWidth * startBotJoin), normalize(normalWidth.yx * vec2(-endBotJoin.y, endBotJoin.x)));\n\n\t//prevent close to reverse direction switch\n\tbool prevReverse = dot(currTangent, prevTangent) <= REVERSE_THRESHOLD && abs(dot(currTangent, prevNormal)) * min(length(prevDiff), length(currDiff)) <  length(normalWidth * currNormal);\n\tbool nextReverse = dot(currTangent, nextTangent) <= REVERSE_THRESHOLD && abs(dot(currTangent, nextNormal)) * min(length(nextDiff), length(currDiff)) <  length(normalWidth * currNormal);\n\n\tif (prevReverse) {\n\t\t//make join rectangular\n\t\tvec2 miterShift = normalWidth * startJoinDirection * miterLimit * .5;\n\t\tfloat normalAdjust = 1. - min(miterLimit / startMiterRatio, 1.);\n\t\taBotCoord = aCoord + miterShift - normalAdjust * normalWidth * currNormal * .5;\n\t\taTopCoord = aCoord + miterShift + normalAdjust * normalWidth * currNormal * .5;\n\t}\n\telse if (!nextReverse && baClipping > 0. && baClipping < length(normalWidth * endBotJoin)) {\n\t\t//handle miter clipping\n\t\tbTopCoord -= normalWidth * endTopJoin;\n\t\tbTopCoord += normalize(endTopJoin * normalWidth) * baClipping;\n\t}\n\n\tif (nextReverse) {\n\t\t//make join rectangular\n\t\tvec2 miterShift = normalWidth * endJoinDirection * miterLimit * .5;\n\t\tfloat normalAdjust = 1. - min(miterLimit / endMiterRatio, 1.);\n\t\tbBotCoord = bCoord + miterShift - normalAdjust * normalWidth * currNormal * .5;\n\t\tbTopCoord = bCoord + miterShift + normalAdjust * normalWidth * currNormal * .5;\n\t}\n\telse if (!prevReverse && abClipping > 0. && abClipping < length(normalWidth * startBotJoin)) {\n\t\t//handle miter clipping\n\t\taBotCoord -= normalWidth * startBotJoin;\n\t\taBotCoord += normalize(startBotJoin * normalWidth) * abClipping;\n\t}\n\n\tvec2 aTopPosition = (aTopCoord) * adjustedScale + translate;\n\tvec2 aBotPosition = (aBotCoord) * adjustedScale + translate;\n\n\tvec2 bTopPosition = (bTopCoord) * adjustedScale + translate;\n\tvec2 bBotPosition = (bBotCoord) * adjustedScale + translate;\n\n\t//position is normalized 0..1 coord on the screen\n\tvec2 position = (aTopPosition * lineTop + aBotPosition * lineBot) * lineStart + (bTopPosition * lineTop + bBotPosition * lineBot) * lineEnd;\n\n\tstartCoord = aCoord * scaleRatio + translate * viewport.zw + viewport.xy;\n\tendCoord = bCoord * scaleRatio + translate * viewport.zw + viewport.xy;\n\n\tgl_Position = vec4(position  * 2.0 - 1.0, depth, 1);\n\n\tenableStartMiter = step(dot(currTangent, prevTangent), .5);\n\tenableEndMiter = step(dot(currTangent, nextTangent), .5);\n\n\t//bevel miter cutoffs\n\tif (miterMode == 1.) {\n\t\tif (enableStartMiter == 1.) {\n\t\t\tvec2 startMiterWidth = vec2(startJoinDirection) * thickness * miterLimit * .5;\n\t\t\tstartCutoff = vec4(aCoord, aCoord);\n\t\t\tstartCutoff.zw += vec2(-startJoinDirection.y, startJoinDirection.x) / scaleRatio;\n\t\t\tstartCutoff = startCutoff * scaleRatio.xyxy + translate.xyxy * viewport.zwzw;\n\t\t\tstartCutoff += viewport.xyxy;\n\t\t\tstartCutoff += startMiterWidth.xyxy;\n\t\t}\n\n\t\tif (enableEndMiter == 1.) {\n\t\t\tvec2 endMiterWidth = vec2(endJoinDirection) * thickness * miterLimit * .5;\n\t\t\tendCutoff = vec4(bCoord, bCoord);\n\t\t\tendCutoff.zw += vec2(-endJoinDirection.y, endJoinDirection.x)  / scaleRatio;\n\t\t\tendCutoff = endCutoff * scaleRatio.xyxy + translate.xyxy * viewport.zwzw;\n\t\t\tendCutoff += viewport.xyxy;\n\t\t\tendCutoff += endMiterWidth.xyxy;\n\t\t}\n\t}\n\n\t//round miter cutoffs\n\telse if (miterMode == 2.) {\n\t\tif (enableStartMiter == 1.) {\n\t\t\tvec2 startMiterWidth = vec2(startJoinDirection) * thickness * abs(dot(startJoinDirection, currNormal)) * .5;\n\t\t\tstartCutoff = vec4(aCoord, aCoord);\n\t\t\tstartCutoff.zw += vec2(-startJoinDirection.y, startJoinDirection.x) / scaleRatio;\n\t\t\tstartCutoff = startCutoff * scaleRatio.xyxy + translate.xyxy * viewport.zwzw;\n\t\t\tstartCutoff += viewport.xyxy;\n\t\t\tstartCutoff += startMiterWidth.xyxy;\n\t\t}\n\n\t\tif (enableEndMiter == 1.) {\n\t\t\tvec2 endMiterWidth = vec2(endJoinDirection) * thickness * abs(dot(endJoinDirection, currNormal)) * .5;\n\t\t\tendCutoff = vec4(bCoord, bCoord);\n\t\t\tendCutoff.zw += vec2(-endJoinDirection.y, endJoinDirection.x)  / scaleRatio;\n\t\t\tendCutoff = endCutoff * scaleRatio.xyxy + translate.xyxy * viewport.zwzw;\n\t\t\tendCutoff += viewport.xyxy;\n\t\t\tendCutoff += endMiterWidth.xyxy;\n\t\t}\n\t}\n}\n"]),frag:x(["precision highp float;\n#define GLSLIFY 1\n\nuniform float dashLength, pixelRatio, thickness, opacity, id, miterMode;\nuniform sampler2D dashTexture;\n\nvarying vec4 fragColor;\nvarying vec2 tangent;\nvarying vec4 startCutoff, endCutoff;\nvarying vec2 startCoord, endCoord;\nvarying float enableStartMiter, enableEndMiter;\n\nfloat distToLine(vec2 p, vec2 a, vec2 b) {\n\tvec2 diff = b - a;\n\tvec2 perp = normalize(vec2(-diff.y, diff.x));\n\treturn dot(p - a, perp);\n}\n\nvoid main() {\n\tfloat alpha = 1., distToStart, distToEnd;\n\tfloat cutoff = thickness * .5;\n\n\t//bevel miter\n\tif (miterMode == 1.) {\n\t\tif (enableStartMiter == 1.) {\n\t\t\tdistToStart = distToLine(gl_FragCoord.xy, startCutoff.xy, startCutoff.zw);\n\t\t\tif (distToStart < -1.) {\n\t\t\t\tdiscard;\n\t\t\t\treturn;\n\t\t\t}\n\t\t\talpha *= min(max(distToStart + 1., 0.), 1.);\n\t\t}\n\n\t\tif (enableEndMiter == 1.) {\n\t\t\tdistToEnd = distToLine(gl_FragCoord.xy, endCutoff.xy, endCutoff.zw);\n\t\t\tif (distToEnd < -1.) {\n\t\t\t\tdiscard;\n\t\t\t\treturn;\n\t\t\t}\n\t\t\talpha *= min(max(distToEnd + 1., 0.), 1.);\n\t\t}\n\t}\n\n\t// round miter\n\telse if (miterMode == 2.) {\n\t\tif (enableStartMiter == 1.) {\n\t\t\tdistToStart = distToLine(gl_FragCoord.xy, startCutoff.xy, startCutoff.zw);\n\t\t\tif (distToStart < 0.) {\n\t\t\t\tfloat radius = length(gl_FragCoord.xy - startCoord);\n\n\t\t\t\tif(radius > cutoff + .5) {\n\t\t\t\t\tdiscard;\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\talpha -= smoothstep(cutoff - .5, cutoff + .5, radius);\n\t\t\t}\n\t\t}\n\n\t\tif (enableEndMiter == 1.) {\n\t\t\tdistToEnd = distToLine(gl_FragCoord.xy, endCutoff.xy, endCutoff.zw);\n\t\t\tif (distToEnd < 0.) {\n\t\t\t\tfloat radius = length(gl_FragCoord.xy - endCoord);\n\n\t\t\t\tif(radius > cutoff + .5) {\n\t\t\t\t\tdiscard;\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\talpha -= smoothstep(cutoff - .5, cutoff + .5, radius);\n\t\t\t}\n\t\t}\n\t}\n\n\tfloat t = fract(dot(tangent, gl_FragCoord.xy) / dashLength) * .5 + .25;\n\tfloat dash = texture2D(dashTexture, vec2(t, .5)).r;\n\n\tgl_FragColor = fragColor;\n\tgl_FragColor.a *= alpha * opacity * dash;\n}\n"]),attributes:{lineEnd:{buffer:o,divisor:0,stride:8,offset:0},lineTop:{buffer:o,divisor:0,stride:8,offset:4},aColor:{buffer:h.prop("colorBuffer"),stride:4,offset:0,divisor:1},bColor:{buffer:h.prop("colorBuffer"),stride:4,offset:4,divisor:1},prevCoord:{buffer:h.prop("positionBuffer"),stride:8,offset:0,divisor:1},aCoord:{buffer:h.prop("positionBuffer"),stride:8,offset:8,divisor:1},bCoord:{buffer:h.prop("positionBuffer"),stride:8,offset:16,divisor:1},nextCoord:{buffer:h.prop("positionBuffer"),stride:8,offset:24,divisor:1}}},b))}catch{p=l}return{fill:h({primitive:"triangle",elements:function(T,_){return _.triangles},offset:0,vert:x(["precision highp float;\n#define GLSLIFY 1\n\nattribute vec2 position, positionFract;\n\nuniform vec4 color;\nuniform vec2 scale, scaleFract, translate, translateFract;\nuniform float pixelRatio, id;\nuniform vec4 viewport;\nuniform float opacity;\n\nvarying vec4 fragColor;\n\nconst float MAX_LINES = 256.;\n\nvoid main() {\n\tfloat depth = (MAX_LINES - 4. - id) / (MAX_LINES);\n\n\tvec2 position = position * scale + translate\n       + positionFract * scale + translateFract\n       + position * scaleFract\n       + positionFract * scaleFract;\n\n\tgl_Position = vec4(position * 2.0 - 1.0, depth, 1);\n\n\tfragColor = color / 255.;\n\tfragColor.a *= opacity;\n}\n"]),frag:x(["precision highp float;\n#define GLSLIFY 1\n\nvarying vec4 fragColor;\n\nvoid main() {\n\tgl_FragColor = fragColor;\n}\n"]),uniforms:{scale:h.prop("scale"),color:h.prop("fill"),scaleFract:h.prop("scaleFract"),translateFract:h.prop("translateFract"),translate:h.prop("translate"),opacity:h.prop("opacity"),pixelRatio:h.context("pixelRatio"),id:h.prop("id"),viewport:function(T,_){return[_.viewport.x,_.viewport.y,T.viewportWidth,T.viewportHeight]}},attributes:{position:{buffer:h.prop("positionBuffer"),stride:8,offset:8},positionFract:{buffer:h.prop("positionFractBuffer"),stride:8,offset:8}},blend:b.blend,depth:{enable:!1},scissor:b.scissor,stencil:b.stencil,viewport:b.viewport}),rect:l,miter:p}},c.defaults={dashes:null,join:"miter",miterLimit:1,thickness:10,cap:"square",color:"black",opacity:1,overlay:!1,viewport:null,range:null,close:!1,fill:null},c.prototype.render=function(){for(var h,p=[],o=arguments.length;o--;)p[o]=arguments[o];p.length&&(h=this).update.apply(h,p),this.draw()},c.prototype.draw=function(){for(var h=this,p=[],o=arguments.length;o--;)p[o]=arguments[o];return(p.length?p:this.passes).forEach(function(b,l){var T;if(b&&Array.isArray(b))return(T=h).draw.apply(T,b);"number"==typeof b&&(b=h.passes[b]),b&&b.count>1&&b.opacity&&(h.regl._refresh(),b.fill&&b.triangles&&b.triangles.length>2&&h.shaders.fill(b),b.thickness&&(b.scale[0]*b.viewport.width>c.precisionThreshold||b.scale[1]*b.viewport.height>c.precisionThreshold||"rect"===b.join||!b.join&&(b.thickness<=2||b.count>=c.maxPoints)?h.shaders.rect(b):h.shaders.miter(b)))}),this},c.prototype.update=function(h){var p=this;if(h){null!=h.length?"number"==typeof h[0]&&(h=[{positions:h}]):Array.isArray(h)||(h=[h]);var o=this.regl,b=this.gl;if(h.forEach(function(k,L){var M=p.passes[L];if(void 0!==k)if(null!==k){if("number"==typeof k[0]&&(k={positions:k}),k=e(k,{positions:"positions points data coords",thickness:"thickness lineWidth lineWidths line-width linewidth width stroke-width strokewidth strokeWidth",join:"lineJoin linejoin join type mode",miterLimit:"miterlimit miterLimit",dashes:"dash dashes dasharray dash-array dashArray",color:"color colour stroke colors colours stroke-color strokeColor",fill:"fill fill-color fillColor",opacity:"alpha opacity",overlay:"overlay crease overlap intersect",close:"closed close closed-path closePath",range:"range dataBox",viewport:"viewport viewBox",hole:"holes hole hollow",splitNull:"splitNull"}),M||(p.passes[L]=M={id:L,scale:null,scaleFract:null,translate:null,translateFract:null,count:0,hole:[],depth:0,dashLength:1,dashTexture:o.texture({channels:1,data:new Uint8Array([255]),width:1,height:1,mag:"linear",min:"linear"}),colorBuffer:o.buffer({usage:"dynamic",type:"uint8",data:new Uint8Array}),positionBuffer:o.buffer({usage:"dynamic",type:"float",data:new Uint8Array}),positionFractBuffer:o.buffer({usage:"dynamic",type:"float",data:new Uint8Array})},k=m({},c.defaults,k)),null!=k.thickness&&(M.thickness=parseFloat(k.thickness)),null!=k.opacity&&(M.opacity=parseFloat(k.opacity)),null!=k.miterLimit&&(M.miterLimit=parseFloat(k.miterLimit)),null!=k.overlay&&(M.overlay=!!k.overlay,L<c.maxLines&&(M.depth=2*(c.maxLines-1-L%c.maxLines)/c.maxLines-1)),null!=k.join&&(M.join=k.join),null!=k.hole&&(M.hole=k.hole),null!=k.fill&&(M.fill=k.fill?g(k.fill,"uint8"):null),null!=k.viewport&&(M.viewport=u(k.viewport)),M.viewport||(M.viewport=u([b.drawingBufferWidth,b.drawingBufferHeight])),null!=k.close&&(M.close=k.close),null===k.positions&&(k.positions=[]),k.positions){var I,P;if(k.positions.x&&k.positions.y){var S=k.positions.x,E=k.positions.y;P=M.count=Math.max(S.length,E.length),I=new Float64Array(2*P);for(var z=0;z<P;z++)I[2*z]=S[z],I[2*z+1]=E[z]}else I=n(k.positions,"float64"),P=M.count=Math.floor(I.length/2);var R=M.bounds=v(I,2);if(M.fill){for(var q=[],V={},W=0,K=0,G=0,Y=M.count;K<Y;K++){var $=I[2*K],B=I[2*K+1];isNaN($)||isNaN(B)||null==$||null==B?($=I[2*W],B=I[2*W+1],V[K]=W):W=K,q[G++]=$,q[G++]=B}if(k.splitNull){M.count-1 in V||(V[M.count]=M.count-1);var N=Object.keys(V).map(Number).sort(function(mt,Bt){return mt-Bt}),U=[],te=0,j=null!=M.hole?M.hole[0]:null;if(null!=j){var J=f(N,function(mt){return mt>=j});(N=N.slice(0,J)).push(j)}for(var X=function(mt){var Bt=q.slice(2*te,2*N[mt]).concat(j?q.slice(2*j):[]),Ut=(M.hole||[]).map(function(Wt){return Wt-j+(N[mt]-te)}),er=t(Bt,Ut);er=er.map(function(Wt){return Wt+te+(Wt+te<N[mt]?0:j-N[mt])}),U.push.apply(U,er),te=N[mt]+1},re=0;re<N.length;re++)X(re);for(var ne=0,le=U.length;ne<le;ne++)null!=V[U[ne]]&&(U[ne]=V[U[ne]]);M.triangles=U}else{for(var oe=t(q,M.hole||[]),de=0,se=oe.length;de<se;de++)null!=V[oe[de]]&&(oe[de]=V[oe[de]]);M.triangles=oe}}var ge=new Float64Array(I);a(ge,2,R);var _e=new Float64Array(2*P+6);M.close?I[0]===I[2*P-2]&&I[1]===I[2*P-1]?(_e[0]=ge[2*P-4],_e[1]=ge[2*P-3]):(_e[0]=ge[2*P-2],_e[1]=ge[2*P-1]):(_e[0]=ge[0],_e[1]=ge[1]),_e.set(ge,2),M.close?I[0]===I[2*P-2]&&I[1]===I[2*P-1]?(_e[2*P+2]=ge[2],_e[2*P+3]=ge[3],M.count-=1):(_e[2*P+2]=ge[0],_e[2*P+3]=ge[1],_e[2*P+4]=ge[2],_e[2*P+5]=ge[3]):(_e[2*P+2]=ge[2*P-2],_e[2*P+3]=ge[2*P-1],_e[2*P+4]=ge[2*P-2],_e[2*P+5]=ge[2*P-1]);var Te=d(_e);M.positionBuffer(Te);var we=s(_e,Te);M.positionFractBuffer(we)}if(k.range?M.range=k.range:M.range||(M.range=M.bounds),(k.range||k.positions)&&M.count){var Oe=M.bounds,Ae=M.range[2]-M.range[0],ke=M.range[3]-M.range[1];M.scale=[(Oe[2]-Oe[0])/Ae,(Oe[3]-Oe[1])/ke],M.translate=[-M.range[0]/Ae+Oe[0]/Ae||0,-M.range[1]/ke+Oe[1]/ke||0],M.scaleFract=s(M.scale),M.translateFract=s(M.translate)}if(k.dashes){var Pe,Ne=0;if(!k.dashes||k.dashes.length<2)Ne=1,Pe=new Uint8Array([255,255,255,255,255,255,255,255]);else{Ne=0;for(var De=0;De<k.dashes.length;++De)Ne+=k.dashes[De];Pe=new Uint8Array(Ne*c.dashMult);for(var ze=0,Me=255,Se=0;Se<2;Se++)for(var Ie=0;Ie<k.dashes.length;++Ie){for(var Fe=0,Re=k.dashes[Ie]*c.dashMult*.5;Fe<Re;++Fe)Pe[ze++]=Me;Me^=255}}M.dashLength=Ne,M.dashTexture({channels:1,data:Pe,width:Pe.length,height:1,mag:"linear",min:"linear"},0,0)}if(k.color){var Xe=M.count,nt=k.color;nt||(nt="transparent");var ct=new Uint8Array(4*Xe+4);if(Array.isArray(nt)&&"number"!=typeof nt[0]){for(var xt=0;xt<Xe;xt++){var dt=g(nt[xt],"uint8");ct.set(dt,4*xt)}ct.set(g(nt[0],"uint8"),4*Xe)}else for(var tt=g(nt,"uint8"),Ke=0;Ke<Xe+1;Ke++)ct.set(tt,4*Ke);M.colorBuffer({usage:"dynamic",type:"uint8",data:ct})}}else p.passes[L]=null}),h.length<this.passes.length){for(var l=h.length;l<this.passes.length;l++){var T=this.passes[l];T&&(T.colorBuffer.destroy(),T.positionBuffer.destroy(),T.dashTexture.destroy())}this.passes.length=h.length}for(var _=[],w=0;w<this.passes.length;w++)null!==this.passes[w]&&_.push(this.passes[w]);return this.passes=_,this}},c.prototype.destroy=function(){return this.passes.forEach(function(h){h.colorBuffer.destroy(),h.positionBuffer.destroy(),h.dashTexture.destroy()}),this.passes.length=0,this}},{"array-bounds":71,"array-find-index":72,"array-normalize":73,"color-normalize":89,earcut:129,"es6-weak-map":183,"flatten-vertex-data":191,glslify:227,"object-assign":247,"parse-rect":249,"pick-by-alias":253,"to-float32":314}],282:[function(y,ee,Q){"use strict";function g(l,T){return function(_){if(Array.isArray(_))return _}(l)||function(_,w){var k=null==_?null:typeof Symbol<"u"&&_[Symbol.iterator]||_["@@iterator"];if(null!=k){var L,M,I=[],P=!0,S=!1;try{for(k=k.call(_);!(P=(L=k.next()).done)&&(I.push(L.value),!w||I.length!==w);P=!0);}catch(E){S=!0,M=E}finally{try{P||null==k.return||k.return()}finally{if(S)throw M}}return I}}(l,T)||m(l,T)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function v(l){return function(T){if(Array.isArray(T))return x(T)}(l)||function(T){if(typeof Symbol<"u"&&null!=T[Symbol.iterator]||null!=T["@@iterator"])return Array.from(T)}(l)||m(l)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function m(l,T){if(l){if("string"==typeof l)return x(l,T);var _=Object.prototype.toString.call(l).slice(8,-1);return"Object"===_&&l.constructor&&(_=l.constructor.name),"Map"===_||"Set"===_?Array.from(l):"Arguments"===_||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(_)?x(l,T):void 0}}function x(l,T){(null==T||T>l.length)&&(T=l.length);for(var _=0,w=new Array(T);_<T;_++)w[_]=l[_];return w}var e=y("color-normalize"),n=y("array-bounds"),t=y("color-id"),a=y("@plotly/point-cluster"),r=y("object-assign"),d=y("glslify"),s=y("pick-by-alias"),i=y("update-diff"),u=y("flatten-vertex-data"),f=y("is-iexplorer"),c=y("to-float32"),h=y("parse-rect"),p=o;function o(l,T){var _=this;if(!(this instanceof o))return new o(l,T);"function"==typeof l?(T||(T={}),T.regl=l):(T=l,l=null),T&&T.length&&(T.positions=T);var w,k=(l=T.regl)._gl,L=[];this.tooManyColors=f,w=l.texture({data:new Uint8Array(1020),width:255,height:1,type:"uint8",format:"rgba",wrapS:"clamp",wrapT:"clamp",mag:"nearest",min:"nearest"}),r(this,{regl:l,gl:k,groups:[],markerCache:[null],markerTextures:[null],palette:L,paletteIds:{},paletteTexture:w,maxColors:255,maxSize:100,canvas:k.canvas}),this.update(T);var M={uniforms:{constPointSize:!!T.constPointSize,opacity:l.prop("opacity"),paletteSize:function(S,E){return[_.tooManyColors?0:255,w.height]},pixelRatio:l.context("pixelRatio"),scale:l.prop("scale"),scaleFract:l.prop("scaleFract"),translate:l.prop("translate"),translateFract:l.prop("translateFract"),markerTexture:l.prop("markerTexture"),paletteTexture:w},attributes:{x:function(S,E){return E.xAttr||{buffer:E.positionBuffer,stride:8,offset:0}},y:function(S,E){return E.yAttr||{buffer:E.positionBuffer,stride:8,offset:4}},xFract:function(S,E){return E.xAttr?{constant:[0,0]}:{buffer:E.positionFractBuffer,stride:8,offset:0}},yFract:function(S,E){return E.yAttr?{constant:[0,0]}:{buffer:E.positionFractBuffer,stride:8,offset:4}},size:function(S,E){return E.size.length?{buffer:E.sizeBuffer,stride:2,offset:0}:{constant:[Math.round(255*E.size/_.maxSize)]}},borderSize:function(S,E){return E.borderSize.length?{buffer:E.sizeBuffer,stride:2,offset:1}:{constant:[Math.round(255*E.borderSize/_.maxSize)]}},colorId:function(S,E){return E.color.length?{buffer:E.colorBuffer,stride:_.tooManyColors?8:4,offset:0}:{constant:_.tooManyColors?L.slice(4*E.color,4*E.color+4):[E.color]}},borderColorId:function(S,E){return E.borderColor.length?{buffer:E.colorBuffer,stride:_.tooManyColors?8:4,offset:_.tooManyColors?4:2}:{constant:_.tooManyColors?L.slice(4*E.borderColor,4*E.borderColor+4):[E.borderColor]}},isActive:function(S,E){return!0===E.activation?{constant:[1]}:E.activation?E.activation:{constant:[0]}}},blend:{enable:!0,color:[0,0,0,1],func:{srcRGB:"src alpha",dstRGB:"one minus src alpha",srcAlpha:"one minus dst alpha",dstAlpha:"one"}},scissor:{enable:!0,box:l.prop("viewport")},viewport:l.prop("viewport"),stencil:{enable:!1},depth:{enable:!1},elements:l.prop("elements"),count:l.prop("count"),offset:l.prop("offset"),primitive:"points"},I=r({},M);I.frag=d(["precision highp float;\n#define GLSLIFY 1\n\nuniform float opacity;\nuniform sampler2D markerTexture;\n\nvarying vec4 fragColor, fragBorderColor;\nvarying float fragWidth, fragBorderColorLevel, fragColorLevel;\n\nfloat smoothStep(float x, float y) {\n  return 1.0 / (1.0 + exp(50.0*(x - y)));\n}\n\nvoid main() {\n  float dist = texture2D(markerTexture, gl_PointCoord).r, delta = fragWidth;\n\n  // max-distance alpha\n  if (dist < 0.003) discard;\n\n  // null-border case\n  if (fragBorderColorLevel == fragColorLevel || fragBorderColor.a == 0.) {\n    float colorAmt = smoothstep(.5 - delta, .5 + delta, dist);\n    gl_FragColor = vec4(fragColor.rgb, colorAmt * fragColor.a * opacity);\n  }\n  else {\n    float borderColorAmt = smoothstep(fragBorderColorLevel - delta, fragBorderColorLevel + delta, dist);\n    float colorAmt = smoothstep(fragColorLevel - delta, fragColorLevel + delta, dist);\n\n    vec4 color = fragBorderColor;\n    color.a *= borderColorAmt;\n    color = mix(color, fragColor, colorAmt);\n    color.a *= opacity;\n\n    gl_FragColor = color;\n  }\n\n}\n"]),I.vert=d(["precision highp float;\n#define GLSLIFY 1\n\nattribute float x, y, xFract, yFract;\nattribute float size, borderSize;\nattribute vec4 colorId, borderColorId;\nattribute float isActive;\n\nuniform bool constPointSize;\nuniform float pixelRatio;\nuniform vec2 scale, scaleFract, translate, translateFract, paletteSize;\nuniform sampler2D paletteTexture;\n\nconst float maxSize = 100.;\nconst float borderLevel = .5;\n\nvarying vec4 fragColor, fragBorderColor;\nvarying float fragPointSize, fragBorderRadius, fragWidth, fragBorderColorLevel, fragColorLevel;\n\nfloat pointSizeScale = (constPointSize) ? 2. : pixelRatio;\n\nbool isDirect = (paletteSize.x < 1.);\n\nvec4 getColor(vec4 id) {\n  return isDirect ? id / 255. : texture2D(paletteTexture,\n    vec2(\n      (id.x + .5) / paletteSize.x,\n      (id.y + .5) / paletteSize.y\n    )\n  );\n}\n\nvoid main() {\n  // ignore inactive points\n  if (isActive == 0.) return;\n\n  vec2 position = vec2(x, y);\n  vec2 positionFract = vec2(xFract, yFract);\n\n  vec4 color = getColor(colorId);\n  vec4 borderColor = getColor(borderColorId);\n\n  float size = size * maxSize / 255.;\n  float borderSize = borderSize * maxSize / 255.;\n\n  gl_PointSize = 2. * size * pointSizeScale;\n  fragPointSize = size * pixelRatio;\n\n  vec2 pos = (position + translate) * scale\n      + (positionFract + translateFract) * scale\n      + (position + translate) * scaleFract\n      + (positionFract + translateFract) * scaleFract;\n\n  gl_Position = vec4(pos * 2. - 1., 0., 1.);\n\n  fragColor = color;\n  fragBorderColor = borderColor;\n  fragWidth = 1. / gl_PointSize;\n\n  fragBorderColorLevel = clamp(borderLevel - borderLevel * borderSize / size, 0., 1.);\n  fragColorLevel = clamp(borderLevel + (1. - borderLevel) * borderSize / size, 0., 1.);\n}"]),this.drawMarker=l(I);var P=r({},M);P.frag=d(["precision highp float;\n#define GLSLIFY 1\n\nvarying vec4 fragColor, fragBorderColor;\nvarying float fragBorderRadius, fragWidth;\n\nuniform float opacity;\n\nfloat smoothStep(float edge0, float edge1, float x) {\n\tfloat t;\n\tt = clamp((x - edge0) / (edge1 - edge0), 0.0, 1.0);\n\treturn t * t * (3.0 - 2.0 * t);\n}\n\nvoid main() {\n\tfloat radius, alpha = 1.0, delta = fragWidth;\n\n\tradius = length(2.0 * gl_PointCoord.xy - 1.0);\n\n\tif (radius > 1.0 + delta) {\n\t\tdiscard;\n\t}\n\n\talpha -= smoothstep(1.0 - delta, 1.0 + delta, radius);\n\n\tfloat borderRadius = fragBorderRadius;\n\tfloat ratio = smoothstep(borderRadius - delta, borderRadius + delta, radius);\n\tvec4 color = mix(fragColor, fragBorderColor, ratio);\n\tcolor.a *= alpha * opacity;\n\tgl_FragColor = color;\n}\n"]),P.vert=d(["precision highp float;\n#define GLSLIFY 1\n\nattribute float x, y, xFract, yFract;\nattribute float size, borderSize;\nattribute vec4 colorId, borderColorId;\nattribute float isActive;\n\nuniform bool constPointSize;\nuniform float pixelRatio;\nuniform vec2 paletteSize, scale, scaleFract, translate, translateFract;\nuniform sampler2D paletteTexture;\n\nconst float maxSize = 100.;\n\nvarying vec4 fragColor, fragBorderColor;\nvarying float fragBorderRadius, fragWidth;\n\nfloat pointSizeScale = (constPointSize) ? 2. : pixelRatio;\n\nbool isDirect = (paletteSize.x < 1.);\n\nvec4 getColor(vec4 id) {\n  return isDirect ? id / 255. : texture2D(paletteTexture,\n    vec2(\n      (id.x + .5) / paletteSize.x,\n      (id.y + .5) / paletteSize.y\n    )\n  );\n}\n\nvoid main() {\n  // ignore inactive points\n  if (isActive == 0.) return;\n\n  vec2 position = vec2(x, y);\n  vec2 positionFract = vec2(xFract, yFract);\n\n  vec4 color = getColor(colorId);\n  vec4 borderColor = getColor(borderColorId);\n\n  float size = size * maxSize / 255.;\n  float borderSize = borderSize * maxSize / 255.;\n\n  gl_PointSize = (size + borderSize) * pointSizeScale;\n\n  vec2 pos = (position + translate) * scale\n      + (positionFract + translateFract) * scale\n      + (position + translate) * scaleFract\n      + (positionFract + translateFract) * scaleFract;\n\n  gl_Position = vec4(pos * 2. - 1., 0., 1.);\n\n  fragBorderRadius = 1. - 2. * borderSize / (size + borderSize);\n  fragColor = color;\n  fragBorderColor = borderColor.a == 0. || borderSize == 0. ? vec4(color.rgb, 0.) : borderColor;\n  fragWidth = 1. / gl_PointSize;\n}\n"]),f&&(P.frag=P.frag.replace("smoothstep","smoothStep"),I.frag=I.frag.replace("smoothstep","smoothStep")),this.drawCircle=l(P)}o.defaults={color:"black",borderColor:"transparent",borderSize:0,size:12,opacity:1,marker:void 0,viewport:null,range:null,pixelSize:null,count:0,offset:0,bounds:null,positions:[],snap:1e4},o.prototype.render=function(){return arguments.length&&this.update.apply(this,arguments),this.draw(),this},o.prototype.draw=function(){for(var l=this,T=arguments.length,_=new Array(T),w=0;w<T;w++)_[w]=arguments[w];var k=this.groups;if(1===_.length&&Array.isArray(_[0])&&(null===_[0][0]||Array.isArray(_[0][0]))&&(_=_[0]),this.regl._refresh(),_.length)for(var L=0;L<_.length;L++)this.drawItem(L,_[L]);else k.forEach(function(M,I){l.drawItem(I)});return this},o.prototype.drawItem=function(l,T){var _=this.groups,w=_[l];if("number"==typeof T&&(l=T,w=_[T],T=null),w&&w.count&&w.opacity){w.activation[0]&&this.drawCircle(this.getMarkerDrawOptions(0,w,T));for(var k=[],L=1;L<w.activation.length;L++)w.activation[L]&&(!0===w.activation[L]||w.activation[L].data.length)&&k.push.apply(k,v(this.getMarkerDrawOptions(L,w,T)));k.length&&this.drawMarker(k)}},o.prototype.getMarkerDrawOptions=function(l,T,_){var w=T.range,k=T.tree,L=T.viewport,M=T.activation,I=T.selectionBuffer,P=T.count;if(!k)return _?[r({},T,{markerTexture:this.markerTextures[l],activation:M[l],count:_.length,elements:_,offset:0})]:[r({},T,{markerTexture:this.markerTextures[l],activation:M[l],offset:0})];var S=[],E=k.range(w,{lod:!0,px:[(w[2]-w[0])/L.width,(w[3]-w[1])/L.height]});if(_){for(var z=M[l].data,R=new Uint8Array(P),q=0;q<_.length;q++){var V=_[q];R[V]=z?z[V]:1}I.subdata(R)}for(var W=E.length;W--;){var K=g(E[W],2),G=K[0];S.push(r({},T,{markerTexture:this.markerTextures[l],activation:_?I:M[l],offset:G,count:K[1]-G}))}return S},o.prototype.update=function(){for(var l=this,T=arguments.length,_=new Array(T),w=0;w<T;w++)_[w]=arguments[w];if(_.length){1===_.length&&Array.isArray(_[0])&&(_=_[0]);var k=this.groups,L=this.gl,M=this.regl,I=this.maxSize,P=this.maxColors,S=this.palette;this.groups=k=_.map(function(E,z){var R=k[z];if(void 0===E)return R;null===E?E={positions:null}:"function"==typeof E?E={ondraw:E}:"number"==typeof E[0]&&(E={positions:E}),null===(E=s(E,{positions:"positions data points",snap:"snap cluster lod tree",size:"sizes size radius",borderSize:"borderSizes borderSize border-size bordersize borderWidth borderWidths border-width borderwidth stroke-width strokeWidth strokewidth outline",color:"colors color fill fill-color fillColor",borderColor:"borderColors borderColor stroke stroke-color strokeColor",marker:"markers marker shape",range:"range dataBox databox",viewport:"viewport viewPort viewBox viewbox",opacity:"opacity alpha transparency",bounds:"bound bounds boundaries limits",tooManyColors:"tooManyColors palette paletteMode optimizePalette enablePalette"})).positions&&(E.positions=[]),null!=E.tooManyColors&&(l.tooManyColors=E.tooManyColors),R||(k[z]=R={id:z,scale:null,translate:null,scaleFract:null,translateFract:null,activation:[],selectionBuffer:M.buffer({data:new Uint8Array(0),usage:"stream",type:"uint8"}),sizeBuffer:M.buffer({data:new Uint8Array(0),usage:"dynamic",type:"uint8"}),colorBuffer:M.buffer({data:new Uint8Array(0),usage:"dynamic",type:"uint8"}),positionBuffer:M.buffer({data:new Uint8Array(0),usage:"dynamic",type:"float"}),positionFractBuffer:M.buffer({data:new Uint8Array(0),usage:"dynamic",type:"float"})},E=r({},o.defaults,E)),E.positions&&!("marker"in E)&&(E.marker=R.marker,delete R.marker),E.marker&&!("positions"in E)&&(E.positions=R.positions,delete R.positions);var q=0,V=0;if(i(R,E,[{snap:!0,size:function(se,ge){return null==se&&(se=o.defaults.size),q+=se&&se.length?1:0,se},borderSize:function(se,ge){return null==se&&(se=o.defaults.borderSize),q+=se&&se.length?1:0,se},opacity:parseFloat,color:function(se,ge){return null==se&&(se=o.defaults.color),se=l.updateColor(se),V++,se},borderColor:function(se,ge){return null==se&&(se=o.defaults.borderColor),se=l.updateColor(se),V++,se},bounds:function(se,ge,_e){return"range"in _e||(_e.range=null),se},positions:function(se,ge,_e){var Te=ge.snap,we=ge.positionBuffer,Oe=ge.positionFractBuffer,fe=ge.selectionBuffer;if(se.x||se.y)return ge.xAttr=se.x.length?{buffer:M.buffer(se.x),offset:0,stride:4,count:se.x.length}:{buffer:se.x.buffer,offset:4*se.x.offset||0,stride:4*(se.x.stride||1),count:se.x.count},ge.yAttr=se.y.length?{buffer:M.buffer(se.y),offset:0,stride:4,count:se.y.length}:{buffer:se.y.buffer,offset:4*se.y.offset||0,stride:4*(se.y.stride||1),count:se.y.count},ge.count=Math.max(ge.xAttr.count,ge.yAttr.count),se;se=u(se,"float64");var ve=ge.count=Math.floor(se.length/2),Ae=ge.bounds=ve?n(se,2):null;if(_e.range||ge.range||(delete ge.range,_e.range=Ae),_e.marker||ge.marker||(delete ge.marker,_e.marker=null),Te&&(!0===Te||ve>Te)?ge.tree=a(se,{bounds:Ae}):Te&&Te.length&&(ge.tree=Te),ge.tree){var ke={primitive:"points",usage:"static",data:ge.tree,type:"uint32"};ge.elements?ge.elements(ke):ge.elements=M.elements(ke)}var Pe=c.float32(se);return we({data:Pe,usage:"dynamic"}),Oe({data:c.fract32(se,Pe),usage:"dynamic"}),fe({data:new Uint8Array(ve),type:"uint8",usage:"stream"}),se}},{marker:function(se,ge,_e){var Te=ge.activation;if(Te.forEach(function(Pe){return Pe&&Pe.destroy&&Pe.destroy()}),Te.length=0,se&&"number"!=typeof se[0]){for(var we=[],Oe=0,fe=Math.min(se.length,ge.count);Oe<fe;Oe++){var ve=l.addMarker(se[Oe]);we[ve]||(we[ve]=new Uint8Array(ge.count)),we[ve][Oe]=1}for(var Ae=0;Ae<we.length;Ae++)if(we[Ae]){var ke={data:we[Ae],type:"uint8",usage:"static"};Te[Ae]?Te[Ae](ke):Te[Ae]=M.buffer(ke),Te[Ae].data=we[Ae]}}else Te[l.addMarker(se)]=!0;return se},range:function(se,ge,_e){var Te=ge.bounds;if(Te)return se||(se=Te),ge.scale=[1/(se[2]-se[0]),1/(se[3]-se[1])],ge.translate=[-se[0],-se[1]],ge.scaleFract=c.fract(ge.scale),ge.translateFract=c.fract(ge.translate),se},viewport:function(se){return h(se||[L.drawingBufferWidth,L.drawingBufferHeight])}}]),q){var K=R.count,G=R.size,Y=R.borderSize,$=R.sizeBuffer,B=new Uint8Array(2*K);if(G.length||Y.length)for(var N=0;N<K;N++)B[2*N]=Math.round(255*(G[N]??G)/I),B[2*N+1]=Math.round(255*(Y[N]??Y)/I);$({data:B,usage:"dynamic"})}if(V){var U,j=R.count,J=R.color,X=R.borderColor,re=R.colorBuffer;if(l.tooManyColors){if(J.length||X.length){U=new Uint8Array(8*j);for(var ne=0;ne<j;ne++){var le=J[ne];U[8*ne]=S[4*le],U[8*ne+1]=S[4*le+1],U[8*ne+2]=S[4*le+2],U[8*ne+3]=S[4*le+3];var oe=X[ne];U[8*ne+4]=S[4*oe],U[8*ne+5]=S[4*oe+1],U[8*ne+6]=S[4*oe+2],U[8*ne+7]=S[4*oe+3]}}}else if(J.length||X.length){U=new Uint8Array(4*j+2);for(var de=0;de<j;de++)null!=J[de]&&(U[4*de]=J[de]%P,U[4*de+1]=Math.floor(J[de]/P)),null!=X[de]&&(U[4*de+2]=X[de]%P,U[4*de+3]=Math.floor(X[de]/P))}re({data:U||new Uint8Array(0),type:"uint8",usage:"dynamic"})}return R})}},o.prototype.addMarker=function(l){var T,_=this.markerTextures,w=this.regl,k=this.markerCache,L=null==l?0:k.indexOf(l);if(L>=0)return L;if(l instanceof Uint8Array||l instanceof Uint8ClampedArray)T=l;else{T=new Uint8Array(l.length);for(var M=0,I=l.length;M<I;M++)T[M]=255*l[M]}var P=Math.floor(Math.sqrt(T.length));return L=_.length,k.push(l),_.push(w.texture({channels:1,data:T,radius:P,mag:"linear",min:"linear"})),L},o.prototype.updateColor=function(l){var T=this.paletteIds,_=this.palette,w=this.maxColors;Array.isArray(l)||(l=[l]);var k=[];if("number"==typeof l[0]){var L=[];if(Array.isArray(l))for(var M=0;M<l.length;M+=4)L.push(l.slice(M,M+4));else for(var I=0;I<l.length;I+=4)L.push(l.subarray(I,I+4));l=L}for(var P=0;P<l.length;P++){var S=l[P];S=e(S,"uint8");var E=t(S,!1);if(null==T[E]){var z=_.length;T[E]=Math.floor(z/4),_[z]=S[0],_[z+1]=S[1],_[z+2]=S[2],_[z+3]=S[3]}k[P]=T[E]}return!this.tooManyColors&&_.length>4*w&&(this.tooManyColors=!0),this.updatePalette(_),1===k.length?k[0]:k},o.prototype.updatePalette=function(l){if(!this.tooManyColors){var T=this.maxColors,_=this.paletteTexture,w=Math.ceil(.25*l.length/T);if(w>1)for(var k=.25*(l=l.slice()).length%T;k<w*T;k++)l.push(0,0,0,0);_.height<w&&_.resize(T,w),_.subimage({width:Math.min(.25*l.length,T),height:w,data:l},0,0)}},o.prototype.destroy=function(){return this.groups.forEach(function(l){l.sizeBuffer.destroy(),l.positionBuffer.destroy(),l.positionFractBuffer.destroy(),l.colorBuffer.destroy(),l.activation.forEach(function(T){return T&&T.destroy&&T.destroy()}),l.selectionBuffer.destroy(),l.elements&&l.elements.destroy()}),this.groups.length=0,this.paletteTexture.destroy(),this.markerTextures.forEach(function(l){return l&&l.destroy&&l.destroy()}),this};var b=y("object-assign");ee.exports=function(l,T){var _=new p(l,T),w=_.render.bind(_);return b(w,{render:w,update:_.update.bind(_),draw:_.draw.bind(_),destroy:_.destroy.bind(_),regl:_.regl,gl:_.gl,canvas:_.gl.canvas,groups:_.groups,markers:_.markerCache,palette:_.palette}),w}},{"@plotly/point-cluster":59,"array-bounds":71,"color-id":87,"color-normalize":89,"flatten-vertex-data":191,glslify:227,"is-iexplorer":233,"object-assign":247,"parse-rect":249,"pick-by-alias":253,"to-float32":314,"update-diff":330}],283:[function(y,ee,Q){"use strict";var g=y("regl-scatter2d"),v=y("pick-by-alias"),m=y("array-bounds"),x=y("raf"),e=y("array-range"),n=y("parse-rect"),t=y("flatten-vertex-data");function a(i,u){if(!(this instanceof a))return new a(i,u);this.traces=[],this.passes={},this.regl=i,this.scatter=g(i),this.canvas=this.scatter.canvas}function r(i,u,f){return(null!=i.id?i.id:i)<<16|(255&u)<<8|255&f}function d(i,u,f){var c,h,p,o,b=i[u],l=i[f];return b.length>2?(c=b[1],h=b[3]):b.length?(c=b[0],h=b[1]):(c=b.y,h=b.y+b.height),l.length>2?(p=l[0],o=l[2]):l.length?(p=l[0],o=l[1]):(p=l.x,o=l.x+l.width),[p,c,o,h]}function s(i){if("number"==typeof i)return[i,i,i,i];if(2===i.length)return[i[0],i[1],i[0],i[1]];var u=n(i);return[u.x,u.y,u.x+u.width,u.y+u.height]}ee.exports=a,a.prototype.render=function(){for(var i,u=this,f=[],c=arguments.length;c--;)f[c]=arguments[c];return f.length&&(i=this).update.apply(i,f),this.regl.attributes.preserveDrawingBuffer?this.draw():(this.dirty?null==this.planned&&(this.planned=x(function(){u.draw(),u.dirty=!0,u.planned=null})):(this.draw(),this.dirty=!0,x(function(){u.dirty=!1})),this)},a.prototype.update=function(){for(var i,u=[],f=arguments.length;f--;)u[f]=arguments[f];if(u.length){for(var c=0;c<u.length;c++)this.updateItem(c,u[c]);this.traces=this.traces.filter(Boolean);for(var h=[],p=0,o=0;o<this.traces.length;o++){for(var b=this.traces[o],l=this.traces[o].passes,T=0;T<l.length;T++)h.push(this.passes[l[T]]);b.passOffset=p,p+=b.passes.length}return(i=this.scatter).update.apply(i,h),this}},a.prototype.updateItem=function(i,u){var f=this.regl;if(null===u)return this.traces[i]=null,this;if(!u)return this;var c,h=v(u,{data:"data items columns rows values dimensions samples x",snap:"snap cluster",size:"sizes size radius",color:"colors color fill fill-color fillColor",opacity:"opacity alpha transparency opaque",borderSize:"borderSizes borderSize border-size bordersize borderWidth borderWidths border-width borderwidth stroke-width strokeWidth strokewidth outline",borderColor:"borderColors borderColor bordercolor stroke stroke-color strokeColor",marker:"markers marker shape",range:"range ranges databox dataBox",viewport:"viewport viewBox viewbox",domain:"domain domains area areas",padding:"pad padding paddings pads margin margins",transpose:"transpose transposed",diagonal:"diagonal diag showDiagonal",upper:"upper up top upperhalf upperHalf showupperhalf showUpper showUpperHalf",lower:"lower low bottom lowerhalf lowerHalf showlowerhalf showLowerHalf showLower"}),p=this.traces[i]||(this.traces[i]={id:i,buffer:f.buffer({usage:"dynamic",type:"float",data:new Uint8Array}),color:"black",marker:null,size:12,borderColor:"transparent",borderSize:1,viewport:n([f._gl.drawingBufferWidth,f._gl.drawingBufferHeight]),padding:[0,0,0,0],opacity:1,diagonal:!0,upper:!0,lower:!0});if(null!=h.color&&(p.color=h.color),null!=h.size&&(p.size=h.size),null!=h.marker&&(p.marker=h.marker),null!=h.borderColor&&(p.borderColor=h.borderColor),null!=h.borderSize&&(p.borderSize=h.borderSize),null!=h.opacity&&(p.opacity=h.opacity),h.viewport&&(p.viewport=n(h.viewport)),null!=h.diagonal&&(p.diagonal=h.diagonal),null!=h.upper&&(p.upper=h.upper),null!=h.lower&&(p.lower=h.lower),h.data){p.buffer(t(h.data)),p.columns=h.data.length,p.count=h.data[0].length,p.bounds=[];for(var o=0;o<p.columns;o++)p.bounds[o]=m(h.data[o],1)}h.range&&(p.range=h.range,c=p.range&&"number"!=typeof p.range[0]),h.domain&&(p.domain=h.domain);var b=!1;null!=h.padding&&(Array.isArray(h.padding)&&h.padding.length===p.columns&&"number"==typeof h.padding[h.padding.length-1]?(p.padding=h.padding.map(s),b=!0):p.padding=s(h.padding));var l=p.columns,T=p.count,_=p.viewport.width,w=p.viewport.height,k=p.viewport.x,L=p.viewport.y,M=_/l,I=w/l;p.passes=[];for(var P=0;P<l;P++)for(var S=0;S<l;S++)if((p.diagonal||S!==P)&&(p.upper||!(P>S))&&(p.lower||!(P<S))){var E=r(p.id,P,S),z=this.passes[E]||(this.passes[E]={});if(h.data&&(z.positions=h.transpose?{x:{buffer:p.buffer,offset:S,count:T,stride:l},y:{buffer:p.buffer,offset:P,count:T,stride:l}}:{x:{buffer:p.buffer,offset:S*T,count:T},y:{buffer:p.buffer,offset:P*T,count:T}},z.bounds=d(p.bounds,P,S)),h.domain||h.viewport||h.data){var R=b?d(p.padding,P,S):p.padding;if(p.domain){var q=d(p.domain,P,S);z.viewport=[k+q[0]*_+R[0],L+q[1]*w+R[1],k+q[2]*_-R[2],L+q[3]*w-R[3]]}else z.viewport=[k+S*M+M*R[0],L+P*I+I*R[1],k+(S+1)*M-M*R[2],L+(P+1)*I-I*R[3]]}h.color&&(z.color=p.color),h.size&&(z.size=p.size),h.marker&&(z.marker=p.marker),h.borderSize&&(z.borderSize=p.borderSize),h.borderColor&&(z.borderColor=p.borderColor),h.opacity&&(z.opacity=p.opacity),h.range&&(z.range=c?d(p.range,P,S):p.range||z.bounds),p.passes.push(E)}return this},a.prototype.draw=function(){for(var i,u=[],f=arguments.length;f--;)u[f]=arguments[f];if(u.length){for(var c=[],h=0;h<u.length;h++)if("number"==typeof u[h]){var p=this.traces[u[h]],b=p.passOffset;c.push.apply(c,e(b,b+p.passes.length))}else if(u[h].length){var l=u[h],T=this.traces[h],_=T.passes,w=T.passOffset;_=_.map(function(k,L){c[w+L]=l})}(i=this.scatter).draw.apply(i,c)}else this.scatter.draw();return this},a.prototype.destroy=function(){return this.traces.forEach(function(i){i.buffer&&i.buffer.destroy&&i.buffer.destroy()}),this.traces=null,this.passes=null,this.scatter.destroy(),this}},{"array-bounds":71,"array-range":74,"flatten-vertex-data":191,"parse-rect":249,"pick-by-alias":253,raf:279,"regl-scatter2d":282}],284:[function(y,ee,Q){var v;v=function(){function g(he,ye){this.id=J++,this.type=he,this.data=ye}function v(he){return"["+function ye(Be){if(0===Be.length)return[];var Ge=Be.charAt(0),Je=Be.charAt(Be.length-1);if(1<Be.length&&Ge===Je&&('"'===Ge||"'"===Ge))return['"'+Be.substr(1,Be.length-2).replace(/\\/g,"\\\\").replace(/"/g,'\\"')+'"'];if(Ge=/\[(false|true|null|\d+|'[^']*'|"[^"]*")\]/.exec(Be))return ye(Be.substr(0,Ge.index)).concat(ye(Ge[1])).concat(ye(Be.substr(Ge.index+Ge[0].length)));if(1===(Ge=Be.split(".")).length)return['"'+Be.replace(/\\/g,"\\\\").replace(/"/g,'\\"')+'"'];for(Be=[],Je=0;Je<Ge.length;++Je)Be=Be.concat(ye(Ge[Je]));return Be}(he).join("][")+"]"}function m(he){return"string"==typeof he?he.split():he}function x(he){return"string"==typeof he?document.querySelector(he):he}function n(he,ye){for(var Be=Array(he),Ge=0;Ge<he;++Ge)Be[Ge]=ye(Ge);return Be}function t(he){var ye,Be;return ye=(65535<he)<<4,ye|=Be=(255<(he>>>=ye))<<3,(ye|=Be=(15<(he>>>=Be))<<2)|(Be=(3<(he>>>=Be))<<1)|he>>>Be>>1}function a(){function he(Ge){e:{for(var Je=16;268435456>=Je;Je*=16)if(Ge<=Je){Ge=Je;break e}Ge=0}return 0<(Je=Be[t(Ge)>>2]).length?Je.pop():new ArrayBuffer(Ge)}function ye(Ge){Be[t(Ge.byteLength)>>2].push(Ge)}var Be=n(8,function(){return[]});return{alloc:he,free:ye,allocType:function(Ge,Je){var He=null;switch(Ge){case 5120:He=new Int8Array(he(Je),0,Je);break;case 5121:He=new Uint8Array(he(Je),0,Je);break;case 5122:He=new Int16Array(he(2*Je),0,Je);break;case 5123:He=new Uint16Array(he(2*Je),0,Je);break;case 5124:He=new Int32Array(he(4*Je),0,Je);break;case 5125:He=new Uint32Array(he(4*Je),0,Je);break;case 5126:He=new Float32Array(he(4*Je),0,Je);break;default:return null}return He.length!==Je?He.subarray(0,Je):He},freeType:function(Ge){ye(Ge.buffer)}}}function r(he){return!!he&&"object"==typeof he&&Array.isArray(he.shape)&&Array.isArray(he.stride)&&"number"==typeof he.offset&&he.shape.length===he.stride.length&&(Array.isArray(he.data)||de(he.data))}function d(he,ye,Be,Ge,Je,He){for(var st=0;st<ye;++st)for(var ot=he[st],wt=0;wt<Be;++wt)for(var Ct=ot[wt],rt=0;rt<Ge;++rt)Je[He++]=Ct[rt]}function s(he){return 0|_e[Object.prototype.toString.call(he)]}function i(he,ye){for(var Be=0;Be<ye.length;++Be)he[Be]=ye[Be]}function u(he,ye,Be,Ge,Je,He,st){for(var ot=0,wt=0;wt<Be;++wt)for(var Ct=0;Ct<Ge;++Ct)he[ot++]=ye[Je*wt+He*Ct+st]}function h(he){for(var ye=le.allocType(5123,he.length),Be=0;Be<he.length;++Be)if(isNaN(he[Be]))ye[Be]=65535;else if(1/0===he[Be])ye[Be]=31744;else if(-1/0===he[Be])ye[Be]=64512;else{ke[0]=he[Be];var Ge=(He=Pe[0])>>>31<<15,Je=(He<<1>>>24)-127,He=He>>13&1023;ye[Be]=-24>Je?Ge:-14>Je?Ge+(He+1024>>-14-Je):15<Je?Ge+31744:Ge+(Je+15<<10)+He}return ye}function p(he){return Array.isArray(he)||de(he)}function o(he){return"[object "+he+"]"}function b(he){return Array.isArray(he)&&(0===he.length||"number"==typeof he[0])}function l(he){return!(!Array.isArray(he)||0===he.length||!p(he[0]))}function T(he){return Object.prototype.toString.call(he)}function _(he){if(!he)return!1;var ye=T(he);return 0<=nt.indexOf(ye)||b(he)||l(he)||r(he)}function w(he,ye){36193===he.type?(he.data=h(ye),le.freeType(ye)):he.data=ye}function k(he,ye,Be,Ge,Je,He){if(he=void 0!==xt[he]?xt[he]:ze[he]*ct[ye],He&&(he*=6),Je){for(Ge=0;1<=Be;)Ge+=he*Be*Be,Be/=2;return Ge}return he*Be*Ge}function I(){this.w=this.z=this.y=this.x=this.state=0,this.buffer=null,this.size=0,this.normalized=!1,this.type=5126,this.divisor=this.stride=this.offset=0}function z(he,ye){return he>>>ye|he<<32-ye}function R(he,ye){var Be=(65535&he)+(65535&ye);return(he>>16)+(ye>>16)+(Be>>16)<<16|65535&Be}function q(he){return Array.prototype.slice.call(he)}function V(he){return q(he).join("")}function K(he){return Array.isArray(he)||de(he)||r(he)}function G(he){return he.sort(function(ye,Be){return"viewport"===ye?-1:"viewport"===Be?1:ye<Be?-1:1})}function Y(he,ye,Be,Ge){this.thisDep=he,this.contextDep=ye,this.propDep=Be,this.append=Ge}function $(he){return he&&!(he.thisDep||he.contextDep||he.propDep)}function B(he){return new Y(!1,!1,!1,he)}function N(he,ye){var Be=he.type;if(0===Be)return new Y(!0,1<=(Be=he.data.length),2<=Be,ye);if(4===Be)return new Y((Be=he.data).thisDep,Be.contextDep,Be.propDep,ye);if(5===Be)return new Y(!1,!1,!1,ye);if(6===Be){for(var Ge=Be=!1,Je=!1,He=0;He<he.data.length;++He){var st=he.data[He];1===st.type?Je=!0:2===st.type?Ge=!0:3===st.type?Be=!0:0===st.type?(Be=!0,1<=(st=st.data)&&(Ge=!0),2<=st&&(Je=!0)):4===st.type&&(Be=Be||st.data.thisDep,Ge=Ge||st.data.contextDep,Je=Je||st.data.propDep)}return new Y(Be,Ge,Je,ye)}return new Y(3===Be,2===Be,1===Be,ye)}function U(he,ye,Be,Ge,Je,He,st,ot,wt,Ct,rt,ft,Rt,kt,Lt,Ee){function Ye(Pt){return Pt.replace(".","_")}function it(Pt,or,hr){var zr=Ye(Pt);Un.push(Pt),Fn[zr]=Hr[zr]=!!hr,vn[zr]=or}function ht(Pt,or,hr){var zr=Ye(Pt);Un.push(Pt),Array.isArray(hr)?(Hr[zr]=hr.slice(),Fn[zr]=hr.slice()):Hr[zr]=Fn[zr]=hr,Cn[zr]=or}function At(){var Pt=function W(he){function ye(){var rt=[],ft=[];return j(function(){rt.push.apply(rt,q(arguments))},{def:function(){var Rt="v"+Je++;return ft.push(Rt),0<arguments.length&&(rt.push(Rt,"="),rt.push.apply(rt,q(arguments)),rt.push(";")),Rt},toString:function(){return V([0<ft.length?"var "+ft.join(",")+";":"",V(rt)])}})}function Be(){function rt(Ee,Ye){Rt(Ee,Ye,"=",ft.def(Ee,Ye),";")}var ft=ye(),Rt=ye(),kt=ft.toString,Lt=Rt.toString;return j(function(){ft.apply(ft,q(arguments))},{def:ft.def,entry:ft,exit:Rt,save:rt,set:function(Ee,Ye,it){rt(Ee,Ye),ft(Ee,Ye,"=",it,";")},toString:function(){return kt()+Lt()}})}var Ge=he&&he.cache,Je=0,He=[],st=[],ot=[],wt=ye(),Ct={};return{global:wt,link:function(rt,ft){var Rt=ft&&ft.stable;if(!Rt)for(var kt=0;kt<st.length;++kt)if(st[kt]===rt&&!ot[kt])return He[kt];return kt="g"+Je++,He.push(kt),st.push(rt),ot.push(Rt),kt},block:ye,proc:function(rt,ft){function Rt(){var Ye="a"+kt.length;return kt.push(Ye),Ye}var kt=[];ft=ft||0;for(var Lt=0;Lt<ft;++Lt)Rt();var Ee=(Lt=Be()).toString;return Ct[rt]=j(Lt,{arg:Rt,toString:function(){return V(["function(",kt.join(),"){",Ee(),"}"])}})},scope:Be,cond:function(){var rt=V(arguments),ft=Be(),Rt=Be(),kt=ft.toString,Lt=Rt.toString;return j(ft,{then:function(){return ft.apply(ft,q(arguments)),this},else:function(){return Rt.apply(Rt,q(arguments)),this},toString:function(){var Ee=Lt();return Ee&&(Ee="else{"+Ee+"}"),V(["if(",rt,"){",kt(),"}",Ee])}})},compile:function(){var rt=['"use strict";',wt,"return {"];Object.keys(Ct).forEach(function(kt){rt.push('"',kt,'":',Ct[kt].toString(),",")}),rt.push("}");var ft,Rt=V(rt).replace(/;/g,";\n").replace(/}/g,"}\n").replace(/{/g,"{\n");return Ge&&(ft=function(kt){for(var Lt,Ee="",Ye=0;Ye<kt.length;Ye++)Lt=kt.charCodeAt(Ye),Ee+="0123456789abcdef".charAt(Lt>>>4&15)+"0123456789abcdef".charAt(15&Lt);return Ee}(function(kt){for(var Lt=Array(kt.length>>2),Ee=0;Ee<Lt.length;Ee++)Lt[Ee]=0;for(Ee=0;Ee<8*kt.length;Ee+=8)Lt[Ee>>5]|=(255&kt.charCodeAt(Ee/8))<<24-Ee%32;var Ye,it,ht,At,Ft,Gt,jt,fr,kr,ur,Jt,$t=8*kt.length;for(kt=[1779033703,-1150833019,1013904242,-1521486534,1359893119,-1694144372,528734635,1541459225],Ee=Array(64),Lt[$t>>5]|=128<<24-$t%32,Lt[15+($t+64>>9<<4)]=$t,fr=0;fr<Lt.length;fr+=16){for($t=kt[0],Ye=kt[1],it=kt[2],ht=kt[3],At=kt[4],Ft=kt[5],Gt=kt[6],jt=kt[7],kr=0;64>kr;kr++){var Qt;16>kr?Ee[kr]=Lt[kr+fr]:(ur=kr,Jt=R(Jt=z(Jt=Ee[kr-2],17)^z(Jt,19)^Jt>>>10,Ee[kr-7]),Qt=z(Qt=Ee[kr-15],7)^z(Qt,18)^Qt>>>3,Ee[ur]=R(R(Jt,Qt),Ee[kr-16])),ur=R(R(R(R(jt,ur=z(ur=At,6)^z(ur,11)^z(ur,25)),At&Ft^~At&Gt),Bt[kr]),Ee[kr]),Jt=R(jt=z(jt=$t,2)^z(jt,13)^z(jt,22),$t&Ye^$t&it^Ye&it),jt=Gt,Gt=Ft,Ft=At,At=R(ht,ur),ht=it,it=Ye,Ye=$t,$t=R(ur,Jt)}kt[0]=R($t,kt[0]),kt[1]=R(Ye,kt[1]),kt[2]=R(it,kt[2]),kt[3]=R(ht,kt[3]),kt[4]=R(At,kt[4]),kt[5]=R(Ft,kt[5]),kt[6]=R(Gt,kt[6]),kt[7]=R(jt,kt[7])}for(Lt="",Ee=0;Ee<32*kt.length;Ee+=8)Lt+=String.fromCharCode(kt[Ee>>5]>>>24-Ee%32&255);return Lt}(function(kt){for(var Lt,Ee,Ye="",it=-1;++it<kt.length;)Lt=kt.charCodeAt(it),Ee=it+1<kt.length?kt.charCodeAt(it+1):0,55296<=Lt&&56319>=Lt&&56320<=Ee&&57343>=Ee&&(Lt=65536+((1023&Lt)<<10)+(1023&Ee),it++),127>=Lt?Ye+=String.fromCharCode(Lt):2047>=Lt?Ye+=String.fromCharCode(192|Lt>>>6&31,128|63&Lt):65535>=Lt?Ye+=String.fromCharCode(224|Lt>>>12&15,128|Lt>>>6&63,128|63&Lt):2097151>=Lt&&(Ye+=String.fromCharCode(240|Lt>>>18&7,128|Lt>>>12&63,128|Lt>>>6&63,128|63&Lt));return Ye}(Rt))),Ge[ft])?Ge[ft].apply(null,st):(Rt=Function.apply(null,He.concat(Rt)),Ge&&(Ge[ft]=Rt),Rt.apply(null,st))}}}({cache:Lt}),or=Pt.link,hr=Pt.global;Pt.id=mr++,Pt.batchId="0";var zr=or(li),Dr=Pt.shared={props:"a0"};Object.keys(li).forEach(function(wr){Dr[wr]=hr.def(zr,".",wr)});var Ir=Pt.next={},Mr=Pt.current={};Object.keys(Cn).forEach(function(wr){Array.isArray(Hr[wr])&&(Ir[wr]=hr.def(Dr.next,".",wr),Mr[wr]=hr.def(Dr.current,".",wr))});var vr=Pt.constants={};Object.keys(tr).forEach(function(wr){vr[wr]=hr.def(JSON.stringify(tr[wr]))}),Pt.invoke=function(wr,Er){switch(Er.type){case 0:var qr=["this",Dr.context,Dr.props,Pt.batchId];return wr.def(or(Er.data),".call(",qr.slice(0,Math.max(Er.data.length+1,4)),")");case 1:return wr.def(Dr.props,Er.data);case 2:return wr.def(Dr.context,Er.data);case 3:return wr.def("this",Er.data);case 4:return Er.data.append(Pt,wr),Er.data.ref;case 5:return Er.data.toString();case 6:return Er.data.map(function(Vr){return Pt.invoke(wr,Vr)})}},Pt.attribCache={};var xr={};return Pt.scopeAttrib=function(wr){if((wr=ye.id(wr))in xr)return xr[wr];var Er=Ct.scope[wr];return Er||(Er=Ct.scope[wr]=new An),xr[wr]=or(Er)},Pt}function kr(Pt,or,hr,zr,Dr){function Ir(mn){var xn=vr[mn];xn&&(wr[mn]=xn)}var mn,bn,Sn,In,Mr=function(mn,xn){if("string"==typeof(bn=mn.static).frag&&"string"==typeof bn.vert){if(0<Object.keys(xn.dynamic).length)return null;var bn=xn.static,Sn=Object.keys(bn);if(0<Sn.length&&"number"==typeof bn[Sn[0]]){for(var In=[],Yn=0;Yn<Sn.length;++Yn)In.push([0|bn[Sn[Yn]],Sn[Yn]]);return In}}return null}(Pt,or),vr=function(mn,xn,bn){function Sn(Ti){if(Ti in In){var kn=In[Ti];Ti=!0;var Qn,Jn,Ii=0|kn.x,ha=0|kn.y;return"width"in kn?Qn=0|kn.width:Ti=!1,"height"in kn?Jn=0|kn.height:Ti=!1,new Y(!Ti&&xn&&xn.thisDep,!Ti&&xn&&xn.contextDep,!Ti&&xn&&xn.propDep,function(oo,Gi){var Zi=oo.shared.context,Ya=Qn;"width"in kn||(Ya=Gi.def(Zi,".","framebufferWidth","-",Ii));var Fi=Jn;return"height"in kn||(Fi=Gi.def(Zi,".","framebufferHeight","-",ha)),[Ii,ha,Ya,Fi]})}if(Ti in Yn){var Ia=Yn[Ti];return Ti=N(Ia,function(oo,Gi){var Zi=oo.invoke(Gi,Ia),Ya=oo.shared.context,Fi=Gi.def(Zi,".x|0"),so=Gi.def(Zi,".y|0");return[Fi,so,Gi.def('"width" in ',Zi,"?",Zi,".width|0:","(",Ya,".","framebufferWidth","-",Fi,")"),Zi=Gi.def('"height" in ',Zi,"?",Zi,".height|0:","(",Ya,".","framebufferHeight","-",so,")")]}),xn&&(Ti.thisDep=Ti.thisDep||xn.thisDep,Ti.contextDep=Ti.contextDep||xn.contextDep,Ti.propDep=Ti.propDep||xn.propDep),Ti}return xn?new Y(xn.thisDep,xn.contextDep,xn.propDep,function(oo,Gi){var Zi=oo.shared.context;return[0,0,Gi.def(Zi,".","framebufferWidth"),Gi.def(Zi,".","framebufferHeight")]}):null}var In=mn.static,Yn=mn.dynamic;if(mn=Sn("viewport")){var ki=mn;mn=new Y(mn.thisDep,mn.contextDep,mn.propDep,function(Ti,kn){var Qn=ki.append(Ti,kn),Jn=Ti.shared.context;return kn.set(Jn,".viewportWidth",Qn[2]),kn.set(Jn,".viewportHeight",Qn[3]),Qn})}return{viewport:mn,scissor_box:Sn("scissor.box")}}(Pt,qr=function Ft(Pt,or){var hr=Pt.static,zr=Pt.dynamic;if("framebuffer"in hr){var Dr=hr.framebuffer;return Dr?(Dr=ot.getFramebuffer(Dr),B(function(Mr,vr){var xr=Mr.link(Dr),wr=Mr.shared;return vr.set(wr.framebuffer,".next",xr),vr.set(wr=wr.context,".framebufferWidth",xr+".width"),vr.set(wr,".framebufferHeight",xr+".height"),xr})):B(function(Mr,vr){var xr=Mr.shared;return vr.set(xr.framebuffer,".next","null"),vr.set(xr=xr.context,".framebufferWidth",xr+".drawingBufferWidth"),vr.set(xr,".framebufferHeight",xr+".drawingBufferHeight"),"null"})}if("framebuffer"in zr){var Ir=zr.framebuffer;return N(Ir,function(Mr,vr){var xr=Mr.invoke(vr,Ir),wr=Mr.shared,Er=wr.framebuffer;return xr=vr.def(Er,".getFramebuffer(",xr,")"),vr.set(Er,".next",xr),vr.set(wr=wr.context,".framebufferWidth",xr+"?"+xr+".width:"+wr+".drawingBufferWidth"),vr.set(wr,".framebufferHeight",xr+"?"+xr+".height:"+wr+".drawingBufferHeight"),xr})}return null}(Pt)),xr=function jt(Pt,or){function hr(en,mn){if(en in zr){var xn=0|zr[en];return mn?Ir.offset=xn:Ir.instances=xn,B(function(Sn,In){return mn&&(Sn.OFFSET=xn),xn})}if(en in Dr){var bn=Dr[en];return N(bn,function(Sn,In){var Yn=Sn.invoke(In,bn);return mn&&(Sn.OFFSET=Yn),Yn})}if(mn){if(xr)return B(function(Sn,In){return Sn.OFFSET=0});if(Mr)return new Y(vr.thisDep,vr.contextDep,vr.propDep,function(Sn,In){return In.def(Sn.shared.vao+".currentVAO?"+Sn.shared.vao+".currentVAO.offset:0")})}else if(Mr)return new Y(vr.thisDep,vr.contextDep,vr.propDep,function(Sn,In){return In.def(Sn.shared.vao+".currentVAO?"+Sn.shared.vao+".currentVAO.instances:-1")});return null}var zr=Pt.static,Dr=Pt.dynamic,Ir={},Mr=!1,vr=function(){if("vao"in zr){var en=zr.vao;return null!==en&&null===Ct.getVAO(en)&&(en=Ct.createVAO(en)),Mr=!0,Ir.vao=en,B(function(xn){var bn=Ct.getVAO(en);return bn?xn.link(bn):"null"})}if("vao"in Dr){Mr=!0;var mn=Dr.vao;return N(mn,function(xn,bn){var Sn=xn.invoke(bn,mn);return bn.def(xn.shared.vao+".getVAO("+Sn+")")})}return null}(),xr=!1,wr=function(){if("elements"in zr){var en=zr.elements;if(Ir.elements=en,K(en)){var mn=Ir.elements=He.create(en,!0);en=He.getElements(mn),xr=!0}else en&&(en=He.getElements(en),xr=!0);return(mn=B(function(bn,Sn){if(en){var In=bn.link(en);return bn.ELEMENTS=In}return bn.ELEMENTS=null})).value=en,mn}if("elements"in Dr){xr=!0;var xn=Dr.elements;return N(xn,function(bn,Sn){var In=(Yn=bn.shared).isBufferArgs,Yn=Yn.elements,ki=bn.invoke(Sn,xn),Ti=Sn.def("null");return In=Sn.def(In,"(",ki,")"),ki=bn.cond(In).then(Ti,"=",Yn,".createStream(",ki,");").else(Ti,"=",Yn,".getElements(",ki,");"),Sn.entry(ki),Sn.exit(bn.cond(In).then(Yn,".destroyStream(",Ti,");")),bn.ELEMENTS=Ti})}return Mr?new Y(vr.thisDep,vr.contextDep,vr.propDep,function(bn,Sn){return Sn.def(bn.shared.vao+".currentVAO?"+bn.shared.elements+".getElements("+bn.shared.vao+".currentVAO.elements):null")}):null}(),Er=hr("offset",!0),qr=function(){if("primitive"in zr){var en=zr.primitive;return Ir.primitive=en,B(function(xn,bn){return Ae[en]})}if("primitive"in Dr){var mn=Dr.primitive;return N(mn,function(xn,bn){var Sn=xn.constants.primTypes,In=xn.invoke(bn,mn);return bn.def(Sn,"[",In,"]")})}return xr?$(wr)?B(wr.value?function(xn,bn){return bn.def(xn.ELEMENTS,".primType")}:function(){return 4}):new Y(wr.thisDep,wr.contextDep,wr.propDep,function(xn,bn){var Sn=xn.ELEMENTS;return bn.def(Sn,"?",Sn,".primType:",4)}):Mr?new Y(vr.thisDep,vr.contextDep,vr.propDep,function(xn,bn){return bn.def(xn.shared.vao+".currentVAO?"+xn.shared.vao+".currentVAO.primitive:4")}):null}(),Vr=function(){if("count"in zr){var en=0|zr.count;return Ir.count=en,B(function(){return en})}if("count"in Dr){var mn=Dr.count;return N(mn,function(xn,bn){return xn.invoke(bn,mn)})}return xr?$(wr)?wr?Er?new Y(Er.thisDep,Er.contextDep,Er.propDep,function(xn,bn){return bn.def(xn.ELEMENTS,".vertCount-",xn.OFFSET)}):B(function(xn,bn){return bn.def(xn.ELEMENTS,".vertCount")}):B(function(){return-1}):new Y(wr.thisDep||Er.thisDep,wr.contextDep||Er.contextDep,wr.propDep||Er.propDep,function(xn,bn){var Sn=xn.ELEMENTS;return xn.OFFSET?bn.def(Sn,"?",Sn,".vertCount-",xn.OFFSET,":-1"):bn.def(Sn,"?",Sn,".vertCount:-1")}):Mr?new Y(vr.thisDep,vr.contextDep,vr.propDep,function(xn,bn){return bn.def(xn.shared.vao,".currentVAO?",xn.shared.vao,".currentVAO.count:-1")}):null}(),Qr=hr("instances",!1);return{elements:wr,primitive:qr,count:Vr,instances:Qr,offset:Er,vao:vr,vaoActive:Mr,elementsActive:xr,static:Ir}}(Pt),wr=(bn=(mn=Pt).static,Sn=mn.dynamic,In={},Un.forEach(function(Yn){function ki(kn,Qn){if(Yn in bn){var Jn=kn(bn[Yn]);In[Ti]=B(function(){return Jn})}else if(Yn in Sn){var Ii=Sn[Yn];In[Ti]=N(Ii,function(ha,Ia){return Qn(ha,Ia,ha.invoke(Ia,Ii))})}}var Ti=Ye(Yn);switch(Yn){case"cull.enable":case"blend.enable":case"dither":case"stencil.enable":case"depth.enable":case"scissor.enable":case"polygonOffset.enable":case"sample.alpha":case"sample.enable":case"depth.mask":case"lineWidth":return ki(function(kn){return kn},function(kn,Qn,Jn){return Jn});case"depth.func":return ki(function(kn){return rr[kn]},function(kn,Qn,Jn){return Qn.def(kn.constants.compareFuncs,"[",Jn,"]")});case"depth.range":return ki(function(kn){return kn},function(kn,Qn,Jn){return[Qn.def("+",Jn,"[0]"),Qn=Qn.def("+",Jn,"[1]")]});case"blend.func":return ki(function(kn){return[Wt["srcRGB"in kn?kn.srcRGB:kn.src],Wt["dstRGB"in kn?kn.dstRGB:kn.dst],Wt["srcAlpha"in kn?kn.srcAlpha:kn.src],Wt["dstAlpha"in kn?kn.dstAlpha:kn.dst]]},function(kn,Qn,Jn){function Ii(Gi,Zi){return Qn.def('"',Gi,Zi,'" in ',Jn,"?",Jn,".",Gi,Zi,":",Jn,".",Gi)}kn=kn.constants.blendFuncs;var ha=Ii("src","RGB"),Ia=Ii("dst","RGB"),oo=(ha=Qn.def(kn,"[",ha,"]"),Qn.def(kn,"[",Ii("src","Alpha"),"]"));return[ha,Ia=Qn.def(kn,"[",Ia,"]"),oo,kn=Qn.def(kn,"[",Ii("dst","Alpha"),"]")]});case"blend.equation":return ki(function(kn){return"string"==typeof kn?[Zn[kn],Zn[kn]]:"object"==typeof kn?[Zn[kn.rgb],Zn[kn.alpha]]:void 0},function(kn,Qn,Jn){var Ii=kn.constants.blendEquations,ha=Qn.def(),Ia=Qn.def();return(kn=kn.cond("typeof ",Jn,'==="string"')).then(ha,"=",Ia,"=",Ii,"[",Jn,"];"),kn.else(ha,"=",Ii,"[",Jn,".rgb];",Ia,"=",Ii,"[",Jn,".alpha];"),Qn(kn),[ha,Ia]});case"blend.color":return ki(function(kn){return n(4,function(Qn){return+kn[Qn]})},function(kn,Qn,Jn){return n(4,function(Ii){return Qn.def("+",Jn,"[",Ii,"]")})});case"stencil.mask":return ki(function(kn){return 0|kn},function(kn,Qn,Jn){return Qn.def(Jn,"|0")});case"stencil.func":return ki(function(kn){return[rr[kn.cmp||"keep"],kn.ref||0,"mask"in kn?kn.mask:-1]},function(kn,Qn,Jn){return[kn=Qn.def('"cmp" in ',Jn,"?",kn.constants.compareFuncs,"[",Jn,".cmp]",":",7680),Qn.def(Jn,".ref|0"),Qn=Qn.def('"mask" in ',Jn,"?",Jn,".mask|0:-1")]});case"stencil.opFront":case"stencil.opBack":return ki(function(kn){return["stencil.opBack"===Yn?1029:1028,Ht[kn.fail||"keep"],Ht[kn.zfail||"keep"],Ht[kn.zpass||"keep"]]},function(kn,Qn,Jn){function Ii(Ia){return Qn.def('"',Ia,'" in ',Jn,"?",ha,"[",Jn,".",Ia,"]:",7680)}var ha=kn.constants.stencilOps;return["stencil.opBack"===Yn?1029:1028,Ii("fail"),Ii("zfail"),Ii("zpass")]});case"polygonOffset.offset":return ki(function(kn){return[0|kn.factor,0|kn.units]},function(kn,Qn,Jn){return[Qn.def(Jn,".factor|0"),Qn=Qn.def(Jn,".units|0")]});case"cull.face":return ki(function(kn){var Qn=0;return"front"===kn?Qn=1028:"back"===kn&&(Qn=1029),Qn},function(kn,Qn,Jn){return Qn.def(Jn,'==="front"?',1028,":",1029)});case"frontFace":return ki(function(kn){return Ve[kn]},function(kn,Qn,Jn){return Qn.def(Jn+'==="cw"?2304:2305')});case"colorMask":return ki(function(kn){return kn.map(function(Qn){return!!Qn})},function(kn,Qn,Jn){return n(4,function(Ii){return"!!"+Jn+"["+Ii+"]"})});case"sample.coverage":return ki(function(kn){return["value"in kn?kn.value:1,!!kn.invert]},function(kn,Qn,Jn){return[Qn.def('"value" in ',Jn,"?+",Jn,".value:1"),Qn=Qn.def("!!",Jn,".invert")]})}}),In),Er=function Gt(Pt,or,hr){function zr(wr){if(wr in Dr){var Er=ye.id(Dr[wr]);return(wr=B(function(){return Er})).id=Er,wr}if(wr in Ir){var qr=Ir[wr];return N(qr,function(Vr,Qr){var en=Vr.invoke(Qr,qr);return Qr.def(Vr.shared.strings,".id(",en,")")})}return null}var Dr=Pt.static,Ir=Pt.dynamic,Mr=zr("frag"),vr=zr("vert"),xr=null;return $(Mr)&&$(vr)?(xr=rt.program(vr.id,Mr.id,null,hr),Pt=B(function(wr,Er){return wr.link(xr)})):Pt=new Y(Mr&&Mr.thisDep||vr&&vr.thisDep,Mr&&Mr.contextDep||vr&&vr.contextDep,Mr&&Mr.propDep||vr&&vr.propDep,function(wr,Er){var qr,Vr,Qr=wr.shared.shader;return qr=Mr?Mr.append(wr,Er):Er.def(Qr,".","frag"),Vr=vr?vr.append(wr,Er):Er.def(Qr,".","vert"),Er.def(Qr+".program("+Vr+","+qr+")")}),{frag:Mr,vert:vr,progVar:Pt,program:xr}}(Pt,0,Mr);Ir("viewport"),Ir(Ye("scissor.box"));var qr,Vr=0<Object.keys(wr).length;if((qr={framebuffer:qr,draw:xr,shader:Er,state:wr,dirty:Vr,scopeVAO:null,drawVAO:null,useVAO:!1,attributes:{}}).profile=function(mn){var xn,bn=mn.static;if(mn=mn.dynamic,"profile"in bn){var Sn=!!bn.profile;(xn=B(function(Yn,ki){return Sn})).enable=Sn}else if("profile"in mn){var In=mn.profile;xn=N(In,function(Yn,ki){return Yn.invoke(ki,In)})}return xn}(Pt),qr.uniforms=function(mn,xn){var bn=mn.static,Sn=mn.dynamic,In={};return Object.keys(bn).forEach(function(Yn){var ki,Ti=bn[Yn];if("number"==typeof Ti||"boolean"==typeof Ti)ki=B(function(){return Ti});else if("function"==typeof Ti){var kn=Ti._reglType;"texture2d"===kn||"textureCube"===kn?ki=B(function(Qn){return Qn.link(Ti)}):"framebuffer"!==kn&&"framebufferCube"!==kn||(ki=B(function(Qn){return Qn.link(Ti.color[0])}))}else p(Ti)&&(ki=B(function(Qn){return Qn.global.def("[",n(Ti.length,function(Jn){return Ti[Jn]}),"]")}));ki.value=Ti,In[Yn]=ki}),Object.keys(Sn).forEach(function(Yn){var ki=Sn[Yn];In[Yn]=N(ki,function(Ti,kn){return Ti.invoke(kn,ki)})}),In}(hr),qr.drawVAO=qr.scopeVAO=xr.vao,!qr.drawVAO&&Er.program&&!Mr&&Be.angle_instanced_arrays&&xr.static.elements){var Qr=!0;if(Pt=Er.program.attributes.map(function(mn){return mn=or.static[mn],Qr=Qr&&!!mn,mn}),Qr&&0<Pt.length){var en=Ct.getVAO(Ct.createVAO({attributes:Pt,elements:xr.static.elements}));qr.drawVAO=new Y(null,null,null,function(mn,xn){return mn.link(en)}),qr.useVAO=!0}}return Mr?qr.useVAO=!0:qr.attributes=function fr(Pt,or){var hr=Pt.static,zr=Pt.dynamic,Dr={};return Object.keys(hr).forEach(function(Ir){var Mr=hr[Ir],vr=ye.id(Ir),xr=new An;if(K(Mr))xr.state=1,xr.buffer=Je.getBuffer(Je.create(Mr,34962,!1,!0)),xr.type=0;else if(Er=Je.getBuffer(Mr))xr.state=1,xr.buffer=Er,xr.type=0;else if("constant"in Mr){var wr=Mr.constant;xr.buffer="null",xr.state=2,"number"==typeof wr?xr.x=wr:Ut.forEach(function(xn,bn){bn<wr.length&&(xr[xn]=wr[bn])})}else{var Er=K(Mr.buffer)?Je.getBuffer(Je.create(Mr.buffer,34962,!1,!0)):Je.getBuffer(Mr.buffer),qr=0|Mr.offset,Vr=0|Mr.stride,Qr=0|Mr.size,en=!!Mr.normalized,mn=0;"type"in Mr&&(mn=Te[Mr.type]),Mr=0|Mr.divisor,xr.buffer=Er,xr.state=1,xr.size=Qr,xr.normalized=en,xr.type=mn||Er.dtype,xr.offset=qr,xr.stride=Vr,xr.divisor=Mr}Dr[Ir]=B(function(xn,bn){var Sn=xn.attribCache;if(vr in Sn)return Sn[vr];var In={isStream:!1};return Object.keys(xr).forEach(function(Yn){In[Yn]=xr[Yn]}),xr.buffer&&(In.buffer=xn.link(xr.buffer),In.type=In.type||In.buffer+".dtype"),Sn[vr]=In})}),Object.keys(zr).forEach(function(Ir){var Mr=zr[Ir];Dr[Ir]=N(Mr,function(vr,xr){function wr(Sn){xr(en[Sn],"=",Er,".",Sn,"|0;")}var Er=vr.invoke(xr,Mr),qr=vr.shared,Vr=vr.constants,Qr=qr.isBufferArgs,en=(qr=qr.buffer,{isStream:xr.def(!1)}),mn=new An;mn.state=1,Object.keys(mn).forEach(function(Sn){en[Sn]=xr.def(""+mn[Sn])});var xn=en.buffer,bn=en.type;return xr("if(",Qr,"(",Er,")){",en.isStream,"=true;",xn,"=",qr,".createStream(",34962,",",Er,");",bn,"=",xn,".dtype;","}else{",xn,"=",qr,".getBuffer(",Er,");","if(",xn,"){",bn,"=",xn,".dtype;",'}else if("constant" in ',Er,"){",en.state,"=",2,";","if(typeof "+Er+'.constant === "number"){',en[Ut[0]],"=",Er,".constant;",Ut.slice(1).map(function(Sn){return en[Sn]}).join("="),"=0;","}else{",Ut.map(function(Sn,In){return en[Sn]+"="+Er+".constant.length>"+In+"?"+Er+".constant["+In+"]:0;"}).join(""),"}}else{","if(",Qr,"(",Er,".buffer)){",xn,"=",qr,".createStream(",34962,",",Er,".buffer);","}else{",xn,"=",qr,".getBuffer(",Er,".buffer);","}",bn,'="type" in ',Er,"?",Vr.glTypes,"[",Er,".type]:",xn,".dtype;",en.normalized,"=!!",Er,".normalized;"),wr("size"),wr("offset"),wr("stride"),wr("divisor"),xr("}}"),xr.exit("if(",en.isStream,"){",qr,".destroyStream(",xn,");","}"),en})}),Dr}(or),qr.context=function(mn){var xn=mn.static,bn=mn.dynamic,Sn={};return Object.keys(xn).forEach(function(In){var Yn=xn[In];Sn[In]=B(function(ki,Ti){return"number"==typeof Yn||"boolean"==typeof Yn?""+Yn:ki.link(Yn)})}),Object.keys(bn).forEach(function(In){var Yn=bn[In];Sn[In]=N(Yn,function(ki,Ti){return ki.invoke(Ti,Yn)})}),Sn}(zr),qr}function ur(Pt,or,hr){var zr=Pt.shared.context,Dr=Pt.scope();Object.keys(hr).forEach(function(Ir){or.save(zr,"."+Ir);var Mr=hr[Ir].append(Pt,or);Array.isArray(Mr)?Dr(zr,".",Ir,"=[",Mr.join(),"];"):Dr(zr,".",Ir,"=",Mr,";")}),or(Dr)}function Jt(Pt,or,hr,zr){var Dr,Ir=(vr=Pt.shared).gl,Mr=vr.framebuffer;hn&&(Dr=or.def(vr.extensions,".webgl_draw_buffers"));var vr=(xr=Pt.constants).drawBuffer,xr=xr.backBuffer;Pt=hr?hr.append(Pt,or):or.def(Mr,".next"),zr||or("if(",Pt,"!==",Mr,".cur){"),or("if(",Pt,"){",Ir,".bindFramebuffer(",36160,",",Pt,".framebuffer);"),hn&&or(Dr,".drawBuffersWEBGL(",vr,"[",Pt,".colorAttachments.length]);"),or("}else{",Ir,".bindFramebuffer(",36160,",null);"),hn&&or(Dr,".drawBuffersWEBGL(",xr,");"),or("}",Mr,".cur=",Pt,";"),zr||or("}")}function $t(Pt,or,hr){var zr=Pt.shared,Dr=zr.gl,Ir=Pt.current,Mr=Pt.next,vr=zr.current,xr=zr.next,wr=Pt.cond(vr,".dirty");Un.forEach(function(Er){var qr,Vr;if(!((Er=Ye(Er))in hr.state))if(Er in Mr){qr=Mr[Er],Vr=Ir[Er];var Qr=n(Hr[Er].length,function(en){return wr.def(qr,"[",en,"]")});wr(Pt.cond(Qr.map(function(en,mn){return en+"!=="+Vr+"["+mn+"]"}).join("||")).then(Dr,".",Cn[Er],"(",Qr,");",Qr.map(function(en,mn){return Vr+"["+mn+"]="+en}).join(";"),";"))}else qr=wr.def(xr,".",Er),Qr=Pt.cond(qr,"!==",vr,".",Er),wr(Qr),Er in vn?Qr(Pt.cond(qr).then(Dr,".enable(",vn[Er],");").else(Dr,".disable(",vn[Er],");"),vr,".",Er,"=",qr,";"):Qr(Dr,".",Cn[Er],"(",qr,");",vr,".",Er,"=",qr,";")}),0===Object.keys(hr.state).length&&wr(vr,".dirty=false;"),or(wr)}function Qt(Pt,or,hr,zr){var Dr,Ir=Pt.shared,Mr=Pt.current,vr=Ir.current,xr=Ir.gl;G(Object.keys(hr)).forEach(function(wr){var Er=hr[wr];if(!zr||zr(Er)){var qr=Er.append(Pt,or);if(vn[wr]){var Vr=vn[wr];$(Er)?(Dr=Pt.link(qr,{stable:!0}),or(Pt.cond(Dr).then(xr,".enable(",Vr,");").else(xr,".disable(",Vr,");")),or(vr,".",wr,"=",Dr,";")):(or(Pt.cond(qr).then(xr,".enable(",Vr,");").else(xr,".disable(",Vr,");")),or(vr,".",wr,"=",qr,";"))}else if(p(qr)){var Qr=Mr[wr];or(xr,".",Cn[wr],"(",qr,");",qr.map(function(en,mn){return Qr+"["+mn+"]="+en}).join(";"),";")}else $(Er)?(Dr=Pt.link(qr,{stable:!0}),or(xr,".",Cn[wr],"(",Dr,");",vr,".",wr,"=",Dr,";")):or(xr,".",Cn[wr],"(",qr,");",vr,".",wr,"=",qr,";")}})}function cr(Pt,or){Rr&&(Pt.instancing=or.def(Pt.shared.extensions,".angle_instanced_arrays"))}function gr(Pt,or,hr,zr,Dr){function Ir(){return typeof performance>"u"?"Date.now()":"performance.now()"}function Mr(mn){mn(wr=or.def(),"=",Ir(),";"),"string"==typeof Dr?mn(Vr,".count+=",Dr,";"):mn(Vr,".count++;"),kt&&(zr?mn(Er=or.def(),"=",en,".getNumPendingQueries();"):mn(en,".beginQuery(",Vr,");"))}function vr(mn){mn(Vr,".cpuTime+=",Ir(),"-",wr,";"),kt&&(zr?mn(en,".pushScopeStats(",Er,",",en,".getNumPendingQueries(),",Vr,");"):mn(en,".endQuery();"))}function xr(mn){var xn=or.def(Qr,".profile");or(Qr,".profile=",mn,";"),or.exit(Qr,".profile=",xn,";")}var wr,Er,qr=Pt.shared,Vr=Pt.stats,Qr=qr.current,en=qr.timer;if(hr=hr.profile){if($(hr))return void(hr.enable?(Mr(or),vr(or.exit),xr("true")):xr("false"));xr(hr=hr.append(Pt,or))}else hr=or.def(Qr,".profile");Mr(qr=Pt.block()),or("if(",hr,"){",qr,"}"),vr(Pt=Pt.block()),or.exit("if(",hr,"){",Pt,"}")}function Tr(Pt,or,hr,zr,Dr){var Mr=Pt.shared;zr.forEach(function(vr){var xr,wr=vr.name,Er=hr.attributes[wr];if(Er){if(!Dr(Er))return;xr=Er.append(Pt,or)}else{if(!Dr(We))return;var qr=Pt.scopeAttrib(wr);xr={},Object.keys(new An).forEach(function(Vr){xr[Vr]=or.def(qr,".",Vr)})}!function Ir(vr,xr,wr){function Er(){or("if(!",en,".buffer){",Vr,".enableVertexAttribArray(",Qr,");}");var Sn,In=wr.type;Sn=wr.size?or.def(wr.size,"||",xr):xr,or("if(",en,".type!==",In,"||",en,".size!==",Sn,"||",bn.map(function(Yn){return en+"."+Yn+"!=="+wr[Yn]}).join("||"),"){",Vr,".bindBuffer(",34962,",",mn,".buffer);",Vr,".vertexAttribPointer(",[Qr,Sn,In,wr.normalized,wr.stride,wr.offset],");",en,".type=",In,";",en,".size=",Sn,";",bn.map(function(Yn){return en+"."+Yn+"="+wr[Yn]+";"}).join(""),"}"),Rr&&or("if(",en,".divisor!==",In=wr.divisor,"){",Pt.instancing,".vertexAttribDivisorANGLE(",[Qr,In],");",en,".divisor=",In,";}")}function qr(){or("if(",en,".buffer){",Vr,".disableVertexAttribArray(",Qr,");",en,".buffer=null;","}if(",Ut.map(function(Sn,In){return en+"."+Sn+"!=="+xn[In]}).join("||"),"){",Vr,".vertexAttrib4f(",Qr,",",xn,");",Ut.map(function(Sn,In){return en+"."+Sn+"="+xn[In]+";"}).join(""),"}")}var Vr=Mr.gl,Qr=or.def(vr,".location"),en=or.def(Mr.attributes,"[",Qr,"]"),mn=wr.buffer,xn=[wr.x,wr.y,wr.z,wr.w],bn=["buffer","normalized","offset","stride"];1===(vr=wr.state)?Er():2===vr?qr():(or("if(",vr,"===",1,"){"),Er(),or("}else{"),qr(),or("}"))}(Pt.link(vr),function(Vr){switch(Vr){case 35664:case 35667:case 35671:return 2;case 35665:case 35668:case 35672:return 3;case 35666:case 35669:case 35673:return 4;default:return 1}}(vr.info.type),xr)})}function Fr(Pt,or,hr,zr,Dr,Ir){for(var Mr,vr=Pt.shared,xr=vr.gl,wr=0;wr<zr.length;++wr){var Er,qr=(en=zr[wr]).name,Vr=en.info.type,Qr=hr.uniforms[qr],en=Pt.link(en)+".location";if(Qr){if(!Dr(Qr))continue;if($(Qr)){if(qr=Qr.value,35678===Vr||35680===Vr)or(xr,".uniform1i(",en,",",(Vr=Pt.link(qr._texture||qr.color[0]._texture))+".bind());"),or.exit(Vr,".unbind();");else if(35674===Vr||35675===Vr||35676===Vr)Qr=2,35675===Vr?Qr=3:35676===Vr&&(Qr=4),or(xr,".uniformMatrix",Qr,"fv(",en,",false,",qr=Pt.global.def("new Float32Array(["+Array.prototype.slice.call(qr)+"])"),");");else{switch(Vr){case 5126:Mr="1f";break;case 35664:Mr="2f";break;case 35665:Mr="3f";break;case 35666:Mr="4f";break;case 35670:case 5124:Mr="1i";break;case 35671:case 35667:Mr="2i";break;case 35672:case 35668:Mr="3i";break;case 35673:case 35669:Mr="4i"}or(xr,".uniform",Mr,"(",en,",",p(qr)?Array.prototype.slice.call(qr):qr,");")}continue}Er=Qr.append(Pt,or)}else{if(!Dr(We))continue;Er=or.def(vr.uniforms,"[",ye.id(qr),"]")}switch(35678===Vr?or("if(",Er,"&&",Er,'._reglType==="framebuffer"){',Er,"=",Er,".color[0];","}"):35680===Vr&&or("if(",Er,"&&",Er,'._reglType==="framebufferCube"){',Er,"=",Er,".color[0];","}"),qr=1,Vr){case 35678:case 35680:Vr=or.def(Er,"._texture"),or(xr,".uniform1i(",en,",",Vr,".bind());"),or.exit(Vr,".unbind();");continue;case 5124:case 35670:Mr="1i";break;case 35667:case 35671:Mr="2i",qr=2;break;case 35668:case 35672:Mr="3i",qr=3;break;case 35669:case 35673:Mr="4i",qr=4;break;case 5126:Mr="1f";break;case 35664:Mr="2f",qr=2;break;case 35665:Mr="3f",qr=3;break;case 35666:Mr="4f",qr=4;break;case 35674:Mr="Matrix2fv";break;case 35675:Mr="Matrix3fv";break;case 35676:Mr="Matrix4fv"}if("M"===Mr.charAt(0)){or(xr,".uniform",Mr,"(",en,","),en=Math.pow(Vr-35674+2,2);var mn=Pt.global.def("new Float32Array(",en,")");Array.isArray(Er)?or("false,(",n(en,function(bn){return mn+"["+bn+"]="+Er[bn]}),",",mn,")"):or("false,(Array.isArray(",Er,")||",Er," instanceof Float32Array)?",Er,":(",n(en,function(bn){return mn+"["+bn+"]="+Er+"["+bn+"]"}),",",mn,")"),or(");")}else{if(1<qr){Vr=[];var xn=[];for(Qr=0;Qr<qr;++Qr)Array.isArray(Er)?xn.push(Er[Qr]):xn.push(or.def(Er+"["+Qr+"]")),Ir&&Vr.push(or.def());Ir&&or("if(!",Pt.batchId,"||",Vr.map(function(bn,Sn){return bn+"!=="+xn[Sn]}).join("||"),"){",Vr.map(function(bn,Sn){return bn+"="+xn[Sn]+";"}).join("")),or(xr,".uniform",Mr,"(",en,",",xn.join(","),");")}else Ir&&(Vr=or.def(),or("if(!",Pt.batchId,"||",Vr,"!==",Er,"){",Vr,"=",Er,";")),or(xr,".uniform",Mr,"(",en,",",Er,");");Ir&&or("}")}}}function Nr(Pt,or,hr,zr){function Dr(In){var Yn=Vr[In];return Yn?Yn.append(Pt,Yn.contextDep&&zr.contextDynamic||Yn.propDep?hr:or):or.def(qr,".",In)}function Ir(){function In(){hr(xr,".drawElementsInstancedANGLE(",[en,xn,bn,mn+"<<(("+bn+"-5121)>>1)",vr],");")}function Yn(){hr(xr,".drawArraysInstancedANGLE(",[en,mn,xn,vr],");")}Qr&&"null"!==Qr?Sn?In():(hr("if(",Qr,"){"),In(),hr("}else{"),Yn(),hr("}")):Yn()}function Mr(){function In(){hr(Er+".drawElements("+[en,xn,bn,mn+"<<(("+bn+"-5121)>>1)"]+");")}function Yn(){hr(Er+".drawArrays("+[en,mn,xn]+");")}Qr&&"null"!==Qr?Sn?In():(hr("if(",Qr,"){"),In(),hr("}else{"),Yn(),hr("}")):Yn()}var vr,xr,In,Yn,wr=Pt.shared,Er=wr.gl,qr=wr.draw,Vr=zr.draw,Qr=(Yn=or,(In=Vr.elements)?((In.contextDep&&zr.contextDynamic||In.propDep)&&(Yn=hr),In=In.append(Pt,Yn),Vr.elementsActive&&Yn("if("+In+")"+Er+".bindBuffer(34963,"+In+".buffer.buffer);")):(In=Yn.def(),Yn(In,"=",qr,".","elements",";","if(",In,"){",Er,".bindBuffer(",34963,",",In,".buffer.buffer);}","else if(",wr.vao,".currentVAO){",In,"=",Pt.shared.elements+".getElements("+wr.vao,".currentVAO.elements);",nn?"":"if("+In+")"+Er+".bindBuffer(34963,"+In+".buffer.buffer);","}")),In),en=Dr("primitive"),mn=Dr("offset"),xn=function(){var In=Vr.count,Yn=or;return In?((In.contextDep&&zr.contextDynamic||In.propDep)&&(Yn=hr),In=In.append(Pt,Yn)):In=Yn.def(qr,".","count"),In}();if("number"==typeof xn){if(0===xn)return}else hr("if(",xn,"){"),hr.exit("}");Rr&&(vr=Dr("instances"),xr=Pt.instancing);var bn=Qr+".type",Sn=Vr.elements&&$(Vr.elements)&&!Vr.vaoActive;Rr&&("number"!=typeof vr||0<=vr)?"string"==typeof vr?(hr("if(",vr,">0){"),Ir(),hr("}else if(",vr,"<0){"),Mr(),hr("}")):Ir():Mr()}function Xr(Pt,or,hr,zr,Dr){return Dr=(or=At()).proc("body",Dr),Rr&&(or.instancing=Dr.def(or.shared.extensions,".angle_instanced_arrays")),Pt(or,Dr,hr,zr),or.compile().body}function un(Pt,or,hr,zr){cr(Pt,or),hr.useVAO?hr.drawVAO?or(Pt.shared.vao,".setVAO(",hr.drawVAO.append(Pt,or),");"):or(Pt.shared.vao,".setVAO(",Pt.shared.vao,".targetVAO);"):(or(Pt.shared.vao,".setVAO(null);"),Tr(Pt,or,hr,zr.attributes,function(){return!0})),Fr(Pt,or,hr,zr.uniforms,function(){return!0},!1),Nr(Pt,or,or,hr)}function $r(Pt,or,hr,zr){function Dr(){return!0}Pt.batchId="a1",cr(Pt,or),Tr(Pt,or,hr,zr.attributes,Dr),Fr(Pt,or,hr,zr.uniforms,Dr,!1),Nr(Pt,or,or,hr)}function Pn(Pt,or,hr,zr){function Dr(qr){return qr.contextDep&&Mr||qr.propDep}function Ir(qr){return!Dr(qr)}cr(Pt,or);var Mr=hr.contextDep,vr=or.def(),xr=or.def();Pt.shared.props=xr,Pt.batchId=vr;var wr=Pt.scope(),Er=Pt.scope();or(wr.entry,"for(",vr,"=0;",vr,"<","a1",";++",vr,"){",xr,"=","a0","[",vr,"];",Er,"}",wr.exit),hr.needsContext&&ur(Pt,Er,hr.context),hr.needsFramebuffer&&Jt(Pt,Er,hr.framebuffer),Qt(Pt,Er,hr.state,Dr),hr.profile&&Dr(hr.profile)&&gr(Pt,Er,hr,!1,!0),zr?(hr.useVAO?hr.drawVAO?Dr(hr.drawVAO)?Er(Pt.shared.vao,".setVAO(",hr.drawVAO.append(Pt,Er),");"):wr(Pt.shared.vao,".setVAO(",hr.drawVAO.append(Pt,wr),");"):wr(Pt.shared.vao,".setVAO(",Pt.shared.vao,".targetVAO);"):(wr(Pt.shared.vao,".setVAO(null);"),Tr(Pt,wr,hr,zr.attributes,Ir),Tr(Pt,Er,hr,zr.attributes,Dr)),Fr(Pt,wr,hr,zr.uniforms,Ir,!1),Fr(Pt,Er,hr,zr.uniforms,Dr,!0),Nr(Pt,wr,Er,hr)):(or=Pt.global.def("{}"),zr=hr.shader.progVar.append(Pt,Er),xr=Er.def(zr,".id"),wr=Er.def(or,"[",xr,"]"),Er(Pt.shared.gl,".useProgram(",zr,".program);","if(!",wr,"){",wr,"=",or,"[",xr,"]=",Pt.link(function(qr){return Xr($r,Pt,hr,qr,2)}),"(",zr,");}",wr,".call(this,a0[",vr,"],",vr,");"))}function dn(Pt,or,hr){var zr=or.static[hr];if(zr&&function(Er){if("object"==typeof Er&&!p(Er)){for(var qr=Object.keys(Er),Vr=0;Vr<qr.length;++Vr)if(X.isDynamic(Er[qr[Vr]]))return!0;return!1}}(zr)){var Dr=Pt.global,Ir=Object.keys(zr),Mr=!1,vr=!1,xr=!1,wr=Pt.global.def("{}");Ir.forEach(function(Er){var qr=zr[Er];if(X.isDynamic(qr))"function"==typeof qr&&(qr=zr[Er]=X.unbox(qr)),Er=N(qr,null),Mr=Mr||Er.thisDep,xr=xr||Er.propDep,vr=vr||Er.contextDep;else{switch(Dr(wr,".",Er,"="),typeof qr){case"number":Dr(qr);break;case"string":Dr('"',qr,'"');break;case"object":Array.isArray(qr)&&Dr("[",qr.join(),"]");break;default:Dr(Pt.link(qr))}Dr(";")}}),or.dynamic[hr]=new X.DynamicVariable(4,{thisDep:Mr,contextDep:vr,propDep:xr,ref:wr,append:function(Er,qr){Ir.forEach(function(Vr){var Qr=zr[Vr];X.isDynamic(Qr)&&(Qr=Er.invoke(qr,Qr),qr(wr,".",Vr,"=",Qr,";"))})}}),delete or.static[hr]}}var An=Ct.Record,Zn={add:32774,subtract:32778,"reverse subtract":32779};Be.ext_blend_minmax&&(Zn.min=32775,Zn.max=32776);var Rr=Be.angle_instanced_arrays,hn=Be.webgl_draw_buffers,nn=Be.oes_vertex_array_object,Hr={dirty:!0,profile:Ee.profile},Fn={},Un=[],vn={},Cn={};it("dither",3024),it("blend.enable",3042),ht("blend.color","blendColor",[0,0,0,0]),ht("blend.equation","blendEquationSeparate",[32774,32774]),ht("blend.func","blendFuncSeparate",[1,0,1,0]),it("depth.enable",2929,!0),ht("depth.func","depthFunc",513),ht("depth.range","depthRange",[0,1]),ht("depth.mask","depthMask",!0),ht("colorMask","colorMask",[!0,!0,!0,!0]),it("cull.enable",2884),ht("cull.face","cullFace",1029),ht("frontFace","frontFace",2305),ht("lineWidth","lineWidth",1),it("polygonOffset.enable",32823),ht("polygonOffset.offset","polygonOffset",[0,0]),it("sample.alpha",32926),it("sample.enable",32928),ht("sample.coverage","sampleCoverage",[1,!1]),it("stencil.enable",2960),ht("stencil.mask","stencilMask",-1),ht("stencil.func","stencilFunc",[519,0,-1]),ht("stencil.opFront","stencilOpSeparate",[1028,7680,7680,7680]),ht("stencil.opBack","stencilOpSeparate",[1029,7680,7680,7680]),it("scissor.enable",3089),ht("scissor.box","scissor",[0,0,he.drawingBufferWidth,he.drawingBufferHeight]),ht("viewport","viewport",[0,0,he.drawingBufferWidth,he.drawingBufferHeight]);var li={gl:he,context:Rt,strings:ye,next:Fn,current:Hr,draw:ft,elements:He,buffer:Je,shader:rt,attributes:Ct.state,vao:Ct,uniforms:wt,framebuffer:ot,extensions:Be,timer:kt,isBufferArgs:K},tr={primTypes:Ae,compareFuncs:rr,blendFuncs:Wt,blendEquations:Zn,stencilOps:Ht,glTypes:Te,orientationType:Ve};hn&&(tr.backBuffer=[1029],tr.drawBuffer=n(Ge.maxDrawbuffers,function(Pt){return 0===Pt?[0]:n(Pt,function(or){return 36064+or})}));var mr=0;return{next:Fn,current:Hr,procs:function(){var Pt=At(),or=Pt.proc("poll"),hr=Pt.proc("refresh"),zr=Pt.block();or(zr),hr(zr);var Dr,Ir=(xr=Pt.shared).gl,Mr=xr.next,vr=xr.current;zr(vr,".dirty=false;"),Jt(Pt,or),Jt(Pt,hr,null,!0),Rr&&(Dr=Pt.link(Rr)),Be.oes_vertex_array_object&&hr(Pt.link(Be.oes_vertex_array_object),".bindVertexArrayOES(null);");var xr=hr.def(xr.attributes),wr=hr.def(0),Er=Pt.cond(wr,".buffer");Er.then(Ir,".enableVertexAttribArray(i);",Ir,".bindBuffer(",34962,",",wr,".buffer.buffer);",Ir,".vertexAttribPointer(i,",wr,".size,",wr,".type,",wr,".normalized,",wr,".stride,",wr,".offset);").else(Ir,".disableVertexAttribArray(i);",Ir,".vertexAttrib4f(i,",wr,".x,",wr,".y,",wr,".z,",wr,".w);",wr,".buffer=null;");var qr=Pt.link(Ge.maxAttributes,{stable:!0});return hr("for(var i=0;i<",qr,";++i){",wr,"=",xr,"[i];",Er,"}"),Rr&&hr("for(var i=0;i<",qr,";++i){",Dr,".vertexAttribDivisorANGLE(i,",xr,"[i].divisor);","}"),hr(Pt.shared.vao,".currentVAO=null;",Pt.shared.vao,".setVAO(",Pt.shared.vao,".targetVAO);"),Object.keys(vn).forEach(function(Vr){var Qr=vn[Vr],en=zr.def(Mr,".",Vr),mn=Pt.block();mn("if(",en,"){",Ir,".enable(",Qr,")}else{",Ir,".disable(",Qr,")}",vr,".",Vr,"=",en,";"),hr(mn),or("if(",en,"!==",vr,".",Vr,"){",mn,"}")}),Object.keys(Cn).forEach(function(Vr){var Qr,en,mn=Cn[Vr],xn=Hr[Vr],bn=Pt.block();bn(Ir,".",mn,"("),p(xn)?(mn=xn.length,Qr=Pt.global.def(Mr,".",Vr),en=Pt.global.def(vr,".",Vr),bn(n(mn,function(Sn){return Qr+"["+Sn+"]"}),");",n(mn,function(Sn){return en+"["+Sn+"]="+Qr+"["+Sn+"];"}).join("")),or("if(",n(mn,function(Sn){return Qr+"["+Sn+"]!=="+en+"["+Sn+"]"}).join("||"),"){",bn,"}")):(Qr=zr.def(Mr,".",Vr),en=zr.def(vr,".",Vr),bn(Qr,");",vr,".",Vr,"=",Qr,";"),or("if(",Qr,"!==",en,"){",bn,"}")),hr(bn)}),Pt.compile()}(),compile:function(Pt,or,hr,zr,Dr){var Ir=At();Ir.stats=Ir.link(Dr),Object.keys(or.static).forEach(function(vr){dn(Ir,or,vr)}),er.forEach(function(vr){dn(Ir,Pt,vr)});var Mr=kr(Pt,or,hr,zr);return Mr.shader.program&&(Mr.shader.program.attributes.sort(function(vr,xr){return vr.name<xr.name?-1:1}),Mr.shader.program.uniforms.sort(function(vr,xr){return vr.name<xr.name?-1:1})),function(vr,xr){var wr=vr.proc("draw",1);cr(vr,wr),ur(vr,wr,xr.context),Jt(vr,wr,xr.framebuffer),$t(vr,wr,xr),Qt(vr,wr,xr.state),gr(vr,wr,xr,!1,!0);var Er=xr.shader.progVar.append(vr,wr);if(wr(vr.shared.gl,".useProgram(",Er,".program);"),xr.shader.program)un(vr,wr,xr,xr.shader.program);else{wr(vr.shared.vao,".setVAO(null);");var qr=vr.global.def("{}"),Vr=wr.def(Er,".id"),Qr=wr.def(qr,"[",Vr,"]");wr(vr.cond(Qr).then(Qr,".call(this,a0);").else(Qr,"=",qr,"[",Vr,"]=",vr.link(function(en){return Xr(un,vr,xr,en,1)}),"(",Er,");",Qr,".call(this,a0);"))}0<Object.keys(xr.state).length&&wr(vr.shared.current,".dirty=true;"),vr.shared.vao&&wr(vr.shared.vao,".setVAO(null);")}(Ir,Mr),function gn(Pt,or){function hr(vr){var xr=or.shader[vr];xr&&(xr=xr.append(Pt,zr),isNaN(xr)?zr.set(Dr.shader,"."+vr,xr):zr.set(Dr.shader,"."+vr,Pt.link(xr,{stable:!0})))}var zr=Pt.proc("scope",3);Pt.batchId="a2";var Dr=Pt.shared,Ir=Dr.current;if(ur(Pt,zr,or.context),or.framebuffer&&or.framebuffer.append(Pt,zr),G(Object.keys(or.state)).forEach(function(vr){var xr=or.state[vr],wr=xr.append(Pt,zr);p(wr)?wr.forEach(function(Er,qr){isNaN(Er)?zr.set(Pt.next[vr],"["+qr+"]",Er):zr.set(Pt.next[vr],"["+qr+"]",Pt.link(Er,{stable:!0}))}):$(xr)?zr.set(Dr.next,"."+vr,Pt.link(wr,{stable:!0})):zr.set(Dr.next,"."+vr,wr)}),gr(Pt,zr,or,!0,!0),["elements","offset","count","instances","primitive"].forEach(function(vr){var xr=or.draw[vr];xr&&(xr=xr.append(Pt,zr),isNaN(xr)?zr.set(Dr.draw,"."+vr,xr):zr.set(Dr.draw,"."+vr,Pt.link(xr),{stable:!0}))}),Object.keys(or.uniforms).forEach(function(vr){var xr=or.uniforms[vr].append(Pt,zr);Array.isArray(xr)&&(xr="["+xr.map(function(wr){return isNaN(wr)?wr:Pt.link(wr,{stable:!0})})+"]"),zr.set(Dr.uniforms,"["+Pt.link(ye.id(vr),{stable:!0})+"]",xr)}),Object.keys(or.attributes).forEach(function(vr){var xr=or.attributes[vr].append(Pt,zr),wr=Pt.scopeAttrib(vr);Object.keys(new An).forEach(function(Er){zr.set(wr,"."+Er,xr[Er])})}),or.scopeVAO){var Mr=or.scopeVAO.append(Pt,zr);isNaN(Mr)?zr.set(Dr.vao,".targetVAO",Mr):zr.set(Dr.vao,".targetVAO",Pt.link(Mr,{stable:!0}))}hr("vert"),hr("frag"),0<Object.keys(or.state).length&&(zr(Ir,".dirty=true;"),zr.exit(Ir,".dirty=true;")),zr("a1(",Pt.shared.context,",a0,",Pt.batchId,");")}(Ir,Mr),function(vr,xr){function wr(xn){return xn.contextDep&&qr||xn.propDep}var Er=vr.proc("batch",2);vr.batchId="0",cr(vr,Er);var qr=!1,Vr=!0;Object.keys(xr.context).forEach(function(xn){qr=qr||xr.context[xn].propDep}),qr||(ur(vr,Er,xr.context),Vr=!1);var Qr=!1;if((en=xr.framebuffer)?(en.propDep?qr=Qr=!0:en.contextDep&&qr&&(Qr=!0),Qr||Jt(vr,Er,en)):Jt(vr,Er,null),xr.state.viewport&&xr.state.viewport.propDep&&(qr=!0),$t(vr,Er,xr),Qt(vr,Er,xr.state,function(xn){return!wr(xn)}),xr.profile&&wr(xr.profile)||gr(vr,Er,xr,!1,"a1"),xr.contextDep=qr,xr.needsContext=Vr,xr.needsFramebuffer=Qr,(Vr=xr.shader.progVar).contextDep&&qr||Vr.propDep)Pn(vr,Er,xr,null);else if(Vr=Vr.append(vr,Er),Er(vr.shared.gl,".useProgram(",Vr,".program);"),xr.shader.program)Pn(vr,Er,xr,xr.shader.program);else{Er(vr.shared.vao,".setVAO(null);");var en=vr.global.def("{}"),mn=(Qr=Er.def(Vr,".id"),Er.def(en,"[",Qr,"]"));Er(vr.cond(mn).then(mn,".call(this,a0,a1);").else(mn,"=",en,"[",Qr,"]=",vr.link(function(xn){return Xr(Pn,vr,xr,xn,2)}),"(",Vr,");",mn,".call(this,a0,a1);"))}0<Object.keys(xr.state).length&&Er(vr.shared.current,".dirty=true;"),vr.shared.vao&&Er(vr.shared.vao,".setVAO(null);")}(Ir,Mr),j(Ir.compile(),{destroy:function(){Mr.shader.program.destroy()}})}}}function te(he,ye){for(var Be=0;Be<he.length;++Be)if(he[Be]===ye)return Be;return-1}var j=function(he,ye){for(var Be=Object.keys(ye),Ge=0;Ge<Be.length;++Ge)he[Be[Ge]]=ye[Be[Ge]];return he},J=0,X={DynamicVariable:g,define:function(he,ye){return new g(he,v(ye+""))},isDynamic:function(he){return"function"==typeof he&&!he._reglType||he instanceof g},unbox:function he(ye,Be){return"function"==typeof ye?new g(0,ye):"number"==typeof ye||"boolean"==typeof ye?new g(5,ye):Array.isArray(ye)?new g(6,ye.map(function(Ge,Je){return he(Ge,Be+"["+Je+"]")})):ye instanceof g?ye:void 0},accessor:v},re={next:"function"==typeof requestAnimationFrame?function(he){return requestAnimationFrame(he)}:function(he){return setTimeout(he,16)},cancel:"function"==typeof cancelAnimationFrame?function(he){return cancelAnimationFrame(he)}:clearTimeout},ne=typeof performance<"u"&&performance.now?function(){return performance.now()}:function(){return+new Date},le=a();le.zero=a();var de=function(he){return he instanceof Uint8Array||he instanceof Uint16Array||he instanceof Uint32Array||he instanceof Int8Array||he instanceof Int16Array||he instanceof Int32Array||he instanceof Float32Array||he instanceof Float64Array||he instanceof Uint8ClampedArray},se=function(he){return Object.keys(he).map(function(ye){return he[ye]})},ge={shape:function(he){for(var ye=[];he.length;he=he[0])ye.push(he.length);return ye},flatten:function(he,ye,Be,Ge){var Je=1;if(ye.length)for(var He=0;He<ye.length;++He)Je*=ye[He];else Je=0;switch(Be=Ge||le.allocType(Be,Je),ye.length){case 0:break;case 1:for(Ge=ye[0],ye=0;ye<Ge;++ye)Be[ye]=he[ye];break;case 2:for(Ge=ye[0],ye=ye[1],He=Je=0;He<Ge;++He)for(var st=he[He],ot=0;ot<ye;++ot)Be[Je++]=st[ot];break;case 3:d(he,ye[0],ye[1],ye[2],Be,0);break;default:!function wt(Ct,rt,ft,Rt,kt){for(var Lt=1,Ee=ft+1;Ee<rt.length;++Ee)Lt*=rt[Ee];var Ye=rt[ft];if(rt.length-ft==4){var it=rt[ft+1],ht=rt[ft+2];for(rt=rt[ft+3],Ee=0;Ee<Ye;++Ee)d(Ct[Ee],it,ht,rt,Rt,kt),kt+=Lt}else for(Ee=0;Ee<Ye;++Ee)wt(Ct[Ee],rt,ft+1,Rt,kt),kt+=Lt}(he,ye,0,Be,0)}return Be}},_e={"[object Int8Array]":5120,"[object Int16Array]":5122,"[object Int32Array]":5124,"[object Uint8Array]":5121,"[object Uint8ClampedArray]":5121,"[object Uint16Array]":5123,"[object Uint32Array]":5125,"[object Float32Array]":5126,"[object Float64Array]":5121,"[object ArrayBuffer]":5121},Te={int8:5120,int16:5122,int32:5124,uint8:5121,uint16:5123,uint32:5125,float:5126,float32:5126},we={dynamic:35048,stream:35040,static:35044},Oe=ge.flatten,fe=ge.shape,ve=[];ve[5120]=1,ve[5122]=2,ve[5124]=4,ve[5121]=1,ve[5123]=2,ve[5125]=4,ve[5126]=4;var Ae={points:0,point:0,lines:1,line:1,triangles:4,triangle:4,"line loop":2,"line strip":3,"triangle strip":5,"triangle fan":6},ke=new Float32Array(1),Pe=new Uint32Array(ke.buffer),Ne=[9984,9986,9985,9987],De=[0,6409,6410,6407,6408],ze={};ze[6409]=ze[6406]=ze[6402]=1,ze[34041]=ze[6410]=2,ze[6407]=ze[35904]=3,ze[6408]=ze[35906]=4;var Me=o("HTMLCanvasElement"),Se=o("OffscreenCanvas"),Ie=o("CanvasRenderingContext2D"),Fe=o("ImageBitmap"),Re=o("HTMLImageElement"),Xe=o("HTMLVideoElement"),nt=Object.keys(_e).concat([Me,Se,Ie,Fe,Re,Xe]),ct=[];ct[5121]=1,ct[5126]=4,ct[36193]=2,ct[5123]=2,ct[5125]=4;var xt=[];xt[32854]=2,xt[32855]=2,xt[36194]=2,xt[34041]=4,xt[33776]=.5,xt[33777]=.5,xt[33778]=1,xt[33779]=1,xt[35986]=.5,xt[35987]=1,xt[34798]=1,xt[35840]=.5,xt[35841]=.25,xt[35842]=.5,xt[35843]=.25,xt[36196]=.5;var dt=[];dt[32854]=2,dt[32855]=2,dt[36194]=2,dt[33189]=2,dt[36168]=1,dt[34041]=4,dt[35907]=4,dt[34836]=16,dt[34842]=8,dt[34843]=6;var Ke=[];Ke[6408]=4,Ke[6407]=3;var mt=[];mt[5121]=1,mt[5126]=4,mt[36193]=2;var Bt=[1116352408,1899447441,-1245643825,-373957723,961987163,1508970993,-1841331548,-1424204075,-670586216,310598401,607225278,1426881987,1925078388,-2132889090,-1680079193,-1046744716,-459576895,-272742522,264347078,604807628,770255983,1249150122,1555081692,1996064986,-1740746414,-1473132947,-1341970488,-1084653625,-958395405,-710438585,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,-2117940946,-1838011259,-1564481375,-1474664885,-1035236496,-949202525,-778901479,-694614492,-200395387,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,-2067236844,-1933114872,-1866530822,-1538233109,-1090935817,-965641998],Ut=["x","y","z","w"],er="blend.func blend.equation stencil.func stencil.opFront stencil.opBack sample.coverage viewport scissor.box polygonOffset.offset".split(" "),Wt={0:0,1:1,zero:0,one:1,"src color":768,"one minus src color":769,"src alpha":770,"one minus src alpha":771,"dst color":774,"one minus dst color":775,"dst alpha":772,"one minus dst alpha":773,"constant color":32769,"one minus constant color":32770,"constant alpha":32771,"one minus constant alpha":32772,"src alpha saturate":776},rr={never:512,less:513,"<":513,equal:514,"=":514,"==":514,"===":514,lequal:515,"<=":515,greater:516,">":516,notequal:517,"!=":517,"!==":517,gequal:518,">=":518,always:519},Ht={0:0,zero:0,keep:7680,replace:7681,increment:7682,decrement:7683,"increment wrap":34055,"decrement wrap":34056,invert:5386},Ve={cw:2304,ccw:2305},We=new Y(!1,!1,!1,function(){});return function(he){function ye(){if(0===$r.length)Ft&&Ft.update(),An=null;else{An=re.next(ye),rt();for(var Rr=$r.length-1;0<=Rr;--Rr){var hn=$r[Rr];hn&&hn(kr,null,0)}kt.flush(),Ft&&Ft.update()}}function Be(){!An&&0<$r.length&&(An=re.next(ye))}function Ge(){An&&(re.cancel(ye),An=null)}function Je(Rr){Rr.preventDefault(),Ge(),Pn.forEach(function(hn){hn()})}function He(Rr){kt.getError(),Ee.restore(),cr.restore(),Jt.restore(),gr.restore(),Tr.restore(),Fr.restore(),Qt.restore(),Ft&&Ft.restore(),Nr.procs.refresh(),Be(),gn.forEach(function(hn){hn()})}function st(Rr){function hn(Pt,or){var hr={},zr={};return Object.keys(Pt).forEach(function(Dr){var Ir=Pt[Dr];if(X.isDynamic(Ir))zr[Dr]=X.unbox(Ir,Dr);else{if(or&&Array.isArray(Ir))for(var Mr=0;Mr<Ir.length;++Mr)if(X.isDynamic(Ir[Mr]))return void(zr[Dr]=X.unbox(Ir,Dr));hr[Dr]=Ir}}),{dynamic:zr,static:hr}}var nn=hn(Rr.context||{},!0),Hr=hn(Rr.uniforms||{},!0),Fn=hn(Rr.attributes||{},!1);Rr=hn(function(Pt){function or(zr){if(zr in hr){var Dr=hr[zr];delete hr[zr],Object.keys(Dr).forEach(function(Ir){hr[zr+"."+Ir]=Dr[Ir]})}}var hr=j({},Pt);return delete hr.uniforms,delete hr.attributes,delete hr.context,delete hr.vao,"stencil"in hr&&hr.stencil.op&&(hr.stencil.opBack=hr.stencil.opFront=hr.stencil.op,delete hr.stencil.op),or("blend"),or("depth"),or("cull"),or("stencil"),or("polygonOffset"),or("scissor"),or("sample"),"vao"in Pt&&(hr.vao=Pt.vao),hr}(Rr),!1);var Un={gpuTime:0,cpuTime:0,count:0},vn=Nr.compile(Rr,Fn,Hr,nn,Un),Cn=vn.draw,li=vn.batch,tr=vn.scope,mr=[];return j(function(Pt,or){var hr;if("function"==typeof Pt)return tr.call(this,null,Pt,0);if("function"==typeof or)if("number"==typeof Pt)for(hr=0;hr<Pt;++hr)tr.call(this,null,or,hr);else{if(!Array.isArray(Pt))return tr.call(this,Pt,or,0);for(hr=0;hr<Pt.length;++hr)tr.call(this,Pt[hr],or,hr)}else if("number"==typeof Pt){if(0<Pt)return li.call(this,function(zr){for(;mr.length<zr;)mr.push(null);return mr}(0|Pt),0|Pt)}else{if(!Array.isArray(Pt))return Cn.call(this,Pt);if(Pt.length)return li.call(this,Pt,Pt.length)}},{stats:Un,destroy:function(){vn.destroy()}})}function ot(Rr,hn){var nn=0;Nr.procs.poll();var Hr=hn.color;Hr&&(kt.clearColor(+Hr[0]||0,+Hr[1]||0,+Hr[2]||0,+Hr[3]||0),nn|=16384),"depth"in hn&&(kt.clearDepth(+hn.depth),nn|=256),"stencil"in hn&&(kt.clearStencil(0|hn.stencil),nn|=1024),kt.clear(nn)}function wt(Rr){return $r.push(Rr),Be(),{cancel:function(){var hn=te($r,Rr);$r[hn]=function nn(){var Hr=te($r,nn);$r[Hr]=$r[$r.length-1],--$r.length,0>=$r.length&&Ge()}}}}function Ct(){var Rr=Xr.viewport,hn=Xr.scissor_box;Rr[0]=Rr[1]=hn[0]=hn[1]=0,kr.viewportWidth=kr.framebufferWidth=kr.drawingBufferWidth=Rr[2]=hn[2]=kt.drawingBufferWidth,kr.viewportHeight=kr.framebufferHeight=kr.drawingBufferHeight=Rr[3]=hn[3]=kt.drawingBufferHeight}function rt(){kr.tick+=1,kr.time=Rt(),Ct(),Nr.procs.poll()}function ft(){gr.refresh(),Ct(),Nr.procs.refresh(),Ft&&Ft.update()}function Rt(){return(ne()-Gt)/1e3}if(!(he=function e(he){var ye,Be,Ge,Je,He=he||{};he={};var st=[],ot=[],wt=typeof window>"u"?1:window.devicePixelRatio,Ct=!1,rt={},ft=function(kt){},Rt=function(){};if("string"==typeof He?ye=document.querySelector(He):"object"==typeof He&&("string"==typeof He.nodeName&&"function"==typeof He.appendChild&&"function"==typeof He.getBoundingClientRect?ye=He:"function"==typeof He.drawArrays||"function"==typeof He.drawElements?Ge=(Je=He).canvas:("gl"in He?Je=He.gl:"canvas"in He?Ge=x(He.canvas):"container"in He&&(Be=x(He.container)),"attributes"in He&&(he=He.attributes),"extensions"in He&&(st=m(He.extensions)),"optionalExtensions"in He&&(ot=m(He.optionalExtensions)),"onDone"in He&&(ft=He.onDone),"profile"in He&&(Ct=!!He.profile),"pixelRatio"in He&&(wt=+He.pixelRatio),"cachedCode"in He&&(rt=He.cachedCode))),ye&&("canvas"===ye.nodeName.toLowerCase()?Ge=ye:Be=ye),!Je){if(!Ge){if(!(ye=function(kt,Lt,Ee){function Ye(){var At=window.innerWidth,Ft=window.innerHeight;kt!==document.body&&(At=(Ft=ht.getBoundingClientRect()).right-Ft.left,Ft=Ft.bottom-Ft.top),ht.width=Ee*At,ht.height=Ee*Ft}var it,ht=document.createElement("canvas");return j(ht.style,{border:0,margin:0,padding:0,top:0,left:0,width:"100%",height:"100%"}),kt.appendChild(ht),kt===document.body&&(ht.style.position="absolute",j(kt.style,{margin:0,padding:0})),kt!==document.body&&"function"==typeof ResizeObserver?(it=new ResizeObserver(function(){setTimeout(Ye)})).observe(kt):window.addEventListener("resize",Ye,!1),Ye(),{canvas:ht,onDestroy:function(){it?it.disconnect():window.removeEventListener("resize",Ye),kt.removeChild(ht)}}}(Be||document.body,0,wt)))return null;Ge=ye.canvas,Rt=ye.onDestroy}void 0===he.premultipliedAlpha&&(he.premultipliedAlpha=!0),Je=function(kt,Lt){function Ee(Ye){try{return kt.getContext(Ye,Lt)}catch{return null}}return Ee("webgl")||Ee("experimental-webgl")||Ee("webgl-experimental")}(Ge,he)}return Je?{gl:Je,canvas:Ge,container:Be,extensions:st,optionalExtensions:ot,pixelRatio:wt,profile:Ct,cachedCode:rt,onDone:ft,onDestroy:Rt}:(Rt(),ft("webgl not supported, try upgrading your browser or graphics drivers http://get.webgl.org"),null)}(he)))return null;var kt=he.gl,Lt=kt.getContextAttributes();kt.isContextLost();var Ee=function(Rr,hn){function nn(vn){var Cn;vn=vn.toLowerCase();try{Cn=Hr[vn]=Rr.getExtension(vn)}catch{}return!!Cn}for(var Hr={},Fn=0;Fn<hn.extensions.length;++Fn){var Un=hn.extensions[Fn];if(!nn(Un))return hn.onDestroy(),hn.onDone('"'+Un+'" extension is not supported by the current WebGL context, try upgrading your system or a different browser'),null}return hn.optionalExtensions.forEach(nn),{extensions:Hr,restore:function(){Object.keys(Hr).forEach(function(vn){if(Hr[vn]&&!nn(vn))throw Error("(regl): error restoring extension "+vn)})}}}(kt,he);if(!Ee)return null;var Rr,hn,Ye=(Rr={"":0},hn=[""],{id:function(nn){var Hr=Rr[nn];return Hr||(Hr=Rr[nn]=hn.length,hn.push(nn),Hr)},str:function(nn){return hn[nn]}}),it={vaoCount:0,bufferCount:0,elementsCount:0,framebufferCount:0,shaderCount:0,textureCount:0,cubeCount:0,renderbufferCount:0,maxTextureUnits:0},ht=he.cachedCode||{},At=Ee.extensions,Ft=function(Rr,hn){function nn(){this.endQueryIndex=this.startQueryIndex=-1,this.sum=0,this.stats=null}function Hr(mr,Pt,or){var hr=vn.pop()||new nn;hr.startQueryIndex=mr,hr.endQueryIndex=Pt,hr.sum=0,hr.stats=or,Cn.push(hr)}if(!hn.ext_disjoint_timer_query)return null;var Fn=[],Un=[],vn=[],Cn=[],li=[],tr=[];return{beginQuery:function(mr){var Pt=Fn.pop()||hn.ext_disjoint_timer_query.createQueryEXT();hn.ext_disjoint_timer_query.beginQueryEXT(35007,Pt),Un.push(Pt),Hr(Un.length-1,Un.length,mr)},endQuery:function(){hn.ext_disjoint_timer_query.endQueryEXT(35007)},pushScopeStats:Hr,update:function(){var mr,Pt;if(0!==(mr=Un.length)){tr.length=Math.max(tr.length,mr+1),li.length=Math.max(li.length,mr+1),li[0]=0;var or=tr[0]=0;for(Pt=mr=0;Pt<Un.length;++Pt){var hr=Un[Pt];hn.ext_disjoint_timer_query.getQueryObjectEXT(hr,34919)?(or+=hn.ext_disjoint_timer_query.getQueryObjectEXT(hr,34918),Fn.push(hr)):Un[mr++]=hr,li[Pt+1]=or,tr[Pt+1]=mr}for(Un.length=mr,Pt=mr=0;Pt<Cn.length;++Pt){var zr=(or=Cn[Pt]).startQueryIndex;or.sum+=li[hr=or.endQueryIndex]-li[zr],(hr=tr[hr])===(zr=tr[zr])?(or.stats.gpuTime+=or.sum/1e6,vn.push(or)):(or.startQueryIndex=zr,or.endQueryIndex=hr,Cn[mr++]=or)}Cn.length=mr}},getNumPendingQueries:function(){return Un.length},clear:function(){Fn.push.apply(Fn,Un);for(var mr=0;mr<Fn.length;mr++)hn.ext_disjoint_timer_query.deleteQueryEXT(Fn[mr]);Un.length=0,Fn.length=0},restore:function(){Un.length=0,Fn.length=0}}}(0,At),Gt=ne(),jt=kt.drawingBufferWidth,fr=kt.drawingBufferHeight,kr={tick:0,time:0,viewportWidth:jt,viewportHeight:fr,framebufferWidth:jt,framebufferHeight:fr,drawingBufferWidth:jt,drawingBufferHeight:fr,pixelRatio:he.pixelRatio},ur=(jt={elements:null,primitive:4,count:-1,offset:0,instances:-1},function(he,ye){var Be=1;ye.ext_texture_filter_anisotropic&&(Be=he.getParameter(34047));var Ge=1,Je=1;ye.webgl_draw_buffers&&(Ge=he.getParameter(34852),Je=he.getParameter(36063));var He=!!ye.oes_texture_float;if(He){He=he.createTexture(),he.bindTexture(3553,He),he.texImage2D(3553,0,6408,1,1,0,6408,5126,null);var st=he.createFramebuffer();if(he.bindFramebuffer(36160,st),he.framebufferTexture2D(36160,36064,3553,He,0),he.bindTexture(3553,null),36053!==he.checkFramebufferStatus(36160))He=!1;else{he.viewport(0,0,1,1),he.clearColor(1,0,0,1),he.clear(16384);var ot=le.allocType(5126,4);he.readPixels(0,0,1,1,6408,5126,ot),he.getError()?He=!1:(he.deleteFramebuffer(st),he.deleteTexture(He),He=1===ot[0]),le.freeType(ot)}}return ot=!0,typeof navigator<"u"&&(/MSIE/.test(navigator.userAgent)||/Trident\//.test(navigator.appVersion)||/Edge/.test(navigator.userAgent))||(ot=he.createTexture(),st=le.allocType(5121,36),he.activeTexture(33984),he.bindTexture(34067,ot),he.texImage2D(34069,0,6408,3,3,0,6408,5121,st),le.freeType(st),he.bindTexture(34067,null),he.deleteTexture(ot),ot=!he.getError()),{colorBits:[he.getParameter(3410),he.getParameter(3411),he.getParameter(3412),he.getParameter(3413)],depthBits:he.getParameter(3414),stencilBits:he.getParameter(3415),subpixelBits:he.getParameter(3408),extensions:Object.keys(ye).filter(function(wt){return!!ye[wt]}),maxAnisotropic:Be,maxDrawbuffers:Ge,maxColorAttachments:Je,pointSizeDims:he.getParameter(33901),lineWidthDims:he.getParameter(33902),maxViewportDims:he.getParameter(3386),maxCombinedTextureUnits:he.getParameter(35661),maxCubeMapSize:he.getParameter(34076),maxRenderbufferSize:he.getParameter(34024),maxTextureUnits:he.getParameter(34930),maxTextureSize:he.getParameter(3379),maxAttributes:he.getParameter(34921),maxVertexUniforms:he.getParameter(36347),maxVertexTextureUnits:he.getParameter(35660),maxVaryingVectors:he.getParameter(36348),maxFragmentUniforms:he.getParameter(36349),glsl:he.getParameter(35724),renderer:he.getParameter(7937),vendor:he.getParameter(7936),version:he.getParameter(7938),readFloat:He,npotTextureCube:ot}}(kt,At)),Jt=function f(he,ye,Be,Ge){function Je(ft){this.id=wt++,this.buffer=he.createBuffer(),this.type=ft,this.usage=35044,this.byteLength=0,this.dimension=1,this.dtype=5121,this.persistentData=null,Be.profile&&(this.stats={size:0})}function He(ft,Rt,kt){ft.byteLength=Rt.byteLength,he.bufferData(ft.type,Rt,kt)}function st(ft,Rt,kt,Lt,Ee,Ye){if(ft.usage=kt,Array.isArray(Rt)){if(ft.dtype=Lt||5126,0<Rt.length)if(Array.isArray(Rt[0])){Ee=fe(Rt);for(var it=Lt=1;it<Ee.length;++it)Lt*=Ee[it];ft.dimension=Lt,He(ft,Rt=Oe(Rt,Ee,ft.dtype),kt),Ye?ft.persistentData=Rt:le.freeType(Rt)}else"number"==typeof Rt[0]?(ft.dimension=Ee,i(Ee=le.allocType(ft.dtype,Rt.length),Rt),He(ft,Ee,kt),Ye?ft.persistentData=Ee:le.freeType(Ee)):de(Rt[0])&&(ft.dimension=Rt[0].length,ft.dtype=Lt||s(Rt[0])||5126,He(ft,Rt=Oe(Rt,[Rt.length,Rt[0].length],ft.dtype),kt),Ye?ft.persistentData=Rt:le.freeType(Rt))}else if(de(Rt))ft.dtype=Lt||s(Rt),ft.dimension=Ee,He(ft,Rt,kt),Ye&&(ft.persistentData=new Uint8Array(new Uint8Array(Rt.buffer)));else if(r(Rt)){var ht=Rt.stride,At=(it=Rt.offset,0),Ft=0,Gt=0,jt=0;1===(Ee=Rt.shape).length?(At=Ee[0],Ft=1,Gt=ht[0],jt=0):2===Ee.length&&(At=Ee[0],Ft=Ee[1],Gt=ht[0],jt=ht[1]),ft.dtype=Lt||s(Rt.data)||5126,ft.dimension=Ft,u(Ee=le.allocType(ft.dtype,At*Ft),Rt.data,At,Ft,Gt,jt,it),He(ft,Ee,kt),Ye?ft.persistentData=Ee:le.freeType(Ee)}else Rt instanceof ArrayBuffer&&(ft.dtype=5121,ft.dimension=Ee,He(ft,Rt,kt),Ye&&(ft.persistentData=new Uint8Array(new Uint8Array(Rt))))}function ot(ft){ye.bufferCount--,Ge(ft),he.deleteBuffer(ft.buffer),ft.buffer=null,delete Ct[ft.id]}var wt=0,Ct={};Je.prototype.bind=function(){he.bindBuffer(this.type,this.buffer)},Je.prototype.destroy=function(){ot(this)};var rt=[];return Be.profile&&(ye.getTotalBufferSize=function(){var ft=0;return Object.keys(Ct).forEach(function(Rt){ft+=Ct[Rt].stats.size}),ft}),{create:function(ft,Rt,kt,Lt){function Ee(it){var ht=35044,At=null,Ft=0,Gt=0,jt=1;return Array.isArray(it)||de(it)||r(it)||it instanceof ArrayBuffer?At=it:"number"==typeof it?Ft=0|it:it&&("data"in it&&(At=it.data),"usage"in it&&(ht=we[it.usage]),"type"in it&&(Gt=Te[it.type]),"dimension"in it&&(jt=0|it.dimension),"length"in it&&(Ft=0|it.length)),Ye.bind(),At?st(Ye,At,ht,Gt,jt,Lt):(Ft&&he.bufferData(Ye.type,Ft,ht),Ye.dtype=Gt||5121,Ye.usage=ht,Ye.dimension=jt,Ye.byteLength=Ft),Be.profile&&(Ye.stats.size=Ye.byteLength*ve[Ye.dtype]),Ee}ye.bufferCount++;var Ye=new Je(Rt);return Ct[Ye.id]=Ye,kt||Ee(ft),Ee._reglType="buffer",Ee._buffer=Ye,Ee.subdata=function(it,ht){var At,Ft=0|(ht||0);if(Ye.bind(),de(it)||it instanceof ArrayBuffer)he.bufferSubData(Ye.type,Ft,it);else if(Array.isArray(it)){if(0<it.length)if("number"==typeof it[0]){var Gt=le.allocType(Ye.dtype,it.length);i(Gt,it),he.bufferSubData(Ye.type,Ft,Gt),le.freeType(Gt)}else(Array.isArray(it[0])||de(it[0]))&&(At=fe(it),Gt=Oe(it,At,Ye.dtype),he.bufferSubData(Ye.type,Ft,Gt),le.freeType(Gt))}else if(r(it)){var jt=it.stride,fr=Gt=0,kr=0,ur=0;1===(At=it.shape).length?(Gt=At[0],fr=1,kr=jt[0],ur=0):2===At.length&&(Gt=At[0],fr=At[1],kr=jt[0],ur=jt[1]),At=Array.isArray(it.data)?Ye.dtype:s(it.data),u(At=le.allocType(At,Gt*fr),it.data,Gt,fr,kr,ur,it.offset),he.bufferSubData(Ye.type,Ft,At),le.freeType(At)}return Ee},Be.profile&&(Ee.stats=Ye.stats),Ee.destroy=function(){ot(Ye)},Ee},createStream:function(ft,Rt){var kt=rt.pop();return kt||(kt=new Je(ft)),kt.bind(),st(kt,Rt,35040,0,1,!1),kt},destroyStream:function(ft){rt.push(ft)},clear:function(){se(Ct).forEach(ot),rt.forEach(ot)},getBuffer:function(ft){return ft&&ft._buffer instanceof Je?ft._buffer:null},restore:function(){se(Ct).forEach(function(ft){ft.buffer=he.createBuffer(),he.bindBuffer(ft.type,ft.buffer),he.bufferData(ft.type,ft.persistentData||ft.byteLength,ft.usage)})},_initBuffer:st}}(kt,it,he,function(Rr){return Qt.destroyBuffer(Rr)}),$t=function c(he,ye,Be,Ge){function Je(ft){this.id=wt++,ot[this.id]=this,this.buffer=ft,this.primType=4,this.type=this.vertCount=0}function He(ft,Rt,kt,Lt,Ee,Ye,it){var ht;if(ft.buffer.bind(),Rt?((ht=it)||de(Rt)&&(!r(Rt)||de(Rt.data))||(ht=ye.oes_element_index_uint?5125:5123),Be._initBuffer(ft.buffer,Rt,kt,ht,3)):(he.bufferData(34963,Ye,kt),ft.buffer.dtype=ht||5121,ft.buffer.usage=kt,ft.buffer.dimension=3,ft.buffer.byteLength=Ye),ht=it,!it){switch(ft.buffer.dtype){case 5121:case 5120:ht=5121;break;case 5123:case 5122:ht=5123;break;case 5125:case 5124:ht=5125}ft.buffer.dtype=ht}ft.type=ht,0>(Rt=Ee)&&(Rt=ft.buffer.byteLength,5123===ht?Rt>>=1:5125===ht&&(Rt>>=2)),ft.vertCount=Rt,Rt=Lt,0>Lt&&(Rt=4,1===(Lt=ft.buffer.dimension)&&(Rt=0),2===Lt&&(Rt=1),3===Lt&&(Rt=4)),ft.primType=Rt}function st(ft){Ge.elementsCount--,delete ot[ft.id],ft.buffer.destroy(),ft.buffer=null}var ot={},wt=0,Ct={uint8:5121,uint16:5123};ye.oes_element_index_uint&&(Ct.uint32=5125),Je.prototype.bind=function(){this.buffer.bind()};var rt=[];return{create:function(ft,Rt){function kt(Ye){if(Ye)if("number"==typeof Ye)Lt(Ye),Ee.primType=4,Ee.vertCount=0|Ye,Ee.type=5121;else{var it=null,ht=35044,At=-1,Ft=-1,Gt=0,jt=0;Array.isArray(Ye)||de(Ye)||r(Ye)?it=Ye:("data"in Ye&&(it=Ye.data),"usage"in Ye&&(ht=we[Ye.usage]),"primitive"in Ye&&(At=Ae[Ye.primitive]),"count"in Ye&&(Ft=0|Ye.count),"type"in Ye&&(jt=Ct[Ye.type]),"length"in Ye?Gt=0|Ye.length:(Gt=Ft,5123===jt||5122===jt?Gt*=2:5125!==jt&&5124!==jt||(Gt*=4))),He(Ee,it,ht,At,Ft,Gt,jt)}else Lt(),Ee.primType=4,Ee.vertCount=0,Ee.type=5121;return kt}var Lt=Be.create(null,34963,!0),Ee=new Je(Lt._buffer);return Ge.elementsCount++,kt(ft),kt._reglType="elements",kt._elements=Ee,kt.subdata=function(Ye,it){return Lt.subdata(Ye,it),kt},kt.destroy=function(){st(Ee)},kt},createStream:function(ft){var Rt=rt.pop();return Rt||(Rt=new Je(Be.create(null,34963,!0,!1)._buffer)),He(Rt,ft,35040,-1,-1,0,0),Rt},destroyStream:function(ft){rt.push(ft)},getElements:function(ft){return"function"==typeof ft&&ft._elements instanceof Je?ft._elements:null},clear:function(){se(ot).forEach(st)}}}(kt,At,Jt,it),Qt=function P(he,ye,Be,Ge,Je,He,st){function ot(){this.id=++rt,this.attributes=[],this.elements=null,this.ownsElements=!1,this.offset=this.count=0,this.instances=-1,this.primitive=4;var kt=ye.oes_vertex_array_object;this.vao=kt?kt.createVertexArrayOES():null,ft[this.id]=this,this.buffers=[]}var wt=Be.maxAttributes,Ct=Array(wt);for(Be=0;Be<wt;++Be)Ct[Be]=new I;var rt=0,ft={},Rt={Record:I,scope:{},state:Ct,currentVAO:null,targetVAO:null,restore:ye.oes_vertex_array_object?function(){ye.oes_vertex_array_object&&se(ft).forEach(function(kt){kt.refresh()})}:function(){},createVAO:function(kt){function Lt(Ye){var it;Array.isArray(Ye)?(it=Ye,Ee.elements&&Ee.ownsElements&&Ee.elements.destroy(),Ee.elements=null,Ee.ownsElements=!1,Ee.offset=0,Ee.count=0,Ee.instances=-1,Ee.primitive=4):(Ye.elements?(it=Ye.elements,Ee.ownsElements?("function"==typeof it&&"elements"===it._reglType?Ee.elements.destroy():Ee.elements(it),Ee.ownsElements=!1):He.getElements(Ye.elements)?(Ee.elements=Ye.elements,Ee.ownsElements=!1):(Ee.elements=He.create(Ye.elements),Ee.ownsElements=!0)):(Ee.elements=null,Ee.ownsElements=!1),it=Ye.attributes,Ee.offset=0,Ee.count=-1,Ee.instances=-1,Ee.primitive=4,Ee.elements&&(Ee.count=Ee.elements._elements.vertCount,Ee.primitive=Ee.elements._elements.primType),"offset"in Ye&&(Ee.offset=0|Ye.offset),"count"in Ye&&(Ee.count=0|Ye.count),"instances"in Ye&&(Ee.instances=0|Ye.instances),"primitive"in Ye&&(Ee.primitive=Ae[Ye.primitive])),Ye={};var ht=Ee.attributes;ht.length=it.length;for(var At=0;At<it.length;++At){var Ft,Gt=it[At],jt=ht[At]=new I,fr=Gt.data||Gt;Array.isArray(fr)||de(fr)||r(fr)?(Ee.buffers[At]&&(Ft=Ee.buffers[At],de(fr)&&Ft._buffer.byteLength>=fr.byteLength?Ft.subdata(fr):(Ft.destroy(),Ee.buffers[At]=null)),Ee.buffers[At]||(Ft=Ee.buffers[At]=Je.create(Gt,34962,!1,!0)),jt.buffer=Je.getBuffer(Ft),jt.size=0|jt.buffer.dimension,jt.normalized=!1,jt.type=jt.buffer.dtype,jt.offset=0,jt.stride=0,jt.divisor=0,jt.state=1,Ye[At]=1):Je.getBuffer(Gt)?(jt.buffer=Je.getBuffer(Gt),jt.size=0|jt.buffer.dimension,jt.normalized=!1,jt.type=jt.buffer.dtype,jt.offset=0,jt.stride=0,jt.divisor=0,jt.state=1):Je.getBuffer(Gt.buffer)?(jt.buffer=Je.getBuffer(Gt.buffer),jt.size=0|(+Gt.size||jt.buffer.dimension),jt.normalized=!!Gt.normalized||!1,jt.type="type"in Gt?Te[Gt.type]:jt.buffer.dtype,jt.offset=0|(Gt.offset||0),jt.stride=0|(Gt.stride||0),jt.divisor=0|(Gt.divisor||0),jt.state=1):"x"in Gt&&(jt.x=+Gt.x||0,jt.y=+Gt.y||0,jt.z=+Gt.z||0,jt.w=+Gt.w||0,jt.state=2)}for(Ft=0;Ft<Ee.buffers.length;++Ft)!Ye[Ft]&&Ee.buffers[Ft]&&(Ee.buffers[Ft].destroy(),Ee.buffers[Ft]=null);return Ee.refresh(),Lt}var Ee=new ot;return Ge.vaoCount+=1,Lt.destroy=function(){for(var Ye=0;Ye<Ee.buffers.length;++Ye)Ee.buffers[Ye]&&Ee.buffers[Ye].destroy();Ee.buffers.length=0,Ee.ownsElements&&(Ee.elements.destroy(),Ee.elements=null,Ee.ownsElements=!1),Ee.destroy()},Lt._vao=Ee,Lt._reglType="vao",Lt(kt)},getVAO:function(kt){return"function"==typeof kt&&kt._vao?kt._vao:null},destroyBuffer:function(kt){for(var Lt=0;Lt<Ct.length;++Lt){var Ee=Ct[Lt];Ee.buffer===kt&&(he.disableVertexAttribArray(Lt),Ee.buffer=null)}},setVAO:ye.oes_vertex_array_object?function(kt){kt!==Rt.currentVAO&&(ye.oes_vertex_array_object.bindVertexArrayOES(kt?kt.vao:null),Rt.currentVAO=kt)}:function(kt){if(kt!==Rt.currentVAO){if(kt)kt.bindAttrs();else{for(var Lt=ye.angle_instanced_arrays,Ee=0;Ee<Ct.length;++Ee){var Ye=Ct[Ee];Ye.buffer?(he.enableVertexAttribArray(Ee),Ye.buffer.bind(),he.vertexAttribPointer(Ee,Ye.size,Ye.type,Ye.normalized,Ye.stride,Ye.offfset),Lt&&Ye.divisor&&Lt.vertexAttribDivisorANGLE(Ee,Ye.divisor)):(he.disableVertexAttribArray(Ee),he.vertexAttrib4f(Ee,Ye.x,Ye.y,Ye.z,Ye.w))}he.bindBuffer(34963,st.elements?st.elements.buffer.buffer:null)}Rt.currentVAO=kt}},clear:ye.oes_vertex_array_object?function(){se(ft).forEach(function(kt){kt.destroy()})}:function(){}};return ot.prototype.bindAttrs=function(){for(var kt=ye.angle_instanced_arrays,Lt=this.attributes,Ee=0;Ee<Lt.length;++Ee){var Ye=Lt[Ee];Ye.buffer?(he.enableVertexAttribArray(Ee),he.bindBuffer(34962,Ye.buffer.buffer),he.vertexAttribPointer(Ee,Ye.size,Ye.type,Ye.normalized,Ye.stride,Ye.offset),kt&&Ye.divisor&&kt.vertexAttribDivisorANGLE(Ee,Ye.divisor)):(he.disableVertexAttribArray(Ee),he.vertexAttrib4f(Ee,Ye.x,Ye.y,Ye.z,Ye.w))}for(kt=Lt.length;kt<wt;++kt)he.disableVertexAttribArray(kt);(kt=He.getElements(this.elements))?he.bindBuffer(34963,kt.buffer.buffer):he.bindBuffer(34963,null)},ot.prototype.refresh=function(){var kt=ye.oes_vertex_array_object;kt&&(kt.bindVertexArrayOES(this.vao),this.bindAttrs(),Rt.currentVAO=null,kt.bindVertexArrayOES(null))},ot.prototype.destroy=function(){if(this.vao){var kt=ye.oes_vertex_array_object;this===Rt.currentVAO&&(Rt.currentVAO=null,kt.bindVertexArrayOES(null)),kt.deleteVertexArrayOES(this.vao),this.vao=null}this.ownsElements&&(this.elements.destroy(),this.elements=null,this.ownsElements=!1),ft[this.id]&&(delete ft[this.id],--Ge.vaoCount)},Rt}(kt,At,ur,it,Jt,$t,jt),cr=function S(he,ye,Be,Ge){function Je(Lt,Ee,Ye,it){this.name=Lt,this.id=Ee,this.location=Ye,this.info=it}function He(Lt,Ee){for(var Ye=0;Ye<Lt.length;++Ye)if(Lt[Ye].id===Ee.id)return void(Lt[Ye].location=Ee.location);Lt.push(Ee)}function st(Lt,Ee,Ye){if(!(ht=(Ye=35632===Lt?Ct:rt)[Ee])){var it=ye.str(Ee),ht=he.createShader(Lt);he.shaderSource(ht,it),he.compileShader(ht),Ye[Ee]=ht}return ht}function ot(Lt,Ee){this.id=kt++,this.fragId=Lt,this.vertId=Ee,this.program=null,this.uniforms=[],this.attributes=[],this.refCount=1,Ge.profile&&(this.stats={uniformsCount:0,attributesCount:0})}function wt(Lt,Ee,Ye){var it;it=st(35632,Lt.fragId);var ht=st(35633,Lt.vertId);if(Ee=Lt.program=he.createProgram(),he.attachShader(Ee,it),he.attachShader(Ee,ht),Ye)for(it=0;it<Ye.length;++it)he.bindAttribLocation(Ee,(ht=Ye[it])[0],ht[1]);he.linkProgram(Ee),ht=he.getProgramParameter(Ee,35718),Ge.profile&&(Lt.stats.uniformsCount=ht);var At=Lt.uniforms;for(it=0;it<ht;++it)if(Ye=he.getActiveUniform(Ee,it))if(1<Ye.size)for(var Ft=0;Ft<Ye.size;++Ft){var Gt=Ye.name.replace("[0]","["+Ft+"]");He(At,new Je(Gt,ye.id(Gt),he.getUniformLocation(Ee,Gt),Ye))}else He(At,new Je(Ye.name,ye.id(Ye.name),he.getUniformLocation(Ee,Ye.name),Ye));for(ht=he.getProgramParameter(Ee,35721),Ge.profile&&(Lt.stats.attributesCount=ht),Lt=Lt.attributes,it=0;it<ht;++it)(Ye=he.getActiveAttrib(Ee,it))&&He(Lt,new Je(Ye.name,ye.id(Ye.name),he.getAttribLocation(Ee,Ye.name),Ye))}var Ct={},rt={},ft={},Rt=[],kt=0;return Ge.profile&&(Be.getMaxUniformsCount=function(){var Lt=0;return Rt.forEach(function(Ee){Ee.stats.uniformsCount>Lt&&(Lt=Ee.stats.uniformsCount)}),Lt},Be.getMaxAttributesCount=function(){var Lt=0;return Rt.forEach(function(Ee){Ee.stats.attributesCount>Lt&&(Lt=Ee.stats.attributesCount)}),Lt}),{clear:function(){var Lt=he.deleteShader.bind(he);se(Ct).forEach(Lt),Ct={},se(rt).forEach(Lt),rt={},Rt.forEach(function(Ee){he.deleteProgram(Ee.program)}),Rt.length=0,ft={},Be.shaderCount=0},program:function(Lt,Ee,Ye,it){var ht=ft[Ee];ht||(ht=ft[Ee]={});var At=ht[Lt];if(At&&(At.refCount++,!it))return At;var Ft=new ot(Ee,Lt);return Be.shaderCount++,wt(Ft,Ye,it),At||(ht[Lt]=Ft),Rt.push(Ft),j(Ft,{destroy:function(){if(Ft.refCount--,0>=Ft.refCount){he.deleteProgram(Ft.program);var Gt=Rt.indexOf(Ft);Rt.splice(Gt,1),Be.shaderCount--}0>=ht[Ft.vertId].refCount&&(he.deleteShader(rt[Ft.vertId]),delete rt[Ft.vertId],delete ft[Ft.fragId][Ft.vertId]),Object.keys(ft[Ft.fragId]).length||(he.deleteShader(Ct[Ft.fragId]),delete Ct[Ft.fragId],delete ft[Ft.fragId])}})},restore:function(){Ct={},rt={};for(var Lt=0;Lt<Rt.length;++Lt)wt(Rt[Lt],null,Rt[Lt].attributes.map(function(Ee){return[Ee.location,Ee.name]}))},shader:st,frag:-1,vert:-1}}(kt,Ye,it,he),gr=function L(he,ye,Be,Ge,Je,He,st){function ot(){this.format=this.internalformat=6408,this.type=5121,this.flipY=this.premultiplyAlpha=this.compressed=!1,this.unpackAlignment=1,this.colorSpace=37444,this.channels=this.height=this.width=0}function wt(tr,mr){tr.internalformat=mr.internalformat,tr.format=mr.format,tr.type=mr.type,tr.compressed=mr.compressed,tr.premultiplyAlpha=mr.premultiplyAlpha,tr.flipY=mr.flipY,tr.unpackAlignment=mr.unpackAlignment,tr.colorSpace=mr.colorSpace,tr.width=mr.width,tr.height=mr.height,tr.channels=mr.channels}function Ct(tr,mr){if("object"==typeof mr&&mr){"premultiplyAlpha"in mr&&(tr.premultiplyAlpha=mr.premultiplyAlpha),"flipY"in mr&&(tr.flipY=mr.flipY),"alignment"in mr&&(tr.unpackAlignment=mr.alignment),"colorSpace"in mr&&(tr.colorSpace=Nr[mr.colorSpace]),"type"in mr&&(tr.type=Xr[mr.type]);var Pt=tr.width,or=tr.height,hr=tr.channels,zr=!1;"shape"in mr?(Pt=mr.shape[0],or=mr.shape[1],3===mr.shape.length&&(hr=mr.shape[2],zr=!0)):("radius"in mr&&(Pt=or=mr.radius),"width"in mr&&(Pt=mr.width),"height"in mr&&(or=mr.height),"channels"in mr&&(hr=mr.channels,zr=!0)),tr.width=0|Pt,tr.height=0|or,tr.channels=0|hr,Pt=!1,"format"in mr&&(or=tr.internalformat=un[Pt=mr.format],tr.format=nn[or],Pt in Xr&&!("type"in mr)&&(tr.type=Xr[Pt]),Pt in $r&&(tr.compressed=!0),Pt=!0),!zr&&Pt?tr.channels=ze[tr.format]:zr&&!Pt&&tr.channels!==De[tr.format]&&(tr.format=tr.internalformat=De[tr.channels])}}function rt(tr){he.pixelStorei(37440,tr.flipY),he.pixelStorei(37441,tr.premultiplyAlpha),he.pixelStorei(37443,tr.colorSpace),he.pixelStorei(3317,tr.unpackAlignment)}function ft(){ot.call(this),this.yOffset=this.xOffset=0,this.data=null,this.needsFree=!1,this.element=null,this.needsCopy=!1}function Rt(tr,mr){var Pt=null;if(_(mr)?Pt=mr:mr&&(Ct(tr,mr),"x"in mr&&(tr.xOffset=0|mr.x),"y"in mr&&(tr.yOffset=0|mr.y),_(mr.data)&&(Pt=mr.data)),mr.copy){var or=Je.viewportWidth,hr=Je.viewportHeight;tr.width=tr.width||or-tr.xOffset,tr.height=tr.height||hr-tr.yOffset,tr.needsCopy=!0}else if(Pt){if(de(Pt))tr.channels=tr.channels||4,tr.data=Pt,"type"in mr||5121!==tr.type||(tr.type=0|_e[Object.prototype.toString.call(Pt)]);else if(b(Pt)){switch(tr.channels=tr.channels||4,hr=(or=Pt).length,tr.type){case 5121:case 5123:case 5125:case 5126:(hr=le.allocType(tr.type,hr)).set(or),tr.data=hr;break;case 36193:tr.data=h(or)}tr.alignment=1,tr.needsFree=!0}else if(r(Pt)){or=Pt.data,Array.isArray(or)||5121!==tr.type||(tr.type=0|_e[Object.prototype.toString.call(or)]);var zr,Dr,Ir,Mr,vr=Pt.stride;3===(hr=Pt.shape).length?(Ir=hr[2],Mr=vr[2]):Mr=Ir=1,zr=hr[0],Dr=hr[1],hr=vr[0],vr=vr[1],tr.alignment=1,tr.width=zr,tr.height=Dr,tr.channels=Ir,tr.format=tr.internalformat=De[Ir],tr.needsFree=!0,zr=Mr,Pt=Pt.offset;for(var xr=le.allocType(36193===tr.type?5126:tr.type,(Ir=tr.width)*(Mr=tr.height)*(Dr=tr.channels)),wr=0,Er=0;Er<Mr;++Er)for(var qr=0;qr<Ir;++qr)for(var Vr=0;Vr<Dr;++Vr)xr[wr++]=or[hr*qr+vr*Er+zr*Vr+Pt];w(tr,xr)}else if(T(Pt)===Me||T(Pt)===Se||T(Pt)===Ie)tr.element=T(Pt)===Me||T(Pt)===Se?Pt:Pt.canvas,tr.width=tr.element.width,tr.height=tr.element.height,tr.channels=4;else if(T(Pt)===Fe)tr.element=Pt,tr.width=Pt.width,tr.height=Pt.height,tr.channels=4;else if(T(Pt)===Re)tr.element=Pt,tr.width=Pt.naturalWidth,tr.height=Pt.naturalHeight,tr.channels=4;else if(T(Pt)===Xe)tr.element=Pt,tr.width=Pt.videoWidth,tr.height=Pt.videoHeight,tr.channels=4;else if(l(Pt)){for(or=tr.width||Pt[0].length,hr=tr.height||Pt.length,vr=tr.channels,vr=p(Pt[0][0])?vr||Pt[0][0].length:vr||1,zr=ge.shape(Pt),Ir=1,Mr=0;Mr<zr.length;++Mr)Ir*=zr[Mr];Ir=le.allocType(36193===tr.type?5126:tr.type,Ir),ge.flatten(Pt,zr,"",Ir),w(tr,Ir),tr.alignment=1,tr.width=or,tr.height=hr,tr.channels=vr,tr.format=tr.internalformat=De[vr],tr.needsFree=!0}}else tr.width=tr.width||1,tr.height=tr.height||1,tr.channels=tr.channels||4}function kt(tr,mr,Pt,or,hr){var zr=tr.element,Dr=tr.data,Ir=tr.internalformat,Mr=tr.format,vr=tr.type,xr=tr.width,wr=tr.height;rt(tr),zr?he.texSubImage2D(mr,hr,Pt,or,Mr,vr,zr):tr.compressed?he.compressedTexSubImage2D(mr,hr,Pt,or,Ir,xr,wr,Dr):tr.needsCopy?(Ge(),he.copyTexSubImage2D(mr,hr,Pt,or,tr.xOffset,tr.yOffset,xr,wr)):he.texSubImage2D(mr,hr,Pt,or,xr,wr,Mr,vr,Dr)}function Lt(){return Hr.pop()||new ft}function Ee(tr){tr.needsFree&&le.freeType(tr.data),ft.call(tr),Hr.push(tr)}function Ye(){ot.call(this),this.genMipmaps=!1,this.mipmapHint=4352,this.mipmask=0,this.images=Array(16)}function it(tr,mr,Pt){var or=tr.images[0]=Lt();tr.mipmask=1,or.width=tr.width=mr,or.height=tr.height=Pt,or.channels=tr.channels=4}function ht(tr,mr){var Pt=null;if(_(mr))wt(Pt=tr.images[0]=Lt(),tr),Rt(Pt,mr),tr.mipmask=1;else if(Ct(tr,mr),Array.isArray(mr.mipmap))for(var or=mr.mipmap,hr=0;hr<or.length;++hr)wt(Pt=tr.images[hr]=Lt(),tr),Pt.width>>=hr,Pt.height>>=hr,Rt(Pt,or[hr]),tr.mipmask|=1<<hr;else wt(Pt=tr.images[0]=Lt(),tr),Rt(Pt,mr),tr.mipmask=1;wt(tr,tr.images[0])}function At(tr,mr){for(var Pt=tr.images,or=0;or<Pt.length&&Pt[or];++or){var hr=Pt[or],zr=mr,Dr=or,Ir=hr.element,Mr=hr.data,vr=hr.internalformat,xr=hr.format,wr=hr.type,Er=hr.width,qr=hr.height;rt(hr),Ir?he.texImage2D(zr,Dr,xr,xr,wr,Ir):hr.compressed?he.compressedTexImage2D(zr,Dr,vr,Er,qr,0,Mr):hr.needsCopy?(Ge(),he.copyTexImage2D(zr,Dr,xr,hr.xOffset,hr.yOffset,Er,qr,0)):he.texImage2D(zr,Dr,xr,Er,qr,0,xr,wr,Mr||null)}}function Ft(){var tr=Fn.pop()||new Ye;ot.call(tr);for(var mr=tr.mipmask=0;16>mr;++mr)tr.images[mr]=null;return tr}function Gt(tr){for(var mr=tr.images,Pt=0;Pt<mr.length;++Pt)mr[Pt]&&Ee(mr[Pt]),mr[Pt]=null;Fn.push(tr)}function jt(){this.magFilter=this.minFilter=9728,this.wrapT=this.wrapS=33071,this.anisotropic=1,this.genMipmaps=!1,this.mipmapHint=4352}function fr(tr,mr){"min"in mr&&(tr.minFilter=Fr[mr.min],0<=Ne.indexOf(tr.minFilter)&&!("faces"in mr)&&(tr.genMipmaps=!0)),"mag"in mr&&(tr.magFilter=Tr[mr.mag]);var Pt=tr.wrapS,or=tr.wrapT;if("wrap"in mr){var hr=mr.wrap;"string"==typeof hr?Pt=or=gr[hr]:Array.isArray(hr)&&(Pt=gr[hr[0]],or=gr[hr[1]])}else"wrapS"in mr&&(Pt=gr[mr.wrapS]),"wrapT"in mr&&(or=gr[mr.wrapT]);if(tr.wrapS=Pt,tr.wrapT=or,"anisotropic"in mr&&(tr.anisotropic=mr.anisotropic),"mipmap"in mr){switch(Pt=!1,typeof mr.mipmap){case"string":tr.mipmapHint=cr[mr.mipmap],Pt=tr.genMipmaps=!0;break;case"boolean":Pt=tr.genMipmaps=mr.mipmap;break;case"object":tr.genMipmaps=!1,Pt=!0}!Pt||"min"in mr||(tr.minFilter=9984)}}function kr(tr,mr){he.texParameteri(mr,10241,tr.minFilter),he.texParameteri(mr,10240,tr.magFilter),he.texParameteri(mr,10242,tr.wrapS),he.texParameteri(mr,10243,tr.wrapT),ye.ext_texture_filter_anisotropic&&he.texParameteri(mr,34046,tr.anisotropic),tr.genMipmaps&&(he.hint(33170,tr.mipmapHint),he.generateMipmap(mr))}function ur(tr){ot.call(this),this.mipmask=0,this.internalformat=6408,this.id=Un++,this.refCount=1,this.target=tr,this.texture=he.createTexture(),this.unit=-1,this.bindCount=0,this.texInfo=new jt,st.profile&&(this.stats={size:0})}function Jt(tr){he.activeTexture(33984),he.bindTexture(tr.target,tr.texture)}function $t(){var tr=li[0];tr?he.bindTexture(tr.target,tr.texture):he.bindTexture(3553,null)}function Qt(tr){var mr=tr.texture,Pt=tr.unit,or=tr.target;0<=Pt&&(he.activeTexture(33984+Pt),he.bindTexture(or,null),li[Pt]=null),he.deleteTexture(mr),tr.texture=null,tr.params=null,tr.pixels=null,tr.refCount=0,delete vn[tr.id],He.textureCount--}var cr={"don't care":4352,"dont care":4352,nice:4354,fast:4353},gr={repeat:10497,clamp:33071,mirror:33648},Tr={nearest:9728,linear:9729},Fr=j({mipmap:9987,"nearest mipmap nearest":9984,"linear mipmap nearest":9985,"nearest mipmap linear":9986,"linear mipmap linear":9987},Tr),Nr={none:0,browser:37444},Xr={uint8:5121,rgba4:32819,rgb565:33635,"rgb5 a1":32820},un={alpha:6406,luminance:6409,"luminance alpha":6410,rgb:6407,rgba:6408,rgba4:32854,"rgb5 a1":32855,rgb565:36194},$r={};ye.ext_srgb&&(un.srgb=35904,un.srgba=35906),ye.oes_texture_float&&(Xr.float32=Xr.float=5126),ye.oes_texture_half_float&&(Xr.float16=Xr["half float"]=36193),ye.webgl_depth_texture&&(j(un,{depth:6402,"depth stencil":34041}),j(Xr,{uint16:5123,uint32:5125,"depth stencil":34042})),ye.webgl_compressed_texture_s3tc&&j($r,{"rgb s3tc dxt1":33776,"rgba s3tc dxt1":33777,"rgba s3tc dxt3":33778,"rgba s3tc dxt5":33779}),ye.webgl_compressed_texture_atc&&j($r,{"rgb atc":35986,"rgba atc explicit alpha":35987,"rgba atc interpolated alpha":34798}),ye.webgl_compressed_texture_pvrtc&&j($r,{"rgb pvrtc 4bppv1":35840,"rgb pvrtc 2bppv1":35841,"rgba pvrtc 4bppv1":35842,"rgba pvrtc 2bppv1":35843}),ye.webgl_compressed_texture_etc1&&($r["rgb etc1"]=36196);var Pn=Array.prototype.slice.call(he.getParameter(34467));Object.keys($r).forEach(function(tr){var mr=$r[tr];0<=Pn.indexOf(mr)&&(un[tr]=mr)});var gn=Object.keys(un);Be.textureFormats=gn;var dn=[];Object.keys(un).forEach(function(tr){dn[un[tr]]=tr});var An=[];Object.keys(Xr).forEach(function(tr){An[Xr[tr]]=tr});var Zn=[];Object.keys(Tr).forEach(function(tr){Zn[Tr[tr]]=tr});var Rr=[];Object.keys(Fr).forEach(function(tr){Rr[Fr[tr]]=tr});var hn=[];Object.keys(gr).forEach(function(tr){hn[gr[tr]]=tr});var nn=gn.reduce(function(tr,mr){var Pt=un[mr];return tr[Pt]=6409===Pt||6406===Pt||6409===Pt||6410===Pt||6402===Pt||34041===Pt||ye.ext_srgb&&(35904===Pt||35906===Pt)?Pt:32855===Pt||0<=mr.indexOf("rgba")?6408:6407,tr},{}),Hr=[],Fn=[],Un=0,vn={},Cn=Be.maxTextureUnits,li=Array(Cn).map(function(){return null});return j(ur.prototype,{bind:function(){this.bindCount+=1;var tr=this.unit;if(0>tr){for(var mr=0;mr<Cn;++mr){var Pt=li[mr];if(Pt){if(0<Pt.bindCount)continue;Pt.unit=-1}li[mr]=this,tr=mr;break}st.profile&&He.maxTextureUnits<tr+1&&(He.maxTextureUnits=tr+1),this.unit=tr,he.activeTexture(33984+tr),he.bindTexture(this.target,this.texture)}return tr},unbind:function(){--this.bindCount},decRef:function(){0>=--this.refCount&&Qt(this)}}),st.profile&&(He.getTotalTextureSize=function(){var tr=0;return Object.keys(vn).forEach(function(mr){tr+=vn[mr].stats.size}),tr}),{create2D:function(tr,mr){function Pt(hr,zr){var Dr=or.texInfo;jt.call(Dr);var Ir=Ft();return"number"==typeof hr?it(Ir,0|hr,"number"==typeof zr?0|zr:0|hr):hr?(fr(Dr,hr),ht(Ir,hr)):it(Ir,1,1),Dr.genMipmaps&&(Ir.mipmask=(Ir.width<<1)-1),or.mipmask=Ir.mipmask,wt(or,Ir),or.internalformat=Ir.internalformat,Pt.width=Ir.width,Pt.height=Ir.height,Jt(or),At(Ir,3553),kr(Dr,3553),$t(),Gt(Ir),st.profile&&(or.stats.size=k(or.internalformat,or.type,Ir.width,Ir.height,Dr.genMipmaps,!1)),Pt.format=dn[or.internalformat],Pt.type=An[or.type],Pt.mag=Zn[Dr.magFilter],Pt.min=Rr[Dr.minFilter],Pt.wrapS=hn[Dr.wrapS],Pt.wrapT=hn[Dr.wrapT],Pt}var or=new ur(3553);return vn[or.id]=or,He.textureCount++,Pt(tr,mr),Pt.subimage=function(hr,zr,Dr,Ir){zr|=0,Dr|=0,Ir|=0;var Mr=Lt();return wt(Mr,or),Mr.width=0,Mr.height=0,Rt(Mr,hr),Mr.width=Mr.width||(or.width>>Ir)-zr,Mr.height=Mr.height||(or.height>>Ir)-Dr,Jt(or),kt(Mr,3553,zr,Dr,Ir),$t(),Ee(Mr),Pt},Pt.resize=function(hr,zr){var Dr=0|hr,Ir=0|zr||Dr;if(Dr===or.width&&Ir===or.height)return Pt;Pt.width=or.width=Dr,Pt.height=or.height=Ir,Jt(or);for(var Mr=0;or.mipmask>>Mr;++Mr){var vr=Dr>>Mr,xr=Ir>>Mr;if(!vr||!xr)break;he.texImage2D(3553,Mr,or.format,vr,xr,0,or.format,or.type,null)}return $t(),st.profile&&(or.stats.size=k(or.internalformat,or.type,Dr,Ir,!1,!1)),Pt},Pt._reglType="texture2d",Pt._texture=or,st.profile&&(Pt.stats=or.stats),Pt.destroy=function(){or.decRef()},Pt},createCube:function(tr,mr,Pt,or,hr,zr){function Dr(vr,xr,wr,Er,qr,Vr){var Qr,en=Ir.texInfo;for(jt.call(en),Qr=0;6>Qr;++Qr)Mr[Qr]=Ft();if("number"!=typeof vr&&vr){if("object"==typeof vr)if(xr)ht(Mr[0],vr),ht(Mr[1],xr),ht(Mr[2],wr),ht(Mr[3],Er),ht(Mr[4],qr),ht(Mr[5],Vr);else if(fr(en,vr),Ct(Ir,vr),"faces"in vr)for(vr=vr.faces,Qr=0;6>Qr;++Qr)wt(Mr[Qr],Ir),ht(Mr[Qr],vr[Qr]);else for(Qr=0;6>Qr;++Qr)ht(Mr[Qr],vr)}else for(vr=0|vr||1,Qr=0;6>Qr;++Qr)it(Mr[Qr],vr,vr);for(wt(Ir,Mr[0]),Ir.mipmask=en.genMipmaps?(Mr[0].width<<1)-1:Mr[0].mipmask,Ir.internalformat=Mr[0].internalformat,Dr.width=Mr[0].width,Dr.height=Mr[0].height,Jt(Ir),Qr=0;6>Qr;++Qr)At(Mr[Qr],34069+Qr);for(kr(en,34067),$t(),st.profile&&(Ir.stats.size=k(Ir.internalformat,Ir.type,Dr.width,Dr.height,en.genMipmaps,!0)),Dr.format=dn[Ir.internalformat],Dr.type=An[Ir.type],Dr.mag=Zn[en.magFilter],Dr.min=Rr[en.minFilter],Dr.wrapS=hn[en.wrapS],Dr.wrapT=hn[en.wrapT],Qr=0;6>Qr;++Qr)Gt(Mr[Qr]);return Dr}var Ir=new ur(34067);vn[Ir.id]=Ir,He.cubeCount++;var Mr=Array(6);return Dr(tr,mr,Pt,or,hr,zr),Dr.subimage=function(vr,xr,wr,Er,qr){wr|=0,Er|=0,qr|=0;var Vr=Lt();return wt(Vr,Ir),Vr.width=0,Vr.height=0,Rt(Vr,xr),Vr.width=Vr.width||(Ir.width>>qr)-wr,Vr.height=Vr.height||(Ir.height>>qr)-Er,Jt(Ir),kt(Vr,34069+vr,wr,Er,qr),$t(),Ee(Vr),Dr},Dr.resize=function(vr){if((vr|=0)!==Ir.width){Dr.width=Ir.width=vr,Dr.height=Ir.height=vr,Jt(Ir);for(var xr=0;6>xr;++xr)for(var wr=0;Ir.mipmask>>wr;++wr)he.texImage2D(34069+xr,wr,Ir.format,vr>>wr,vr>>wr,0,Ir.format,Ir.type,null);return $t(),st.profile&&(Ir.stats.size=k(Ir.internalformat,Ir.type,Dr.width,Dr.height,!1,!0)),Dr}},Dr._reglType="textureCube",Dr._texture=Ir,st.profile&&(Dr.stats=Ir.stats),Dr.destroy=function(){Ir.decRef()},Dr},clear:function(){for(var tr=0;tr<Cn;++tr)he.activeTexture(33984+tr),he.bindTexture(3553,null),li[tr]=null;se(vn).forEach(Qt),He.cubeCount=0,He.textureCount=0},getTexture:function(tr){return null},restore:function(){for(var tr=0;tr<Cn;++tr){var mr=li[tr];mr&&(mr.bindCount=0,mr.unit=-1,li[tr]=null)}se(vn).forEach(function(Pt){Pt.texture=he.createTexture(),he.bindTexture(Pt.target,Pt.texture);for(var or=0;32>or;++or)if(0!=(Pt.mipmask&1<<or))if(3553===Pt.target)he.texImage2D(3553,or,Pt.internalformat,Pt.width>>or,Pt.height>>or,0,Pt.internalformat,Pt.type,null);else for(var hr=0;6>hr;++hr)he.texImage2D(34069+hr,or,Pt.internalformat,Pt.width>>or,Pt.height>>or,0,Pt.internalformat,Pt.type,null);kr(Pt.texInfo,Pt.target)})},refresh:function(){for(var tr=0;tr<Cn;++tr){var mr=li[tr];mr&&(mr.bindCount=0,mr.unit=-1,li[tr]=null),he.activeTexture(33984+tr),he.bindTexture(3553,null),he.bindTexture(34067,null)}}}}(kt,At,ur,function(){Nr.procs.poll()},kr,it,he),Tr=function(he,ye,Be,Ge,Je){function He(ft){this.id=Ct++,this.refCount=1,this.renderbuffer=ft,this.format=32854,this.height=this.width=0,Je.profile&&(this.stats={size:0})}function st(ft){var Rt=ft.renderbuffer;he.bindRenderbuffer(36161,null),he.deleteRenderbuffer(Rt),ft.renderbuffer=null,ft.refCount=0,delete rt[ft.id],Ge.renderbufferCount--}var ot={rgba4:32854,rgb565:36194,"rgb5 a1":32855,depth:33189,stencil:36168,"depth stencil":34041};ye.ext_srgb&&(ot.srgba=35907),ye.ext_color_buffer_half_float&&(ot.rgba16f=34842,ot.rgb16f=34843),ye.webgl_color_buffer_float&&(ot.rgba32f=34836);var wt=[];Object.keys(ot).forEach(function(ft){wt[ot[ft]]=ft});var Ct=0,rt={};return He.prototype.decRef=function(){0>=--this.refCount&&st(this)},Je.profile&&(Ge.getTotalRenderbufferSize=function(){var ft=0;return Object.keys(rt).forEach(function(Rt){ft+=rt[Rt].stats.size}),ft}),{create:function(ft,Rt){function kt(Ee,Ye){var it=0,ht=0,At=32854;if("object"==typeof Ee&&Ee?("shape"in Ee?(it=0|(ht=Ee.shape)[0],ht=0|ht[1]):("radius"in Ee&&(it=ht=0|Ee.radius),"width"in Ee&&(it=0|Ee.width),"height"in Ee&&(ht=0|Ee.height)),"format"in Ee&&(At=ot[Ee.format])):"number"==typeof Ee?(it=0|Ee,ht="number"==typeof Ye?0|Ye:it):Ee||(it=ht=1),it!==Lt.width||ht!==Lt.height||At!==Lt.format)return kt.width=Lt.width=it,kt.height=Lt.height=ht,Lt.format=At,he.bindRenderbuffer(36161,Lt.renderbuffer),he.renderbufferStorage(36161,At,it,ht),Je.profile&&(Lt.stats.size=dt[Lt.format]*Lt.width*Lt.height),kt.format=wt[Lt.format],kt}var Lt=new He(he.createRenderbuffer());return rt[Lt.id]=Lt,Ge.renderbufferCount++,kt(ft,Rt),kt.resize=function(Ee,Ye){var it=0|Ee,ht=0|Ye||it;return it===Lt.width&&ht===Lt.height||(kt.width=Lt.width=it,kt.height=Lt.height=ht,he.bindRenderbuffer(36161,Lt.renderbuffer),he.renderbufferStorage(36161,Lt.format,it,ht),Je.profile&&(Lt.stats.size=dt[Lt.format]*Lt.width*Lt.height)),kt},kt._reglType="renderbuffer",kt._renderbuffer=Lt,Je.profile&&(kt.stats=Lt.stats),kt.destroy=function(){Lt.decRef()},kt},clear:function(){se(rt).forEach(st)},restore:function(){se(rt).forEach(function(ft){ft.renderbuffer=he.createRenderbuffer(),he.bindRenderbuffer(36161,ft.renderbuffer),he.renderbufferStorage(36161,ft.format,ft.width,ft.height)}),he.bindRenderbuffer(36161,null)}}}(kt,At,0,it,he),Fr=function M(he,ye,Be,Ge,Je,He){function st(ur,Jt,$t){this.target=ur,this.texture=Jt,this.renderbuffer=$t;var Qt=ur=0;Jt?(ur=Jt.width,Qt=Jt.height):$t&&(ur=$t.width,Qt=$t.height),this.width=ur,this.height=Qt}function ot(ur){ur&&(ur.texture&&ur.texture._texture.decRef(),ur.renderbuffer&&ur.renderbuffer._renderbuffer.decRef())}function wt(ur,Jt,$t){ur&&(ur.texture?ur.texture._texture.refCount+=1:ur.renderbuffer._renderbuffer.refCount+=1)}function Ct(ur,Jt){Jt&&(Jt.texture?he.framebufferTexture2D(36160,ur,Jt.target,Jt.texture._texture.texture,0):he.framebufferRenderbuffer(36160,ur,36161,Jt.renderbuffer._renderbuffer.renderbuffer))}function rt(ur){var Jt=3553,$t=null,Qt=null,cr=ur;return"object"==typeof ur&&(cr=ur.data,"target"in ur&&(Jt=0|ur.target)),"texture2d"===(ur=cr._reglType)||"textureCube"===ur?$t=cr:"renderbuffer"===ur&&(Qt=cr,Jt=36161),new st(Jt,$t,Qt)}function ft(ur,Jt,$t,Qt,cr){return $t?((ur=Ge.create2D({width:ur,height:Jt,format:Qt,type:cr}))._texture.refCount=0,new st(3553,ur,null)):((ur=Je.create({width:ur,height:Jt,format:Qt}))._renderbuffer.refCount=0,new st(36161,null,ur))}function Rt(ur){return ur&&(ur.texture||ur.renderbuffer)}function kt(ur,Jt,$t){ur&&(ur.texture?ur.texture.resize(Jt,$t):ur.renderbuffer&&ur.renderbuffer.resize(Jt,$t),ur.width=Jt,ur.height=$t)}function Lt(){this.id=fr++,kr[this.id]=this,this.framebuffer=he.createFramebuffer(),this.height=this.width=0,this.colorAttachments=[],this.depthStencilAttachment=this.stencilAttachment=this.depthAttachment=null}function Ee(ur){ur.colorAttachments.forEach(ot),ot(ur.depthAttachment),ot(ur.stencilAttachment),ot(ur.depthStencilAttachment)}function Ye(ur){he.deleteFramebuffer(ur.framebuffer),ur.framebuffer=null,He.framebufferCount--,delete kr[ur.id]}function it(ur){var Jt;he.bindFramebuffer(36160,ur.framebuffer);var $t=ur.colorAttachments;for(Jt=0;Jt<$t.length;++Jt)Ct(36064+Jt,$t[Jt]);for(Jt=$t.length;Jt<Be.maxColorAttachments;++Jt)he.framebufferTexture2D(36160,36064+Jt,3553,null,0);he.framebufferTexture2D(36160,33306,3553,null,0),he.framebufferTexture2D(36160,36096,3553,null,0),he.framebufferTexture2D(36160,36128,3553,null,0),Ct(36096,ur.depthAttachment),Ct(36128,ur.stencilAttachment),Ct(33306,ur.depthStencilAttachment),he.checkFramebufferStatus(36160),he.isContextLost(),he.bindFramebuffer(36160,At.next?At.next.framebuffer:null),At.cur=At.next,he.getError()}function ht(ur,Jt){function $t(cr,gr){var Tr,Fr=0,Nr=0,Xr=!0,un=!0;Tr=null;var $r=!0,Pn="rgba",gn="uint8",dn=1,An=null,Zn=null,Rr=null,hn=!1;"number"==typeof cr?(Fr=0|cr,Nr=0|gr||Fr):cr?("shape"in cr?(Fr=(Nr=cr.shape)[0],Nr=Nr[1]):("radius"in cr&&(Fr=Nr=cr.radius),"width"in cr&&(Fr=cr.width),"height"in cr&&(Nr=cr.height)),("color"in cr||"colors"in cr)&&(Tr=cr.color||cr.colors,Array.isArray(Tr)),Tr||("colorCount"in cr&&(dn=0|cr.colorCount),"colorTexture"in cr&&($r=!!cr.colorTexture,Pn="rgba4"),"colorType"in cr&&(gn=cr.colorType,!$r)&&("half float"===gn||"float16"===gn?Pn="rgba16f":"float"!==gn&&"float32"!==gn||(Pn="rgba32f")),"colorFormat"in cr&&(0<=Ft.indexOf(Pn=cr.colorFormat)?$r=!0:0<=Gt.indexOf(Pn)&&($r=!1))),("depthTexture"in cr||"depthStencilTexture"in cr)&&(hn=!(!cr.depthTexture&&!cr.depthStencilTexture)),"depth"in cr&&("boolean"==typeof cr.depth?Xr=cr.depth:(An=cr.depth,un=!1)),"stencil"in cr&&("boolean"==typeof cr.stencil?un=cr.stencil:(Zn=cr.stencil,Xr=!1)),"depthStencil"in cr&&("boolean"==typeof cr.depthStencil?Xr=un=cr.depthStencil:(Rr=cr.depthStencil,un=Xr=!1))):Fr=Nr=1;var nn=null,Hr=null,Fn=null,Un=null;if(Array.isArray(Tr))nn=Tr.map(rt);else if(Tr)nn=[rt(Tr)];else for(nn=Array(dn),Tr=0;Tr<dn;++Tr)nn[Tr]=ft(Fr,Nr,$r,Pn,gn);for(Fr=Fr||nn[0].width,Nr=Nr||nn[0].height,An?Hr=rt(An):Xr&&!un&&(Hr=ft(Fr,Nr,hn,"depth","uint32")),Zn?Fn=rt(Zn):un&&!Xr&&(Fn=ft(Fr,Nr,!1,"stencil","uint8")),Rr?Un=rt(Rr):!An&&!Zn&&un&&Xr&&(Un=ft(Fr,Nr,hn,"depth stencil","depth stencil")),Xr=null,Tr=0;Tr<nn.length;++Tr)wt(nn[Tr]),nn[Tr]&&nn[Tr].texture&&(un=Ke[nn[Tr].texture._texture.format]*mt[nn[Tr].texture._texture.type],null===Xr&&(Xr=un));return wt(Hr),wt(Fn),wt(Un),Ee(Qt),Qt.width=Fr,Qt.height=Nr,Qt.colorAttachments=nn,Qt.depthAttachment=Hr,Qt.stencilAttachment=Fn,Qt.depthStencilAttachment=Un,$t.color=nn.map(Rt),$t.depth=Rt(Hr),$t.stencil=Rt(Fn),$t.depthStencil=Rt(Un),$t.width=Qt.width,$t.height=Qt.height,it(Qt),$t}var Qt=new Lt;return He.framebufferCount++,$t(ur,Jt),j($t,{resize:function(cr,gr){var Tr=Math.max(0|cr,1),Fr=Math.max(0|gr||Tr,1);if(Tr===Qt.width&&Fr===Qt.height)return $t;for(var Nr=Qt.colorAttachments,Xr=0;Xr<Nr.length;++Xr)kt(Nr[Xr],Tr,Fr);return kt(Qt.depthAttachment,Tr,Fr),kt(Qt.stencilAttachment,Tr,Fr),kt(Qt.depthStencilAttachment,Tr,Fr),Qt.width=$t.width=Tr,Qt.height=$t.height=Fr,it(Qt),$t},_reglType:"framebuffer",_framebuffer:Qt,destroy:function(){Ye(Qt),Ee(Qt)},use:function(cr){At.setFBO({framebuffer:$t},cr)}})}var At={cur:null,next:null,dirty:!1,setFBO:null},Ft=["rgba"],Gt=["rgba4","rgb565","rgb5 a1"];ye.ext_srgb&&Gt.push("srgba"),ye.ext_color_buffer_half_float&&Gt.push("rgba16f","rgb16f"),ye.webgl_color_buffer_float&&Gt.push("rgba32f");var jt=["uint8"];ye.oes_texture_half_float&&jt.push("half float","float16"),ye.oes_texture_float&&jt.push("float","float32");var fr=0,kr={};return j(At,{getFramebuffer:function(ur){return"function"==typeof ur&&"framebuffer"===ur._reglType&&(ur=ur._framebuffer)instanceof Lt?ur:null},create:ht,createCube:function(ur){function Jt(Qt){var cr,gr={color:null},Tr=0,Fr=null;cr="rgba";var Nr="uint8",Xr=1;if("number"==typeof Qt?Tr=0|Qt:Qt?("shape"in Qt?Tr=Qt.shape[0]:("radius"in Qt&&(Tr=0|Qt.radius),"width"in Qt?Tr=0|Qt.width:"height"in Qt&&(Tr=0|Qt.height)),("color"in Qt||"colors"in Qt)&&(Fr=Qt.color||Qt.colors,Array.isArray(Fr)),Fr||("colorCount"in Qt&&(Xr=0|Qt.colorCount),"colorType"in Qt&&(Nr=Qt.colorType),"colorFormat"in Qt&&(cr=Qt.colorFormat)),"depth"in Qt&&(gr.depth=Qt.depth),"stencil"in Qt&&(gr.stencil=Qt.stencil),"depthStencil"in Qt&&(gr.depthStencil=Qt.depthStencil)):Tr=1,Fr)if(Array.isArray(Fr))for(Qt=[],cr=0;cr<Fr.length;++cr)Qt[cr]=Fr[cr];else Qt=[Fr];else for(Qt=Array(Xr),Fr={radius:Tr,format:cr,type:Nr},cr=0;cr<Xr;++cr)Qt[cr]=Ge.createCube(Fr);for(gr.color=Array(Qt.length),cr=0;cr<Qt.length;++cr)Xr=Qt[cr],Tr=Tr||Xr.width,gr.color[cr]={target:34069,data:Qt[cr]};for(cr=0;6>cr;++cr){for(Xr=0;Xr<Qt.length;++Xr)gr.color[Xr].target=34069+cr;0<cr&&(gr.depth=$t[0].depth,gr.stencil=$t[0].stencil,gr.depthStencil=$t[0].depthStencil),$t[cr]?$t[cr](gr):$t[cr]=ht(gr)}return j(Jt,{width:Tr,height:Tr,color:Qt})}var $t=Array(6);return Jt(ur),j(Jt,{faces:$t,resize:function(Qt){var cr=0|Qt;if(cr===Jt.width)return Jt;var gr=Jt.color;for(Qt=0;Qt<gr.length;++Qt)gr[Qt].resize(cr);for(Qt=0;6>Qt;++Qt)$t[Qt].resize(cr);return Jt.width=Jt.height=cr,Jt},_reglType:"framebufferCube",destroy:function(){$t.forEach(function(Qt){Qt.destroy()})}})},clear:function(){se(kr).forEach(Ye)},restore:function(){At.cur=null,At.next=null,At.dirty=!0,se(kr).forEach(function(ur){ur.framebuffer=he.createFramebuffer(),it(ur)})}})}(kt,At,ur,gr,Tr,it),Nr=U(kt,Ye,At,ur,Jt,$t,0,Fr,{},Qt,cr,jt,kr,Ft,ht,he),Xr=(Ye=function E(he,ye,Be,Ge,Je,He,st){function ot(wt){var Ct;Ct=null===ye.next?5121:ye.next.colorAttachments[0].texture._texture.type;var rt=0,ft=0,Rt=Ge.framebufferWidth,kt=Ge.framebufferHeight,Lt=null;return de(wt)?Lt=wt:wt&&(rt=0|wt.x,ft=0|wt.y,Rt=0|(wt.width||Ge.framebufferWidth-rt),kt=0|(wt.height||Ge.framebufferHeight-ft),Lt=wt.data||null),Be(),wt=Rt*kt*4,Lt||(5121===Ct?Lt=new Uint8Array(wt):5126===Ct&&(Lt=Lt||new Float32Array(wt))),he.pixelStorei(3333,4),he.readPixels(rt,ft,Rt,kt,6408,Ct,Lt),Lt}return function(wt){return wt&&"framebuffer"in wt?(ye.setFBO({framebuffer:(Ct=wt).framebuffer},function(){rt=ot(Ct)}),rt):ot(wt);var Ct,rt}}(kt,Fr,Nr.procs.poll,kr),Nr.next),un=kt.canvas,$r=[],Pn=[],gn=[],dn=[he.onDestroy],An=null;un&&(un.addEventListener("webglcontextlost",Je,!1),un.addEventListener("webglcontextrestored",He,!1));var Zn=Fr.setFBO=st({framebuffer:X.define.call(null,1,"framebuffer")});return ft(),Lt=j(st,{clear:function(Rr){if("framebuffer"in Rr)if(Rr.framebuffer&&"framebufferCube"===Rr.framebuffer_reglType)for(var hn=0;6>hn;++hn)Zn(j({framebuffer:Rr.framebuffer.faces[hn]},Rr),ot);else Zn(Rr,ot);else ot(0,Rr)},prop:X.define.bind(null,1),context:X.define.bind(null,2),this:X.define.bind(null,3),draw:st({}),buffer:function(Rr){return Jt.create(Rr,34962,!1,!1)},elements:function(Rr){return $t.create(Rr,!1)},texture:gr.create2D,cube:gr.createCube,renderbuffer:Tr.create,framebuffer:Fr.create,framebufferCube:Fr.createCube,vao:Qt.createVAO,attributes:Lt,frame:wt,on:function(Rr,hn){var nn;switch(Rr){case"frame":return wt(hn);case"lost":nn=Pn;break;case"restore":nn=gn;break;case"destroy":nn=dn}return nn.push(hn),{cancel:function(){for(var Hr=0;Hr<nn.length;++Hr)if(nn[Hr]===hn){nn[Hr]=nn[nn.length-1],nn.pop();break}}}},limits:ur,hasExtension:function(Rr){return 0<=ur.extensions.indexOf(Rr.toLowerCase())},read:Ye,destroy:function(){$r.length=0,Ge(),un&&(un.removeEventListener("webglcontextlost",Je),un.removeEventListener("webglcontextrestored",He)),cr.clear(),Fr.clear(),Tr.clear(),Qt.clear(),gr.clear(),$t.clear(),Jt.clear(),Ft&&Ft.clear(),dn.forEach(function(Rr){Rr()})},_gl:kt,_refresh:ft,poll:function(){rt(),Ft&&Ft.update()},now:Rt,stats:it,getCachedCode:function(){return ht},preloadCachedCode:function(Rr){Object.entries(Rr).forEach(function(hn){ht[hn[0]]=hn[1]})}}),he.onDone(null,Lt),Lt}},"object"==typeof Q&&void 0!==ee?ee.exports=v():this.createREGL=v()},{}],285:[function(y,ee,Q){var g=y("buffer"),v=g.Buffer;function m(e,n){for(var t in e)n[t]=e[t]}function x(e,n,t){return v(e,n,t)}v.from&&v.alloc&&v.allocUnsafe&&v.allocUnsafeSlow?ee.exports=g:(m(g,Q),Q.Buffer=x),x.prototype=Object.create(v.prototype),m(v,x),x.from=function(e,n,t){if("number"==typeof e)throw new TypeError("Argument must not be a number");return v(e,n,t)},x.alloc=function(e,n,t){if("number"!=typeof e)throw new TypeError("Argument must be a number");var a=v(e);return void 0!==n?"string"==typeof t?a.fill(n,t):a.fill(n):a.fill(0),a},x.allocUnsafe=function(e){if("number"!=typeof e)throw new TypeError("Argument must be a number");return v(e)},x.allocUnsafeSlow=function(e){if("number"!=typeof e)throw new TypeError("Argument must be a number");return g.SlowBuffer(e)}},{buffer:85}],286:[function(y,ee,Q){ee.exports=v;var g=y("events").EventEmitter;function v(){g.call(this)}y("inherits")(v,g),v.Readable=y("readable-stream/lib/_stream_readable.js"),v.Writable=y("readable-stream/lib/_stream_writable.js"),v.Duplex=y("readable-stream/lib/_stream_duplex.js"),v.Transform=y("readable-stream/lib/_stream_transform.js"),v.PassThrough=y("readable-stream/lib/_stream_passthrough.js"),v.finished=y("readable-stream/lib/internal/streams/end-of-stream.js"),v.pipeline=y("readable-stream/lib/internal/streams/pipeline.js"),v.Stream=v,v.prototype.pipe=function(m,x){var e=this;function n(u){m.writable&&!1===m.write(u)&&e.pause&&e.pause()}function t(){e.readable&&e.resume&&e.resume()}e.on("data",n),m.on("drain",t),m._isStdio||x&&!1===x.end||(e.on("end",r),e.on("close",d));var a=!1;function r(){a||(a=!0,m.end())}function d(){a||(a=!0,"function"==typeof m.destroy&&m.destroy())}function s(u){if(i(),0===g.listenerCount(this,"error"))throw u}function i(){e.removeListener("data",n),m.removeListener("drain",t),e.removeListener("end",r),e.removeListener("close",d),e.removeListener("error",s),m.removeListener("error",s),e.removeListener("end",i),e.removeListener("close",i),m.removeListener("close",i)}return e.on("error",s),m.on("error",s),e.on("end",i),e.on("close",i),m.on("close",i),m.emit("pipe",e),m}},{events:84,inherits:231,"readable-stream/lib/_stream_duplex.js":288,"readable-stream/lib/_stream_passthrough.js":289,"readable-stream/lib/_stream_readable.js":290,"readable-stream/lib/_stream_transform.js":291,"readable-stream/lib/_stream_writable.js":292,"readable-stream/lib/internal/streams/end-of-stream.js":296,"readable-stream/lib/internal/streams/pipeline.js":298}],287:[function(y,ee,Q){"use strict";var g={};function v(x,e,n){n||(n=Error);var t=function(a){var r,d;function s(i,u,f){return a.call(this,"string"==typeof e?e:e(i,u,f))||this}return d=a,(r=s).prototype=Object.create(d.prototype),r.prototype.constructor=r,r.__proto__=d,s}(n);t.prototype.name=n.name,t.prototype.code=x,g[x]=t}function m(x,e){if(Array.isArray(x)){var n=x.length;return x=x.map(function(t){return String(t)}),n>2?"one of ".concat(e," ").concat(x.slice(0,n-1).join(", "),", or ")+x[n-1]:2===n?"one of ".concat(e," ").concat(x[0]," or ").concat(x[1]):"of ".concat(e," ").concat(x[0])}return"of ".concat(e," ").concat(String(x))}v("ERR_INVALID_OPT_VALUE",function(x,e){return'The value "'+e+'" is invalid for option "'+x+'"'},TypeError),v("ERR_INVALID_ARG_TYPE",function(x,e,n){var t,d,i,f;if("string"==typeof e&&"not "===e.substr(0,"not ".length)?(t="must not be",e=e.replace(/^not /,"")):t="must be",i=x,(void 0===f||f>i.length)&&(f=i.length)," argument"===i.substring(f-" argument".length,f))d="The ".concat(x," ").concat(t," ").concat(m(e,"type"));else{var s=function(i,u,f){return"number"!=typeof f&&(f=0),!(f+".".length>i.length)&&-1!==i.indexOf(".",f)}(x)?"property":"argument";d='The "'.concat(x,'" ').concat(s," ").concat(t," ").concat(m(e,"type"))}return d+". Received type ".concat(typeof n)},TypeError),v("ERR_STREAM_PUSH_AFTER_EOF","stream.push() after EOF"),v("ERR_METHOD_NOT_IMPLEMENTED",function(x){return"The "+x+" method is not implemented"}),v("ERR_STREAM_PREMATURE_CLOSE","Premature close"),v("ERR_STREAM_DESTROYED",function(x){return"Cannot call "+x+" after a stream was destroyed"}),v("ERR_MULTIPLE_CALLBACK","Callback called multiple times"),v("ERR_STREAM_CANNOT_PIPE","Cannot pipe, not readable"),v("ERR_STREAM_WRITE_AFTER_END","write after end"),v("ERR_STREAM_NULL_VALUES","May not write null values to stream",TypeError),v("ERR_UNKNOWN_ENCODING",function(x){return"Unknown encoding: "+x},TypeError),v("ERR_STREAM_UNSHIFT_AFTER_END_EVENT","stream.unshift() after end event"),ee.exports.codes=g},{}],288:[function(y,ee,Q){(function(g){(function(){"use strict";var v=Object.keys||function(s){var i=[];for(var u in s)i.push(u);return i};ee.exports=a;var m=y("./_stream_readable"),x=y("./_stream_writable");y("inherits")(a,m);for(var e=v(x.prototype),n=0;n<e.length;n++){var t=e[n];a.prototype[t]||(a.prototype[t]=x.prototype[t])}function a(s){if(!(this instanceof a))return new a(s);m.call(this,s),x.call(this,s),this.allowHalfOpen=!0,s&&(!1===s.readable&&(this.readable=!1),!1===s.writable&&(this.writable=!1),!1===s.allowHalfOpen&&(this.allowHalfOpen=!1,this.once("end",r)))}function r(){this._writableState.ended||g.nextTick(d,this)}function d(s){s.end()}Object.defineProperty(a.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),Object.defineProperty(a.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}}),Object.defineProperty(a.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}}),Object.defineProperty(a.prototype,"destroyed",{enumerable:!1,get:function(){return void 0!==this._readableState&&void 0!==this._writableState&&this._readableState.destroyed&&this._writableState.destroyed},set:function(s){void 0!==this._readableState&&void 0!==this._writableState&&(this._readableState.destroyed=s,this._writableState.destroyed=s)}})}).call(this)}).call(this,y("_process"))},{"./_stream_readable":290,"./_stream_writable":292,_process:278,inherits:231}],289:[function(y,ee,Q){"use strict";ee.exports=v;var g=y("./_stream_transform");function v(m){if(!(this instanceof v))return new v(m);g.call(this,m)}y("inherits")(v,g),v.prototype._transform=function(m,x,e){e(null,m)}},{"./_stream_transform":291,inherits:231}],290:[function(y,ee,Q){(function(g,v){(function(){"use strict";var m;ee.exports=k,k.ReadableState=w,y("events");var a,x=function(B,N){return B.listeners(N).length},e=y("./internal/streams/stream"),n=y("buffer").Buffer,t=v.Uint8Array||function(){},r=y("util");a=r&&r.debuglog?r.debuglog("stream"):function(){};var d,s,i,u=y("./internal/streams/buffer_list"),f=y("./internal/streams/destroy"),c=y("./internal/streams/state").getHighWaterMark,h=y("../errors").codes,p=h.ERR_INVALID_ARG_TYPE,o=h.ERR_STREAM_PUSH_AFTER_EOF,b=h.ERR_METHOD_NOT_IMPLEMENTED,l=h.ERR_STREAM_UNSHIFT_AFTER_END_EVENT;y("inherits")(k,e);var T=f.errorOrDestroy,_=["error","close","destroy","pause","resume"];function w(B,N,U){m=m||y("./_stream_duplex"),"boolean"!=typeof U&&(U=N instanceof m),this.objectMode=!!(B=B||{}).objectMode,U&&(this.objectMode=this.objectMode||!!B.readableObjectMode),this.highWaterMark=c(this,B,"readableHighWaterMark",U),this.buffer=new u,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.paused=!0,this.emitClose=!1!==B.emitClose,this.autoDestroy=!!B.autoDestroy,this.destroyed=!1,this.defaultEncoding=B.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,B.encoding&&(d||(d=y("string_decoder/").StringDecoder),this.decoder=new d(B.encoding),this.encoding=B.encoding)}function k(B){if(m=m||y("./_stream_duplex"),!(this instanceof k))return new k(B);this._readableState=new w(B,this,this instanceof m),this.readable=!0,B&&("function"==typeof B.read&&(this._read=B.read),"function"==typeof B.destroy&&(this._destroy=B.destroy)),e.call(this)}function L(B,N,U,te,j){a("readableAddChunk",N);var J,re,ne,le,oe,X=B._readableState;if(null===N)X.reading=!1,function(re,ne){if(a("onEofChunk"),!ne.ended){if(ne.decoder){var le=ne.decoder.end();le&&le.length&&(ne.buffer.push(le),ne.length+=ne.objectMode?1:le.length)}ne.ended=!0,ne.sync?P(re):(ne.needReadable=!1,ne.emittedReadable||(ne.emittedReadable=!0,S(re)))}}(B,X);else if(j||(re=X,n.isBuffer(oe=ne=N)||oe instanceof t||"string"==typeof ne||void 0===ne||re.objectMode||(le=new p("chunk",["string","Buffer","Uint8Array"],ne)),J=le),J)T(B,J);else if(X.objectMode||N&&N.length>0)if("string"==typeof N||X.objectMode||Object.getPrototypeOf(N)===n.prototype||(N=function(re){return n.from(re)}(N)),te)X.endEmitted?T(B,new l):M(B,X,N,!0);else if(X.ended)T(B,new o);else{if(X.destroyed)return!1;X.reading=!1,X.decoder&&!U?(N=X.decoder.write(N),X.objectMode||0!==N.length?M(B,X,N,!1):E(B,X)):M(B,X,N,!1)}else te||(X.reading=!1,E(B,X));return!X.ended&&(X.length<X.highWaterMark||0===X.length)}function M(B,N,U,te){N.flowing&&0===N.length&&!N.sync?(N.awaitDrain=0,B.emit("data",U)):(N.length+=N.objectMode?1:U.length,te?N.buffer.unshift(U):N.buffer.push(U),N.needReadable&&P(B)),E(B,N)}function I(B,N){return B<=0||0===N.length&&N.ended?0:N.objectMode?1:B!=B?N.flowing&&N.length?N.buffer.head.data.length:N.length:(B>N.highWaterMark&&(N.highWaterMark=((U=B)>=1073741824?U=1073741824:(U--,U|=U>>>1,U|=U>>>2,U|=U>>>4,U|=U>>>8,U|=U>>>16,U++),U)),B<=N.length?B:N.ended?N.length:(N.needReadable=!0,0));var U}function P(B){var N=B._readableState;a("emitReadable",N.needReadable,N.emittedReadable),N.needReadable=!1,N.emittedReadable||(a("emitReadable",N.flowing),N.emittedReadable=!0,g.nextTick(S,B))}function S(B){var N=B._readableState;a("emitReadable_",N.destroyed,N.length,N.ended),N.destroyed||!N.length&&!N.ended||(B.emit("readable"),N.emittedReadable=!1),N.needReadable=!N.flowing&&!N.ended&&N.length<=N.highWaterMark,W(B)}function E(B,N){N.readingMore||(N.readingMore=!0,g.nextTick(z,B,N))}function z(B,N){for(;!N.reading&&!N.ended&&(N.length<N.highWaterMark||N.flowing&&0===N.length);){var U=N.length;if(a("maybeReadMore read 0"),B.read(0),U===N.length)break}N.readingMore=!1}function R(B){var N=B._readableState;N.readableListening=B.listenerCount("readable")>0,N.resumeScheduled&&!N.paused?N.flowing=!0:B.listenerCount("data")>0&&B.resume()}function q(B){a("readable nexttick read 0"),B.read(0)}function V(B,N){a("resume",N.reading),N.reading||B.read(0),N.resumeScheduled=!1,B.emit("resume"),W(B),N.flowing&&!N.reading&&B.read(0)}function W(B){var N=B._readableState;for(a("flow",N.flowing);N.flowing&&null!==B.read(););}function K(B,N){return 0===N.length?null:(N.objectMode?U=N.buffer.shift():!B||B>=N.length?(U=N.decoder?N.buffer.join(""):1===N.buffer.length?N.buffer.first():N.buffer.concat(N.length),N.buffer.clear()):U=N.buffer.consume(B,N.decoder),U);var U}function G(B){var N=B._readableState;a("endReadable",N.endEmitted),N.endEmitted||(N.ended=!0,g.nextTick(Y,N,B))}function Y(B,N){if(a("endReadableNT",B.endEmitted,B.length),!B.endEmitted&&0===B.length&&(B.endEmitted=!0,N.readable=!1,N.emit("end"),B.autoDestroy)){var U=N._writableState;(!U||U.autoDestroy&&U.finished)&&N.destroy()}}function $(B,N){for(var U=0,te=B.length;U<te;U++)if(B[U]===N)return U;return-1}Object.defineProperty(k.prototype,"destroyed",{enumerable:!1,get:function(){return void 0!==this._readableState&&this._readableState.destroyed},set:function(B){this._readableState&&(this._readableState.destroyed=B)}}),k.prototype.destroy=f.destroy,k.prototype._undestroy=f.undestroy,k.prototype._destroy=function(B,N){N(B)},k.prototype.push=function(B,N){var U,te=this._readableState;return te.objectMode?U=!0:"string"==typeof B&&((N=N||te.defaultEncoding)!==te.encoding&&(B=n.from(B,N),N=""),U=!0),L(this,B,N,!1,U)},k.prototype.unshift=function(B){return L(this,B,null,!0,!1)},k.prototype.isPaused=function(){return!1===this._readableState.flowing},k.prototype.setEncoding=function(B){d||(d=y("string_decoder/").StringDecoder);var N=new d(B);this._readableState.decoder=N,this._readableState.encoding=this._readableState.decoder.encoding;for(var U=this._readableState.buffer.head,te="";null!==U;)te+=N.write(U.data),U=U.next;return this._readableState.buffer.clear(),""!==te&&this._readableState.buffer.push(te),this._readableState.length=te.length,this},k.prototype.read=function(B){a("read",B),B=parseInt(B,10);var N=this._readableState,U=B;if(0!==B&&(N.emittedReadable=!1),0===B&&N.needReadable&&((0!==N.highWaterMark?N.length>=N.highWaterMark:N.length>0)||N.ended))return a("read: emitReadable",N.length,N.ended),0===N.length&&N.ended?G(this):P(this),null;if(0===(B=I(B,N))&&N.ended)return 0===N.length&&G(this),null;var te,j=N.needReadable;return a("need readable",j),(0===N.length||N.length-B<N.highWaterMark)&&a("length less than watermark",j=!0),N.ended||N.reading?a("reading or ended",j=!1):j&&(a("do read"),N.reading=!0,N.sync=!0,0===N.length&&(N.needReadable=!0),this._read(N.highWaterMark),N.sync=!1,N.reading||(B=I(U,N))),null===(te=B>0?K(B,N):null)?(N.needReadable=N.length<=N.highWaterMark,B=0):(N.length-=B,N.awaitDrain=0),0===N.length&&(N.ended||(N.needReadable=!0),U!==B&&N.ended&&G(this)),null!==te&&this.emit("data",te),te},k.prototype._read=function(B){T(this,new b("_read()"))},k.prototype.pipe=function(B,N){var U=this,te=this._readableState;switch(te.pipesCount){case 0:te.pipes=B;break;case 1:te.pipes=[te.pipes,B];break;default:te.pipes.push(B)}te.pipesCount+=1,a("pipe count=%d opts=%j",te.pipesCount,N);var j=N&&!1===N.end||B===g.stdout||B===g.stderr?ge:X;function X(){a("onend"),B.end()}te.endEmitted?g.nextTick(j):U.once("end",j),B.on("unpipe",function J(_e,Te){a("onunpipe"),_e===U&&Te&&!1===Te.hasUnpiped&&(Te.hasUnpiped=!0,a("cleanup"),B.removeListener("close",de),B.removeListener("finish",se),B.removeListener("drain",re),B.removeListener("error",oe),B.removeListener("unpipe",J),U.removeListener("end",X),U.removeListener("end",ge),U.removeListener("data",le),ne=!0,!te.awaitDrain||B._writableState&&!B._writableState.needDrain||re())});var _e,re=(_e=U,function(){var Te=_e._readableState;a("pipeOnDrain",Te.awaitDrain),Te.awaitDrain&&Te.awaitDrain--,0===Te.awaitDrain&&x(_e,"data")&&(Te.flowing=!0,W(_e))});B.on("drain",re);var ne=!1;function le(_e){a("ondata");var Te=B.write(_e);a("dest.write",Te),!1===Te&&((1===te.pipesCount&&te.pipes===B||te.pipesCount>1&&-1!==$(te.pipes,B))&&!ne&&(a("false write response, pause",te.awaitDrain),te.awaitDrain++),U.pause())}function oe(_e){a("onerror",_e),ge(),B.removeListener("error",oe),0===x(B,"error")&&T(B,_e)}function de(){B.removeListener("finish",se),ge()}function se(){a("onfinish"),B.removeListener("close",de),ge()}function ge(){a("unpipe"),U.unpipe(B)}return U.on("data",le),function(_e,Te,we){if("function"==typeof _e.prependListener)return _e.prependListener(Te,we);_e._events&&_e._events[Te]?Array.isArray(_e._events[Te])?_e._events[Te].unshift(we):_e._events[Te]=[we,_e._events[Te]]:_e.on(Te,we)}(B,"error",oe),B.once("close",de),B.once("finish",se),B.emit("pipe",U),te.flowing||(a("pipe resume"),U.resume()),B},k.prototype.unpipe=function(B){var N=this._readableState,U={hasUnpiped:!1};if(0===N.pipesCount)return this;if(1===N.pipesCount)return B&&B!==N.pipes||(B||(B=N.pipes),N.pipes=null,N.pipesCount=0,N.flowing=!1,B&&B.emit("unpipe",this,U)),this;if(!B){var te=N.pipes,j=N.pipesCount;N.pipes=null,N.pipesCount=0,N.flowing=!1;for(var J=0;J<j;J++)te[J].emit("unpipe",this,{hasUnpiped:!1});return this}var X=$(N.pipes,B);return-1===X||(N.pipes.splice(X,1),N.pipesCount-=1,1===N.pipesCount&&(N.pipes=N.pipes[0]),B.emit("unpipe",this,U)),this},k.prototype.addListener=k.prototype.on=function(B,N){var U=e.prototype.on.call(this,B,N),te=this._readableState;return"data"===B?(te.readableListening=this.listenerCount("readable")>0,!1!==te.flowing&&this.resume()):"readable"===B&&(te.endEmitted||te.readableListening||(te.readableListening=te.needReadable=!0,te.flowing=!1,te.emittedReadable=!1,a("on readable",te.length,te.reading),te.length?P(this):te.reading||g.nextTick(q,this))),U},k.prototype.removeListener=function(B,N){var U=e.prototype.removeListener.call(this,B,N);return"readable"===B&&g.nextTick(R,this),U},k.prototype.removeAllListeners=function(B){var N=e.prototype.removeAllListeners.apply(this,arguments);return"readable"!==B&&void 0!==B||g.nextTick(R,this),N},k.prototype.resume=function(){var U,B=this._readableState;return B.flowing||(a("resume"),B.flowing=!B.readableListening,this,(U=B).resumeScheduled||(U.resumeScheduled=!0,g.nextTick(V,this,U))),B.paused=!1,this},k.prototype.pause=function(){return a("call pause flowing=%j",this._readableState.flowing),!1!==this._readableState.flowing&&(a("pause"),this._readableState.flowing=!1,this.emit("pause")),this._readableState.paused=!0,this},k.prototype.wrap=function(B){var N=this,U=this._readableState,te=!1;for(var j in B.on("end",function(){if(a("wrapped end"),U.decoder&&!U.ended){var X=U.decoder.end();X&&X.length&&N.push(X)}N.push(null)}),B.on("data",function(X){a("wrapped data"),U.decoder&&(X=U.decoder.write(X)),U.objectMode&&null==X||(U.objectMode||X&&X.length)&&(N.push(X)||(te=!0,B.pause()))}),B)void 0===this[j]&&"function"==typeof B[j]&&(this[j]=function(X){return function(){return B[X].apply(B,arguments)}}(j));for(var J=0;J<_.length;J++)B.on(_[J],this.emit.bind(this,_[J]));return this._read=function(X){a("wrapped _read",X),te&&(te=!1,B.resume())},this},"function"==typeof Symbol&&(k.prototype[Symbol.asyncIterator]=function(){return void 0===s&&(s=y("./internal/streams/async_iterator")),s(this)}),Object.defineProperty(k.prototype,"readableHighWaterMark",{enumerable:!1,get:function(){return this._readableState.highWaterMark}}),Object.defineProperty(k.prototype,"readableBuffer",{enumerable:!1,get:function(){return this._readableState&&this._readableState.buffer}}),Object.defineProperty(k.prototype,"readableFlowing",{enumerable:!1,get:function(){return this._readableState.flowing},set:function(B){this._readableState&&(this._readableState.flowing=B)}}),k._fromList=K,Object.defineProperty(k.prototype,"readableLength",{enumerable:!1,get:function(){return this._readableState.length}}),"function"==typeof Symbol&&(k.from=function(B,N){return void 0===i&&(i=y("./internal/streams/from")),i(k,B,N)})}).call(this)}).call(this,y("_process"),typeof global<"u"?global:typeof self<"u"?self:typeof window<"u"?window:{})},{"../errors":287,"./_stream_duplex":288,"./internal/streams/async_iterator":293,"./internal/streams/buffer_list":294,"./internal/streams/destroy":295,"./internal/streams/from":297,"./internal/streams/state":299,"./internal/streams/stream":300,_process:278,buffer:85,events:84,inherits:231,"string_decoder/":301,util:83}],291:[function(y,ee,Q){"use strict";ee.exports=a;var g=y("../errors").codes,v=g.ERR_METHOD_NOT_IMPLEMENTED,m=g.ERR_MULTIPLE_CALLBACK,x=g.ERR_TRANSFORM_ALREADY_TRANSFORMING,e=g.ERR_TRANSFORM_WITH_LENGTH_0,n=y("./_stream_duplex");function t(s,i){var u=this._transformState;u.transforming=!1;var f=u.writecb;if(null===f)return this.emit("error",new m);u.writechunk=null,u.writecb=null,null!=i&&this.push(i),f(s);var c=this._readableState;c.reading=!1,(c.needReadable||c.length<c.highWaterMark)&&this._read(c.highWaterMark)}function a(s){if(!(this instanceof a))return new a(s);n.call(this,s),this._transformState={afterTransform:t.bind(this),needTransform:!1,transforming:!1,writecb:null,writechunk:null,writeencoding:null},this._readableState.needReadable=!0,this._readableState.sync=!1,s&&("function"==typeof s.transform&&(this._transform=s.transform),"function"==typeof s.flush&&(this._flush=s.flush)),this.on("prefinish",r)}function r(){var s=this;"function"!=typeof this._flush||this._readableState.destroyed?d(this,null,null):this._flush(function(i,u){d(s,i,u)})}function d(s,i,u){if(i)return s.emit("error",i);if(null!=u&&s.push(u),s._writableState.length)throw new e;if(s._transformState.transforming)throw new x;return s.push(null)}y("inherits")(a,n),a.prototype.push=function(s,i){return this._transformState.needTransform=!1,n.prototype.push.call(this,s,i)},a.prototype._transform=function(s,i,u){u(new v("_transform()"))},a.prototype._write=function(s,i,u){var f=this._transformState;if(f.writecb=u,f.writechunk=s,f.writeencoding=i,!f.transforming){var c=this._readableState;(f.needTransform||c.needReadable||c.length<c.highWaterMark)&&this._read(c.highWaterMark)}},a.prototype._read=function(s){var i=this._transformState;null===i.writechunk||i.transforming?i.needTransform=!0:(i.transforming=!0,this._transform(i.writechunk,i.writeencoding,i.afterTransform))},a.prototype._destroy=function(s,i){n.prototype._destroy.call(this,s,function(u){i(u)})}},{"../errors":287,"./_stream_duplex":288,inherits:231}],292:[function(y,ee,Q){(function(g,v){(function(){"use strict";function m(z){var R=this;this.next=null,this.entry=null,this.finish=function(){!function(q,V,W){var K=q.entry;for(q.entry=null;K;){var G=K.callback;V.pendingcb--,G(undefined),K=K.next}V.corkedRequestsFree.next=q}(R,z)}}var x;ee.exports=k,k.WritableState=w;var r,e={deprecate:y("util-deprecate")},n=y("./internal/streams/stream"),t=y("buffer").Buffer,a=v.Uint8Array||function(){},d=y("./internal/streams/destroy"),s=y("./internal/streams/state").getHighWaterMark,i=y("../errors").codes,u=i.ERR_INVALID_ARG_TYPE,f=i.ERR_METHOD_NOT_IMPLEMENTED,c=i.ERR_MULTIPLE_CALLBACK,h=i.ERR_STREAM_CANNOT_PIPE,p=i.ERR_STREAM_DESTROYED,o=i.ERR_STREAM_NULL_VALUES,b=i.ERR_STREAM_WRITE_AFTER_END,l=i.ERR_UNKNOWN_ENCODING,T=d.errorOrDestroy;function _(){}function w(z,R,q){x=x||y("./_stream_duplex"),"boolean"!=typeof q&&(q=R instanceof x),this.objectMode=!!(z=z||{}).objectMode,q&&(this.objectMode=this.objectMode||!!z.writableObjectMode),this.highWaterMark=s(this,z,"writableHighWaterMark",q),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1,this.decodeStrings=!(!1===z.decodeStrings),this.defaultEncoding=z.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(W){!function(K,G){var U,Y=K._writableState,$=Y.sync,B=Y.writecb;if("function"!=typeof B)throw new c;if((U=Y).writing=!1,U.writecb=null,U.length-=U.writelen,U.writelen=0,G)!function(U,te,j,J,X){--te.pendingcb,j?(g.nextTick(X,J),g.nextTick(E,U,te),U._writableState.errorEmitted=!0,T(U,J)):(X(J),U._writableState.errorEmitted=!0,T(U,J),E(U,te))}(K,Y,$,G,B);else{var N=P(Y)||K.destroyed;N||Y.corked||Y.bufferProcessing||!Y.bufferedRequest||I(K,Y),$?g.nextTick(M,K,Y,N,B):M(K,Y,N,B)}}(R,W)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.emitClose=!1!==z.emitClose,this.autoDestroy=!!z.autoDestroy,this.bufferedRequestCount=0,this.corkedRequestsFree=new m(this)}function k(z){var R=this instanceof(x=x||y("./_stream_duplex"));if(!R&&!r.call(k,this))return new k(z);this._writableState=new w(z,this,R),this.writable=!0,z&&("function"==typeof z.write&&(this._write=z.write),"function"==typeof z.writev&&(this._writev=z.writev),"function"==typeof z.destroy&&(this._destroy=z.destroy),"function"==typeof z.final&&(this._final=z.final)),n.call(this)}function L(z,R,q,V,W,K,G){R.writelen=V,R.writecb=G,R.writing=!0,R.sync=!0,R.destroyed?R.onwrite(new p("write")):q?z._writev(W,R.onwrite):z._write(W,K,R.onwrite),R.sync=!1}function M(z,R,q,V){var W,K;q||(W=z,0===(K=R).length&&K.needDrain&&(K.needDrain=!1,W.emit("drain"))),R.pendingcb--,V(),E(z,R)}function I(z,R){R.bufferProcessing=!0;var q=R.bufferedRequest;if(z._writev&&q&&q.next){var W=new Array(R.bufferedRequestCount),K=R.corkedRequestsFree;K.entry=q;for(var G=0,Y=!0;q;)W[G]=q,q.isBuf||(Y=!1),q=q.next,G+=1;W.allBuffers=Y,L(z,R,!0,R.length,W,"",K.finish),R.pendingcb++,R.lastBufferedRequest=null,K.next?(R.corkedRequestsFree=K.next,K.next=null):R.corkedRequestsFree=new m(R),R.bufferedRequestCount=0}else{for(;q;){var $=q.chunk;if(L(z,R,!1,R.objectMode?1:$.length,$,q.encoding,q.callback),q=q.next,R.bufferedRequestCount--,R.writing)break}null===q&&(R.lastBufferedRequest=null)}R.bufferedRequest=q,R.bufferProcessing=!1}function P(z){return z.ending&&0===z.length&&null===z.bufferedRequest&&!z.finished&&!z.writing}function S(z,R){z._final(function(q){R.pendingcb--,q&&T(z,q),R.prefinished=!0,z.emit("prefinish"),E(z,R)})}function E(z,R){var W,K,q=P(R);if(q&&(W=z,(K=R).prefinished||K.finalCalled||("function"!=typeof W._final||K.destroyed?(K.prefinished=!0,W.emit("prefinish")):(K.pendingcb++,K.finalCalled=!0,g.nextTick(S,W,K))),0===R.pendingcb&&(R.finished=!0,z.emit("finish"),R.autoDestroy))){var V=z._readableState;(!V||V.autoDestroy&&V.endEmitted)&&z.destroy()}return q}y("inherits")(k,n),w.prototype.getBuffer=function(){for(var z=this.bufferedRequest,R=[];z;)R.push(z),z=z.next;return R},function(){try{Object.defineProperty(w.prototype,"buffer",{get:e.deprecate(function(){return this.getBuffer()},"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")})}catch{}}(),"function"==typeof Symbol&&Symbol.hasInstance&&"function"==typeof Function.prototype[Symbol.hasInstance]?(r=Function.prototype[Symbol.hasInstance],Object.defineProperty(k,Symbol.hasInstance,{value:function(z){return!!r.call(this,z)||this===k&&z&&z._writableState instanceof w}})):r=function(z){return z instanceof this},k.prototype.pipe=function(){T(this,new h)},k.prototype.write=function(z,R,q){var V,Y,$,B,W=this._writableState,K=!1,G=!W.objectMode&&(t.isBuffer(V=z)||V instanceof a);return G&&!t.isBuffer(z)&&(z=t.from(z)),"function"==typeof R&&(q=R,R=null),G?R="buffer":R||(R=W.defaultEncoding),"function"!=typeof q&&(q=_),W.ending?(Y=this,$=q,B=new b,T(Y,B),g.nextTick($,B)):(G||function(Y,$,B,N){var U;return null===B?U=new o:"string"==typeof B||$.objectMode||(U=new u("chunk",["string","Buffer"],B)),!U||(T(Y,U),g.nextTick(N,U),!1)}(this,W,z,q))&&(W.pendingcb++,K=function(Y,$,B,N,U,te){if(!B){var j=(le=N,(ne=$).objectMode||!1===ne.decodeStrings||"string"!=typeof le||(le=t.from(le,U)),le);N!==j&&(B=!0,U="buffer",N=j)}var ne,le,J=$.objectMode?1:N.length;$.length+=J;var X=$.length<$.highWaterMark;if(X||($.needDrain=!0),$.writing||$.corked){var re=$.lastBufferedRequest;$.lastBufferedRequest={chunk:N,encoding:U,isBuf:B,callback:te,next:null},re?re.next=$.lastBufferedRequest:$.bufferedRequest=$.lastBufferedRequest,$.bufferedRequestCount+=1}else L(Y,$,!1,J,N,U,te);return X}(this,W,G,z,R,q)),K},k.prototype.cork=function(){this._writableState.corked++},k.prototype.uncork=function(){var z=this._writableState;z.corked&&(z.corked--,z.writing||z.corked||z.bufferProcessing||!z.bufferedRequest||I(this,z))},k.prototype.setDefaultEncoding=function(z){if("string"==typeof z&&(z=z.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((z+"").toLowerCase())>-1))throw new l(z);return this._writableState.defaultEncoding=z,this},Object.defineProperty(k.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}}),Object.defineProperty(k.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),k.prototype._write=function(z,R,q){q(new f("_write()"))},k.prototype._writev=null,k.prototype.end=function(z,R,q){var W,K,G,V=this._writableState;return"function"==typeof z?(q=z,z=null,R=null):"function"==typeof R&&(q=R,R=null),null!=z&&this.write(z,R),V.corked&&(V.corked=1,this.uncork()),V.ending||(W=this,G=q,(K=V).ending=!0,E(W,K),G&&(K.finished?g.nextTick(G):W.once("finish",G)),K.ended=!0,W.writable=!1),this},Object.defineProperty(k.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}}),Object.defineProperty(k.prototype,"destroyed",{enumerable:!1,get:function(){return void 0!==this._writableState&&this._writableState.destroyed},set:function(z){this._writableState&&(this._writableState.destroyed=z)}}),k.prototype.destroy=d.destroy,k.prototype._undestroy=d.undestroy,k.prototype._destroy=function(z,R){R(z)}}).call(this)}).call(this,y("_process"),typeof global<"u"?global:typeof self<"u"?self:typeof window<"u"?window:{})},{"../errors":287,"./_stream_duplex":288,"./internal/streams/destroy":295,"./internal/streams/state":299,"./internal/streams/stream":300,_process:278,buffer:85,inherits:231,"util-deprecate":331}],293:[function(y,ee,Q){(function(g){(function(){"use strict";var v;function m(p,o,b){return o in p?Object.defineProperty(p,o,{value:b,enumerable:!0,configurable:!0,writable:!0}):p[o]=b,p}var x=y("./end-of-stream"),e=Symbol("lastResolve"),n=Symbol("lastReject"),t=Symbol("error"),a=Symbol("ended"),r=Symbol("lastPromise"),d=Symbol("handlePromise"),s=Symbol("stream");function i(p,o){return{value:p,done:o}}function u(p){var o=p[e];if(null!==o){var b=p[s].read();null!==b&&(p[r]=null,p[e]=null,p[n]=null,o(i(b,!1)))}}function f(p){g.nextTick(u,p)}var c=Object.getPrototypeOf(function(){}),h=Object.setPrototypeOf((m(v={get stream(){return this[s]},next:function(){var p=this,o=this[t];if(null!==o)return Promise.reject(o);if(this[a])return Promise.resolve(i(void 0,!0));if(this[s].destroyed)return new Promise(function(_,w){g.nextTick(function(){p[t]?w(p[t]):_(i(void 0,!0))})});var b,_,w,l=this[r];if(l)b=new Promise((_=l,w=this,function(k,L){_.then(function(){w[a]?k(i(void 0,!0)):w[d](k,L)},L)}));else{var T=this[s].read();if(null!==T)return Promise.resolve(i(T,!1));b=new Promise(this[d])}return this[r]=b,b}},Symbol.asyncIterator,function(){return this}),m(v,"return",function(){var p=this;return new Promise(function(o,b){p[s].destroy(null,function(l){l?b(l):o(i(void 0,!0))})})}),v),c);ee.exports=function(p){var o,b=Object.create(h,(m(o={},s,{value:p,writable:!0}),m(o,e,{value:null,writable:!0}),m(o,n,{value:null,writable:!0}),m(o,t,{value:null,writable:!0}),m(o,a,{value:p._readableState.endEmitted,writable:!0}),m(o,d,{value:function(l,T){var _=b[s].read();_?(b[r]=null,b[e]=null,b[n]=null,l(i(_,!1))):(b[e]=l,b[n]=T)},writable:!0}),o));return b[r]=null,x(p,function(l){if(l&&"ERR_STREAM_PREMATURE_CLOSE"!==l.code){var T=b[n];return null!==T&&(b[r]=null,b[e]=null,b[n]=null,T(l)),void(b[t]=l)}var _=b[e];null!==_&&(b[r]=null,b[e]=null,b[n]=null,_(i(void 0,!0))),b[a]=!0}),p.on("readable",f.bind(null,b)),b}}).call(this)}).call(this,y("_process"))},{"./end-of-stream":296,_process:278}],294:[function(y,ee,Q){"use strict";function g(t,a){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var d=Object.getOwnPropertySymbols(t);a&&(d=d.filter(function(s){return Object.getOwnPropertyDescriptor(t,s).enumerable})),r.push.apply(r,d)}return r}function v(t,a,r){return a in t?Object.defineProperty(t,a,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[a]=r,t}function m(t,a){for(var r=0;r<a.length;r++){var d=a[r];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(t,d.key,d)}}var x=y("buffer").Buffer,e=y("util").inspect,n=e&&e.custom||"inspect";ee.exports=function(){function t(){(function(s,i){if(!(s instanceof i))throw new TypeError("Cannot call a class as a function")})(this,t),this.head=null,this.tail=null,this.length=0}var a,r;return a=t,(r=[{key:"push",value:function(s){var i={data:s,next:null};this.length>0?this.tail.next=i:this.head=i,this.tail=i,++this.length}},{key:"unshift",value:function(s){var i={data:s,next:this.head};0===this.length&&(this.tail=i),this.head=i,++this.length}},{key:"shift",value:function(){if(0!==this.length){var s=this.head.data;return this.head=1===this.length?this.tail=null:this.head.next,--this.length,s}}},{key:"clear",value:function(){this.head=this.tail=null,this.length=0}},{key:"join",value:function(s){if(0===this.length)return"";for(var i=this.head,u=""+i.data;i=i.next;)u+=s+i.data;return u}},{key:"concat",value:function(s){if(0===this.length)return x.alloc(0);for(var c=x.allocUnsafe(s>>>0),h=this.head,p=0;h;)x.prototype.copy.call(h.data,c,p),p+=h.data.length,h=h.next;return c}},{key:"consume",value:function(s,i){var u;return s<this.head.data.length?(u=this.head.data.slice(0,s),this.head.data=this.head.data.slice(s)):u=s===this.head.data.length?this.shift():i?this._getString(s):this._getBuffer(s),u}},{key:"first",value:function(){return this.head.data}},{key:"_getString",value:function(s){var i=this.head,u=1,f=i.data;for(s-=f.length;i=i.next;){var c=i.data,h=s>c.length?c.length:s;if(f+=h===c.length?c:c.slice(0,s),0==(s-=h)){h===c.length?(++u,this.head=i.next?i.next:this.tail=null):(this.head=i,i.data=c.slice(h));break}++u}return this.length-=u,f}},{key:"_getBuffer",value:function(s){var i=x.allocUnsafe(s),u=this.head,f=1;for(u.data.copy(i),s-=u.data.length;u=u.next;){var c=u.data,h=s>c.length?c.length:s;if(c.copy(i,i.length-s,0,h),0==(s-=h)){h===c.length?(++f,this.head=u.next?u.next:this.tail=null):(this.head=u,u.data=c.slice(h));break}++f}return this.length-=f,i}},{key:n,value:function(s,i){return e(this,function(u){for(var f=1;f<arguments.length;f++){var c=null!=arguments[f]?arguments[f]:{};f%2?g(Object(c),!0).forEach(function(h){v(u,h,c[h])}):Object.getOwnPropertyDescriptors?Object.defineProperties(u,Object.getOwnPropertyDescriptors(c)):g(Object(c)).forEach(function(h){Object.defineProperty(u,h,Object.getOwnPropertyDescriptor(c,h))})}return u}({},i,{depth:0,customInspect:!1}))}}])&&m(a.prototype,r),t}()},{buffer:85,util:83}],295:[function(y,ee,Q){(function(g){(function(){"use strict";function v(e,n){x(e,n),m(e)}function m(e){e._writableState&&!e._writableState.emitClose||e._readableState&&!e._readableState.emitClose||e.emit("close")}function x(e,n){e.emit("error",n)}ee.exports={destroy:function(e,n){var t=this;return this._readableState&&this._readableState.destroyed||this._writableState&&this._writableState.destroyed?(n?n(e):e&&(this._writableState?this._writableState.errorEmitted||(this._writableState.errorEmitted=!0,g.nextTick(x,this,e)):g.nextTick(x,this,e)),this):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(e||null,function(d){!n&&d?t._writableState?t._writableState.errorEmitted?g.nextTick(m,t):(t._writableState.errorEmitted=!0,g.nextTick(v,t,d)):g.nextTick(v,t,d):n?(g.nextTick(m,t),n(d)):g.nextTick(m,t)}),this)},undestroy:function(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finalCalled=!1,this._writableState.prefinished=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)},errorOrDestroy:function(e,n){var t=e._readableState,a=e._writableState;t&&t.autoDestroy||a&&a.autoDestroy?e.destroy(n):e.emit("error",n)}}}).call(this)}).call(this,y("_process"))},{_process:278}],296:[function(y,ee,Q){"use strict";var g=y("../../../errors").codes.ERR_STREAM_PREMATURE_CLOSE;function v(){}ee.exports=function m(x,e,n){if("function"==typeof e)return m(x,null,e);var p,o;e||(e={}),p=n||v,o=!1,n=function(){if(!o){o=!0;for(var b=arguments.length,l=new Array(b),T=0;T<b;T++)l[T]=arguments[T];p.apply(this,l)}};var t=e.readable||!1!==e.readable&&x.readable,a=e.writable||!1!==e.writable&&x.writable,r=function(){x.writable||s()},d=x._writableState&&x._writableState.finished,s=function(){a=!1,d=!0,t||n.call(x)},i=x._readableState&&x._readableState.endEmitted,u=function(){t=!1,i=!0,a||n.call(x)},f=function(p){n.call(x,p)},c=function(){var p;return t&&!i?(x._readableState&&x._readableState.ended||(p=new g),n.call(x,p)):a&&!d?(x._writableState&&x._writableState.ended||(p=new g),n.call(x,p)):void 0},h=function(){x.req.on("finish",s)};return function(p){return p.setHeader&&"function"==typeof p.abort}(x)?(x.on("complete",s),x.on("abort",c),x.req?h():x.on("request",h)):a&&!x._writableState&&(x.on("end",r),x.on("close",r)),x.on("end",u),x.on("finish",s),!1!==e.error&&x.on("error",f),x.on("close",c),function(){x.removeListener("complete",s),x.removeListener("abort",c),x.removeListener("request",h),x.req&&x.req.removeListener("finish",s),x.removeListener("end",r),x.removeListener("close",r),x.removeListener("finish",s),x.removeListener("end",u),x.removeListener("error",f),x.removeListener("close",c)}}},{"../../../errors":287}],297:[function(y,ee,Q){ee.exports=function(){throw new Error("Readable.from is not available in the browser")}},{}],298:[function(y,ee,Q){"use strict";var g,v=y("../../../errors").codes,m=v.ERR_MISSING_ARGS,x=v.ERR_STREAM_DESTROYED;function e(d){if(d)throw d}function n(d,s,i,u){var h,p;h=u,p=!1,u=function(){p||(p=!0,h.apply(void 0,arguments))};var f=!1;d.on("close",function(){f=!0}),void 0===g&&(g=y("./end-of-stream")),g(d,{readable:s,writable:i},function(h){if(h)return u(h);f=!0,u()});var c=!1;return function(h){if(!f&&!c)return c=!0,function(p){return p.setHeader&&"function"==typeof p.abort}(d)?d.abort():"function"==typeof d.destroy?d.destroy():void u(h||new x("pipe"))}}function t(d){d()}function a(d,s){return d.pipe(s)}function r(d){return d.length?"function"!=typeof d[d.length-1]?e:d.pop():e}ee.exports=function(){for(var d=arguments.length,s=new Array(d),i=0;i<d;i++)s[i]=arguments[i];var u,f=r(s);if(Array.isArray(s[0])&&(s=s[0]),s.length<2)throw new m("streams");var c=s.map(function(h,p){var o=p<s.length-1;return n(h,o,p>0,function(b){u||(u=b),b&&c.forEach(t),o||(c.forEach(t),f(u))})});return s.reduce(a)}},{"../../../errors":287,"./end-of-stream":296}],299:[function(y,ee,Q){"use strict";var g=y("../../../errors").codes.ERR_INVALID_OPT_VALUE;ee.exports={getHighWaterMark:function(v,m,x,e){var t,n=null!=(t=m).highWaterMark?t.highWaterMark:e?t[x]:null;if(null!=n){if(!isFinite(n)||Math.floor(n)!==n||n<0)throw new g(e?x:"highWaterMark",n);return Math.floor(n)}return v.objectMode?16:16384}}},{"../../../errors":287}],300:[function(y,ee,Q){ee.exports=y("events").EventEmitter},{events:84}],301:[function(y,ee,Q){"use strict";var g=y("safe-buffer").Buffer,v=g.isEncoding||function(i){switch((i=""+i)&&i.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function m(i){var u;switch(this.encoding=function(f){var c=function(h){if(!h)return"utf8";for(var p;;)switch(h){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return h;default:if(p)return;h=(""+h).toLowerCase(),p=!0}}(f);if("string"!=typeof c&&(g.isEncoding===v||!v(f)))throw new Error("Unknown encoding: "+f);return c||f}(i),this.encoding){case"utf16le":this.text=n,this.end=t,u=4;break;case"utf8":this.fillLast=e,u=4;break;case"base64":this.text=a,this.end=r,u=3;break;default:return this.write=d,void(this.end=s)}this.lastNeed=0,this.lastTotal=0,this.lastChar=g.allocUnsafe(u)}function x(i){return i<=127?0:i>>5==6?2:i>>4==14?3:i>>3==30?4:i>>6==2?-1:-2}function e(i){var u=this.lastTotal-this.lastNeed,f=function(c,h,p){if(128!=(192&h[0]))return c.lastNeed=0,"\ufffd";if(c.lastNeed>1&&h.length>1){if(128!=(192&h[1]))return c.lastNeed=1,"\ufffd";if(c.lastNeed>2&&h.length>2&&128!=(192&h[2]))return c.lastNeed=2,"\ufffd"}}(this,i);return void 0!==f?f:this.lastNeed<=i.length?(i.copy(this.lastChar,u,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal)):(i.copy(this.lastChar,u,0,i.length),void(this.lastNeed-=i.length))}function n(i,u){if((i.length-u)%2==0){var f=i.toString("utf16le",u);if(f){var c=f.charCodeAt(f.length-1);if(c>=55296&&c<=56319)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=i[i.length-2],this.lastChar[1]=i[i.length-1],f.slice(0,-1)}return f}return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=i[i.length-1],i.toString("utf16le",u,i.length-1)}function t(i){var u=i&&i.length?this.write(i):"";return this.lastNeed?u+this.lastChar.toString("utf16le",0,this.lastTotal-this.lastNeed):u}function a(i,u){var f=(i.length-u)%3;return 0===f?i.toString("base64",u):(this.lastNeed=3-f,this.lastTotal=3,1===f?this.lastChar[0]=i[i.length-1]:(this.lastChar[0]=i[i.length-2],this.lastChar[1]=i[i.length-1]),i.toString("base64",u,i.length-f))}function r(i){var u=i&&i.length?this.write(i):"";return this.lastNeed?u+this.lastChar.toString("base64",0,3-this.lastNeed):u}function d(i){return i.toString(this.encoding)}function s(i){return i&&i.length?this.write(i):""}Q.StringDecoder=m,m.prototype.write=function(i){if(0===i.length)return"";var u,f;if(this.lastNeed){if(void 0===(u=this.fillLast(i)))return"";f=this.lastNeed,this.lastNeed=0}else f=0;return f<i.length?u?u+this.text(i,f):this.text(i,f):u||""},m.prototype.end=function(i){var u=i&&i.length?this.write(i):"";return this.lastNeed?u+"\ufffd":u},m.prototype.text=function(i,u){var f=function(h,p,o){var b=p.length-1;if(b<o)return 0;var l=x(p[b]);return l>=0?(l>0&&(h.lastNeed=l-1),l):--b<o||-2===l?0:(l=x(p[b]))>=0?(l>0&&(h.lastNeed=l-2),l):--b<o||-2===l?0:(l=x(p[b]))>=0?(l>0&&(2===l?l=0:h.lastNeed=l-3),l):0}(this,i,u);if(!this.lastNeed)return i.toString("utf8",u);this.lastTotal=f;var c=i.length-(f-this.lastNeed);return i.copy(this.lastChar,0,c),i.toString("utf8",u,c)},m.prototype.fillLast=function(i){if(this.lastNeed<=i.length)return i.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);i.copy(this.lastChar,this.lastTotal-this.lastNeed,0,i.length),this.lastNeed-=i.length}},{"safe-buffer":285}],302:[function(y,ee,Q){(function(g,v){(function(){var m=y("assert"),x=y("debug")("stream-parser");function e(f){x("initializing parser stream"),f._parserBytesLeft=0,f._parserBuffers=[],f._parserBuffered=0,f._parserState=-1,f._parserCallback=null,"function"==typeof f.push&&(f._parserOutput=f.push.bind(f)),f._parserInit=!0}function n(f,c){m(!this._parserCallback,'there is already a "callback" set!'),m(isFinite(f)&&f>0,'can only buffer a finite number of bytes > 0, got "'+f+'"'),this._parserInit||e(this),x("buffering %o bytes",f),this._parserBytesLeft=f,this._parserCallback=c,this._parserState=0}function t(f,c){m(!this._parserCallback,'there is already a "callback" set!'),m(f>0,'can only skip > 0 bytes, got "'+f+'"'),this._parserInit||e(this),x("skipping %o bytes",f),this._parserBytesLeft=f,this._parserCallback=c,this._parserState=1}function a(f,c){m(!this._parserCallback,'There is already a "callback" set!'),m(f>0,'can only pass through > 0 bytes, got "'+f+'"'),this._parserInit||e(this),x("passing through %o bytes",f),this._parserBytesLeft=f,this._parserCallback=c,this._parserState=2}function r(f,c,h){this._parserInit||e(this),x("write(%o bytes)",f.length),"function"==typeof c&&(h=c),i(this,f,null,h)}function d(f,c,h){this._parserInit||e(this),x("transform(%o bytes)",f.length),"function"!=typeof c&&(c=this._parserOutput),i(this,f,c,h)}function s(f,c,h,p){if(f._parserBytesLeft-=c.length,x("%o bytes left for stream piece",f._parserBytesLeft),0===f._parserState?(f._parserBuffers.push(c),f._parserBuffered+=c.length):2===f._parserState&&h(c),0!==f._parserBytesLeft)return p;var o=f._parserCallback;if(o&&0===f._parserState&&f._parserBuffers.length>1&&(c=v.concat(f._parserBuffers,f._parserBuffered)),0!==f._parserState&&(c=null),f._parserCallback=null,f._parserBuffered=0,f._parserState=-1,f._parserBuffers.splice(0),o){var b=[];c&&b.push(c),h&&b.push(h);var l=o.length>b.length;l&&b.push(u(p));var T=o.apply(f,b);if(!l||p===T)return p}}ee.exports=function(f){var c=f&&"function"==typeof f._transform;if(!(c||f&&"function"==typeof f._write))throw new Error("must pass a Writable or Transform stream in");x("extending Parser into stream"),f._bytes=n,f._skipBytes=t,c&&(f._passthrough=a),c?f._transform=d:f._write=r};var i=u(function f(c,h,p,o){return c._parserBytesLeft<=0?o(new Error("got data but not currently parsing anything")):h.length<=c._parserBytesLeft?function(){return s(c,h,p,o)}:function(){var b=h.slice(0,c._parserBytesLeft);return s(c,b,p,function(l){return l?o(l):h.length>b.length?function(){return f(c,h.slice(b.length),p,o)}:void 0})}});function u(f){return function(){for(var c=f.apply(this,arguments);"function"==typeof c;)c=c();return c}}}).call(this)}).call(this,y("_process"),y("buffer").Buffer)},{_process:278,assert:75,buffer:85,debug:303}],303:[function(y,ee,Q){(function(g){(function(){function v(){var m;try{m=Q.storage.debug}catch{}return!m&&void 0!==g&&"env"in g&&(m=g.env.DEBUG),m}(Q=ee.exports=y("./debug")).log=function(){return"object"==typeof console&&console.log&&Function.prototype.apply.call(console.log,console,arguments)},Q.formatArgs=function(m){var x=this.useColors;if(m[0]=(x?"%c":"")+this.namespace+(x?" %c":" ")+m[0]+(x?"%c ":" ")+"+"+Q.humanize(this.diff),x){var e="color: "+this.color;m.splice(1,0,e,"color: inherit");var n=0,t=0;m[0].replace(/%[a-zA-Z%]/g,function(a){"%%"!==a&&(n++,"%c"===a&&(t=n))}),m.splice(t,0,e)}},Q.save=function(m){try{null==m?Q.storage.removeItem("debug"):Q.storage.debug=m}catch{}},Q.load=v,Q.useColors=function(){return!!(typeof window<"u"&&window.process&&"renderer"===window.process.type)||typeof document<"u"&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||typeof window<"u"&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)},Q.storage=typeof chrome<"u"&&void 0!==chrome.storage?chrome.storage.local:function(){try{return window.localStorage}catch{}}(),Q.colors=["lightseagreen","forestgreen","goldenrod","dodgerblue","darkorchid","crimson"],Q.formatters.j=function(m){try{return JSON.stringify(m)}catch(x){return"[UnexpectedJSONParseError]: "+x.message}},Q.enable(v())}).call(this)}).call(this,y("_process"))},{"./debug":304,_process:278}],304:[function(y,ee,Q){var g;function v(m){function x(){if(x.enabled){var e=x,n=+new Date;e.diff=n-(g||n),e.prev=g,e.curr=n,g=n;for(var a=new Array(arguments.length),r=0;r<a.length;r++)a[r]=arguments[r];a[0]=Q.coerce(a[0]),"string"!=typeof a[0]&&a.unshift("%O");var d=0;a[0]=a[0].replace(/%([a-zA-Z%])/g,function(i,u){if("%%"===i)return i;d++;var f=Q.formatters[u];return"function"==typeof f&&(i=f.call(e,a[d]),a.splice(d,1),d--),i}),Q.formatArgs.call(e,a),(x.log||Q.log||console.log.bind(console)).apply(e,a)}}return x.namespace=m,x.enabled=Q.enabled(m),x.useColors=Q.useColors(),x.color=function(e){var n,t=0;for(n in e)t=(t<<5)-t+e.charCodeAt(n),t|=0;return Q.colors[Math.abs(t)%Q.colors.length]}(m),"function"==typeof Q.init&&Q.init(x),x}(Q=ee.exports=v.debug=v.default=v).coerce=function(m){return m instanceof Error?m.stack||m.message:m},Q.disable=function(){Q.enable("")},Q.enable=function(m){Q.save(m),Q.names=[],Q.skips=[];for(var x=("string"==typeof m?m:"").split(/[\s,]+/),e=x.length,n=0;n<e;n++)x[n]&&("-"===(m=x[n].replace(/\*/g,".*?"))[0]?Q.skips.push(new RegExp("^"+m.substr(1)+"$")):Q.names.push(new RegExp("^"+m+"$")))},Q.enabled=function(m){var x,e;for(x=0,e=Q.skips.length;x<e;x++)if(Q.skips[x].test(m))return!1;for(x=0,e=Q.names.length;x<e;x++)if(Q.names[x].test(m))return!0;return!1},Q.humanize=y("ms"),Q.names=[],Q.skips=[],Q.formatters={}},{ms:305}],305:[function(y,ee,Q){var g=1e3,v=6e4,m=60*v,x=24*m;function e(n,t,a){if(!(n<t))return n<1.5*t?Math.floor(n/t)+" "+a:Math.ceil(n/t)+" "+a+"s"}ee.exports=function(n,t){t=t||{};var a,d,r=typeof n;if("string"===r&&n.length>0)return function(d){if(!((d=String(d)).length>100)){var s=/^((?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|years?|yrs?|y)?$/i.exec(d);if(s){var i=parseFloat(s[1]);switch((s[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return 315576e5*i;case"days":case"day":case"d":return i*x;case"hours":case"hour":case"hrs":case"hr":case"h":return i*m;case"minutes":case"minute":case"mins":case"min":case"m":return i*v;case"seconds":case"second":case"secs":case"sec":case"s":return i*g;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return i;default:return}}}}(n);if("number"===r&&!1===isNaN(n))return t.long?e(a=n,x,"day")||e(a,m,"hour")||e(a,v,"minute")||e(a,g,"second")||a+" ms":(d=n)>=x?Math.round(d/x)+"d":d>=m?Math.round(d/m)+"h":d>=v?Math.round(d/v)+"m":d>=g?Math.round(d/g)+"s":d+"ms";throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(n))}},{}],306:[function(y,ee,Q){"use strict";var g=y("parenthesis");ee.exports=function(v,m,x){if(null==v)throw Error("First argument should be a string");if(null==m)throw Error("Separator should be a string or a RegExp");x?("string"==typeof x||Array.isArray(x))&&(x={ignore:x}):x={},null==x.escape&&(x.escape=!0),null==x.ignore?x.ignore=["[]","()","{}","<>",'""',"''","``","\u201c\u201d","\xab\xbb"]:("string"==typeof x.ignore&&(x.ignore=[x.ignore]),x.ignore=x.ignore.map(function(s){return 1===s.length&&(s+=s),s}));var e=g.parse(v,{flat:!0,brackets:x.ignore}),n=e[0].split(m);if(x.escape){for(var t=[],a=0;a<n.length;a++){var r=n[a];"\\"===r[r.length-1]&&"\\"!==r[r.length-2]?(t.push(r+m+n[a+1]),a++):t.push(r)}n=t}for(a=0;a<n.length;a++)e[0]=n[a],n[a]=g.stringify(e,{flat:!0});return n}},{parenthesis:248}],307:[function(y,ee,Q){"use strict";ee.exports=function(g){for(var v=g.length,m=new Array(v),x=new Array(v),e=new Array(v),n=new Array(v),t=new Array(v),a=new Array(v),r=0;r<v;++r)m[r]=-1,x[r]=0,e[r]=!1,n[r]=0,t[r]=-1,a[r]=[];var d,s=0,i=[],u=[];function f(p){var o=[p],b=[p];for(m[p]=x[p]=s,e[p]=!0,s+=1;b.length>0;){var l=g[p=b[b.length-1]];if(n[p]<l.length){for(var T=n[p];T<l.length;++T){var _=l[T];if(m[_]<0){m[_]=x[_]=s,e[_]=!0,s+=1,o.push(_),b.push(_);break}e[_]&&(x[p]=0|Math.min(x[p],x[_])),t[_]>=0&&a[p].push(t[_])}n[p]=T}else{if(x[p]===m[p]){var w=[],k=[],L=0;for(T=o.length-1;T>=0;--T){var M=o[T];if(e[M]=!1,w.push(M),k.push(a[M]),L+=a[M].length,t[M]=i.length,M===p){o.length=T;break}}i.push(w);var I=new Array(L);for(T=0;T<k.length;T++)for(var P=0;P<k[T].length;P++)I[--L]=k[T][P];u.push(I)}b.pop()}}}for(r=0;r<v;++r)m[r]<0&&f(r);for(r=0;r<u.length;r++){var c=u[r];if(0!==c.length){c.sort(function(p,o){return p-o}),d=[c[0]];for(var h=1;h<c.length;h++)c[h]!==c[h-1]&&d.push(c[h]);u[r]=d}}return{components:i,adjacencyList:u}}},{}],308:[function(y,ee,Q){"use strict";Object.defineProperty(Q,"__esModule",{value:!0});var v=2*Math.PI,m=function(n,t,a,r,d,s,i){var u=n.x,f=n.y;return{x:r*(u*=t)-d*(f*=a)+s,y:d*u+r*f+i}},x=function(n,t){var a=1.5707963267948966===t?.551915024494:-1.5707963267948966===t?-.551915024494:1.3333333333333333*Math.tan(t/4),r=Math.cos(n),d=Math.sin(n),s=Math.cos(n+t),i=Math.sin(n+t);return[{x:r-d*a,y:d+r*a},{x:s+i*a,y:i-s*a},{x:s,y:i}]},e=function(n,t,a,r){var d=n*a+t*r;return d>1&&(d=1),d<-1&&(d=-1),(n*r-t*a<0?-1:1)*Math.acos(d)};Q.default=function(n){var t=n.px,a=n.py,r=n.cx,d=n.cy,s=n.rx,i=n.ry,u=n.xAxisRotation,f=void 0===u?0:u,c=n.largeArcFlag,h=void 0===c?0:c,p=n.sweepFlag,o=void 0===p?0:p,b=[];if(0===s||0===i)return[];var l=Math.sin(f*v/360),T=Math.cos(f*v/360),_=T*(t-r)/2+l*(a-d)/2,w=-l*(t-r)/2+T*(a-d)/2;if(0===_&&0===w)return[];s=Math.abs(s),i=Math.abs(i);var k=Math.pow(_,2)/Math.pow(s,2)+Math.pow(w,2)/Math.pow(i,2);k>1&&(s*=Math.sqrt(k),i*=Math.sqrt(k));var M=function(n,t){if(Array.isArray(n))return n;if(Symbol.iterator in Object(n))return function(a,r){var d=[],s=!0,i=!1,u=void 0;try{for(var f,c=a[Symbol.iterator]();!(s=(f=c.next()).done)&&(d.push(f.value),!r||d.length!==r);s=!0);}catch(h){i=!0,u=h}finally{try{!s&&c.return&&c.return()}finally{if(i)throw u}}return d}(n,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")}(function(V,W,K,G,Y,$,B,N,U,te,j,J){var X=Math.pow(Y,2),re=Math.pow($,2),ne=Math.pow(j,2),le=Math.pow(J,2),oe=X*re-X*le-re*ne;oe<0&&(oe=0),oe/=X*le+re*ne;var de=(oe=Math.sqrt(oe)*(B===N?-1:1))*Y/$*J,se=oe*-$/Y*j,ge=te*de-U*se+(V+K)/2,_e=U*de+te*se+(W+G)/2,Te=(j-de)/Y,we=(J-se)/$,Oe=(-j-de)/Y,fe=(-J-se)/$,ve=e(1,0,Te,we),Ae=e(Te,we,Oe,fe);return 0===N&&Ae>0&&(Ae-=v),1===N&&Ae<0&&(Ae+=v),[ge,_e,ve,Ae]}(t,a,r,d,s,i,h,o,l,T,_,w),4),I=M[0],P=M[1],S=M[2],E=M[3],z=Math.abs(E)/(v/4);Math.abs(1-z)<1e-7&&(z=1);var R=Math.max(Math.ceil(z),1);E/=R;for(var q=0;q<R;q++)b.push(x(S,E)),S+=E;return b.map(function(V){var W=m(V[0],s,i,T,l,I,P),K=W.x,G=W.y,Y=m(V[1],s,i,T,l,I,P),$=Y.x,B=Y.y,N=m(V[2],s,i,T,l,I,P);return{x1:K,y1:G,x2:$,y2:B,x:N.x,y:N.y}})},ee.exports=Q.default},{}],309:[function(y,ee,Q){"use strict";var g=y("parse-svg-path"),v=y("abs-svg-path"),m=y("normalize-svg-path"),x=y("is-svg-path"),e=y("assert");ee.exports=function(n){if(Array.isArray(n)&&1===n.length&&"string"==typeof n[0]&&(n=n[0]),"string"==typeof n&&(e(x(n),"String is not an SVG path."),n=g(n)),e(Array.isArray(n),"Argument should be a string or an array of path segments."),n=v(n),!(n=m(n)).length)return[0,0,0,0];for(var t=[1/0,1/0,-1/0,-1/0],a=0,r=n.length;a<r;a++)for(var d=n[a].slice(1),s=0;s<d.length;s+=2)d[s+0]<t[0]&&(t[0]=d[s+0]),d[s+1]<t[1]&&(t[1]=d[s+1]),d[s+0]>t[2]&&(t[2]=d[s+0]),d[s+1]>t[3]&&(t[3]=d[s+1]);return t}},{"abs-svg-path":70,assert:75,"is-svg-path":238,"normalize-svg-path":310,"parse-svg-path":250}],310:[function(y,ee,Q){"use strict";ee.exports=function(x){for(var e,n=[],t=0,a=0,r=0,d=0,s=null,i=null,u=0,f=0,c=0,h=x.length;c<h;c++){var p=x[c],o=p[0];switch(o){case"M":r=p[1],d=p[2];break;case"A":var b=g({px:u,py:f,cx:p[6],cy:p[7],rx:p[1],ry:p[2],xAxisRotation:p[3],largeArcFlag:p[4],sweepFlag:p[5]});if(!b.length)continue;for(var l,T=0;T<b.length;T++)p=["C",(l=b[T]).x1,l.y1,l.x2,l.y2,l.x,l.y],T<b.length-1&&n.push(p);break;case"S":var _=u,w=f;"C"!=e&&"S"!=e||(_+=_-t,w+=w-a),p=["C",_,w,p[1],p[2],p[3],p[4]];break;case"T":"Q"==e||"T"==e?(s=2*u-s,i=2*f-i):(s=u,i=f),p=m(u,f,s,i,p[1],p[2]);break;case"Q":s=p[1],i=p[2],p=m(u,f,p[1],p[2],p[3],p[4]);break;case"L":p=v(u,f,p[1],p[2]);break;case"H":p=v(u,f,p[1],f);break;case"V":p=v(u,f,u,p[1]);break;case"Z":p=v(u,f,r,d)}e=o,u=p[p.length-2],f=p[p.length-1],p.length>4?(t=p[p.length-4],a=p[p.length-3]):(t=u,a=f),n.push(p)}return n};var g=y("svg-arc-to-cubic-bezier");function v(x,e,n,t){return["C",x,e,n,t,n,t]}function m(x,e,n,t,a,r){return["C",x/3+2/3*n,e/3+2/3*t,a/3+2/3*n,r/3+2/3*t,a,r]}},{"svg-arc-to-cubic-bezier":308}],311:[function(y,ee,Q){"use strict";var g,v=y("svg-path-bounds"),m=y("parse-svg-path"),x=y("draw-svg-path"),e=y("is-svg-path"),n=y("bitmap-sdf"),t=document.createElement("canvas"),a=t.getContext("2d");ee.exports=function(r,d){if(!e(r))throw Error("Argument should be valid svg path string");var s,i;d||(d={}),d.shape?(s=d.shape[0],i=d.shape[1]):(s=t.width=d.w||d.width||200,i=t.height=d.h||d.height||200);var u=Math.min(s,i),f=d.stroke||0,c=d.viewbox||d.viewBox||v(r),h=[s/(c[2]-c[0]),i/(c[3]-c[1])],p=Math.min(h[0]||0,h[1]||0)/2;if(a.fillStyle="black",a.fillRect(0,0,s,i),a.fillStyle="white",f&&("number"!=typeof f&&(f=1),a.strokeStyle=f>0?"white":"black",a.lineWidth=Math.abs(f)),a.translate(.5*s,.5*i),a.scale(p,p),function(){if(null!=g)return g;var l=document.createElement("canvas").getContext("2d");if(l.canvas.width=l.canvas.height=1,!window.Path2D)return g=!1;var T=new Path2D("M0,0h1v1h-1v-1Z");l.fillStyle="black",l.fill(T);var _=l.getImageData(0,0,1,1);return g=_&&_.data&&255===_.data[3]}()){var o=new Path2D(r);a.fill(o),f&&a.stroke(o)}else{var b=m(r);x(a,b),a.fill(),f&&a.stroke()}return a.setTransform(1,0,0,1,0,0),n(a,{cutoff:null!=d.cutoff?d.cutoff:.5,radius:null!=d.radius?d.radius:.5*u})}},{"bitmap-sdf":82,"draw-svg-path":126,"is-svg-path":238,"parse-svg-path":250,"svg-path-bounds":309}],312:[function(y,ee,Q){(function(g,v){(function(){var m=y("process/browser.js").nextTick,x=Function.prototype.apply,e=Array.prototype.slice,n={},t=0;function a(r,d){this._id=r,this._clearFn=d}Q.setTimeout=function(){return new a(x.call(setTimeout,window,arguments),clearTimeout)},Q.setInterval=function(){return new a(x.call(setInterval,window,arguments),clearInterval)},Q.clearTimeout=Q.clearInterval=function(r){r.close()},a.prototype.unref=a.prototype.ref=function(){},a.prototype.close=function(){this._clearFn.call(window,this._id)},Q.enroll=function(r,d){clearTimeout(r._idleTimeoutId),r._idleTimeout=d},Q.unenroll=function(r){clearTimeout(r._idleTimeoutId),r._idleTimeout=-1},Q._unrefActive=Q.active=function(r){clearTimeout(r._idleTimeoutId);var d=r._idleTimeout;d>=0&&(r._idleTimeoutId=setTimeout(function(){r._onTimeout&&r._onTimeout()},d))},Q.setImmediate="function"==typeof g?g:function(r){var d=t++,s=!(arguments.length<2)&&e.call(arguments,1);return n[d]=!0,m(function(){n[d]&&(s?r.apply(null,s):r.call(null),Q.clearImmediate(d))}),d},Q.clearImmediate="function"==typeof v?v:function(r){delete n[r]}}).call(this)}).call(this,y("timers").setImmediate,y("timers").clearImmediate)},{"process/browser.js":278,timers:312}],313:[function(y,ee,Q){!function(g){var v=/^\s+/,m=/\s+$/,x=0,e=g.round,n=g.min,t=g.max,a=g.random;function r(U,te){if(te=te||{},(U=U||"")instanceof r)return U;if(!(this instanceof r))return new r(U,te);var J,_e,Te,X,re,ne,le,oe,de,se,j=(X={r:0,g:0,b:0},re=1,ne=null,le=null,oe=null,de=!1,se=!1,"string"==typeof(J=U)&&(J=function(we){we=we.replace(v,"").replace(m,"").toLowerCase();var Oe,fe=!1;if(I[we])we=I[we],fe=!0;else if("transparent"==we)return{r:0,g:0,b:0,a:0,format:"name"};return(Oe=B.rgb.exec(we))?{r:Oe[1],g:Oe[2],b:Oe[3]}:(Oe=B.rgba.exec(we))?{r:Oe[1],g:Oe[2],b:Oe[3],a:Oe[4]}:(Oe=B.hsl.exec(we))?{h:Oe[1],s:Oe[2],l:Oe[3]}:(Oe=B.hsla.exec(we))?{h:Oe[1],s:Oe[2],l:Oe[3],a:Oe[4]}:(Oe=B.hsv.exec(we))?{h:Oe[1],s:Oe[2],v:Oe[3]}:(Oe=B.hsva.exec(we))?{h:Oe[1],s:Oe[2],v:Oe[3],a:Oe[4]}:(Oe=B.hex8.exec(we))?{r:R(Oe[1]),g:R(Oe[2]),b:R(Oe[3]),a:K(Oe[4]),format:fe?"name":"hex8"}:(Oe=B.hex6.exec(we))?{r:R(Oe[1]),g:R(Oe[2]),b:R(Oe[3]),format:fe?"name":"hex"}:(Oe=B.hex4.exec(we))?{r:R(Oe[1]+""+Oe[1]),g:R(Oe[2]+""+Oe[2]),b:R(Oe[3]+""+Oe[3]),a:K(Oe[4]+""+Oe[4]),format:fe?"name":"hex8"}:!!(Oe=B.hex3.exec(we))&&{r:R(Oe[1]+""+Oe[1]),g:R(Oe[2]+""+Oe[2]),b:R(Oe[3]+""+Oe[3]),format:fe?"name":"hex"}}(J)),"object"==typeof J&&(N(J.r)&&N(J.g)&&N(J.b)?(_e=J.g,Te=J.b,X={r:255*E(J.r,255),g:255*E(_e,255),b:255*E(Te,255)},de=!0,se="%"===String(J.r).substr(-1)?"prgb":"rgb"):N(J.h)&&N(J.s)&&N(J.v)?(ne=V(J.s),le=V(J.v),X=function(we,Oe,fe){we=6*E(we,360),Oe=E(Oe,100),fe=E(fe,100);var ve=g.floor(we),Ae=we-ve,ke=fe*(1-Oe),Pe=fe*(1-Ae*Oe),Ne=fe*(1-(1-Ae)*Oe),De=ve%6;return{r:255*[fe,Pe,ke,ke,Ne,fe][De],g:255*[Ne,fe,fe,Pe,ke,ke][De],b:255*[ke,ke,Ne,fe,fe,Pe][De]}}(J.h,ne,le),de=!0,se="hsv"):N(J.h)&&N(J.s)&&N(J.l)&&(ne=V(J.s),oe=V(J.l),X=function(we,Oe,fe){var ve,Ae,ke;function Pe(ze,Me,Se){return Se<0&&(Se+=1),Se>1&&(Se-=1),Se<1/6?ze+6*(Me-ze)*Se:Se<.5?Me:Se<2/3?ze+(Me-ze)*(2/3-Se)*6:ze}if(we=E(we,360),Oe=E(Oe,100),fe=E(fe,100),0===Oe)ve=Ae=ke=fe;else{var Ne=fe<.5?fe*(1+Oe):fe+Oe-fe*Oe,De=2*fe-Ne;ve=Pe(De,Ne,we+1/3),Ae=Pe(De,Ne,we),ke=Pe(De,Ne,we-1/3)}return{r:255*ve,g:255*Ae,b:255*ke}}(J.h,ne,oe),de=!0,se="hsl"),J.hasOwnProperty("a")&&(re=J.a)),re=S(re),{ok:de,format:J.format||se,r:n(255,t(X.r,0)),g:n(255,t(X.g,0)),b:n(255,t(X.b,0)),a:re});this._originalInput=U,this._r=j.r,this._g=j.g,this._b=j.b,this._a=j.a,this._roundA=e(100*this._a)/100,this._format=te.format||j.format,this._gradientType=te.gradientType,this._r<1&&(this._r=e(this._r)),this._g<1&&(this._g=e(this._g)),this._b<1&&(this._b=e(this._b)),this._ok=j.ok,this._tc_id=x++}function d(U,te,j){U=E(U,255),te=E(te,255),j=E(j,255);var J,X,re=t(U,te,j),ne=n(U,te,j),le=(re+ne)/2;if(re==ne)J=X=0;else{var oe=re-ne;switch(X=le>.5?oe/(2-re-ne):oe/(re+ne),re){case U:J=(te-j)/oe+(te<j?6:0);break;case te:J=(j-U)/oe+2;break;case j:J=(U-te)/oe+4}J/=6}return{h:J,s:X,l:le}}function s(U,te,j){U=E(U,255),te=E(te,255),j=E(j,255);var J,X,re=t(U,te,j),ne=n(U,te,j),le=re,oe=re-ne;if(X=0===re?0:oe/re,re==ne)J=0;else{switch(re){case U:J=(te-j)/oe+(te<j?6:0);break;case te:J=(j-U)/oe+2;break;case j:J=(U-te)/oe+4}J/=6}return{h:J,s:X,v:le}}function i(U,te,j,J){var X=[q(e(U).toString(16)),q(e(te).toString(16)),q(e(j).toString(16))];return J&&X[0].charAt(0)==X[0].charAt(1)&&X[1].charAt(0)==X[1].charAt(1)&&X[2].charAt(0)==X[2].charAt(1)?X[0].charAt(0)+X[1].charAt(0)+X[2].charAt(0):X.join("")}function u(U,te,j,J){return[q(W(J)),q(e(U).toString(16)),q(e(te).toString(16)),q(e(j).toString(16))].join("")}function f(U,te){te=0===te?0:te||10;var j=r(U).toHsl();return j.s-=te/100,j.s=z(j.s),r(j)}function c(U,te){te=0===te?0:te||10;var j=r(U).toHsl();return j.s+=te/100,j.s=z(j.s),r(j)}function h(U){return r(U).desaturate(100)}function p(U,te){te=0===te?0:te||10;var j=r(U).toHsl();return j.l+=te/100,j.l=z(j.l),r(j)}function o(U,te){te=0===te?0:te||10;var j=r(U).toRgb();return j.r=t(0,n(255,j.r-e(-te/100*255))),j.g=t(0,n(255,j.g-e(-te/100*255))),j.b=t(0,n(255,j.b-e(-te/100*255))),r(j)}function b(U,te){te=0===te?0:te||10;var j=r(U).toHsl();return j.l-=te/100,j.l=z(j.l),r(j)}function l(U,te){var j=r(U).toHsl(),J=(j.h+te)%360;return j.h=J<0?360+J:J,r(j)}function T(U){var te=r(U).toHsl();return te.h=(te.h+180)%360,r(te)}function _(U){var te=r(U).toHsl(),j=te.h;return[r(U),r({h:(j+120)%360,s:te.s,l:te.l}),r({h:(j+240)%360,s:te.s,l:te.l})]}function w(U){var te=r(U).toHsl(),j=te.h;return[r(U),r({h:(j+90)%360,s:te.s,l:te.l}),r({h:(j+180)%360,s:te.s,l:te.l}),r({h:(j+270)%360,s:te.s,l:te.l})]}function k(U){var te=r(U).toHsl(),j=te.h;return[r(U),r({h:(j+72)%360,s:te.s,l:te.l}),r({h:(j+216)%360,s:te.s,l:te.l})]}function L(U,te,j){te=te||6,j=j||30;var J=r(U).toHsl(),X=360/j,re=[r(U)];for(J.h=(J.h-(X*te>>1)+720)%360;--te;)J.h=(J.h+X)%360,re.push(r(J));return re}function M(U,te){te=te||6;for(var j=r(U).toHsv(),J=j.h,X=j.s,re=j.v,ne=[],le=1/te;te--;)ne.push(r({h:J,s:X,v:re})),re=(re+le)%1;return ne}r.prototype={isDark:function(){return this.getBrightness()<128},isLight:function(){return!this.isDark()},isValid:function(){return this._ok},getOriginalInput:function(){return this._originalInput},getFormat:function(){return this._format},getAlpha:function(){return this._a},getBrightness:function(){var U=this.toRgb();return(299*U.r+587*U.g+114*U.b)/1e3},getLuminance:function(){var U,te,j,J=this.toRgb();return te=J.g/255,j=J.b/255,.2126*((U=J.r/255)<=.03928?U/12.92:g.pow((U+.055)/1.055,2.4))+.7152*(te<=.03928?te/12.92:g.pow((te+.055)/1.055,2.4))+.0722*(j<=.03928?j/12.92:g.pow((j+.055)/1.055,2.4))},setAlpha:function(U){return this._a=S(U),this._roundA=e(100*this._a)/100,this},toHsv:function(){var U=s(this._r,this._g,this._b);return{h:360*U.h,s:U.s,v:U.v,a:this._a}},toHsvString:function(){var U=s(this._r,this._g,this._b),te=e(360*U.h),j=e(100*U.s),J=e(100*U.v);return 1==this._a?"hsv("+te+", "+j+"%, "+J+"%)":"hsva("+te+", "+j+"%, "+J+"%, "+this._roundA+")"},toHsl:function(){var U=d(this._r,this._g,this._b);return{h:360*U.h,s:U.s,l:U.l,a:this._a}},toHslString:function(){var U=d(this._r,this._g,this._b),te=e(360*U.h),j=e(100*U.s),J=e(100*U.l);return 1==this._a?"hsl("+te+", "+j+"%, "+J+"%)":"hsla("+te+", "+j+"%, "+J+"%, "+this._roundA+")"},toHex:function(U){return i(this._r,this._g,this._b,U)},toHexString:function(U){return"#"+this.toHex(U)},toHex8:function(U){return j=this._g,J=this._b,X=this._a,re=U,ne=[q(e(this._r).toString(16)),q(e(j).toString(16)),q(e(J).toString(16)),q(W(X))],re&&ne[0].charAt(0)==ne[0].charAt(1)&&ne[1].charAt(0)==ne[1].charAt(1)&&ne[2].charAt(0)==ne[2].charAt(1)&&ne[3].charAt(0)==ne[3].charAt(1)?ne[0].charAt(0)+ne[1].charAt(0)+ne[2].charAt(0)+ne[3].charAt(0):ne.join("");var j,J,X,re,ne},toHex8String:function(U){return"#"+this.toHex8(U)},toRgb:function(){return{r:e(this._r),g:e(this._g),b:e(this._b),a:this._a}},toRgbString:function(){return 1==this._a?"rgb("+e(this._r)+", "+e(this._g)+", "+e(this._b)+")":"rgba("+e(this._r)+", "+e(this._g)+", "+e(this._b)+", "+this._roundA+")"},toPercentageRgb:function(){return{r:e(100*E(this._r,255))+"%",g:e(100*E(this._g,255))+"%",b:e(100*E(this._b,255))+"%",a:this._a}},toPercentageRgbString:function(){return 1==this._a?"rgb("+e(100*E(this._r,255))+"%, "+e(100*E(this._g,255))+"%, "+e(100*E(this._b,255))+"%)":"rgba("+e(100*E(this._r,255))+"%, "+e(100*E(this._g,255))+"%, "+e(100*E(this._b,255))+"%, "+this._roundA+")"},toName:function(){return 0===this._a?"transparent":!(this._a<1)&&(P[i(this._r,this._g,this._b,!0)]||!1)},toFilter:function(U){var te="#"+u(this._r,this._g,this._b,this._a),j=te,J=this._gradientType?"GradientType = 1, ":"";if(U){var X=r(U);j="#"+u(X._r,X._g,X._b,X._a)}return"progid:DXImageTransform.Microsoft.gradient("+J+"startColorstr="+te+",endColorstr="+j+")"},toString:function(U){var te=!!U;U=U||this._format;var j=!1;return te||!(this._a<1&&this._a>=0)||"hex"!==U&&"hex6"!==U&&"hex3"!==U&&"hex4"!==U&&"hex8"!==U&&"name"!==U?("rgb"===U&&(j=this.toRgbString()),"prgb"===U&&(j=this.toPercentageRgbString()),"hex"!==U&&"hex6"!==U||(j=this.toHexString()),"hex3"===U&&(j=this.toHexString(!0)),"hex4"===U&&(j=this.toHex8String(!0)),"hex8"===U&&(j=this.toHex8String()),"name"===U&&(j=this.toName()),"hsl"===U&&(j=this.toHslString()),"hsv"===U&&(j=this.toHsvString()),j||this.toHexString()):"name"===U&&0===this._a?this.toName():this.toRgbString()},clone:function(){return r(this.toString())},_applyModification:function(U,te){var j=U.apply(null,[this].concat([].slice.call(te)));return this._r=j._r,this._g=j._g,this._b=j._b,this.setAlpha(j._a),this},lighten:function(){return this._applyModification(p,arguments)},brighten:function(){return this._applyModification(o,arguments)},darken:function(){return this._applyModification(b,arguments)},desaturate:function(){return this._applyModification(f,arguments)},saturate:function(){return this._applyModification(c,arguments)},greyscale:function(){return this._applyModification(h,arguments)},spin:function(){return this._applyModification(l,arguments)},_applyCombination:function(U,te){return U.apply(null,[this].concat([].slice.call(te)))},analogous:function(){return this._applyCombination(L,arguments)},complement:function(){return this._applyCombination(T,arguments)},monochromatic:function(){return this._applyCombination(M,arguments)},splitcomplement:function(){return this._applyCombination(k,arguments)},triad:function(){return this._applyCombination(_,arguments)},tetrad:function(){return this._applyCombination(w,arguments)}},r.fromRatio=function(U,te){if("object"==typeof U){var j={};for(var J in U)U.hasOwnProperty(J)&&(j[J]="a"===J?U[J]:V(U[J]));U=j}return r(U,te)},r.equals=function(U,te){return!(!U||!te)&&r(U).toRgbString()==r(te).toRgbString()},r.random=function(){return r.fromRatio({r:a(),g:a(),b:a()})},r.mix=function(U,te,j){j=0===j?0:j||50;var J=r(U).toRgb(),X=r(te).toRgb(),re=j/100;return r({r:(X.r-J.r)*re+J.r,g:(X.g-J.g)*re+J.g,b:(X.b-J.b)*re+J.b,a:(X.a-J.a)*re+J.a})},r.readability=function(U,te){var j=r(U),J=r(te);return(g.max(j.getLuminance(),J.getLuminance())+.05)/(g.min(j.getLuminance(),J.getLuminance())+.05)},r.isReadable=function(U,te,j){var J,X,ne,le,oe,re=r.readability(U,te);switch(X=!1,(ne=j,"AA"!==(le=((ne=ne||{level:"AA",size:"small"}).level||"AA").toUpperCase())&&"AAA"!==le&&(le="AA"),"small"!==(oe=(ne.size||"small").toLowerCase())&&"large"!==oe&&(oe="small"),J={level:le,size:oe}).level+J.size){case"AAsmall":case"AAAlarge":X=re>=4.5;break;case"AAlarge":X=re>=3;break;case"AAAsmall":X=re>=7}return X},r.mostReadable=function(U,te,j){var J,X,re,ne,le=null,oe=0;X=(j=j||{}).includeFallbackColors,re=j.level,ne=j.size;for(var de=0;de<te.length;de++)(J=r.readability(U,te[de]))>oe&&(oe=J,le=r(te[de]));return r.isReadable(U,le,{level:re,size:ne})||!X?le:(j.includeFallbackColors=!1,r.mostReadable(U,["#fff","#000"],j))};var I=r.names={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"0ff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000",blanchedalmond:"ffebcd",blue:"00f",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",burntsienna:"ea7e5d",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"0ff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkgrey:"a9a9a9",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkslategrey:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dimgrey:"696969",dodgerblue:"1e90ff",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"f0f",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",grey:"808080",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgray:"d3d3d3",lightgreen:"90ee90",lightgrey:"d3d3d3",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslategray:"789",lightslategrey:"789",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"0f0",limegreen:"32cd32",linen:"faf0e6",magenta:"f0f",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370db",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"db7093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",rebeccapurple:"663399",red:"f00",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",slategrey:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",wheat:"f5deb3",white:"fff",whitesmoke:"f5f5f5",yellow:"ff0",yellowgreen:"9acd32"},P=r.hexNames=function(U){var te={};for(var j in U)U.hasOwnProperty(j)&&(te[U[j]]=j);return te}(I);function S(U){return U=parseFloat(U),(isNaN(U)||U<0||U>1)&&(U=1),U}function E(U,te){var J;"string"==typeof(J=U)&&-1!=J.indexOf(".")&&1===parseFloat(J)&&(U="100%");var j=function(J){return"string"==typeof J&&-1!=J.indexOf("%")}(U);return U=n(te,t(0,parseFloat(U))),j&&(U=parseInt(U*te,10)/100),g.abs(U-te)<1e-6?1:U%te/parseFloat(te)}function z(U){return n(1,t(0,U))}function R(U){return parseInt(U,16)}function q(U){return 1==U.length?"0"+U:""+U}function V(U){return U<=1&&(U=100*U+"%"),U}function W(U){return g.round(255*parseFloat(U)).toString(16)}function K(U){return R(U)/255}var G,Y,$,B=(Y="[\\s|\\(]+("+(G="(?:[-\\+]?\\d*\\.\\d+%?)|(?:[-\\+]?\\d+%?)")+")[,|\\s]+("+G+")[,|\\s]+("+G+")\\s*\\)?",$="[\\s|\\(]+("+G+")[,|\\s]+("+G+")[,|\\s]+("+G+")[,|\\s]+("+G+")\\s*\\)?",{CSS_UNIT:new RegExp(G),rgb:new RegExp("rgb"+Y),rgba:new RegExp("rgba"+$),hsl:new RegExp("hsl"+Y),hsla:new RegExp("hsla"+$),hsv:new RegExp("hsv"+Y),hsva:new RegExp("hsva"+$),hex3:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex6:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/,hex4:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex8:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/});function N(U){return!!B.CSS_UNIT.exec(U)}void 0!==ee&&ee.exports?ee.exports=r:window.tinycolor=r}(Math)},{}],314:[function(y,ee,Q){"use strict";ee.exports=v,ee.exports.float32=ee.exports.float=v,ee.exports.fract32=ee.exports.fract=function(m,x){if(m.length){if(m instanceof Float32Array)return new Float32Array(m.length);x instanceof Float32Array||(x=v(m));for(var e=0,n=x.length;e<n;e++)x[e]=m[e]-x[e];return x}return v(m-v(m))};var g=new Float32Array(1);function v(m){return m.length?m instanceof Float32Array?m:new Float32Array(m):(g[0]=m,g[0])}},{}],315:[function(y,ee,Q){"use strict";var g=y("parse-unit");function v(x,e){var n=g(getComputedStyle(x).getPropertyValue(e));return n[0]*m(n[1],x)}function m(x,e){switch(e=e||document.body,x=(x||"px").trim().toLowerCase(),e!==window&&e!==document||(e=document.body),x){case"%":return e.clientHeight/100;case"ch":case"ex":return function(n,t){var a=document.createElement("div");a.style["font-size"]="128"+n,t.appendChild(a);var r=v(a,"font-size")/128;return t.removeChild(a),r}(x,e);case"em":return v(e,"font-size");case"rem":return v(document.body,"font-size");case"vw":return window.innerWidth/100;case"vh":return window.innerHeight/100;case"vmin":return Math.min(window.innerWidth,window.innerHeight)/100;case"vmax":return Math.max(window.innerWidth,window.innerHeight)/100;case"in":return 96;case"cm":return 96/2.54;case"mm":return 96/25.4;case"pt":return 96/72;case"pc":return 16}return 1}ee.exports=m},{"parse-unit":251}],316:[function(y,ee,Q){var g,v;g=this,v=function(g){"use strict";function v(u){return u}function m(u){if(null==u)return v;var f,c,h=u.scale[0],p=u.scale[1],o=u.translate[0],b=u.translate[1];return function(l,T){T||(f=c=0);var _=2,w=l.length,k=new Array(w);for(k[0]=(f+=l[0])*h+o,k[1]=(c+=l[1])*p+b;_<w;)k[_]=l[_],++_;return k}}function x(u){var f,c=m(u.transform),h=1/0,p=h,o=-h,b=-h;function l(_){(_=c(_))[0]<h&&(h=_[0]),_[0]>o&&(o=_[0]),_[1]<p&&(p=_[1]),_[1]>b&&(b=_[1])}function T(_){switch(_.type){case"GeometryCollection":_.geometries.forEach(T);break;case"Point":l(_.coordinates);break;case"MultiPoint":_.coordinates.forEach(l)}}for(f in u.arcs.forEach(function(_){for(var w,k=-1,L=_.length;++k<L;)(w=c(_[k],k))[0]<h&&(h=w[0]),w[0]>o&&(o=w[0]),w[1]<p&&(p=w[1]),w[1]>b&&(b=w[1])}),u.objects)T(u.objects[f]);return[h,p,o,b]}function e(u,f){var c=f.id,h=f.bbox,p=f.properties??{},o=n(u,f);return null==c&&null==h?{type:"Feature",properties:p,geometry:o}:null==h?{type:"Feature",id:c,properties:p,geometry:o}:{type:"Feature",id:c,bbox:h,properties:p,geometry:o}}function n(u,f){var c=m(u.transform),h=u.arcs;function p(_,w){w.length&&w.pop();for(var k=h[_<0?~_:_],L=0,M=k.length;L<M;++L)w.push(c(k[L],L));_<0&&function(I,P){for(var S,E=I.length,z=E-P;z<--E;)S=I[z],I[z++]=I[E],I[E]=S}(w,M)}function o(_){return c(_)}function b(_){for(var w=[],k=0,L=_.length;k<L;++k)p(_[k],w);return w.length<2&&w.push(w[0]),w}function l(_){for(var w=b(_);w.length<4;)w.push(w[0]);return w}function T(_){return _.map(l)}return function _(w){var k,L=w.type;switch(L){case"GeometryCollection":return{type:L,geometries:w.geometries.map(_)};case"Point":k=o(w.coordinates);break;case"MultiPoint":k=w.coordinates.map(o);break;case"LineString":k=b(w.arcs);break;case"MultiLineString":k=w.arcs.map(b);break;case"Polygon":k=T(w.arcs);break;case"MultiPolygon":k=w.arcs.map(T);break;default:return null}return{type:L,coordinates:k}}(f)}function t(u,f){var c={},h={},p={},o=[],b=-1;function l(T,_){for(var w in T){var k=T[w];delete _[k.start],delete k.start,delete k.end,k.forEach(function(L){c[L<0?~L:L]=1}),o.push(k)}}return f.forEach(function(T,_){var w,k=u.arcs[T<0?~T:T];k.length<3&&!k[1][0]&&!k[1][1]&&(w=f[++b],f[b]=T,f[_]=w)}),f.forEach(function(T){var _,w,S,E,z,R,k=(R=(z=u.arcs[(S=T)<0?~S:S])[0],u.transform?(E=[0,0],z.forEach(function(q){E[0]+=q[0],E[1]+=q[1]})):E=z[z.length-1],S<0?[E,R]:[R,E]),L=k[0],M=k[1];if(_=p[L])if(delete p[_.end],_.push(T),_.end=M,w=h[M]){delete h[w.start];var I=w===_?_:_.concat(w);h[I.start=_.start]=p[I.end=w.end]=I}else h[_.start]=p[_.end]=_;else if(_=h[M])if(delete h[_.start],_.unshift(T),_.start=L,w=p[L]){delete p[w.end];var P=w===_?_:w.concat(_);h[P.start=w.start]=p[P.end=_.end]=P}else h[_.start]=p[_.end]=_;else h[(_=[T]).start=L]=p[_.end=M]=_}),l(p,h),l(h,p),f.forEach(function(T){c[T<0?~T:T]||o.push([T])}),o}function a(u,f,c){var h,p,o;if(arguments.length>1)h=r(0,f,c);else for(p=0,h=new Array(o=u.arcs.length);p<o;++p)h[p]=p;return{type:"MultiLineString",arcs:t(u,h)}}function r(u,f,c){var h,p=[],o=[];function b(_){var w=_<0?~_:_;(o[w]||(o[w]=[])).push({i:_,g:h})}function l(_){_.forEach(b)}function T(_){_.forEach(l)}return function _(w){switch(h=w,w.type){case"GeometryCollection":w.geometries.forEach(_);break;case"LineString":l(w.arcs);break;case"MultiLineString":case"Polygon":T(w.arcs);break;case"MultiPolygon":w.arcs.forEach(T)}}(f),o.forEach(null==c?function(_){p.push(_[0].i)}:function(_){c(_[0].g,_[_.length-1].g)&&p.push(_[0].i)}),p}function d(u,f){var c={},h=[],p=[];function o(l){l.forEach(function(T){T.forEach(function(_){(c[_=_<0?~_:_]||(c[_]=[])).push(l)})}),h.push(l)}function b(l){return function(T){for(var _,w=-1,k=T.length,L=T[k-1],M=0;++w<k;)M+=(_=L)[0]*(L=T[w])[1]-_[1]*L[0];return Math.abs(M)}(n(u,{type:"Polygon",arcs:[l]}).coordinates[0])}return f.forEach(function l(T){switch(T.type){case"GeometryCollection":T.geometries.forEach(l);break;case"Polygon":o(T.arcs);break;case"MultiPolygon":T.arcs.forEach(o)}}),h.forEach(function(l){if(!l._){var T=[],_=[l];for(l._=1,p.push(T);l=_.pop();)T.push(l),l.forEach(function(w){w.forEach(function(k){c[k<0?~k:k].forEach(function(L){L._||(L._=1,_.push(L))})})})}}),h.forEach(function(l){delete l._}),{type:"MultiPolygon",arcs:p.map(function(l){var T,_=[];if(l.forEach(function(I){I.forEach(function(P){P.forEach(function(S){c[S<0?~S:S].length<2&&_.push(S)})})}),(T=(_=t(u,_)).length)>1)for(var w,k,L=1,M=b(_[0]);L<T;++L)(w=b(_[L]))>M&&(k=_[0],_[0]=_[L],_[L]=k,M=w);return _}).filter(function(l){return l.length>0})}}function s(u,f){for(var c=0,h=u.length;c<h;){var p=c+h>>>1;u[p]<f?c=p+1:h=p}return c}function i(u){if(null==u)return v;var f,c,h=u.scale[0],p=u.scale[1],o=u.translate[0],b=u.translate[1];return function(l,T){T||(f=c=0);var _=2,w=l.length,k=new Array(w),L=Math.round((l[0]-o)/h),M=Math.round((l[1]-b)/p);for(k[0]=L-f,f=L,k[1]=M-c,c=M;_<w;)k[_]=l[_],++_;return k}}g.bbox=x,g.feature=function(u,f){return"string"==typeof f&&(f=u.objects[f]),"GeometryCollection"===f.type?{type:"FeatureCollection",features:f.geometries.map(function(c){return e(u,c)})}:e(u,f)},g.merge=function(u){return n(u,d.apply(this,arguments))},g.mergeArcs=d,g.mesh=function(u){return n(u,a.apply(this,arguments))},g.meshArcs=a,g.neighbors=function(u){var f={},c=u.map(function(){return[]});function h(I,P){I.forEach(function(S){S<0&&(S=~S);var E=f[S];E?E.push(P):f[S]=[P]})}function p(I,P){I.forEach(function(S){h(S,P)})}var o={LineString:h,MultiLineString:p,Polygon:p,MultiPolygon:function(I,P){I.forEach(function(S){p(S,P)})}};for(var b in u.forEach(function I(P,S){"GeometryCollection"===P.type?P.geometries.forEach(function(E){I(E,S)}):P.type in o&&o[P.type](P.arcs,S)}),f)for(var l=f[b],T=l.length,_=0;_<T;++_)for(var w=_+1;w<T;++w){var k,L=l[_],M=l[w];(k=c[L])[b=s(k,M)]!==M&&k.splice(b,0,M),(k=c[M])[b=s(k,L)]!==L&&k.splice(b,0,L)}return c},g.quantize=function(u,f){if(u.transform)throw new Error("already quantized");if(f&&f.scale)l=u.bbox;else{if(!((c=Math.floor(f))>=2))throw new Error("n must be \u22652");var c,h=(l=u.bbox||x(u))[0],p=l[1],o=l[2],b=l[3];f={scale:[o-h?(o-h)/(c-1):1,b-p?(b-p)/(c-1):1],translate:[h,p]}}var l,T,_=i(f),w=u.objects,k={};function L(I){return _(I)}function M(I){var P;switch(I.type){case"GeometryCollection":P={type:"GeometryCollection",geometries:I.geometries.map(M)};break;case"Point":P={type:"Point",coordinates:L(I.coordinates)};break;case"MultiPoint":P={type:"MultiPoint",coordinates:I.coordinates.map(L)};break;default:return I}return null!=I.id&&(P.id=I.id),null!=I.bbox&&(P.bbox=I.bbox),null!=I.properties&&(P.properties=I.properties),P}for(T in w)k[T]=M(w[T]);return{type:"Topology",bbox:l,transform:f,objects:k,arcs:u.arcs.map(function(I){var P,S=0,E=1,z=I.length,R=new Array(z);for(R[0]=_(I[0],0);++S<z;)((P=_(I[S],S))[0]||P[1])&&(R[E++]=P);return 1===E&&(R[E++]=[0,0]),R.length=E,R})}},g.transform=m,g.untransform=i,Object.defineProperty(g,"__esModule",{value:!0})},v("object"==typeof Q&&void 0!==ee?Q:(g=g||self).topojson=g.topojson||{})},{}],317:[function(y,ee,Q){"use strict";var g=y("../prototype/is");ee.exports=function(v){if("function"!=typeof v||!hasOwnProperty.call(v,"length"))return!1;try{if("number"!=typeof v.length||"function"!=typeof v.call||"function"!=typeof v.apply)return!1}catch{return!1}return!g(v)}},{"../prototype/is":324}],318:[function(y,ee,Q){"use strict";var g=y("../value/is"),v=y("../object/is"),m=y("../string/coerce"),x=y("./to-short-string"),e=function(n,t){return n.replace("%v",x(t))};ee.exports=function(n,t,a){if(!v(a))throw new TypeError(e(t,n));if(!g(n)){if("default"in a)return a.default;if(a.isOptional)return null}var r=m(a.errorMessage);throw g(r)||(r=t),new TypeError(e(r,n))}},{"../object/is":321,"../string/coerce":325,"../value/is":327,"./to-short-string":320}],319:[function(y,ee,Q){"use strict";ee.exports=function(g){try{return g.toString()}catch{try{return String(g)}catch{return null}}}},{}],320:[function(y,ee,Q){"use strict";var g=y("./safe-to-string"),v=/[\n\r\u2028\u2029]/g;ee.exports=function(m){var x=g(m);return null===x?"<Non-coercible to string value>":(x.length>100&&(x=x.slice(0,99)+"\u2026"),x=x.replace(v,function(e){switch(e){case"\n":return"\\n";case"\r":return"\\r";case"\u2028":return"\\u2028";case"\u2029":return"\\u2029";default:throw new Error("Unexpected character")}}))}},{"./safe-to-string":319}],321:[function(y,ee,Q){"use strict";var g=y("../value/is"),v={object:!0,function:!0,undefined:!0};ee.exports=function(m){return!!g(m)&&hasOwnProperty.call(v,typeof m)}},{"../value/is":327}],322:[function(y,ee,Q){"use strict";var g=y("../lib/resolve-exception"),v=y("./is");ee.exports=function(m){return v(m)?m:g(m,"%v is not a plain function",arguments[1])}},{"../lib/resolve-exception":318,"./is":323}],323:[function(y,ee,Q){"use strict";var g=y("../function/is"),v=/^\s*class[\s{/}]/,m=Function.prototype.toString;ee.exports=function(x){return!!g(x)&&!v.test(m.call(x))}},{"../function/is":317}],324:[function(y,ee,Q){"use strict";var g=y("../object/is");ee.exports=function(v){if(!g(v))return!1;try{return!!v.constructor&&v.constructor.prototype===v}catch{return!1}}},{"../object/is":321}],325:[function(y,ee,Q){"use strict";var g=y("../value/is"),v=y("../object/is"),m=Object.prototype.toString;ee.exports=function(x){if(!g(x))return null;if(v(x)){var e=x.toString;if("function"!=typeof e||e===m)return null}try{return""+x}catch{return null}}},{"../object/is":321,"../value/is":327}],326:[function(y,ee,Q){"use strict";var g=y("../lib/resolve-exception"),v=y("./is");ee.exports=function(m){return v(m)?m:g(m,"Cannot use %v",arguments[1])}},{"../lib/resolve-exception":318,"./is":327}],327:[function(y,ee,Q){"use strict";ee.exports=function(g){return null!=g}},{}],328:[function(y,ee,Q){(function(g){(function(){"use strict";var v=y("bit-twiddle"),m=y("dup"),x=y("buffer").Buffer;g.__TYPEDARRAY_POOL||(g.__TYPEDARRAY_POOL={UINT8:m([32,0]),UINT16:m([32,0]),UINT32:m([32,0]),BIGUINT64:m([32,0]),INT8:m([32,0]),INT16:m([32,0]),INT32:m([32,0]),BIGINT64:m([32,0]),FLOAT:m([32,0]),DOUBLE:m([32,0]),DATA:m([32,0]),UINT8C:m([32,0]),BUFFER:m([32,0])});var e=typeof Uint8ClampedArray<"u",n=typeof BigUint64Array<"u",t=typeof BigInt64Array<"u",a=g.__TYPEDARRAY_POOL;a.UINT8C||(a.UINT8C=m([32,0])),a.BIGUINT64||(a.BIGUINT64=m([32,0])),a.BIGINT64||(a.BIGINT64=m([32,0])),a.BUFFER||(a.BUFFER=m([32,0]));var r=a.DATA,d=a.BUFFER;function s(M){if(M){var P=v.log2(M.length||M.byteLength);r[P].push(M)}}function i(M){M=v.nextPow2(M);var I=v.log2(M),P=r[I];return P.length>0?P.pop():new ArrayBuffer(M)}function u(M){return new Uint8Array(i(M),0,M)}function f(M){return new Uint16Array(i(2*M),0,M)}function c(M){return new Uint32Array(i(4*M),0,M)}function h(M){return new Int8Array(i(M),0,M)}function p(M){return new Int16Array(i(2*M),0,M)}function o(M){return new Int32Array(i(4*M),0,M)}function b(M){return new Float32Array(i(4*M),0,M)}function l(M){return new Float64Array(i(8*M),0,M)}function T(M){return e?new Uint8ClampedArray(i(M),0,M):u(M)}function _(M){return n?new BigUint64Array(i(8*M),0,M):null}function w(M){return t?new BigInt64Array(i(8*M),0,M):null}function k(M){return new DataView(i(M),0,M)}function L(M){M=v.nextPow2(M);var I=v.log2(M),P=d[I];return P.length>0?P.pop():new x(M)}Q.free=function(M){if(x.isBuffer(M))d[v.log2(M.length)].push(M);else{if("[object ArrayBuffer]"!==Object.prototype.toString.call(M)&&(M=M.buffer),!M)return;var P=0|v.log2(M.length||M.byteLength);r[P].push(M)}},Q.freeUint8=Q.freeUint16=Q.freeUint32=Q.freeBigUint64=Q.freeInt8=Q.freeInt16=Q.freeInt32=Q.freeBigInt64=Q.freeFloat32=Q.freeFloat=Q.freeFloat64=Q.freeDouble=Q.freeUint8Clamped=Q.freeDataView=function(M){s(M.buffer)},Q.freeArrayBuffer=s,Q.freeBuffer=function(M){d[v.log2(M.length)].push(M)},Q.malloc=function(M,I){if(void 0===I||"arraybuffer"===I)return i(M);switch(I){case"uint8":return u(M);case"uint16":return f(M);case"uint32":return c(M);case"int8":return h(M);case"int16":return p(M);case"int32":return o(M);case"float":case"float32":return b(M);case"double":case"float64":return l(M);case"uint8_clamped":return T(M);case"bigint64":return w(M);case"biguint64":return _(M);case"buffer":return L(M);case"data":case"dataview":return k(M);default:return null}return null},Q.mallocArrayBuffer=i,Q.mallocUint8=u,Q.mallocUint16=f,Q.mallocUint32=c,Q.mallocInt8=h,Q.mallocInt16=p,Q.mallocInt32=o,Q.mallocFloat32=Q.mallocFloat=b,Q.mallocFloat64=Q.mallocDouble=l,Q.mallocUint8Clamped=T,Q.mallocBigUint64=_,Q.mallocBigInt64=w,Q.mallocDataView=k,Q.mallocBuffer=L,Q.clearCache=function(){for(var M=0;M<32;++M)a.UINT8[M].length=0,a.UINT16[M].length=0,a.UINT32[M].length=0,a.INT8[M].length=0,a.INT16[M].length=0,a.INT32[M].length=0,a.FLOAT[M].length=0,a.DOUBLE[M].length=0,a.BIGUINT64[M].length=0,a.BIGINT64[M].length=0,a.UINT8C[M].length=0,r[M].length=0,d[M].length=0}}).call(this)}).call(this,typeof global<"u"?global:typeof self<"u"?self:typeof window<"u"?window:{})},{"bit-twiddle":81,buffer:85,dup:128}],329:[function(y,ee,Q){var g=/[\'\"]/;ee.exports=function(v){return v?(g.test(v.charAt(0))&&(v=v.substr(1)),g.test(v.charAt(v.length-1))&&(v=v.substr(0,v.length-1)),v):""}},{}],330:[function(y,ee,Q){"use strict";ee.exports=function(g,v,m){Array.isArray(m)||(m=[].slice.call(arguments,2));for(var x=0,e=m.length;x<e;x++){var n=m[x];for(var t in n)if((void 0===v[t]||Array.isArray(v[t])||g[t]!==v[t])&&t in v){var a;if(!0===n[t])a=v[t];else if(!1===n[t]||"function"==typeof n[t]&&void 0===(a=n[t](v[t],g,v)))continue;g[t]=a}}return g}},{}],331:[function(y,ee,Q){(function(g){(function(){function v(m){try{if(!g.localStorage)return!1}catch{return!1}var x=g.localStorage[m];return null!=x&&"true"===String(x).toLowerCase()}ee.exports=function(m,x){if(v("noDeprecation"))return m;var e=!1;return function(){if(!e){if(v("throwDeprecation"))throw new Error(x);v("traceDeprecation")?console.trace(x):console.warn(x),e=!0}return m.apply(this,arguments)}}}).call(this)}).call(this,typeof global<"u"?global:typeof self<"u"?self:typeof window<"u"?window:{})},{}],332:[function(y,ee,Q){var g=y("get-canvas-context");ee.exports=function(v){return g("webgl",v)}},{"get-canvas-context":194}],333:[function(y,ee,Q){var g=y("../main"),v=y("object-assign"),m=g.instance();function x(s){this.local=this.regionalOptions[s||""]||this.regionalOptions[""]}v(x.prototype=new g.baseCalendar,{name:"Chinese",jdEpoch:1721425.5,hasYearZero:!1,minMonth:0,firstMonth:0,minDay:1,regionalOptions:{"":{name:"Chinese",epochs:["BEC","EC"],monthNumbers:function(s,i){if("string"==typeof s){var u=s.match(n);return u?u[0]:""}var f=this._validateYear(s),c=s.month(),h=""+this.toChineseMonth(f,c);return i&&h.length<2&&(h="0"+h),this.isIntercalaryMonth(f,c)&&(h+="i"),h},monthNames:function(s){if("string"==typeof s){var i=s.match(t);return i?i[0]:""}var u=this._validateYear(s),f=s.month(),c=["\u4e00\u6708","\u4e8c\u6708","\u4e09\u6708","\u56db\u6708","\u4e94\u6708","\u516d\u6708","\u4e03\u6708","\u516b\u6708","\u4e5d\u6708","\u5341\u6708","\u5341\u4e00\u6708","\u5341\u4e8c\u6708"][this.toChineseMonth(u,f)-1];return this.isIntercalaryMonth(u,f)&&(c="\u95f0"+c),c},monthNamesShort:function(s){if("string"==typeof s){var i=s.match(a);return i?i[0]:""}var u=this._validateYear(s),f=s.month(),c=["\u4e00","\u4e8c","\u4e09","\u56db","\u4e94","\u516d","\u4e03","\u516b","\u4e5d","\u5341","\u5341\u4e00","\u5341\u4e8c"][this.toChineseMonth(u,f)-1];return this.isIntercalaryMonth(u,f)&&(c="\u95f0"+c),c},parseMonth:function(s,i){s=this._validateYear(s);var u,f=parseInt(i);if(isNaN(f))"\u95f0"===i[0]&&(u=!0,i=i.substring(1)),"\u6708"===i[i.length-1]&&(i=i.substring(0,i.length-1)),f=1+["\u4e00","\u4e8c","\u4e09","\u56db","\u4e94","\u516d","\u4e03","\u516b","\u4e5d","\u5341","\u5341\u4e00","\u5341\u4e8c"].indexOf(i);else{var c=i[i.length-1];u="i"===c||"I"===c}return this.toMonthIndex(s,f,u)},dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayNamesShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],dayNamesMin:["Su","Mo","Tu","We","Th","Fr","Sa"],digits:null,dateFormat:"yyyy/mm/dd",firstDay:1,isRTL:!1}},_validateYear:function(s,i){if(s.year&&(s=s.year()),"number"!=typeof s||s<1888||s>2111)throw i.replace(/\{0\}/,this.local.name);return s},toMonthIndex:function(s,i,u){var f=this.intercalaryMonth(s);if(u&&i!==f||i<1||i>12)throw g.local.invalidMonth.replace(/\{0\}/,this.local.name);return f?!u&&i<=f?i-1:i:i-1},toChineseMonth:function(s,i){s.year&&(i=(s=s.year()).month());var u=this.intercalaryMonth(s);if(i<0||i>(u?12:11))throw g.local.invalidMonth.replace(/\{0\}/,this.local.name);return u?i<u?i+1:i:i+1},intercalaryMonth:function(s){return s=this._validateYear(s),r[s-r[0]]>>13},isIntercalaryMonth:function(s,i){s.year&&(i=(s=s.year()).month());var u=this.intercalaryMonth(s);return!!u&&u===i},leapYear:function(s){return 0!==this.intercalaryMonth(s)},weekOfYear:function(s,i,u){var f,c=this._validateYear(s,g.local.invalidyear),h=d[c-d[0]];(f=m.newDate(h>>9&4095,h>>5&15,31&h)).add(4-(f.dayOfWeek()||7),"d");var l=this.toJD(s,i,u)-f.toJD();return 1+Math.floor(l/7)},monthsInYear:function(s){return this.leapYear(s)?13:12},daysInMonth:function(s,i){s.year&&(i=s.month(),s=s.year()),s=this._validateYear(s);var u=r[s-r[0]];if(i>(u>>13?12:11))throw g.local.invalidMonth.replace(/\{0\}/,this.local.name);return u&1<<12-i?30:29},weekDay:function(s,i,u){return(this.dayOfWeek(s,i,u)||7)<6},toJD:function(s,i,u){var f=this._validate(s,h,u,g.local.invalidDate);s=this._validateYear(f.year()),i=f.month(),u=f.day();var c=this.isIntercalaryMonth(s,i),h=this.toChineseMonth(s,i),p=function(o,b,l,T,_){var w,k,L;if("object"==typeof o)k=o,w=b||{};else{var M;if(!("number"==typeof o&&o>=1888&&o<=2111))throw new Error("Lunar year outside range 1888-2111");if(!("number"==typeof b&&b>=1&&b<=12))throw new Error("Lunar month outside range 1 - 12");if(!("number"==typeof l&&l>=1&&l<=30))throw new Error("Lunar day outside range 1 - 30");"object"==typeof T?(M=!1,w=T):(M=!!T,w={}),k={year:o,month:b,day:l,isIntercalary:M}}L=k.day-1;var I,P=r[k.year-r[0]],S=P>>13;I=S&&(k.month>S||k.isIntercalary)?k.month:k.month-1;for(var E=0;E<I;E++)L+=P&1<<12-E?30:29;var z=d[k.year-d[0]],R=new Date(z>>9&4095,(z>>5&15)-1,(31&z)+L);return w.year=R.getFullYear(),w.month=1+R.getMonth(),w.day=R.getDate(),w}(s,h,u,c);return m.toJD(p.year,p.month,p.day)},fromJD:function(s){var i=m.fromJD(s),u=function(c,h,p,o){var b,l;if("object"==typeof c)b=c,l=h||{};else{if(!("number"==typeof c&&c>=1888&&c<=2111))throw new Error("Solar year outside range 1888-2111");if(!("number"==typeof h&&h>=1&&h<=12))throw new Error("Solar month outside range 1 - 12");if(!("number"==typeof p&&p>=1&&p<=31))throw new Error("Solar day outside range 1 - 31");b={year:c,month:h,day:p},l={}}var T=d[b.year-d[0]];l.year=(b.year<<9|b.month<<5|b.day)>=T?b.year:b.year-1,T=d[l.year-d[0]];var w,k=new Date(T>>9&4095,(T>>5&15)-1,31&T),L=new Date(b.year,b.month-1,b.day);w=Math.round((L-k)/864e5);var M,I=r[l.year-r[0]];for(M=0;M<13;M++){var P=I&1<<12-M?30:29;if(w<P)break;w-=P}var S=I>>13;return!S||M<S?(l.isIntercalary=!1,l.month=1+M):M===S?(l.isIntercalary=!0,l.month=M):(l.isIntercalary=!1,l.month=M),l.day=1+w,l}(i.year(),i.month(),i.day()),f=this.toMonthIndex(u.year,u.month,u.isIntercalary);return this.newDate(u.year,f,u.day)},fromString:function(s){var i=s.match(e),u=this._validateYear(+i[1]),h=this.toMonthIndex(u,+i[2],!!i[3]);return this.newDate(u,h,+i[4])},add:function(s,i,u){var f=s.year(),c=s.month(),h=this.isIntercalaryMonth(f,c),p=this.toChineseMonth(f,c),o=Object.getPrototypeOf(x.prototype).add.call(this,s,i,u);if("y"===u){var b=o.year(),l=o.month(),T=this.isIntercalaryMonth(b,p),_=this.toMonthIndex(b,p,!(!h||!T));_!==l&&o.month(_)}return o}});var e=/^\s*(-?\d\d\d\d|\d\d)[-/](\d?\d)([iI]?)[-/](\d?\d)/m,n=/^\d?\d[iI]?/m,t=/^\u95f0?\u5341?[\u4e00\u4e8c\u4e09\u56db\u4e94\u516d\u4e03\u516b\u4e5d]?\u6708/m,a=/^\u95f0?\u5341?[\u4e00\u4e8c\u4e09\u56db\u4e94\u516d\u4e03\u516b\u4e5d]?/m;g.calendars.chinese=x;var r=[1887,5780,5802,19157,2742,50359,1198,2646,46378,7466,3412,30122,5482,67949,2396,5294,43597,6732,6954,36181,2772,4954,18781,2396,54427,5274,6730,47781,5800,6868,21210,4790,59703,2350,5270,46667,3402,3496,38325,1388,4782,18735,2350,52374,6804,7498,44457,2906,1388,29294,4700,63789,6442,6804,56138,5802,2772,38235,1210,4698,22827,5418,63125,3476,5802,43701,2484,5302,27223,2646,70954,7466,3412,54698,5482,2412,38062,5294,2636,32038,6954,60245,2772,4826,43357,2394,5274,39501,6730,72357,5800,5844,53978,4790,2358,38039,5270,87627,3402,3496,54708,5484,4782,43311,2350,3222,27978,7498,68965,2904,5484,45677,4700,6444,39573,6804,6986,19285,2772,62811,1210,4698,47403,5418,5780,38570,5546,76469,2420,5302,51799,2646,5414,36501,3412,5546,18869,2412,54446,5276,6732,48422,6822,2900,28010,4826,92509,2394,5274,55883,6730,6820,47956,5812,2778,18779,2358,62615,5270,5450,46757,3492,5556,27318,4718,67887,2350,3222,52554,7498,3428,38252,5468,4700,31022,6444,64149,6804,6986,43861,2772,5338,35421,2650,70955,5418,5780,54954,5546,2740,38074,5302,2646,29991,3366,61011,3412,5546,43445,2412,5294,35406,6732,72998,6820,6996,52586,2778,2396,38045,5274,6698,23333,6820,64338,5812,2746,43355,2358,5270,39499,5450,79525,3492,5548],d=[1887,966732,967231,967733,968265,968766,969297,969798,970298,970829,971330,971830,972362,972863,973395,973896,974397,974928,975428,975929,976461,976962,977462,977994,978494,979026,979526,980026,980558,981059,981559,982091,982593,983124,983624,984124,984656,985157,985656,986189,986690,987191,987722,988222,988753,989254,989754,990286,990788,991288,991819,992319,992851,993352,993851,994383,994885,995385,995917,996418,996918,997450,997949,998481,998982,999483,1000014,1000515,1001016,1001548,1002047,1002578,1003080,1003580,1004111,1004613,1005113,1005645,1006146,1006645,1007177,1007678,1008209,1008710,1009211,1009743,1010243,1010743,1011275,1011775,1012306,1012807,1013308,1013840,1014341,1014841,1015373,1015874,1016404,1016905,1017405,1017937,1018438,1018939,1019471,1019972,1020471,1021002,1021503,1022035,1022535,1023036,1023568,1024069,1024568,1025100,1025601,1026102,1026633,1027133,1027666,1028167,1028666,1029198,1029699,1030199,1030730,1031231,1031763,1032264,1032764,1033296,1033797,1034297,1034828,1035329,1035830,1036362,1036861,1037393,1037894,1038394,1038925,1039427,1039927,1040459,1040959,1041491,1041992,1042492,1043023,1043524,1044024,1044556,1045057,1045558,1046090,1046590,1047121,1047622,1048122,1048654,1049154,1049655,1050187,1050689,1051219,1051720,1052220,1052751,1053252,1053752,1054284,1054786,1055285,1055817,1056317,1056849,1057349,1057850,1058382,1058883,1059383,1059915,1060415,1060947,1061447,1061947,1062479,1062981,1063480,1064012,1064514,1065014,1065545,1066045,1066577,1067078,1067578,1068110,1068611,1069112,1069642,1070142,1070674,1071175,1071675,1072207,1072709,1073209,1073740,1074241,1074741,1075273,1075773,1076305,1076807,1077308,1077839,1078340,1078840,1079372,1079871,1080403,1080904]},{"../main":347,"object-assign":247}],334:[function(y,ee,Q){var g=y("../main");function m(x){this.local=this.regionalOptions[x||""]||this.regionalOptions[""]}y("object-assign")(m.prototype=new g.baseCalendar,{name:"Coptic",jdEpoch:1825029.5,daysPerMonth:[30,30,30,30,30,30,30,30,30,30,30,30,5],hasYearZero:!1,minMonth:1,firstMonth:1,minDay:1,regionalOptions:{"":{name:"Coptic",epochs:["BAM","AM"],monthNames:["Thout","Paopi","Hathor","Koiak","Tobi","Meshir","Paremhat","Paremoude","Pashons","Paoni","Epip","Mesori","Pi Kogi Enavot"],monthNamesShort:["Tho","Pao","Hath","Koi","Tob","Mesh","Pat","Pad","Pash","Pao","Epi","Meso","PiK"],dayNames:["Tkyriaka","Pesnau","Pshoment","Peftoou","Ptiou","Psoou","Psabbaton"],dayNamesShort:["Tky","Pes","Psh","Pef","Pti","Pso","Psa"],dayNamesMin:["Tk","Pes","Psh","Pef","Pt","Pso","Psa"],digits:null,dateFormat:"dd/mm/yyyy",firstDay:0,isRTL:!1}},leapYear:function(x){var e=this._validate(x,this.minMonth,this.minDay,g.local.invalidYear);return(x=e.year()+(e.year()<0?1:0))%4==3||x%4==-1},monthsInYear:function(x){return this._validate(x,this.minMonth,this.minDay,g.local.invalidYear||g.regionalOptions[""].invalidYear),13},weekOfYear:function(x,e,n){var t=this.newDate(x,e,n);return t.add(-t.dayOfWeek(),"d"),Math.floor((t.dayOfYear()-1)/7)+1},daysInMonth:function(x,e){var n=this._validate(x,e,this.minDay,g.local.invalidMonth);return this.daysPerMonth[n.month()-1]+(13===n.month()&&this.leapYear(n.year())?1:0)},weekDay:function(x,e,n){return(this.dayOfWeek(x,e,n)||7)<6},toJD:function(x,e,n){var t=this._validate(x,e,n,g.local.invalidDate);return(x=t.year())<0&&x++,t.day()+30*(t.month()-1)+365*(x-1)+Math.floor(x/4)+this.jdEpoch-1},fromJD:function(x){var e=Math.floor(x)+.5-this.jdEpoch,n=Math.floor((e-Math.floor((e+366)/1461))/365)+1;n<=0&&n--,e=Math.floor(x)+.5-this.newDate(n,1,1).toJD();var t=Math.floor(e/30)+1;return this.newDate(n,t,e-30*(t-1)+1)}}),g.calendars.coptic=m},{"../main":347,"object-assign":247}],335:[function(y,ee,Q){var g=y("../main");function m(e){this.local=this.regionalOptions[e||""]||this.regionalOptions[""]}y("object-assign")(m.prototype=new g.baseCalendar,{name:"Discworld",jdEpoch:1721425.5,daysPerMonth:[16,32,32,32,32,32,32,32,32,32,32,32,32],hasYearZero:!1,minMonth:1,firstMonth:1,minDay:1,regionalOptions:{"":{name:"Discworld",epochs:["BUC","UC"],monthNames:["Ick","Offle","February","March","April","May","June","Grune","August","Spune","Sektober","Ember","December"],monthNamesShort:["Ick","Off","Feb","Mar","Apr","May","Jun","Gru","Aug","Spu","Sek","Emb","Dec"],dayNames:["Sunday","Octeday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayNamesShort:["Sun","Oct","Mon","Tue","Wed","Thu","Fri","Sat"],dayNamesMin:["Su","Oc","Mo","Tu","We","Th","Fr","Sa"],digits:null,dateFormat:"yyyy/mm/dd",firstDay:2,isRTL:!1}},leapYear:function(e){return this._validate(e,this.minMonth,this.minDay,g.local.invalidYear),!1},monthsInYear:function(e){return this._validate(e,this.minMonth,this.minDay,g.local.invalidYear),13},daysInYear:function(e){return this._validate(e,this.minMonth,this.minDay,g.local.invalidYear),400},weekOfYear:function(e,n,t){var a=this.newDate(e,n,t);return a.add(-a.dayOfWeek(),"d"),Math.floor((a.dayOfYear()-1)/8)+1},daysInMonth:function(e,n){var t=this._validate(e,n,this.minDay,g.local.invalidMonth);return this.daysPerMonth[t.month()-1]},daysInWeek:function(){return 8},dayOfWeek:function(e,n,t){return(this._validate(e,n,t,g.local.invalidDate).day()+1)%8},weekDay:function(e,n,t){var a=this.dayOfWeek(e,n,t);return a>=2&&a<=6},extraInfo:function(e,n,t){var a=this._validate(e,n,t,g.local.invalidDate);return{century:x[Math.floor((a.year()-1)/100)+1]||""}},toJD:function(e,n,t){var a=this._validate(e,n,t,g.local.invalidDate);return e=a.year()+(a.year()<0?1:0),n=a.month(),(t=a.day())+(n>1?16:0)+(n>2?32*(n-2):0)+400*(e-1)+this.jdEpoch-1},fromJD:function(e){e=Math.floor(e+.5)-Math.floor(this.jdEpoch)-1;var n=Math.floor(e/400)+1;e-=400*(n-1),e+=e>15?16:0;var t=Math.floor(e/32)+1;return this.newDate(n<=0?n-1:n,t,e-32*(t-1)+1)}});var x={20:"Fruitbat",21:"Anchovy"};g.calendars.discworld=m},{"../main":347,"object-assign":247}],336:[function(y,ee,Q){var g=y("../main");function m(x){this.local=this.regionalOptions[x||""]||this.regionalOptions[""]}y("object-assign")(m.prototype=new g.baseCalendar,{name:"Ethiopian",jdEpoch:1724220.5,daysPerMonth:[30,30,30,30,30,30,30,30,30,30,30,30,5],hasYearZero:!1,minMonth:1,firstMonth:1,minDay:1,regionalOptions:{"":{name:"Ethiopian",epochs:["BEE","EE"],monthNames:["Meskerem","Tikemet","Hidar","Tahesas","Tir","Yekatit","Megabit","Miazia","Genbot","Sene","Hamle","Nehase","Pagume"],monthNamesShort:["Mes","Tik","Hid","Tah","Tir","Yek","Meg","Mia","Gen","Sen","Ham","Neh","Pag"],dayNames:["Ehud","Segno","Maksegno","Irob","Hamus","Arb","Kidame"],dayNamesShort:["Ehu","Seg","Mak","Iro","Ham","Arb","Kid"],dayNamesMin:["Eh","Se","Ma","Ir","Ha","Ar","Ki"],digits:null,dateFormat:"dd/mm/yyyy",firstDay:0,isRTL:!1}},leapYear:function(x){var e=this._validate(x,this.minMonth,this.minDay,g.local.invalidYear);return(x=e.year()+(e.year()<0?1:0))%4==3||x%4==-1},monthsInYear:function(x){return this._validate(x,this.minMonth,this.minDay,g.local.invalidYear||g.regionalOptions[""].invalidYear),13},weekOfYear:function(x,e,n){var t=this.newDate(x,e,n);return t.add(-t.dayOfWeek(),"d"),Math.floor((t.dayOfYear()-1)/7)+1},daysInMonth:function(x,e){var n=this._validate(x,e,this.minDay,g.local.invalidMonth);return this.daysPerMonth[n.month()-1]+(13===n.month()&&this.leapYear(n.year())?1:0)},weekDay:function(x,e,n){return(this.dayOfWeek(x,e,n)||7)<6},toJD:function(x,e,n){var t=this._validate(x,e,n,g.local.invalidDate);return(x=t.year())<0&&x++,t.day()+30*(t.month()-1)+365*(x-1)+Math.floor(x/4)+this.jdEpoch-1},fromJD:function(x){var e=Math.floor(x)+.5-this.jdEpoch,n=Math.floor((e-Math.floor((e+366)/1461))/365)+1;n<=0&&n--,e=Math.floor(x)+.5-this.newDate(n,1,1).toJD();var t=Math.floor(e/30)+1;return this.newDate(n,t,e-30*(t-1)+1)}}),g.calendars.ethiopian=m},{"../main":347,"object-assign":247}],337:[function(y,ee,Q){var g=y("../main");function m(e){this.local=this.regionalOptions[e||""]||this.regionalOptions[""]}function x(e,n){return e-n*Math.floor(e/n)}y("object-assign")(m.prototype=new g.baseCalendar,{name:"Hebrew",jdEpoch:347995.5,daysPerMonth:[30,29,30,29,30,29,30,29,30,29,30,29,29],hasYearZero:!1,minMonth:1,firstMonth:7,minDay:1,regionalOptions:{"":{name:"Hebrew",epochs:["BAM","AM"],monthNames:["Nisan","Iyar","Sivan","Tammuz","Av","Elul","Tishrei","Cheshvan","Kislev","Tevet","Shevat","Adar","Adar II"],monthNamesShort:["Nis","Iya","Siv","Tam","Av","Elu","Tis","Che","Kis","Tev","She","Ada","Ad2"],dayNames:["Yom Rishon","Yom Sheni","Yom Shlishi","Yom Revi'i","Yom Chamishi","Yom Shishi","Yom Shabbat"],dayNamesShort:["Ris","She","Shl","Rev","Cha","Shi","Sha"],dayNamesMin:["Ri","She","Shl","Re","Ch","Shi","Sha"],digits:null,dateFormat:"dd/mm/yyyy",firstDay:0,isRTL:!1}},leapYear:function(e){var n=this._validate(e,this.minMonth,this.minDay,g.local.invalidYear);return this._leapYear(n.year())},_leapYear:function(e){return x(7*(e=e<0?e+1:e)+1,19)<7},monthsInYear:function(e){return this._validate(e,this.minMonth,this.minDay,g.local.invalidYear),this._leapYear(e.year?e.year():e)?13:12},weekOfYear:function(e,n,t){var a=this.newDate(e,n,t);return a.add(-a.dayOfWeek(),"d"),Math.floor((a.dayOfYear()-1)/7)+1},daysInYear:function(e){return e=this._validate(e,this.minMonth,this.minDay,g.local.invalidYear).year(),this.toJD(-1===e?1:e+1,7,1)-this.toJD(e,7,1)},daysInMonth:function(e,n){return e.year&&(n=e.month(),e=e.year()),this._validate(e,n,this.minDay,g.local.invalidMonth),12===n&&this.leapYear(e)||8===n&&5===x(this.daysInYear(e),10)?30:9===n&&3===x(this.daysInYear(e),10)?29:this.daysPerMonth[n-1]},weekDay:function(e,n,t){return 6!==this.dayOfWeek(e,n,t)},extraInfo:function(e,n,t){var a=this._validate(e,n,t,g.local.invalidDate);return{yearType:(this.leapYear(a)?"embolismic":"common")+" "+["deficient","regular","complete"][this.daysInYear(a)%10-3]}},toJD:function(e,n,t){var a=this._validate(e,n,t,g.local.invalidDate);e=a.year(),n=a.month(),t=a.day();var r=e<=0?e+1:e,d=this.jdEpoch+this._delay1(r)+this._delay2(r)+t+1;if(n<7){for(var s=7;s<=this.monthsInYear(e);s++)d+=this.daysInMonth(e,s);for(s=1;s<n;s++)d+=this.daysInMonth(e,s)}else for(s=7;s<n;s++)d+=this.daysInMonth(e,s);return d},_delay1:function(e){var n=Math.floor((235*e-234)/19),a=29*n+Math.floor((12084+13753*n)/25920);return x(3*(a+1),7)<3&&a++,a},_delay2:function(e){var n=this._delay1(e-1),t=this._delay1(e);return this._delay1(e+1)-t==356?2:t-n==382?1:0},fromJD:function(e){e=Math.floor(e)+.5;for(var n=Math.floor(98496*(e-this.jdEpoch)/35975351)-1;e>=this.toJD(-1===n?1:n+1,7,1);)n++;for(var t=e<this.toJD(n,1,1)?7:1;e>this.toJD(n,t,this.daysInMonth(n,t));)t++;var a=e-this.toJD(n,t,1)+1;return this.newDate(n,t,a)}}),g.calendars.hebrew=m},{"../main":347,"object-assign":247}],338:[function(y,ee,Q){var g=y("../main");function m(x){this.local=this.regionalOptions[x||""]||this.regionalOptions[""]}y("object-assign")(m.prototype=new g.baseCalendar,{name:"Islamic",jdEpoch:1948439.5,daysPerMonth:[30,29,30,29,30,29,30,29,30,29,30,29],hasYearZero:!1,minMonth:1,firstMonth:1,minDay:1,regionalOptions:{"":{name:"Islamic",epochs:["BH","AH"],monthNames:["Muharram","Safar","Rabi' al-awwal","Rabi' al-thani","Jumada al-awwal","Jumada al-thani","Rajab","Sha'aban","Ramadan","Shawwal","Dhu al-Qi'dah","Dhu al-Hijjah"],monthNamesShort:["Muh","Saf","Rab1","Rab2","Jum1","Jum2","Raj","Sha'","Ram","Shaw","DhuQ","DhuH"],dayNames:["Yawm al-ahad","Yawm al-ithnayn","Yawm ath-thulaathaa'","Yawm al-arbi'aa'","Yawm al-kham\u012bs","Yawm al-jum'a","Yawm as-sabt"],dayNamesShort:["Aha","Ith","Thu","Arb","Kha","Jum","Sab"],dayNamesMin:["Ah","It","Th","Ar","Kh","Ju","Sa"],digits:null,dateFormat:"yyyy/mm/dd",firstDay:6,isRTL:!1}},leapYear:function(x){return(11*this._validate(x,this.minMonth,this.minDay,g.local.invalidYear).year()+14)%30<11},weekOfYear:function(x,e,n){var t=this.newDate(x,e,n);return t.add(-t.dayOfWeek(),"d"),Math.floor((t.dayOfYear()-1)/7)+1},daysInYear:function(x){return this.leapYear(x)?355:354},daysInMonth:function(x,e){var n=this._validate(x,e,this.minDay,g.local.invalidMonth);return this.daysPerMonth[n.month()-1]+(12===n.month()&&this.leapYear(n.year())?1:0)},weekDay:function(x,e,n){return 5!==this.dayOfWeek(x,e,n)},toJD:function(x,e,n){var t=this._validate(x,e,n,g.local.invalidDate);return x=t.year(),e=t.month(),x=x<=0?x+1:x,(n=t.day())+Math.ceil(29.5*(e-1))+354*(x-1)+Math.floor((3+11*x)/30)+this.jdEpoch-1},fromJD:function(x){x=Math.floor(x)+.5;var e=Math.floor((30*(x-this.jdEpoch)+10646)/10631);e=e<=0?e-1:e;var n=Math.min(12,Math.ceil((x-29-this.toJD(e,1,1))/29.5)+1),t=x-this.toJD(e,n,1)+1;return this.newDate(e,n,t)}}),g.calendars.islamic=m},{"../main":347,"object-assign":247}],339:[function(y,ee,Q){var g=y("../main");function m(x){this.local=this.regionalOptions[x||""]||this.regionalOptions[""]}y("object-assign")(m.prototype=new g.baseCalendar,{name:"Julian",jdEpoch:1721423.5,daysPerMonth:[31,28,31,30,31,30,31,31,30,31,30,31],hasYearZero:!1,minMonth:1,firstMonth:1,minDay:1,regionalOptions:{"":{name:"Julian",epochs:["BC","AD"],monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],monthNamesShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayNamesShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],dayNamesMin:["Su","Mo","Tu","We","Th","Fr","Sa"],digits:null,dateFormat:"mm/dd/yyyy",firstDay:0,isRTL:!1}},leapYear:function(x){var e=this._validate(x,this.minMonth,this.minDay,g.local.invalidYear);return(x=e.year()<0?e.year()+1:e.year())%4==0},weekOfYear:function(x,e,n){var t=this.newDate(x,e,n);return t.add(4-(t.dayOfWeek()||7),"d"),Math.floor((t.dayOfYear()-1)/7)+1},daysInMonth:function(x,e){var n=this._validate(x,e,this.minDay,g.local.invalidMonth);return this.daysPerMonth[n.month()-1]+(2===n.month()&&this.leapYear(n.year())?1:0)},weekDay:function(x,e,n){return(this.dayOfWeek(x,e,n)||7)<6},toJD:function(x,e,n){var t=this._validate(x,e,n,g.local.invalidDate);return x=t.year(),e=t.month(),n=t.day(),x<0&&x++,e<=2&&(x--,e+=12),Math.floor(365.25*(x+4716))+Math.floor(30.6001*(e+1))+n-1524.5},fromJD:function(x){var e=Math.floor(x+.5)+1524,n=Math.floor((e-122.1)/365.25),t=Math.floor(365.25*n),a=Math.floor((e-t)/30.6001),r=a-Math.floor(a<14?1:13),d=n-Math.floor(r>2?4716:4715),s=e-t-Math.floor(30.6001*a);return d<=0&&d--,this.newDate(d,r,s)}}),g.calendars.julian=m},{"../main":347,"object-assign":247}],340:[function(y,ee,Q){var g=y("../main");function m(n){this.local=this.regionalOptions[n||""]||this.regionalOptions[""]}function x(n,t){return n-t*Math.floor(n/t)}function e(n,t){return x(n-1,t)+1}y("object-assign")(m.prototype=new g.baseCalendar,{name:"Mayan",jdEpoch:584282.5,hasYearZero:!0,minMonth:0,firstMonth:0,minDay:0,regionalOptions:{"":{name:"Mayan",epochs:["",""],monthNames:["0","1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17"],monthNamesShort:["0","1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17"],dayNames:["0","1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19"],dayNamesShort:["0","1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19"],dayNamesMin:["0","1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19"],digits:null,dateFormat:"YYYY.m.d",firstDay:0,isRTL:!1,haabMonths:["Pop","Uo","Zip","Zotz","Tzec","Xul","Yaxkin","Mol","Chen","Yax","Zac","Ceh","Mac","Kankin","Muan","Pax","Kayab","Cumku","Uayeb"],tzolkinMonths:["Imix","Ik","Akbal","Kan","Chicchan","Cimi","Manik","Lamat","Muluc","Oc","Chuen","Eb","Ben","Ix","Men","Cib","Caban","Etznab","Cauac","Ahau"]}},leapYear:function(n){return this._validate(n,this.minMonth,this.minDay,g.local.invalidYear),!1},formatYear:function(n){n=this._validate(n,this.minMonth,this.minDay,g.local.invalidYear).year();var t=Math.floor(n/400);return n%=400,n+=n<0?400:0,t+"."+Math.floor(n/20)+"."+n%20},forYear:function(n){if((n=n.split(".")).length<3)throw"Invalid Mayan year";for(var t=0,a=0;a<n.length;a++){var r=parseInt(n[a],10);if(Math.abs(r)>19||a>0&&r<0)throw"Invalid Mayan year";t=20*t+r}return t},monthsInYear:function(n){return this._validate(n,this.minMonth,this.minDay,g.local.invalidYear),18},weekOfYear:function(n,t,a){return this._validate(n,t,a,g.local.invalidDate),0},daysInYear:function(n){return this._validate(n,this.minMonth,this.minDay,g.local.invalidYear),360},daysInMonth:function(n,t){return this._validate(n,t,this.minDay,g.local.invalidMonth),20},daysInWeek:function(){return 5},dayOfWeek:function(n,t,a){return this._validate(n,t,a,g.local.invalidDate).day()},weekDay:function(n,t,a){return this._validate(n,t,a,g.local.invalidDate),!0},extraInfo:function(n,t,a){var r=this._validate(n,t,a,g.local.invalidDate).toJD(),d=this._toHaab(r),s=this._toTzolkin(r);return{haabMonthName:this.local.haabMonths[d[0]-1],haabMonth:d[0],haabDay:d[1],tzolkinDayName:this.local.tzolkinMonths[s[0]-1],tzolkinDay:s[0],tzolkinTrecena:s[1]}},_toHaab:function(n){var t=x(8+(n-=this.jdEpoch)+340,365);return[Math.floor(t/20)+1,x(t,20)]},_toTzolkin:function(n){return[e(20+(n-=this.jdEpoch),20),e(n+4,13)]},toJD:function(n,t,a){var r=this._validate(n,t,a,g.local.invalidDate);return r.day()+20*r.month()+360*r.year()+this.jdEpoch},fromJD:function(n){n=Math.floor(n)+.5-this.jdEpoch;var t=Math.floor(n/360);n%=360,n+=n<0?360:0;var a=Math.floor(n/20);return this.newDate(t,a,n%20)}}),g.calendars.mayan=m},{"../main":347,"object-assign":247}],341:[function(y,ee,Q){var g=y("../main"),v=y("object-assign");function m(e){this.local=this.regionalOptions[e||""]||this.regionalOptions[""]}m.prototype=new g.baseCalendar;var x=g.instance("gregorian");v(m.prototype,{name:"Nanakshahi",jdEpoch:2257673.5,daysPerMonth:[31,31,31,31,31,30,30,30,30,30,30,30],hasYearZero:!1,minMonth:1,firstMonth:1,minDay:1,regionalOptions:{"":{name:"Nanakshahi",epochs:["BN","AN"],monthNames:["Chet","Vaisakh","Jeth","Harh","Sawan","Bhadon","Assu","Katak","Maghar","Poh","Magh","Phagun"],monthNamesShort:["Che","Vai","Jet","Har","Saw","Bha","Ass","Kat","Mgr","Poh","Mgh","Pha"],dayNames:["Somvaar","Mangalvar","Budhvaar","Veervaar","Shukarvaar","Sanicharvaar","Etvaar"],dayNamesShort:["Som","Mangal","Budh","Veer","Shukar","Sanichar","Et"],dayNamesMin:["So","Ma","Bu","Ve","Sh","Sa","Et"],digits:null,dateFormat:"dd-mm-yyyy",firstDay:0,isRTL:!1}},leapYear:function(e){var n=this._validate(e,this.minMonth,this.minDay,g.local.invalidYear||g.regionalOptions[""].invalidYear);return x.leapYear(n.year()+(n.year()<1?1:0)+1469)},weekOfYear:function(e,n,t){var a=this.newDate(e,n,t);return a.add(1-(a.dayOfWeek()||7),"d"),Math.floor((a.dayOfYear()-1)/7)+1},daysInMonth:function(e,n){var t=this._validate(e,n,this.minDay,g.local.invalidMonth);return this.daysPerMonth[t.month()-1]+(12===t.month()&&this.leapYear(t.year())?1:0)},weekDay:function(e,n,t){return(this.dayOfWeek(e,n,t)||7)<6},toJD:function(e,n,t){var a=this._validate(e,n,t,g.local.invalidMonth);(e=a.year())<0&&e++;for(var r=a.day(),d=1;d<a.month();d++)r+=this.daysPerMonth[d-1];return r+x.toJD(e+1468,3,13)},fromJD:function(e){e=Math.floor(e+.5);for(var n=Math.floor((e-(this.jdEpoch-1))/366);e>=this.toJD(n+1,1,1);)n++;for(var t=e-Math.floor(this.toJD(n,1,1)+.5)+1,a=1;t>this.daysInMonth(n,a);)t-=this.daysInMonth(n,a),a++;return this.newDate(n,a,t)}}),g.calendars.nanakshahi=m},{"../main":347,"object-assign":247}],342:[function(y,ee,Q){var g=y("../main");function m(x){this.local=this.regionalOptions[x||""]||this.regionalOptions[""]}y("object-assign")(m.prototype=new g.baseCalendar,{name:"Nepali",jdEpoch:1700709.5,daysPerMonth:[31,31,32,32,31,30,30,29,30,29,30,30],hasYearZero:!1,minMonth:1,firstMonth:1,minDay:1,daysPerYear:365,regionalOptions:{"":{name:"Nepali",epochs:["BBS","ABS"],monthNames:["Baisakh","Jestha","Ashadh","Shrawan","Bhadra","Ashwin","Kartik","Mangsir","Paush","Mangh","Falgun","Chaitra"],monthNamesShort:["Bai","Je","As","Shra","Bha","Ash","Kar","Mang","Pau","Ma","Fal","Chai"],dayNames:["Aaitabaar","Sombaar","Manglbaar","Budhabaar","Bihibaar","Shukrabaar","Shanibaar"],dayNamesShort:["Aaita","Som","Mangl","Budha","Bihi","Shukra","Shani"],dayNamesMin:["Aai","So","Man","Bu","Bi","Shu","Sha"],digits:null,dateFormat:"dd/mm/yyyy",firstDay:1,isRTL:!1}},leapYear:function(x){return this.daysInYear(x)!==this.daysPerYear},weekOfYear:function(x,e,n){var t=this.newDate(x,e,n);return t.add(-t.dayOfWeek(),"d"),Math.floor((t.dayOfYear()-1)/7)+1},daysInYear:function(x){if(x=this._validate(x,this.minMonth,this.minDay,g.local.invalidYear).year(),void 0===this.NEPALI_CALENDAR_DATA[x])return this.daysPerYear;for(var e=0,n=this.minMonth;n<=12;n++)e+=this.NEPALI_CALENDAR_DATA[x][n];return e},daysInMonth:function(x,e){return x.year&&(e=x.month(),x=x.year()),this._validate(x,e,this.minDay,g.local.invalidMonth),void 0===this.NEPALI_CALENDAR_DATA[x]?this.daysPerMonth[e-1]:this.NEPALI_CALENDAR_DATA[x][e]},weekDay:function(x,e,n){return 6!==this.dayOfWeek(x,e,n)},toJD:function(x,e,n){var t=this._validate(x,e,n,g.local.invalidDate);x=t.year(),e=t.month(),n=t.day();var a=g.instance(),r=0,d=e,s=x;this._createMissingCalendarData(x);var i=x-(d>9||9===d&&n>=this.NEPALI_CALENDAR_DATA[s][0]?56:57);for(9!==e&&(r=n,d--);9!==d;)d<=0&&(d=12,s--),r+=this.NEPALI_CALENDAR_DATA[s][d],d--;return 9===e?(r+=n-this.NEPALI_CALENDAR_DATA[s][0])<0&&(r+=a.daysInYear(i)):r+=this.NEPALI_CALENDAR_DATA[s][9]-this.NEPALI_CALENDAR_DATA[s][0],a.newDate(i,1,1).add(r,"d").toJD()},fromJD:function(x){var e=g.instance().fromJD(x),n=e.year(),t=e.dayOfYear(),a=n+56;this._createMissingCalendarData(a);for(var r=9,s=this.NEPALI_CALENDAR_DATA[a][r]-this.NEPALI_CALENDAR_DATA[a][0]+1;t>s;)++r>12&&(r=1,a++),s+=this.NEPALI_CALENDAR_DATA[a][r];return this.newDate(a,r,this.NEPALI_CALENDAR_DATA[a][r]-(s-t))},_createMissingCalendarData:function(x){var e=this.daysPerMonth.slice(0);e.unshift(17);for(var n=x-1;n<x+2;n++)void 0===this.NEPALI_CALENDAR_DATA[n]&&(this.NEPALI_CALENDAR_DATA[n]=e)},NEPALI_CALENDAR_DATA:{1970:[18,31,31,32,31,31,31,30,29,30,29,30,30],1971:[18,31,31,32,31,32,30,30,29,30,29,30,30],1972:[17,31,32,31,32,31,30,30,30,29,29,30,30],1973:[19,30,32,31,32,31,30,30,30,29,30,29,31],1974:[19,31,31,32,30,31,31,30,29,30,29,30,30],1975:[18,31,31,32,32,30,31,30,29,30,29,30,30],1976:[17,31,32,31,32,31,30,30,30,29,29,30,31],1977:[18,31,32,31,32,31,31,29,30,29,30,29,31],1978:[18,31,31,32,31,31,31,30,29,30,29,30,30],1979:[18,31,31,32,32,31,30,30,29,30,29,30,30],1980:[17,31,32,31,32,31,30,30,30,29,29,30,31],1981:[18,31,31,31,32,31,31,29,30,30,29,30,30],1982:[18,31,31,32,31,31,31,30,29,30,29,30,30],1983:[18,31,31,32,32,31,30,30,29,30,29,30,30],1984:[17,31,32,31,32,31,30,30,30,29,29,30,31],1985:[18,31,31,31,32,31,31,29,30,30,29,30,30],1986:[18,31,31,32,31,31,31,30,29,30,29,30,30],1987:[18,31,32,31,32,31,30,30,29,30,29,30,30],1988:[17,31,32,31,32,31,30,30,30,29,29,30,31],1989:[18,31,31,31,32,31,31,30,29,30,29,30,30],1990:[18,31,31,32,31,31,31,30,29,30,29,30,30],1991:[18,31,32,31,32,31,30,30,29,30,29,30,30],1992:[17,31,32,31,32,31,30,30,30,29,30,29,31],1993:[18,31,31,31,32,31,31,30,29,30,29,30,30],1994:[18,31,31,32,31,31,31,30,29,30,29,30,30],1995:[17,31,32,31,32,31,30,30,30,29,29,30,30],1996:[17,31,32,31,32,31,30,30,30,29,30,29,31],1997:[18,31,31,32,31,31,31,30,29,30,29,30,30],1998:[18,31,31,32,31,31,31,30,29,30,29,30,30],1999:[17,31,32,31,32,31,30,30,30,29,29,30,31],2e3:[17,30,32,31,32,31,30,30,30,29,30,29,31],2001:[18,31,31,32,31,31,31,30,29,30,29,30,30],2002:[18,31,31,32,32,31,30,30,29,30,29,30,30],2003:[17,31,32,31,32,31,30,30,30,29,29,30,31],2004:[17,30,32,31,32,31,30,30,30,29,30,29,31],2005:[18,31,31,32,31,31,31,30,29,30,29,30,30],2006:[18,31,31,32,32,31,30,30,29,30,29,30,30],2007:[17,31,32,31,32,31,30,30,30,29,29,30,31],2008:[17,31,31,31,32,31,31,29,30,30,29,29,31],2009:[18,31,31,32,31,31,31,30,29,30,29,30,30],2010:[18,31,31,32,32,31,30,30,29,30,29,30,30],2011:[17,31,32,31,32,31,30,30,30,29,29,30,31],2012:[17,31,31,31,32,31,31,29,30,30,29,30,30],2013:[18,31,31,32,31,31,31,30,29,30,29,30,30],2014:[18,31,31,32,32,31,30,30,29,30,29,30,30],2015:[17,31,32,31,32,31,30,30,30,29,29,30,31],2016:[17,31,31,31,32,31,31,29,30,30,29,30,30],2017:[18,31,31,32,31,31,31,30,29,30,29,30,30],2018:[18,31,32,31,32,31,30,30,29,30,29,30,30],2019:[17,31,32,31,32,31,30,30,30,29,30,29,31],2020:[17,31,31,31,32,31,31,30,29,30,29,30,30],2021:[18,31,31,32,31,31,31,30,29,30,29,30,30],2022:[17,31,32,31,32,31,30,30,30,29,29,30,30],2023:[17,31,32,31,32,31,30,30,30,29,30,29,31],2024:[17,31,31,31,32,31,31,30,29,30,29,30,30],2025:[18,31,31,32,31,31,31,30,29,30,29,30,30],2026:[17,31,32,31,32,31,30,30,30,29,29,30,31],2027:[17,30,32,31,32,31,30,30,30,29,30,29,31],2028:[17,31,31,32,31,31,31,30,29,30,29,30,30],2029:[18,31,31,32,31,32,30,30,29,30,29,30,30],2030:[17,31,32,31,32,31,30,30,30,30,30,30,31],2031:[17,31,32,31,32,31,31,31,31,31,31,31,31],2032:[17,32,32,32,32,32,32,32,32,32,32,32,32],2033:[18,31,31,32,32,31,30,30,29,30,29,30,30],2034:[17,31,32,31,32,31,30,30,30,29,29,30,31],2035:[17,30,32,31,32,31,31,29,30,30,29,29,31],2036:[17,31,31,32,31,31,31,30,29,30,29,30,30],2037:[18,31,31,32,32,31,30,30,29,30,29,30,30],2038:[17,31,32,31,32,31,30,30,30,29,29,30,31],2039:[17,31,31,31,32,31,31,29,30,30,29,30,30],2040:[17,31,31,32,31,31,31,30,29,30,29,30,30],2041:[18,31,31,32,32,31,30,30,29,30,29,30,30],2042:[17,31,32,31,32,31,30,30,30,29,29,30,31],2043:[17,31,31,31,32,31,31,29,30,30,29,30,30],2044:[17,31,31,32,31,31,31,30,29,30,29,30,30],2045:[18,31,32,31,32,31,30,30,29,30,29,30,30],2046:[17,31,32,31,32,31,30,30,30,29,29,30,31],2047:[17,31,31,31,32,31,31,30,29,30,29,30,30],2048:[17,31,31,32,31,31,31,30,29,30,29,30,30],2049:[17,31,32,31,32,31,30,30,30,29,29,30,30],2050:[17,31,32,31,32,31,30,30,30,29,30,29,31],2051:[17,31,31,31,32,31,31,30,29,30,29,30,30],2052:[17,31,31,32,31,31,31,30,29,30,29,30,30],2053:[17,31,32,31,32,31,30,30,30,29,29,30,30],2054:[17,31,32,31,32,31,30,30,30,29,30,29,31],2055:[17,31,31,32,31,31,31,30,29,30,30,29,30],2056:[17,31,31,32,31,32,30,30,29,30,29,30,30],2057:[17,31,32,31,32,31,30,30,30,29,29,30,31],2058:[17,30,32,31,32,31,30,30,30,29,30,29,31],2059:[17,31,31,32,31,31,31,30,29,30,29,30,30],2060:[17,31,31,32,32,31,30,30,29,30,29,30,30],2061:[17,31,32,31,32,31,30,30,30,29,29,30,31],2062:[17,30,32,31,32,31,31,29,30,29,30,29,31],2063:[17,31,31,32,31,31,31,30,29,30,29,30,30],2064:[17,31,31,32,32,31,30,30,29,30,29,30,30],2065:[17,31,32,31,32,31,30,30,30,29,29,30,31],2066:[17,31,31,31,32,31,31,29,30,30,29,29,31],2067:[17,31,31,32,31,31,31,30,29,30,29,30,30],2068:[17,31,31,32,32,31,30,30,29,30,29,30,30],2069:[17,31,32,31,32,31,30,30,30,29,29,30,31],2070:[17,31,31,31,32,31,31,29,30,30,29,30,30],2071:[17,31,31,32,31,31,31,30,29,30,29,30,30],2072:[17,31,32,31,32,31,30,30,29,30,29,30,30],2073:[17,31,32,31,32,31,30,30,30,29,29,30,31],2074:[17,31,31,31,32,31,31,30,29,30,29,30,30],2075:[17,31,31,32,31,31,31,30,29,30,29,30,30],2076:[16,31,32,31,32,31,30,30,30,29,29,30,30],2077:[17,31,32,31,32,31,30,30,30,29,30,29,31],2078:[17,31,31,31,32,31,31,30,29,30,29,30,30],2079:[17,31,31,32,31,31,31,30,29,30,29,30,30],2080:[16,31,32,31,32,31,30,30,30,29,29,30,30],2081:[17,31,31,32,32,31,30,30,30,29,30,30,30],2082:[17,31,32,31,32,31,30,30,30,29,30,30,30],2083:[17,31,31,32,31,31,30,30,30,29,30,30,30],2084:[17,31,31,32,31,31,30,30,30,29,30,30,30],2085:[17,31,32,31,32,31,31,30,30,29,30,30,30],2086:[17,31,32,31,32,31,30,30,30,29,30,30,30],2087:[16,31,31,32,31,31,31,30,30,29,30,30,30],2088:[16,30,31,32,32,30,31,30,30,29,30,30,30],2089:[17,31,32,31,32,31,30,30,30,29,30,30,30],2090:[17,31,32,31,32,31,30,30,30,29,30,30,30],2091:[16,31,31,32,31,31,31,30,30,29,30,30,30],2092:[16,31,31,32,32,31,30,30,30,29,30,30,30],2093:[17,31,32,31,32,31,30,30,30,29,30,30,30],2094:[17,31,31,32,31,31,30,30,30,29,30,30,30],2095:[17,31,31,32,31,31,31,30,29,30,30,30,30],2096:[17,30,31,32,32,31,30,30,29,30,29,30,30],2097:[17,31,32,31,32,31,30,30,30,29,30,30,30],2098:[17,31,31,32,31,31,31,29,30,29,30,30,31],2099:[17,31,31,32,31,31,31,30,29,29,30,30,30],2100:[17,31,32,31,32,30,31,30,29,30,29,30,30]}}),g.calendars.nepali=m},{"../main":347,"object-assign":247}],343:[function(y,ee,Q){var g=y("../main");function m(e){this.local=this.regionalOptions[e||""]||this.regionalOptions[""]}function x(e,n){return e-n*Math.floor(e/n)}y("object-assign")(m.prototype=new g.baseCalendar,{name:"Persian",jdEpoch:1948320.5,daysPerMonth:[31,31,31,31,31,31,30,30,30,30,30,29],hasYearZero:!1,minMonth:1,firstMonth:1,minDay:1,regionalOptions:{"":{name:"Persian",epochs:["BP","AP"],monthNames:["Farvardin","Ordibehesht","Khordad","Tir","Mordad","Shahrivar","Mehr","Aban","Azar","Day","Bahman","Esfand"],monthNamesShort:["Far","Ord","Kho","Tir","Mor","Sha","Meh","Aba","Aza","Day","Bah","Esf"],dayNames:["Yekshambe","Doshambe","Seshambe","Ch\xe6harshambe","Panjshambe","Jom'e","Shambe"],dayNamesShort:["Yek","Do","Se","Ch\xe6","Panj","Jom","Sha"],dayNamesMin:["Ye","Do","Se","Ch","Pa","Jo","Sh"],digits:null,dateFormat:"yyyy/mm/dd",firstDay:6,isRTL:!1}},leapYear:function(e){var n=this._validate(e,this.minMonth,this.minDay,g.local.invalidYear);return 682*((n.year()-(n.year()>0?474:473))%2820+474+38)%2816<682},weekOfYear:function(e,n,t){var a=this.newDate(e,n,t);return a.add(-(a.dayOfWeek()+1)%7,"d"),Math.floor((a.dayOfYear()-1)/7)+1},daysInMonth:function(e,n){var t=this._validate(e,n,this.minDay,g.local.invalidMonth);return this.daysPerMonth[t.month()-1]+(12===t.month()&&this.leapYear(t.year())?1:0)},weekDay:function(e,n,t){return 5!==this.dayOfWeek(e,n,t)},toJD:function(e,n,t){var a=this._validate(e,n,t,g.local.invalidDate);e=a.year(),n=a.month(),t=a.day();var r=e-(e>=0?474:473),d=474+x(r,2820);return t+(n<=7?31*(n-1):30*(n-1)+6)+Math.floor((682*d-110)/2816)+365*(d-1)+1029983*Math.floor(r/2820)+this.jdEpoch-1},fromJD:function(e){var n=(e=Math.floor(e)+.5)-this.toJD(475,1,1),t=Math.floor(n/1029983),a=x(n,1029983),r=2820;if(1029982!==a){var d=Math.floor(a/366),s=x(a,366);r=Math.floor((2134*d+2816*s+2815)/1028522)+d+1}var i=r+2820*t+474,u=e-this.toJD(i=i<=0?i-1:i,1,1)+1,f=u<=186?Math.ceil(u/31):Math.ceil((u-6)/30),c=e-this.toJD(i,f,1)+1;return this.newDate(i,f,c)}}),g.calendars.persian=m,g.calendars.jalali=m},{"../main":347,"object-assign":247}],344:[function(y,ee,Q){var g=y("../main"),v=y("object-assign"),m=g.instance();function x(e){this.local=this.regionalOptions[e||""]||this.regionalOptions[""]}v(x.prototype=new g.baseCalendar,{name:"Taiwan",jdEpoch:2419402.5,yearsOffset:1911,daysPerMonth:[31,28,31,30,31,30,31,31,30,31,30,31],hasYearZero:!1,minMonth:1,firstMonth:1,minDay:1,regionalOptions:{"":{name:"Taiwan",epochs:["BROC","ROC"],monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],monthNamesShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayNamesShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],dayNamesMin:["Su","Mo","Tu","We","Th","Fr","Sa"],digits:null,dateFormat:"yyyy/mm/dd",firstDay:1,isRTL:!1}},leapYear:function(e){var n=this._validate(e,this.minMonth,this.minDay,g.local.invalidYear);return e=this._t2gYear(n.year()),m.leapYear(e)},weekOfYear:function(e,n,t){var a=this._validate(e,this.minMonth,this.minDay,g.local.invalidYear);return e=this._t2gYear(a.year()),m.weekOfYear(e,a.month(),a.day())},daysInMonth:function(e,n){var t=this._validate(e,n,this.minDay,g.local.invalidMonth);return this.daysPerMonth[t.month()-1]+(2===t.month()&&this.leapYear(t.year())?1:0)},weekDay:function(e,n,t){return(this.dayOfWeek(e,n,t)||7)<6},toJD:function(e,n,t){var a=this._validate(e,n,t,g.local.invalidDate);return e=this._t2gYear(a.year()),m.toJD(e,a.month(),a.day())},fromJD:function(e){var n=m.fromJD(e),t=this._g2tYear(n.year());return this.newDate(t,n.month(),n.day())},_t2gYear:function(e){return e+this.yearsOffset+(e>=-this.yearsOffset&&e<=-1?1:0)},_g2tYear:function(e){return e-this.yearsOffset-(e>=1&&e<=this.yearsOffset?1:0)}}),g.calendars.taiwan=x},{"../main":347,"object-assign":247}],345:[function(y,ee,Q){var g=y("../main"),v=y("object-assign"),m=g.instance();function x(e){this.local=this.regionalOptions[e||""]||this.regionalOptions[""]}v(x.prototype=new g.baseCalendar,{name:"Thai",jdEpoch:1523098.5,yearsOffset:543,daysPerMonth:[31,28,31,30,31,30,31,31,30,31,30,31],hasYearZero:!1,minMonth:1,firstMonth:1,minDay:1,regionalOptions:{"":{name:"Thai",epochs:["BBE","BE"],monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],monthNamesShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayNamesShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],dayNamesMin:["Su","Mo","Tu","We","Th","Fr","Sa"],digits:null,dateFormat:"dd/mm/yyyy",firstDay:0,isRTL:!1}},leapYear:function(e){var n=this._validate(e,this.minMonth,this.minDay,g.local.invalidYear);return e=this._t2gYear(n.year()),m.leapYear(e)},weekOfYear:function(e,n,t){var a=this._validate(e,this.minMonth,this.minDay,g.local.invalidYear);return e=this._t2gYear(a.year()),m.weekOfYear(e,a.month(),a.day())},daysInMonth:function(e,n){var t=this._validate(e,n,this.minDay,g.local.invalidMonth);return this.daysPerMonth[t.month()-1]+(2===t.month()&&this.leapYear(t.year())?1:0)},weekDay:function(e,n,t){return(this.dayOfWeek(e,n,t)||7)<6},toJD:function(e,n,t){var a=this._validate(e,n,t,g.local.invalidDate);return e=this._t2gYear(a.year()),m.toJD(e,a.month(),a.day())},fromJD:function(e){var n=m.fromJD(e),t=this._g2tYear(n.year());return this.newDate(t,n.month(),n.day())},_t2gYear:function(e){return e-this.yearsOffset-(e>=1&&e<=this.yearsOffset?1:0)},_g2tYear:function(e){return e+this.yearsOffset+(e>=-this.yearsOffset&&e<=-1?1:0)}}),g.calendars.thai=x},{"../main":347,"object-assign":247}],346:[function(y,ee,Q){var g=y("../main");function m(e){this.local=this.regionalOptions[e||""]||this.regionalOptions[""]}y("object-assign")(m.prototype=new g.baseCalendar,{name:"UmmAlQura",hasYearZero:!1,minMonth:1,firstMonth:1,minDay:1,regionalOptions:{"":{name:"Umm al-Qura",epochs:["BH","AH"],monthNames:["Al-Muharram","Safar","Rabi' al-awwal","Rabi' Al-Thani","Jumada Al-Awwal","Jumada Al-Thani","Rajab","Sha'aban","Ramadan","Shawwal","Dhu al-Qi'dah","Dhu al-Hijjah"],monthNamesShort:["Muh","Saf","Rab1","Rab2","Jum1","Jum2","Raj","Sha'","Ram","Shaw","DhuQ","DhuH"],dayNames:["Yawm al-Ahad","Yawm al-Ithnain","Yawm al-Thal\u0101th\u0101\u2019","Yawm al-Arba\u2018\u0101\u2019","Yawm al-Kham\u012bs","Yawm al-Jum\u2018a","Yawm al-Sabt"],dayNamesMin:["Ah","Ith","Th","Ar","Kh","Ju","Sa"],digits:null,dateFormat:"yyyy/mm/dd",firstDay:6,isRTL:!0}},leapYear:function(e){var n=this._validate(e,this.minMonth,this.minDay,g.local.invalidYear);return 355===this.daysInYear(n.year())},weekOfYear:function(e,n,t){var a=this.newDate(e,n,t);return a.add(-a.dayOfWeek(),"d"),Math.floor((a.dayOfYear()-1)/7)+1},daysInYear:function(e){for(var n=0,t=1;t<=12;t++)n+=this.daysInMonth(e,t);return n},daysInMonth:function(e,n){for(var t=this._validate(e,n,this.minDay,g.local.invalidMonth).toJD()-24e5+.5,a=0,r=0;r<x.length;r++){if(x[r]>t)return x[a]-x[a-1];a++}return 30},weekDay:function(e,n,t){return 5!==this.dayOfWeek(e,n,t)},toJD:function(e,n,t){var a=this._validate(e,n,t,g.local.invalidDate),r=12*(a.year()-1)+a.month()-15292;return a.day()+x[r-1]-1+24e5-.5},fromJD:function(e){for(var n=e-24e5+.5,t=0,a=0;a<x.length&&!(x[a]>n);a++)t++;var r=t+15292,d=Math.floor((r-1)/12);return this.newDate(d+1,r-12*d,n-x[t-1]+1)},isValid:function(e,n,t){var a=g.baseCalendar.prototype.isValid.apply(this,arguments);return a&&(a=(e=null!=e.year?e.year:e)>=1276&&e<=1500),a},_validate:function(e,n,t,a){var r=g.baseCalendar.prototype._validate.apply(this,arguments);if(r.year<1276||r.year>1500)throw a.replace(/\{0\}/,this.local.name);return r}}),g.calendars.ummalqura=m;var x=[20,50,79,109,138,168,197,227,256,286,315,345,374,404,433,463,492,522,551,581,611,641,670,700,729,759,788,818,847,877,906,936,965,995,1024,1054,1083,1113,1142,1172,1201,1231,1260,1290,1320,1350,1379,1409,1438,1468,1497,1527,1556,1586,1615,1645,1674,1704,1733,1763,1792,1822,1851,1881,1910,1940,1969,1999,2028,2058,2087,2117,2146,2176,2205,2235,2264,2294,2323,2353,2383,2413,2442,2472,2501,2531,2560,2590,2619,2649,2678,2708,2737,2767,2796,2826,2855,2885,2914,2944,2973,3003,3032,3062,3091,3121,3150,3180,3209,3239,3268,3298,3327,3357,3386,3416,3446,3476,3505,3535,3564,3594,3623,3653,3682,3712,3741,3771,3800,3830,3859,3889,3918,3948,3977,4007,4036,4066,4095,4125,4155,4185,4214,4244,4273,4303,4332,4362,4391,4421,4450,4480,4509,4539,4568,4598,4627,4657,4686,4716,4745,4775,4804,4834,4863,4893,4922,4952,4981,5011,5040,5070,5099,5129,5158,5188,5218,5248,5277,5307,5336,5366,5395,5425,5454,5484,5513,5543,5572,5602,5631,5661,5690,5720,5749,5779,5808,5838,5867,5897,5926,5956,5985,6015,6044,6074,6103,6133,6162,6192,6221,6251,6281,6311,6340,6370,6399,6429,6458,6488,6517,6547,6576,6606,6635,6665,6694,6724,6753,6783,6812,6842,6871,6901,6930,6960,6989,7019,7048,7078,7107,7137,7166,7196,7225,7255,7284,7314,7344,7374,7403,7433,7462,7492,7521,7551,7580,7610,7639,7669,7698,7728,7757,7787,7816,7846,7875,7905,7934,7964,7993,8023,8053,8083,8112,8142,8171,8201,8230,8260,8289,8319,8348,8378,8407,8437,8466,8496,8525,8555,8584,8614,8643,8673,8702,8732,8761,8791,8821,8850,8880,8909,8938,8968,8997,9027,9056,9086,9115,9145,9175,9205,9234,9264,9293,9322,9352,9381,9410,9440,9470,9499,9529,9559,9589,9618,9648,9677,9706,9736,9765,9794,9824,9853,9883,9913,9943,9972,10002,10032,10061,10090,10120,10149,10178,10208,10237,10267,10297,10326,10356,10386,10415,10445,10474,10504,10533,10562,10592,10621,10651,10680,10710,10740,10770,10799,10829,10858,10888,10917,10947,10976,11005,11035,11064,11094,11124,11153,11183,11213,11242,11272,11301,11331,11360,11389,11419,11448,11478,11507,11537,11567,11596,11626,11655,11685,11715,11744,11774,11803,11832,11862,11891,11921,11950,11980,12010,12039,12069,12099,12128,12158,12187,12216,12246,12275,12304,12334,12364,12393,12423,12453,12483,12512,12542,12571,12600,12630,12659,12688,12718,12747,12777,12807,12837,12866,12896,12926,12955,12984,13014,13043,13072,13102,13131,13161,13191,13220,13250,13280,13310,13339,13368,13398,13427,13456,13486,13515,13545,13574,13604,13634,13664,13693,13723,13752,13782,13811,13840,13870,13899,13929,13958,13988,14018,14047,14077,14107,14136,14166,14195,14224,14254,14283,14313,14342,14372,14401,14431,14461,14490,14520,14550,14579,14609,14638,14667,14697,14726,14756,14785,14815,14844,14874,14904,14933,14963,14993,15021,15051,15081,15110,15140,15169,15199,15228,15258,15287,15317,15347,15377,15406,15436,15465,15494,15524,15553,15582,15612,15641,15671,15701,15731,15760,15790,15820,15849,15878,15908,15937,15966,15996,16025,16055,16085,16114,16144,16174,16204,16233,16262,16292,16321,16350,16380,16409,16439,16468,16498,16528,16558,16587,16617,16646,16676,16705,16734,16764,16793,16823,16852,16882,16912,16941,16971,17001,17030,17060,17089,17118,17148,17177,17207,17236,17266,17295,17325,17355,17384,17414,17444,17473,17502,17532,17561,17591,17620,17650,17679,17709,17738,17768,17798,17827,17857,17886,17916,17945,17975,18004,18034,18063,18093,18122,18152,18181,18211,18241,18270,18300,18330,18359,18388,18418,18447,18476,18506,18535,18565,18595,18625,18654,18684,18714,18743,18772,18802,18831,18860,18890,18919,18949,18979,19008,19038,19068,19098,19127,19156,19186,19215,19244,19274,19303,19333,19362,19392,19422,19452,19481,19511,19540,19570,19599,19628,19658,19687,19717,19746,19776,19806,19836,19865,19895,19924,19954,19983,20012,20042,20071,20101,20130,20160,20190,20219,20249,20279,20308,20338,20367,20396,20426,20455,20485,20514,20544,20573,20603,20633,20662,20692,20721,20751,20780,20810,20839,20869,20898,20928,20957,20987,21016,21046,21076,21105,21135,21164,21194,21223,21253,21282,21312,21341,21371,21400,21430,21459,21489,21519,21548,21578,21607,21637,21666,21696,21725,21754,21784,21813,21843,21873,21902,21932,21962,21991,22021,22050,22080,22109,22138,22168,22197,22227,22256,22286,22316,22346,22375,22405,22434,22464,22493,22522,22552,22581,22611,22640,22670,22700,22730,22759,22789,22818,22848,22877,22906,22936,22965,22994,23024,23054,23083,23113,23143,23173,23202,23232,23261,23290,23320,23349,23379,23408,23438,23467,23497,23527,23556,23586,23616,23645,23674,23704,23733,23763,23792,23822,23851,23881,23910,23940,23970,23999,24029,24058,24088,24117,24147,24176,24206,24235,24265,24294,24324,24353,24383,24413,24442,24472,24501,24531,24560,24590,24619,24648,24678,24707,24737,24767,24796,24826,24856,24885,24915,24944,24974,25003,25032,25062,25091,25121,25150,25180,25210,25240,25269,25299,25328,25358,25387,25416,25446,25475,25505,25534,25564,25594,25624,25653,25683,25712,25742,25771,25800,25830,25859,25888,25918,25948,25977,26007,26037,26067,26096,26126,26155,26184,26214,26243,26272,26302,26332,26361,26391,26421,26451,26480,26510,26539,26568,26598,26627,26656,26686,26715,26745,26775,26805,26834,26864,26893,26923,26952,26982,27011,27041,27070,27099,27129,27159,27188,27218,27248,27277,27307,27336,27366,27395,27425,27454,27484,27513,27542,27572,27602,27631,27661,27691,27720,27750,27779,27809,27838,27868,27897,27926,27956,27985,28015,28045,28074,28104,28134,28163,28193,28222,28252,28281,28310,28340,28369,28399,28428,28458,28488,28517,28547,28577,28607,28636,28665,28695,28724,28754,28783,28813,28843,28872,28901,28931,28960,28990,29019,29049,29078,29108,29137,29167,29196,29226,29255,29285,29315,29345,29375,29404,29434,29463,29492,29522,29551,29580,29610,29640,29669,29699,29729,29759,29788,29818,29847,29876,29906,29935,29964,29994,30023,30053,30082,30112,30141,30171,30200,30230,30259,30289,30318,30348,30378,30408,30437,30467,30496,30526,30555,30585,30614,30644,30673,30703,30732,30762,30791,30821,30850,30880,30909,30939,30968,30998,31027,31057,31086,31116,31145,31175,31204,31234,31263,31293,31322,31352,31381,31411,31441,31471,31500,31530,31559,31589,31618,31648,31676,31706,31736,31766,31795,31825,31854,31884,31913,31943,31972,32002,32031,32061,32090,32120,32150,32180,32209,32239,32268,32298,32327,32357,32386,32416,32445,32475,32504,32534,32563,32593,32622,32652,32681,32711,32740,32770,32799,32829,32858,32888,32917,32947,32976,33006,33035,33065,33094,33124,33153,33183,33213,33243,33272,33302,33331,33361,33390,33420,33450,33479,33509,33539,33568,33598,33627,33657,33686,33716,33745,33775,33804,33834,33863,33893,33922,33952,33981,34011,34040,34069,34099,34128,34158,34187,34217,34247,34277,34306,34336,34365,34395,34424,34454,34483,34512,34542,34571,34601,34631,34660,34690,34719,34749,34778,34808,34837,34867,34896,34926,34955,34985,35015,35044,35074,35103,35133,35162,35192,35222,35251,35280,35310,35340,35370,35399,35429,35458,35488,35517,35547,35576,35605,35635,35665,35694,35723,35753,35782,35811,35841,35871,35901,35930,35960,35989,36019,36048,36078,36107,36136,36166,36195,36225,36254,36284,36314,36343,36373,36403,36433,36462,36492,36521,36551,36580,36610,36639,36669,36698,36728,36757,36786,36816,36845,36875,36904,36934,36963,36993,37022,37052,37081,37111,37141,37170,37200,37229,37259,37288,37318,37347,37377,37406,37436,37465,37495,37524,37554,37584,37613,37643,37672,37701,37731,37760,37790,37819,37849,37878,37908,37938,37967,37997,38027,38056,38085,38115,38144,38174,38203,38233,38262,38292,38322,38351,38381,38410,38440,38469,38499,38528,38558,38587,38617,38646,38676,38705,38735,38764,38794,38823,38853,38882,38912,38941,38971,39001,39030,39059,39089,39118,39148,39178,39208,39237,39267,39297,39326,39355,39385,39414,39444,39473,39503,39532,39562,39592,39621,39650,39680,39709,39739,39768,39798,39827,39857,39886,39916,39946,39975,40005,40035,40064,40094,40123,40153,40182,40212,40241,40271,40300,40330,40359,40389,40418,40448,40477,40507,40536,40566,40595,40625,40655,40685,40714,40744,40773,40803,40832,40862,40892,40921,40951,40980,41009,41039,41068,41098,41127,41157,41186,41216,41245,41275,41304,41334,41364,41393,41422,41452,41481,41511,41540,41570,41599,41629,41658,41688,41718,41748,41777,41807,41836,41865,41894,41924,41953,41983,42012,42042,42072,42102,42131,42161,42190,42220,42249,42279,42308,42337,42367,42397,42426,42456,42485,42515,42545,42574,42604,42633,42662,42692,42721,42751,42780,42810,42839,42869,42899,42929,42958,42988,43017,43046,43076,43105,43135,43164,43194,43223,43253,43283,43312,43342,43371,43401,43430,43460,43489,43519,43548,43578,43607,43637,43666,43696,43726,43755,43785,43814,43844,43873,43903,43932,43962,43991,44021,44050,44080,44109,44139,44169,44198,44228,44258,44287,44317,44346,44375,44405,44434,44464,44493,44523,44553,44582,44612,44641,44671,44700,44730,44759,44788,44818,44847,44877,44906,44936,44966,44996,45025,45055,45084,45114,45143,45172,45202,45231,45261,45290,45320,45350,45380,45409,45439,45468,45498,45527,45556,45586,45615,45644,45674,45704,45733,45763,45793,45823,45852,45882,45911,45940,45970,45999,46028,46058,46088,46117,46147,46177,46206,46236,46265,46295,46324,46354,46383,46413,46442,46472,46501,46531,46560,46590,46620,46649,46679,46708,46738,46767,46797,46826,46856,46885,46915,46944,46974,47003,47033,47063,47092,47122,47151,47181,47210,47240,47269,47298,47328,47357,47387,47417,47446,47476,47506,47535,47565,47594,47624,47653,47682,47712,47741,47771,47800,47830,47860,47890,47919,47949,47978,48008,48037,48066,48096,48125,48155,48184,48214,48244,48273,48303,48333,48362,48392,48421,48450,48480,48509,48538,48568,48598,48627,48657,48687,48717,48746,48776,48805,48834,48864,48893,48922,48952,48982,49011,49041,49071,49100,49130,49160,49189,49218,49248,49277,49306,49336,49365,49395,49425,49455,49484,49514,49543,49573,49602,49632,49661,49690,49720,49749,49779,49809,49838,49868,49898,49927,49957,49986,50016,50045,50075,50104,50133,50163,50192,50222,50252,50281,50311,50340,50370,50400,50429,50459,50488,50518,50547,50576,50606,50635,50665,50694,50724,50754,50784,50813,50843,50872,50902,50931,50960,50990,51019,51049,51078,51108,51138,51167,51197,51227,51256,51286,51315,51345,51374,51403,51433,51462,51492,51522,51552,51582,51611,51641,51670,51699,51729,51758,51787,51816,51846,51876,51906,51936,51965,51995,52025,52054,52083,52113,52142,52171,52200,52230,52260,52290,52319,52349,52379,52408,52438,52467,52497,52526,52555,52585,52614,52644,52673,52703,52733,52762,52792,52822,52851,52881,52910,52939,52969,52998,53028,53057,53087,53116,53146,53176,53205,53235,53264,53294,53324,53353,53383,53412,53441,53471,53500,53530,53559,53589,53619,53648,53678,53708,53737,53767,53796,53825,53855,53884,53913,53943,53973,54003,54032,54062,54092,54121,54151,54180,54209,54239,54268,54297,54327,54357,54387,54416,54446,54476,54505,54535,54564,54593,54623,54652,54681,54711,54741,54770,54800,54830,54859,54889,54919,54948,54977,55007,55036,55066,55095,55125,55154,55184,55213,55243,55273,55302,55332,55361,55391,55420,55450,55479,55508,55538,55567,55597,55627,55657,55686,55716,55745,55775,55804,55834,55863,55892,55922,55951,55981,56011,56040,56070,56100,56129,56159,56188,56218,56247,56276,56306,56335,56365,56394,56424,56454,56483,56513,56543,56572,56601,56631,56660,56690,56719,56749,56778,56808,56837,56867,56897,56926,56956,56985,57015,57044,57074,57103,57133,57162,57192,57221,57251,57280,57310,57340,57369,57399,57429,57458,57487,57517,57546,57576,57605,57634,57664,57694,57723,57753,57783,57813,57842,57871,57901,57930,57959,57989,58018,58048,58077,58107,58137,58167,58196,58226,58255,58285,58314,58343,58373,58402,58432,58461,58491,58521,58551,58580,58610,58639,58669,58698,58727,58757,58786,58816,58845,58875,58905,58934,58964,58994,59023,59053,59082,59111,59141,59170,59200,59229,59259,59288,59318,59348,59377,59407,59436,59466,59495,59525,59554,59584,59613,59643,59672,59702,59731,59761,59791,59820,59850,59879,59909,59939,59968,59997,60027,60056,60086,60115,60145,60174,60204,60234,60264,60293,60323,60352,60381,60411,60440,60469,60499,60528,60558,60588,60618,60648,60677,60707,60736,60765,60795,60824,60853,60883,60912,60942,60972,61002,61031,61061,61090,61120,61149,61179,61208,61237,61267,61296,61326,61356,61385,61415,61445,61474,61504,61533,61563,61592,61621,61651,61680,61710,61739,61769,61799,61828,61858,61888,61917,61947,61976,62006,62035,62064,62094,62123,62153,62182,62212,62242,62271,62301,62331,62360,62390,62419,62448,62478,62507,62537,62566,62596,62625,62655,62685,62715,62744,62774,62803,62832,62862,62891,62921,62950,62980,63009,63039,63069,63099,63128,63157,63187,63216,63246,63275,63305,63334,63363,63393,63423,63453,63482,63512,63541,63571,63600,63630,63659,63689,63718,63747,63777,63807,63836,63866,63895,63925,63955,63984,64014,64043,64073,64102,64131,64161,64190,64220,64249,64279,64309,64339,64368,64398,64427,64457,64486,64515,64545,64574,64603,64633,64663,64692,64722,64752,64782,64811,64841,64870,64899,64929,64958,64987,65017,65047,65076,65106,65136,65166,65195,65225,65254,65283,65313,65342,65371,65401,65431,65460,65490,65520,65549,65579,65608,65638,65667,65697,65726,65755,65785,65815,65844,65874,65903,65933,65963,65992,66022,66051,66081,66110,66140,66169,66199,66228,66258,66287,66317,66346,66376,66405,66435,66465,66494,66524,66553,66583,66612,66641,66671,66700,66730,66760,66789,66819,66849,66878,66908,66937,66967,66996,67025,67055,67084,67114,67143,67173,67203,67233,67262,67292,67321,67351,67380,67409,67439,67468,67497,67527,67557,67587,67617,67646,67676,67705,67735,67764,67793,67823,67852,67882,67911,67941,67971,68e3,68030,68060,68089,68119,68148,68177,68207,68236,68266,68295,68325,68354,68384,68414,68443,68473,68502,68532,68561,68591,68620,68650,68679,68708,68738,68768,68797,68827,68857,68886,68916,68946,68975,69004,69034,69063,69092,69122,69152,69181,69211,69240,69270,69300,69330,69359,69388,69418,69447,69476,69506,69535,69565,69595,69624,69654,69684,69713,69743,69772,69802,69831,69861,69890,69919,69949,69978,70008,70038,70067,70097,70126,70156,70186,70215,70245,70274,70303,70333,70362,70392,70421,70451,70481,70510,70540,70570,70599,70629,70658,70687,70717,70746,70776,70805,70835,70864,70894,70924,70954,70983,71013,71042,71071,71101,71130,71159,71189,71218,71248,71278,71308,71337,71367,71397,71426,71455,71485,71514,71543,71573,71602,71632,71662,71691,71721,71751,71781,71810,71839,71869,71898,71927,71957,71986,72016,72046,72075,72105,72135,72164,72194,72223,72253,72282,72311,72341,72370,72400,72429,72459,72489,72518,72548,72577,72607,72637,72666,72695,72725,72754,72784,72813,72843,72872,72902,72931,72961,72991,73020,73050,73080,73109,73139,73168,73197,73227,73256,73286,73315,73345,73375,73404,73434,73464,73493,73523,73552,73581,73611,73640,73669,73699,73729,73758,73788,73818,73848,73877,73907,73936,73965,73995,74024,74053,74083,74113,74142,74172,74202,74231,74261,74291,74320,74349,74379,74408,74437,74467,74497,74526,74556,74586,74615,74645,74675,74704,74733,74763,74792,74822,74851,74881,74910,74940,74969,74999,75029,75058,75088,75117,75147,75176,75206,75235,75264,75294,75323,75353,75383,75412,75442,75472,75501,75531,75560,75590,75619,75648,75678,75707,75737,75766,75796,75826,75856,75885,75915,75944,75974,76003,76032,76062,76091,76121,76150,76180,76210,76239,76269,76299,76328,76358,76387,76416,76446,76475,76505,76534,76564,76593,76623,76653,76682,76712,76741,76771,76801,76830,76859,76889,76918,76948,76977,77007,77036,77066,77096,77125,77155,77185,77214,77243,77273,77302,77332,77361,77390,77420,77450,77479,77509,77539,77569,77598,77627,77657,77686,77715,77745,77774,77804,77833,77863,77893,77923,77952,77982,78011,78041,78070,78099,78129,78158,78188,78217,78247,78277,78307,78336,78366,78395,78425,78454,78483,78513,78542,78572,78601,78631,78661,78690,78720,78750,78779,78808,78838,78867,78897,78926,78956,78985,79015,79044,79074,79104,79133,79163,79192,79222,79251,79281,79310,79340,79369,79399,79428,79458,79487,79517,79546,79576,79606,79635,79665,79695,79724,79753,79783,79812,79841,79871,79900,79930,79960,79990]},{"../main":347,"object-assign":247}],347:[function(y,ee,Q){var g=y("object-assign");function v(){this.regionalOptions=[],this.regionalOptions[""]={invalidCalendar:"Calendar {0} not found",invalidDate:"Invalid {0} date",invalidMonth:"Invalid {0} month",invalidYear:"Invalid {0} year",differentCalendars:"Cannot mix {0} and {1} dates"},this.local=this.regionalOptions[""],this.calendars={},this._localCals={}}function m(a,r,d,s){if(this._calendar=a,this._year=r,this._month=d,this._day=s,0===this._calendar._validateLevel&&!this._calendar.isValid(this._year,this._month,this._day))throw(t.local.invalidDate||t.regionalOptions[""].invalidDate).replace(/\{0\}/,this._calendar.local.name)}function x(a,r){return"000000".substring(0,r-(a=""+a).length)+a}function e(){this.shortYearCutoff="+10"}function n(a){this.local=this.regionalOptions[a]||this.regionalOptions[""]}g(v.prototype,{instance:function(a,r){a=(a||"gregorian").toLowerCase();var d=this._localCals[a+"-"+(r=r||"")];if(!d&&this.calendars[a]&&(d=new this.calendars[a](r),this._localCals[a+"-"+r]=d),!d)throw(this.local.invalidCalendar||this.regionalOptions[""].invalidCalendar).replace(/\{0\}/,a);return d},newDate:function(a,r,d,s,i){return(s=(null!=a&&a.year?a.calendar():"string"==typeof s?this.instance(s,i):s)||this.instance()).newDate(a,r,d)},substituteDigits:function(a){return function(r){return(r+"").replace(/[0-9]/g,function(d){return a[d]})}},substituteChineseDigits:function(a,r){return function(d){for(var s="",i=0;d>0;){var u=d%10;s=(0===u?"":a[u]+r[i])+s,i++,d=Math.floor(d/10)}return 0===s.indexOf(a[1]+r[1])&&(s=s.substr(1)),s||a[0]}}}),g(m.prototype,{newDate:function(a,r,d){return this._calendar.newDate(a??this,r,d)},year:function(a){return 0===arguments.length?this._year:this.set(a,"y")},month:function(a){return 0===arguments.length?this._month:this.set(a,"m")},day:function(a){return 0===arguments.length?this._day:this.set(a,"d")},date:function(a,r,d){if(!this._calendar.isValid(a,r,d))throw(t.local.invalidDate||t.regionalOptions[""].invalidDate).replace(/\{0\}/,this._calendar.local.name);return this._year=a,this._month=r,this._day=d,this},leapYear:function(){return this._calendar.leapYear(this)},epoch:function(){return this._calendar.epoch(this)},formatYear:function(){return this._calendar.formatYear(this)},monthOfYear:function(){return this._calendar.monthOfYear(this)},weekOfYear:function(){return this._calendar.weekOfYear(this)},daysInYear:function(){return this._calendar.daysInYear(this)},dayOfYear:function(){return this._calendar.dayOfYear(this)},daysInMonth:function(){return this._calendar.daysInMonth(this)},dayOfWeek:function(){return this._calendar.dayOfWeek(this)},weekDay:function(){return this._calendar.weekDay(this)},extraInfo:function(){return this._calendar.extraInfo(this)},add:function(a,r){return this._calendar.add(this,a,r)},set:function(a,r){return this._calendar.set(this,a,r)},compareTo:function(a){if(this._calendar.name!==a._calendar.name)throw(t.local.differentCalendars||t.regionalOptions[""].differentCalendars).replace(/\{0\}/,this._calendar.local.name).replace(/\{1\}/,a._calendar.local.name);var r=this._year!==a._year?this._year-a._year:this._month!==a._month?this.monthOfYear()-a.monthOfYear():this._day-a._day;return 0===r?0:r<0?-1:1},calendar:function(){return this._calendar},toJD:function(){return this._calendar.toJD(this)},fromJD:function(a){return this._calendar.fromJD(a)},toJSDate:function(){return this._calendar.toJSDate(this)},fromJSDate:function(a){return this._calendar.fromJSDate(a)},toString:function(){return(this.year()<0?"-":"")+x(Math.abs(this.year()),4)+"-"+x(this.month(),2)+"-"+x(this.day(),2)}}),g(e.prototype,{_validateLevel:0,newDate:function(a,r,d){return null==a?this.today():(a.year&&(this._validate(a,r,d,t.local.invalidDate||t.regionalOptions[""].invalidDate),d=a.day(),r=a.month(),a=a.year()),new m(this,a,r,d))},today:function(){return this.fromJSDate(new Date)},epoch:function(a){return this._validate(a,this.minMonth,this.minDay,t.local.invalidYear||t.regionalOptions[""].invalidYear).year()<0?this.local.epochs[0]:this.local.epochs[1]},formatYear:function(a){var r=this._validate(a,this.minMonth,this.minDay,t.local.invalidYear||t.regionalOptions[""].invalidYear);return(r.year()<0?"-":"")+x(Math.abs(r.year()),4)},monthsInYear:function(a){return this._validate(a,this.minMonth,this.minDay,t.local.invalidYear||t.regionalOptions[""].invalidYear),12},monthOfYear:function(a,r){var d=this._validate(a,r,this.minDay,t.local.invalidMonth||t.regionalOptions[""].invalidMonth);return(d.month()+this.monthsInYear(d)-this.firstMonth)%this.monthsInYear(d)+this.minMonth},fromMonthOfYear:function(a,r){var d=(r+this.firstMonth-2*this.minMonth)%this.monthsInYear(a)+this.minMonth;return this._validate(a,d,this.minDay,t.local.invalidMonth||t.regionalOptions[""].invalidMonth),d},daysInYear:function(a){var r=this._validate(a,this.minMonth,this.minDay,t.local.invalidYear||t.regionalOptions[""].invalidYear);return this.leapYear(r)?366:365},dayOfYear:function(a,r,d){var s=this._validate(a,r,d,t.local.invalidDate||t.regionalOptions[""].invalidDate);return s.toJD()-this.newDate(s.year(),this.fromMonthOfYear(s.year(),this.minMonth),this.minDay).toJD()+1},daysInWeek:function(){return 7},dayOfWeek:function(a,r,d){var s=this._validate(a,r,d,t.local.invalidDate||t.regionalOptions[""].invalidDate);return(Math.floor(this.toJD(s))+2)%this.daysInWeek()},extraInfo:function(a,r,d){return this._validate(a,r,d,t.local.invalidDate||t.regionalOptions[""].invalidDate),{}},add:function(a,r,d){return this._validate(a,this.minMonth,this.minDay,t.local.invalidDate||t.regionalOptions[""].invalidDate),this._correctAdd(a,this._add(a,r,d),r,d)},_add:function(a,r,d){if(this._validateLevel++,"d"===d||"w"===d){var s=a.toJD()+r*("w"===d?this.daysInWeek():1),i=a.calendar().fromJD(s);return this._validateLevel--,[i.year(),i.month(),i.day()]}try{var u=a.year()+("y"===d?r:0),f=a.monthOfYear()+("m"===d?r:0);i=a.day(),"y"===d?(a.month()!==this.fromMonthOfYear(u,f)&&(f=this.newDate(u,a.month(),this.minDay).monthOfYear()),f=Math.min(f,this.monthsInYear(u)),i=Math.min(i,this.daysInMonth(u,this.fromMonthOfYear(u,f)))):"m"===d&&(function(h){for(;f<h.minMonth;)u--,f+=h.monthsInYear(u);for(var p=h.monthsInYear(u);f>p-1+h.minMonth;)u++,f-=p,p=h.monthsInYear(u)}(this),i=Math.min(i,this.daysInMonth(u,this.fromMonthOfYear(u,f))));var c=[u,this.fromMonthOfYear(u,f),i];return this._validateLevel--,c}catch(h){throw this._validateLevel--,h}},_correctAdd:function(a,r,d,s){if(!(this.hasYearZero||"y"!==s&&"m"!==s||0!==r[0]&&a.year()>0==r[0]>0)){var i={y:[1,1,"y"],m:[1,this.monthsInYear(-1),"m"],w:[this.daysInWeek(),this.daysInYear(-1),"d"],d:[1,this.daysInYear(-1),"d"]}[s];r=this._add(a,d*i[0]+(d<0?-1:1)*i[1],i[2])}return a.date(r[0],r[1],r[2])},set:function(a,r,d){this._validate(a,this.minMonth,this.minDay,t.local.invalidDate||t.regionalOptions[""].invalidDate);var s="y"===d?r:a.year(),i="m"===d?r:a.month(),u="d"===d?r:a.day();return"y"!==d&&"m"!==d||(u=Math.min(u,this.daysInMonth(s,i))),a.date(s,i,u)},isValid:function(a,r,d){this._validateLevel++;var s=this.hasYearZero||0!==a;if(s){var i=this.newDate(a,r,this.minDay);s=r>=this.minMonth&&r-this.minMonth<this.monthsInYear(i)&&d>=this.minDay&&d-this.minDay<this.daysInMonth(i)}return this._validateLevel--,s},toJSDate:function(a,r,d){var s=this._validate(a,r,d,t.local.invalidDate||t.regionalOptions[""].invalidDate);return t.instance().fromJD(this.toJD(s)).toJSDate()},fromJSDate:function(a){return this.fromJD(t.instance().fromJSDate(a).toJD())},_validate:function(a,r,d,s){if(a.year){if(0===this._validateLevel&&this.name!==a.calendar().name)throw(t.local.differentCalendars||t.regionalOptions[""].differentCalendars).replace(/\{0\}/,this.local.name).replace(/\{1\}/,a.calendar().local.name);return a}try{if(this._validateLevel++,1===this._validateLevel&&!this.isValid(a,r,d))throw s.replace(/\{0\}/,this.local.name);var i=this.newDate(a,r,d);return this._validateLevel--,i}catch(u){throw this._validateLevel--,u}}}),g(n.prototype=new e,{name:"Gregorian",jdEpoch:1721425.5,daysPerMonth:[31,28,31,30,31,30,31,31,30,31,30,31],hasYearZero:!1,minMonth:1,firstMonth:1,minDay:1,regionalOptions:{"":{name:"Gregorian",epochs:["BCE","CE"],monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],monthNamesShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayNamesShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],dayNamesMin:["Su","Mo","Tu","We","Th","Fr","Sa"],digits:null,dateFormat:"mm/dd/yyyy",firstDay:0,isRTL:!1}},leapYear:function(a){var r=this._validate(a,this.minMonth,this.minDay,t.local.invalidYear||t.regionalOptions[""].invalidYear);return(a=r.year()+(r.year()<0?1:0))%4==0&&(a%100!=0||a%400==0)},weekOfYear:function(a,r,d){var s=this.newDate(a,r,d);return s.add(4-(s.dayOfWeek()||7),"d"),Math.floor((s.dayOfYear()-1)/7)+1},daysInMonth:function(a,r){var d=this._validate(a,r,this.minDay,t.local.invalidMonth||t.regionalOptions[""].invalidMonth);return this.daysPerMonth[d.month()-1]+(2===d.month()&&this.leapYear(d.year())?1:0)},weekDay:function(a,r,d){return(this.dayOfWeek(a,r,d)||7)<6},toJD:function(a,r,d){var s=this._validate(a,r,d,t.local.invalidDate||t.regionalOptions[""].invalidDate);a=s.year(),r=s.month(),d=s.day(),a<0&&a++,r<3&&(r+=12,a--);var i=Math.floor(a/100),u=2-i+Math.floor(i/4);return Math.floor(365.25*(a+4716))+Math.floor(30.6001*(r+1))+d+u-1524.5},fromJD:function(a){var r=Math.floor(a+.5),d=Math.floor((r-1867216.25)/36524.25),s=1524+(d=r+1+d-Math.floor(d/4)),i=Math.floor((s-122.1)/365.25),u=Math.floor(365.25*i),f=Math.floor((s-u)/30.6001),c=s-u-Math.floor(30.6001*f),h=f-(f>13.5?13:1),p=i-(h>2.5?4716:4715);return p<=0&&p--,this.newDate(p,h,c)},toJSDate:function(a,r,d){var s=this._validate(a,r,d,t.local.invalidDate||t.regionalOptions[""].invalidDate),i=new Date(s.year(),s.month()-1,s.day());return i.setHours(0),i.setMinutes(0),i.setSeconds(0),i.setMilliseconds(0),i.setHours(i.getHours()>12?i.getHours()+2:0),i},fromJSDate:function(a){return this.newDate(a.getFullYear(),a.getMonth()+1,a.getDate())}});var t=ee.exports=new v;t.cdate=m,t.baseCalendar=e,t.calendars.gregorian=n},{"object-assign":247}],348:[function(y,ee,Q){var g=y("object-assign"),v=y("./main");g(v.regionalOptions[""],{invalidArguments:"Invalid arguments",invalidFormat:"Cannot format a date from another calendar",missingNumberAt:"Missing number at position {0}",unknownNameAt:"Unknown name at position {0}",unexpectedLiteralAt:"Unexpected literal at position {0}",unexpectedText:"Additional text found at end"}),v.local=v.regionalOptions[""],g(v.cdate.prototype,{formatDate:function(m,x){return"string"!=typeof m&&(x=m,m=""),this._calendar.formatDate(m||"",this,x)}}),g(v.baseCalendar.prototype,{UNIX_EPOCH:v.instance().newDate(1970,1,1).toJD(),SECS_PER_DAY:86400,TICKS_EPOCH:v.instance().jdEpoch,TICKS_PER_DAY:864e9,ATOM:"yyyy-mm-dd",COOKIE:"D, dd M yyyy",FULL:"DD, MM d, yyyy",ISO_8601:"yyyy-mm-dd",JULIAN:"J",RFC_822:"D, d M yy",RFC_850:"DD, dd-M-yy",RFC_1036:"D, d M yy",RFC_1123:"D, d M yyyy",RFC_2822:"D, d M yyyy",RSS:"D, d M yy",TICKS:"!",TIMESTAMP:"@",W3C:"yyyy-mm-dd",formatDate:function(m,x,e){if("string"!=typeof m&&(e=x,x=m,m=""),!x)return"";if(x.calendar()!==this)throw v.local.invalidFormat||v.regionalOptions[""].invalidFormat;m=m||this.local.dateFormat;for(var t,a,r,d=(e=e||{}).dayNamesShort||this.local.dayNamesShort,s=e.dayNames||this.local.dayNames,i=e.monthNumbers||this.local.monthNumbers,u=e.monthNamesShort||this.local.monthNamesShort,f=e.monthNames||this.local.monthNames,c=function(L,M){for(var I=1;k+I<m.length&&m.charAt(k+I)===L;)I++;return k+=I-1,Math.floor(I/(M||1))>1},h=function(L,M,I,P){var S=""+M;if(c(L,P))for(;S.length<I;)S="0"+S;return S},p=this,b=function(L,M){return M?"function"==typeof f?f.call(p,L):f[L.month()-p.minMonth]:"function"==typeof u?u.call(p,L):u[L.month()-p.minMonth]},l=this.local.digits,T=function(L){return e.localNumbers&&l?l(L):L},_="",w=!1,k=0;k<m.length;k++)if(w)"'"!==m.charAt(k)||c("'")?_+=m.charAt(k):w=!1;else switch(m.charAt(k)){case"d":_+=T(h("d",x.day(),2));break;case"D":_+=("D",t=x.dayOfWeek(),a=d,r=s,c("D")?r[t]:a[t]);break;case"o":_+=h("o",x.dayOfYear(),3);break;case"w":_+=h("w",x.weekOfYear(),2);break;case"m":_+=(L=x,"function"==typeof i?i.call(p,L,c("m")):T(h("m",L.month(),2)));break;case"M":_+=b(x,c("M"));break;case"y":_+=c("y",2)?x.year():(x.year()%100<10?"0":"")+x.year()%100;break;case"Y":c("Y",2),_+=x.formatYear();break;case"J":_+=x.toJD();break;case"@":_+=(x.toJD()-this.UNIX_EPOCH)*this.SECS_PER_DAY;break;case"!":_+=(x.toJD()-this.TICKS_EPOCH)*this.TICKS_PER_DAY;break;case"'":c("'")?_+="'":w=!0;break;default:_+=m.charAt(k)}var L;return _},parseDate:function(m,x,e){if(null==x)throw v.local.invalidArguments||v.regionalOptions[""].invalidArguments;if(""===(x="object"==typeof x?x.toString():x+""))return null;m=m||this.local.dateFormat;var n=(e=e||{}).shortYearCutoff||this.shortYearCutoff;n="string"!=typeof n?n:this.today().year()%100+parseInt(n,10);for(var t=e.dayNamesShort||this.local.dayNamesShort,a=e.dayNames||this.local.dayNames,r=e.parseMonth||this.local.parseMonth,d=e.monthNumbers||this.local.monthNumbers,s=e.monthNamesShort||this.local.monthNamesShort,i=e.monthNames||this.local.monthNames,u=-1,f=-1,c=-1,h=-1,p=-1,o=!1,b=!1,l=function(z,R){for(var q=1;P+q<m.length&&m.charAt(P+q)===z;)q++;return P+=q-1,Math.floor(q/(R||1))>1},T=function(z,R){var q=l(z,R),V=[2,3,q?4:2,q?4:2,10,11,20]["oyYJ@!".indexOf(z)+1],W=new RegExp("^-?\\d{1,"+V+"}"),K=x.substring(I).match(W);if(!K)throw(v.local.missingNumberAt||v.regionalOptions[""].missingNumberAt).replace(/\{0\}/,I);return I+=K[0].length,parseInt(K[0],10)},_=this,w=function(){if("function"==typeof d){l("m");var z=d.call(_,x.substring(I));return I+=z.length,z}return T("m")},k=function(z,R,q,V){for(var W=l(z,V)?q:R,K=0;K<W.length;K++)if(x.substr(I,W[K].length).toLowerCase()===W[K].toLowerCase())return I+=W[K].length,K+_.minMonth;throw(v.local.unknownNameAt||v.regionalOptions[""].unknownNameAt).replace(/\{0\}/,I)},L=function(){if("function"==typeof i){var z=l("M")?i.call(_,x.substring(I)):s.call(_,x.substring(I));return I+=z.length,z}return k("M",s,i)},M=function(){if(x.charAt(I)!==m.charAt(P))throw(v.local.unexpectedLiteralAt||v.regionalOptions[""].unexpectedLiteralAt).replace(/\{0\}/,I);I++},I=0,P=0;P<m.length;P++)if(b)"'"!==m.charAt(P)||l("'")?M():b=!1;else switch(m.charAt(P)){case"d":h=T("d");break;case"D":k("D",t,a);break;case"o":p=T("o");break;case"w":T("w");break;case"m":c=w();break;case"M":c=L();break;case"y":var S=P;o=!l("y",2),P=S,f=T("y",2);break;case"Y":f=T("Y",2);break;case"J":u=T("J")+.5,"."===x.charAt(I)&&(I++,T("J"));break;case"@":u=T("@")/this.SECS_PER_DAY+this.UNIX_EPOCH;break;case"!":u=T("!")/this.TICKS_PER_DAY+this.TICKS_EPOCH;break;case"*":I=x.length;break;case"'":l("'")?M():b=!0;break;default:M()}if(I<x.length)throw v.local.unexpectedText||v.regionalOptions[""].unexpectedText;if(-1===f?f=this.today().year():f<100&&o&&(f+=-1===n?1900:this.today().year()-this.today().year()%100-(f<=n?0:100)),"string"==typeof c&&(c=r.call(this,f,c)),p>-1){h=p;for(var E=this.daysInMonth(f,c=1);h>E;E=this.daysInMonth(f,c))c++,h-=E}return u>-1?this.fromJD(u):this.newDate(f,c,h)},determineDate:function(m,x,e,n,t){e&&"object"!=typeof e&&(t=n,n=e,e=null),"string"!=typeof n&&(t=n,n="");var a=this;return x=x?x.newDate():null,null==m?x:"string"==typeof m?function(r){try{return a.parseDate(n,r,t)}catch{}for(var d=((r=r.toLowerCase()).match(/^c/)&&e?e.newDate():null)||a.today(),s=/([+-]?[0-9]+)\s*(d|w|m|y)?/g,i=s.exec(r);i;)d.add(parseInt(i[1],10),i[2]||"d"),i=s.exec(r);return d}(m):"number"==typeof m?isNaN(m)||m===1/0||m===-1/0?x:a.today().add(m,"d"):a.newDate(m)}})},{"./main":347,"object-assign":247}],349:[function(y,ee,Q){"use strict";ee.exports=[{path:"",backoff:0},{path:"M-2.4,-3V3L0.6,0Z",backoff:.6},{path:"M-3.7,-2.5V2.5L1.3,0Z",backoff:1.3},{path:"M-4.45,-3L-1.65,-0.2V0.2L-4.45,3L1.55,0Z",backoff:1.55},{path:"M-2.2,-2.2L-0.2,-0.2V0.2L-2.2,2.2L-1.4,3L1.6,0L-1.4,-3Z",backoff:1.6},{path:"M-4.4,-2.1L-0.6,-0.2V0.2L-4.4,2.1L-4,3L2,0L-4,-3Z",backoff:2},{path:"M2,0A2,2 0 1,1 0,-2A2,2 0 0,1 2,0Z",backoff:0,noRotate:!0},{path:"M2,2V-2H-2V2Z",backoff:0,noRotate:!0}]},{}],350:[function(y,ee,Q){"use strict";var g=y("./arrow_paths"),v=y("../../plots/font_attributes"),m=y("../../plots/cartesian/constants"),x=y("../../plot_api/plot_template").templatedArray;y("../../constants/axis_placeable_objects"),ee.exports=x("annotation",{visible:{valType:"boolean",dflt:!0,editType:"calc+arraydraw"},text:{valType:"string",editType:"calc+arraydraw"},textangle:{valType:"angle",dflt:0,editType:"calc+arraydraw"},font:v({editType:"calc+arraydraw",colorEditType:"arraydraw"}),width:{valType:"number",min:1,dflt:null,editType:"calc+arraydraw"},height:{valType:"number",min:1,dflt:null,editType:"calc+arraydraw"},opacity:{valType:"number",min:0,max:1,dflt:1,editType:"arraydraw"},align:{valType:"enumerated",values:["left","center","right"],dflt:"center",editType:"arraydraw"},valign:{valType:"enumerated",values:["top","middle","bottom"],dflt:"middle",editType:"arraydraw"},bgcolor:{valType:"color",dflt:"rgba(0,0,0,0)",editType:"arraydraw"},bordercolor:{valType:"color",dflt:"rgba(0,0,0,0)",editType:"arraydraw"},borderpad:{valType:"number",min:0,dflt:1,editType:"calc+arraydraw"},borderwidth:{valType:"number",min:0,dflt:1,editType:"calc+arraydraw"},showarrow:{valType:"boolean",dflt:!0,editType:"calc+arraydraw"},arrowcolor:{valType:"color",editType:"arraydraw"},arrowhead:{valType:"integer",min:0,max:g.length,dflt:1,editType:"arraydraw"},startarrowhead:{valType:"integer",min:0,max:g.length,dflt:1,editType:"arraydraw"},arrowside:{valType:"flaglist",flags:["end","start"],extras:["none"],dflt:"end",editType:"arraydraw"},arrowsize:{valType:"number",min:.3,dflt:1,editType:"calc+arraydraw"},startarrowsize:{valType:"number",min:.3,dflt:1,editType:"calc+arraydraw"},arrowwidth:{valType:"number",min:.1,editType:"calc+arraydraw"},standoff:{valType:"number",min:0,dflt:0,editType:"calc+arraydraw"},startstandoff:{valType:"number",min:0,dflt:0,editType:"calc+arraydraw"},ax:{valType:"any",editType:"calc+arraydraw"},ay:{valType:"any",editType:"calc+arraydraw"},axref:{valType:"enumerated",dflt:"pixel",values:["pixel",m.idRegex.x.toString()],editType:"calc"},ayref:{valType:"enumerated",dflt:"pixel",values:["pixel",m.idRegex.y.toString()],editType:"calc"},xref:{valType:"enumerated",values:["paper",m.idRegex.x.toString()],editType:"calc"},x:{valType:"any",editType:"calc+arraydraw"},xanchor:{valType:"enumerated",values:["auto","left","center","right"],dflt:"auto",editType:"calc+arraydraw"},xshift:{valType:"number",dflt:0,editType:"calc+arraydraw"},yref:{valType:"enumerated",values:["paper",m.idRegex.y.toString()],editType:"calc"},y:{valType:"any",editType:"calc+arraydraw"},yanchor:{valType:"enumerated",values:["auto","top","middle","bottom"],dflt:"auto",editType:"calc+arraydraw"},yshift:{valType:"number",dflt:0,editType:"calc+arraydraw"},clicktoshow:{valType:"enumerated",values:[!1,"onoff","onout"],dflt:!1,editType:"arraydraw"},xclick:{valType:"any",editType:"arraydraw"},yclick:{valType:"any",editType:"arraydraw"},hovertext:{valType:"string",editType:"arraydraw"},hoverlabel:{bgcolor:{valType:"color",editType:"arraydraw"},bordercolor:{valType:"color",editType:"arraydraw"},font:v({editType:"arraydraw"}),editType:"arraydraw"},captureevents:{valType:"boolean",editType:"arraydraw"},editType:"calc",_deprecated:{ref:{valType:"string",editType:"calc"}}})},{"../../constants/axis_placeable_objects":484,"../../plot_api/plot_template":555,"../../plots/cartesian/constants":573,"../../plots/font_attributes":594,"./arrow_paths":349}],351:[function(y,ee,Q){"use strict";var g=y("../../lib"),v=y("../../plots/cartesian/axes"),m=y("./draw").draw;function x(n){g.filterVisible(n._fullLayout.annotations).forEach(function(a){var r=v.getFromId(n,a.xref),d=v.getFromId(n,a.yref),s=v.getRefType(a.xref),i=v.getRefType(a.yref);a._extremes={},"range"===s&&e(a,r),"range"===i&&e(a,d)})}function e(n,t){var a,r=t._id,d=r.charAt(0),s=n[d],i=n["a"+d],c=n["_"+d+"padplus"],h=n["_"+d+"padminus"],p={x:1,y:-1}[d]*n[d+"shift"],o=3*n.arrowsize*n.arrowwidth||0,b=o+p,l=o-p,T=3*n.startarrowsize*n.arrowwidth||0,_=T+p,w=T-p;if(n["a"+d+"ref"]===n[d+"ref"]){var k=v.findExtremes(t,[t.r2c(s)],{ppadplus:b,ppadminus:l}),L=v.findExtremes(t,[t.r2c(i)],{ppadplus:Math.max(c,_),ppadminus:Math.max(h,w)});a={min:[k.min[0],L.min[0]],max:[k.max[0],L.max[0]]}}else _=i?_+i:_,w=i?w-i:w,a=v.findExtremes(t,[t.r2c(s)],{ppadplus:Math.max(c,b,_),ppadminus:Math.max(h,l,w)});n._extremes[r]=a}ee.exports=function(n){if(g.filterVisible(n._fullLayout.annotations).length&&n._fullData.length)return g.syncOrAsync([m,x],n)}},{"../../lib":515,"../../plots/cartesian/axes":566,"./draw":356}],352:[function(y,ee,Q){"use strict";var g=y("../../lib"),v=y("../../registry"),m=y("../../plot_api/plot_template").arrayEditor;function x(n,t){var a,r,d,s,i,u,f,c=n._fullLayout.annotations,h=[],p=[],o=[],b=(t||[]).length;for(a=0;a<c.length;a++)if(s=(d=c[a]).clicktoshow){for(r=0;r<b;r++)if(u=(i=t[r]).xaxis,f=i.yaxis,u._id===d.xref&&f._id===d.yref&&u.d2r(i.x)===e(d._xclick,u)&&f.d2r(i.y)===e(d._yclick,f)){(d.visible?"onout"===s?p:o:h).push(a);break}r===b&&d.visible&&"onout"===s&&p.push(a)}return{on:h,off:p,explicitOff:o}}function e(n,t){return"log"===t.type?t.l2r(n):t.d2r(n)}ee.exports={hasClickToShow:function(n,t){var a=x(n,t);return a.on.length>0||a.explicitOff.length>0},onClick:function(n,t){var a,r,d=x(n,t),s=d.on,i=d.off.concat(d.explicitOff),u={},f=n._fullLayout.annotations;if(s.length||i.length){for(a=0;a<s.length;a++)(r=m(n.layout,"annotations",f[s[a]])).modifyItem("visible",!0),g.extendFlat(u,r.getUpdateObj());for(a=0;a<i.length;a++)(r=m(n.layout,"annotations",f[i[a]])).modifyItem("visible",!1),g.extendFlat(u,r.getUpdateObj());return v.call("update",n,{},u)}}}},{"../../lib":515,"../../plot_api/plot_template":555,"../../registry":647}],353:[function(y,ee,Q){"use strict";var g=y("../../lib"),v=y("../color");ee.exports=function(m,x,e,n){n("opacity");var t=n("bgcolor"),a=n("bordercolor"),r=v.opacity(a);n("borderpad");var d=n("borderwidth"),s=n("showarrow");if(n("text",s?" ":e._dfltTitle.annotation),n("textangle"),g.coerceFont(n,"font",e.font),n("width"),n("align"),n("height")&&n("valign"),s){var i,u,f=n("arrowside");-1!==f.indexOf("end")&&(i=n("arrowhead"),u=n("arrowsize")),-1!==f.indexOf("start")&&(n("startarrowhead",i),n("startarrowsize",u)),n("arrowcolor",r?x.bordercolor:v.defaultLine),n("arrowwidth",2*(r&&d||1)),n("standoff"),n("startstandoff")}var c=n("hovertext"),h=e.hoverlabel||{};if(c){var p=n("hoverlabel.bgcolor",h.bgcolor||(v.opacity(t)?v.rgb(t):v.defaultLine)),o=n("hoverlabel.bordercolor",h.bordercolor||v.contrast(p));g.coerceFont(n,"hoverlabel.font",{family:h.font.family,size:h.font.size,color:h.font.color||o})}n("captureevents",!!c)}},{"../../lib":515,"../color":367}],354:[function(y,ee,Q){"use strict";var g=y("fast-isnumeric"),v=y("../../lib/to_log_range");ee.exports=function(m,x,e,n){x=x||{};var t="log"===e&&"linear"===x.type;if(t||"linear"===e&&"log"===x.type)for(var r,d,s=m._fullLayout.annotations,i=x._id.charAt(0),u=0;u<s.length;u++)d="annotations["+u+"].",(r=s[u])[i+"ref"]===x._id&&f(i),r["a"+i+"ref"]===x._id&&f("a"+i);function f(c){var h=r[c],p=null;p=t?v(h,x.range):Math.pow(10,h),g(p)||(p=null),n(d+c,p)}}},{"../../lib/to_log_range":543,"fast-isnumeric":190}],355:[function(y,ee,Q){"use strict";var g=y("../../lib"),v=y("../../plots/cartesian/axes"),m=y("../../plots/array_container_defaults"),x=y("./common_defaults"),e=y("./attributes");function n(t,a,r){function d(L,M){return g.coerce(t,a,e,L,M)}var s=d("visible"),i=d("clicktoshow");if(s||i){x(t,a,r,d);for(var u=a.showarrow,f=["x","y"],c=[-10,-30],h={_fullLayout:r},p=0;p<2;p++){var o=f[p],b=v.coerceRef(t,a,h,o,"","paper");if("paper"!==b&&v.getFromId(h,b)._annIndices.push(a._index),v.coercePosition(a,h,d,b,o,.5),u){var l="a"+o,T=v.coerceRef(t,a,h,l,"pixel",["pixel","paper"]);"pixel"!==T&&T!==b&&(T=a[l]="pixel"),v.coercePosition(a,h,d,T,l,"pixel"===T?c[p]:.4)}d(o+"anchor"),d(o+"shift")}if(g.noneOrAll(t,a,["x","y"]),u&&g.noneOrAll(t,a,["ax","ay"]),i){var w=d("xclick"),k=d("yclick");a._xclick=void 0===w?a.x:v.cleanPosition(w,h,a.xref),a._yclick=void 0===k?a.y:v.cleanPosition(k,h,a.yref)}}}ee.exports=function(t,a){m(t,a,{name:"annotations",handleItemDefaults:n})}},{"../../lib":515,"../../plots/array_container_defaults":561,"../../plots/cartesian/axes":566,"./attributes":350,"./common_defaults":353}],356:[function(y,ee,Q){"use strict";var g=y("@plotly/d3"),v=y("../../registry"),m=y("../../plots/plots"),x=y("../../lib"),e=x.strTranslate,n=y("../../plots/cartesian/axes"),t=y("../color"),a=y("../drawing"),r=y("../fx"),d=y("../../lib/svg_text_utils"),s=y("../../lib/setcursor"),i=y("../dragelement"),u=y("../../plot_api/plot_template").arrayEditor,f=y("./draw_arrow_head");function c(o,b){var l=o._fullLayout.annotations[b]||{},T=n.getFromId(o,l.xref),_=n.getFromId(o,l.yref);T&&T.setScale(),_&&_.setScale(),p(o,l,b,!1,T,_)}function h(o,b,l,T,_){var w=_[l],k=_[l+"ref"],L=-1!==l.indexOf("y"),M="domain"===n.getRefType(k),I=L?T.h:T.w;return o?M?w+(L?-b:b)/o._length:o.p2r(o.r2p(w)+b):w+(L?-b:b)/I}function p(o,b,l,T,_,w){var k,L,M=o._fullLayout,I=o._fullLayout._size,P=o._context.edits;T?(k="annotation-"+T,L=T+".annotations"):(k="annotation",L="annotations");var S=u(o.layout,L,b),E=S.modifyBase,z=S.modifyItem,R=S.getUpdateObj;M._infolayer.selectAll("."+k+'[data-index="'+l+'"]').remove();var q="clip"+M._uid+"_ann"+l;if(b._input&&!1!==b.visible){var V={x:{},y:{}},W=+b.textangle||0,K=M._infolayer.append("g").classed(k,!0).attr("data-index",String(l)).style("opacity",b.opacity),G=K.append("g").classed("annotation-text-g",!0),Y=P[b.showarrow?"annotationTail":"annotationPosition"],$=b.captureevents||P.annotationText||Y,B=G.append("g").style("pointer-events",$?"all":null).call(s,"pointer").on("click",function(){o._dragging=!1,o.emit("plotly_clickannotation",oe(g.event))});b.hovertext&&B.on("mouseover",function(){var ge=b.hoverlabel,_e=ge.font,Te=this.getBoundingClientRect(),we=o.getBoundingClientRect();r.loneHover({x0:Te.left-we.left,x1:Te.right-we.left,y:(Te.top+Te.bottom)/2-we.top,text:b.hovertext,color:ge.bgcolor,borderColor:ge.bordercolor,fontFamily:_e.family,fontSize:_e.size,fontColor:_e.color},{container:M._hoverlayer.node(),outerContainer:M._paper.node(),gd:o})}).on("mouseout",function(){r.loneUnhover(M._hoverlayer.node())});var N=b.borderwidth,te=N+b.borderpad,j=B.append("rect").attr("class","bg").style("stroke-width",N+"px").call(t.stroke,b.bordercolor).call(t.fill,b.bgcolor),J=b.width||b.height,X=M._topclips.selectAll("#"+q).data(J?[0]:[]);X.enter().append("clipPath").classed("annclip",!0).attr("id",q).append("rect"),X.exit().remove();var re=b.font,ne=M._meta?x.templateString(b.text,M._meta):b.text,le=B.append("text").classed("annotation-text",!0).text(ne);P.annotationText?le.call(d.makeEditable,{delegate:B,gd:o}).call(de).on("edit",function(ge){b.text=ge,this.call(de),z("text",ge),_&&_.autorange&&E(_._name+".autorange",!0),w&&w.autorange&&E(w._name+".autorange",!0),v.call("_guiRelayout",o,R())}):le.call(de)}else g.selectAll("#"+q).remove();function oe(ge){var _e={index:l,annotation:b._input,fullAnnotation:b,event:ge};return T&&(_e.subplotId=T),_e}function de(ge){return ge.call(a.font,re).attr({"text-anchor":{left:"start",right:"end"}[b.align]||"middle"}),d.convertToTspans(ge,o,se),ge}function se(){var ge=le.selectAll("a");1===ge.size()&&ge.text()===le.text()&&B.insert("a",":first-child").attr({"xlink:xlink:href":ge.attr("xlink:href"),"xlink:xlink:show":ge.attr("xlink:show")}).style({cursor:"pointer"}).node().appendChild(j.node());var _e=B.select(".annotation-text-math-group"),Te=!_e.empty(),we=a.bBox((Te?_e:le).node()),Oe=we.width,fe=we.height,ve=b.width||Oe,Ae=b.height||fe,ke=Math.round(ve+2*te),Pe=Math.round(Ae+2*te);function Ne(rt,ft){return"auto"===ft&&(ft=rt<1/3?"left":rt>2/3?"right":"center"),{center:0,middle:0,left:.5,bottom:-.5,right:-.5,top:.5}[ft]}for(var De=!1,ze=["x","y"],Me=0;Me<ze.length;Me++){var Se,Ie,Fe,Re,Xe,nt=ze[Me],ct=b[nt+"ref"]||nt,xt=b["a"+nt+"ref"],dt={x:_,y:w}[nt],tt=(W+("x"===nt?0:-90))*Math.PI/180,Ke=ke*Math.cos(tt),mt=Pe*Math.sin(tt),Bt=Math.abs(Ke)+Math.abs(mt),Ut=b[nt+"anchor"],er=b[nt+"shift"]*("x"===nt?1:-1),Wt=V[nt],rr=n.getRefType(ct);if(dt&&"domain"!==rr){var Ht=dt.r2fraction(b[nt]);(Ht<0||Ht>1)&&(xt===ct?((Ht=dt.r2fraction(b["a"+nt]))<0||Ht>1)&&(De=!0):De=!0),Se=dt._offset+dt.r2p(b[nt]),Re=.5}else{var Ve="domain"===rr;"x"===nt?(Fe=b[nt],Se=Ve?dt._offset+dt._length*Fe:Se=I.l+I.w*Fe):(Fe=1-b[nt],Se=Ve?dt._offset+dt._length*Fe:Se=I.t+I.h*Fe),Re=b.showarrow?.5:Fe}if(b.showarrow){Wt.head=Se;var We=b["a"+nt];if(Xe=Ke*Ne(.5,b.xanchor)-mt*Ne(.5,b.yanchor),xt===ct){var he=n.getRefType(xt);"domain"===he?("y"===nt&&(We=1-We),Wt.tail=dt._offset+dt._length*We):Wt.tail="paper"===he?"y"===nt?I.t+I.h*(We=1-We):I.l+I.w*We:dt._offset+dt.r2p(We),Ie=Xe}else Wt.tail=Se+We,Ie=Xe+We;Wt.text=Wt.tail+Xe;var ye=M["x"===nt?"width":"height"];if("paper"===ct&&(Wt.head=x.constrain(Wt.head,1,ye-1)),"pixel"===xt){var Be=-Math.max(Wt.tail-3,Wt.text),Ge=Math.min(Wt.tail+3,Wt.text)-ye;Be>0?(Wt.tail+=Be,Wt.text+=Be):Ge>0&&(Wt.tail-=Ge,Wt.text-=Ge)}Wt.tail+=er,Wt.head+=er}else Ie=Xe=Bt*Ne(Re,Ut),Wt.text=Se+Xe;Wt.text+=er,Xe+=er,b["_"+nt+"padplus"]=Bt/2+(Ie+=er),b["_"+nt+"padminus"]=Bt/2-Ie,b["_"+nt+"size"]=Bt,b["_"+nt+"shift"]=Xe}if(De)B.remove();else{var Je=0,He=0;"left"!==b.align&&(Je=(ve-Oe)*("center"===b.align?.5:1)),"top"!==b.valign&&(He=(Ae-fe)*("middle"===b.valign?.5:1)),Te?_e.select("svg").attr({x:te+Je-1,y:te+He}).call(a.setClipUrl,J?q:null,o):le.call(d.positionText,te+Je-we.left,te+He-we.top).call(a.setClipUrl,J?q:null,o),X.select("rect").call(a.setRect,te,te,ve,Ae),j.call(a.setRect,N/2,N/2,ke-N,Pe-N),B.call(a.setTranslate,Math.round(V.x.text-ke/2),Math.round(V.y.text-Pe/2)),G.attr({transform:"rotate("+W+","+V.x.text+","+V.y.text+")"});var wt,Ct=function(rt,ft){K.selectAll(".annotation-arrow-g").remove();var Rt=V.x.head,kt=V.y.head,Lt=V.x.tail+rt,Ee=V.y.tail+ft,Ye=V.x.text+rt,it=V.y.text+ft,ht=x.rotationXYMatrix(W,Ye,it),At=x.apply2DTransform(ht),Ft=x.apply2DTransform2(ht),Gt=+j.attr("width"),jt=+j.attr("height"),fr=Ye-.5*Gt,kr=fr+Gt,ur=it-.5*jt,Jt=ur+jt,$t=[[fr,ur,fr,Jt],[fr,Jt,kr,Jt],[kr,Jt,kr,ur],[kr,ur,fr,ur]].map(Ft);if(!$t.reduce(function(dn,An){return dn^!!x.segmentsIntersect(Rt,kt,Rt+1e6,kt+1e6,An[0],An[1],An[2],An[3])},!1)){$t.forEach(function(dn){var An=x.segmentsIntersect(Lt,Ee,Rt,kt,dn[0],dn[1],dn[2],dn[3]);An&&(Lt=An.x,Ee=An.y)});var Qt=b.arrowwidth,cr=b.arrowcolor,gr=b.arrowside,Tr=K.append("g").style({opacity:t.opacity(cr)}).classed("annotation-arrow-g",!0),Fr=Tr.append("path").attr("d","M"+Lt+","+Ee+"L"+Rt+","+kt).style("stroke-width",Qt+"px").call(t.stroke,t.rgb(cr));if(f(Fr,gr,b),P.annotationPosition&&Fr.node().parentNode&&!T){var Nr=Rt,Xr=kt;if(b.standoff){var un=Math.sqrt(Math.pow(Rt-Lt,2)+Math.pow(kt-Ee,2));Nr+=b.standoff*(Lt-Rt)/un,Xr+=b.standoff*(Ee-kt)/un}var $r,Pn,gn=Tr.append("path").classed("annotation-arrow",!0).classed("anndrag",!0).classed("cursor-move",!0).attr({d:"M3,3H-3V-3H3ZM0,0L"+(Lt-Nr)+","+(Ee-Xr),transform:e(Nr,Xr)}).style("stroke-width",Qt+6+"px").call(t.stroke,"rgba(0,0,0,0)").call(t.fill,"rgba(0,0,0,0)");i.init({element:gn.node(),gd:o,prepFn:function(){var dn=a.getTranslate(B);$r=dn.x,Pn=dn.y,_&&_.autorange&&E(_._name+".autorange",!0),w&&w.autorange&&E(w._name+".autorange",!0)},moveFn:function(dn,An){var Zn=At($r,Pn),Rr=Zn[0]+dn,hn=Zn[1]+An;B.call(a.setTranslate,Rr,hn),z("x",h(_,dn,"x",I,b)),z("y",h(w,An,"y",I,b)),b.axref===b.xref&&z("ax",h(_,dn,"ax",I,b)),b.ayref===b.yref&&z("ay",h(w,An,"ay",I,b)),Tr.attr("transform",e(dn,An)),G.attr({transform:"rotate("+W+","+Rr+","+hn+")"})},doneFn:function(){v.call("_guiRelayout",o,R());var dn=document.querySelector(".js-notes-box-panel");dn&&dn.redraw(dn.selectedObj)}})}}};b.showarrow&&Ct(0,0),Y&&i.init({element:B.node(),gd:o,prepFn:function(){wt=G.attr("transform")},moveFn:function(rt,ft){var Rt="pointer";if(b.showarrow)z("ax",b.axref===b.xref?h(_,rt,"ax",I,b):b.ax+rt),z("ay",b.ayref===b.yref?h(w,ft,"ay",I.w,b):b.ay+ft),Ct(rt,ft);else{if(T)return;var kt,Lt;if(_)kt=h(_,rt,"x",I,b);else{var Ee=b._xsize/I.w;kt=i.align(b.x+(b._xshift-b.xshift)/I.w-Ee/2+rt/I.w,Ee,0,1,b.xanchor)}if(w)Lt=h(w,ft,"y",I,b);else{var it=b._ysize/I.h;Lt=i.align(b.y-(b._yshift+b.yshift)/I.h-it/2-ft/I.h,it,0,1,b.yanchor)}z("x",kt),z("y",Lt),_&&w||(Rt=i.getCursor(_?.5:kt,w?.5:Lt,b.xanchor,b.yanchor))}G.attr({transform:e(rt,ft)+wt}),s(B,Rt)},clickFn:function(rt,ft){b.captureevents&&o.emit("plotly_clickannotation",oe(ft))},doneFn:function(){s(B),v.call("_guiRelayout",o,R());var rt=document.querySelector(".js-notes-box-panel");rt&&rt.redraw(rt.selectedObj)}})}}}ee.exports={draw:function(o){var b=o._fullLayout;b._infolayer.selectAll(".annotation").remove();for(var l=0;l<b.annotations.length;l++)b.annotations[l].visible&&c(o,l);return m.previousPromises(o)},drawOne:c,drawRaw:p}},{"../../lib":515,"../../lib/setcursor":536,"../../lib/svg_text_utils":541,"../../plot_api/plot_template":555,"../../plots/cartesian/axes":566,"../../plots/plots":628,"../../registry":647,"../color":367,"../dragelement":386,"../drawing":389,"../fx":407,"./draw_arrow_head":357,"@plotly/d3":58}],357:[function(y,ee,Q){"use strict";var g=y("@plotly/d3"),v=y("../color"),m=y("./arrow_paths"),x=y("../../lib"),e=x.strScale,n=x.strRotate,t=x.strTranslate;ee.exports=function(a,r,d){var s,i,u,f,c=a.node(),h=m[d.arrowhead||0],p=m[d.startarrowhead||0],o=(d.arrowwidth||1)*(d.arrowsize||1),b=(d.arrowwidth||1)*(d.startarrowsize||1),l=r.indexOf("start")>=0,T=r.indexOf("end")>=0,_=h.backoff*o+d.standoff,w=p.backoff*b+d.startstandoff;if("line"===c.nodeName){s={x:+a.attr("x1"),y:+a.attr("y1")},i={x:+a.attr("x2"),y:+a.attr("y2")};var k=s.x-i.x,L=s.y-i.y;if(f=(u=Math.atan2(L,k))+Math.PI,_&&w&&_+w>Math.sqrt(k*k+L*L))return void K();if(_){if(_*_>k*k+L*L)return void K();var M=_*Math.cos(u),I=_*Math.sin(u);i.x+=M,i.y+=I,a.attr({x2:i.x,y2:i.y})}if(w){if(w*w>k*k+L*L)return void K();var P=w*Math.cos(u),S=w*Math.sin(u);s.x-=P,s.y-=S,a.attr({x1:s.x,y1:s.y})}}else if("path"===c.nodeName){var E=c.getTotalLength(),z="";if(E<_+w)return void K();var R=c.getPointAtLength(0),q=c.getPointAtLength(.1);u=Math.atan2(R.y-q.y,R.x-q.x),s=c.getPointAtLength(Math.min(w,E)),z="0px,"+w+"px,";var V=c.getPointAtLength(E),W=c.getPointAtLength(E-.1);f=Math.atan2(V.y-W.y,V.x-W.x),i=c.getPointAtLength(Math.max(0,E-_)),a.style("stroke-dasharray",z+=E-(z?w+_:_)+"px,"+E+"px")}function K(){a.style("stroke-dasharray","0px,100px")}function G(Y,$,B,N){Y.path&&(Y.noRotate&&(B=0),g.select(c.parentNode).append("path").attr({class:a.attr("class"),d:Y.path,transform:t($.x,$.y)+n(180*B/Math.PI)+e(N)}).style({fill:v.rgb(d.arrowcolor),"stroke-width":0}))}l&&G(p,s,u,b),T&&G(h,i,f,o)}},{"../../lib":515,"../color":367,"./arrow_paths":349,"@plotly/d3":58}],358:[function(y,ee,Q){"use strict";var g=y("./draw"),v=y("./click");ee.exports={moduleType:"component",name:"annotations",layoutAttributes:y("./attributes"),supplyLayoutDefaults:y("./defaults"),includeBasePlot:y("../../plots/cartesian/include_components")("annotations"),calcAutorange:y("./calc_autorange"),draw:g.draw,drawOne:g.drawOne,drawRaw:g.drawRaw,hasClickToShow:v.hasClickToShow,onClick:v.onClick,convertCoords:y("./convert_coords")}},{"../../plots/cartesian/include_components":577,"./attributes":350,"./calc_autorange":351,"./click":352,"./convert_coords":354,"./defaults":355,"./draw":356}],359:[function(y,ee,Q){"use strict";var g=y("../annotations/attributes"),v=y("../../plot_api/edit_types").overrideAll,m=y("../../plot_api/plot_template").templatedArray;ee.exports=v(m("annotation",{visible:g.visible,x:{valType:"any"},y:{valType:"any"},z:{valType:"any"},ax:{valType:"number"},ay:{valType:"number"},xanchor:g.xanchor,xshift:g.xshift,yanchor:g.yanchor,yshift:g.yshift,text:g.text,textangle:g.textangle,font:g.font,width:g.width,height:g.height,opacity:g.opacity,align:g.align,valign:g.valign,bgcolor:g.bgcolor,bordercolor:g.bordercolor,borderpad:g.borderpad,borderwidth:g.borderwidth,showarrow:g.showarrow,arrowcolor:g.arrowcolor,arrowhead:g.arrowhead,startarrowhead:g.startarrowhead,arrowside:g.arrowside,arrowsize:g.arrowsize,startarrowsize:g.startarrowsize,arrowwidth:g.arrowwidth,standoff:g.standoff,startstandoff:g.startstandoff,hovertext:g.hovertext,hoverlabel:g.hoverlabel,captureevents:g.captureevents}),"calc","from-root")},{"../../plot_api/edit_types":548,"../../plot_api/plot_template":555,"../annotations/attributes":350}],360:[function(y,ee,Q){"use strict";var g=y("../../lib"),v=y("../../plots/cartesian/axes");function m(x,e){var n=e.fullSceneLayout.domain,t=e.fullLayout._size,a={pdata:null,type:"linear",autorange:!1,range:[-1/0,1/0]};x._xa={},g.extendFlat(x._xa,a),v.setConvert(x._xa),x._xa._offset=t.l+n.x[0]*t.w,x._xa.l2p=function(){return.5*(1+x._pdata[0]/x._pdata[3])*t.w*(n.x[1]-n.x[0])},x._ya={},g.extendFlat(x._ya,a),v.setConvert(x._ya),x._ya._offset=t.t+(1-n.y[1])*t.h,x._ya.l2p=function(){return.5*(1-x._pdata[1]/x._pdata[3])*t.h*(n.y[1]-n.y[0])}}ee.exports=function(x){for(var e=x.fullSceneLayout.annotations,n=0;n<e.length;n++)m(e[n],x);x.fullLayout._infolayer.selectAll(".annotation-"+x.id).remove()}},{"../../lib":515,"../../plots/cartesian/axes":566}],361:[function(y,ee,Q){"use strict";var g=y("../../lib"),v=y("../../plots/cartesian/axes"),m=y("../../plots/array_container_defaults"),x=y("../annotations/common_defaults"),e=y("./attributes");function n(t,a,r,d){function s(u,f){return g.coerce(t,a,e,u,f)}function i(u){var f=u+"axis",c={_fullLayout:{}};return c._fullLayout[f]=r[f],v.coercePosition(a,c,s,u,u,.5)}s("visible")&&(x(t,a,d.fullLayout,s),i("x"),i("y"),i("z"),g.noneOrAll(t,a,["x","y","z"]),a.xref="x",a.yref="y",a.zref="z",s("xanchor"),s("yanchor"),s("xshift"),s("yshift"),a.showarrow&&(a.axref="pixel",a.ayref="pixel",s("ax",-10),s("ay",-30),g.noneOrAll(t,a,["ax","ay"])))}ee.exports=function(t,a,r){m(t,a,{name:"annotations",handleItemDefaults:n,fullLayout:r.fullLayout})}},{"../../lib":515,"../../plots/array_container_defaults":561,"../../plots/cartesian/axes":566,"../annotations/common_defaults":353,"./attributes":359}],362:[function(y,ee,Q){"use strict";var g=y("../annotations/draw").drawRaw,v=y("../../plots/gl3d/project"),m=["x","y","z"];ee.exports=function(x){for(var e=x.fullSceneLayout,n=x.dataScale,t=e.annotations,a=0;a<t.length;a++){for(var r=t[a],d=!1,s=0;s<3;s++){var i=m[s],f=e[i+"axis"].r2fraction(r[i]);if(f<0||f>1){d=!0;break}}d?x.fullLayout._infolayer.select(".annotation-"+x.id+'[data-index="'+a+'"]').remove():(r._pdata=v(x.glplot.cameraParams,[e.xaxis.r2l(r.x)*n[0],e.yaxis.r2l(r.y)*n[1],e.zaxis.r2l(r.z)*n[2]]),g(x.graphDiv,r,a,x.id,r._xa,r._ya))}}},{"../../plots/gl3d/project":616,"../annotations/draw":356}],363:[function(y,ee,Q){"use strict";var g=y("../../registry"),v=y("../../lib");ee.exports={moduleType:"component",name:"annotations3d",schema:{subplots:{scene:{annotations:y("./attributes")}}},layoutAttributes:y("./attributes"),handleDefaults:y("./defaults"),includeBasePlot:function(m,x){var e=g.subplotsRegistry.gl3d;if(e)for(var n=e.attrRegex,t=Object.keys(m),a=0;a<t.length;a++){var r=t[a];n.test(r)&&(m[r].annotations||[]).length&&(v.pushUnique(x._basePlotModules,e),v.pushUnique(x._subplots.gl3d,r))}},convert:y("./convert"),draw:y("./draw")}},{"../../lib":515,"../../registry":647,"./attributes":359,"./convert":360,"./defaults":361,"./draw":362}],364:[function(y,ee,Q){"use strict";ee.exports=y("world-calendars/dist/main"),y("world-calendars/dist/plus"),y("world-calendars/dist/calendars/chinese"),y("world-calendars/dist/calendars/coptic"),y("world-calendars/dist/calendars/discworld"),y("world-calendars/dist/calendars/ethiopian"),y("world-calendars/dist/calendars/hebrew"),y("world-calendars/dist/calendars/islamic"),y("world-calendars/dist/calendars/julian"),y("world-calendars/dist/calendars/mayan"),y("world-calendars/dist/calendars/nanakshahi"),y("world-calendars/dist/calendars/nepali"),y("world-calendars/dist/calendars/persian"),y("world-calendars/dist/calendars/taiwan"),y("world-calendars/dist/calendars/thai"),y("world-calendars/dist/calendars/ummalqura")},{"world-calendars/dist/calendars/chinese":333,"world-calendars/dist/calendars/coptic":334,"world-calendars/dist/calendars/discworld":335,"world-calendars/dist/calendars/ethiopian":336,"world-calendars/dist/calendars/hebrew":337,"world-calendars/dist/calendars/islamic":338,"world-calendars/dist/calendars/julian":339,"world-calendars/dist/calendars/mayan":340,"world-calendars/dist/calendars/nanakshahi":341,"world-calendars/dist/calendars/nepali":342,"world-calendars/dist/calendars/persian":343,"world-calendars/dist/calendars/taiwan":344,"world-calendars/dist/calendars/thai":345,"world-calendars/dist/calendars/ummalqura":346,"world-calendars/dist/main":347,"world-calendars/dist/plus":348}],365:[function(y,ee,Q){"use strict";var g=y("./calendars"),v=y("../../lib"),m=y("../../constants/numerical"),x=m.EPOCHJD,e=m.ONEDAY,n={valType:"enumerated",values:v.sortObjectKeys(g.calendars),editType:"calc",dflt:"gregorian"},t=function(p,o,b,l){var T={};return T[b]=n,v.coerce(p,o,T,b,l)},a={d:{0:"dd","-":"d"},e:{0:"d","-":"d"},a:{0:"D","-":"D"},A:{0:"DD","-":"DD"},j:{0:"oo","-":"o"},W:{0:"ww","-":"w"},m:{0:"mm","-":"m"},b:{0:"M","-":"M"},B:{0:"MM","-":"MM"},y:{0:"yy","-":"yy"},Y:{0:"yyyy","-":"yyyy"},U:"##",w:"##",c:{0:"D M d %X yyyy","-":"D M d %X yyyy"},x:{0:"mm/dd/yyyy","-":"mm/dd/yyyy"}},r={};function d(p){return r[p]||(r[p]=g.instance(p))}function s(p){return v.extendFlat({},n,{description:p})}function i(p){return"Sets the calendar system to use with `"+p+"` date data."}var u={xcalendar:s(i("x"))},f=v.extendFlat({},u,{ycalendar:s(i("y"))}),c=v.extendFlat({},f,{zcalendar:s(i("z"))}),h=s(["Sets the calendar system to use for `range` and `tick0`","if this is a date axis. This does not set the calendar for","interpreting data on this axis, that's specified in the trace","or via the global `layout.calendar`"].join(" "));ee.exports={moduleType:"component",name:"calendars",schema:{traces:{scatter:f,bar:f,box:f,heatmap:f,contour:f,histogram:f,histogram2d:f,histogram2dcontour:f,scatter3d:c,surface:c,mesh3d:c,scattergl:f,ohlc:u,candlestick:u},layout:{calendar:s(["Sets the default calendar system to use for interpreting and","displaying dates throughout the plot."].join(" "))},subplots:{xaxis:{calendar:h},yaxis:{calendar:h},scene:{xaxis:{calendar:h},yaxis:{calendar:h},zaxis:{calendar:h}},polar:{radialaxis:{calendar:h}}},transforms:{filter:{valuecalendar:s(["WARNING: All transforms are deprecated and may be removed from the API in next major version.","Sets the calendar system to use for `value`, if it is a date."].join(" ")),targetcalendar:s(["WARNING: All transforms are deprecated and may be removed from the API in next major version.","Sets the calendar system to use for `target`, if it is an","array of dates. If `target` is a string (eg *x*) we use the","corresponding trace attribute (eg `xcalendar`) if it exists,","even if `targetcalendar` is provided."].join(" "))}}},layoutAttributes:n,handleDefaults:t,handleTraceDefaults:function(p,o,b,l){for(var T=0;T<b.length;T++)t(p,o,b[T]+"calendar",l.calendar)},CANONICAL_SUNDAY:{chinese:"2000-01-02",coptic:"2000-01-03",discworld:"2000-01-03",ethiopian:"2000-01-05",hebrew:"5000-01-01",islamic:"1000-01-02",julian:"2000-01-03",mayan:"5000-01-01",nanakshahi:"1000-01-05",nepali:"2000-01-05",persian:"1000-01-01",jalali:"1000-01-01",taiwan:"1000-01-04",thai:"2000-01-04",ummalqura:"1400-01-06"},CANONICAL_TICK:{chinese:"2000-01-01",coptic:"2000-01-01",discworld:"2000-01-01",ethiopian:"2000-01-01",hebrew:"5000-01-01",islamic:"1000-01-01",julian:"2000-01-01",mayan:"5000-01-01",nanakshahi:"1000-01-01",nepali:"2000-01-01",persian:"1000-01-01",jalali:"1000-01-01",taiwan:"1000-01-01",thai:"2000-01-01",ummalqura:"1400-01-01"},DFLTRANGE:{chinese:["2000-01-01","2001-01-01"],coptic:["1700-01-01","1701-01-01"],discworld:["1800-01-01","1801-01-01"],ethiopian:["2000-01-01","2001-01-01"],hebrew:["5700-01-01","5701-01-01"],islamic:["1400-01-01","1401-01-01"],julian:["2000-01-01","2001-01-01"],mayan:["5200-01-01","5201-01-01"],nanakshahi:["0500-01-01","0501-01-01"],nepali:["2000-01-01","2001-01-01"],persian:["1400-01-01","1401-01-01"],jalali:["1400-01-01","1401-01-01"],taiwan:["0100-01-01","0101-01-01"],thai:["2500-01-01","2501-01-01"],ummalqura:["1400-01-01","1401-01-01"]},getCal:d,worldCalFmt:function(p,o,b){for(var l,T,_,w,k,L=Math.floor((o+.05)/e)+x,M=d(b).fromJD(L),I=0;-1!==(I=p.indexOf("%",I));)"0"===(l=p.charAt(I+1))||"-"===l||"_"===l?(_=3,T=p.charAt(I+2),"_"===l&&(l="-")):(T=l,l="0",_=2),(w=a[T])?(k="##"===w?"##":M.formatDate(w[l]),p=p.substr(0,I)+k+p.substr(I+_),I+=k.length):I+=_;return p}}},{"../../constants/numerical":491,"../../lib":515,"./calendars":364}],366:[function(y,ee,Q){"use strict";Q.defaults=["#1f77b4","#ff7f0e","#2ca02c","#d62728","#9467bd","#8c564b","#e377c2","#7f7f7f","#bcbd22","#17becf"],Q.defaultLine="#444",Q.lightLine="#eee",Q.background="#fff",Q.borderLine="#BEC8D9",Q.lightFraction=1e3/11},{}],367:[function(y,ee,Q){"use strict";var g=y("tinycolor2"),v=y("fast-isnumeric"),m=y("../../lib/array").isTypedArray,x=ee.exports={},e=y("./attributes");x.defaults=e.defaults;var n=x.defaultLine=e.defaultLine;x.lightLine=e.lightLine;var t=x.background=e.background;function a(r){if(v(r)||"string"!=typeof r)return r;var d=r.trim();if("rgb"!==d.substr(0,3))return r;var s=d.match(/^rgba?\s*\(([^()]*)\)$/);if(!s)return r;var i=s[1].trim().split(/\s*[\s,]\s*/),u="a"===d.charAt(3)&&4===i.length;if(!u&&3!==i.length)return r;for(var f=0;f<i.length;f++){if(!(i[f].length&&(i[f]=Number(i[f]),i[f]>=0)))return r;if(3===f)i[f]>1&&(i[f]=1);else if(i[f]>=1)return r}var c=Math.round(255*i[0])+", "+Math.round(255*i[1])+", "+Math.round(255*i[2]);return u?"rgba("+c+", "+i[3]+")":"rgb("+c+")"}x.tinyRGB=function(r){var d=r.toRgb();return"rgb("+Math.round(d.r)+", "+Math.round(d.g)+", "+Math.round(d.b)+")"},x.rgb=function(r){return x.tinyRGB(g(r))},x.opacity=function(r){return r?g(r).getAlpha():0},x.addOpacity=function(r,d){var s=g(r).toRgb();return"rgba("+Math.round(s.r)+", "+Math.round(s.g)+", "+Math.round(s.b)+", "+d+")"},x.combine=function(r,d){var s=g(r).toRgb();if(1===s.a)return g(r).toRgbString();var i=g(d||t).toRgb(),u=1===i.a?i:{r:255*(1-i.a)+i.r*i.a,g:255*(1-i.a)+i.g*i.a,b:255*(1-i.a)+i.b*i.a};return g({r:u.r*(1-s.a)+s.r*s.a,g:u.g*(1-s.a)+s.g*s.a,b:u.b*(1-s.a)+s.b*s.a}).toRgbString()},x.contrast=function(r,d,s){var i=g(r);return 1!==i.getAlpha()&&(i=g(x.combine(r,t))),(i.isDark()?d?i.lighten(d):t:s?i.darken(s):n).toString()},x.stroke=function(r,d){var s=g(d);r.style({stroke:x.tinyRGB(s),"stroke-opacity":s.getAlpha()})},x.fill=function(r,d){var s=g(d);r.style({fill:x.tinyRGB(s),"fill-opacity":s.getAlpha()})},x.clean=function(r){if(r&&"object"==typeof r){var d,s,i,u,f=Object.keys(r);for(d=0;d<f.length;d++)if(u=r[i=f[d]],"color"===i.substr(i.length-5))if(Array.isArray(u))for(s=0;s<u.length;s++)u[s]=a(u[s]);else r[i]=a(u);else if("colorscale"===i.substr(i.length-10)&&Array.isArray(u))for(s=0;s<u.length;s++)Array.isArray(u[s])&&(u[s][1]=a(u[s][1]));else if(Array.isArray(u)){var c=u[0];if(!Array.isArray(c)&&c&&"object"==typeof c)for(s=0;s<u.length;s++)x.clean(u[s])}else u&&"object"==typeof u&&!m(u)&&x.clean(u)}}},{"../../lib/array":497,"./attributes":366,"fast-isnumeric":190,tinycolor2:313}],368:[function(y,ee,Q){"use strict";var g=y("../../plots/cartesian/layout_attributes"),v=y("../../plots/font_attributes"),m=y("../../lib/extend").extendFlat,x=y("../../plot_api/edit_types").overrideAll;ee.exports=x({orientation:{valType:"enumerated",values:["h","v"],dflt:"v"},thicknessmode:{valType:"enumerated",values:["fraction","pixels"],dflt:"pixels"},thickness:{valType:"number",min:0,dflt:30},lenmode:{valType:"enumerated",values:["fraction","pixels"],dflt:"fraction"},len:{valType:"number",min:0,dflt:1},x:{valType:"number",min:-2,max:3},xanchor:{valType:"enumerated",values:["left","center","right"]},xpad:{valType:"number",min:0,dflt:10},y:{valType:"number",min:-2,max:3},yanchor:{valType:"enumerated",values:["top","middle","bottom"]},ypad:{valType:"number",min:0,dflt:10},outlinecolor:g.linecolor,outlinewidth:g.linewidth,bordercolor:g.linecolor,borderwidth:{valType:"number",min:0,dflt:0},bgcolor:{valType:"color",dflt:"rgba(0,0,0,0)"},tickmode:g.tickmode,nticks:g.nticks,tick0:g.tick0,dtick:g.dtick,tickvals:g.tickvals,ticktext:g.ticktext,ticks:m({},g.ticks,{dflt:""}),ticklabeloverflow:m({},g.ticklabeloverflow,{}),ticklabelposition:{valType:"enumerated",values:["outside","inside","outside top","inside top","outside left","inside left","outside right","inside right","outside bottom","inside bottom"],dflt:"outside"},ticklen:g.ticklen,tickwidth:g.tickwidth,tickcolor:g.tickcolor,ticklabelstep:g.ticklabelstep,showticklabels:g.showticklabels,tickfont:v({}),tickangle:g.tickangle,tickformat:g.tickformat,tickformatstops:g.tickformatstops,tickprefix:g.tickprefix,showtickprefix:g.showtickprefix,ticksuffix:g.ticksuffix,showticksuffix:g.showticksuffix,separatethousands:g.separatethousands,exponentformat:g.exponentformat,minexponent:g.minexponent,showexponent:g.showexponent,title:{text:{valType:"string"},font:v({}),side:{valType:"enumerated",values:["right","top","bottom"]}},_deprecated:{title:{valType:"string"},titlefont:v({}),titleside:{valType:"enumerated",values:["right","top","bottom"],dflt:"top"}}},"colorbars","from-root")},{"../../lib/extend":505,"../../plot_api/edit_types":548,"../../plots/cartesian/layout_attributes":579,"../../plots/font_attributes":594}],369:[function(y,ee,Q){"use strict";ee.exports={cn:{colorbar:"colorbar",cbbg:"cbbg",cbfill:"cbfill",cbfills:"cbfills",cbline:"cbline",cblines:"cblines",cbaxis:"cbaxis",cbtitleunshift:"cbtitleunshift",cbtitle:"cbtitle",cboutline:"cboutline",crisp:"crisp",jsPlaceholder:"js-placeholder"}}},{}],370:[function(y,ee,Q){"use strict";var g=y("../../lib"),v=y("../../plot_api/plot_template"),m=y("../../plots/cartesian/tick_value_defaults"),x=y("../../plots/cartesian/tick_mark_defaults"),e=y("../../plots/cartesian/tick_label_defaults"),n=y("../../plots/cartesian/prefix_suffix_defaults"),t=y("./attributes");ee.exports=function(a,r,d){var s=v.newContainer(r,"colorbar"),i=a.colorbar||{};function u(L,M){return g.coerce(i,s,t,L,M)}var f=d.margin||{t:0,b:0,l:0,r:0},c=d.width-f.l-f.r,h=d.height-f.t-f.b,p="v"===u("orientation"),o=u("thicknessmode");u("thickness","fraction"===o?30/(p?c:h):30);var b=u("lenmode");u("len","fraction"===b?1:p?h:c),u("x",p?1.02:.5),u("xanchor",p?"left":"center"),u("xpad"),u("y",p?.5:1.02),u("yanchor",p?"middle":"bottom"),u("ypad"),g.noneOrAll(i,s,["x","y"]),u("outlinecolor"),u("outlinewidth"),u("bordercolor"),u("borderwidth"),u("bgcolor");var l=g.coerce(i,s,{ticklabelposition:{valType:"enumerated",dflt:"outside",values:p?["outside","inside","outside top","inside top","outside bottom","inside bottom"]:["outside","inside","outside left","inside left","outside right","inside right"]}},"ticklabelposition");u("ticklabeloverflow",-1!==l.indexOf("inside")?"hide past domain":"hide past div"),m(i,s,u,"linear");var T=d.font,_={outerTicks:!1,font:T};-1!==l.indexOf("inside")&&(_.bgColor="black"),n(i,s,u,"linear",_),e(i,s,u,"linear",_),x(i,s,u,"linear",_),u("title.text",d._dfltTitle.colorbar);var w=s.tickfont,k=g.extendFlat({},w,{color:T.color,size:g.bigFont(w.size)});g.coerceFont(u,"title.font",k),u("title.side",p?"top":"right")}},{"../../lib":515,"../../plot_api/plot_template":555,"../../plots/cartesian/prefix_suffix_defaults":583,"../../plots/cartesian/tick_label_defaults":587,"../../plots/cartesian/tick_mark_defaults":588,"../../plots/cartesian/tick_value_defaults":589,"./attributes":368}],371:[function(y,ee,Q){"use strict";var g=y("@plotly/d3"),v=y("tinycolor2"),m=y("../../plots/plots"),x=y("../../registry"),e=y("../../plots/cartesian/axes"),n=y("../dragelement"),t=y("../../lib"),a=t.strTranslate,r=y("../../lib/extend").extendFlat,d=y("../../lib/setcursor"),s=y("../drawing"),i=y("../color"),u=y("../titles"),f=y("../../lib/svg_text_utils"),c=y("../colorscale/helpers").flipScale,h=y("../../plots/cartesian/axis_defaults"),p=y("../../plots/cartesian/position_defaults"),o=y("../../plots/cartesian/layout_attributes"),b=y("../../constants/alignment"),l=b.LINE_SPACING,T=b.FROM_TL,_=b.FROM_BR,w=y("./constants").cn;ee.exports={draw:function(k){var L=k._fullLayout._infolayer.selectAll("g."+w.colorbar).data(function(M){var I,P,S,E,z=M._fullLayout,R=M.calcdata,q=[];function V(J){return r(J,{_fillcolor:null,_line:{color:null,width:null,dash:null},_levels:{start:null,end:null,size:null},_filllevels:null,_fillgradient:null,_zrange:null})}function W(){"function"==typeof E.calc?E.calc(M,S,I):(I._fillgradient=P.reversescale?c(P.colorscale):P.colorscale,I._zrange=[P[E.min],P[E.max]])}for(var K=0;K<R.length;K++){var Y=(S=R[K][0].trace)._module.colorbar;if(!0===S.visible&&Y)for(var $=Array.isArray(Y),B=$?Y:[Y],N=0;N<B.length;N++){var U=(E=B[N]).container;(P=U?S[U]:S)&&P.showscale&&((I=V(P.colorbar))._id="cb"+S.uid+($&&U?"-"+U:""),I._traceIndex=S.index,I._propPrefix=(U?U+".":"")+"colorbar.",I._meta=S._meta,W(),q.push(I))}}for(var te in z._colorAxes)if((P=z[te]).showscale){var j=z._colorAxes[te];(I=V(P.colorbar))._id="cb"+te,I._propPrefix=te+".colorbar.",I._meta=z._meta,E={min:"cmin",max:"cmax"},"heatmap"!==j[0]&&(E.calc=(S=j[1])._module.colorbar.calc),W(),q.push(I)}return q}(k),function(M){return M._id});L.enter().append("g").attr("class",function(M){return M._id}).classed(w.colorbar,!0),L.each(function(M){var I=g.select(this);t.ensureSingle(I,"rect",w.cbbg),t.ensureSingle(I,"g",w.cbfills),t.ensureSingle(I,"g",w.cblines),t.ensureSingle(I,"g",w.cbaxis,function(S){S.classed(w.crisp,!0)}),t.ensureSingle(I,"g",w.cbtitleunshift,function(S){S.append("g").classed(w.cbtitle,!0)}),t.ensureSingle(I,"rect",w.cboutline);var S,E,z,R,q,V,W,K,P=function(S,E,z){var R="v"===E.orientation,q=E.len,V=E.lenmode,W=E.thickness,K=E.thicknessmode,G=E.outlinewidth,Y=E.borderwidth,$=E.bgcolor,B=E.xanchor,N=E.yanchor,U=E.xpad,te=E.ypad,j=E.x,J=R?E.y:1-E.y,X=z._fullLayout,re=X._size,ne=E._fillcolor,le=E._line,oe=E.title,de=oe.side,se=E._zrange||g.extent(("function"==typeof ne?ne:le.color).domain()),ge="function"==typeof le.color?le.color:function(){return le.color},_e="function"==typeof ne?ne:function(){return ne},Te=E._levels,we=function(rr,Ht,Ve){var We,he,ye=Ht._levels,Be=[],Ge=[],Je=ye.end+ye.size/100,He=ye.size,st=1.001*Ve[0]-.001*Ve[1],ot=1.001*Ve[1]-.001*Ve[0];for(he=0;he<1e5&&(We=ye.start+he*He,!(He>0?We>=Je:We<=Je));he++)We>st&&We<ot&&Be.push(We);if(Ht._fillgradient)Ge=[0];else if("function"==typeof Ht._fillcolor){var wt=Ht._filllevels;if(wt)for(Je=wt.end+wt.size/100,He=wt.size,he=0;he<1e5&&(We=wt.start+he*He,!(He>0?We>=Je:We<=Je));he++)We>Ve[0]&&We<Ve[1]&&Ge.push(We);else(Ge=Be.map(function(Ct){return Ct-ye.size/2})).push(Ge[Ge.length-1]+ye.size)}else Ht._fillcolor&&"string"==typeof Ht._fillcolor&&(Ge=[0]);return ye.size<0&&(Be.reverse(),Ge.reverse()),{line:Be,fill:Ge}}(0,E,se),Oe=we.fill,fe=we.line,ve=Math.round(W*("fraction"===K?R?re.w:re.h:1)),Ae=ve/(R?re.w:re.h),ke=Math.round(q*("fraction"===V?R?re.h:re.w:1)),Pe=ke/(R?re.h:re.w),Ne=Math.round(R?j*re.w+U:J*re.h+te),De={center:.5,right:1}[B]||0,ze={top:1,middle:.5}[N]||0,Me=R?j-De*Ae:J-ze*Ae,Se=R?J-ze*Pe:j-De*Pe,Ie=Math.round(R?re.h*(1-Se):re.w*Se);E._lenFrac=Pe,E._thickFrac=Ae,E._uFrac=Me,E._vFrac=Se;var Fe=E._axis=function(rr,Ht,Ve){var We=rr._fullLayout,he="v"===Ht.orientation,ye={type:"linear",range:Ve,tickmode:Ht.tickmode,nticks:Ht.nticks,tick0:Ht.tick0,dtick:Ht.dtick,tickvals:Ht.tickvals,ticktext:Ht.ticktext,ticks:Ht.ticks,ticklen:Ht.ticklen,tickwidth:Ht.tickwidth,tickcolor:Ht.tickcolor,showticklabels:Ht.showticklabels,ticklabelposition:Ht.ticklabelposition,ticklabeloverflow:Ht.ticklabeloverflow,ticklabelstep:Ht.ticklabelstep,tickfont:Ht.tickfont,tickangle:Ht.tickangle,tickformat:Ht.tickformat,exponentformat:Ht.exponentformat,minexponent:Ht.minexponent,separatethousands:Ht.separatethousands,showexponent:Ht.showexponent,showtickprefix:Ht.showtickprefix,tickprefix:Ht.tickprefix,showticksuffix:Ht.showticksuffix,ticksuffix:Ht.ticksuffix,title:Ht.title,showline:!0,anchor:"free",side:he?"right":"bottom",position:1},Be=he?"y":"x",Ge={type:"linear",_id:Be+Ht._id},Je={letter:Be,font:We.font,noHover:!0,noTickson:!0,noTicklabelmode:!0,calendar:We.calendar};function He(st,ot){return t.coerce(ye,Ge,o,st,ot)}return h(ye,Ge,He,Je,We),p(ye,Ge,He,Je),Ge}(z,E,se);Fe.position=Ae+(R?j+U/re.w:J+te/re.h);var Re=-1!==["top","bottom"].indexOf(de);if(R&&Re&&(Fe.title.side=de,Fe.titlex=j+U/re.w,Fe.titley=Se+("top"===oe.side?Pe-te/re.h:te/re.h)),R||Re||(Fe.title.side=de,Fe.titley=J+te/re.h,Fe.titlex=Se+U/re.w),le.color&&"auto"===E.tickmode){Fe.tickmode="linear",Fe.tick0=Te.start;var Xe=Te.size,nt=t.constrain(ke/50,4,15)+1,ct=(se[1]-se[0])/((E.nticks||nt)*Xe);if(ct>1){var xt=Math.pow(10,Math.floor(Math.log(ct)/Math.LN10));Xe*=xt*t.roundUp(ct/xt,[2,5,10]),(Math.abs(Te.start)/Te.size+1e-6)%1<2e-6&&(Fe.tick0=0)}Fe.dtick=Xe}Fe.domain=R?[Se+te/re.h,Se+Pe-te/re.h]:[Se+U/re.w,Se+Pe-U/re.w],Fe.setScale(),S.attr("transform",a(Math.round(re.l),Math.round(re.t)));var dt,tt=S.select("."+w.cbtitleunshift).attr("transform",a(-Math.round(re.l),-Math.round(re.t))),Ke=Fe.ticklabelposition,mt=Fe.title.font.size,Bt=S.select("."+w.cbaxis),Ut=0,er=0;function Wt(rr,Ht){var Ve={propContainer:Fe,propName:E._propPrefix+"title",traceIndex:E._traceIndex,_meta:E._meta,placeholder:X._dfltTitle.colorbar,containerGroup:S.select("."+w.cbtitle)},We="h"===rr.charAt(0)?rr.substr(1):"h"+rr;S.selectAll("."+We+",."+We+"-math-group").remove(),u.draw(z,rr,r(Ve,Ht||{}))}return t.syncOrAsync([m.previousPromises,function(){var rr,Ht;(R&&Re||!R&&!Re)&&("top"===de&&(rr=U+re.l+re.w*j,Ht=te+re.t+re.h*(1-Se-Pe)+3+.75*mt),"bottom"===de&&(rr=U+re.l+re.w*j,Ht=te+re.t+re.h*(1-Se)-3-.25*mt),"right"===de&&(Ht=te+re.t+re.h*J+3+.75*mt,rr=U+re.l+re.w*Se),Wt(Fe._id+"title",{attributes:{x:rr,y:Ht,"text-anchor":R?"start":"middle"}}))},function(){if(!R&&!Re||R&&Re){var rr,Ht=S.select("."+w.cbtitle),Ve=Ht.select("text"),We=[-G/2,G/2],he=Ht.select(".h"+Fe._id+"title-math-group").node(),ye=15.6;if(Ve.node()&&(ye=parseInt(Ve.node().style.fontSize,10)*l),he?(rr=s.bBox(he),er=rr.width,(Ut=rr.height)>ye&&(We[1]-=(Ut-ye)/2)):Ve.node()&&!Ve.classed(w.jsPlaceholder)&&(rr=s.bBox(Ve.node()),er=rr.width,Ut=rr.height),R){if(Ut){if(Ut+=5,"top"===de)Fe.domain[1]-=Ut/re.h,We[1]*=-1;else{Fe.domain[0]+=Ut/re.h;var Be=f.lineCount(Ve);We[1]+=(1-Be)*ye}Ht.attr("transform",a(We[0],We[1])),Fe.setScale()}}else er&&("right"===de&&(Fe.domain[0]+=(er+mt/2)/re.w),Ht.attr("transform",a(We[0],We[1])),Fe.setScale())}S.selectAll("."+w.cbfills+",."+w.cblines).attr("transform",R?a(0,Math.round(re.h*(1-Fe.domain[1]))):a(Math.round(re.w*Fe.domain[0]),0)),Bt.attr("transform",R?a(0,Math.round(-re.t)):a(Math.round(-re.l),0));var Ge=S.select("."+w.cbfills).selectAll("rect."+w.cbfill).attr("style","").data(Oe);Ge.enter().append("rect").classed(w.cbfill,!0).style("stroke","none"),Ge.exit().remove();var Je=se.map(Fe.c2p).map(Math.round).sort(function(Ct,rt){return Ct-rt});Ge.each(function(Ct,rt){var ft=[0===rt?se[0]:(Oe[rt]+Oe[rt-1])/2,rt===Oe.length-1?se[1]:(Oe[rt]+Oe[rt+1])/2].map(Fe.c2p).map(Math.round);R&&(ft[1]=t.constrain(ft[1]+(ft[1]>ft[0])?1:-1,Je[0],Je[1]));var Rt=g.select(this).attr(R?"x":"y",Ne).attr(R?"y":"x",g.min(ft)).attr(R?"width":"height",Math.max(ve,2)).attr(R?"height":"width",Math.max(g.max(ft)-g.min(ft),2));if(E._fillgradient)s.gradient(Rt,z,E._id,R?"vertical":"horizontalreversed",E._fillgradient,"fill");else{var kt=_e(Ct).replace("e-","");Rt.attr("fill",v(kt).toHexString())}});var He=S.select("."+w.cblines).selectAll("path."+w.cbline).data(le.color&&le.width?fe:[]);He.enter().append("path").classed(w.cbline,!0),He.exit().remove(),He.each(function(Ct){var rt=Ne,ft=Math.round(Fe.c2p(Ct))+le.width/2%1;g.select(this).attr("d","M"+(R?rt+","+ft:ft+","+rt)+(R?"h":"v")+ve).call(s.lineGroupStyle,le.width,ge(Ct),le.dash)}),Bt.selectAll("g."+Fe._id+"tick,path").remove();var st=Ne+ve+(G||0)/2-("outside"===E.ticks?1:0),ot=e.calcTicks(Fe),wt=e.getTickSigns(Fe)[2];return e.drawTicks(z,Fe,{vals:"inside"===Fe.ticks?e.clipEnds(Fe,ot):ot,layer:Bt,path:e.makeTickPath(Fe,st,wt),transFn:e.makeTransTickFn(Fe)}),e.drawLabels(z,Fe,{vals:ot,layer:Bt,transFn:e.makeTransTickLabelFn(Fe),labelFns:e.makeLabelFns(Fe,st)})},function(){if(R&&!Re||!R&&Re){var rr,Ht,Ve=Fe.position||0,We=Fe._offset+Fe._length/2;if("right"===de)Ht=We,rr=re.l+re.w*Ve+10+mt*(Fe.showticklabels?1:.5);else if(rr=We,"bottom"===de&&(Ht=re.t+re.h*Ve+10+(-1===Ke.indexOf("inside")?Fe.tickfont.size:0)+("intside"!==Fe.ticks&&E.ticklen||0)),"top"===de){var he=oe.text.split("<br>").length;Ht=re.t+re.h*Ve+10-ve-l*mt*he}Wt((R?"h":"v")+Fe._id+"title",{avoid:{selection:g.select(z).selectAll("g."+Fe._id+"tick"),side:de,offsetTop:R?0:re.t,offsetLeft:R?re.l:0,maxShift:R?X.width:X.height},attributes:{x:rr,y:Ht,"text-anchor":"middle"},transform:{rotate:R?-90:0,offset:0}})}},m.previousPromises,function(){var rr,Ht=ve+G/2;-1===Ke.indexOf("inside")&&(rr=s.bBox(Bt.node()),Ht+=R?rr.width:rr.height),dt=tt.select("text");var Ve=0,We=R&&"top"===de,he=!R&&"right"===de,ye=0;if(dt.node()&&!dt.classed(w.jsPlaceholder)){var Be,Ge=tt.select(".h"+Fe._id+"title-math-group").node();Ge&&(R&&Re||!R&&!Re)?(Ve=(rr=s.bBox(Ge)).width,Be=rr.height):(Ve=(rr=s.bBox(tt.node())).right-re.l-(R?Ne:Ie),Be=rr.bottom-re.t-(R?Ie:Ne),R||"top"!==de||(Ht+=rr.height,ye=rr.height)),he&&(dt.attr("transform",a(Ve/2+mt/2,0)),Ve*=2),Ht=Math.max(Ht,R?Ve:Be)}var Je=2*(R?U:te)+Ht+Y+G/2,He=0;!R&&oe.text&&"bottom"===N&&J<=0&&(Je+=He=Je/2,ye+=He),X._hColorbarMoveTitle=He,X._hColorbarMoveCBTitle=ye;var st=Y+G;S.select("."+w.cbbg).attr("x",(R?Ne:Ie)-st/2-(R?U:0)).attr("y",(R?Ie:Ne)-(R?ke:te+ye-He)).attr(R?"width":"height",Math.max(Je-He,2)).attr(R?"height":"width",Math.max(ke+st,2)).call(i.fill,$).call(i.stroke,E.bordercolor).style("stroke-width",Y);var ot=he?Math.max(Ve-10,0):0;if(S.selectAll("."+w.cboutline).attr("x",(R?Ne:Ie+U)+ot).attr("y",(R?Ie+te-ke:Ne)+(We?Ut:0)).attr(R?"width":"height",Math.max(ve,2)).attr(R?"height":"width",Math.max(ke-(R?2*te+Ut:2*U+ot),2)).call(i.stroke,E.outlinecolor).style({fill:"none","stroke-width":G}),S.attr("transform",a(re.l-(R?De*Je:0),re.t-(R?0:(1-ze)*Je-ye))),!R&&(Y||v($).getAlpha()&&!v.equals(X.paper_bgcolor,$))){var wt=Bt.selectAll("text"),Ct=wt[0].length,rt=S.select("."+w.cbbg).node(),ft=s.bBox(rt),Rt=s.getTranslate(S);wt.each(function(At,Ft){var Gt=Ct-1;if(0===Ft||Ft===Gt){var jt,fr=s.bBox(this),kr=s.getTranslate(this);Ft===Gt?(jt=ft.right+Rt.x+Ie-Y-2+j-(fr.right+kr.x))>0&&(jt=0):0===Ft&&(jt=ft.left+Rt.x+Ie+Y+2-(fr.left+kr.x))<0&&(jt=0),jt&&(Ct<3?this.setAttribute("transform","translate("+jt+",0) "+this.getAttribute("transform")):this.setAttribute("visibility","hidden"))}})}var kt={},Lt=T[B],Ee=_[B],Ye=T[N],it=_[N],ht=Je-ve;R?("pixels"===V?(kt.y=J,kt.t=ke*Ye,kt.b=ke*it):(kt.t=kt.b=0,kt.yt=J+q*Ye,kt.yb=J-q*it),"pixels"===K?(kt.x=j,kt.l=Je*Lt,kt.r=Je*Ee):(kt.l=ht*Lt,kt.r=ht*Ee,kt.xl=j-W*Lt,kt.xr=j+W*Ee)):("pixels"===V?(kt.x=j,kt.l=ke*Lt,kt.r=ke*Ee):(kt.l=kt.r=0,kt.xl=j+q*Lt,kt.xr=j-q*Ee),"pixels"===K?(kt.y=1-J,kt.t=Je*Ye,kt.b=Je*it):(kt.t=ht*Ye,kt.b=ht*it,kt.yt=J-W*Ye,kt.yb=J+W*it)),m.autoMargin(z,E._id,kt)}],z)}(I,M,k);P&&P.then&&(k._promises||[]).push(P),k._context.edits.colorbarPosition&&(W="v"===(E=M).orientation,K=(z=k)._fullLayout._size,n.init({element:(S=I).node(),gd:z,prepFn:function(){R=S.attr("transform"),d(S)},moveFn:function(G,Y){S.attr("transform",R+a(G,Y)),q=n.align((W?E._uFrac:E._vFrac)+G/K.w,W?E._thickFrac:E._lenFrac,0,1,E.xanchor),V=n.align((W?E._vFrac:1-E._uFrac)-Y/K.h,W?E._lenFrac:E._thickFrac,0,1,E.yanchor);var $=n.getCursor(q,V,E.xanchor,E.yanchor);d(S,$)},doneFn:function(){if(d(S),void 0!==q&&void 0!==V){var G={};G[E._propPrefix+"x"]=q,G[E._propPrefix+"y"]=V,void 0!==E._traceIndex?x.call("_guiRestyle",z,G,E._traceIndex):x.call("_guiRelayout",z,G)}}}))}),L.exit().each(function(M){m.autoMargin(k,M._id)}).remove(),L.order()}}},{"../../constants/alignment":483,"../../lib":515,"../../lib/extend":505,"../../lib/setcursor":536,"../../lib/svg_text_utils":541,"../../plots/cartesian/axes":566,"../../plots/cartesian/axis_defaults":568,"../../plots/cartesian/layout_attributes":579,"../../plots/cartesian/position_defaults":582,"../../plots/plots":628,"../../registry":647,"../color":367,"../colorscale/helpers":378,"../dragelement":386,"../drawing":389,"../titles":476,"./constants":369,"@plotly/d3":58,tinycolor2:313}],372:[function(y,ee,Q){"use strict";var g=y("../../lib");ee.exports=function(v){return g.isPlainObject(v.colorbar)}},{"../../lib":515}],373:[function(y,ee,Q){"use strict";ee.exports={moduleType:"component",name:"colorbar",attributes:y("./attributes"),supplyDefaults:y("./defaults"),draw:y("./draw").draw,hasColorbar:y("./has_colorbar")}},{"./attributes":368,"./defaults":370,"./draw":371,"./has_colorbar":372}],374:[function(y,ee,Q){"use strict";var g=y("../colorbar/attributes"),v=y("../../lib/regex").counter,m=y("../../lib/sort_object_keys"),x=y("./scales.js").scales;function e(n){return"`"+n+"`"}m(x),ee.exports=function(n,t){n=n||"";var a,r=(t=t||{}).cLetter||"c",d=("onlyIfNumerical"in t||Boolean(n),"noScale"in t?t.noScale:"marker.line"===n),s="showScaleDflt"in t?t.showScaleDflt:"z"===r,i="string"==typeof t.colorscaleDflt?x[t.colorscaleDflt]:null,u=t.editTypeOverride||"",f=n?n+".":"";"colorAttr"in t?a=t.colorAttr:e(f+(a={z:"z",c:"color"}[r]));var c=r+"auto",h=r+"min",p=r+"max",o=r+"mid",b=(e(f+c),e(f+h),e(f+p),{});b[h]=b[p]=void 0;var l={};l[c]=!1;var T={};return"color"===a&&(T.color={valType:"color",arrayOk:!0,editType:u||"style"},t.anim&&(T.color.anim=!0)),T[c]={valType:"boolean",dflt:!0,editType:"calc",impliedEdits:b},T[h]={valType:"number",dflt:null,editType:u||"plot",impliedEdits:l},T[p]={valType:"number",dflt:null,editType:u||"plot",impliedEdits:l},T[o]={valType:"number",dflt:null,editType:"calc",impliedEdits:b},T.colorscale={valType:"colorscale",editType:"calc",dflt:i,impliedEdits:{autocolorscale:!1}},T.autocolorscale={valType:"boolean",dflt:!1!==t.autoColorDflt,editType:"calc",impliedEdits:{colorscale:void 0}},T.reversescale={valType:"boolean",dflt:!1,editType:"plot"},d||(T.showscale={valType:"boolean",dflt:s,editType:"calc"},T.colorbar=g),t.noColorAxis||(T.coloraxis={valType:"subplotid",regex:v("coloraxis"),dflt:null,editType:"calc"}),T}},{"../../lib/regex":532,"../../lib/sort_object_keys":538,"../colorbar/attributes":368,"./scales.js":382}],375:[function(y,ee,Q){"use strict";var g=y("fast-isnumeric"),v=y("../../lib"),m=y("./helpers").extractOpts;ee.exports=function(x,e,n){var a=x._fullLayout,r=n.vals,d=n.containerStr,s=d?v.nestedProperty(e,d).get():e,i=m(s),u=!1!==i.auto,f=i.min,c=i.max,h=i.mid,p=function(){return v.aggNums(Math.min,null,r)},o=function(){return v.aggNums(Math.max,null,r)};void 0===f?f=p():u&&(f=s._colorAx&&g(f)?Math.min(f,p()):p()),void 0===c?c=o():u&&(c=s._colorAx&&g(c)?Math.max(c,o()):o()),u&&void 0!==h&&(c-h>h-f?f=h-(c-h):c-h<h-f&&(c=h+(h-f))),f===c&&(f-=.5,c+=.5),i._sync("min",f),i._sync("max",c),i.autocolorscale&&i._sync("colorscale",f*c<0?a.colorscale.diverging:f>=0?a.colorscale.sequential:a.colorscale.sequentialminus)}},{"../../lib":515,"./helpers":378,"fast-isnumeric":190}],376:[function(y,ee,Q){"use strict";var g=y("../../lib"),v=y("./helpers").hasColorscale,m=y("./helpers").extractOpts;ee.exports=function(x,e){function n(u,f){var c=u["_"+f];void 0!==c&&(u[f]=c)}function t(u,f){var c=f.container?g.nestedProperty(u,f.container).get():u;if(c)if(c.coloraxis)c._colorAx=e[c.coloraxis];else{var h=m(c),p=h.auto;(p||void 0===h.min)&&n(c,f.min),(p||void 0===h.max)&&n(c,f.max),h.autocolorscale&&n(c,"colorscale")}}for(var a=0;a<x.length;a++){var r=x[a],d=r._module.colorbar;if(d)if(Array.isArray(d))for(var s=0;s<d.length;s++)t(r,d[s]);else t(r,d);v(r,"marker.line")&&t(r,{container:"marker.line",min:"cmin",max:"cmax"})}for(var i in e._colorAxes)t(e[i],{min:"cmin",max:"cmax"})}},{"../../lib":515,"./helpers":378}],377:[function(y,ee,Q){"use strict";var g=y("fast-isnumeric"),v=y("../../lib"),m=y("../colorbar/has_colorbar"),x=y("../colorbar/defaults"),e=y("./scales").isValid,n=y("../../registry").traceIs;function t(a,r){var d=r.slice(0,r.length-1);return r?v.nestedProperty(a,d).get()||{}:a}ee.exports=function a(r,d,s,i,u){var f=u.prefix,c=u.cLetter,h="_module"in d,p=t(r,f),o=t(d,f),b=t(d._template||{},f)||{},l=function(){return delete r.coloraxis,delete d.coloraxis,a(r,d,s,i,u)};if(h){var T=s._colorAxes||{},_=i(f+"coloraxis");if(_){var w=n(d,"contour")&&v.nestedProperty(d,"contours.coloring").get()||"heatmap",k=T[_];return void(k?(k[2].push(l),k[0]!==w&&(k[0]=!1,v.warn(["Ignoring coloraxis:",_,"setting","as it is linked to incompatible colorscales."].join(" ")))):T[_]=[w,d,[l]])}}var L=p[c+"min"],M=p[c+"max"],I=g(L)&&g(M)&&L<M;i(f+c+"auto",!I)?i(f+c+"mid"):(i(f+c+"min"),i(f+c+"max"));var P,S,E=p.colorscale,z=b.colorscale;void 0!==E&&(P=!e(E)),void 0!==z&&(P=!e(z)),i(f+"autocolorscale",P),i(f+"colorscale"),i(f+"reversescale"),"marker.line."!==f&&(f&&h&&(S=m(p)),i(f+"showscale",S)&&(f&&b&&(o._template=b),x(p,o,s)))}},{"../../lib":515,"../../registry":647,"../colorbar/defaults":370,"../colorbar/has_colorbar":372,"./scales":382,"fast-isnumeric":190}],378:[function(y,ee,Q){"use strict";var g=y("@plotly/d3"),v=y("tinycolor2"),m=y("fast-isnumeric"),x=y("../../lib"),e=y("../color"),n=y("./scales").isValid,t=["showscale","autocolorscale","colorscale","reversescale","colorbar"],a=["min","max","mid","auto"];function r(f){var c,h,p,o=f._colorAx,b=o||f,l={};for(h=0;h<t.length;h++)l[p=t[h]]=b[p];if(o)for(c="c",h=0;h<a.length;h++)l[p=a[h]]=b["c"+p];else{var T;for(h=0;h<a.length;h++)((T="c"+(p=a[h]))in b||(T="z"+p)in b)&&(l[p]=b[T]);c=T.charAt(0)}return l._sync=function(_,w){var k=-1!==a.indexOf(_)?c+_:_;b[k]=b["_"+k]=w},l}function d(f){for(var c=r(f),h=c.min,p=c.max,o=c.reversescale?s(c.colorscale):c.colorscale,b=o.length,l=new Array(b),T=new Array(b),_=0;_<b;_++){var w=o[_];l[_]=h+w[0]*(p-h),T[_]=w[1]}return{domain:l,range:T}}function s(f){for(var c=f.length,h=new Array(c),p=c-1,o=0;p>=0;p--,o++){var b=f[p];h[o]=[1-b[0],b[1]]}return h}function i(f,c){c=c||{};for(var h=f.domain,p=f.range,o=p.length,b=new Array(o),l=0;l<o;l++){var T=v(p[l]).toRgb();b[l]=[T.r,T.g,T.b,T.a]}var _,w=g.scale.linear().domain(h).range(b).clamp(!0),k=c.noNumericCheck,L=c.returnArray;return(_=k&&L?w:k?function(M){return u(w(M))}:L?function(M){return m(M)?w(M):v(M).isValid()?M:e.defaultLine}:function(M){return m(M)?u(w(M)):v(M).isValid()?M:e.defaultLine}).domain=w.domain,_.range=function(){return p},_}function u(f){return v({r:f[0],g:f[1],b:f[2],a:f[3]}).toRgbString()}ee.exports={hasColorscale:function(f,c,h){var p=c?x.nestedProperty(f,c).get()||{}:f,o=p[h||"color"],b=!1;if(x.isArrayOrTypedArray(o))for(var l=0;l<o.length;l++)if(m(o[l])){b=!0;break}return x.isPlainObject(p)&&(b||!0===p.showscale||m(p.cmin)&&m(p.cmax)||n(p.colorscale)||x.isPlainObject(p.colorbar))},extractOpts:r,extractScale:d,flipScale:s,makeColorScaleFunc:i,makeColorScaleFuncFromTrace:function(f,c){return i(d(f),c)}}},{"../../lib":515,"../color":367,"./scales":382,"@plotly/d3":58,"fast-isnumeric":190,tinycolor2:313}],379:[function(y,ee,Q){"use strict";var g=y("./scales"),v=y("./helpers");ee.exports={moduleType:"component",name:"colorscale",attributes:y("./attributes"),layoutAttributes:y("./layout_attributes"),supplyLayoutDefaults:y("./layout_defaults"),handleDefaults:y("./defaults"),crossTraceDefaults:y("./cross_trace_defaults"),calc:y("./calc"),scales:g.scales,defaultScale:g.defaultScale,getScale:g.get,isValidScale:g.isValid,hasColorscale:v.hasColorscale,extractOpts:v.extractOpts,extractScale:v.extractScale,flipScale:v.flipScale,makeColorScaleFunc:v.makeColorScaleFunc,makeColorScaleFuncFromTrace:v.makeColorScaleFuncFromTrace}},{"./attributes":374,"./calc":375,"./cross_trace_defaults":376,"./defaults":377,"./helpers":378,"./layout_attributes":380,"./layout_defaults":381,"./scales":382}],380:[function(y,ee,Q){"use strict";var g=y("../../lib/extend").extendFlat,v=y("./attributes"),m=y("./scales").scales;ee.exports={editType:"calc",colorscale:{editType:"calc",sequential:{valType:"colorscale",dflt:m.Reds,editType:"calc"},sequentialminus:{valType:"colorscale",dflt:m.Blues,editType:"calc"},diverging:{valType:"colorscale",dflt:m.RdBu,editType:"calc"}},coloraxis:g({_isSubplotObj:!0,editType:"calc"},v("",{colorAttr:"corresponding trace color array(s)",noColorAxis:!0,showScaleDflt:!0}))}},{"../../lib/extend":505,"./attributes":374,"./scales":382}],381:[function(y,ee,Q){"use strict";var g=y("../../lib"),v=y("../../plot_api/plot_template"),m=y("./layout_attributes"),x=y("./defaults");ee.exports=function(e,n){function t(c,h){return g.coerce(e,n,m,c,h)}t("colorscale.sequential"),t("colorscale.sequentialminus"),t("colorscale.diverging");var a,r,d=n._colorAxes;function s(c,h){return g.coerce(a,r,m.coloraxis,c,h)}for(var i in d){var u=d[i];if(u[0])a=e[i]||{},(r=v.newContainer(n,i,"coloraxis"))._name=i,x(a,r,n,s,{prefix:"",cLetter:"c"});else{for(var f=0;f<u[2].length;f++)u[2][f]();delete n._colorAxes[i]}}}},{"../../lib":515,"../../plot_api/plot_template":555,"./defaults":377,"./layout_attributes":380}],382:[function(y,ee,Q){"use strict";var g=y("tinycolor2"),v={Greys:[[0,"rgb(0,0,0)"],[1,"rgb(255,255,255)"]],YlGnBu:[[0,"rgb(8,29,88)"],[.125,"rgb(37,52,148)"],[.25,"rgb(34,94,168)"],[.375,"rgb(29,145,192)"],[.5,"rgb(65,182,196)"],[.625,"rgb(127,205,187)"],[.75,"rgb(199,233,180)"],[.875,"rgb(237,248,217)"],[1,"rgb(255,255,217)"]],Greens:[[0,"rgb(0,68,27)"],[.125,"rgb(0,109,44)"],[.25,"rgb(35,139,69)"],[.375,"rgb(65,171,93)"],[.5,"rgb(116,196,118)"],[.625,"rgb(161,217,155)"],[.75,"rgb(199,233,192)"],[.875,"rgb(229,245,224)"],[1,"rgb(247,252,245)"]],YlOrRd:[[0,"rgb(128,0,38)"],[.125,"rgb(189,0,38)"],[.25,"rgb(227,26,28)"],[.375,"rgb(252,78,42)"],[.5,"rgb(253,141,60)"],[.625,"rgb(254,178,76)"],[.75,"rgb(254,217,118)"],[.875,"rgb(255,237,160)"],[1,"rgb(255,255,204)"]],Bluered:[[0,"rgb(0,0,255)"],[1,"rgb(255,0,0)"]],RdBu:[[0,"rgb(5,10,172)"],[.35,"rgb(106,137,247)"],[.5,"rgb(190,190,190)"],[.6,"rgb(220,170,132)"],[.7,"rgb(230,145,90)"],[1,"rgb(178,10,28)"]],Reds:[[0,"rgb(220,220,220)"],[.2,"rgb(245,195,157)"],[.4,"rgb(245,160,105)"],[1,"rgb(178,10,28)"]],Blues:[[0,"rgb(5,10,172)"],[.35,"rgb(40,60,190)"],[.5,"rgb(70,100,245)"],[.6,"rgb(90,120,245)"],[.7,"rgb(106,137,247)"],[1,"rgb(220,220,220)"]],Picnic:[[0,"rgb(0,0,255)"],[.1,"rgb(51,153,255)"],[.2,"rgb(102,204,255)"],[.3,"rgb(153,204,255)"],[.4,"rgb(204,204,255)"],[.5,"rgb(255,255,255)"],[.6,"rgb(255,204,255)"],[.7,"rgb(255,153,255)"],[.8,"rgb(255,102,204)"],[.9,"rgb(255,102,102)"],[1,"rgb(255,0,0)"]],Rainbow:[[0,"rgb(150,0,90)"],[.125,"rgb(0,0,200)"],[.25,"rgb(0,25,255)"],[.375,"rgb(0,152,255)"],[.5,"rgb(44,255,150)"],[.625,"rgb(151,255,0)"],[.75,"rgb(255,234,0)"],[.875,"rgb(255,111,0)"],[1,"rgb(255,0,0)"]],Portland:[[0,"rgb(12,51,131)"],[.25,"rgb(10,136,186)"],[.5,"rgb(242,211,56)"],[.75,"rgb(242,143,56)"],[1,"rgb(217,30,30)"]],Jet:[[0,"rgb(0,0,131)"],[.125,"rgb(0,60,170)"],[.375,"rgb(5,255,255)"],[.625,"rgb(255,255,0)"],[.875,"rgb(250,0,0)"],[1,"rgb(128,0,0)"]],Hot:[[0,"rgb(0,0,0)"],[.3,"rgb(230,0,0)"],[.6,"rgb(255,210,0)"],[1,"rgb(255,255,255)"]],Blackbody:[[0,"rgb(0,0,0)"],[.2,"rgb(230,0,0)"],[.4,"rgb(230,210,0)"],[.7,"rgb(255,255,255)"],[1,"rgb(160,200,255)"]],Earth:[[0,"rgb(0,0,130)"],[.1,"rgb(0,180,180)"],[.2,"rgb(40,210,40)"],[.4,"rgb(230,230,50)"],[.6,"rgb(120,70,20)"],[1,"rgb(255,255,255)"]],Electric:[[0,"rgb(0,0,0)"],[.15,"rgb(30,0,100)"],[.4,"rgb(120,0,100)"],[.6,"rgb(160,90,0)"],[.8,"rgb(230,200,0)"],[1,"rgb(255,250,220)"]],Viridis:[[0,"#440154"],[.06274509803921569,"#48186a"],[.12549019607843137,"#472d7b"],[.18823529411764706,"#424086"],[.25098039215686274,"#3b528b"],[.3137254901960784,"#33638d"],[.3764705882352941,"#2c728e"],[.4392156862745098,"#26828e"],[.5019607843137255,"#21918c"],[.5647058823529412,"#1fa088"],[.6274509803921569,"#28ae80"],[.6901960784313725,"#3fbc73"],[.7529411764705882,"#5ec962"],[.8156862745098039,"#84d44b"],[.8784313725490196,"#addc30"],[.9411764705882353,"#d8e219"],[1,"#fde725"]],Cividis:[[0,"rgb(0,32,76)"],[.058824,"rgb(0,42,102)"],[.117647,"rgb(0,52,110)"],[.176471,"rgb(39,63,108)"],[.235294,"rgb(60,74,107)"],[.294118,"rgb(76,85,107)"],[.352941,"rgb(91,95,109)"],[.411765,"rgb(104,106,112)"],[.470588,"rgb(117,117,117)"],[.529412,"rgb(131,129,120)"],[.588235,"rgb(146,140,120)"],[.647059,"rgb(161,152,118)"],[.705882,"rgb(176,165,114)"],[.764706,"rgb(192,177,109)"],[.823529,"rgb(209,191,102)"],[.882353,"rgb(225,204,92)"],[.941176,"rgb(243,219,79)"],[1,"rgb(255,233,69)"]]},m=v.RdBu;function x(e){var n=0;if(!Array.isArray(e)||e.length<2||!e[0]||!e[e.length-1]||0!=+e[0][0]||1!=+e[e.length-1][0])return!1;for(var t=0;t<e.length;t++){var a=e[t];if(2!==a.length||+a[0]<n||!g(a[1]).isValid())return!1;n=+a[0]}return!0}ee.exports={scales:v,defaultScale:m,get:function(e,n){if(n||(n=m),!e)return n;function t(){try{e=v[e]||JSON.parse(e)}catch{e=n}}return"string"==typeof e&&(t(),"string"==typeof e&&t()),x(e)?e:n},isValid:function(e){return void 0!==v[e]||x(e)}}},{tinycolor2:313}],383:[function(y,ee,Q){"use strict";ee.exports=function(g,v,m,x,e){var n=(g-m)/(x-m),t=n+v/(x-m),a=(n+t)/2;return"left"===e||"bottom"===e?n:"center"===e||"middle"===e?a:"right"===e||"top"===e?t:n<2/3-a?n:t>4/3-a?t:a}},{}],384:[function(y,ee,Q){"use strict";var g=y("../../lib"),v=[["sw-resize","s-resize","se-resize"],["w-resize","move","e-resize"],["nw-resize","n-resize","ne-resize"]];ee.exports=function(m,x,e,n){return m="left"===e?0:"center"===e?1:"right"===e?2:g.constrain(Math.floor(3*m),0,2),x="bottom"===n?0:"middle"===n?1:"top"===n?2:g.constrain(Math.floor(3*x),0,2),v[x][m]}},{"../../lib":515}],385:[function(y,ee,Q){"use strict";Q.selectMode=function(g){return"lasso"===g||"select"===g},Q.drawMode=function(g){return"drawclosedpath"===g||"drawopenpath"===g||"drawline"===g||"drawrect"===g||"drawcircle"===g},Q.openMode=function(g){return"drawline"===g||"drawopenpath"===g},Q.rectMode=function(g){return"select"===g||"drawline"===g||"drawrect"===g||"drawcircle"===g},Q.freeMode=function(g){return"lasso"===g||"drawclosedpath"===g||"drawopenpath"===g},Q.selectingOrDrawing=function(g){return Q.freeMode(g)||Q.rectMode(g)}},{}],386:[function(y,ee,Q){"use strict";var g=y("mouse-event-offset"),v=y("has-hover"),m=y("has-passive-events"),x=y("../../lib").removeElement,e=y("../../plots/cartesian/constants"),n=ee.exports={};n.align=y("./align"),n.getCursor=y("./cursor");var t=y("./unhover");function a(){var d=document.createElement("div");d.className="dragcover";var s=d.style;return s.position="fixed",s.left=0,s.right=0,s.top=0,s.bottom=0,s.zIndex=999999999,s.background="none",document.body.appendChild(d),d}function r(d){return g(d.changedTouches?d.changedTouches[0]:d,document.body)}n.unhover=t.wrapped,n.unhoverRaw=t.raw,n.init=function(d){var s,i,u,f,c,h,p,o,b=d.gd,l=1,T=b._context.doubleClickDelay,_=d.element;b._mouseDownTime||(b._mouseDownTime=0),_.style.pointerEvents="all",_.onmousedown=k,m?(_._ontouchstart&&_.removeEventListener("touchstart",_._ontouchstart),_._ontouchstart=k,_.addEventListener("touchstart",k,{passive:!1})):_.ontouchstart=k;var w=d.clampFn||function(I,P,S){return Math.abs(I)<S&&(I=0),Math.abs(P)<S&&(P=0),[I,P]};function k(I){b._dragged=!1,b._dragging=!0;var P=r(I);s=P[0],i=P[1],p=I.target,h=I,o=2===I.buttons||I.ctrlKey,void 0===I.clientX&&void 0===I.clientY&&(I.clientX=s,I.clientY=i),(u=(new Date).getTime())-b._mouseDownTime<T?l+=1:(l=1,b._mouseDownTime=u),d.prepFn&&d.prepFn(I,s,i),v&&!o?(c=a()).style.cursor=window.getComputedStyle(_).cursor:v||(c=document,f=window.getComputedStyle(document.documentElement).cursor,document.documentElement.style.cursor=window.getComputedStyle(_).cursor),document.addEventListener("mouseup",M),document.addEventListener("touchend",M),!1!==d.dragmode&&(I.preventDefault(),document.addEventListener("mousemove",L),document.addEventListener("touchmove",L,{passive:!1}))}function L(I){I.preventDefault();var P=r(I),E=w(P[0]-s,P[1]-i,d.minDrag||e.MINDRAG),z=E[0],R=E[1];(z||R)&&(b._dragged=!0,n.unhover(b,I)),b._dragged&&d.moveFn&&!o&&(b._dragdata={element:_,dx:z,dy:R},d.moveFn(z,R))}function M(I){if(delete b._dragdata,!1!==d.dragmode&&(I.preventDefault(),document.removeEventListener("mousemove",L),document.removeEventListener("touchmove",L)),document.removeEventListener("mouseup",M),document.removeEventListener("touchend",M),v?x(c):f&&(c.documentElement.style.cursor=f,f=null),b._dragging){if(b._dragging=!1,(new Date).getTime()-b._mouseDownTime>T&&(l=Math.max(l-1,1)),b._dragged)d.doneFn&&d.doneFn();else if(d.clickFn&&d.clickFn(l,h),!o){var P;try{P=new MouseEvent("click",I)}catch{var S=r(I);(P=document.createEvent("MouseEvents")).initMouseEvent("click",I.bubbles,I.cancelable,I.view,I.detail,I.screenX,I.screenY,S[0],S[1],I.ctrlKey,I.altKey,I.shiftKey,I.metaKey,I.button,I.relatedTarget)}p.dispatchEvent(P)}b._dragging=!1,b._dragged=!1}else b._dragged=!1}},n.coverSlip=a},{"../../lib":515,"../../plots/cartesian/constants":573,"./align":383,"./cursor":384,"./unhover":387,"has-hover":228,"has-passive-events":229,"mouse-event-offset":242}],387:[function(y,ee,Q){"use strict";var g=y("../../lib/events"),v=y("../../lib/throttle"),m=y("../../lib/dom").getGraphDiv,x=y("../fx/constants"),e=ee.exports={};e.wrapped=function(n,t,a){(n=m(n))._fullLayout&&v.clear(n._fullLayout._uid+x.HOVERID),e.raw(n,t,a)},e.raw=function(n,t){var a=n._fullLayout,r=n._hoverdata;t||(t={}),t.target&&!n._dragged&&!1===g.triggerHandler(n,"plotly_beforehover",t)||(a._hoverlayer.selectAll("g").remove(),a._hoverlayer.selectAll("line").remove(),a._hoverlayer.selectAll("circle").remove(),n._hoverdata=void 0,t.target&&r&&n.emit("plotly_unhover",{event:t,points:r}))}},{"../../lib/dom":503,"../../lib/events":504,"../../lib/throttle":542,"../fx/constants":401}],388:[function(y,ee,Q){"use strict";Q.dash={valType:"string",values:["solid","dot","dash","longdash","dashdot","longdashdot"],dflt:"solid",editType:"style"},Q.pattern={shape:{valType:"enumerated",values:["","/","\\","x","-","|","+","."],dflt:"",arrayOk:!0,editType:"style"},fillmode:{valType:"enumerated",values:["replace","overlay"],dflt:"replace",editType:"style"},bgcolor:{valType:"color",arrayOk:!0,editType:"style"},fgcolor:{valType:"color",arrayOk:!0,editType:"style"},fgopacity:{valType:"number",editType:"style",min:0,max:1},size:{valType:"number",min:0,dflt:8,arrayOk:!0,editType:"style"},solidity:{valType:"number",min:0,max:1,dflt:.3,arrayOk:!0,editType:"style"},editType:"style"}},{}],389:[function(y,ee,Q){"use strict";var g=y("@plotly/d3"),v=y("../../lib"),m=v.numberFormat,x=y("fast-isnumeric"),e=y("tinycolor2"),n=y("../../registry"),t=y("../color"),a=y("../colorscale"),r=v.strTranslate,d=y("../../lib/svg_text_utils"),s=y("../../constants/xmlns_namespaces"),i=y("../../constants/alignment").LINE_SPACING,u=y("../../constants/interactions").DESELECTDIM,f=y("../../traces/scatter/subtypes"),c=y("../../traces/scatter/make_bubble_size_func"),h=y("../../components/fx/helpers").appendArrayPointValue,p=ee.exports={};function o(G,Y,$){var B=Y.fillpattern,N=B&&p.getPatternAttr(B.shape,0,"");if(N){var U=p.getPatternAttr(B.bgcolor,0,null),te=p.getPatternAttr(B.fgcolor,0,null),j=B.fgopacity,J=p.getPatternAttr(B.size,0,8),X=p.getPatternAttr(B.solidity,0,.3);p.pattern(G,"point",$,Y.uid,N,J,X,void 0,B.fillmode,U,te,j)}else Y.fillcolor&&G.call(t.fill,Y.fillcolor)}p.font=function(G,Y,$,B){v.isPlainObject(Y)&&(B=Y.color,$=Y.size,Y=Y.family),Y&&G.style("font-family",Y),$+1&&G.style("font-size",$+"px"),B&&G.call(t.fill,B)},p.setPosition=function(G,Y,$){G.attr("x",Y).attr("y",$)},p.setSize=function(G,Y,$){G.attr("width",Y).attr("height",$)},p.setRect=function(G,Y,$,B,N){G.call(p.setPosition,Y,$).call(p.setSize,B,N)},p.translatePoint=function(G,Y,$,B){var N=$.c2p(G.x),U=B.c2p(G.y);return!!(x(N)&&x(U)&&Y.node())&&("text"===Y.node().nodeName?Y.attr("x",N).attr("y",U):Y.attr("transform",r(N,U)),!0)},p.translatePoints=function(G,Y,$){G.each(function(B){var N=g.select(this);p.translatePoint(B,N,Y,$)})},p.hideOutsideRangePoint=function(G,Y,$,B,N,U){Y.attr("display",$.isPtWithinRange(G,N)&&B.isPtWithinRange(G,U)?null:"none")},p.hideOutsideRangePoints=function(G,Y){if(Y._hasClipOnAxisFalse){var $=Y.xaxis,B=Y.yaxis;G.each(function(N){var U=N[0].trace,te=U.xcalendar,j=U.ycalendar,J=n.traceIs(U,"bar-like")?".bartext":".point,.textpoint";G.selectAll(J).each(function(X){p.hideOutsideRangePoint(X,g.select(this),$,B,te,j)})})}},p.crispRound=function(G,Y,$){return Y&&x(Y)?G._context.staticPlot?Y:Y<1?1:Math.round(Y):$||0},p.singleLineStyle=function(G,Y,$,B,N){Y.style("fill","none");var U=(((G||[])[0]||{}).trace||{}).line||{},te=$||U.width||0,j=N||U.dash||"";t.stroke(Y,B||U.color),p.dashLine(Y,j,te)},p.lineGroupStyle=function(G,Y,$,B){G.style("fill","none").each(function(N){var U=(((N||[])[0]||{}).trace||{}).line||{},te=Y||U.width||0,j=B||U.dash||"";g.select(this).call(t.stroke,$||U.color).call(p.dashLine,j,te)})},p.dashLine=function(G,Y,$){Y=p.dashStyle(Y,$=+$||0),G.style({"stroke-dasharray":Y,"stroke-width":$+"px"})},p.dashStyle=function(G,Y){Y=+Y||1;var $=Math.max(Y,3);return"solid"===G?G="":"dot"===G?G=$+"px,"+$+"px":"dash"===G?G=3*$+"px,"+3*$+"px":"longdash"===G?G=5*$+"px,"+5*$+"px":"dashdot"===G?G=3*$+"px,"+$+"px,"+$+"px,"+$+"px":"longdashdot"===G&&(G=5*$+"px,"+2*$+"px,"+$+"px,"+2*$+"px"),G},p.singleFillStyle=function(G,Y){var $=g.select(G.node());o(G,(($.data()[0]||[])[0]||{}).trace||{},Y)},p.fillGroupStyle=function(G,Y){G.style("stroke-width",0).each(function($){var B=g.select(this);$[0].trace&&o(B,$[0].trace,Y)})};var b=y("./symbol_defs");p.symbolNames=[],p.symbolFuncs=[],p.symbolNeedLines={},p.symbolNoDot={},p.symbolNoFill={},p.symbolList=[],Object.keys(b).forEach(function(G){var Y=b[G],$=Y.n;p.symbolList.push($,String($),G,$+100,String($+100),G+"-open"),p.symbolNames[$]=G,p.symbolFuncs[$]=Y.f,Y.needLine&&(p.symbolNeedLines[$]=!0),Y.noDot?p.symbolNoDot[$]=!0:p.symbolList.push($+200,String($+200),G+"-dot",$+300,String($+300),G+"-open-dot"),Y.noFill&&(p.symbolNoFill[$]=!0)});var l=p.symbolNames.length;function T(G,Y){return p.symbolFuncs[G%100](Y)+(G>=200?"M0,0.5L0.5,0L0,-0.5L-0.5,0Z":"")}p.symbolNumber=function(G){if(x(G))G=+G;else if("string"==typeof G){var Y=0;G.indexOf("-open")>0&&(Y=100,G=G.replace("-open","")),G.indexOf("-dot")>0&&(Y+=200,G=G.replace("-dot","")),(G=p.symbolNames.indexOf(G))>=0&&(G+=Y)}return G%100>=l||G>=400?0:Math.floor(Math.max(G,0))};var _={x1:1,x2:0,y1:0,y2:0},w={x1:0,x2:0,y1:1,y2:0},k=m("~f"),L={radial:{node:"radialGradient"},radialreversed:{node:"radialGradient",reversed:!0},horizontal:{node:"linearGradient",attrs:_},horizontalreversed:{node:"linearGradient",attrs:_,reversed:!0},vertical:{node:"linearGradient",attrs:w},verticalreversed:{node:"linearGradient",attrs:w,reversed:!0}};p.gradient=function(G,Y,$,B,N,U){for(var te=N.length,j=L[B],J=new Array(te),X=0;X<te;X++)j.reversed?J[te-1-X]=[k(100*(1-N[X][0])),N[X][1]]:J[X]=[k(100*N[X][0]),N[X][1]];var re=Y._fullLayout,ne="g"+re._uid+"-"+$,le=re._defs.select(".gradients").selectAll("#"+ne).data([B+J.join(";")],v.identity);le.exit().remove(),le.enter().append(j.node).each(function(){var oe=g.select(this);j.attrs&&oe.attr(j.attrs),oe.attr("id",ne);var de=oe.selectAll("stop").data(J);de.exit().remove(),de.enter().append("stop"),de.each(function(se){var ge=e(se[1]);g.select(this).attr({offset:se[0]+"%","stop-color":t.tinyRGB(ge),"stop-opacity":ge.getAlpha()})})}),G.style(U,V(ne,Y)).style(U+"-opacity",null),G.classed("gradient_filled",!0)},p.pattern=function(G,Y,$,B,N,U,te,j,J,X,re,ne){var le="legend"===Y;j&&("overlay"===J?re=t.contrast(X=j):(X=void 0,re=j));var oe,de,se,ge,_e,Te,we,Oe,ve,ke=$._fullLayout,Pe="p"+ke._uid+"-"+B,Ne={};switch(N){case"/":oe=U*Math.sqrt(2),de=U*Math.sqrt(2),Te="path",Ne={d:se="M-"+oe/4+","+de/4+"l"+oe/2+",-"+de/2+"M0,"+de+"L"+oe+",0M"+oe/4*3+","+de/4*5+"l"+oe/2+",-"+de/2,opacity:ne,stroke:re,"stroke-width":(ge=te*U)+"px"};break;case"\\":oe=U*Math.sqrt(2),de=U*Math.sqrt(2),Te="path",Ne={d:se="M"+oe/4*3+",-"+de/4+"l"+oe/2+","+de/2+"M0,0L"+oe+","+de+"M-"+oe/4+","+de/4*3+"l"+oe/2+","+de/2,opacity:ne,stroke:re,"stroke-width":(ge=te*U)+"px"};break;case"x":oe=U*Math.sqrt(2),de=U*Math.sqrt(2),se="M-"+oe/4+","+de/4+"l"+oe/2+",-"+de/2+"M0,"+de+"L"+oe+",0M"+oe/4*3+","+de/4*5+"l"+oe/2+",-"+de/2+"M"+oe/4*3+",-"+de/4+"l"+oe/2+","+de/2+"M0,0L"+oe+","+de+"M-"+oe/4+","+de/4*3+"l"+oe/2+","+de/2,ge=U-U*Math.sqrt(1-te),Te="path",Ne={d:se,opacity:ne,stroke:re,"stroke-width":ge+"px"};break;case"|":Te="path",Te="path",Ne={d:se="M"+(oe=U)/2+",0L"+oe/2+","+(de=U),opacity:ne,stroke:re,"stroke-width":(ge=te*U)+"px"};break;case"-":Te="path",Te="path",Ne={d:se="M0,"+(de=U)/2+"L"+(oe=U)+","+de/2,opacity:ne,stroke:re,"stroke-width":(ge=te*U)+"px"};break;case"+":Te="path",se="M"+(oe=U)/2+",0L"+oe/2+","+(de=U)+"M0,"+de/2+"L"+oe+","+de/2,ge=U-U*Math.sqrt(1-te),Te="path",Ne={d:se,opacity:ne,stroke:re,"stroke-width":ge+"px"};break;case".":oe=U,de=U,te<Math.PI/4?_e=Math.sqrt(te*U*U/Math.PI):(we=te,Oe=Math.PI/4,1,_e=(ve=U/2)+(U/Math.sqrt(2)-ve)*(we-Oe)/(1-Oe)),Te="circle",Ne={cx:oe/2,cy:de/2,r:_e,opacity:ne,fill:re}}var De=[N||"noSh",X||"noBg",re||"noFg",U,te].join(";"),ze=ke._defs.select(".patterns").selectAll("#"+Pe).data([De],v.identity);ze.exit().remove(),ze.enter().append("pattern").each(function(){var Me=g.select(this);if(Me.attr({id:Pe,width:oe+"px",height:de+"px",patternUnits:"userSpaceOnUse",patternTransform:le?"scale(0.8)":""}),X){var Se=Me.selectAll("rect").data([0]);Se.exit().remove(),Se.enter().append("rect").attr({width:oe+"px",height:de+"px",fill:X})}var Ie=Me.selectAll(Te).data([0]);Ie.exit().remove(),Ie.enter().append(Te).attr(Ne)}),G.style("fill",V(Pe,$)).style("fill-opacity",null),G.classed("pattern_filled",!0)},p.initGradients=function(G){v.ensureSingle(G._fullLayout._defs,"g","gradients").selectAll("linearGradient,radialGradient").remove(),g.select(G).selectAll(".gradient_filled").classed("gradient_filled",!1)},p.initPatterns=function(G){v.ensureSingle(G._fullLayout._defs,"g","patterns").selectAll("pattern").remove(),g.select(G).selectAll(".pattern_filled").classed("pattern_filled",!1)},p.getPatternAttr=function(G,Y,$){return G&&v.isArrayOrTypedArray(G)?Y<G.length?G[Y]:$:G},p.pointStyle=function(G,Y,$){if(G.size()){var B=p.makePointStyleFns(Y);G.each(function(N){p.singlePointStyle(N,g.select(this),Y,B,$)})}},p.singlePointStyle=function(G,Y,$,B,N){var U=$.marker,te=U.line;if(Y.style("opacity",B.selectedOpacityFn?B.selectedOpacityFn(G):void 0===G.mo?U.opacity:G.mo),B.ms2mrc){var j;j="various"===G.ms||"various"===U.size?3:B.ms2mrc(G.ms),G.mrc=j,B.selectedSizeFn&&(j=G.mrc=B.selectedSizeFn(G));var J=p.symbolNumber(G.mx||U.symbol)||0;G.om=J%200>=100,Y.attr("d",T(J,j))}var X,re,ne,le=!1;if(G.so?(ne=te.outlierwidth,re=te.outliercolor,X=U.outliercolor):(ne=(G.mlw+1||(te||{}).width+1||(G.trace?(G.trace.marker.line||{}).width:0)+1)-1||0,re="mlc"in G?G.mlcc=B.lineScale(G.mlc):v.isArrayOrTypedArray(te.color)?t.defaultLine:te.color,v.isArrayOrTypedArray(U.color)&&(X=t.defaultLine,le=!0),X="mc"in G?G.mcc=B.markerScale(G.mc):U.color||"rgba(0,0,0,0)",B.selectedColorFn&&(X=B.selectedColorFn(G))),G.om)Y.call(t.stroke,X).style({"stroke-width":(ne||1)+"px",fill:"none"});else{Y.style("stroke-width",(G.isBlank?0:ne)+"px");var de=U.gradient,se=G.mgt;se?le=!0:se=de&&de.type,v.isArrayOrTypedArray(se)&&(L[se=se[0]]||(se=0));var ge=U.pattern,_e=ge&&p.getPatternAttr(ge.shape,G.i,"");if(se&&"none"!==se){var Te=G.mgc;Te?le=!0:Te=de.color;var we=$.uid;le&&(we+="-"+G.i),p.gradient(Y,N,we,se,[[0,Te],[1,X]],"fill")}else if(_e){var Oe=p.getPatternAttr(ge.bgcolor,G.i,null),fe=p.getPatternAttr(ge.fgcolor,G.i,null),ve=ge.fgopacity,Ae=p.getPatternAttr(ge.size,G.i,8),ke=p.getPatternAttr(ge.solidity,G.i,.3),Pe=G.mcc||v.isArrayOrTypedArray(ge.shape)||v.isArrayOrTypedArray(ge.bgcolor)||v.isArrayOrTypedArray(ge.size)||v.isArrayOrTypedArray(ge.solidity),Ne=$.uid;Pe&&(Ne+="-"+G.i),p.pattern(Y,"point",N,Ne,_e,Ae,ke,G.mcc,ge.fillmode,Oe,fe,ve)}else t.fill(Y,X);ne&&t.stroke(Y,re)}},p.makePointStyleFns=function(G){var Y={},$=G.marker;return Y.markerScale=p.tryColorscale($,""),Y.lineScale=p.tryColorscale($,"line"),n.traceIs(G,"symbols")&&(Y.ms2mrc=f.isBubble(G)?c(G):function(){return($.size||6)/2}),G.selectedpoints&&v.extendFlat(Y,p.makeSelectedPointStyleFns(G)),Y},p.makeSelectedPointStyleFns=function(G){var Y={},N=G.marker||{},U=(G.selected||{}).marker||{},te=(G.unselected||{}).marker||{},J=U.opacity,X=te.opacity,re=void 0!==J,ne=void 0!==X;(v.isArrayOrTypedArray(N.opacity)||re||ne)&&(Y.selectedOpacityFn=function(Oe){var fe=void 0===Oe.mo?N.opacity:Oe.mo;return Oe.selected?re?J:fe:ne?X:u*fe});var le=N.color,oe=U.color,de=te.color;(oe||de)&&(Y.selectedColorFn=function(Oe){var fe=Oe.mcc||le;return Oe.selected?oe||fe:de||fe});var se=N.size,ge=U.size,_e=te.size,Te=void 0!==ge,we=void 0!==_e;return n.traceIs(G,"symbols")&&(Te||we)&&(Y.selectedSizeFn=function(Oe){var fe=Oe.mrc||se/2;return Oe.selected?Te?ge/2:fe:we?_e/2:fe}),Y},p.makeSelectedTextStyleFns=function(G){var Y={},j=(G.textfont||{}).color,J=((G.selected||{}).textfont||{}).color,X=((G.unselected||{}).textfont||{}).color;return Y.selectedTextColorFn=function(re){var ne=re.tc||j;return re.selected?J||ne:X||(J?ne:t.addOpacity(ne,u))},Y},p.selectedPointStyle=function(G,Y){if(G.size()&&Y.selectedpoints){var $=p.makeSelectedPointStyleFns(Y),B=Y.marker||{},N=[];$.selectedOpacityFn&&N.push(function(U,te){U.style("opacity",$.selectedOpacityFn(te))}),$.selectedColorFn&&N.push(function(U,te){t.fill(U,$.selectedColorFn(te))}),$.selectedSizeFn&&N.push(function(U,te){var j=te.mx||B.symbol||0,J=$.selectedSizeFn(te);U.attr("d",T(p.symbolNumber(j),J)),te.mrc2=J}),N.length&&G.each(function(U){for(var te=g.select(this),j=0;j<N.length;j++)N[j](te,U)})}},p.tryColorscale=function(G,Y){var $=Y?v.nestedProperty(G,Y).get():G;return $&&($.colorscale||$._colorAx)&&v.isArrayOrTypedArray($.color)?a.makeColorScaleFuncFromTrace($):v.identity};var M={start:1,end:-1,middle:0,bottom:1,top:-1};function I(G,Y,$,B,N){var U=g.select(G.node().parentNode),te=-1!==Y.indexOf("top")?"top":-1!==Y.indexOf("bottom")?"bottom":"middle",j=-1!==Y.indexOf("left")?"end":-1!==Y.indexOf("right")?"start":"middle",J=B?B/.8+1:0,X=(d.lineCount(G)-1)*i+1,re=M[j]*J,ne=.75*$+M[te]*J+(M[te]-1)*X*$/2;G.attr("text-anchor",j),N||U.attr("transform",r(re,ne))}function P(G,Y){var $=G.ts||Y.textfont.size;return x($)&&$>0?$:0}function S(G,Y,$,B){var N=G[0]-Y[0],U=G[1]-Y[1],te=$[0]-Y[0],j=$[1]-Y[1],J=Math.pow(N*N+U*U,.25),X=Math.pow(te*te+j*j,.25),re=(X*X*N-J*J*te)*B,ne=(X*X*U-J*J*j)*B,le=3*X*(J+X),oe=3*J*(J+X);return[[g.round(Y[0]+(le&&re/le),2),g.round(Y[1]+(le&&ne/le),2)],[g.round(Y[0]-(oe&&re/oe),2),g.round(Y[1]-(oe&&ne/oe),2)]]}p.textPointStyle=function(G,Y,$){if(G.size()){var B;if(Y.selectedpoints){var N=p.makeSelectedTextStyleFns(Y);B=N.selectedTextColorFn}var U=Y.texttemplate,te=$._fullLayout;G.each(function(j){var J=g.select(this),X=U?v.extractOption(j,Y,"txt","texttemplate"):v.extractOption(j,Y,"tx","text");if(X||0===X){if(U){var re=Y._module.formatLabels,ne=re?re(j,Y,te):{},le={};h(le,Y,j.i),X=v.texttemplateString(X,ne,te._d3locale,le,j,Y._meta||{})}var de=j.tp||Y.textposition,se=P(j,Y),ge=B?B(j):j.tc||Y.textfont.color;J.call(p.font,j.tf||Y.textfont.family,se,ge).text(X).call(d.convertToTspans,$).call(I,de,se,j.mrc)}else J.remove()})}},p.selectedTextStyle=function(G,Y){if(G.size()&&Y.selectedpoints){var $=p.makeSelectedTextStyleFns(Y);G.each(function(B){var N=g.select(this),U=$.selectedTextColorFn(B),te=B.tp||Y.textposition,j=P(B,Y);t.fill(N,U);var J=n.traceIs(Y,"bar-like");I(N,te,j,B.mrc2||B.mrc,J)})}},p.smoothopen=function(G,Y){if(G.length<3)return"M"+G.join("L");var $,B="M"+G[0],N=[];for($=1;$<G.length-1;$++)N.push(S(G[$-1],G[$],G[$+1],Y));for(B+="Q"+N[0][0]+" "+G[1],$=2;$<G.length-1;$++)B+="C"+N[$-2][1]+" "+N[$-1][0]+" "+G[$];return B+"Q"+N[G.length-3][1]+" "+G[G.length-1]},p.smoothclosed=function(G,Y){if(G.length<3)return"M"+G.join("L")+"Z";var $,B="M"+G[0],N=G.length-1,U=[S(G[N],G[0],G[1],Y)];for($=1;$<N;$++)U.push(S(G[$-1],G[$],G[$+1],Y));for(U.push(S(G[N-1],G[N],G[0],Y)),$=1;$<=N;$++)B+="C"+U[$-1][1]+" "+U[$][0]+" "+G[$];return B+"C"+U[N][1]+" "+U[0][0]+" "+G[0]+"Z"};var E={hv:function(G,Y){return"H"+g.round(Y[0],2)+"V"+g.round(Y[1],2)},vh:function(G,Y){return"V"+g.round(Y[1],2)+"H"+g.round(Y[0],2)},hvh:function(G,Y){return"H"+g.round((G[0]+Y[0])/2,2)+"V"+g.round(Y[1],2)+"H"+g.round(Y[0],2)},vhv:function(G,Y){return"V"+g.round((G[1]+Y[1])/2,2)+"H"+g.round(Y[0],2)+"V"+g.round(Y[1],2)}},z=function(G,Y){return"L"+g.round(Y[0],2)+","+g.round(Y[1],2)};p.steps=function(G){var Y=E[G]||z;return function($){for(var B="M"+g.round($[0][0],2)+","+g.round($[0][1],2),N=1;N<$.length;N++)B+=Y($[N-1],$[N]);return B}},p.makeTester=function(){var G=v.ensureSingleById(g.select("body"),"svg","js-plotly-tester",function($){$.attr(s.svgAttrs).style({position:"absolute",left:"-10000px",top:"-10000px",width:"9000px",height:"9000px","z-index":"1"})}),Y=v.ensureSingle(G,"path","js-reference-point",function($){$.attr("d","M0,0H1V1H0Z").style({"stroke-width":0,fill:"black"})});p.tester=G,p.testref=Y},p.savedBBoxes={};var R=0;function q(G){var Y=G.getAttribute("data-unformatted");if(null!==Y)return Y+G.getAttribute("data-math")+G.getAttribute("text-anchor")+G.getAttribute("style")}function V(G,Y){if(!G)return null;var $=Y._context,B=$._exportedPlot?"":$._baseUrl||"";return B?"url('"+B+"#"+G+"')":"url(#"+G+")"}p.bBox=function(G,Y,$){var B,N,U;if($||($=q(G)),$){if(B=p.savedBBoxes[$])return v.extendFlat({},B)}else if(1===G.childNodes.length){var te=G.childNodes[0];if($=q(te)){var j=+te.getAttribute("x")||0,J=+te.getAttribute("y")||0,X=te.getAttribute("transform");if(!X){var re=p.bBox(te,!1,$);return j&&(re.left+=j,re.right+=j),J&&(re.top+=J,re.bottom+=J),re}if(B=p.savedBBoxes[$+="~"+j+"~"+J+"~"+X])return v.extendFlat({},B)}}Y?N=G:(U=p.tester.node(),N=G.cloneNode(!0),U.appendChild(N)),g.select(N).attr("transform",null).call(d.positionText,0,0);var ne=N.getBoundingClientRect(),le=p.testref.node().getBoundingClientRect();Y||U.removeChild(N);var oe={height:ne.height,width:ne.width,left:ne.left-le.left,top:ne.top-le.top,right:ne.right-le.left,bottom:ne.bottom-le.top};return R>=1e4&&(p.savedBBoxes={},R=0),$&&(p.savedBBoxes[$]=oe),R++,v.extendFlat({},oe)},p.setClipUrl=function(G,Y,$){G.attr("clip-path",V(Y,$))},p.getTranslate=function(G){var Y=(G[G.attr?"attr":"getAttribute"]("transform")||"").replace(/.*\btranslate\((-?\d*\.?\d*)[^-\d]*(-?\d*\.?\d*)[^\d].*/,function($,B,N){return[B,N].join(" ")}).split(" ");return{x:+Y[0]||0,y:+Y[1]||0}},p.setTranslate=function(G,Y,$){var N=G.attr?"attr":"setAttribute",U=G[G.attr?"attr":"getAttribute"]("transform")||"";return Y=Y||0,$=$||0,U=U.replace(/(\btranslate\(.*?\);?)/,"").trim(),U=(U+=r(Y,$)).trim(),G[N]("transform",U),U},p.getScale=function(G){var Y=(G[G.attr?"attr":"getAttribute"]("transform")||"").replace(/.*\bscale\((\d*\.?\d*)[^\d]*(\d*\.?\d*)[^\d].*/,function($,B,N){return[B,N].join(" ")}).split(" ");return{x:+Y[0]||1,y:+Y[1]||1}},p.setScale=function(G,Y,$){var N=G.attr?"attr":"setAttribute",U=G[G.attr?"attr":"getAttribute"]("transform")||"";return Y=Y||1,$=$||1,U=U.replace(/(\bscale\(.*?\);?)/,"").trim(),U=(U+="scale("+Y+","+$+")").trim(),G[N]("transform",U),U};var W=/\s*sc.*/;p.setPointGroupScale=function(G,Y,$){if(Y=Y||1,$=$||1,G){var B=1===Y&&1===$?"":"scale("+Y+","+$+")";G.each(function(){var N=(this.getAttribute("transform")||"").replace(W,"");N=(N+=B).trim(),this.setAttribute("transform",N)})}};var K=/translate\([^)]*\)\s*$/;p.setTextPointsScale=function(G,Y,$){G&&G.each(function(){var B,N=g.select(this),U=N.select("text");if(U.node()){var te=parseFloat(U.attr("x")||0),j=parseFloat(U.attr("y")||0),J=(N.attr("transform")||"").match(K);B=1===Y&&1===$?[]:[r(te,j),"scale("+Y+","+$+")",r(-te,-j)],J&&B.push(J),N.attr("transform",B.join(""))}})}},{"../../components/fx/helpers":403,"../../constants/alignment":483,"../../constants/interactions":490,"../../constants/xmlns_namespaces":492,"../../lib":515,"../../lib/svg_text_utils":541,"../../registry":647,"../../traces/scatter/make_bubble_size_func":953,"../../traces/scatter/subtypes":961,"../color":367,"../colorscale":379,"./symbol_defs":390,"@plotly/d3":58,"fast-isnumeric":190,tinycolor2:313}],390:[function(y,ee,Q){"use strict";var g=y("@plotly/d3");ee.exports={circle:{n:0,f:function(v){var m=g.round(v,2);return"M"+m+",0A"+m+","+m+" 0 1,1 0,-"+m+"A"+m+","+m+" 0 0,1 "+m+",0Z"}},square:{n:1,f:function(v){var m=g.round(v,2);return"M"+m+","+m+"H-"+m+"V-"+m+"H"+m+"Z"}},diamond:{n:2,f:function(v){var m=g.round(1.3*v,2);return"M"+m+",0L0,"+m+"L-"+m+",0L0,-"+m+"Z"}},cross:{n:3,f:function(v){var m=g.round(.4*v,2),x=g.round(1.2*v,2);return"M"+x+","+m+"H"+m+"V"+x+"H-"+m+"V"+m+"H-"+x+"V-"+m+"H-"+m+"V-"+x+"H"+m+"V-"+m+"H"+x+"Z"}},x:{n:4,f:function(v){var m=g.round(.8*v/Math.sqrt(2),2),x="l"+m+","+m,e="l"+m+",-"+m,n="l-"+m+",-"+m,t="l-"+m+","+m;return"M0,"+m+x+e+n+e+n+t+n+t+x+t+x+"Z"}},"triangle-up":{n:5,f:function(v){var m=g.round(2*v/Math.sqrt(3),2);return"M-"+m+","+g.round(v/2,2)+"H"+m+"L0,-"+g.round(v,2)+"Z"}},"triangle-down":{n:6,f:function(v){var m=g.round(2*v/Math.sqrt(3),2);return"M-"+m+",-"+g.round(v/2,2)+"H"+m+"L0,"+g.round(v,2)+"Z"}},"triangle-left":{n:7,f:function(v){var m=g.round(2*v/Math.sqrt(3),2);return"M"+g.round(v/2,2)+",-"+m+"V"+m+"L-"+g.round(v,2)+",0Z"}},"triangle-right":{n:8,f:function(v){var m=g.round(2*v/Math.sqrt(3),2);return"M-"+g.round(v/2,2)+",-"+m+"V"+m+"L"+g.round(v,2)+",0Z"}},"triangle-ne":{n:9,f:function(v){var m=g.round(.6*v,2),x=g.round(1.2*v,2);return"M-"+x+",-"+m+"H"+m+"V"+x+"Z"}},"triangle-se":{n:10,f:function(v){var m=g.round(.6*v,2),x=g.round(1.2*v,2);return"M"+m+",-"+x+"V"+m+"H-"+x+"Z"}},"triangle-sw":{n:11,f:function(v){var m=g.round(.6*v,2),x=g.round(1.2*v,2);return"M"+x+","+m+"H-"+m+"V-"+x+"Z"}},"triangle-nw":{n:12,f:function(v){var m=g.round(.6*v,2),x=g.round(1.2*v,2);return"M-"+m+","+x+"V-"+m+"H"+x+"Z"}},pentagon:{n:13,f:function(v){var m=g.round(.951*v,2),x=g.round(.588*v,2),e=g.round(-v,2),n=g.round(-.309*v,2);return"M"+m+","+n+"L"+x+","+g.round(.809*v,2)+"H-"+x+"L-"+m+","+n+"L0,"+e+"Z"}},hexagon:{n:14,f:function(v){var m=g.round(v,2),x=g.round(v/2,2),e=g.round(v*Math.sqrt(3)/2,2);return"M"+e+",-"+x+"V"+x+"L0,"+m+"L-"+e+","+x+"V-"+x+"L0,-"+m+"Z"}},hexagon2:{n:15,f:function(v){var m=g.round(v,2),x=g.round(v/2,2),e=g.round(v*Math.sqrt(3)/2,2);return"M-"+x+","+e+"H"+x+"L"+m+",0L"+x+",-"+e+"H-"+x+"L-"+m+",0Z"}},octagon:{n:16,f:function(v){var m=g.round(.924*v,2),x=g.round(.383*v,2);return"M-"+x+",-"+m+"H"+x+"L"+m+",-"+x+"V"+x+"L"+x+","+m+"H-"+x+"L-"+m+","+x+"V-"+x+"Z"}},star:{n:17,f:function(v){var m=1.4*v,x=g.round(.225*m,2),e=g.round(.951*m,2),n=g.round(.363*m,2),t=g.round(.588*m,2),a=g.round(-m,2),r=g.round(-.309*m,2),d=g.round(.118*m,2),s=g.round(.809*m,2);return"M"+x+","+r+"H"+e+"L"+n+","+d+"L"+t+","+s+"L0,"+g.round(.382*m,2)+"L-"+t+","+s+"L-"+n+","+d+"L-"+e+","+r+"H-"+x+"L0,"+a+"Z"}},hexagram:{n:18,f:function(v){var m=g.round(.66*v,2),x=g.round(.38*v,2),e=g.round(.76*v,2);return"M-"+e+",0l-"+x+",-"+m+"h"+e+"l"+x+",-"+m+"l"+x+","+m+"h"+e+"l-"+x+","+m+"l"+x+","+m+"h-"+e+"l-"+x+","+m+"l-"+x+",-"+m+"h-"+e+"Z"}},"star-triangle-up":{n:19,f:function(v){var m=g.round(v*Math.sqrt(3)*.8,2),x=g.round(.8*v,2),e=g.round(1.6*v,2),n=g.round(4*v,2),t="A "+n+","+n+" 0 0 1 ";return"M-"+m+","+x+t+m+","+x+t+"0,-"+e+t+"-"+m+","+x+"Z"}},"star-triangle-down":{n:20,f:function(v){var m=g.round(v*Math.sqrt(3)*.8,2),x=g.round(.8*v,2),e=g.round(1.6*v,2),n=g.round(4*v,2),t="A "+n+","+n+" 0 0 1 ";return"M"+m+",-"+x+t+"-"+m+",-"+x+t+"0,"+e+t+m+",-"+x+"Z"}},"star-square":{n:21,f:function(v){var m=g.round(1.1*v,2),x=g.round(2*v,2),e="A "+x+","+x+" 0 0 1 ";return"M-"+m+",-"+m+e+"-"+m+","+m+e+m+","+m+e+m+",-"+m+e+"-"+m+",-"+m+"Z"}},"star-diamond":{n:22,f:function(v){var m=g.round(1.4*v,2),x=g.round(1.9*v,2),e="A "+x+","+x+" 0 0 1 ";return"M-"+m+",0"+e+"0,"+m+e+m+",0"+e+"0,-"+m+e+"-"+m+",0Z"}},"diamond-tall":{n:23,f:function(v){var m=g.round(.7*v,2),x=g.round(1.4*v,2);return"M0,"+x+"L"+m+",0L0,-"+x+"L-"+m+",0Z"}},"diamond-wide":{n:24,f:function(v){var m=g.round(1.4*v,2),x=g.round(.7*v,2);return"M0,"+x+"L"+m+",0L0,-"+x+"L-"+m+",0Z"}},hourglass:{n:25,f:function(v){var m=g.round(v,2);return"M"+m+","+m+"H-"+m+"L"+m+",-"+m+"H-"+m+"Z"},noDot:!0},bowtie:{n:26,f:function(v){var m=g.round(v,2);return"M"+m+","+m+"V-"+m+"L-"+m+","+m+"V-"+m+"Z"},noDot:!0},"circle-cross":{n:27,f:function(v){var m=g.round(v,2);return"M0,"+m+"V-"+m+"M"+m+",0H-"+m+"M"+m+",0A"+m+","+m+" 0 1,1 0,-"+m+"A"+m+","+m+" 0 0,1 "+m+",0Z"},needLine:!0,noDot:!0},"circle-x":{n:28,f:function(v){var m=g.round(v,2),x=g.round(v/Math.sqrt(2),2);return"M"+x+","+x+"L-"+x+",-"+x+"M"+x+",-"+x+"L-"+x+","+x+"M"+m+",0A"+m+","+m+" 0 1,1 0,-"+m+"A"+m+","+m+" 0 0,1 "+m+",0Z"},needLine:!0,noDot:!0},"square-cross":{n:29,f:function(v){var m=g.round(v,2);return"M0,"+m+"V-"+m+"M"+m+",0H-"+m+"M"+m+","+m+"H-"+m+"V-"+m+"H"+m+"Z"},needLine:!0,noDot:!0},"square-x":{n:30,f:function(v){var m=g.round(v,2);return"M"+m+","+m+"L-"+m+",-"+m+"M"+m+",-"+m+"L-"+m+","+m+"M"+m+","+m+"H-"+m+"V-"+m+"H"+m+"Z"},needLine:!0,noDot:!0},"diamond-cross":{n:31,f:function(v){var m=g.round(1.3*v,2);return"M"+m+",0L0,"+m+"L-"+m+",0L0,-"+m+"ZM0,-"+m+"V"+m+"M-"+m+",0H"+m},needLine:!0,noDot:!0},"diamond-x":{n:32,f:function(v){var m=g.round(1.3*v,2),x=g.round(.65*v,2);return"M"+m+",0L0,"+m+"L-"+m+",0L0,-"+m+"ZM-"+x+",-"+x+"L"+x+","+x+"M-"+x+","+x+"L"+x+",-"+x},needLine:!0,noDot:!0},"cross-thin":{n:33,f:function(v){var m=g.round(1.4*v,2);return"M0,"+m+"V-"+m+"M"+m+",0H-"+m},needLine:!0,noDot:!0,noFill:!0},"x-thin":{n:34,f:function(v){var m=g.round(v,2);return"M"+m+","+m+"L-"+m+",-"+m+"M"+m+",-"+m+"L-"+m+","+m},needLine:!0,noDot:!0,noFill:!0},asterisk:{n:35,f:function(v){var m=g.round(1.2*v,2),x=g.round(.85*v,2);return"M0,"+m+"V-"+m+"M"+m+",0H-"+m+"M"+x+","+x+"L-"+x+",-"+x+"M"+x+",-"+x+"L-"+x+","+x},needLine:!0,noDot:!0,noFill:!0},hash:{n:36,f:function(v){var m=g.round(v/2,2),x=g.round(v,2);return"M"+m+","+x+"V-"+x+"m-"+x+",0V"+x+"M"+x+","+m+"H-"+x+"m0,-"+x+"H"+x},needLine:!0,noFill:!0},"y-up":{n:37,f:function(v){var m=g.round(1.2*v,2),x=g.round(1.6*v,2),e=g.round(.8*v,2);return"M-"+m+","+e+"L0,0M"+m+","+e+"L0,0M0,-"+x+"L0,0"},needLine:!0,noDot:!0,noFill:!0},"y-down":{n:38,f:function(v){var m=g.round(1.2*v,2),x=g.round(1.6*v,2),e=g.round(.8*v,2);return"M-"+m+",-"+e+"L0,0M"+m+",-"+e+"L0,0M0,"+x+"L0,0"},needLine:!0,noDot:!0,noFill:!0},"y-left":{n:39,f:function(v){var m=g.round(1.2*v,2),x=g.round(1.6*v,2),e=g.round(.8*v,2);return"M"+e+","+m+"L0,0M"+e+",-"+m+"L0,0M-"+x+",0L0,0"},needLine:!0,noDot:!0,noFill:!0},"y-right":{n:40,f:function(v){var m=g.round(1.2*v,2),x=g.round(1.6*v,2),e=g.round(.8*v,2);return"M-"+e+","+m+"L0,0M-"+e+",-"+m+"L0,0M"+x+",0L0,0"},needLine:!0,noDot:!0,noFill:!0},"line-ew":{n:41,f:function(v){var m=g.round(1.4*v,2);return"M"+m+",0H-"+m},needLine:!0,noDot:!0,noFill:!0},"line-ns":{n:42,f:function(v){var m=g.round(1.4*v,2);return"M0,"+m+"V-"+m},needLine:!0,noDot:!0,noFill:!0},"line-ne":{n:43,f:function(v){var m=g.round(v,2);return"M"+m+",-"+m+"L-"+m+","+m},needLine:!0,noDot:!0,noFill:!0},"line-nw":{n:44,f:function(v){var m=g.round(v,2);return"M"+m+","+m+"L-"+m+",-"+m},needLine:!0,noDot:!0,noFill:!0},"arrow-up":{n:45,f:function(v){var m=g.round(v,2);return"M0,0L-"+m+","+g.round(2*v,2)+"H"+m+"Z"},noDot:!0},"arrow-down":{n:46,f:function(v){var m=g.round(v,2);return"M0,0L-"+m+",-"+g.round(2*v,2)+"H"+m+"Z"},noDot:!0},"arrow-left":{n:47,f:function(v){var m=g.round(2*v,2),x=g.round(v,2);return"M0,0L"+m+",-"+x+"V"+x+"Z"},noDot:!0},"arrow-right":{n:48,f:function(v){var m=g.round(2*v,2),x=g.round(v,2);return"M0,0L-"+m+",-"+x+"V"+x+"Z"},noDot:!0},"arrow-bar-up":{n:49,f:function(v){var m=g.round(v,2);return"M-"+m+",0H"+m+"M0,0L-"+m+","+g.round(2*v,2)+"H"+m+"Z"},needLine:!0,noDot:!0},"arrow-bar-down":{n:50,f:function(v){var m=g.round(v,2);return"M-"+m+",0H"+m+"M0,0L-"+m+",-"+g.round(2*v,2)+"H"+m+"Z"},needLine:!0,noDot:!0},"arrow-bar-left":{n:51,f:function(v){var m=g.round(2*v,2),x=g.round(v,2);return"M0,-"+x+"V"+x+"M0,0L"+m+",-"+x+"V"+x+"Z"},needLine:!0,noDot:!0},"arrow-bar-right":{n:52,f:function(v){var m=g.round(2*v,2),x=g.round(v,2);return"M0,-"+x+"V"+x+"M0,0L-"+m+",-"+x+"V"+x+"Z"},needLine:!0,noDot:!0}}},{"@plotly/d3":58}],391:[function(y,ee,Q){"use strict";ee.exports={visible:{valType:"boolean",editType:"calc"},type:{valType:"enumerated",values:["percent","constant","sqrt","data"],editType:"calc"},symmetric:{valType:"boolean",editType:"calc"},array:{valType:"data_array",editType:"calc"},arrayminus:{valType:"data_array",editType:"calc"},value:{valType:"number",min:0,dflt:10,editType:"calc"},valueminus:{valType:"number",min:0,dflt:10,editType:"calc"},traceref:{valType:"integer",min:0,dflt:0,editType:"style"},tracerefminus:{valType:"integer",min:0,dflt:0,editType:"style"},copy_ystyle:{valType:"boolean",editType:"plot"},copy_zstyle:{valType:"boolean",editType:"style"},color:{valType:"color",editType:"style"},thickness:{valType:"number",min:0,dflt:2,editType:"style"},width:{valType:"number",min:0,editType:"plot"},editType:"calc",_deprecated:{opacity:{valType:"number",editType:"style"}}}},{}],392:[function(y,ee,Q){"use strict";var g=y("fast-isnumeric"),v=y("../../registry"),m=y("../../plots/cartesian/axes"),x=y("../../lib"),e=y("./compute_error");function n(t,a,r,d){var s=a["error_"+d]||{},i=[];if(s.visible&&-1!==["linear","log"].indexOf(r.type)){for(var u=e(s),f=0;f<t.length;f++){var c=t[f],h=c.i;if(void 0===h)h=f;else if(null===h)continue;var p=c[d];if(g(r.c2l(p))){var o=u(p,h);if(g(o[0])&&g(o[1])){var b=c[d+"s"]=p-o[0],l=c[d+"h"]=p+o[1];i.push(b,l)}}}var _=a._extremes[r._id],w=m.findExtremes(r,i,x.extendFlat({tozero:_.opts.tozero},{padded:!0}));_.min=_.min.concat(w.min),_.max=_.max.concat(w.max)}}ee.exports=function(t){for(var a=t.calcdata,r=0;r<a.length;r++){var d=a[r],s=d[0].trace;if(!0===s.visible&&v.traceIs(s,"errorBarsOK")){var i=m.getFromId(t,s.xaxis),u=m.getFromId(t,s.yaxis);n(d,s,i,"x"),n(d,s,u,"y")}}}},{"../../lib":515,"../../plots/cartesian/axes":566,"../../registry":647,"./compute_error":393,"fast-isnumeric":190}],393:[function(y,ee,Q){"use strict";function g(v,m){return"percent"===v?function(x){return Math.abs(x*m/100)}:"constant"===v?function(){return Math.abs(m)}:"sqrt"===v?function(x){return Math.sqrt(Math.abs(x))}:void 0}ee.exports=function(v){var m=v.type,x=v.symmetric;if("data"===m){var e=v.array||[];if(x)return function(r,d){var s=+e[d];return[s,s]};var n=v.arrayminus||[];return function(r,d){var s=+e[d],i=+n[d];return isNaN(s)&&isNaN(i)?[NaN,NaN]:[i||0,s||0]}}var t=g(m,v.value),a=g(m,v.valueminus);return x||void 0===v.valueminus?function(r){var d=t(r);return[d,d]}:function(r){return[a(r),t(r)]}}},{}],394:[function(y,ee,Q){"use strict";var g=y("fast-isnumeric"),v=y("../../registry"),m=y("../../lib"),x=y("../../plot_api/plot_template"),e=y("./attributes");ee.exports=function(n,t,a,r){var d="error_"+r.axis,s=x.newContainer(t,d),i=n[d]||{};function u(p,o){return m.coerce(i,s,e,p,o)}if(!1!==u("visible",void 0!==i.array||void 0!==i.value||"sqrt"===i.type)){var f=u("type","array"in i?"data":"percent"),c=!0;"sqrt"!==f&&(c=u("symmetric",!(("data"===f?"arrayminus":"valueminus")in i))),"data"===f?(u("array"),u("traceref"),c||(u("arrayminus"),u("tracerefminus"))):"percent"!==f&&"constant"!==f||(u("value"),c||u("valueminus"));var h="copy_"+r.inherit+"style";r.inherit&&(t["error_"+r.inherit]||{}).visible&&u(h,!(i.color||g(i.thickness)||g(i.width))),r.inherit&&s[h]||(u("color",a),u("thickness"),u("width",v.traceIs(t,"gl3d")?0:4))}}},{"../../lib":515,"../../plot_api/plot_template":555,"../../registry":647,"./attributes":391,"fast-isnumeric":190}],395:[function(y,ee,Q){"use strict";var g=y("../../lib"),v=y("../../plot_api/edit_types").overrideAll,m=y("./attributes"),x={error_x:g.extendFlat({},m),error_y:g.extendFlat({},m)};delete x.error_x.copy_zstyle,delete x.error_y.copy_zstyle,delete x.error_y.copy_ystyle;var e={error_x:g.extendFlat({},m),error_y:g.extendFlat({},m),error_z:g.extendFlat({},m)};delete e.error_x.copy_ystyle,delete e.error_y.copy_ystyle,delete e.error_z.copy_ystyle,delete e.error_z.copy_zstyle,ee.exports={moduleType:"component",name:"errorbars",schema:{traces:{scatter:x,bar:x,histogram:x,scatter3d:v(e,"calc","nested"),scattergl:v(x,"calc","nested")}},supplyDefaults:y("./defaults"),calc:y("./calc"),makeComputeError:y("./compute_error"),plot:y("./plot"),style:y("./style"),hoverInfo:function(n,t,a){(t.error_y||{}).visible&&(a.yerr=n.yh-n.y,t.error_y.symmetric||(a.yerrneg=n.y-n.ys)),(t.error_x||{}).visible&&(a.xerr=n.xh-n.x,t.error_x.symmetric||(a.xerrneg=n.x-n.xs))}}},{"../../lib":515,"../../plot_api/edit_types":548,"./attributes":391,"./calc":392,"./compute_error":393,"./defaults":394,"./plot":396,"./style":397}],396:[function(y,ee,Q){"use strict";var g=y("@plotly/d3"),v=y("fast-isnumeric"),m=y("../drawing"),x=y("../../traces/scatter/subtypes");ee.exports=function(e,n,t,a){var r=t.xaxis,d=t.yaxis,s=a&&a.duration>0;n.each(function(i){var u,f=i[0].trace,c=f.error_x||{},h=f.error_y||{};f.ids&&(u=function(l){return l.id});var p=x.hasMarkers(f)&&f.marker.maxdisplayed>0;h.visible||c.visible||(i=[]);var o=g.select(this).selectAll("g.errorbar").data(i,u);if(o.exit().remove(),i.length){c.visible||o.selectAll("path.xerror").remove(),h.visible||o.selectAll("path.yerror").remove(),o.style("opacity",1);var b=o.enter().append("g").classed("errorbar",!0);s&&b.style("opacity",0).transition().duration(a.duration).style("opacity",1),m.setClipUrl(o,t.layerClipId,e),o.each(function(l){var P,S,E,z,T=g.select(this),_=(E=d,z={x:(S=r).c2p((P=l).x),y:E.c2p(P.y)},void 0!==P.yh&&(z.yh=E.c2p(P.yh),z.ys=E.c2p(P.ys),v(z.ys)||(z.noYS=!0,z.ys=E.c2p(P.ys,!0))),void 0!==P.xh&&(z.xh=S.c2p(P.xh),z.xs=S.c2p(P.xs),v(z.xs)||(z.noXS=!0,z.xs=S.c2p(P.xs,!0))),z);if(!p||l.vis){var w,k=T.select("path.yerror");if(h.visible&&v(_.x)&&v(_.yh)&&v(_.ys)){var L=h.width;w="M"+(_.x-L)+","+_.yh+"h"+2*L+"m-"+L+",0V"+_.ys,_.noYS||(w+="m-"+L+",0h"+2*L),k.size()?s&&(k=k.transition().duration(a.duration).ease(a.easing)):k=T.append("path").style("vector-effect","non-scaling-stroke").classed("yerror",!0),k.attr("d",w)}else k.remove();var M=T.select("path.xerror");if(c.visible&&v(_.y)&&v(_.xh)&&v(_.xs)){var I=(c.copy_ystyle?h:c).width;w="M"+_.xh+","+(_.y-I)+"v"+2*I+"m0,-"+I+"H"+_.xs,_.noXS||(w+="m0,-"+I+"v"+2*I),M.size()?s&&(M=M.transition().duration(a.duration).ease(a.easing)):M=T.append("path").style("vector-effect","non-scaling-stroke").classed("xerror",!0),M.attr("d",w)}else M.remove()}})}})}},{"../../traces/scatter/subtypes":961,"../drawing":389,"@plotly/d3":58,"fast-isnumeric":190}],397:[function(y,ee,Q){"use strict";var g=y("@plotly/d3"),v=y("../color");ee.exports=function(m){m.each(function(x){var e=x[0].trace,n=e.error_y||{},t=e.error_x||{},a=g.select(this);a.selectAll("path.yerror").style("stroke-width",n.thickness+"px").call(v.stroke,n.color),t.copy_ystyle&&(t=n),a.selectAll("path.xerror").style("stroke-width",t.thickness+"px").call(v.stroke,t.color)})}},{"../color":367,"@plotly/d3":58}],398:[function(y,ee,Q){"use strict";var g=y("../../plots/font_attributes"),v=y("./layout_attributes").hoverlabel,m=y("../../lib/extend").extendFlat;ee.exports={hoverlabel:{bgcolor:m({},v.bgcolor,{arrayOk:!0}),bordercolor:m({},v.bordercolor,{arrayOk:!0}),font:g({arrayOk:!0,editType:"none"}),align:m({},v.align,{arrayOk:!0}),namelength:m({},v.namelength,{arrayOk:!0}),editType:"none"}}},{"../../lib/extend":505,"../../plots/font_attributes":594,"./layout_attributes":408}],399:[function(y,ee,Q){"use strict";var g=y("../../lib"),v=y("../../registry");function m(x,e,n,t){t=t||g.identity,Array.isArray(x)&&(e[0][n]=t(x))}ee.exports=function(x){var e=x.calcdata,n=x._fullLayout;function t(i){return function(u){return g.coerceHoverinfo({hoverinfo:u},{_module:i._module},n)}}for(var a=0;a<e.length;a++){var r=e[a],d=r[0].trace;if(!v.traceIs(d,"pie-like")){var s=v.traceIs(d,"2dMap")?m:g.fillArray;s(d.hoverinfo,r,"hi",t(d)),d.hovertemplate&&s(d.hovertemplate,r,"ht"),d.hoverlabel&&(s(d.hoverlabel.bgcolor,r,"hbg"),s(d.hoverlabel.bordercolor,r,"hbc"),s(d.hoverlabel.font.size,r,"hts"),s(d.hoverlabel.font.color,r,"htc"),s(d.hoverlabel.font.family,r,"htf"),s(d.hoverlabel.namelength,r,"hnl"),s(d.hoverlabel.align,r,"hta"))}}}},{"../../lib":515,"../../registry":647}],400:[function(y,ee,Q){"use strict";var g=y("../../registry"),v=y("./hover").hover;ee.exports=function(m,x,e){var n=g.getComponentMethod("annotations","onClick")(m,m._hoverdata);function t(){m.emit("plotly_click",{points:m._hoverdata,event:x})}void 0!==e&&v(m,x,e,!0),m._hoverdata&&x&&x.target&&(n&&n.then?n.then(t):t(),x.stopImmediatePropagation&&x.stopImmediatePropagation())}},{"../../registry":647,"./hover":404}],401:[function(y,ee,Q){"use strict";ee.exports={YANGLE:60,HOVERARROWSIZE:6,HOVERTEXTPAD:3,HOVERFONTSIZE:13,HOVERFONT:"Arial, sans-serif",HOVERMINTIME:50,HOVERID:"-hover"}},{}],402:[function(y,ee,Q){"use strict";var g=y("../../lib"),v=y("./attributes"),m=y("./hoverlabel_defaults");ee.exports=function(x,e,n,t){var a=g.extendFlat({},t.hoverlabel);e.hovertemplate&&(a.namelength=-1),m(x,e,function(r,d){return g.coerce(x,e,v,r,d)},a)}},{"../../lib":515,"./attributes":398,"./hoverlabel_defaults":405}],403:[function(y,ee,Q){"use strict";var g=y("../../lib");Q.getSubplot=function(t){return t.subplot||t.xaxis+t.yaxis||t.geo},Q.isTraceInSubplots=function(t,a){if("splom"===t.type){for(var r=t.xaxes||[],d=t.yaxes||[],s=0;s<r.length;s++)for(var i=0;i<d.length;i++)if(-1!==a.indexOf(r[s]+d[i]))return!0;return!1}return-1!==a.indexOf(Q.getSubplot(t))},Q.flat=function(t,a){for(var r=new Array(t.length),d=0;d<t.length;d++)r[d]=a;return r},Q.p2c=function(t,a){for(var r=new Array(t.length),d=0;d<t.length;d++)r[d]=t[d].p2c(a);return r},Q.getDistanceFunction=function(t,a,r,d){return"closest"===t?d||Q.quadrature(a,r):"x"===t.charAt(0)?a:r},Q.getClosest=function(t,a,r){if(!1!==r.index)r.index>=0&&r.index<t.length?r.distance=0:r.index=!1;else for(var d=0;d<t.length;d++){var s=a(t[d]);s<=r.distance&&(r.index=d,r.distance=s)}return r},Q.inbox=function(t,a,r){return t*a<0||0===t?r:1/0},Q.quadrature=function(t,a){return function(r){var d=t(r),s=a(r);return Math.sqrt(d*d+s*s)}},Q.makeEventData=function(t,a,r){var d="index"in t?t.index:t.pointNumber,s={data:a._input,fullData:a,curveNumber:a.index,pointNumber:d};if(a._indexToPoints){var i=a._indexToPoints[d];1===i.length?s.pointIndex=i[0]:s.pointIndices=i}else s.pointIndex=d;return a._module.eventData?s=a._module.eventData(s,t,a,r,d):("xVal"in t?s.x=t.xVal:"x"in t&&(s.x=t.x),"yVal"in t?s.y=t.yVal:"y"in t&&(s.y=t.y),t.xa&&(s.xaxis=t.xa),t.ya&&(s.yaxis=t.ya),void 0!==t.zLabelVal&&(s.z=t.zLabelVal)),Q.appendArrayPointValue(s,a,d),s},Q.appendArrayPointValue=function(t,a,r){var d=a._arrayAttrs;if(d)for(var s=0;s<d.length;s++){var i=d[s],u=m(i);if(void 0===t[u]){var f=x(g.nestedProperty(a,i).get(),r);void 0!==f&&(t[u]=f)}}},Q.appendArrayMultiPointValues=function(t,a,r){var d=a._arrayAttrs;if(d)for(var s=0;s<d.length;s++){var i=d[s],u=m(i);if(void 0===t[u]){for(var f=g.nestedProperty(a,i).get(),c=new Array(r.length),h=0;h<r.length;h++)c[h]=x(f,r[h]);t[u]=c}}};var v={ids:"id",locations:"location",labels:"label",values:"value","marker.colors":"color",parents:"parent"};function m(t){return v[t]||t}function x(t,a){return Array.isArray(a)?Array.isArray(t)&&Array.isArray(t[a[0]])?t[a[0]][a[1]]:void 0:t[a]}var e={x:!0,y:!0},n={"x unified":!0,"y unified":!0};Q.isUnifiedHover=function(t){return"string"==typeof t&&!!n[t]},Q.isXYhover=function(t){return"string"==typeof t&&!!e[t]}},{"../../lib":515}],404:[function(y,ee,Q){"use strict";var g=y("@plotly/d3"),v=y("fast-isnumeric"),m=y("tinycolor2"),x=y("../../lib"),e=x.strTranslate,n=x.strRotate,t=y("../../lib/events"),a=y("../../lib/svg_text_utils"),r=y("../../lib/override_cursor"),d=y("../drawing"),s=y("../color"),i=y("../dragelement"),u=y("../../plots/cartesian/axes"),f=y("../../registry"),c=y("./helpers"),h=y("./constants"),p=y("../legend/defaults"),o=y("../legend/draw"),b=h.YANGLE,l=Math.PI*b/180,T=1/Math.sin(l),_=Math.cos(l),w=Math.sin(l),k=h.HOVERARROWSIZE,L=h.HOVERTEXTPAD,M={box:!0,ohlc:!0,violin:!0,candlestick:!0},I={scatter:!0,scattergl:!0,splom:!0};function P(N){return[N.trace.index,N.index,N.x0,N.y0,N.name,N.attr,N.xa?N.xa._id:"",N.ya?N.ya._id:""].join(",")}Q.hover=function(N,U,te,j){N=x.getGraphDiv(N);var J=U.target;x.throttle(N._fullLayout._uid+h.HOVERID,h.HOVERMINTIME,function(){!function(X,re,ne,le,oe){ne||(ne="xy");var de=Array.isArray(ne)?ne:[ne],se=X._fullLayout,ge=se._plots||[],_e=ge[ne],Te=se._has("cartesian");if(_e){var we=_e.overlays.map(function(Rr){return Rr.id});de=de.concat(we)}for(var Oe=de.length,fe=new Array(Oe),ve=new Array(Oe),Ae=!1,ke=0;ke<Oe;ke++){var Pe=de[ke];if(ge[Pe])Ae=!0,fe[ke]=ge[Pe].xaxis,ve[ke]=ge[Pe].yaxis;else{if(!se[Pe]||!se[Pe]._subplot)return void x.warn("Unrecognized subplot: "+Pe);var Ne=se[Pe]._subplot;fe[ke]=Ne.xaxis,ve[ke]=Ne.yaxis}}var De=re.hovermode||se.hovermode;if(De&&!Ae&&(De="closest"),-1===["x","y","closest","x unified","y unified"].indexOf(De)||!X.calcdata||X.querySelector(".zoombox")||X._dragging)return i.unhoverRaw(X,re);var ze=se.hoverdistance;-1===ze&&(ze=1/0);var Me=se.spikedistance;-1===Me&&(Me=1/0);var Se,Ie,Fe,Re,Xe,nt,ct,xt,dt,tt,Ke,mt,Bt,Ut=[],er=[],Wt={hLinePoint:null,vLinePoint:null},rr=!1;if(Array.isArray(re))for(De="array",Fe=0;Fe<re.length;Fe++)(Xe=X.calcdata[re[Fe].curveNumber||0])&&(nt=Xe[0].trace,"skip"!==Xe[0].trace.hoverinfo&&(er.push(Xe),"h"===nt.orientation&&(rr=!0)));else{for(Re=0;Re<X.calcdata.length;Re++)"skip"!==(nt=(Xe=X.calcdata[Re])[0].trace).hoverinfo&&c.isTraceInSubplots(nt,de)&&(er.push(Xe),"h"===nt.orientation&&(rr=!0));var Ht,Ve;if(oe){if(!1===t.triggerHandler(X,"plotly_beforehover",re))return;var We=oe.getBoundingClientRect();Ht=re.clientX-We.left,Ve=re.clientY-We.top,se._calcInverseTransform(X);var he=x.apply3DTransform(se._invTransform)(Ht,Ve);if(Ve=he[1],(Ht=he[0])<0||Ht>fe[0]._length||Ve<0||Ve>ve[0]._length)return i.unhoverRaw(X,re)}else Ht="xpx"in re?re.xpx:fe[0]._length/2,Ve="ypx"in re?re.ypx:ve[0]._length/2;if(re.pointerX=Ht+fe[0]._offset,re.pointerY=Ve+ve[0]._offset,Se="xval"in re?c.flat(de,re.xval):c.p2c(fe,Ht),Ie="yval"in re?c.flat(de,re.yval):c.p2c(ve,Ve),!v(Se[0])||!v(Ie[0]))return x.warn("Fx.hover failed",re,X),i.unhoverRaw(X,re)}var ye=1/0;function Be(Rr,hn){for(Re=0;Re<er.length;Re++)if((Xe=er[Re])&&Xe[0]&&Xe[0].trace&&!0===(nt=Xe[0].trace).visible&&0!==nt._length&&-1===["carpet","contourcarpet"].indexOf(nt._module.name)){if("splom"===nt.type?ct=de[xt=0]:(ct=c.getSubplot(nt),xt=de.indexOf(ct)),c.isUnifiedHover(dt=De)&&(dt=dt.charAt(0)),mt={cd:Xe,trace:nt,xa:fe[xt],ya:ve[xt],maxHoverDistance:ze,maxSpikeDistance:Me,index:!1,distance:Math.min(ye,ze),spikeDistance:1/0,xSpike:void 0,ySpike:void 0,color:s.defaultLine,name:nt.name,x0:void 0,x1:void 0,y0:void 0,y1:void 0,xLabelVal:void 0,yLabelVal:void 0,zLabelVal:void 0,text:void 0},se[ct]&&(mt.subplot=se[ct]._subplot),se._splomScenes&&se._splomScenes[nt.uid]&&(mt.scene=se._splomScenes[nt.uid]),Bt=Ut.length,"array"===dt){var nn=re[Re];"pointNumber"in nn?(mt.index=nn.pointNumber,dt="closest"):(dt="","xval"in nn&&(tt=nn.xval,dt="x"),"yval"in nn&&(Ke=nn.yval,dt=dt?"closest":"y"))}else void 0!==Rr&&void 0!==hn?(tt=Rr,Ke=hn):(tt=Se[xt],Ke=Ie[xt]);if(0!==ze)if(nt._module&&nt._module.hoverPoints){var Hr=nt._module.hoverPoints(mt,tt,Ke,dt,{finiteRange:!0,hoverLayer:se._hoverlayer});if(Hr)for(var Fn,Un=0;Un<Hr.length;Un++)v((Fn=Hr[Un]).x0)&&v(Fn.y0)&&Ut.push(q(Fn,De))}else x.log("Unrecognized trace type in hover:",nt);if("closest"===De&&Ut.length>Bt&&(Ut.splice(0,Bt),ye=Ut[0].distance),Te&&0!==Me&&0===Ut.length){mt.distance=Me,mt.index=!1;var vn=nt._module.hoverPoints(mt,tt,Ke,"closest",{hoverLayer:se._hoverlayer});if(vn&&(vn=vn.filter(function(or){return or.spikeDistance<=Me})),vn&&vn.length){var Cn,li=vn.filter(function(or){return or.xa.showspikes&&"hovered data"!==or.xa.spikesnap});if(li.length){var tr=li[0];v(tr.x0)&&v(tr.y0)&&(Cn=Je(tr),(!Wt.vLinePoint||Wt.vLinePoint.spikeDistance>Cn.spikeDistance)&&(Wt.vLinePoint=Cn))}var mr=vn.filter(function(or){return or.ya.showspikes&&"hovered data"!==or.ya.spikesnap});if(mr.length){var Pt=mr[0];v(Pt.x0)&&v(Pt.y0)&&(Cn=Je(Pt),(!Wt.hLinePoint||Wt.hLinePoint.spikeDistance>Cn.spikeDistance)&&(Wt.hLinePoint=Cn))}}}}}function Ge(Rr,hn,nn){for(var Hr,Fn=null,Un=1/0,vn=0;vn<Rr.length;vn++)Hr=Rr[vn].spikeDistance,nn&&0===vn&&(Hr=-1/0),Hr<=Un&&Hr<=hn&&(Fn=Rr[vn],Un=Hr);return Fn}function Je(Rr){return Rr?{xa:Rr.xa,ya:Rr.ya,x:void 0!==Rr.xSpike?Rr.xSpike:(Rr.x0+Rr.x1)/2,y:void 0!==Rr.ySpike?Rr.ySpike:(Rr.y0+Rr.y1)/2,distance:Rr.distance,spikeDistance:Rr.spikeDistance,curveNumber:Rr.trace.index,color:Rr.color,pointNumber:Rr.index}:null}Be();var He={fullLayout:se,container:se._hoverlayer,event:re},st=X._spikepoints;X._spikepoints={vLinePoint:Wt.vLinePoint,hLinePoint:Wt.hLinePoint};var wt=function(){Ut.sort(function(Rr,hn){return Rr.distance-hn.distance}),Ut=function(Rr,hn){for(var nn=hn.charAt(0),Hr=[],Fn=[],Un=[],vn=0;vn<Rr.length;vn++){var Cn=Rr[vn];f.traceIs(Cn.trace,"bar-like")||f.traceIs(Cn.trace,"box-violin")?Un.push(Cn):Cn.trace[nn+"period"]?Fn.push(Cn):Hr.push(Cn)}return Hr.concat(Fn).concat(Un)}(Ut,De)};wt();var Ct=De.charAt(0),rt=("x"===Ct||"y"===Ct)&&Ut[0]&&I[Ut[0].trace.type];if(Te&&0!==Me&&0!==Ut.length){var ft=Ge(Ut.filter(function(Rr){return Rr.ya.showspikes}),Me,rt);Wt.hLinePoint=Je(ft);var Rt=Ge(Ut.filter(function(Rr){return Rr.xa.showspikes}),Me,rt);Wt.vLinePoint=Je(Rt)}if(0===Ut.length){var kt=i.unhoverRaw(X,re);return!Te||null===Wt.hLinePoint&&null===Wt.vLinePoint||W(st)&&V(X,Wt,He),kt}if(Te&&W(st)&&V(X,Wt,He),c.isXYhover(dt)&&0!==Ut[0].length&&"splom"!==Ut[0].trace.type){var Lt=Ut[0],Ee=(Ut=M[Lt.trace.type]?Ut.filter(function(Rr){return Rr.trace.index===Lt.trace.index}):[Lt]).length;Be(G("x",Lt,se),G("y",Lt,se));var ht,At=[],Ft={},Gt=0,jt=function(Rr){var hn=M[Rr.trace.type]?P(Rr):Rr.trace.index;if(Ft[hn]){var nn=Ft[hn]-1,Hr=At[nn];nn>0&&Math.abs(Rr.distance)<Math.abs(Hr.distance)&&(At[nn]=Rr)}else Gt++,Ft[hn]=Gt,At.push(Rr)};for(ht=0;ht<Ee;ht++)jt(Ut[ht]);for(ht=Ut.length-1;ht>Ee-1;ht--)jt(Ut[ht]);Ut=At,wt()}var fr=X._hoverdata,kr=[],ur=Y(X),Jt=$(X);for(Fe=0;Fe<Ut.length;Fe++){var $t=Ut[Fe],Qt=c.makeEventData($t,$t.trace,$t.cd);if(!1!==$t.hovertemplate){var cr=!1;$t.cd[$t.index]&&$t.cd[$t.index].ht&&(cr=$t.cd[$t.index].ht),$t.hovertemplate=cr||$t.trace.hovertemplate||!1}if($t.xa&&$t.ya){var gr=$t.x0+$t.xa._offset,Tr=$t.x1+$t.xa._offset,Fr=$t.y0+$t.ya._offset,Nr=$t.y1+$t.ya._offset,Xr=Math.min(gr,Tr),un=Math.max(gr,Tr),$r=Math.min(Fr,Nr),Pn=Math.max(Fr,Nr);Qt.bbox={x0:Xr+Jt,x1:un+Jt,y0:$r+ur,y1:Pn+ur}}$t.eventData=[Qt],kr.push(Qt)}X._hoverdata=kr;var gn="y"===De&&(er.length>1||Ut.length>1)||"closest"===De&&rr&&Ut.length>1,dn=s.combine(se.plot_bgcolor||s.background,se.paper_bgcolor),An=E(Ut,{gd:X,hovermode:De,rotateLabels:gn,bgColor:dn,container:se._hoverlayer,outerContainer:se._paper.node(),commonLabelOpts:se.hoverlabel,hoverdistance:se.hoverdistance});if(c.isUnifiedHover(De)||(function(Rr,hn,nn){var Hr,Fn,Un,vn,Cn,li,tr,mr=0,Pt=1,or=Rr.size(),hr=new Array(or),zr=0;function Dr(Vr){var Qr=Vr[0],en=Vr[Vr.length-1];if(Un=en.pos+en.dp+en.size-Qr.pmax,(Fn=Qr.pmin-Qr.pos-Qr.dp+Qr.size)>.01){for(Cn=Vr.length-1;Cn>=0;Cn--)Vr[Cn].dp+=Fn;Hr=!1}if(!(Un<.01)){if(Fn<-.01){for(Cn=Vr.length-1;Cn>=0;Cn--)Vr[Cn].dp-=Un;Hr=!1}if(Hr){var mn=0;for(vn=0;vn<Vr.length;vn++)(li=Vr[vn]).pos+li.dp+li.size>Qr.pmax&&mn++;for(vn=Vr.length-1;vn>=0&&!(mn<=0);vn--)(li=Vr[vn]).pos>Qr.pmax-1&&(li.del=!0,mn--);for(vn=0;vn<Vr.length&&!(mn<=0);vn++)if((li=Vr[vn]).pos<Qr.pmin+1)for(li.del=!0,mn--,Un=2*li.size,Cn=Vr.length-1;Cn>=0;Cn--)Vr[Cn].dp-=Un;for(vn=Vr.length-1;vn>=0&&!(mn<=0);vn--)(li=Vr[vn]).pos+li.dp+li.size>Qr.pmax&&(li.del=!0,mn--)}}}for(Rr.each(function(Vr){var Qr=Vr[hn],en="x"===Qr._id.charAt(0),mn=Qr.range;0===zr&&mn&&mn[0]>mn[1]!==en&&(Pt=-1),hr[zr++]=[{datum:Vr,traceIndex:Vr.trace.index,dp:0,pos:Vr.pos,posref:Vr.posref,size:Vr.by*(en?T:1)/2,pmin:0,pmax:en?nn.width:nn.height}]}),hr.sort(function(Vr,Qr){return Vr[0].posref-Qr[0].posref||Pt*(Qr[0].traceIndex-Vr[0].traceIndex)});!Hr&&mr<=or;){for(mr++,Hr=!0,vn=0;vn<hr.length-1;){var Ir=hr[vn],Mr=hr[vn+1],vr=Ir[Ir.length-1],xr=Mr[0];if((Fn=vr.pos+vr.dp+vr.size-xr.pos-xr.dp+xr.size)>.01&&vr.pmin===xr.pmin&&vr.pmax===xr.pmax){for(Cn=Mr.length-1;Cn>=0;Cn--)Mr[Cn].dp+=Fn;for(Ir.push.apply(Ir,Mr),hr.splice(vn+1,1),tr=0,Cn=Ir.length-1;Cn>=0;Cn--)tr+=Ir[Cn].dp;for(Un=tr/Ir.length,Cn=Ir.length-1;Cn>=0;Cn--)Ir[Cn].dp-=Un;Hr=!1}else vn++}hr.forEach(Dr)}for(vn=hr.length-1;vn>=0;vn--){var wr=hr[vn];for(Cn=wr.length-1;Cn>=0;Cn--){var Er=wr[Cn],qr=Er.datum;qr.offset=Er.dp,qr.del=Er.del}}}(An,gn?"xa":"ya",se),R(An,gn,se._invScaleX,se._invScaleY)),oe&&oe.tagName){var Zn=f.getComponentMethod("annotations","hasClickToShow")(X,kr);r(g.select(oe),Zn?"pointer":"")}!oe||le||!function(Rr,hn,nn){if(!nn||nn.length!==Rr._hoverdata.length)return!0;for(var Hr=nn.length-1;Hr>=0;Hr--){var Fn=nn[Hr],Un=Rr._hoverdata[Hr];if(Fn.curveNumber!==Un.curveNumber||String(Fn.pointNumber)!==String(Un.pointNumber)||String(Fn.pointNumbers)!==String(Un.pointNumbers))return!0}return!1}(X,0,fr)||(fr&&X.emit("plotly_unhover",{event:re,points:fr}),X.emit("plotly_hover",{event:re,points:X._hoverdata,xaxes:fe,yaxes:ve,xvals:Se,yvals:Ie}))}(N,U,te,j,J)})},Q.loneHover=function(N,U){var te=!0;Array.isArray(N)||(te=!1,N=[N]);var j=U.gd,J=Y(j),X=$(j),re=E(N.map(function(oe){var de=oe._x0||oe.x0||oe.x||0,se=oe._x1||oe.x1||oe.x||0,ge=oe._y0||oe.y0||oe.y||0,_e=oe._y1||oe.y1||oe.y||0,Te=oe.eventData;if(Te){var we=Math.min(de,se),Oe=Math.max(de,se),fe=Math.min(ge,_e),ve=Math.max(ge,_e),Ae=oe.trace;if(f.traceIs(Ae,"gl3d")){var ke=j._fullLayout[Ae.scene]._scene.container,Pe=ke.offsetLeft,Ne=ke.offsetTop;we+=Pe,Oe+=Pe,fe+=Ne,ve+=Ne}Te.bbox={x0:we+X,x1:Oe+X,y0:fe+J,y1:ve+J},U.inOut_bbox&&U.inOut_bbox.push(Te.bbox)}else Te=!1;return{color:oe.color||s.defaultLine,x0:oe.x0||oe.x||0,x1:oe.x1||oe.x||0,y0:oe.y0||oe.y||0,y1:oe.y1||oe.y||0,xLabel:oe.xLabel,yLabel:oe.yLabel,zLabel:oe.zLabel,text:oe.text,name:oe.name,idealAlign:oe.idealAlign,borderColor:oe.borderColor,fontFamily:oe.fontFamily,fontSize:oe.fontSize,fontColor:oe.fontColor,nameLength:oe.nameLength,textAlign:oe.textAlign,trace:oe.trace||{index:0,hoverinfo:""},xa:{_offset:0},ya:{_offset:0},index:0,hovertemplate:oe.hovertemplate||!1,hovertemplateLabels:oe.hovertemplateLabels||!1,eventData:Te}}),{gd:j,hovermode:"closest",rotateLabels:!1,bgColor:U.bgColor||s.background,container:g.select(U.container),outerContainer:U.outerContainer||U.container}),ne=0,le=0;return re.sort(function(oe,de){return oe.y0-de.y0}).each(function(oe,de){var se=oe.y0-oe.by/2;oe.offset=se-5<ne?ne-se+5:0,ne=se+oe.by+oe.offset,de===U.anchorIndex&&(le=oe.offset)}).each(function(oe){oe.offset-=le}),R(re,!1,j._fullLayout._invScaleX,j._fullLayout._invScaleY),te?re:re.node()};var S=/<extra>([\s\S]*)<\/extra>/;function E(N,U){var te=U.gd,j=te._fullLayout,J=U.hovermode,X=U.rotateLabels,re=U.bgColor,ne=U.container,le=U.outerContainer,oe=U.commonLabelOpts||{};if(0===N.length)return[[]];var de=U.fontFamily||h.HOVERFONT,se=U.fontSize||h.HOVERFONTSIZE,ge=N[0],_e=ge.xa,Te=ge.ya,we=J.charAt(0),Oe=ge[we+"Label"],fe=B(te,le),ve=fe.top,Ae=fe.width,ke=fe.height,Pe=void 0!==Oe&&ge.distance<=U.hoverdistance&&("x"===J||"y"===J);if(Pe){var Ne,De,ze=!0;for(Ne=0;Ne<N.length;Ne++)if(ze&&void 0===N[Ne].zLabel&&(ze=!1),De=N[Ne].hoverinfo||N[Ne].trace.hoverinfo){var Me=Array.isArray(De)?De:De.split("+");if(-1===Me.indexOf("all")&&-1===Me.indexOf(J)){Pe=!1;break}}ze&&(Pe=!1)}var Se=ne.selectAll("g.axistext").data(Pe?[0]:[]);if(Se.enter().append("g").classed("axistext",!0),Se.exit().remove(),Se.each(function(){var rt=g.select(this),ft=x.ensureSingle(rt,"path","",function(Tr){Tr.style({"stroke-width":"1px"})}),Rt=x.ensureSingle(rt,"text","",function(Tr){Tr.attr("data-notex",1)}),kt=oe.bgcolor||s.defaultLine,Lt=oe.bordercolor||s.contrast(kt),Ee=s.contrast(kt),Ye={family:oe.font.family||de,size:oe.font.size||se,color:oe.font.color||Ee};ft.style({fill:kt,stroke:Lt}),Rt.text(Oe).call(d.font,Ye).call(a.positionText,0,0).call(a.convertToTspans,te),rt.attr("transform","");var it,ht,At=B(te,Rt.node());if("x"===J){var Ft="top"===_e.side?"-":"";Rt.attr("text-anchor","middle").call(a.positionText,0,"top"===_e.side?ve-At.bottom-k-L:ve-At.top+k+L),ht=Te._offset+("top"===_e.side?0:Te._length);var Gt=At.width/2+L;(it=_e._offset+(ge.x0+ge.x1)/2)<Gt?(it=Gt,ft.attr("d","M-"+(Gt-k)+",0L-"+(Gt-2*k)+","+Ft+k+"H"+(L+At.width/2)+"v"+Ft+(2*L+At.height)+"H-"+Gt+"V"+Ft+k+"Z")):it>j.width-Gt?(it=j.width-Gt,ft.attr("d","M"+(Gt-k)+",0L"+Gt+","+Ft+k+"v"+Ft+(2*L+At.height)+"H-"+Gt+"V"+Ft+k+"H"+(Gt-2*k)+"Z")):ft.attr("d","M0,0L"+k+","+Ft+k+"H"+(L+At.width/2)+"v"+Ft+(2*L+At.height)+"H-"+(L+At.width/2)+"V"+Ft+k+"H-"+k+"Z")}else{var jt,fr,kr;"right"===Te.side?(jt="start",fr=1,kr="",it=_e._offset+_e._length):(jt="end",fr=-1,kr="-",it=_e._offset),ht=Te._offset+(ge.y0+ge.y1)/2,Rt.attr("text-anchor",jt),ft.attr("d","M0,0L"+kr+k+","+k+"V"+(L+At.height/2)+"h"+kr+(2*L+At.width)+"V-"+(L+At.height/2)+"H"+kr+k+"V-"+k+"Z");var ur,Jt=At.height/2,$t=ve-At.top-Jt,Qt="clip"+j._uid+"commonlabel"+Te._id;if(it<At.width+2*L+k){ur="M-"+(k+L)+"-"+Jt+"h-"+(At.width-L)+"V"+Jt+"h"+(At.width-L)+"Z";var cr=At.width-it+L;a.positionText(Rt,cr,$t),"end"===jt&&Rt.selectAll("tspan").each(function(){var Tr=g.select(this),Fr=d.tester.append("text").text(Tr.text()).call(d.font,Ye),Nr=B(te,Fr.node());Math.round(Nr.width)<Math.round(At.width)&&Tr.attr("x",cr-Nr.width),Fr.remove()})}else a.positionText(Rt,fr*(L+k),$t),ur=null;var gr=j._topclips.selectAll("#"+Qt).data(ur?[0]:[]);gr.enter().append("clipPath").attr("id",Qt).append("path"),gr.exit().remove(),gr.select("path").attr("d",ur),d.setClipUrl(Rt,ur?Qt:null,te)}rt.attr("transform",e(it,ht))}),c.isUnifiedHover(J)){ne.selectAll("g.hovertext").remove();var Ie=N.filter(function(rt){return"none"!==rt.hoverinfo});if(0===Ie.length)return;var Fe=j.hoverlabel,Re=Fe.font,nt={font:Re};p({showlegend:!0,legend:{title:{text:Oe,font:Re},font:Re,bgcolor:Fe.bgcolor,bordercolor:Fe.bordercolor,borderwidth:1,tracegroupgap:7,traceorder:j.legend?j.legend.traceorder:void 0,orientation:"v"}},nt,te._fullData);var ct=nt.legend;ct.entries=[];for(var xt=0;xt<Ie.length;xt++){var dt=Ie[xt];if("none"!==dt.hoverinfo){var tt=z(dt,!0,J,j,Oe),Ke=tt[0],mt=tt[1];dt.name=mt,dt.text=""!==mt?mt+" : "+Ke:Ke;var Bt=dt.cd[dt.index];Bt&&(Bt.mc&&(dt.mc=Bt.mc),Bt.mcc&&(dt.mc=Bt.mcc),Bt.mlc&&(dt.mlc=Bt.mlc),Bt.mlcc&&(dt.mlc=Bt.mlcc),Bt.mlw&&(dt.mlw=Bt.mlw),Bt.mrc&&(dt.mrc=Bt.mrc),Bt.dir&&(dt.dir=Bt.dir)),dt._distinct=!0,ct.entries.push([dt])}}ct.entries.sort(function(rt,ft){return rt[0].trace.index-ft[0].trace.index}),ct.layer=ne,ct._inHover=!0,ct._groupTitleFont=Fe.grouptitlefont,o(te,ct);var Ut,er,Wt,rr,Ht=ne.select("g.legend"),Ve=B(te,Ht.node()),We=Ve.width+2*L,he=Ve.height+2*L,ye=Ie[0],Be=(ye.x0+ye.x1)/2,Ge=(ye.y0+ye.y1)/2,Je=!(f.traceIs(ye.trace,"bar-like")||f.traceIs(ye.trace,"box-violin"));"y"===we?Je?(er=Ge-L,Ut=Ge+L):(er=Math.min.apply(null,Ie.map(function(rt){return Math.min(rt.y0,rt.y1)})),Ut=Math.max.apply(null,Ie.map(function(rt){return Math.max(rt.y0,rt.y1)}))):er=Ut=x.mean(Ie.map(function(rt){return(rt.y0+rt.y1)/2}))-he/2,"x"===we?Je?(Wt=Be+L,rr=Be-L):(Wt=Math.max.apply(null,Ie.map(function(rt){return Math.max(rt.x0,rt.x1)})),rr=Math.min.apply(null,Ie.map(function(rt){return Math.min(rt.x0,rt.x1)}))):Wt=rr=x.mean(Ie.map(function(rt){return(rt.x0+rt.x1)/2}))-We/2;var He,st,ot=_e._offset,wt=Te._offset;return rr+=ot-We,er+=wt-he,He=(Wt+=ot)+We<Ae&&Wt>=0?Wt:rr+We<Ae&&rr>=0?rr:ot+We<Ae?ot:Wt-Be<Be-rr+We?Ae-We:0,st=(Ut+=wt)+he<ke&&Ut>=0?Ut:er+he<ke&&er>=0?er:wt+he<ke?wt:Ut-Ge<Ge-er+he?ke-he:0,Ht.attr("transform",e((He+=L)-1,(st+=L)-1)),Ht}var Ct=ne.selectAll("g.hovertext").data(N,function(rt){return P(rt)});return Ct.enter().append("g").classed("hovertext",!0).each(function(){var rt=g.select(this);rt.append("rect").call(s.fill,s.addOpacity(re,.8)),rt.append("text").classed("name",!0),rt.append("path").style("stroke-width","1px"),rt.append("text").classed("nums",!0).call(d.font,de,se)}),Ct.exit().remove(),Ct.each(function(rt){var ft=g.select(this).attr("transform",""),Rt=rt.color;Array.isArray(Rt)&&(Rt=Rt[rt.eventData[0].pointNumber]);var kt=rt.bgcolor||Rt,Lt=s.combine(s.opacity(kt)?kt:s.defaultLine,re),Ee=s.combine(s.opacity(Rt)?Rt:s.defaultLine,re),Ye=rt.borderColor||s.contrast(Lt),it=z(rt,Pe,J,j,Oe,ft),ht=it[0],At=it[1],Ft=ft.select("text.nums").call(d.font,rt.fontFamily||de,rt.fontSize||se,rt.fontColor||Ye).text(ht).attr("data-notex",1).call(a.positionText,0,0).call(a.convertToTspans,te),Gt=ft.select("text.name"),jt=0,fr=0;if(At&&At!==ht){Gt.call(d.font,rt.fontFamily||de,rt.fontSize||se,Ee).text(At).attr("data-notex",1).call(a.positionText,0,0).call(a.convertToTspans,te);var kr=B(te,Gt.node());jt=kr.width+2*L,fr=kr.height+2*L}else Gt.remove(),ft.select("rect").remove();ft.select("path").style({fill:Lt,stroke:Ye});var ur=rt.xa._offset+(rt.x0+rt.x1)/2,Jt=rt.ya._offset+(rt.y0+rt.y1)/2,$t=Math.abs(rt.x1-rt.x0),Qt=Math.abs(rt.y1-rt.y0),cr=B(te,Ft.node()),gr=cr.width/j._invScaleX,Tr=cr.height/j._invScaleY;rt.ty0=(ve-cr.top)/j._invScaleY,rt.bx=gr+2*L,rt.by=Math.max(Tr+2*L,fr),rt.anchor="start",rt.txwidth=gr,rt.tx2width=jt,rt.offset=0;var Fr,Nr,Xr=(gr+k+L+jt)*j._invScaleX;if(X)rt.pos=ur,Fr=Jt+Qt/2+Xr<=ke,Nr=Jt-Qt/2-Xr>=0,"top"!==rt.idealAlign&&Fr||!Nr?Fr?(Jt+=Qt/2,rt.anchor="start"):rt.anchor="middle":(Jt-=Qt/2,rt.anchor="end");else if(rt.pos=Jt,Fr=ur+$t/2+Xr<=Ae,Nr=ur-$t/2-Xr>=0,"left"!==rt.idealAlign&&Fr||!Nr)if(Fr)ur+=$t/2,rt.anchor="start";else{rt.anchor="middle";var un=Xr/2,$r=ur+un-Ae,Pn=ur-un;$r>0&&(ur-=$r),Pn<0&&(ur+=-Pn)}else ur-=$t/2,rt.anchor="end";Ft.attr("text-anchor",rt.anchor),jt&&Gt.attr("text-anchor",rt.anchor),ft.attr("transform",e(ur,Jt)+(X?n(b):""))}),Ct}function z(N,U,te,j,J,X){var re="",ne="";void 0!==N.nameOverride&&(N.name=N.nameOverride),N.name&&(N.trace._meta&&(N.name=x.templateString(N.name,N.trace._meta)),re=K(N.name,N.nameLength));var le=te.charAt(0);void 0!==N.zLabel?(void 0!==N.xLabel&&(ne+="x: "+N.xLabel+"<br>"),void 0!==N.yLabel&&(ne+="y: "+N.yLabel+"<br>"),"choropleth"!==N.trace.type&&"choroplethmapbox"!==N.trace.type&&(ne+=(ne?"z: ":"")+N.zLabel)):U&&N[le+"Label"]===J?ne=N[("x"===le?"y":"x")+"Label"]||"":void 0===N.xLabel?void 0!==N.yLabel&&"scattercarpet"!==N.trace.type&&(ne=N.yLabel):ne=void 0===N.yLabel?N.xLabel:"("+N.xLabel+", "+N.yLabel+")",!N.text&&0!==N.text||Array.isArray(N.text)||(ne+=(ne?"<br>":"")+N.text),void 0!==N.extraText&&(ne+=(ne?"<br>":"")+N.extraText),X&&""===ne&&!N.hovertemplate&&(""===re&&X.remove(),ne=re);var de=N.hovertemplate||!1;if(de){var se=N.hovertemplateLabels||N;N[le+"Label"]!==J&&(se[le+"other"]=se[le+"Val"],se[le+"otherLabel"]=se[le+"Label"]),ne=(ne=x.hovertemplateString(de,se,j._d3locale,N.eventData[0]||{},N.trace._meta)).replace(S,function(ge,_e){return re=K(_e,N.nameLength),""})}return[ne,re]}function R(N,U,te,j){var J=function(re){return re*te},X=function(re){return re*j};N.each(function(re){var ne=g.select(this);if(re.del)return ne.remove();var le=ne.select("text.nums"),oe=re.anchor,de="end"===oe?-1:1,se={start:1,end:-1,middle:0}[oe],ge=se*(k+L),_e=ge+se*(re.txwidth+L),Te=0,we=re.offset,Oe="middle"===oe;Oe&&(ge-=re.tx2width/2,_e+=re.txwidth/2+L),U&&(we*=-w,Te=re.offset*_),ne.select("path").attr("d",Oe?"M-"+J(re.bx/2+re.tx2width/2)+","+X(we-re.by/2)+"h"+J(re.bx)+"v"+X(re.by)+"h-"+J(re.bx)+"Z":"M0,0L"+J(de*k+Te)+","+X(k+we)+"v"+X(re.by/2-k)+"h"+J(de*re.bx)+"v-"+X(re.by)+"H"+J(de*k+Te)+"V"+X(we-k)+"Z");var fe=Te+ge,ve=we+re.ty0-re.by/2+L,Ae=re.textAlign||"auto";"auto"!==Ae&&("left"===Ae&&"start"!==oe?(le.attr("text-anchor","start"),fe=Oe?-re.bx/2-re.tx2width/2+L:-re.bx-L):"right"===Ae&&"end"!==oe&&(le.attr("text-anchor","end"),fe=Oe?re.bx/2-re.tx2width/2-L:re.bx+L)),le.call(a.positionText,J(fe),X(ve)),re.tx2width&&(ne.select("text.name").call(a.positionText,J(_e+se*L+Te),X(we+re.ty0-re.by/2+L)),ne.select("rect").call(d.setRect,J(_e+(se-1)*re.tx2width/2+Te),X(we-re.by/2-1),J(re.tx2width),X(re.by+2)))})}function q(N,U){var te=N.index,j=N.trace||{},J=N.cd[0],X=N.cd[te]||{};function re(ge){return ge||v(ge)&&0===ge}var ne=Array.isArray(te)?function(ge,_e){var Te=x.castOption(J,te,ge);return re(Te)?Te:x.extractOption({},j,"",_e)}:function(ge,_e){return x.extractOption(X,j,ge,_e)};function le(ge,_e,Te){var we=ne(_e,Te);re(we)&&(N[ge]=we)}if(le("hoverinfo","hi","hoverinfo"),le("bgcolor","hbg","hoverlabel.bgcolor"),le("borderColor","hbc","hoverlabel.bordercolor"),le("fontFamily","htf","hoverlabel.font.family"),le("fontSize","hts","hoverlabel.font.size"),le("fontColor","htc","hoverlabel.font.color"),le("nameLength","hnl","hoverlabel.namelength"),le("textAlign","hta","hoverlabel.align"),N.posref="y"===U||"closest"===U&&"h"===j.orientation?N.xa._offset+(N.x0+N.x1)/2:N.ya._offset+(N.y0+N.y1)/2,N.x0=x.constrain(N.x0,0,N.xa._length),N.x1=x.constrain(N.x1,0,N.xa._length),N.y0=x.constrain(N.y0,0,N.ya._length),N.y1=x.constrain(N.y1,0,N.ya._length),void 0!==N.xLabelVal&&(N.xLabel="xLabel"in N?N.xLabel:u.hoverLabelText(N.xa,N.xLabelVal,j.xhoverformat),N.xVal=N.xa.c2d(N.xLabelVal)),void 0!==N.yLabelVal&&(N.yLabel="yLabel"in N?N.yLabel:u.hoverLabelText(N.ya,N.yLabelVal,j.yhoverformat),N.yVal=N.ya.c2d(N.yLabelVal)),void 0!==N.zLabelVal&&void 0===N.zLabel&&(N.zLabel=String(N.zLabelVal)),!(isNaN(N.xerr)||"log"===N.xa.type&&N.xerr<=0)){var oe=u.tickText(N.xa,N.xa.c2l(N.xerr),"hover").text;N.xLabel+=void 0!==N.xerrneg?" +"+oe+" / -"+u.tickText(N.xa,N.xa.c2l(N.xerrneg),"hover").text:" \xb1 "+oe,"x"===U&&(N.distance+=1)}if(!(isNaN(N.yerr)||"log"===N.ya.type&&N.yerr<=0)){var de=u.tickText(N.ya,N.ya.c2l(N.yerr),"hover").text;N.yLabel+=void 0!==N.yerrneg?" +"+de+" / -"+u.tickText(N.ya,N.ya.c2l(N.yerrneg),"hover").text:" \xb1 "+de,"y"===U&&(N.distance+=1)}var se=N.hoverinfo||N.trace.hoverinfo;return se&&"all"!==se&&(-1===(se=Array.isArray(se)?se:se.split("+")).indexOf("x")&&(N.xLabel=void 0),-1===se.indexOf("y")&&(N.yLabel=void 0),-1===se.indexOf("z")&&(N.zLabel=void 0),-1===se.indexOf("text")&&(N.text=void 0),-1===se.indexOf("name")&&(N.name=void 0)),N}function V(N,U,te){var j,J,X=te.container,re=te.fullLayout,ne=re._size,le=te.event,oe=!!U.hLinePoint,de=!!U.vLinePoint;if(X.selectAll(".spikeline").remove(),de||oe){var se=s.combine(re.plot_bgcolor,re.paper_bgcolor);if(oe){var ge,_e,Te=U.hLinePoint;j=Te&&Te.xa,"cursor"===(J=Te&&Te.ya).spikesnap?(ge=le.pointerX,_e=le.pointerY):(ge=j._offset+Te.x,_e=J._offset+Te.y);var we,Oe,fe=m.readability(Te.color,se)<1.5?s.contrast(se):Te.color,ve=J.spikemode,Ae=J.spikethickness,ke=J.spikecolor||fe,Pe=u.getPxPosition(N,J);if(-1!==ve.indexOf("toaxis")||-1!==ve.indexOf("across")){if(-1!==ve.indexOf("toaxis")&&(we=Pe,Oe=ge),-1!==ve.indexOf("across")){var Ne=J._counterDomainMin,De=J._counterDomainMax;"free"===J.anchor&&(Ne=Math.min(Ne,J.position),De=Math.max(De,J.position)),we=ne.l+Ne*ne.w,Oe=ne.l+De*ne.w}X.insert("line",":first-child").attr({x1:we,x2:Oe,y1:_e,y2:_e,"stroke-width":Ae,stroke:ke,"stroke-dasharray":d.dashStyle(J.spikedash,Ae)}).classed("spikeline",!0).classed("crisp",!0),X.insert("line",":first-child").attr({x1:we,x2:Oe,y1:_e,y2:_e,"stroke-width":Ae+2,stroke:se}).classed("spikeline",!0).classed("crisp",!0)}-1!==ve.indexOf("marker")&&X.insert("circle",":first-child").attr({cx:Pe+("right"!==J.side?Ae:-Ae),cy:_e,r:Ae,fill:ke}).classed("spikeline",!0)}if(de){var ze,Me,Se=U.vLinePoint;J=Se&&Se.ya,"cursor"===(j=Se&&Se.xa).spikesnap?(ze=le.pointerX,Me=le.pointerY):(ze=j._offset+Se.x,Me=J._offset+Se.y);var Ie,Fe,Re=m.readability(Se.color,se)<1.5?s.contrast(se):Se.color,Xe=j.spikemode,nt=j.spikethickness,ct=j.spikecolor||Re,xt=u.getPxPosition(N,j);if(-1!==Xe.indexOf("toaxis")||-1!==Xe.indexOf("across")){if(-1!==Xe.indexOf("toaxis")&&(Ie=xt,Fe=Me),-1!==Xe.indexOf("across")){var dt=j._counterDomainMin,tt=j._counterDomainMax;"free"===j.anchor&&(dt=Math.min(dt,j.position),tt=Math.max(tt,j.position)),Ie=ne.t+(1-tt)*ne.h,Fe=ne.t+(1-dt)*ne.h}X.insert("line",":first-child").attr({x1:ze,x2:ze,y1:Ie,y2:Fe,"stroke-width":nt,stroke:ct,"stroke-dasharray":d.dashStyle(j.spikedash,nt)}).classed("spikeline",!0).classed("crisp",!0),X.insert("line",":first-child").attr({x1:ze,x2:ze,y1:Ie,y2:Fe,"stroke-width":nt+2,stroke:se}).classed("spikeline",!0).classed("crisp",!0)}-1!==Xe.indexOf("marker")&&X.insert("circle",":first-child").attr({cx:ze,cy:xt-("top"!==j.side?nt:-nt),r:nt,fill:ct}).classed("spikeline",!0)}}}function W(N,U){return!U||U.vLinePoint!==N._spikepoints.vLinePoint||U.hLinePoint!==N._spikepoints.hLinePoint}function K(N,U){return a.plainText(N||"",{len:U,allowedTags:["br","sub","sup","b","i","em"]})}function G(N,U,te){var j=U[N+"a"],J=U[N+"Val"],X=U.cd[0];if("category"===j.type)J=j._categoriesMap[J];else if("date"===j.type){var re=U.trace[N+"periodalignment"];if(re){var ne=U.cd[U.index],le=ne[N+"Start"];void 0===le&&(le=ne[N]);var oe=ne[N+"End"];void 0===oe&&(oe=ne[N]);var de=oe-le;"end"===re?J+=de:"middle"===re&&(J+=de/2)}J=j.d2c(J)}return X&&X.t&&X.t.posLetter===j._id&&("group"!==te.boxmode&&"group"!==te.violinmode||(J+=X.t.dPos)),J}function Y(N){return N.offsetTop+N.clientTop}function $(N){return N.offsetLeft+N.clientLeft}function B(N,U){var te=N._fullLayout,j=U.getBoundingClientRect(),J=j.x,X=j.y,re=J+j.width,ne=X+j.height,le=x.apply3DTransform(te._invTransform)(J,X),oe=x.apply3DTransform(te._invTransform)(re,ne),de=le[0],se=le[1],ge=oe[0],_e=oe[1];return{x:de,y:se,width:ge-de,height:_e-se,top:Math.min(se,_e),left:Math.min(de,ge),right:Math.max(de,ge),bottom:Math.max(se,_e)}}},{"../../lib":515,"../../lib/events":504,"../../lib/override_cursor":526,"../../lib/svg_text_utils":541,"../../plots/cartesian/axes":566,"../../registry":647,"../color":367,"../dragelement":386,"../drawing":389,"../legend/defaults":419,"../legend/draw":420,"./constants":401,"./helpers":403,"@plotly/d3":58,"fast-isnumeric":190,tinycolor2:313}],405:[function(y,ee,Q){"use strict";var g=y("../../lib"),v=y("../color"),m=y("./helpers").isUnifiedHover;ee.exports=function(x,e,n,t){t=t||{};var a=e.legend;function r(d){t.font[d]||(t.font[d]=a?e.legend.font[d]:e.font[d])}e&&m(e.hovermode)&&(t.font||(t.font={}),r("size"),r("family"),r("color"),a?(t.bgcolor||(t.bgcolor=v.combine(e.legend.bgcolor,e.paper_bgcolor)),t.bordercolor||(t.bordercolor=e.legend.bordercolor)):t.bgcolor||(t.bgcolor=e.paper_bgcolor)),n("hoverlabel.bgcolor",t.bgcolor),n("hoverlabel.bordercolor",t.bordercolor),n("hoverlabel.namelength",t.namelength),g.coerceFont(n,"hoverlabel.font",t.font),n("hoverlabel.align",t.align)}},{"../../lib":515,"../color":367,"./helpers":403}],406:[function(y,ee,Q){"use strict";var g=y("../../lib"),v=y("./layout_attributes");ee.exports=function(m,x){function e(n,t){return void 0!==x[n]?x[n]:g.coerce(m,x,v,n,t)}return e("clickmode"),e("hovermode")}},{"../../lib":515,"./layout_attributes":408}],407:[function(y,ee,Q){"use strict";var g=y("@plotly/d3"),v=y("../../lib"),m=y("../dragelement"),x=y("./helpers"),e=y("./layout_attributes"),n=y("./hover");ee.exports={moduleType:"component",name:"fx",constants:y("./constants"),schema:{layout:e},attributes:y("./attributes"),layoutAttributes:e,supplyLayoutGlobalDefaults:y("./layout_global_defaults"),supplyDefaults:y("./defaults"),supplyLayoutDefaults:y("./layout_defaults"),calc:y("./calc"),getDistanceFunction:x.getDistanceFunction,getClosest:x.getClosest,inbox:x.inbox,quadrature:x.quadrature,appendArrayPointValue:x.appendArrayPointValue,castHoverOption:function(t,a,r){return v.castOption(t,a,"hoverlabel."+r)},castHoverinfo:function(t,a,r){return v.castOption(t,r,"hoverinfo",function(d){return v.coerceHoverinfo({hoverinfo:d},{_module:t._module},a)})},hover:n.hover,unhover:m.unhover,loneHover:n.loneHover,loneUnhover:function(t){var a=v.isD3Selection(t)?t:g.select(t);a.selectAll("g.hovertext").remove(),a.selectAll(".spikeline").remove()},click:y("./click")}},{"../../lib":515,"../dragelement":386,"./attributes":398,"./calc":399,"./click":400,"./constants":401,"./defaults":402,"./helpers":403,"./hover":404,"./layout_attributes":408,"./layout_defaults":409,"./layout_global_defaults":410,"@plotly/d3":58}],408:[function(y,ee,Q){"use strict";var g=y("./constants"),v=y("../../plots/font_attributes"),m=v({editType:"none"});m.family.dflt=g.HOVERFONT,m.size.dflt=g.HOVERFONTSIZE,ee.exports={clickmode:{valType:"flaglist",flags:["event","select"],dflt:"event",editType:"plot",extras:["none"]},dragmode:{valType:"enumerated",values:["zoom","pan","select","lasso","drawclosedpath","drawopenpath","drawline","drawrect","drawcircle","orbit","turntable",!1],dflt:"zoom",editType:"modebar"},hovermode:{valType:"enumerated",values:["x","y","closest",!1,"x unified","y unified"],dflt:"closest",editType:"modebar"},hoverdistance:{valType:"integer",min:-1,dflt:20,editType:"none"},spikedistance:{valType:"integer",min:-1,dflt:-1,editType:"none"},hoverlabel:{bgcolor:{valType:"color",editType:"none"},bordercolor:{valType:"color",editType:"none"},font:m,grouptitlefont:v({editType:"none"}),align:{valType:"enumerated",values:["left","right","auto"],dflt:"auto",editType:"none"},namelength:{valType:"integer",min:-1,dflt:15,editType:"none"},editType:"none"},selectdirection:{valType:"enumerated",values:["h","v","d","any"],dflt:"any",editType:"none"}}},{"../../plots/font_attributes":594,"./constants":401}],409:[function(y,ee,Q){"use strict";var g=y("../../lib"),v=y("./layout_attributes"),m=y("./hovermode_defaults"),x=y("./hoverlabel_defaults");ee.exports=function(e,n){function t(s,i){return g.coerce(e,n,v,s,i)}m(e,n)&&(t("hoverdistance"),t("spikedistance")),"select"===t("dragmode")&&t("selectdirection");var a=n._has("mapbox"),r=n._has("geo"),d=n._basePlotModules.length;"zoom"===n.dragmode&&((a||r)&&1===d||a&&r&&2===d)&&(n.dragmode="pan"),x(e,n,t),g.coerceFont(t,"hoverlabel.grouptitlefont",n.hoverlabel.font)}},{"../../lib":515,"./hoverlabel_defaults":405,"./hovermode_defaults":406,"./layout_attributes":408}],410:[function(y,ee,Q){"use strict";var g=y("../../lib"),v=y("./hoverlabel_defaults"),m=y("./layout_attributes");ee.exports=function(x,e){v(x,e,function(n,t){return g.coerce(x,e,m,n,t)})}},{"../../lib":515,"./hoverlabel_defaults":405,"./layout_attributes":408}],411:[function(y,ee,Q){"use strict";var g=y("../../lib"),v=y("../../lib/regex").counter,m=y("../../plots/domain").attributes,x=y("../../plots/cartesian/constants").idRegex,e=y("../../plot_api/plot_template"),n={rows:{valType:"integer",min:1,editType:"plot"},roworder:{valType:"enumerated",values:["top to bottom","bottom to top"],dflt:"top to bottom",editType:"plot"},columns:{valType:"integer",min:1,editType:"plot"},subplots:{valType:"info_array",freeLength:!0,dimensions:2,items:{valType:"enumerated",values:[v("xy").toString(),""],editType:"plot"},editType:"plot"},xaxes:{valType:"info_array",freeLength:!0,items:{valType:"enumerated",values:[x.x.toString(),""],editType:"plot"},editType:"plot"},yaxes:{valType:"info_array",freeLength:!0,items:{valType:"enumerated",values:[x.y.toString(),""],editType:"plot"},editType:"plot"},pattern:{valType:"enumerated",values:["independent","coupled"],dflt:"coupled",editType:"plot"},xgap:{valType:"number",min:0,max:1,editType:"plot"},ygap:{valType:"number",min:0,max:1,editType:"plot"},domain:m({name:"grid",editType:"plot",noGridCell:!0},{}),xside:{valType:"enumerated",values:["bottom","bottom plot","top plot","top"],dflt:"bottom plot",editType:"plot"},yside:{valType:"enumerated",values:["left","left plot","right plot","right"],dflt:"left plot",editType:"plot"},editType:"plot"};function t(d,s,i){var u=s[i+"axes"],f=Object.keys((d._splomAxes||{})[i]||{});return Array.isArray(u)?u:f.length?f:void 0}function a(d,s,i,u,f,c){var h=s(d+"gap",i),p=s("domain."+d);s(d+"side",u);for(var o=new Array(f),b=p[0],l=(p[1]-b)/(f-h),T=l*(1-h),_=0;_<f;_++){var w=b+l*_;o[c?f-1-_:_]=[w,w+T]}return o}function r(d,s,i,u,f){var c,h=new Array(i);function p(o,b){-1!==s.indexOf(b)&&void 0===u[b]?(h[o]=b,u[b]=o):h[o]=""}if(Array.isArray(d))for(c=0;c<i;c++)p(c,d[c]);else for(p(0,f),c=1;c<i;c++)p(c,f+(c+1));return h}ee.exports={moduleType:"component",name:"grid",schema:{layout:{grid:n}},layoutAttributes:n,sizeDefaults:function(d,s){var i=d.grid||{},u=t(s,i,"x"),f=t(s,i,"y");if(d.grid||u||f){var c,h,p=Array.isArray(i.subplots)&&Array.isArray(i.subplots[0]),o=Array.isArray(u),b=Array.isArray(f),l=o&&u!==i.xaxes&&b&&f!==i.yaxes;p?(c=i.subplots.length,h=i.subplots[0].length):(b&&(c=f.length),o&&(h=u.length));var T=e.newContainer(s,"grid"),_=S("rows",c),w=S("columns",h);if(_*w>1){!p&&!o&&!b&&"independent"===S("pattern")&&(p=!0),T._hasSubplotGrid=p;var k,L,M="top to bottom"===S("roworder"),P=p?.3:.1;l&&s._splomGridDflt&&(k=s._splomGridDflt.xside,L=s._splomGridDflt.yside),T._domains={x:a("x",S,p?.2:.1,k,w),y:a("y",S,P,L,_,M)}}else delete s.grid}function S(E,z){return g.coerce(i,T,n,E,z)}},contentDefaults:function(d,s){var i=s.grid;if(i&&i._domains){var u,f,c,h,p,o,b,l=d.grid||{},T=s._subplots,_=i._hasSubplotGrid,w=i.rows,k=i.columns,L="independent"===i.pattern,M=i._axisMap={};if(_){var I=l.subplots||[];o=i.subplots=new Array(w);var P=1;for(u=0;u<w;u++){var S=o[u]=new Array(k),E=I[u]||[];for(f=0;f<k;f++)if(L?(p=1===P?"xy":"x"+P+"y"+P,P++):p=E[f],S[f]="",-1!==T.cartesian.indexOf(p)){if(b=p.indexOf("y"),c=p.slice(0,b),h=p.slice(b),void 0!==M[c]&&M[c]!==f||void 0!==M[h]&&M[h]!==u)continue;S[f]=p,M[c]=f,M[h]=u}}}else{var z=t(s,l,"x"),R=t(s,l,"y");i.xaxes=r(z,T.xaxis,k,M,"x"),i.yaxes=r(R,T.yaxis,w,M,"y")}var q=i._anchors={},V="top to bottom"===i.roworder;for(var W in M){var K,G,Y,$=W.charAt(0),B=i[$+"side"];if(B.length<8)q[W]="free";else if("x"===$){if("t"===B.charAt(0)===V?(K=0,G=1,Y=w):(K=w-1,G=-1,Y=-1),_){var N=M[W];for(u=K;u!==Y;u+=G)if((p=o[u][N])&&(b=p.indexOf("y"),p.slice(0,b)===W)){q[W]=p.slice(b);break}}else for(u=K;u!==Y;u+=G)if(-1!==T.cartesian.indexOf(W+(h=i.yaxes[u]))){q[W]=h;break}}else if("l"===B.charAt(0)?(K=0,G=1,Y=k):(K=k-1,G=-1,Y=-1),_){var U=M[W];for(u=K;u!==Y;u+=G)if((p=o[U][u])&&(b=p.indexOf("y"),p.slice(b)===W)){q[W]=p.slice(0,b);break}}else for(u=K;u!==Y;u+=G)if(-1!==T.cartesian.indexOf((c=i.xaxes[u])+W)){q[W]=c;break}}}}}},{"../../lib":515,"../../lib/regex":532,"../../plot_api/plot_template":555,"../../plots/cartesian/constants":573,"../../plots/domain":593}],412:[function(y,ee,Q){"use strict";var g=y("../../plots/cartesian/constants"),v=y("../../plot_api/plot_template").templatedArray;y("../../constants/axis_placeable_objects"),ee.exports=v("image",{visible:{valType:"boolean",dflt:!0,editType:"arraydraw"},source:{valType:"string",editType:"arraydraw"},layer:{valType:"enumerated",values:["below","above"],dflt:"above",editType:"arraydraw"},sizex:{valType:"number",dflt:0,editType:"arraydraw"},sizey:{valType:"number",dflt:0,editType:"arraydraw"},sizing:{valType:"enumerated",values:["fill","contain","stretch"],dflt:"contain",editType:"arraydraw"},opacity:{valType:"number",min:0,max:1,dflt:1,editType:"arraydraw"},x:{valType:"any",dflt:0,editType:"arraydraw"},y:{valType:"any",dflt:0,editType:"arraydraw"},xanchor:{valType:"enumerated",values:["left","center","right"],dflt:"left",editType:"arraydraw"},yanchor:{valType:"enumerated",values:["top","middle","bottom"],dflt:"top",editType:"arraydraw"},xref:{valType:"enumerated",values:["paper",g.idRegex.x.toString()],dflt:"paper",editType:"arraydraw"},yref:{valType:"enumerated",values:["paper",g.idRegex.y.toString()],dflt:"paper",editType:"arraydraw"},editType:"arraydraw"})},{"../../constants/axis_placeable_objects":484,"../../plot_api/plot_template":555,"../../plots/cartesian/constants":573}],413:[function(y,ee,Q){"use strict";var g=y("fast-isnumeric"),v=y("../../lib/to_log_range");ee.exports=function(m,x,e,n){x=x||{};var t="log"===e&&"linear"===x.type;if(t||"linear"===e&&"log"===x.type)for(var r,d,s=m._fullLayout.images,i=x._id.charAt(0),u=0;u<s.length;u++)if(d="images["+u+"].",(r=s[u])[i+"ref"]===x._id){var f=r[i],c=r["size"+i],h=null,p=null;if(t){h=v(f,x.range);var o=c/Math.pow(10,h)/2;p=2*Math.log(o+Math.sqrt(1+o*o))/Math.LN10}else p=(h=Math.pow(10,f))*(Math.pow(10,c/2)-Math.pow(10,-c/2));g(h)?g(p)||(p=null):(h=null,p=null),n(d+i,h),n(d+"size"+i,p)}}},{"../../lib/to_log_range":543,"fast-isnumeric":190}],414:[function(y,ee,Q){"use strict";var g=y("../../lib"),v=y("../../plots/cartesian/axes"),m=y("../../plots/array_container_defaults"),x=y("./attributes");function e(n,t,a){function r(h,p){return g.coerce(n,t,x,h,p)}var d=r("source");if(!r("visible",!!d))return t;r("layer"),r("xanchor"),r("yanchor"),r("sizex"),r("sizey"),r("sizing"),r("opacity");for(var s={_fullLayout:a},i=["x","y"],u=0;u<2;u++){var f=i[u],c=v.coerceRef(n,t,s,f,"paper",void 0);"paper"!==c&&v.getFromId(s,c)._imgIndices.push(t._index),v.coercePosition(t,s,r,c,f,0)}return t}ee.exports=function(n,t){m(n,t,{name:"images",handleItemDefaults:e})}},{"../../lib":515,"../../plots/array_container_defaults":561,"../../plots/cartesian/axes":566,"./attributes":412}],415:[function(y,ee,Q){"use strict";var g=y("@plotly/d3"),v=y("../drawing"),m=y("../../plots/cartesian/axes"),x=y("../../plots/cartesian/axis_ids"),e=y("../../constants/xmlns_namespaces");ee.exports=function(n){var t,a,r=n._fullLayout,d=[],s={},i=[];for(a=0;a<r.images.length;a++){var u=r.images[a];if(u.visible)if("below"===u.layer&&"paper"!==u.xref&&"paper"!==u.yref){t=x.ref2id(u.xref)+x.ref2id(u.yref);var f=r._plots[t];if(!f){i.push(u);continue}f.mainplot&&(t=f.mainplot.id),s[t]||(s[t]=[]),s[t].push(u)}else"above"===u.layer?d.push(u):i.push(u)}var c={left:{sizing:"xMin",offset:0},center:{sizing:"xMid",offset:-.5},right:{sizing:"xMax",offset:-1}},h={top:{sizing:"YMin",offset:0},middle:{sizing:"YMid",offset:-.5},bottom:{sizing:"YMax",offset:-1}};function p(k){var L=g.select(this);if(this._imgSrc!==k.source)if(L.attr("xmlns",e.svg),k.source&&"data:"===k.source.slice(0,5))L.attr("xlink:href",k.source),this._imgSrc=k.source;else{var M=new Promise(function(I){var P=new Image;function S(){L.remove(),I()}this.img=P,P.setAttribute("crossOrigin","anonymous"),P.onerror=S,P.onload=function(){var E=document.createElement("canvas");E.width=this.width,E.height=this.height,E.getContext("2d",{willReadFrequently:!0}).drawImage(this,0,0);var z=E.toDataURL("image/png");L.attr("xlink:href",z),I()},L.on("error",S),P.src=k.source,this._imgSrc=k.source}.bind(this));n._promises.push(M)}}function o(k){var L,M,I=g.select(this),P=m.getFromId(n,k.xref),S=m.getFromId(n,k.yref),E="domain"===m.getRefType(k.xref),z="domain"===m.getRefType(k.yref),R=r._size;L=void 0!==P?"string"==typeof k.xref&&E?P._length*k.sizex:Math.abs(P.l2p(k.sizex)-P.l2p(0)):k.sizex*R.w,M=void 0!==S?"string"==typeof k.yref&&z?S._length*k.sizey:Math.abs(S.l2p(k.sizey)-S.l2p(0)):k.sizey*R.h;var q,V,W=L*c[k.xanchor].offset,K=M*h[k.yanchor].offset,G=c[k.xanchor].sizing+h[k.yanchor].sizing;switch(q=void 0!==P?"string"==typeof k.xref&&E?P._length*k.x+P._offset:P.r2p(k.x)+P._offset:k.x*R.w+R.l,q+=W,V=void 0!==S?"string"==typeof k.yref&&z?S._length*(1-k.y)+S._offset:S.r2p(k.y)+S._offset:R.h-k.y*R.h+R.t,V+=K,k.sizing){case"fill":G+=" slice";break;case"stretch":G="none"}I.attr({x:q,y:V,width:L,height:M,preserveAspectRatio:G,opacity:k.opacity});var Y=(P&&"domain"!==m.getRefType(k.xref)?P._id:"")+(S&&"domain"!==m.getRefType(k.yref)?S._id:"");v.setClipUrl(I,Y?"clip"+r._uid+Y:null,n)}var b=r._imageLowerLayer.selectAll("image").data(i),l=r._imageUpperLayer.selectAll("image").data(d);b.enter().append("image"),l.enter().append("image"),b.exit().remove(),l.exit().remove(),b.each(function(k){p.bind(this)(k),o.bind(this)(k)}),l.each(function(k){p.bind(this)(k),o.bind(this)(k)});var T=Object.keys(r._plots);for(a=0;a<T.length;a++){var _=r._plots[t=T[a]];if(_.imagelayer){var w=_.imagelayer.selectAll("image").data(s[t]||[]);w.enter().append("image"),w.exit().remove(),w.each(function(k){p.bind(this)(k),o.bind(this)(k)})}}}},{"../../constants/xmlns_namespaces":492,"../../plots/cartesian/axes":566,"../../plots/cartesian/axis_ids":570,"../drawing":389,"@plotly/d3":58}],416:[function(y,ee,Q){"use strict";ee.exports={moduleType:"component",name:"images",layoutAttributes:y("./attributes"),supplyLayoutDefaults:y("./defaults"),includeBasePlot:y("../../plots/cartesian/include_components")("images"),draw:y("./draw"),convertCoords:y("./convert_coords")}},{"../../plots/cartesian/include_components":577,"./attributes":412,"./convert_coords":413,"./defaults":414,"./draw":415}],417:[function(y,ee,Q){"use strict";var g=y("../../plots/font_attributes"),v=y("../color/attributes");ee.exports={bgcolor:{valType:"color",editType:"legend"},bordercolor:{valType:"color",dflt:v.defaultLine,editType:"legend"},borderwidth:{valType:"number",min:0,dflt:0,editType:"legend"},font:g({editType:"legend"}),grouptitlefont:g({editType:"legend"}),orientation:{valType:"enumerated",values:["v","h"],dflt:"v",editType:"legend"},traceorder:{valType:"flaglist",flags:["reversed","grouped"],extras:["normal"],editType:"legend"},tracegroupgap:{valType:"number",min:0,dflt:10,editType:"legend"},itemsizing:{valType:"enumerated",values:["trace","constant"],dflt:"trace",editType:"legend"},itemwidth:{valType:"number",min:30,dflt:30,editType:"legend"},itemclick:{valType:"enumerated",values:["toggle","toggleothers",!1],dflt:"toggle",editType:"legend"},itemdoubleclick:{valType:"enumerated",values:["toggle","toggleothers",!1],dflt:"toggleothers",editType:"legend"},groupclick:{valType:"enumerated",values:["toggleitem","togglegroup"],dflt:"togglegroup",editType:"legend"},x:{valType:"number",min:-2,max:3,editType:"legend"},xanchor:{valType:"enumerated",values:["auto","left","center","right"],dflt:"left",editType:"legend"},y:{valType:"number",min:-2,max:3,editType:"legend"},yanchor:{valType:"enumerated",values:["auto","top","middle","bottom"],editType:"legend"},uirevision:{valType:"any",editType:"none"},valign:{valType:"enumerated",values:["top","middle","bottom"],dflt:"middle",editType:"legend"},title:{text:{valType:"string",dflt:"",editType:"legend"},font:g({editType:"legend"}),side:{valType:"enumerated",values:["top","left","top left"],editType:"legend"},editType:"legend"},editType:"legend"}},{"../../plots/font_attributes":594,"../color/attributes":366}],418:[function(y,ee,Q){"use strict";ee.exports={scrollBarWidth:6,scrollBarMinHeight:20,scrollBarColor:"#808BA4",scrollBarMargin:4,scrollBarEnterAttrs:{rx:20,ry:3,width:0,height:0},titlePad:2,itemGap:5}},{}],419:[function(y,ee,Q){"use strict";var g=y("../../registry"),v=y("../../lib"),m=y("../../plot_api/plot_template"),x=y("../../plots/attributes"),e=y("./attributes"),n=y("../../plots/layout_attributes"),t=y("./helpers");ee.exports=function(a,r,d){var s,i=a.legend||{},u=m.newContainer(r,"legend");function f(S,E){return v.coerce(i,u,e,S,E)}for(var c=function(S,E){return v.coerce(s._input,s,x,S,E)},h=r.font||{},p=v.coerceFont(f,"grouptitlefont",v.extendFlat({},h,{size:Math.round(1.1*h.size)})),o=0,b=!1,l="normal",T=0;T<d.length;T++)(s=d[T]).visible&&((s.showlegend||s._dfltShowLegend&&!(s._module&&s._module.attributes&&s._module.attributes.showlegend&&!1===s._module.attributes.showlegend.dflt))&&(o++,s.showlegend&&(b=!0,(g.traceIs(s,"pie-like")||!0===s._input.showlegend)&&o++),v.coerceFont(c,"legendgrouptitle.font",p)),(g.traceIs(s,"bar")&&"stack"===r.barmode||-1!==["tonextx","tonexty"].indexOf(s.fill))&&(l=t.isGrouped({traceorder:l})?"grouped+reversed":"reversed"),void 0!==s.legendgroup&&""!==s.legendgroup&&(l=t.isReversed({traceorder:l})?"reversed+grouped":"grouped"));var _=v.coerce(a,r,n,"showlegend",b&&o>1);if(!1===_&&(r.legend=void 0),(!1!==_||i.uirevision)&&(f("uirevision",r.uirevision),!1!==_)){f("bgcolor",r.paper_bgcolor),f("bordercolor"),f("borderwidth");var w,k,L,M=v.coerceFont(f,"font",r.font),I="h"===f("orientation");if(I?(w=0,g.getComponentMethod("rangeslider","isVisible")(a.xaxis)?(k=1.1,L="bottom"):(k=-.1,L="top")):(w=1.02,k=1,L="auto"),f("traceorder",l),t.isGrouped(r.legend)&&f("tracegroupgap"),f("itemsizing"),f("itemwidth"),f("itemclick"),f("itemdoubleclick"),f("groupclick"),f("x",w),f("xanchor"),f("y",k),f("yanchor",L),f("valign"),v.noneOrAll(i,u,["x","y"]),f("title.text")){f("title.side",I?"left":"top");var P=v.extendFlat({},M,{size:v.bigFont(M.size)});v.coerceFont(f,"title.font",P)}}}},{"../../lib":515,"../../plot_api/plot_template":555,"../../plots/attributes":562,"../../plots/layout_attributes":619,"../../registry":647,"./attributes":417,"./helpers":423}],420:[function(y,ee,Q){"use strict";var g=y("@plotly/d3"),v=y("../../lib"),m=y("../../plots/plots"),x=y("../../registry"),e=y("../../lib/events"),n=y("../dragelement"),t=y("../drawing"),a=y("../color"),r=y("../../lib/svg_text_utils"),d=y("./handle_click"),s=y("./constants"),i=y("../../constants/alignment"),u=i.LINE_SPACING,f=i.FROM_TL,c=i.FROM_BR,h=y("./get_legend_data"),p=y("./style"),o=y("./helpers");function b(M,I,P,S,E){var z=P.data()[0][0].trace,R={event:E,node:P.node(),curveNumber:z.index,expandedIndex:z._expandedIndex,data:M.data,layout:M.layout,frames:M._transitionData._frames,config:M._context,fullData:M._fullData,fullLayout:M._fullLayout};z._group&&(R.group=z._group),x.traceIs(z,"pie-like")&&(R.label=P.datum()[0].label),!1!==e.triggerHandler(M,"plotly_legendclick",R)&&(1===S?I._clickTimeout=setTimeout(function(){M._fullLayout&&d(P,M,S)},M._context.doubleClickDelay):2===S&&(I._clickTimeout&&clearTimeout(I._clickTimeout),M._legendMouseDownTime=0,!1!==e.triggerHandler(M,"plotly_legenddoubleclick",R)&&d(P,M,S)))}function l(M,I,P){var S,E,z=M.data()[0][0],R=z.trace,q=x.traceIs(R,"pie-like"),V=!P._inHover&&I._context.edits.legendText&&!q,W=P._maxNameLength;z.groupTitle?(S=z.groupTitle.text,E=z.groupTitle.font):(E=P.font,P.entries?S=z.text:(S=q?z.label:R.name,R._meta&&(S=v.templateString(S,R._meta))));var K=v.ensureSingle(M,"text","legendtext");K.attr("text-anchor","start").call(t.font,E).text(V?T(S,W):S),r.positionText(K,P.itemwidth+2*s.itemGap,0),V?K.call(r.makeEditable,{gd:I,text:S}).call(w,M,I,P).on("edit",function(Y){this.text(T(Y,W)).call(w,M,I,P);var $=z.trace._fullInput||{},B={};if(x.hasTransform($,"groupby")){var N=x.getTransformIndices($,"groupby"),te=v.keyedContainer($,"transforms["+N[N.length-1]+"].styles","target","value.name");te.set(z.trace._group,Y),B=te.constructUpdate()}else B.name=Y;return x.call("_guiRestyle",I,B,R.index)}):w(K,M,I,P)}function T(M,I){var P=Math.max(4,I);if(M&&M.trim().length>=P/2)return M;for(var S=P-(M=M||"").length;S>0;S--)M+=" ";return M}function _(M,I){var P,S=I._context.doubleClickDelay,E=1,z=v.ensureSingle(M,"rect","legendtoggle",function(R){I._context.staticPlot||R.style("cursor","pointer").attr("pointer-events","all"),R.call(a.fill,"rgba(0,0,0,0)")});I._context.staticPlot||(z.on("mousedown",function(){(P=(new Date).getTime())-I._legendMouseDownTime<S?E+=1:(E=1,I._legendMouseDownTime=P)}),z.on("mouseup",function(){if(!I._dragged&&!I._editing){var R=I._fullLayout.legend;(new Date).getTime()-I._legendMouseDownTime>S&&(E=Math.max(E-1,1)),b(I,R,M,E,g.event)}}))}function w(M,I,P,S,E){S._inHover&&M.attr("data-notex",!0),r.convertToTspans(M,P,function(){!function(z,R,q,V){var W=z.data()[0][0];if(q._inHover||!W||W.trace.showlegend){var K=z.select("g[class*=math-group]"),G=K.node();q||(q=R._fullLayout.legend);var B,N,$=q.borderwidth,U=(1===V?q.title.font:W.groupTitle?W.groupTitle.font:q.font).size*u;if(G){var te=t.bBox(G);B=te.height,N=te.width,1===V?t.setTranslate(K,$,$+.75*B):t.setTranslate(K,0,.25*B)}else{var j=z.select(1===V?".legendtitletext":".legendtext"),J=r.lineCount(j),X=j.node();if(B=U*J,N=X?t.bBox(X).width:0,1===V)"left"===q.title.side&&(N+=2*s.itemGap),r.positionText(j,$+s.titlePad,$+U);else{var re=2*s.itemGap+q.itemwidth;W.groupTitle&&(re=s.itemGap,N-=q.itemwidth),r.positionText(j,re,-U*((J-1)/2-.3))}}1===V?(q._titleWidth=N,q._titleHeight=B):(W.lineHeight=U,W.height=Math.max(B,16)+3,W.width=N)}else z.remove()}(I,P,S,E)})}function k(M){return v.isRightAnchor(M)?"right":v.isCenterAnchor(M)?"center":"left"}function L(M){return v.isBottomAnchor(M)?"bottom":v.isMiddleAnchor(M)?"middle":"top"}ee.exports=function(M,I){return I||(I=M._fullLayout.legend||{}),function(P,S){var E,z,R=P._fullLayout,q="legend"+R._uid,V=S._inHover;if(V?(E=S.layer,q+="-hover"):E=R._infolayer,E){if(P._legendMouseDownTime||(P._legendMouseDownTime=0),V){if(!S.entries)return;z=h(S.entries,S)}else{if(!P.calcdata)return;z=R.showlegend&&h(P.calcdata,S)}var W=R.hiddenlabels||[];if(!(V||R.showlegend&&z.length))return E.selectAll(".legend").remove(),R._topdefs.select("#"+q).remove(),m.autoMargin(P,"legend");var K=v.ensureSingle(E,"g","legend",function(J){V||J.attr("pointer-events","all")}),G=v.ensureSingleById(R._topdefs,"clipPath",q,function(J){J.append("rect")}),Y=v.ensureSingle(K,"rect","bg",function(J){J.attr("shape-rendering","crispEdges")});Y.call(a.stroke,S.bordercolor).call(a.fill,S.bgcolor).style("stroke-width",S.borderwidth+"px");var $=v.ensureSingle(K,"g","scrollbox"),B=S.title;if(S._titleWidth=0,S._titleHeight=0,B.text){var N=v.ensureSingle($,"text","legendtitletext");N.attr("text-anchor","start").call(t.font,B.font).text(B.text),w(N,$,P,S,1)}else $.selectAll(".legendtitletext").remove();var U=v.ensureSingle(K,"rect","scrollbar",function(J){J.attr(s.scrollBarEnterAttrs).call(a.fill,s.scrollBarColor)}),te=$.selectAll("g.groups").data(z);te.enter().append("g").attr("class","groups"),te.exit().remove();var j=te.selectAll("g.traces").data(v.identity);j.enter().append("g").attr("class","traces"),j.exit().remove(),j.style("opacity",function(J){var X=J[0].trace;return x.traceIs(X,"pie-like")?-1!==W.indexOf(J[0].label)?.5:1:"legendonly"===X.visible?.5:1}).each(function(){g.select(this).call(l,P,S)}).call(p,P,S).each(function(){V||g.select(this).call(_,P)}),v.syncOrAsync([m.previousPromises,function(){return function(J,X,re,ne){var le=J._fullLayout;ne||(ne=le.legend);var oe=le._size,de=o.isVertical(ne),se=o.isGrouped(ne),ge=ne.borderwidth,_e=2*ge,Te=s.itemGap,we=ne.itemwidth+2*Te,Oe=2*(ge+Te),fe=L(ne),ve=ne.y<0||0===ne.y&&"top"===fe,Ae=ne.y>1||1===ne.y&&"bottom"===fe,ke=ne.tracegroupgap;ne._maxHeight=Math.max(ve||Ae?le.height/2:oe.h,30);var Pe=0;ne._width=0,ne._height=0;var rr,Ht,Ve,We,Ne=(Ht=0,Ve=0,(We=(rr=ne).title.side)&&(-1!==We.indexOf("left")&&(Ht=rr._titleWidth),-1!==We.indexOf("top")&&(Ve=rr._titleHeight)),[Ht,Ve]);if(de)re.each(function(rr){var Ht=rr[0].height;t.setTranslate(this,ge+Ne[0],ge+Ne[1]+ne._height+Ht/2+Te),ne._height+=Ht,ne._width=Math.max(ne._width,rr[0].width)}),Pe=we+ne._width,ne._width+=Te+we+_e,ne._height+=Oe,se&&(X.each(function(rr,Ht){t.setTranslate(this,0,Ht*ne.tracegroupgap)}),ne._height+=(ne._lgroupsLength-1)*ne.tracegroupgap);else{var De=k(ne),Se=Ae||ve,Ie=le.width/2;ne._maxWidth=Math.max(ne.x<0||0===ne.x&&"right"===De?Se&&"left"===De?oe.l+oe.w:Ie:ne.x>1||1===ne.x&&"left"===De?Se&&"right"===De?oe.r+oe.w:Ie:oe.w,2*we);var Fe=0,Re=0;re.each(function(rr){var Ht=rr[0].width+we;Fe=Math.max(Fe,Ht),Re+=Ht}),Pe=null;var Xe=0;if(se){var nt=0,ct=0,xt=0;X.each(function(){var rr=0,Ht=0;g.select(this).selectAll("g.traces").each(function(We){var he=We[0].width,ye=We[0].height;t.setTranslate(this,Ne[0],Ne[1]+ge+Te+ye/2+Ht),Ht+=ye,rr=Math.max(rr,we+he)});var Ve=rr+Te;ct>0&&Ve+ge+ct>ne._maxWidth?(Xe=Math.max(Xe,ct),ct=0,xt+=nt+ke,nt=Ht):nt=Math.max(nt,Ht),t.setTranslate(this,ct,xt),ct+=Ve}),ne._width=Math.max(Xe,ct)+ge,ne._height=xt+nt+Oe}else{var dt=re.size(),tt=Re+_e+(dt-1)*Te<ne._maxWidth,Ke=0,mt=0,Bt=0,Ut=0;re.each(function(rr){var Ht=rr[0].height,Ve=we+rr[0].width,We=(tt?Ve:Fe)+Te;We+ge+mt-Te>=ne._maxWidth&&(Xe=Math.max(Xe,Ut),mt=0,Bt+=Ke,ne._height+=Ke,Ke=0),t.setTranslate(this,Ne[0]+ge+mt,Ne[1]+ge+Bt+Ht/2+Te),Ut=mt+Ve+Te,mt+=We,Ke=Math.max(Ke,Ht)}),tt?(ne._width=mt+_e,ne._height=Ke+Oe):(ne._width=Math.max(Xe,Ut)+_e,ne._height+=Ke+Oe)}}ne._width=Math.ceil(Math.max(ne._width+Ne[0],ne._titleWidth+2*(ge+s.titlePad))),ne._height=Math.ceil(Math.max(ne._height+Ne[1],ne._titleHeight+2*(ge+s.itemGap))),ne._effHeight=Math.min(ne._height,ne._maxHeight);var er=J._context.edits,Wt=er.legendText||er.legendPosition;re.each(function(rr){var Ht=g.select(this).select(".legendtoggle"),Ve=rr[0].height,We=Wt?we:Pe||we+rr[0].width;de||(We+=Te/2),t.setRect(Ht,0,-Ve/2,We,Ve)})}(P,te,j,S)},function(){var J,X,re,ne,Se,Ie,Fe,Re,le=R._size,oe=S.borderwidth;if(!V){if(Fe=k(Ie=(Se=P)._fullLayout.legend),Re=L(Ie),m.autoMargin(Se,"legend",{x:Ie.x,y:Ie.y,l:Ie._width*f[Fe],r:Ie._width*c[Fe],b:Ie._effHeight*c[Re],t:Ie._effHeight*f[Re]}))return;var de=le.l+le.w*S.x-f[k(S)]*S._width,se=le.t+le.h*(1-S.y)-f[L(S)]*S._effHeight;if(R.margin.autoexpand){var ge=de,_e=se;de=v.constrain(de,0,R.width-S._width),se=v.constrain(se,0,R.height-S._effHeight),de!==ge&&v.log("Constrain legend.x to make legend fit inside graph"),se!==_e&&v.log("Constrain legend.y to make legend fit inside graph")}t.setTranslate(K,de,se)}if(U.on(".drag",null),K.on("wheel",null),V||S._height<=S._maxHeight||P._context.staticPlot){var Te=S._effHeight;V&&(Te=S._height),Y.attr({width:S._width-oe,height:Te-oe,x:oe/2,y:oe/2}),t.setTranslate($,0,0),G.select("rect").attr({width:S._width-2*oe,height:Te-2*oe,x:oe,y:oe}),t.setClipUrl($,q,P),t.setRect(U,0,0,0,0),delete S._scrollY}else{var we,fe,ve=Math.max(s.scrollBarMinHeight,S._effHeight*S._effHeight/S._height),Ae=S._effHeight-ve-2*s.scrollBarMargin,ke=S._height-S._effHeight,Pe=Ae/ke,Ne=Math.min(S._scrollY||0,ke);Y.attr({width:S._width-2*oe+s.scrollBarWidth+s.scrollBarMargin,height:S._effHeight-oe,x:oe/2,y:oe/2}),G.select("rect").attr({width:S._width-2*oe+s.scrollBarWidth+s.scrollBarMargin,height:S._effHeight-2*oe,x:oe,y:oe+Ne}),t.setClipUrl($,q,P),Me(Ne,ve,Pe),K.on("wheel",function(){Me(Ne=v.constrain(S._scrollY+g.event.deltaY/Ae*ke,0,ke),ve,Pe),0!==Ne&&Ne!==ke&&g.event.preventDefault()});var De=g.behavior.drag().on("dragstart",function(){var Se=g.event.sourceEvent;we="touchstart"===Se.type?Se.changedTouches[0].clientY:Se.clientY,fe=Ne}).on("drag",function(){var Se=g.event.sourceEvent;2===Se.buttons||Se.ctrlKey||Me(Ne=function(Ie,Fe,Re){return v.constrain((Re-Fe)/Pe+Ie,0,ke)}(fe,we,"touchmove"===Se.type?Se.changedTouches[0].clientY:Se.clientY),ve,Pe)});U.call(De);var ze=g.behavior.drag().on("dragstart",function(){var Se=g.event.sourceEvent;"touchstart"===Se.type&&(we=Se.changedTouches[0].clientY,fe=Ne)}).on("drag",function(){var Se=g.event.sourceEvent;"touchmove"===Se.type&&Me(Ne=function(Ie,Fe,Re){return v.constrain((Fe-Re)/Pe+Ie,0,ke)}(fe,we,Se.changedTouches[0].clientY),ve,Pe)});$.call(ze)}function Me(Se,Ie,Fe){S._scrollY=P._fullLayout.legend._scrollY=Se,t.setTranslate($,0,-Se),t.setRect(U,S._width,s.scrollBarMargin+Se*Fe,s.scrollBarWidth,Ie),G.select("rect").attr("y",oe+Se)}P._context.edits.legendPosition&&(K.classed("cursor-move",!0),n.init({element:K.node(),gd:P,prepFn:function(){var Se=t.getTranslate(K);re=Se.x,ne=Se.y},moveFn:function(Se,Ie){var Fe=re+Se,Re=ne+Ie;t.setTranslate(K,Fe,Re),J=n.align(Fe,0,le.l,le.l+le.w,S.xanchor),X=n.align(Re,0,le.t+le.h,le.t,S.yanchor)},doneFn:function(){void 0!==J&&void 0!==X&&x.call("_guiRelayout",P,{"legend.x":J,"legend.y":X})},clickFn:function(Se,Ie){var Fe=E.selectAll("g.traces").filter(function(){var Re=this.getBoundingClientRect();return Ie.clientX>=Re.left&&Ie.clientX<=Re.right&&Ie.clientY>=Re.top&&Ie.clientY<=Re.bottom});Fe.size()>0&&b(P,K,Fe,Se,Ie)}}))}],P)}}(M,I)}},{"../../constants/alignment":483,"../../lib":515,"../../lib/events":504,"../../lib/svg_text_utils":541,"../../plots/plots":628,"../../registry":647,"../color":367,"../dragelement":386,"../drawing":389,"./constants":418,"./get_legend_data":421,"./handle_click":422,"./helpers":423,"./style":425,"@plotly/d3":58}],421:[function(y,ee,Q){"use strict";var g=y("../../registry"),v=y("./helpers");ee.exports=function(m,x){var e,n,t=x._inHover,a=v.isGrouped(x),r=v.isReversed(x),d={},s=[],i=!1,u={},f=0,c=0;function h(R,q){if(""!==R&&v.isGrouped(x))-1===s.indexOf(R)?(s.push(R),i=!0,d[R]=[q]):d[R].push(q);else{var V="~~i"+f;s.push(V),d[V]=[q],f++}}for(e=0;e<m.length;e++){var p=m[e],o=p[0],b=o.trace,l=b.legendgroup;if(t||b.visible&&b.showlegend)if(g.traceIs(b,"pie-like"))for(u[l]||(u[l]={}),n=0;n<p.length;n++){var T=p[n].label;u[l][T]||(h(l,{label:T,color:p[n].color,i:p[n].i,trace:b,pts:p[n].pts}),u[l][T]=!0,c=Math.max(c,(T||"").length))}else h(l,o),c=Math.max(c,(b.name||"").length)}if(!s.length)return[];var _=!i||!a,w=[];for(e=0;e<s.length;e++){var k=d[s[e]];w.push(_?k[0]:k)}for(_&&(w=[w]),e=0;e<w.length;e++){var L=1/0;for(n=0;n<w[e].length;n++){var M=w[e][n].trace.legendrank;L>M&&(L=M)}w[e][0]._groupMinRank=L,w[e][0]._preGroupSort=e}var I=function(R,q){return R.trace.legendrank-q.trace.legendrank||R._preSort-q._preSort};for(w.forEach(function(R,q){R[0]._preGroupSort=q}),w.sort(function(R,q){return R[0]._groupMinRank-q[0]._groupMinRank||R[0]._preGroupSort-q[0]._preGroupSort}),e=0;e<w.length;e++){w[e].forEach(function(R,q){R._preSort=q}),w[e].sort(I);var P=w[e][0].trace,S=null;for(n=0;n<w[e].length;n++){var E=w[e][n].trace.legendgrouptitle;if(E&&E.text){S=E,t&&(E.font=x._groupTitleFont);break}}if(r&&w[e].reverse(),S){var z=!1;for(n=0;n<w[e].length;n++)if(g.traceIs(w[e][n].trace,"pie-like")){z=!0;break}w[e].unshift({i:-1,groupTitle:S,noClick:z,trace:{showlegend:P.showlegend,legendgroup:P.legendgroup,visible:"toggleitem"===x.groupclick||P.visible}})}for(n=0;n<w[e].length;n++)w[e][n]=[w[e][n]]}return x._lgroupsLength=w.length,x._maxNameLength=c,w}},{"../../registry":647,"./helpers":423}],422:[function(y,ee,Q){"use strict";var g=y("../../lib"),v=y("../../registry"),m=!0;ee.exports=function(x,e,n){var t=e._fullLayout;if(!e._dragged&&!e._editing){var a,r=t.legend.itemclick,d=t.legend.itemdoubleclick,s=t.legend.groupclick;if(1===n&&"toggle"===r&&"toggleothers"===d&&m&&e.data&&e._context.showTips&&g.notifier(g._(e,"Double-click on legend to isolate one trace"),"long"),m=!1,1===n?a=r:2===n&&(a=d),a){var i="togglegroup"===s,u=t.hiddenlabels?t.hiddenlabels.slice():[],f=x.data()[0][0];if(!f.groupTitle||!f.noClick){var c,h,p,o,b,l=e._fullData,T=f.trace,_=T.legendgroup,w={},k=[],L=[],M=[];if(v.traceIs(T,"pie-like")){var I=f.label,P=u.indexOf(I);"toggle"===a?-1===P?u.push(I):u.splice(P,1):"toggleothers"===a&&(u=[],e.calcdata[0].forEach(function(U){I!==U.label&&u.push(U.label)}),e._fullLayout.hiddenlabels&&e._fullLayout.hiddenlabels.length===u.length&&-1===P&&(u=[])),v.call("_guiRelayout",e,"hiddenlabels",u)}else{var S,E=_&&_.length,z=[];if(E)for(c=0;c<l.length;c++)(S=l[c]).visible&&S.legendgroup===_&&z.push(c);if("toggle"===a){var R;switch(T.visible){case!0:R="legendonly";break;case!1:R=!1;break;case"legendonly":R=!0}if(E)if(i)for(c=0;c<l.length;c++)!1!==l[c].visible&&l[c].legendgroup===_&&N(l[c],R);else N(T,R);else N(T,R)}else if("toggleothers"===a){var W,G=!0;for(c=0;c<l.length;c++)if(W=!0!==l[c].showlegend,!(l[c]===T||W||E&&l[c].legendgroup===_||!0!==l[c].visible||v.traceIs(l[c],"notLegendIsolatable"))){G=!1;break}for(c=0;c<l.length;c++)if(!1!==l[c].visible&&!v.traceIs(l[c],"notLegendIsolatable"))switch(T.visible){case"legendonly":N(l[c],!0);break;case!0:W=!0!==l[c].showlegend&&!l[c].legendgroup,N(l[c],!!(l[c]===T||E&&l[c].legendgroup===_||W)||!!G||"legendonly")}}for(c=0;c<L.length;c++)if(p=L[c]){var Y=p.constructUpdate(),$=Object.keys(Y);for(h=0;h<$.length;h++)(w[o=$[h]]=w[o]||[])[M[c]]=Y[o]}for(b=Object.keys(w),c=0;c<b.length;c++)for(o=b[c],h=0;h<k.length;h++)w[o].hasOwnProperty(h)||(w[o][h]=void 0);v.call("_guiRestyle",e,w,k)}}}}function B(U,te,j){var J=k.indexOf(U),X=w[te];return X||(X=w[te]=[]),-1===k.indexOf(U)&&(k.push(U),J=k.length-1),X[J]=j,J}function N(U,te){if(!f.groupTitle||i){var j=U._fullInput;if(v.hasTransform(j,"groupby")){var J=L[j.index];if(!J){var X=v.getTransformIndices(j,"groupby");J=g.keyedContainer(j,"transforms["+X[X.length-1]+"].styles","target","value.visible"),L[j.index]=J}var ne=J.get(U._group);void 0===ne&&(ne=!0),!1!==ne&&J.set(U._group,te),M[j.index]=B(j.index,"visible",!1!==j.visible)}else B(j.index,"visible",!1!==j.visible&&te)}}}},{"../../lib":515,"../../registry":647}],423:[function(y,ee,Q){"use strict";Q.isGrouped=function(g){return-1!==(g.traceorder||"").indexOf("grouped")},Q.isVertical=function(g){return"h"!==g.orientation},Q.isReversed=function(g){return-1!==(g.traceorder||"").indexOf("reversed")}},{}],424:[function(y,ee,Q){"use strict";ee.exports={moduleType:"component",name:"legend",layoutAttributes:y("./attributes"),supplyLayoutDefaults:y("./defaults"),draw:y("./draw"),style:y("./style")}},{"./attributes":417,"./defaults":419,"./draw":420,"./style":425}],425:[function(y,ee,Q){"use strict";var g=y("@plotly/d3"),v=y("../../registry"),m=y("../../lib"),x=m.strTranslate,e=y("../drawing"),n=y("../color"),t=y("../colorscale/helpers").extractOpts,a=y("../../traces/scatter/subtypes"),r=y("../../traces/pie/style_one"),d=y("../../traces/pie/helpers").castOption,s=y("./constants");function i(c,h){return(h?"radial":"horizontal")+(c?"":"reversed")}function u(c){var h=c[0].trace,p=h.contours,o=a.hasLines(h),b=a.hasMarkers(h),l=h.visible&&h.fill&&"none"!==h.fill,T=!1,_=!1;if(p){var w=p.coloring;"lines"===w?T=!0:o="none"===w||"heatmap"===w||p.showlines,"constraint"===p.type?l="="!==p._operation:"fill"!==w&&"heatmap"!==w||(_=!0)}return{showMarker:b,showLine:o,showFill:l,showGradientLine:T,showGradientFill:_,anyLine:o||T,anyFill:l||_}}function f(c,h,p){return c&&m.isArrayOrTypedArray(c)?h:c>p?p:c}ee.exports=function(c,h,p){p||(p=h._fullLayout.legend);var b="constant"===p.itemsizing,l=p.itemwidth,_=x((l+2*s.itemGap)/2,0),w=function(M,I,P,S){var E;if(M+1)E=M;else{if(!(I&&I.width>0))return 0;E=I.width}return b?S:Math.min(E,P)};function k(M,I,P){var S=M[0].trace,E=S.marker||{},z=E.line||{},R=P?S.visible&&S.type===P:v.traceIs(S,"bar"),q=g.select(I).select("g.legendpoints").selectAll("path.legend"+P).data(R?[M]:[]);q.enter().append("path").classed("legend"+P,!0).attr("d","M6,6H-6V-6H6Z").attr("transform",_),q.exit().remove(),q.each(function(V){var W=g.select(this),K=V[0],G=w(K.mlw,E.line,5,2);W.style("stroke-width",G+"px");var Y=K.mcc;if(!p._inHover&&"mc"in K){var $=t(E),B=$.mid;void 0===B&&(B=($.max+$.min)/2),Y=e.tryColorscale(E,"")(B)}var N=Y||K.mc||E.color,U=E.pattern,te=U&&e.getPatternAttr(U.shape,0,"");if(te){var j=e.getPatternAttr(U.bgcolor,0,null),J=e.getPatternAttr(U.fgcolor,0,null),X=U.fgopacity,re=f(U.size,8,10),ne=f(U.solidity,.5,1);W.call(e.pattern,"legend",h,"legend-"+S.uid,te,re,ne,Y,U.fillmode,j,J,X)}else W.call(n.fill,N);G&&n.stroke(W,K.mlc||z.color)})}function L(M,I,P){var S=M[0],E=S.trace,z=P?E.visible&&E.type===P:v.traceIs(E,P),R=g.select(I).select("g.legendpoints").selectAll("path.legend"+P).data(z?[M]:[]);if(R.enter().append("path").classed("legend"+P,!0).attr("d","M6,6H-6V-6H6Z").attr("transform",_),R.exit().remove(),R.size()){var q=(E.marker||{}).line,V=w(d(q.width,S.pts),q,5,2),W=m.minExtend(E,{marker:{line:{width:V}}});W.marker.line.color=q.color;var K=m.minExtend(S,{trace:W});r(R,K,W)}}c.each(function(M){var I=g.select(this),P=m.ensureSingle(I,"g","layers");P.style("opacity",M[0].trace.opacity);var S=p.valign,E=M[0].lineHeight,z=M[0].height;P.attr("transform","middle"!==S&&E&&z?x(0,{top:1,bottom:-1}[S]*(.5*(E-z+3))):null),P.selectAll("g.legendfill").data([M]).enter().append("g").classed("legendfill",!0),P.selectAll("g.legendlines").data([M]).enter().append("g").classed("legendlines",!0);var q=P.selectAll("g.legendsymbols").data([M]);q.enter().append("g").classed("legendsymbols",!0),q.selectAll("g.legendpoints").data([M]).enter().append("g").classed("legendpoints",!0)}).each(function(M){var I,P=M[0].trace,S=[];if(P.visible)switch(P.type){case"histogram2d":case"heatmap":S=[["M-15,-2V4H15V-2Z"]],I=!0;break;case"choropleth":case"choroplethmapbox":S=[["M-6,-6V6H6V-6Z"]],I=!0;break;case"densitymapbox":S=[["M-6,0 a6,6 0 1,0 12,0 a 6,6 0 1,0 -12,0"]],I="radial";break;case"cone":S=[["M-6,2 A2,2 0 0,0 -6,6 V6L6,4Z"],["M-6,-6 A2,2 0 0,0 -6,-2 L6,-4Z"],["M-6,-2 A2,2 0 0,0 -6,2 L6,0Z"]],I=!1;break;case"streamtube":S=[["M-6,2 A2,2 0 0,0 -6,6 H6 A2,2 0 0,1 6,2 Z"],["M-6,-6 A2,2 0 0,0 -6,-2 H6 A2,2 0 0,1 6,-6 Z"],["M-6,-2 A2,2 0 0,0 -6,2 H6 A2,2 0 0,1 6,-2 Z"]],I=!1;break;case"surface":S=[["M-6,-6 A2,3 0 0,0 -6,0 H6 A2,3 0 0,1 6,-6 Z"],["M-6,1 A2,3 0 0,1 -6,6 H6 A2,3 0 0,0 6,0 Z"]],I=!0;break;case"mesh3d":S=[["M-6,6H0L-6,-6Z"],["M6,6H0L6,-6Z"],["M-6,-6H6L0,6Z"]],I=!1;break;case"volume":S=[["M-6,6H0L-6,-6Z"],["M6,6H0L6,-6Z"],["M-6,-6H6L0,6Z"]],I=!0;break;case"isosurface":S=[["M-6,6H0L-6,-6Z"],["M6,6H0L6,-6Z"],["M-6,-6 A12,24 0 0,0 6,-6 L0,6Z"]],I=!1}var E=g.select(this).select("g.legendpoints").selectAll("path.legend3dandfriends").data(S);E.enter().append("path").classed("legend3dandfriends",!0).attr("transform",_).style("stroke-miterlimit",1),E.exit().remove(),E.each(function(z,R){var q,V=g.select(this),W=t(P),K=W.colorscale,G=W.reversescale;if(K){if(!I){var Y=K.length;q=0===R?K[G?Y-1:0][1]:1===R?K[G?0:Y-1][1]:K[Math.floor((Y-1)/2)][1]}}else{var $=P.vertexcolor||P.facecolor||P.color;q=m.isArrayOrTypedArray($)?$[R]||$[0]:$}V.attr("d",z[0]),q?V.call(n.fill,q):V.call(function(B){B.size()&&e.gradient(B,h,"legendfill-"+P.uid,i(G,"radial"===I),K,"fill")})})}).each(function(M){var I=M[0].trace,P="waterfall"===I.type;if(M[0]._distinct&&P){var S=M[0].trace[M[0].dir].marker;return M[0].mc=S.color,M[0].mlw=S.line.width,M[0].mlc=S.line.color,k(M,this,"waterfall")}var E=[];I.visible&&P&&(E=M[0].hasTotals?[["increasing","M-6,-6V6H0Z"],["totals","M6,6H0L-6,-6H-0Z"],["decreasing","M6,6V-6H0Z"]]:[["increasing","M-6,-6V6H6Z"],["decreasing","M6,6V-6H-6Z"]]);var z=g.select(this).select("g.legendpoints").selectAll("path.legendwaterfall").data(E);z.enter().append("path").classed("legendwaterfall",!0).attr("transform",_).style("stroke-miterlimit",1),z.exit().remove(),z.each(function(R){var q=g.select(this),V=I[R[0]].marker,W=w(void 0,V.line,5,2);q.attr("d",R[1]).style("stroke-width",W+"px").call(n.fill,V.color),W&&q.call(n.stroke,V.line.color)})}).each(function(M){k(M,this,"funnel")}).each(function(M){k(M,this)}).each(function(M){var I=M[0].trace,P=g.select(this).select("g.legendpoints").selectAll("path.legendbox").data(I.visible&&v.traceIs(I,"box-violin")?[M]:[]);P.enter().append("path").classed("legendbox",!0).attr("d","M6,6H-6V-6H6Z").attr("transform",_),P.exit().remove(),P.each(function(){var S=g.select(this);if("all"!==I.boxpoints&&"all"!==I.points||0!==n.opacity(I.fillcolor)||0!==n.opacity((I.line||{}).color)){var E=w(void 0,I.line,5,2);S.style("stroke-width",E+"px").call(n.fill,I.fillcolor),E&&n.stroke(S,I.line.color)}else{var z=m.minExtend(I,{marker:{size:b?12:m.constrain(I.marker.size,2,16),sizeref:1,sizemin:1,sizemode:"diameter"}});P.call(e.pointStyle,z,h)}})}).each(function(M){L(M,this,"funnelarea")}).each(function(M){L(M,this,"pie")}).each(function(M){var I,P,S=u(M),E=S.showFill,z=S.showLine,R=S.showGradientLine,q=S.showGradientFill,V=S.anyFill,W=S.anyLine,K=M[0],G=K.trace,Y=t(G),$=Y.colorscale,B=Y.reversescale,N=a.hasMarkers(G)||!V?"M5,0":W?"M5,-2":"M5,-3",U=g.select(this),te=U.select(".legendfill").selectAll("path").data(E||q?[M]:[]);if(te.enter().append("path").classed("js-fill",!0),te.exit().remove(),te.attr("d",N+"h"+l+"v6h-"+l+"z").call(function(X){X.size()&&(E?e.fillGroupStyle(X,h):e.gradient(X,h,"legendfill-"+G.uid,i(B),$,"fill"))}),z||R){var j=w(void 0,G.line,10,5);P=m.minExtend(G,{line:{width:j}}),I=[m.minExtend(K,{trace:P})]}var J=U.select(".legendlines").selectAll("path").data(z||R?[I]:[]);J.enter().append("path").classed("js-line",!0),J.exit().remove(),J.attr("d",N+(R?"l"+l+",0.0001":"h"+l)).call(z?e.lineGroupStyle:function(X){if(X.size()){var re="legendline-"+G.uid;e.lineGroupStyle(X),e.gradient(X,h,re,i(B),$,"stroke")}})}).each(function(M){var I,P,S=u(M),R=S.showLine,q=S.showMarker,V=M[0],W=V.trace,K=!q&&!S.anyLine&&!S.anyFill&&a.hasText(W);function G(J,X,re,ne){var le=m.nestedProperty(W,J).get(),oe=m.isArrayOrTypedArray(le)&&X?X(le):le;if(b&&oe&&void 0!==ne&&(oe=ne),re){if(oe<re[0])return re[0];if(oe>re[1])return re[1]}return oe}function Y(J){return V._distinct&&V.index&&J[V.index]?J[V.index]:J[0]}if(q||K||R){var $={},B={};if(q){$.mc=G("marker.color",Y),$.mx=G("marker.symbol",Y),$.mo=G("marker.opacity",m.mean,[.2,1]),$.mlc=G("marker.line.color",Y),$.mlw=G("marker.line.width",m.mean,[0,5],2),B.marker={sizeref:1,sizemin:1,sizemode:"diameter"};var N=G("marker.size",m.mean,[2,16],12);$.ms=N,B.marker.size=N}R&&(B.line={width:G("line.width",Y,[0,10],5)}),K&&($.tx="Aa",$.tp=G("textposition",Y),$.ts=10,$.tc=G("textfont.color",Y),$.tf=G("textfont.family",Y)),I=[m.minExtend(V,$)],(P=m.minExtend(W,B)).selectedpoints=null,P.texttemplate=null}var U=g.select(this).select("g.legendpoints"),te=U.selectAll("path.scatterpts").data(q?I:[]);te.enter().insert("path",":first-child").classed("scatterpts",!0).attr("transform",_),te.exit().remove(),te.call(e.pointStyle,P,h),q&&(I[0].mrc=3);var j=U.selectAll("g.pointtext").data(K?I:[]);j.enter().append("g").classed("pointtext",!0).append("text").attr("transform",_),j.exit().remove(),j.selectAll("text").call(e.textPointStyle,P,h)}).each(function(M){var I=M[0].trace,P=g.select(this).select("g.legendpoints").selectAll("path.legendcandle").data(I.visible&&"candlestick"===I.type?[M,M]:[]);P.enter().append("path").classed("legendcandle",!0).attr("d",function(S,E){return E?"M-15,0H-8M-8,6V-6H8Z":"M15,0H8M8,-6V6H-8Z"}).attr("transform",_).style("stroke-miterlimit",1),P.exit().remove(),P.each(function(S,E){var z=g.select(this),R=I[E?"increasing":"decreasing"],q=w(void 0,R.line,5,2);z.style("stroke-width",q+"px").call(n.fill,R.fillcolor),q&&n.stroke(z,R.line.color)})}).each(function(M){var I=M[0].trace,P=g.select(this).select("g.legendpoints").selectAll("path.legendohlc").data(I.visible&&"ohlc"===I.type?[M,M]:[]);P.enter().append("path").classed("legendohlc",!0).attr("d",function(S,E){return E?"M-15,0H0M-8,-6V0":"M15,0H0M8,6V0"}).attr("transform",_).style("stroke-miterlimit",1),P.exit().remove(),P.each(function(S,E){var z=g.select(this),R=I[E?"increasing":"decreasing"],q=w(void 0,R.line,5,2);z.style("fill","none").call(e.dashLine,R.line.dash,q),q&&n.stroke(z,R.line.color)})})}},{"../../lib":515,"../../registry":647,"../../traces/pie/helpers":915,"../../traces/pie/style_one":921,"../../traces/scatter/subtypes":961,"../color":367,"../colorscale/helpers":378,"../drawing":389,"./constants":418,"@plotly/d3":58}],426:[function(y,ee,Q){"use strict";y("./constants"),ee.exports={editType:"modebar",orientation:{valType:"enumerated",values:["v","h"],dflt:"h",editType:"modebar"},bgcolor:{valType:"color",editType:"modebar"},color:{valType:"color",editType:"modebar"},activecolor:{valType:"color",editType:"modebar"},uirevision:{valType:"any",editType:"none"},add:{valType:"string",arrayOk:!0,dflt:"",editType:"modebar"},remove:{valType:"string",arrayOk:!0,dflt:"",editType:"modebar"}}},{"./constants":428}],427:[function(y,ee,Q){"use strict";var g=y("../../registry"),v=y("../../plots/plots"),m=y("../../plots/cartesian/axis_ids"),x=y("../../fonts/ploticon"),e=y("../shapes/draw").eraseActiveShape,n=y("../../lib"),t=n._,a=ee.exports={};function r(o,b){var l,T,_=b.currentTarget,w=_.getAttribute("data-attr"),k=_.getAttribute("data-val")||!0,L=o._fullLayout,M={},I=m.list(o,null,!0),P=L._cartesianSpikesEnabled;if("zoom"===w){var S,E="in"===k?.5:2,z=(1+E)/2,R=(1-E)/2;for(T=0;T<I.length;T++)if(!(l=I[T]).fixedrange)if(S=l._name,"auto"===k)M[S+".autorange"]=!0;else if("reset"===k){if(void 0===l._rangeInitial)M[S+".autorange"]=!0;else{var q=l._rangeInitial.slice();M[S+".range[0]"]=q[0],M[S+".range[1]"]=q[1]}void 0!==l._showSpikeInitial&&(M[S+".showspikes"]=l._showSpikeInitial,"on"!==P||l._showSpikeInitial||(P="off"))}else{var V=[l.r2l(l.range[0]),l.r2l(l.range[1])],W=[z*V[0]+R*V[1],z*V[1]+R*V[0]];M[S+".range[0]"]=l.l2r(W[0]),M[S+".range[1]"]=l.l2r(W[1])}}else"hovermode"!==w||"x"!==k&&"y"!==k||_.setAttribute("data-val",k=L._isHoriz?"y":"x"),M[w]=k;L._cartesianSpikesEnabled=P,g.call("_guiRelayout",o,M)}function d(o,b){for(var l=b.currentTarget,T=l.getAttribute("data-attr"),_=l.getAttribute("data-val")||!0,w=o._fullLayout._subplots.gl3d||[],k={},L=T.split("."),M=0;M<w.length;M++)k[w[M]+"."+L[1]]=_;k.dragmode="pan"===_?_:"zoom",g.call("_guiRelayout",o,k)}function s(o,b){for(var l=b.currentTarget.getAttribute("data-attr"),T="resetLastSave"===l,_="resetDefault"===l,w=o._fullLayout,k=w._subplots.gl3d||[],L={},M=0;M<k.length;M++){var I,P=k[M],S=P+".camera",E=P+".aspectratio",z=P+".aspectmode",R=w[P]._scene;T?(L[S+".up"]=R.viewInitial.up,L[S+".eye"]=R.viewInitial.eye,L[S+".center"]=R.viewInitial.center,I=!0):_&&(L[S+".up"]=null,L[S+".eye"]=null,L[S+".center"]=null,I=!0),I&&(L[E+".x"]=R.viewInitial.aspectratio.x,L[E+".y"]=R.viewInitial.aspectratio.y,L[E+".z"]=R.viewInitial.aspectratio.z,L[z]=R.viewInitial.aspectmode)}g.call("_guiRelayout",o,L)}function i(o,b){var l=b.currentTarget,T=l._previousVal,_=o._fullLayout,w=_._subplots.gl3d||[],k=["xaxis","yaxis","zaxis"],L={},M={};if(T)M=T,l._previousVal=null;else{for(var I=0;I<w.length;I++){var P=w[I],S=_[P],E=P+".hovermode";L[E]=S.hovermode,M[E]=!1;for(var z=0;z<3;z++){var R=k[z],q=P+"."+R+".showspikes";M[q]=!1,L[q]=S[R].showspikes}}l._previousVal=L}return M}function u(o,b){for(var l=b.currentTarget,T=l.getAttribute("data-attr"),_=l.getAttribute("data-val")||!0,w=o._fullLayout,k=w._subplots.geo||[],L=0;L<k.length;L++){var M=k[L];if("zoom"===T){var P=w[M].projection.scale;g.call("_guiRelayout",o,M+".projection.scale","in"===_?2*P:.5*P)}}"reset"===T&&p(o,"geo")}function f(o){var b=o._fullLayout;return!b.hovermode&&(b._has("cartesian")?b._isHoriz?"y":"x":"closest")}function c(o){var b=f(o);g.call("_guiRelayout",o,"hovermode",b)}function h(o,b){for(var l=b.currentTarget.getAttribute("data-val"),T=o._fullLayout,_=T._subplots.mapbox||[],w={},k=0;k<_.length;k++){var L=_[k],M=T[L].zoom;w[L+".zoom"]="in"===l?1.05*M:M/1.05}g.call("_guiRelayout",o,w)}function p(o,b){for(var l=o._fullLayout,T=l._subplots[b]||[],_={},w=0;w<T.length;w++)for(var k=T[w],L=l[k]._subplot.viewInitial,M=Object.keys(L),I=0;I<M.length;I++){var P=M[I];_[k+"."+P]=L[P]}g.call("_guiRelayout",o,_)}a.toImage={name:"toImage",title:function(o){return t(o,"png"===((o._context.toImageButtonOptions||{}).format||"png")?"Download plot as a png":"Download plot")},icon:x.camera,click:function(o){var b=o._context.toImageButtonOptions,l={format:b.format||"png"};n.notifier(t(o,"Taking snapshot - this may take a few seconds"),"long"),"svg"!==l.format&&n.isIE()&&(n.notifier(t(o,"IE only supports svg.  Changing format to svg."),"long"),l.format="svg"),["filename","width","height","scale"].forEach(function(T){T in b&&(l[T]=b[T])}),g.call("downloadImage",o,l).then(function(T){n.notifier(t(o,"Snapshot succeeded")+" - "+T,"long")}).catch(function(){n.notifier(t(o,"Sorry, there was a problem downloading your snapshot!"),"long")})}},a.sendDataToCloud={name:"sendDataToCloud",title:function(o){return t(o,"Edit in Chart Studio")},icon:x.disk,click:function(o){v.sendDataToCloud(o)}},a.editInChartStudio={name:"editInChartStudio",title:function(o){return t(o,"Edit in Chart Studio")},icon:x.pencil,click:function(o){v.sendDataToCloud(o)}},a.zoom2d={name:"zoom2d",_cat:"zoom",title:function(o){return t(o,"Zoom")},attr:"dragmode",val:"zoom",icon:x.zoombox,click:r},a.pan2d={name:"pan2d",_cat:"pan",title:function(o){return t(o,"Pan")},attr:"dragmode",val:"pan",icon:x.pan,click:r},a.select2d={name:"select2d",_cat:"select",title:function(o){return t(o,"Box Select")},attr:"dragmode",val:"select",icon:x.selectbox,click:r},a.lasso2d={name:"lasso2d",_cat:"lasso",title:function(o){return t(o,"Lasso Select")},attr:"dragmode",val:"lasso",icon:x.lasso,click:r},a.drawclosedpath={name:"drawclosedpath",title:function(o){return t(o,"Draw closed freeform")},attr:"dragmode",val:"drawclosedpath",icon:x.drawclosedpath,click:r},a.drawopenpath={name:"drawopenpath",title:function(o){return t(o,"Draw open freeform")},attr:"dragmode",val:"drawopenpath",icon:x.drawopenpath,click:r},a.drawline={name:"drawline",title:function(o){return t(o,"Draw line")},attr:"dragmode",val:"drawline",icon:x.drawline,click:r},a.drawrect={name:"drawrect",title:function(o){return t(o,"Draw rectangle")},attr:"dragmode",val:"drawrect",icon:x.drawrect,click:r},a.drawcircle={name:"drawcircle",title:function(o){return t(o,"Draw circle")},attr:"dragmode",val:"drawcircle",icon:x.drawcircle,click:r},a.eraseshape={name:"eraseshape",title:function(o){return t(o,"Erase active shape")},icon:x.eraseshape,click:e},a.zoomIn2d={name:"zoomIn2d",_cat:"zoomin",title:function(o){return t(o,"Zoom in")},attr:"zoom",val:"in",icon:x.zoom_plus,click:r},a.zoomOut2d={name:"zoomOut2d",_cat:"zoomout",title:function(o){return t(o,"Zoom out")},attr:"zoom",val:"out",icon:x.zoom_minus,click:r},a.autoScale2d={name:"autoScale2d",_cat:"autoscale",title:function(o){return t(o,"Autoscale")},attr:"zoom",val:"auto",icon:x.autoscale,click:r},a.resetScale2d={name:"resetScale2d",_cat:"resetscale",title:function(o){return t(o,"Reset axes")},attr:"zoom",val:"reset",icon:x.home,click:r},a.hoverClosestCartesian={name:"hoverClosestCartesian",_cat:"hoverclosest",title:function(o){return t(o,"Show closest data on hover")},attr:"hovermode",val:"closest",icon:x.tooltip_basic,gravity:"ne",click:r},a.hoverCompareCartesian={name:"hoverCompareCartesian",_cat:"hoverCompare",title:function(o){return t(o,"Compare data on hover")},attr:"hovermode",val:function(o){return o._fullLayout._isHoriz?"y":"x"},icon:x.tooltip_compare,gravity:"ne",click:r},a.zoom3d={name:"zoom3d",_cat:"zoom",title:function(o){return t(o,"Zoom")},attr:"scene.dragmode",val:"zoom",icon:x.zoombox,click:d},a.pan3d={name:"pan3d",_cat:"pan",title:function(o){return t(o,"Pan")},attr:"scene.dragmode",val:"pan",icon:x.pan,click:d},a.orbitRotation={name:"orbitRotation",title:function(o){return t(o,"Orbital rotation")},attr:"scene.dragmode",val:"orbit",icon:x["3d_rotate"],click:d},a.tableRotation={name:"tableRotation",title:function(o){return t(o,"Turntable rotation")},attr:"scene.dragmode",val:"turntable",icon:x["z-axis"],click:d},a.resetCameraDefault3d={name:"resetCameraDefault3d",_cat:"resetCameraDefault",title:function(o){return t(o,"Reset camera to default")},attr:"resetDefault",icon:x.home,click:s},a.resetCameraLastSave3d={name:"resetCameraLastSave3d",_cat:"resetCameraLastSave",title:function(o){return t(o,"Reset camera to last save")},attr:"resetLastSave",icon:x.movie,click:s},a.hoverClosest3d={name:"hoverClosest3d",_cat:"hoverclosest",title:function(o){return t(o,"Toggle show closest data on hover")},attr:"hovermode",val:null,toggle:!0,icon:x.tooltip_basic,gravity:"ne",click:function(o,b){var l=i(o,b);g.call("_guiRelayout",o,l)}},a.zoomInGeo={name:"zoomInGeo",_cat:"zoomin",title:function(o){return t(o,"Zoom in")},attr:"zoom",val:"in",icon:x.zoom_plus,click:u},a.zoomOutGeo={name:"zoomOutGeo",_cat:"zoomout",title:function(o){return t(o,"Zoom out")},attr:"zoom",val:"out",icon:x.zoom_minus,click:u},a.resetGeo={name:"resetGeo",_cat:"reset",title:function(o){return t(o,"Reset")},attr:"reset",val:null,icon:x.autoscale,click:u},a.hoverClosestGeo={name:"hoverClosestGeo",_cat:"hoverclosest",title:function(o){return t(o,"Toggle show closest data on hover")},attr:"hovermode",val:null,toggle:!0,icon:x.tooltip_basic,gravity:"ne",click:c},a.hoverClosestGl2d={name:"hoverClosestGl2d",_cat:"hoverclosest",title:function(o){return t(o,"Toggle show closest data on hover")},attr:"hovermode",val:null,toggle:!0,icon:x.tooltip_basic,gravity:"ne",click:c},a.hoverClosestPie={name:"hoverClosestPie",_cat:"hoverclosest",title:function(o){return t(o,"Toggle show closest data on hover")},attr:"hovermode",val:"closest",icon:x.tooltip_basic,gravity:"ne",click:c},a.resetViewSankey={name:"resetSankeyGroup",title:function(o){return t(o,"Reset view")},icon:x.home,click:function(o){for(var b={"node.groups":[],"node.x":[],"node.y":[]},l=0;l<o._fullData.length;l++){var T=o._fullData[l]._viewInitial;b["node.groups"].push(T.node.groups.slice()),b["node.x"].push(T.node.x.slice()),b["node.y"].push(T.node.y.slice())}g.call("restyle",o,b)}},a.toggleHover={name:"toggleHover",title:function(o){return t(o,"Toggle show closest data on hover")},attr:"hovermode",val:null,toggle:!0,icon:x.tooltip_basic,gravity:"ne",click:function(o,b){var l=i(o,b);l.hovermode=f(o),g.call("_guiRelayout",o,l)}},a.resetViews={name:"resetViews",title:function(o){return t(o,"Reset views")},icon:x.home,click:function(o,b){var l=b.currentTarget;l.setAttribute("data-attr","zoom"),l.setAttribute("data-val","reset"),r(o,b),l.setAttribute("data-attr","resetLastSave"),s(o,b),p(o,"geo"),p(o,"mapbox")}},a.toggleSpikelines={name:"toggleSpikelines",title:function(o){return t(o,"Toggle Spike Lines")},icon:x.spikeline,attr:"_cartesianSpikesEnabled",val:"on",click:function(o){var b=o._fullLayout;b._cartesianSpikesEnabled="on"===b._cartesianSpikesEnabled?"off":"on",g.call("_guiRelayout",o,function(T){for(var _="on"===T._fullLayout._cartesianSpikesEnabled,w=m.list(T,null,!0),k={},L=0;L<w.length;L++){var M=w[L];k[M._name+".showspikes"]=!!_||M._showSpikeInitial}return k}(o))}},a.resetViewMapbox={name:"resetViewMapbox",_cat:"resetView",title:function(o){return t(o,"Reset view")},attr:"reset",icon:x.home,click:function(o){p(o,"mapbox")}},a.zoomInMapbox={name:"zoomInMapbox",_cat:"zoomin",title:function(o){return t(o,"Zoom in")},attr:"zoom",val:"in",icon:x.zoom_plus,click:h},a.zoomOutMapbox={name:"zoomOutMapbox",_cat:"zoomout",title:function(o){return t(o,"Zoom out")},attr:"zoom",val:"out",icon:x.zoom_minus,click:h}},{"../../fonts/ploticon":494,"../../lib":515,"../../plots/cartesian/axis_ids":570,"../../plots/plots":628,"../../registry":647,"../shapes/draw":462}],428:[function(y,ee,Q){"use strict";var g=y("./buttons"),v=Object.keys(g),m=["drawline","drawopenpath","drawclosedpath","drawcircle","drawrect","eraseshape"],x=["v1hovermode","hoverclosest","hovercompare","togglehover","togglespikelines"].concat(m),e=[];v.forEach(function(n){!function(t){if(-1===x.indexOf(t._cat||t.name)){var a=t.name,r=(t._cat||t.name).toLowerCase();-1===e.indexOf(a)&&e.push(a),-1===e.indexOf(r)&&e.push(r)}}(g[n])}),e.sort(),ee.exports={DRAW_MODES:m,backButtons:x,foreButtons:e}},{"./buttons":427}],429:[function(y,ee,Q){"use strict";var g=y("../../lib"),v=y("../color"),m=y("../../plot_api/plot_template"),x=y("./attributes");ee.exports=function(e,n){var t=e.modebar||{},a=m.newContainer(n,"modebar");function r(s,i){return g.coerce(t,a,x,s,i)}r("orientation"),r("bgcolor",v.addOpacity(n.paper_bgcolor,.5));var d=v.contrast(v.rgb(n.modebar.bgcolor));r("color",v.addOpacity(d,.3)),r("activecolor",v.addOpacity(d,.7)),r("uirevision",n.uirevision),r("add"),r("remove")}},{"../../lib":515,"../../plot_api/plot_template":555,"../color":367,"./attributes":426}],430:[function(y,ee,Q){"use strict";ee.exports={moduleType:"component",name:"modebar",layoutAttributes:y("./attributes"),supplyLayoutDefaults:y("./defaults"),manage:y("./manage")}},{"./attributes":426,"./defaults":429,"./manage":431}],431:[function(y,ee,Q){"use strict";var g=y("../../plots/cartesian/axis_ids"),v=y("../../traces/scatter/subtypes"),m=y("../../registry"),x=y("../fx/helpers").isUnifiedHover,e=y("./modebar"),n=y("./buttons"),t=y("./constants").DRAW_MODES,a=y("../../lib").extendDeep;ee.exports=function(r){var d=r._fullLayout,s=r._context,i=d._modeBar;if(s.displayModeBar||s.watermark){if(!Array.isArray(s.modeBarButtonsToRemove))throw new Error(["*modeBarButtonsToRemove* configuration options","must be an array."].join(" "));if(!Array.isArray(s.modeBarButtonsToAdd))throw new Error(["*modeBarButtonsToAdd* configuration options","must be an array."].join(" "));var u,f=s.modeBarButtons;u=Array.isArray(f)&&f.length?function(c){for(var h=a([],c),p=0;p<h.length;p++)for(var o=h[p],b=0;b<o.length;b++){var l=o[b];if("string"==typeof l){if(void 0===n[l])throw new Error(["*modeBarButtons* configuration options","invalid button name"].join(" "));h[p][b]=n[l]}}return h}(f):!s.displayModeBar&&s.watermark?[]:function(c){var h=c._fullLayout,p=c._fullData,o=c._context;function b(le,oe){if("string"==typeof oe){if(oe.toLowerCase()===le.toLowerCase())return!0}else if(oe.name===le||(oe._cat||oe.name)===le.toLowerCase())return!0;return!1}var l=h.modebar.add;"string"==typeof l&&(l=[l]);var T=h.modebar.remove;"string"==typeof T&&(T=[T]);var _=o.modeBarButtonsToAdd.concat(l.filter(function(le){for(var oe=0;oe<o.modeBarButtonsToRemove.length;oe++)if(b(le,o.modeBarButtonsToRemove[oe]))return!1;return!0})),w=o.modeBarButtonsToRemove.concat(T.filter(function(le){for(var oe=0;oe<o.modeBarButtonsToAdd.length;oe++)if(b(le,o.modeBarButtonsToAdd[oe]))return!1;return!0})),k=h._has("cartesian"),L=h._has("gl3d"),M=h._has("geo"),I=h._has("pie"),P=h._has("funnelarea"),S=h._has("gl2d"),E=h._has("ternary"),z=h._has("mapbox"),R=h._has("polar"),q=h._has("smith"),V=h._has("sankey"),W=function(le){for(var oe=g.list({_fullLayout:le},null,!0),de=0;de<oe.length;de++)if(!oe[de].fixedrange)return!1;return!0}(h),K=x(h.hovermode),G=[];function Y(le){if(le.length){for(var oe=[],de=0;de<le.length;de++){for(var se=le[de],ge=n[se],_e=ge.name.toLowerCase(),Te=(ge._cat||ge.name).toLowerCase(),we=!1,Oe=0;Oe<w.length;Oe++){var fe=w[Oe].toLowerCase();if(fe===_e||fe===Te){we=!0;break}}we||oe.push(n[se])}G.push(oe)}}var $=["toImage"];o.showEditInChartStudio?$.push("editInChartStudio"):o.showSendToCloud&&$.push("sendDataToCloud"),Y($);var B=[],N=[],U=[],te=[];(k||S||I||P||E)+M+L+z+R+q>1?(N=["toggleHover"],U=["resetViews"]):M?(B=["zoomInGeo","zoomOutGeo"],N=["hoverClosestGeo"],U=["resetGeo"]):L?(N=["hoverClosest3d"],U=["resetCameraDefault3d","resetCameraLastSave3d"]):z?(B=["zoomInMapbox","zoomOutMapbox"],N=["toggleHover"],U=["resetViewMapbox"]):S?N=["hoverClosestGl2d"]:I?N=["hoverClosestPie"]:V?(N=["hoverClosestCartesian","hoverCompareCartesian"],U=["resetViewSankey"]):N=["toggleHover"],k&&(N=["toggleSpikelines","hoverClosestCartesian","hoverCompareCartesian"]),(function(le){for(var oe=0;oe<le.length;oe++)if(!m.traceIs(le[oe],"noHover"))return!1;return!0}(p)||K)&&(N=[]),!k&&!S||W||(B=["zoomIn2d","zoomOut2d","autoScale2d"],"resetViews"!==U[0]&&(U=["resetScale2d"])),L?te=["zoom3d","pan3d","orbitRotation","tableRotation"]:(k||S)&&!W||E?te=["zoom2d","pan2d"]:z||M?te=["pan2d"]:R&&(te=["zoom2d"]),function(le){for(var oe=!1,de=0;de<le.length&&!oe;de++){var se=le[de];se._module&&se._module.selectPoints&&(m.traceIs(se,"scatter-like")?(v.hasMarkers(se)||v.hasText(se))&&(oe=!0):m.traceIs(se,"box-violin")&&"all"!==se.boxpoints&&"all"!==se.points||(oe=!0))}return oe}(p)&&te.push("select2d","lasso2d");var j=[],J=function(le){-1===j.indexOf(le)&&-1!==N.indexOf(le)&&j.push(le)};if(Array.isArray(_)){for(var X=[],re=0;re<_.length;re++){var ne=_[re];"string"==typeof ne?(ne=ne.toLowerCase(),-1!==t.indexOf(ne)?(h._has("mapbox")||h._has("cartesian"))&&te.push(ne):"togglespikelines"===ne?J("toggleSpikelines"):"togglehover"===ne?J("toggleHover"):"hovercompare"===ne?J("hoverCompareCartesian"):"hoverclosest"===ne?(J("hoverClosestCartesian"),J("hoverClosestGeo"),J("hoverClosest3d"),J("hoverClosestGl2d"),J("hoverClosestPie")):"v1hovermode"===ne&&(J("toggleHover"),J("hoverClosestCartesian"),J("hoverCompareCartesian"),J("hoverClosestGeo"),J("hoverClosest3d"),J("hoverClosestGl2d"),J("hoverClosestPie"))):X.push(ne)}_=X}return Y(te),Y(B.concat(U)),Y(j),function(le,oe){if(oe.length)if(Array.isArray(oe[0]))for(var de=0;de<oe.length;de++)le.push(oe[de]);else le.push(oe);return le}(G,_)}(r),i?i.update(r,u):d._modeBar=e(r,u)}else i&&(i.destroy(),delete d._modeBar)}},{"../../lib":515,"../../plots/cartesian/axis_ids":570,"../../registry":647,"../../traces/scatter/subtypes":961,"../fx/helpers":403,"./buttons":427,"./constants":428,"./modebar":432}],432:[function(y,ee,Q){"use strict";var g=y("@plotly/d3"),v=y("fast-isnumeric"),m=y("../../lib"),x=y("../../fonts/ploticon"),e=y("../../version").version,n=new DOMParser;function t(r){this.container=r.container,this.element=document.createElement("div"),this.update(r.graphInfo,r.buttons),this.container.appendChild(this.element)}var a=t.prototype;a.update=function(r,d){this.graphInfo=r;var s=this.graphInfo._context,i=this.graphInfo._fullLayout,u="modebar-"+i._uid;this.element.setAttribute("id",u),this._uid=u,this.element.className="modebar","hover"===s.displayModeBar&&(this.element.className+=" modebar--hover ease-bg"),"v"===i.modebar.orientation&&(this.element.className+=" vertical",d=d.reverse());var f=i.modebar,c="hover"===s.displayModeBar?".js-plotly-plot .plotly:hover ":"";m.deleteRelatedStyleRule(u),m.addRelatedStyleRule(u,c+"#"+u+" .modebar-group","background-color: "+f.bgcolor),m.addRelatedStyleRule(u,"#"+u+" .modebar-btn .icon path","fill: "+f.color),m.addRelatedStyleRule(u,"#"+u+" .modebar-btn:hover .icon path","fill: "+f.activecolor),m.addRelatedStyleRule(u,"#"+u+" .modebar-btn.active .icon path","fill: "+f.activecolor);var h=!this.hasButtons(d),p=this.hasLogo!==s.displaylogo,o=this.locale!==s.locale;if(this.locale=s.locale,(h||p||o)&&(this.removeAllButtons(),this.updateButtons(d),s.watermark||s.displaylogo)){var b=this.getLogo();s.watermark&&(b.className=b.className+" watermark"),"v"===i.modebar.orientation?this.element.insertBefore(b,this.element.childNodes[0]):this.element.appendChild(b),this.hasLogo=!0}this.updateActiveButton()},a.updateButtons=function(r){var d=this;this.buttons=r,this.buttonElements=[],this.buttonsNames=[],this.buttons.forEach(function(s){var i=d.createGroup();s.forEach(function(u){var f=u.name;if(!f)throw new Error("must provide button 'name' in button config");if(-1!==d.buttonsNames.indexOf(f))throw new Error("button name '"+f+"' is taken");d.buttonsNames.push(f);var c=d.createButton(u);d.buttonElements.push(c),i.appendChild(c)}),d.element.appendChild(i)})},a.createGroup=function(){var r=document.createElement("div");return r.className="modebar-group",r},a.createButton=function(r){var d=this,s=document.createElement("a");s.setAttribute("rel","tooltip"),s.className="modebar-btn";var i=r.title;void 0===i?i=r.name:"function"==typeof i&&(i=i(this.graphInfo)),(i||0===i)&&s.setAttribute("data-title",i),void 0!==r.attr&&s.setAttribute("data-attr",r.attr);var u=r.val;if(void 0!==u&&("function"==typeof u&&(u=u(this.graphInfo)),s.setAttribute("data-val",u)),"function"!=typeof r.click)throw new Error("must provide button 'click' function in button config");s.addEventListener("click",function(c){r.click(d.graphInfo,c),d.updateActiveButton(c.currentTarget)}),s.setAttribute("data-toggle",r.toggle||!1),r.toggle&&g.select(s).classed("active",!0);var f=r.icon;return s.appendChild("function"==typeof f?f():this.createIcon(f||x.question)),s.setAttribute("data-gravity",r.gravity||"n"),s},a.createIcon=function(r){var d,s=v(r.height)?Number(r.height):r.ascent-r.descent,i="http://www.w3.org/2000/svg";if(r.path){(d=document.createElementNS(i,"svg")).setAttribute("viewBox",[0,0,r.width,s].join(" ")),d.setAttribute("class","icon");var u=document.createElementNS(i,"path");u.setAttribute("d",r.path),r.transform?u.setAttribute("transform",r.transform):void 0!==r.ascent&&u.setAttribute("transform","matrix(1 0 0 -1 0 "+r.ascent+")"),d.appendChild(u)}return r.svg&&(d=n.parseFromString(r.svg,"application/xml").childNodes[0]),d.setAttribute("height","1em"),d.setAttribute("width","1em"),d},a.updateActiveButton=function(r){var d=this.graphInfo._fullLayout,s=void 0!==r?r.getAttribute("data-attr"):null;this.buttonElements.forEach(function(i){var u=i.getAttribute("data-val")||!0,f=i.getAttribute("data-attr"),c="true"===i.getAttribute("data-toggle"),h=g.select(i);if(c)f===s&&h.classed("active",!h.classed("active"));else{var p=null===f?f:m.nestedProperty(d,f).get();h.classed("active",p===u)}})},a.hasButtons=function(r){var d=this.buttons;if(!d||r.length!==d.length)return!1;for(var s=0;s<r.length;++s){if(r[s].length!==d[s].length)return!1;for(var i=0;i<r[s].length;i++)if(r[s][i].name!==d[s][i].name)return!1}return!0},a.getLogo=function(){var r=this.createGroup(),d=document.createElement("a");return d.href="https://plotly.com/",d.target="_blank",d.setAttribute("data-title",m._(this.graphInfo,"Produced with Plotly.js")+" (v"+e+")"),d.className="modebar-btn plotlyjsicon modebar-btn--logo",d.appendChild(this.createIcon(x.newplotlylogo)),r.appendChild(d),r},a.removeAllButtons=function(){for(;this.element.firstChild;)this.element.removeChild(this.element.firstChild);this.hasLogo=!1},a.destroy=function(){m.removeElement(this.container.querySelector(".modebar")),m.deleteRelatedStyleRule(this._uid)},ee.exports=function(r,d){var s=r._fullLayout,i=new t({graphInfo:r,container:s._modebardiv.node(),buttons:d});return s._privateplot&&g.select(i.element).append("span").classed("badge-private float--left",!0).text("PRIVATE"),i}},{"../../fonts/ploticon":494,"../../lib":515,"../../version":1132,"@plotly/d3":58,"fast-isnumeric":190}],433:[function(y,ee,Q){"use strict";var g=y("../../plots/font_attributes"),v=y("../color/attributes"),m=(0,y("../../plot_api/plot_template").templatedArray)("button",{visible:{valType:"boolean",dflt:!0,editType:"plot"},step:{valType:"enumerated",values:["month","year","day","hour","minute","second","all"],dflt:"month",editType:"plot"},stepmode:{valType:"enumerated",values:["backward","todate"],dflt:"backward",editType:"plot"},count:{valType:"number",min:0,dflt:1,editType:"plot"},label:{valType:"string",editType:"plot"},editType:"plot"});ee.exports={visible:{valType:"boolean",editType:"plot"},buttons:m,x:{valType:"number",min:-2,max:3,editType:"plot"},xanchor:{valType:"enumerated",values:["auto","left","center","right"],dflt:"left",editType:"plot"},y:{valType:"number",min:-2,max:3,editType:"plot"},yanchor:{valType:"enumerated",values:["auto","top","middle","bottom"],dflt:"bottom",editType:"plot"},font:g({editType:"plot"}),bgcolor:{valType:"color",dflt:v.lightLine,editType:"plot"},activecolor:{valType:"color",editType:"plot"},bordercolor:{valType:"color",dflt:v.defaultLine,editType:"plot"},borderwidth:{valType:"number",min:0,dflt:0,editType:"plot"},editType:"plot"}},{"../../plot_api/plot_template":555,"../../plots/font_attributes":594,"../color/attributes":366}],434:[function(y,ee,Q){"use strict";ee.exports={yPad:.02,minButtonWidth:30,rx:3,ry:3,lightAmount:25,darkAmount:10}},{}],435:[function(y,ee,Q){"use strict";var g=y("../../lib"),v=y("../color"),m=y("../../plot_api/plot_template"),x=y("../../plots/array_container_defaults"),e=y("./attributes"),n=y("./constants");function t(a,r,d,s){var i=s.calendar;function u(c,h){return g.coerce(a,r,e.buttons,c,h)}if(u("visible")){var f=u("step");"all"!==f&&(!i||"gregorian"===i||"month"!==f&&"year"!==f?u("stepmode"):r.stepmode="backward",u("count")),u("label")}}ee.exports=function(a,r,d,s,i){var u=a.rangeselector||{},f=m.newContainer(r,"rangeselector");function c(o,b){return g.coerce(u,f,e,o,b)}if(c("visible",x(u,f,{name:"buttons",handleItemDefaults:t,calendar:i}).length>0)){var h=function(o,b,l){for(var T=l.filter(function(L){return b[L].anchor===o._id}),_=0,w=0;w<T.length;w++){var k=b[T[w]].domain;k&&(_=Math.max(k[1],_))}return[o.domain[0],_+n.yPad]}(r,d,s);c("x",h[0]),c("y",h[1]),g.noneOrAll(a,r,["x","y"]),c("xanchor"),c("yanchor"),g.coerceFont(c,"font",d.font);var p=c("bgcolor");c("activecolor",v.contrast(p,n.lightAmount,n.darkAmount)),c("bordercolor"),c("borderwidth")}}},{"../../lib":515,"../../plot_api/plot_template":555,"../../plots/array_container_defaults":561,"../color":367,"./attributes":433,"./constants":434}],436:[function(y,ee,Q){"use strict";var g=y("@plotly/d3"),v=y("../../registry"),m=y("../../plots/plots"),x=y("../color"),e=y("../drawing"),n=y("../../lib"),t=n.strTranslate,a=y("../../lib/svg_text_utils"),r=y("../../plots/cartesian/axis_ids"),d=y("../../constants/alignment"),s=d.LINE_SPACING,i=d.FROM_TL,u=d.FROM_BR,f=y("./constants"),c=y("./get_update_object");function h(b){return b._id}function p(b,l,T){var w,k,_=n.ensureSingle(b,"rect","selector-rect",function(w){w.attr("shape-rendering","crispEdges")});_.attr({rx:f.rx,ry:f.ry}),_.call(x.stroke,l.bordercolor).call(x.fill,(w=l,k=T,k._isActive||k._isHovered?w.activecolor:w.bgcolor)).style("stroke-width",l.borderwidth+"px")}function o(b,l,T,_){var w,k;n.ensureSingle(b,"text","selector-text",function(w){w.attr("text-anchor","middle")}).call(e.font,l.font).text((w=T,k=_._fullLayout._meta,w.label?k?n.templateString(w.label,k):w.label:"all"===w.step?"all":w.count+w.step.charAt(0))).call(function(w){a.convertToTspans(w,_)})}ee.exports=function(b){var l=b._fullLayout._infolayer.selectAll(".rangeselector").data(function(T){for(var _=r.list(T,"x",!0),w=[],k=0;k<_.length;k++){var L=_[k];L.rangeselector&&L.rangeselector.visible&&w.push(L)}return w}(b),h);l.enter().append("g").classed("rangeselector",!0),l.exit().remove(),l.style({cursor:"pointer","pointer-events":"all"}),l.each(function(T){var _=g.select(this),w=T,k=w.rangeselector,L=_.selectAll("g.button").data(n.filterVisible(k.buttons));L.enter().append("g").classed("button",!0),L.exit().remove(),L.each(function(M){var I=g.select(this),P=c(w,M);M._isActive=function(S,E,z){if("all"===E.step)return!0===S.autorange;var R=Object.keys(z);return S.range[0]===z[R[0]]&&S.range[1]===z[R[1]]}(w,M,P),I.call(p,k,M),I.call(o,k,M,b),I.on("click",function(){b._dragged||v.call("_guiRelayout",b,P)}),I.on("mouseover",function(){M._isHovered=!0,I.call(p,k,M)}),I.on("mouseout",function(){M._isHovered=!1,I.call(p,k,M)})}),function(M,I,P,S,E){var z=0,R=0,q=P.borderwidth;I.each(function(){var $=g.select(this).select(".selector-text"),N=Math.max(P.font.size*s*a.lineCount($),16)+3;R=Math.max(R,N)}),I.each(function(){var $=g.select(this),B=$.select(".selector-rect"),N=$.select(".selector-text"),U=N.node()&&e.bBox(N.node()).width,te=P.font.size*s,j=a.lineCount(N),J=Math.max(U+10,f.minButtonWidth);$.attr("transform",t(q+z,q)),B.attr({x:0,y:0,width:J,height:R}),a.positionText(N,J/2,R/2-(j-1)*te/2+3),z+=J+5});var V=M._fullLayout._size,W=V.l+V.w*P.x,K=V.t+V.h*(1-P.y),G="left";n.isRightAnchor(P)&&(W-=z,G="right"),n.isCenterAnchor(P)&&(W-=z/2,G="center");var Y="top";n.isBottomAnchor(P)&&(K-=R,Y="bottom"),n.isMiddleAnchor(P)&&(K-=R/2,Y="middle"),z=Math.ceil(z),R=Math.ceil(R),W=Math.round(W),K=Math.round(K),m.autoMargin(M,S+"-range-selector",{x:P.x,y:P.y,l:z*i[G],r:z*u[G],b:R*u[Y],t:R*i[Y]}),E.attr("transform",t(W,K))}(b,L,k,w._name,_)})}},{"../../constants/alignment":483,"../../lib":515,"../../lib/svg_text_utils":541,"../../plots/cartesian/axis_ids":570,"../../plots/plots":628,"../../registry":647,"../color":367,"../drawing":389,"./constants":434,"./get_update_object":437,"@plotly/d3":58}],437:[function(y,ee,Q){"use strict";var g=y("d3-time"),v=y("../../lib").titleCase;ee.exports=function(m,x){var e=m._name,n={};if("all"===x.step)n[e+".autorange"]=!0;else{var t=function(a,r){var d,s=a.range,i=new Date(a.r2l(s[1])),f=g["utc"+v(r.step)],c=r.count;switch(r.stepmode){case"backward":d=a.l2r(+f.offset(i,-c));break;case"todate":var h=f.offset(i,-c);d=a.l2r(+f.ceil(h))}return[d,s[1]]}(m,x);n[e+".range[0]"]=t[0],n[e+".range[1]"]=t[1]}return n}},{"../../lib":515,"d3-time":122}],438:[function(y,ee,Q){"use strict";ee.exports={moduleType:"component",name:"rangeselector",schema:{subplots:{xaxis:{rangeselector:y("./attributes")}}},layoutAttributes:y("./attributes"),handleDefaults:y("./defaults"),draw:y("./draw")}},{"./attributes":433,"./defaults":435,"./draw":436}],439:[function(y,ee,Q){"use strict";var g=y("../color/attributes");ee.exports={bgcolor:{valType:"color",dflt:g.background,editType:"plot"},bordercolor:{valType:"color",dflt:g.defaultLine,editType:"plot"},borderwidth:{valType:"integer",dflt:0,min:0,editType:"plot"},autorange:{valType:"boolean",dflt:!0,editType:"calc",impliedEdits:{"range[0]":void 0,"range[1]":void 0}},range:{valType:"info_array",items:[{valType:"any",editType:"calc",impliedEdits:{"^autorange":!1}},{valType:"any",editType:"calc",impliedEdits:{"^autorange":!1}}],editType:"calc",impliedEdits:{autorange:!1}},thickness:{valType:"number",dflt:.15,min:0,max:1,editType:"plot"},visible:{valType:"boolean",dflt:!0,editType:"calc"},editType:"calc"}},{"../color/attributes":366}],440:[function(y,ee,Q){"use strict";var g=y("../../plots/cartesian/axis_ids").list,v=y("../../plots/cartesian/autorange").getAutoRange,m=y("./constants");ee.exports=function(x){for(var e=g(x,"x",!0),n=0;n<e.length;n++){var t=e[n],a=t[m.name];a&&a.visible&&a.autorange&&(a._input.autorange=!0,a._input.range=a.range=v(x,t))}}},{"../../plots/cartesian/autorange":565,"../../plots/cartesian/axis_ids":570,"./constants":441}],441:[function(y,ee,Q){"use strict";ee.exports={name:"rangeslider",containerClassName:"rangeslider-container",bgClassName:"rangeslider-bg",rangePlotClassName:"rangeslider-rangeplot",maskMinClassName:"rangeslider-mask-min",maskMaxClassName:"rangeslider-mask-max",slideBoxClassName:"rangeslider-slidebox",grabberMinClassName:"rangeslider-grabber-min",grabAreaMinClassName:"rangeslider-grabarea-min",handleMinClassName:"rangeslider-handle-min",grabberMaxClassName:"rangeslider-grabber-max",grabAreaMaxClassName:"rangeslider-grabarea-max",handleMaxClassName:"rangeslider-handle-max",maskMinOppAxisClassName:"rangeslider-mask-min-opp-axis",maskMaxOppAxisClassName:"rangeslider-mask-max-opp-axis",maskColor:"rgba(0,0,0,0.4)",maskOppAxisColor:"rgba(0,0,0,0.2)",slideBoxFill:"transparent",slideBoxCursor:"ew-resize",grabAreaFill:"transparent",grabAreaCursor:"col-resize",grabAreaWidth:10,handleWidth:4,handleRadius:1,handleStrokeWidth:1,extraPad:15}},{}],442:[function(y,ee,Q){"use strict";var g=y("../../lib"),v=y("../../plot_api/plot_template"),m=y("../../plots/cartesian/axis_ids"),x=y("./attributes"),e=y("./oppaxis_attributes");ee.exports=function(n,t,a){var r=n[a],d=t[a];if(r.rangeslider||t._requestRangeslider[d._id]){g.isPlainObject(r.rangeslider)||(r.rangeslider={});var s,i,u=r.rangeslider,f=v.newContainer(d,"rangeslider");if(_("visible")){_("bgcolor",t.plot_bgcolor),_("bordercolor"),_("borderwidth"),_("thickness"),_("autorange",!d.isValidRange(u.range)),_("range");var c=t._subplots;if(c)for(var h=c.cartesian.filter(function(k){return k.substr(0,k.indexOf("y"))===m.name2id(a)}).map(function(k){return k.substr(k.indexOf("y"),k.length)}),p=g.simpleMap(h,m.id2name),o=0;o<p.length;o++){var b=p[o];s=u[b]||{},i=v.newContainer(f,b,"yaxis");var l,T=t[b];s.range&&T.isValidRange(s.range)&&(l="fixed"),"match"!==w("rangemode",l)&&w("range",T.range.slice())}f._input=u}}function _(k,L){return g.coerce(u,f,x,k,L)}function w(k,L){return g.coerce(s,i,e,k,L)}}},{"../../lib":515,"../../plot_api/plot_template":555,"../../plots/cartesian/axis_ids":570,"./attributes":439,"./oppaxis_attributes":446}],443:[function(y,ee,Q){"use strict";var g=y("@plotly/d3"),v=y("../../registry"),m=y("../../plots/plots"),x=y("../../lib"),e=x.strTranslate,n=y("../drawing"),t=y("../color"),a=y("../titles"),r=y("../../plots/cartesian"),d=y("../../plots/cartesian/axis_ids"),s=y("../dragelement"),i=y("../../lib/setcursor"),u=y("./constants");function f(l,T,_,w){var k=x.ensureSingle(l,"rect",u.bgClassName,function(P){P.attr({x:0,y:0,"shape-rendering":"crispEdges"})}),L=w.borderwidth%2==0?w.borderwidth:w.borderwidth-1,M=-w._offsetShift,I=n.crispRound(T,w.borderwidth);k.attr({width:w._width+L,height:w._height+L,transform:e(M,M),fill:w.bgcolor,stroke:w.bordercolor,"stroke-width":I})}function c(l,T,_,w){x.ensureSingleById(T._fullLayout._topdefs,"clipPath",w._clipId,function(L){L.append("rect").attr({x:0,y:0})}).select("rect").attr({width:w._width,height:w._height})}function h(l,T,_,w){var k,L=T.calcdata,M=l.selectAll("g."+u.rangePlotClassName).data(_._subplotsWith,x.identity);M.enter().append("g").attr("class",function(I){return u.rangePlotClassName+" "+I}).call(n.setClipUrl,w._clipId,T),M.order(),M.exit().remove(),M.each(function(I,P){var S=g.select(this),E=0===P,z=d.getFromId(T,I,"y"),R=z._name,q=w[R],V={data:[],layout:{xaxis:{type:_.type,domain:[0,1],range:w.range.slice(),calendar:_.calendar},width:w._width,height:w._height,margin:{t:0,b:0,l:0,r:0}},_context:T._context};_.rangebreaks&&(V.layout.xaxis.rangebreaks=_.rangebreaks),V.layout[R]={type:z.type,domain:[0,1],range:"match"!==q.rangemode?q.range.slice():z.range.slice(),calendar:z.calendar},z.rangebreaks&&(V.layout[R].rangebreaks=z.rangebreaks),m.supplyDefaults(V);var W=V._fullLayout.xaxis,K=V._fullLayout[R];W.clearCalc(),W.setScale(),K.clearCalc(),K.setScale();var G={id:I,plotgroup:S,xaxis:W,yaxis:K,isRangePlot:!0};E?k=G:(G.mainplot="xy",G.mainplotinfo=k),r.rangePlot(T,G,function(Y,$){for(var B=[],N=0;N<Y.length;N++){var U=Y[N],te=U[0].trace;te.xaxis+te.yaxis===$&&B.push(U)}return B}(L,I))})}function p(l,T,_,w,k){x.ensureSingle(l,"rect",u.maskMinClassName,function(L){L.attr({x:0,y:0,"shape-rendering":"crispEdges"})}).attr("height",w._height).call(t.fill,u.maskColor),x.ensureSingle(l,"rect",u.maskMaxClassName,function(L){L.attr({y:0,"shape-rendering":"crispEdges"})}).attr("height",w._height).call(t.fill,u.maskColor),"match"!==k.rangemode&&(x.ensureSingle(l,"rect",u.maskMinOppAxisClassName,function(L){L.attr({y:0,"shape-rendering":"crispEdges"})}).attr("width",w._width).call(t.fill,u.maskOppAxisColor),x.ensureSingle(l,"rect",u.maskMaxOppAxisClassName,function(L){L.attr({y:0,"shape-rendering":"crispEdges"})}).attr("width",w._width).style("border-top",u.maskOppBorder).call(t.fill,u.maskOppAxisColor))}function o(l,T,_,w){T._context.staticPlot||x.ensureSingle(l,"rect",u.slideBoxClassName,function(k){k.attr({y:0,cursor:u.slideBoxCursor,"shape-rendering":"crispEdges"})}).attr({height:w._height,fill:u.slideBoxFill})}function b(l,T,_,w){var k=x.ensureSingle(l,"g",u.grabberMinClassName),L=x.ensureSingle(l,"g",u.grabberMaxClassName),M={x:0,width:u.handleWidth,rx:u.handleRadius,fill:t.background,stroke:t.defaultLine,"stroke-width":u.handleStrokeWidth,"shape-rendering":"crispEdges"},I={y:Math.round(w._height/4),height:Math.round(w._height/2)};x.ensureSingle(k,"rect",u.handleMinClassName,function(S){S.attr(M)}).attr(I),x.ensureSingle(L,"rect",u.handleMaxClassName,function(S){S.attr(M)}).attr(I);var P={width:u.grabAreaWidth,x:0,y:0,fill:u.grabAreaFill,cursor:T._context.staticPlot?void 0:u.grabAreaCursor};x.ensureSingle(k,"rect",u.grabAreaMinClassName,function(S){S.attr(P)}).attr("height",w._height),x.ensureSingle(L,"rect",u.grabAreaMaxClassName,function(S){S.attr(P)}).attr("height",w._height)}ee.exports=function(l){for(var T=l._fullLayout,_=T._rangeSliderData,w=0;w<_.length;w++){var k=_[w][u.name];k._clipId=k._id+"-"+T._uid}var L=T._infolayer.selectAll("g."+u.containerClassName).data(_,function(M){return M._name});L.exit().each(function(M){T._topdefs.select("#"+M[u.name]._clipId).remove()}).remove(),0!==_.length&&(L.enter().append("g").classed(u.containerClassName,!0).attr("pointer-events","all"),L.each(function(M){var I=g.select(this),P=M[u.name],S=T[d.id2name(M.anchor)],E=P[d.id2name(M.anchor)];if(P.range){var z,R=x.simpleMap(P.range,M.r2l),q=x.simpleMap(M.range,M.r2l);z=q[0]<q[1]?[Math.min(R[0],q[0]),Math.max(R[1],q[1])]:[Math.max(R[0],q[0]),Math.min(R[1],q[1])],P.range=P._input.range=x.simpleMap(z,M.l2r)}M.cleanRange("rangeslider.range");var V=T._size,W=M.domain;P._width=V.w*(W[1]-W[0]);var K=Math.round(V.l+V.w*W[0]),G=Math.round(V.t+V.h*(1-M._counterDomainMin)+("bottom"===M.side?M._depth:0)+P._offsetShift+u.extraPad);I.attr("transform",e(K,G)),P._rl=x.simpleMap(P.range,M.r2l);var Y=P._rl[0],$=P._rl[1],B=$-Y;if(P.p2d=function(le){return le/P._width*B+Y},P.d2p=function(le){return(le-Y)/B*P._width},M.rangebreaks){var N=M.locateBreaks(Y,$);if(N.length){var U,te,j=0;for(U=0;U<N.length;U++)j+=(te=N[U]).max-te.min;var J=P._width/($-Y-j),X=[-J*Y];for(U=0;U<N.length;U++)X.push(X[X.length-1]-J*((te=N[U]).max-te.min));for(P.d2p=function(le){for(var oe=X[0],de=0;de<N.length;de++){var se=N[de];if(le>=se.max)oe=X[de+1];else if(le<se.min)break}return oe+J*le},U=0;U<N.length;U++)(te=N[U]).pmin=P.d2p(te.min),te.pmax=P.d2p(te.max);P.p2d=function(le){for(var oe=X[0],de=0;de<N.length;de++){var se=N[de];if(le>=se.pmax)oe=X[de+1];else if(le<se.pmin)break}return(le-oe)/J}}}if("match"!==E.rangemode){var re=S.r2l(E.range[0]),ne=S.r2l(E.range[1])-re;P.d2pOppAxis=function(le){return(le-re)/ne*P._height}}I.call(f,l,M,P).call(c,l,M,P).call(h,l,M,P).call(p,l,M,P,E).call(o,l,M,P).call(b,l,M,P),function(le,oe,de,se){if(!oe._context.staticPlot){var ge=le.select("rect."+u.slideBoxClassName).node(),_e=le.select("rect."+u.grabAreaMinClassName).node(),Te=le.select("rect."+u.grabAreaMaxClassName).node();le.on("mousedown",we),le.on("touchstart",we)}function we(){var Oe=g.event,fe=Oe.target,ve=Oe.clientX||Oe.touches[0].clientX,Ae=ve-le.node().getBoundingClientRect().left,ke=se.d2p(de._rl[0]),Pe=se.d2p(de._rl[1]),Ne=s.coverSlip();function De(Me){var Se,Ie,Fe,Re=+(Me.clientX||Me.touches[0].clientX)-ve;switch(fe){case ge:Fe="ew-resize",Se=ke+Re,Ie=Pe+Re;break;case _e:Fe="col-resize",Se=ke+Re,Ie=Pe;break;case Te:Fe="col-resize",Se=ke,Ie=Pe+Re;break;default:Fe="ew-resize",Se=Ae,Ie=Ae+Re}if(Ie<Se){var Xe=Ie;Ie=Se,Se=Xe}se._pixelMin=Se,se._pixelMax=Ie,i(g.select(Ne),Fe),function(nt,ct,xt,dt){function tt(Bt){return xt.l2r(x.constrain(Bt,dt._rl[0],dt._rl[1]))}var Ke=tt(dt.p2d(dt._pixelMin)),mt=tt(dt.p2d(dt._pixelMax));window.requestAnimationFrame(function(){v.call("_guiRelayout",ct,xt._name+".range",[Ke,mt])})}(0,oe,de,se)}function ze(){Ne.removeEventListener("mousemove",De),Ne.removeEventListener("mouseup",ze),this.removeEventListener("touchmove",De),this.removeEventListener("touchend",ze),x.removeElement(Ne)}this.addEventListener("touchmove",De),this.addEventListener("touchend",ze),Ne.addEventListener("mousemove",De),Ne.addEventListener("mouseup",ze)}}(I,l,M,P),function(le,oe,de,se,ge,_e){var Te=u.handleWidth/2;function we(ze){return x.constrain(ze,0,se._width)}function Oe(ze){return x.constrain(ze,0,se._height)}function fe(ze){return x.constrain(ze,-Te,se._width+Te)}var ve=we(se.d2p(de._rl[0])),Ae=we(se.d2p(de._rl[1]));if(le.select("rect."+u.slideBoxClassName).attr("x",ve).attr("width",Ae-ve),le.select("rect."+u.maskMinClassName).attr("width",ve),le.select("rect."+u.maskMaxClassName).attr("x",Ae).attr("width",se._width-Ae),"match"!==_e.rangemode){var ke=se._height-Oe(se.d2pOppAxis(ge._rl[1])),Pe=se._height-Oe(se.d2pOppAxis(ge._rl[0]));le.select("rect."+u.maskMinOppAxisClassName).attr("x",ve).attr("height",ke).attr("width",Ae-ve),le.select("rect."+u.maskMaxOppAxisClassName).attr("x",ve).attr("y",Pe).attr("height",se._height-Pe).attr("width",Ae-ve),le.select("rect."+u.slideBoxClassName).attr("y",ke).attr("height",Pe-ke)}var Ne=Math.round(fe(ve-Te))-.5,De=Math.round(fe(Ae-Te))+.5;le.select("g."+u.grabberMinClassName).attr("transform",e(Ne,.5)),le.select("g."+u.grabberMaxClassName).attr("transform",e(De,.5))}(I,0,M,P,S,E),"bottom"===M.side&&a.draw(l,M._id+"title",{propContainer:M,propName:M._name+".title",placeholder:T._dfltTitle.x,attributes:{x:M._offset+M._length/2,y:G+P._height+P._offsetShift+10+1.5*M.title.font.size,"text-anchor":"middle"}})}))}},{"../../lib":515,"../../lib/setcursor":536,"../../plots/cartesian":578,"../../plots/cartesian/axis_ids":570,"../../plots/plots":628,"../../registry":647,"../color":367,"../dragelement":386,"../drawing":389,"../titles":476,"./constants":441,"@plotly/d3":58}],444:[function(y,ee,Q){"use strict";var g=y("../../plots/cartesian/axis_ids"),v=y("../../lib/svg_text_utils"),m=y("./constants"),x=y("../../constants/alignment").LINE_SPACING,e=m.name;function n(t){var a=t&&t[e];return a&&a.visible}Q.isVisible=n,Q.makeData=function(t){var a=g.list({_fullLayout:t},"x",!0),r=t.margin,d=[];if(!t._has("gl2d"))for(var s=0;s<a.length;s++){var i=a[s];if(n(i)){d.push(i);var u=i[e];u._id=e+i._id,u._height=(t.height-r.b-r.t)*u.thickness,u._offsetShift=Math.floor(u.borderwidth/2)}}t._rangeSliderData=d},Q.autoMarginOpts=function(t,a){var r=t._fullLayout,d=a[e],s=a._id.charAt(0),i=0,u=0;return"bottom"===a.side&&(i=a._depth,a.title.text!==r._dfltTitle[s]&&(u=1.5*a.title.font.size+10+d._offsetShift,u+=(a.title.text.match(v.BR_TAG_ALL)||[]).length*a.title.font.size*x)),{x:0,y:a._counterDomainMin,l:0,r:0,t:0,b:d._height+i+Math.max(r.margin.b,u),pad:m.extraPad+2*d._offsetShift}}},{"../../constants/alignment":483,"../../lib/svg_text_utils":541,"../../plots/cartesian/axis_ids":570,"./constants":441}],445:[function(y,ee,Q){"use strict";var g=y("../../lib"),v=y("./attributes"),m=y("./oppaxis_attributes"),x=y("./helpers");ee.exports={moduleType:"component",name:"rangeslider",schema:{subplots:{xaxis:{rangeslider:g.extendFlat({},v,{yaxis:m})}}},layoutAttributes:y("./attributes"),handleDefaults:y("./defaults"),calcAutorange:y("./calc_autorange"),draw:y("./draw"),isVisible:x.isVisible,makeData:x.makeData,autoMarginOpts:x.autoMarginOpts}},{"../../lib":515,"./attributes":439,"./calc_autorange":440,"./defaults":442,"./draw":443,"./helpers":444,"./oppaxis_attributes":446}],446:[function(y,ee,Q){"use strict";ee.exports={_isSubplotObj:!0,rangemode:{valType:"enumerated",values:["auto","fixed","match"],dflt:"match",editType:"calc"},range:{valType:"info_array",items:[{valType:"any",editType:"plot"},{valType:"any",editType:"plot"}],editType:"plot"},editType:"calc"}},{}],447:[function(y,ee,Q){"use strict";var g=y("../annotations/attributes"),v=y("../../traces/scatter/attributes").line,m=y("../drawing/attributes").dash,x=y("../../lib/extend").extendFlat,e=y("../../plot_api/edit_types").overrideAll,n=y("../../plot_api/plot_template").templatedArray;y("../../constants/axis_placeable_objects"),ee.exports=e(n("selection",{type:{valType:"enumerated",values:["rect","path"]},xref:x({},g.xref,{}),yref:x({},g.yref,{}),x0:{valType:"any"},x1:{valType:"any"},y0:{valType:"any"},y1:{valType:"any"},path:{valType:"string",editType:"arraydraw"},opacity:{valType:"number",min:0,max:1,dflt:.7,editType:"arraydraw"},line:{color:v.color,width:x({},v.width,{min:1,dflt:1}),dash:x({},m,{dflt:"dot"})}}),"arraydraw","from-root")},{"../../constants/axis_placeable_objects":484,"../../lib/extend":505,"../../plot_api/edit_types":548,"../../plot_api/plot_template":555,"../../traces/scatter/attributes":936,"../annotations/attributes":350,"../drawing/attributes":388}],448:[function(y,ee,Q){"use strict";ee.exports={BENDPX:1.5,MINSELECT:12,SELECTDELAY:100,SELECTID:"-select"}},{}],449:[function(y,ee,Q){"use strict";var g=y("../../lib"),v=y("../../plots/cartesian/axes"),m=y("../../plots/array_container_defaults"),x=y("./attributes"),e=y("../shapes/helpers");function n(t,a,r){function d(I,P){return g.coerce(t,a,x,I,P)}var s=d("path"),i="path"!==d("type",s?"path":"rect");i&&delete a.path,d("opacity"),d("line.color"),d("line.width"),d("line.dash");for(var u=["x","y"],f=0;f<2;f++){var c,h,p,o=u[f],b={_fullLayout:r},l=v.coerceRef(t,a,b,o);if((c=v.getFromId(b,l))._selectionIndices.push(a._index),p=e.rangeToShapePosition(c),h=e.shapePositionToRange(c),i){var T=o+"0",_=o+"1",w=t[T],k=t[_];t[T]=h(t[T],!0),t[_]=h(t[_],!0),v.coercePosition(a,b,d,l,T),v.coercePosition(a,b,d,l,_);var L=a[T],M=a[_];void 0!==L&&void 0!==M&&(a[T]=p(L),a[_]=p(M),t[T]=w,t[_]=k)}}i&&g.noneOrAll(t,a,["x0","x1","y0","y1"])}ee.exports=function(t,a){m(t,a,{name:"selections",handleItemDefaults:n});for(var r=a.selections,d=0;d<r.length;d++){var s=r[d];s&&void 0===s.path&&(void 0!==s.x0&&void 0!==s.x1&&void 0!==s.y0&&void 0!==s.y1||(a.selections[d]=null))}}},{"../../lib":515,"../../plots/array_container_defaults":561,"../../plots/cartesian/axes":566,"../shapes/helpers":469,"./attributes":447}],450:[function(y,ee,Q){"use strict";var g=y("../shapes/draw_newshape/helpers").readPaths,v=y("../shapes/display_outlines"),m=y("../shapes/handle_outline").clearOutlineControllers,x=y("../color"),e=y("../drawing"),n=y("../../plot_api/plot_template").arrayEditor,t=y("../shapes/helpers"),a=t.getPathString;function r(u){var f=u._fullLayout;for(var c in m(u),f._selectionLayer.selectAll("path").remove(),f._plots){var h=f._plots[c].selectionLayer;h&&h.selectAll("path").remove()}for(var p=0;p<f.selections.length;p++)d(u,p)}function d(u,f){u._fullLayout._paperdiv.selectAll('.selectionlayer [data-index="'+f+'"]').remove();var c=t.makeSelectionsOptionsAndPlotinfo(u,f),h=c.options,p=c.plotinfo;h._input&&function(o){var b=a(u,h),l={"data-index":f,"fill-rule":"evenodd",d:b},T=h.opacity,_="rgba(0,0,0,0)",w=h.line.color||x.contrast(u._fullLayout.plot_bgcolor),k=h.line.width,L=h.line.dash;k||(k=5,L="solid");var M=u._fullLayout._activeSelectionIndex===f;M&&(_=u._fullLayout.activeselection.fillcolor,T=u._fullLayout.activeselection.opacity);for(var I=[],P=1;P>=0;P--){var S=o.append("path").attr(l).style("opacity",P?.1:T).call(x.stroke,w).call(x.fill,_).call(e.dashLine,P?"solid":L,P?4+k:k);if(s(S,u,h),M){var E=n(u.layout,"selections",h);S.style({cursor:"move"});var z={element:S.node(),plotinfo:p,gd:u,editHelpers:E,isActiveSelection:!0},R=g(b,u);v(R,S,z)}else S.style("pointer-events",P?"all":"none");I[P]=S}var q=I[0];I[1].node().addEventListener("click",function(){return function(V,W){var K=+W.node().getAttribute("data-index");if(K>=0){if(K===V._fullLayout._activeSelectionIndex)return void i(V);V._fullLayout._activeSelectionIndex=K,V._fullLayout._deactivateSelection=i,r(V)}}(u,q)})}(u._fullLayout._selectionLayer)}function s(u,f,c){e.setClipUrl(u,"clip"+f._fullLayout._uid+(c.xref+c.yref),f)}function i(u){u._fullLayout._activeSelectionIndex>=0&&(m(u),delete u._fullLayout._activeSelectionIndex,r(u))}ee.exports={draw:r,drawOne:d,activateLastSelection:function(u){u._fullLayout._activeSelectionIndex=u._fullLayout.selections.length-1,u._fullLayout._deactivateSelection=i,r(u)}}},{"../../plot_api/plot_template":555,"../color":367,"../drawing":389,"../shapes/display_outlines":461,"../shapes/draw_newshape/helpers":466,"../shapes/handle_outline":468,"../shapes/helpers":469}],451:[function(y,ee,Q){"use strict";var g=y("../../drawing/attributes").dash,v=y("../../../lib/extend").extendFlat;ee.exports={newselection:{mode:{valType:"enumerated",values:["immediate","gradual"],dflt:"immediate",editType:"none"},line:{color:{valType:"color",editType:"none"},width:{valType:"number",min:1,dflt:1,editType:"none"},dash:v({},g,{dflt:"dot",editType:"none"}),editType:"none"},editType:"none"},activeselection:{fillcolor:{valType:"color",dflt:"rgba(0,0,0,0)",editType:"none"},opacity:{valType:"number",min:0,max:1,dflt:.5,editType:"none"},editType:"none"}}},{"../../../lib/extend":505,"../../drawing/attributes":388}],452:[function(y,ee,Q){"use strict";ee.exports=function(g,v,m){m("newselection.mode"),m("newselection.line.width")&&(m("newselection.line.color"),m("newselection.line.dash")),m("activeselection.fillcolor"),m("activeselection.opacity")}},{}],453:[function(y,ee,Q){"use strict";var g=y("../../dragelement/helpers").selectMode,v=y("../../shapes/handle_outline").clearOutline,m=y("../../shapes/draw_newshape/helpers"),x=m.readPaths,e=m.writePaths,n=m.fixDatesForPaths;ee.exports=function(t,a){if(t.length){var r=t[0][0];if(r){var d=r.getAttribute("d"),s=a.gd,i=s._fullLayout.newselection,u=a.plotinfo,f=u.xaxis,c=u.yaxis,h=a.isActiveSelection,p=a.dragmode,o=(s.layout||{}).selections||[];if(!g(p)&&void 0!==h){var b=s._fullLayout._activeSelectionIndex;if(b<o.length)switch(s._fullLayout.selections[b].type){case"rect":p="select";break;case"path":p="lasso"}}var l,T=x(d,s,u,h),_={xref:f._id,yref:c._id,opacity:i.opacity,line:{color:i.line.color,width:i.line.width,dash:i.line.dash}};1===T.length&&(l=T[0]),l&&5===l.length&&"select"===p?(_.type="rect",_.x0=l[0][1],_.y0=l[0][2],_.x1=l[2][1],_.y1=l[2][2]):(_.type="path",f&&c&&n(T,f,c),_.path=e(T),l=null),v(s);for(var w=a.editHelpers,k=(w||{}).modifyItem,L=[],M=0;M<o.length;M++){var I=s._fullLayout.selections[M];if(I){if(L[M]=I._input,void 0!==h&&M===s._fullLayout._activeSelectionIndex){var P=_;switch(I.type){case"rect":k("x0",P.x0),k("x1",P.x1),k("y0",P.y0),k("y1",P.y1);break;case"path":k("path",P.path)}}}else L[M]=I}return void 0===h?(L.push(_),L):w?w.getUpdateObj():{}}}}},{"../../dragelement/helpers":385,"../../shapes/draw_newshape/helpers":466,"../../shapes/handle_outline":468}],454:[function(y,ee,Q){"use strict";var g=y("../../lib").strTranslate;function v(m,x){switch(m.type){case"log":return m.p2d(x);case"date":return m.p2r(x,0,m.calendar);default:return m.p2r(x)}}ee.exports={p2r:v,r2p:function(m,x){switch(m.type){case"log":return m.d2p(x);case"date":return m.r2p(x,0,m.calendar);default:return m.r2p(x)}},axValue:function(m){var x="y"===m._id.charAt(0)?1:0;return function(e){return v(m,e[x])}},getTransform:function(m){return g(m.xaxis._offset,m.yaxis._offset)}}},{"../../lib":515}],455:[function(y,ee,Q){"use strict";var g=y("./draw"),v=y("./select");ee.exports={moduleType:"component",name:"selections",layoutAttributes:y("./attributes"),supplyLayoutDefaults:y("./defaults"),supplyDrawNewSelectionDefaults:y("./draw_newselection/defaults"),includeBasePlot:y("../../plots/cartesian/include_components")("selections"),draw:g.draw,drawOne:g.drawOne,reselect:v.reselect,prepSelect:v.prepSelect,clearOutline:v.clearOutline,clearSelectionsCache:v.clearSelectionsCache,selectOnClick:v.selectOnClick}},{"../../plots/cartesian/include_components":577,"./attributes":447,"./defaults":449,"./draw":450,"./draw_newselection/defaults":452,"./select":456}],456:[function(y,ee,Q){"use strict";var g=y("polybooljs"),v=y("point-in-polygon/nested"),m=y("../../registry"),x=y("../drawing").dashStyle,e=y("../color"),n=y("../fx"),t=y("../fx/helpers").makeEventData,a=y("../dragelement/helpers"),r=a.freeMode,d=a.rectMode,s=a.drawMode,i=a.openMode,u=a.selectMode,f=y("../shapes/helpers"),c=y("../shapes/constants"),h=y("../shapes/display_outlines"),p=y("../shapes/handle_outline").clearOutline,o=y("../shapes/draw_newshape/helpers"),b=o.handleEllipse,l=o.readPaths,T=y("../shapes/draw_newshape/newshapes"),_=y("./draw_newselection/newselections"),w=y("./draw").activateLastSelection,k=y("../../lib"),L=k.sorterAsc,M=y("../../lib/polygon"),I=y("../../lib/throttle"),P=y("../../plots/cartesian/axis_ids").getFromId,S=y("../../lib/clear_gl_canvases"),E=y("../../plot_api/subroutines").redrawReglTraces,z=y("./constants"),R=z.MINSELECT,q=M.filter,V=M.tester,W=y("./helpers"),K=W.p2r,G=W.axValue,Y=W.getTransform;function $(ze){return void 0!==ze.subplot}function B(ze,Me,Se,Ie,Fe,Re,Xe){var nt,ct,xt,dt,tt,Ke,mt,Bt,Ut,ye,er=Me._hoverdata,Wt=Me._fullLayout.clickmode.indexOf("event")>-1,rr=[];if((ye=er)&&Array.isArray(ye)&&!0!==ye[0].hoverOnBox){j(ze,Me,Re);var Ht=function(ye,Be){var Ge,Je,He=ye[0],st=-1,ot=[];for(Je=0;Je<Be.length;Je++)if(He.fullData._expandedIndex===(Ge=Be[Je]).cd[0].trace._expandedIndex){if(!0===He.hoverOnBox)break;void 0!==He.pointNumber?st=He.pointNumber:void 0!==He.binNumber&&(st=He.binNumber,ot=He.pointNumbers);break}return{pointNumber:st,pointNumbers:ot,searchInfo:Ge}}(er,nt=re(Me,Se,Ie,Fe));if(Ht.pointNumbers.length>0?function(ye,Be){var Ge,Je,He,st=[];for(He=0;He<ye.length;He++)(Ge=ye[He]).cd[0].trace.selectedpoints&&Ge.cd[0].trace.selectedpoints.length>0&&st.push(Ge);if(1===st.length&&st[0]===Be.searchInfo&&(Je=Be.searchInfo.cd[0].trace).selectedpoints.length===Be.pointNumbers.length){for(He=0;He<Be.pointNumbers.length;He++)if(Je.selectedpoints.indexOf(Be.pointNumbers[He])<0)return!1;return!0}return!1}(nt,Ht):function(ye){var Ge,Je,He=0;for(Je=0;Je<ye.length;Je++)if((Ge=ye[Je].cd[0].trace).selectedpoints&&(Ge.selectedpoints.length>1||(He+=Ge.selectedpoints.length)>1))return!1;return 1===He}(nt)&&(Ke=le(Ht))){for(Xe&&Xe.remove(),Ut=0;Ut<nt.length;Ut++)(ct=nt[Ut])._module.selectPoints(ct,!1);oe(Me,nt),J(Re),Wt&&De(Me)}else{for(mt=ze.shiftKey&&(void 0!==Ke?Ke:le(Ht)),xt=function(ye,Be,Ge){return{pointNumber:ye,searchInfo:Be,subtract:!!Ge}}(Ht.pointNumber,Ht.searchInfo,mt),dt=te(Re.selectionDefs.concat([xt])),Ut=0;Ut<nt.length;Ut++)if(tt=se(nt[Ut]._module.selectPoints(nt[Ut],dt),nt[Ut]),rr.length)for(var Ve=0;Ve<tt.length;Ve++)rr.push(tt[Ve]);else rr=tt;if(oe(Me,nt,Bt={points:rr}),xt&&Re&&Re.selectionDefs.push(xt),Xe){var We=Re.mergedPolygons,he=i(Re.dragmode);h(ge(We,he),Xe,Re)}Wt&&Ne(Me,Bt)}}}function N(ze){return"pointNumber"in ze&&"searchInfo"in ze}function U(ze){return{xmin:0,xmax:0,ymin:0,ymax:0,pts:[],contains:function(Me,Se,Ie,Fe){return Fe.cd[0].trace._expandedIndex===ze.searchInfo.cd[0].trace._expandedIndex&&Ie===ze.pointNumber},isRect:!1,degenerate:!1,subtract:!!ze.subtract}}function te(ze){if(ze.length){for(var Me=[],Se=N(ze[0])?0:ze[0][0][0],Ie=Se,Fe=N(ze[0])?0:ze[0][0][1],Re=Fe,Xe=0;Xe<ze.length;Xe++)if(N(ze[Xe]))Me.push(U(ze[Xe]));else{var nt=V(ze[Xe]);nt.subtract=!!ze[Xe].subtract,Me.push(nt),Se=Math.min(Se,nt.xmin),Ie=Math.max(Ie,nt.xmax),Fe=Math.min(Fe,nt.ymin),Re=Math.max(Re,nt.ymax)}return{xmin:Se,xmax:Ie,ymin:Fe,ymax:Re,pts:[],contains:function(ct,xt,dt,tt){for(var Ke=!1,mt=0;mt<Me.length;mt++)Me[mt].contains(ct,xt,dt,tt)&&(Ke=!Me[mt].subtract);return Ke},isRect:!1,degenerate:!1}}}function j(ze,Me,Se){var Ie=Me._fullLayout,Fe=Se.plotinfo,Re=Se.dragmode,Xe=Ie._lastSelectedSubplot&&Ie._lastSelectedSubplot===Fe.id,nt=(ze.shiftKey||ze.altKey)&&!(s(Re)&&i(Re));Xe&&nt&&Fe.selection&&Fe.selection.selectionDefs&&!Se.selectionDefs?(Se.selectionDefs=Fe.selection.selectionDefs,Se.mergedPolygons=Fe.selection.mergedPolygons):nt&&Fe.selection||J(Se),Xe||(p(Me),Ie._lastSelectedSubplot=Fe.id)}function J(ze,Me){var Se=ze.dragmode,Ie=ze.plotinfo,Fe=ze.gd;Fe._fullLayout._activeShapeIndex>=0&&Fe._fullLayout._deactivateShape(Fe),Fe._fullLayout._activeSelectionIndex>=0&&Fe._fullLayout._deactivateSelection(Fe);var Re=Fe._fullLayout._zoomlayer,Xe=s(Se),nt=u(Se);if(Xe||nt){var ct,xt,dt=Re.selectAll(".select-outline-"+Ie.id);dt&&Fe._fullLayout._outlining&&(Xe&&(ct=T(dt,ze)),ct&&m.call("_guiRelayout",Fe,{shapes:ct}),nt&&!$(ze)&&(xt=_(dt,ze)),xt&&m.call("_guiRelayout",Fe,{selections:xt}).then(function(){Me&&w(Fe)}),Fe._fullLayout._outlining=!1)}Ie.selection={},Ie.selection.selectionDefs=ze.selectionDefs=[],Ie.selection.mergedPolygons=ze.mergedPolygons=[]}function X(ze){return ze._id}function re(ze,Me,Se,Ie){if(!ze.calcdata)return[];var Fe,Re,Xe,nt=[],ct=Me.map(X),xt=Se.map(X);for(Xe=0;Xe<ze.calcdata.length;Xe++)if(!0===(Re=(Fe=ze.calcdata[Xe])[0].trace).visible&&Re._module&&Re._module.selectPoints)if(!$({subplot:Ie})||Re.subplot!==Ie&&Re.geo!==Ie)if("splom"===Re.type){if(Re._xaxes[ct[0]]&&Re._yaxes[xt[0]]){var dt=ne(Re._module,Fe,Me[0],Se[0]);dt.scene=ze._fullLayout._splomScenes[Re.uid],nt.push(dt)}}else if("sankey"===Re.type){var tt=ne(Re._module,Fe,Me[0],Se[0]);nt.push(tt)}else{if(-1===ct.indexOf(Re.xaxis)||-1===xt.indexOf(Re.yaxis))continue;nt.push(ne(Re._module,Fe,P(ze,Re.xaxis),P(ze,Re.yaxis)))}else nt.push(ne(Re._module,Fe,Me[0],Se[0]));return nt}function ne(ze,Me,Se,Ie){return{_module:ze,cd:Me,xaxis:Se,yaxis:Ie}}function le(ze){var Me=ze.searchInfo.cd[0].trace,Ie=ze.pointNumbers;return!!Me.selectedpoints&&Me.selectedpoints.indexOf(Ie.length>0?Ie[0]:ze.pointNumber)>-1}function oe(ze,Me,Se){var Ie,Fe;for(Ie=0;Ie<Me.length;Ie++){var Re=Me[Ie].cd[0].trace._fullInput,Xe=ze._fullLayout._tracePreGUI[Re.uid]||{};void 0===Xe.selectedpoints&&(Xe.selectedpoints=Re._input.selectedpoints||null)}if(Se){var nt=Se.points||[];for(Ie=0;Ie<Me.length;Ie++)(Fe=Me[Ie].cd[0].trace)._input.selectedpoints=Fe._fullInput.selectedpoints=[],Fe._fullInput!==Fe&&(Fe.selectedpoints=[]);for(var ct=0;ct<nt.length;ct++){var xt=nt[ct],dt=xt.data,tt=xt.fullData,Ke=xt.pointIndex,mt=xt.pointIndices;mt?([].push.apply(dt.selectedpoints,mt),Fe._fullInput!==Fe&&[].push.apply(tt.selectedpoints,mt)):(dt.selectedpoints.push(Ke),Fe._fullInput!==Fe&&tt.selectedpoints.push(Ke))}}else for(Ie=0;Ie<Me.length;Ie++)delete(Fe=Me[Ie].cd[0].trace).selectedpoints,delete Fe._input.selectedpoints,Fe._fullInput!==Fe&&delete Fe._fullInput.selectedpoints;!function(Bt,Ut){for(var er=!1,Wt=0;Wt<Ut.length;Wt++){var rr=Ut[Wt],Ht=rr.cd;m.traceIs(Ht[0].trace,"regl")&&(er=!0);var Ve=rr._module,We=Ve.styleOnSelect||Ve.style;We&&(We(Bt,Ht,Ht[0].node3),Ht[0].nodeRangePlot3&&We(Bt,Ht,Ht[0].nodeRangePlot3))}er&&(S(Bt),E(Bt))}(ze,Me)}function de(ze,Me,Se){for(var Ie=(Se?g.difference:g.union)({regions:ze},{regions:[Me]}).regions.reverse(),Fe=0;Fe<Ie.length;Fe++){var Re=Ie[Fe];Re.subtract=ve(Re,Ie.slice(0,Fe))}return Ie}function se(ze,Me){if(Array.isArray(ze))for(var Se=Me.cd,Ie=Me.cd[0].trace,Fe=0;Fe<ze.length;Fe++)ze[Fe]=t(ze[Fe],Ie,Se);return ze}function ge(ze,Me){for(var Se=[],Ie=0;Ie<ze.length;Ie++){Se[Ie]=[];for(var Fe=0;Fe<ze[Ie].length;Fe++){Se[Ie][Fe]=[],Se[Ie][Fe][0]=Fe?"L":"M";for(var Re=0;Re<ze[Ie][Fe].length;Re++)Se[Ie][Fe].push(ze[Ie][Fe][Re])}Me||Se[Ie].push(["Z",Se[Ie][0][1],Se[Ie][0][2]])}return Se}function _e(ze,Me){for(var Se,Ie,Fe=[],Re=[],Xe=0;Xe<Me.length;Xe++){var nt=Me[Xe];Ie=nt._module.selectPoints(nt,ze),Re.push(Ie),Se=se(Ie,nt),Fe=Fe.concat(Se)}return Fe}function Te(ze,Me,Se,Ie){var Fe,Re,Xe,nt=!!Se;Ie&&(Fe=Ie.plotinfo,Re=Ie.xaxes[0]._id,Xe=Ie.yaxes[0]._id);var ct=[],xt=[],dt=fe(ze),tt=ze._fullLayout;if(Fe){var Ke=tt._zoomlayer,mt=tt.dragmode,Bt=s(mt),Ut=u(mt);if(Bt||Ut){var er=P(ze,Re,"x"),Wt=P(ze,Xe,"y");if(er&&Wt){var rr=Ke.selectAll(".select-outline-"+Fe.id);if(rr&&ze._fullLayout._outlining&&rr.length){for(var Ht=rr[0][0].getAttribute("d"),Ve=l(Ht,ze,Fe),We=[],he=0;he<Ve.length;he++){for(var ye=Ve[he],Be=[],Ge=0;Ge<ye.length;Ge++)Be.push([Ae(er,ye[Ge][1]),Ae(Wt,ye[Ge][2])]);Be.xref=Re,Be.yref=Xe,Be.subtract=ve(Be,We),We.push(Be)}dt=dt.concat(We)}}}}var Je=Re&&Xe?[Re+Xe]:tt._subplots.cartesian;!function(Tr){var Fr=Tr.calcdata;if(Fr)for(var Nr=0;Nr<Fr.length;Nr++){var un=Tr._fullLayout._splomScenes;if(un){var $r=un[Fr[Nr][0].trace.uid];$r&&($r.selectBatch=[])}}}(ze);for(var He={},st=0;st<Je.length;st++){var ot=Je[st],wt=ot.indexOf("y"),Ct=ot.slice(0,wt),rt=ot.slice(wt),ft=Re&&Xe?Me:void 0;if(ft=Oe(dt,Ct,rt,ft)){var Rt=Se;if(!nt){var kt=P(ze,Ct,"x"),Lt=P(ze,rt,"y");Rt=re(ze,[kt],[Lt],ot);for(var Ee=0;Ee<Rt.length;Ee++){var Ye=Rt[Ee],it=Ye.cd[0],ht=it.trace;if("scattergl"===Ye._module.name&&!it.t.xpx){var At=ht.x,Ft=ht.y,Gt=ht._length;it.t.xpx=[],it.t.ypx=[];for(var jt=0;jt<Gt;jt++)it.t.xpx[jt]=kt.c2p(At[jt]),it.t.ypx[jt]=Lt.c2p(Ft[jt])}"splom"===Ye._module.name&&(He[ht.uid]||(He[ht.uid]=!0))}}var fr=_e(ft,Rt);ct=ct.concat(fr),xt=xt.concat(Rt)}}var kr={points:ct};oe(ze,xt,kr);var ur=tt.clickmode.indexOf("event")>-1;if(!Fe&&tt._reselect){if(ur){var Jt=fe(ze,!0),$t=Jt[0].xref,Qt=Jt[0].yref;if($t&&Qt){var cr=ke(Jt);Pe([P(ze,$t,"x"),P(ze,Qt,"y")])(kr,cr)}Ne(ze,kr)}tt._reselect=!1}if(!Fe&&tt._deselect){var gr=tt._deselect;(function(Tr,Fr,Nr){for(var Xr=0;Xr<Nr.length;Xr++){var un=Nr[Xr];if(un.xaxis&&un.xaxis._id===Tr&&un.yaxis&&un.yaxis._id===Fr)return!0}return!1})(Re=gr.xref,Xe=gr.yref,xt)||we(ze,Re,Xe,Se),ur&&(kr.points.length?Ne(ze,kr):ze.emit("plotly_deselect",null)),tt._deselect=!1}return{eventData:kr,selectionTesters:Me}}function we(ze,Me,Se,Ie){Ie=re(ze,[P(ze,Me,"x")],[P(ze,Se,"y")],Me+Se);for(var Fe=0;Fe<Ie.length;Fe++){var Re=Ie[Fe];Re._module.selectPoints(Re,!1)}oe(ze,Ie)}function Oe(ze,Me,Se,Ie){for(var Fe,Re=0;Re<ze.length;Re++){var Xe=ze[Re];Me===Xe.xref&&Se===Xe.yref&&(Fe?Ie=te(Fe=de(Fe,Xe,!!Xe.subtract)):(Fe=[Xe],Ie=V(Xe)))}return Ie}function fe(ze,Me){for(var Se=[],Ie=ze._fullLayout,Fe=Ie.selections,Re=Fe.length,Xe=0;Xe<Re;Xe++)if(!Me||Xe===Ie._activeSelectionIndex){var nt=Fe[Xe];if(nt){var ct,xt,dt,tt,Ke,mt=nt.xref,Bt=nt.yref,Ut=P(ze,mt,"x"),er=P(ze,Bt,"y");if("rect"===nt.type){Ke=[];var Wt=Ae(Ut,nt.x0),rr=Ae(Ut,nt.x1),Ht=Ae(er,nt.y0),Ve=Ae(er,nt.y1);Ke=[[Wt,Ht],[Wt,Ve],[rr,Ve],[rr,Ht]],ct=Math.min(Wt,rr),xt=Math.max(Wt,rr),dt=Math.min(Ht,Ve),tt=Math.max(Ht,Ve),Ke.xmin=ct,Ke.xmax=xt,Ke.ymin=dt,Ke.ymax=tt,Ke.xref=mt,Ke.yref=Bt,Ke.subtract=!1,Ke.isRect=!0,Se.push(Ke)}else if("path"===nt.type)for(var We=nt.path.split("Z"),he=[],ye=0;ye<We.length;ye++){var Be=We[ye];if(Be){var Ge=f.extractPathCoords(Be+="Z",c.paramIsX,"raw"),Je=f.extractPathCoords(Be,c.paramIsY,"raw");ct=1/0,xt=-1/0,dt=1/0,tt=-1/0,Ke=[];for(var He=0;He<Ge.length;He++){var st=Ae(Ut,Ge[He]),ot=Ae(er,Je[He]);Ke.push([st,ot]),ct=Math.min(st,ct),xt=Math.max(st,xt),dt=Math.min(ot,dt),tt=Math.max(ot,tt)}Ke.xmin=ct,Ke.xmax=xt,Ke.ymin=dt,Ke.ymax=tt,Ke.xref=mt,Ke.yref=Bt,Ke.subtract=ve(Ke,he),he.push(Ke),Se.push(Ke)}}}}return Se}function ve(ze,Me){for(var Se=!1,Ie=0;Ie<Me.length;Ie++)for(var Fe=Me[Ie],Re=0;Re<ze.length;Re++)if(v(ze[Re],Fe)){Se=!Se;break}return Se}function Ae(ze,Me){return"date"===ze.type&&(Me=Me.replace("_"," ")),"log"===ze.type?ze.c2p(Me):ze.r2p(Me,null,ze.calendar)}function ke(ze){for(var Me=ze.length,Se=[],Ie=0;Ie<Me;Ie++){var Fe=ze[Ie];Se=(Se=Se.concat(Fe)).concat([Fe[0]])}return(Re=Se).isRect=5===Re.length&&Re[0][0]===Re[4][0]&&Re[0][1]===Re[4][1]&&Re[0][0]===Re[1][0]&&Re[2][0]===Re[3][0]&&Re[0][1]===Re[3][1]&&Re[1][1]===Re[2][1]||Re[0][1]===Re[1][1]&&Re[2][1]===Re[3][1]&&Re[0][0]===Re[3][0]&&Re[1][0]===Re[2][0],Re.isRect&&(Re.xmin=Math.min(Re[0][0],Re[2][0]),Re.xmax=Math.max(Re[0][0],Re[2][0]),Re.ymin=Math.min(Re[0][1],Re[2][1]),Re.ymax=Math.max(Re[0][1],Re[2][1])),Re;var Re}function Pe(ze){return function(Me,Se){for(var Ie,Fe,Re=0;Re<ze.length;Re++){var Xe=ze[Re],nt=Xe._id,ct=nt.charAt(0);if(Se.isRect){Ie||(Ie={});var xt=Se[ct+"min"],dt=Se[ct+"max"];void 0!==xt&&void 0!==dt&&(Ie[nt]=[K(Xe,xt),K(Xe,dt)].sort(L))}else Fe||(Fe={}),Fe[nt]=Se.map(G(Xe))}Ie&&(Me.range=Ie),Fe&&(Me.lassoPoints=Fe)}}function Ne(ze,Me){Me&&(Me.selections=(ze.layout||{}).selections||[]),ze.emit("plotly_selected",Me)}function De(ze){ze.emit("plotly_deselect",null)}ee.exports={reselect:Te,prepSelect:function(ze,Me,Se,Ie,Fe){var Re=!$(Ie),Xe=r(Fe),nt=d(Fe),ct=i(Fe),xt=s(Fe),dt=u(Fe),tt="drawcircle"===Fe,Ke="drawline"===Fe||tt,mt=Ie.gd,Bt=mt._fullLayout,Ut=dt&&"immediate"===Bt.newselection.mode&&Re,er=Bt._zoomlayer,Wt=Ie.element.getBoundingClientRect(),rr=Ie.plotinfo,Ht=Y(rr),Ve=Me-Wt.left,We=Se-Wt.top;Bt._calcInverseTransform(mt);var ye,Be,Ge,Je,He,st,ot,he=k.apply3DTransform(Bt._invTransform)(Ve,We),wt=Bt._invScaleX,Ct=Bt._invScaleY,rt=Ve=he[0],ft=We=he[1],Rt="M"+Ve+","+We,kt=Ie.xaxes[0],Lt=Ie.yaxes[0],Ee=kt._length,Ye=Lt._length,it=ze.altKey&&!(s(Fe)&&ct);j(ze,mt,Ie),Xe&&(ye=q([[Ve,We]],z.BENDPX));var ht=er.selectAll("path.select-outline-"+rr.id).data([1]),At=xt?Bt.newshape:Bt.newselection;ht.enter().append("path").attr("class","select-outline select-outline-"+rr.id).style({opacity:xt?At.opacity/2:1,fill:xt&&!ct?At.fillcolor:"none",stroke:At.line.color||(Re?e.contrast(mt._fullLayout.plot_bgcolor):"#7f7f7f"),"stroke-dasharray":x(At.line.dash,At.line.width),"stroke-width":At.line.width+"px","shape-rendering":"crispEdges"}).attr("fill-rule","evenodd").classed("cursor-move",!!xt).attr("transform",Ht).attr("d",Rt+"Z");var Ft=er.append("path").attr("class","zoombox-corners").style({fill:e.background,stroke:e.defaultLine,"stroke-width":1}).attr("transform",Ht).attr("d","M0,0Z"),Gt=Bt._uid+z.SELECTID,jt=[],fr=re(mt,Ie.xaxes,Ie.yaxes,Ie.subplot);Ut&&!ze.shiftKey&&(Ie._clearSubplotSelections=function(){if(Re){var ur=kt._id,Jt=Lt._id;we(mt,ur,Jt,fr);for(var $t=(mt.layout||{}).selections||[],Qt=[],cr=!1,gr=0;gr<$t.length;gr++){var Tr=Bt.selections[gr];Tr.xref!==ur||Tr.yref!==Jt?Qt.push($t[gr]):cr=!0}cr&&m.call("_guiRelayout",mt,{selections:Qt})}});var ur,kr=(ur=Ie).plotinfo.fillRangeItems||Pe(ur.xaxes.concat(ur.yaxes));Ie.moveFn=function(ur,Jt){Ie._clearSubplotSelections&&(Ie._clearSubplotSelections(),Ie._clearSubplotSelections=void 0),rt=Math.max(0,Math.min(Ee,wt*ur+Ve)),ft=Math.max(0,Math.min(Ye,Ct*Jt+We));var $t=Math.abs(rt-Ve),Qt=Math.abs(ft-We);if(nt){var cr,gr,Tr;if(dt){var Fr=Bt.selectdirection;switch(cr="any"===Fr?Qt<Math.min(.6*$t,R)?"h":$t<Math.min(.6*Qt,R)?"v":"d":Fr){case"h":gr=tt?Ye/2:0,Tr=Ye;break;case"v":gr=tt?Ee/2:0,Tr=Ee}}if(xt)switch(Bt.newshape.drawdirection){case"vertical":cr="h",gr=tt?Ye/2:0,Tr=Ye;break;case"horizontal":cr="v",gr=tt?Ee/2:0,Tr=Ee;break;case"ortho":$t<Qt?(cr="h",gr=We,Tr=ft):(cr="v",gr=Ve,Tr=rt);break;default:cr="d"}"h"===cr?((Je=Ke?b(tt,[rt,gr],[rt,Tr]):[[Ve,gr],[Ve,Tr],[rt,Tr],[rt,gr]]).xmin=Ke?rt:Math.min(Ve,rt),Je.xmax=Ke?rt:Math.max(Ve,rt),Je.ymin=Math.min(gr,Tr),Je.ymax=Math.max(gr,Tr),Ft.attr("d","M"+Je.xmin+","+(We-R)+"h-4v"+2*R+"h4ZM"+(Je.xmax-1)+","+(We-R)+"h4v"+2*R+"h-4Z")):"v"===cr?((Je=Ke?b(tt,[gr,ft],[Tr,ft]):[[gr,We],[gr,ft],[Tr,ft],[Tr,We]]).xmin=Math.min(gr,Tr),Je.xmax=Math.max(gr,Tr),Je.ymin=Ke?ft:Math.min(We,ft),Je.ymax=Ke?ft:Math.max(We,ft),Ft.attr("d","M"+(Ve-R)+","+Je.ymin+"v-4h"+2*R+"v4ZM"+(Ve-R)+","+(Je.ymax-1)+"v4h"+2*R+"v-4Z")):"d"===cr&&((Je=Ke?b(tt,[Ve,We],[rt,ft]):[[Ve,We],[Ve,ft],[rt,ft],[rt,We]]).xmin=Math.min(Ve,rt),Je.xmax=Math.max(Ve,rt),Je.ymin=Math.min(We,ft),Je.ymax=Math.max(We,ft),Ft.attr("d","M0,0Z"))}else Xe&&(ye.addPt([rt,ft]),Je=ye.filtered);if(Ie.selectionDefs&&Ie.selectionDefs.length?(Ge=de(Ie.mergedPolygons,Je,it),Je.subtract=it,Be=te(Ie.selectionDefs.concat([Je]))):(Ge=[Je],Be=V(Je)),h(ge(Ge,ct),ht,Ie),dt){var Nr,Xr=Te(mt),un=Xr.eventData?Xr.eventData.points.slice():[];Xr=Te(mt,Be,fr,Ie),Be=Xr.selectionTesters,ot=Xr.eventData,Nr=ye?ye.filtered:ke(Ge),I.throttle(Gt,z.SELECTDELAY,function(){for(var $r=(jt=_e(Be,fr)).slice(),Pn=0;Pn<un.length;Pn++){for(var gn=un[Pn],dn=!1,An=0;An<$r.length;An++)if($r[An].curveNumber===gn.curveNumber&&$r[An].pointNumber===gn.pointNumber){dn=!0;break}dn||$r.push(gn)}$r.length&&(ot||(ot={}),ot.points=$r),kr(ot,Nr),mt.emit("plotly_selecting",ot)})}},Ie.clickFn=function(ur,Jt){if(Ft.remove(),mt._fullLayout._activeShapeIndex>=0)mt._fullLayout._deactivateShape(mt);else if(!xt){var $t=Bt.clickmode;I.done(Gt).then(function(){if(I.clear(Gt),2===ur){for(ht.remove(),He=0;He<fr.length;He++)(st=fr[He])._module.selectPoints(st,!1);if(oe(mt,fr),J(Ie),De(mt),fr.length){var Qt=fr[0].xaxis,cr=fr[0].yaxis;if(Qt&&cr){for(var gr=[],Tr=mt._fullLayout.selections,Fr=0;Fr<Tr.length;Fr++){var Nr=Tr[Fr];Nr&&(Nr.xref===Qt._id&&Nr.yref===cr._id||gr.push(Nr))}m.call("_guiRelayout",mt,{selections:gr})}}}else $t.indexOf("select")>-1&&B(Jt,mt,Ie.xaxes,Ie.yaxes,Ie.subplot,Ie,ht),"event"===$t&&Ne(mt,void 0);n.click(mt,Jt)}).catch(k.error)}},Ie.doneFn=function(){Ft.remove(),I.done(Gt).then(function(){I.clear(Gt),!Ut&&Je&&Ie.selectionDefs&&(Je.subtract=it,Ie.selectionDefs.push(Je),Ie.mergedPolygons.length=0,[].push.apply(Ie.mergedPolygons,Ge)),(Ut||xt)&&J(Ie,Ut),Ie.doneFnCompleted&&Ie.doneFnCompleted(jt),dt&&Ne(mt,ot)}).catch(k.error)}},clearOutline:p,clearSelectionsCache:J,selectOnClick:B}},{"../../lib":515,"../../lib/clear_gl_canvases":499,"../../lib/polygon":527,"../../lib/throttle":542,"../../plot_api/subroutines":556,"../../plots/cartesian/axis_ids":570,"../../registry":647,"../color":367,"../dragelement/helpers":385,"../drawing":389,"../fx":407,"../fx/helpers":403,"../shapes/constants":459,"../shapes/display_outlines":461,"../shapes/draw_newshape/helpers":466,"../shapes/draw_newshape/newshapes":467,"../shapes/handle_outline":468,"../shapes/helpers":469,"./constants":448,"./draw":450,"./draw_newselection/newselections":453,"./helpers":454,"point-in-polygon/nested":254,polybooljs:255}],457:[function(y,ee,Q){"use strict";var g=y("../annotations/attributes"),v=y("../../traces/scatter/attributes").line,m=y("../drawing/attributes").dash,x=y("../../lib/extend").extendFlat,e=y("../../plot_api/plot_template").templatedArray;y("../../constants/axis_placeable_objects"),ee.exports=e("shape",{visible:{valType:"boolean",dflt:!0,editType:"calc+arraydraw"},type:{valType:"enumerated",values:["circle","rect","path","line"],editType:"calc+arraydraw"},layer:{valType:"enumerated",values:["below","above"],dflt:"above",editType:"arraydraw"},xref:x({},g.xref,{}),xsizemode:{valType:"enumerated",values:["scaled","pixel"],dflt:"scaled",editType:"calc+arraydraw"},xanchor:{valType:"any",editType:"calc+arraydraw"},x0:{valType:"any",editType:"calc+arraydraw"},x1:{valType:"any",editType:"calc+arraydraw"},yref:x({},g.yref,{}),ysizemode:{valType:"enumerated",values:["scaled","pixel"],dflt:"scaled",editType:"calc+arraydraw"},yanchor:{valType:"any",editType:"calc+arraydraw"},y0:{valType:"any",editType:"calc+arraydraw"},y1:{valType:"any",editType:"calc+arraydraw"},path:{valType:"string",editType:"calc+arraydraw"},opacity:{valType:"number",min:0,max:1,dflt:1,editType:"arraydraw"},line:{color:x({},v.color,{editType:"arraydraw"}),width:x({},v.width,{editType:"calc+arraydraw"}),dash:x({},m,{editType:"arraydraw"}),editType:"calc+arraydraw"},fillcolor:{valType:"color",dflt:"rgba(0,0,0,0)",editType:"arraydraw"},fillrule:{valType:"enumerated",values:["evenodd","nonzero"],dflt:"evenodd",editType:"arraydraw"},editable:{valType:"boolean",dflt:!1,editType:"calc+arraydraw"},editType:"arraydraw"})},{"../../constants/axis_placeable_objects":484,"../../lib/extend":505,"../../plot_api/plot_template":555,"../../traces/scatter/attributes":936,"../annotations/attributes":350,"../drawing/attributes":388}],458:[function(y,ee,Q){"use strict";var g=y("../../lib"),v=y("../../plots/cartesian/axes"),m=y("./constants"),x=y("./helpers");function e(r){return t(r.line.width,r.xsizemode,r.x0,r.x1,r.path,!1)}function n(r){return t(r.line.width,r.ysizemode,r.y0,r.y1,r.path,!0)}function t(r,d,s,i,u,f){var c=r/2,h=f;if("pixel"===d){var p=u?x.extractPathCoords(u,f?m.paramIsY:m.paramIsX):[s,i],o=g.aggNums(Math.max,null,p),b=g.aggNums(Math.min,null,p),l=b<0?Math.abs(b)+c:c,T=o>0?o+c:c;return{ppad:c,ppadplus:h?l:T,ppadminus:h?T:l}}return{ppad:c}}function a(r,d,s,i,u){var f="category"===r.type||"multicategory"===r.type?r.r2c:r.d2c;if(void 0!==d)return[f(d),f(s)];if(i){var c,h,p,o,b=1/0,l=-1/0,T=i.match(m.segmentRE);for("date"===r.type&&(f=x.decodeDate(f)),c=0;c<T.length;c++)void 0!==(h=u[T[c].charAt(0)].drawn)&&(!(p=T[c].substr(1).match(m.paramRE))||p.length<h||((o=f(p[h]))<b&&(b=o),o>l&&(l=o)));return l>=b?[b,l]:void 0}}ee.exports=function(r){var s=g.filterVisible(r._fullLayout.shapes);if(s.length&&r._fullData.length)for(var i=0;i<s.length;i++){var u,f,c=s[i];c._extremes={};var h=v.getRefType(c.xref),p=v.getRefType(c.yref);if("paper"!==c.xref&&"domain"!==h){var o="pixel"===c.xsizemode?c.xanchor:c.x0,b="pixel"===c.xsizemode?c.xanchor:c.x1;(f=a(u=v.getFromId(r,c.xref),o,b,c.path,m.paramIsX))&&(c._extremes[u._id]=v.findExtremes(u,f,e(c)))}if("paper"!==c.yref&&"domain"!==p){var l="pixel"===c.ysizemode?c.yanchor:c.y0,T="pixel"===c.ysizemode?c.yanchor:c.y1;(f=a(u=v.getFromId(r,c.yref),l,T,c.path,m.paramIsY))&&(c._extremes[u._id]=v.findExtremes(u,f,n(c)))}}}},{"../../lib":515,"../../plots/cartesian/axes":566,"./constants":459,"./helpers":469}],459:[function(y,ee,Q){"use strict";ee.exports={segmentRE:/[MLHVQCTSZ][^MLHVQCTSZ]*/g,paramRE:/[^\s,]+/g,paramIsX:{M:{0:!0,drawn:0},L:{0:!0,drawn:0},H:{0:!0,drawn:0},V:{},Q:{0:!0,2:!0,drawn:2},C:{0:!0,2:!0,4:!0,drawn:4},T:{0:!0,drawn:0},S:{0:!0,2:!0,drawn:2},Z:{}},paramIsY:{M:{1:!0,drawn:1},L:{1:!0,drawn:1},H:{},V:{0:!0,drawn:0},Q:{1:!0,3:!0,drawn:3},C:{1:!0,3:!0,5:!0,drawn:5},T:{1:!0,drawn:1},S:{1:!0,3:!0,drawn:5},Z:{}},numParams:{M:2,L:2,H:1,V:1,Q:4,C:6,T:2,S:4,Z:0}}},{}],460:[function(y,ee,Q){"use strict";var g=y("../../lib"),v=y("../../plots/cartesian/axes"),m=y("../../plots/array_container_defaults"),x=y("./attributes"),e=y("./helpers");function n(t,a,r){function d(E,z){return g.coerce(t,a,x,E,z)}if(d("visible")){var s=d("path"),i="path"!==d("type",s?"path":"rect");i&&delete a.path,d("editable"),d("layer"),d("opacity"),d("fillcolor"),d("fillrule"),d("line.width")&&(d("line.color"),d("line.dash"));for(var u=d("xsizemode"),f=d("ysizemode"),c=["x","y"],h=0;h<2;h++){var p,o,b,l=c[h],T=l+"anchor",_="x"===l?u:f,w={_fullLayout:r},k=v.coerceRef(t,a,w,l,void 0,"paper");if("range"===v.getRefType(k)?((p=v.getFromId(w,k))._shapeIndices.push(a._index),b=e.rangeToShapePosition(p),o=e.shapePositionToRange(p)):o=b=g.identity,i){var L=l+"0",M=l+"1",I=t[L],P=t[M];t[L]=o(t[L],!0),t[M]=o(t[M],!0),"pixel"===_?(d(L,0),d(M,10)):(v.coercePosition(a,w,d,k,L,.25),v.coercePosition(a,w,d,k,M,.75)),a[L]=b(a[L]),a[M]=b(a[M]),t[L]=I,t[M]=P}if("pixel"===_){var S=t[T];t[T]=o(t[T],!0),v.coercePosition(a,w,d,k,T,.25),a[T]=b(a[T]),t[T]=S}}i&&g.noneOrAll(t,a,["x0","x1","y0","y1"])}}ee.exports=function(t,a){m(t,a,{name:"shapes",handleItemDefaults:n})}},{"../../lib":515,"../../plots/array_container_defaults":561,"../../plots/cartesian/axes":566,"./attributes":457,"./helpers":469}],461:[function(y,ee,Q){"use strict";var g=y("../../lib").strTranslate,v=y("../dragelement"),m=y("../dragelement/helpers"),x=m.drawMode,e=m.selectMode,n=y("../../registry"),t=y("../color"),a=y("./draw_newshape/constants"),r=a.i000,d=a.i090,s=a.i180,i=a.i270,u=y("./handle_outline").clearOutlineControllers,f=y("./draw_newshape/helpers"),c=f.pointsOnRectangle,h=f.pointsOnEllipse,p=f.writePaths,o=y("./draw_newshape/newshapes"),b=y("../selections/draw_newselection/newselections");function l(T,_){var w,k,L,P=T.length;return k=T[w=(_+1)%P][1],L=T[w][2],k===T[_][1]&&L===T[_][2]&&(k=T[w=(_+2)%P][1],L=T[w][2]),[w,k,L]}ee.exports=function T(_,w,k,L){L||(L=0);var M=k.gd;function I(){T(_,w,k,L++),h(_[0])&&P({redrawing:!0})}function P(X){var re={};void 0!==k.isActiveShape&&(k.isActiveShape=!1,re=o(w,k)),void 0!==k.isActiveSelection&&(k.isActiveSelection=!1,re=b(w,k),M._fullLayout._reselect=!0),Object.keys(re).length&&n.call((X||{}).redrawing?"relayout":"_guiRelayout",M,re)}var S,E,z,R,q,V=M._fullLayout._zoomlayer,W=k.dragmode,K=x(W),G=e(W);function Y(X){z=+X.srcElement.getAttribute("data-i"),R=+X.srcElement.getAttribute("data-j"),S[z][R].moveFn=$}function $(X,re){if(_.length){var ne=q[z][R][1],le=q[z][R][2],oe=_[z],de=oe.length;if(c(oe)){var se=X,ge=re;k.isActiveSelection&&(l(oe,R)[1]===oe[R][1]?ge=0:se=0);for(var _e=0;_e<de;_e++)if(_e!==R){var Te=oe[_e];Te[1]===oe[R][1]&&(Te[1]=ne+se),Te[2]===oe[R][2]&&(Te[2]=le+ge)}if(oe[R][1]=ne+se,oe[R][2]=le+ge,!c(oe))for(var we=0;we<de;we++)for(var Oe=0;Oe<oe[we].length;Oe++)oe[we][Oe]=q[z][we][Oe]}else oe[R][1]=ne+X,oe[R][2]=le+re;I()}}function B(){P()}function N(X,re){if(2===X){z=+re.srcElement.getAttribute("data-i"),R=+re.srcElement.getAttribute("data-j");var ne=_[z];c(ne)||h(ne)||function(){if(_.length&&_[z]&&_[z].length){for(var le=[],oe=0;oe<_[z].length;oe++)oe!==R&&le.push(_[z][oe]);le.length>1&&(2!==le.length||"Z"!==le[1][0])&&(0===R&&(le[0][0]="M"),_[z]=le,I(),P())}}()}}function U(X,re){(function(ne,le){if(_.length)for(var oe=0;oe<_.length;oe++)for(var de=0;de<_[oe].length;de++)for(var se=0;se+2<_[oe][de].length;se+=2)_[oe][de][se+1]=q[oe][de][se+1]+ne,_[oe][de][se+2]=q[oe][de][se+2]+le})(X,re),I()}(K||G)&&(M._fullLayout._outlining=!0),u(M),w.attr("d",p(_)),L||!k.isActiveShape&&!k.isActiveSelection||(q=function(X,re){for(var ne=0;ne<re.length;ne++){var le=re[ne];X[ne]=[];for(var oe=0;oe<le.length;oe++){X[ne][oe]=[];for(var de=0;de<le[oe].length;de++)X[ne][oe][de]=le[oe][de]}}return X}([],_),function(X){S=[];for(var re=0;re<_.length;re++){var ne=_[re],le=c(ne),oe=!le&&h(ne);S[re]=[];for(var de=ne.length,se=0;se<de;se++)if("Z"!==ne[se][0]&&(!oe||se===r||se===d||se===s||se===i)){var ge,_e=le&&k.isActiveSelection;_e&&(ge=l(ne,se));var Te=ne[se][1],we=ne[se][2],Oe=X.append(_e?"rect":"circle").attr("data-i",re).attr("data-j",se).style({fill:t.background,stroke:t.defaultLine,"stroke-width":1,"shape-rendering":"crispEdges"});if(_e){var fe=ge[1]-Te,ve=ge[2]-we,Ae=ve?5:Math.max(Math.min(25,Math.abs(fe)-5),5),ke=fe?5:Math.max(Math.min(25,Math.abs(ve)-5),5);Oe.classed(ve?"cursor-ew-resize":"cursor-ns-resize",!0).attr("width",Ae).attr("height",ke).attr("x",Te-Ae/2).attr("y",we-ke/2).attr("transform",g(fe/2,ve/2))}else Oe.classed("cursor-grab",!0).attr("r",5).attr("cx",Te).attr("cy",we);S[re][se]={element:Oe.node(),gd:M,prepFn:Y,doneFn:B,clickFn:N},v.init(S[re][se])}}}(V.append("g").attr("class","outline-controllers")),E=[],_.length&&(E[0]={element:w[0][0],gd:M,prepFn:function te(X){(z=+X.srcElement.getAttribute("data-i"))||(z=0),E[z].moveFn=U},doneFn:function j(){P()},clickFn:function J(X){2===X&&function(re){if(e(re._fullLayout.dragmode)){u(re);var ne=re._fullLayout._activeSelectionIndex,le=(re.layout||{}).selections||[];if(ne<le.length){for(var oe=[],de=0;de<le.length;de++)de!==ne&&oe.push(le[de]);delete re._fullLayout._activeSelectionIndex;var se=re._fullLayout.selections[ne];re._fullLayout._deselect={xref:se.xref,yref:se.yref},n.call("_guiRelayout",re,{selections:oe})}}}(M)}},v.init(E[0])))}},{"../../lib":515,"../../registry":647,"../color":367,"../dragelement":386,"../dragelement/helpers":385,"../selections/draw_newselection/newselections":453,"./draw_newshape/constants":464,"./draw_newshape/helpers":466,"./draw_newshape/newshapes":467,"./handle_outline":468}],462:[function(y,ee,Q){"use strict";var g=y("../../registry"),v=y("../../lib"),m=y("../../plots/cartesian/axes"),x=y("./draw_newshape/helpers").readPaths,e=y("./display_outlines"),n=y("./handle_outline").clearOutlineControllers,t=y("../color"),a=y("../drawing"),r=y("../../plot_api/plot_template").arrayEditor,d=y("../dragelement"),s=y("../../lib/setcursor"),i=y("./constants"),u=y("./helpers"),f=u.getPathString;function c(_){var w=_._fullLayout;for(var k in w._shapeUpperLayer.selectAll("path").remove(),w._shapeLowerLayer.selectAll("path").remove(),w._plots){var L=w._plots[k].shapelayer;L&&L.selectAll("path").remove()}for(var M=0;M<w.shapes.length;M++)w.shapes[M].visible&&o(_,M)}function h(_){return!!_._fullLayout._outlining}function p(_){return!_._context.edits.shapePosition}function o(_,w){_._fullLayout._paperdiv.selectAll('.shapelayer [data-index="'+w+'"]').remove();var k=u.makeShapesOptionsAndPlotinfo(_,w),L=k.options,M=k.plotinfo;L._input&&!1!==L.visible&&function I(P){var S=f(_,L),E={"data-index":w,"fill-rule":L.fillrule,d:S},z=L.opacity,R=L.fillcolor,q=L.line.width?L.line.color:"rgba(0,0,0,0)",V=L.line.width,W=L.line.dash;V||!0!==L.editable||(V=5,W="solid");var K="Z"!==S[S.length-1],G=p(_)&&L.editable&&_._fullLayout._activeShapeIndex===w;G&&(R=K?"rgba(0,0,0,0)":_._fullLayout.activeshape.fillcolor,z=_._fullLayout.activeshape.opacity);var Y,$=P.append("path").attr(E).style("opacity",z).call(t.stroke,q).call(t.fill,R).call(a.dashLine,W,V);if(b($,_,L),(G||_._context.edits.shapePosition)&&(Y=r(_.layout,"shapes",L)),G){$.style({cursor:"move"});var B={element:$.node(),plotinfo:M,gd:_,editHelpers:Y,isActiveShape:!0},N=x(S,_);e(N,$,B)}else _._context.edits.shapePosition?function(U,te,j,J,X,re){var ne,le,oe,de,se,ge,_e,Te,we,Oe,fe,ve,Ae,ke,Pe,Ne,De="pixel"===j.xsizemode,ze="pixel"===j.ysizemode,Me="line"===j.type,Se="path"===j.type,Ie=re.modifyItem,Fe=m.getFromId(U,j.xref),Re=m.getRefType(j.xref),Xe=m.getFromId(U,j.yref),nt=m.getRefType(j.yref),ct=u.getDataToPixel(U,Fe,!1,Re),xt=u.getDataToPixel(U,Xe,!0,nt),dt=u.getPixelToData(U,Fe,!1,Re),tt=u.getPixelToData(U,Xe,!0,nt),Ke=Me?function(){var Ht=Math.max(j.line.width,10),Ve=X.append("g").attr("data-index",J);Ve.append("path").attr("d",te.attr("d")).style({cursor:"move","stroke-width":Ht,"stroke-opacity":"0"});var We={"fill-opacity":"0"},he=Math.max(Ht/2,10);return Ve.append("circle").attr({"data-line-point":"start-point",cx:De?ct(j.xanchor)+j.x0:ct(j.x0),cy:ze?xt(j.yanchor)-j.y0:xt(j.y0),r:he}).style(We).classed("cursor-grab",!0),Ve.append("circle").attr({"data-line-point":"end-point",cx:De?ct(j.xanchor)+j.x1:ct(j.x1),cy:ze?xt(j.yanchor)-j.y1:xt(j.y1),r:he}).style(We).classed("cursor-grab",!0),Ve}():te,mt={element:Ke.node(),gd:U,prepFn:function(Ht){var Ve,We,he,ye,Be,Ge,Je,He;h(U)||(De&&(se=ct(j.xanchor)),ze&&(ge=xt(j.yanchor)),"path"===j.type?Pe=j.path:(ne=De?j.x0:ct(j.x0),le=ze?j.y0:xt(j.y0),oe=De?j.x1:ct(j.x1),de=ze?j.y1:xt(j.y1)),ne<oe?(we=ne,Ae="x0",Oe=oe,ke="x1"):(we=oe,Ae="x1",Oe=ne,ke="x0"),!ze&&le<de||ze&&le>de?(_e=le,fe="y0",Te=de,ve="y1"):(_e=de,fe="y1",Te=le,ve="y0"),Bt(Ht),Wt(X,j),Ve=te,Be=(We=j).yref,Ge=m.getFromId(he=U,ye=We.xref),Je=m.getFromId(he,Be),He="","paper"===ye||Ge.autorange||(He+=ye),"paper"===Be||Je.autorange||(He+=Be),a.setClipUrl(Ve,He?"clip"+he._fullLayout._uid+He:null,he),mt.moveFn="move"===Ne?Ut:er,mt.altKey=Ht.altKey)},doneFn:function(){h(U)||(s(te),rr(X),b(te,U,j),g.call("_guiRelayout",U,re.getUpdateObj()))},clickFn:function(){h(U)||rr(X)}};function Bt(Ht){if(h(U))Ne=null;else if(Me)Ne="path"===Ht.target.tagName?"move":"start-point"===Ht.target.attributes["data-line-point"].value?"resize-over-start-point":"resize-over-end-point";else{var Ve=mt.element.getBoundingClientRect(),We=Ve.right-Ve.left,he=Ve.bottom-Ve.top,Ge=!Se&&We>10&&he>10&&!Ht.shiftKey?d.getCursor((Ht.clientX-Ve.left)/We,1-(Ht.clientY-Ve.top)/he):"move";s(te,Ge),Ne=Ge.split("-")[0]}}function Ut(Ht,Ve){if("path"===j.type){var We=function(Be){return Be},he=We,ye=We;De?Ie("xanchor",j.xanchor=dt(se+Ht)):(he=function(Be){return dt(ct(Be)+Ht)},Fe&&"date"===Fe.type&&(he=u.encodeDate(he))),ze?Ie("yanchor",j.yanchor=tt(ge+Ve)):(ye=function(Be){return tt(xt(Be)+Ve)},Xe&&"date"===Xe.type&&(ye=u.encodeDate(ye))),Ie("path",j.path=l(Pe,he,ye))}else De?Ie("xanchor",j.xanchor=dt(se+Ht)):(Ie("x0",j.x0=dt(ne+Ht)),Ie("x1",j.x1=dt(oe+Ht))),ze?Ie("yanchor",j.yanchor=tt(ge+Ve)):(Ie("y0",j.y0=tt(le+Ve)),Ie("y1",j.y1=tt(de+Ve)));te.attr("d",f(U,j)),Wt(X,j)}function er(Ht,Ve){if(Se){var We=function(Ee){return Ee},he=We,ye=We;De?Ie("xanchor",j.xanchor=dt(se+Ht)):(he=function(Ee){return dt(ct(Ee)+Ht)},Fe&&"date"===Fe.type&&(he=u.encodeDate(he))),ze?Ie("yanchor",j.yanchor=tt(ge+Ve)):(ye=function(Ee){return tt(xt(Ee)+Ve)},Xe&&"date"===Xe.type&&(ye=u.encodeDate(ye))),Ie("path",j.path=l(Pe,he,ye))}else if(Me){if("resize-over-start-point"===Ne){var Be=ne+Ht,Ge=ze?le-Ve:le+Ve;Ie("x0",j.x0=De?Be:dt(Be)),Ie("y0",j.y0=ze?Ge:tt(Ge))}else if("resize-over-end-point"===Ne){var Je=oe+Ht,He=ze?de-Ve:de+Ve;Ie("x1",j.x1=De?Je:dt(Je)),Ie("y1",j.y1=ze?He:tt(He))}}else{var st=function(Ee){return-1!==Ne.indexOf(Ee)},ot=st("n"),wt=st("s"),Ct=st("w"),rt=st("e"),ft=ot?_e+Ve:_e,Rt=wt?Te+Ve:Te,kt=Ct?we+Ht:we,Lt=rt?Oe+Ht:Oe;ze&&(ot&&(ft=_e-Ve),wt&&(Rt=Te-Ve)),(!ze&&Rt-ft>10||ze&&ft-Rt>10)&&(Ie(fe,j[fe]=ze?ft:tt(ft)),Ie(ve,j[ve]=ze?Rt:tt(Rt))),Lt-kt>10&&(Ie(Ae,j[Ae]=De?kt:dt(kt)),Ie(ke,j[ke]=De?Lt:dt(Lt)))}te.attr("d",f(U,j)),Wt(X,j)}function Wt(Ht,Ve){(De||ze)&&function(){var We="path"!==Ve.type,he=Ht.selectAll(".visual-cue").data([0]);he.enter().append("path").attr({fill:"#fff","fill-rule":"evenodd",stroke:"#000","stroke-width":1}).classed("visual-cue",!0);var ye=ct(De?Ve.xanchor:v.midRange(We?[Ve.x0,Ve.x1]:u.extractPathCoords(Ve.path,i.paramIsX))),Be=xt(ze?Ve.yanchor:v.midRange(We?[Ve.y0,Ve.y1]:u.extractPathCoords(Ve.path,i.paramIsY)));ye=u.roundPositionForSharpStrokeRendering(ye,1),Be=u.roundPositionForSharpStrokeRendering(Be,1),he.attr("d",De&&ze?"M"+(ye-1-1)+","+(Be-1-1)+"h-8v2h8 v8h2v-8 h8v-2h-8 v-8h-2 Z":De?"M"+(ye-1-1)+","+(Be-9-1)+"v18 h2 v-18 Z":"M"+(ye-9-1)+","+(Be-1-1)+"h18 v2 h-18 Z")}()}function rr(Ht){Ht.selectAll(".visual-cue").remove()}d.init(mt),Ke.node().onmousemove=Bt}(_,$,L,w,P,Y):!0===L.editable&&$.style("pointer-events",K||t.opacity(R)*z<=.5?"stroke":"all");$.node().addEventListener("click",function(){return function(U,te){if(p(U)){var j=+te.node().getAttribute("data-index");if(j>=0){if(j===U._fullLayout._activeShapeIndex)return void T(U);U._fullLayout._activeShapeIndex=j,U._fullLayout._deactivateShape=T,c(U)}}}(_,$)})}("below"!==L.layer?_._fullLayout._shapeUpperLayer:"paper"===L.xref||"paper"===L.yref?_._fullLayout._shapeLowerLayer:M._hadPlotinfo?(M.mainplotinfo||M).shapelayer:_._fullLayout._shapeLowerLayer)}function b(_,w,k){var L=(k.xref+k.yref).replace(/paper/g,"").replace(/[xyz][1-9]* *domain/g,"");a.setClipUrl(_,L?"clip"+w._fullLayout._uid+L:null,w)}function l(_,w,k){return _.replace(i.segmentRE,function(L){var M=0,I=L.charAt(0),P=i.paramIsX[I],S=i.paramIsY[I],E=i.numParams[I];return I+L.substr(1).replace(i.paramRE,function(z){return M>=E||(P[M]?z=w(z):S[M]&&(z=k(z)),M++),z})})}function T(_){p(_)&&_._fullLayout._activeShapeIndex>=0&&(n(_),delete _._fullLayout._activeShapeIndex,c(_))}ee.exports={draw:c,drawOne:o,eraseActiveShape:function(_){if(p(_)){n(_);var w=_._fullLayout._activeShapeIndex,k=(_.layout||{}).shapes||[];if(w<k.length){for(var L=[],M=0;M<k.length;M++)M!==w&&L.push(k[M]);delete _._fullLayout._activeShapeIndex,g.call("_guiRelayout",_,{shapes:L})}}}}},{"../../lib":515,"../../lib/setcursor":536,"../../plot_api/plot_template":555,"../../plots/cartesian/axes":566,"../../registry":647,"../color":367,"../dragelement":386,"../drawing":389,"./constants":459,"./display_outlines":461,"./draw_newshape/helpers":466,"./handle_outline":468,"./helpers":469}],463:[function(y,ee,Q){"use strict";var g=y("../../drawing/attributes").dash,v=y("../../../lib/extend").extendFlat;ee.exports={newshape:{line:{color:{valType:"color",editType:"none"},width:{valType:"number",min:0,dflt:4,editType:"none"},dash:v({},g,{dflt:"solid",editType:"none"}),editType:"none"},fillcolor:{valType:"color",dflt:"rgba(0,0,0,0)",editType:"none"},fillrule:{valType:"enumerated",values:["evenodd","nonzero"],dflt:"evenodd",editType:"none"},opacity:{valType:"number",min:0,max:1,dflt:1,editType:"none"},layer:{valType:"enumerated",values:["below","above"],dflt:"above",editType:"none"},drawdirection:{valType:"enumerated",values:["ortho","horizontal","vertical","diagonal"],dflt:"diagonal",editType:"none"},editType:"none"},activeshape:{fillcolor:{valType:"color",dflt:"rgb(255,0,255)",editType:"none"},opacity:{valType:"number",min:0,max:1,dflt:.5,editType:"none"},editType:"none"}}},{"../../../lib/extend":505,"../../drawing/attributes":388}],464:[function(y,ee,Q){"use strict";ee.exports={CIRCLE_SIDES:32,i000:0,i090:8,i180:16,i270:24,cos45:Math.cos(Math.PI/4),sin45:Math.sin(Math.PI/4),SQRT2:Math.sqrt(2)}},{}],465:[function(y,ee,Q){"use strict";var g=y("../../color");ee.exports=function(v,m,x){x("newshape.drawdirection"),x("newshape.layer"),x("newshape.fillcolor"),x("newshape.fillrule"),x("newshape.opacity"),x("newshape.line.width")&&(x("newshape.line.color",g.contrast((v||{}).plot_bgcolor||"#FFF")),x("newshape.line.dash")),x("activeshape.fillcolor"),x("activeshape.opacity")}},{"../../color":367}],466:[function(y,ee,Q){"use strict";var g=y("parse-svg-path"),v=y("./constants"),m=v.CIRCLE_SIDES,x=v.SQRT2,e=y("../../selections/helpers"),n=e.p2r,t=e.r2p,a=[0,3,4,5,6,1,2],r=[0,3,4,1,2];function d(i,u){return Math.abs(i-u)<=1e-6}function s(i,u){var f=u[1]-i[1],c=u[2]-i[2];return Math.sqrt(f*f+c*c)}Q.writePaths=function(i){var u=i.length;if(!u)return"M0,0Z";for(var f="",c=0;c<u;c++)for(var h=i[c].length,p=0;p<h;p++){var o=i[c][p][0];if("Z"===o)f+="Z";else for(var b=i[c][p].length,l=0;l<b;l++){var T=l;"Q"===o||"S"===o?T=r[l]:"C"===o&&(T=a[l]),f+=i[c][p][T],l>0&&l<b-1&&(f+=",")}}return f},Q.readPaths=function(i,u,f,c){var h,p,o,b=g(i),l=[],T=-1,_=0,w=0,k=function(){p=_,o=w};k();for(var L=0;L<b.length;L++){var E=[],z=b[L][0],R=z;switch(z){case"M":l[++T]=[],E.push([R,_=+b[L][1],w=+b[L][2]]),k();break;case"Q":case"S":E.push([R,_=+b[L][3],w=+b[L][4],+b[L][1],+b[L][2]]);break;case"C":E.push([R,_=+b[L][5],w=+b[L][6],+b[L][1],+b[L][2],+b[L][3],+b[L][4]]);break;case"T":case"L":E.push([R,_=+b[L][1],w=+b[L][2]]);break;case"H":E.push([R="L",_=+b[L][1],w]);break;case"V":E.push([R="L",_,w=+b[L][1]]);break;case"A":R="L";var q=+b[L][1],V=+b[L][2];+b[L][4]||(q=-q,V=-V);var W=_-q,K=w;for(h=1;h<=m/2;h++){var G=2*Math.PI*h/m;E.push([R,W+q*Math.cos(G),K+V*Math.sin(G)])}break;case"Z":_===p&&w===o||E.push([R,_=p,w=o])}for(var Y=(f||{}).domain,$=u._fullLayout._size,B=f&&"pixel"===f.xsizemode,N=f&&"pixel"===f.ysizemode,U=!1===c,te=0;te<E.length;te++){for(h=0;h+2<7;h+=2){var j=E[te][h+1],J=E[te][h+2];void 0!==j&&void 0!==J&&(_=j,w=J,f&&(f.xaxis&&f.xaxis.p2r?(U&&(j-=f.xaxis._offset),j=B?t(f.xaxis,f.xanchor)+j:n(f.xaxis,j)):(U&&(j-=$.l),Y?j=Y.x[0]+j/$.w:j/=$.w),f.yaxis&&f.yaxis.p2r?(U&&(J-=f.yaxis._offset),J=N?t(f.yaxis,f.yanchor)-J:n(f.yaxis,J)):(U&&(J-=$.t),J=Y?Y.y[1]-J/$.h:1-J/$.h)),E[te][h+1]=j,E[te][h+2]=J)}l[T].push(E[te].slice())}}return l},Q.pointsOnRectangle=function(i){if(5!==i.length)return!1;for(var u=1;u<3;u++)if(!d(i[0][u]-i[1][u],i[3][u]-i[2][u])||!d(i[0][u]-i[3][u],i[1][u]-i[2][u]))return!1;return!(!d(i[0][1],i[1][1])&&!d(i[0][1],i[3][1])||!(s(i[0],i[1])*s(i[0],i[3])))},Q.pointsOnEllipse=function(i){var u=i.length;if(u!==m+1)return!1;u=m;for(var f=0;f<u;f++){var c=(2*u-f)%u,h=(u/2+c)%u;if(!d(s(i[f],i[(u/2+f)%u]),s(i[c],i[h])))return!1}return!0},Q.handleEllipse=function(i,u,f){if(!i)return[u,f];var c=Q.ellipseOver({x0:u[0],y0:u[1],x1:f[0],y1:f[1]}),h=(c.x1+c.x0)/2,p=(c.y1+c.y0)/2,o=(c.x1-c.x0)/2,b=(c.y1-c.y0)/2;o||(o=b/=x),b||(b=o/=x);for(var l=[],T=0;T<m;T++){var _=2*T*Math.PI/m;l.push([h+o*Math.cos(_),p+b*Math.sin(_)])}return l},Q.ellipseOver=function(i){var u=i.x0,f=i.y0,c=i.x1,h=i.y1,p=c-u,o=h-f,b=((u-=p)+c)/2,l=((f-=o)+h)/2;return{x0:b-(p*=x),y0:l-(o*=x),x1:b+p,y1:l+o}},Q.fixDatesForPaths=function(i,u,f){var c="date"===u.type,h="date"===f.type;if(!c&&!h)return i;for(var p=0;p<i.length;p++)for(var o=0;o<i[p].length;o++)for(var b=0;b+2<i[p][o].length;b+=2)c&&(i[p][o][b+1]=i[p][o][b+1].replace(" ","_")),h&&(i[p][o][b+2]=i[p][o][b+2].replace(" ","_"));return i}},{"../../selections/helpers":454,"./constants":464,"parse-svg-path":250}],467:[function(y,ee,Q){"use strict";var g=y("../../dragelement/helpers"),v=g.drawMode,m=g.openMode,x=y("./constants"),e=x.i000,n=x.i090,t=x.i180,a=x.i270,r=x.cos45,d=x.sin45,s=y("../../selections/helpers"),i=s.p2r,u=s.r2p,f=y(".././handle_outline").clearOutline,c=y("./helpers"),h=c.readPaths,p=c.writePaths,o=c.ellipseOver,b=c.fixDatesForPaths;ee.exports=function(l,T){if(l.length){var _=l[0][0];if(_){var w=_.getAttribute("d"),k=T.gd,L=k._fullLayout.newshape,M=T.plotinfo,I=M.xaxis,P=M.yaxis,S=!!M.domain||!M.xaxis,E=!!M.domain||!M.yaxis,z=T.isActiveShape,R=T.dragmode,q=(k.layout||{}).shapes||[];if(!v(R)&&void 0!==z){var V=k._fullLayout._activeShapeIndex;if(V<q.length)switch(k._fullLayout.shapes[V].type){case"rect":R="drawrect";break;case"circle":R="drawcircle";break;case"line":R="drawline";break;case"path":var W=q[V].path||"";R="Z"===W[W.length-1]?"drawclosedpath":"drawopenpath"}}var K,G=m(R),Y=h(w,k,M,z),$={editable:!0,xref:S?"paper":I._id,yref:E?"paper":P._id,layer:L.layer,opacity:L.opacity,line:{color:L.line.color,width:L.line.width,dash:L.line.dash}};if(G||($.fillcolor=L.fillcolor,$.fillrule=L.fillrule),1===Y.length&&(K=Y[0]),K&&5===K.length&&"drawrect"===R)$.type="rect",$.x0=K[0][1],$.y0=K[0][2],$.x1=K[2][1],$.y1=K[2][2];else if(K&&"drawline"===R)$.type="line",$.x0=K[0][1],$.y0=K[0][2],$.x1=K[1][1],$.y1=K[1][2];else if(K&&"drawcircle"===R){$.type="circle";var B=K[e][1],N=K[n][1],U=K[t][1],te=K[a][1],j=K[e][2],J=K[n][2],X=K[t][2],re=K[a][2],ne=M.xaxis&&("date"===M.xaxis.type||"log"===M.xaxis.type),le=M.yaxis&&("date"===M.yaxis.type||"log"===M.yaxis.type);ne&&(B=u(M.xaxis,B),N=u(M.xaxis,N),U=u(M.xaxis,U),te=u(M.xaxis,te)),le&&(j=u(M.yaxis,j),J=u(M.yaxis,J),X=u(M.yaxis,X),re=u(M.yaxis,re));var oe=(N+te)/2,de=(j+X)/2,se=o({x0:oe,y0:de,x1:oe+(te-N+U-B)/2*r,y1:de+(re-J+X-j)/2*d});ne&&(se.x0=i(M.xaxis,se.x0),se.x1=i(M.xaxis,se.x1)),le&&(se.y0=i(M.yaxis,se.y0),se.y1=i(M.yaxis,se.y1)),$.x0=se.x0,$.y0=se.y0,$.x1=se.x1,$.y1=se.y1}else $.type="path",I&&P&&b(Y,I,P),$.path=p(Y),K=null;f(k);for(var ge=T.editHelpers,_e=(ge||{}).modifyItem,Te=[],we=0;we<q.length;we++){var Oe=k._fullLayout.shapes[we];if(Te[we]=Oe._input,void 0!==z&&we===k._fullLayout._activeShapeIndex){var fe=$;switch(Oe.type){case"line":case"rect":case"circle":_e("x0",fe.x0),_e("x1",fe.x1),_e("y0",fe.y0),_e("y1",fe.y1);break;case"path":_e("path",fe.path)}}}return void 0===z?(Te.push($),Te):ge?ge.getUpdateObj():{}}}}},{"../../dragelement/helpers":385,"../../selections/helpers":454,".././handle_outline":468,"./constants":464,"./helpers":466}],468:[function(y,ee,Q){"use strict";ee.exports={clearOutlineControllers:function(g){var v=g._fullLayout._zoomlayer;v&&v.selectAll(".outline-controllers").remove()},clearOutline:function(g){var v=g._fullLayout._zoomlayer;v&&v.selectAll(".select-outline").remove(),g._fullLayout._outlining=!1}}},{}],469:[function(y,ee,Q){"use strict";var g=y("./constants"),v=y("../../lib"),m=y("../../plots/cartesian/axes");Q.rangeToShapePosition=function(x){return"log"===x.type?x.r2d:function(e){return e}},Q.shapePositionToRange=function(x){return"log"===x.type?x.d2r:function(e){return e}},Q.decodeDate=function(x){return function(e){return e.replace&&(e=e.replace("_"," ")),x(e)}},Q.encodeDate=function(x){return function(e){return x(e).replace(" ","_")}},Q.extractPathCoords=function(x,e,n){var t=[];return x.match(g.segmentRE).forEach(function(a){var r=e[a.charAt(0)].drawn;if(void 0!==r){var d=a.substr(1).match(g.paramRE);if(d&&!(d.length<r)){var s=d[r],i=n?s:v.cleanNumber(s);t.push(i)}}}),t},Q.getDataToPixel=function(x,e,n,t){var a,r=x._fullLayout._size;if(e)if("domain"===t)a=function(s){return e._length*(n?1-s:s)+e._offset};else{var d=Q.shapePositionToRange(e);a=function(s){return e._offset+e.r2p(d(s,!0))},"date"===e.type&&(a=Q.decodeDate(a))}else a=n?function(s){return r.t+r.h*(1-s)}:function(s){return r.l+r.w*s};return a},Q.getPixelToData=function(x,e,n,t){var a,r=x._fullLayout._size;if(e)if("domain"===t)a=function(s){var i=(s-e._offset)/e._length;return n?1-i:i};else{var d=Q.rangeToShapePosition(e);a=function(s){return d(e.p2r(s-e._offset))}}else a=n?function(s){return 1-(s-r.t)/r.h}:function(s){return(s-r.l)/r.w};return a},Q.roundPositionForSharpStrokeRendering=function(x,e){var n=1===Math.round(e%2),t=Math.round(x);return n?t+.5:t},Q.makeShapesOptionsAndPlotinfo=function(x,e){var n=x._fullLayout.shapes[e]||{},t=x._fullLayout._plots[n.xref+n.yref];return t?t._hadPlotinfo=!0:(t={},n.xref&&"paper"!==n.xref&&(t.xaxis=x._fullLayout[n.xref+"axis"]),n.yref&&"paper"!==n.yref&&(t.yaxis=x._fullLayout[n.yref+"axis"])),t.xsizemode=n.xsizemode,t.ysizemode=n.ysizemode,t.xanchor=n.xanchor,t.yanchor=n.yanchor,{options:n,plotinfo:t}},Q.makeSelectionsOptionsAndPlotinfo=function(x,e){var n=x._fullLayout.selections[e]||{},t=x._fullLayout._plots[n.xref+n.yref];return t?t._hadPlotinfo=!0:(t={},n.xref&&(t.xaxis=x._fullLayout[n.xref+"axis"]),n.yref&&(t.yaxis=x._fullLayout[n.yref+"axis"])),{options:n,plotinfo:t}},Q.getPathString=function(x,e){var n,t,a,r,d,s,i,u,P,S,E,R,q,V,W,f=e.type,c=m.getRefType(e.xref),h=m.getRefType(e.yref),p=m.getFromId(x,e.xref),o=m.getFromId(x,e.yref),b=x._fullLayout._size;if(p?"domain"===c?t=function(P){return p._offset+p._length*P}:(n=Q.shapePositionToRange(p),t=function(P){return p._offset+p.r2p(n(P,!0))}):t=function(P){return b.l+b.w*P},o?"domain"===h?r=function(P){return o._offset+o._length*(1-P)}:(a=Q.shapePositionToRange(o),r=function(P){return o._offset+o.r2p(a(P,!0))}):r=function(P){return b.t+b.h*(1-P)},"path"===f)return p&&"date"===p.type&&(t=Q.decodeDate(t)),o&&"date"===o.type&&(r=Q.decodeDate(r)),S=t,E=r,R=(P=e).xsizemode,q=P.ysizemode,V=P.xanchor,W=P.yanchor,P.path.replace(g.segmentRE,function(K){var G=0,Y=K.charAt(0),$=g.paramIsX[Y],B=g.paramIsY[Y],N=g.numParams[Y],U=K.substr(1).replace(g.paramRE,function(te){return $[G]?te="pixel"===R?S(V)+Number(te):S(te):B[G]&&(te="pixel"===q?E(W)-Number(te):E(te)),++G>N&&(te="X"),te});return G>N&&(U=U.replace(/[\s,]*X.*/,""),v.log("Ignoring extra params in segment "+K)),Y+U});if("pixel"===e.xsizemode){var l=t(e.xanchor);d=l+e.x0,s=l+e.x1}else d=t(e.x0),s=t(e.x1);if("pixel"===e.ysizemode){var T=r(e.yanchor);i=T-e.y0,u=T-e.y1}else i=r(e.y0),u=r(e.y1);if("line"===f)return"M"+d+","+i+"L"+s+","+u;if("rect"===f)return"M"+d+","+i+"H"+s+"V"+u+"H"+d+"Z";var _=(d+s)/2,w=(i+u)/2,k=Math.abs(_-d),L=Math.abs(w-i),M="A"+k+","+L,I=_+k+","+w;return"M"+I+M+" 0 1,1 "+_+","+(w-L)+M+" 0 0,1 "+I+"Z"}},{"../../lib":515,"../../plots/cartesian/axes":566,"./constants":459}],470:[function(y,ee,Q){"use strict";var g=y("./draw");ee.exports={moduleType:"component",name:"shapes",layoutAttributes:y("./attributes"),supplyLayoutDefaults:y("./defaults"),supplyDrawNewShapeDefaults:y("./draw_newshape/defaults"),includeBasePlot:y("../../plots/cartesian/include_components")("shapes"),calcAutorange:y("./calc_autorange"),draw:g.draw,drawOne:g.drawOne}},{"../../plots/cartesian/include_components":577,"./attributes":457,"./calc_autorange":458,"./defaults":460,"./draw":462,"./draw_newshape/defaults":465}],471:[function(y,ee,Q){"use strict";var g=y("../../plots/font_attributes"),v=y("../../plots/pad_attributes"),m=y("../../lib/extend").extendDeepAll,x=y("../../plot_api/edit_types").overrideAll,e=y("../../plots/animation_attributes"),n=y("../../plot_api/plot_template").templatedArray,t=y("./constants"),a=n("step",{visible:{valType:"boolean",dflt:!0},method:{valType:"enumerated",values:["restyle","relayout","animate","update","skip"],dflt:"restyle"},args:{valType:"info_array",freeLength:!0,items:[{valType:"any"},{valType:"any"},{valType:"any"}]},label:{valType:"string"},value:{valType:"string"},execute:{valType:"boolean",dflt:!0}});ee.exports=x(n("slider",{visible:{valType:"boolean",dflt:!0},active:{valType:"number",min:0,dflt:0},steps:a,lenmode:{valType:"enumerated",values:["fraction","pixels"],dflt:"fraction"},len:{valType:"number",min:0,dflt:1},x:{valType:"number",min:-2,max:3,dflt:0},pad:m(v({editType:"arraydraw"}),{},{t:{dflt:20}}),xanchor:{valType:"enumerated",values:["auto","left","center","right"],dflt:"left"},y:{valType:"number",min:-2,max:3,dflt:0},yanchor:{valType:"enumerated",values:["auto","top","middle","bottom"],dflt:"top"},transition:{duration:{valType:"number",min:0,dflt:150},easing:{valType:"enumerated",values:e.transition.easing.values,dflt:"cubic-in-out"}},currentvalue:{visible:{valType:"boolean",dflt:!0},xanchor:{valType:"enumerated",values:["left","center","right"],dflt:"left"},offset:{valType:"number",dflt:10},prefix:{valType:"string"},suffix:{valType:"string"},font:g({})},font:g({}),activebgcolor:{valType:"color",dflt:t.gripBgActiveColor},bgcolor:{valType:"color",dflt:t.railBgColor},bordercolor:{valType:"color",dflt:t.railBorderColor},borderwidth:{valType:"number",min:0,dflt:t.railBorderWidth},ticklen:{valType:"number",min:0,dflt:t.tickLength},tickcolor:{valType:"color",dflt:t.tickColor},tickwidth:{valType:"number",min:0,dflt:1},minorticklen:{valType:"number",min:0,dflt:t.minorTickLength}}),"arraydraw","from-root")},{"../../lib/extend":505,"../../plot_api/edit_types":548,"../../plot_api/plot_template":555,"../../plots/animation_attributes":560,"../../plots/font_attributes":594,"../../plots/pad_attributes":627,"./constants":472}],472:[function(y,ee,Q){"use strict";ee.exports={name:"sliders",containerClassName:"slider-container",groupClassName:"slider-group",inputAreaClass:"slider-input-area",railRectClass:"slider-rail-rect",railTouchRectClass:"slider-rail-touch-rect",gripRectClass:"slider-grip-rect",tickRectClass:"slider-tick-rect",inputProxyClass:"slider-input-proxy",labelsClass:"slider-labels",labelGroupClass:"slider-label-group",labelClass:"slider-label",currentValueClass:"slider-current-value",railHeight:5,menuIndexAttrName:"slider-active-index",autoMarginIdRoot:"slider-",minWidth:30,minHeight:30,textPadX:40,arrowOffsetX:4,railRadius:2,railWidth:5,railBorder:4,railBorderWidth:1,railBorderColor:"#bec8d9",railBgColor:"#f8fafc",railInset:8,stepInset:10,gripRadius:10,gripWidth:20,gripHeight:20,gripBorder:20,gripBorderWidth:1,gripBorderColor:"#bec8d9",gripBgColor:"#f6f8fa",gripBgActiveColor:"#dbdde0",labelPadding:8,labelOffset:0,tickWidth:1,tickColor:"#333",tickOffset:25,tickLength:7,minorTickOffset:25,minorTickColor:"#333",minorTickLength:4,currentValuePadding:8,currentValueInset:0}},{}],473:[function(y,ee,Q){"use strict";var g=y("../../lib"),v=y("../../plots/array_container_defaults"),m=y("./attributes"),x=y("./constants").name,e=m.steps;function n(a,r,d){function s(h,p){return g.coerce(a,r,m,h,p)}for(var i=v(a,r,{name:"steps",handleItemDefaults:t}),u=0,f=0;f<i.length;f++)i[f].visible&&u++;if(u<2?r.visible=!1:s("visible")){r._stepCount=u;var c=r._visibleSteps=g.filterVisible(i);(i[s("active")]||{}).visible||(r.active=c[0]._index),s("x"),s("y"),g.noneOrAll(a,r,["x","y"]),s("xanchor"),s("yanchor"),s("len"),s("lenmode"),s("pad.t"),s("pad.r"),s("pad.b"),s("pad.l"),g.coerceFont(s,"font",d.font),s("currentvalue.visible")&&(s("currentvalue.xanchor"),s("currentvalue.prefix"),s("currentvalue.suffix"),s("currentvalue.offset"),g.coerceFont(s,"currentvalue.font",r.font)),s("transition.duration"),s("transition.easing"),s("bgcolor"),s("activebgcolor"),s("bordercolor"),s("borderwidth"),s("ticklen"),s("tickwidth"),s("tickcolor"),s("minorticklen")}}function t(a,r){function d(i,u){return g.coerce(a,r,e,i,u)}if("skip"===a.method||Array.isArray(a.args)?d("visible"):r.visible=!1){d("method"),d("args");var s=d("label","step-"+r._index);d("value",s),d("execute")}}ee.exports=function(a,r){v(a,r,{name:x,handleItemDefaults:n})}},{"../../lib":515,"../../plots/array_container_defaults":561,"./attributes":471,"./constants":472}],474:[function(y,ee,Q){"use strict";var g=y("@plotly/d3"),v=y("../../plots/plots"),m=y("../color"),x=y("../drawing"),e=y("../../lib"),n=e.strTranslate,t=y("../../lib/svg_text_utils"),a=y("../../plot_api/plot_template").arrayEditor,r=y("./constants"),d=y("../../constants/alignment"),s=d.LINE_SPACING,i=d.FROM_TL,u=d.FROM_BR;function f(E){return r.autoMarginIdRoot+E._index}function c(E){return E._index}function h(E,z){var R=x.tester.selectAll("g."+r.labelGroupClass).data(z._visibleSteps);R.enter().append("g").classed(r.labelGroupClass,!0);var q=0,V=0;R.each(function(te){var j=b(g.select(this),{step:te},z).node();if(j){var J=x.bBox(j);V=Math.max(V,J.height),q=Math.max(q,J.width)}}),R.remove();var W=z._dims={};W.inputAreaWidth=Math.max(r.railWidth,r.gripHeight);var K=E._fullLayout._size;if(W.lx=K.l+K.w*z.x,W.ly=K.t+K.h*(1-z.y),W.outerLength="fraction"===z.lenmode?Math.round(K.w*z.len):z.len,W.inputAreaStart=0,W.inputAreaLength=Math.round(W.outerLength-z.pad.l-z.pad.r),W.labelStride=Math.max(1,Math.ceil((q+r.labelPadding)/((W.inputAreaLength-2*r.stepInset)/(z._stepCount-1)))),W.labelHeight=V,W.currentValueMaxWidth=0,W.currentValueHeight=0,W.currentValueTotalHeight=0,W.currentValueMaxLines=1,z.currentvalue.visible){var $=x.tester.append("g");R.each(function(te){var j=p($,z,te.label),J=j.node()&&x.bBox(j.node())||{width:0,height:0},X=t.lineCount(j);W.currentValueMaxWidth=Math.max(W.currentValueMaxWidth,Math.ceil(J.width)),W.currentValueHeight=Math.max(W.currentValueHeight,Math.ceil(J.height)),W.currentValueMaxLines=Math.max(W.currentValueMaxLines,X)}),W.currentValueTotalHeight=W.currentValueHeight+z.currentvalue.offset,$.remove()}W.height=W.currentValueTotalHeight+r.tickOffset+z.ticklen+r.labelOffset+W.labelHeight+z.pad.t+z.pad.b;var B="left";e.isRightAnchor(z)&&(W.lx-=W.outerLength,B="right"),e.isCenterAnchor(z)&&(W.lx-=W.outerLength/2,B="center");var N="top";e.isBottomAnchor(z)&&(W.ly-=W.height,N="bottom"),e.isMiddleAnchor(z)&&(W.ly-=W.height/2,N="middle"),W.outerLength=Math.ceil(W.outerLength),W.height=Math.ceil(W.height),W.lx=Math.round(W.lx),W.ly=Math.round(W.ly);var U={y:z.y,b:W.height*u[N],t:W.height*i[N]};"fraction"===z.lenmode?(U.l=0,U.xl=z.x-z.len*i[B],U.r=0,U.xr=z.x+z.len*u[B]):(U.x=z.x,U.l=W.outerLength*i[B],U.r=W.outerLength*u[B]),v.autoMargin(E,f(z),U)}function p(E,z,R){if(z.currentvalue.visible){var q,V,W=z._dims;switch(z.currentvalue.xanchor){case"right":q=W.inputAreaLength-r.currentValueInset-W.currentValueMaxWidth,V="left";break;case"center":q=.5*W.inputAreaLength,V="middle";break;default:q=r.currentValueInset,V="left"}var K=e.ensureSingle(E,"text",r.labelClass,function(U){U.attr({"text-anchor":V,"data-notex":1})}),G=z.currentvalue.prefix?z.currentvalue.prefix:"";if("string"==typeof R)G+=R;else{var Y=z.steps[z.active].label,$=z._gd._fullLayout._meta;$&&(Y=e.templateString(Y,$)),G+=Y}z.currentvalue.suffix&&(G+=z.currentvalue.suffix),K.call(x.font,z.currentvalue.font).text(G).call(t.convertToTspans,z._gd);var B=t.lineCount(K);return t.positionText(K,q,(W.currentValueMaxLines+1-B)*z.currentvalue.font.size*s),K}}function o(E,z,R){e.ensureSingle(E,"rect",r.gripRectClass,function(q){q.call(w,z,E,R).style("pointer-events","all")}).attr({width:r.gripWidth,height:r.gripHeight,rx:r.gripRadius,ry:r.gripRadius}).call(m.stroke,R.bordercolor).call(m.fill,R.bgcolor).style("stroke-width",R.borderwidth+"px")}function b(E,z,R){var q=e.ensureSingle(E,"text",r.labelClass,function(K){K.attr({"text-anchor":"middle","data-notex":1})}),V=z.step.label,W=R._gd._fullLayout._meta;return W&&(V=e.templateString(V,W)),q.call(x.font,R.font).text(V).call(t.convertToTspans,R._gd),q}function l(E,z){var R=e.ensureSingle(E,"g",r.labelsClass),q=z._dims,V=R.selectAll("g."+r.labelGroupClass).data(q.labelSteps);V.enter().append("g").classed(r.labelGroupClass,!0),V.exit().remove(),V.each(function(W){var K=g.select(this);K.call(b,W,z),x.setTranslate(K,M(z,W.fraction),r.tickOffset+z.ticklen+z.font.size*s+r.labelOffset+q.currentValueTotalHeight)})}function T(E,z,R,q,V){var W=Math.round(q*(R._stepCount-1)),K=R._visibleSteps[W]._index;K!==R.active&&_(E,z,R,K,!0,V)}function _(E,z,R,q,V,W){var K=R.active;R.active=q,a(E.layout,r.name,R).applyUpdate("active",q);var G=R.steps[R.active];z.call(L,R,W),z.call(p,R),E.emit("plotly_sliderchange",{slider:R,step:R.steps[R.active],interaction:V,previousActive:K}),G&&G.method&&V&&(z._nextMethod?(z._nextMethod.step=G,z._nextMethod.doCallback=V,z._nextMethod.doTransition=W):(z._nextMethod={step:G,doCallback:V,doTransition:W},z._nextMethodRaf=window.requestAnimationFrame(function(){var Y=z._nextMethod.step;Y.method&&(Y.execute&&v.executeAPICommand(E,Y.method,Y.args),z._nextMethod=null,z._nextMethodRaf=null)})))}function w(E,z,R){var q=R.node(),V=g.select(z);function W(){return R.data()[0]}function K(){var G=W();z.emit("plotly_sliderstart",{slider:G});var Y=R.select("."+r.gripRectClass);g.event.stopPropagation(),g.event.preventDefault(),Y.call(m.fill,G.activebgcolor);var $=I(G,g.mouse(q)[0]);function B(){var U=W(),te=I(U,g.mouse(q)[0]);T(z,R,U,te,!1)}function N(){var U=W();U._dragging=!1,Y.call(m.fill,U.bgcolor),V.on("mouseup",null),V.on("mousemove",null),V.on("touchend",null),V.on("touchmove",null),z.emit("plotly_sliderend",{slider:U,step:U.steps[U.active]})}T(z,R,G,$,!0),G._dragging=!0,V.on("mousemove",B),V.on("touchmove",B),V.on("mouseup",N),V.on("touchend",N)}E.on("mousedown",K),E.on("touchstart",K)}function k(E,z){var R=E.selectAll("rect."+r.tickRectClass).data(z._visibleSteps),q=z._dims;R.enter().append("rect").classed(r.tickRectClass,!0),R.exit().remove(),R.attr({width:z.tickwidth+"px","shape-rendering":"crispEdges"}),R.each(function(V,W){var K=W%q.labelStride==0,G=g.select(this);G.attr({height:K?z.ticklen:z.minorticklen}).call(m.fill,z.tickcolor),x.setTranslate(G,M(z,W/(z._stepCount-1))-.5*z.tickwidth,(K?r.tickOffset:r.minorTickOffset)+q.currentValueTotalHeight)})}function L(E,z,R){for(var q=E.select("rect."+r.gripRectClass),V=0,W=0;W<z._stepCount;W++)if(z._visibleSteps[W]._index===z.active){V=W;break}var K=M(z,V/(z._stepCount-1));if(!z._invokingCommand){var G=q;R&&z.transition.duration>0&&(G=G.transition().duration(z.transition.duration).ease(z.transition.easing)),G.attr("transform",n(K-.5*r.gripWidth,z._dims.currentValueTotalHeight))}}function M(E,z){var R=E._dims;return R.inputAreaStart+r.stepInset+(R.inputAreaLength-2*r.stepInset)*Math.min(1,Math.max(0,z))}function I(E,z){var R=E._dims;return Math.min(1,Math.max(0,(z-r.stepInset-R.inputAreaStart)/(R.inputAreaLength-2*r.stepInset-2*R.inputAreaStart)))}function P(E,z,R){var q=R._dims,V=e.ensureSingle(E,"rect",r.railTouchRectClass,function(W){W.call(w,z,E,R).style("pointer-events","all")});V.attr({width:q.inputAreaLength,height:Math.max(q.inputAreaWidth,r.tickOffset+R.ticklen+q.labelHeight)}).call(m.fill,R.bgcolor).attr("opacity",0),x.setTranslate(V,0,q.currentValueTotalHeight)}function S(E,z){var R=z._dims,q=R.inputAreaLength-2*r.railInset,V=e.ensureSingle(E,"rect",r.railRectClass);V.attr({width:q,height:r.railWidth,rx:r.railRadius,ry:r.railRadius,"shape-rendering":"crispEdges"}).call(m.stroke,z.bordercolor).call(m.fill,z.bgcolor).style("stroke-width",z.borderwidth+"px"),x.setTranslate(V,r.railInset,.5*(R.inputAreaWidth-r.railWidth)+R.currentValueTotalHeight)}ee.exports=function(E){var z=E._fullLayout,R=function(Y,$){for(var B=Y[r.name],N=[],U=0;U<B.length;U++){var te=B[U];te.visible&&(te._gd=$,N.push(te))}return N}(z,E),q=z._infolayer.selectAll("g."+r.containerClassName).data(R.length>0?[0]:[]);function V(Y){Y._commandObserver&&(Y._commandObserver.remove(),delete Y._commandObserver),v.autoMargin(E,f(Y))}if(q.enter().append("g").classed(r.containerClassName,!0).style("cursor","ew-resize"),q.exit().each(function(){g.select(this).selectAll("g."+r.groupClassName).each(V)}).remove(),0!==R.length){var W=q.selectAll("g."+r.groupClassName).data(R,c);W.enter().append("g").classed(r.groupClassName,!0),W.exit().each(V).remove();for(var K=0;K<R.length;K++)h(E,R[K]);W.each(function(Y){var $=g.select(this);(function(B){var N=B._dims;N.labelSteps=[];for(var U=B._stepCount,te=0;te<U;te+=N.labelStride)N.labelSteps.push({fraction:te/(U-1),step:B._visibleSteps[te]})})(Y),v.manageCommandObserver(E,Y,Y._visibleSteps,function(B){var N=$.data()[0];N.active!==B.index&&(N._dragging||_(E,$,N,B.index,!1,!0))}),function(B,N,U){(U.steps[U.active]||{}).visible||(U.active=U._visibleSteps[0]._index),N.call(p,U).call(S,U).call(l,U).call(k,U).call(P,B,U).call(o,B,U);var te=U._dims;x.setTranslate(N,te.lx+U.pad.l,te.ly+U.pad.t),N.call(L,U,!1),N.call(p,U)}(E,g.select(this),Y)})}}},{"../../constants/alignment":483,"../../lib":515,"../../lib/svg_text_utils":541,"../../plot_api/plot_template":555,"../../plots/plots":628,"../color":367,"../drawing":389,"./constants":472,"@plotly/d3":58}],475:[function(y,ee,Q){"use strict";var g=y("./constants");ee.exports={moduleType:"component",name:g.name,layoutAttributes:y("./attributes"),supplyLayoutDefaults:y("./defaults"),draw:y("./draw")}},{"./attributes":471,"./constants":472,"./defaults":473,"./draw":474}],476:[function(y,ee,Q){"use strict";var g=y("@plotly/d3"),v=y("fast-isnumeric"),m=y("../../plots/plots"),x=y("../../registry"),e=y("../../lib"),n=e.strTranslate,t=y("../drawing"),a=y("../color"),r=y("../../lib/svg_text_utils"),d=y("../../constants/interactions"),s=y("../../constants/alignment").OPPOSITE_SIDE,i=/ [XY][0-9]* /;ee.exports={draw:function(u,f,c){var h,o=c.propName,b=c.placeholder,l=c.traceIndex,T=c.avoid||{},_=c.attributes,w=c.transform,k=c.containerGroup,L=u._fullLayout,M=1,I=!1,P=c.propContainer.title,S=(P&&P.text?P.text:"").trim(),E=P&&P.font?P.font:{},z=E.family,R=E.size,q=E.color;"title.text"===o?h="titleText":-1!==o.indexOf("axis")?h="axisTitleText":o.indexOf(!0)&&(h="colorbarTitleText");var V=u._context.edits[h];""===S?M=0:S.replace(i," % ")===b.replace(i," % ")&&(M=.2,I=!0,V||(S="")),c._meta?S=e.templateString(S,c._meta):L._meta&&(S=e.templateString(S,L._meta));var W,K=S||V;k||(k=e.ensureSingle(L._infolayer,"g","g-"+f),W=L._hColorbarMoveTitle);var G=k.selectAll("text").data(K?[0]:[]);if(G.enter().append("text"),G.text(S).attr("class",f),G.exit().remove(),!K)return k;function Y(N){e.syncOrAsync([$,B],N)}function $(N){var U;return!w&&W&&(w={}),w?(U="",w.rotate&&(U+="rotate("+[w.rotate,_.x,_.y]+")"),(w.offset||W)&&(U+=n(0,(w.offset||0)-(W||0)))):U=null,N.attr("transform",U),N.style({"font-family":z,"font-size":g.round(R,2)+"px",fill:a.rgb(q),opacity:M*a.opacity(q),"font-weight":m.fontWeight}).attr(_).call(r.convertToTspans,u),m.previousPromises(u)}function B(N){var U=g.select(N.node().parentNode);if(T&&T.selection&&T.side&&S){U.attr("transform",null);var te=s[T.side],j="left"===T.side||"top"===T.side?-1:1,J=v(T.pad)?T.pad:2,X=t.bBox(U.node()),ne=T.maxShift||j*({left:0,top:0,right:L.width,bottom:L.height}[T.side]-X[T.side]),le=0;if(ne<0)le=ne;else{var oe=T.offsetLeft||0,de=T.offsetTop||0;X.left-=oe,X.right-=oe,X.top-=de,X.bottom-=de,T.selection.each(function(){var ge=t.bBox(this);e.bBoxIntersect(X,ge,J)&&(le=Math.max(le,j*(ge[T.side]-X[te])+J))}),le=Math.min(ne,le)}if(le>0||ne<0){var se={left:[-le,0],right:[le,0],top:[0,-le],bottom:[0,le]}[T.side];U.attr("transform",n(se[0],se[1]))}}}return G.call(Y),V&&(S?G.on(".opacity",null):(M=0,I=!0,G.text(b).on("mouseover.opacity",function(){g.select(this).transition().duration(d.SHOW_PLACEHOLDER).style("opacity",1)}).on("mouseout.opacity",function(){g.select(this).transition().duration(d.HIDE_PLACEHOLDER).style("opacity",0)})),G.call(r.makeEditable,{gd:u}).on("edit",function(N){void 0!==l?x.call("_guiRestyle",u,o,N,l):x.call("_guiRelayout",u,o,N)}).on("cancel",function(){this.text(this.attr("data-unformatted")).call(Y)}).on("input",function(N){this.text(N||" ").call(r.positionText,_.x,_.y)})),G.classed("js-placeholder",I),k}}},{"../../constants/alignment":483,"../../constants/interactions":490,"../../lib":515,"../../lib/svg_text_utils":541,"../../plots/plots":628,"../../registry":647,"../color":367,"../drawing":389,"@plotly/d3":58,"fast-isnumeric":190}],477:[function(y,ee,Q){"use strict";var g=y("../../plots/font_attributes"),v=y("../color/attributes"),m=y("../../lib/extend").extendFlat,x=y("../../plot_api/edit_types").overrideAll,e=y("../../plots/pad_attributes"),n=y("../../plot_api/plot_template").templatedArray,t=n("button",{visible:{valType:"boolean"},method:{valType:"enumerated",values:["restyle","relayout","animate","update","skip"],dflt:"restyle"},args:{valType:"info_array",freeLength:!0,items:[{valType:"any"},{valType:"any"},{valType:"any"}]},args2:{valType:"info_array",freeLength:!0,items:[{valType:"any"},{valType:"any"},{valType:"any"}]},label:{valType:"string",dflt:""},execute:{valType:"boolean",dflt:!0}});ee.exports=x(n("updatemenu",{_arrayAttrRegexps:[/^updatemenus\[(0|[1-9][0-9]+)\]\.buttons/],visible:{valType:"boolean"},type:{valType:"enumerated",values:["dropdown","buttons"],dflt:"dropdown"},direction:{valType:"enumerated",values:["left","right","up","down"],dflt:"down"},active:{valType:"integer",min:-1,dflt:0},showactive:{valType:"boolean",dflt:!0},buttons:t,x:{valType:"number",min:-2,max:3,dflt:-.05},xanchor:{valType:"enumerated",values:["auto","left","center","right"],dflt:"right"},y:{valType:"number",min:-2,max:3,dflt:1},yanchor:{valType:"enumerated",values:["auto","top","middle","bottom"],dflt:"top"},pad:m(e({editType:"arraydraw"}),{}),font:g({}),bgcolor:{valType:"color"},bordercolor:{valType:"color",dflt:v.borderLine},borderwidth:{valType:"number",min:0,dflt:1,editType:"arraydraw"}}),"arraydraw","from-root")},{"../../lib/extend":505,"../../plot_api/edit_types":548,"../../plot_api/plot_template":555,"../../plots/font_attributes":594,"../../plots/pad_attributes":627,"../color/attributes":366}],478:[function(y,ee,Q){"use strict";ee.exports={name:"updatemenus",containerClassName:"updatemenu-container",headerGroupClassName:"updatemenu-header-group",headerClassName:"updatemenu-header",headerArrowClassName:"updatemenu-header-arrow",dropdownButtonGroupClassName:"updatemenu-dropdown-button-group",dropdownButtonClassName:"updatemenu-dropdown-button",buttonClassName:"updatemenu-button",itemRectClassName:"updatemenu-item-rect",itemTextClassName:"updatemenu-item-text",menuIndexAttrName:"updatemenu-active-index",autoMarginIdRoot:"updatemenu-",blankHeaderOpts:{label:"  "},minWidth:30,minHeight:30,textPadX:24,arrowPadX:16,rx:2,ry:2,textOffsetX:12,textOffsetY:3,arrowOffsetX:4,gapButtonHeader:5,gapButton:2,activeColor:"#F4FAFF",hoverColor:"#F4FAFF",arrowSymbol:{left:"\u25c4",right:"\u25ba",up:"\u25b2",down:"\u25bc"}}},{}],479:[function(y,ee,Q){"use strict";var g=y("../../lib"),v=y("../../plots/array_container_defaults"),m=y("./attributes"),x=y("./constants").name,e=m.buttons;function n(a,r,d){function s(i,u){return g.coerce(a,r,m,i,u)}s("visible",v(a,r,{name:"buttons",handleItemDefaults:t}).length>0)&&(s("active"),s("direction"),s("type"),s("showactive"),s("x"),s("y"),g.noneOrAll(a,r,["x","y"]),s("xanchor"),s("yanchor"),s("pad.t"),s("pad.r"),s("pad.b"),s("pad.l"),g.coerceFont(s,"font",d.font),s("bgcolor",d.paper_bgcolor),s("bordercolor"),s("borderwidth"))}function t(a,r){function d(s,i){return g.coerce(a,r,e,s,i)}d("visible","skip"===a.method||Array.isArray(a.args))&&(d("method"),d("args"),d("args2"),d("label"),d("execute"))}ee.exports=function(a,r){v(a,r,{name:x,handleItemDefaults:n})}},{"../../lib":515,"../../plots/array_container_defaults":561,"./attributes":477,"./constants":478}],480:[function(y,ee,Q){"use strict";var g=y("@plotly/d3"),v=y("../../plots/plots"),m=y("../color"),x=y("../drawing"),e=y("../../lib"),n=y("../../lib/svg_text_utils"),t=y("../../plot_api/plot_template").arrayEditor,a=y("../../constants/alignment").LINE_SPACING,r=y("./constants"),d=y("./scrollbox");function s(M){return M._index}function i(M,I){return+M.attr(r.menuIndexAttrName)===I._index}function u(M,I,P,S,E,z,R,q){I.active=R,t(M.layout,r.name,I).applyUpdate("active",R),"buttons"===I.type?c(M,S,null,null,I):"dropdown"===I.type&&(E.attr(r.menuIndexAttrName,"-1"),f(M,S,E,z,I),q||c(M,S,E,z,I))}function f(M,I,P,S,E){var z=e.ensureSingle(I,"g",r.headerClassName,function(G){G.style("pointer-events","all")}),R=E._dims,W={y:E.pad.t,yPad:0,x:E.pad.l,xPad:0,index:0},K={width:R.headerWidth,height:R.headerHeight};z.call(h,E,E.buttons[E.active]||r.blankHeaderOpts,M).call(k,E,W,K),e.ensureSingle(I,"text",r.headerArrowClassName,function(G){G.attr("text-anchor","end").call(x.font,E.font).text(r.arrowSymbol[E.direction])}).attr({x:R.headerWidth-r.arrowOffsetX+E.pad.l,y:R.headerHeight/2+r.textOffsetY+E.pad.t}),z.on("click",function(){P.call(L,String(i(P,E)?-1:E._index)),c(M,I,P,S,E)}),z.on("mouseover",function(){z.call(l)}),z.on("mouseout",function(){z.call(T,E)}),x.setTranslate(I,R.lx,R.ly)}function c(M,I,P,S,E){P||(P=I).attr("pointer-events","all");var z=-1==+P.attr(r.menuIndexAttrName)&&"buttons"!==E.type?[]:E.buttons,R="dropdown"===E.type?r.dropdownButtonClassName:r.buttonClassName,q=P.selectAll("g."+R).data(e.filterVisible(z)),V=q.enter().append("g").classed(R,!0),W=q.exit();"dropdown"===E.type?(V.attr("opacity","0").transition().attr("opacity","1"),W.transition().attr("opacity","0").remove()):W.remove();var K=0,G=0,Y=E._dims,$=-1!==["up","down"].indexOf(E.direction);"dropdown"===E.type&&($?G=Y.headerHeight+r.gapButtonHeader:K=Y.headerWidth+r.gapButtonHeader),"dropdown"===E.type&&"up"===E.direction&&(G=-r.gapButtonHeader+r.gapButton-Y.openHeight),"dropdown"===E.type&&"left"===E.direction&&(K=-r.gapButtonHeader+r.gapButton-Y.openWidth);var U,te,j,B={x:Y.lx+K+E.pad.l,y:Y.ly+G+E.pad.t,yPad:r.gapButton,xPad:r.gapButton,index:0},N={l:B.x+E.borderwidth,t:B.y+E.borderwidth};q.each(function(U,te){var j=g.select(this);j.call(h,E,U,M).call(k,E,B),j.on("click",function(){g.event.defaultPrevented||(U.execute&&(U.args2&&E.active===te?(u(M,E,0,I,P,S,-1),v.executeAPICommand(M,U.method,U.args2)):(u(M,E,0,I,P,S,te),v.executeAPICommand(M,U.method,U.args))),M.emit("plotly_buttonclicked",{menu:E,button:U,active:E.active}))}),j.on("mouseover",function(){j.call(l)}),j.on("mouseout",function(){j.call(T,E),q.call(b,E)})}),q.call(b,E),$?(N.w=Math.max(Y.openWidth,Y.headerWidth),N.h=B.y-N.t):(N.w=B.x-N.l,N.h=Math.max(Y.openHeight,Y.headerHeight)),N.direction=E.direction,S&&(q.size()?function(U,te,j,J,X,re){var ne,le,oe,de=X.direction,ge=X._dims,_e=X.active;if("up"===de||"down"===de)for(le=0,oe=0;oe<_e;oe++)le+=ge.heights[oe]+r.gapButton;else for(ne=0,oe=0;oe<_e;oe++)ne+=ge.widths[oe]+r.gapButton;J.enable(re,ne,le),J.hbar&&J.hbar.attr("opacity","0").transition().attr("opacity","1"),J.vbar&&J.vbar.attr("opacity","0").transition().attr("opacity","1")}(0,0,0,S,E,N):(j=!!(U=S).vbar,(te=!!U.hbar)&&U.hbar.transition().attr("opacity","0").each("end",function(){te=!1,j||U.disable()}),j&&U.vbar.transition().attr("opacity","0").each("end",function(){j=!1,te||U.disable()})))}function h(M,I,P,S){M.call(p,I).call(o,I,P,S)}function p(M,I){e.ensureSingle(M,"rect",r.itemRectClassName,function(P){P.attr({rx:r.rx,ry:r.ry,"shape-rendering":"crispEdges"})}).call(m.stroke,I.bordercolor).call(m.fill,I.bgcolor).style("stroke-width",I.borderwidth+"px")}function o(M,I,P,S){var E=e.ensureSingle(M,"text",r.itemTextClassName,function(q){q.attr({"text-anchor":"start","data-notex":1})}),z=P.label,R=S._fullLayout._meta;R&&(z=e.templateString(z,R)),E.call(x.font,I.font).text(z).call(n.convertToTspans,S)}function b(M,I){var P=I.active;M.each(function(S,E){var z=g.select(this);E===P&&I.showactive&&z.select("rect."+r.itemRectClassName).call(m.fill,r.activeColor)})}function l(M){M.select("rect."+r.itemRectClassName).call(m.fill,r.hoverColor)}function T(M,I){M.select("rect."+r.itemRectClassName).call(m.fill,I.bgcolor)}function _(M,I){var P=I._dims={width1:0,height1:0,heights:[],widths:[],totalWidth:0,totalHeight:0,openWidth:0,openHeight:0,lx:0,ly:0},S=x.tester.selectAll("g."+r.dropdownButtonClassName).data(e.filterVisible(I.buttons));S.enter().append("g").classed(r.dropdownButtonClassName,!0);var E=-1!==["up","down"].indexOf(I.direction);S.each(function(K,G){var Y=g.select(this);Y.call(h,I,K,M);var $=Y.select("."+r.itemTextClassName),B=$.node()&&x.bBox($.node()).width,N=Math.max(B+r.textPadX,r.minWidth),U=I.font.size*a,te=n.lineCount($),j=Math.max(U*te,r.minHeight)+r.textOffsetY;j=Math.ceil(j),N=Math.ceil(N),P.widths[G]=N,P.heights[G]=j,P.height1=Math.max(P.height1,j),P.width1=Math.max(P.width1,N),E?(P.totalWidth=Math.max(P.totalWidth,N),P.openWidth=P.totalWidth,P.totalHeight+=j+r.gapButton,P.openHeight+=j+r.gapButton):(P.totalWidth+=N+r.gapButton,P.openWidth+=N+r.gapButton,P.totalHeight=Math.max(P.totalHeight,j),P.openHeight=P.totalHeight)}),E?P.totalHeight-=r.gapButton:P.totalWidth-=r.gapButton,P.headerWidth=P.width1+r.arrowPadX,P.headerHeight=P.height1,"dropdown"===I.type&&(E?(P.width1+=r.arrowPadX,P.totalHeight=P.height1):P.totalWidth=P.width1,P.totalWidth+=r.arrowPadX),S.remove();var z=P.totalWidth+I.pad.l+I.pad.r,R=P.totalHeight+I.pad.t+I.pad.b,q=M._fullLayout._size;P.lx=q.l+q.w*I.x,P.ly=q.t+q.h*(1-I.y);var V="left";e.isRightAnchor(I)&&(P.lx-=z,V="right"),e.isCenterAnchor(I)&&(P.lx-=z/2,V="center");var W="top";e.isBottomAnchor(I)&&(P.ly-=R,W="bottom"),e.isMiddleAnchor(I)&&(P.ly-=R/2,W="middle"),P.totalWidth=Math.ceil(P.totalWidth),P.totalHeight=Math.ceil(P.totalHeight),P.lx=Math.round(P.lx),P.ly=Math.round(P.ly),v.autoMargin(M,w(I),{x:I.x,y:I.y,l:z*({right:1,center:.5}[V]||0),r:z*({left:1,center:.5}[V]||0),b:R*({top:1,middle:.5}[W]||0),t:R*({bottom:1,middle:.5}[W]||0)})}function w(M){return r.autoMarginIdRoot+M._index}function k(M,I,P,S){S=S||{};var E=M.select("."+r.itemRectClassName),z=M.select("."+r.itemTextClassName),R=I.borderwidth,q=P.index,V=I._dims;x.setTranslate(M,R+P.x,R+P.y);var W=-1!==["up","down"].indexOf(I.direction),K=S.height||(W?V.heights[q]:V.height1);E.attr({x:0,y:0,width:S.width||(W?V.width1:V.widths[q]),height:K});var G=I.font.size*a,Y=(n.lineCount(z)-1)*G/2;n.positionText(z,r.textOffsetX,K/2-Y+r.textOffsetY),W?P.y+=V.heights[q]+P.yPad:P.x+=V.widths[q]+P.xPad,P.index++}function L(M,I){M.attr(r.menuIndexAttrName,I||"-1").selectAll("g."+r.dropdownButtonClassName).remove()}ee.exports=function(M){var I=M._fullLayout,P=e.filterVisible(I[r.name]);function S(G){v.autoMargin(M,w(G))}var E=I._menulayer.selectAll("g."+r.containerClassName).data(P.length>0?[0]:[]);if(E.enter().append("g").classed(r.containerClassName,!0).style("cursor","pointer"),E.exit().each(function(){g.select(this).selectAll("g."+r.headerGroupClassName).each(S)}).remove(),0!==P.length){var z=E.selectAll("g."+r.headerGroupClassName).data(P,s);z.enter().append("g").classed(r.headerGroupClassName,!0);for(var R=e.ensureSingle(E,"g",r.dropdownButtonGroupClassName,function(G){G.style("pointer-events","all")}),q=0;q<P.length;q++)_(M,P[q]);var K=new d(M,R,"updatemenus"+I._uid);z.enter().size()&&(R.node().parentNode.appendChild(R.node()),R.call(L)),z.exit().each(function(G){R.call(L),S(G)}).remove(),z.each(function(G){var Y=g.select(this),$="dropdown"===G.type?R:null;v.manageCommandObserver(M,G,G.buttons,function(B){u(M,G,0,Y,$,K,B.index,!0)}),"dropdown"===G.type?(f(M,Y,R,K,G),i(R,G)&&c(M,Y,R,K,G)):c(M,Y,null,null,G)})}}},{"../../constants/alignment":483,"../../lib":515,"../../lib/svg_text_utils":541,"../../plot_api/plot_template":555,"../../plots/plots":628,"../color":367,"../drawing":389,"./constants":478,"./scrollbox":482,"@plotly/d3":58}],481:[function(y,ee,Q){arguments[4][475][0].apply(Q,arguments)},{"./attributes":477,"./constants":478,"./defaults":479,"./draw":480,dup:475}],482:[function(y,ee,Q){"use strict";ee.exports=e;var g=y("@plotly/d3"),v=y("../color"),m=y("../drawing"),x=y("../../lib");function e(n,t,a){this.gd=n,this.container=t,this.id=a,this.position=null,this.translateX=null,this.translateY=null,this.hbar=null,this.vbar=null,this.bg=this.container.selectAll("rect.scrollbox-bg").data([0]),this.bg.exit().on(".drag",null).on("wheel",null).remove(),this.bg.enter().append("rect").classed("scrollbox-bg",!0).style("pointer-events","all").attr({opacity:0,x:0,y:0,width:0,height:0})}e.barWidth=2,e.barLength=20,e.barRadius=2,e.barPad=1,e.barColor="#808BA4",e.prototype.enable=function(n,t,a){var r=this.gd._fullLayout,d=r.width,s=r.height;this.position=n;var i,u,f,c,h=this.position.l,p=this.position.w,o=this.position.t,b=this.position.h,l=this.position.direction,T="down"===l,_="left"===l,w="up"===l,k=p,L=b;T||_||"right"===l||w||(this.position.direction="down",T=!0),T||w?(u=(i=h)+k,T?(f=o,L=(c=Math.min(f+L,s))-f):L=(c=o+L)-(f=Math.max(c-L,0))):(c=(f=o)+L,_?k=(u=h+k)-(i=Math.max(u-k,0)):(i=h,k=(u=Math.min(i+k,d))-i)),this._box={l:i,t:f,w:k,h:L};var M=p>k,I=e.barLength+2*e.barPad,P=e.barWidth+2*e.barPad,S=h,E=o+b;E+P>s&&(E=s-P);var z=this.container.selectAll("rect.scrollbar-horizontal").data(M?[0]:[]);z.exit().on(".drag",null).remove(),z.enter().append("rect").classed("scrollbar-horizontal",!0).call(v.fill,e.barColor),M?(this.hbar=z.attr({rx:e.barRadius,ry:e.barRadius,x:S,y:E,width:I,height:P}),this._hbarXMin=S+I/2,this._hbarTranslateMax=k-I):(delete this.hbar,delete this._hbarXMin,delete this._hbarTranslateMax);var R=b>L,q=e.barWidth+2*e.barPad,V=e.barLength+2*e.barPad,W=h+p,K=o;W+q>d&&(W=d-q);var G=this.container.selectAll("rect.scrollbar-vertical").data(R?[0]:[]);G.exit().on(".drag",null).remove(),G.enter().append("rect").classed("scrollbar-vertical",!0).call(v.fill,e.barColor),R?(this.vbar=G.attr({rx:e.barRadius,ry:e.barRadius,x:W,y:K,width:q,height:V}),this._vbarYMin=K+V/2,this._vbarTranslateMax=L-V):(delete this.vbar,delete this._vbarYMin,delete this._vbarTranslateMax);var Y=this.id,$=i-.5,B=R?u+q+.5:u+.5,N=f-.5,U=M?c+P+.5:c+.5,te=r._topdefs.selectAll("#"+Y).data(M||R?[0]:[]);if(te.exit().remove(),te.enter().append("clipPath").attr("id",Y).append("rect"),M||R?(this._clipRect=te.select("rect").attr({x:Math.floor($),y:Math.floor(N),width:Math.ceil(B)-Math.floor($),height:Math.ceil(U)-Math.floor(N)}),this.container.call(m.setClipUrl,Y,this.gd),this.bg.attr({x:h,y:o,width:p,height:b})):(this.bg.attr({width:0,height:0}),this.container.on("wheel",null).on(".drag",null).call(m.setClipUrl,null),delete this._clipRect),M||R){var j=g.behavior.drag().on("dragstart",function(){g.event.sourceEvent.preventDefault()}).on("drag",this._onBoxDrag.bind(this));this.container.on("wheel",null).on("wheel",this._onBoxWheel.bind(this)).on(".drag",null).call(j);var J=g.behavior.drag().on("dragstart",function(){g.event.sourceEvent.preventDefault(),g.event.sourceEvent.stopPropagation()}).on("drag",this._onBarDrag.bind(this));M&&this.hbar.on(".drag",null).call(J),R&&this.vbar.on(".drag",null).call(J)}this.setTranslate(t,a)},e.prototype.disable=function(){(this.hbar||this.vbar)&&(this.bg.attr({width:0,height:0}),this.container.on("wheel",null).on(".drag",null).call(m.setClipUrl,null),delete this._clipRect),this.hbar&&(this.hbar.on(".drag",null),this.hbar.remove(),delete this.hbar,delete this._hbarXMin,delete this._hbarTranslateMax),this.vbar&&(this.vbar.on(".drag",null),this.vbar.remove(),delete this.vbar,delete this._vbarYMin,delete this._vbarTranslateMax)},e.prototype._onBoxDrag=function(){var n=this.translateX,t=this.translateY;this.hbar&&(n-=g.event.dx),this.vbar&&(t-=g.event.dy),this.setTranslate(n,t)},e.prototype._onBoxWheel=function(){var n=this.translateX,t=this.translateY;this.hbar&&(n+=g.event.deltaY),this.vbar&&(t+=g.event.deltaY),this.setTranslate(n,t)},e.prototype._onBarDrag=function(){var n=this.translateX,t=this.translateY;if(this.hbar){var a=n+this._hbarXMin,r=a+this._hbarTranslateMax;n=(x.constrain(g.event.x,a,r)-a)/(r-a)*(this.position.w-this._box.w)}if(this.vbar){var d=t+this._vbarYMin,s=d+this._vbarTranslateMax;t=(x.constrain(g.event.y,d,s)-d)/(s-d)*(this.position.h-this._box.h)}this.setTranslate(n,t)},e.prototype.setTranslate=function(n,t){var a=this.position.w-this._box.w,r=this.position.h-this._box.h;n=x.constrain(n||0,0,a),t=x.constrain(t||0,0,r),this.translateX=n,this.translateY=t,this.container.call(m.setTranslate,this._box.l-this.position.l-n,this._box.t-this.position.t-t),this._clipRect&&this._clipRect.attr({x:Math.floor(this.position.l+n-.5),y:Math.floor(this.position.t+t-.5)}),this.hbar&&this.hbar.call(m.setTranslate,n+n/a*this._hbarTranslateMax,t),this.vbar&&this.vbar.call(m.setTranslate,n,t+t/r*this._vbarTranslateMax)}},{"../../lib":515,"../color":367,"../drawing":389,"@plotly/d3":58}],483:[function(y,ee,Q){"use strict";ee.exports={FROM_BL:{left:0,center:.5,right:1,bottom:0,middle:.5,top:1},FROM_TL:{left:0,center:.5,right:1,bottom:1,middle:.5,top:0},FROM_BR:{left:1,center:.5,right:0,bottom:0,middle:.5,top:1},LINE_SPACING:1.3,CAP_SHIFT:.7,MID_SHIFT:.35,OPPOSITE_SIDE:{left:"right",right:"left",top:"bottom",bottom:"top"}}},{}],484:[function(y,ee,Q){"use strict";ee.exports={axisRefDescription:function(g,v,m){return["If set to a",g,"axis id (e.g. *"+g+"* or","*"+g+"2*), the `"+g+"` position refers to a",g,"coordinate. If set to *paper*, the `"+g+"`","position refers to the distance from the",v,"of the plotting","area in normalized coordinates where *0* (*1*) corresponds to the",v,"("+m+"). If set to a",g,"axis ID followed by","*domain* (separated by a space), the position behaves like for","*paper*, but refers to the distance in fractions of the domain","length from the",v,"of the domain of that axis: e.g.,","*"+g+"2 domain* refers to the domain of the second",g," axis and a",g,"position of 0.5 refers to the","point between the",v,"and the",m,"of the domain of the","second",g,"axis."].join(" ")}}},{}],485:[function(y,ee,Q){"use strict";ee.exports={INCREASING:{COLOR:"#3D9970",SYMBOL:"\u25b2"},DECREASING:{COLOR:"#FF4136",SYMBOL:"\u25bc"}}},{}],486:[function(y,ee,Q){"use strict";ee.exports={FORMAT_LINK:"https://github.com/d3/d3-format/tree/v1.4.5#d3-format",DATE_FORMAT_LINK:"https://github.com/d3/d3-time-format/tree/v2.2.3#locale_format"}},{}],487:[function(y,ee,Q){"use strict";ee.exports={COMPARISON_OPS:["=","!=","<",">=",">","<="],COMPARISON_OPS2:["=","<",">=",">","<="],INTERVAL_OPS:["[]","()","[)","(]","][",")(","](",")["],SET_OPS:["{}","}{"],CONSTRAINT_REDUCTION:{"=":"=","<":"<","<=":"<",">":">",">=":">","[]":"[]","()":"[]","[)":"[]","(]":"[]","][":"][",")(":"][","](":"][",")[":"]["}}},{}],488:[function(y,ee,Q){"use strict";ee.exports={solid:[[],0],dot:[[.5,1],200],dash:[[.5,1],50],longdash:[[.5,1],10],dashdot:[[.5,.625,.875,1],50],longdashdot:[[.5,.7,.8,1],10]}},{}],489:[function(y,ee,Q){"use strict";ee.exports={circle:"\u25cf","circle-open":"\u25cb",square:"\u25a0","square-open":"\u25a1",diamond:"\u25c6","diamond-open":"\u25c7",cross:"+",x:"\u274c"}},{}],490:[function(y,ee,Q){"use strict";ee.exports={SHOW_PLACEHOLDER:100,HIDE_PLACEHOLDER:1e3,DESELECTDIM:.2}},{}],491:[function(y,ee,Q){"use strict";ee.exports={BADNUM:void 0,FP_SAFE:1e-4*Number.MAX_VALUE,ONEMAXYEAR:316224e5,ONEAVGYEAR:315576e5,ONEMINYEAR:31536e6,ONEMAXQUARTER:79488e5,ONEAVGQUARTER:78894e5,ONEMINQUARTER:76896e5,ONEMAXMONTH:26784e5,ONEAVGMONTH:26298e5,ONEMINMONTH:24192e5,ONEWEEK:6048e5,ONEDAY:864e5,ONEHOUR:36e5,ONEMIN:6e4,ONESEC:1e3,EPOCHJD:2440587.5,ALMOST_EQUAL:.999999,LOG_CLIP:10,MINUS_SIGN:"\u2212"}},{}],492:[function(y,ee,Q){"use strict";Q.xmlns="http://www.w3.org/2000/xmlns/",Q.svg="http://www.w3.org/2000/svg",Q.xlink="http://www.w3.org/1999/xlink",Q.svgAttrs={xmlns:Q.svg,"xmlns:xlink":Q.xlink}},{}],493:[function(y,ee,Q){"use strict";Q.version=y("./version").version,y("native-promise-only"),y("../build/plotcss");for(var g=y("./registry"),v=Q.register=g.register,m=y("./plot_api"),x=Object.keys(m),e=0;e<x.length;e++){var n=x[e];"_"!==n.charAt(0)&&(Q[n]=m[n]),v({moduleType:"apiMethod",name:n,fn:m[n]})}v(y("./traces/scatter")),v([y("./components/legend"),y("./components/fx"),y("./components/annotations"),y("./components/annotations3d"),y("./components/selections"),y("./components/shapes"),y("./components/images"),y("./components/updatemenus"),y("./components/sliders"),y("./components/rangeslider"),y("./components/rangeselector"),y("./components/grid"),y("./components/errorbars"),y("./components/colorscale"),y("./components/colorbar"),y("./components/modebar")]),v([y("./locale-en"),y("./locale-en-us")]),window.PlotlyLocales&&Array.isArray(window.PlotlyLocales)&&(v(window.PlotlyLocales),delete window.PlotlyLocales),Q.Icons=y("./fonts/ploticon");var t=y("./components/fx"),a=y("./plots/plots");Q.Plots={resize:a.resize,graphJson:a.graphJson,sendDataToCloud:a.sendDataToCloud},Q.Fx={hover:t.hover,unhover:t.unhover,loneHover:t.loneHover,loneUnhover:t.loneUnhover},Q.Snapshot=y("./snapshot"),Q.PlotSchema=y("./plot_api/plot_schema")},{"../build/plotcss":1,"./components/annotations":358,"./components/annotations3d":363,"./components/colorbar":373,"./components/colorscale":379,"./components/errorbars":395,"./components/fx":407,"./components/grid":411,"./components/images":416,"./components/legend":424,"./components/modebar":430,"./components/rangeselector":438,"./components/rangeslider":445,"./components/selections":455,"./components/shapes":470,"./components/sliders":475,"./components/updatemenus":481,"./fonts/ploticon":494,"./locale-en":546,"./locale-en-us":545,"./plot_api":550,"./plot_api/plot_schema":554,"./plots/plots":628,"./registry":647,"./snapshot":652,"./traces/scatter":948,"./version":1132,"native-promise-only":245}],494:[function(y,ee,Q){"use strict";ee.exports={undo:{width:857.1,height:1e3,path:"m857 350q0-87-34-166t-91-137-137-92-166-34q-96 0-183 41t-147 114q-4 6-4 13t5 11l76 77q6 5 14 5 9-1 13-7 41-53 100-82t126-29q58 0 110 23t92 61 61 91 22 111-22 111-61 91-92 61-110 23q-55 0-105-20t-90-57l77-77q17-16 8-38-10-23-33-23h-250q-15 0-25 11t-11 25v250q0 24 22 33 22 10 39-8l72-72q60 57 137 88t159 31q87 0 166-34t137-92 91-137 34-166z",transform:"matrix(1 0 0 -1 0 850)"},home:{width:928.6,height:1e3,path:"m786 296v-267q0-15-11-26t-25-10h-214v214h-143v-214h-214q-15 0-25 10t-11 26v267q0 1 0 2t0 2l321 264 321-264q1-1 1-4z m124 39l-34-41q-5-5-12-6h-2q-7 0-12 3l-386 322-386-322q-7-4-13-4-7 2-12 7l-35 41q-4 5-3 13t6 12l401 334q18 15 42 15t43-15l136-114v109q0 8 5 13t13 5h107q8 0 13-5t5-13v-227l122-102q5-5 6-12t-4-13z",transform:"matrix(1 0 0 -1 0 850)"},"camera-retro":{width:1e3,height:1e3,path:"m518 386q0 8-5 13t-13 5q-37 0-63-27t-26-63q0-8 5-13t13-5 12 5 5 13q0 23 16 38t38 16q8 0 13 5t5 13z m125-73q0-59-42-101t-101-42-101 42-42 101 42 101 101 42 101-42 42-101z m-572-320h858v71h-858v-71z m643 320q0 89-62 152t-152 62-151-62-63-152 63-151 151-63 152 63 62 151z m-571 358h214v72h-214v-72z m-72-107h858v143h-462l-36-71h-360v-72z m929 143v-714q0-30-21-51t-50-21h-858q-29 0-50 21t-21 51v714q0 30 21 51t50 21h858q29 0 50-21t21-51z",transform:"matrix(1 0 0 -1 0 850)"},zoombox:{width:1e3,height:1e3,path:"m1000-25l-250 251c40 63 63 138 63 218 0 224-182 406-407 406-224 0-406-182-406-406s183-406 407-406c80 0 155 22 218 62l250-250 125 125z m-812 250l0 438 437 0 0-438-437 0z m62 375l313 0 0-312-313 0 0 312z",transform:"matrix(1 0 0 -1 0 850)"},pan:{width:1e3,height:1e3,path:"m1000 350l-187 188 0-125-250 0 0 250 125 0-188 187-187-187 125 0 0-250-250 0 0 125-188-188 186-187 0 125 252 0 0-250-125 0 187-188 188 188-125 0 0 250 250 0 0-126 187 188z",transform:"matrix(1 0 0 -1 0 850)"},zoom_plus:{width:875,height:1e3,path:"m1 787l0-875 875 0 0 875-875 0z m687-500l-187 0 0-187-125 0 0 187-188 0 0 125 188 0 0 187 125 0 0-187 187 0 0-125z",transform:"matrix(1 0 0 -1 0 850)"},zoom_minus:{width:875,height:1e3,path:"m0 788l0-876 875 0 0 876-875 0z m688-500l-500 0 0 125 500 0 0-125z",transform:"matrix(1 0 0 -1 0 850)"},autoscale:{width:1e3,height:1e3,path:"m250 850l-187 0-63 0 0-62 0-188 63 0 0 188 187 0 0 62z m688 0l-188 0 0-62 188 0 0-188 62 0 0 188 0 62-62 0z m-875-938l0 188-63 0 0-188 0-62 63 0 187 0 0 62-187 0z m875 188l0-188-188 0 0-62 188 0 62 0 0 62 0 188-62 0z m-125 188l-1 0-93-94-156 156 156 156 92-93 2 0 0 250-250 0 0-2 93-92-156-156-156 156 94 92 0 2-250 0 0-250 0 0 93 93 157-156-157-156-93 94 0 0 0-250 250 0 0 0-94 93 156 157 156-157-93-93 0 0 250 0 0 250z",transform:"matrix(1 0 0 -1 0 850)"},tooltip_basic:{width:1500,height:1e3,path:"m375 725l0 0-375-375 375-374 0-1 1125 0 0 750-1125 0z",transform:"matrix(1 0 0 -1 0 850)"},tooltip_compare:{width:1125,height:1e3,path:"m187 786l0 2-187-188 188-187 0 0 937 0 0 373-938 0z m0-499l0 1-187-188 188-188 0 0 937 0 0 376-938-1z",transform:"matrix(1 0 0 -1 0 850)"},plotlylogo:{width:1542,height:1e3,path:"m0-10h182v-140h-182v140z m228 146h183v-286h-183v286z m225 714h182v-1000h-182v1000z m225-285h182v-715h-182v715z m225 142h183v-857h-183v857z m231-428h182v-429h-182v429z m225-291h183v-138h-183v138z",transform:"matrix(1 0 0 -1 0 850)"},"z-axis":{width:1e3,height:1e3,path:"m833 5l-17 108v41l-130-65 130-66c0 0 0 38 0 39 0-1 36-14 39-25 4-15-6-22-16-30-15-12-39-16-56-20-90-22-187-23-279-23-261 0-341 34-353 59 3 60 228 110 228 110-140-8-351-35-351-116 0-120 293-142 474-142 155 0 477 22 477 142 0 50-74 79-163 96z m-374 94c-58-5-99-21-99-40 0-24 65-43 144-43 79 0 143 19 143 43 0 19-42 34-98 40v216h87l-132 135-133-135h88v-216z m167 515h-136v1c16 16 31 34 46 52l84 109v54h-230v-71h124v-1c-16-17-28-32-44-51l-89-114v-51h245v72z",transform:"matrix(1 0 0 -1 0 850)"},"3d_rotate":{width:1e3,height:1e3,path:"m922 660c-5 4-9 7-14 11-359 263-580-31-580-31l-102 28 58-400c0 1 1 1 2 2 118 108 351 249 351 249s-62 27-100 42c88 83 222 183 347 122 16-8 30-17 44-27-2 1-4 2-6 4z m36-329c0 0 64 229-88 296-62 27-124 14-175-11 157-78 225-208 249-266 8-19 11-31 11-31 2 5 6 15 11 32-5-13-8-20-8-20z m-775-239c70-31 117-50 198-32-121 80-199 346-199 346l-96-15-58-12c0 0 55-226 155-287z m603 133l-317-139c0 0 4-4 19-14 7-5 24-15 24-15s-177-147-389 4c235-287 536-112 536-112l31-22 100 299-4-1z m-298-153c6-4 14-9 24-15 0 0-17 10-24 15z",transform:"matrix(1 0 0 -1 0 850)"},camera:{width:1e3,height:1e3,path:"m500 450c-83 0-150-67-150-150 0-83 67-150 150-150 83 0 150 67 150 150 0 83-67 150-150 150z m400 150h-120c-16 0-34 13-39 29l-31 93c-6 15-23 28-40 28h-340c-16 0-34-13-39-28l-31-94c-6-15-23-28-40-28h-120c-55 0-100-45-100-100v-450c0-55 45-100 100-100h800c55 0 100 45 100 100v450c0 55-45 100-100 100z m-400-550c-138 0-250 112-250 250 0 138 112 250 250 250 138 0 250-112 250-250 0-138-112-250-250-250z m365 380c-19 0-35 16-35 35 0 19 16 35 35 35 19 0 35-16 35-35 0-19-16-35-35-35z",transform:"matrix(1 0 0 -1 0 850)"},movie:{width:1e3,height:1e3,path:"m938 413l-188-125c0 37-17 71-44 94 64 38 107 107 107 187 0 121-98 219-219 219-121 0-219-98-219-219 0-61 25-117 66-156h-115c30 33 49 76 49 125 0 103-84 187-187 187s-188-84-188-187c0-57 26-107 65-141-38-22-65-62-65-109v-250c0-70 56-126 125-126h500c69 0 125 56 125 126l188-126c34 0 62 28 62 63v375c0 35-28 63-62 63z m-750 0c-69 0-125 56-125 125s56 125 125 125 125-56 125-125-56-125-125-125z m406-1c-87 0-157 70-157 157 0 86 70 156 157 156s156-70 156-156-70-157-156-157z",transform:"matrix(1 0 0 -1 0 850)"},question:{width:857.1,height:1e3,path:"m500 82v107q0 8-5 13t-13 5h-107q-8 0-13-5t-5-13v-107q0-8 5-13t13-5h107q8 0 13 5t5 13z m143 375q0 49-31 91t-77 65-95 23q-136 0-207-119-9-14 4-24l74-55q4-4 10-4 9 0 14 7 30 38 48 51 19 14 48 14 27 0 48-15t21-33q0-21-11-34t-38-25q-35-16-65-48t-29-70v-20q0-8 5-13t13-5h107q8 0 13 5t5 13q0 10 12 27t30 28q18 10 28 16t25 19 25 27 16 34 7 45z m214-107q0-117-57-215t-156-156-215-58-216 58-155 156-58 215 58 215 155 156 216 58 215-58 156-156 57-215z",transform:"matrix(1 0 0 -1 0 850)"},disk:{width:857.1,height:1e3,path:"m214-7h429v214h-429v-214z m500 0h72v500q0 8-6 21t-11 20l-157 156q-5 6-19 12t-22 5v-232q0-22-15-38t-38-16h-322q-22 0-37 16t-16 38v232h-72v-714h72v232q0 22 16 38t37 16h465q22 0 38-16t15-38v-232z m-214 518v178q0 8-5 13t-13 5h-107q-7 0-13-5t-5-13v-178q0-8 5-13t13-5h107q7 0 13 5t5 13z m357-18v-518q0-22-15-38t-38-16h-750q-23 0-38 16t-16 38v750q0 22 16 38t38 16h517q23 0 50-12t42-26l156-157q16-15 27-42t11-49z",transform:"matrix(1 0 0 -1 0 850)"},drawopenpath:{width:70,height:70,path:"M33.21,85.65a7.31,7.31,0,0,1-2.59-.48c-8.16-3.11-9.27-19.8-9.88-41.3-.1-3.58-.19-6.68-.35-9-.15-2.1-.67-3.48-1.43-3.79-2.13-.88-7.91,2.32-12,5.86L3,32.38c1.87-1.64,11.55-9.66,18.27-6.9,2.13.87,4.75,3.14,5.17,9,.17,2.43.26,5.59.36,9.25a224.17,224.17,0,0,0,1.5,23.4c1.54,10.76,4,12.22,4.48,12.4.84.32,2.79-.46,5.76-3.59L43,80.07C41.53,81.57,37.68,85.64,33.21,85.65ZM74.81,69a11.34,11.34,0,0,0,6.09-6.72L87.26,44.5,74.72,32,56.9,38.35c-2.37.86-5.57,3.42-6.61,6L38.65,72.14l8.42,8.43ZM55,46.27a7.91,7.91,0,0,1,3.64-3.17l14.8-5.3,8,8L76.11,60.6l-.06.19a6.37,6.37,0,0,1-3,3.43L48.25,74.59,44.62,71Zm16.57,7.82A6.9,6.9,0,1,0,64.64,61,6.91,6.91,0,0,0,71.54,54.09Zm-4.05,0a2.85,2.85,0,1,1-2.85-2.85A2.86,2.86,0,0,1,67.49,54.09Zm-4.13,5.22L60.5,56.45,44.26,72.7l2.86,2.86ZM97.83,35.67,84.14,22l-8.57,8.57L89.26,44.24Zm-13.69-8,8,8-2.85,2.85-8-8Z",transform:"matrix(1 0 0 1 -15 -15)"},drawclosedpath:{width:90,height:90,path:"M88.41,21.12a26.56,26.56,0,0,0-36.18,0l-2.07,2-2.07-2a26.57,26.57,0,0,0-36.18,0,23.74,23.74,0,0,0,0,34.8L48,90.12a3.22,3.22,0,0,0,4.42,0l36-34.21a23.73,23.73,0,0,0,0-34.79ZM84,51.24,50.16,83.35,16.35,51.25a17.28,17.28,0,0,1,0-25.47,20,20,0,0,1,27.3,0l4.29,4.07a3.23,3.23,0,0,0,4.44,0l4.29-4.07a20,20,0,0,1,27.3,0,17.27,17.27,0,0,1,0,25.46ZM66.76,47.68h-33v6.91h33ZM53.35,35H46.44V68h6.91Z",transform:"matrix(1 0 0 1 -5 -5)"},lasso:{width:1031,height:1e3,path:"m1018 538c-36 207-290 336-568 286-277-48-473-256-436-463 10-57 36-108 76-151-13-66 11-137 68-183 34-28 75-41 114-42l-55-70 0 0c-2-1-3-2-4-3-10-14-8-34 5-45 14-11 34-8 45 4 1 1 2 3 2 5l0 0 113 140c16 11 31 24 45 40 4 3 6 7 8 11 48-3 100 0 151 9 278 48 473 255 436 462z m-624-379c-80 14-149 48-197 96 42 42 109 47 156 9 33-26 47-66 41-105z m-187-74c-19 16-33 37-39 60 50-32 109-55 174-68-42-25-95-24-135 8z m360 75c-34-7-69-9-102-8 8 62-16 128-68 170-73 59-175 54-244-5-9 20-16 40-20 61-28 159 121 317 333 354s407-60 434-217c28-159-121-318-333-355z",transform:"matrix(1 0 0 -1 0 850)"},selectbox:{width:1e3,height:1e3,path:"m0 850l0-143 143 0 0 143-143 0z m286 0l0-143 143 0 0 143-143 0z m285 0l0-143 143 0 0 143-143 0z m286 0l0-143 143 0 0 143-143 0z m-857-286l0-143 143 0 0 143-143 0z m857 0l0-143 143 0 0 143-143 0z m-857-285l0-143 143 0 0 143-143 0z m857 0l0-143 143 0 0 143-143 0z m-857-286l0-143 143 0 0 143-143 0z m286 0l0-143 143 0 0 143-143 0z m285 0l0-143 143 0 0 143-143 0z m286 0l0-143 143 0 0 143-143 0z",transform:"matrix(1 0 0 -1 0 850)"},drawline:{width:70,height:70,path:"M60.64,62.3a11.29,11.29,0,0,0,6.09-6.72l6.35-17.72L60.54,25.31l-17.82,6.4c-2.36.86-5.57,3.41-6.6,6L24.48,65.5l8.42,8.42ZM40.79,39.63a7.89,7.89,0,0,1,3.65-3.17l14.79-5.31,8,8L61.94,54l-.06.19a6.44,6.44,0,0,1-3,3.43L34.07,68l-3.62-3.63Zm16.57,7.81a6.9,6.9,0,1,0-6.89,6.9A6.9,6.9,0,0,0,57.36,47.44Zm-4,0a2.86,2.86,0,1,1-2.85-2.85A2.86,2.86,0,0,1,53.32,47.44Zm-4.13,5.22L46.33,49.8,30.08,66.05l2.86,2.86ZM83.65,29,70,15.34,61.4,23.9,75.09,37.59ZM70,21.06l8,8-2.84,2.85-8-8ZM87,80.49H10.67V87H87Z",transform:"matrix(1 0 0 1 -15 -15)"},drawrect:{width:80,height:80,path:"M78,22V79H21V22H78m9-9H12V88H87V13ZM68,46.22H31V54H68ZM53,32H45.22V69H53Z",transform:"matrix(1 0 0 1 -10 -10)"},drawcircle:{width:80,height:80,path:"M50,84.72C26.84,84.72,8,69.28,8,50.3S26.84,15.87,50,15.87,92,31.31,92,50.3,73.16,84.72,50,84.72Zm0-60.59c-18.6,0-33.74,11.74-33.74,26.17S31.4,76.46,50,76.46,83.74,64.72,83.74,50.3,68.6,24.13,50,24.13Zm17.15,22h-34v7.11h34Zm-13.8-13H46.24v34h7.11Z",transform:"matrix(1 0 0 1 -10 -10)"},eraseshape:{width:80,height:80,path:"M82.77,78H31.85L6,49.57,31.85,21.14H82.77a8.72,8.72,0,0,1,8.65,8.77V69.24A8.72,8.72,0,0,1,82.77,78ZM35.46,69.84H82.77a.57.57,0,0,0,.49-.6V29.91a.57.57,0,0,0-.49-.61H35.46L17,49.57Zm32.68-34.7-24,24,5,5,24-24Zm-19,.53-5,5,24,24,5-5Z",transform:"matrix(1 0 0 1 -10 -10)"},spikeline:{width:1e3,height:1e3,path:"M512 409c0-57-46-104-103-104-57 0-104 47-104 104 0 57 47 103 104 103 57 0 103-46 103-103z m-327-39l92 0 0 92-92 0z m-185 0l92 0 0 92-92 0z m370-186l92 0 0 93-92 0z m0-184l92 0 0 92-92 0z",transform:"matrix(1.5 0 0 -1.5 0 850)"},pencil:{width:1792,height:1792,path:"M491 1536l91-91-235-235-91 91v107h128v128h107zm523-928q0-22-22-22-10 0-17 7l-542 542q-7 7-7 17 0 22 22 22 10 0 17-7l542-542q7-7 7-17zm-54-192l416 416-832 832h-416v-416zm683 96q0 53-37 90l-166 166-416-416 166-165q36-38 90-38 53 0 91 38l235 234q37 39 37 91z",transform:"matrix(1 0 0 1 0 1)"},newplotlylogo:{name:"newplotlylogo",svg:["<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 132 132'>","<defs>"," <style>","  .cls-0{fill:#000;}","  .cls-1{fill:#FFF;}","  .cls-2{fill:#F26;}","  .cls-3{fill:#D69;}","  .cls-4{fill:#BAC;}","  .cls-5{fill:#9EF;}"," </style>","</defs>"," <title>plotly-logomark</title>"," <g id='symbol'>","  <rect class='cls-0' x='0' y='0' width='132' height='132' rx='18' ry='18'/>","  <circle class='cls-5' cx='102' cy='30' r='6'/>","  <circle class='cls-4' cx='78' cy='30' r='6'/>","  <circle class='cls-4' cx='78' cy='54' r='6'/>","  <circle class='cls-3' cx='54' cy='30' r='6'/>","  <circle class='cls-2' cx='30' cy='30' r='6'/>","  <circle class='cls-2' cx='30' cy='54' r='6'/>","  <path class='cls-1' d='M30,72a6,6,0,0,0-6,6v24a6,6,0,0,0,12,0V78A6,6,0,0,0,30,72Z'/>","  <path class='cls-1' d='M78,72a6,6,0,0,0-6,6v24a6,6,0,0,0,12,0V78A6,6,0,0,0,78,72Z'/>","  <path class='cls-1' d='M54,48a6,6,0,0,0-6,6v48a6,6,0,0,0,12,0V54A6,6,0,0,0,54,48Z'/>","  <path class='cls-1' d='M102,48a6,6,0,0,0-6,6v48a6,6,0,0,0,12,0V54A6,6,0,0,0,102,48Z'/>"," </g>","</svg>"].join("")}}},{}],495:[function(y,ee,Q){"use strict";Q.isLeftAnchor=function(g){return"left"===g.xanchor||"auto"===g.xanchor&&g.x<=1/3},Q.isCenterAnchor=function(g){return"center"===g.xanchor||"auto"===g.xanchor&&g.x>1/3&&g.x<2/3},Q.isRightAnchor=function(g){return"right"===g.xanchor||"auto"===g.xanchor&&g.x>=2/3},Q.isTopAnchor=function(g){return"top"===g.yanchor||"auto"===g.yanchor&&g.y>=2/3},Q.isMiddleAnchor=function(g){return"middle"===g.yanchor||"auto"===g.yanchor&&g.y>1/3&&g.y<2/3},Q.isBottomAnchor=function(g){return"bottom"===g.yanchor||"auto"===g.yanchor&&g.y<=1/3}},{}],496:[function(y,ee,Q){"use strict";var g=y("./mod"),v=g.mod,m=g.modHalf,x=Math.PI,e=2*x;function n(d){return Math.abs(d[1]-d[0])>e-1e-14}function t(d,s){return m(s-d,e)}function a(d,s){if(n(s))return!0;var i,u;s[0]<s[1]?(i=s[0],u=s[1]):(i=s[1],u=s[0]),(i=v(i,e))>(u=v(u,e))&&(u+=e);var f=v(d,e),c=f+e;return f>=i&&f<=u||c>=i&&c<=u}function r(d,s,i,u,f,c,h){f=f||0,c=c||0;var p,o,b,l,T,_=n([i,u]);function w(I,P){return[I*Math.cos(P)+f,c-I*Math.sin(P)]}_?(p=0,o=x,b=e):i<u?(p=i,b=u):(p=u,b=i),d<s?(l=d,T=s):(l=s,T=d);var k,L=Math.abs(b-p)<=x?0:1;function M(I,P,S){return"A"+[I,I]+" "+[0,L,S]+" "+w(I,P)}return _?k=null===l?"M"+w(T,p)+M(T,o,0)+M(T,b,0)+"Z":"M"+w(l,p)+M(l,o,0)+M(l,b,0)+"ZM"+w(T,p)+M(T,o,1)+M(T,b,1)+"Z":null===l?(k="M"+w(T,p)+M(T,b,0),h&&(k+="L0,0Z")):k="M"+w(l,p)+"L"+w(T,p)+M(T,b,0)+"L"+w(l,b)+M(l,p,1)+"Z",k}ee.exports={deg2rad:function(d){return d/180*x},rad2deg:function(d){return d/x*180},angleDelta:t,angleDist:function(d,s){return Math.abs(t(d,s))},isFullCircle:n,isAngleInsideSector:a,isPtInsideSector:function(d,s,i,u){return!!a(s,u)&&(i[0]<i[1]?(f=i[0],c=i[1]):(f=i[1],c=i[0]),d>=f&&d<=c);var f,c},pathArc:function(d,s,i,u,f){return r(null,d,s,i,u,f,0)},pathSector:function(d,s,i,u,f){return r(null,d,s,i,u,f,1)},pathAnnulus:function(d,s,i,u,f,c){return r(d,s,i,u,f,c,1)}}},{"./mod":522}],497:[function(y,ee,Q){"use strict";var g=Array.isArray,v=ArrayBuffer,m=DataView;function x(t){return v.isView(t)&&!(t instanceof m)}function e(t){return g(t)||x(t)}function n(t,a,r){if(e(t)){if(e(t[0])){for(var d=r,s=0;s<t.length;s++)d=a(d,t[s].length);return d}return t.length}return 0}Q.isTypedArray=x,Q.isArrayOrTypedArray=e,Q.isArray1D=function(t){return!e(t[0])},Q.ensureArray=function(t,a){return g(t)||(t=[]),t.length=a,t},Q.concat=function(){var t,a,r,d,s,i,u,f,c=[],h=!0,p=0;for(r=0;r<arguments.length;r++)(i=(d=arguments[r]).length)&&(a?c.push(d):(a=d,s=i),g(d)?t=!1:(h=!1,p?t!==d.constructor&&(t=!1):t=d.constructor),p+=i);if(!p)return[];if(!c.length)return a;if(h)return a.concat.apply(a,c);if(t){for((u=new t(p)).set(a),r=0;r<c.length;r++)u.set(d=c[r],s),s+=d.length;return u}for(u=new Array(p),f=0;f<a.length;f++)u[f]=a[f];for(r=0;r<c.length;r++){for(d=c[r],f=0;f<d.length;f++)u[s+f]=d[f];s+=f}return u},Q.maxRowLength=function(t){return n(t,Math.max,0)},Q.minRowLength=function(t){return n(t,Math.min,1/0)}},{}],498:[function(y,ee,Q){"use strict";var g=y("fast-isnumeric"),v=y("../constants/numerical").BADNUM,m=/^['"%,$#\s']+|[, ]|['"%,$#\s']+$/g;ee.exports=function(x){return"string"==typeof x&&(x=x.replace(m,"")),g(x)?Number(x):v}},{"../constants/numerical":491,"fast-isnumeric":190}],499:[function(y,ee,Q){"use strict";ee.exports=function(g){var v=g._fullLayout;v._glcanvas&&v._glcanvas.size()&&v._glcanvas.each(function(m){m.regl&&m.regl.clear({color:!0,depth:!0})})}},{}],500:[function(y,ee,Q){"use strict";ee.exports=function(g){g._responsiveChartHandler&&(window.removeEventListener("resize",g._responsiveChartHandler),delete g._responsiveChartHandler)}},{}],501:[function(y,ee,Q){"use strict";var g=y("fast-isnumeric"),v=y("tinycolor2"),m=y("../plots/attributes"),x=y("../components/colorscale/scales"),e=y("../components/color"),n=y("../constants/interactions").DESELECTDIM,t=y("./nested_property"),a=y("./regex").counter,r=y("./mod").modHalf,d=y("./array").isArrayOrTypedArray;function s(i,u){var f=Q.valObjectMeta[u.valType];if(u.arrayOk&&d(i))return!0;if(f.validateFunction)return f.validateFunction(i,u);var c={},h=c;return f.coerceFunction(i,{set:function(o){h=o}},c,u),h!==c}Q.valObjectMeta={data_array:{coerceFunction:function(i,u,f){d(i)?u.set(i):void 0!==f&&u.set(f)}},enumerated:{coerceFunction:function(i,u,f,c){c.coerceNumber&&(i=+i),-1===c.values.indexOf(i)?u.set(f):u.set(i)},validateFunction:function(i,u){u.coerceNumber&&(i=+i);for(var f=u.values,c=0;c<f.length;c++){var h=String(f[c]);if("/"===h.charAt(0)&&"/"===h.charAt(h.length-1)){if(new RegExp(h.substr(1,h.length-2)).test(i))return!0}else if(i===f[c])return!0}return!1}},boolean:{coerceFunction:function(i,u,f){u.set(!0===i||!1===i?i:f)}},number:{coerceFunction:function(i,u,f,c){!g(i)||void 0!==c.min&&i<c.min||void 0!==c.max&&i>c.max?u.set(f):u.set(+i)}},integer:{coerceFunction:function(i,u,f,c){i%1||!g(i)||void 0!==c.min&&i<c.min||void 0!==c.max&&i>c.max?u.set(f):u.set(+i)}},string:{coerceFunction:function(i,u,f,c){u.set("string"!=typeof i?!0!==c.strict&&"number"==typeof i?String(i):f:c.noBlank&&!i?f:i)}},color:{coerceFunction:function(i,u,f){v(i).isValid()?u.set(i):u.set(f)}},colorlist:{coerceFunction:function(i,u,f){Array.isArray(i)&&i.length&&i.every(function(c){return v(c).isValid()})?u.set(i):u.set(f)}},colorscale:{coerceFunction:function(i,u,f){u.set(x.get(i,f))}},angle:{coerceFunction:function(i,u,f){"auto"===i?u.set("auto"):g(i)?u.set(r(+i,360)):u.set(f)}},subplotid:{coerceFunction:function(i,u,f,c){var h=c.regex||a(f);"string"==typeof i&&h.test(i)?u.set(i):u.set(f)},validateFunction:function(i,u){var f=u.dflt;return i===f||"string"==typeof i&&!!a(f).test(i)}},flaglist:{coerceFunction:function(i,u,f,c){if(-1===(c.extras||[]).indexOf(i))if("string"==typeof i){for(var h=i.split("+"),p=0;p<h.length;){var o=h[p];-1===c.flags.indexOf(o)||h.indexOf(o)<p?h.splice(p,1):p++}u.set(h.length?h.join("+"):f)}else u.set(f);else u.set(i)}},any:{coerceFunction:function(i,u,f){u.set(void 0===i?f:i)}},info_array:{coerceFunction:function(i,u,f,c){function h(E,z,R){var q;return void 0===R&&(R=z.dflt),Q.valObjectMeta[z.valType].coerceFunction(E,{set:function(W){q=W}},R,z),q}var p=2===c.dimensions||"1-2"===c.dimensions&&Array.isArray(i)&&Array.isArray(i[0]);if(Array.isArray(i)){var o,b,l,_,w,k=c.items,L=[],M=Array.isArray(k),I=M&&p&&Array.isArray(k[0]),P=p&&M&&!I,S=M&&!P?k.length:i.length;if(f=Array.isArray(f)?f:[],p)for(o=0;o<S;o++)for(L[o]=[],l=Array.isArray(i[o])?i[o]:[],_=P?k.length:M?k[o].length:l.length,b=0;b<_;b++)void 0!==(w=h(l[b],P?k[b]:M?k[o][b]:k,(f[o]||[])[b]))&&(L[o][b]=w);else for(o=0;o<S;o++)void 0!==(w=h(i[o],M?k[o]:k,f[o]))&&(L[o]=w);u.set(L)}else u.set(f)},validateFunction:function(i,u){if(!Array.isArray(i))return!1;var f=u.items,c=Array.isArray(f),h=2===u.dimensions;if(!u.freeLength&&i.length!==f.length)return!1;for(var p=0;p<i.length;p++)if(h){if(!Array.isArray(i[p])||!u.freeLength&&i[p].length!==f[p].length)return!1;for(var o=0;o<i[p].length;o++)if(!s(i[p][o],c?f[p][o]:f))return!1}else if(!s(i[p],c?f[p]:f))return!1;return!0}}},Q.coerce=function(i,u,f,c,h){var p=t(f,c).get(),o=t(i,c),b=t(u,c),l=o.get(),T=u._template;if(void 0===l&&T&&(l=t(T,c).get(),T=0),void 0===h&&(h=p.dflt),p.arrayOk&&d(l))return b.set(l),l;var _=Q.valObjectMeta[p.valType].coerceFunction;_(l,b,h,p);var w=b.get();return T&&w===h&&!s(l,p)&&(_(l=t(T,c).get(),b,h,p),w=b.get()),w},Q.coerce2=function(i,u,f,c,h){var p=t(i,c),o=Q.coerce(i,u,f,c,h);return null!=p.get()&&o},Q.coerceFont=function(i,u,f){var c={};return c.family=i(u+".family",(f=f||{}).family),c.size=i(u+".size",f.size),c.color=i(u+".color",f.color),c},Q.coercePattern=function(i,u,f,c){if(i(u+".shape")){i(u+".solidity"),i(u+".size");var h="overlay"===i(u+".fillmode");if(!c){var p=i(u+".bgcolor",h?f:void 0);i(u+".fgcolor",h?e.contrast(p):f)}i(u+".fgopacity",h?.5:1)}},Q.coerceHoverinfo=function(i,u,f){var c,h=u._module.attributes,p=h.hoverinfo?h:m,o=p.hoverinfo;if(1===f._dataLength){var b="all"===o.dflt?o.flags.slice():o.dflt.split("+");b.splice(b.indexOf("name"),1),c=b.join("+")}return Q.coerce(i,u,p,"hoverinfo",c)},Q.coerceSelectionMarkerOpacity=function(i,u){if(i.marker){var f,c,h=i.marker.opacity;void 0!==h&&(d(h)||i.selected||i.unselected||(f=h,c=n*h),u("selected.marker.opacity",f),u("unselected.marker.opacity",c))}},Q.validate=s},{"../components/color":367,"../components/colorscale/scales":382,"../constants/interactions":490,"../plots/attributes":562,"./array":497,"./mod":522,"./nested_property":523,"./regex":532,"fast-isnumeric":190,tinycolor2:313}],502:[function(y,ee,Q){"use strict";var g,v,m=y("d3-time-format").timeFormat,x=y("fast-isnumeric"),e=y("./loggers"),n=y("./mod").mod,t=y("../constants/numerical"),a=t.BADNUM,r=t.ONEDAY,d=t.ONEHOUR,s=t.ONEMIN,i=t.ONESEC,u=t.EPOCHJD,f=y("../registry"),c=y("d3-time-format").utcFormat,h=/^\s*(-?\d\d\d\d|\d\d)(-(\d?\d)(-(\d?\d)([ Tt]([01]?\d|2[0-3])(:([0-5]\d)(:([0-5]\d(\.\d+)?))?(Z|z|[+\-]\d\d(:?\d\d)?)?)?)?)?)?\s*$/m,p=/^\s*(-?\d\d\d\d|\d\d)(-(\d?\di?)(-(\d?\d)([ Tt]([01]?\d|2[0-3])(:([0-5]\d)(:([0-5]\d(\.\d+)?))?(Z|z|[+\-]\d\d(:?\d\d)?)?)?)?)?)?\s*$/m,o=(new Date).getFullYear()-70;function b(z){return z&&f.componentsRegistry.calendars&&"string"==typeof z&&"gregorian"!==z}function l(z,R){return String(z+Math.pow(10,R)).substr(1)}Q.dateTick0=function(z,R){var W,K,q=(K=!!R,b(W=z)?K?f.getComponentMethod("calendars","CANONICAL_SUNDAY")[W]:f.getComponentMethod("calendars","CANONICAL_TICK")[W]:K?"2000-01-02":"2000-01-01");if(R<2)return q;var V=Q.dateTime2ms(q,z);return Q.ms2DateTime(V+=r*(R-1),0,z)},Q.dfltRange=function(z){return b(z)?f.getComponentMethod("calendars","DFLTRANGE")[z]:["2000-01-01","2001-01-01"]},Q.isJSDate=function(z){return"object"==typeof z&&null!==z&&"function"==typeof z.getTime},Q.dateTime2ms=function(z,R){if(Q.isJSDate(z)){var q=z.getTimezoneOffset()*s,V=(z.getUTCMinutes()-z.getMinutes())*s+(z.getUTCSeconds()-z.getSeconds())*i+(z.getUTCMilliseconds()-z.getMilliseconds());if(V){var W=3*s;q=q-W/2+n(V-q+W/2,W)}return(z=Number(z)-q)>=g&&z<=v?z:a}if("string"!=typeof z&&"number"!=typeof z)return a;z=String(z);var K=b(R),G=z.charAt(0);!K||"G"!==G&&"g"!==G||(z=z.substr(1),R="");var Y=K&&"chinese"===R.substr(0,7),$=z.match(Y?p:h);if(!$)return a;var B=$[1],N=$[3]||"1",U=Number($[5]||1),te=Number($[7]||0),j=Number($[9]||0),J=Number($[11]||0);if(K){if(2===B.length)return a;var X;B=Number(B);try{var re=f.getComponentMethod("calendars","getCal")(R);if(Y){var ne="i"===N.charAt(N.length-1);N=parseInt(N,10),X=re.newDate(B,re.toMonthIndex(B,N,ne),U)}else X=re.newDate(B,Number(N),U)}catch{return a}return X?(X.toJD()-u)*r+te*d+j*s+J*i:a}B=2===B.length?(Number(B)+2e3-o)%100+o:Number(B),N-=1;var le=new Date(Date.UTC(2e3,N,U,te,j));return le.setUTCFullYear(B),le.getUTCMonth()!==N||le.getUTCDate()!==U?a:le.getTime()+J*i},g=Q.MIN_MS=Q.dateTime2ms("-9999"),v=Q.MAX_MS=Q.dateTime2ms("9999-12-31 23:59:59.9999"),Q.isDateTime=function(z,R){return Q.dateTime2ms(z,R)!==a};var T=90*r,_=3*d,w=5*s;function k(z,R,q,V,W){if((R||q||V||W)&&(z+=" "+l(R,2)+":"+l(q,2),(V||W)&&(z+=":"+l(V,2),W))){for(var K=4;W%10==0;)K-=1,W/=10;z+="."+l(W,K)}return z}Q.ms2DateTime=function(z,R,q){if("number"!=typeof z||!(z>=g&&z<=v))return a;R||(R=0);var V,W,K,G,Y,$,B=Math.floor(10*n(z+.05,1)),N=Math.round(z-B/10);if(b(q)){var U=Math.floor(N/r)+u,te=Math.floor(n(z,r));try{V=f.getComponentMethod("calendars","getCal")(q).fromJD(U).formatDate("yyyy-mm-dd")}catch{V=c("G%Y-%m-%d")(new Date(N))}if("-"===V.charAt(0))for(;V.length<11;)V="-0"+V.substr(1);else for(;V.length<10;)V="0"+V;W=R<T?Math.floor(te/d):0,K=R<T?Math.floor(te%d/s):0,G=R<_?Math.floor(te%s/i):0,Y=R<w?te%i*10+B:0}else $=new Date(N),V=c("%Y-%m-%d")($),W=R<T?$.getUTCHours():0,K=R<T?$.getUTCMinutes():0,G=R<_?$.getUTCSeconds():0,Y=R<w?10*$.getUTCMilliseconds()+B:0;return k(V,W,K,G,Y)},Q.ms2DateTimeLocal=function(z){if(!(z>=g+r&&z<=v-r))return a;var R=Math.floor(10*n(z+.05,1)),q=new Date(Math.round(z-R/10));return k(m("%Y-%m-%d")(q),q.getHours(),q.getMinutes(),q.getSeconds(),10*q.getUTCMilliseconds()+R)},Q.cleanDate=function(z,R,q){if(z===a)return R;if(Q.isJSDate(z)||"number"==typeof z&&isFinite(z)){if(b(q))return e.error("JS Dates and milliseconds are incompatible with world calendars",z),R;if(!(z=Q.ms2DateTimeLocal(+z))&&void 0!==R)return R}else if(!Q.isDateTime(z,q))return e.error("unrecognized date",z),R;return z};var L=/%\d?f/g,M=/%h/g,I={1:"1",2:"1",3:"2",4:"2"};function P(z,R,q,V){z=z.replace(L,function(K){var G=Math.min(+K.charAt(1)||6,6);return(R/1e3%1+2).toFixed(G).substr(2).replace(/0+$/,"")||"0"});var W=new Date(Math.floor(R+.05));if(z=z.replace(M,function(){return I[q("%q")(W)]}),b(V))try{z=f.getComponentMethod("calendars","worldCalFmt")(z,R,V)}catch{return"Invalid"}return q(z)(W)}var S=[59,59.9,59.99,59.999,59.9999];Q.formatDate=function(z,R,q,V,W,K){if(W=b(W)&&W,!R)if("y"===q)R=K.year;else if("m"===q)R=K.month;else{if("d"!==q)return function(G,Y){var $=n(G+.05,r),B=l(Math.floor($/d),2)+":"+l(n(Math.floor($/s),60),2);if("M"!==Y){x(Y)||(Y=0);var N=(100+Math.min(n(G/i,60),S[Y])).toFixed(Y).substr(1);Y>0&&(N=N.replace(/0+$/,"").replace(/[\.]$/,"")),B+=":"+N}return B}(z,q)+"\n"+P(K.dayMonthYear,z,V,W);R=K.dayMonth+"\n"+K.year}return P(R,z,V,W)};var E=3*r;Q.incrementMonth=function(z,R,q){q=b(q)&&q;var V=n(z,r);if(z=Math.round(z-V),q)try{var W=Math.round(z/r)+u,K=f.getComponentMethod("calendars","getCal")(q),G=K.fromJD(W);return R%12?K.add(G,R,"m"):K.add(G,R/12,"y"),(G.toJD()-u)*r+V}catch{e.error("invalid ms "+z+" in calendar "+q)}var Y=new Date(z+E);return Y.setUTCMonth(Y.getUTCMonth()+R)+V-E},Q.findExactDates=function(z,R){for(var q,V,W=0,K=0,G=0,Y=0,$=b(R)&&f.getComponentMethod("calendars","getCal")(R),B=0;B<z.length;B++)if(x(V=z[B])){if(!(V%r))if($)try{1===(q=$.fromJD(V/r+u)).day()?1===q.month()?W++:K++:G++}catch{}else 1===(q=new Date(V)).getUTCDate()?0===q.getUTCMonth()?W++:K++:G++}else Y++;G+=K+=W;var N=z.length-Y;return{exactYears:W/N,exactMonths:K/N,exactDays:G/N}}},{"../constants/numerical":491,"../registry":647,"./loggers":519,"./mod":522,"d3-time-format":120,"fast-isnumeric":190}],503:[function(y,ee,Q){"use strict";var g=y("@plotly/d3"),v=y("./loggers"),m=y("./matrix"),x=y("gl-mat4");function e(d){var s=d&&d.parentNode;s&&s.removeChild(d)}function n(d,s,i){var u="plotly.js-style-"+d,f=document.getElementById(u);f||((f=document.createElement("style")).setAttribute("id",u),f.appendChild(document.createTextNode("")),document.head.appendChild(f));var c=f.sheet;c.insertRule?c.insertRule(s+"{"+i+"}",0):c.addRule?c.addRule(s,i,0):v.warn("addStyleRule failed")}function t(d){var s=window.getComputedStyle(d,null),i=s.getPropertyValue("-webkit-transform")||s.getPropertyValue("-moz-transform")||s.getPropertyValue("-ms-transform")||s.getPropertyValue("-o-transform")||s.getPropertyValue("transform");return"none"===i?null:i.replace("matrix","").replace("3d","").slice(1,-1).split(",").map(function(u){return+u})}function a(d){for(var s=[];r(d);)s.push(d),d=d.parentNode;return s}function r(d){return d&&(d instanceof Element||d instanceof HTMLElement)}ee.exports={getGraphDiv:function(d){var s;if("string"==typeof d){if(null===(s=document.getElementById(d)))throw new Error("No DOM element with id '"+d+"' exists on the page.");return s}if(null==d)throw new Error("DOM element provided is null or undefined");return d},isPlotDiv:function(d){var s=g.select(d);return s.node()instanceof HTMLElement&&s.size()&&s.classed("js-plotly-plot")},removeElement:e,addStyleRule:function(d,s){n("global",d,s)},addRelatedStyleRule:n,deleteRelatedStyleRule:function(d){var i=document.getElementById("plotly.js-style-"+d);i&&e(i)},getFullTransformMatrix:function(d){var s=a(d),i=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];return s.forEach(function(u){var f=t(u);if(f){var c=m.convertCssMatrix(f);i=x.multiply(i,i,c)}}),i},getElementTransformMatrix:t,getElementAndAncestors:a,equalDomRects:function(d,s){return d&&s&&d.x===s.x&&d.y===s.y&&d.top===s.top&&d.left===s.left&&d.right===s.right&&d.bottom===s.bottom}}},{"./loggers":519,"./matrix":521,"@plotly/d3":58,"gl-mat4":210}],504:[function(y,ee,Q){"use strict";var g=y("events").EventEmitter;ee.exports={init:function(m){if(m._ev instanceof g)return m;var x=new g,e=new g;return m._ev=x,m._internalEv=e,m.on=x.on.bind(x),m.once=x.once.bind(x),m.removeListener=x.removeListener.bind(x),m.removeAllListeners=x.removeAllListeners.bind(x),m._internalOn=e.on.bind(e),m._internalOnce=e.once.bind(e),m._removeInternalListener=e.removeListener.bind(e),m._removeAllInternalListeners=e.removeAllListeners.bind(e),m.emit=function(n,t){typeof jQuery<"u"&&jQuery(m).trigger(n,t),x.emit(n,t),e.emit(n,t)},m},triggerHandler:function(m,x,e){var n,t;typeof jQuery<"u"&&(n=jQuery(m).triggerHandler(x,e));var a=m._ev;if(!a)return n;var r,d=a._events[x];if(!d)return n;function s(i){return i.listener?(a.removeListener(x,i.listener),i.fired?void 0:(i.fired=!0,i.listener.apply(a,[e]))):i.apply(a,[e])}for(d=Array.isArray(d)?d:[d],r=0;r<d.length-1;r++)s(d[r]);return t=s(d[r]),void 0!==n?n:t},purge:function(m){return delete m._ev,delete m.on,delete m.once,delete m.removeListener,delete m.removeAllListeners,delete m.emit,delete m._ev,delete m._internalEv,delete m._internalOn,delete m._internalOnce,delete m._removeInternalListener,delete m._removeAllInternalListeners,m}}},{events:84}],505:[function(y,ee,Q){"use strict";var g=y("./is_plain_object.js"),v=Array.isArray;function m(x,e,n,t){var a,r,d,s,i,u,f=x[0],c=x.length;if(2===c&&v(f)&&v(x[1])&&0===f.length){if(function(p,o){var b,l;for(b=0;b<p.length;b++){if(null!==(l=p[b])&&"object"==typeof l)return!1;void 0!==l&&(o[b]=l)}return!0}(x[1],f))return f;f.splice(0,f.length)}for(var h=1;h<c;h++)for(r in a=x[h])d=f[r],s=a[r],t&&v(s)?f[r]=s:e&&s&&(g(s)||(i=v(s)))?(i?(i=!1,u=d&&v(d)?d:[]):u=d&&g(d)?d:{},f[r]=m([u,s],e,n,t)):(void 0!==s||n)&&(f[r]=s);return f}Q.extendFlat=function(){return m(arguments,!1,!1,!1)},Q.extendDeep=function(){return m(arguments,!0,!1,!1)},Q.extendDeepAll=function(){return m(arguments,!0,!0,!1)},Q.extendDeepNoArrays=function(){return m(arguments,!0,!1,!0)}},{"./is_plain_object.js":516}],506:[function(y,ee,Q){"use strict";ee.exports=function(g){for(var v={},m=[],x=0,e=0;e<g.length;e++){var n=g[e];1!==v[n]&&(v[n]=1,m[x++]=n)}return m}},{}],507:[function(y,ee,Q){"use strict";function g(m){return!0===m.visible}function v(m){var x=m[0].trace;return!0===x.visible&&0!==x._length}ee.exports=function(m){for(var x,e=(x=m,Array.isArray(x)&&Array.isArray(x[0])&&x[0][0]&&x[0][0].trace?v:g),n=[],t=0;t<m.length;t++){var a=m[t];e(a)&&n.push(a)}return n}},{}],508:[function(y,ee,Q){"use strict";var g=y("@plotly/d3"),v=y("country-regex"),m=y("@turf/area"),x=y("@turf/centroid"),e=y("@turf/bbox"),n=y("./identity"),t=y("./loggers"),a=y("./is_plain_object"),r=y("./nested_property"),d=y("./polygon"),s=Object.keys(v),i={"ISO-3":n,"USA-states":n,"country names":function(f){for(var c=0;c<s.length;c++){var h=s[c];if(new RegExp(v[h]).test(f.trim().toLowerCase()))return h}return t.log("Unrecognized country name: "+f+"."),!1}};function u(f){var c=f.geojson,h=window.PlotlyGeoAssets||{},p="string"==typeof c?h[c]:c;return a(p)?p:(t.error("Oops ... something went wrong when fetching "+c),!1)}ee.exports={locationToFeature:function(f,c,h){if(!c||"string"!=typeof c)return!1;var p,o,b,l=i[f](c);if(l){if("USA-states"===f)for(p=[],b=0;b<h.length;b++)(o=h[b]).properties&&o.properties.gu&&"USA"===o.properties.gu&&p.push(o);else p=h;for(b=0;b<p.length;b++)if((o=p[b]).id===l)return o;t.log(["Location with id",l,"does not have a matching topojson feature at this resolution."].join(" "))}return!1},feature2polygons:function(f){var c,h,p,o,b=f.geometry,l=b.coordinates,T=f.id,_=[];function w(k){for(var L=0;L<k.length-1;L++)if(k[L][0]>0&&k[L+1][0]<0)return L;return null}switch(c="RUS"===T||"FJI"===T?function(k){var L;if(null===w(k))L=k;else for(L=new Array(k.length),o=0;o<k.length;o++)L[o]=[k[o][0]<0?k[o][0]+360:k[o][0],k[o][1]];_.push(d.tester(L))}:"ATA"===T?function(k){var L=w(k);if(null===L)return _.push(d.tester(k));var M=new Array(k.length+1),I=0;for(o=0;o<k.length;o++)o>L?M[I++]=[k[o][0]+360,k[o][1]]:o===L?(M[I++]=k[o],M[I++]=[k[o][0],-90]):M[I++]=k[o];var P=d.tester(M);P.pts.pop(),_.push(P)}:function(k){_.push(d.tester(k))},b.type){case"MultiPolygon":for(h=0;h<l.length;h++)for(p=0;p<l[h].length;p++)c(l[h][p]);break;case"Polygon":for(h=0;h<l.length;h++)c(l[h])}return _},getTraceGeojson:u,extractTraceFeature:function(f){var c=f[0].trace,h=u(c);if(!h)return!1;var p,o={},b=[];for(p=0;p<c._length;p++){var l=f[p];(l.loc||0===l.loc)&&(o[l.loc]=l)}function T(k){var L=r(k,c.featureidkey||"id").get(),M=o[L];if(M){var I=k.geometry;if("Polygon"===I.type||"MultiPolygon"===I.type){var P={type:"Feature",id:L,geometry:I,properties:{}};P.properties.ct=function(S){var E,z=S.geometry;if("MultiPolygon"===z.type)for(var R=z.coordinates,q=0,V=0;V<R.length;V++){var W={type:"Polygon",coordinates:R[V]},K=m.default(W);K>q&&(q=K,E=W)}else E=z;return x.default(E).geometry.coordinates}(P),M.fIn=k,M.fOut=P,b.push(P)}else t.log(["Location",M.loc,"does not have a valid GeoJSON geometry.","Traces with locationmode *geojson-id* only support","*Polygon* and *MultiPolygon* geometries."].join(" "))}delete o[L]}switch(h.type){case"FeatureCollection":var _=h.features;for(p=0;p<_.length;p++)T(_[p]);break;case"Feature":T(h);break;default:return t.warn(["Invalid GeoJSON type",(h.type||"none")+".","Traces with locationmode *geojson-id* only support","*FeatureCollection* and *Feature* types."].join(" ")),!1}for(var w in o)t.log(["Location *"+w+"*","does not have a matching feature with id-key","*"+c.featureidkey+"*."].join(" "));return b},fetchTraceGeoData:function(f){var c=window.PlotlyGeoAssets||{},h=[];function p(T){return new Promise(function(_,w){g.json(T,function(k,L){return k?(delete c[T],w(new Error(404===k.status?'GeoJSON at URL "'+T+'" does not exist.':"Unexpected error while fetching from "+T))):(c[T]=L,_(L))})})}function o(T){return new Promise(function(_,w){var k=0,L=setInterval(function(){return c[T]&&"pending"!==c[T]?(clearInterval(L),_(c[T])):k>100?(clearInterval(L),w("Unexpected error while fetching from "+T)):void k++},50)})}for(var b=0;b<f.length;b++){var l=f[b][0].trace.geojson;"string"==typeof l&&(c[l]?"pending"===c[l]&&h.push(o(l)):(c[l]="pending",h.push(p(l))))}return h},computeBbox:function(f){return e.default(f)}}},{"./identity":513,"./is_plain_object":516,"./loggers":519,"./nested_property":523,"./polygon":527,"@plotly/d3":58,"@turf/area":61,"@turf/bbox":64,"@turf/centroid":67,"country-regex":94}],509:[function(y,ee,Q){"use strict";var g=y("../constants/numerical").BADNUM;Q.calcTraceToLineCoords=function(v){for(var m=v[0].trace.connectgaps,x=[],e=[],n=0;n<v.length;n++){var t=v[n].lonlat;t[0]!==g?e.push(t):!m&&e.length>0&&(x.push(e),e=[])}return e.length>0&&x.push(e),x},Q.makeLine=function(v){return 1===v.length?{type:"LineString",coordinates:v[0]}:{type:"MultiLineString",coordinates:v}},Q.makePolygon=function(v){if(1===v.length)return{type:"Polygon",coordinates:v};for(var m=new Array(v.length),x=0;x<v.length;x++)m[x]=[v[x]];return{type:"MultiPolygon",coordinates:m}},Q.makeBlank=function(){return{type:"Point",coordinates:[]}}},{"../constants/numerical":491}],510:[function(y,ee,Q){"use strict";var g,v,m,x=y("./mod").mod;function e(t,a,r,d,s,i,u,f){var c=r-t,h=s-t,p=u-s,o=d-a,b=i-a,l=f-i,T=c*l-p*o;if(0===T)return null;var _=(h*l-p*b)/T,w=(h*o-c*b)/T;return w<0||w>1||_<0||_>1?null:{x:t+c*_,y:a+o*_}}function n(t,a,r,d,s){var i=d*t+s*a;if(i<0)return d*d+s*s;if(i>r){var u=d-t,f=s-a;return u*u+f*f}var c=d*a-s*t;return c*c/r}Q.segmentsIntersect=e,Q.segmentDistance=function(t,a,r,d,s,i,u,f){if(e(t,a,r,d,s,i,u,f))return 0;var c=r-t,h=d-a,p=u-s,o=f-i,b=c*c+h*h,l=p*p+o*o,T=Math.min(n(c,h,b,s-t,i-a),n(c,h,b,u-t,f-a),n(p,o,l,t-s,a-i),n(p,o,l,r-s,d-i));return Math.sqrt(T)},Q.getTextLocation=function(t,a,r,d){if(t===v&&d===m||(g={},v=t,m=d),g[r])return g[r];var s=t.getPointAtLength(x(r-d/2,a)),i=t.getPointAtLength(x(r+d/2,a)),u=Math.atan((i.y-s.y)/(i.x-s.x)),f=t.getPointAtLength(x(r,a)),c={x:(4*f.x+s.x+i.x)/6,y:(4*f.y+s.y+i.y)/6,theta:u};return g[r]=c,c},Q.clearLocationCache=function(){v=null},Q.getVisibleSegment=function(t,a,r){var d,s,i=a.left,u=a.right,f=a.top,c=a.bottom,h=0,p=t.getTotalLength(),o=p;function b(T){var _=t.getPointAtLength(T);0===T?d=_:T===p&&(s=_);var w=_.x<i?i-_.x:_.x>u?_.x-u:0,k=_.y<f?f-_.y:_.y>c?_.y-c:0;return Math.sqrt(w*w+k*k)}for(var l=b(h);l;){if((h+=l+r)>o)return;l=b(h)}for(l=b(o);l;){if(h>(o-=l+r))return;l=b(o)}return{min:h,max:o,len:o-h,total:p,isClosed:0===h&&o===p&&Math.abs(d.x-s.x)<.1&&Math.abs(d.y-s.y)<.1}},Q.findPointOnPath=function(t,a,r,d){for(var s,i,u,f=(d=d||{}).pathLength||t.getTotalLength(),c=d.tolerance||.001,h=d.iterationLimit||30,p=t.getPointAtLength(0)[r]>t.getPointAtLength(f)[r]?-1:1,o=0,b=0,l=f;o<h;){if(u=(i=t.getPointAtLength(s=(b+l)/2))[r]-a,Math.abs(u)<c)return i;p*u>0?l=s:b=s,o++}return i}},{"./mod":522}],511:[function(y,ee,Q){"use strict";var g=y("fast-isnumeric"),v=y("tinycolor2"),m=y("color-normalize"),x=y("../components/colorscale"),e=y("../components/color/attributes").defaultLine,n=y("./array").isArrayOrTypedArray,t=m(e);function a(s,i){var u=s;return u[3]*=i,u}function r(s){if(g(s))return t;var i=m(s);return i.length?i:t}function d(s){return g(s)?s:1}ee.exports={formatColor:function(s,i,u){var f,c,h,p,o,b=s.color,l=n(b),T=n(i),_=x.extractOpts(s),w=[];if(f=void 0!==_.colorscale?x.makeColorScaleFuncFromTrace(s):r,c=l?function(L,M){return void 0===L[M]?t:m(f(L[M]))}:r,h=T?function(L,M){return void 0===L[M]?1:d(L[M])}:d,l||T)for(var k=0;k<u;k++)p=c(b,k),o=h(i,k),w[k]=a(p,o);else w=a(m(b),i);return w},parseColorScale:function(s){var i=x.extractOpts(s),u=i.colorscale;return i.reversescale&&(u=x.flipScale(i.colorscale)),u.map(function(f){var c=f[0],h=v(f[1]).toRgb();return{index:c,rgb:[h.r,h.g,h.b,h.a]}})}}},{"../components/color/attributes":366,"../components/colorscale":379,"./array":497,"color-normalize":89,"fast-isnumeric":190,tinycolor2:313}],512:[function(y,ee,Q){"use strict";var g=y("./identity");function v(m){return[m]}ee.exports={keyFun:function(m){return m.key},repeat:v,descend:g,wrap:v,unwrap:function(m){return m[0]}}},{"./identity":513}],513:[function(y,ee,Q){"use strict";ee.exports=function(g){return g}},{}],514:[function(y,ee,Q){"use strict";ee.exports=function(g,v){if(!v)return g;var m=1/Math.abs(v),x=m>1?(m*g+m*v)/m:g+v,e=String(x).length;if(e>16){var n=String(v).length;if(e>=String(g).length+n){var t=parseFloat(x).toPrecision(12);-1===t.indexOf("e+")&&(x=+t)}}return x}},{}],515:[function(y,ee,Q){"use strict";var g=y("@plotly/d3"),v=y("d3-time-format").utcFormat,m=y("d3-format").format,x=y("fast-isnumeric"),e=y("../constants/numerical"),n=e.FP_SAFE,t=-n,a=e.BADNUM,r=ee.exports={};r.adjustFormat=function(B){return!B||/^\d[.]\df/.test(B)||/[.]\d%/.test(B)?B:"0.f"===B?"~f":/^\d%/.test(B)?"~%":/^\ds/.test(B)?"~s":!/^[~,.0$]/.test(B)&&/[&fps]/.test(B)?"~"+B:B};var d={};r.warnBadFormat=function(B){var N=String(B);d[N]||(d[N]=1,r.warn('encountered bad format: "'+N+'"'))},r.noFormat=function(B){return String(B)},r.numberFormat=function(B){var N;try{N=m(r.adjustFormat(B))}catch{return r.warnBadFormat(B),r.noFormat}return N},r.nestedProperty=y("./nested_property"),r.keyedContainer=y("./keyed_container"),r.relativeAttr=y("./relative_attr"),r.isPlainObject=y("./is_plain_object"),r.toLogRange=y("./to_log_range"),r.relinkPrivateKeys=y("./relink_private");var s=y("./array");r.isTypedArray=s.isTypedArray,r.isArrayOrTypedArray=s.isArrayOrTypedArray,r.isArray1D=s.isArray1D,r.ensureArray=s.ensureArray,r.concat=s.concat,r.maxRowLength=s.maxRowLength,r.minRowLength=s.minRowLength;var i=y("./mod");r.mod=i.mod,r.modHalf=i.modHalf;var u=y("./coerce");r.valObjectMeta=u.valObjectMeta,r.coerce=u.coerce,r.coerce2=u.coerce2,r.coerceFont=u.coerceFont,r.coercePattern=u.coercePattern,r.coerceHoverinfo=u.coerceHoverinfo,r.coerceSelectionMarkerOpacity=u.coerceSelectionMarkerOpacity,r.validate=u.validate;var f=y("./dates");r.dateTime2ms=f.dateTime2ms,r.isDateTime=f.isDateTime,r.ms2DateTime=f.ms2DateTime,r.ms2DateTimeLocal=f.ms2DateTimeLocal,r.cleanDate=f.cleanDate,r.isJSDate=f.isJSDate,r.formatDate=f.formatDate,r.incrementMonth=f.incrementMonth,r.dateTick0=f.dateTick0,r.dfltRange=f.dfltRange,r.findExactDates=f.findExactDates,r.MIN_MS=f.MIN_MS,r.MAX_MS=f.MAX_MS;var c=y("./search");r.findBin=c.findBin,r.sorterAsc=c.sorterAsc,r.sorterDes=c.sorterDes,r.distinctVals=c.distinctVals,r.roundUp=c.roundUp,r.sort=c.sort,r.findIndexOfMin=c.findIndexOfMin,r.sortObjectKeys=y("./sort_object_keys");var h=y("./stats");r.aggNums=h.aggNums,r.len=h.len,r.mean=h.mean,r.median=h.median,r.midRange=h.midRange,r.variance=h.variance,r.stdev=h.stdev,r.interp=h.interp;var p=y("./matrix");r.init2dArray=p.init2dArray,r.transposeRagged=p.transposeRagged,r.dot=p.dot,r.translationMatrix=p.translationMatrix,r.rotationMatrix=p.rotationMatrix,r.rotationXYMatrix=p.rotationXYMatrix,r.apply3DTransform=p.apply3DTransform,r.apply2DTransform=p.apply2DTransform,r.apply2DTransform2=p.apply2DTransform2,r.convertCssMatrix=p.convertCssMatrix,r.inverseTransformMatrix=p.inverseTransformMatrix;var o=y("./angles");r.deg2rad=o.deg2rad,r.rad2deg=o.rad2deg,r.angleDelta=o.angleDelta,r.angleDist=o.angleDist,r.isFullCircle=o.isFullCircle,r.isAngleInsideSector=o.isAngleInsideSector,r.isPtInsideSector=o.isPtInsideSector,r.pathArc=o.pathArc,r.pathSector=o.pathSector,r.pathAnnulus=o.pathAnnulus;var b=y("./anchor_utils");r.isLeftAnchor=b.isLeftAnchor,r.isCenterAnchor=b.isCenterAnchor,r.isRightAnchor=b.isRightAnchor,r.isTopAnchor=b.isTopAnchor,r.isMiddleAnchor=b.isMiddleAnchor,r.isBottomAnchor=b.isBottomAnchor;var l=y("./geometry2d");r.segmentsIntersect=l.segmentsIntersect,r.segmentDistance=l.segmentDistance,r.getTextLocation=l.getTextLocation,r.clearLocationCache=l.clearLocationCache,r.getVisibleSegment=l.getVisibleSegment,r.findPointOnPath=l.findPointOnPath;var T=y("./extend");r.extendFlat=T.extendFlat,r.extendDeep=T.extendDeep,r.extendDeepAll=T.extendDeepAll,r.extendDeepNoArrays=T.extendDeepNoArrays;var _=y("./loggers");r.log=_.log,r.warn=_.warn,r.error=_.error;var w=y("./regex");r.counterRegex=w.counter;var k=y("./throttle");r.throttle=k.throttle,r.throttleDone=k.done,r.clearThrottle=k.clear;var L=y("./dom");function M(B){var N={};for(var U in B)for(var te=B[U],j=0;j<te.length;j++)N[te[j]]=+U;return N}r.getGraphDiv=L.getGraphDiv,r.isPlotDiv=L.isPlotDiv,r.removeElement=L.removeElement,r.addStyleRule=L.addStyleRule,r.addRelatedStyleRule=L.addRelatedStyleRule,r.deleteRelatedStyleRule=L.deleteRelatedStyleRule,r.getFullTransformMatrix=L.getFullTransformMatrix,r.getElementTransformMatrix=L.getElementTransformMatrix,r.getElementAndAncestors=L.getElementAndAncestors,r.equalDomRects=L.equalDomRects,r.clearResponsive=y("./clear_responsive"),r.preserveDrawingBuffer=y("./preserve_drawing_buffer"),r.makeTraceGroups=y("./make_trace_groups"),r._=y("./localize"),r.notifier=y("./notifier"),r.filterUnique=y("./filter_unique"),r.filterVisible=y("./filter_visible"),r.pushUnique=y("./push_unique"),r.increment=y("./increment"),r.cleanNumber=y("./clean_number"),r.ensureNumber=function(B){return x(B)?(B=Number(B))>n||B<t?a:B:a},r.isIndex=function(B,N){return!(void 0!==N&&B>=N)&&x(B)&&B>=0&&B%1==0},r.noop=y("./noop"),r.identity=y("./identity"),r.repeat=function(B,N){for(var U=new Array(N),te=0;te<N;te++)U[te]=B;return U},r.swapAttrs=function(B,N,U,te){U||(U="x"),te||(te="y");for(var j=0;j<N.length;j++){var J=N[j],X=r.nestedProperty(B,J.replace("?",U)),re=r.nestedProperty(B,J.replace("?",te)),ne=X.get();X.set(re.get()),re.set(ne)}},r.raiseToTop=function(B){B.parentNode.appendChild(B)},r.cancelTransition=function(B){return B.transition().duration(0)},r.constrain=function(B,N,U){return N>U?Math.max(U,Math.min(N,B)):Math.max(N,Math.min(U,B))},r.bBoxIntersect=function(B,N,U){return B.left<=N.right+(U=U||0)&&N.left<=B.right+U&&B.top<=N.bottom+U&&N.top<=B.bottom+U},r.simpleMap=function(B,N,U,te,j){for(var J=B.length,X=new Array(J),re=0;re<J;re++)X[re]=N(B[re],U,te,j);return X},r.randstr=function B(N,U,te,j){if(te||(te=16),void 0===U&&(U=24),U<=0)return"0";var J,X,re=Math.log(Math.pow(2,U))/Math.log(te),ne="";for(J=2;re===1/0;J*=2)re=Math.log(Math.pow(2,U/J))/Math.log(te)*J;var le=re-Math.floor(re);for(J=0;J<Math.floor(re);J++)ne=Math.floor(Math.random()*te).toString(te)+ne;le&&(X=Math.pow(te,le),ne=Math.floor(Math.random()*X).toString(te)+ne);var oe=parseInt(ne,te);return N&&N[ne]||oe!==1/0&&oe>=Math.pow(2,U)?j>10?(r.warn("randstr failed uniqueness"),ne):B(N,U,te,(j||0)+1):ne},r.OptionControl=function(B,N){B||(B={}),N||(N="opt");var U={optionList:[],_newoption:function(te){te[N]=B,U[te.name]=te,U.optionList.push(te)}};return U["_"+N]=B,U},r.smooth=function(B,N){if((N=Math.round(N)||0)<2)return B;var U,te,j,J,X=B.length,re=2*X,ne=2*N-1,le=new Array(ne),oe=new Array(X);for(U=0;U<ne;U++)le[U]=(1-Math.cos(Math.PI*(U+1)/N))/(2*N);for(U=0;U<X;U++){for(J=0,te=0;te<ne;te++)(j=U+te+1-N)<-X?j-=re*Math.round(j/re):j>=re&&(j-=re*Math.floor(j/re)),j<0?j=-1-j:j>=X&&(j=re-1-j),J+=B[j]*le[te];oe[U]=J}return oe},r.syncOrAsync=function(B,N,U){var te;function j(){return r.syncOrAsync(B,N,U)}for(;B.length;)if((te=(0,B.splice(0,1)[0])(N))&&te.then)return te.then(j);return U&&U(N)},r.stripTrailingSlash=function(B){return"/"===B.substr(-1)?B.substr(0,B.length-1):B},r.noneOrAll=function(B,N,U){if(B){var te,j=!1,J=!0;for(te=0;te<U.length;te++)null!=B[U[te]]?j=!0:J=!1;if(j&&!J)for(te=0;te<U.length;te++)B[U[te]]=N[U[te]]}},r.mergeArray=function(B,N,U,te){var j="function"==typeof te;if(r.isArrayOrTypedArray(B))for(var J=Math.min(B.length,N.length),X=0;X<J;X++){var re=B[X];N[X][U]=j?te(re):re}},r.mergeArrayCastPositive=function(B,N,U){return r.mergeArray(B,N,U,function(te){var j=+te;return isFinite(j)&&j>0?j:0})},r.fillArray=function(B,N,U,te){if(te=te||r.identity,r.isArrayOrTypedArray(B))for(var j=0;j<N.length;j++)N[j][U]=te(B[j])},r.castOption=function(B,N,U,te){te=te||r.identity;var j=r.nestedProperty(B,U).get();return r.isArrayOrTypedArray(j)?Array.isArray(N)&&r.isArrayOrTypedArray(j[N[0]])?te(j[N[0]][N[1]]):te(j[N]):j},r.extractOption=function(B,N,U,te){if(U in B)return B[U];var j=r.nestedProperty(N,te).get();return Array.isArray(j)?void 0:j},r.tagSelected=function(B,N,U){var te,j,J=N.selectedpoints,X=N._indexToPoints;X&&(te=M(X));for(var re=0;re<J.length;re++){var ne=J[re];if(r.isIndex(ne)||r.isArrayOrTypedArray(ne)&&r.isIndex(ne[0])&&r.isIndex(ne[1])){var le=te?te[ne]:ne,oe=U?U[le]:le;void 0!==(j=oe)&&j<B.length&&(B[oe].selected=1)}}},r.selIndices2selPoints=function(B){var N=B.selectedpoints,U=B._indexToPoints;if(U){for(var te=M(U),j=[],J=0;J<N.length;J++){var X=N[J];if(r.isIndex(X)){var re=te[X];r.isIndex(re)&&j.push(re)}}return j}return N},r.getTargetArray=function(B,N){var U=N.target;if("string"==typeof U&&U){var te=r.nestedProperty(B,U).get();return!!Array.isArray(te)&&te}return!!Array.isArray(U)&&U},r.minExtend=function(B,N){var U={};"object"!=typeof N&&(N={});var te,j,J,X=Object.keys(B);for(te=0;te<X.length;te++)J=B[j=X[te]],"_"!==j.charAt(0)&&"function"!=typeof J&&(U[j]="module"===j?J:Array.isArray(J)?"colorscale"===j?J.slice():J.slice(0,3):r.isTypedArray(J)?J.subarray(0,3):J&&"object"==typeof J?r.minExtend(B[j],N[j]):J);for(X=Object.keys(N),te=0;te<X.length;te++)"object"==typeof(J=N[j=X[te]])&&j in U&&"object"==typeof U[j]||(U[j]=J);return U},r.titleCase=function(B){return B.charAt(0).toUpperCase()+B.substr(1)},r.containsAny=function(B,N){for(var U=0;U<N.length;U++)if(-1!==B.indexOf(N[U]))return!0;return!1},r.isIE=function(){return void 0!==window.navigator.msSaveBlob};var I=/Version\/[\d\.]+.*Safari/;r.isSafari=function(){return I.test(window.navigator.userAgent)};var P=/iPad|iPhone|iPod/;r.isIOS=function(){return P.test(window.navigator.userAgent)};var S=/Firefox\/(\d+)\.\d+/;r.getFirefoxVersion=function(){var B=S.exec(window.navigator.userAgent);if(B&&2===B.length){var N=parseInt(B[1]);if(!isNaN(N))return N}return null},r.isD3Selection=function(B){return B instanceof g.selection},r.ensureSingle=function(B,N,U,te){var j=B.select(N+(U?"."+U:""));if(j.size())return j;var J=B.append(N);return U&&J.classed(U,!0),te&&J.call(te),J},r.ensureSingleById=function(B,N,U,te){var j=B.select(N+"#"+U);if(j.size())return j;var J=B.append(N).attr("id",U);return te&&J.call(te),J},r.objectFromPath=function(B,N){for(var U,te=B.split("."),j=U={},J=0;J<te.length;J++){var X=te[J],re=null,ne=te[J].match(/(.*)\[([0-9]+)\]/);ne?(re=ne[2],(U=U[X=ne[1]]=[])[re]=J===te.length-1?N:{},U=U[re]):(U[X]=J===te.length-1?N:{},U=U[X])}return j};var E=/^([^\[\.]+)\.(.+)?/,z=/^([^\.]+)\[([0-9]+)\](\.)?(.+)?/;r.expandObjectPaths=function(B){var N,U,te,j,J,X,re;if("object"==typeof B&&!Array.isArray(B))for(U in B)B.hasOwnProperty(U)&&((N=U.match(E))?(j=B[U],te=N[1],delete B[U],B[te]=r.extendDeepNoArrays(B[te]||{},r.objectFromPath(U,r.expandObjectPaths(j))[te])):(N=U.match(z))?(j=B[U],te=N[1],J=parseInt(N[2]),delete B[U],B[te]=B[te]||[],"."===N[3]?(re=N[4],X=B[te][J]=B[te][J]||{},r.extendDeepNoArrays(X,r.objectFromPath(re,r.expandObjectPaths(j)))):B[te][J]=r.expandObjectPaths(j)):B[U]=r.expandObjectPaths(B[U]));return B},r.numSeparate=function(B,N,U){if(U||(U=!1),"string"!=typeof N||0===N.length)throw new Error("Separator string required for formatting!");"number"==typeof B&&(B=String(B));var te=/(\d+)(\d{3})/,j=N.charAt(0),J=N.charAt(1),X=B.split("."),re=X[0],ne=X.length>1?j+X[1]:"";if(J&&(X.length>1||re.length>4||U))for(;te.test(re);)re=re.replace(te,"$1"+J+"$2");return re+ne},r.TEMPLATE_STRING_REGEX=/%{([^\s%{}:]*)([:|\|][^}]*)?}/g;var R=/^\w*$/;r.templateString=function(B,N){var U={};return B.replace(r.TEMPLATE_STRING_REGEX,function(te,j){var J;return R.test(j)?J=N[j]:(U[j]=U[j]||r.nestedProperty(N,j).get,J=U[j]()),r.isValidTextValue(J)?J:""})};var q={max:10,count:0,name:"hovertemplate"};r.hovertemplateString=function(){return K.apply(q,arguments)};var V={max:10,count:0,name:"texttemplate"};r.texttemplateString=function(){return K.apply(V,arguments)};var W=/^[:|\|]/;function K(B,N,U){var te=this,j=arguments;N||(N={});var J={};return B.replace(r.TEMPLATE_STRING_REGEX,function(X,re,ne){var le,oe,de,se="_xother"===re||"_yother"===re,ge="_xother_"===re||"_yother_"===re,_e="xother_"===re||"yother_"===re,Te="xother"===re||"yother"===re||se||_e||ge,we=re;if((se||ge)&&(we=we.substring(1)),(_e||ge)&&(we=we.substring(0,we.length-1)),Te){if(void 0===(le=N[we]))return""}else for(de=3;de<j.length;de++)if(oe=j[de]){if(oe.hasOwnProperty(we)){le=oe[we];break}if(R.test(we)||(le=r.nestedProperty(oe,we).get(),(le=J[we]||r.nestedProperty(oe,we).get())&&(J[we]=le)),void 0!==le)break}if(void 0===le&&te)return te.count<te.max&&(r.warn("Variable '"+we+"' in "+te.name+" could not be found!"),le=X),te.count===te.max&&r.warn("Too many "+te.name+" warnings - additional warnings will be suppressed"),te.count++,X;if(ne){var Oe;if(":"===ne[0]&&(le=(Oe=U?U.numberFormat:r.numberFormat)(ne.replace(W,""))(le)),"|"===ne[0]){Oe=U?U.timeFormat:v;var fe=r.dateTime2ms(le);le=r.formatDate(fe,ne.replace(W,""),!1,Oe)}}else{var ve=we+"Label";N.hasOwnProperty(ve)&&(le=N[ve])}return Te&&(le="("+le+")",(se||ge)&&(le=" "+le),(_e||ge)&&(le+=" ")),le})}r.subplotSort=function(B,N){for(var U=Math.min(B.length,N.length)+1,te=0,j=0,J=0;J<U;J++){var X=B.charCodeAt(J)||0,re=N.charCodeAt(J)||0,ne=X>=48&&X<=57,le=re>=48&&re<=57;if(ne&&(te=10*te+X-48),le&&(j=10*j+re-48),!ne||!le){if(te!==j)return te-j;if(X!==re)return X-re}}return j-te};var G=2e9;r.seedPseudoRandom=function(){G=2e9},r.pseudoRandom=function(){var B=G;return G=(69069*G+1)%4294967296,Math.abs(G-B)<429496729?r.pseudoRandom():G/4294967296},r.fillText=function(B,N,U){var te=Array.isArray(U)?function(X){U.push(X)}:function(X){U.text=X},j=r.extractOption(B,N,"htx","hovertext");if(r.isValidTextValue(j))return te(j);var J=r.extractOption(B,N,"tx","text");return r.isValidTextValue(J)?te(J):void 0},r.isValidTextValue=function(B){return B||0===B},r.formatPercent=function(B,N){N=N||0;for(var U=(Math.round(100*B*Math.pow(10,N))*Math.pow(.1,N)).toFixed(N)+"%",te=0;te<N;te++)-1!==U.indexOf(".")&&(U=(U=U.replace("0%","%")).replace(".%","%"));return U},r.isHidden=function(B){var N=window.getComputedStyle(B).display;return!N||"none"===N},r.strTranslate=function(B,N){return B||N?"translate("+B+","+N+")":""},r.strRotate=function(B){return B?"rotate("+B+")":""},r.strScale=function(B){return 1!==B?"scale("+B+")":""},r.getTextTransform=function(B){var N=B.noCenter,U=B.textX,te=B.textY,ne=B.rotate,le=B.scale;return le?le>1&&(le=1):le=0,r.strTranslate(B.targetX-le*(U+(B.anchorX||0)),B.targetY-le*(te+(B.anchorY||0)))+r.strScale(le)+(ne?"rotate("+ne+(N?"":" "+U+" "+te)+")":"")},r.ensureUniformFontSize=function(B,N){var U=r.extendFlat({},N);return U.size=Math.max(N.size,B._fullLayout.uniformtext.minsize||0),U},r.join2=function(B,N,U){var te=B.length;return te>1?B.slice(0,-1).join(N)+U+B[te-1]:B.join(N)},r.bigFont=function(B){return Math.round(1.2*B)};var Y=r.getFirefoxVersion(),$=null!==Y&&Y<86;r.getPositionFromD3Event=function(){return $?[g.event.layerX,g.event.layerY]:[g.event.offsetX,g.event.offsetY]}},{"../constants/numerical":491,"./anchor_utils":495,"./angles":496,"./array":497,"./clean_number":498,"./clear_responsive":500,"./coerce":501,"./dates":502,"./dom":503,"./extend":505,"./filter_unique":506,"./filter_visible":507,"./geometry2d":510,"./identity":513,"./increment":514,"./is_plain_object":516,"./keyed_container":517,"./localize":518,"./loggers":519,"./make_trace_groups":520,"./matrix":521,"./mod":522,"./nested_property":523,"./noop":524,"./notifier":525,"./preserve_drawing_buffer":529,"./push_unique":530,"./regex":532,"./relative_attr":533,"./relink_private":534,"./search":535,"./sort_object_keys":538,"./stats":539,"./throttle":542,"./to_log_range":543,"@plotly/d3":58,"d3-format":112,"d3-time-format":120,"fast-isnumeric":190}],516:[function(y,ee,Q){"use strict";ee.exports=function(g){return window&&window.process&&window.process.versions?"[object Object]"===Object.prototype.toString.call(g):"[object Object]"===Object.prototype.toString.call(g)&&Object.getPrototypeOf(g).hasOwnProperty("hasOwnProperty")}},{}],517:[function(y,ee,Q){"use strict";var g=y("./nested_property"),v=/^\w*$/;ee.exports=function(m,x,e,n){var t,a,r;e=e||"name",n=n||"value";var d={};x&&x.length?(r=g(m,x),a=r.get()):a=m,x=x||"";var s={};if(a)for(t=0;t<a.length;t++)s[a[t][e]]=t;var i=v.test(n),u={set:function(f,c){var h=null===c?4:0;if(!a){if(!r||4===h)return;r.set(a=[])}var p=s[f];if(void 0===p){if(4===h)return;h|=3,s[f]=p=a.length}else c!==(i?a[p][n]:g(a[p],n).get())&&(h|=2);var o=a[p]=a[p]||{};return o[e]=f,i?o[n]=c:g(o,n).set(c),null!==c&&(h&=-5),d[p]=d[p]|h,u},get:function(f){if(a){var c=s[f];return void 0===c?void 0:i?a[c][n]:g(a[c],n).get()}},rename:function(f,c){var h=s[f];return void 0===h||(d[h]=1|d[h],s[c]=h,delete s[f],a[h][e]=c),u},remove:function(f){var c=s[f];if(void 0===c)return u;var h=a[c];if(Object.keys(h).length>2)return d[c]=2|d[c],u.set(f,null);if(i){for(t=c;t<a.length;t++)d[t]=3|d[t];for(t=c;t<a.length;t++)s[a[t][e]]--;a.splice(c,1),delete s[f]}else g(h,n).set(null),d[c]=6|d[c];return u},constructUpdate:function(){for(var f,c,h={},p=Object.keys(d),o=0;o<p.length;o++)f=x+"["+(c=p[o])+"]",a[c]?(1&d[c]&&(h[f+"."+e]=a[c][e]),2&d[c]&&(h[f+"."+n]=i?4&d[c]?null:a[c][n]:4&d[c]?null:g(a[c],n).get())):h[f]=null;return h}};return u}},{"./nested_property":523}],518:[function(y,ee,Q){"use strict";var g=y("../registry");ee.exports=function(v,m){for(var x=v._context.locale,e=0;e<2;e++){for(var n=v._context.locales,t=0;t<2;t++){var a=(n[x]||{}).dictionary;if(a){var r=a[m];if(r)return r}n=g.localeRegistry}var d=x.split("-")[0];if(d===x)break;x=d}return m}},{"../registry":647}],519:[function(y,ee,Q){"use strict";var g=y("../plot_api/plot_config").dfltConfig,v=y("./notifier"),m=ee.exports={};m.log=function(){var x;if(g.logging>1){var e=["LOG:"];for(x=0;x<arguments.length;x++)e.push(arguments[x]);console.trace.apply(console,e)}if(g.notifyOnLogging>1){var n=[];for(x=0;x<arguments.length;x++)n.push(arguments[x]);v(n.join("<br>"),"long")}},m.warn=function(){var x;if(g.logging>0){var e=["WARN:"];for(x=0;x<arguments.length;x++)e.push(arguments[x]);console.trace.apply(console,e)}if(g.notifyOnLogging>0){var n=[];for(x=0;x<arguments.length;x++)n.push(arguments[x]);v(n.join("<br>"),"stick")}},m.error=function(){var x;if(g.logging>0){var e=["ERROR:"];for(x=0;x<arguments.length;x++)e.push(arguments[x]);console.error.apply(console,e)}if(g.notifyOnLogging>0){var n=[];for(x=0;x<arguments.length;x++)n.push(arguments[x]);v(n.join("<br>"),"stick")}}},{"../plot_api/plot_config":553,"./notifier":525}],520:[function(y,ee,Q){"use strict";var g=y("@plotly/d3");ee.exports=function(v,m,x){var e=v.selectAll("g."+x.replace(/\s/g,".")).data(m,function(t){return t[0].trace.uid});e.exit().remove(),e.enter().append("g").attr("class",x),e.order();var n=v.classed("rangeplot")?"nodeRangePlot3":"node3";return e.each(function(t){t[0][n]=g.select(this)}),e}},{"@plotly/d3":58}],521:[function(y,ee,Q){"use strict";var g=y("gl-mat4");Q.init2dArray=function(v,m){for(var x=new Array(v),e=0;e<v;e++)x[e]=new Array(m);return x},Q.transposeRagged=function(v){var m,x,e=0,n=v.length;for(m=0;m<n;m++)e=Math.max(e,v[m].length);var t=new Array(e);for(m=0;m<e;m++)for(t[m]=new Array(n),x=0;x<n;x++)t[m][x]=v[x][m];return t},Q.dot=function(v,m){if(!v.length||!m.length||v.length!==m.length)return null;var x,e,n=v.length;if(v[0].length)for(x=new Array(n),e=0;e<n;e++)x[e]=Q.dot(v[e],m);else if(m[0].length){var t=Q.transposeRagged(m);for(x=new Array(t.length),e=0;e<t.length;e++)x[e]=Q.dot(v,t[e])}else for(x=0,e=0;e<n;e++)x+=v[e]*m[e];return x},Q.translationMatrix=function(v,m){return[[1,0,v],[0,1,m],[0,0,1]]},Q.rotationMatrix=function(v){var m=v*Math.PI/180;return[[Math.cos(m),-Math.sin(m),0],[Math.sin(m),Math.cos(m),0],[0,0,1]]},Q.rotationXYMatrix=function(v,m,x){return Q.dot(Q.dot(Q.translationMatrix(m,x),Q.rotationMatrix(v)),Q.translationMatrix(-m,-x))},Q.apply3DTransform=function(v){return function(){var m=arguments,x=1===arguments.length?m[0]:[m[0],m[1],m[2]||0];return Q.dot(v,[x[0],x[1],x[2],1]).slice(0,3)}},Q.apply2DTransform=function(v){return function(){var m=arguments;3===m.length&&(m=m[0]);var x=1===arguments.length?m[0]:[m[0],m[1]];return Q.dot(v,[x[0],x[1],1]).slice(0,2)}},Q.apply2DTransform2=function(v){var m=Q.apply2DTransform(v);return function(x){return m(x.slice(0,2)).concat(m(x.slice(2,4)))}},Q.convertCssMatrix=function(v){if(v){var m=v.length;if(16===m)return v;if(6===m)return[v[0],v[1],0,0,v[2],v[3],0,0,0,0,1,0,v[4],v[5],0,1]}return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]},Q.inverseTransformMatrix=function(v){var m=[];return g.invert(m,v),[[m[0],m[1],m[2],m[3]],[m[4],m[5],m[6],m[7]],[m[8],m[9],m[10],m[11]],[m[12],m[13],m[14],m[15]]]}},{"gl-mat4":210}],522:[function(y,ee,Q){"use strict";ee.exports={mod:function(g,v){var m=g%v;return m<0?m+v:m},modHalf:function(g,v){return Math.abs(g)>v/2?g-Math.round(g/v)*v:g}}},{}],523:[function(y,ee,Q){"use strict";var g=y("fast-isnumeric"),v=y("./array").isArrayOrTypedArray;function m(d,s){return function(){var i,u,f,c,h,p=d;for(c=0;c<s.length-1;c++){if(-1===(i=s[c])){for(u=!0,f=[],h=0;h<p.length;h++)f[h]=m(p[h],s.slice(c+1))(),f[h]!==f[0]&&(u=!1);return u?f[0]:f}if("number"==typeof i&&!v(p)||"object"!=typeof(p=p[i])||null===p)return}if("object"==typeof p&&null!==p&&null!==(f=p[s[c]]))return f}}ee.exports=function(d,s){if(g(s))s=String(s);else if("string"!=typeof s||"[-1]"===s.substr(s.length-4))throw"bad property string";for(var i,u,f,c=0,h=s.split(".");c<h.length;){if(i=String(h[c]).match(/^([^\[\]]*)((\[\-?[0-9]*\])+)$/)){if(i[1])h[c]=i[1];else{if(0!==c)throw"bad property string";h.splice(0,1)}for(u=i[2].substr(1,i[2].length-2).split("]["),f=0;f<u.length;f++)c++,h.splice(c,0,Number(u[f]))}c++}return"object"!=typeof d?{set:function(){throw"bad container"},get:function(){},astr:s,parts:h,obj:d}:{set:n(d,h,s),get:m(d,h),astr:s,parts:h,obj:d}};var x=/(^|\.)args\[/;function e(d,s){return void 0===d||null===d&&!s.match(x)}function n(d,s,i){return function(u){var f,c,h=d,p="",o=[[d,p]],b=e(u,i);for(c=0;c<s.length-1;c++){if("number"==typeof(f=s[c])&&!v(h))throw"array index but container is not an array";if(-1===f){if(b=!a(h,s.slice(c+1),u,i))break;return}if(!r(h,f,s[c+1],b))break;if("object"!=typeof(h=h[f])||null===h)throw"container is not an object";p=t(p,f),o.push([h,p])}if(b){if(c===s.length-1&&(delete h[s[c]],Array.isArray(h)&&+s[c]==h.length-1))for(;h.length&&void 0===h[h.length-1];)h.pop()}else h[s[c]]=u}}function t(d,s){var i=s;return g(s)?i="["+s+"]":d&&(i="."+s),d+i}function a(d,s,i,u){var f,c=v(i),h=!0,p=i,o=u.replace("-1",0),b=!c&&e(i,o),l=s[0];for(f=0;f<d.length;f++)o=u.replace("-1",f),c&&(b=e(p=i[f%i.length],o)),b&&(h=!1),r(d,f,l,b)&&n(d[f],s,u.replace("-1",f))(p);return h}function r(d,s,i,u){if(void 0===d[s]){if(u)return!1;d[s]="number"==typeof i?[]:{}}return!0}},{"./array":497,"fast-isnumeric":190}],524:[function(y,ee,Q){"use strict";ee.exports=function(){}},{}],525:[function(y,ee,Q){"use strict";var g=y("@plotly/d3"),v=y("fast-isnumeric"),m=[];ee.exports=function(x,e){if(-1===m.indexOf(x)){m.push(x);var n=1e3;v(e)?n=e:"long"===e&&(n=3e3);var t=g.select("body").selectAll(".plotly-notifier").data([0]);t.enter().append("div").classed("plotly-notifier",!0),t.selectAll(".notifier-note").data(m).enter().append("div").classed("notifier-note",!0).style("opacity",0).each(function(r){var d=g.select(this);d.append("button").classed("notifier-close",!0).html("&times;").on("click",function(){d.transition().call(a)});for(var s=d.append("p"),i=r.split(/<br\s*\/?>/g),u=0;u<i.length;u++)u&&s.append("br"),s.append("span").text(i[u]);"stick"===e?d.transition().duration(350).style("opacity",1):d.transition().duration(700).style("opacity",1).transition().delay(n).call(a)})}function a(r){r.duration(700).style("opacity",0).each("end",function(d){var s=m.indexOf(d);-1!==s&&m.splice(s,1),g.select(this).remove()})}}},{"@plotly/d3":58,"fast-isnumeric":190}],526:[function(y,ee,Q){"use strict";var g=y("./setcursor"),v="data-savedcursor";ee.exports=function(m,x){var e=m.attr(v);if(x){if(!e){for(var n=(m.attr("class")||"").split(" "),t=0;t<n.length;t++){var a=n[t];0===a.indexOf("cursor-")&&m.attr(v,a.substr(7)).classed(a,!1)}m.attr(v)||m.attr(v,"!!")}g(m,x)}else e&&(m.attr(v,null),"!!"===e?g(m):g(m,e))}},{"./setcursor":536}],527:[function(y,ee,Q){"use strict";var g=y("./matrix").dot,v=y("../constants/numerical").BADNUM,m=ee.exports={};m.tester=function(x){var e,n=x.slice(),t=n[0][0],a=t,r=n[0][1],d=r;for(n[n.length-1][0]===n[0][0]&&n[n.length-1][1]===n[0][1]||n.push(n[0]),e=1;e<n.length;e++)t=Math.min(t,n[e][0]),a=Math.max(a,n[e][0]),r=Math.min(r,n[e][1]),d=Math.max(d,n[e][1]);var s,i=!1;5===n.length&&(n[0][0]===n[1][0]?n[2][0]===n[3][0]&&n[0][1]===n[3][1]&&n[1][1]===n[2][1]&&(i=!0,s=function(c){return c[0]===n[0][0]}):n[0][1]===n[1][1]&&n[2][1]===n[3][1]&&n[0][0]===n[3][0]&&n[1][0]===n[2][0]&&(i=!0,s=function(c){return c[1]===n[0][1]}));var u=!0,f=n[0];for(e=1;e<n.length;e++)if(f[0]!==n[e][0]||f[1]!==n[e][1]){u=!1;break}return{xmin:t,xmax:a,ymin:r,ymax:d,pts:n,contains:i?function(c,h){var p=c[0],o=c[1];return!(p===v||p<t||p>a||o===v||o<r||o>d||h&&s(c))}:function(c,h){var p=c[0],o=c[1];if(p===v||p<t||p>a||o===v||o<r||o>d)return!1;var b,l,T,_,w,k=n.length,L=n[0][0],M=n[0][1],I=0;for(b=1;b<k;b++)if(l=L,T=M,L=n[b][0],M=n[b][1],!(p<(_=Math.min(l,L))||p>Math.max(l,L)||o>Math.max(T,M)))if(o<Math.min(T,M))p!==_&&I++;else{if(o===(w=L===l?o:T+(p-l)*(M-T)/(L-l)))return 1!==b||!h;o<=w&&p!==_&&I++}return I%2==1},isRect:i,degenerate:u}},m.isSegmentBent=function(x,e,n,t){var a,r,d,s=x[e],i=[x[n][0]-s[0],x[n][1]-s[1]],u=g(i,i),f=Math.sqrt(u),c=[-i[1]/f,i[0]/f];for(a=e+1;a<n;a++)if((d=g(r=[x[a][0]-s[0],x[a][1]-s[1]],i))<0||d>u||Math.abs(g(r,c))>t)return!0;return!1},m.filter=function(x,e){var n=[x[0]],t=0,a=0;function r(d){x.push(d);var s=n.length,i=t;n.splice(a+1);for(var u=i+1;u<x.length;u++)(u===x.length-1||m.isSegmentBent(x,i,u+1,e))&&(n.push(x[u]),n.length<s-2&&(t=u,a=n.length-1),i=u)}return x.length>1&&r(x.pop()),{addPt:r,raw:x,filtered:n}}},{"../constants/numerical":491,"./matrix":521}],528:[function(y,ee,Q){(function(g){(function(){"use strict";var v=y("./show_no_webgl_msg"),m=y("regl");ee.exports=function(x,e,n){var t=x._fullLayout,a=!0;return t._glcanvas.each(function(r){if(r.regl)r.regl.preloadCachedCode(n);else if(!r.pick||t._has("parcoords")){try{r.regl=m({canvas:this,attributes:{antialias:!r.pick,preserveDrawingBuffer:!0},pixelRatio:x._context.plotGlPixelRatio||g.devicePixelRatio,extensions:e||[],cachedCode:n||{}})}catch{a=!1}r.regl||(a=!1),a&&this.addEventListener("webglcontextlost",function(d){x&&x.emit&&x.emit("plotly_webglcontextlost",{event:d,layer:r.key})},!1)}}),a||v({container:t._glcontainer.node()}),a}}).call(this)}).call(this,typeof global<"u"?global:typeof self<"u"?self:typeof window<"u"?window:{})},{"./show_no_webgl_msg":537,regl:284}],529:[function(y,ee,Q){"use strict";var g=y("fast-isnumeric"),v=y("is-mobile");ee.exports=function(m){var x,s;if("string"!=typeof(x=m&&m.hasOwnProperty("userAgent")?m.userAgent:(typeof navigator<"u"&&(s=navigator.userAgent),s&&s.headers&&"string"==typeof s.headers["user-agent"]&&(s=s.headers["user-agent"]),s)))return!0;var e=v({ua:{headers:{"user-agent":x}},tablet:!0,featureDetect:!1});if(!e)for(var n=x.split(" "),t=1;t<n.length;t++)if(-1!==n[t].indexOf("Safari"))for(var a=t-1;a>-1;a--){var r=n[a];if("Version/"===r.substr(0,8)){var d=r.substr(8).split(".")[0];if(g(d)&&(d=+d),d>=13)return!0}}return e}},{"fast-isnumeric":190,"is-mobile":234}],530:[function(y,ee,Q){"use strict";ee.exports=function(g,v){if(v instanceof RegExp){for(var m=v.toString(),x=0;x<g.length;x++)if(g[x]instanceof RegExp&&g[x].toString()===m)return g;g.push(v)}else!v&&0!==v||-1!==g.indexOf(v)||g.push(v);return g}},{}],531:[function(y,ee,Q){"use strict";var g=y("../lib"),v=y("../plot_api/plot_config").dfltConfig,m={add:function(x,e,n,t,a){var r,d;x.undoQueue=x.undoQueue||{index:0,queue:[],sequence:!1},d=x.undoQueue.index,x.autoplay?x.undoQueue.inSequence||(x.autoplay=!1):(!x.undoQueue.sequence||x.undoQueue.beginSequence?(x.undoQueue.queue.splice(d,x.undoQueue.queue.length-d,r={undo:{calls:[],args:[]},redo:{calls:[],args:[]}}),x.undoQueue.index+=1):r=x.undoQueue.queue[d-1],x.undoQueue.beginSequence=!1,r&&(r.undo.calls.unshift(e),r.undo.args.unshift(n),r.redo.calls.push(t),r.redo.args.push(a)),x.undoQueue.queue.length>v.queueLength&&(x.undoQueue.queue.shift(),x.undoQueue.index--))},startSequence:function(x){x.undoQueue=x.undoQueue||{index:0,queue:[],sequence:!1},x.undoQueue.sequence=!0,x.undoQueue.beginSequence=!0},stopSequence:function(x){x.undoQueue=x.undoQueue||{index:0,queue:[],sequence:!1},x.undoQueue.sequence=!1,x.undoQueue.beginSequence=!1},undo:function(x){var e,n;if(!(void 0===x.undoQueue||isNaN(x.undoQueue.index)||x.undoQueue.index<=0)){for(x.undoQueue.index--,e=x.undoQueue.queue[x.undoQueue.index],x.undoQueue.inSequence=!0,n=0;n<e.undo.calls.length;n++)m.plotDo(x,e.undo.calls[n],e.undo.args[n]);x.undoQueue.inSequence=!1,x.autoplay=!1}},redo:function(x){var e,n;if(!(void 0===x.undoQueue||isNaN(x.undoQueue.index)||x.undoQueue.index>=x.undoQueue.queue.length)){for(e=x.undoQueue.queue[x.undoQueue.index],x.undoQueue.inSequence=!0,n=0;n<e.redo.calls.length;n++)m.plotDo(x,e.redo.calls[n],e.redo.args[n]);x.undoQueue.inSequence=!1,x.autoplay=!1,x.undoQueue.index++}},plotDo:function(x,e,n){x.autoplay=!0,n=function(t,a){for(var r,d=[],s=0;s<a.length;s++)d[s]=(r=a[s])===t?r:"object"==typeof r?Array.isArray(r)?g.extendDeep([],r):g.extendDeepAll({},r):r;return d}(x,n),e.apply(null,n)}};ee.exports=m},{"../lib":515,"../plot_api/plot_config":553}],532:[function(y,ee,Q){"use strict";Q.counter=function(g,v,m,x){var e=(v||"")+(m?"":"$"),n=!1===x?"":"^";return"xy"===g?new RegExp(n+"x([2-9]|[1-9][0-9]+)?y([2-9]|[1-9][0-9]+)?"+e):new RegExp(n+g+"([2-9]|[1-9][0-9]+)?"+e)}},{}],533:[function(y,ee,Q){"use strict";var g=/^(.*)(\.[^\.\[\]]+|\[\d\])$/,v=/^[^\.\[\]]+$/;ee.exports=function(m,x){for(;x;){var e=m.match(g);if(e)m=e[1];else{if(!m.match(v))throw new Error("bad relativeAttr call:"+[m,x]);m=""}if("^"!==x.charAt(0))break;x=x.slice(1)}return m&&"["!==x.charAt(0)?m+"."+x:m+x}},{}],534:[function(y,ee,Q){"use strict";var g=y("./array").isArrayOrTypedArray,v=y("./is_plain_object");ee.exports=function m(x,e){for(var n in e){var t=e[n],a=x[n];if(a!==t)if("_"===n.charAt(0)||"function"==typeof t){if(n in x)continue;x[n]=t}else if(g(t)&&g(a)&&v(t[0])){if("customdata"===n||"ids"===n)continue;for(var r=Math.min(t.length,a.length),d=0;d<r;d++)a[d]!==t[d]&&v(t[d])&&v(a[d])&&m(a[d],t[d])}else v(t)&&v(a)&&(m(a,t),Object.keys(a).length||delete x[n])}}},{"./array":497,"./is_plain_object":516}],535:[function(y,ee,Q){"use strict";var g=y("fast-isnumeric"),v=y("./loggers"),m=y("./identity"),x=y("../constants/numerical").BADNUM;function e(r,d){return r<d}function n(r,d){return r<=d}function t(r,d){return r>d}function a(r,d){return r>=d}Q.findBin=function(r,d,s){if(g(d.start))return s?Math.ceil((r-d.start)/d.size-1e-9)-1:Math.floor((r-d.start)/d.size+1e-9);var i,u,f=0,c=d.length,h=0,p=c>1?(d[c-1]-d[0])/(c-1):1;for(u=p>=0?s?e:n:s?a:t,r+=1e-9*p*(s?-1:1)*(p>=0?1:-1);f<c&&h++<100;)u(d[i=Math.floor((f+c)/2)],r)?f=i+1:c=i;return h>90&&v.log("Long binary search..."),f-1},Q.sorterAsc=function(r,d){return r-d},Q.sorterDes=function(r,d){return d-r},Q.distinctVals=function(r){var d,s=r.slice();for(s.sort(Q.sorterAsc),d=s.length-1;d>-1&&s[d]===x;d--);for(var i,u=s[d]-s[0]||1,f=u/(d||1)/1e4,c=[],h=0;h<=d;h++){var p=s[h],o=p-i;void 0===i?(c.push(p),i=p):o>f&&(u=Math.min(u,o),c.push(p),i=p)}return{vals:c,minDiff:u}},Q.roundUp=function(r,d,s){for(var i,u=0,f=d.length-1,c=0,h=s?0:1,p=s?1:0,o=s?Math.ceil:Math.floor;u<f&&c++<100;)d[i=o((u+f)/2)]<=r?u=i+h:f=i-p;return d[u]},Q.sort=function(r,d){for(var s=0,i=0,u=1;u<r.length;u++){var f=d(r[u],r[u-1]);if(f<0?s=1:f>0&&(i=1),s&&i)return r.sort(d)}return i?r:r.reverse()},Q.findIndexOfMin=function(r,d){d=d||m;for(var s,i=1/0,u=0;u<r.length;u++){var f=d(r[u]);f<i&&(i=f,s=u)}return s}},{"../constants/numerical":491,"./identity":513,"./loggers":519,"fast-isnumeric":190}],536:[function(y,ee,Q){"use strict";ee.exports=function(g,v){(g.attr("class")||"").split(" ").forEach(function(m){0===m.indexOf("cursor-")&&g.classed(m,!1)}),v&&g.classed("cursor-"+v,!0)}},{}],537:[function(y,ee,Q){"use strict";var g=y("../components/color"),v=function(){};ee.exports=function(m){for(var x in m)"function"==typeof m[x]&&(m[x]=v);m.destroy=function(){m.container.parentNode.removeChild(m.container)};var e=document.createElement("div");e.className="no-webgl",e.style.cursor="pointer",e.style.fontSize="24px",e.style.color=g.defaults[0],e.style.position="absolute",e.style.left=e.style.top="0px",e.style.width=e.style.height="100%",e.style["background-color"]=g.lightLine,e.style["z-index"]=30;var n=document.createElement("p");return n.textContent="WebGL is not supported by your browser - visit https://get.webgl.org for more info",n.style.position="relative",n.style.top="50%",n.style.left="50%",n.style.height="30%",n.style.width="50%",n.style.margin="-15% 0 0 -25%",e.appendChild(n),m.container.appendChild(e),m.container.style.background="#FFFFFF",m.container.onclick=function(){window.open("https://get.webgl.org")},!1}},{"../components/color":367}],538:[function(y,ee,Q){"use strict";ee.exports=function(g){return Object.keys(g).sort()}},{}],539:[function(y,ee,Q){"use strict";var g=y("fast-isnumeric"),v=y("./array").isArrayOrTypedArray;Q.aggNums=function(m,x,e,n){var t,a;if((!n||n>e.length)&&(n=e.length),g(x)||(x=!1),v(e[0])){for(a=new Array(n),t=0;t<n;t++)a[t]=Q.aggNums(m,x,e[t]);e=a}for(t=0;t<n;t++)g(x)?g(e[t])&&(x=m(+x,+e[t])):x=e[t];return x},Q.len=function(m){return Q.aggNums(function(x){return x+1},0,m)},Q.mean=function(m,x){return x||(x=Q.len(m)),Q.aggNums(function(e,n){return e+n},0,m)/x},Q.midRange=function(m){if(void 0!==m&&0!==m.length)return(Q.aggNums(Math.max,null,m)+Q.aggNums(Math.min,null,m))/2},Q.variance=function(m,x,e){return x||(x=Q.len(m)),g(e)||(e=Q.mean(m,x)),Q.aggNums(function(n,t){return n+Math.pow(t-e,2)},0,m)/x},Q.stdev=function(m,x,e){return Math.sqrt(Q.variance(m,x,e))},Q.median=function(m){var x=m.slice().sort();return Q.interp(x,.5)},Q.interp=function(m,x){if(!g(x))throw"n should be a finite number";if((x=x*m.length-.5)<0)return m[0];if(x>m.length-1)return m[m.length-1];var e=x%1;return e*m[Math.ceil(x)]+(1-e)*m[Math.floor(x)]}},{"./array":497,"fast-isnumeric":190}],540:[function(y,ee,Q){"use strict";var g=y("color-normalize");ee.exports=function(v){return v?g(v):[0,0,0,1]}},{"color-normalize":89}],541:[function(y,ee,Q){"use strict";var g=y("@plotly/d3"),v=y("../lib"),m=v.strTranslate,x=y("../constants/xmlns_namespaces"),e=y("../constants/alignment").LINE_SPACING,n=/([^$]*)([$]+[^$]*[$]+)([^$]*)/;Q.convertToTspans=function(S,E,z){var R=S.text(),q=!S.attr("data-notex")&&E&&E._context.typesetMath&&typeof MathJax<"u"&&R.match(n),V=g.select(S.node().parentNode);if(!V.empty()){var W=S.attr("class")?S.attr("class").split(" ")[0]:"text";return V.selectAll("svg."+(W+="-math")).remove(),V.selectAll("g."+W+"-group").remove(),S.style("display",null).attr({"data-unformatted":R,"data-math":"N"}),q?(E&&E._promises||[]).push(new Promise(function(G){S.style("display","none");var Y=parseInt(S.node().style.fontSize,10);!function(B,N,U){var te,j,J,X,re=parseInt((MathJax.version||"").split(".")[0]);if(2===re||3===re){var ne=function(){var oe="math-output-"+v.randstr({},64),de=(X=g.select("body").append("div").attr({id:oe}).style({visibility:"hidden",position:"absolute","font-size":N.fontSize+"px"}).text(B.replace(t,"\\lt ").replace(a,"\\gt "))).node();return 2===re?MathJax.Hub.Typeset(de):MathJax.typeset([de])},le=function(){var oe=X.select(2===re?".MathJax_SVG":".MathJax"),de=!oe.empty()&&X.select("svg").node();if(de){var se,ge=de.getBoundingClientRect();se=2===re?g.select("body").select("#MathJax_SVG_glyphs"):oe.select("defs"),U(oe,se,ge)}else v.log("There was an error in the tex syntax.",B),U();X.remove()};2===re?MathJax.Hub.Queue(function(){return j=v.extendDeepAll({},MathJax.Hub.config),J=MathJax.Hub.processSectionDelay,void 0!==MathJax.Hub.processSectionDelay&&(MathJax.Hub.processSectionDelay=0),MathJax.Hub.Config({messageStyle:"none",tex2jax:{inlineMath:r},displayAlign:"left"})},function(){if("SVG"!==(te=MathJax.Hub.config.menuSettings.renderer))return MathJax.Hub.setRenderer("SVG")},ne,le,function(){if("SVG"!==te)return MathJax.Hub.setRenderer(te)},function(){return void 0!==J&&(MathJax.Hub.processSectionDelay=J),MathJax.Hub.Config(j)}):3===re&&(j=v.extendDeepAll({},MathJax.config),MathJax.config.tex||(MathJax.config.tex={}),MathJax.config.tex.inlineMath=r,"svg"!==(te=MathJax.config.startup.output)&&(MathJax.config.startup.output="svg"),MathJax.startup.defaultReady(),MathJax.startup.promise.then(function(){ne(),le(),"svg"!==te&&(MathJax.config.startup.output=te),MathJax.config=j}))}else v.warn("No MathJax version:",MathJax.version)}(q[2],{fontSize:Y},function(B,N,U){V.selectAll("svg."+W).remove(),V.selectAll("g."+W+"-group").remove();var te=B&&B.select("svg");if(!te||!te.node())return K(),void G();var j=V.append("g").classed(W+"-group",!0).attr({"pointer-events":"none","data-unformatted":R,"data-math":"Y"});j.node().appendChild(te.node()),N&&N.node()&&te.node().insertBefore(N.node().cloneNode(!0),te.node().firstChild);var J=U.width,X=U.height;te.attr({class:W,height:X,preserveAspectRatio:"xMinYMin meet"}).style({overflow:"visible","pointer-events":"none"});var re=S.node().style.fill||"black",ne=te.select("g");ne.attr({fill:re,stroke:re});var le=ne.node().getBoundingClientRect(),oe=le.width,de=le.height;(oe>J||de>X)&&(te.style("overflow","hidden"),oe=(le=te.node().getBoundingClientRect()).width,de=le.height);var se=+S.attr("x"),ge=+S.attr("y"),_e=-(Y||S.node().getBoundingClientRect().height)/4;if("y"===W[0])j.attr({transform:"rotate("+[-90,se,ge]+")"+m(-oe/2,_e-de/2)});else if("l"===W[0])ge=_e-de/2;else if("a"===W[0]&&0!==W.indexOf("atitle"))se=0,ge=_e;else{var Te=S.attr("text-anchor");se-=oe*("middle"===Te?.5:"end"===Te?1:0),ge=ge+_e-de/2}te.attr({x:se,y:ge}),z&&z.call(S,j),G(j)})})):K(),S}function K(){V.empty()||(W=S.attr("class")+"-math",V.select("svg."+W).remove()),S.text("").style("white-space","pre"),function(G,Y){Y=Y.replace(f," ");var $,B=!1,N=[],U=-1;function te(){U++;var fe=document.createElementNS(x.svg,"tspan");g.select(fe).attr({class:"line",dy:U*e+"em"}),G.appendChild(fe),$=fe;var ve=N;if(N=[{node:fe}],ve.length>1)for(var Ae=1;Ae<ve.length;Ae++)j(ve[Ae])}function j(fe){var ve,Ae=fe.type,ke={};if("a"===Ae){ve="a";var Pe=fe.target,Ne=fe.href,De=fe.popup;Ne&&(ke={"xlink:xlink:show":"_blank"===Pe||"_"!==Pe.charAt(0)?"new":"replace",target:Pe,"xlink:xlink:href":Ne},De&&(ke.onclick='window.open(this.href.baseVal,this.target.baseVal,"'+De+'");return false;'))}else ve="tspan";fe.style&&(ke.style=fe.style);var ze=document.createElementNS(x.svg,ve);if("sup"===Ae||"sub"===Ae){J($,"\u200b"),$.appendChild(ze);var Me=document.createElementNS(x.svg,"tspan");J(Me,"\u200b"),g.select(Me).attr("dy",i[Ae]),ke.dy=s[Ae],$.appendChild(ze),$.appendChild(Me)}else $.appendChild(ze);g.select(ze).attr(ke),$=fe.node=ze,N.push(fe)}function J(fe,ve){fe.appendChild(document.createTextNode(ve))}function X(fe){if(1!==N.length){var ve=N.pop();fe!==ve.type&&v.log("Start tag <"+ve.type+"> doesnt match end tag <"+fe+">. Pretending it did match.",Y),$=N[N.length-1].node}else v.log("Ignoring unexpected end tag </"+fe+">.",Y)}p.test(Y)?te():($=G,N=[{node:G}]);for(var re=Y.split(c),ne=0;ne<re.length;ne++){var le=re[ne],oe=le.match(h),de=oe&&oe[2].toLowerCase(),se=d[de];if("br"===de)te();else if(void 0===se)J($,M(le));else if(oe[1])X(de);else{var ge=oe[4],_e={type:de},Te=_(ge,o);if(Te?(Te=Te.replace(w,"$1 fill:"),se&&(Te+=";"+se)):se&&(Te=se),Te&&(_e.style=Te),"a"===de){B=!0;var we=_(ge,b);if(we){var Oe=I(we);Oe&&(_e.href=Oe,_e.target=_(ge,l)||"_blank",_e.popup=_(ge,T))}}j(_e)}}return B}(S.node(),R)&&S.style("pointer-events","all"),Q.positionText(S),z&&z.call(S)}};var t=/(<|&lt;|&#60;)/g,a=/(>|&gt;|&#62;)/g,r=[["$","$"],["\\(","\\)"]],d={sup:"font-size:70%",sub:"font-size:70%",b:"font-weight:bold",i:"font-style:italic",a:"cursor:pointer",span:"",em:"font-style:italic;font-weight:bold"},s={sub:"0.3em",sup:"-0.6em"},i={sub:"-0.21em",sup:"0.42em"},u=["http:","https:","mailto:","",void 0,":"],f=Q.NEWLINES=/(\r\n?|\n)/g,c=/(<[^<>]*>)/,h=/<(\/?)([^ >]*)(\s+(.*))?>/i,p=/<br(\s+.*)?>/i;Q.BR_TAG_ALL=/<br(\s+.*)?>/gi;var o=/(^|[\s"'])style\s*=\s*("([^"]*);?"|'([^']*);?')/i,b=/(^|[\s"'])href\s*=\s*("([^"]*)"|'([^']*)')/i,l=/(^|[\s"'])target\s*=\s*("([^"\s]*)"|'([^'\s]*)')/i,T=/(^|[\s"'])popup\s*=\s*("([\w=,]*)"|'([\w=,]*)')/i;function _(S,E){if(!S)return null;var z=S.match(E),R=z&&(z[3]||z[4]);return R&&M(R)}var w=/(^|;)\s*color:/;Q.plainText=function(S,E){for(var z=void 0!==(E=E||{}).len&&-1!==E.len?E.len:1/0,R=void 0!==E.allowedTags?E.allowedTags:["br"],V=S.split(c),W=[],K="",G=0,Y=0;Y<V.length;Y++){var $=V[Y],B=$.match(h),N=B&&B[2].toLowerCase();if(N)-1!==R.indexOf(N)&&(W.push($),K=N);else{var U=$.length;if(G+U<z)W.push($),G+=U;else if(G<z){var te=z-G;K&&("br"!==K||te<=3||U<=3)&&W.pop(),W.push(z>3?$.substr(0,te-3)+"...":$.substr(0,te));break}K=""}}return W.join("")};var k={mu:"\u03bc",amp:"&",lt:"<",gt:">",nbsp:"\xa0",times:"\xd7",plusmn:"\xb1",deg:"\xb0"},L=/&(#\d+|#x[\da-fA-F]+|[a-z]+);/g;function M(S){return S.replace(L,function(E,z){return("#"===z.charAt(0)?function(R){if(!(R>1114111)){var q=String.fromCodePoint;if(q)return q(R);var V=String.fromCharCode;return R<=65535?V(R):V(55232+(R>>10),R%1024+56320)}}("x"===z.charAt(1)?parseInt(z.substr(2),16):parseInt(z.substr(1),10)):k[z])||E})}function I(S){var E=encodeURI(decodeURI(S)),z=document.createElement("a"),R=document.createElement("a");z.href=S,R.href=E;var V=R.protocol;return-1!==u.indexOf(z.protocol)&&-1!==u.indexOf(V)?E:""}function P(S,E,z){var R,q,V,W=z.horizontalAlign,K=z.verticalAlign||"top",G=S.node().getBoundingClientRect(),Y=E.node().getBoundingClientRect();return q="bottom"===K?function(){return G.bottom-R.height}:"middle"===K?function(){return G.top+(G.height-R.height)/2}:function(){return G.top},V="right"===W?function(){return G.right-R.width}:"center"===W?function(){return G.left+(G.width-R.width)/2}:function(){return G.left},function(){R=this.node().getBoundingClientRect();var $=V()-Y.left,B=q()-Y.top,N=z.gd||{};if(z.gd){N._fullLayout._calcInverseTransform(N);var U=v.apply3DTransform(N._fullLayout._invTransform)($,B);$=U[0],B=U[1]}return this.style({top:B+"px",left:$+"px","z-index":1e3}),this}}Q.convertEntities=M,Q.sanitizeHTML=function(S){S=S.replace(f," ");for(var E=document.createElement("p"),z=E,R=[],q=S.split(c),V=0;V<q.length;V++){var W=q[V],K=W.match(h),G=K&&K[2].toLowerCase();if(G in d)if(K[1])R.length&&(z=R.pop());else{var Y=K[4],$=_(Y,o),B=$?{style:$}:{};if("a"===G){var N=_(Y,b);if(N){var U=I(N);if(U){B.href=U;var te=_(Y,l);te&&(B.target=te)}}}var j=document.createElement(G);z.appendChild(j),g.select(j).attr(B),z=j,R.push(j)}else z.appendChild(document.createTextNode(M(W)))}return E.innerHTML},Q.lineCount=function(S){return S.selectAll("tspan.line").size()||1},Q.positionText=function(S,E,z){return S.each(function(){var R=g.select(this);function q(K,G){return void 0===G?null===(G=R.attr(K))&&(R.attr(K,0),G=0):R.attr(K,G),G}var V=q("x",E),W=q("y",z);"text"===this.nodeName&&R.selectAll("tspan.line").attr({x:V,y:W})})},Q.makeTextShadow=function(S){var E="1px ",z="1px ",R="1px ";return E+z+R+S+", -"+E+"-"+z+R+S+", "+E+"-"+z+R+S+", -"+E+z+R+S},Q.makeEditable=function(S,E){var z=E.gd,R=E.delegate,q=g.dispatch("edit","input","cancel"),V=R||S;if(S.style({"pointer-events":R?"none":"all"}),1!==S.size())throw new Error("boo");function W(){var $,B,N,U,te;$=g.select(z).select(".svg-container"),B=$.append("div"),N=S.node().style,U=parseFloat(N.fontSize||12),void 0===(te=E.text)&&(te=S.attr("data-unformatted")),B.classed("plugin-editable editable",!0).style({position:"absolute","font-family":N.fontFamily||"Arial","font-size":U,color:E.fill||N.fill||"black",opacity:1,"background-color":E.background||"transparent",outline:"#ffffff33 1px solid",margin:[-U/8+1,0,0,-1].join("px ")+"px",padding:"0","box-sizing":"border-box"}).attr({contenteditable:!0}).text(te).call(P(S,$,E)).on("blur",function(){z._editing=!1,S.text(this.textContent).style({opacity:1});var j,J=g.select(this).attr("class");(j=J?"."+J.split(" ")[0]+"-math-group":"[class*=-math-group]")&&g.select(S.node().parentNode).select(j).style({opacity:0});var X=this.textContent;g.select(this).transition().duration(0).remove(),g.select(document).on("mouseup",null),q.edit.call(S,X)}).on("focus",function(){var j=this;z._editing=!0,g.select(document).on("mouseup",function(){if(g.event.target===j)return!1;document.activeElement===B.node()&&B.node().blur()})}).on("keyup",function(){27===g.event.which?(z._editing=!1,S.style({opacity:1}),g.select(this).style({opacity:0}).on("blur",function(){return!1}).transition().remove(),q.cancel.call(S,this.textContent)):(q.input.call(S,this.textContent),g.select(this).call(P(S,$,E)))}).on("keydown",function(){13===g.event.which&&this.blur()}).call(K),S.style({opacity:0});var G,Y=V.attr("class");(G=Y?"."+Y.split(" ")[0]+"-math-group":"[class*=-math-group]")&&g.select(S.node().parentNode).select(G).style({opacity:0})}function K(G){var Y=G.node(),$=document.createRange();$.selectNodeContents(Y);var B=window.getSelection();B.removeAllRanges(),B.addRange($),Y.focus()}return E.immediate?W():V.on("click",W),g.rebind(S,q,"on")}},{"../constants/alignment":483,"../constants/xmlns_namespaces":492,"../lib":515,"@plotly/d3":58}],542:[function(y,ee,Q){"use strict";var g={};function v(m){m&&null!==m.timer&&(clearTimeout(m.timer),m.timer=null)}Q.throttle=function(m,x,e){var n=g[m],t=Date.now();if(!n){for(var a in g)g[a].ts<t-6e4&&delete g[a];n=g[m]={ts:0,timer:null}}function r(){e(),n.ts=Date.now(),n.onDone&&(n.onDone(),n.onDone=null)}v(n),t>n.ts+x?r():n.timer=setTimeout(function(){r(),n.timer=null},x)},Q.done=function(m){var x=g[m];return x&&x.timer?new Promise(function(e){var n=x.onDone;x.onDone=function(){n&&n(),e(),x.onDone=null}}):Promise.resolve()},Q.clear=function(m){if(m)v(g[m]),delete g[m];else for(var x in g)Q.clear(x)}},{}],543:[function(y,ee,Q){"use strict";var g=y("fast-isnumeric");ee.exports=function(v,m){if(v>0)return Math.log(v)/Math.LN10;var x=Math.log(Math.min(m[0],m[1]))/Math.LN10;return g(x)||(x=Math.log(Math.max(m[0],m[1]))/Math.LN10-6),x}},{"fast-isnumeric":190}],544:[function(y,ee,Q){"use strict";var g=ee.exports={},v=y("../plots/geo/constants").locationmodeToLayer,m=y("topojson-client").feature;g.getTopojsonName=function(x){return[x.scope.replace(/ /g,"-"),"_",x.resolution.toString(),"m"].join("")},g.getTopojsonPath=function(x,e){return x+e+".json"},g.getTopojsonFeatures=function(x,e){return m(e,e.objects[v[x.locationmode]]).features}},{"../plots/geo/constants":596,"topojson-client":316}],545:[function(y,ee,Q){"use strict";ee.exports={moduleType:"locale",name:"en-US",dictionary:{"Click to enter Colorscale title":"Click to enter Colorscale title"},format:{date:"%m/%d/%Y"}}},{}],546:[function(y,ee,Q){"use strict";ee.exports={moduleType:"locale",name:"en",dictionary:{"Click to enter Colorscale title":"Click to enter Colourscale title"},format:{days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],periods:["AM","PM"],dateTime:"%a %b %e %X %Y",date:"%d/%m/%Y",time:"%H:%M:%S",decimal:".",thousands:",",grouping:[3],currency:["$",""],year:"%Y",month:"%b %Y",dayMonth:"%b %-d",dayMonthYear:"%b %-d, %Y"}}},{}],547:[function(y,ee,Q){"use strict";var g=y("../registry");ee.exports=function(v){for(var m,x,e=g.layoutArrayContainers,n=g.layoutArrayRegexes,t=v.split("[")[0],a=0;a<n.length;a++)if((x=v.match(n[a]))&&0===x.index){m=x[0];break}if(m||(m=e[e.indexOf(t)]),!m)return!1;var r=v.substr(m.length);return r?!!(x=r.match(/^\[(0|[1-9][0-9]*)\](\.(.+))?$/))&&{array:m,index:Number(x[1]),property:x[3]||""}:{array:m,index:"",property:""}}},{"../registry":647}],548:[function(y,ee,Q){"use strict";var g=y("../lib"),v=g.extendFlat,m=g.isPlainObject,x={valType:"flaglist",extras:["none"],flags:["calc","clearAxisTypes","plot","style","markerSize","colorbars"]},e={valType:"flaglist",extras:["none"],flags:["calc","plot","legend","ticks","axrange","layoutstyle","modebar","camera","arraydraw","colorbars"]},n=x.flags.slice().concat(["fullReplot"]),t=e.flags.slice().concat("layoutReplot");function a(s){for(var i={},u=0;u<s.length;u++)i[s[u]]=!1;return i}function r(s,i,u){var f=v({},s);for(var c in f){var h=f[c];m(h)&&(f[c]=d(h,i,0,c))}return"from-root"===u&&(f.editType=i),f}function d(s,i,u,f){if(s.valType){var c=v({},s);if(c.editType=i,Array.isArray(s.items)){c.items=new Array(s.items.length);for(var h=0;h<s.items.length;h++)c.items[h]=d(s.items[h],i)}return c}return r(s,i,"_"===f.charAt(0)?"nested":"from-root")}ee.exports={traces:x,layout:e,traceFlags:function(){return a(n)},layoutFlags:function(){return a(t)},update:function(s,i){var u=i.editType;if(u&&"none"!==u)for(var f=u.split("+"),c=0;c<f.length;c++)s[f[c]]=!0},overrideAll:r}},{"../lib":515}],549:[function(y,ee,Q){"use strict";var g=y("fast-isnumeric"),v=y("gl-mat4/fromQuat"),m=y("../registry"),x=y("../lib"),e=y("../plots/plots"),n=y("../plots/cartesian/axis_ids"),t=y("../components/color"),a=n.cleanId,r=n.getFromTrace,d=m.traceIs;function s(l,T){var _=l[T],w=T.charAt(0);_&&"paper"!==_&&(l[T]=a(_,w,!0))}function i(l){function T(_,w){l[_]&&(!l.title||!l.title[w])&&(l.title||(l.title={}),l.title[w]=l[_],delete l[_])}l&&("string"!=typeof l.title&&"number"!=typeof l.title||(l.title={text:l.title}),T("titlefont","font"),T("titleposition","position"),T("titleside","side"),T("titleoffset","offset"))}function u(l){if(!x.isPlainObject(l))return!1;var T=l.name;return delete l.name,delete l.showlegend,("string"==typeof T||"number"==typeof T)&&String(T)}function f(l,T,_,w){if(_&&!w)return l;if(w&&!_||!l.trim())return T;if(!T.trim())return l;var k,L=Math.min(l.length,T.length);for(k=0;k<L&&l.charAt(k)===T.charAt(k);k++);return l.substr(0,k).trim()}function c(l){var T="middle",_="center";return"string"==typeof l&&(-1!==l.indexOf("top")?T="top":-1!==l.indexOf("bottom")&&(T="bottom"),-1!==l.indexOf("left")?_="left":-1!==l.indexOf("right")&&(_="right")),T+" "+_}function h(l,T){return T in l&&"object"==typeof l[T]&&0===Object.keys(l[T]).length}Q.clearPromiseQueue=function(l){Array.isArray(l._promises)&&l._promises.length>0&&x.log("Clearing previous rejected promises from queue."),l._promises=[]},Q.cleanLayout=function(l){var T,_;l||(l={}),l.xaxis1&&(l.xaxis||(l.xaxis=l.xaxis1),delete l.xaxis1),l.yaxis1&&(l.yaxis||(l.yaxis=l.yaxis1),delete l.yaxis1),l.scene1&&(l.scene||(l.scene=l.scene1),delete l.scene1);var w=(e.subplotsRegistry.cartesian||{}).attrRegex,k=(e.subplotsRegistry.polar||{}).attrRegex,L=(e.subplotsRegistry.ternary||{}).attrRegex,M=(e.subplotsRegistry.gl3d||{}).attrRegex,I=Object.keys(l);for(T=0;T<I.length;T++){var P=I[T];if(w&&w.test(P)){var S=l[P];S.anchor&&"free"!==S.anchor&&(S.anchor=a(S.anchor)),S.overlaying&&(S.overlaying=a(S.overlaying)),S.type||(S.isdate?S.type="date":S.islog?S.type="log":!1===S.isdate&&!1===S.islog&&(S.type="linear")),"withzero"!==S.autorange&&"tozero"!==S.autorange||(S.autorange=!0,S.rangemode="tozero"),delete S.islog,delete S.isdate,delete S.categories,h(S,"domain")&&delete S.domain,void 0!==S.autotick&&(void 0===S.tickmode&&(S.tickmode=S.autotick?"auto":"linear"),delete S.autotick),i(S)}else if(k&&k.test(P))i(l[P].radialaxis);else if(L&&L.test(P)){var E=l[P];i(E.aaxis),i(E.baxis),i(E.caxis)}else if(M&&M.test(P)){var z=l[P],R=z.cameraposition;if(Array.isArray(R)&&4===R[0].length){var V=R[1],W=R[2],K=v([],R[0]),G=[];for(_=0;_<3;++_)G[_]=V[_]+W*K[2+4*_];z.camera={eye:{x:G[0],y:G[1],z:G[2]},center:{x:V[0],y:V[1],z:V[2]},up:{x:0,y:0,z:1}},delete z.cameraposition}i(z.xaxis),i(z.yaxis),i(z.zaxis)}}var Y=Array.isArray(l.annotations)?l.annotations.length:0;for(T=0;T<Y;T++){var $=l.annotations[T];x.isPlainObject($)&&($.ref&&("paper"===$.ref?($.xref="paper",$.yref="paper"):"data"===$.ref&&($.xref="x",$.yref="y"),delete $.ref),s($,"xref"),s($,"yref"))}var B=Array.isArray(l.shapes)?l.shapes.length:0;for(T=0;T<B;T++){var N=l.shapes[T];x.isPlainObject(N)&&(s(N,"xref"),s(N,"yref"))}var U=Array.isArray(l.images)?l.images.length:0;for(T=0;T<U;T++){var te=l.images[T];x.isPlainObject(te)&&(s(te,"xref"),s(te,"yref"))}var j=l.legend;return j&&(j.x>3?(j.x=1.02,j.xanchor="left"):j.x<-2&&(j.x=-.02,j.xanchor="right"),j.y>3?(j.y=1.02,j.yanchor="bottom"):j.y<-2&&(j.y=-.02,j.yanchor="top")),i(l),"rotate"===l.dragmode&&(l.dragmode="orbit"),t.clean(l),l.template&&l.template.layout&&Q.cleanLayout(l.template.layout),l},Q.cleanData=function(l){for(var T=0;T<l.length;T++){var _,w=l[T];if("histogramy"===w.type&&"xbins"in w&&!("ybins"in w)&&(w.ybins=w.xbins,delete w.xbins),w.error_y&&"opacity"in w.error_y){var k=t.defaults,L=w.error_y.color||(d(w,"bar")?t.defaultLine:k[T%k.length]);w.error_y.color=t.addOpacity(t.rgb(L),t.opacity(L)*w.error_y.opacity),delete w.error_y.opacity}if("bardir"in w&&("h"!==w.bardir||!d(w,"bar")&&"histogram"!==w.type.substr(0,9)||(w.orientation="h",Q.swapXYData(w)),delete w.bardir),"histogramy"===w.type&&Q.swapXYData(w),"histogramx"!==w.type&&"histogramy"!==w.type||(w.type="histogram"),"scl"in w&&!("colorscale"in w)&&(w.colorscale=w.scl,delete w.scl),"reversescl"in w&&!("reversescale"in w)&&(w.reversescale=w.reversescl,delete w.reversescl),w.xaxis&&(w.xaxis=a(w.xaxis,"x")),w.yaxis&&(w.yaxis=a(w.yaxis,"y")),d(w,"gl3d")&&w.scene&&(w.scene=e.subplotsRegistry.gl3d.cleanId(w.scene)),!d(w,"pie-like")&&!d(w,"bar-like"))if(Array.isArray(w.textposition))for(_=0;_<w.textposition.length;_++)w.textposition[_]=c(w.textposition[_]);else w.textposition&&(w.textposition=c(w.textposition));var M=m.getModule(w);if(M&&M.colorbar){var I=M.colorbar.container,P=I?w[I]:w;P&&P.colorscale&&("YIGnBu"===P.colorscale&&(P.colorscale="YlGnBu"),"YIOrRd"===P.colorscale&&(P.colorscale="YlOrRd"))}if("surface"===w.type&&x.isPlainObject(w.contours)){var S=["x","y","z"];for(_=0;_<S.length;_++){var E=w.contours[S[_]];x.isPlainObject(E)&&(E.highlightColor&&(E.highlightcolor=E.highlightColor,delete E.highlightColor),E.highlightWidth&&(E.highlightwidth=E.highlightWidth,delete E.highlightWidth))}}if("candlestick"===w.type||"ohlc"===w.type){var z=!1!==(w.increasing||{}).showlegend,R=!1!==(w.decreasing||{}).showlegend,q=u(w.increasing),V=u(w.decreasing);if(!1!==q&&!1!==V){var W=f(q,V,z,R);W&&(w.name=W)}else!q&&!V||w.name||(w.name=q||V)}if(Array.isArray(w.transforms)){var K=w.transforms;for(_=0;_<K.length;_++){var G=K[_];if(x.isPlainObject(G))switch(G.type){case"filter":G.filtersrc&&(G.target=G.filtersrc,delete G.filtersrc),G.calendar&&(G.valuecalendar||(G.valuecalendar=G.calendar),delete G.calendar);break;case"groupby":if(G.styles=G.styles||G.style,G.styles&&!Array.isArray(G.styles)){var Y=G.styles,$=Object.keys(Y);G.styles=[];for(var B=0;B<$.length;B++)G.styles.push({target:$[B],value:Y[$[B]]})}}}}h(w,"line")&&delete w.line,"marker"in w&&(h(w.marker,"line")&&delete w.marker.line,h(w,"marker")&&delete w.marker),t.clean(w),w.autobinx&&(delete w.autobinx,delete w.xbins),w.autobiny&&(delete w.autobiny,delete w.ybins),i(w),w.colorbar&&i(w.colorbar),w.marker&&w.marker.colorbar&&i(w.marker.colorbar),w.line&&w.line.colorbar&&i(w.line.colorbar),w.aaxis&&i(w.aaxis),w.baxis&&i(w.baxis)}},Q.swapXYData=function(l){var T;if(x.swapAttrs(l,["?","?0","d?","?bins","nbins?","autobin?","?src","error_?"]),Array.isArray(l.z)&&Array.isArray(l.z[0])&&(l.transpose?delete l.transpose:l.transpose=!0),l.error_x&&l.error_y){var _=l.error_y,w="copy_ystyle"in _?_.copy_ystyle:!(_.color||_.thickness||_.width);x.swapAttrs(l,["error_?.copy_ystyle"]),w&&x.swapAttrs(l,["error_?.color","error_?.thickness","error_?.width"])}if("string"==typeof l.hoverinfo){var k=l.hoverinfo.split("+");for(T=0;T<k.length;T++)"x"===k[T]?k[T]="y":"y"===k[T]&&(k[T]="x");l.hoverinfo=k.join("+")}},Q.coerceTraceIndices=function(l,T){if(g(T))return[T];if(!Array.isArray(T)||!T.length)return l.data.map(function(k,L){return L});if(Array.isArray(T)){for(var _=[],w=0;w<T.length;w++)x.isIndex(T[w],l.data.length)?_.push(T[w]):x.warn("trace index (",T[w],") is not a number or is out of bounds");return _}return T},Q.manageArrayContainers=function(l,T,_){var w=l.obj,k=l.parts,L=k.length,M=k[L-1],I=g(M);if(I&&null===T){var P=k.slice(0,L-1).join(".");x.nestedProperty(w,P).get().splice(M,1)}else I&&void 0===l.get()&&void 0===l.get()&&(_[l.astr]=null),l.set(T)};var p=/(\.[^\[\]\.]+|\[[^\[\]\.]+\])$/;function o(l){var T=l.search(p);if(T>0)return l.substr(0,T)}Q.hasParent=function(l,T){for(var _=o(T);_;){if(_ in l)return!0;_=o(_)}return!1};var b=["x","y","z"];Q.clearAxisTypes=function(l,T,_){for(var w=0;w<T.length;w++)for(var k=l._fullData[w],L=0;L<3;L++){var M=r(l,k,b[L]);if(M&&"log"!==M.type){var I=M._name,P=M._id.substr(1);if("scene"===P.substr(0,5)){if(void 0!==_[P])continue;I=P+"."+I}var S=I+".type";void 0===_[I]&&void 0===_[S]&&x.nestedProperty(l.layout,S).set(null)}}}},{"../components/color":367,"../lib":515,"../plots/cartesian/axis_ids":570,"../plots/plots":628,"../registry":647,"fast-isnumeric":190,"gl-mat4/fromQuat":200}],550:[function(y,ee,Q){"use strict";var g=y("./plot_api");Q._doPlot=g._doPlot,Q.newPlot=g.newPlot,Q.restyle=g.restyle,Q.relayout=g.relayout,Q.redraw=g.redraw,Q.update=g.update,Q._guiRestyle=g._guiRestyle,Q._guiRelayout=g._guiRelayout,Q._guiUpdate=g._guiUpdate,Q._storeDirectGUIEdit=g._storeDirectGUIEdit,Q.react=g.react,Q.extendTraces=g.extendTraces,Q.prependTraces=g.prependTraces,Q.addTraces=g.addTraces,Q.deleteTraces=g.deleteTraces,Q.moveTraces=g.moveTraces,Q.purge=g.purge,Q.addFrames=g.addFrames,Q.deleteFrames=g.deleteFrames,Q.animate=g.animate,Q.setPlotConfig=g.setPlotConfig,Q.toImage=y("./to_image"),Q.validate=y("./validate"),Q.downloadImage=y("../snapshot/download");var v=y("./template_api");Q.makeTemplate=v.makeTemplate,Q.validateTemplate=v.validateTemplate},{"../snapshot/download":649,"./plot_api":552,"./template_api":557,"./to_image":558,"./validate":559}],551:[function(y,ee,Q){"use strict";var g=y("../lib/is_plain_object"),v=y("../lib/noop"),m=y("../lib/loggers"),x=y("../lib/search").sorterAsc,e=y("../registry");Q.containerArrayMatch=y("./container_array_match");var n=Q.isAddVal=function(a){return"add"===a||g(a)},t=Q.isRemoveVal=function(a){return null===a||"remove"===a};Q.applyContainerArrayChanges=function(a,r,d,s,i){var u=r.astr,f=e.getComponentMethod(u,"supplyLayoutDefaults"),c=e.getComponentMethod(u,"draw"),h=e.getComponentMethod(u,"drawOne"),p=s.replot||s.recalc||f===v||c===v,o=a.layout,b=a._fullLayout;if(d[""]){Object.keys(d).length>1&&m.warn("Full array edits are incompatible with other edits",u);var l=d[""][""];if(t(l))r.set(null);else{if(!Array.isArray(l))return m.warn("Unrecognized full array edit value",u,l),!0;r.set(l)}return!p&&(f(o,b),c(a),!0)}var T,_,w,k,L,M,I,S=Object.keys(d).map(Number).sort(x),E=r.get(),z=E||[],R=i(b,u).get(),q=[],V=-1,W=z.length;for(T=0;T<S.length;T++)if(k=d[w=S[T]],L=Object.keys(k),I=n(M=k[""]),w<0||w>z.length-(I?0:1))m.warn("index out of range",u,w);else if(void 0!==M)L.length>1&&m.warn("Insertion & removal are incompatible with edits to the same index.",u,w),t(M)?q.push(w):I?("add"===M&&(M={}),z.splice(w,0,M),R&&R.splice(w,0,{})):m.warn("Unrecognized full object edit value",u,w,M),-1===V&&(V=w);else for(_=0;_<L.length;_++)i(z[w],L[_],u+"["+w+"].").set(k[L[_]]);for(T=q.length-1;T>=0;T--)z.splice(q[T],1),R&&R.splice(q[T],1);if(z.length?E||r.set(z):r.set(null),p)return!1;if(f(o,b),h!==v){var K;if(-1===V)K=S;else{for(W=Math.max(z.length,W),K=[],T=0;T<S.length&&!((w=S[T])>=V);T++)K.push(w);for(T=V;T<W;T++)K.push(T)}for(T=0;T<K.length;T++)h(a,K[T])}else c(a);return!0}},{"../lib/is_plain_object":516,"../lib/loggers":519,"../lib/noop":524,"../lib/search":535,"../registry":647,"./container_array_match":547}],552:[function(y,ee,Q){"use strict";var g=y("@plotly/d3"),v=y("fast-isnumeric"),m=y("has-hover"),x=y("../lib"),e=x.nestedProperty,n=y("../lib/events"),t=y("../lib/queue"),a=y("../registry"),r=y("./plot_schema"),d=y("../plots/plots"),s=y("../plots/cartesian/axes"),i=y("../components/drawing"),u=y("../components/color"),f=y("../plots/cartesian/graph_interact").initInteractions,c=y("../constants/xmlns_namespaces"),h=y("../components/selections").clearOutline,p=y("./plot_config").dfltConfig,o=y("./manage_arrays"),b=y("./helpers"),l=y("./subroutines"),T=y("./edit_types"),_=y("../plots/cartesian/constants").AX_NAME_PATTERN,w=0;function k(fe){var ve=fe._fullLayout;ve._redrawFromAutoMarginCount?ve._redrawFromAutoMarginCount--:fe.emit("plotly_afterplot")}function L(fe,ve){try{fe._fullLayout._paper.style("background",ve)}catch(Ae){x.error(Ae)}}function M(fe,ve){L(fe,u.combine(ve,"white"))}function I(fe,ve){if(!fe._context){fe._context=x.extendDeep({},p);var Ae=g.select("base");fe._context._baseUrl=Ae.size()&&Ae.attr("href")?window.location.href.split("#")[0]:""}var ke,Pe,Ne,De=fe._context;if(ve){for(Pe=Object.keys(ve),ke=0;ke<Pe.length;ke++)"editable"!==(Ne=Pe[ke])&&"edits"!==Ne&&Ne in De&&(De[Ne]="setBackground"===Ne&&"opaque"===ve[Ne]?M:ve[Ne]);ve.plot3dPixelRatio&&!De.plotGlPixelRatio&&(De.plotGlPixelRatio=De.plot3dPixelRatio);var ze=ve.editable;if(void 0!==ze)for(De.editable=ze,Pe=Object.keys(De.edits),ke=0;ke<Pe.length;ke++)De.edits[Pe[ke]]=ze;if(ve.edits)for(Pe=Object.keys(ve.edits),ke=0;ke<Pe.length;ke++)(Ne=Pe[ke])in De.edits&&(De.edits[Ne]=ve.edits[Ne]);De._exportedPlot=ve._exportedPlot}De.staticPlot&&(De.editable=!1,De.edits={},De.autosizable=!1,De.scrollZoom=!1,De.doubleClick=!1,De.showTips=!1,De.showLink=!1,De.displayModeBar=!1),"hover"!==De.displayModeBar||m||(De.displayModeBar=!0),"transparent"!==De.setBackground&&"function"==typeof De.setBackground||(De.setBackground=L),De._hasZeroHeight=De._hasZeroHeight||0===fe.clientHeight,De._hasZeroWidth=De._hasZeroWidth||0===fe.clientWidth;var Me=De.scrollZoom,Se=De._scrollZoom={};if(!0===Me)Se.cartesian=1,Se.gl3d=1,Se.geo=1,Se.mapbox=1;else if("string"==typeof Me){var Ie=Me.split("+");for(ke=0;ke<Ie.length;ke++)Se[Ie[ke]]=1}else!1!==Me&&(Se.gl3d=1,Se.geo=1,Se.mapbox=1)}function P(fe,ve){var Ae,ke,Pe=ve+1,Ne=[];for(Ae=0;Ae<fe.length;Ae++)(ke=fe[Ae])<0?Ne.push(Pe+ke):Ne.push(ke);return Ne}function S(fe,ve,Ae){var ke,Pe;for(ke=0;ke<ve.length;ke++){if((Pe=ve[ke])!==parseInt(Pe,10))throw new Error("all values in "+Ae+" must be integers");if(Pe>=fe.data.length||Pe<-fe.data.length)throw new Error(Ae+" must be valid indices for gd.data.");if(ve.indexOf(Pe,ke+1)>-1||Pe>=0&&ve.indexOf(-fe.data.length+Pe)>-1||Pe<0&&ve.indexOf(fe.data.length+Pe)>-1)throw new Error("each index in "+Ae+" must be unique.")}}function E(fe,ve,Ae){if(!Array.isArray(fe.data))throw new Error("gd.data must be an array.");if(void 0===ve)throw new Error("currentIndices is a required argument.");if(Array.isArray(ve)||(ve=[ve]),S(fe,ve,"currentIndices"),void 0===Ae||Array.isArray(Ae)||(Ae=[Ae]),void 0!==Ae&&S(fe,Ae,"newIndices"),void 0!==Ae&&ve.length!==Ae.length)throw new Error("current and new indices must be of equal length.")}function z(fe,ve,Ae,ke,Pe){!function(Re,Xe,nt,ct){var xt=x.isPlainObject(ct);if(!Array.isArray(Re.data))throw new Error("gd.data must be an array");if(!x.isPlainObject(Xe))throw new Error("update must be a key:value object");if(void 0===nt)throw new Error("indices must be an integer or array of integers");for(var dt in S(Re,nt,"indices"),Xe){if(!Array.isArray(Xe[dt])||Xe[dt].length!==nt.length)throw new Error("attribute "+dt+" must be an array of length equal to indices array length");if(xt&&(!(dt in ct)||!Array.isArray(ct[dt])||ct[dt].length!==Xe[dt].length))throw new Error("when maxPoints is set as a key:value object it must contain a 1:1 corrispondence with the keys and number of traces in the update object")}}(fe,ve,Ae,ke);for(var Ne=function(Re,Xe,nt,ct){var dt,tt,Ke,mt,Bt=x.isPlainObject(ct),Ut=[];for(var er in Array.isArray(nt)||(nt=[nt]),nt=P(nt,Re.data.length-1),Xe)for(var Wt=0;Wt<nt.length;Wt++){if(dt=(tt=e(Re.data[nt[Wt]],er)).get(),!x.isArrayOrTypedArray(Ke=Xe[er][Wt]))throw new Error("attribute: "+er+" index: "+Wt+" must be an array");if(!x.isArrayOrTypedArray(dt))throw new Error("cannot extend missing or non-array attribute: "+er);if(dt.constructor!==Ke.constructor)throw new Error("cannot extend array with an array of a different type: "+er);v(mt=Bt?ct[er][Wt]:ct)||(mt=-1),Ut.push({prop:tt,target:dt,insert:Ke,maxp:Math.floor(mt)})}return Ut}(fe,ve,Ae,ke),De={},ze={},Me=0;Me<Ne.length;Me++){var Se=Ne[Me].prop,Fe=Pe(Ne[Me].target,Ne[Me].insert,Ne[Me].maxp);Se.set(Fe[0]),Array.isArray(De[Se.astr])||(De[Se.astr]=[]),De[Se.astr].push(Fe[1]),Array.isArray(ze[Se.astr])||(ze[Se.astr]=[]),ze[Se.astr].push(Ne[Me].target.length)}return{update:De,maxPoints:ze}}function R(fe,ve){var Ae=new fe.constructor(fe.length+ve.length);return Ae.set(fe),Ae.set(ve,fe.length),Ae}function q(fe,ve,Ae,ke){fe=x.getGraphDiv(fe),b.clearPromiseQueue(fe);var Pe={};if("string"==typeof ve)Pe[ve]=Ae;else{if(!x.isPlainObject(ve))return x.warn("Restyle fail.",ve,Ae,ke),Promise.reject();Pe=x.extendFlat({},ve),void 0===ke&&(ke=Ae)}Object.keys(Pe).length&&(fe.changed=!0);var Ne=b.coerceTraceIndices(fe,ke),De=G(fe,Pe,Ne),ze=De.flags;ze.calc&&(fe.calcdata=void 0),ze.clearAxisTypes&&b.clearAxisTypes(fe,Ne,{});var Me=[];ze.fullReplot?Me.push(Q._doPlot):(Me.push(d.previousPromises),d.supplyDefaults(fe),ze.markerSize&&(d.doCalcdata(fe),N(Me)),ze.style&&Me.push(l.doTraceStyle),ze.colorbars&&Me.push(l.doColorBars),Me.push(k)),Me.push(d.rehover,d.redrag,d.reselect),t.add(fe,q,[fe,De.undoit,De.traces],q,[fe,De.redoit,De.traces]);var Se=x.syncOrAsync(Me,fe);return Se&&Se.then||(Se=Promise.resolve()),Se.then(function(){return fe.emit("plotly_restyle",De.eventData),fe})}function V(fe){return void 0===fe?null:fe}function W(fe,ve){return ve?function(Ae,ke,Pe){var Ne=e(Ae,ke),De=Ne.set;return Ne.set=function(ze){K((Pe||"")+ke,Ne.get(),ze,fe),De(ze)},Ne}:e}function K(fe,ve,Ae,ke){if(Array.isArray(ve)||Array.isArray(Ae))for(var Pe=Array.isArray(ve)?ve:[],Ne=Array.isArray(Ae)?Ae:[],De=Math.max(Pe.length,Ne.length),ze=0;ze<De;ze++)K(fe+"["+ze+"]",Pe[ze],Ne[ze],ke);else if(x.isPlainObject(ve)||x.isPlainObject(Ae)){var Me=x.isPlainObject(ve)?ve:{},Se=x.isPlainObject(Ae)?Ae:{},Ie=x.extendFlat({},Me,Se);for(var Fe in Ie)K(fe+"."+Fe,Me[Fe],Se[Fe],ke)}else void 0===ke[fe]&&(ke[fe]=V(ve))}function G(fe,ve,Ae){var ke,Pe=fe._fullLayout,Ne=fe._fullData,De=fe.data,ze=Pe._guiEditing,Me=W(Pe._preGUI,ze),Se=x.extendDeepAll({},ve);Y(ve);var Ie,Fe=T.traceFlags(),Re={},Xe={};function nt(){return Ae.map(function(){})}function ct(it){var ht=s.id2name(it);-1===Ie.indexOf(ht)&&Ie.push(ht)}function xt(it){return"LAYOUT"+it+".autorange"}function dt(it){return"LAYOUT"+it+".range"}function tt(it){for(var ht=it;ht<Ne.length;ht++)if(Ne[ht]._input===De[it])return Ne[ht]}function Ke(it,ht,At){if(Array.isArray(it))it.forEach(function(jt){Ke(jt,ht,At)});else if(!(it in ve)&&!b.hasParent(ve,it)){var Ft;if("LAYOUT"===it.substr(0,6))Ft=Me(fe.layout,it.replace("LAYOUT",""));else{var Gt=Ae[At];Ft=W(Pe._tracePreGUI[tt(Gt)._fullInput.uid],ze)(De[Gt],it)}it in Xe||(Xe[it]=nt()),void 0===Xe[it][At]&&(Xe[it][At]=V(Ft.get())),void 0!==ht&&Ft.set(ht)}}function mt(it){return function(ht){return Ne[ht][it]}}function Bt(it){return function(ht,At){return!1===ht?Ne[Ae[At]][it]:null}}for(var Ut in ve){if(b.hasParent(ve,Ut))throw new Error("cannot set "+Ut+" and a parent attribute simultaneously");var er,Wt,rr,Ht,Ve,We,he=ve[Ut];if("autobinx"!==Ut&&"autobiny"!==Ut||(Ut=Ut.charAt(Ut.length-1)+"bins",he=Array.isArray(he)?he.map(Bt(Ut)):!1===he?Ae.map(mt(Ut)):null),Re[Ut]=he,"LAYOUT"!==Ut.substr(0,6)){for(Xe[Ut]=nt(),ke=0;ke<Ae.length;ke++)if(er=De[Ae[ke]],Wt=tt(Ae[ke]),Ht=(rr=W(Pe._tracePreGUI[Wt._fullInput.uid],ze)(er,Ut)).get(),void 0!==(Ve=Array.isArray(he)?he[ke%he.length]:he)){var ye=rr.parts[rr.parts.length-1],Be=Ut.substr(0,Ut.length-ye.length-1),Ge=Be?Be+".":"",Je=Be?e(Wt,Be).get():Wt;if((We=r.getTraceValObject(Wt,rr.parts))&&We.impliedEdits&&null!==Ve)for(var He in We.impliedEdits)Ke(x.relativeAttr(Ut,He),We.impliedEdits[He],ke);else if("thicknessmode"!==ye&&"lenmode"!==ye||Ht===Ve||"fraction"!==Ve&&"pixels"!==Ve||!Je){if("type"===Ut&&("pie"===Ve!=("pie"===Ht)||"funnelarea"===Ve!=("funnelarea"===Ht))){var st="x",ot="y";"bar"!==Ve&&"bar"!==Ht||"h"!==er.orientation||(st="y",ot="x"),x.swapAttrs(er,["?","?src"],"labels",st),x.swapAttrs(er,["d?","?0"],"label",st),x.swapAttrs(er,["?","?src"],"values",ot),"pie"===Ht||"funnelarea"===Ht?(e(er,"marker.color").set(e(er,"marker.colors").get()),Pe._pielayer.selectAll("g.trace").remove()):a.traceIs(er,"cartesian")&&e(er,"marker.colors").set(e(er,"marker.color").get())}}else{var wt=Pe._size,Ct=Je.orient,rt="top"===Ct||"bottom"===Ct;if("thicknessmode"===ye){var ft=rt?wt.h:wt.w;Ke(Ge+"thickness",Je.thickness*("fraction"===Ve?1/ft:ft),ke)}else{var Rt=rt?wt.w:wt.h;Ke(Ge+"len",Je.len*("fraction"===Ve?1/Rt:Rt),ke)}}if(Xe[Ut][ke]=V(Ht),-1!==["swapxy","swapxyaxes","orientation","orientationaxes"].indexOf(Ut)){if("orientation"===Ut){rr.set(Ve);var kt=er.x&&!er.y?"h":"v";if((rr.get()||kt)===Wt.orientation)continue}else"orientationaxes"===Ut&&(er.orientation={v:"h",h:"v"}[Wt.orientation]);b.swapXYData(er),Fe.calc=Fe.clearAxisTypes=!0}else-1!==d.dataArrayContainers.indexOf(rr.parts[0])?(b.manageArrayContainers(rr,Ve,Xe),Fe.calc=!0):(We?We.arrayOk&&!a.traceIs(Wt,"regl")&&(x.isArrayOrTypedArray(Ve)||x.isArrayOrTypedArray(Ht))?Fe.calc=!0:T.update(Fe,We):Fe.calc=!0,rr.set(Ve))}if(-1!==["swapxyaxes","orientationaxes"].indexOf(Ut)&&s.swap(fe,Ae),"orientationaxes"===Ut){var Lt=e(fe.layout,"hovermode"),Ee=Lt.get();"x"===Ee?Lt.set("y"):"y"===Ee?Lt.set("x"):"x unified"===Ee?Lt.set("y unified"):"y unified"===Ee&&Lt.set("x unified")}if(-1!==["orientation","type"].indexOf(Ut)){for(Ie=[],ke=0;ke<Ae.length;ke++){var Ye=De[Ae[ke]];a.traceIs(Ye,"cartesian")&&(ct(Ye.xaxis||"x"),ct(Ye.yaxis||"y"))}Ke(Ie.map(xt),!0,0),Ke(Ie.map(dt),[0,1],0)}}else rr=Me(fe.layout,Ut.replace("LAYOUT","")),Xe[Ut]=[V(rr.get())],rr.set(Array.isArray(he)?he[0]:he),Fe.calc=!0}return(Fe.calc||Fe.plot)&&(Fe.fullReplot=!0),{flags:Fe,undoit:Xe,redoit:Re,traces:Ae,eventData:x.extendDeepNoArrays([],[Se,Ae])}}function Y(fe){var ve,Ae,ke,Pe=x.counterRegex("axis",".title",!1,!1),Ne=/colorbar\.title$/,De=Object.keys(fe);for(ve=0;ve<De.length;ve++)ke=fe[Ae=De[ve]],"title"!==Ae&&!Pe.test(Ae)&&!Ne.test(Ae)||"string"!=typeof ke&&"number"!=typeof ke?Ae.indexOf("titlefont")>-1&&-1===Ae.indexOf("grouptitlefont")?ze(Ae,Ae.replace("titlefont","title.font")):Ae.indexOf("titleposition")>-1?ze(Ae,Ae.replace("titleposition","title.position")):Ae.indexOf("titleside")>-1?ze(Ae,Ae.replace("titleside","title.side")):Ae.indexOf("titleoffset")>-1&&ze(Ae,Ae.replace("titleoffset","title.offset")):ze(Ae,Ae.replace("title","title.text"));function ze(Me,Se){fe[Se]=fe[Me],delete fe[Me]}}function $(fe,ve,Ae){fe=x.getGraphDiv(fe),b.clearPromiseQueue(fe);var ke={};if("string"==typeof ve)ke[ve]=Ae;else{if(!x.isPlainObject(ve))return x.warn("Relayout fail.",ve,Ae),Promise.reject();ke=x.extendFlat({},ve)}Object.keys(ke).length&&(fe.changed=!0);var Pe=J(fe,ke),Ne=Pe.flags;Ne.calc&&(fe.calcdata=void 0);var De=[d.previousPromises];Ne.layoutReplot?De.push(l.layoutReplot):Object.keys(ke).length&&(B(fe,Ne,Pe)||d.supplyDefaults(fe),Ne.legend&&De.push(l.doLegend),Ne.layoutstyle&&De.push(l.layoutStyles),Ne.axrange&&N(De,Pe.rangesAltered),Ne.ticks&&De.push(l.doTicksRelayout),Ne.modebar&&De.push(l.doModeBar),Ne.camera&&De.push(l.doCamera),Ne.colorbars&&De.push(l.doColorBars),De.push(k)),De.push(d.rehover,d.redrag,d.reselect),t.add(fe,$,[fe,Pe.undoit],$,[fe,Pe.redoit]);var ze=x.syncOrAsync(De,fe);return ze&&ze.then||(ze=Promise.resolve(fe)),ze.then(function(){return fe.emit("plotly_relayout",Pe.eventData),fe})}function B(fe,ve,Ae){var ke=fe._fullLayout;if(!ve.axrange)return!1;for(var Pe in ve)if("axrange"!==Pe&&ve[Pe])return!1;for(var Ne in Ae.rangesAltered){var De=s.id2name(Ne),ze=fe.layout[De],Me=ke[De];if(Me.autorange=ze.autorange,ze.range&&(Me.range=ze.range.slice()),Me.cleanRange(),Me._matchGroup)for(var Se in Me._matchGroup)if(Se!==Ne){var Ie=ke[s.id2name(Se)];Ie.autorange=Me.autorange,Ie.range=Me.range.slice(),Ie._input.range=Me.range.slice()}}return!0}function N(fe,ve){fe.push(h,l.doAutoRangeAndConstraints,ve?function(ke){var Pe=[],Ne=!0;for(var De in ve){var ze=s.getFromId(ke,De);if(Pe.push(De),-1!==(ze.ticklabelposition||"").indexOf("inside")&&ze._anchorAxis&&Pe.push(ze._anchorAxis._id),ze._matchGroup)for(var Me in ze._matchGroup)ve[Me]||Pe.push(Me);ze.automargin&&(Ne=!1)}return s.draw(ke,Pe,{skipTitle:Ne})}:function(ke){return s.draw(ke,"redraw")},l.drawData,l.finalDraw)}var U=/^[xyz]axis[0-9]*\.range(\[[0|1]\])?$/,te=/^[xyz]axis[0-9]*\.autorange$/,j=/^[xyz]axis[0-9]*\.domain(\[[0|1]\])?$/;function J(fe,ve){var Ae,ke,Pe,Ne=fe.layout,De=fe._fullLayout,Me=W(De._preGUI,De._guiEditing),Se=Object.keys(ve),Ie=s.list(fe),Fe=x.extendDeepAll({},ve),Re={};for(Y(ve),Se=Object.keys(ve),ke=0;ke<Se.length;ke++)if(0===Se[ke].indexOf("allaxes")){for(Pe=0;Pe<Ie.length;Pe++){var Xe=Ie[Pe]._id.substr(1),nt=-1!==Xe.indexOf("scene")?Xe+".":"",ct=Se[ke].replace("allaxes",nt+Ie[Pe]._name);ve[ct]||(ve[ct]=ve[Se[ke]])}delete ve[Se[ke]]}var xt=T.layoutFlags(),dt={},tt={};function Ke(Gt,jt){if(Array.isArray(Gt))Gt.forEach(function(kr){Ke(kr,jt)});else if(!(Gt in ve)&&!b.hasParent(ve,Gt)){var fr=Me(Ne,Gt);Gt in tt||(tt[Gt]=V(fr.get())),void 0!==jt&&fr.set(jt)}}var mt,Bt={};function Ut(Gt){var jt=s.name2id(Gt.split(".")[0]);return Bt[jt]=1,jt}for(var er in ve){if(b.hasParent(ve,er))throw new Error("cannot set "+er+" and a parent attribute simultaneously");for(var Wt=Me(Ne,er),rr=ve[er],Ht=Wt.parts.length-1;Ht>0&&"string"!=typeof Wt.parts[Ht];)Ht--;var Ve=Wt.parts[Ht],We=Wt.parts[Ht-1]+"."+Ve,he=Wt.parts.slice(0,Ht).join("."),ye=e(fe.layout,he).get(),Be=e(De,he).get(),Ge=Wt.get();if(void 0!==rr){dt[er]=rr,tt[er]="reverse"===Ve?rr:V(Ge);var Je=r.getLayoutValObject(De,Wt.parts);if(Je&&Je.impliedEdits&&null!==rr)for(var He in Je.impliedEdits)Ke(x.relativeAttr(er,He),Je.impliedEdits[He]);if(-1!==["width","height"].indexOf(er))if(rr){Ke("autosize",null);var st="height"===er?"width":"height";Ke(st,De[st])}else De[er]=fe._initialAutoSize[er];else if("autosize"===er)Ke("width",rr?null:De.width),Ke("height",rr?null:De.height);else if(We.match(U))Ut(We),e(De,he+"._inputRange").set(null);else if(We.match(te)){Ut(We),e(De,he+"._inputRange").set(null);var ot=e(De,he).get();ot._inputDomain&&(ot._input.domain=ot._inputDomain.slice())}else We.match(j)&&e(De,he+"._inputDomain").set(null);if("type"===Ve){mt=ye;var wt="linear"===Be.type&&"log"===rr;if(wt||"log"===Be.type&&"linear"===rr){if(mt&&mt.range)if(Be.autorange)wt&&(mt.range=mt.range[1]>mt.range[0]?[1,2]:[2,1]);else{var rt=mt.range[0],ft=mt.range[1];wt?(rt<=0&&ft<=0&&Ke(he+".autorange",!0),rt<=0?rt=ft/1e6:ft<=0&&(ft=rt/1e6),Ke(he+".range[0]",Math.log(rt)/Math.LN10),Ke(he+".range[1]",Math.log(ft)/Math.LN10)):(Ke(he+".range[0]",Math.pow(10,rt)),Ke(he+".range[1]",Math.pow(10,ft)))}else Ke(he+".autorange",!0);Array.isArray(De._subplots.polar)&&De._subplots.polar.length&&De[Wt.parts[0]]&&"radialaxis"===Wt.parts[1]&&delete De[Wt.parts[0]]._subplot.viewInitial["radialaxis.range"],a.getComponentMethod("annotations","convertCoords")(fe,Be,rr,Ke),a.getComponentMethod("images","convertCoords")(fe,Be,rr,Ke)}else Ke(he+".autorange",!0),Ke(he+".range",null);e(De,he+"._inputRange").set(null)}else if(Ve.match(_)){var Rt=e(De,er).get(),kt=(rr||{}).type;kt&&"-"!==kt||(kt="linear"),a.getComponentMethod("annotations","convertCoords")(fe,Rt,kt,Ke),a.getComponentMethod("images","convertCoords")(fe,Rt,kt,Ke)}var Lt=o.containerArrayMatch(er);if(Lt){Ae=Lt.array;var Ee=Lt.property,Ye=Je||{editType:"calc"};""!==(ke=Lt.index)&&""===Ee&&(o.isAddVal(rr)?tt[er]=null:o.isRemoveVal(rr)?tt[er]=(e(Ne,Ae).get()||[])[ke]:x.warn("unrecognized full object value",ve)),T.update(xt,Ye),Re[Ae]||(Re[Ae]={});var it=Re[Ae][ke];it||(it=Re[Ae][ke]={}),it[Ee]=rr,delete ve[er]}else"reverse"===Ve?(ye.range?ye.range.reverse():(Ke(he+".autorange",!0),ye.range=[1,0]),Be.autorange?xt.calc=!0:xt.plot=!0):("dragmode"===er&&(!1===rr&&!1!==Ge||!1!==rr&&!1===Ge)||De._has("scatter-like")&&De._has("regl")&&"dragmode"===er&&("lasso"===rr||"select"===rr)&&"lasso"!==Ge&&"select"!==Ge||De._has("gl2d")?xt.plot=!0:Je?T.update(xt,Je):xt.calc=!0,Wt.set(rr))}}for(Ae in Re)o.applyContainerArrayChanges(fe,Me(Ne,Ae),Re[Ae],xt,Me)||(xt.plot=!0);for(var ht in Bt){var At=(mt=s.getFromId(fe,ht))&&mt._constraintGroup;if(At)for(var Ft in xt.calc=!0,At)Bt[Ft]||(s.getFromId(fe,Ft)._constraintShrinkable=!0)}return(X(fe)||ve.height||ve.width)&&(xt.plot=!0),(xt.plot||xt.calc)&&(xt.layoutReplot=!0),{flags:xt,rangesAltered:Bt,undoit:tt,redoit:dt,eventData:Fe}}function X(fe){var ve=fe._fullLayout,Ae=ve.width,ke=ve.height;return fe.layout.autosize&&d.plotAutoSize(fe,fe.layout,ve),ve.width!==Ae||ve.height!==ke}function re(fe,ve,Ae,ke){fe=x.getGraphDiv(fe),b.clearPromiseQueue(fe),x.isPlainObject(ve)||(ve={}),x.isPlainObject(Ae)||(Ae={}),Object.keys(ve).length&&(fe.changed=!0),Object.keys(Ae).length&&(fe.changed=!0);var Pe=b.coerceTraceIndices(fe,ke),Ne=G(fe,x.extendFlat({},ve),Pe),De=Ne.flags,ze=J(fe,x.extendFlat({},Ae)),Me=ze.flags;(De.calc||Me.calc)&&(fe.calcdata=void 0),De.clearAxisTypes&&b.clearAxisTypes(fe,Pe,Ae);var Se=[];Me.layoutReplot?Se.push(l.layoutReplot):De.fullReplot?Se.push(Q._doPlot):(Se.push(d.previousPromises),B(fe,Me,ze)||d.supplyDefaults(fe),De.style&&Se.push(l.doTraceStyle),(De.colorbars||Me.colorbars)&&Se.push(l.doColorBars),Me.legend&&Se.push(l.doLegend),Me.layoutstyle&&Se.push(l.layoutStyles),Me.axrange&&N(Se,ze.rangesAltered),Me.ticks&&Se.push(l.doTicksRelayout),Me.modebar&&Se.push(l.doModeBar),Me.camera&&Se.push(l.doCamera),Se.push(k)),Se.push(d.rehover,d.redrag,d.reselect),t.add(fe,re,[fe,Ne.undoit,ze.undoit,Ne.traces],re,[fe,Ne.redoit,ze.redoit,Ne.traces]);var Ie=x.syncOrAsync(Se,fe);return Ie&&Ie.then||(Ie=Promise.resolve(fe)),Ie.then(function(){return fe.emit("plotly_update",{data:Ne.eventData,layout:ze.eventData}),fe})}function ne(fe){return function(ve){ve._fullLayout._guiEditing=!0;var Ae=fe.apply(null,arguments);return ve._fullLayout._guiEditing=!1,Ae}}var le=[{pattern:/^hiddenlabels/,attr:"legend.uirevision"},{pattern:/^((x|y)axis\d*)\.((auto)?range|title\.text)/},{pattern:/axis\d*\.showspikes$/,attr:"modebar.uirevision"},{pattern:/(hover|drag)mode$/,attr:"modebar.uirevision"},{pattern:/^(scene\d*)\.camera/},{pattern:/^(geo\d*)\.(projection|center|fitbounds)/},{pattern:/^(ternary\d*\.[abc]axis)\.(min|title\.text)$/},{pattern:/^(polar\d*\.radialaxis)\.((auto)?range|angle|title\.text)/},{pattern:/^(polar\d*\.angularaxis)\.rotation/},{pattern:/^(mapbox\d*)\.(center|zoom|bearing|pitch)/},{pattern:/^legend\.(x|y)$/,attr:"editrevision"},{pattern:/^(shapes|annotations)/,attr:"editrevision"},{pattern:/^title\.text$/,attr:"editrevision"}],oe=[{pattern:/^selectedpoints$/,attr:"selectionrevision"},{pattern:/(^|value\.)visible$/,attr:"legend.uirevision"},{pattern:/^dimensions\[\d+\]\.constraintrange/},{pattern:/^node\.(x|y|groups)/},{pattern:/^level$/},{pattern:/(^|value\.)name$/},{pattern:/colorbar\.title\.text$/},{pattern:/colorbar\.(x|y)$/,attr:"editrevision"}];function de(fe,ve){for(var Ae=0;Ae<ve.length;Ae++){var ke=ve[Ae],Pe=fe.match(ke.pattern);if(Pe){var Ne=Pe[1]||"";return{head:Ne,tail:fe.substr(Ne.length+1),attr:ke.attr}}}}function se(fe,ve){var Ae=e(ve,fe).get();if(void 0!==Ae)return Ae;var ke=fe.split(".");for(ke.pop();ke.length>1;)if(ke.pop(),void 0!==(Ae=e(ve,ke.join(".")+".uirevision").get()))return Ae;return ve.uirevision}function ge(fe,ve){for(var Ae=0;Ae<ve.length;Ae++)if(ve[Ae]._fullInput.uid===fe)return Ae;return-1}function _e(fe,ve,Ae){for(var ke=0;ke<ve.length;ke++)if(ve[ke].uid===fe)return ke;return!ve[Ae]||ve[Ae].uid?-1:Ae}function Te(fe,ve){var Ae=x.isPlainObject(fe),ke=Array.isArray(fe);return Ae||ke?(Ae&&x.isPlainObject(ve)||ke&&Array.isArray(ve))&&JSON.stringify(fe)===JSON.stringify(ve):fe===ve}function we(fe,ve,Ae,ke){var Pe,Ne,De,ze=ke.getValObject,Me=ke.flags,Se=ke.immutable,Ie=ke.inArray,Fe=ke.arrayIndex;function Re(){var ye=Pe.editType;Ie&&-1!==ye.indexOf("arraydraw")?x.pushUnique(Me.arrays[Ie],Fe):(T.update(Me,Pe),"none"!==ye&&Me.nChanges++,ke.transition&&Pe.anim&&Me.nChangesAnim++,(U.test(De)||te.test(De))&&(Me.rangesAltered[Ae[0]]=1),j.test(De)&&e(ve,"_inputDomain").set(null),"datarevision"===Ne&&(Me.newDataRevision=1))}function Xe(ye){return"data_array"===ye.valType||ye.arrayOk}for(Ne in fe){if(Me.calc&&!ke.transition)return;var nt=fe[Ne],ct=ve[Ne],xt=Ae.concat(Ne);if(De=xt.join("."),"_"!==Ne.charAt(0)&&"function"!=typeof nt&&nt!==ct){if(("tick0"===Ne||"dtick"===Ne)&&"geo"!==Ae[0]){var dt=ve.tickmode;if("auto"===dt||"array"===dt||!dt)continue}if(("range"!==Ne||!ve.autorange)&&("zmin"!==Ne&&"zmax"!==Ne||"contourcarpet"!==ve.type)&&(Pe=ze(xt))&&(!Pe._compareAsJSON||JSON.stringify(nt)!==JSON.stringify(ct))){var tt,Ke=Pe.valType,mt=Xe(Pe),Bt=Array.isArray(nt),Ut=Array.isArray(ct);if(Bt&&Ut){var er="_input_"+Ne,Wt=fe[er],rr=ve[er];if(Array.isArray(Wt)&&Wt===rr)continue}if(void 0===ct)mt&&Bt?Me.calc=!0:Re();else if(Pe._isLinkedToArray){var Ht=[],Ve=!1;Ie||(Me.arrays[Ne]=Ht);var We=Math.min(nt.length,ct.length),he=Math.max(nt.length,ct.length);if(We!==he){if("arraydraw"!==Pe.editType){Re();continue}Ve=!0}for(tt=0;tt<We;tt++)we(nt[tt],ct[tt],xt.concat(tt),x.extendFlat({inArray:Ne,arrayIndex:tt},ke));if(Ve)for(tt=We;tt<he;tt++)Ht.push(tt)}else!Ke&&x.isPlainObject(nt)?we(nt,ct,xt,ke):mt?Bt&&Ut?(Se&&(Me.calc=!0),(Se||ke.newDataRevision)&&Re()):Bt!==Ut?Me.calc=!0:Re():Bt&&Ut&&nt.length===ct.length&&String(nt)===String(ct)||Re()}}}for(Ne in ve)if(!(Ne in fe)&&"_"!==Ne.charAt(0)&&"function"!=typeof ve[Ne]){if(Xe(Pe=ze(Ae.concat(Ne)))&&Array.isArray(ve[Ne]))return void(Me.calc=!0);Re()}}function Oe(fe){var ve=fe._fullLayout,Ae=fe.getBoundingClientRect();if(!x.equalDomRects(Ae,ve._lastBBox)){var ke=ve._invTransform=x.inverseTransformMatrix(x.getFullTransformMatrix(fe));ve._invScaleX=Math.sqrt(ke[0][0]*ke[0][0]+ke[0][1]*ke[0][1]+ke[0][2]*ke[0][2]),ve._invScaleY=Math.sqrt(ke[1][0]*ke[1][0]+ke[1][1]*ke[1][1]+ke[1][2]*ke[1][2]),ve._lastBBox=Ae}}Q.animate=function(fe,ve,Ae){if(fe=x.getGraphDiv(fe),!x.isPlotDiv(fe))throw new Error("This element is not a Plotly plot: "+fe+". It's likely that you've failed to create a plot before animating it. For more details, see https://plotly.com/javascript/animations/");var ke=fe._transitionData;ke._frameQueue||(ke._frameQueue=[]);var Pe=(Ae=d.supplyAnimationDefaults(Ae)).transition,Ne=Ae.frame;function De(Se){return Array.isArray(Pe)?Se>=Pe.length?Pe[0]:Pe[Se]:Pe}function ze(Se){return Array.isArray(Ne)?Se>=Ne.length?Ne[0]:Ne[Se]:Ne}function Me(Se,Ie){var Fe=0;return function(){if(Se&&++Fe===Ie)return Se()}}return void 0===ke._frameWaitingCnt&&(ke._frameWaitingCnt=0),new Promise(function(Se,Ie){function Re(){fe.emit("plotly_animating"),ke._lastFrameAt=-1/0,ke._timeToNext=0,ke._runningTransitions=0,ke._currentFrame=null;var Wt=function(){ke._animationRaf=window.requestAnimationFrame(Wt),Date.now()-ke._lastFrameAt>ke._timeToNext&&function Fe(){ke._currentFrame&&ke._currentFrame.onComplete&&ke._currentFrame.onComplete();var Wt=ke._currentFrame=ke._frameQueue.shift();if(Wt){var rr=Wt.name?Wt.name.toString():null;fe._fullLayout._currentFrame=rr,ke._lastFrameAt=Date.now(),ke._timeToNext=Wt.frameOpts.duration,d.transition(fe,Wt.frame.data,Wt.frame.layout,b.coerceTraceIndices(fe,Wt.frame.traces),Wt.frameOpts,Wt.transitionOpts).then(function(){Wt.onComplete&&Wt.onComplete()}),fe.emit("plotly_animatingframe",{name:rr,frame:Wt.frame,animation:{frame:Wt.frameOpts,transition:Wt.transitionOpts}})}else fe.emit("plotly_animated"),window.cancelAnimationFrame(ke._animationRaf),ke._animationRaf=null}()};Wt()}var Xe,nt,ct=0;function xt(Wt){return Wt.transitionOpts=Array.isArray(Pe)?ct>=Pe.length?Pe[ct]:Pe[0]:Pe,ct++,Wt}var dt=[],tt=null==ve,Ke=Array.isArray(ve);if(tt||Ke||!x.isPlainObject(ve)){if(tt||-1!==["string","number"].indexOf(typeof ve))for(Xe=0;Xe<ke._frames.length;Xe++)(nt=ke._frames[Xe])&&(tt||String(nt.group)===String(ve))&&dt.push({type:"byname",name:String(nt.name),data:xt({name:nt.name})});else if(Ke)for(Xe=0;Xe<ve.length;Xe++){var mt=ve[Xe];-1!==["number","string"].indexOf(typeof mt)?(mt=String(mt),dt.push({type:"byname",name:mt,data:xt({name:mt})})):x.isPlainObject(mt)&&dt.push({type:"object",data:xt(x.extendFlat({},mt))})}}else dt.push({type:"object",data:xt(x.extendFlat({},ve))});for(Xe=0;Xe<dt.length;Xe++)if("byname"===(nt=dt[Xe]).type&&!ke._frameHash[nt.data.name])return x.warn('animate failure: frame not found: "'+nt.data.name+'"'),void Ie();-1!==["next","immediate"].indexOf(Ae.mode)&&function(){if(0!==ke._frameQueue.length){for(;ke._frameQueue.length;){var Wt=ke._frameQueue.pop();Wt.onInterrupt&&Wt.onInterrupt()}fe.emit("plotly_animationinterrupted",[])}}(),"reverse"===Ae.direction&&dt.reverse();var Bt=fe._fullLayout._currentFrame;if(Bt&&Ae.fromcurrent){var Ut=-1;for(Xe=0;Xe<dt.length;Xe++)if("byname"===(nt=dt[Xe]).type&&nt.name===Bt){Ut=Xe;break}if(Ut>0&&Ut<dt.length-1){var er=[];for(Xe=0;Xe<dt.length;Xe++)nt=dt[Xe],("byname"!==dt[Xe].type||Xe>Ut)&&er.push(nt);dt=er}}dt.length>0?function(Wt){if(0!==Wt.length){for(var rr=0;rr<Wt.length;rr++){var Ht;Ht="byname"===Wt[rr].type?d.computeFrame(fe,Wt[rr].name):Wt[rr].data;var Ve=ze(rr),We=De(rr);We.duration=Math.min(We.duration,Ve.duration);var he={frame:Ht,name:Wt[rr].name,frameOpts:Ve,transitionOpts:We};rr===Wt.length-1&&(he.onComplete=Me(Se,2),he.onInterrupt=Ie),ke._frameQueue.push(he)}"immediate"===Ae.mode&&(ke._lastFrameAt=-1/0),ke._animationRaf||Re()}}(dt):(fe.emit("plotly_animated"),Se())})},Q.addFrames=function(fe,ve,Ae){if(fe=x.getGraphDiv(fe),null==ve)return Promise.resolve();if(!x.isPlotDiv(fe))throw new Error("This element is not a Plotly plot: "+fe+". It's likely that you've failed to create a plot before adding frames. For more details, see https://plotly.com/javascript/animations/");var ke,Pe,Ne,De,ze=fe._transitionData._frames,Me=fe._transitionData._frameHash;if(!Array.isArray(ve))throw new Error("addFrames failure: frameList must be an Array of frame definitions"+ve);var Se=ze.length+2*ve.length,Ie=[],Fe={};for(ke=ve.length-1;ke>=0;ke--)if(x.isPlainObject(ve[ke])){var Re=ve[ke].name,Xe=(Me[Re]||Fe[Re]||{}).name,nt=ve[ke].name;Xe&&nt&&"number"==typeof nt&&(Me[Xe]||Fe[Xe])&&w<5&&(w++,x.warn('addFrames: overwriting frame "'+(Me[Xe]||Fe[Xe]).name+'" with a frame whose name of type "number" also equates to "'+Xe+'". This is valid but may potentially lead to unexpected behavior since all plotly.js frame names are stored internally as strings.'),5===w&&x.warn("addFrames: This API call has yielded too many of these warnings. For the rest of this call, further warnings about numeric frame names will be suppressed.")),Fe[Re]={name:Re},Ie.push({frame:d.supplyFrameDefaults(ve[ke]),index:Ae&&null!=Ae[ke]?Ae[ke]:Se+ke})}Ie.sort(function(er,Wt){return er.index>Wt.index?-1:er.index<Wt.index?1:0});var xt=[],dt=[],tt=ze.length;for(ke=Ie.length-1;ke>=0;ke--){if("number"==typeof(Pe=Ie[ke].frame).name&&x.warn("Warning: addFrames accepts frames with numeric names, but the numbers areimplicitly cast to strings"),!Pe.name)for(;Me[Pe.name="frame "+fe._transitionData._counter++];);if(Me[Pe.name]){for(Ne=0;Ne<ze.length&&(ze[Ne]||{}).name!==Pe.name;Ne++);xt.push({type:"replace",index:Ne,value:Pe}),dt.unshift({type:"replace",index:Ne,value:ze[Ne]})}else De=Math.max(0,Math.min(Ie[ke].index,tt)),xt.push({type:"insert",index:De,value:Pe}),dt.unshift({type:"delete",index:De}),tt++}return t&&t.add(fe,d.modifyFrames,[fe,dt],d.modifyFrames,[fe,xt]),d.modifyFrames(fe,xt)},Q.deleteFrames=function(fe,ve){if(fe=x.getGraphDiv(fe),!x.isPlotDiv(fe))throw new Error("This element is not a Plotly plot: "+fe);var Ae,ke,Pe=fe._transitionData._frames,Ne=[],De=[];if(!ve)for(ve=[],Ae=0;Ae<Pe.length;Ae++)ve.push(Ae);for((ve=ve.slice()).sort(),Ae=ve.length-1;Ae>=0;Ae--)Ne.push({type:"delete",index:ke=ve[Ae]}),De.unshift({type:"insert",index:ke,value:Pe[ke]});return t&&t.add(fe,d.modifyFrames,[fe,De],d.modifyFrames,[fe,Ne]),d.modifyFrames(fe,Ne)},Q.addTraces=function fe(ve,Ae,ke){ve=x.getGraphDiv(ve);var Pe,Ne,De=[],ze=Q.deleteTraces,Me=fe,Se=[ve,De],Ie=[ve,Ae];for(function(Fe,Re,Xe){var nt,ct;if(!Array.isArray(Fe.data))throw new Error("gd.data must be an array.");if(void 0===Re)throw new Error("traces must be defined.");for(Array.isArray(Re)||(Re=[Re]),nt=0;nt<Re.length;nt++)if("object"!=typeof(ct=Re[nt])||Array.isArray(ct)||null===ct)throw new Error("all values in traces array must be non-array objects");if(void 0===Xe||Array.isArray(Xe)||(Xe=[Xe]),void 0!==Xe&&Xe.length!==Re.length)throw new Error("if indices is specified, traces.length must equal indices.length")}(ve,Ae,ke),Array.isArray(Ae)||(Ae=[Ae]),Ae=Ae.map(function(Fe){return x.extendFlat({},Fe)}),b.cleanData(Ae),Pe=0;Pe<Ae.length;Pe++)ve.data.push(Ae[Pe]);for(Pe=0;Pe<Ae.length;Pe++)De.push(-Ae.length+Pe);if(void 0===ke)return Ne=Q.redraw(ve),t.add(ve,ze,Se,Me,Ie),Ne;Array.isArray(ke)||(ke=[ke]);try{E(ve,De,ke)}catch(Fe){throw ve.data.splice(ve.data.length-Ae.length,Ae.length),Fe}return t.startSequence(ve),t.add(ve,ze,Se,Me,Ie),Ne=Q.moveTraces(ve,De,ke),t.stopSequence(ve),Ne},Q.deleteTraces=function fe(ve,Ae){ve=x.getGraphDiv(ve);var ke,Pe,Ne=[],De=Q.addTraces,ze=fe,Me=[ve,Ne,Ae],Se=[ve,Ae];if(void 0===Ae)throw new Error("indices must be an integer or array of integers.");for(Array.isArray(Ae)||(Ae=[Ae]),S(ve,Ae,"indices"),(Ae=P(Ae,ve.data.length-1)).sort(x.sorterDes),ke=0;ke<Ae.length;ke+=1)Pe=ve.data.splice(Ae[ke],1)[0],Ne.push(Pe);var Ie=Q.redraw(ve);return t.add(ve,De,Me,ze,Se),Ie},Q.extendTraces=function fe(ve,Ae,ke,Pe){function Ne(Se,Ie,Fe){var Re,Xe;if(x.isTypedArray(Se))if(Fe<0){var nt=new Se.constructor(0),ct=R(Se,Ie);Fe<0?(Re=ct,Xe=nt):(Re=nt,Xe=ct)}else if(Re=new Se.constructor(Fe),Xe=new Se.constructor(Se.length+Ie.length-Fe),Fe===Ie.length)Re.set(Ie),Xe.set(Se);else if(Fe<Ie.length){var xt=Ie.length-Fe;Re.set(Ie.subarray(xt)),Xe.set(Se),Xe.set(Ie.subarray(0,xt),Se.length)}else{var dt=Fe-Ie.length,tt=Se.length-dt;Re.set(Se.subarray(tt)),Re.set(Ie,dt),Xe.set(Se.subarray(0,tt))}else Re=Se.concat(Ie),Xe=Fe>=0&&Fe<Re.length?Re.splice(0,Re.length-Fe):[];return[Re,Xe]}var De=z(ve=x.getGraphDiv(ve),Ae,ke,Pe,Ne),ze=Q.redraw(ve);return t.add(ve,Q.prependTraces,[ve,De.update,ke,De.maxPoints],fe,arguments),ze},Q.moveTraces=function fe(ve,Ae,ke){var Pe,Ne=[],De=[],ze=fe,Me=fe,Se=[ve=x.getGraphDiv(ve),ke,Ae],Ie=[ve,Ae,ke];if(E(ve,Ae,ke),Ae=Array.isArray(Ae)?Ae:[Ae],void 0===ke)for(ke=[],Pe=0;Pe<Ae.length;Pe++)ke.push(-Ae.length+Pe);for(ke=Array.isArray(ke)?ke:[ke],Ae=P(Ae,ve.data.length-1),ke=P(ke,ve.data.length-1),Pe=0;Pe<ve.data.length;Pe++)-1===Ae.indexOf(Pe)&&Ne.push(ve.data[Pe]);for(Pe=0;Pe<Ae.length;Pe++)De.push({newIndex:ke[Pe],trace:ve.data[Ae[Pe]]});for(De.sort(function(Re,Xe){return Re.newIndex-Xe.newIndex}),Pe=0;Pe<De.length;Pe+=1)Ne.splice(De[Pe].newIndex,0,De[Pe].trace);ve.data=Ne;var Fe=Q.redraw(ve);return t.add(ve,ze,Se,Me,Ie),Fe},Q.prependTraces=function fe(ve,Ae,ke,Pe){function Ne(Se,Ie,Fe){var Re,Xe;if(x.isTypedArray(Se))if(Fe<=0){var nt=new Se.constructor(0),ct=R(Ie,Se);Fe<0?(Re=ct,Xe=nt):(Re=nt,Xe=ct)}else if(Re=new Se.constructor(Fe),Xe=new Se.constructor(Se.length+Ie.length-Fe),Fe===Ie.length)Re.set(Ie),Xe.set(Se);else if(Fe<Ie.length){var xt=Ie.length-Fe;Re.set(Ie.subarray(0,xt)),Xe.set(Ie.subarray(xt)),Xe.set(Se,xt)}else{var dt=Fe-Ie.length;Re.set(Ie),Re.set(Se.subarray(0,dt),Ie.length),Xe.set(Se.subarray(dt))}else Re=Ie.concat(Se),Xe=Fe>=0&&Fe<Re.length?Re.splice(Fe,Re.length):[];return[Re,Xe]}var De=z(ve=x.getGraphDiv(ve),Ae,ke,Pe,Ne),ze=Q.redraw(ve);return t.add(ve,Q.extendTraces,[ve,De.update,ke,De.maxPoints],fe,arguments),ze},Q.newPlot=function(fe,ve,Ae,ke){return fe=x.getGraphDiv(fe),d.cleanPlot([],{},fe._fullData||[],fe._fullLayout||{}),d.purge(fe),Q._doPlot(fe,ve,Ae,ke)},Q._doPlot=function(fe,ve,Ae,ke){var Pe;if(fe=x.getGraphDiv(fe),n.init(fe),x.isPlainObject(ve)){var Ne=ve;ve=Ne.data,Ae=Ne.layout,ke=Ne.config,Pe=Ne.frames}if(!1===n.triggerHandler(fe,"plotly_beforeplot",[ve,Ae,ke]))return Promise.reject();ve||Ae||x.isPlotDiv(fe)||x.warn("Calling _doPlot as if redrawing but this container doesn't yet have a plot.",fe),I(fe,ke),Ae||(Ae={}),g.select(fe).classed("js-plotly-plot",!0),i.makeTester(),Array.isArray(fe._promises)||(fe._promises=[]);var De=0===(fe.data||[]).length&&Array.isArray(ve);Array.isArray(ve)&&(b.cleanData(ve),De?fe.data=ve:fe.data.push.apply(fe.data,ve),fe.empty=!1),fe.layout&&!De||(fe.layout=b.cleanLayout(Ae)),d.supplyDefaults(fe);var ze=fe._fullLayout,Me=ze._has("cartesian");ze._replotting=!0,(De||ze._shouldCreateBgLayer)&&(function(dt){var tt=g.select(dt),Ke=dt._fullLayout;if(Ke._calcInverseTransform=Oe,Ke._calcInverseTransform(dt),Ke._container=tt.selectAll(".plot-container").data([0]),Ke._container.enter().insert("div",":first-child").classed("plot-container",!0).classed("plotly",!0),Ke._paperdiv=Ke._container.selectAll(".svg-container").data([0]),Ke._paperdiv.enter().append("div").classed("user-select-none",!0).classed("svg-container",!0).style("position","relative"),Ke._glcontainer=Ke._paperdiv.selectAll(".gl-container").data([{}]),Ke._glcontainer.enter().append("div").classed("gl-container",!0),Ke._paperdiv.selectAll(".main-svg").remove(),Ke._paperdiv.select(".modebar-container").remove(),Ke._paper=Ke._paperdiv.insert("svg",":first-child").classed("main-svg",!0),Ke._toppaper=Ke._paperdiv.append("svg").classed("main-svg",!0),Ke._modebardiv=Ke._paperdiv.append("div"),delete Ke._modeBar,Ke._hoverpaper=Ke._paperdiv.append("svg").classed("main-svg",!0),!Ke._uid){var mt={};g.selectAll("defs").each(function(){this.id&&(mt[this.id.split("-")[1]]=1)}),Ke._uid=x.randstr(mt)}Ke._paperdiv.selectAll(".main-svg").attr(c.svgAttrs),Ke._defs=Ke._paper.append("defs").attr("id","defs-"+Ke._uid),Ke._clips=Ke._defs.append("g").classed("clips",!0),Ke._topdefs=Ke._toppaper.append("defs").attr("id","topdefs-"+Ke._uid),Ke._topclips=Ke._topdefs.append("g").classed("clips",!0),Ke._bgLayer=Ke._paper.append("g").classed("bglayer",!0),Ke._draggers=Ke._paper.append("g").classed("draglayer",!0);var Bt=Ke._paper.append("g").classed("layer-below",!0);Ke._imageLowerLayer=Bt.append("g").classed("imagelayer",!0),Ke._shapeLowerLayer=Bt.append("g").classed("shapelayer",!0),Ke._cartesianlayer=Ke._paper.append("g").classed("cartesianlayer",!0),Ke._polarlayer=Ke._paper.append("g").classed("polarlayer",!0),Ke._smithlayer=Ke._paper.append("g").classed("smithlayer",!0),Ke._ternarylayer=Ke._paper.append("g").classed("ternarylayer",!0),Ke._geolayer=Ke._paper.append("g").classed("geolayer",!0),Ke._funnelarealayer=Ke._paper.append("g").classed("funnelarealayer",!0),Ke._pielayer=Ke._paper.append("g").classed("pielayer",!0),Ke._iciclelayer=Ke._paper.append("g").classed("iciclelayer",!0),Ke._treemaplayer=Ke._paper.append("g").classed("treemaplayer",!0),Ke._sunburstlayer=Ke._paper.append("g").classed("sunburstlayer",!0),Ke._indicatorlayer=Ke._toppaper.append("g").classed("indicatorlayer",!0),Ke._glimages=Ke._paper.append("g").classed("glimages",!0);var Ut=Ke._toppaper.append("g").classed("layer-above",!0);Ke._imageUpperLayer=Ut.append("g").classed("imagelayer",!0),Ke._shapeUpperLayer=Ut.append("g").classed("shapelayer",!0),Ke._selectionLayer=Ke._toppaper.append("g").classed("selectionlayer",!0),Ke._infolayer=Ke._toppaper.append("g").classed("infolayer",!0),Ke._menulayer=Ke._toppaper.append("g").classed("menulayer",!0),Ke._zoomlayer=Ke._toppaper.append("g").classed("zoomlayer",!0),Ke._hoverlayer=Ke._hoverpaper.append("g").classed("hoverlayer",!0),Ke._modebardiv.classed("modebar-container",!0).style("position","absolute").style("top","0px").style("right","0px"),dt.emit("plotly_framework")}(fe),ze._shouldCreateBgLayer&&delete ze._shouldCreateBgLayer),i.initGradients(fe),i.initPatterns(fe),De&&s.saveShowSpikeInitial(fe);var Se=!fe.calcdata||fe.calcdata.length!==(fe._fullData||[]).length;Se&&d.doCalcdata(fe);for(var Ie=0;Ie<fe.calcdata.length;Ie++)fe.calcdata[Ie][0].trace=fe._fullData[Ie];fe._context.responsive?fe._responsiveChartHandler||(fe._responsiveChartHandler=function(){x.isHidden(fe)||d.resize(fe)},window.addEventListener("resize",fe._responsiveChartHandler)):x.clearResponsive(fe);var Fe=x.extendFlat({},ze._size),Re=0;function Xe(){if(d.clearAutoMarginIds(fe),l.drawMarginPushers(fe),s.allowAutoMargin(fe),ze._has("pie"))for(var dt=fe._fullData,tt=0;tt<dt.length;tt++){var Ke=dt[tt];"pie"===Ke.type&&Ke.automargin&&d.allowAutoMargin(fe,"pie."+Ke.uid+".automargin")}return d.doAutoMargin(fe),d.previousPromises(fe)}function nt(){fe._transitioning||(l.doAutoRangeAndConstraints(fe),De&&s.saveRangeInitial(fe),a.getComponentMethod("rangeslider","calcAutorange")(fe))}var ct=[d.previousPromises,function(){if(Pe)return Q.addFrames(fe,Pe)},function dt(){for(var tt=ze._basePlotModules,Ke=0;Ke<tt.length;Ke++)tt[Ke].drawFramework&&tt[Ke].drawFramework(fe);!ze._glcanvas&&ze._has("gl")&&(ze._glcanvas=ze._glcontainer.selectAll(".gl-canvas").data([{key:"contextLayer",context:!0,pick:!1},{key:"focusLayer",context:!1,pick:!1},{key:"pickLayer",context:!1,pick:!0}],function(er){return er.key}),ze._glcanvas.enter().append("canvas").attr("class",function(er){return"gl-canvas gl-canvas-"+er.key.replace("Layer","")}).style({position:"absolute",top:0,left:0,overflow:"visible","pointer-events":"none"}));var mt=fe._context.plotGlPixelRatio;if(ze._glcanvas){ze._glcanvas.attr("width",ze.width*mt).attr("height",ze.height*mt).style("width",ze.width+"px").style("height",ze.height+"px");var Bt=ze._glcanvas.data()[0].regl;if(Bt&&(Math.floor(ze.width*mt)!==Bt._gl.drawingBufferWidth||Math.floor(ze.height*mt)!==Bt._gl.drawingBufferHeight)){var Ut="WebGL context buffer and canvas dimensions do not match due to browser/WebGL bug.";if(!Re)return x.log(Ut+" Clearing graph and plotting again."),d.cleanPlot([],{},fe._fullData,ze),d.supplyDefaults(fe),ze=fe._fullLayout,d.doCalcdata(fe),Re++,dt();x.error(Ut)}}return"h"===ze.modebar.orientation?ze._modebardiv.style("height",null).style("width","100%"):ze._modebardiv.style("width",null).style("height",ze.height+"px"),d.previousPromises(fe)},Xe,function(){if(d.didMarginChange(Fe,ze._size))return x.syncOrAsync([Xe,l.layoutStyles],fe)}];Me&&ct.push(function(){if(Se)return x.syncOrAsync([a.getComponentMethod("shapes","calcAutorange"),a.getComponentMethod("annotations","calcAutorange"),nt],fe);nt()}),ct.push(l.layoutStyles),Me&&ct.push(function(){return s.draw(fe,De?"":"redraw")},function(dt){dt._fullLayout._insideTickLabelsAutorange&&$(dt,dt._fullLayout._insideTickLabelsAutorange).then(function(){dt._fullLayout._insideTickLabelsAutorange=void 0})}),ct.push(l.drawData,l.finalDraw,f,d.addLinks,d.rehover,d.redrag,d.reselect,d.doAutoMargin,function(dt){dt._fullLayout._insideTickLabelsAutorange&&De&&s.saveRangeInitial(dt,!0)},d.previousPromises);var xt=x.syncOrAsync(ct,fe);return xt&&xt.then||(xt=Promise.resolve()),xt.then(function(){return k(fe),fe})},Q.purge=function(fe){var ve=(fe=x.getGraphDiv(fe))._fullLayout||{};return d.cleanPlot([],{},fe._fullData||[],ve),d.purge(fe),n.purge(fe),ve._container&&ve._container.remove(),delete fe._context,fe},Q.react=function(fe,ve,Ae,ke){var Pe,Ne;fe=x.getGraphDiv(fe),b.clearPromiseQueue(fe);var he,ye,Be,Ge,Je,He,De=fe._fullData,ze=fe._fullLayout;if(x.isPlotDiv(fe)&&De&&ze){if(x.isPlainObject(ve)){var Me=ve;ve=Me.data,Ae=Me.layout,ke=Me.config,Pe=Me.frames}var Se=!1;if(ke){var Ie=x.extendDeep({},fe._context);fe._context=void 0,I(fe,ke),Se=function he(ye,Be){var Ge;for(Ge in ye)if("_"!==Ge.charAt(0)){var Je=ye[Ge],He=Be[Ge];if(Je!==He)if(x.isPlainObject(Je)&&x.isPlainObject(He)){if(he(Je,He))return!0}else{if(!Array.isArray(Je)||!Array.isArray(He)||Je.length!==He.length)return!0;for(var st=0;st<Je.length;st++)if(Je[st]!==He[st]&&(!x.isPlainObject(Je[st])||!x.isPlainObject(He[st])||he(Je[st],He[st])))return!0}}}(Ie,fe._context)}fe.data=ve||[],b.cleanData(fe.data),fe.layout=Ae||{},b.cleanLayout(fe.layout),function(he,ye,Be,Ge){var Je,He,st,ot,wt,Ct,rt,ft,Rt,kt,Lt=Ge._preGUI,Ee=[],Ye={},it={};for(Je in Lt){if(wt=de(Je,le)){if(Rt=wt.head,kt=wt.tail,(ot=(st=e(Ge,He=wt.attr||Rt+".uirevision").get())&&se(He,ye))&&ot===st){if(null===(Ct=Lt[Je])&&(Ct=void 0),Te(ft=(rt=e(ye,Je)).get(),Ct)){void 0===ft&&"autorange"===kt&&Ee.push(Rt),rt.set(V(e(Ge,Je).get()));continue}if("autorange"===kt||"range["===kt.substr(0,6)){var Ft=Lt[Rt+".autorange"];if(Ft||null===Ft&&null===Lt[Rt+".range[0]"]&&null===Lt[Rt+".range[1]"]){if(!(Rt in Ye)){var Gt=e(ye,Rt).get();Ye[Rt]=Gt&&(Gt.autorange||!1!==Gt.autorange&&(!Gt.range||2!==Gt.range.length))}if(Ye[Rt]){rt.set(V(e(Ge,Je).get()));continue}}}}}else x.warn("unrecognized GUI edit: "+Je);delete Lt[Je],wt&&"range["===wt.tail.substr(0,6)&&(it[wt.head]=1)}for(var jt=0;jt<Ee.length;jt++){var fr=Ee[jt];if(it[fr]){var kr=e(ye,fr).get();kr&&delete kr.autorange}}var ur=Ge._tracePreGUI;for(var Jt in ur){var $t,Qt=ur[Jt],cr=null;for(Je in Qt){if(!cr){var gr=ge(Jt,Be);if(gr<0){delete ur[Jt];break}var Tr=_e(Jt,he,($t=Be[gr]._fullInput).index);if(Tr<0){delete ur[Jt];break}cr=he[Tr]}if(wt=de(Je,oe)){if(wt.attr?ot=(st=e(Ge,wt.attr).get())&&se(wt.attr,ye):(st=$t.uirevision,void 0===(ot=cr.uirevision)&&(ot=ye.uirevision)),ot&&ot===st&&(null===(Ct=Qt[Je])&&(Ct=void 0),Te(ft=(rt=e(cr,Je)).get(),Ct))){rt.set(V(e($t,Je).get()));continue}}else x.warn("unrecognized GUI edit: "+Je+" in trace uid "+Jt);delete Qt[Je]}}}(fe.data,fe.layout,De,ze),d.supplyDefaults(fe,{skipUpdateCalc:!0});var Fe=fe._fullData,Re=fe._fullLayout,Xe=void 0===Re.datarevision,nt=Re.transition,ct=(he=fe,ye=ze,Be=Re,Ge=Xe,Je=nt,(He=T.layoutFlags()).arrays={},He.rangesAltered={},He.nChanges=0,He.nChangesAnim=0,we(ye,Be,[],{getValObject:function st(ot){return r.getLayoutValObject(Be,ot)},flags:He,immutable:Ge,transition:Je,gd:he}),(He.plot||He.calc)&&(He.layoutReplot=!0),Je&&He.nChanges&&He.nChangesAnim&&(He.anim=He.nChanges===He.nChangesAnim?"all":"some"),He),dt=function(he,ye,Be,Ge,Je,He){var st=ye.length===Be.length;if(!Je&&!st)return{fullReplot:!0,calc:!0};var ot,wt,Ct=T.traceFlags();Ct.arrays={},Ct.nChanges=0,Ct.nChangesAnim=0;var rt={getValObject:function(Rt){var kt=r.getTraceValObject(wt,Rt);return!wt._module.animatable&&kt.anim&&(kt.anim=!1),kt},flags:Ct,immutable:Ge,transition:Je,newDataRevision:He,gd:he},ft={};for(ot=0;ot<ye.length;ot++)if(Be[ot]){if(d.hasMakesDataTransform(wt=Be[ot]._fullInput)&&(wt=Be[ot]),ft[wt.uid])continue;ft[wt.uid]=1,we(ye[ot]._fullInput,wt,[],rt)}return(Ct.calc||Ct.plot)&&(Ct.fullReplot=!0),Je&&Ct.nChanges&&Ct.nChangesAnim&&(Ct.anim=Ct.nChanges===Ct.nChangesAnim&&st?"all":"some"),Ct}(fe,De,Fe,Xe,nt,ct.newDataRevision);if(X(fe)&&(ct.layoutReplot=!0),dt.calc||ct.calc){fe.calcdata=void 0;for(var tt=Object.getOwnPropertyNames(Re),Ke=0;Ke<tt.length;Ke++){var mt=tt[Ke],Bt=mt.substring(0,5);if("xaxis"===Bt||"yaxis"===Bt){var Ut=Re[mt]._emptyCategories;Ut&&Ut()}}}else d.supplyDefaultsUpdateCalc(fe.calcdata,Fe);var er=[];if(Pe&&(fe._transitionData={},d.createTransitionData(fe),er.push(function(){return Q.addFrames(fe,Pe)})),Re.transition&&!Se&&(dt.anim||ct.anim))ct.ticks&&er.push(l.doTicksRelayout),d.doCalcdata(fe),l.doAutoRangeAndConstraints(fe),er.push(function(){return d.transitionFromReact(fe,dt,ct,ze)});else if(dt.fullReplot||ct.layoutReplot||Se)fe._fullLayout._skipDefaults=!0,er.push(Q._doPlot);else{for(var Wt in ct.arrays){var rr=ct.arrays[Wt];if(rr.length){var Ht=a.getComponentMethod(Wt,"drawOne");if(Ht!==x.noop)for(var Ve=0;Ve<rr.length;Ve++)Ht(fe,rr[Ve]);else{var We=a.getComponentMethod(Wt,"draw");if(We===x.noop)throw new Error("cannot draw components: "+Wt);We(fe)}}}er.push(d.previousPromises),dt.style&&er.push(l.doTraceStyle),(dt.colorbars||ct.colorbars)&&er.push(l.doColorBars),ct.legend&&er.push(l.doLegend),ct.layoutstyle&&er.push(l.layoutStyles),ct.axrange&&N(er),ct.ticks&&er.push(l.doTicksRelayout),ct.modebar&&er.push(l.doModeBar),ct.camera&&er.push(l.doCamera),er.push(k)}er.push(d.rehover,d.redrag,d.reselect),(Ne=x.syncOrAsync(er,fe))&&Ne.then||(Ne=Promise.resolve(fe))}else Ne=Q.newPlot(fe,ve,Ae,ke);return Ne.then(function(){return fe.emit("plotly_react",{data:ve,layout:Ae}),fe})},Q.redraw=function(fe){if(fe=x.getGraphDiv(fe),!x.isPlotDiv(fe))throw new Error("This element is not a Plotly plot: "+fe);return b.cleanData(fe.data),b.cleanLayout(fe.layout),fe.calcdata=void 0,Q._doPlot(fe).then(function(){return fe.emit("plotly_redraw"),fe})},Q.relayout=$,Q.restyle=q,Q.setPlotConfig=function(fe){return x.extendFlat(p,fe)},Q.update=re,Q._guiRelayout=ne($),Q._guiRestyle=ne(q),Q._guiUpdate=ne(re),Q._storeDirectGUIEdit=function(fe,ve,Ae){for(var ke in Ae)K(ke,e(fe,ke).get(),Ae[ke],ve)}},{"../components/color":367,"../components/drawing":389,"../components/selections":455,"../constants/xmlns_namespaces":492,"../lib":515,"../lib/events":504,"../lib/queue":531,"../plots/cartesian/axes":566,"../plots/cartesian/constants":573,"../plots/cartesian/graph_interact":576,"../plots/plots":628,"../registry":647,"./edit_types":548,"./helpers":549,"./manage_arrays":551,"./plot_config":553,"./plot_schema":554,"./subroutines":556,"@plotly/d3":58,"fast-isnumeric":190,"has-hover":228}],553:[function(y,ee,Q){"use strict";var g={staticPlot:{valType:"boolean",dflt:!1},typesetMath:{valType:"boolean",dflt:!0},plotlyServerURL:{valType:"string",dflt:""},editable:{valType:"boolean",dflt:!1},edits:{annotationPosition:{valType:"boolean",dflt:!1},annotationTail:{valType:"boolean",dflt:!1},annotationText:{valType:"boolean",dflt:!1},axisTitleText:{valType:"boolean",dflt:!1},colorbarPosition:{valType:"boolean",dflt:!1},colorbarTitleText:{valType:"boolean",dflt:!1},legendPosition:{valType:"boolean",dflt:!1},legendText:{valType:"boolean",dflt:!1},shapePosition:{valType:"boolean",dflt:!1},titleText:{valType:"boolean",dflt:!1}},autosizable:{valType:"boolean",dflt:!1},responsive:{valType:"boolean",dflt:!1},fillFrame:{valType:"boolean",dflt:!1},frameMargins:{valType:"number",dflt:0,min:0,max:.5},scrollZoom:{valType:"flaglist",flags:["cartesian","gl3d","geo","mapbox"],extras:[!0,!1],dflt:"gl3d+geo+mapbox"},doubleClick:{valType:"enumerated",values:[!1,"reset","autosize","reset+autosize"],dflt:"reset+autosize"},doubleClickDelay:{valType:"number",dflt:300,min:0},showAxisDragHandles:{valType:"boolean",dflt:!0},showAxisRangeEntryBoxes:{valType:"boolean",dflt:!0},showTips:{valType:"boolean",dflt:!0},showLink:{valType:"boolean",dflt:!1},linkText:{valType:"string",dflt:"Edit chart",noBlank:!0},sendData:{valType:"boolean",dflt:!0},showSources:{valType:"any",dflt:!1},displayModeBar:{valType:"enumerated",values:["hover",!0,!1],dflt:"hover"},showSendToCloud:{valType:"boolean",dflt:!1},showEditInChartStudio:{valType:"boolean",dflt:!1},modeBarButtonsToRemove:{valType:"any",dflt:[]},modeBarButtonsToAdd:{valType:"any",dflt:[]},modeBarButtons:{valType:"any",dflt:!1},toImageButtonOptions:{valType:"any",dflt:{}},displaylogo:{valType:"boolean",dflt:!0},watermark:{valType:"boolean",dflt:!1},plotGlPixelRatio:{valType:"number",dflt:2,min:1,max:4},setBackground:{valType:"any",dflt:"transparent"},topojsonURL:{valType:"string",noBlank:!0,dflt:"https://cdn.plot.ly/"},mapboxAccessToken:{valType:"string",dflt:null},logging:{valType:"integer",min:0,max:2,dflt:1},notifyOnLogging:{valType:"integer",min:0,max:2,dflt:0},queueLength:{valType:"integer",min:0,dflt:0},globalTransforms:{valType:"any",dflt:[]},locale:{valType:"string",dflt:"en-US"},locales:{valType:"any",dflt:{}}},v={};(function m(x,e){for(var n in x){var t=x[n];t.valType?e[n]=t.dflt:(e[n]||(e[n]={}),m(t,e[n]))}})(g,v),ee.exports={configAttributes:g,dfltConfig:v}},{}],554:[function(y,ee,Q){"use strict";var g=y("../registry"),v=y("../lib"),m=y("../plots/attributes"),x=y("../plots/layout_attributes"),e=y("../plots/frame_attributes"),n=y("../plots/animation_attributes"),t=y("./plot_config").configAttributes,a=y("./edit_types"),r=v.extendDeepAll,d=v.isPlainObject,s=v.isArrayOrTypedArray,i=v.nestedProperty,u=v.valObjectMeta,f=["_isSubplotObj","_isLinkedToArray","_arrayAttrRegexps","_deprecated"];function c(_,w,k){if(!_)return!1;if(_._isLinkedToArray)if(h(w[k]))k++;else if(k<w.length)return!1;for(;k<w.length;k++){var L=_[w[k]];if(!d(L)||(_=L,k===w.length-1))break;if(_._isLinkedToArray){if(!h(w[++k]))return!1}else if("info_array"===_.valType){var M=w[++k];if(!h(M))return!1;var I=_.items;if(Array.isArray(I)){if(M>=I.length)return!1;if(2===_.dimensions){if(k++,w.length===k)return _;var P=w[k];if(!h(P))return!1;_=I[M][P]}else _=I[M]}else _=I}}return _}function h(_){return _===Math.round(_)&&_>=0}function p(){var _,w,k={};for(_ in r(k,x),g.subplotsRegistry)if((w=g.subplotsRegistry[_]).layoutAttributes)if(Array.isArray(w.attr))for(var L=0;L<w.attr.length;L++)l(k,w,w.attr[L]);else l(k,w,"subplot"===w.attr?w.name:w.attr);for(_ in g.componentsRegistry){var M=(w=g.componentsRegistry[_]).schema;if(M&&(M.subplots||M.layout)){var I=M.subplots;if(I&&I.xaxis&&!I.yaxis)for(var P in I.xaxis)delete k.yaxis[P]}else"colorscale"===w.name?r(k,w.layoutAttributes):w.layoutAttributes&&T(k,w.layoutAttributes,w.name)}return{layoutAttributes:b(k)}}function o(){var _={frames:r({},e)};return b(_),_.frames}function b(_){return Q.crawl(_,function(k,L,M){Q.isValObject(k)?!0!==k.arrayOk&&"data_array"!==k.valType||(M[L+"src"]={valType:"string",editType:"none"}):d(k)&&(k.role="object")}),Q.crawl(_,function(k,L,M){if(k){var I=k._isLinkedToArray;I&&(delete k._isLinkedToArray,M[L]={items:{}},M[L].items[I]=k,M[L].role="object")}}),function(w){!function k(L){for(var M in L)if(d(L[M]))k(L[M]);else if(Array.isArray(L[M]))for(var I=0;I<L[M].length;I++)k(L[M][I]);else L[M]instanceof RegExp&&(L[M]=L[M].toString())}(w)}(_),_}function l(_,w,k){var L=i(_,k),M=r({},w.layoutAttributes);M._isSubplotObj=!0,L.set(M)}function T(_,w,k){var L=i(_,k);L.set(r(L.get()||{},w))}Q.IS_SUBPLOT_OBJ="_isSubplotObj",Q.IS_LINKED_TO_ARRAY="_isLinkedToArray",Q.DEPRECATED="_deprecated",Q.UNDERSCORE_ATTRS=f,Q.get=function(){var _={};g.allTypes.forEach(function(k){_[k]=function(L){var M,I;I=(M=g.modules[L]._module).basePlotModule;var P={type:null},S=r({},m),E=r({},M.attributes);Q.crawl(E,function(q,V,W,K,G){i(S,G).set(void 0),void 0===q&&i(E,G).set(void 0)}),r(P,S),g.traceIs(L,"noOpacity")&&delete P.opacity,g.traceIs(L,"showLegend")||(delete P.showlegend,delete P.legendgroup),g.traceIs(L,"noHover")&&(delete P.hoverinfo,delete P.hoverlabel),M.selectPoints||delete P.selectedpoints,r(P,E),I.attributes&&r(P,I.attributes),P.type=L;var z={meta:M.meta||{},categories:M.categories||{},animatable:Boolean(M.animatable),type:L,attributes:b(P)};if(M.layoutAttributes){var R={};r(R,M.layoutAttributes),z.layoutAttributes=b(R)}return M.animatable||Q.crawl(z,function(q){Q.isValObject(q)&&"anim"in q&&delete q.anim}),z}(k)});var w={};return Object.keys(g.transformsRegistry).forEach(function(k){var L,I;w[k]=(I=r({},g.transformsRegistry[L=k].attributes),Object.keys(g.componentsRegistry).forEach(function(P){var S=g.componentsRegistry[P];S.schema&&S.schema.transforms&&S.schema.transforms[L]&&Object.keys(S.schema.transforms[L]).forEach(function(E){T(I,S.schema.transforms[L][E],E)})}),{attributes:b(I)})}),{defs:{valObjects:u,metaKeys:f.concat(["description","role","editType","impliedEdits"]),editType:{traces:a.traces,layout:a.layout},impliedEdits:{}},traces:_,layout:p(),transforms:w,frames:o(),animation:b(n),config:b(t)}},Q.crawl=function(_,w,k,L){var M=k||0;L=L||"",Object.keys(_).forEach(function(I){var P=_[I];if(-1===f.indexOf(I)){var S=(L?L+".":"")+I;w(P,I,_,M,S),Q.isValObject(P)||d(P)&&"impliedEdits"!==I&&Q.crawl(P,w,M+1,S)}})},Q.isValObject=function(_){return _&&void 0!==_.valType},Q.findArrayAttributes=function(_){var w,k,L=[],M=[],I=[];function P(q,V,W,K){M=M.slice(0,K).concat([V]),I=I.slice(0,K).concat([q&&q._isLinkedToArray]),q&&("data_array"===q.valType||!0===q.arrayOk)&&("colorbar"!==M[K-1]||"ticktext"!==V&&"tickvals"!==V)&&function G(Y,$,B){var N=Y[M[$]],U=B+M[$];if($===M.length-1)s(N)&&L.push(k+U);else if(I[$]){if(Array.isArray(N))for(var te=0;te<N.length;te++)d(N[te])&&G(N[te],$+1,U+"["+te+"].")}else d(N)&&G(N,$+1,U+".")}(w,0,"")}w=_,k="",Q.crawl(m,P),_._module&&_._module.attributes&&Q.crawl(_._module.attributes,P);var S=_.transforms;if(S)for(var E=0;E<S.length;E++){var z=S[E],R=z._module;R&&(k="transforms["+E+"].",w=z,Q.crawl(R.attributes,P))}return L},Q.getTraceValObject=function(_,w){var k,L,M=w[0],I=1;if("transforms"===M){if(1===w.length)return m.transforms;var P=_.transforms;if(!Array.isArray(P)||!P.length)return!1;var S=w[1];if(!h(S)||S>=P.length)return!1;L=(k=(g.transformsRegistry[P[S].type]||{}).attributes)&&k[w[2]],I=3}else{var E=_._module;if(E||(E=(g.modules[_.type||m.type.dflt]||{})._module),!E)return!1;if(!(L=(k=E.attributes)&&k[M])){var z=E.basePlotModule;z&&z.attributes&&(L=z.attributes[M])}L||(L=m[M])}return c(L,w,I)},Q.getLayoutValObject=function(_,w){return c(function(k,L){var M,I,P,S,E=k._basePlotModules;if(E){var z;for(M=0;M<E.length;M++){if((P=E[M]).attrRegex&&P.attrRegex.test(L)){if(P.layoutAttrOverrides)return P.layoutAttrOverrides;!z&&P.layoutAttributes&&(z=P.layoutAttributes)}var R=P.baseLayoutAttrOverrides;if(R&&L in R)return R[L]}if(z)return z}var q=k._modules;if(q)for(M=0;M<q.length;M++)if((S=q[M].layoutAttributes)&&L in S)return S[L];for(I in g.componentsRegistry){if("colorscale"===(P=g.componentsRegistry[I]).name&&0===L.indexOf("coloraxis"))return P.layoutAttributes[L];if(!P.schema&&L===P.name)return P.layoutAttributes}return L in x&&x[L]}(_,w[0]),w,1)}},{"../lib":515,"../plots/animation_attributes":560,"../plots/attributes":562,"../plots/frame_attributes":595,"../plots/layout_attributes":619,"../registry":647,"./edit_types":548,"./plot_config":553}],555:[function(y,ee,Q){"use strict";var g=y("../lib"),v=y("../plots/attributes"),m={name:{valType:"string",editType:"none"}};function x(n){return n&&"string"==typeof n}function e(n){return"s"!==n.charAt(n.length-1)&&g.warn("bad argument to arrayDefaultKey: "+n),n.substr(0,n.length-1)+"defaults"}m.templateitemname={valType:"string",editType:"calc"},Q.templatedArray=function(n,t){return t._isLinkedToArray=n,t.name=m.name,t.templateitemname=m.templateitemname,t},Q.traceTemplater=function(n){var t,a,r={};for(t in n)a=n[t],Array.isArray(a)&&a.length&&(r[t]=0);return{newTrace:function(d){var s={type:t=g.coerce(d,{},v,"type"),_template:null};if(t in r){var i=r[t]%(a=n[t]).length;r[t]++,s._template=a[i]}return s}}},Q.newContainer=function(n,t,a){var r=n._template,d=r&&(r[t]||a&&r[a]);return g.isPlainObject(d)||(d=null),n[t]={_template:d}},Q.arrayTemplater=function(n,t,a){var r=n._template,d=r&&r[e(t)],s=r&&r[t];Array.isArray(s)&&s.length||(s=[]);var i={};return{newItem:function(u){var f={name:u.name,_input:u},c=f.templateitemname=u.templateitemname;if(!x(c))return f._template=d,f;for(var h=0;h<s.length;h++){var p=s[h];if(p.name===c)return i[c]=1,f._template=p,f}return f[a]=u[a]||!1,f._template=!1,f},defaultItems:function(){for(var u=[],f=0;f<s.length;f++){var c=s[f],h=c.name;if(x(h)&&!i[h]){var p={_template:c,name:h,_input:{_templateitemname:h}};p.templateitemname=c.templateitemname,u.push(p),i[h]=1}}return u}}},Q.arrayDefaultKey=e,Q.arrayEditor=function(n,t,a){var r=(g.nestedProperty(n,t).get()||[]).length,d=a._index,s=d>=r&&(a._input||{})._templateitemname;s&&(d=r);var i,u=t+"["+d+"]";function f(){i={},s&&(i[u]={},i[u].templateitemname=s)}function c(p,o){s?g.nestedProperty(i[u],p).set(o):i[u+"."+p]=o}function h(){var p=i;return f(),p}return f(),{modifyBase:function(p,o){i[p]=o},modifyItem:c,getUpdateObj:h,applyUpdate:function(p,o){p&&c(p,o);var b=h();for(var l in b)g.nestedProperty(n,l).set(b[l])}}}},{"../lib":515,"../plots/attributes":562}],556:[function(y,ee,Q){"use strict";var g=y("@plotly/d3"),v=y("../registry"),m=y("../plots/plots"),x=y("../lib"),e=y("../lib/clear_gl_canvases"),n=y("../components/color"),t=y("../components/drawing"),a=y("../components/titles"),r=y("../components/modebar"),d=y("../plots/cartesian/axes"),s=y("../constants/alignment"),i=y("../plots/cartesian/constraints"),u=i.enforce,f=i.clean,c=y("../plots/cartesian/autorange").doAutoRange;function h(w,k,L){for(var M=0;M<L.length;M++){var I=L[M][0],P=L[M][1];if(!(I[0]>=w[1]||I[1]<=w[0])&&P[0]<k[1]&&P[1]>k[0])return!0}return!1}function p(w){var k,L,M,I,P,S,E=w._fullLayout,z=E._size,R=z.p,q=d.list(w,"",!0);if(E._paperdiv.style({width:w._context.responsive&&E.autosize&&!w._context._hasZeroWidth&&!w.layout.width?"100%":E.width+"px",height:w._context.responsive&&E.autosize&&!w._context._hasZeroHeight&&!w.layout.height?"100%":E.height+"px"}).selectAll(".main-svg").call(t.setSize,E.width,E.height),w._context.setBackground(w,E.paper_bgcolor),Q.drawMainTitle(w),r.manage(w),!E._has("cartesian"))return m.previousPromises(w);function V(Re,Xe,nt){var ct=Re._lw/2;return"x"===Re._id.charAt(0)?Xe?"top"===nt?Xe._offset-R-ct:Xe._offset+Xe._length+R+ct:z.t+z.h*(1-(Re.position||0))+ct%1:Xe?"right"===nt?Xe._offset+Xe._length+R+ct:Xe._offset-R-ct:z.l+z.w*(Re.position||0)+ct%1}for(k=0;k<q.length;k++){var W=(I=q[k])._anchorAxis;I._linepositions={},I._lw=t.crispRound(w,I.linewidth,1),I._mainLinePosition=V(I,W,I.side),I._mainMirrorPosition=I.mirror&&W?V(I,W,s.OPPOSITE_SIDE[I.side]):null}var K=[],G=[],Y=[],$=1===n.opacity(E.paper_bgcolor)&&1===n.opacity(E.plot_bgcolor)&&E.paper_bgcolor===E.plot_bgcolor;for(L in E._plots)if((M=E._plots[L]).mainplot)M.bg&&M.bg.remove(),M.bg=void 0;else{var B=M.xaxis.domain,N=M.yaxis.domain,U=M.plotgroup;if(h(B,N,Y)){var te=U.node(),j=M.bg=x.ensureSingle(U,"rect","bg");te.insertBefore(j.node(),te.childNodes[0]),G.push(L)}else U.select("rect.bg").remove(),Y.push([B,N]),$||(K.push(L),G.push(L))}var J,X,re,ne,le,oe,de,se,ge,_e,Te,we,Oe,fe=E._bgLayer.selectAll(".bg").data(K);for(fe.enter().append("rect").classed("bg",!0),fe.exit().remove(),fe.each(function(Re){E._plots[Re].bg=g.select(this)}),k=0;k<G.length;k++)P=(M=E._plots[G[k]]).xaxis,S=M.yaxis,M.bg&&void 0!==P._offset&&void 0!==S._offset&&M.bg.call(t.setRect,P._offset-R,S._offset-R,P._length+2*R,S._length+2*R).call(n.fill,E.plot_bgcolor).style("stroke-width",0);if(!E._hasOnlyLargeSploms)for(L in E._plots){P=(M=E._plots[L]).xaxis,S=M.yaxis;var ve,Ae,ke=M.clipId="clip"+E._uid+L+"plot",Pe=x.ensureSingleById(E._clips,"clipPath",ke,function(Re){Re.classed("plotclip",!0).append("rect")});M.clipRect=Pe.select("rect").attr({width:P._length,height:S._length}),t.setTranslate(M.plot,P._offset,S._offset),M._hasClipOnAxisFalse?(ve=null,Ae=ke):(ve=ke,Ae=null),t.setClipUrl(M.plot,ve,w),M.layerClipId=Ae}function Ne(Re){return"M"+J+","+Re+"H"+X}function De(Re){return"M"+P._offset+","+Re+"h"+P._length}function ze(Re){return"M"+Re+","+se+"V"+de}function Me(Re){return"M"+Re+","+S._offset+"v"+S._length}function Se(Re,Xe,nt){if(!Re.showline||L!==Re._mainSubplot)return"";if(!Re._anchorAxis)return nt(Re._mainLinePosition);var ct=Xe(Re._mainLinePosition);return Re.mirror&&(ct+=Xe(Re._mainMirrorPosition)),ct}for(L in E._plots){S=(M=E._plots[L]).yaxis;var Ie="M0,0";o(P=M.xaxis,L)&&(le=l(P,"left",S,q),J=P._offset-(le?R+le:0),oe=l(P,"right",S,q),X=P._offset+P._length+(oe?R+oe:0),re=V(P,S,"bottom"),ne=V(P,S,"top"),!(Oe=!P._anchorAxis||L!==P._mainSubplot)||"allticks"!==P.mirror&&"all"!==P.mirror||(P._linepositions[L]=[re,ne]),Ie=Se(P,Ne,De),Oe&&P.showline&&("all"===P.mirror||"allticks"===P.mirror)&&(Ie+=Ne(re)+Ne(ne)),M.xlines.style("stroke-width",P._lw+"px").call(n.stroke,P.showline?P.linecolor:"rgba(0,0,0,0)")),M.xlines.attr("d",Ie);var Fe="M0,0";o(S,L)&&(Te=l(S,"bottom",P,q),de=S._offset+S._length+(Te?R:0),we=l(S,"top",P,q),se=S._offset-(we?R:0),ge=V(S,P,"left"),_e=V(S,P,"right"),!(Oe=!S._anchorAxis||L!==S._mainSubplot)||"allticks"!==S.mirror&&"all"!==S.mirror||(S._linepositions[L]=[ge,_e]),Fe=Se(S,ze,Me),Oe&&S.showline&&("all"===S.mirror||"allticks"===S.mirror)&&(Fe+=ze(ge)+ze(_e)),M.ylines.style("stroke-width",S._lw+"px").call(n.stroke,S.showline?S.linecolor:"rgba(0,0,0,0)")),M.ylines.attr("d",Fe)}return d.makeClipPaths(w),m.previousPromises(w)}function o(w,k){return(w.ticks||w.showline)&&(k===w._mainSubplot||"all"===w.mirror||"allticks"===w.mirror)}function b(w,k,L){if(!L.showline||!L._lw)return!1;if("all"===L.mirror||"allticks"===L.mirror)return!0;var M=L._anchorAxis;if(!M)return!1;var I=s.FROM_BL[k];return L.side===k?M.domain[I]===w.domain[I]:L.mirror&&M.domain[1-I]===w.domain[1-I]}function l(w,k,L,M){if(b(w,k,L))return L._lw;for(var I=0;I<M.length;I++){var P=M[I];if(P._mainAxis===L._mainAxis&&b(w,k,P))return P._lw}return 0}function T(w,k){var L=w.title,M=w._size,I=0;return"paper"===("start"===k?I=L.pad.l:"end"===k&&(I=-L.pad.r),L.xref)?M.l+M.w*L.x+I:w.width*L.x+I}function _(w,k){var L=w.title,M=w._size,I=0;return"0em"!==k&&k?k===s.CAP_SHIFT+"em"&&(I=L.pad.t):I=-L.pad.b,"auto"===L.y?M.t/2:"paper"===L.yref?M.t+M.h-M.h*L.y+I:w.height-w.height*L.y+I}Q.layoutStyles=function(w){return x.syncOrAsync([m.doAutoMargin,p],w)},Q.drawMainTitle=function(w){var P,S,k=w._fullLayout,L=(S="middle",x.isRightAnchor(P=k.title)?S="end":x.isLeftAnchor(P)&&(S="start"),S),M=function(I){var P=I.title,S="0em";return x.isTopAnchor(P)?S=s.CAP_SHIFT+"em":x.isMiddleAnchor(P)&&(S=s.MID_SHIFT+"em"),S}(k);a.draw(w,"gtitle",{propContainer:k,propName:"title.text",placeholder:k._dfltTitle.plot,attributes:{x:T(k,L),y:_(k,M),"text-anchor":L,dy:M}})},Q.doTraceStyle=function(w){var k,L=w.calcdata,M=[];for(k=0;k<L.length;k++){var I=L[k],P=I[0]||{},S=P.trace||{},E=S._module||{},z=E.arraysToCalcdata;z&&z(I,S);var R=E.editStyle;R&&M.push({fn:R,cd0:P})}if(M.length){for(k=0;k<M.length;k++){var q=M[k];q.fn(w,q.cd0)}e(w),Q.redrawReglTraces(w)}return m.style(w),v.getComponentMethod("legend","draw")(w),m.previousPromises(w)},Q.doColorBars=function(w){return v.getComponentMethod("colorbar","draw")(w),m.previousPromises(w)},Q.layoutReplot=function(w){var k=w.layout;return w.layout=void 0,v.call("_doPlot",w,"",k)},Q.doLegend=function(w){return v.getComponentMethod("legend","draw")(w),m.previousPromises(w)},Q.doTicksRelayout=function(w){return d.draw(w,"redraw"),w._fullLayout._hasOnlyLargeSploms&&(v.subplotsRegistry.splom.updateGrid(w),e(w),Q.redrawReglTraces(w)),Q.drawMainTitle(w),m.previousPromises(w)},Q.doModeBar=function(w){var k=w._fullLayout;r.manage(w);for(var L=0;L<k._basePlotModules.length;L++){var M=k._basePlotModules[L].updateFx;M&&M(w)}return m.previousPromises(w)},Q.doCamera=function(w){for(var k=w._fullLayout,L=k._subplots.gl3d,M=0;M<L.length;M++){var I=k[L[M]];I._scene.setViewport(I)}},Q.drawData=function(w){var k=w._fullLayout;e(w);for(var L=k._basePlotModules,M=0;M<L.length;M++)L[M].plot(w);return Q.redrawReglTraces(w),m.style(w),v.getComponentMethod("selections","draw")(w),v.getComponentMethod("shapes","draw")(w),v.getComponentMethod("annotations","draw")(w),v.getComponentMethod("images","draw")(w),k._replotting=!1,m.previousPromises(w)},Q.redrawReglTraces=function(w){var k=w._fullLayout;if(k._has("regl")){var L,M,I=w._fullData,P=[],S=[];for(k._hasOnlyLargeSploms&&k._splomGrid.draw(),L=0;L<I.length;L++){var E=I[L];!0===E.visible&&0!==E._length&&("splom"===E.type?k._splomScenes[E.uid].draw():"scattergl"===E.type?x.pushUnique(P,E.xaxis+E.yaxis):"scatterpolargl"===E.type&&x.pushUnique(S,E.subplot))}for(L=0;L<P.length;L++)(M=k._plots[P[L]])._scene&&M._scene.draw();for(L=0;L<S.length;L++)(M=k[S[L]]._subplot)._scene&&M._scene.draw()}},Q.doAutoRangeAndConstraints=function(w){for(var k,L=d.list(w,"",!0),M={},I=0;I<L.length;I++)if(!M[(k=L[I])._id]){M[k._id]=1,f(w,k),c(w,k);var P=k._matchGroup;if(P)for(var S in P){var E=d.getFromId(w,S);c(w,E,k.range),M[S]=1}}u(w)},Q.finalDraw=function(w){v.getComponentMethod("rangeslider","draw")(w),v.getComponentMethod("rangeselector","draw")(w)},Q.drawMarginPushers=function(w){v.getComponentMethod("legend","draw")(w),v.getComponentMethod("rangeselector","draw")(w),v.getComponentMethod("sliders","draw")(w),v.getComponentMethod("updatemenus","draw")(w),v.getComponentMethod("colorbar","draw")(w)}},{"../components/color":367,"../components/drawing":389,"../components/modebar":430,"../components/titles":476,"../constants/alignment":483,"../lib":515,"../lib/clear_gl_canvases":499,"../plots/cartesian/autorange":565,"../plots/cartesian/axes":566,"../plots/cartesian/constraints":574,"../plots/plots":628,"../registry":647,"@plotly/d3":58}],557:[function(y,ee,Q){"use strict";var g=y("../lib"),v=g.isPlainObject,m=y("./plot_schema"),x=y("../plots/plots"),e=y("../plots/attributes"),n=y("./plot_template"),t=y("./plot_config").dfltConfig;function a(h,p){h=g.extendDeep({},h);var o,b,l=Object.keys(h).sort();function T(M,I,P){if(v(I)&&v(M))a(M,I);else if(Array.isArray(I)&&Array.isArray(M)){var S=n.arrayTemplater({_template:h},P);for(b=0;b<I.length;b++){var E=I[b],z=S.newItem(E)._template;z&&a(z,E)}var R=S.defaultItems();for(b=0;b<R.length;b++)I.push(R[b]._template);for(b=0;b<I.length;b++)delete I[b].templateitemname}}for(o=0;o<l.length;o++){var _=l[o],w=h[_];if(_ in p?T(w,p[_],_):p[_]=w,r(_)===_)for(var k in p){var L=r(k);k===L||L!==_||k in h||T(w,p[k],_)}}}function r(h){return h.replace(/[0-9]+$/,"")}function d(h,p,o,b,l){var T=l&&o(l);for(var _ in h){var w=h[_],k=u(h,_,b),L=u(h,_,l),M=o(L);if(!M){var I=r(_);I!==_&&(M=o(L=u(h,I,l)))}if(!(T&&T===M||!M||M._noTemplating||"data_array"===M.valType||M.arrayOk&&Array.isArray(w)))if(!M.valType&&v(w))d(w,p,o,k,L);else if(M._isLinkedToArray&&Array.isArray(w))for(var P=!1,S=0,E={},z=0;z<w.length;z++){var R=w[z];if(v(R)){var q=R.name;if(q)E[q]||(d(R,p,o,u(w,S,k),u(w,S,L)),S++,E[q]=1);else if(!P){var V=u(h,n.arrayDefaultKey(_),b),W=u(w,S,k);d(R,p,o,W,u(w,S,L));var K=g.nestedProperty(p,W);g.nestedProperty(p,V).set(K.get()),K.set(null),P=!0}}}else g.nestedProperty(p,k).set(w)}}function s(h,p){return m.getLayoutValObject(h,g.nestedProperty({},p).parts)}function i(h,p){return m.getTraceValObject(h,g.nestedProperty({},p).parts)}function u(h,p,o){return o?Array.isArray(h)?o+"["+p+"]":o+"."+p:p}function f(h){for(var p=0;p<h.length;p++)if(v(h[p]))return!0}function c(h){var p;switch(h.code){case"data":p="The template has no key data.";break;case"layout":p="The template has no key layout.";break;case"missing":p=h.path?"There are no templates for item "+h.path+" with name "+h.templateitemname:"There are no templates for trace "+h.index+", of type "+h.traceType+".";break;case"unused":p=h.path?"The template item at "+h.path+" was not used in constructing the plot.":h.dataCount?"Some of the templates of type "+h.traceType+" were not used. The template has "+h.templateCount+" traces, the data only has "+h.dataCount+" of this type.":"The template has "+h.templateCount+" traces of type "+h.traceType+" but there are none in the data.";break;case"reused":p="Some of the templates of type "+h.traceType+" were used more than once. The template has "+h.templateCount+" traces, the data has "+h.dataCount+" of this type."}return h.msg=p,h}Q.makeTemplate=function(h){h=g.isPlainObject(h)?h:g.getGraphDiv(h),h=g.extendDeep({_context:t},{data:h.data,layout:h.layout}),x.supplyDefaults(h);var p=h.data||[],o=h.layout||{};o._basePlotModules=h._fullLayout._basePlotModules,o._modules=h._fullLayout._modules;var b={data:{},layout:{}};p.forEach(function(S){var E={};d(S,E,i.bind(null,S));var z=g.coerce(S,{},e,"type"),R=b.data[z];R||(R=b.data[z]=[]),R.push(E)}),d(o,b.layout,s.bind(null,o)),delete b.layout.template;var l=o.template;if(v(l)){var T,_,w,k,L,M,I=l.layout;v(I)&&a(I,b.layout);var P=l.data;if(v(P)){for(_ in b.data)if(w=P[_],Array.isArray(w)){for(M=(L=b.data[_]).length,k=w.length,T=0;T<M;T++)a(w[T%k],L[T]);for(T=M;T<k;T++)L.push(g.extendDeep({},w[T]))}for(_ in P)_ in b.data||(b.data[_]=g.extendDeep([],P[_]))}}return b},Q.validateTemplate=function(h,p){var o=g.extendDeep({},{_context:t,data:h.data,layout:h.layout}),b=o.layout||{};v(p)||(p=b.template||{});var l=p.layout,T=p.data,_=[];o.layout=b,o.layout.template=p,x.supplyDefaults(o);var w=o._fullLayout,k=o._fullData,L={};if(v(l)?(function R(q,V){for(var W in q)if("_"!==W.charAt(0)&&v(q[W])){var K,G=r(W),Y=[];for(K=0;K<V.length;K++)Y.push(u(q,W,V[K])),G!==W&&Y.push(u(q,G,V[K]));for(K=0;K<Y.length;K++)L[Y[K]]=1;R(q[W],Y)}}(w,["layout"]),function R(q,V){for(var W in q)if(-1===W.indexOf("defaults")&&v(q[W])){var K=u(q,W,V);L[K]?R(q[W],K):_.push({code:"unused",path:K})}}(l,"layout")):_.push({code:"layout"}),v(T)){for(var M,I={},P=0;P<k.length;P++){var S=k[P];I[M=S.type]=(I[M]||0)+1,S._fullInput._template||_.push({code:"missing",index:S._fullInput.index,traceType:M})}for(M in T){var E=T[M].length,z=I[M]||0;E>z?_.push({code:"unused",traceType:M,templateCount:E,dataCount:z}):z>E&&_.push({code:"reused",traceType:M,templateCount:E,dataCount:z})}}else _.push({code:"data"});if(function R(q,V){for(var W in q)if("_"!==W.charAt(0)){var K=q[W],G=u(q,W,V);v(K)?(Array.isArray(q)&&!1===K._template&&K.templateitemname&&_.push({code:"missing",path:G,templateitemname:K.templateitemname}),R(K,G)):Array.isArray(K)&&f(K)&&R(K,G)}}({data:k,layout:w},""),_.length)return _.map(c)}},{"../lib":515,"../plots/attributes":562,"../plots/plots":628,"./plot_config":553,"./plot_schema":554,"./plot_template":555}],558:[function(y,ee,Q){"use strict";var g=y("fast-isnumeric"),v=y("./plot_api"),m=y("../plots/plots"),x=y("../lib"),e=y("../snapshot/helpers"),n=y("../snapshot/tosvg"),t=y("../snapshot/svgtoimg"),a=y("../version").version,r={format:{valType:"enumerated",values:["png","jpeg","webp","svg","full-json"],dflt:"png"},width:{valType:"number",min:1},height:{valType:"number",min:1},scale:{valType:"number",min:0,dflt:1},setBackground:{valType:"any",dflt:!1},imageDataOnly:{valType:"boolean",dflt:!1}};ee.exports=function(d,s){var i,u,f,c;function h(z){return!(z in s)||x.validate(s[z],r[z])}if(s=s||{},x.isPlainObject(d)?(i=d.data||[],u=d.layout||{},f=d.config||{},c={}):(d=x.getGraphDiv(d),i=x.extendDeep([],d.data),u=x.extendDeep({},d.layout),f=d._context,c=d._fullLayout||{}),!h("width")&&null!==s.width||!h("height")&&null!==s.height)throw new Error("Height and width should be pixel values.");if(!h("format"))throw new Error("Export format is not "+x.join2(r.format.values,", "," or ")+".");var p={};function o(z,R){return x.coerce(s,p,r,z,R)}var b=o("format"),l=o("width"),T=o("height"),_=o("scale"),w=o("setBackground"),k=o("imageDataOnly"),L=document.createElement("div");L.style.position="absolute",L.style.left="-5000px",document.body.appendChild(L);var M=x.extendFlat({},u);l?M.width=l:null===s.width&&g(c.width)&&(M.width=c.width),T?M.height=T:null===s.height&&g(c.height)&&(M.height=c.height);var I=x.extendFlat({},f,{_exportedPlot:!0,staticPlot:!0,setBackground:w}),P=e.getRedrawFunc(L);function S(){return new Promise(function(z){setTimeout(z,e.getDelay(L._fullLayout))})}function E(){return new Promise(function(z,R){var q=n(L,b,_),V=L._fullLayout.width,W=L._fullLayout.height;function K(){v.purge(L),document.body.removeChild(L)}if("full-json"===b){var G=m.graphJson(L,!1,"keepdata","object",!0,!0);return G.version=a,G=JSON.stringify(G),K(),z(k?G:e.encodeJSON(G))}if(K(),"svg"===b)return z(k?q:e.encodeSVG(q));var Y=document.createElement("canvas");Y.id=x.randstr(),t({format:b,width:V,height:W,scale:_,canvas:Y,svg:q,promise:!0}).then(z).catch(R)})}return new Promise(function(z,R){v.newPlot(L,i,M,I).then(P).then(S).then(E).then(function(q){var V;z((V=q,k?V.replace(e.IMAGE_URL_PREFIX,""):V))}).catch(function(q){R(q)})})}},{"../lib":515,"../plots/plots":628,"../snapshot/helpers":651,"../snapshot/svgtoimg":653,"../snapshot/tosvg":655,"../version":1132,"./plot_api":552,"fast-isnumeric":190}],559:[function(y,ee,Q){"use strict";var g=y("../lib"),v=y("../plots/plots"),m=y("./plot_schema"),x=y("./plot_config").dfltConfig,e=g.isPlainObject,n=Array.isArray,t=g.isArrayOrTypedArray;function a(p,o,b,l,T,_){_=_||[];for(var w=Object.keys(p),k=0;k<w.length;k++){var L=w[k];if("transforms"!==L){var M=_.slice();M.push(L);var I=p[L],P=o[L],S=f(b,L),E=(S||{}).valType,z="info_array"===E,R="colorscale"===E,q=(S||{}).items;if(u(b,L))if(e(I)&&e(P)&&"any"!==E)a(I,P,S,l,T,M);else if(z&&n(I)){I.length>P.length&&l.push(i("unused",T,M.concat(P.length)));var V,W,G,Y,$=P.length,B=Array.isArray(q);if(B&&($=Math.min($,q.length)),2===S.dimensions)for(W=0;W<$;W++)if(n(I[W])){I[W].length>P[W].length&&l.push(i("unused",T,M.concat(W,P[W].length)));var N=P[W].length;for(V=0;V<(B?Math.min(N,q[W].length):N);V++)Y=P[W][V],g.validate(G=I[W][V],B?q[W][V]:q)?Y!==G&&Y!==+G&&l.push(i("dynamic",T,M.concat(W,V),G,Y)):l.push(i("value",T,M.concat(W,V),G))}else l.push(i("array",T,M.concat(W),I[W]));else for(W=0;W<$;W++)Y=P[W],g.validate(G=I[W],B?q[W]:q)?Y!==G&&Y!==+G&&l.push(i("dynamic",T,M.concat(W),G,Y)):l.push(i("value",T,M.concat(W),G))}else if(S.items&&!z&&n(I)){var U,te,j=q[Object.keys(q)[0]],J=[];for(U=0;U<P.length;U++){var X=P[U]._index||U;if((te=M.slice()).push(X),e(I[X])&&e(P[U])){J.push(X);var re=I[X],ne=P[U];e(re)&&!1!==re.visible&&!1===ne.visible?l.push(i("invisible",T,te)):a(re,ne,j,l,T,te)}}for(U=0;U<I.length;U++)(te=M.slice()).push(U),e(I[U])?-1===J.indexOf(U)&&l.push(i("unused",T,te)):l.push(i("object",T,te,I[U]))}else!e(I)&&e(P)?l.push(i("object",T,M,I)):t(I)||!t(P)||z||R?L in o?g.validate(I,S)?"enumerated"===S.valType&&(S.coerceNumber&&I!==+P||I!==P)&&l.push(i("dynamic",T,M,I,P)):l.push(i("value",T,M,I)):l.push(i("unused",T,M,I)):l.push(i("array",T,M,I));else l.push(i("schema",T,M))}}return l}function r(p,o){for(var b=p.layout.layoutAttributes,l=0;l<o.length;l++){var T=o[l],_=p.traces[T.type],w=_.layoutAttributes;w&&g.extendFlat(T.subplot?b[_.attributes.subplot.dflt]:b,w)}return b}ee.exports=function(p,o){void 0===p&&(p=[]),void 0===o&&(o={});var b,l,T=m.get(),_=[],w={_context:g.extendFlat({},x)};n(p)?(w.data=g.extendDeep([],p),b=p):(w.data=[],b=[],_.push(i("array","data"))),e(o)?(w.layout=g.extendDeep({},o),l=o):(w.layout={},l={},arguments.length>1&&_.push(i("object","layout"))),v.supplyDefaults(w);for(var k=w._fullData,L=b.length,M=0;M<L;M++){var I=b[M],P=["data",M];if(e(I)){var S=k[M],E=S.type,z=T.traces[E].attributes;z.type={valType:"enumerated",values:[E]},!1===S.visible&&!1!==I.visible&&_.push(i("invisible",P)),a(I,S,z,_,P);var R=I.transforms,q=S.transforms;if(R){n(R)||_.push(i("array",P,["transforms"])),P.push("transforms");for(var V=0;V<R.length;V++){var W=["transforms",V],K=R[V].type;if(e(R[V])){var G=T.transforms[K]?T.transforms[K].attributes:{};G.type={valType:"enumerated",values:Object.keys(T.transforms)},a(R[V],q[V],G,_,P,W)}else _.push(i("object",P,W))}}}else _.push(i("object",P))}return a(l,w._fullLayout,r(T,k),_,"layout"),0===_.length?void 0:_};var d={object:function(p,o){return("layout"===p&&""===o?"The layout argument":"data"===p[0]&&""===o?"Trace "+p[1]+" in the data argument":s(p)+"key "+o)+" must be linked to an object container"},array:function(p,o){return("data"===p?"The data argument":s(p)+"key "+o)+" must be linked to an array container"},schema:function(p,o){return s(p)+"key "+o+" is not part of the schema"},unused:function(p,o,b){var l=e(b)?"container":"key";return s(p)+l+" "+o+" did not get coerced"},dynamic:function(p,o,b,l){return[s(p)+"key",o,"(set to '"+b+"')","got reset to","'"+l+"'","during defaults."].join(" ")},invisible:function(p,o){return(o?s(p)+"item "+o:"Trace "+p[1])+" got defaulted to be not visible"},value:function(p,o,b){return[s(p)+"key "+o,"is set to an invalid value ("+b+")"].join(" ")}};function s(p){return n(p)?"In data trace "+p[1]+", ":"In "+p+", "}function i(p,o,b,l,T){var _,w;b=b||"",n(o)?(_=o[0],w=o[1]):(_=o,w=null);var k=function(M){if(!n(M))return String(M);for(var I="",P=0;P<M.length;P++){var S=M[P];"number"==typeof S?I=I.substr(0,I.length-1)+"["+S+"]":I+=S,P<M.length-1&&(I+=".")}return I}(b),L=d[p](o,k,l,T);return g.log(L),{code:p,container:_,trace:w,path:b,astr:k,msg:L}}function u(p,o){var b=h(o),l=b.keyMinusId;return!!(l in p&&p[l]._isSubplotObj&&b.id)||o in p}function f(p,o){return o in p?p[o]:p[h(o).keyMinusId]}var c=g.counterRegex("([a-z]+)");function h(p){var o=p.match(c);return{keyMinusId:o&&o[1],id:o&&o[2]}}},{"../lib":515,"../plots/plots":628,"./plot_config":553,"./plot_schema":554}],560:[function(y,ee,Q){"use strict";ee.exports={mode:{valType:"enumerated",dflt:"afterall",values:["immediate","next","afterall"]},direction:{valType:"enumerated",values:["forward","reverse"],dflt:"forward"},fromcurrent:{valType:"boolean",dflt:!1},frame:{duration:{valType:"number",min:0,dflt:500},redraw:{valType:"boolean",dflt:!0}},transition:{duration:{valType:"number",min:0,dflt:500,editType:"none"},easing:{valType:"enumerated",dflt:"cubic-in-out",values:["linear","quad","cubic","sin","exp","circle","elastic","back","bounce","linear-in","quad-in","cubic-in","sin-in","exp-in","circle-in","elastic-in","back-in","bounce-in","linear-out","quad-out","cubic-out","sin-out","exp-out","circle-out","elastic-out","back-out","bounce-out","linear-in-out","quad-in-out","cubic-in-out","sin-in-out","exp-in-out","circle-in-out","elastic-in-out","back-in-out","bounce-in-out"],editType:"none"},ordering:{valType:"enumerated",values:["layout first","traces first"],dflt:"layout first",editType:"none"}}}},{}],561:[function(y,ee,Q){"use strict";var g=y("../lib"),v=y("../plot_api/plot_template");ee.exports=function(m,x,e){var n,t,a=e.name,r=e.inclusionAttr||"visible",d=x[a],s=g.isArrayOrTypedArray(m[a])?m[a]:[],i=x[a]=[],u=v.arrayTemplater(x,a,r);for(n=0;n<s.length;n++){var f=s[n];g.isPlainObject(f)?t=u.newItem(f):(t=u.newItem({}))[r]=!1,t._index=n,!1!==t[r]&&e.handleItemDefaults(f,t,x,e),i.push(t)}var c=u.defaultItems();for(n=0;n<c.length;n++)(t=c[n])._index=i.length,e.handleItemDefaults({},t,x,e,{}),i.push(t);if(g.isArrayOrTypedArray(d)){var h=Math.min(d.length,i.length);for(n=0;n<h;n++)g.relinkPrivateKeys(i[n],d[n])}return i}},{"../lib":515,"../plot_api/plot_template":555}],562:[function(y,ee,Q){"use strict";var g=y("./font_attributes"),v=y("../components/fx/attributes");ee.exports={type:{valType:"enumerated",values:[],dflt:"scatter",editType:"calc+clearAxisTypes",_noTemplating:!0},visible:{valType:"enumerated",values:[!0,!1,"legendonly"],dflt:!0,editType:"calc"},showlegend:{valType:"boolean",dflt:!0,editType:"style"},legendgroup:{valType:"string",dflt:"",editType:"style"},legendgrouptitle:{text:{valType:"string",dflt:"",editType:"style"},font:g({editType:"style"}),editType:"style"},legendrank:{valType:"number",dflt:1e3,editType:"style"},opacity:{valType:"number",min:0,max:1,dflt:1,editType:"style"},name:{valType:"string",editType:"style"},uid:{valType:"string",editType:"plot",anim:!0},ids:{valType:"data_array",editType:"calc",anim:!0},customdata:{valType:"data_array",editType:"calc"},meta:{valType:"any",arrayOk:!0,editType:"plot"},selectedpoints:{valType:"any",editType:"calc"},hoverinfo:{valType:"flaglist",flags:["x","y","z","text","name"],extras:["all","none","skip"],arrayOk:!0,dflt:"all",editType:"none"},hoverlabel:v.hoverlabel,stream:{token:{valType:"string",noBlank:!0,strict:!0,editType:"calc"},maxpoints:{valType:"number",min:0,max:1e4,dflt:500,editType:"calc"},editType:"calc"},transforms:{_isLinkedToArray:"transform",editType:"calc"},uirevision:{valType:"any",editType:"none"}}},{"../components/fx/attributes":398,"./font_attributes":594}],563:[function(y,ee,Q){"use strict";var g=y("fast-isnumeric"),v=y("../../lib"),m=v.dateTime2ms,x=v.incrementMonth,e=y("../../constants/numerical").ONEAVGMONTH;ee.exports=function(n,t,a,r){if("date"!==t.type)return{vals:r};var d=n[a+"periodalignment"];if(!d)return{vals:r};var s,i=n[a+"period"];if(g(i)){if((i=+i)<=0)return{vals:r}}else if("string"==typeof i&&"M"===i.charAt(0)){var u=+i.substring(1);if(!(u>0&&Math.round(u)===u))return{vals:r};s=u}for(var f=t.calendar,c="start"===d,h="end"===d,o=m(n[a+"period0"],f)||0,b=[],l=[],T=[],_=r.length,w=0;w<_;w++){var k,L,M,I=r[w];if(s){for(k=Math.round((I-o)/(s*e)),M=x(o,s*k,f);M>I;)M=x(M,-s,f);for(;M<=I;)M=x(M,s,f);L=x(M,-s,f)}else{for(M=o+(k=Math.round((I-o)/i))*i;M>I;)M-=i;for(;M<=I;)M+=i;L=M-i}b[w]=c?L:h?M:(L+M)/2,l[w]=L,T[w]=M}return{vals:b,starts:l,ends:T}}},{"../../constants/numerical":491,"../../lib":515,"fast-isnumeric":190}],564:[function(y,ee,Q){"use strict";ee.exports={xaxis:{valType:"subplotid",dflt:"x",editType:"calc+clearAxisTypes"},yaxis:{valType:"subplotid",dflt:"y",editType:"calc+clearAxisTypes"}}},{}],565:[function(y,ee,Q){"use strict";var g=y("@plotly/d3"),v=y("fast-isnumeric"),m=y("../../lib"),x=y("../../constants/numerical").FP_SAFE,e=y("../../registry"),n=y("../../components/drawing"),t=y("./axis_ids"),a=t.getFromId,r=t.isLinked;function d(l,T){var _,w,k=[],L=l._fullLayout,M=i(L,T,0),I=i(L,T,1),P=u(l,T),S=P.min,E=P.max;if(0===S.length||0===E.length)return m.simpleMap(T.range,T.r2l);var z=S[0].val,R=E[0].val;for(_=1;_<S.length&&z===R;_++)z=Math.min(z,S[_].val);for(_=1;_<E.length&&z===R;_++)R=Math.max(R,E[_].val);var q=!1;if(T.range){var V=m.simpleMap(T.range,T.r2l);q=V[1]<V[0]}"reversed"===T.autorange&&(q=!0,T.autorange=!0);var W,K,G,Y,$,B,N=T.rangemode,U="tozero"===N,te="nonnegative"===N,j=T._length,J=j/10,X=0;for(_=0;_<S.length;_++)for(W=S[_],w=0;w<E.length;w++)(B=(K=E[w]).val-W.val-s(T,W.val,K.val))>0&&(($=j-M(W)-I(K))>J?B/$>X&&(G=W,Y=K,X=B/$):B/j>X&&(G={val:W.val,nopad:1},Y={val:K.val,nopad:1},X=B/j));if(z===R){var re=z-1,ne=z+1;if(U)if(0===z)k=[0,1];else{var le=(z>0?E:S).reduce(function(de,se){return Math.max(de,I(se))},0),oe=z/(1-Math.min(.5,le/j));k=z>0?[0,oe]:[oe,0]}else k=te?[Math.max(0,re),Math.max(1,ne)]:[re,ne]}else U?(G.val>=0&&(G={val:0,nopad:1}),Y.val<=0&&(Y={val:0,nopad:1})):te&&(G.val-X*M(G)<0&&(G={val:0,nopad:1}),Y.val<=0&&(Y={val:1,nopad:1})),X=(Y.val-G.val-s(T,W.val,K.val))/(j-M(G)-I(Y)),k=[G.val-X*M(G),Y.val+X*I(Y)];return q&&k.reverse(),m.simpleMap(k,T.l2r||Number)}function s(l,T,_){var w=0;if(l.rangebreaks)for(var k=l.locateBreaks(T,_),L=0;L<k.length;L++){var M=k[L];w+=M.max-M.min}return w}function i(l,T,_){var w=.05*T._length,k=T._anchorAxis||{};if(-1!==(T.ticklabelposition||"").indexOf("inside")||-1!==(k.ticklabelposition||"").indexOf("inside")){var L="reversed"===T.autorange;if(!L){var M=m.simpleMap(T.range,T.r2l);L=M[1]<M[0]}L&&(_=!_)}var I=0;return r(l,T._id)||(I=function(P,S,E){var z=0,R="x"===S._id.charAt(0);for(var q in P._plots){var V=P._plots[q];if(S._id===V.xaxis._id||S._id===V.yaxis._id){var W=(R?V.yaxis:V.xaxis)||{};if(-1!==(W.ticklabelposition||"").indexOf("inside")&&(!E&&("left"===W.side||"bottom"===W.side)||E&&("top"===W.side||"right"===W.side))){if(W._vals){var K=m.deg2rad(W._tickAngles[W._id+"tick"]||0),G=Math.abs(Math.cos(K)),Y=Math.abs(Math.sin(K));W._vals[0].bb||W._selections[W._id+"tick"].each(function(j){var J=g.select(this);J.select(".text-math-group").empty()&&(j.bb=n.bBox(J.node()))});for(var B=0;B<W._vals.length;B++){var N=W._vals[B].bb;if(N){var U=6+N.width,te=6+N.height;z=Math.max(z,R?Math.max(U*G,te*Y):Math.max(te*G,U*Y))}}}"inside"===W.ticks&&"inside"===W.ticklabelposition&&(z+=W.ticklen||0)}}}return z}(l,T,_)),w=Math.max(I,w),"domain"===T.constrain&&T._inputDomain&&(w*=(T._inputDomain[1]-T._inputDomain[0])/(T.domain[1]-T.domain[0])),function(P){return P.nopad?0:P.pad+(P.extrapad?w:I)}}function u(l,T,_){var w,k,L,M=T._id,P=l._fullLayout,S=[],E=[];function z(K,G){for(w=0;w<G.length;w++){var Y=K[G[w]],$=(Y._extremes||{})[M];if(!0===Y.visible&&$){for(k=0;k<$.min.length;k++)f(S,(L=$.min[k]).val,L.pad,{extrapad:L.extrapad});for(k=0;k<$.max.length;k++)c(E,(L=$.max[k]).val,L.pad,{extrapad:L.extrapad})}}}if(z(l._fullData,T._traceIndices),z(P.annotations||[],T._annIndices||[]),z(P.shapes||[],T._shapeIndices||[]),T._matchGroup&&!_)for(var R in T._matchGroup)if(R!==T._id){var q=a(l,R),V=u(l,q,!0),W=T._length/q._length;for(k=0;k<V.min.length;k++)f(S,(L=V.min[k]).val,L.pad*W,{extrapad:L.extrapad});for(k=0;k<V.max.length;k++)c(E,(L=V.max[k]).val,L.pad*W,{extrapad:L.extrapad})}return{min:S,max:E}}function f(l,T,_,w){h(l,T,_,w,o)}function c(l,T,_,w){h(l,T,_,w,b)}function h(l,T,_,w,k){for(var L=w.tozero,M=w.extrapad,I=!0,P=0;P<l.length&&I;P++){var S=l[P];if(k(S.val,T)&&S.pad>=_&&(S.extrapad||!M)){I=!1;break}k(T,S.val)&&S.pad<=_&&(M||!S.extrapad)&&(l.splice(P,1),P--)}if(I){var E=L&&0===T;l.push({val:T,pad:E?0:_,extrapad:!E&&M})}}function p(l){return v(l)&&Math.abs(l)<x}function o(l,T){return l<=T}function b(l,T){return l>=T}ee.exports={getAutoRange:d,makePadFn:i,doAutoRange:function(l,T,_){if(T.setScale(),T.autorange){T.range=_?_.slice():d(l,T),T._r=T.range.slice(),T._rl=m.simpleMap(T._r,T.r2l);var w=T._input,k={};k[T._attr+".range"]=T.range,k[T._attr+".autorange"]=T.autorange,e.call("_storeDirectGUIEdit",l.layout,l._fullLayout._preGUI,k),w.range=T.range.slice(),w.autorange=T.autorange}var L=T._anchorAxis;if(L&&L.rangeslider){var M=L.rangeslider[T._name];M&&"auto"===M.rangemode&&(M.range=d(l,T)),L._input.rangeslider[T._name]=m.extendFlat({},M)}},findExtremes:function(l,T,_){_||(_={}),l._m||l.setScale();var w,k,L,M,I,P,S,E,z,R=[],q=[],V=T.length,W=_.padded||!1,K=_.tozero&&("linear"===l.type||"-"===l.type),G="log"===l.type,Y=!1,$=_.vpadLinearized||!1;function B(ne){if(Array.isArray(ne))return Y=!0,function(oe){return Math.max(Number(ne[oe]||0),0)};var le=Math.max(Number(ne||0),0);return function(){return le}}var N=B((l._m>0?_.ppadplus:_.ppadminus)||_.ppad||0),U=B((l._m>0?_.ppadminus:_.ppadplus)||_.ppad||0),te=B(_.vpadplus||_.vpad),j=B(_.vpadminus||_.vpad);if(!Y){if(E=1/0,z=-1/0,G)for(w=0;w<V;w++)(k=T[w])<E&&k>0&&(E=k),k>z&&k<x&&(z=k);else for(w=0;w<V;w++)(k=T[w])<E&&k>-x&&(E=k),k>z&&k<x&&(z=k);T=[E,z],V=2}var J={tozero:K,extrapad:W};function X(ne){v(L=T[ne])&&(P=N(ne),S=U(ne),$?(M=l.c2l(L)-j(ne),I=l.c2l(L)+te(ne)):(E=L-j(ne),z=L+te(ne),G&&E<z/10&&(E=z/10),M=l.c2l(E),I=l.c2l(z)),K&&(M=Math.min(0,M),I=Math.max(0,I)),p(M)&&f(R,M,S,J),p(I)&&c(q,I,P,J))}var re=Math.min(6,V);for(w=0;w<re;w++)X(w);for(w=V-1;w>=re;w--)X(w);return{min:R,max:q,opts:_}},concatExtremes:u}},{"../../components/drawing":389,"../../constants/numerical":491,"../../lib":515,"../../registry":647,"./axis_ids":570,"@plotly/d3":58,"fast-isnumeric":190}],566:[function(y,ee,Q){"use strict";var g=y("@plotly/d3"),v=y("fast-isnumeric"),m=y("../../plots/plots"),x=y("../../registry"),e=y("../../lib"),n=e.strTranslate,t=y("../../lib/svg_text_utils"),a=y("../../components/titles"),r=y("../../components/color"),d=y("../../components/drawing"),s=y("./layout_attributes"),i=y("./clean_ticks"),u=y("../../constants/numerical"),f=u.ONEMAXYEAR,c=u.ONEAVGYEAR,h=u.ONEMINYEAR,p=u.ONEMAXQUARTER,o=u.ONEAVGQUARTER,b=u.ONEMINQUARTER,l=u.ONEMAXMONTH,T=u.ONEAVGMONTH,_=u.ONEMINMONTH,w=u.ONEWEEK,k=u.ONEDAY,L=k/2,M=u.ONEHOUR,I=u.ONEMIN,P=u.ONESEC,S=u.MINUS_SIGN,E=u.BADNUM,z={K:"zeroline"},R={K:"gridline",L:"path"},q={K:"minor-gridline",L:"path"},V={K:"tick",L:"path"},W={K:"tick",L:"text"},K={width:["x","r","l","xl","xr"],height:["y","t","b","yt","yb"],right:["r","xr"],left:["l","xl"],top:["t","yt"],bottom:["b","yb"]},G=y("../../constants/alignment"),Y=G.MID_SHIFT,$=G.CAP_SHIFT,B=G.LINE_SPACING,N=G.OPPOSITE_SIDE,U=ee.exports={};U.setConvert=y("./set_convert");var te=y("./axis_autotype"),j=y("./axis_ids"),J=j.idSort,X=j.isLinked;U.id2name=j.id2name,U.name2id=j.name2id,U.cleanId=j.cleanId,U.list=j.list,U.listIds=j.listIds,U.getFromId=j.getFromId,U.getFromTrace=j.getFromTrace;var re=y("./autorange");function ne(he){var ye=1e-4*(he[1]-he[0]);return[he[0]-ye,he[1]+ye]}U.getAutoRange=re.getAutoRange,U.findExtremes=re.findExtremes,U.coerceRef=function(he,ye,Be,Ge,Je,He){var st=Ge.charAt(Ge.length-1),ot=Be._fullLayout._subplots[st+"axis"],wt=Ge+"ref",Ct={};return Je||(Je=ot[0]||("string"==typeof He?He:He[0])),He||(He=Je),ot=ot.concat(ot.map(function(rt){return rt+" domain"})),Ct[wt]={valType:"enumerated",values:ot.concat(He?"string"==typeof He?[He]:He:[]),dflt:Je},e.coerce(he,ye,Ct,wt)},U.getRefType=function(he){return void 0===he?he:"paper"===he?"paper":"pixel"===he?"pixel":/( domain)$/.test(he)?"domain":"range"},U.coercePosition=function(he,ye,Be,Ge,Je,He){var st,ot;if("range"!==U.getRefType(Ge))st=e.ensureNumber,ot=Be(Je,He);else{var wt=U.getFromId(ye,Ge);ot=Be(Je,He=wt.fraction2r(He)),st=wt.cleanPos}he[Je]=st(ot)},U.cleanPosition=function(he,ye,Be){return("paper"===Be||"pixel"===Be?e.ensureNumber:U.getFromId(ye,Be).cleanPos)(he)},U.redrawComponents=function(he,ye){ye=ye||U.listIds(he);var Be=he._fullLayout;function Ge(Je,He,st,ot){for(var wt=x.getComponentMethod(Je,He),Ct={},rt=0;rt<ye.length;rt++)for(var ft=Be[U.id2name(ye[rt])][st],Rt=0;Rt<ft.length;Rt++){var kt=ft[Rt];if(!Ct[kt]&&(wt(he,kt),Ct[kt]=1,ot))return}}Ge("annotations","drawOne","_annIndices"),Ge("shapes","drawOne","_shapeIndices"),Ge("images","draw","_imgIndices",!0),Ge("selections","drawOne","_selectionIndices")};var le=U.getDataConversions=function(he,ye,Be,Ge){var Je,He="x"===Be||"y"===Be||"z"===Be?Be:Ge;if(Array.isArray(He)){if(Je={type:te(Ge,void 0,{autotypenumbers:he._fullLayout.autotypenumbers}),_categories:[]},U.setConvert(Je),"category"===Je.type)for(var st=0;st<Ge.length;st++)Je.d2c(Ge[st])}else Je=U.getFromTrace(he,ye,He);return Je?{d2c:Je.d2c,c2d:Je.c2d}:"ids"===He?{d2c:de,c2d:de}:{d2c:oe,c2d:oe}};function oe(he){return+he}function de(he){return String(he)}function se(he,ye){return Math.abs((he/ye+.5)%1-.5)<.001}function ge(he,ye){return Math.abs(he/ye-1)<.001}function _e(he){return+he.substring(1)}function Te(he){var ye=ne(e.simpleMap(he.range,he.r2l)),Be=Math.min(ye[0],ye[1]),Ge=Math.max(ye[0],ye[1]),Je="category"===he.type?he.d2l_noadd:he.d2l;"log"===he.type&&"L"!==String(he.dtick).charAt(0)&&(he.dtick="L"+Math.pow(10,Math.floor(Math.min(he.range[0],he.range[1]))-1));for(var He=[],st=0;st<=1;st++)if(!st||he.minor){var ot=st?he.minor.tickvals:he.tickvals,wt=st?[]:he.ticktext;if(ot){Array.isArray(wt)||(wt=[]);for(var Ct=0;Ct<ot.length;Ct++){var rt=Je(ot[Ct]);if(rt>Be&&rt<Ge){var ft=void 0===wt[Ct]?U.tickText(he,rt):ze(he,rt,String(wt[Ct]));st&&(ft.minor=!0,ft.text=""),He.push(ft)}}}}return he.rangebreaks&&(He=He.filter(function(Rt){return he.maskBreaks(Rt.x)!==E})),He}U.getDataToCoordFunc=function(he,ye,Be,Ge){return le(he,ye,Be,Ge).d2c},U.counterLetter=function(he){var ye=he.charAt(0);return"x"===ye?"y":"y"===ye?"x":void 0},U.minDtick=function(he,ye,Be,Ge){-1===["log","category","multicategory"].indexOf(he.type)&&Ge?void 0===he._minDtick?(he._minDtick=ye,he._forceTick0=Be):he._minDtick&&((he._minDtick/ye+1e-6)%1<2e-6&&((Be-he._forceTick0)/ye%1+1.000001)%1<2e-6?(he._minDtick=ye,he._forceTick0=Be):((ye/he._minDtick+1e-6)%1>2e-6||((Be-he._forceTick0)/he._minDtick%1+1.000001)%1>2e-6)&&(he._minDtick=0)):he._minDtick=0},U.saveRangeInitial=function(he,ye){for(var Be=U.list(he,"",!0),Ge=!1,Je=0;Je<Be.length;Je++){var He=Be[Je],st=void 0===He._rangeInitial;(st&&!1===He.autorange||ye&&(st||He.range[0]!==He._rangeInitial[0]||He.range[1]!==He._rangeInitial[1]))&&(He._rangeInitial=He.range.slice(),Ge=!0)}return Ge},U.saveShowSpikeInitial=function(he,ye){for(var Be=U.list(he,"",!0),Ge=!1,Je="on",He=0;He<Be.length;He++){var st=Be[He],ot=void 0===st._showSpikeInitial;(ot||ye&&(ot||st.showspikes!==st._showspikes))&&(st._showSpikeInitial=st.showspikes,Ge=!0),"on"!==Je||st.showspikes||(Je="off")}return he._fullLayout._cartesianSpikesEnabled=Je,Ge},U.autoBin=function(he,ye,Be,Ge,Je,He){var st,ot=e.aggNums(Math.min,null,he),wt=e.aggNums(Math.max,null,he);if("category"===ye.type||"multicategory"===ye.type)return{start:ot-.5,end:wt+.5,size:Math.max(1,Math.round(He)||1),_dataSpan:wt-ot};if(Je||(Je=ye.calendar),st="log"===ye.type?{type:"linear",range:[ot,wt]}:{type:ye.type,range:e.simpleMap([ot,wt],ye.c2r,0,Je),calendar:Je},U.setConvert(st),He=He&&i.dtick(He,st.type))st.dtick=He,st.tick0=i.tick0(void 0,st.type,Je);else{var Ct;if(Be)Ct=(wt-ot)/Be;else{var rt=e.distinctVals(he),ft=Math.pow(10,Math.floor(Math.log(rt.minDiff)/Math.LN10)),Rt=ft*e.roundUp(rt.minDiff/ft,[.9,1.9,4.9,9.9],!0);Ct=Math.max(Rt,2*e.stdev(he)/Math.pow(he.length,Ge?.25:.4)),v(Ct)||(Ct=1)}U.autoTicks(st,Ct)}var kt,Lt=st.dtick,Ee=U.tickIncrement(U.tickFirst(st),Lt,"reverse",Je);if("number"==typeof Lt)kt=(Ee=function(Ye,it,ht,At,Ft){var Gt=0,jt=0,fr=0,kr=0;function ur(cr){return(1+100*(cr-Ye)/ht.dtick)%100<2}for(var Jt=0;Jt<it.length;Jt++)it[Jt]%1==0?fr++:v(it[Jt])||kr++,ur(it[Jt])&&Gt++,ur(it[Jt]+ht.dtick/2)&&jt++;var $t=it.length-kr;if(fr===$t&&"date"!==ht.type)ht.dtick<1?Ye=At-.5*ht.dtick:(Ye-=.5)+ht.dtick<At&&(Ye+=ht.dtick);else if(jt<.1*$t&&(Gt>.3*$t||ur(At)||ur(Ft))){var Qt=ht.dtick/2;Ye+=Ye+Qt<At?Qt:-Qt}return Ye}(Ee,he,st,ot,wt))+(1+Math.floor((wt-Ee)/Lt))*Lt;else for("M"===st.dtick.charAt(0)&&(Ee=function(Ye,it,ht,At,Ft){var Gt=e.findExactDates(it,Ft);if(Gt.exactDays>.8){var jt=Number(ht.substr(1));Gt.exactYears>.8&&jt%12==0?Ye=U.tickIncrement(Ye,"M6","reverse")+1.5*k:Gt.exactMonths>.8?Ye=U.tickIncrement(Ye,"M1","reverse")+15.5*k:Ye-=L;var fr=U.tickIncrement(Ye,ht);if(fr<=At)return fr}return Ye}(Ee,he,Lt,ot,Je)),kt=Ee;kt<=wt;)kt=U.tickIncrement(kt,Lt,!1,Je);return{start:ye.c2r(Ee,0,Je),end:ye.c2r(kt,0,Je),size:Lt,_dataSpan:wt-ot}},U.prepMinorTicks=function(he,ye,Be){if(!ye.minor.dtick){delete he.dtick;var Ge,Je=ye.dtick&&v(ye._tmin);if(Je){var He=U.tickIncrement(ye._tmin,ye.dtick,!0);Ge=[ye._tmin,.99*He+.01*ye._tmin]}else{var st=e.simpleMap(ye.range,ye.r2l);Ge=[st[0],.8*st[0]+.2*st[1]]}if(he.range=e.simpleMap(Ge,ye.l2r),he._isMinor=!0,U.prepTicks(he,Be),Je){var ot=v(ye.dtick),wt=v(he.dtick),Ct=ot?ye.dtick:+ye.dtick.substring(1),rt=wt?he.dtick:+he.dtick.substring(1);ot&&wt?se(Ct,rt)?Ct===2*w&&rt===2*k&&(he.dtick=w):he.dtick=Ct===2*w&&rt===3*k?w:Ct!==w||(ye._input.minor||{}).nticks?ge(Ct/rt,2.5)?Ct/2:Ct:k:"M"===String(ye.dtick).charAt(0)?wt?he.dtick="M1":se(Ct,rt)?Ct>=12&&2===rt&&(he.dtick="M3"):he.dtick=ye.dtick:"L"===String(he.dtick).charAt(0)?"L"===String(ye.dtick).charAt(0)?se(Ct,rt)||(he.dtick=ge(Ct/rt,2.5)?ye.dtick/2:ye.dtick):he.dtick="D1":"D2"===he.dtick&&+ye.dtick>1&&(he.dtick=1)}he.range=ye.range}void 0===ye.minor._tick0Init&&(he.tick0=ye.tick0)},U.prepTicks=function(he,ye){var Be=e.simpleMap(he.range,he.r2l,void 0,void 0,ye);if("auto"===he.tickmode||!he.dtick){var Ge,Je=he.nticks;Je||("category"===he.type||"multicategory"===he.type?(Ge=he.tickfont?e.bigFont(he.tickfont.size||12):15,Je=he._length/Ge):(Ge="y"===he._id.charAt(0)?40:80,Je=e.constrain(he._length/Ge,4,9)+1),"radialaxis"===he._name&&(Je*=2)),he.minor&&"array"!==he.minor.tickmode||"array"===he.tickmode&&(Je*=100),he._roughDTick=Math.abs(Be[1]-Be[0])/Je,U.autoTicks(he,he._roughDTick),he._minDtick>0&&he.dtick<2*he._minDtick&&(he.dtick=he._minDtick,he.tick0=he.l2r(he._forceTick0))}"period"===he.ticklabelmode&&function(He){var st;function ot(){return!(v(He.dtick)||"M"!==He.dtick.charAt(0))}var wt=ot(),Ct=U.getTickFormat(He);if(Ct){var rt=He._dtickInit!==He.dtick;/%[fLQsSMX]/.test(Ct)||(/%[HI]/.test(Ct)?(st=M,rt&&!wt&&He.dtick<M&&(He.dtick=M)):/%p/.test(Ct)?(st=L,rt&&!wt&&He.dtick<L&&(He.dtick=L)):/%[Aadejuwx]/.test(Ct)?(st=k,rt&&!wt&&He.dtick<k&&(He.dtick=k)):/%[UVW]/.test(Ct)?(st=w,rt&&!wt&&He.dtick<w&&(He.dtick=w)):/%[Bbm]/.test(Ct)?(st=T,rt&&(wt?_e(He.dtick)<1:He.dtick<_)&&(He.dtick="M1")):/%[q]/.test(Ct)?(st=o,rt&&(wt?_e(He.dtick)<3:He.dtick<b)&&(He.dtick="M3")):/%[Yy]/.test(Ct)&&(st=c,rt&&(wt?_e(He.dtick)<12:He.dtick<h)&&(He.dtick="M12")))}(wt=ot())&&He.tick0===He._dowTick0&&(He.tick0=He._rawTick0),He._definedDelta=st}(he),he.tick0||(he.tick0="date"===he.type?"2000-01-01":0),"date"===he.type&&he.dtick<.1&&(he.dtick=.1),De(he)},U.calcTicks=function(he,ye){for(var Be,Ge,Je=he.type,He=he.calendar,st=he.ticklabelstep,ot="period"===he.ticklabelmode,wt=e.simpleMap(he.range,he.r2l,void 0,void 0,ye),Ct=wt[1]<wt[0],rt=Math.min(wt[0],wt[1]),ft=Math.max(wt[0],wt[1]),Rt=Math.max(1e3,he._length||0),kt=[],Lt=[],Ee=[],Ye=[],it=he.minor&&(he.minor.ticks||he.minor.showgrid),ht=1;ht>=(it?0:1);ht--){var At=!ht;ht?(he._dtickInit=he.dtick,he._tick0Init=he.tick0):(he.minor._dtickInit=he.minor.dtick,he.minor._tick0Init=he.minor.tick0);var Ft=ht?he:e.extendFlat({},he,he.minor);if(At?U.prepMinorTicks(Ft,he,ye):U.prepTicks(Ft,ye),"array"!==Ft.tickmode){var Gt=ne(wt),jt=Gt[0],fr=Gt[1],kr=v(Ft.dtick),ur="log"===Je&&!(kr||"L"===Ft.dtick.charAt(0)),Jt=U.tickFirst(Ft,ye);if(ht){if(he._tmin=Jt,Jt<jt!==Ct)break;"category"!==Je&&"multicategory"!==Je||(fr=Ct?Math.max(-.5,fr):Math.min(he._categories.length-.5,fr))}var $t,Qt,cr=null,gr=Jt;ht&&(kr?Qt=he.dtick:"date"===Je?"string"==typeof he.dtick&&"M"===he.dtick.charAt(0)&&(Qt=T*he.dtick.substring(1)):Qt=he._roughDTick,$t=Math.round((he.r2l(gr)-he.r2l(he.tick0))/Qt)-1);var Tr=Ft.dtick;for(Ft.rangebreaks&&Ft._tick0Init!==Ft.tick0&&(gr=Ht(gr,he),Ct||(gr=U.tickIncrement(gr,Tr,!Ct,He))),ht&&ot&&(gr=U.tickIncrement(gr,Tr,!Ct,He),$t--);Ct?gr>=fr:gr<=fr;gr=U.tickIncrement(gr,Tr,Ct,He)){if(ht&&$t++,Ft.rangebreaks&&!Ct){if(gr<jt)continue;if(Ft.maskBreaks(gr)===E&&Ht(gr,Ft)>=ft)break}if(Ee.length>Rt||gr===cr)break;cr=gr;var Fr={value:gr};ht?(ur&&gr!==(0|gr)&&(Fr.simpleLabel=!0),st>1&&$t%st&&(Fr.skipLabel=!0),Ee.push(Fr)):(Fr.minor=!0,Ye.push(Fr))}}else ht?(Ee=[],kt=Te(he)):(Ye=[],Lt=Te(he))}if(it&&!("inside"===he.minor.ticks&&"outside"===he.ticks||"outside"===he.minor.ticks&&"inside"===he.ticks)){for(var Nr=Ee.map(function(Cn){return Cn.value}),Xr=[],un=0;un<Ye.length;un++){var $r=Ye[un],Pn=$r.value;if(-1===Nr.indexOf(Pn)){for(var gn=!1,dn=0;!gn&&dn<Ee.length;dn++)1e7+Ee[dn].value===1e7+Pn&&(gn=!0);gn||Xr.push($r)}}Ye=Xr}if(ot&&function(Cn,li,tr){for(var mr=0;mr<Cn.length;mr++){var Pt=Cn[mr].value,or=mr,hr=mr+1;mr<Cn.length-1?(or=mr,hr=mr+1):mr>0?(or=mr-1,hr=mr):(or=mr,hr=mr);var zr,Mr=Math.abs(Cn[hr].value-Cn[or].value),vr=tr||Mr,xr=0;vr>=h?xr=Mr>=h&&Mr<=f?Mr:c:tr===o&&vr>=b?xr=Mr>=b&&Mr<=p?Mr:o:vr>=_?xr=Mr>=_&&Mr<=l?Mr:T:tr===w&&vr>=w?xr=w:vr>=k?xr=k:tr===L&&vr>=L?xr=L:tr===M&&vr>=M&&(xr=M),xr>=Mr&&(xr=Mr,zr=!0);var wr=Pt+xr;if(li.rangebreaks&&xr>0){for(var Er=0,qr=0;qr<84;qr++){var Vr=(qr+.5)/84;li.maskBreaks(Pt*(1-Vr)+Vr*wr)!==E&&Er++}(xr*=Er/84)||(Cn[mr].drop=!0),zr&&Mr>w&&(xr=Mr)}(xr>0||0===mr)&&(Cn[mr].periodX=Pt+xr/2)}}(Ee,he,he._definedDelta),he.rangebreaks){var An="y"===he._id.charAt(0),Zn=1;"auto"===he.tickmode&&(Zn=he.tickfont?he.tickfont.size:12);var Rr=NaN;for(Be=Ee.length-1;Be>-1;Be--)if(Ee[Be].drop)Ee.splice(Be,1);else{Ee[Be].value=Ht(Ee[Be].value,he);var hn=he.c2p(Ee[Be].value);(An?Rr>hn-Zn:Rr<hn+Zn)?Ee.splice(Ct?Be+1:Be,1):Rr=hn}}rr(he)&&360===Math.abs(wt[1]-wt[0])&&Ee.pop(),he._tmax=(Ee[Ee.length-1]||{}).value,he._prevDateHead="",he._inCalcTicks=!0;var nn,Hr,Fn=function(Cn){Cn.text="",he._prevDateHead=Ge};for(Ee=Ee.concat(Ye),Be=0;Be<Ee.length;Be++){var vn=Ee[Be].value;Ee[Be].minor?Lt.push({x:vn,minor:!0}):(Ge=he._prevDateHead,nn=U.tickText(he,vn,!1,Ee[Be].simpleLabel),void 0!==(Hr=Ee[Be].periodX)&&(nn.periodX=Hr,(Hr>ft||Hr<rt)&&(Hr>ft&&(nn.periodX=ft),Hr<rt&&(nn.periodX=rt),Fn(nn))),Ee[Be].skipLabel&&Fn(nn),kt.push(nn))}return kt=kt.concat(Lt),he._inCalcTicks=!1,ot&&kt.length&&(kt[0].noTick=!0),kt};var we=[2,5,10],Oe=[1,2,3,6,12],fe=[1,2,5,10,15,30],ve=[1,2,3,7,14],Ae=[-.046,0,.301,.477,.602,.699,.778,.845,.903,.954,1],ke=[-.301,0,.301,.699,1],Pe=[15,30,45,90,180];function Ne(he,ye,Be){return ye*e.roundUp(he/ye,Be)}function De(he){var ye=he.dtick;if(he._tickexponent=0,v(ye)||"string"==typeof ye||(ye=1),"category"!==he.type&&"multicategory"!==he.type||(he._tickround=null),"date"===he.type){var Be=he.r2l(he.tick0),Ge=he.l2r(Be).replace(/(^-|i)/g,""),Je=Ge.length;if("M"===String(ye).charAt(0))he._tickround=Je>10||"01-01"!==Ge.substr(5)?"d":+ye.substr(1)%12==0?"y":"m";else if(ye>=k&&Je<=10||ye>=15*k)he._tickround="d";else if(ye>=I&&Je<=16||ye>=M)he._tickround="M";else if(ye>=P&&Je<=19||ye>=I)he._tickround="S";else{var He=he.l2r(Be+ye).replace(/^-/,"").length;he._tickround=Math.max(Je,He)-20,he._tickround<0&&(he._tickround=4)}}else if(v(ye)||"L"===ye.charAt(0)){var st=he.range.map(he.r2d||Number);v(ye)||(ye=Number(ye.substr(1))),he._tickround=2-Math.floor(Math.log(ye)/Math.LN10+.01);var ot=Math.max(Math.abs(st[0]),Math.abs(st[1])),wt=Math.floor(Math.log(ot)/Math.LN10+.01),Ct=void 0===he.minexponent?3:he.minexponent;Math.abs(wt)>Ct&&(he._tickexponent=Se(he.exponentformat)&&!Ie(wt)?3*Math.round((wt-1)/3):wt)}else he._tickround=null}function ze(he,ye,Be){var Ge=he.tickfont||{};return{x:ye,dx:0,dy:0,text:Be||"",fontSize:Ge.size,font:Ge.family,fontColor:Ge.color}}U.autoTicks=function(he,ye,Be){var Ge;function Je(ft){return Math.pow(ft,Math.floor(Math.log(ye)/Math.LN10))}if("date"===he.type){he.tick0=e.dateTick0(he.calendar,0);var He=2*ye;if(He>c)ye/=c,Ge=Je(10),he.dtick="M"+12*Ne(ye,Ge,we);else if(He>T)he.dtick="M"+Ne(ye/=T,1,Oe);else if(He>k){if(he.dtick=Ne(ye,k,he._hasDayOfWeekBreaks?[1,2,7,14]:ve),!Be){var st=U.getTickFormat(he),ot="period"===he.ticklabelmode;ot&&(he._rawTick0=he.tick0),he.tick0=/%[uVW]/.test(st)?e.dateTick0(he.calendar,2):e.dateTick0(he.calendar,1),ot&&(he._dowTick0=he.tick0)}}else He>M?he.dtick=Ne(ye,M,Oe):He>I?he.dtick=Ne(ye,I,fe):He>P?he.dtick=Ne(ye,P,fe):(Ge=Je(10),he.dtick=Ne(ye,Ge,we))}else if("log"===he.type){he.tick0=0;var wt=e.simpleMap(he.range,he.r2l);if(he._isMinor&&(ye*=1.5),ye>.7)he.dtick=Math.ceil(ye);else if(Math.abs(wt[1]-wt[0])<1){var Ct=1.5*Math.abs((wt[1]-wt[0])/ye);ye=Math.abs(Math.pow(10,wt[1])-Math.pow(10,wt[0]))/Ct,Ge=Je(10),he.dtick="L"+Ne(ye,Ge,we)}else he.dtick=ye>.3?"D2":"D1"}else"category"===he.type||"multicategory"===he.type?(he.tick0=0,he.dtick=Math.ceil(Math.max(ye,1))):rr(he)?(he.tick0=0,he.dtick=Ne(ye,Ge=1,Pe)):(he.tick0=0,Ge=Je(10),he.dtick=Ne(ye,Ge,we));if(0===he.dtick&&(he.dtick=1),!v(he.dtick)&&"string"!=typeof he.dtick){var rt=he.dtick;throw he.dtick=1,"ax.dtick error: "+String(rt)}},U.tickIncrement=function(he,ye,Be,Ge){var Je=Be?-1:1;if(v(ye))return e.increment(he,Je*ye);var He=ye.charAt(0),st=Je*Number(ye.substr(1));if("M"===He)return e.incrementMonth(he,st,Ge);if("L"===He)return Math.log(Math.pow(10,he)+st)/Math.LN10;if("D"===He){var ot="D2"===ye?ke:Ae,wt=he+.01*Je,Ct=e.roundUp(e.mod(wt,1),ot,Be);return Math.floor(wt)+Math.log(g.round(Math.pow(10,Ct),1))/Math.LN10}throw"unrecognized dtick "+String(ye)},U.tickFirst=function(he,ye){var Be=he.r2l||Number,Ge=e.simpleMap(he.range,Be,void 0,void 0,ye),Je=Ge[1]<Ge[0],He=Je?Math.floor:Math.ceil,st=ne(Ge)[0],ot=he.dtick,wt=Be(he.tick0);if(v(ot)){var Ct=He((st-wt)/ot)*ot+wt;return"category"!==he.type&&"multicategory"!==he.type||(Ct=e.constrain(Ct,0,he._categories.length-1)),Ct}var rt=ot.charAt(0),ft=Number(ot.substr(1));if("M"===rt){for(var Rt,kt,Lt,Ee=0,Ye=wt;Ee<10;){if(((Rt=U.tickIncrement(Ye,ot,Je,he.calendar))-st)*(Ye-st)<=0)return Je?Math.min(Ye,Rt):Math.max(Ye,Rt);kt=(st-(Ye+Rt)/2)/(Rt-Ye),Lt=rt+(Math.abs(Math.round(kt))||1)*ft,Ye=U.tickIncrement(Ye,Lt,kt<0?!Je:Je,he.calendar),Ee++}return e.error("tickFirst did not converge",he),Ye}if("L"===rt)return Math.log(He((Math.pow(10,st)-wt)/ft)*ft+wt)/Math.LN10;if("D"===rt){var it="D2"===ot?ke:Ae,ht=e.roundUp(e.mod(st,1),it,Je);return Math.floor(st)+Math.log(g.round(Math.pow(10,ht),1))/Math.LN10}throw"unrecognized dtick "+String(ot)},U.tickText=function(he,ye,Be,Ge){var Je,He=ze(he,ye),st="array"===he.tickmode,ot=Be||st,wt=he.type,Ct="category"===wt?he.d2l_noadd:he.d2l;if(st&&Array.isArray(he.ticktext)){var rt=e.simpleMap(he.range,he.r2l),ft=(Math.abs(rt[1]-rt[0])-(he._lBreaks||0))/1e4;for(Je=0;Je<he.ticktext.length&&!(Math.abs(ye-Ct(he.tickvals[Je]))<ft);Je++);if(Je<he.ticktext.length)return He.text=String(he.ticktext[Je]),He}function Rt(Ee){return void 0===Ee||(Be?"none"===Ee:"all"!==Ee&&ye!=={first:he._tmin,last:he._tmax}[Ee])}var Ye,it,kt=Be?"never":"none"!==he.exponentformat&&Rt(he.showexponent)?"hide":"";if("date"===wt?function(Ee,Ye,it,ht){var At=Ee._tickround,Ft=it&&Ee.hoverformat||U.getTickFormat(Ee);ht&&(At=v(At)?4:{y:"m",m:"d",d:"M",M:"S",S:4}[At]);var Gt,jt=e.formatDate(Ye.x,Ft,At,Ee._dateFormat,Ee.calendar,Ee._extraFormat),fr=jt.indexOf("\n");if(-1!==fr&&(Gt=jt.substr(fr+1),jt=jt.substr(0,fr)),ht&&("00:00:00"===jt||"00:00"===jt?(jt=Gt,Gt=""):8===jt.length&&(jt=jt.replace(/:00$/,""))),Gt)if(it)"d"===At?jt+=", "+Gt:jt=Gt+(jt?", "+jt:"");else if(Ee._inCalcTicks&&Ee._prevDateHead===Gt){var kr=Ve(Ee),ur=Ee._trueSide||Ee.side;(!kr&&"top"===ur||kr&&"bottom"===ur)&&(jt+="<br> ")}else Ee._prevDateHead=Gt,jt+="<br>"+Gt;Ye.text=jt}(he,He,Be,ot):"log"===wt?function(Ee,Ye,it,ht,At){var Ft=Ee.dtick,Gt=Ye.x,jt=Ee.tickformat,fr="string"==typeof Ft&&Ft.charAt(0);if("never"===At&&(At=""),ht&&"L"!==fr&&(Ft="L3",fr="L"),jt||"L"===fr)Ye.text=Fe(Math.pow(10,Gt),Ee,At,ht);else if(v(Ft)||"D"===fr&&e.mod(Gt+.01,1)<.1){var kr=Math.round(Gt),ur=Math.abs(kr),Jt=Ee.exponentformat;"power"===Jt||Se(Jt)&&Ie(kr)?(Ye.text=0===kr?1:1===kr?"10":"10<sup>"+(kr>1?"":S)+ur+"</sup>",Ye.fontSize*=1.25):("e"===Jt||"E"===Jt)&&ur>2?Ye.text="1"+Jt+(kr>0?"+":S)+ur:(Ye.text=Fe(Math.pow(10,Gt),Ee,"","fakehover"),"D1"===Ft&&"y"===Ee._id.charAt(0)&&(Ye.dy-=Ye.fontSize/6))}else{if("D"!==fr)throw"unrecognized dtick "+String(Ft);Ye.text=String(Math.round(Math.pow(10,e.mod(Gt,1)))),Ye.fontSize*=.75}if("D1"===Ee.dtick){var $t=String(Ye.text).charAt(0);"0"!==$t&&"1"!==$t||("y"===Ee._id.charAt(0)?Ye.dx-=Ye.fontSize/4:(Ye.dy+=Ye.fontSize/2,Ye.dx+=(Ee.range[1]>Ee.range[0]?1:-1)*Ye.fontSize*(Gt<0?.5:.25)))}}(he,He,0,ot,kt):"category"===wt?(Ye=He,void 0===(it=he._categories[Math.round(Ye.x)])&&(it=""),Ye.text=String(it)):"multicategory"===wt?function(Ee,Ye,it){var ht=Math.round(Ye.x),At=Ee._categories[ht]||[],Ft=void 0===At[1]?"":String(At[1]),Gt=void 0===At[0]?"":String(At[0]);it?Ye.text=Gt+" - "+Ft:(Ye.text=Ft,Ye.text2=Gt)}(he,He,Be):rr(he)?function(Ee,Ye,it,ht,At){if("radians"!==Ee.thetaunit||it)Ye.text=Fe(Ye.x,Ee,At,ht);else{var Ft=Ye.x/180;if(0===Ft)Ye.text="0";else{var Gt=function(fr){function kr(Qt,cr){return Math.abs(Qt-cr)<=1e-6}var ur=function(Qt){for(var cr=1;!kr(Math.round(Qt*cr)/cr,Qt);)cr*=10;return cr}(fr),Jt=fr*ur,$t=Math.abs(function Qt(cr,gr){return kr(gr,0)?cr:Qt(gr,cr%gr)}(Jt,ur));return[Math.round(Jt/$t),Math.round(ur/$t)]}(Ft);if(Gt[1]>=100)Ye.text=Fe(e.deg2rad(Ye.x),Ee,At,ht);else{var jt=Ye.x<0;Ye.text=1===Gt[1]?1===Gt[0]?"\u03c0":Gt[0]+"\u03c0":["<sup>",Gt[0],"</sup>","\u2044","<sub>",Gt[1],"</sub>","\u03c0"].join(""),jt&&(Ye.text=S+Ye.text)}}}}(he,He,Be,ot,kt):function(Ee,Ye,it,ht,At){"never"===At?At="":"all"===Ee.showexponent&&Math.abs(Ye.x/Ee.dtick)<1e-6&&(At="hide"),Ye.text=Fe(Ye.x,Ee,At,ht)}(he,He,0,ot,kt),Ge||(he.tickprefix&&!Rt(he.showtickprefix)&&(He.text=he.tickprefix+He.text),he.ticksuffix&&!Rt(he.showticksuffix)&&(He.text+=he.ticksuffix)),"boundaries"===he.tickson||he.showdividers){var Lt=function(Ee){var Ye=he.l2p(Ee);return Ye>=0&&Ye<=he._length?Ee:null};He.xbnd=[Lt(He.x-.5),Lt(He.x+he.dtick-.5)]}return He},U.hoverLabelText=function(he,ye,Be){Be&&(he=e.extendFlat({},he,{hoverformat:Be}));var Ge=Array.isArray(ye)?ye[0]:ye,Je=Array.isArray(ye)?ye[1]:void 0;if(void 0!==Je&&Je!==Ge)return U.hoverLabelText(he,Ge,Be)+" - "+U.hoverLabelText(he,Je,Be);var He="log"===he.type&&Ge<=0,st=U.tickText(he,he.c2l(He?-Ge:Ge),"hover").text;return He?0===Ge?"0":S+st:st};var Me=["f","p","n","\u03bc","m","","k","M","G","T"];function Se(he){return"SI"===he||"B"===he}function Ie(he){return he>14||he<-15}function Fe(he,ye,Be,Ge){var Je=he<0,He=ye._tickround,st=Be||ye.exponentformat||"B",ot=ye._tickexponent,wt=U.getTickFormat(ye),Ct=ye.separatethousands;if(Ge){var rt={exponentformat:st,minexponent:ye.minexponent,dtick:"none"===ye.showexponent?ye.dtick:v(he)&&Math.abs(he)||1,range:"none"===ye.showexponent?ye.range.map(ye.r2d):[0,he||1]};De(rt),He=(Number(rt._tickround)||0)+4,ot=rt._tickexponent,ye.hoverformat&&(wt=ye.hoverformat)}if(wt)return ye._numFormat(wt)(he).replace(/-/g,S);var ft,Rt=Math.pow(10,-He)/2;if("none"===st&&(ot=0),(he=Math.abs(he))<Rt)he="0",Je=!1;else{if(he+=Rt,ot&&(he*=Math.pow(10,-ot),He+=ot),0===He)he=String(Math.floor(he));else if(He<0){he=(he=String(Math.round(he))).substr(0,he.length+He);for(var kt=He;kt<0;kt++)he+="0"}else{var Lt=(he=String(he)).indexOf(".")+1;Lt&&(he=he.substr(0,Lt+He).replace(/\.?0+$/,""))}he=e.numSeparate(he,ye._separators,Ct)}return ot&&"hide"!==st&&(Se(st)&&Ie(ot)&&(st="power"),ft=ot<0?S+-ot:"power"!==st?"+"+ot:String(ot),"e"===st||"E"===st?he+=st+ft:"power"===st?he+="\xd710<sup>"+ft+"</sup>":"B"===st&&9===ot?he+="B":Se(st)&&(he+=Me[ot/3+5])),Je?S+he:he}function Re(he,ye){if(he){var Be=Object.keys(K).reduce(function(Ge,Je){return-1!==ye.indexOf(Je)&&K[Je].forEach(function(He){Ge[He]=1}),Ge},{});Object.keys(he).forEach(function(Ge){Be[Ge]||(1===Ge.length?he[Ge]=0:delete he[Ge])})}}function Xe(he,ye){for(var Be=[],Ge={},Je=0;Je<ye.length;Je++){var He=ye[Je];Ge[He.text2]?Ge[He.text2].push(He.x):Ge[He.text2]=[He.x]}for(var st in Ge)Be.push(ze(he,e.interp(Ge[st],.5),st));return Be}function nt(he){return void 0!==he.periodX?he.periodX:he.x}function ct(he){return[he.text,he.x,he.axInfo,he.font,he.fontSize,he.fontColor].join("_")}function xt(he){var ye=he.title.font.size,Be=(he.title.text.match(t.BR_TAG_ALL)||[]).length;return he.title.hasOwnProperty("standoff")?Be?ye*($+Be*B):ye*$:Be?ye*(Be+1)*B:ye}function dt(he,ye){var Be=he.l2p(ye);return Be>1&&Be<he._length-1}function tt(he){var ye=g.select(he),Be=ye.select(".text-math-group");return Be.empty()?ye.select("text"):Be}function Ke(he){return he._id+".automargin"}function mt(he){return Ke(he)+".mirror"}function Bt(he){return he._id+".rangeslider"}function Ut(he,ye){for(var Be=0;Be<ye.length;Be++)-1===he.indexOf(ye[Be])&&he.push(ye[Be])}function er(he,ye,Be){var Ge,Je,He=[],st=[],ot=he.layout;for(Ge=0;Ge<ye.length;Ge++)He.push(U.getFromId(he,ye[Ge]));for(Ge=0;Ge<Be.length;Ge++)st.push(U.getFromId(he,Be[Ge]));var wt=Object.keys(s),Ct=["anchor","domain","overlaying","position","side","tickangle","editType"],rt=["linear","log"];for(Ge=0;Ge<wt.length;Ge++){var ft=wt[Ge],Rt=He[0][ft],kt=st[0][ft],Lt=!0,Ee=!1,Ye=!1;if("_"!==ft.charAt(0)&&"function"!=typeof Rt&&-1===Ct.indexOf(ft)){for(Je=1;Je<He.length&&Lt;Je++){var it=He[Je][ft];"type"===ft&&-1!==rt.indexOf(Rt)&&-1!==rt.indexOf(it)&&Rt!==it?Ee=!0:it!==Rt&&(Lt=!1)}for(Je=1;Je<st.length&&Lt;Je++){var ht=st[Je][ft];"type"===ft&&-1!==rt.indexOf(kt)&&-1!==rt.indexOf(ht)&&kt!==ht?Ye=!0:st[Je][ft]!==kt&&(Lt=!1)}Lt&&(Ee&&(ot[He[0]._name].type="linear"),Ye&&(ot[st[0]._name].type="linear"),Wt(ot,ft,He,st,he._fullLayout._dfltTitle))}}for(Ge=0;Ge<he._fullLayout.annotations.length;Ge++){var At=he._fullLayout.annotations[Ge];-1!==ye.indexOf(At.xref)&&-1!==Be.indexOf(At.yref)&&e.swapAttrs(ot.annotations[Ge],["?"])}}function Wt(he,ye,Be,Ge,Je){var He,st=e.nestedProperty,ot=st(he[Be[0]._name],ye).get(),wt=st(he[Ge[0]._name],ye).get();for("title"===ye&&(ot&&ot.text===Je.x&&(ot.text=Je.y),wt&&wt.text===Je.y&&(wt.text=Je.x)),He=0;He<Be.length;He++)st(he,Be[He]._name+"."+ye).set(wt);for(He=0;He<Ge.length;He++)st(he,Ge[He]._name+"."+ye).set(ot)}function rr(he){return"angularaxis"===he._id}function Ht(he,ye){for(var Be=ye._rangebreaks.length,Ge=0;Ge<Be;Ge++){var Je=ye._rangebreaks[Ge];if(he>=Je.min&&he<Je.max)return Je.max}return he}function Ve(he){return-1!==(he.ticklabelposition||"").indexOf("inside")}function We(he,ye){Ve(he._anchorAxis||{})&&he._hideCounterAxisInsideTickLabels&&he._hideCounterAxisInsideTickLabels(ye)}U.getTickFormat=function(he){var ye,Be,Ge,Je,He,st,ot,wt,Rt,kt,Lt,Ee,Ye,it;function Ct(Rt){return"string"!=typeof Rt?Rt:Number(Rt.replace("M",""))*T}function rt(Rt,kt){var Lt=["L","D"];if(typeof Rt==typeof kt){if("number"==typeof Rt)return Rt-kt;var Ee=Lt.indexOf(Rt.charAt(0)),Ye=Lt.indexOf(kt.charAt(0));return Ee===Ye?Number(Rt.replace(/(L|D)/g,""))-Number(kt.replace(/(L|D)/g,"")):Ee-Ye}return"number"==typeof Rt?1:-1}if(he.tickformatstops&&he.tickformatstops.length>0)switch(he.type){case"date":case"linear":for(ye=0;ye<he.tickformatstops.length;ye++)if((Ge=he.tickformatstops[ye]).enabled&&(Je=he.dtick,st=void 0,void 0,void 0,st=Ct||function(Rt){return Rt},wt=(He=Ge.dtickrange)[1],(!(ot=He[0])&&"number"!=typeof ot||st(ot)<=st(Je))&&(!wt&&"number"!=typeof wt||st(wt)>=st(Je)))){Be=Ge;break}break;case"log":for(ye=0;ye<he.tickformatstops.length;ye++)if((Ge=he.tickformatstops[ye]).enabled&&(Lt=void 0,Ee=void 0,Ye=void 0,it=void 0,Lt=null===(kt=Ge.dtickrange)[0],Ee=null===kt[1],Ye=rt(Rt=he.dtick,kt[0])>=0,it=rt(Rt,kt[1])<=0,(Lt||Ye)&&(Ee||it))){Be=Ge;break}}return Be?Be.value:he.tickformat},U.getSubplots=function(he,ye){var Be=he._fullLayout._subplots,Ge=Be.cartesian.concat(Be.gl2d||[]),Je=ye?U.findSubplotsWithAxis(Ge,ye):Ge;return Je.sort(function(He,st){var ot=He.substr(1).split("y"),wt=st.substr(1).split("y");return ot[0]===wt[0]?+ot[1]-+wt[1]:+ot[0]-+wt[0]}),Je},U.findSubplotsWithAxis=function(he,ye){for(var Be=new RegExp("x"===ye._id.charAt(0)?"^"+ye._id+"y":ye._id+"$"),Ge=[],Je=0;Je<he.length;Je++){var He=he[Je];Be.test(He)&&Ge.push(He)}return Ge},U.makeClipPaths=function(he){var ye=he._fullLayout;if(!ye._hasOnlyLargeSploms){var Be,Ge,Je={_offset:0,_length:ye.width,_id:""},He={_offset:0,_length:ye.height,_id:""},st=U.list(he,"x",!0),ot=U.list(he,"y",!0),wt=[];for(Be=0;Be<st.length;Be++)for(wt.push({x:st[Be],y:He}),Ge=0;Ge<ot.length;Ge++)0===Be&&wt.push({x:Je,y:ot[Ge]}),wt.push({x:st[Be],y:ot[Ge]});var Ct=ye._clips.selectAll(".axesclip").data(wt,function(rt){return rt.x._id+rt.y._id});Ct.enter().append("clipPath").classed("axesclip",!0).attr("id",function(rt){return"clip"+ye._uid+rt.x._id+rt.y._id}).append("rect"),Ct.exit().remove(),Ct.each(function(rt){g.select(this).select("rect").attr({x:rt.x._offset||0,y:rt.y._offset||0,width:rt.x._length||1,height:rt.y._length||1})})}},U.draw=function(he,ye,Be){var Ge=he._fullLayout;"redraw"===ye&&Ge._paper.selectAll("g.subplot").each(function(He){var ot=Ge._plots[He[0]];if(ot){var wt=ot.xaxis,Ct=ot.yaxis;ot.xaxislayer.selectAll("."+wt._id+"tick").remove(),ot.yaxislayer.selectAll("."+Ct._id+"tick").remove(),ot.xaxislayer.selectAll("."+wt._id+"tick2").remove(),ot.yaxislayer.selectAll("."+Ct._id+"tick2").remove(),ot.xaxislayer.selectAll("."+wt._id+"divider").remove(),ot.yaxislayer.selectAll("."+Ct._id+"divider").remove(),ot.minorGridlayer&&ot.minorGridlayer.selectAll("path").remove(),ot.gridlayer&&ot.gridlayer.selectAll("path").remove(),ot.zerolinelayer&&ot.zerolinelayer.selectAll("path").remove(),Ge._infolayer.select(".g-"+wt._id+"title").remove(),Ge._infolayer.select(".g-"+Ct._id+"title").remove()}});var Je=ye&&"redraw"!==ye?ye:U.listIds(he);return e.syncOrAsync(Je.map(function(He){return function(){if(He){var st=U.getFromId(he,He),ot=U.drawOne(he,st,Be);return st._r=st.range.slice(),st._rl=e.simpleMap(st._r,st.r2l),ot}}}))},U.drawOne=function(he,ye,Be){var Ge,Je,He;Be=Be||{},ye.setScale();var st=he._fullLayout,ot=ye._id,wt=ot.charAt(0),Ct=U.counterLetter(ot),rt=st._plots[ye._mainSubplot];if(rt){var ft=rt[wt+"axislayer"],Rt=ye._mainLinePosition,kt=ye._mainMirrorPosition,Lt=ye._vals=U.calcTicks(ye),Ee=[ye.mirror,Rt,kt].join("_");for(Ge=0;Ge<Lt.length;Ge++)Lt[Ge].axInfo=Ee;ye._selections={},ye._tickAngles&&(ye._prevTickAngles=ye._tickAngles),ye._tickAngles={},ye._depth=null;var Ye={};if(ye.visible){var it,ht,At=U.makeTransTickFn(ye),Ft=U.makeTransTickLabelFn(ye),Gt="inside"===ye.ticks,jt="outside"===ye.ticks;if("boundaries"===ye.tickson){var fr=function(tr,mr){var Pt,or=[],hr=function(zr,Dr){var Ir=zr.xbnd[Dr];null!==Ir&&or.push(e.extendFlat({},zr,{x:Ir}))};if(mr.length){for(Pt=0;Pt<mr.length;Pt++)hr(mr[Pt],0);hr(mr[Pt-1],1)}return or}(0,Lt);ht=U.clipEnds(ye,fr),it=Gt?ht:fr}else ht=U.clipEnds(ye,Lt),it=Gt&&"period"!==ye.ticklabelmode?ht:Lt;var kr,ur=ye._gridVals=ht,Jt=function(tr,mr){var Pt,or,hr=[],zr=mr.length&&mr[mr.length-1].x<mr[0].x,Dr=function(Mr,vr){var xr=Mr.xbnd[vr];null!==xr&&hr.push(e.extendFlat({},Mr,{x:xr}))};if(tr.showdividers&&mr.length){for(Pt=0;Pt<mr.length;Pt++){var Ir=mr[Pt];Ir.text2!==or&&Dr(Ir,zr?1:0),or=Ir.text2}Dr(mr[Pt-1],zr?0:1)}return hr}(ye,Lt);if(!st._hasOnlyLargeSploms){var $t=ye._subplotsWith,Qt={};for(Ge=0;Ge<$t.length;Ge++){var cr=(He=st._plots[Je=$t[Ge]])[Ct+"axis"],gr=cr._mainAxis._id;if(!Qt[gr]){Qt[gr]=1;var Tr="x"===wt?"M0,"+cr._offset+"v"+cr._length:"M"+cr._offset+",0h"+cr._length;U.drawGrid(he,ye,{vals:ur,counterAxis:cr,layer:He.gridlayer.select("."+ot),minorLayer:He.minorGridlayer.select("."+ot),path:Tr,transFn:At}),U.drawZeroLine(he,ye,{counterAxis:cr,layer:He.zerolinelayer,path:Tr,transFn:At})}}}var Fr=U.getTickSigns(ye),Nr=U.getTickSigns(ye,"minor");if(ye.ticks||ye.minor&&ye.minor.ticks){var Xr,un,$r,Pn,gn=U.makeTickPath(ye,Rt,Fr[2]),dn=U.makeTickPath(ye,Rt,Nr[2],{minor:!0});if(ye._anchorAxis&&ye.mirror&&!0!==ye.mirror?(Xr=U.makeTickPath(ye,kt,Fr[3]),un=U.makeTickPath(ye,kt,Nr[3],{minor:!0}),$r=gn+Xr,Pn=dn+un):(Xr="",un="",$r=gn,Pn=dn),ye.showdividers&&jt&&"boundaries"===ye.tickson){var An={};for(Ge=0;Ge<Jt.length;Ge++)An[Jt[Ge].x]=1;kr=function(tr){return An[tr.x]?Xr:$r}}else kr=function(tr){return tr.minor?Pn:$r}}if(U.drawTicks(he,ye,{vals:it,layer:ft,path:kr,transFn:At}),"allticks"===ye.mirror){var Zn=Object.keys(ye._linepositions||{});for(Ge=0;Ge<Zn.length;Ge++){He=st._plots[Je=Zn[Ge]];var Rr=ye._linepositions[Je]||[],nn=Rr[1],Hr=Rr[2],Fn=U.makeTickPath(ye,Rr[0],Hr?Fr[0]:Nr[0],{minor:Hr})+U.makeTickPath(ye,nn,Hr?Fr[1]:Nr[1],{minor:Hr});U.drawTicks(he,ye,{vals:it,layer:He[wt+"axislayer"],path:Fn,transFn:At})}}var Un=[];if(Un.push(function(){return U.drawLabels(he,ye,{vals:Lt,layer:ft,plotinfo:He,transFn:Ft,labelFns:U.makeLabelFns(ye,Rt)})}),"multicategory"===ye.type){var vn={x:2,y:10}[wt];Un.push(function(){var tr={x:"height",y:"width"}[wt],mr=li()[tr]+vn+(ye._tickAngles[ot+"tick"]?ye.tickfont.size*B:0);return U.drawLabels(he,ye,{vals:Xe(ye,Lt),layer:ft,cls:ot+"tick2",repositionOnUpdate:!0,secondary:!0,transFn:At,labelFns:U.makeLabelFns(ye,Rt+mr*Fr[4])})}),Un.push(function(){return ye._depth=Fr[4]*(li("tick2")[ye.side]-Rt),tr=he,mr=ye,hr=(Pt={vals:Jt,layer:ft,path:U.makeTickPath(ye,Rt,Fr[4],{len:ye._depth}),transFn:At}).vals,(zr=Pt.layer.selectAll("path."+(or=mr._id+"divider")).data(hr,ct)).exit().remove(),zr.enter().insert("path",":first-child").classed(or,1).classed("crisp",1).call(r.stroke,mr.dividercolor).style("stroke-width",d.crispRound(tr,mr.dividerwidth,1)+"px"),void zr.attr("transform",Pt.transFn).attr("d",Pt.path);var tr,mr,Pt,or,hr,zr})}else ye.title.hasOwnProperty("standoff")&&Un.push(function(){ye._depth=Fr[4]*(li()[ye.side]-Rt)});var Cn=x.getComponentMethod("rangeslider","isVisible")(ye);return Un.push(function(){var tr,mr,Pt,or,hr=ye.side.charAt(0),zr=N[ye.side].charAt(0),Dr=U.getPxPosition(he,ye),Ir=jt?ye.ticklen:0;if((ye.automargin||Cn)&&("multicategory"===ye.type?tr=li("tick2"):(tr=li(),"x"===wt&&"b"===hr&&(ye._depth=Math.max(tr.width>0?tr.bottom-Dr:0,Ir)))),ye.automargin){mr={x:0,y:0,r:0,l:0,t:0,b:0};var Mr=[0,1];if("x"===wt){if("b"===hr?mr[hr]=ye._depth:(mr[hr]=ye._depth=Math.max(tr.width>0?Dr-tr.top:0,Ir),Mr.reverse()),tr.width>0){var vr=tr.right-(ye._offset+ye._length);vr>0&&(mr.xr=1,mr.r=vr);var xr=ye._offset-tr.left;xr>0&&(mr.xl=0,mr.l=xr)}}else if("l"===hr?mr[hr]=ye._depth=Math.max(tr.height>0?Dr-tr.left:0,Ir):(mr[hr]=ye._depth=Math.max(tr.height>0?tr.right-Dr:0,Ir),Mr.reverse()),tr.height>0){var wr=tr.bottom-(ye._offset+ye._length);wr>0&&(mr.yb=0,mr.b=wr);var Er=ye._offset-tr.top;Er>0&&(mr.yt=1,mr.t=Er)}mr[Ct]="free"===ye.anchor?ye.position:ye._anchorAxis.domain[Mr[0]],ye.title.text!==st._dfltTitle[wt]&&(mr[hr]+=xt(ye)+(ye.title.standoff||0)),ye.mirror&&"free"!==ye.anchor&&((Pt={x:0,y:0,r:0,l:0,t:0,b:0})[zr]=ye.linewidth,ye.mirror&&!0!==ye.mirror&&(Pt[zr]+=Ir),!0===ye.mirror||"ticks"===ye.mirror?Pt[Ct]=ye._anchorAxis.domain[Mr[1]]:"all"!==ye.mirror&&"allticks"!==ye.mirror||(Pt[Ct]=[ye._counterDomainMin,ye._counterDomainMax][Mr[1]]))}Cn&&(or=x.getComponentMethod("rangeslider","autoMarginOpts")(he,ye)),"string"==typeof ye.automargin&&(Re(mr,ye.automargin),Re(Pt,ye.automargin)),m.autoMargin(he,Ke(ye),mr),m.autoMargin(he,mt(ye),Pt),m.autoMargin(he,Bt(ye),or)}),Be.skipTitle||Cn&&"bottom"===ye.side||Un.push(function(){return function(tr,mr){var Pt,or=tr._fullLayout,hr=mr._id,zr=hr.charAt(0),Dr=mr.title.font.size;if(mr.title.hasOwnProperty("standoff"))Pt=mr._depth+mr.title.standoff+xt(mr);else{var Ir=Ve(mr);if("multicategory"===mr.type)Pt=mr._depth;else{var Mr=1.5*Dr;Ir&&(Mr=.5*Dr,"outside"===mr.ticks&&(Mr+=mr.ticklen)),Pt=10+Mr+(mr.linewidth?mr.linewidth-1:0)}Ir||(Pt+="x"===zr?"top"===mr.side?Dr*(mr.showticklabels?1:0):Dr*(mr.showticklabels?1.5:.5):"right"===mr.side?Dr*(mr.showticklabels?1:.5):Dr*(mr.showticklabels?.5:0))}var vr,xr,wr,Er,qr=U.getPxPosition(tr,mr);if("x"===zr?(xr=mr._offset+mr._length/2,wr="top"===mr.side?qr-Pt:qr+Pt):(wr=mr._offset+mr._length/2,xr="right"===mr.side?qr+Pt:qr-Pt,vr={rotate:"-90",offset:0}),"multicategory"!==mr.type){var Vr=mr._selections[mr._id+"tick"];if(Er={selection:Vr,side:mr.side},Vr&&Vr.node()&&Vr.node().parentNode){var Qr=d.getTranslate(Vr.node().parentNode);Er.offsetLeft=Qr.x,Er.offsetTop=Qr.y}mr.title.hasOwnProperty("standoff")&&(Er.pad=0)}return a.draw(tr,hr+"title",{propContainer:mr,propName:mr._name+".title.text",placeholder:or._dfltTitle[zr],avoid:Er,transform:vr,attributes:{x:xr,y:wr,"text-anchor":"middle"}})}(he,ye)}),e.syncOrAsync(Un)}}function li(tr){var Pt,or,hr,zr,Dr,Ir,mr=ot+(tr||"tick");return Ye[mr]||(Ye[mr]=((Pt=ye)._selections[or=mr].size()?(hr=1/0,zr=-1/0,Dr=1/0,Ir=-1/0,Pt._selections[or].each(function(){var Mr=tt(this),vr=d.bBox(Mr.node().parentNode);hr=Math.min(hr,vr.top),zr=Math.max(zr,vr.bottom),Dr=Math.min(Dr,vr.left),Ir=Math.max(Ir,vr.right)})):(hr=0,zr=0,Dr=0,Ir=0),{top:hr,bottom:zr,left:Dr,right:Ir,height:zr-hr,width:Ir-Dr})),Ye[mr]}},U.getTickSigns=function(he,ye){var Be=he._id.charAt(0),Je=he.side==={x:"top",y:"right"}[Be]?1:-1,He=[-1,1,Je,-Je];return"inside"!==(ye?(he.minor||{}).ticks:he.ticks)==("x"===Be)&&(He=He.map(function(st){return-st})),he.side&&He.push({l:-1,t:-1,r:1,b:1}[he.side.charAt(0)]),He},U.makeTransTickFn=function(he){return"x"===he._id.charAt(0)?function(ye){return n(he._offset+he.l2p(ye.x),0)}:function(ye){return n(0,he._offset+he.l2p(ye.x))}},U.makeTransTickLabelFn=function(he){var ye=function(Je){var He=Je.ticklabelposition||"",st=function(it){return-1!==He.indexOf(it)},ot=st("top"),wt=st("left"),Ct=st("right"),rt=st("bottom"),ft=st("inside"),Rt=rt||wt||ot||Ct;if(!Rt&&!ft)return[0,0];var kt=Je.side,Lt=Rt?(Je.tickwidth||0)/2:0,Ee=3,Ye=Je.tickfont?Je.tickfont.size:12;return(rt||ot)&&(Lt+=Ye*$,Ee+=(Je.linewidth||0)/2),(wt||Ct)&&(Lt+=(Je.linewidth||0)/2,Ee+=3),ft&&"top"===kt&&(Ee-=Ye*(1-$)),(wt||ot)&&(Lt=-Lt),"bottom"!==kt&&"right"!==kt||(Ee=-Ee),[Rt?Lt:0,ft?Ee:0]}(he),Be=ye[0],Ge=ye[1];return"x"===he._id.charAt(0)?function(Je){return n(Be+he._offset+he.l2p(nt(Je)),Ge)}:function(Je){return n(Ge,Be+he._offset+he.l2p(nt(Je)))}},U.makeTickPath=function(he,ye,Be,Ge){Ge||(Ge={});var Je=Ge.minor;if(Je&&!he.minor)return"";var He=void 0!==Ge.len?Ge.len:Je?he.minor.ticklen:he.ticklen,st=he._id.charAt(0),ot=(he.linewidth||1)/2;return"x"===st?"M0,"+(ye+ot*Be)+"v"+He*Be:"M"+(ye+ot*Be)+",0h"+He*Be},U.makeLabelFns=function(he,ye,Be){var Ge=he.ticklabelposition||"",Je=function($t){return-1!==Ge.indexOf($t)},He=Je("top"),st=Je("left"),ot=Je("right"),wt=Je("bottom")||st||He||ot,Ct=Je("inside"),rt="inside"===Ge&&"inside"===he.ticks||!Ct&&"outside"===he.ticks&&"boundaries"!==he.tickson,ft=0,Rt=0,kt=rt?he.ticklen:0;if(Ct?kt*=-1:wt&&(kt=0),rt&&(ft+=kt,Be)){var Lt=e.deg2rad(Be);ft=kt*Math.cos(Lt)+1,Rt=kt*Math.sin(Lt)}he.showticklabels&&(rt||he.showline)&&(ft+=.2*he.tickfont.size);var Ee,Ye,it,ht,At,Ft={labelStandoff:ft+=(he.linewidth||1)/2*(Ct?-1:1),labelShift:Rt},Gt=0,jt=he.side,fr=he._id.charAt(0),kr=he.tickangle;if("x"===fr)ht=(At=!Ct&&"bottom"===jt||Ct&&"top"===jt)?1:-1,Ct&&(ht*=-1),Ee=Rt*ht,Ye=ye+ft*ht,it=At?1:-.2,90===Math.abs(kr)&&(Ct?it+=Y:it=-90===kr&&"bottom"===jt?$:90===kr&&"top"===jt?Y:.5,Gt=Y/2*(kr/90)),Ft.xFn=function($t){return $t.dx+Ee+Gt*$t.fontSize},Ft.yFn=function($t){return $t.dy+Ye+$t.fontSize*it},Ft.anchorFn=function($t,Qt){if(wt){if(st)return"end";if(ot)return"start"}return v(Qt)&&0!==Qt&&180!==Qt?Qt*ht<0!==Ct?"end":"start":"middle"},Ft.heightFn=function($t,Qt,cr){return Qt<-60||Qt>60?-.5*cr:"top"===he.side!==Ct?-cr:0};else if("y"===fr){if(ht=(At=!Ct&&"left"===jt||Ct&&"right"===jt)?1:-1,Ct&&(ht*=-1),Ee=ft,Ye=Rt*ht,it=0,Ct||90!==Math.abs(kr)||(it=-90===kr&&"left"===jt||90===kr&&"right"===jt?$:.5),Ct){var ur=v(kr)?+kr:0;if(0!==ur){var Jt=e.deg2rad(ur);Gt=Math.abs(Math.sin(Jt))*$*ht,it=0}}Ft.xFn=function($t){return $t.dx+ye-(Ee+$t.fontSize*it)*ht+Gt*$t.fontSize},Ft.yFn=function($t){return $t.dy+Ye+$t.fontSize*Y},Ft.anchorFn=function($t,Qt){return v(Qt)&&90===Math.abs(Qt)?"middle":At?"end":"start"},Ft.heightFn=function($t,Qt,cr){return"right"===he.side&&(Qt*=-1),Qt<-30?-cr:Qt<30?-.5*cr:0}}return Ft},U.drawTicks=function(he,ye,Be){Be=Be||{};var Ge=ye._id+"tick",Je=[].concat(ye.minor&&ye.minor.ticks?Be.vals.filter(function(st){return st.minor&&!st.noTick}):[]).concat(ye.ticks?Be.vals.filter(function(st){return!st.minor&&!st.noTick}):[]),He=Be.layer.selectAll("path."+Ge).data(Je,ct);He.exit().remove(),He.enter().append("path").classed(Ge,1).classed("ticks",1).classed("crisp",!1!==Be.crisp).each(function(st){return r.stroke(g.select(this),st.minor?ye.minor.tickcolor:ye.tickcolor)}).style("stroke-width",function(st){return d.crispRound(he,st.minor?ye.minor.tickwidth:ye.tickwidth,1)+"px"}).attr("d",Be.path).style("display",null),We(ye,[V]),He.attr("transform",Be.transFn)},U.drawGrid=function(he,ye,Be){Be=Be||{};var Ge=ye._id+"grid",Je=ye.minor&&ye.minor.showgrid,He=Je?Be.vals.filter(function(it){return it.minor}):[],st=ye.showgrid?Be.vals.filter(function(it){return!it.minor}):[],ot=Be.counterAxis;if(ot&&U.shouldShowZeroLine(he,ye,ot))for(var wt="array"===ye.tickmode,Ct=0;Ct<st.length;Ct++){var rt=st[Ct].x;if(wt?!rt:Math.abs(rt)<ye.dtick/100){if(st=st.slice(0,Ct).concat(st.slice(Ct+1)),!wt)break;Ct--}}ye._gw=d.crispRound(he,ye.gridwidth,1);for(var ft=Je?d.crispRound(he,ye.minor.gridwidth,1):0,Rt=Be.layer,kt=Be.minorLayer,Lt=1;Lt>=0;Lt--){var Ee=Lt?Rt:kt;if(Ee){var Ye=Ee.selectAll("path."+Ge).data(Lt?st:He,ct);Ye.exit().remove(),Ye.enter().append("path").classed(Ge,1).classed("crisp",!1!==Be.crisp),Ye.attr("transform",Be.transFn).attr("d",Be.path).each(function(it){return r.stroke(g.select(this),it.minor?ye.minor.gridcolor:ye.gridcolor||"#ddd")}).style("stroke-dasharray",function(it){return d.dashStyle(it.minor?ye.minor.griddash:ye.griddash,it.minor?ye.minor.gridwidth:ye.gridwidth)}).style("stroke-width",function(it){return(it.minor?ft:ye._gw)+"px"}).style("display",null),"function"==typeof Be.path&&Ye.attr("d",Be.path)}}We(ye,[R,q])},U.drawZeroLine=function(he,ye,Be){var Ge=ye._id+"zl",Je=U.shouldShowZeroLine(he,ye,(Be=Be||Be).counterAxis),He=Be.layer.selectAll("path."+Ge).data(Je?[{x:0,id:ye._id}]:[]);He.exit().remove(),He.enter().append("path").classed(Ge,1).classed("zl",1).classed("crisp",!1!==Be.crisp).each(function(){Be.layer.selectAll("path").sort(function(st,ot){return J(st.id,ot.id)})}),He.attr("transform",Be.transFn).attr("d",Be.path).call(r.stroke,ye.zerolinecolor||r.defaultLine).style("stroke-width",d.crispRound(he,ye.zerolinewidth,ye._gw||1)+"px").style("display",null),We(ye,[z])},U.drawLabels=function(he,ye,Be){Be=Be||{};var Ge=he._fullLayout,Je=ye._id,He=Je.charAt(0),st=Be.cls||Je+"tick",ot=Be.vals.filter(function(ht){return ht.text}),wt=Be.labelFns,Ct=Be.secondary?0:ye.tickangle,rt=(ye._prevTickAngles||{})[st],ft=Be.layer.selectAll("g."+st).data(ye.showticklabels?ot:[],ct),Rt=[];function kt(ht,At){ht.each(function(Ft){var Gt=g.select(this),jt=Gt.select(".text-math-group"),fr=wt.anchorFn(Ft,At),kr=Be.transFn.call(Gt.node(),Ft)+(v(At)&&0!=+At?" rotate("+At+","+wt.xFn(Ft)+","+(wt.yFn(Ft)-Ft.fontSize/2)+")":""),ur=t.lineCount(Gt),Jt=B*Ft.fontSize,$t=wt.heightFn(Ft,v(At)?+At:0,(ur-1)*Jt);if($t&&(kr+=n(0,$t)),jt.empty()){var Qt=Gt.select("text");Qt.attr({transform:kr,"text-anchor":fr}),Qt.style("opacity",1),ye._adjustTickLabelsOverflow&&ye._adjustTickLabelsOverflow()}else{var cr=d.bBox(jt.node()).width*{end:-.5,start:.5}[fr];jt.attr("transform",kr+n(cr,0))}})}ft.enter().append("g").classed(st,1).append("text").attr("text-anchor","middle").each(function(ht){var At=g.select(this),Ft=he._promises.length;At.call(t.positionText,wt.xFn(ht),wt.yFn(ht)).call(d.font,ht.font,ht.fontSize,ht.fontColor).text(ht.text).call(t.convertToTspans,he),he._promises[Ft]?Rt.push(he._promises.pop().then(function(){kt(At,Ct)})):kt(At,Ct)}),We(ye,[W]),ft.exit().remove(),Be.repositionOnUpdate&&ft.each(function(ht){g.select(this).select("text").call(t.positionText,wt.xFn(ht),wt.yFn(ht))}),ye._adjustTickLabelsOverflow=function(){var ht=ye.ticklabeloverflow;if(ht&&"allow"!==ht){var At=-1!==ht.indexOf("hide"),Ft="x"===ye._id.charAt(0),Gt=0,jt=Ft?he._fullLayout.width:he._fullLayout.height;if(-1!==ht.indexOf("domain")){var fr=e.simpleMap(ye.range,ye.r2l);Gt=ye.l2p(fr[0])+ye._offset,jt=ye.l2p(fr[1])+ye._offset}var kr=Math.min(Gt,jt),ur=Math.max(Gt,jt),Jt=ye.side,$t=1/0,Qt=-1/0;for(var cr in ft.each(function(Fr){var Nr=g.select(this);if(Nr.select(".text-math-group").empty()){var Xr=d.bBox(Nr.node()),un=0;Ft?(Xr.right>ur||Xr.left<kr)&&(un=1):(Xr.bottom>ur||Xr.top+(ye.tickangle?0:Fr.fontSize/4)<kr)&&(un=1);var $r=Nr.select("text");un?At&&$r.style("opacity",0):($r.style("opacity",1),$t="bottom"===Jt||"right"===Jt?Math.min($t,Ft?Xr.top:Xr.left):-1/0,Qt="top"===Jt||"left"===Jt?Math.max(Qt,Ft?Xr.bottom:Xr.right):1/0)}}),Ge._plots){var gr=Ge._plots[cr];if(ye._id===gr.xaxis._id||ye._id===gr.yaxis._id){var Tr=Ft?gr.yaxis:gr.xaxis;Tr&&(Tr["_visibleLabelMin_"+ye._id]=$t,Tr["_visibleLabelMax_"+ye._id]=Qt)}}}},ye._hideCounterAxisInsideTickLabels=function(ht){var At="x"===ye._id.charAt(0),Ft=[];for(var Gt in Ge._plots){var jt=Ge._plots[Gt];ye._id!==jt.xaxis._id&&ye._id!==jt.yaxis._id||Ft.push(At?jt.yaxis:jt.xaxis)}Ft.forEach(function(fr,kr){fr&&Ve(fr)&&(ht||[z,q,R,V,W]).forEach(function(ur){var Jt="tick"===ur.K&&"text"===ur.L&&"period"===ye.ticklabelmode,$t=Ge._plots[ye._mainSubplot];(ur.K===z.K?$t.zerolinelayer.selectAll("."+ye._id+"zl"):ur.K===q.K?$t.minorGridlayer.selectAll("."+ye._id):ur.K===R.K?$t.gridlayer.selectAll("."+ye._id):$t[ye._id.charAt(0)+"axislayer"]).each(function(){var Qt=g.select(this);ur.L&&(Qt=Qt.selectAll(ur.L)),Qt.each(function(cr){var gr=ye.l2p(Jt?nt(cr):cr.x)+ye._offset,Tr=g.select(this);gr<ye["_visibleLabelMax_"+fr._id]&&gr>ye["_visibleLabelMin_"+fr._id]?Tr.style("display","none"):"tick"!==ur.K||kr||Tr.style("display",null)})})})})},kt(ft,rt+1?rt:Ct);var Lt=null;ye._selections&&(ye._selections[st]=ft);var Ee=[function(){return Rt.length&&Promise.all(Rt)}];ye.automargin&&Ge._redrawFromAutoMarginCount&&90===rt?(Lt=90,Ee.push(function(){kt(ft,rt)})):Ee.push(function(){if(kt(ft,Ct),ot.length&&"x"===He&&!v(Ct)&&("log"!==ye.type||"D"!==String(ye.dtick).charAt(0))){Lt=0;var ht,At=0,Ft=[];if(ft.each(function(Nr){At=Math.max(At,Nr.fontSize);var Xr=ye.l2p(Nr.x),un=tt(this),$r=d.bBox(un.node());Ft.push({top:0,bottom:10,height:10,left:Xr-$r.width/2,right:Xr+$r.width/2+2,width:$r.width+2})}),"boundaries"!==ye.tickson&&!ye.showdividers||Be.secondary){var Gt=ot.length,jt=Math.abs((ot[Gt-1].x-ot[0].x)*ye._m)/(Gt-1),fr=ye.ticklabelposition||"",kr=function(Nr){return-1!==fr.indexOf(Nr)},ur=kr("top"),Jt=kr("left"),$t=kr("right"),Qt=kr("bottom")||Jt||ur||$t?(ye.tickwidth||0)+6:0,cr=jt<2.5*At||"multicategory"===ye.type||"realaxis"===ye._name;for(ht=0;ht<Ft.length-1;ht++)if(e.bBoxIntersect(Ft[ht],Ft[ht+1],Qt)){Lt=cr?90:30;break}}else{var gr=2;for(ye.ticks&&(gr+=ye.tickwidth/2),ht=0;ht<Ft.length;ht++){var Tr=ot[ht].xbnd,Fr=Ft[ht];if(null!==Tr[0]&&Fr.left-ye.l2p(Tr[0])<gr||null!==Tr[1]&&ye.l2p(Tr[1])-Fr.right<gr){Lt=90;break}}}Lt&&kt(ft,Lt)}}),ye._tickAngles&&Ee.push(function(){ye._tickAngles[st]=null===Lt?v(Ct)?Ct:0:Lt});var Ye=ye._anchorAxis;Ye&&Ye.autorange&&Ve(ye)&&!X(Ge,ye._id)&&(Ge._insideTickLabelsAutorange||(Ge._insideTickLabelsAutorange={}),Ge._insideTickLabelsAutorange[Ye._name+".autorange"]=Ye.autorange,Ee.push(function(){ft.each(function(ht,At){var Ft=tt(this);Ft.select(".text-math-group").empty()&&(ye._vals[At].bb=d.bBox(Ft.node()))})}));var it=e.syncOrAsync(Ee);return it&&it.then&&he._promises.push(it),it},U.getPxPosition=function(he,ye){var Be,Ge=he._fullLayout._size,Je=ye._id.charAt(0),He=ye.side;return"free"!==ye.anchor?Be=ye._anchorAxis:"x"===Je?Be={_offset:Ge.t+(1-(ye.position||0))*Ge.h,_length:0}:"y"===Je&&(Be={_offset:Ge.l+(ye.position||0)*Ge.w,_length:0}),"top"===He||"left"===He?Be._offset:"bottom"===He||"right"===He?Be._offset+Be._length:void 0},U.shouldShowZeroLine=function(he,ye,Be){var Ge=e.simpleMap(ye.range,ye.r2l);return Ge[0]*Ge[1]<=0&&ye.zeroline&&("linear"===ye.type||"-"===ye.type)&&!(ye.rangebreaks&&ye.maskBreaks(0)===E)&&(dt(ye,0)||!function(Je,He,st,ot){var wt=st._mainAxis;if(wt){var Ct=Je._fullLayout,rt=He._id.charAt(0),ft=U.counterLetter(He._id),Rt=He._offset+(Math.abs(ot[0])<Math.abs(ot[1])==("x"===rt)?0:He._length),Lt=Ct._plots[st._mainSubplot];if(!(Lt.mainplotinfo||Lt).overlays.length)return kt(st);for(var Ee=U.list(Je,ft),Ye=0;Ye<Ee.length;Ye++){var it=Ee[Ye];if(it._mainAxis===wt&&kt(it))return!0}}function kt(ht){if(!ht.showline||!ht.linewidth)return!1;var At=Math.max((ht.linewidth+He.zerolinewidth)/2,1);function Ft(fr){return"number"==typeof fr&&Math.abs(fr-Rt)<At}if(Ft(ht._mainLinePosition)||Ft(ht._mainMirrorPosition))return!0;var Gt=ht._linepositions||{};for(var jt in Gt)if(Ft(Gt[jt][0])||Ft(Gt[jt][1]))return!0}}(he,ye,Be,Ge)||function(Je,He){for(var st=Je._fullData,ot=He._mainSubplot,wt=He._id.charAt(0),Ct=0;Ct<st.length;Ct++){var rt=st[Ct];if(!0===rt.visible&&rt.xaxis+rt.yaxis===ot&&(x.traceIs(rt,"bar-like")&&rt.orientation==={x:"h",y:"v"}[wt]||rt.fill&&rt.fill.charAt(rt.fill.length-1)===wt))return!0}return!1}(he,ye))},U.clipEnds=function(he,ye){return ye.filter(function(Be){return dt(he,Be.x)})},U.allowAutoMargin=function(he){for(var ye=U.list(he,"",!0),Be=0;Be<ye.length;Be++){var Ge=ye[Be];Ge.automargin&&(m.allowAutoMargin(he,Ke(Ge)),Ge.mirror&&m.allowAutoMargin(he,mt(Ge))),x.getComponentMethod("rangeslider","isVisible")(Ge)&&m.allowAutoMargin(he,Bt(Ge))}},U.swap=function(he,ye){for(var Be=function(Je,He){var st,ot,wt=[];for(st=0;st<He.length;st++){var Ct=[],rt=Je._fullData[He[st]].xaxis,ft=Je._fullData[He[st]].yaxis;if(rt&&ft){for(ot=0;ot<wt.length;ot++)-1===wt[ot].x.indexOf(rt)&&-1===wt[ot].y.indexOf(ft)||Ct.push(ot);if(Ct.length){var Rt,kt=wt[Ct[0]];if(Ct.length>1)for(ot=1;ot<Ct.length;ot++)Ut(kt.x,(Rt=wt[Ct[ot]]).x),Ut(kt.y,Rt.y);Ut(kt.x,[rt]),Ut(kt.y,[ft])}else wt.push({x:[rt],y:[ft]})}}return wt}(he,ye),Ge=0;Ge<Be.length;Ge++)er(he,Be[Ge].x,Be[Ge].y)}},{"../../components/color":367,"../../components/drawing":389,"../../components/titles":476,"../../constants/alignment":483,"../../constants/numerical":491,"../../lib":515,"../../lib/svg_text_utils":541,"../../plots/plots":628,"../../registry":647,"./autorange":565,"./axis_autotype":567,"./axis_ids":570,"./clean_ticks":572,"./layout_attributes":579,"./set_convert":585,"@plotly/d3":58,"fast-isnumeric":190}],567:[function(y,ee,Q){"use strict";var g=y("fast-isnumeric"),v=y("../../lib"),m=y("../../constants/numerical").BADNUM,x=v.isArrayOrTypedArray,e=v.isDateTime,n=v.cleanNumber,t=Math.round;function a(d,s){return s?g(d):"number"==typeof d}function r(d){return Math.max(1,(d-1)/1e3)}ee.exports=function(d,s,i){var b,u=d,f=i.noMultiCategory;if(x(u)&&!u.length)return"-";if(!f&&x((b=u)[0])&&x(b[1]))return"multicategory";if(f&&Array.isArray(u[0])){for(var c=[],h=0;h<u.length;h++)if(x(u[h]))for(var p=0;p<u[h].length;p++)c.push(u[h][p]);u=c}if(function(b,l){for(var T=b.length,_=r(T),w=0,k=0,L={},M=0;M<T;M+=_){var P=b[t(M)],S=String(P);L[S]||(L[S]=1,e(P,l)&&w++,g(P)&&k++)}return w>2*k}(u,s))return"date";var o="strict"!==i.autotypenumbers;return function(b,l){for(var T=b.length,_=r(T),w=0,k=0,L={},M=0;M<T;M+=_){var P=b[t(M)],S=String(P);if(!L[S]){L[S]=1;var E=typeof P;"boolean"===E?k++:(l?n(P)!==m:"number"===E)?w++:"string"===E&&k++}}return k>2*w}(u,o)?"category":function(b,l){for(var T=b.length,_=0;_<T;_++)if(a(b[_],l))return!0;return!1}(u,o)?"linear":"-"}},{"../../constants/numerical":491,"../../lib":515,"fast-isnumeric":190}],568:[function(y,ee,Q){"use strict";var g=y("fast-isnumeric"),v=y("../../registry"),m=y("../../lib"),x=y("../../plot_api/plot_template"),e=y("../array_container_defaults"),n=y("./layout_attributes"),t=y("./tick_value_defaults"),a=y("./tick_mark_defaults"),r=y("./tick_label_defaults"),d=y("./prefix_suffix_defaults"),s=y("./category_order_defaults"),i=y("./line_grid_defaults"),u=y("./set_convert"),f=y("./constants").WEEKDAY_PATTERN,c=y("./constants").HOUR_PATTERN;function h(b,l,T){function _(E,z){return m.coerce(b,l,n.rangebreaks,E,z)}if(_("enabled")){var w=_("bounds");if(w&&w.length>=2){var k,L,M="";if(2===w.length)for(k=0;k<2;k++)if(L=o(w[k])){M=f;break}var I=_("pattern",M);if(I===f)for(k=0;k<2;k++)(L=o(w[k]))&&(l.bounds[k]=w[k]=L-1);if(I)for(k=0;k<2;k++)switch(L=w[k],I){case f:if(!g(L)||(L=+L)!==Math.floor(L)||L<0||L>=7)return void(l.enabled=!1);l.bounds[k]=w[k]=L;break;case c:if(!g(L)||(L=+L)<0||L>24)return void(l.enabled=!1);l.bounds[k]=w[k]=L}if(!1===T.autorange){var P=T.range;if(P[0]<P[1]){if(w[0]<P[0]&&w[1]>P[1])return void(l.enabled=!1)}else if(w[0]>P[0]&&w[1]<P[1])return void(l.enabled=!1)}}else{var S=_("values");if(!S||!S.length)return void(l.enabled=!1);_("dvalue")}}}ee.exports=function(b,l,T,_,w){var k,L=_.letter,M=_.font||{},I=_.splomStash||{},P=T("visible",!_.visibleDflt),E=l.type||(l._template||{}).type||"-";"date"===E&&(v.getComponentMethod("calendars","handleDefaults")(b,l,"calendar",_.calendar),_.noTicklabelmode||(k=T("ticklabelmode")));var z="";_.noTicklabelposition&&"multicategory"!==E||(z=m.coerce(b,l,{ticklabelposition:{valType:"enumerated",dflt:"outside",values:"period"===k?["outside","inside"]:"x"===L?["outside","inside","outside left","inside left","outside right","inside right"]:["outside","inside","outside top","inside top","outside bottom","inside bottom"]}},"ticklabelposition")),_.noTicklabeloverflow||T("ticklabeloverflow",-1!==z.indexOf("inside")?"hide past domain":"category"===E||"multicategory"===E?"allow":"hide past div"),u(l,w);var R=!l.isValidRange(b.range);R&&_.reverseDflt&&(R="reversed"),!T("autorange",R)||"linear"!==E&&"-"!==E||T("rangemode"),T("range"),l.cleanRange(),s(b,l,T,_),"category"===E||_.noHover||T("hoverformat");var q=T("color"),V=q!==n.color.dflt?q:M.color,W=I.label||w._dfltTitle[L];if(d(b,l,T,E,_),!P)return l;T("title.text",W),m.coerceFont(T,"title.font",{family:M.family,size:m.bigFont(M.size),color:V}),t(b,l,T,E);var K=_.hasMinor;if(K&&(x.newContainer(l,"minor"),t(b,l,T,E,{isMinor:!0})),r(b,l,T,E,_),a(b,l,T,_),K){var G=_.isMinor;_.isMinor=!0,a(b,l,T,_),_.isMinor=G}i(b,l,T,{dfltColor:q,bgColor:_.bgColor,showGrid:_.showGrid,hasMinor:K,attributes:n}),!K||l.minor.ticks||l.minor.showgrid||delete l.minor,(l.showline||l.ticks)&&T("mirror"),_.automargin&&T("automargin");var Y,$="multicategory"===E;if(_.noTickson||"category"!==E&&!$||!l.ticks&&!l.showgrid||($&&(Y="boundaries"),"boundaries"===T("tickson",Y)&&delete l.ticklabelposition),$&&T("showdividers")&&(T("dividercolor"),T("dividerwidth")),"date"===E)if(e(b,l,{name:"rangebreaks",inclusionAttr:"enabled",handleItemDefaults:h}),l.rangebreaks.length){for(var B=0;B<l.rangebreaks.length;B++)if(l.rangebreaks[B].pattern===f){l._hasDayOfWeekBreaks=!0;break}if(u(l,w),w._has("scattergl")||w._has("splom"))for(var N=0;N<_.data.length;N++){var U=_.data[N];"scattergl"!==U.type&&"splom"!==U.type||(U.visible=!1,m.warn(U.type+" traces do not work on axes with rangebreaks. Setting trace "+U.index+" to `visible: false`."))}}else delete l.rangebreaks;return l};var p={sun:1,mon:2,tue:3,wed:4,thu:5,fri:6,sat:7};function o(b){if("string"==typeof b)return p[b.substr(0,3).toLowerCase()]}},{"../../lib":515,"../../plot_api/plot_template":555,"../../registry":647,"../array_container_defaults":561,"./category_order_defaults":571,"./constants":573,"./layout_attributes":579,"./line_grid_defaults":581,"./prefix_suffix_defaults":583,"./set_convert":585,"./tick_label_defaults":587,"./tick_mark_defaults":588,"./tick_value_defaults":589,"fast-isnumeric":190}],569:[function(y,ee,Q){"use strict";var g=y("../../constants/docs"),v=g.FORMAT_LINK,m=g.DATE_FORMAT_LINK;function x(n,t){return["Sets the "+n+" formatting rule"+(t?"for `"+t+"` ":""),"using d3 formatting mini-languages","which are very similar to those in Python. For numbers, see: "+v+"."].join(" ")}function e(n,t){return x(n,t)+[" And for dates see: "+m+".","We add two items to d3's date formatter:","*%h* for half of the year as a decimal number as well as","*%{n}f* for fractional seconds","with n digits. For example, *2016-10-13 09:15:23.456* with tickformat","*%H~%M~%S.%2f* would display *09~15~23.46*"].join(" ")}ee.exports={axisHoverFormat:function(n,t){return{valType:"string",dflt:"",editType:"none",description:(t?x:e)("hover text",n)+["By default the values are formatted using "+(t?"generic number format":"`"+n+"axis.hoverformat`")+"."].join(" ")}},descriptionOnlyNumbers:x,descriptionWithDates:e}},{"../../constants/docs":486}],570:[function(y,ee,Q){"use strict";var g=y("../../registry"),v=y("./constants");function m(x,e){if(e&&e.length)for(var n=0;n<e.length;n++)if(e[n][x])return!0;return!1}Q.id2name=function(x){if("string"==typeof x&&x.match(v.AX_ID_PATTERN)){var e=x.split(" ")[0].substr(1);return"1"===e&&(e=""),x.charAt(0)+"axis"+e}},Q.name2id=function(x){if(x.match(v.AX_NAME_PATTERN)){var e=x.substr(5);return"1"===e&&(e=""),x.charAt(0)+e}},Q.cleanId=function(x,e,n){var t=/( domain)$/.test(x);if("string"==typeof x&&x.match(v.AX_ID_PATTERN)&&(!e||x.charAt(0)===e)&&(!t||n)){var a=x.split(" ")[0].substr(1).replace(/^0+/,"");return"1"===a&&(a=""),x.charAt(0)+a+(t&&n?" domain":"")}},Q.list=function(x,e,n){var t=x._fullLayout;if(!t)return[];var a,r=Q.listIds(x,e),d=new Array(r.length);for(a=0;a<r.length;a++){var s=r[a];d[a]=t[s.charAt(0)+"axis"+s.substr(1)]}if(!n){var i=t._subplots.gl3d||[];for(a=0;a<i.length;a++){var u=t[i[a]];e?d.push(u[e+"axis"]):d.push(u.xaxis,u.yaxis,u.zaxis)}}return d},Q.listIds=function(x,e){var n=x._fullLayout;if(!n)return[];var t=n._subplots;return e?t[e+"axis"]:t.xaxis.concat(t.yaxis)},Q.getFromId=function(x,e,n){var t=x._fullLayout;return e=void 0===e||"string"!=typeof e?e:e.replace(" domain",""),"x"===n?e=e.replace(/y[0-9]*/,""):"y"===n&&(e=e.replace(/x[0-9]*/,"")),t[Q.id2name(e)]},Q.getFromTrace=function(x,e,n){var t=x._fullLayout,a=null;if(g.traceIs(e,"gl3d")){var r=e.scene;"scene"===r.substr(0,5)&&(a=t[r][n+"axis"])}else a=Q.getFromId(x,e[n+"axis"]||n);return a},Q.idSort=function(x,e){var n=x.charAt(0),t=e.charAt(0);return n!==t?n>t?1:-1:+(x.substr(1)||1)-+(e.substr(1)||1)},Q.ref2id=function(x){return!!/^[xyz]/.test(x)&&x.split(" ")[0]},Q.isLinked=function(x,e){return m(e,x._axisMatchGroups)||m(e,x._axisConstraintGroups)}},{"../../registry":647,"./constants":573}],571:[function(y,ee,Q){"use strict";ee.exports=function(g,v,m,x){if("category"===v.type){var e,n=g.categoryarray,t=Array.isArray(n)&&n.length>0;t&&(e="array");var a,r=m("categoryorder",e);"array"===r&&(a=m("categoryarray")),t||"array"!==r||(r=v.categoryorder="trace"),"trace"===r?v._initialCategories=[]:"array"===r?v._initialCategories=a.slice():(a=function(d,s){var i,u,f,c=s.dataAttr||d._id.charAt(0),h={};if(s.axData)i=s.axData;else for(i=[],u=0;u<s.data.length;u++){var p=s.data[u];p[c+"axis"]===d._id&&i.push(p)}for(u=0;u<i.length;u++){var o=i[u][c];for(f=0;f<o.length;f++){var b=o[f];null!=b&&(h[b]=1)}}return Object.keys(h)}(v,x).sort(),"category ascending"===r?v._initialCategories=a:"category descending"===r&&(v._initialCategories=a.reverse()))}}},{}],572:[function(y,ee,Q){"use strict";var g=y("fast-isnumeric"),v=y("../../lib"),m=y("../../constants/numerical"),x=m.ONEDAY,e=m.ONEWEEK;Q.dtick=function(n,t){var a="log"===t,r="date"===t,d="category"===t,s=r?x:1;if(!n)return s;if(g(n))return(n=Number(n))<=0?s:d?Math.max(1,Math.round(n)):r?Math.max(.1,n):n;if("string"!=typeof n||!r&&!a)return s;var i=n.charAt(0),u=n.substr(1);return(u=g(u)?Number(u):0)<=0||!(r&&"M"===i&&u===Math.round(u)||a&&"L"===i||a&&"D"===i&&(1===u||2===u))?s:n},Q.tick0=function(n,t,a,r){return"date"===t?v.cleanDate(n,v.dateTick0(a,r%e==0?1:0)):"D1"!==r&&"D2"!==r?g(n)?Number(n):0:void 0}},{"../../constants/numerical":491,"../../lib":515,"fast-isnumeric":190}],573:[function(y,ee,Q){"use strict";var g=y("../../lib/regex").counter;ee.exports={idRegex:{x:g("x","( domain)?"),y:g("y","( domain)?")},attrRegex:g("[xy]axis"),xAxisMatch:g("xaxis"),yAxisMatch:g("yaxis"),AX_ID_PATTERN:/^[xyz][0-9]*( domain)?$/,AX_NAME_PATTERN:/^[xyz]axis[0-9]*$/,SUBPLOT_PATTERN:/^x([0-9]*)y([0-9]*)$/,HOUR_PATTERN:"hour",WEEKDAY_PATTERN:"day of week",MINDRAG:8,MINZOOM:20,DRAGGERSIZE:20,REDRAWDELAY:50,DFLTRANGEX:[-1,6],DFLTRANGEY:[-1,4],traceLayerClasses:["imagelayer","heatmaplayer","contourcarpetlayer","contourlayer","funnellayer","waterfalllayer","barlayer","carpetlayer","violinlayer","boxlayer","ohlclayer","scattercarpetlayer","scatterlayer"],clipOnAxisFalseQuery:[".scatterlayer",".barlayer",".funnellayer",".waterfalllayer"],layerValue2layerClass:{"above traces":"above","below traces":"below"}}},{"../../lib/regex":532}],574:[function(y,ee,Q){"use strict";var g=y("../../lib"),v=y("./autorange"),m=y("./axis_ids").id2name,x=y("./layout_attributes"),e=y("./scale_zoom"),n=y("./set_convert"),t=y("../../constants/numerical").ALMOST_EQUAL,a=y("../../constants/alignment").FROM_BL;function r(h,p,o){var b=o.axIds,l=o.layoutOut,T=o.hasImage,_=l._axisConstraintGroups,w=l._axisMatchGroups,k=p._id,L=k.charAt(0),M=((l._splomAxes||{})[L]||{})[k]||{},I=p._id,P="x"===I.charAt(0);function S(te,j){return g.coerce(h,p,x,te,j)}p._matchGroup=null,p._constraintGroup=null,S("constrain",T?"domain":"range"),g.coerce(h,p,{constraintoward:{valType:"enumerated",values:P?["left","center","right"]:["bottom","middle","top"],dflt:P?"center":"middle"}},"constraintoward");var E,z,R=p.type,q=[];for(E=0;E<b.length;E++)(z=b[E])!==I&&l[m(z)].type===R&&q.push(z);var V=s(_,I);if(V){var W=[];for(E=0;E<q.length;E++)V[z=q[E]]||W.push(z);q=W}var K,G,Y=q.length;Y&&(h.matches||M.matches)&&(K=g.coerce(h,p,{matches:{valType:"enumerated",values:q,dflt:-1!==q.indexOf(M.matches)?M.matches:void 0}},"matches"));var $=T&&!P?p.anchor:void 0;if(Y&&!K&&(h.scaleanchor||$)&&(G=g.coerce(h,p,{scaleanchor:{valType:"enumerated",values:q}},"scaleanchor",$)),K){p._matchGroup=i(w,I,K,1);var B=l[m(K)],N=d(l,p)/d(l,B);P!==("x"===K.charAt(0))&&(N=(P?"x":"y")+N),i(_,I,K,N)}else h.matches&&-1!==b.indexOf(h.matches)&&g.warn("ignored "+p._name+'.matches: "'+h.matches+'" to avoid an infinite loop');if(G){var U=S("scaleratio");U||(U=p.scaleratio=1),i(_,I,G,U)}else h.scaleanchor&&-1!==b.indexOf(h.scaleanchor)&&g.warn("ignored "+p._name+'.scaleanchor: "'+h.scaleanchor+'" to avoid either an infinite loop and possibly inconsistent scaleratios, or because this axis declares a *matches* constraint.')}function d(h,p){var o=p.domain;return o||(o=h[m(p.overlaying)].domain),o[1]-o[0]}function s(h,p){for(var o=0;o<h.length;o++)if(h[o][p])return h[o];return null}function i(h,p,o,b){var l,T,_,w,k,L=s(h,p);null===L?((L={})[p]=1,k=h.length,h.push(L)):k=h.indexOf(L);var M=Object.keys(L);for(l=0;l<h.length;l++)if(_=h[l],l!==k&&_[o]){var I=_[o];for(T=0;T<M.length;T++)_[w=M[T]]=u(I,u(b,L[w]));return void h.splice(k,1)}if(1!==b)for(T=0;T<M.length;T++){var P=M[T];L[P]=u(b,L[P])}L[o]=1}function u(h,p){var o,b,l="",T="";"string"==typeof h&&(o=(l=h.match(/^[xy]*/)[0]).length,h=+h.substr(o)),"string"==typeof p&&(b=(T=p.match(/^[xy]*/)[0]).length,p=+p.substr(b));var _=h*p;return o||b?o&&b&&l.charAt(0)!==T.charAt(0)?o===b?_:(o>b?l.substr(b):T.substr(o))+_:l+T+h*p:_}function f(h,p){for(var o=p._size,b=o.h/o.w,l={},T=Object.keys(h),_=0;_<T.length;_++){var w=T[_],k=h[w];if("string"==typeof k){var L=k.match(/^[xy]*/)[0],M=L.length;k=+k.substr(M);for(var I="y"===L.charAt(0)?b:1/b,P=0;P<M;P++)k*=I}l[w]=k}return l}function c(h,p){var o=h._inputDomain,l=o[0]+(o[1]-o[0])*a[h.constraintoward];h.domain=h._input.domain=[l+(o[0]-l)/p,l+(o[1]-l)/p],h.setScale()}Q.handleDefaults=function(h,p,o){var b,l,T,_,w,k,L,M,I=o.axIds,P=o.axHasImage,S=p._axisConstraintGroups=[],E=p._axisMatchGroups=[];for(b=0;b<I.length;b++)r(w=h[_=m(I[b])],k=p[_],{axIds:I,layoutOut:p,hasImage:P[_]});function z(B,N){for(b=0;b<B.length;b++)for(T in l=B[b])p[m(T)][N]=l}for(z(E,"_matchGroup"),b=0;b<S.length;b++)for(T in l=S[b])if((k=p[m(T)]).fixedrange){for(var R in l){var q=m(R);!1===(h[q]||{}).fixedrange&&g.warn("fixedrange was specified as false for axis "+q+" but was overridden because another axis in its constraint group has fixedrange true"),p[q].fixedrange=!0}break}for(b=0;b<S.length;){for(T in l=S[b]){(k=p[m(T)])._matchGroup&&Object.keys(k._matchGroup).length===Object.keys(l).length&&(S.splice(b,1),b--);break}b++}z(S,"_constraintGroup");var V=["constrain","range","autorange","rangemode","rangebreaks","categoryorder","categoryarray"],W=!1,K=!1;function G(){M=k[L],"rangebreaks"===L&&(K=k._hasDayOfWeekBreaks)}for(b=0;b<E.length;b++){l=E[b];for(var Y=0;Y<V.length;Y++){var $;for(T in L=V[Y],M=null,l)if(w=h[_=m(T)],L in(k=p[_])){if(!k.matches&&($=k,L in w)){G();break}null===M&&L in w&&G()}if("range"===L&&M&&(W=!0),"autorange"===L&&null===M&&W&&(M=!1),null===M&&L in $&&(M=$[L]),null!==M)for(T in l)(k=p[m(T)])[L]="range"===L?M.slice():M,"rangebreaks"===L&&(k._hasDayOfWeekBreaks=K,n(k,p))}}},Q.enforce=function(h){var p,o,b,l,T,_,w,k,L=h._fullLayout,M=L._axisConstraintGroups||[];for(p=0;p<M.length;p++){b=f(M[p],L);var I=Object.keys(b),P=1/0,S=0,E=1/0,z={},R={},q=!1;for(o=0;o<I.length;o++)R[l=I[o]]=T=L[m(l)],T._inputDomain?T.domain=T._inputDomain.slice():T._inputDomain=T.domain.slice(),T._inputRange||(T._inputRange=T.range.slice()),T.setScale(),z[l]=_=Math.abs(T._m)/b[l],P=Math.min(P,_),"domain"!==T.constrain&&T._constraintShrinkable||(E=Math.min(E,_)),delete T._constraintShrinkable,S=Math.max(S,_),"domain"===T.constrain&&(q=!0);if(!(P>t*S)||q)for(o=0;o<I.length;o++)if(_=z[l=I[o]],w=(T=R[l]).constrain,_!==E||"domain"===w)if(k=_/E,"range"===w)e(T,k);else{var V=T._inputDomain,W=(T.domain[1]-T.domain[0])/(V[1]-V[0]),K=(T.r2l(T.range[1])-T.r2l(T.range[0]))/(T.r2l(T._inputRange[1])-T.r2l(T._inputRange[0]));if((k/=W)*K<1){T.domain=T._input.domain=V.slice(),e(T,k);continue}if(K<1&&(T.range=T._input.range=T._inputRange.slice(),k*=K),T.autorange){var G=T.r2l(T.range[0]),Y=T.r2l(T.range[1]),$=(G+Y)/2,B=$,N=$,U=Math.abs(Y-$),te=$-U*k*1.0001,j=$+U*k*1.0001,J=v.makePadFn(L,T,0),X=v.makePadFn(L,T,1);c(T,k);var re,ne,le=Math.abs(T._m),oe=v.concatExtremes(h,T),de=oe.min,se=oe.max;for(ne=0;ne<de.length;ne++)(re=de[ne].val-J(de[ne])/le)>te&&re<B&&(B=re);for(ne=0;ne<se.length;ne++)(re=se[ne].val+X(se[ne])/le)<j&&re>N&&(N=re);k/=(N-B)/(2*U),B=T.l2r(B),N=T.l2r(N),T.range=T._input.range=G<Y?[B,N]:[N,B]}c(T,k)}}},Q.getAxisGroup=function(h,p){for(var o=h._axisMatchGroups,b=0;b<o.length;b++)if(o[b][p])return"g"+b;return p},Q.clean=function(h,p){if(p._inputDomain){for(var o=!1,b=p._id,l=h._fullLayout._axisConstraintGroups,T=0;T<l.length;T++)if(l[T][b]){o=!0;break}o&&"domain"===p.constrain||(p._input.domain=p.domain=p._inputDomain,delete p._inputDomain)}}},{"../../constants/alignment":483,"../../constants/numerical":491,"../../lib":515,"./autorange":565,"./axis_ids":570,"./layout_attributes":579,"./scale_zoom":584,"./set_convert":585}],575:[function(y,ee,Q){"use strict";var g=y("@plotly/d3"),v=y("../../lib"),m=v.numberFormat,x=y("tinycolor2"),e=y("has-passive-events"),n=y("../../registry"),t=v.strTranslate,a=y("../../lib/svg_text_utils"),r=y("../../components/color"),d=y("../../components/drawing"),s=y("../../components/fx"),i=y("./axes"),u=y("../../lib/setcursor"),f=y("../../components/dragelement"),c=y("../../components/dragelement/helpers"),h=c.selectingOrDrawing,p=c.freeMode,o=y("../../constants/alignment").FROM_TL,b=y("../../lib/clear_gl_canvases"),l=y("../../plot_api/subroutines").redrawReglTraces,T=y("../plots"),_=y("./axis_ids").getFromId,w=y("../../components/selections").prepSelect,k=y("../../components/selections").clearOutline,L=y("../../components/selections").selectOnClick,M=y("./scale_zoom"),I=y("./constants"),P=I.MINDRAG,S=I.MINZOOM,E=!0;function z(re,ne,le,oe){var de=v.ensureSingle(re.draglayer,ne,le,function(se){se.classed("drag",!0).style({fill:"transparent","stroke-width":0}).attr("data-subplot",re.id)});return de.call(u,oe),de.node()}function R(re,ne,le,oe,de,se,ge){var _e=z(re,"rect",ne,le);return g.select(_e).call(d.setRect,oe,de,se,ge),_e}function q(re,ne){for(var le=0;le<re.length;le++)if(!re[le].fixedrange)return ne;return""}function V(re,ne,le,oe,de){for(var se=0;se<re.length;se++){var ge=re[se];if(!ge.fixedrange)if(ge.rangebreaks){var _e="y"===ge._id.charAt(0),we=_e?1-le:le;oe[ge._name+".range[0]"]=ge.l2r(ge.p2l((_e?1-ne:ne)*ge._length)),oe[ge._name+".range[1]"]=ge.l2r(ge.p2l(we*ge._length))}else{var Oe=ge._rl[0],fe=ge._rl[1]-Oe;oe[ge._name+".range[0]"]=ge.l2r(Oe+fe*ne),oe[ge._name+".range[1]"]=ge.l2r(Oe+fe*le)}}if(de&&de.length){var ve=(ne+(1-le))/2;V(de,ve,1-ve,oe,[])}}function W(re,ne){for(var le=0;le<re.length;le++){var oe=re[le];if(!oe.fixedrange)if(oe.rangebreaks){var de=oe._length,se=(oe.p2l(0+ne)-oe.p2l(0)+(oe.p2l(de+ne)-oe.p2l(de)))/2;oe.range=[oe.l2r(oe._rl[0]-se),oe.l2r(oe._rl[1]-se)]}else oe.range=[oe.l2r(oe._rl[0]-ne/oe._m),oe.l2r(oe._rl[1]-ne/oe._m)]}}function K(re){return 1-(re>=0?Math.min(re,.9):1/(1/Math.max(re,-.3)+3.222))}function G(re,ne,le,oe,de){return re.append("path").attr("class","zoombox").style({fill:ne>.2?"rgba(0,0,0,0)":"rgba(255,255,255,0)","stroke-width":0}).attr("transform",t(le,oe)).attr("d",de+"Z")}function Y(re,ne,le){return re.append("path").attr("class","zoombox-corners").style({fill:r.background,stroke:r.defaultLine,"stroke-width":1,opacity:0}).attr("transform",t(ne,le)).attr("d","M0,0Z")}function $(re,ne,le,oe,de,se){re.attr("d",oe+"M"+le.l+","+le.t+"v"+le.h+"h"+le.w+"v-"+le.h+"h-"+le.w+"Z"),B(re,ne,de,se)}function B(re,ne,le,oe){le||(re.transition().style("fill",oe>.2?"rgba(0,0,0,0.4)":"rgba(255,255,255,0.3)").duration(200),ne.transition().style("opacity",1).duration(200))}function N(re){g.select(re).selectAll(".zoombox,.js-zoombox-backdrop,.js-zoombox-menu,.zoombox-corners").remove()}function U(re){E&&re.data&&re._context.showTips&&(v.notifier(v._(re,"Double-click to zoom back out"),"long"),E=!1)}function te(re){var ne=Math.floor(Math.min(re.b-re.t,re.r-re.l,S)/2);return"M"+(re.l-3.5)+","+(re.t-.5+ne)+"h3v"+-ne+"h"+ne+"v-3h-"+(ne+3)+"ZM"+(re.r+3.5)+","+(re.t-.5+ne)+"h-3v"+-ne+"h"+-ne+"v-3h"+(ne+3)+"ZM"+(re.r+3.5)+","+(re.b+.5-ne)+"h-3v"+ne+"h"+-ne+"v3h"+(ne+3)+"ZM"+(re.l-3.5)+","+(re.b+.5-ne)+"h3v"+ne+"h"+ne+"v3h-"+(ne+3)+"Z"}function j(re,ne,le,oe,de){for(var se,ge,_e,Te,we=!1,Oe={},fe={},ve=(de||{}).xaHash,Ae=(de||{}).yaHash,ke=0;ke<ne.length;ke++){var Pe=ne[ke];for(se in le)if(Pe[se]){for(_e in Pe)de&&(ve[_e]||Ae[_e])||("x"===_e.charAt(0)?le:oe)[_e]||(Oe[_e]=se);for(ge in oe)de&&(ve[ge]||Ae[ge])||!Pe[ge]||(we=!0)}for(ge in oe)if(Pe[ge])for(Te in Pe)de&&(ve[Te]||Ae[Te])||("x"===Te.charAt(0)?le:oe)[Te]||(fe[Te]=ge)}we&&(v.extendFlat(Oe,fe),fe={});var Ne={},De=[];for(_e in Oe){var ze=_(re,_e);De.push(ze),Ne[ze._id]=ze}var Me={},Se=[];for(Te in fe){var Ie=_(re,Te);Se.push(Ie),Me[Ie._id]=Ie}return{xaHash:Ne,yaHash:Me,xaxes:De,yaxes:Se,xLinks:Oe,yLinks:fe,isSubplotConstrained:we}}function J(re,ne){if(e){var le=void 0!==re.onwheel?"wheel":"mousewheel";re._onwheel&&re.removeEventListener(le,re._onwheel),re._onwheel=ne,re.addEventListener(le,ne,{passive:!1})}else void 0!==re.onwheel?re.onwheel=ne:void 0!==re.onmousewheel?re.onmousewheel=ne:re.isAddedWheelEvent||(re.isAddedWheelEvent=!0,re.addEventListener("wheel",ne,{passive:!1}))}function X(re){var ne=[];for(var le in re)ne.push(re[le]);return ne}ee.exports={makeDragBox:function(re,ne,le,oe,de,se,ge,_e){var Te,we,Oe,fe,ve,Ae,ke,Pe,Ne,De,ze,Me,Se,Ie,Fe,Re,Xe,nt,ct,xt,dt,tt,Ke,mt=re._fullLayout._zoomlayer,Bt=ge+_e==="nsew",Ut=1===(ge+_e).length;function er(){if(Ne=(Te=ne.xaxis)._length,De=(we=ne.yaxis)._length,ke=Te._offset,Pe=we._offset,(Oe={})[Te._id]=Te,(fe={})[we._id]=we,ge&&_e)for(var Jt=ne.overlays,$t=0;$t<Jt.length;$t++){var Qt=Jt[$t].xaxis;Oe[Qt._id]=Qt;var cr=Jt[$t].yaxis;fe[cr._id]=cr}ve=X(Oe),Ae=X(fe),Se=q(ve,_e),Ie=q(Ae,ge),Fe=!Ie&&!Se,Me=j(re,re._fullLayout._axisMatchGroups,Oe,fe);var gr=(ze=j(re,re._fullLayout._axisConstraintGroups,Oe,fe,Me)).isSubplotConstrained||Me.isSubplotConstrained;Re=_e||gr,Xe=ge||gr;var Tr=re._fullLayout;nt=Tr._has("scattergl"),ct=Tr._has("splom"),xt=Tr._has("svg")}er();var Jt,Wt=(Jt=Ie+Se)?"nsew"===Jt?Bt?"":"pan"===re._fullLayout.dragmode?"move":"crosshair":Jt.toLowerCase()+"-resize":"pointer",rr=R(ne,ge+_e+"drag",Wt,le,oe,de,se);if(Fe&&!Bt)return rr.onmousedown=null,rr.style.pointerEvents="none",rr;var Ht,Ve,We,he,ye,Be,Ge,Je,He,st,ot={element:rr,gd:re,plotinfo:ne};function wt(){ot.plotinfo.selection=!1,k(re)}function Ct(Jt,$t){var $r,Pn,gn,dn,An,Qt=ot.gd;if(Qt._fullLayout._activeShapeIndex>=0)Qt._fullLayout._deactivateShape(Qt);else{var cr=Qt._fullLayout.clickmode;if(N(Qt),2!==Jt||Ut||function Ft(){if(!re._transitioningWithDuration){var Jt=re._context.doubleClick,$t=[];Se&&($t=$t.concat(ve)),Ie&&($t=$t.concat(Ae)),Me.xaxes&&($t=$t.concat(Me.xaxes)),Me.yaxes&&($t=$t.concat(Me.yaxes));var Qt,cr,gr,Tr={};if("reset+autosize"===Jt)for(Jt="autosize",cr=0;cr<$t.length;cr++)if((Qt=$t[cr])._rangeInitial&&(Qt.range[0]!==Qt._rangeInitial[0]||Qt.range[1]!==Qt._rangeInitial[1])||!Qt._rangeInitial&&!Qt.autorange){Jt="reset";break}if("autosize"===Jt)for(cr=0;cr<$t.length;cr++)(Qt=$t[cr]).fixedrange||(Tr[Qt._name+".autorange"]=!0);else if("reset"===Jt)for((Se||ze.isSubplotConstrained)&&($t=$t.concat(ze.xaxes)),Ie&&!ze.isSubplotConstrained&&($t=$t.concat(ze.yaxes)),ze.isSubplotConstrained&&(Se?Ie||($t=$t.concat(Ae)):$t=$t.concat(ve)),cr=0;cr<$t.length;cr++)(Qt=$t[cr]).fixedrange||(Qt._rangeInitial?(Tr[Qt._name+".range[0]"]=(gr=Qt._rangeInitial)[0],Tr[Qt._name+".range[1]"]=gr[1]):Tr[Qt._name+".autorange"]=!0);re.emit("plotly_doubleclick",null),n.call("_guiRelayout",re,Tr)}}(),Bt)cr.indexOf("select")>-1&&L($t,Qt,ve,Ae,ne.id,ot),cr.indexOf("event")>-1&&s.click(Qt,$t,ne.id);else if(1===Jt&&Ut){var gr=ge?we:Te,Tr="s"===ge||"w"===_e?0:1,Fr=gr._name+".range["+Tr+"]",Nr=(dn=($r=gr).range[Pn=Tr],An=Math.abs(dn-$r.range[1-Pn]),"date"===$r.type?dn:"log"===$r.type?(gn=Math.ceil(Math.max(0,-Math.log(An)/Math.LN10))+3,m("."+gn+"g")(Math.pow(10,dn))):(gn=Math.floor(Math.log(Math.abs(dn))/Math.LN10)-Math.floor(Math.log(An)/Math.LN10)+4,m("."+String(gn)+"g")(dn))),Xr="left",un="middle";if(gr.fixedrange)return;ge?(un="n"===ge?"top":"bottom","right"===gr.side&&(Xr="right")):"e"===_e&&(Xr="right"),Qt._context.showAxisRangeEntryBoxes&&g.select(rr).call(a.makeEditable,{gd:Qt,immediate:!0,background:Qt._fullLayout.paper_bgcolor,text:String(Nr),fill:gr.tickfont?gr.tickfont.color:"#444",horizontalAlign:Xr,verticalAlign:un}).on("edit",function($r){var Pn=gr.d2r($r);void 0!==Pn&&n.call("_guiRelayout",Qt,Fr,Pn)})}}}function rt(Jt,$t){if(re._transitioningWithDuration)return!1;var un,$r,Qt=Math.max(0,Math.min(Ne,tt*Jt+Ht)),cr=Math.max(0,Math.min(De,Ke*$t+Ve)),gr=Math.abs(Qt-Ht),Tr=Math.abs(cr-Ve);function Fr(){Ge="",We.r=We.l,We.t=We.b,He.attr("d","M0,0Z")}if(We.l=Math.min(Ht,Qt),We.r=Math.max(Ht,Qt),We.t=Math.min(Ve,cr),We.b=Math.max(Ve,cr),ze.isSubplotConstrained)gr>S||Tr>S?(Ge="xy",gr/Ne>Tr/De?(Tr=gr*De/Ne,Ve>cr?We.t=Ve-Tr:We.b=Ve+Tr):(gr=Tr*Ne/De,Ht>Qt?We.l=Ht-gr:We.r=Ht+gr),He.attr("d",te(We))):Fr();else if(Me.isSubplotConstrained)if(gr>S||Tr>S){Ge="xy";var Nr=Math.min(We.l/Ne,(De-We.b)/De),Xr=Math.max(We.r/Ne,(De-We.t)/De);We.l=Nr*Ne,We.r=Xr*Ne,We.b=(1-Nr)*De,We.t=(1-Xr)*De,He.attr("d",te(We))}else Fr();else!Ie||Tr<Math.min(Math.max(.6*gr,P),S)?gr<P||!Se?Fr():(We.t=0,We.b=De,Ge="x",He.attr("d","M"+((un=We).l-.5)+","+(($r=Ve)-S-.5)+"h-3v"+(2*S+1)+"h3ZM"+(un.r+.5)+","+($r-S-.5)+"h3v"+(2*S+1)+"h-3Z")):!Se||gr<Math.min(.6*Tr,S)?(We.l=0,We.r=Ne,Ge="y",He.attr("d",function(un,$r){return"M"+($r-S-.5)+","+(un.t-.5)+"v-3h"+(2*S+1)+"v3ZM"+($r-S-.5)+","+(un.b+.5)+"v3h"+(2*S+1)+"v-3Z"}(We,Ht))):(Ge="xy",He.attr("d",te(We)));We.w=We.r-We.l,We.h=We.b-We.t,Ge&&(st=!0),re._dragged=st,$(Je,He,We,ye,Be,he),ft(),re.emit("plotly_relayouting",dt),Be=!0}function ft(){dt={},"xy"!==Ge&&"x"!==Ge||(V(ve,We.l/Ne,We.r/Ne,dt,ze.xaxes),ht("x",dt)),"xy"!==Ge&&"y"!==Ge||(V(Ae,(De-We.b)/De,(De-We.t)/De,dt,ze.yaxes),ht("y",dt))}function Rt(){ft(),N(re),Gt(),U(re)}ot.prepFn=function(Jt,$t,Qt){var cr=ot.dragmode,gr=re._fullLayout.dragmode;gr!==cr&&(ot.dragmode=gr),er(),tt=re._fullLayout._invScaleX,Ke=re._fullLayout._invScaleY,Fe||(Bt?Jt.shiftKey?"pan"===gr?gr="zoom":h(gr)||(gr="pan"):Jt.ctrlKey&&(gr="pan"):gr="pan"),ot.minDrag=p(gr)?1:void 0,h(gr)?(ot.xaxes=ve,ot.yaxes=Ae,w(Jt,$t,Qt,ot,gr)):(ot.clickFn=Ct,h(cr)&&wt(),Fe||("zoom"===gr?(ot.moveFn=rt,ot.doneFn=Rt,ot.minDrag=1,function(Tr,Fr,Nr){var Xr=rr.getBoundingClientRect();Ht=Fr-Xr.left,Ve=Nr-Xr.top,re._fullLayout._calcInverseTransform(re);var un=v.apply3DTransform(re._fullLayout._invTransform)(Ht,Ve);We={l:Ht=un[0],r:Ht,w:0,t:Ve=un[1],b:Ve,h:0},he=re._hmpixcount?re._hmlumcount/re._hmpixcount:x(re._fullLayout.plot_bgcolor).getLuminance(),Be=!1,Ge="xy",st=!1,Je=G(mt,he,ke,Pe,ye="M0,0H"+Ne+"V"+De+"H0V0"),He=Y(mt,ke,Pe)}(0,$t,Qt)):"pan"===gr&&(ot.moveFn=it,ot.doneFn=Gt))),re._fullLayout._redrag=function(){var Tr=re._dragdata;Tr&&Tr.element===rr&&(h(re._fullLayout.dragmode)||(er(),jt([0,0,Ne,De]),ot.moveFn(Tr.dx,Tr.dy)))}},f.init(ot);var kt=[0,0,Ne,De],Lt=null,Ee=I.REDRAWDELAY,Ye=ne.mainplot?re._fullLayout._plots[ne.mainplot]:ne;function it(Jt,$t){if(Jt*=tt,$t*=Ke,!re._transitioningWithDuration){if(re._fullLayout._replotting=!0,"ew"===Se||"ns"===Ie){var Qt=Se?-Jt:0,cr=Ie?-$t:0;if(Me.isSubplotConstrained){if(Se&&Ie){var gr=(Jt/Ne-$t/De)/2;Qt=-(Jt=gr*Ne),cr=-($t=-gr*De)}Ie?Qt=-cr*Ne/De:cr=-Qt*De/Ne}return Se&&(W(ve,Jt),ht("x")),Ie&&(W(Ae,$t),ht("y")),jt([Qt,cr,Ne,De]),At(),void re.emit("plotly_relayouting",dt)}var Tr,Fr,Nr="w"===Se==("n"===Ie)?1:-1;if(Se&&Ie&&(ze.isSubplotConstrained||Me.isSubplotConstrained)){var Xr=(Jt/Ne+Nr*$t/De)/2;Jt=Xr*Ne,$t=Nr*Xr*De}if("w"===Se?Jt=gn(ve,0,Jt):"e"===Se?Jt=gn(ve,1,-Jt):Se||(Jt=0),"n"===Ie?$t=gn(Ae,1,$t):"s"===Ie?$t=gn(Ae,0,-$t):Ie||($t=0),Tr="w"===Se?Jt:0,Fr="n"===Ie?$t:0,ze.isSubplotConstrained&&!Me.isSubplotConstrained||Me.isSubplotConstrained&&Se&&Ie&&Nr>0){var un;if(Me.isSubplotConstrained||!Se&&1===Ie.length){for(un=0;un<ve.length;un++)ve[un].range=ve[un]._r.slice(),M(ve[un],1-$t/De);Tr=(Jt=$t*Ne/De)/2}if(Me.isSubplotConstrained||!Ie&&1===Se.length){for(un=0;un<Ae.length;un++)Ae[un].range=Ae[un]._r.slice(),M(Ae[un],1-Jt/Ne);Fr=($t=Jt*De/Ne)/2}}Me.isSubplotConstrained&&Ie||ht("x"),Me.isSubplotConstrained&&Se||ht("y");var $r=Ne-Jt,Pn=De-$t;!Me.isSubplotConstrained||Se&&Ie||(Se?(Fr=Tr?0:Jt*De/Ne,Pn=$r*De/Ne):(Tr=Fr?0:$t*Ne/De,$r=Pn*Ne/De)),jt([Tr,Fr,$r,Pn]),At(),re.emit("plotly_relayouting",dt)}function gn(dn,An,Zn){for(var Rr,hn,nn=1-An,Hr=0;Hr<dn.length;Hr++){var Fn=dn[Hr];if(!Fn.fixedrange){Rr=Fn,hn=Fn._rl[nn]+(Fn._rl[An]-Fn._rl[nn])/K(Zn/Fn._length);var Un=Fn.l2r(hn);!1!==Un&&void 0!==Un&&(Fn.range[An]=Un)}}return Rr._length*(Rr._rl[An]-hn)/(Rr._rl[An]-Rr._rl[nn])}}function ht(Jt,$t){for(var Qt=Me.isSubplotConstrained?{x:Ae,y:ve}[Jt]:Me[Jt+"axes"],cr=Me.isSubplotConstrained?{x:ve,y:Ae}[Jt]:[],gr=0;gr<Qt.length;gr++){var Tr=Qt[gr],Fr=Tr._id,Nr=Me.xLinks[Fr]||Me.yLinks[Fr],Xr=cr[0]||Oe[Nr]||fe[Nr];Xr&&($t?($t[Tr._name+".range[0]"]=$t[Xr._name+".range[0]"],$t[Tr._name+".range[1]"]=$t[Xr._name+".range[1]"]):Tr.range=Xr.range.slice())}}function At(){var Jt,$t=[];function Qt(Tr){for(Jt=0;Jt<Tr.length;Jt++)Tr[Jt].fixedrange||$t.push(Tr[Jt]._id)}for(Re&&(Qt(ve),Qt(ze.xaxes),Qt(Me.xaxes)),Xe&&(Qt(Ae),Qt(ze.yaxes),Qt(Me.yaxes)),dt={},Jt=0;Jt<$t.length;Jt++){var gr=_(re,$t[Jt]);i.drawOne(re,gr,{skipTitle:!0}),dt[gr._name+".range[0]"]=gr.range[0],dt[gr._name+".range[1]"]=gr.range[1]}i.redrawComponents(re,$t)}function Gt(){jt([0,0,Ne,De]),v.syncOrAsync([T.previousPromises,function(){re._fullLayout._replotting=!1,n.call("_guiRelayout",re,dt)}],re)}function jt(Jt){var $t,Qt,cr,gr,Tr=re._fullLayout,Fr=Tr._plots,Nr=Tr._subplots.cartesian;if(ct&&n.subplotsRegistry.splom.drag(re),nt)for($t=0;$t<Nr.length;$t++)if(cr=(Qt=Fr[Nr[$t]]).xaxis,gr=Qt.yaxis,Qt._scene){var Xr=v.simpleMap(cr.range,cr.r2l),un=v.simpleMap(gr.range,gr.r2l);Qt._scene.update({range:[Xr[0],un[0],Xr[1],un[1]]})}if((ct||nt)&&(b(re),l(re)),xt){var $r=Jt[2]/Te._length,Pn=Jt[3]/we._length;for($t=0;$t<Nr.length;$t++){cr=(Qt=Fr[Nr[$t]]).xaxis,gr=Qt.yaxis;var gn,dn,An,Zn,hn=(Xe||Me.isSubplotConstrained)&&!gr.fixedrange&&fe[gr._id];if((Re||Me.isSubplotConstrained)&&!cr.fixedrange&&Oe[cr._id]?(gn=$r,An=_e||Me.isSubplotConstrained?Jt[0]:ur(cr,gn)):Me.xaHash[cr._id]?(gn=$r,An=Jt[0]*cr._length/Te._length):Me.yaHash[cr._id]?(gn=Pn,An="ns"===Ie?-Jt[1]*cr._length/we._length:ur(cr,gn,{n:"top",s:"bottom"}[Ie])):An=kr(cr,gn=fr(cr,$r,Pn)),hn?(dn=Pn,Zn=ge||Me.isSubplotConstrained?Jt[1]:ur(gr,dn)):Me.yaHash[gr._id]?(dn=Pn,Zn=Jt[1]*gr._length/we._length):Me.xaHash[gr._id]?(dn=$r,Zn="ew"===Se?-Jt[0]*gr._length/Te._length:ur(gr,dn,{e:"right",w:"left"}[Se])):Zn=kr(gr,dn=fr(gr,$r,Pn)),gn||dn){gn||(gn=1),dn||(dn=1);var nn=cr._offset-An/gn,Hr=gr._offset-Zn/dn;Qt.clipRect.call(d.setTranslate,An,Zn).call(d.setScale,gn,dn),Qt.plot.call(d.setTranslate,nn,Hr).call(d.setScale,1/gn,1/dn),gn===Qt.xScaleFactor&&dn===Qt.yScaleFactor||(d.setPointGroupScale(Qt.zoomScalePts,gn,dn),d.setTextPointsScale(Qt.zoomScaleTxt,gn,dn)),d.hideOutsideRangePoints(Qt.clipOnAxisFalseTraces,Qt),Qt.xScaleFactor=gn,Qt.yScaleFactor=dn}}}}function fr(Jt,$t,Qt){return Jt.fixedrange?0:Re&&ze.xaHash[Jt._id]?$t:Xe&&(ze.isSubplotConstrained?ze.xaHash:ze.yaHash)[Jt._id]?Qt:0}function kr(Jt,$t){return $t?(Jt.range=Jt._r.slice(),M(Jt,$t),ur(Jt,$t)):0}function ur(Jt,$t,Qt){return Jt._length*(1-$t)*o[Qt||Jt.constraintoward||"middle"]}return ge.length*_e.length!=1&&J(rr,function(Jt){if(re._context._scrollZoom.cartesian||re._fullLayout._enablescrollzoom){if(wt(),re._transitioningWithDuration)return Jt.preventDefault(),void Jt.stopPropagation();er(),clearTimeout(Lt);var $t=-Jt.deltaY;if(isFinite($t)||($t=Jt.wheelDelta/10),isFinite($t)){var Qt,cr=Math.exp(-Math.min(Math.max($t,-20),20)/200),gr=Ye.draglayer.select(".nsewdrag").node().getBoundingClientRect(),Tr=(Jt.clientX-gr.left)/gr.width,Fr=(gr.bottom-Jt.clientY)/gr.height;if(Re){for(_e||(Tr=.5),Qt=0;Qt<ve.length;Qt++)Nr(ve[Qt],Tr,cr);ht("x"),kt[2]*=cr,kt[0]+=kt[2]*Tr*(1/cr-1)}if(Xe){for(ge||(Fr=.5),Qt=0;Qt<Ae.length;Qt++)Nr(Ae[Qt],Fr,cr);ht("y"),kt[3]*=cr,kt[1]+=kt[3]*(1-Fr)*(1/cr-1)}jt(kt),At(),re.emit("plotly_relayouting",dt),Lt=setTimeout(function(){re._fullLayout&&(kt=[0,0,Ne,De],Gt())},Ee),Jt.preventDefault()}else v.log("Did not find wheel motion attributes: ",Jt)}function Nr(Xr,un,$r){if(!Xr.fixedrange){var Pn=v.simpleMap(Xr.range,Xr.r2l),gn=Pn[0]+(Pn[1]-Pn[0])*un;Xr.range=Pn.map(function(dn){return Xr.l2r(gn+(dn-gn)*$r)})}}}),rr},makeDragger:z,makeRectDragger:R,makeZoombox:G,makeCorners:Y,updateZoombox:$,xyCorners:te,transitionZoombox:B,removeZoombox:N,showDoubleClickNotifier:U,attachWheelEventHandler:J}},{"../../components/color":367,"../../components/dragelement":386,"../../components/dragelement/helpers":385,"../../components/drawing":389,"../../components/fx":407,"../../components/selections":455,"../../constants/alignment":483,"../../lib":515,"../../lib/clear_gl_canvases":499,"../../lib/setcursor":536,"../../lib/svg_text_utils":541,"../../plot_api/subroutines":556,"../../registry":647,"../plots":628,"./axes":566,"./axis_ids":570,"./constants":573,"./scale_zoom":584,"@plotly/d3":58,"has-passive-events":229,tinycolor2:313}],576:[function(y,ee,Q){"use strict";var g=y("@plotly/d3"),v=y("../../components/fx"),m=y("../../components/dragelement"),x=y("../../lib/setcursor"),e=y("./dragbox").makeDragBox,n=y("./constants").DRAGGERSIZE;Q.initInteractions=function(t){var a=t._fullLayout;if(t._context.staticPlot)g.select(t).selectAll(".drag").remove();else if(a._has("cartesian")||a._has("splom")){Object.keys(a._plots||{}).sort(function(d,s){if((a._plots[d].mainplot&&!0)===(a._plots[s].mainplot&&!0)){var i=d.split("y"),u=s.split("y");return i[0]===u[0]?Number(i[1]||1)-Number(u[1]||1):Number(i[0]||1)-Number(u[0]||1)}return a._plots[d].mainplot?1:-1}).forEach(function(d){var s=a._plots[d],i=s.xaxis,u=s.yaxis;if(!s.mainplot){var f=e(t,s,i._offset,u._offset,i._length,u._length,"ns","ew");f.onmousemove=function(p){t._fullLayout._rehover=function(){t._fullLayout._hoversubplot===d&&t._fullLayout._plots[d]&&v.hover(t,p,d)},v.hover(t,p,d),t._fullLayout._lasthover=f,t._fullLayout._hoversubplot=d},f.onmouseout=function(p){t._dragging||(t._fullLayout._hoversubplot=null,m.unhover(t,p))},t._context.showAxisDragHandles&&(e(t,s,i._offset-n,u._offset-n,n,n,"n","w"),e(t,s,i._offset+i._length,u._offset-n,n,n,"n","e"),e(t,s,i._offset-n,u._offset+u._length,n,n,"s","w"),e(t,s,i._offset+i._length,u._offset+u._length,n,n,"s","e"))}if(t._context.showAxisDragHandles){if(d===i._mainSubplot){var c=i._mainLinePosition;"top"===i.side&&(c-=n),e(t,s,i._offset+.1*i._length,c,.8*i._length,n,"","ew"),e(t,s,i._offset,c,.1*i._length,n,"","w"),e(t,s,i._offset+.9*i._length,c,.1*i._length,n,"","e")}if(d===u._mainSubplot){var h=u._mainLinePosition;"right"!==u.side&&(h-=n),e(t,s,h,u._offset+.1*u._length,n,.8*u._length,"ns",""),e(t,s,h,u._offset+.9*u._length,n,.1*u._length,"s",""),e(t,s,h,u._offset,n,.1*u._length,"n","")}}});var r=a._hoverlayer.node();r.onmousemove=function(d){d.target=t._fullLayout._lasthover,v.hover(t,d,a._hoversubplot)},r.onclick=function(d){d.target=t._fullLayout._lasthover,v.click(t,d)},r.onmousedown=function(d){t._fullLayout._lasthover.onmousedown(d)},Q.updateFx(t)}},Q.updateFx=function(t){var a=t._fullLayout;x(a._draggers,"pan"===a.dragmode?"move":"crosshair")}},{"../../components/dragelement":386,"../../components/fx":407,"../../lib/setcursor":536,"./constants":573,"./dragbox":575,"@plotly/d3":58}],577:[function(y,ee,Q){"use strict";var g=y("../../registry"),v=y("../../lib"),m=y("./axis_ids");ee.exports=function(x){return function(e,n){var t=e[x];if(Array.isArray(t))for(var a=g.subplotsRegistry.cartesian,r=a.idRegex,d=n._subplots,s=d.xaxis,i=d.yaxis,u=d.cartesian,f=n._has("cartesian")||n._has("gl2d"),c=0;c<t.length;c++){var h=t[c];if(v.isPlainObject(h)){var p=m.cleanId(h.xref,"x",!1),o=m.cleanId(h.yref,"y",!1),b=r.x.test(p),l=r.y.test(o);if(b||l){f||v.pushUnique(n._basePlotModules,a);var T=!1;b&&-1===s.indexOf(p)&&(s.push(p),T=!0),l&&-1===i.indexOf(o)&&(i.push(o),T=!0),T&&b&&l&&u.push(p+o)}}}}}},{"../../lib":515,"../../registry":647,"./axis_ids":570}],578:[function(y,ee,Q){"use strict";var g=y("@plotly/d3"),v=y("../../registry"),m=y("../../lib"),x=y("../plots"),e=y("../../components/drawing"),n=y("../get_data").getModuleCalcData,t=y("./axis_ids"),a=y("./constants"),r=y("../../constants/xmlns_namespaces"),d=m.ensureSingle;function s(h,p,o){return m.ensureSingle(h,p,o,function(b){b.datum(o)})}function i(h,p,o,b,l){for(var T,_,w,k=a.traceLayerClasses,L=h._fullLayout,M=L._modules,I=[],P=[],S=0;S<M.length;S++){var E=(T=M[S]).name,z=v.modules[E].categories;if(z.svg){var R=T.layerName||E+"layer",q=T.plot;w=(_=n(o,q))[0],o=_[1],w.length&&I.push({i:k.indexOf(R),className:R,plotMethod:q,cdModule:w}),z.zoomScale&&P.push("."+R)}}I.sort(function(K,G){return K.i-G.i});var V=p.plot.selectAll("g.mlayer").data(I,function(K){return K.className});if(V.enter().append("g").attr("class",function(K){return K.className}).classed("mlayer",!0).classed("rangeplot",p.isRangePlot),V.exit().remove(),V.order(),V.each(function(K){var G=g.select(this),Y=K.className;K.plotMethod(h,p,K.cdModule,G,b,l),-1===a.clipOnAxisFalseQuery.indexOf("."+Y)&&e.setClipUrl(G,p.layerClipId,h)}),L._has("scattergl")&&(T=v.getModule("scattergl"),w=n(o,T)[0],T.plot(h,p,w)),!h._context.staticPlot&&(p._hasClipOnAxisFalse&&(p.clipOnAxisFalseTraces=p.plot.selectAll(a.clipOnAxisFalseQuery.join(",")).selectAll(".trace")),P.length)){var W=p.plot.selectAll(P.join(",")).selectAll(".trace");p.zoomScalePts=W.selectAll("path.point"),p.zoomScaleTxt=W.selectAll(".textpoint")}}function u(h,p){var o=p.plotgroup,b=p.id,l=a.layerValue2layerClass[p.xaxis.layer],T=a.layerValue2layerClass[p.yaxis.layer],_=h._fullLayout._hasOnlyLargeSploms;if(p.mainplot){var w=p.mainplotinfo,k=w.plotgroup,L=b+"-x",M=b+"-y";p.minorGridlayer=w.minorGridlayer,p.gridlayer=w.gridlayer,p.zerolinelayer=w.zerolinelayer,d(w.overlinesBelow,"path",L),d(w.overlinesBelow,"path",M),d(w.overaxesBelow,"g",L),d(w.overaxesBelow,"g",M),p.plot=d(w.overplot,"g",b),d(w.overlinesAbove,"path",L),d(w.overlinesAbove,"path",M),d(w.overaxesAbove,"g",L),d(w.overaxesAbove,"g",M),p.xlines=k.select(".overlines-"+l).select("."+L),p.ylines=k.select(".overlines-"+T).select("."+M),p.xaxislayer=k.select(".overaxes-"+l).select("."+L),p.yaxislayer=k.select(".overaxes-"+T).select("."+M)}else if(_)p.xlines=d(o,"path","xlines-above"),p.ylines=d(o,"path","ylines-above"),p.xaxislayer=d(o,"g","xaxislayer-above"),p.yaxislayer=d(o,"g","yaxislayer-above");else{var I=d(o,"g","layer-subplot");p.shapelayer=d(I,"g","shapelayer"),p.imagelayer=d(I,"g","imagelayer"),p.minorGridlayer=d(o,"g","minor-gridlayer"),p.gridlayer=d(o,"g","gridlayer"),p.zerolinelayer=d(o,"g","zerolinelayer"),d(o,"path","xlines-below"),d(o,"path","ylines-below"),p.overlinesBelow=d(o,"g","overlines-below"),d(o,"g","xaxislayer-below"),d(o,"g","yaxislayer-below"),p.overaxesBelow=d(o,"g","overaxes-below"),p.plot=d(o,"g","plot"),p.overplot=d(o,"g","overplot"),p.xlines=d(o,"path","xlines-above"),p.ylines=d(o,"path","ylines-above"),p.overlinesAbove=d(o,"g","overlines-above"),d(o,"g","xaxislayer-above"),d(o,"g","yaxislayer-above"),p.overaxesAbove=d(o,"g","overaxes-above"),p.xlines=o.select(".xlines-"+l),p.ylines=o.select(".ylines-"+T),p.xaxislayer=o.select(".xaxislayer-"+l),p.yaxislayer=o.select(".yaxislayer-"+T)}_||(s(p.minorGridlayer,"g",p.xaxis._id),s(p.minorGridlayer,"g",p.yaxis._id),p.minorGridlayer.selectAll("g").map(function(P){return P[0]}).sort(t.idSort),s(p.gridlayer,"g",p.xaxis._id),s(p.gridlayer,"g",p.yaxis._id),p.gridlayer.selectAll("g").map(function(P){return P[0]}).sort(t.idSort)),p.xlines.style("fill","none").classed("crisp",!0),p.ylines.style("fill","none").classed("crisp",!0)}function f(h,p){if(h){var o={};for(var b in h.each(function(w){var k=w[0];g.select(this).remove(),c(k,p),o[k]=!0}),p._plots)for(var l=p._plots[b].overlays||[],T=0;T<l.length;T++){var _=l[T];o[_.id]&&_.plot.selectAll(".trace").remove()}}}function c(h,p){p._draggers.selectAll("g."+h).remove(),p._defs.select("#clip"+p._uid+h+"plot").remove()}Q.name="cartesian",Q.attr=["xaxis","yaxis"],Q.idRoot=["x","y"],Q.idRegex=a.idRegex,Q.attrRegex=a.attrRegex,Q.attributes=y("./attributes"),Q.layoutAttributes=y("./layout_attributes"),Q.supplyLayoutDefaults=y("./layout_defaults"),Q.transitionAxes=y("./transition_axes"),Q.finalizeSubplots=function(h,p){var o,b,l,T=p._subplots,_=T.xaxis,w=T.yaxis,k=T.cartesian,L=k.concat(T.gl2d||[]),M={},I={};for(o=0;o<L.length;o++){var P=L[o].split("y");M[P[0]]=1,I["y"+P[1]]=1}for(o=0;o<_.length;o++)M[b=_[o]]||(l=(h[t.id2name(b)]||{}).anchor,a.idRegex.y.test(l)||(l="y"),k.push(b+l),L.push(b+l),I[l]||(I[l]=1,m.pushUnique(w,l)));for(o=0;o<w.length;o++)I[l=w[o]]||(b=(h[t.id2name(l)]||{}).anchor,a.idRegex.x.test(b)||(b="x"),k.push(b+l),L.push(b+l),M[b]||(M[b]=1,m.pushUnique(_,b)));if(!L.length){for(var S in b="",l="",h)a.attrRegex.test(S)&&("x"===S.charAt(0)?(!b||+S.substr(5)<+b.substr(5))&&(b=S):(!l||+S.substr(5)<+l.substr(5))&&(l=S));b=b?t.name2id(b):"x",l=l?t.name2id(l):"y",_.push(b),w.push(l),k.push(b+l)}},Q.plot=function(h,p,o,b){var l,T=h._fullLayout,_=T._subplots.cartesian,w=h.calcdata;if(!Array.isArray(p))for(p=[],l=0;l<w.length;l++)p.push(l);for(l=0;l<_.length;l++){for(var k,L=_[l],M=T._plots[L],I=[],P=0;P<w.length;P++){var S=w[P],E=S[0].trace;E.xaxis+E.yaxis===L&&((-1!==p.indexOf(E.index)||E.carpet)&&(k&&k[0].trace.xaxis+k[0].trace.yaxis===L&&-1!==["tonextx","tonexty","tonext"].indexOf(E.fill)&&-1===I.indexOf(k)&&I.push(k),I.push(S)),k=S)}i(h,M,I,o,b)}},Q.clean=function(h,p,o,b){var l,T,_,w=b._plots||{},k=p._plots||{},L=b._subplots||{};if(b._hasOnlyLargeSploms&&!p._hasOnlyLargeSploms)for(_ in w)(l=w[_]).plotgroup&&l.plotgroup.remove();var M=b._has&&b._has("gl"),I=p._has&&p._has("gl");if(M&&!I)for(_ in w)(l=w[_])._scene&&l._scene.destroy();if(L.xaxis&&L.yaxis){var P=t.listIds({_fullLayout:b});for(T=0;T<P.length;T++){var S=P[T];p[t.id2name(S)]||b._infolayer.selectAll(".g-"+S+"title").remove()}}var E=b._has&&b._has("cartesian"),z=p._has&&p._has("cartesian");if(E&&!z)f(b._cartesianlayer.selectAll(".subplot"),b),b._defs.selectAll(".axesclip").remove(),delete b._axisConstraintGroups,delete b._axisMatchGroups;else if(L.cartesian)for(T=0;T<L.cartesian.length;T++){var R=L.cartesian[T];k[R]||(b._cartesianlayer.selectAll("."+R+",."+R+"-x,."+R+"-y").remove(),c(R,b))}},Q.drawFramework=function(h){var p=h._fullLayout,o=function(l){var T,_,w,k,L,M,I=l._fullLayout,P=I._subplots.cartesian,S=P.length,E=[],z=[];for(T=0;T<S;T++){var V=(L=(k=I._plots[w=P[T]]).xaxis)._mainAxis._id+(M=k.yaxis)._mainAxis._id,W=I._plots[V];k.overlays=[],V!==w&&W?(k.mainplot=V,k.mainplotinfo=W,z.push(w)):(k.mainplot=void 0,k.mainplotinfo=void 0,E.push(w))}for(T=0;T<z.length;T++)(k=I._plots[w=z[T]]).mainplotinfo.overlays.push(k);var K=E.concat(z),G=new Array(S);for(T=0;T<S;T++){var Y=[w=K[T],(L=(k=I._plots[w]).xaxis).layer,(M=k.yaxis).layer,L.overlaying||"",M.overlaying||""];for(_=0;_<k.overlays.length;_++)Y.push(k.overlays[_].id);G[T]=Y}return G}(h),b=p._cartesianlayer.selectAll(".subplot").data(o,String);b.enter().append("g").attr("class",function(l){return"subplot "+l[0]}),b.order(),b.exit().call(f,p),b.each(function(l){var T=l[0],_=p._plots[T];_.plotgroup=g.select(this),u(h,_),_.draglayer=d(p._draggers,"g",T)})},Q.rangePlot=function(h,p,o){u(h,p),i(h,p,o),x.style(h)},Q.toSVG=function(h){var p=h._fullLayout._glimages,o=g.select(h).selectAll(".svg-container");o.filter(function(b,l){return l===o.size()-1}).selectAll(".gl-canvas-context, .gl-canvas-focus").each(function(){var b=this.toDataURL("image/png");p.append("svg:image").attr({xmlns:r.svg,"xlink:href":b,preserveAspectRatio:"none",x:0,y:0,width:this.style.width,height:this.style.height})})},Q.updateFx=y("./graph_interact").updateFx},{"../../components/drawing":389,"../../constants/xmlns_namespaces":492,"../../lib":515,"../../registry":647,"../get_data":602,"../plots":628,"./attributes":564,"./axis_ids":570,"./constants":573,"./graph_interact":576,"./layout_attributes":579,"./layout_defaults":580,"./transition_axes":590,"@plotly/d3":58}],579:[function(y,ee,Q){"use strict";var g=y("../font_attributes"),v=y("../../components/color/attributes"),m=y("../../components/drawing/attributes").dash,x=y("../../lib/extend").extendFlat,e=y("../../plot_api/plot_template").templatedArray,n=y("../../plots/cartesian/axis_format_attributes").descriptionWithDates,t=y("../../constants/numerical").ONEDAY,a=y("./constants"),r=a.HOUR_PATTERN,d=a.WEEKDAY_PATTERN,s={valType:"enumerated",values:["auto","linear","array"],editType:"ticks",impliedEdits:{tick0:void 0,dtick:void 0}};function i(k){return{valType:"integer",min:0,dflt:k?5:0,editType:"ticks"}}var u={valType:"any",editType:"ticks",impliedEdits:{tickmode:"linear"}},f={valType:"any",editType:"ticks",impliedEdits:{tickmode:"linear"}},c={valType:"data_array",editType:"ticks"},h={valType:"enumerated",values:["outside","inside",""],editType:"ticks"};function p(k){var L={valType:"number",min:0,editType:"ticks"};return k||(L.dflt=5),L}function o(k){var L={valType:"number",min:0,editType:"ticks"};return k||(L.dflt=1),L}var b={valType:"color",dflt:v.defaultLine,editType:"ticks"},l={valType:"color",dflt:v.lightLine,editType:"ticks"};function T(k){var L={valType:"number",min:0,editType:"ticks"};return k||(L.dflt=1),L}var _=x({},m,{editType:"ticks"}),w={valType:"boolean",editType:"ticks"};ee.exports={visible:{valType:"boolean",editType:"plot"},color:{valType:"color",dflt:v.defaultLine,editType:"ticks"},title:{text:{valType:"string",editType:"ticks"},font:g({editType:"ticks"}),standoff:{valType:"number",min:0,editType:"ticks"},editType:"ticks"},type:{valType:"enumerated",values:["-","linear","log","date","category","multicategory"],dflt:"-",editType:"calc",_noTemplating:!0},autotypenumbers:{valType:"enumerated",values:["convert types","strict"],dflt:"convert types",editType:"calc"},autorange:{valType:"enumerated",values:[!0,!1,"reversed"],dflt:!0,editType:"axrange",impliedEdits:{"range[0]":void 0,"range[1]":void 0}},rangemode:{valType:"enumerated",values:["normal","tozero","nonnegative"],dflt:"normal",editType:"plot"},range:{valType:"info_array",items:[{valType:"any",editType:"axrange",impliedEdits:{"^autorange":!1},anim:!0},{valType:"any",editType:"axrange",impliedEdits:{"^autorange":!1},anim:!0}],editType:"axrange",impliedEdits:{autorange:!1},anim:!0},fixedrange:{valType:"boolean",dflt:!1,editType:"calc"},scaleanchor:{valType:"enumerated",values:[a.idRegex.x.toString(),a.idRegex.y.toString()],editType:"plot"},scaleratio:{valType:"number",min:0,dflt:1,editType:"plot"},constrain:{valType:"enumerated",values:["range","domain"],editType:"plot"},constraintoward:{valType:"enumerated",values:["left","center","right","top","middle","bottom"],editType:"plot"},matches:{valType:"enumerated",values:[a.idRegex.x.toString(),a.idRegex.y.toString()],editType:"calc"},rangebreaks:e("rangebreak",{enabled:{valType:"boolean",dflt:!0,editType:"calc"},bounds:{valType:"info_array",items:[{valType:"any",editType:"calc"},{valType:"any",editType:"calc"}],editType:"calc"},pattern:{valType:"enumerated",values:[d,r,""],editType:"calc"},values:{valType:"info_array",freeLength:!0,editType:"calc",items:{valType:"any",editType:"calc"}},dvalue:{valType:"number",editType:"calc",min:0,dflt:t},editType:"calc"}),tickmode:s,nticks:i(),tick0:u,dtick:f,ticklabelstep:{valType:"integer",min:1,dflt:1,editType:"ticks"},tickvals:c,ticktext:{valType:"data_array",editType:"ticks"},ticks:h,tickson:{valType:"enumerated",values:["labels","boundaries"],dflt:"labels",editType:"ticks"},ticklabelmode:{valType:"enumerated",values:["instant","period"],dflt:"instant",editType:"ticks"},ticklabelposition:{valType:"enumerated",values:["outside","inside","outside top","inside top","outside left","inside left","outside right","inside right","outside bottom","inside bottom"],dflt:"outside",editType:"calc"},ticklabeloverflow:{valType:"enumerated",values:["allow","hide past div","hide past domain"],editType:"calc"},mirror:{valType:"enumerated",values:[!0,"ticks",!1,"all","allticks"],dflt:!1,editType:"ticks+layoutstyle"},ticklen:p(),tickwidth:o(),tickcolor:b,showticklabels:{valType:"boolean",dflt:!0,editType:"ticks"},automargin:{valType:"flaglist",flags:["height","width","left","right","top","bottom"],extras:[!0,!1],dflt:!1,editType:"ticks"},showspikes:{valType:"boolean",dflt:!1,editType:"modebar"},spikecolor:{valType:"color",dflt:null,editType:"none"},spikethickness:{valType:"number",dflt:3,editType:"none"},spikedash:x({},m,{dflt:"dash",editType:"none"}),spikemode:{valType:"flaglist",flags:["toaxis","across","marker"],dflt:"toaxis",editType:"none"},spikesnap:{valType:"enumerated",values:["data","cursor","hovered data"],dflt:"hovered data",editType:"none"},tickfont:g({editType:"ticks"}),tickangle:{valType:"angle",dflt:"auto",editType:"ticks"},tickprefix:{valType:"string",dflt:"",editType:"ticks"},showtickprefix:{valType:"enumerated",values:["all","first","last","none"],dflt:"all",editType:"ticks"},ticksuffix:{valType:"string",dflt:"",editType:"ticks"},showticksuffix:{valType:"enumerated",values:["all","first","last","none"],dflt:"all",editType:"ticks"},showexponent:{valType:"enumerated",values:["all","first","last","none"],dflt:"all",editType:"ticks"},exponentformat:{valType:"enumerated",values:["none","e","E","power","SI","B"],dflt:"B",editType:"ticks"},minexponent:{valType:"number",dflt:3,min:0,editType:"ticks"},separatethousands:{valType:"boolean",dflt:!1,editType:"ticks"},tickformat:{valType:"string",dflt:"",editType:"ticks",description:n("tick label")},tickformatstops:e("tickformatstop",{enabled:{valType:"boolean",dflt:!0,editType:"ticks"},dtickrange:{valType:"info_array",items:[{valType:"any",editType:"ticks"},{valType:"any",editType:"ticks"}],editType:"ticks"},value:{valType:"string",dflt:"",editType:"ticks"},editType:"ticks"}),hoverformat:{valType:"string",dflt:"",editType:"none",description:n("hover text")},showline:{valType:"boolean",dflt:!1,editType:"ticks+layoutstyle"},linecolor:{valType:"color",dflt:v.defaultLine,editType:"layoutstyle"},linewidth:{valType:"number",min:0,dflt:1,editType:"ticks+layoutstyle"},showgrid:w,gridcolor:l,gridwidth:T(),griddash:_,zeroline:{valType:"boolean",editType:"ticks"},zerolinecolor:{valType:"color",dflt:v.defaultLine,editType:"ticks"},zerolinewidth:{valType:"number",dflt:1,editType:"ticks"},showdividers:{valType:"boolean",dflt:!0,editType:"ticks"},dividercolor:{valType:"color",dflt:v.defaultLine,editType:"ticks"},dividerwidth:{valType:"number",dflt:1,editType:"ticks"},anchor:{valType:"enumerated",values:["free",a.idRegex.x.toString(),a.idRegex.y.toString()],editType:"plot"},side:{valType:"enumerated",values:["top","bottom","left","right"],editType:"plot"},overlaying:{valType:"enumerated",values:["free",a.idRegex.x.toString(),a.idRegex.y.toString()],editType:"plot"},minor:{tickmode:s,nticks:i("minor"),tick0:u,dtick:f,tickvals:c,ticks:h,ticklen:p("minor"),tickwidth:o("minor"),tickcolor:b,gridcolor:l,gridwidth:T("minor"),griddash:_,showgrid:w,editType:"ticks"},layer:{valType:"enumerated",values:["above traces","below traces"],dflt:"above traces",editType:"plot"},domain:{valType:"info_array",items:[{valType:"number",min:0,max:1,editType:"plot"},{valType:"number",min:0,max:1,editType:"plot"}],dflt:[0,1],editType:"plot"},position:{valType:"number",min:0,max:1,dflt:0,editType:"plot"},categoryorder:{valType:"enumerated",values:["trace","category ascending","category descending","array","total ascending","total descending","min ascending","min descending","max ascending","max descending","sum ascending","sum descending","mean ascending","mean descending","median ascending","median descending"],dflt:"trace",editType:"calc"},categoryarray:{valType:"data_array",editType:"calc"},uirevision:{valType:"any",editType:"none"},editType:"calc",_deprecated:{autotick:{valType:"boolean",editType:"ticks"},title:{valType:"string",editType:"ticks"},titlefont:g({editType:"ticks"})}}},{"../../components/color/attributes":366,"../../components/drawing/attributes":388,"../../constants/numerical":491,"../../lib/extend":505,"../../plot_api/plot_template":555,"../../plots/cartesian/axis_format_attributes":569,"../font_attributes":594,"./constants":573}],580:[function(y,ee,Q){"use strict";var g=y("../../lib"),v=y("../../components/color"),m=y("../../components/fx/helpers").isUnifiedHover,x=y("../../components/fx/hovermode_defaults"),e=y("../../plot_api/plot_template"),n=y("../layout_attributes"),t=y("./layout_attributes"),a=y("./type_defaults"),r=y("./axis_defaults"),d=y("./constraints"),s=y("./position_defaults"),i=y("./axis_ids"),u=i.id2name,f=i.name2id,c=y("./constants").AX_ID_PATTERN,h=y("../../registry"),p=h.traceIs,o=h.getComponentMethod;function b(l,T,_){Array.isArray(l[T])?l[T].push(_):l[T]=[_]}ee.exports=function(l,T,_){var w,k,L=T.autotypenumbers,M={},I={},P={},S={},E={},z={},R={},q={},V={},W={};for(w=0;w<_.length;w++){var K=_[w];if(p(K,"cartesian")||p(K,"gl2d")){var G,Y;if(K.xaxis)G=u(K.xaxis),b(M,G,K);else if(K.xaxes)for(k=0;k<K.xaxes.length;k++)b(M,u(K.xaxes[k]),K);if(K.yaxis)Y=u(K.yaxis),b(M,Y,K);else if(K.yaxes)for(k=0;k<K.yaxes.length;k++)b(M,u(K.yaxes[k]),K);"funnel"===K.type?"h"===K.orientation?(G&&(I[G]=!0),Y&&(R[Y]=!0)):Y&&(P[Y]=!0):"image"===K.type?(Y&&(q[Y]=!0),G&&(q[G]=!0)):(Y&&(E[Y]=!0,z[Y]=!0),p(K,"carpet")&&("carpet"!==K.type||K._cheater)||G&&(S[G]=!0)),"carpet"===K.type&&K._cheater&&G&&(I[G]=!0),p(K,"2dMap")&&(V[G]=!0,V[Y]=!0),p(K,"oriented")&&(W["h"===K.orientation?Y:G]=!0)}}var $=T._subplots,B=$.xaxis,N=$.yaxis,U=g.simpleMap(B,u),te=g.simpleMap(N,u),j=U.concat(te),J=v.background;B.length&&N.length&&(J=g.coerce(l,T,n,"plot_bgcolor"));var X,re,ne,le,oe,de=v.combine(J,T.paper_bgcolor);function se(){oe._traceIndices=(M[X]||[]).map(function(mt){return mt._expandedIndex}),oe._annIndices=[],oe._shapeIndices=[],oe._selectionIndices=[],oe._imgIndices=[],oe._subplotsWith=[],oe._counterAxes=[],oe._name=oe._attr=X,oe._id=re}function ge(Ke,mt){return g.coerce(le,oe,t,Ke,mt)}function _e(Ke,mt){return g.coerce2(le,oe,t,Ke,mt)}function Te(Ke){return"x"===Ke?N:B}function we(Ke,mt){for(var Bt="x"===Ke?U:te,Ut=[],er=0;er<Bt.length;er++){var Wt=Bt[er];Wt===mt||(l[Wt]||{}).overlaying||Ut.push(f(Wt))}return Ut}var Oe={x:Te("x"),y:Te("y")},fe=Oe.x.concat(Oe.y),ve={},Ae=[];function ke(){var Ke=le.matches;c.test(Ke)&&-1===fe.indexOf(Ke)&&(ve[Ke]=le.type,Ae=Object.keys(ve))}var Pe=x(l,T),Ne=m(Pe);for(w=0;w<j.length;w++){re=f(X=j[w]),ne=X.charAt(0),g.isPlainObject(l[X])||(l[X]={}),le=l[X],oe=e.newContainer(T,X,ne+"axis"),se();var Me={hasMinor:!0,letter:ne,font:T.font,outerTicks:V[X],showGrid:!W[X],data:M[X]||[],bgColor:de,calendar:T.calendar,automargin:!0,visibleDflt:"x"===ne&&!S[X]&&I[X]||"y"===ne&&!E[X]&&P[X],reverseDflt:"y"===ne&&(!z[X]&&R[X]||q[X]),autotypenumbersDflt:L,splomStash:((T._splomAxes||{})[ne]||{})[re]};ge("uirevision",T.uirevision),a(le,oe,ge,Me),r(le,oe,ge,Me,T);var Se=Ne&&ne===Pe.charAt(0),Ie=_e("spikecolor",Ne?oe.color:void 0),Fe=_e("spikethickness",Ne?1.5:void 0),Re=_e("spikedash",Ne?"dot":void 0),Xe=_e("spikemode",Ne?"across":void 0),nt=_e("spikesnap");ge("showspikes",!!(Se||Ie||Fe||Re||Xe||nt))||(delete oe.spikecolor,delete oe.spikethickness,delete oe.spikedash,delete oe.spikemode,delete oe.spikesnap),s(le,oe,ge,{letter:ne,counterAxes:Oe[ne],overlayableAxes:we(ne,X),grid:T.grid}),ge("title.standoff"),ke(),oe._input=le}for(w=0;w<Ae.length;){re=Ae[w++],ne=(X=u(re)).charAt(0),g.isPlainObject(l[X])||(l[X]={}),le=l[X],oe=e.newContainer(T,X,ne+"axis"),se();var ct={letter:ne,font:T.font,outerTicks:V[X],showGrid:!W[X],data:[],bgColor:de,calendar:T.calendar,automargin:!0,visibleDflt:!1,reverseDflt:!1,autotypenumbersDflt:L,splomStash:((T._splomAxes||{})[ne]||{})[re]};ge("uirevision",T.uirevision),oe.type=ve[re]||"linear",r(le,oe,ge,ct,T),s(le,oe,ge,{letter:ne,counterAxes:Oe[ne],overlayableAxes:we(ne,X),grid:T.grid}),ge("fixedrange"),ke(),oe._input=le}var xt=o("rangeslider","handleDefaults"),dt=o("rangeselector","handleDefaults");for(w=0;w<U.length;w++)le=l[X=U[w]],oe=T[X],xt(l,T,X),"date"===oe.type&&dt(le,oe,T,te,oe.calendar),ge("fixedrange");for(w=0;w<te.length;w++){le=l[X=te[w]];var tt=T[u((oe=T[X]).anchor)];ge("fixedrange",o("rangeslider","isVisible")(tt))}d.handleDefaults(l,T,{axIds:fe.concat(Ae).sort(i.idSort),axHasImage:q})}},{"../../components/color":367,"../../components/fx/helpers":403,"../../components/fx/hovermode_defaults":406,"../../lib":515,"../../plot_api/plot_template":555,"../../registry":647,"../layout_attributes":619,"./axis_defaults":568,"./axis_ids":570,"./constants":573,"./constraints":574,"./layout_attributes":579,"./position_defaults":582,"./type_defaults":591}],581:[function(y,ee,Q){"use strict";var g=y("tinycolor2").mix,v=y("../../components/color/attributes"),m=y("../../lib");ee.exports=function(x,e,n,t){var a=(t=t||{}).dfltColor;function r(l,T){return m.coerce2(x,e,t.attributes,l,T)}var d=r("linecolor",a),s=r("linewidth");n("showline",t.showLine||!!d||!!s)||(delete e.linecolor,delete e.linewidth);var i=r("gridcolor",g(a,t.bgColor,t.blend||v.lightFraction).toRgbString()),u=r("gridwidth"),f=r("griddash");if(n("showgrid",t.showGrid||!!i||!!u||!!f)||(delete e.gridcolor,delete e.gridwidth,delete e.griddash),t.hasMinor){var c=r("minor.gridcolor",g(e.gridcolor,t.bgColor,67).toRgbString()),h=r("minor.gridwidth",e.gridwidth||1),p=r("minor.griddash",e.griddash||"solid");n("minor.showgrid",!!c||!!h||!!p)||(delete e.minor.gridcolor,delete e.minor.gridwidth,delete e.minor.griddash)}if(!t.noZeroLine){var o=r("zerolinecolor",a),b=r("zerolinewidth");n("zeroline",t.showGrid||!!o||!!b)||(delete e.zerolinecolor,delete e.zerolinewidth)}}},{"../../components/color/attributes":366,"../../lib":515,tinycolor2:313}],582:[function(y,ee,Q){"use strict";var g=y("fast-isnumeric"),v=y("../../lib");ee.exports=function(m,x,e,n){var t,a,r,d,s=n.counterAxes||[],i=n.overlayableAxes||[],u=n.letter,f=n.grid;f&&(t=f._anchors[x._id],(a=f._domains[u][f._axisMap[x._id]])&&(r=f[u+"side"].split(" ")[0],d=f.domain[u]["right"===r||"top"===r?1:0])),a=a||[0,1],t=t||(g(m.position)?"free":s[0]||"free"),r=r||("x"===u?"bottom":"left"),d=d||0,"free"===v.coerce(m,x,{anchor:{valType:"enumerated",values:["free"].concat(s),dflt:t}},"anchor")&&e("position",d),v.coerce(m,x,{side:{valType:"enumerated",values:"x"===u?["bottom","top"]:["left","right"],dflt:r}},"side");var c=!1;if(i.length&&(c=v.coerce(m,x,{overlaying:{valType:"enumerated",values:[!1].concat(i),dflt:!1}},"overlaying")),!c){var h=e("domain",a);h[0]>h[1]-1/4096&&(x.domain=a),v.noneOrAll(m.domain,x.domain,a)}return e("layer"),x}},{"../../lib":515,"fast-isnumeric":190}],583:[function(y,ee,Q){"use strict";var g=y("./show_dflt");ee.exports=function(v,m,x,e,n){n||(n={});var t=n.tickSuffixDflt,a=g(v);x("tickprefix")&&x("showtickprefix",a),x("ticksuffix",t)&&x("showticksuffix",a)}},{"./show_dflt":586}],584:[function(y,ee,Q){"use strict";var g=y("../../constants/alignment").FROM_BL;ee.exports=function(v,m,x){void 0===x&&(x=g[v.constraintoward||"center"]);var e=[v.r2l(v.range[0]),v.r2l(v.range[1])],n=e[0]+(e[1]-e[0])*x;v.range=v._input.range=[v.l2r(n+(e[0]-n)*m),v.l2r(n+(e[1]-n)*m)],v.setScale()}},{"../../constants/alignment":483}],585:[function(y,ee,Q){"use strict";var g=y("@plotly/d3"),v=y("d3-time-format").utcFormat,m=y("../../lib"),x=m.numberFormat,e=y("fast-isnumeric"),n=m.cleanNumber,t=m.ms2DateTime,a=m.dateTime2ms,r=m.ensureNumber,d=m.isArrayOrTypedArray,s=y("../../constants/numerical"),i=s.FP_SAFE,u=s.BADNUM,f=s.LOG_CLIP,c=s.ONEWEEK,h=s.ONEDAY,p=s.ONEHOUR,o=s.ONEMIN,b=s.ONESEC,l=y("./axis_ids"),T=y("./constants"),_=T.HOUR_PATTERN,w=T.WEEKDAY_PATTERN;function k(M){return Math.pow(10,M)}function L(M){return null!=M}ee.exports=function(M,I){I=I||{};var P=M._id||"x",S=P.charAt(0);function E(j,J){if(j>0)return Math.log(j)/Math.LN10;if(j<=0&&J&&M.range&&2===M.range.length){var X=M.range[0],re=M.range[1];return.5*(X+re-2*f*Math.abs(X-re))}return u}function z(j,J,X,re){if((re||{}).msUTC&&e(j))return+j;var ne=a(j,X||M.calendar);if(ne===u){if(!e(j))return u;j=+j;var le=Math.floor(10*m.mod(j+.05,1)),oe=Math.round(j-le/10);ne=a(new Date(oe))+le/10}return ne}function R(j,J,X){return t(j,J,X||M.calendar)}function q(j){return M._categories[Math.round(j)]}function V(j){if(L(j)){if(void 0===M._categoriesMap&&(M._categoriesMap={}),void 0!==M._categoriesMap[j])return M._categoriesMap[j];M._categories.push("number"==typeof j?String(j):j);var J=M._categories.length-1;return M._categoriesMap[j]=J,J}return u}function W(j){if(M._categoriesMap)return M._categoriesMap[j]}function K(j){var J=W(j);return void 0!==J?J:e(j)?+j:void 0}function G(j){return e(j)?+j:W(j)}function Y(j,J,X){return g.round(X+J*j,2)}function $(j,J,X){return(j-X)/J}var B=function(j){return e(j)?Y(j,M._m,M._b):u},N=function(j){return $(j,M._m,M._b)};if(M.rangebreaks){var U="y"===S;B=function(j){if(!e(j))return u;var J=M._rangebreaks.length;if(!J)return Y(j,M._m,M._b);var X=U;M.range[0]>M.range[1]&&(X=!X);for(var re=X?-1:1,ne=re*j,le=0,oe=0;oe<J;oe++){var de=re*M._rangebreaks[oe].min,se=re*M._rangebreaks[oe].max;if(ne<de)break;if(!(ne>se)){le=ne<(de+se)/2?oe:oe+1;break}le=oe+1}var ge=M._B[le]||0;return isFinite(ge)?Y(j,M._m2,ge):0},N=function(j){var J=M._rangebreaks.length;if(!J)return $(j,M._m,M._b);for(var X=0,re=0;re<J&&!(j<M._rangebreaks[re].pmin);re++)j>M._rangebreaks[re].pmax&&(X=re+1);return $(j,M._m2,M._B[X])}}M.c2l="log"===M.type?E:r,M.l2c="log"===M.type?k:r,M.l2p=B,M.p2l=N,M.c2p="log"===M.type?function(j,J){return B(E(j,J))}:B,M.p2c="log"===M.type?function(j){return k(N(j))}:N,-1!==["linear","-"].indexOf(M.type)?(M.d2r=M.r2d=M.d2c=M.r2c=M.d2l=M.r2l=n,M.c2d=M.c2r=M.l2d=M.l2r=r,M.d2p=M.r2p=function(j){return M.l2p(n(j))},M.p2d=M.p2r=N,M.cleanPos=r):"log"===M.type?(M.d2r=M.d2l=function(j,J){return E(n(j),J)},M.r2d=M.r2c=function(j){return k(n(j))},M.d2c=M.r2l=n,M.c2d=M.l2r=r,M.c2r=E,M.l2d=k,M.d2p=function(j,J){return M.l2p(M.d2r(j,J))},M.p2d=function(j){return k(N(j))},M.r2p=function(j){return M.l2p(n(j))},M.p2r=N,M.cleanPos=r):"date"===M.type?(M.d2r=M.r2d=m.identity,M.d2c=M.r2c=M.d2l=M.r2l=z,M.c2d=M.c2r=M.l2d=M.l2r=R,M.d2p=M.r2p=function(j,J,X){return M.l2p(z(j,0,X))},M.p2d=M.p2r=function(j,J,X){return R(N(j),J,X)},M.cleanPos=function(j){return m.cleanDate(j,u,M.calendar)}):"category"===M.type?(M.d2c=M.d2l=V,M.r2d=M.c2d=M.l2d=q,M.d2r=M.d2l_noadd=K,M.r2c=function(j){var J=G(j);return void 0!==J?J:M.fraction2r(.5)},M.l2r=M.c2r=r,M.r2l=G,M.d2p=function(j){return M.l2p(M.r2c(j))},M.p2d=function(j){return q(N(j))},M.r2p=M.d2p,M.p2r=N,M.cleanPos=function(j){return"string"==typeof j&&""!==j?j:r(j)}):"multicategory"===M.type&&(M.r2d=M.c2d=M.l2d=q,M.d2r=M.d2l_noadd=K,M.r2c=function(j){var J=K(j);return void 0!==J?J:M.fraction2r(.5)},M.r2c_just_indices=W,M.l2r=M.c2r=r,M.r2l=K,M.d2p=function(j){return M.l2p(M.r2c(j))},M.p2d=function(j){return q(N(j))},M.r2p=M.d2p,M.p2r=N,M.cleanPos=function(j){return Array.isArray(j)||"string"==typeof j&&""!==j?j:r(j)},M.setupMultiCategory=function(j){var J,X,re=M._traceIndices,ne=M._matchGroup;if(ne&&0===M._categories.length)for(var le in ne)if(le!==P){var oe=I[l.id2name(le)];re=re.concat(oe._traceIndices)}var de=[[0,{}],[0,{}]],se=[];for(J=0;J<re.length;J++){var ge=j[re[J]];if(S in ge){var _e=ge[S],Te=ge._length||m.minRowLength(_e);if(d(_e[0])&&d(_e[1]))for(X=0;X<Te;X++){var we=_e[0][X],Oe=_e[1][X];L(we)&&L(Oe)&&(se.push([we,Oe]),we in de[0][1]||(de[0][1][we]=de[0][0]++),Oe in de[1][1]||(de[1][1][Oe]=de[1][0]++))}}}for(se.sort(function(fe,ve){var Ae=de[0][1],ke=Ae[fe[0]]-Ae[ve[0]];if(ke)return ke;var Pe=de[1][1];return Pe[fe[1]]-Pe[ve[1]]}),J=0;J<se.length;J++)V(se[J])}),M.fraction2r=function(j){var J=M.r2l(M.range[0]),X=M.r2l(M.range[1]);return M.l2r(J+j*(X-J))},M.r2fraction=function(j){var J=M.r2l(M.range[0]),X=M.r2l(M.range[1]);return(M.r2l(j)-J)/(X-J)},M.cleanRange=function(j,J){J||(J={}),j||(j="range");var X,re,ne=m.nestedProperty(M,j).get();if(re=(re="date"===M.type?m.dfltRange(M.calendar):"y"===S?T.DFLTRANGEY:"realaxis"===M._name?[0,1]:J.dfltRange||T.DFLTRANGEX).slice(),"tozero"!==M.rangemode&&"nonnegative"!==M.rangemode||(re[0]=0),ne&&2===ne.length)for("date"!==M.type||M.autorange||(ne[0]=m.cleanDate(ne[0],u,M.calendar),ne[1]=m.cleanDate(ne[1],u,M.calendar)),X=0;X<2;X++)if("date"===M.type){if(!m.isDateTime(ne[X],M.calendar)){M[j]=re;break}if(M.r2l(ne[0])===M.r2l(ne[1])){var le=m.constrain(M.r2l(ne[0]),m.MIN_MS+1e3,m.MAX_MS-1e3);ne[0]=M.l2r(le-1e3),ne[1]=M.l2r(le+1e3);break}}else{if(!e(ne[X])){if(!e(ne[1-X])){M[j]=re;break}ne[X]=ne[1-X]*(X?10:.1)}if(ne[X]<-i?ne[X]=-i:ne[X]>i&&(ne[X]=i),ne[0]===ne[1]){var oe=Math.max(1,Math.abs(1e-6*ne[0]));ne[0]-=oe,ne[1]+=oe}}else m.nestedProperty(M,j).set(re)},M.setScale=function(j){var J=I._size;if(M.overlaying){var X=l.getFromId({_fullLayout:I},M.overlaying);M.domain=X.domain}var re=j&&M._r?"_r":"range",ne=M.calendar;M.cleanRange(re);var le,oe,de=M.r2l(M[re][0],ne),se=M.r2l(M[re][1],ne),ge="y"===S;if(ge?(M._offset=J.t+(1-M.domain[1])*J.h,M._length=J.h*(M.domain[1]-M.domain[0]),M._m=M._length/(de-se),M._b=-M._m*se):(M._offset=J.l+M.domain[0]*J.w,M._length=J.w*(M.domain[1]-M.domain[0]),M._m=M._length/(se-de),M._b=-M._m*de),M._rangebreaks=[],M._lBreaks=0,M._m2=0,M._B=[],M.rangebreaks&&(M._rangebreaks=M.locateBreaks(Math.min(de,se),Math.max(de,se)),M._rangebreaks.length)){for(le=0;le<M._rangebreaks.length;le++)oe=M._rangebreaks[le],M._lBreaks+=Math.abs(oe.max-oe.min);var _e=ge;de>se&&(_e=!_e),_e&&M._rangebreaks.reverse();var Te=_e?-1:1;for(M._m2=Te*M._length/(Math.abs(se-de)-M._lBreaks),M._B.push(-M._m2*(ge?se:de)),le=0;le<M._rangebreaks.length;le++)M._B.push(M._B[M._B.length-1]-Te*M._m2*((oe=M._rangebreaks[le]).max-oe.min));for(le=0;le<M._rangebreaks.length;le++)(oe=M._rangebreaks[le]).pmin=B(oe.min),oe.pmax=B(oe.max)}if(!isFinite(M._m)||!isFinite(M._b)||M._length<0)throw I._replotting=!1,new Error("Something went wrong with axis scaling")},M.maskBreaks=function(j){var J,X,re,ne,le,oe=M.rangebreaks||[];oe._cachedPatterns||(oe._cachedPatterns=oe.map(function(we){return we.enabled&&we.bounds?m.simpleMap(we.bounds,we.pattern?n:M.d2c):null})),oe._cachedValues||(oe._cachedValues=oe.map(function(we){return we.enabled&&we.values?m.simpleMap(we.values,M.d2c).sort(m.sorterAsc):null}));for(var de=0;de<oe.length;de++){var se=oe[de];if(se.enabled)if(se.bounds){switch(X=(J=oe._cachedPatterns[de])[0],re=J[1],se.pattern){case w:ne=(le=new Date(j)).getUTCDay(),X>re&&(re+=7,ne<X&&(ne+=7));break;case _:ne=(le=new Date(j)).getUTCHours()+(le.getUTCMinutes()/60+le.getUTCSeconds()/3600+le.getUTCMilliseconds()/36e5),X>re&&(re+=24,ne<X&&(ne+=24));break;case"":ne=j}if(ne>=X&&ne<re)return u}else for(var _e=oe._cachedValues[de],Te=0;Te<_e.length;Te++)if(re=(X=_e[Te])+se.dvalue,j>=X&&j<re)return u}return j},M.locateBreaks=function(j,J){var X,re,ne,le,oe=[];if(!M.rangebreaks)return oe;var de=M.rangebreaks.slice().sort(function(Pe,Ne){return Pe.pattern===w&&Ne.pattern===_?-1:Ne.pattern===w&&Pe.pattern===_?1:0}),se=function(Pe,Ne){if((Pe=m.constrain(Pe,j,J))!==(Ne=m.constrain(Ne,j,J))){for(var De=!0,ze=0;ze<oe.length;ze++){var Me=oe[ze];Pe<Me.max&&Ne>=Me.min&&(Pe<Me.min&&(Me.min=Pe),Ne>Me.max&&(Me.max=Ne),De=!1)}De&&oe.push({min:Pe,max:Ne})}};for(X=0;X<de.length;X++){var ge=de[X];if(ge.enabled)if(ge.bounds){var _e=j,Te=J;ge.pattern&&(_e=Math.floor(_e)),ne=(re=m.simpleMap(ge.bounds,ge.pattern?n:M.r2l))[0],le=re[1];var we,Oe,fe=new Date(_e);switch(ge.pattern){case w:Oe=c,we=(le-ne+(le<ne?7:0))*h,_e+=ne*h-(fe.getUTCDay()*h+fe.getUTCHours()*p+fe.getUTCMinutes()*o+fe.getUTCSeconds()*b+fe.getUTCMilliseconds());break;case _:Oe=h,we=(le-ne+(le<ne?24:0))*p,_e+=ne*p-(fe.getUTCHours()*p+fe.getUTCMinutes()*o+fe.getUTCSeconds()*b+fe.getUTCMilliseconds());break;default:_e=Math.min(re[0],re[1]),we=Oe=(Te=Math.max(re[0],re[1]))-_e}for(var ve=_e;ve<Te;ve+=Oe)se(ve,ve+we)}else for(var Ae=m.simpleMap(ge.values,M.d2c),ke=0;ke<Ae.length;ke++)se(ne=Ae[ke],le=ne+ge.dvalue)}return oe.sort(function(Pe,Ne){return Pe.min-Ne.min}),oe},M.makeCalcdata=function(j,J,X){var re,ne,le,oe,de=M.type,se="date"===de&&j[J+"calendar"];if(J in j){if(re=j[J],oe=j._length||m.minRowLength(re),m.isTypedArray(re)&&("linear"===de||"log"===de)){if(oe===re.length)return re;if(re.subarray)return re.subarray(0,oe)}if("multicategory"===de)return function(Te,we){for(var Oe=new Array(we),fe=0;fe<we;fe++)Oe[fe]=W([(Te[0]||[])[fe],(Te[1]||[])[fe]]);return Oe}(re,oe);for(ne=new Array(oe),le=0;le<oe;le++)ne[le]=M.d2c(re[le],0,se,X)}else{var ge=J+"0"in j?M.d2c(j[J+"0"],0,se):0,_e=j["d"+J]?Number(j["d"+J]):1;for(re=j[{x:"y",y:"x"}[J]],oe=j._length||re.length,ne=new Array(oe),le=0;le<oe;le++)ne[le]=ge+le*_e}if(M.rangebreaks)for(le=0;le<oe;le++)ne[le]=M.maskBreaks(ne[le]);return ne},M.isValidRange=function(j){return Array.isArray(j)&&2===j.length&&e(M.r2l(j[0]))&&e(M.r2l(j[1]))},M.isPtWithinRange=function(j,J){var X=M.c2l(j[S],null,J),re=M.r2l(M.range[0]),ne=M.r2l(M.range[1]);return re<ne?re<=X&&X<=ne:ne<=X&&X<=re},M._emptyCategories=function(){M._categories=[],M._categoriesMap={}},M.clearCalc=function(){var j=M._matchGroup;if(j){var J=null,X=null;for(var re in j){var ne=I[l.id2name(re)];if(ne._categories){J=ne._categories,X=ne._categoriesMap;break}}J&&X?(M._categories=J,M._categoriesMap=X):M._emptyCategories()}else M._emptyCategories();if(M._initialCategories)for(var le=0;le<M._initialCategories.length;le++)V(M._initialCategories[le])},M.sortByInitialCategories=function(){var j=[];if(M._emptyCategories(),M._initialCategories)for(var J=0;J<M._initialCategories.length;J++)V(M._initialCategories[J]);j=j.concat(M._traceIndices);var X=M._matchGroup;for(var re in X)if(P!==re){var ne=I[l.id2name(re)];ne._categories=M._categories,ne._categoriesMap=M._categoriesMap,j=j.concat(ne._traceIndices)}return j};var te=I._d3locale;"date"===M.type&&(M._dateFormat=te?te.timeFormat:v,M._extraFormat=I._extraFormat),M._separators=I.separators,M._numFormat=te?te.numberFormat:x,delete M._minDtick,delete M._forceTick0}},{"../../constants/numerical":491,"../../lib":515,"./axis_ids":570,"./constants":573,"@plotly/d3":58,"d3-time-format":120,"fast-isnumeric":190}],586:[function(y,ee,Q){"use strict";ee.exports=function(g){var v=["showexponent","showtickprefix","showticksuffix"].filter(function(m){return void 0!==g[m]});if(v.every(function(m){return g[m]===g[v[0]]})||1===v.length)return g[v[0]]}},{}],587:[function(y,ee,Q){"use strict";var g=y("../../lib"),v=y("../../components/color").contrast,m=y("./layout_attributes"),x=y("./show_dflt"),e=y("../array_container_defaults");function n(t,a){function r(d,s){return g.coerce(t,a,m.tickformatstops,d,s)}r("enabled")&&(r("dtickrange"),r("value"))}ee.exports=function(t,a,r,d,s){s||(s={});var i=x(t);if(r("showticklabels")){var u=s.font||{},f=a.color,c=-1!==(a.ticklabelposition||"").indexOf("inside")?v(s.bgColor):f&&f!==m.color.dflt?f:u.color;if(g.coerceFont(r,"tickfont",{family:u.family,size:u.size,color:c}),s.noTicklabelstep||"multicategory"===d||"log"===d||r("ticklabelstep"),s.noAng||r("tickangle"),"category"!==d){var h=r("tickformat");e(t,a,{name:"tickformatstops",inclusionAttr:"enabled",handleItemDefaults:n}),a.tickformatstops.length||delete a.tickformatstops,s.noExp||h||"date"===d||(r("showexponent",i),r("exponentformat"),r("minexponent"),r("separatethousands"))}}}},{"../../components/color":367,"../../lib":515,"../array_container_defaults":561,"./layout_attributes":579,"./show_dflt":586}],588:[function(y,ee,Q){"use strict";var g=y("../../lib"),v=y("./layout_attributes");ee.exports=function(m,x,e,n){var t=n.isMinor,a=t?m.minor||{}:m,r=t?x.minor:x,d=t?v.minor:v,s=t?"minor.":"",i=g.coerce2(a,r,d,"ticklen",t?.6*(x.ticklen||5):void 0),u=g.coerce2(a,r,d,"tickwidth",t?x.tickwidth||1:void 0),f=g.coerce2(a,r,d,"tickcolor",(t?x.tickcolor:void 0)||r.color);e(s+"ticks",!t&&n.outerTicks||i||u||f?"outside":"")||(delete r.ticklen,delete r.tickwidth,delete r.tickcolor)}},{"../../lib":515,"./layout_attributes":579}],589:[function(y,ee,Q){"use strict";var g=y("./clean_ticks"),v=y("../../lib").isArrayOrTypedArray;ee.exports=function(m,x,e,n,t){t||(t={});var a=t.isMinor,r=a?m.minor||{}:m,d=a?x.minor:x,s=a?"minor.":"";function i(o){var b=r[o];return void 0!==b?b:(d._template||{})[o]}var u=i("tick0"),f=i("dtick"),c=i("tickvals"),h=e(s+"tickmode",v(c)?"array":f?"linear":"auto");if("auto"===h)e(s+"nticks");else if("linear"===h){var p=d.dtick=g.dtick(f,n);d.tick0=g.tick0(u,n,x.calendar,p)}else"multicategory"!==n&&(void 0===e(s+"tickvals")?d.tickmode="auto":a||e("ticktext"))}},{"../../lib":515,"./clean_ticks":572}],590:[function(y,ee,Q){"use strict";var g=y("@plotly/d3"),v=y("../../registry"),m=y("../../lib"),x=y("../../components/drawing"),e=y("./axes");ee.exports=function(n,t,a,r){var d=n._fullLayout;if(0!==t.length){var s,i,u,f;r&&(s=r());var c=g.ease(a.easing);return n._transitionData._interruptCallbacks.push(function(){return window.cancelAnimationFrame(f),f=null,function(){for(var o={},b=0;b<t.length;b++){var l=t[b],_=l.plotinfo.yaxis;l.xr0&&(o[l.plotinfo.xaxis._name+".range"]=l.xr0.slice()),l.yr0&&(o[_._name+".range"]=l.yr0.slice())}return v.call("relayout",n,o).then(function(){for(var w=0;w<t.length;w++)h(t[w].plotinfo)})}()}),i=Date.now(),f=window.requestAnimationFrame(function o(){u=Date.now();for(var b=Math.min(1,(u-i)/a.duration),l=c(b),T=0;T<t.length;T++)p(t[T],l);u-i>a.duration?(function(){for(var _={},w=0;w<t.length;w++){var k=t[w],M=k.plotinfo.yaxis;k.xr1&&(_[k.plotinfo.xaxis._name+".range"]=k.xr1.slice()),k.yr1&&(_[M._name+".range"]=k.yr1.slice())}s&&s(),v.call("relayout",n,_).then(function(){for(var I=0;I<t.length;I++)h(t[I].plotinfo)})}(),f=window.cancelAnimationFrame(o)):f=window.requestAnimationFrame(o)}),Promise.resolve()}function h(o){var b=o.xaxis,l=o.yaxis;d._defs.select("#"+o.clipId+"> rect").call(x.setTranslate,0,0).call(x.setScale,1,1),o.plot.call(x.setTranslate,b._offset,l._offset).call(x.setScale,1,1);var T=o.plot.selectAll(".scatterlayer .trace");T.selectAll(".point").call(x.setPointGroupScale,1,1),T.selectAll(".textpoint").call(x.setTextPointsScale,1,1),T.call(x.hideOutsideRangePoints,o)}function p(o,b){var l=o.plotinfo,T=l.xaxis,_=l.yaxis,w=T._length,k=_._length,L=!!o.xr1,M=!!o.yr1,I=[];if(L){var P=m.simpleMap(o.xr0,T.r2l),S=m.simpleMap(o.xr1,T.r2l),E=P[1]-P[0],z=S[1]-S[0];I[0]=(P[0]*(1-b)+b*S[0]-P[0])/(P[1]-P[0])*w,I[2]=w*(1-b+b*z/E),T.range[0]=T.l2r(P[0]*(1-b)+b*S[0]),T.range[1]=T.l2r(P[1]*(1-b)+b*S[1])}else I[0]=0,I[2]=w;if(M){var R=m.simpleMap(o.yr0,_.r2l),q=m.simpleMap(o.yr1,_.r2l),V=R[1]-R[0],W=q[1]-q[0];I[1]=(R[1]*(1-b)+b*q[1]-R[1])/(R[0]-R[1])*k,I[3]=k*(1-b+b*W/V),_.range[0]=T.l2r(R[0]*(1-b)+b*q[0]),_.range[1]=_.l2r(R[1]*(1-b)+b*q[1])}else I[1]=0,I[3]=k;e.drawOne(n,T,{skipTitle:!0}),e.drawOne(n,_,{skipTitle:!0}),e.redrawComponents(n,[T._id,_._id]);var K=L?w/I[2]:1,G=M?k/I[3]:1,U=T._offset-(L?I[0]/I[2]*w:0),te=_._offset-(M?I[1]/I[3]*k:0);l.clipRect.call(x.setTranslate,L?I[0]:0,M?I[1]:0).call(x.setScale,1/K,1/G),l.plot.call(x.setTranslate,U,te).call(x.setScale,K,G),x.setPointGroupScale(l.zoomScalePts,1/K,1/G),x.setTextPointsScale(l.zoomScaleTxt,1/K,1/G)}e.redrawComponents(n)}},{"../../components/drawing":389,"../../lib":515,"../../registry":647,"./axes":566,"@plotly/d3":58}],591:[function(y,ee,Q){"use strict";var g=y("../../registry").traceIs,v=y("./axis_autotype");function m(e){return{v:"x",h:"y"}[e.orientation||"v"]}function x(e,n){var t=m(e),a=g(e,"box-violin"),r=g(e._fullInput||{},"candlestick");return a&&!r&&n===t&&void 0===e[t]&&void 0===e[t+"0"]}ee.exports=function(e,n,t,a){t("autotypenumbers",a.autotypenumbersDflt),"-"===t("type",(a.splomStash||{}).type)&&(function(r,d){if("-"===r.type){var s,i=r._id,u=i.charAt(0);-1!==i.indexOf("scene")&&(i=u);var f=function(_,w,k){for(var L=0;L<_.length;L++){var M=_[L];if("splom"===M.type&&M._length>0&&(M["_"+k+"axes"]||{})[w]||(M[k+"axis"]||k)===w&&(x(M,k)||(M[k]||[]).length||M[k+"0"]))return M}}(d,i,u);if(f){if("histogram"===f.type&&u==={v:"y",h:"x"}[f.orientation||"v"])return void(r.type="linear");var c=u+"calendar",h=f[c],p={noMultiCategory:!g(f,"cartesian")||g(f,"noMultiCategory")};if("box"===f.type&&f._hasPreCompStats&&u==={h:"x",v:"y"}[f.orientation||"v"]&&(p.noMultiCategory=!0),p.autotypenumbers=r.autotypenumbers,x(f,u)){var o=m(f),b=[];for(s=0;s<d.length;s++){var l=d[s];g(l,"box-violin")&&(l[u+"axis"]||u)===i&&(b.push(void 0!==l[o]?l[o][0]:void 0!==l.name?l.name:"text"),l[c]!==h&&(h=void 0))}r.type=v(b,h,p)}else if("splom"===f.type){var T=f.dimensions[f._axesDim[i]];T.visible&&(r.type=v(T.values,h,p))}else r.type=v(f[u]||[f[u+"0"]],h,p)}}}(n,a.data),"-"===n.type?n.type="linear":e.type=n.type)}},{"../../registry":647,"./axis_autotype":567}],592:[function(y,ee,Q){"use strict";var g=y("../registry"),v=y("../lib");function m(t,a,r){var d,s,i,u=!1;if("data"===a.type)d=t._fullData[null!==a.traces?a.traces[0]:0];else{if("layout"!==a.type)return!1;d=t._fullLayout}return s=v.nestedProperty(d,a.prop).get(),(i=r[a.type]=r[a.type]||{}).hasOwnProperty(a.prop)&&i[a.prop]!==s&&(u=!0),i[a.prop]=s,{changed:u,value:s}}function x(t,a){var r=[],d=a[0],s={};if("string"==typeof d)s[d]=a[1];else{if(!v.isPlainObject(d))return r;s=d}return n(s,function(i,u,f){r.push({type:"layout",prop:i,value:f})},"",0),r}function e(t,a){var r,d,s,i,u=[];if(s=a[1],r=a[2],i={},"string"==typeof(d=a[0]))i[d]=s;else{if(!v.isPlainObject(d))return u;i=d,void 0===r&&(r=s)}return void 0===r&&(r=null),n(i,function(f,c,h){var p,o;if(Array.isArray(h)){o=h.slice();var b=Math.min(o.length,t.data.length);r&&(b=Math.min(b,r.length)),p=[];for(var l=0;l<b;l++)p[l]=r?r[l]:l}else o=h,p=r?r.slice():null;if(null===p)Array.isArray(o)&&(o=o[0]);else if(Array.isArray(p)){if(!Array.isArray(o)){var T=o;o=[];for(var _=0;_<p.length;_++)o[_]=T}o.length=Math.min(p.length,o.length)}u.push({type:"data",prop:f,traces:p,value:o})},"",0),u}function n(t,a,r,d){Object.keys(t).forEach(function(s){var i=t[s];if("_"!==s[0]){var u=r+(d>0?".":"")+s;v.isPlainObject(i)?n(i,a,u,d+1):a(u,s,i)}})}Q.manageCommandObserver=function(t,a,r,d){var s={},i=!0;a&&a._commandObserver&&(s=a._commandObserver),s.cache||(s.cache={}),s.lookupTable={};var u=Q.hasSimpleAPICommandBindings(t,r,s.lookupTable);if(a&&a._commandObserver){if(u)return s;if(a._commandObserver.remove)return a._commandObserver.remove(),a._commandObserver=null,s}if(u){m(t,u,s.cache),s.check=function(){if(i){var h=m(t,u,s.cache);return h.changed&&d&&void 0!==s.lookupTable[h.value]&&(s.disable(),Promise.resolve(d({value:h.value,type:u.type,prop:u.prop,traces:u.traces,index:s.lookupTable[h.value]})).then(s.enable,s.enable)),h.changed}};for(var f=["plotly_relayout","plotly_redraw","plotly_restyle","plotly_update","plotly_animatingframe","plotly_afterplot"],c=0;c<f.length;c++)t._internalOn(f[c],s.check);s.remove=function(){for(var h=0;h<f.length;h++)t._removeInternalListener(f[h],s.check)}}else v.log("Unable to automatically bind plot updates to API command"),s.lookupTable={},s.remove=function(){};return s.disable=function(){i=!1},s.enable=function(){i=!0},a&&(a._commandObserver=s),s},Q.hasSimpleAPICommandBindings=function(t,a,r){var d,s,i=a.length;for(d=0;d<i;d++){var u,f=a[d],c=f.method,h=f.args;if(Array.isArray(h)||(h=[]),!c)return!1;var p=Q.computeAPICommandBindings(t,c,h);if(1!==p.length)return!1;if(s){if((u=p[0]).type!==s.type||u.prop!==s.prop)return!1;if(Array.isArray(s.traces)){if(!Array.isArray(u.traces))return!1;u.traces.sort();for(var o=0;o<s.traces.length;o++)if(s.traces[o]!==u.traces[o])return!1}else if(u.prop!==s.prop)return!1}else s=p[0],Array.isArray(s.traces)&&s.traces.sort();var b=(u=p[0]).value;if(Array.isArray(b)){if(1!==b.length)return!1;b=b[0]}r&&(r[b]=d)}return s},Q.executeAPICommand=function(t,a,r){if("skip"===a)return Promise.resolve();var d=g.apiMethodRegistry[a],s=[t];Array.isArray(r)||(r=[]);for(var i=0;i<r.length;i++)s.push(r[i]);return d.apply(null,s).catch(function(u){return v.warn("API call to Plotly."+a+" rejected.",u),Promise.reject(u)})},Q.computeAPICommandBindings=function(t,a,r){var d,i;switch(Array.isArray(r)||(r=[]),a){case"restyle":d=e(t,r);break;case"relayout":d=x(0,r);break;case"update":d=e(t,[r[0],r[2]]).concat(x(0,[r[1]]));break;case"animate":i=r,d=Array.isArray(i[0])&&1===i[0].length&&-1!==["string","number"].indexOf(typeof i[0][0])?[{type:"layout",prop:"_currentFrame",value:i[0][0].toString()}]:[];break;default:d=[]}return d}},{"../lib":515,"../registry":647}],593:[function(y,ee,Q){"use strict";var g=y("../lib/extend").extendFlat;Q.attributes=function(v,m){m=m||{};var x={valType:"info_array",editType:(v=v||{}).editType,items:[{valType:"number",min:0,max:1,editType:v.editType},{valType:"number",min:0,max:1,editType:v.editType}],dflt:[0,1]},e={x:g({},x,{}),y:g({},x,{}),editType:v.editType};return v.noGridCell||(e.row={valType:"integer",min:0,dflt:0,editType:v.editType},e.column={valType:"integer",min:0,dflt:0,editType:v.editType}),e},Q.defaults=function(v,m,x,e){var n=e&&e.x||[0,1],t=e&&e.y||[0,1],a=m.grid;if(a){var r=x("domain.column");void 0!==r&&(r<a.columns?n=a._domains.x[r]:delete v.domain.column);var d=x("domain.row");void 0!==d&&(d<a.rows?t=a._domains.y[d]:delete v.domain.row)}var s=x("domain.x",n),i=x("domain.y",t);s[0]<s[1]||(v.domain.x=n.slice()),i[0]<i[1]||(v.domain.y=t.slice())}},{"../lib/extend":505}],594:[function(y,ee,Q){"use strict";ee.exports=function(g){var v=g.editType,m=g.colorEditType;void 0===m&&(m=v);var x={family:{valType:"string",noBlank:!0,strict:!0,editType:v},size:{valType:"number",min:1,editType:v},color:{valType:"color",editType:m},editType:v};return g.autoSize&&(x.size.dflt="auto"),g.autoColor&&(x.color.dflt="auto"),g.arrayOk&&(x.family.arrayOk=!0,x.size.arrayOk=!0,x.color.arrayOk=!0),x}},{}],595:[function(y,ee,Q){"use strict";ee.exports={_isLinkedToArray:"frames_entry",group:{valType:"string"},name:{valType:"string"},traces:{valType:"any"},baseframe:{valType:"string"},data:{valType:"any"},layout:{valType:"any"}}},{}],596:[function(y,ee,Q){"use strict";Q.projNames={airy:"airy",aitoff:"aitoff","albers usa":"albersUsa",albers:"albers",august:"august","azimuthal equal area":"azimuthalEqualArea","azimuthal equidistant":"azimuthalEquidistant",baker:"baker",bertin1953:"bertin1953",boggs:"boggs",bonne:"bonne",bottomley:"bottomley",bromley:"bromley",collignon:"collignon","conic conformal":"conicConformal","conic equal area":"conicEqualArea","conic equidistant":"conicEquidistant",craig:"craig",craster:"craster","cylindrical equal area":"cylindricalEqualArea","cylindrical stereographic":"cylindricalStereographic",eckert1:"eckert1",eckert2:"eckert2",eckert3:"eckert3",eckert4:"eckert4",eckert5:"eckert5",eckert6:"eckert6",eisenlohr:"eisenlohr",equirectangular:"equirectangular",fahey:"fahey","foucaut sinusoidal":"foucautSinusoidal",foucaut:"foucaut",ginzburg4:"ginzburg4",ginzburg5:"ginzburg5",ginzburg6:"ginzburg6",ginzburg8:"ginzburg8",ginzburg9:"ginzburg9",gnomonic:"gnomonic","gringorten quincuncial":"gringortenQuincuncial",gringorten:"gringorten",guyou:"guyou",hammer:"hammer",hill:"hill",homolosine:"homolosine",hufnagel:"hufnagel",hyperelliptical:"hyperelliptical",kavrayskiy7:"kavrayskiy7",lagrange:"lagrange",larrivee:"larrivee",laskowski:"laskowski",loximuthal:"loximuthal",mercator:"mercator",miller:"miller",mollweide:"mollweide","mt flat polar parabolic":"mtFlatPolarParabolic","mt flat polar quartic":"mtFlatPolarQuartic","mt flat polar sinusoidal":"mtFlatPolarSinusoidal","natural earth":"naturalEarth","natural earth1":"naturalEarth1","natural earth2":"naturalEarth2","nell hammer":"nellHammer",nicolosi:"nicolosi",orthographic:"orthographic",patterson:"patterson","peirce quincuncial":"peirceQuincuncial",polyconic:"polyconic","rectangular polyconic":"rectangularPolyconic",robinson:"robinson",satellite:"satellite","sinu mollweide":"sinuMollweide",sinusoidal:"sinusoidal",stereographic:"stereographic",times:"times","transverse mercator":"transverseMercator","van der grinten":"vanDerGrinten","van der grinten2":"vanDerGrinten2","van der grinten3":"vanDerGrinten3","van der grinten4":"vanDerGrinten4",wagner4:"wagner4",wagner6:"wagner6",wiechel:"wiechel","winkel tripel":"winkel3",winkel3:"winkel3"},Q.axesNames=["lonaxis","lataxis"],Q.lonaxisSpan={orthographic:180,"azimuthal equal area":360,"azimuthal equidistant":360,"conic conformal":180,gnomonic:160,stereographic:180,"transverse mercator":180,"*":360},Q.lataxisSpan={"conic conformal":150,stereographic:179.5,"*":180},Q.scopeDefaults={world:{lonaxisRange:[-180,180],lataxisRange:[-90,90],projType:"equirectangular",projRotate:[0,0,0]},usa:{lonaxisRange:[-180,-50],lataxisRange:[15,80],projType:"albers usa"},europe:{lonaxisRange:[-30,60],lataxisRange:[30,85],projType:"conic conformal",projRotate:[15,0,0],projParallels:[0,60]},asia:{lonaxisRange:[22,160],lataxisRange:[-15,55],projType:"mercator",projRotate:[0,0,0]},africa:{lonaxisRange:[-30,60],lataxisRange:[-40,40],projType:"mercator",projRotate:[0,0,0]},"north america":{lonaxisRange:[-180,-45],lataxisRange:[5,85],projType:"conic conformal",projRotate:[-100,0,0],projParallels:[29.5,45.5]},"south america":{lonaxisRange:[-100,-30],lataxisRange:[-60,15],projType:"mercator",projRotate:[0,0,0]}},Q.clipPad=.001,Q.precision=.1,Q.landColor="#F0DC82",Q.waterColor="#3399FF",Q.locationmodeToLayer={"ISO-3":"countries","USA-states":"subunits","country names":"countries"},Q.sphereSVG={type:"Sphere"},Q.fillLayers={ocean:1,land:1,lakes:1},Q.lineLayers={subunits:1,countries:1,coastlines:1,rivers:1,frame:1},Q.layers=["bg","ocean","land","lakes","subunits","countries","coastlines","rivers","lataxis","lonaxis","frame","backplot","frontplot"],Q.layersForChoropleth=["bg","ocean","land","subunits","countries","coastlines","lataxis","lonaxis","frame","backplot","rivers","lakes","frontplot"],Q.layerNameToAdjective={ocean:"ocean",land:"land",lakes:"lake",subunits:"subunit",countries:"country",coastlines:"coastline",rivers:"river",frame:"frame"}},{}],597:[function(y,ee,Q){"use strict";var g=y("@plotly/d3"),v=y("d3-geo"),m=v.geoPath,x=v.geoDistance,e=y("d3-geo-projection"),n=y("../../registry"),t=y("../../lib"),a=t.strTranslate,r=y("../../components/color"),d=y("../../components/drawing"),s=y("../../components/fx"),i=y("../plots"),u=y("../cartesian/axes"),f=y("../cartesian/autorange").getAutoRange,c=y("../../components/dragelement"),h=y("../../components/selections").prepSelect,p=y("../../components/selections").clearOutline,o=y("../../components/selections").selectOnClick,b=y("./zoom"),l=y("./constants"),T=y("../../lib/geo_location_utils"),_=y("../../lib/topojson_utils"),w=y("topojson-client").feature;function k(I){this.id=I.id,this.graphDiv=I.graphDiv,this.container=I.container,this.topojsonURL=I.topojsonURL,this.isStatic=I.staticPlot,this.topojsonName=null,this.topojson=null,this.projection=null,this.scope=null,this.viewInitial=null,this.fitScale=null,this.bounds=null,this.midPt=null,this.hasChoropleth=!1,this.traceHash={},this.layers={},this.basePaths={},this.dataPaths={},this.dataPoints={},this.clipDef=null,this.clipRect=null,this.bgRect=null,this.makeFramework()}var L=k.prototype;function M(I,P){var S=l.clipPad,E=I[0]+S,z=I[1]-S,R=P[0]+S,q=P[1]-S;E>0&&z<0&&(z+=360);var V=(z-E)/4;return{type:"Polygon",coordinates:[[[E,R],[E,q],[E+V,q],[E+2*V,q],[E+3*V,q],[z,q],[z,R],[z-V,R],[z-2*V,R],[z-3*V,R],[E,R]]]}}ee.exports=function(I){return new k(I)},L.plot=function(I,P,S){var E=this,z=P[this.id],R=[],q=!1;for(var V in l.layerNameToAdjective)if("frame"!==V&&z["show"+V]){q=!0;break}for(var W=0;W<I.length;W++)if(I[0][0].trace.locationmode){q=!0;break}if(q){var K=_.getTopojsonName(z);null!==E.topojson&&K===E.topojsonName||(E.topojsonName=K,void 0===PlotlyGeoAssets.topojson[E.topojsonName]&&R.push(E.fetchTopojson()))}R=R.concat(T.fetchTraceGeoData(I)),S.push(new Promise(function(G,Y){Promise.all(R).then(function(){E.topojson=PlotlyGeoAssets.topojson[E.topojsonName],E.update(I,P),G()}).catch(Y)}))},L.fetchTopojson=function(){var I=this,P=_.getTopojsonPath(I.topojsonURL,I.topojsonName);return new Promise(function(S,E){g.json(P,function(z,R){if(z)return E(404===z.status?new Error(["plotly.js could not find topojson file at",P+".","Make sure the *topojsonURL* plot config option","is set properly."].join(" ")):new Error(["unexpected error while fetching topojson file at",P].join(" ")));PlotlyGeoAssets.topojson[I.topojsonName]=R,S()})})},L.update=function(I,P){var S=P[this.id];this.hasChoropleth=!1;for(var E=0;E<I.length;E++){var z=I[E],R=z[0].trace;"choropleth"===R.type&&(this.hasChoropleth=!0),!0===R.visible&&R._length>0&&R._module.calcGeoJSON(z,P)}if(!this.updateProjection(I,P)){this.viewInitial&&this.scope===S.scope||this.saveViewInitial(S),this.scope=S.scope,this.updateBaseLayers(P,S),this.updateDims(P,S),this.updateFx(P,S),i.generalUpdatePerTraceModule(this.graphDiv,this,I,S);var q=this.layers.frontplot.select(".scatterlayer");this.dataPoints.point=q.selectAll(".point"),this.dataPoints.text=q.selectAll("text"),this.dataPaths.line=q.selectAll(".js-line");var V=this.layers.backplot.select(".choroplethlayer");this.dataPaths.choropleth=V.selectAll("path"),this.render()}},L.updateProjection=function(I,P){var S=this.graphDiv,E=P[this.id],z=P._size,R=E.domain,q=E.projection,V=E.lonaxis,W=E.lataxis,K=V._ax,G=W._ax,Y=this.projection=function(fe){var ve=fe.projection,Ae=ve.type,ke=l.projNames[Ae];ke="geo"+t.titleCase(ke);for(var Pe=(v[ke]||e[ke])(),Ne=fe._isSatellite?180*Math.acos(1/ve.distance)/Math.PI:fe._isClipped?l.lonaxisSpan[Ae]/2:null,De=["center","rotate","parallels","clipExtent"],ze=function(Ie){return Ie?Pe:[]},Me=0;Me<De.length;Me++){var Se=De[Me];"function"!=typeof Pe[Se]&&(Pe[Se]=ze)}return Pe.isLonLatOverEdges=function(Ie){if(null===Pe(Ie))return!0;if(Ne){var Fe=Pe.rotate();return x(Ie,[-Fe[0],-Fe[1]])>Ne*Math.PI/180}return!1},Pe.getPath=function(){return m().projection(Pe)},Pe.getBounds=function(Ie){return Pe.getPath().bounds(Ie)},Pe.precision(l.precision),fe._isSatellite&&Pe.tilt(ve.tilt).distance(ve.distance),Ne&&Pe.clipAngle(Ne-l.clipPad),Pe}(E),$=[[z.l+z.w*R.x[0],z.t+z.h*(1-R.y[1])],[z.l+z.w*R.x[1],z.t+z.h*(1-R.y[0])]],B=E.center||{},N=q.rotation||{},U=V.range||[],te=W.range||[];if(E.fitbounds){K._length=$[1][0]-$[0][0],G._length=$[1][1]-$[0][1],K.range=f(S,K),G.range=f(S,G);var j=(K.range[0]+K.range[1])/2,J=(G.range[0]+G.range[1])/2;if(E._isScoped)B={lon:j,lat:J};else if(E._isClipped){B={lon:j,lat:J},N={lon:j,lat:J,roll:N.roll};var X=q.type,re=l.lonaxisSpan[X]/2||180,ne=l.lataxisSpan[X]/2||90;U=[j-re,j+re],te=[J-ne,J+ne]}else B={lon:j,lat:J},N={lon:j,lat:N.lat,roll:N.roll}}Y.center([B.lon-N.lon,B.lat-N.lat]).rotate([-N.lon,-N.lat,N.roll]).parallels(q.parallels);var le=M(U,te);Y.fitExtent($,le);var oe=this.bounds=Y.getBounds(le),de=this.fitScale=Y.scale(),se=Y.translate();if(E.fitbounds){var ge=Y.getBounds(M(K.range,G.range)),_e=Math.min((oe[1][0]-oe[0][0])/(ge[1][0]-ge[0][0]),(oe[1][1]-oe[0][1])/(ge[1][1]-ge[0][1]));isFinite(_e)?Y.scale(_e*de):t.warn("Something went wrong during"+this.id+"fitbounds computations.")}else Y.scale(q.scale*de);var Te=this.midPt=[(oe[0][0]+oe[1][0])/2,(oe[0][1]+oe[1][1])/2];if(Y.translate([se[0]+(Te[0]-se[0]),se[1]+(Te[1]-se[1])]).clipExtent(oe),E._isAlbersUsa){var we=Y([B.lon,B.lat]),Oe=Y.translate();Y.translate([Oe[0]-(we[0]-Oe[0]),Oe[1]-(we[1]-Oe[1])])}},L.updateBaseLayers=function(I,P){var S=this,E=S.topojson,z=S.layers,R=S.basePaths;function q(Y){return"lonaxis"===Y||"lataxis"===Y}function V(Y){return Boolean(l.lineLayers[Y])}function W(Y){return Boolean(l.fillLayers[Y])}var K=(this.hasChoropleth?l.layersForChoropleth:l.layers).filter(function(Y){return V(Y)||W(Y)?P["show"+Y]:!q(Y)||P[Y].showgrid}),G=S.framework.selectAll(".layer").data(K,String);G.exit().each(function(Y){delete z[Y],delete R[Y],g.select(this).remove()}),G.enter().append("g").attr("class",function(Y){return"layer "+Y}).each(function(Y){var $=z[Y]=g.select(this);"bg"===Y?S.bgRect=$.append("rect").style("pointer-events","all"):q(Y)?R[Y]=$.append("path").style("fill","none"):"backplot"===Y?$.append("g").classed("choroplethlayer",!0):"frontplot"===Y?$.append("g").classed("scatterlayer",!0):V(Y)?R[Y]=$.append("path").style("fill","none").style("stroke-miterlimit",2):W(Y)&&(R[Y]=$.append("path").style("stroke","none"))}),G.order(),G.each(function(Y){var $=R[Y],B=l.layerNameToAdjective[Y];"frame"===Y?$.datum(l.sphereSVG):V(Y)||W(Y)?$.datum(w(E,E.objects[Y])):q(Y)&&$.datum(function(N,U,te){var j,J,X,re=U[N],ne=l.scopeDefaults[U.scope];"lonaxis"===N?(j=ne.lonaxisRange,J=ne.lataxisRange,X=function(Oe,fe){return[Oe,fe]}):"lataxis"===N&&(j=ne.lataxisRange,J=ne.lonaxisRange,X=function(Oe,fe){return[fe,Oe]});var le={type:"linear",range:[j[0],j[1]-1e-6],tick0:re.tick0,dtick:re.dtick};u.setConvert(le,te);var oe=u.calcTicks(le);U.isScoped||"lonaxis"!==N||oe.pop();for(var de=oe.length,se=new Array(de),ge=0;ge<de;ge++)for(var _e=oe[ge].x,Te=se[ge]=[],we=J[0];we<J[1]+2.5;we+=2.5)Te.push(X(_e,we));return{type:"MultiLineString",coordinates:se}}(Y,P,I)).call(r.stroke,P[Y].gridcolor).call(d.dashLine,P[Y].griddash,P[Y].gridwidth),V(Y)?$.call(r.stroke,P[B+"color"]).call(d.dashLine,"",P[B+"width"]):W(Y)&&$.call(r.fill,P[B+"color"])})},L.updateDims=function(I,P){var S=this.bounds,E=(P.framewidth||0)/2,z=S[0][0]-E,R=S[0][1]-E,q=S[1][0]-z+E,V=S[1][1]-R+E;d.setRect(this.clipRect,z,R,q,V),this.bgRect.call(d.setRect,z,R,q,V).call(r.fill,P.bgcolor),this.xaxis._offset=z,this.xaxis._length=q,this.yaxis._offset=R,this.yaxis._length=V},L.updateFx=function(I,P){var S=this,E=S.graphDiv,z=S.bgRect,R=I.dragmode,q=I.clickmode;if(!S.isStatic){var V={element:S.bgRect.node(),gd:E,plotinfo:{id:S.id,xaxis:S.xaxis,yaxis:S.yaxis,fillRangeItems:function(K,G){G.isRect?(K.range={})[S.id]=[W([G.xmin,G.ymin]),W([G.xmax,G.ymax])]:(K.lassoPoints={})[S.id]=G.map(W)}},xaxes:[S.xaxis],yaxes:[S.yaxis],subplot:S.id,clickFn:function(K){2===K&&p(E)}};"pan"===R?(z.node().onmousedown=null,z.call(b(S,P)),z.on("dblclick.zoom",function(){var K=S.viewInitial,G={};for(var Y in K)G[S.id+"."+Y]=K[Y];n.call("_guiRelayout",E,G),E.emit("plotly_doubleclick",null)}),E._context._scrollZoom.geo||z.on("wheel.zoom",null)):"select"!==R&&"lasso"!==R||(z.on(".zoom",null),V.prepFn=function(K,G,Y){h(K,G,Y,V,R)},c.init(V)),z.on("mousemove",function(){var K=S.projection.invert(t.getPositionFromD3Event());if(!K)return c.unhover(E,g.event);S.xaxis.p2c=function(){return K[0]},S.yaxis.p2c=function(){return K[1]},s.hover(E,g.event,S.id)}),z.on("mouseout",function(){E._dragging||c.unhover(E,g.event)}),z.on("click",function(){"select"!==R&&"lasso"!==R&&(q.indexOf("select")>-1&&o(g.event,E,[S.xaxis],[S.yaxis],S.id,V),q.indexOf("event")>-1&&s.click(E,g.event))})}function W(K){return S.projection.invert([K[0]+S.xaxis._offset,K[1]+S.yaxis._offset])}},L.makeFramework=function(){var I=this,P=I.graphDiv,S=P._fullLayout,E="clip"+S._uid+I.id;I.clipDef=S._clips.append("clipPath").attr("id",E),I.clipRect=I.clipDef.append("rect"),I.framework=g.select(I.container).append("g").attr("class","geo "+I.id).call(d.setClipUrl,E,P),I.project=function(z){var R=I.projection(z);return R?[R[0]-I.xaxis._offset,R[1]-I.yaxis._offset]:[null,null]},I.xaxis={_id:"x",c2p:function(z){return I.project(z)[0]}},I.yaxis={_id:"y",c2p:function(z){return I.project(z)[1]}},I.mockAxis={type:"linear",showexponent:"all",exponentformat:"B"},u.setConvert(I.mockAxis,S)},L.saveViewInitial=function(I){var S=I.center||{},E=I.projection,z=E.rotation||{};this.viewInitial={fitbounds:I.fitbounds,"projection.scale":E.scale},t.extendFlat(this.viewInitial,I._isScoped?{"center.lon":S.lon,"center.lat":S.lat}:I._isClipped?{"projection.rotation.lon":z.lon,"projection.rotation.lat":z.lat}:{"center.lon":S.lon,"center.lat":S.lat,"projection.rotation.lon":z.lon})},L.render=function(){var I,P=this.projection,S=P.getPath();function E(R){var q=P(R.lonlat);return q?a(q[0],q[1]):null}function z(R){return P.isLonLatOverEdges(R.lonlat)?"none":null}for(I in this.basePaths)this.basePaths[I].attr("d",S);for(I in this.dataPaths)this.dataPaths[I].attr("d",function(R){return S(R.geojson)});for(I in this.dataPoints)this.dataPoints[I].attr("display",z).attr("transform",E)}},{"../../components/color":367,"../../components/dragelement":386,"../../components/drawing":389,"../../components/fx":407,"../../components/selections":455,"../../lib":515,"../../lib/geo_location_utils":508,"../../lib/topojson_utils":544,"../../registry":647,"../cartesian/autorange":565,"../cartesian/axes":566,"../plots":628,"./constants":596,"./zoom":601,"@plotly/d3":58,"d3-geo":114,"d3-geo-projection":113,"topojson-client":316}],598:[function(y,ee,Q){"use strict";var g=y("../../plots/get_data").getSubplotCalcData,v=y("../../lib").counterRegex,m=y("./geo"),x="geo",e=v(x),n={};n.geo={valType:"subplotid",dflt:x,editType:"calc"},ee.exports={attr:x,name:x,idRoot:x,idRegex:e,attrRegex:e,attributes:n,layoutAttributes:y("./layout_attributes"),supplyLayoutDefaults:y("./layout_defaults"),plot:function(t){for(var a=t._fullLayout,r=t.calcdata,d=a._subplots.geo,s=0;s<d.length;s++){var i=d[s],u=g(r,x,i),f=a[i]._subplot;f||(f=m({id:i,graphDiv:t,container:a._geolayer.node(),topojsonURL:t._context.topojsonURL,staticPlot:t._context.staticPlot}),a[i]._subplot=f),f.plot(u,a,t._promises)}},updateFx:function(t){for(var a=t._fullLayout,r=a._subplots.geo,d=0;d<r.length;d++){var s=a[r[d]];s._subplot.updateFx(a,s)}},clean:function(t,a,r,d){for(var s=d._subplots.geo||[],i=0;i<s.length;i++){var u=s[i],f=d[u]._subplot;!a[u]&&f&&(f.framework.remove(),f.clipDef.remove())}}}},{"../../lib":515,"../../plots/get_data":602,"./geo":597,"./layout_attributes":599,"./layout_defaults":600}],599:[function(y,ee,Q){"use strict";var g=y("../../components/color/attributes"),v=y("../domain").attributes,m=y("../../components/drawing/attributes").dash,x=y("./constants"),e=y("../../plot_api/edit_types").overrideAll,n=y("../../lib/sort_object_keys"),t={range:{valType:"info_array",items:[{valType:"number"},{valType:"number"}]},showgrid:{valType:"boolean",dflt:!1},tick0:{valType:"number",dflt:0},dtick:{valType:"number"},gridcolor:{valType:"color",dflt:g.lightLine},gridwidth:{valType:"number",min:0,dflt:1},griddash:m};(ee.exports=e({domain:v({name:"geo"},{}),fitbounds:{valType:"enumerated",values:[!1,"locations","geojson"],dflt:!1,editType:"plot"},resolution:{valType:"enumerated",values:[110,50],dflt:110,coerceNumber:!0},scope:{valType:"enumerated",values:n(x.scopeDefaults),dflt:"world"},projection:{type:{valType:"enumerated",values:n(x.projNames)},rotation:{lon:{valType:"number"},lat:{valType:"number"},roll:{valType:"number"}},tilt:{valType:"number",dflt:0},distance:{valType:"number",min:1.001,dflt:2},parallels:{valType:"info_array",items:[{valType:"number"},{valType:"number"}]},scale:{valType:"number",min:0,dflt:1}},center:{lon:{valType:"number"},lat:{valType:"number"}},visible:{valType:"boolean",dflt:!0},showcoastlines:{valType:"boolean"},coastlinecolor:{valType:"color",dflt:g.defaultLine},coastlinewidth:{valType:"number",min:0,dflt:1},showland:{valType:"boolean",dflt:!1},landcolor:{valType:"color",dflt:x.landColor},showocean:{valType:"boolean",dflt:!1},oceancolor:{valType:"color",dflt:x.waterColor},showlakes:{valType:"boolean",dflt:!1},lakecolor:{valType:"color",dflt:x.waterColor},showrivers:{valType:"boolean",dflt:!1},rivercolor:{valType:"color",dflt:x.waterColor},riverwidth:{valType:"number",min:0,dflt:1},showcountries:{valType:"boolean"},countrycolor:{valType:"color",dflt:g.defaultLine},countrywidth:{valType:"number",min:0,dflt:1},showsubunits:{valType:"boolean"},subunitcolor:{valType:"color",dflt:g.defaultLine},subunitwidth:{valType:"number",min:0,dflt:1},showframe:{valType:"boolean"},framecolor:{valType:"color",dflt:g.defaultLine},framewidth:{valType:"number",min:0,dflt:1},bgcolor:{valType:"color",dflt:g.background},lonaxis:t,lataxis:t},"plot","from-root")).uirevision={valType:"any",editType:"none"}},{"../../components/color/attributes":366,"../../components/drawing/attributes":388,"../../lib/sort_object_keys":538,"../../plot_api/edit_types":548,"../domain":593,"./constants":596}],600:[function(y,ee,Q){"use strict";var g=y("../../lib"),v=y("../subplot_defaults"),m=y("../get_data").getSubplotData,x=y("./constants"),e=y("./layout_attributes"),n=x.axesNames;function t(a,r,d,s){var i=m(s.fullData,"geo",s.id).map(function(N){return N._expandedIndex}),u=d("resolution"),f=d("scope"),c=x.scopeDefaults[f],h=d("projection.type",c.projType),p=r._isAlbersUsa="albers usa"===h;p&&(f=r.scope="usa");var o=r._isScoped="world"!==f,b=r._isSatellite="satellite"===h,l=r._isConic=-1!==h.indexOf("conic")||"albers"===h,T=r._isClipped=!!x.lonaxisSpan[h];if(!1===a.visible){var _=g.extendDeep({},r._template);_.showcoastlines=!1,_.showcountries=!1,_.showframe=!1,_.showlakes=!1,_.showland=!1,_.showocean=!1,_.showrivers=!1,_.showsubunits=!1,_.lonaxis&&(_.lonaxis.showgrid=!1),_.lataxis&&(_.lataxis.showgrid=!1),r._template=_}for(var w=d("visible"),k=0;k<n.length;k++){var L,M=n[k],I=[30,10][k];if(o)L=c[M+"Range"];else{var P=x[M+"Span"],S=(P[h]||P["*"])/2,E=d("projection.rotation."+M.substr(0,3),c.projRotate[k]);L=[E-S,E+S]}var z=d(M+".range",L);d(M+".tick0"),d(M+".dtick",I),d(M+".showgrid",!!w&&void 0)&&(d(M+".gridcolor"),d(M+".gridwidth"),d(M+".griddash")),r[M]._ax={type:"linear",_id:M.slice(0,3),_traceIndices:i,setScale:g.identity,c2l:g.identity,r2l:g.identity,autorange:!0,range:z.slice(),_m:1,_input:{}}}var R=r.lonaxis.range,q=r.lataxis.range,V=R[0],W=R[1];V>0&&W<0&&(W+=360);var K,G,Y,$=(V+W)/2;if(!p){var B=o?c.projRotate:[$,0,0];K=d("projection.rotation.lon",B[0]),d("projection.rotation.lat",B[1]),d("projection.rotation.roll",B[2]),d("showcoastlines",!o&&w)&&(d("coastlinecolor"),d("coastlinewidth")),d("showocean",!!w&&void 0)&&d("oceancolor")}p?(G=-96.6,Y=38.7):(G=o?$:K,Y=(q[0]+q[1])/2),d("center.lon",G),d("center.lat",Y),b&&(d("projection.tilt"),d("projection.distance")),l&&d("projection.parallels",c.projParallels||[0,60]),d("projection.scale"),d("showland",!!w&&void 0)&&d("landcolor"),d("showlakes",!!w&&void 0)&&d("lakecolor"),d("showrivers",!!w&&void 0)&&(d("rivercolor"),d("riverwidth")),d("showcountries",o&&"usa"!==f&&w)&&(d("countrycolor"),d("countrywidth")),("usa"===f||"north america"===f&&50===u)&&(d("showsubunits",w),d("subunitcolor"),d("subunitwidth")),o||d("showframe",w)&&(d("framecolor"),d("framewidth")),d("bgcolor"),d("fitbounds")&&(delete r.projection.scale,o?(delete r.center.lon,delete r.center.lat):T?(delete r.center.lon,delete r.center.lat,delete r.projection.rotation.lon,delete r.projection.rotation.lat,delete r.lonaxis.range,delete r.lataxis.range):(delete r.center.lon,delete r.center.lat,delete r.projection.rotation.lon))}ee.exports=function(a,r,d){v(a,r,d,{type:"geo",attributes:e,handleDefaults:t,fullData:d,partition:"y"})}},{"../../lib":515,"../get_data":602,"../subplot_defaults":641,"./constants":596,"./layout_attributes":599}],601:[function(y,ee,Q){"use strict";var g=y("@plotly/d3"),v=y("../../lib"),m=y("../../registry"),x=Math.PI/180,e=180/Math.PI,n={cursor:"pointer"},t={cursor:"auto"};function a(w,k){return g.behavior.zoom().translate(k.translate()).scale(k.scale())}function r(w,k,L){var M=w.id,I=w.graphDiv,P=I.layout,S=P[M],E=I._fullLayout,z=E[M],R={},q={};function V(W,K){R[M+"."+W]=v.nestedProperty(S,W).get(),m.call("_storeDirectGUIEdit",P,E._preGUI,R);var G=v.nestedProperty(z,W);G.get()!==K&&(G.set(K),v.nestedProperty(S,W).set(K),q[M+"."+W]=K)}L(V),V("projection.scale",k.scale()/w.fitScale),V("fitbounds",!1),I.emit("plotly_relayout",q)}function d(w,k){var L=a(0,k);function M(I){var P=k.invert(w.midPt);I("center.lon",P[0]),I("center.lat",P[1])}return L.on("zoomstart",function(){g.select(this).style(n)}).on("zoom",function(){k.scale(g.event.scale).translate(g.event.translate),w.render();var I=k.invert(w.midPt);w.graphDiv.emit("plotly_relayouting",{"geo.projection.scale":k.scale()/w.fitScale,"geo.center.lon":I[0],"geo.center.lat":I[1]})}).on("zoomend",function(){g.select(this).style(t),r(w,k,M)}),L}function s(w,k){var L,M,I,P,S,E,z,R,q,V=a(0,k);function W(G){return k.invert(G)}function K(G){var Y=k.rotate(),$=k.invert(w.midPt);G("projection.rotation.lon",-Y[0]),G("center.lon",$[0]),G("center.lat",$[1])}return V.on("zoomstart",function(){g.select(this).style(n),L=g.mouse(this),M=k.rotate(),I=k.translate(),P=M,S=W(L)}).on("zoom",function(){if(E=g.mouse(this),function($){var B=W($);if(!B)return!0;var N=k(B);return Math.abs(N[0]-$[0])>2||Math.abs(N[1]-$[1])>2}(L))return V.scale(k.scale()),void V.translate(k.translate());k.scale(g.event.scale),k.translate([I[0],g.event.translate[1]]),S?W(E)&&(R=W(E),k.rotate(z=[P[0]+(R[0]-S[0]),M[1],M[2]]),P=z):S=W(L=E),q=!0,w.render();var G=k.rotate(),Y=k.invert(w.midPt);w.graphDiv.emit("plotly_relayouting",{"geo.projection.scale":k.scale()/w.fitScale,"geo.center.lon":Y[0],"geo.center.lat":Y[1],"geo.projection.rotation.lon":-G[0]})}).on("zoomend",function(){g.select(this).style(t),q&&r(w,k,K)}),V}function i(w,k){var L,M={r:k.rotate(),k:k.scale()},I=a(0,k),P=function(W){for(var K=0,G=arguments.length,Y=[];++K<G;)Y.push(arguments[K]);var $=g.dispatch.apply(null,Y);return $.of=function(B,N){return function(U){var te;try{te=U.sourceEvent=g.event,U.target=W,g.event=U,$[U.type].apply(B,N)}finally{g.event=te}}},$}(I,"zoomstart","zoom","zoomend"),S=0,E=I.on;function z(W){S++||W({type:"zoomstart"})}function R(W){W({type:"zoom"})}function q(W){--S||W({type:"zoomend"})}function V(W){var K=k.rotate();W("projection.rotation.lon",-K[0]),W("projection.rotation.lat",-K[1])}return I.on("zoomstart",function(){g.select(this).style(n);var W=g.mouse(this),K=k.rotate(),G=K,Y=k.translate(),$=f(K);L=u(k,W),E.call(I,"zoom",function(){var B=g.mouse(this);if(k.scale(M.k=g.event.scale),L){if(u(k,B)){k.rotate(K).translate(Y);var N=u(k,B),U=h(L,N),te=T(c($,U)),j=M.r=p(te,L,G);isFinite(j[0])&&isFinite(j[1])&&isFinite(j[2])||(j=G),k.rotate(j),G=j}}else L=u(k,W=B);R(P.of(this,arguments))}),z(P.of(this,arguments))}).on("zoomend",function(){g.select(this).style(t),E.call(I,"zoom",null),q(P.of(this,arguments)),r(w,k,V)}).on("zoom.redraw",function(){w.render();var W=k.rotate();w.graphDiv.emit("plotly_relayouting",{"geo.projection.scale":k.scale()/w.fitScale,"geo.projection.rotation.lon":-W[0],"geo.projection.rotation.lat":-W[1]})}),g.rebind(I,P,"on")}function u(w,k){var M,I,P,S,L=w.invert(k);return L&&isFinite(L[0])&&isFinite(L[1])&&(I=(M=L)[0]*x,P=M[1]*x,[(S=Math.cos(P))*Math.cos(I),S*Math.sin(I),Math.sin(P)])}function f(w){var k=.5*w[0]*x,L=.5*w[1]*x,M=.5*w[2]*x,I=Math.sin(k),P=Math.cos(k),S=Math.sin(L),E=Math.cos(L),z=Math.sin(M),R=Math.cos(M);return[P*E*R+I*S*z,I*E*R-P*S*z,P*S*R+I*E*z,P*E*z-I*S*R]}function c(w,k){var L=w[0],M=w[1],I=w[2],P=w[3],S=k[0],E=k[1],z=k[2],R=k[3];return[L*S-M*E-I*z-P*R,L*E+M*S+I*R-P*z,L*z-M*R+I*S+P*E,L*R+M*z-I*E+P*S]}function h(w,k){if(w&&k){var L=[(S=w)[1]*(E=k)[2]-S[2]*E[1],S[2]*E[0]-S[0]*E[2],S[0]*E[1]-S[1]*E[0]],M=Math.sqrt(_(L,L)),I=.5*Math.acos(Math.max(-1,Math.min(1,_(w,k)))),P=Math.sin(I)/M;return M&&[Math.cos(I),L[2]*P,-L[1]*P,L[0]*P]}var S,E}function p(w,k,L){var M=l(k,2,w[0]);M=l(M,1,w[1]),M=l(M,0,w[2]-L[2]);var I,P,S=k[0],E=k[1],z=k[2],R=M[0],q=M[1],V=M[2],W=Math.atan2(E,S)*e,K=Math.sqrt(S*S+E*E);Math.abs(q)>K?(P=(q>0?90:-90)-W,I=0):(P=Math.asin(q/K)*e-W,I=Math.sqrt(K*K-q*q));var G=180-P-2*W,Y=(Math.atan2(V,R)-Math.atan2(z,I))*e,$=(Math.atan2(V,R)-Math.atan2(z,-I))*e;return o(L[0],L[1],P,Y)<=o(L[0],L[1],G,$)?[P,Y,L[2]]:[G,$,L[2]]}function o(w,k,L,M){var I=b(L-w),P=b(M-k);return Math.sqrt(I*I+P*P)}function b(w){return(w%360+540)%360-180}function l(w,k,L){var M=L*x,I=w.slice(),P=0===k?1:0,S=2===k?1:2,E=Math.cos(M),z=Math.sin(M);return I[P]=w[P]*E-w[S]*z,I[S]=w[S]*E+w[P]*z,I}function T(w){return[Math.atan2(2*(w[0]*w[1]+w[2]*w[3]),1-2*(w[1]*w[1]+w[2]*w[2]))*e,Math.asin(Math.max(-1,Math.min(1,2*(w[0]*w[2]-w[3]*w[1]))))*e,Math.atan2(2*(w[0]*w[3]+w[1]*w[2]),1-2*(w[2]*w[2]+w[3]*w[3]))*e]}function _(w,k){for(var L=0,M=0,I=w.length;M<I;++M)L+=w[M]*k[M];return L}ee.exports=function(w,k){return(k._isScoped?d:k._isClipped?i:s)(w,w.projection)}},{"../../lib":515,"../../registry":647,"@plotly/d3":58}],602:[function(y,ee,Q){"use strict";var g=y("../registry"),v=y("./cartesian/constants").SUBPLOT_PATTERN;Q.getSubplotCalcData=function(m,x,e){var n=g.subplotsRegistry[x];if(!n)return[];for(var t=n.attr,a=[],r=0;r<m.length;r++){var d=m[r];d[0].trace[t]===e&&a.push(d)}return a},Q.getModuleCalcData=function(m,x){var e,n=[],t=[];if(!(e="string"==typeof x?g.getModule(x).plot:"function"==typeof x?x:x.plot))return[n,m];for(var a=0;a<m.length;a++){var r=m[a],d=r[0].trace;!0===d.visible&&0!==d._length&&(d._module.plot===e?n.push(r):t.push(r))}return[n,t]},Q.getSubplotData=function(m,x,e){if(!g.subplotsRegistry[x])return[];var n,t,a,r=g.subplotsRegistry[x].attr,d=[];if("gl2d"===x){var s=e.match(v);t="x"+s[1],a="y"+s[2]}for(var i=0;i<m.length;i++)n=m[i],"gl2d"===x&&g.traceIs(n,"gl2d")?n[r[0]]===t&&n[r[1]]===a&&d.push(n):n[r]===e&&d.push(n);return d}},{"../registry":647,"./cartesian/constants":573}],603:[function(y,ee,Q){"use strict";var g=y("mouse-change"),v=y("mouse-wheel"),m=y("mouse-event-offset"),x=y("../cartesian/constants"),e=y("has-passive-events");function n(t,a){this.element=t,this.plot=a,this.mouseListener=null,this.wheelListener=null,this.lastInputTime=Date.now(),this.lastPos=[0,0],this.boxEnabled=!1,this.boxInited=!1,this.boxStart=[0,0],this.boxEnd=[0,0],this.dragStart=[0,0]}ee.exports=function(t){var a=t.mouseContainer,r=t.glplot,d=new n(a,r);function s(){t.xaxis.autorange=!1,t.yaxis.autorange=!1}function i(u,f,c){var h,p,o=t.calcDataBox(),b=r.viewBox,l=d.lastPos[0],T=d.lastPos[1],_=x.MINDRAG*r.pixelRatio,w=x.MINZOOM*r.pixelRatio;function k(E,z,R){var q=Math.min(z,R),V=Math.max(z,R);q!==V?(o[E]=q,o[E+2]=V,d.dataBox=o,t.setRanges(o)):(t.selectBox.selectBox=[0,0,1,1],t.glplot.setDirty())}switch(f*=r.pixelRatio,c=b[3]-b[1]-(c*=r.pixelRatio),t.fullLayout.dragmode){case"zoom":if(u){var L=f/(b[2]-b[0])*(o[2]-o[0])+o[0],M=c/(b[3]-b[1])*(o[3]-o[1])+o[1];d.boxInited||(d.boxStart[0]=L,d.boxStart[1]=M,d.dragStart[0]=f,d.dragStart[1]=c),d.boxEnd[0]=L,d.boxEnd[1]=M,d.boxInited=!0,d.boxEnabled||d.boxStart[0]===d.boxEnd[0]&&d.boxStart[1]===d.boxEnd[1]||(d.boxEnabled=!0);var I=Math.abs(d.dragStart[0]-f)<w,P=Math.abs(d.dragStart[1]-c)<w;if(!function(){for(var E=t.graphDiv._fullLayout._axisConstraintGroups,z=t.xaxis._id,R=t.yaxis._id,q=0;q<E.length;q++)if(-1!==E[q][z]){if(-1!==E[q][R])return!0;break}return!1}()||I&&P)I&&(d.boxEnd[0]=d.boxStart[0]),P&&(d.boxEnd[1]=d.boxStart[1]);else{h=d.boxEnd[0]-d.boxStart[0],p=d.boxEnd[1]-d.boxStart[1];var S=(o[3]-o[1])/(o[2]-o[0]);Math.abs(h*S)>Math.abs(p)?(d.boxEnd[1]=d.boxStart[1]+Math.abs(h)*S*(p>=0?1:-1),d.boxEnd[1]<o[1]?(d.boxEnd[1]=o[1],d.boxEnd[0]=d.boxStart[0]+(o[1]-d.boxStart[1])/Math.abs(S)):d.boxEnd[1]>o[3]&&(d.boxEnd[1]=o[3],d.boxEnd[0]=d.boxStart[0]+(o[3]-d.boxStart[1])/Math.abs(S))):(d.boxEnd[0]=d.boxStart[0]+Math.abs(p)/S*(h>=0?1:-1),d.boxEnd[0]<o[0]?(d.boxEnd[0]=o[0],d.boxEnd[1]=d.boxStart[1]+(o[0]-d.boxStart[0])*Math.abs(S)):d.boxEnd[0]>o[2]&&(d.boxEnd[0]=o[2],d.boxEnd[1]=d.boxStart[1]+(o[2]-d.boxStart[0])*Math.abs(S)))}}else d.boxEnabled?(p=d.boxStart[1]!==d.boxEnd[1],(h=d.boxStart[0]!==d.boxEnd[0])||p?(h&&(k(0,d.boxStart[0],d.boxEnd[0]),t.xaxis.autorange=!1),p&&(k(1,d.boxStart[1],d.boxEnd[1]),t.yaxis.autorange=!1),t.relayoutCallback()):t.glplot.setDirty(),d.boxEnabled=!1,d.boxInited=!1):d.boxInited&&(d.boxInited=!1);break;case"pan":d.boxEnabled=!1,d.boxInited=!1,u?(d.panning||(d.dragStart[0]=f,d.dragStart[1]=c),Math.abs(d.dragStart[0]-f)<_&&(f=d.dragStart[0]),Math.abs(d.dragStart[1]-c)<_&&(c=d.dragStart[1]),p=(T-c)*(o[3]-o[1])/(r.viewBox[3]-r.viewBox[1]),o[0]+=h=(l-f)*(o[2]-o[0])/(r.viewBox[2]-r.viewBox[0]),o[2]+=h,o[1]+=p,o[3]+=p,t.setRanges(o),d.panning=!0,d.lastInputTime=Date.now(),s(),t.cameraChanged(),t.handleAnnotations()):d.panning&&(d.panning=!1,t.relayoutCallback())}d.lastPos[0]=f,d.lastPos[1]=c}return d.mouseListener=g(a,i),a.addEventListener("touchstart",function(u){var f=m(u.changedTouches[0],a);i(0,f[0],f[1]),i(1,f[0],f[1]),u.preventDefault()},!!e&&{passive:!1}),a.addEventListener("touchmove",function(u){u.preventDefault();var f=m(u.changedTouches[0],a);i(1,f[0],f[1]),u.preventDefault()},!!e&&{passive:!1}),a.addEventListener("touchend",function(u){i(0,d.lastPos[0],d.lastPos[1]),u.preventDefault()},!!e&&{passive:!1}),d.wheelListener=v(a,function(u,f){if(!t.scrollZoom)return!1;var c=t.calcDataBox(),h=r.viewBox,p=d.lastPos[0],o=d.lastPos[1],b=Math.exp(5*f/(h[3]-h[1])),l=p/(h[2]-h[0])*(c[2]-c[0])+c[0],T=o/(h[3]-h[1])*(c[3]-c[1])+c[1];return c[0]=(c[0]-l)*b+l,c[2]=(c[2]-l)*b+l,c[1]=(c[1]-T)*b+T,c[3]=(c[3]-T)*b+T,t.setRanges(c),d.lastInputTime=Date.now(),s(),t.cameraChanged(),t.handleAnnotations(),t.relayoutCallback(),!0},!0),d}},{"../cartesian/constants":573,"has-passive-events":229,"mouse-change":241,"mouse-event-offset":242,"mouse-wheel":244}],604:[function(y,ee,Q){"use strict";var g=y("../cartesian/axes"),v=y("../../lib/str2rgbarray");function m(n){this.scene=n,this.gl=n.gl,this.pixelRatio=n.pixelRatio,this.screenBox=[0,0,1,1],this.viewBox=[0,0,1,1],this.dataBox=[-1,-1,1,1],this.borderLineEnable=[!1,!1,!1,!1],this.borderLineWidth=[1,1,1,1],this.borderLineColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.ticks=[[],[]],this.tickEnable=[!0,!0,!1,!1],this.tickPad=[15,15,15,15],this.tickAngle=[0,0,0,0],this.tickColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.tickMarkLength=[0,0,0,0],this.tickMarkWidth=[0,0,0,0],this.tickMarkColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.labels=["x","y"],this.labelEnable=[!0,!0,!1,!1],this.labelAngle=[0,Math.PI/2,0,3*Math.PI/2],this.labelPad=[15,15,15,15],this.labelSize=[12,12],this.labelFont=["sans-serif","sans-serif"],this.labelColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.title="",this.titleEnable=!0,this.titleCenter=[0,0,0,0],this.titleAngle=0,this.titleColor=[0,0,0,1],this.titleFont="sans-serif",this.titleSize=18,this.gridLineEnable=[!0,!0],this.gridLineColor=[[0,0,0,.5],[0,0,0,.5]],this.gridLineWidth=[1,1],this.zeroLineEnable=[!0,!0],this.zeroLineWidth=[1,1],this.zeroLineColor=[[0,0,0,1],[0,0,0,1]],this.borderColor=[0,0,0,0],this.backgroundColor=[0,0,0,0],this.static=this.scene.staticPlot}var x=m.prototype,e=["xaxis","yaxis"];x.merge=function(n){var t,a,r,d,s,i,u,f,c,h,p;for(this.titleEnable=!1,this.backgroundColor=v(n.plot_bgcolor),h=0;h<2;++h){var o=(t=e[h]).charAt(0);for(r=(a=n[this.scene[t]._name]).title.text===this.scene.fullLayout._dfltTitle[o]?"":a.title.text,p=0;p<=2;p+=2)this.labelEnable[h+p]=!1,this.labels[h+p]=r,this.labelColor[h+p]=v(a.title.font.color),this.labelFont[h+p]=a.title.font.family,this.labelSize[h+p]=a.title.font.size,this.labelPad[h+p]=this.getLabelPad(t,a),this.tickEnable[h+p]=!1,this.tickColor[h+p]=v((a.tickfont||{}).color),this.tickAngle[h+p]="auto"===a.tickangle?0:Math.PI*-a.tickangle/180,this.tickPad[h+p]=this.getTickPad(a),this.tickMarkLength[h+p]=0,this.tickMarkWidth[h+p]=a.tickwidth||0,this.tickMarkColor[h+p]=v(a.tickcolor),this.borderLineEnable[h+p]=!1,this.borderLineColor[h+p]=v(a.linecolor),this.borderLineWidth[h+p]=a.linewidth||0;u=this.hasSharedAxis(a),s=this.hasAxisInDfltPos(t,a)&&!u,i=this.hasAxisInAltrPos(t,a)&&!u,d=a.mirror||!1,f=u?-1!==String(d).indexOf("all"):!!d,c=u?"allticks"===d:-1!==String(d).indexOf("ticks"),s?this.labelEnable[h]=!0:i&&(this.labelEnable[h+2]=!0),s?this.tickEnable[h]=a.showticklabels:i&&(this.tickEnable[h+2]=a.showticklabels),(s||f)&&(this.borderLineEnable[h]=a.showline),(i||f)&&(this.borderLineEnable[h+2]=a.showline),(s||c)&&(this.tickMarkLength[h]=this.getTickMarkLength(a)),(i||c)&&(this.tickMarkLength[h+2]=this.getTickMarkLength(a)),this.gridLineEnable[h]=a.showgrid,this.gridLineColor[h]=v(a.gridcolor),this.gridLineWidth[h]=a.gridwidth,this.zeroLineEnable[h]=a.zeroline,this.zeroLineColor[h]=v(a.zerolinecolor),this.zeroLineWidth[h]=a.zerolinewidth}},x.hasSharedAxis=function(n){var t=this.scene;return 0!==g.findSubplotsWithAxis(t.fullLayout._subplots.gl2d,n).indexOf(t.id)},x.hasAxisInDfltPos=function(n,t){var a=t.side;return"xaxis"===n?"bottom"===a:"yaxis"===n?"left"===a:void 0},x.hasAxisInAltrPos=function(n,t){var a=t.side;return"xaxis"===n?"top"===a:"yaxis"===n?"right"===a:void 0},x.getLabelPad=function(n,t){var a=t.title.font.size,r=t.showticklabels;return"xaxis"===n?"top"===t.side?a*(1.5+(r?1:0))-10:a*(1.5+(r?.5:0))-10:"yaxis"===n?"right"===t.side?10+a*(1.5+(r?1:.5)):10+a*(1.5+(r?.5:0)):void 0},x.getTickPad=function(n){return"outside"===n.ticks?10+n.ticklen:15},x.getTickMarkLength=function(n){if(!n.ticks)return 0;var t=n.ticklen;return"inside"===n.ticks?-t:t},ee.exports=function(n){return new m(n)}},{"../../lib/str2rgbarray":540,"../cartesian/axes":566}],605:[function(y,ee,Q){"use strict";var g=y("../../plot_api/edit_types").overrideAll,v=y("./scene2d"),m=y("../layout_attributes"),x=y("../../constants/xmlns_namespaces"),e=y("../cartesian/constants"),n=y("../cartesian"),t=y("../../components/fx/layout_attributes"),a=y("../get_data").getSubplotData;Q.name="gl2d",Q.attr=["xaxis","yaxis"],Q.idRoot=["x","y"],Q.idRegex=e.idRegex,Q.attrRegex=e.attrRegex,Q.attributes=y("../cartesian/attributes"),Q.supplyLayoutDefaults=function(r,d,s){d._has("cartesian")||n.supplyLayoutDefaults(r,d,s)},Q.layoutAttrOverrides=g(n.layoutAttributes,"plot","from-root"),Q.baseLayoutAttrOverrides=g({plot_bgcolor:m.plot_bgcolor,hoverlabel:t.hoverlabel},"plot","nested"),Q.plot=function(r){for(var d=r._fullLayout,s=r._fullData,i=d._subplots.gl2d,u=0;u<i.length;u++){var f=i[u],c=d._plots[f],h=a(s,"gl2d",f),p=c._scene2d;void 0===p&&(p=new v({id:f,graphDiv:r,container:r.querySelector(".gl-container"),staticPlot:r._context.staticPlot,plotGlPixelRatio:r._context.plotGlPixelRatio},d),c._scene2d=p),p.plot(h,r.calcdata,d,r.layout)}},Q.clean=function(r,d,s,i){for(var u=i._subplots.gl2d||[],f=0;f<u.length;f++){var c=u[f],h=i._plots[c];h._scene2d&&0===a(r,"gl2d",c).length&&(h._scene2d.destroy(),delete i._plots[c])}n.clean.apply(this,arguments)},Q.drawFramework=function(r){r._context.staticPlot||n.drawFramework(r)},Q.toSVG=function(r){for(var d=r._fullLayout,s=d._subplots.gl2d,i=0;i<s.length;i++){var u=d._plots[s[i]]._scene2d,f=u.toImage("png");d._glimages.append("svg:image").attr({xmlns:x.svg,"xlink:href":f,x:0,y:0,width:"100%",height:"100%",preserveAspectRatio:"none"}),u.destroy()}},Q.updateFx=function(r){for(var d=r._fullLayout,s=d._subplots.gl2d,i=0;i<s.length;i++)d._plots[s[i]]._scene2d.updateFx(d.dragmode)}},{"../../components/fx/layout_attributes":408,"../../constants/xmlns_namespaces":492,"../../plot_api/edit_types":548,"../cartesian":578,"../cartesian/attributes":564,"../cartesian/constants":573,"../get_data":602,"../layout_attributes":619,"./scene2d":606}],606:[function(y,ee,Q){"use strict";var g,v,m=y("../../registry"),x=y("../../plots/cartesian/axes"),e=y("../../components/fx"),n=y("../../../stackgl_modules").gl_plot2d,t=y("../../../stackgl_modules").gl_spikes2d,a=y("../../../stackgl_modules").gl_select_box,r=y("webgl-context"),d=y("./convert"),s=y("./camera"),i=y("../../lib/show_no_webgl_msg"),u=y("../cartesian/constraints"),f=u.enforce,c=u.clean,h=y("../cartesian/autorange").doAutoRange,p=y("../../components/dragelement/helpers"),o=p.drawMode,b=p.selectMode,l=["xaxis","yaxis"],T=y("../cartesian/constants").SUBPLOT_PATTERN;function _(k,L){this.container=k.container,this.graphDiv=k.graphDiv,this.pixelRatio=k.plotGlPixelRatio||window.devicePixelRatio,this.id=k.id,this.staticPlot=!!k.staticPlot,this.scrollZoom=this.graphDiv._context._scrollZoom.cartesian,this.fullData=null,this.updateRefs(L),this.makeFramework(),this.stopped||(this.glplotOptions=d(this),this.glplotOptions.merge(L),this.glplot=n(this.glplotOptions),this.camera=s(this),this.traces={},this.spikes=t(this.glplot),this.selectBox=a(this.glplot,{innerFill:!1,outerFill:!0}),this.lastButtonState=0,this.pickResult=null,this.isMouseOver=!0,this.stopped=!1,this.redraw=this.draw.bind(this),this.redraw())}ee.exports=_;var w=_.prototype;w.makeFramework=function(){if(this.staticPlot){if(!(v||(g=document.createElement("canvas"),v=r({canvas:g,preserveDrawingBuffer:!1,premultipliedAlpha:!0,antialias:!0}))))throw new Error("Error creating static canvas/context for image server");this.canvas=g,this.gl=v}else{var k=this.container.querySelector(".gl-canvas-focus"),L=r({canvas:k,preserveDrawingBuffer:!0,premultipliedAlpha:!0});if(!L)return i(this),void(this.stopped=!0);this.canvas=k,this.gl=L}var M=this.canvas;M.style.width="100%",M.style.height="100%",M.style.position="absolute",M.style.top="0px",M.style.left="0px",M.style["pointer-events"]="none",this.updateSize(M);var I=this.svgContainer=document.createElementNS("http://www.w3.org/2000/svg","svg");I.style.position="absolute",I.style.top=I.style.left="0px",I.style.width=I.style.height="100%",I.style["z-index"]=20,I.style["pointer-events"]="none";var P=this.mouseContainer=document.createElement("div");P.style.position="absolute",P.style["pointer-events"]="auto",this.pickCanvas=this.container.querySelector(".gl-canvas-pick");var S=this.container;S.appendChild(I),S.appendChild(P);var E=this;P.addEventListener("mouseout",function(){E.isMouseOver=!1,E.unhover()}),P.addEventListener("mouseover",function(){E.isMouseOver=!0})},w.toImage=function(k){k||(k="png"),this.stopped=!0,this.staticPlot&&this.container.appendChild(g),this.updateSize(this.canvas);var L=this.glplot.gl,M=L.drawingBufferWidth,I=L.drawingBufferHeight;L.clearColor(1,1,1,0),L.clear(L.COLOR_BUFFER_BIT|L.DEPTH_BUFFER_BIT),this.glplot.setDirty(),this.glplot.draw(),L.bindFramebuffer(L.FRAMEBUFFER,null);var P=new Uint8Array(M*I*4);L.readPixels(0,0,M,I,L.RGBA,L.UNSIGNED_BYTE,P);for(var S=0,E=I-1;S<E;++S,--E)for(var z=0;z<M;++z)for(var R=0;R<4;++R){var q=P[4*(M*S+z)+R];P[4*(M*S+z)+R]=P[4*(M*E+z)+R],P[4*(M*E+z)+R]=q}var V=document.createElement("canvas");V.width=M,V.height=I;var W,K=V.getContext("2d",{willReadFrequently:!0}),G=K.createImageData(M,I);switch(G.data.set(P),K.putImageData(G,0,0),k){case"jpeg":W=V.toDataURL("image/jpeg");break;case"webp":W=V.toDataURL("image/webp");break;default:W=V.toDataURL("image/png")}return this.staticPlot&&this.container.removeChild(g),W},w.updateSize=function(k){k||(k=this.canvas);var L=this.pixelRatio,M=this.fullLayout,P=M.height,S=0|Math.ceil(L*M.width),E=0|Math.ceil(L*P);return k.width===S&&k.height===E||(k.width=S,k.height=E),k},w.computeTickMarks=function(){this.xaxis.setScale(),this.yaxis.setScale();for(var k=[x.calcTicks(this.xaxis),x.calcTicks(this.yaxis)],L=0;L<2;++L)for(var M=0;M<k[L].length;++M)k[L][M].text=k[L][M].text+"";return k},w.updateRefs=function(k){this.fullLayout=k;var L=this.id.match(T),I="yaxis"+L[2];this.xaxis=this.fullLayout["xaxis"+L[1]],this.yaxis=this.fullLayout[I]},w.relayoutCallback=function(){var k=this.graphDiv,L=this.xaxis,M=this.yaxis,I=k.layout,P={},S=P[L._name+".range"]=L.range.slice(),E=P[M._name+".range"]=M.range.slice();P[L._name+".autorange"]=L.autorange,P[M._name+".autorange"]=M.autorange,m.call("_storeDirectGUIEdit",k.layout,k._fullLayout._preGUI,P);var z=I[L._name];z.range=S,z.autorange=L.autorange;var R=I[M._name];R.range=E,R.autorange=M.autorange,P.lastInputTime=this.camera.lastInputTime,k.emit("plotly_relayout",P)},w.cameraChanged=function(){var k=this.camera;this.glplot.setDataBox(this.calcDataBox());var L=this.computeTickMarks();(function(M,I){for(var P=0;P<2;++P){var S=M[P],E=I[P];if(S.length!==E.length)return!0;for(var z=0;z<S.length;++z)if(S[z].x!==E[z].x)return!0}return!1})(L,this.glplotOptions.ticks)&&(this.glplotOptions.ticks=L,this.glplotOptions.dataBox=k.dataBox,this.glplot.update(this.glplotOptions),this.handleAnnotations())},w.handleAnnotations=function(){for(var k=this.graphDiv,L=this.fullLayout.annotations,M=0;M<L.length;M++){var I=L[M];I.xref===this.xaxis._id&&I.yref===this.yaxis._id&&m.getComponentMethod("annotations","drawOne")(k,M)}},w.destroy=function(){if(this.glplot){var k=this.traces;k&&Object.keys(k).map(function(L){k[L].dispose(),delete k[L]}),this.glplot.dispose(),this.container.removeChild(this.svgContainer),this.container.removeChild(this.mouseContainer),this.fullData=null,this.glplot=null,this.stopped=!0,this.camera.mouseListener.enabled=!1,this.mouseContainer.removeEventListener("wheel",this.camera.wheelListener),this.camera=null}},w.plot=function(k,L,M){var I=this.glplot;this.updateRefs(M),this.xaxis.clearCalc(),this.yaxis.clearCalc(),this.updateTraces(k,L),this.updateFx(M.dragmode);var P=M.width,S=M.height;this.updateSize(this.canvas);var E=this.glplotOptions;E.merge(M),E.screenBox=[0,0,P,S];var z={_fullLayout:{_axisConstraintGroups:M._axisConstraintGroups,xaxis:this.xaxis,yaxis:this.yaxis,_size:M._size}};c(z,this.xaxis),c(z,this.yaxis);var R,q,V=M._size,W=this.xaxis.domain,K=this.yaxis.domain;for(E.viewBox=[V.l+W[0]*V.w,V.b+K[0]*V.h,P-V.r-(1-W[1])*V.w,S-V.t-(1-K[1])*V.h],this.mouseContainer.style.width=V.w*(W[1]-W[0])+"px",this.mouseContainer.style.height=V.h*(K[1]-K[0])+"px",this.mouseContainer.height=V.h*(K[1]-K[0]),this.mouseContainer.style.left=V.l+W[0]*V.w+"px",this.mouseContainer.style.top=V.t+(1-K[1])*V.h+"px",q=0;q<2;++q)(R=this[l[q]])._length=E.viewBox[q+2]-E.viewBox[q],h(this.graphDiv,R),R.setScale();f(z),E.ticks=this.computeTickMarks(),E.dataBox=this.calcDataBox(),E.merge(M),I.update(E),this.glplot.draw()},w.calcDataBox=function(){var k=this.xaxis,L=this.yaxis,M=k.range,I=L.range,P=k.r2l,S=L.r2l;return[P(M[0]),S(I[0]),P(M[1]),S(I[1])]},w.setRanges=function(k){var L=this.xaxis,M=this.yaxis,I=L.l2r,P=M.l2r;L.range=[I(k[0]),I(k[2])],M.range=[P(k[1]),P(k[3])]},w.updateTraces=function(k,L){var M,I,P,S=Object.keys(this.traces);this.fullData=k;e:for(M=0;M<S.length;M++){var E=S[M],z=this.traces[E];for(I=0;I<k.length;I++)if((P=k[I]).uid===E&&P.type===z.type)continue e;z.dispose(),delete this.traces[E]}for(M=0;M<k.length;M++){var R=L[M],q=this.traces[(P=k[M]).uid];q?q.update(P,R):(q=P._module.plot(this,P,R),this.traces[P.uid]=q)}this.glplot.objects.sort(function(V,W){return V._trace.index-W._trace.index})},w.updateFx=function(k){b(k)||o(k)?(this.pickCanvas.style["pointer-events"]="none",this.mouseContainer.style["pointer-events"]="none"):(this.pickCanvas.style["pointer-events"]="auto",this.mouseContainer.style["pointer-events"]="auto"),this.mouseContainer.style.cursor="pan"===k?"move":"zoom"===k?"crosshair":null},w.emitPointAction=function(k,L){for(var M,I=k.trace.uid,P=k.pointIndex,S=0;S<this.fullData.length;S++)this.fullData[S].uid===I&&(M=this.fullData[S]);var E={x:k.traceCoord[0],y:k.traceCoord[1],curveNumber:M.index,pointNumber:P,data:M._input,fullData:this.fullData,xaxis:this.xaxis,yaxis:this.yaxis};e.appendArrayPointValue(E,M,P),this.graphDiv.emit(L,{points:[E]})},w.draw=function(){if(!this.stopped){requestAnimationFrame(this.redraw);var k=this.glplot,L=this.camera,M=L.mouseListener,I=1===this.lastButtonState&&0===M.buttons,P=this.fullLayout;this.lastButtonState=M.buttons,this.cameraChanged();var S,E=M.x*k.pixelRatio,z=this.canvas.height-k.pixelRatio*M.y;if(L.boxEnabled&&"zoom"===P.dragmode){this.selectBox.enabled=!0;for(var R=this.selectBox.selectBox=[Math.min(L.boxStart[0],L.boxEnd[0]),Math.min(L.boxStart[1],L.boxEnd[1]),Math.max(L.boxStart[0],L.boxEnd[0]),Math.max(L.boxStart[1],L.boxEnd[1])],q=0;q<2;q++)L.boxStart[q]===L.boxEnd[q]&&(R[q]=k.dataBox[q],R[q+2]=k.dataBox[q+2]);k.setDirty()}else if(!L.panning&&this.isMouseOver){this.selectBox.enabled=!1;var V=P._size,G=(S=k.pick(E/k.pixelRatio+V.l+this.xaxis.domain[0]*V.w,z/k.pixelRatio-(V.t+(1-this.yaxis.domain[1])*V.h)))&&S.object._trace.handlePick(S);if(G&&I&&this.emitPointAction(G,"plotly_click"),S&&"skip"!==S.object._trace.hoverinfo&&P.hovermode&&G&&(!this.lastPickResult||this.lastPickResult.traceUid!==G.trace.uid||this.lastPickResult.dataCoord[0]!==G.dataCoord[0]||this.lastPickResult.dataCoord[1]!==G.dataCoord[1])){var Y=G;this.lastPickResult={traceUid:G.trace?G.trace.uid:null,dataCoord:G.dataCoord.slice()},this.spikes.update({center:S.dataCoord}),Y.screenCoord=[((k.viewBox[2]-k.viewBox[0])*(S.dataCoord[0]-k.dataBox[0])/(k.dataBox[2]-k.dataBox[0])+k.viewBox[0])/k.pixelRatio,(this.canvas.height-(k.viewBox[3]-k.viewBox[1])*(S.dataCoord[1]-k.dataBox[1])/(k.dataBox[3]-k.dataBox[1])-k.viewBox[1])/k.pixelRatio],this.emitPointAction(G,"plotly_hover");var $=this.fullData[Y.trace.index]||{},B=Y.pointIndex,N=e.castHoverinfo($,P,B);if(N&&"all"!==N){var U=N.split("+");-1===U.indexOf("x")&&(Y.traceCoord[0]=void 0),-1===U.indexOf("y")&&(Y.traceCoord[1]=void 0),-1===U.indexOf("z")&&(Y.traceCoord[2]=void 0),-1===U.indexOf("text")&&(Y.textLabel=void 0),-1===U.indexOf("name")&&(Y.name=void 0)}e.loneHover({x:Y.screenCoord[0],y:Y.screenCoord[1],xLabel:this.hoverFormatter("xaxis",Y.traceCoord[0]),yLabel:this.hoverFormatter("yaxis",Y.traceCoord[1]),zLabel:Y.traceCoord[2],text:Y.textLabel,name:Y.name,color:e.castHoverOption($,B,"bgcolor")||Y.color,borderColor:e.castHoverOption($,B,"bordercolor"),fontFamily:e.castHoverOption($,B,"font.family"),fontSize:e.castHoverOption($,B,"font.size"),fontColor:e.castHoverOption($,B,"font.color"),nameLength:e.castHoverOption($,B,"namelength"),textAlign:e.castHoverOption($,B,"align")},{container:this.svgContainer,gd:this.graphDiv})}}S||this.unhover(),k.draw()}},w.unhover=function(){this.lastPickResult&&(this.spikes.update({}),this.lastPickResult=null,this.graphDiv.emit("plotly_unhover"),e.loneUnhover(this.svgContainer))},w.hoverFormatter=function(k,L){if(void 0!==L){var M=this[k];return x.tickText(M,M.c2l(L),"hover").text}}},{"../../../stackgl_modules":1133,"../../components/dragelement/helpers":385,"../../components/fx":407,"../../lib/show_no_webgl_msg":537,"../../plots/cartesian/axes":566,"../../registry":647,"../cartesian/autorange":565,"../cartesian/constants":573,"../cartesian/constraints":574,"./camera":603,"./convert":604,"webgl-context":332}],607:[function(y,ee,Q){"use strict";var g=y("../../plot_api/edit_types").overrideAll,v=y("../../components/fx/layout_attributes"),m=y("./scene"),x=y("../get_data").getSubplotData,e=y("../../lib"),n=y("../../constants/xmlns_namespaces");Q.name="gl3d",Q.attr="scene",Q.idRoot="scene",Q.idRegex=Q.attrRegex=e.counterRegex("scene"),Q.attributes=y("./layout/attributes"),Q.layoutAttributes=y("./layout/layout_attributes"),Q.baseLayoutAttrOverrides=g({hoverlabel:v.hoverlabel},"plot","nested"),Q.supplyLayoutDefaults=y("./layout/defaults"),Q.plot=function(t){for(var a=t._fullLayout,r=t._fullData,d=a._subplots.gl3d,s=0;s<d.length;s++){var i=d[s],u=x(r,"gl3d",i),f=a[i],c=f.camera,h=f._scene;h||(h=new m({id:i,graphDiv:t,container:t.querySelector(".gl-container"),staticPlot:t._context.staticPlot,plotGlPixelRatio:t._context.plotGlPixelRatio,camera:c},a),f._scene=h),h.viewInitial||(h.viewInitial={up:{x:c.up.x,y:c.up.y,z:c.up.z},eye:{x:c.eye.x,y:c.eye.y,z:c.eye.z},center:{x:c.center.x,y:c.center.y,z:c.center.z}}),h.plot(u,a,t.layout)}},Q.clean=function(t,a,r,d){for(var s=d._subplots.gl3d||[],i=0;i<s.length;i++){var u=s[i];!a[u]&&d[u]._scene&&(d[u]._scene.destroy(),d._infolayer&&d._infolayer.selectAll(".annotation-"+u).remove())}},Q.toSVG=function(t){for(var a=t._fullLayout,r=a._subplots.gl3d,d=a._size,s=0;s<r.length;s++){var i=a[r[s]],u=i.domain,f=i._scene,c=f.toImage("png");a._glimages.append("svg:image").attr({xmlns:n.svg,"xlink:href":c,x:d.l+d.w*u.x[0],y:d.t+d.h*(1-u.y[1]),width:d.w*(u.x[1]-u.x[0]),height:d.h*(u.y[1]-u.y[0]),preserveAspectRatio:"none"}),f.destroy()}},Q.cleanId=function(t){if(t.match(/^scene[0-9]*$/)){var a=t.substr(5);return"1"===a&&(a=""),"scene"+a}},Q.updateFx=function(t){for(var a=t._fullLayout,r=a._subplots.gl3d,d=0;d<r.length;d++)a[r[d]]._scene.updateFx(a.dragmode,a.hovermode)}},{"../../components/fx/layout_attributes":408,"../../constants/xmlns_namespaces":492,"../../lib":515,"../../plot_api/edit_types":548,"../get_data":602,"./layout/attributes":608,"./layout/defaults":612,"./layout/layout_attributes":613,"./scene":617}],608:[function(y,ee,Q){"use strict";ee.exports={scene:{valType:"subplotid",dflt:"scene",editType:"calc+clearAxisTypes"}}},{}],609:[function(y,ee,Q){"use strict";var g=y("../../../components/color"),v=y("../../cartesian/layout_attributes"),m=y("../../../lib/extend").extendFlat,x=y("../../../plot_api/edit_types").overrideAll;ee.exports=x({visible:v.visible,showspikes:{valType:"boolean",dflt:!0},spikesides:{valType:"boolean",dflt:!0},spikethickness:{valType:"number",min:0,dflt:2},spikecolor:{valType:"color",dflt:g.defaultLine},showbackground:{valType:"boolean",dflt:!1},backgroundcolor:{valType:"color",dflt:"rgba(204, 204, 204, 0.5)"},showaxeslabels:{valType:"boolean",dflt:!0},color:v.color,categoryorder:v.categoryorder,categoryarray:v.categoryarray,title:{text:v.title.text,font:v.title.font},type:m({},v.type,{values:["-","linear","log","date","category"]}),autotypenumbers:v.autotypenumbers,autorange:v.autorange,rangemode:v.rangemode,range:m({},v.range,{items:[{valType:"any",editType:"plot",impliedEdits:{"^autorange":!1}},{valType:"any",editType:"plot",impliedEdits:{"^autorange":!1}}],anim:!1}),tickmode:v.tickmode,nticks:v.nticks,tick0:v.tick0,dtick:v.dtick,tickvals:v.tickvals,ticktext:v.ticktext,ticks:v.ticks,mirror:v.mirror,ticklen:v.ticklen,tickwidth:v.tickwidth,tickcolor:v.tickcolor,showticklabels:v.showticklabels,tickfont:v.tickfont,tickangle:v.tickangle,tickprefix:v.tickprefix,showtickprefix:v.showtickprefix,ticksuffix:v.ticksuffix,showticksuffix:v.showticksuffix,showexponent:v.showexponent,exponentformat:v.exponentformat,minexponent:v.minexponent,separatethousands:v.separatethousands,tickformat:v.tickformat,tickformatstops:v.tickformatstops,hoverformat:v.hoverformat,showline:v.showline,linecolor:v.linecolor,linewidth:v.linewidth,showgrid:v.showgrid,gridcolor:m({},v.gridcolor,{dflt:"rgb(204, 204, 204)"}),gridwidth:v.gridwidth,zeroline:v.zeroline,zerolinecolor:v.zerolinecolor,zerolinewidth:v.zerolinewidth,_deprecated:{title:v._deprecated.title,titlefont:v._deprecated.titlefont}},"plot","from-root")},{"../../../components/color":367,"../../../lib/extend":505,"../../../plot_api/edit_types":548,"../../cartesian/layout_attributes":579}],610:[function(y,ee,Q){"use strict";var g=y("tinycolor2").mix,v=y("../../../lib"),m=y("../../../plot_api/plot_template"),x=y("./axis_attributes"),e=y("../../cartesian/type_defaults"),n=y("../../cartesian/axis_defaults"),t=["xaxis","yaxis","zaxis"];ee.exports=function(a,r,d){var s,i;function u(h,p){return v.coerce(s,i,x,h,p)}for(var f=0;f<t.length;f++){var c=t[f];s=a[c]||{},(i=m.newContainer(r,c))._id=c[0]+d.scene,i._name=c,e(s,i,u,d),n(s,i,u,{font:d.font,letter:c[0],data:d.data,showGrid:!0,noTickson:!0,noTicklabelmode:!0,noTicklabelstep:!0,noTicklabelposition:!0,noTicklabeloverflow:!0,bgColor:d.bgColor,calendar:d.calendar},d.fullLayout),u("gridcolor",g(i.color,d.bgColor,13600/187).toRgbString()),u("title.text",c[0]),i.setScale=v.noop,u("showspikes")&&(u("spikesides"),u("spikethickness"),u("spikecolor",i.color)),u("showaxeslabels"),u("showbackground")&&u("backgroundcolor")}}},{"../../../lib":515,"../../../plot_api/plot_template":555,"../../cartesian/axis_defaults":568,"../../cartesian/type_defaults":591,"./axis_attributes":609,tinycolor2:313}],611:[function(y,ee,Q){"use strict";var g=y("../../../lib/str2rgbarray"),v=y("../../../lib"),m=["xaxis","yaxis","zaxis"];function x(){this.bounds=[[-10,-10,-10],[10,10,10]],this.ticks=[[],[],[]],this.tickEnable=[!0,!0,!0],this.tickFont=["sans-serif","sans-serif","sans-serif"],this.tickSize=[12,12,12],this.tickAngle=[0,0,0],this.tickColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.tickPad=[18,18,18],this.labels=["x","y","z"],this.labelEnable=[!0,!0,!0],this.labelFont=["Open Sans","Open Sans","Open Sans"],this.labelSize=[20,20,20],this.labelColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.labelPad=[30,30,30],this.lineEnable=[!0,!0,!0],this.lineMirror=[!1,!1,!1],this.lineWidth=[1,1,1],this.lineColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.lineTickEnable=[!0,!0,!0],this.lineTickMirror=[!1,!1,!1],this.lineTickLength=[10,10,10],this.lineTickWidth=[1,1,1],this.lineTickColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.gridEnable=[!0,!0,!0],this.gridWidth=[1,1,1],this.gridColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.zeroEnable=[!0,!0,!0],this.zeroLineColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.zeroLineWidth=[2,2,2],this.backgroundEnable=[!0,!0,!0],this.backgroundColor=[[.8,.8,.8,.5],[.8,.8,.8,.5],[.8,.8,.8,.5]],this._defaultTickPad=this.tickPad.slice(),this._defaultLabelPad=this.labelPad.slice(),this._defaultLineTickLength=this.lineTickLength.slice()}x.prototype.merge=function(e,n){for(var t=0;t<3;++t){var a=n[m[t]];a.visible?(this.labels[t]=e._meta?v.templateString(a.title.text,e._meta):a.title.text,"font"in a.title&&(a.title.font.color&&(this.labelColor[t]=g(a.title.font.color)),a.title.font.family&&(this.labelFont[t]=a.title.font.family),a.title.font.size&&(this.labelSize[t]=a.title.font.size)),"showline"in a&&(this.lineEnable[t]=a.showline),"linecolor"in a&&(this.lineColor[t]=g(a.linecolor)),"linewidth"in a&&(this.lineWidth[t]=a.linewidth),"showgrid"in a&&(this.gridEnable[t]=a.showgrid),"gridcolor"in a&&(this.gridColor[t]=g(a.gridcolor)),"gridwidth"in a&&(this.gridWidth[t]=a.gridwidth),"log"===a.type?this.zeroEnable[t]=!1:"zeroline"in a&&(this.zeroEnable[t]=a.zeroline),"zerolinecolor"in a&&(this.zeroLineColor[t]=g(a.zerolinecolor)),"zerolinewidth"in a&&(this.zeroLineWidth[t]=a.zerolinewidth),this.lineTickEnable[t]=!(!("ticks"in a)||!a.ticks),"ticklen"in a&&(this.lineTickLength[t]=this._defaultLineTickLength[t]=a.ticklen),"tickcolor"in a&&(this.lineTickColor[t]=g(a.tickcolor)),"tickwidth"in a&&(this.lineTickWidth[t]=a.tickwidth),"tickangle"in a&&(this.tickAngle[t]="auto"===a.tickangle?-3600:Math.PI*-a.tickangle/180),"showticklabels"in a&&(this.tickEnable[t]=a.showticklabels),"tickfont"in a&&(a.tickfont.color&&(this.tickColor[t]=g(a.tickfont.color)),a.tickfont.family&&(this.tickFont[t]=a.tickfont.family),a.tickfont.size&&(this.tickSize[t]=a.tickfont.size)),"mirror"in a?-1!==["ticks","all","allticks"].indexOf(a.mirror)?(this.lineTickMirror[t]=!0,this.lineMirror[t]=!0):!0===a.mirror?(this.lineTickMirror[t]=!1,this.lineMirror[t]=!0):(this.lineTickMirror[t]=!1,this.lineMirror[t]=!1):this.lineMirror[t]=!1,"showbackground"in a&&!1!==a.showbackground?(this.backgroundEnable[t]=!0,this.backgroundColor[t]=g(a.backgroundcolor)):this.backgroundEnable[t]=!1):(this.tickEnable[t]=!1,this.labelEnable[t]=!1,this.lineEnable[t]=!1,this.lineTickEnable[t]=!1,this.gridEnable[t]=!1,this.zeroEnable[t]=!1,this.backgroundEnable[t]=!1)}},ee.exports=function(e,n){var t=new x;return t.merge(e,n),t}},{"../../../lib":515,"../../../lib/str2rgbarray":540}],612:[function(y,ee,Q){"use strict";var g=y("../../../lib"),v=y("../../../components/color"),m=y("../../../registry"),x=y("../../subplot_defaults"),e=y("./axis_defaults"),n=y("./layout_attributes"),t=y("../../get_data").getSubplotData;function a(r,d,s,i){for(var u=s("bgcolor"),f=v.combine(u,i.paper_bgcolor),c=["up","center","eye"],h=0;h<c.length;h++)s("camera."+c[h]+".x"),s("camera."+c[h]+".y"),s("camera."+c[h]+".z");s("camera.projection.type");var p=!!s("aspectratio.x")&&!!s("aspectratio.y")&&!!s("aspectratio.z"),o=s("aspectmode",p?"manual":"auto");p||(r.aspectratio=d.aspectratio={x:1,y:1,z:1},"manual"===o&&(d.aspectmode="auto"),r.aspectmode=d.aspectmode);var b=t(i.fullData,"gl3d",i.id);e(r,d,{font:i.font,scene:i.id,data:b,bgColor:f,calendar:i.calendar,autotypenumbersDflt:i.autotypenumbersDflt,fullLayout:i.fullLayout}),m.getComponentMethod("annotations3d","handleDefaults")(r,d,i);var l=i.getDfltFromLayout("dragmode");if(!1!==l&&!l)if(l="orbit",r.camera&&r.camera.up){var T=r.camera.up.x,_=r.camera.up.y,w=r.camera.up.z;0!==w&&(T&&_&&w?w/Math.sqrt(T*T+_*_+w*w)>.999&&(l="turntable"):l="turntable")}else l="turntable";s("dragmode",l),s("hovermode",i.getDfltFromLayout("hovermode"))}ee.exports=function(r,d,s){var i=d._basePlotModules.length>1;x(r,d,s,{type:"gl3d",attributes:n,handleDefaults:a,fullLayout:d,font:d.font,fullData:s,getDfltFromLayout:function(u){if(!i)return g.validate(r[u],n[u])?r[u]:void 0},autotypenumbersDflt:d.autotypenumbers,paper_bgcolor:d.paper_bgcolor,calendar:d.calendar})}},{"../../../components/color":367,"../../../lib":515,"../../../registry":647,"../../get_data":602,"../../subplot_defaults":641,"./axis_defaults":610,"./layout_attributes":613}],613:[function(y,ee,Q){"use strict";var g=y("./axis_attributes"),v=y("../../domain").attributes,m=y("../../../lib/extend").extendFlat,x=y("../../../lib").counterRegex;function e(n,t,a){return{x:{valType:"number",dflt:n,editType:"camera"},y:{valType:"number",dflt:t,editType:"camera"},z:{valType:"number",dflt:a,editType:"camera"},editType:"camera"}}ee.exports={_arrayAttrRegexps:[x("scene",".annotations",!0)],bgcolor:{valType:"color",dflt:"rgba(0,0,0,0)",editType:"plot"},camera:{up:m(e(0,0,1),{}),center:m(e(0,0,0),{}),eye:m(e(1.25,1.25,1.25),{}),projection:{type:{valType:"enumerated",values:["perspective","orthographic"],dflt:"perspective",editType:"calc"},editType:"calc"},editType:"camera"},domain:v({name:"scene",editType:"plot"}),aspectmode:{valType:"enumerated",values:["auto","cube","data","manual"],dflt:"auto",editType:"plot",impliedEdits:{"aspectratio.x":void 0,"aspectratio.y":void 0,"aspectratio.z":void 0}},aspectratio:{x:{valType:"number",min:0,editType:"plot",impliedEdits:{"^aspectmode":"manual"}},y:{valType:"number",min:0,editType:"plot",impliedEdits:{"^aspectmode":"manual"}},z:{valType:"number",min:0,editType:"plot",impliedEdits:{"^aspectmode":"manual"}},editType:"plot",impliedEdits:{aspectmode:"manual"}},xaxis:g,yaxis:g,zaxis:g,dragmode:{valType:"enumerated",values:["orbit","turntable","zoom","pan",!1],editType:"plot"},hovermode:{valType:"enumerated",values:["closest",!1],dflt:"closest",editType:"modebar"},uirevision:{valType:"any",editType:"none"},editType:"plot",_deprecated:{cameraposition:{valType:"info_array",editType:"camera"}}}},{"../../../lib":515,"../../../lib/extend":505,"../../domain":593,"./axis_attributes":609}],614:[function(y,ee,Q){"use strict";var g=y("../../../lib/str2rgbarray"),v=["xaxis","yaxis","zaxis"];function m(){this.enabled=[!0,!0,!0],this.colors=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.drawSides=[!0,!0,!0],this.lineWidth=[1,1,1]}m.prototype.merge=function(x){for(var e=0;e<3;++e){var n=x[v[e]];n.visible?(this.enabled[e]=n.showspikes,this.colors[e]=g(n.spikecolor),this.drawSides[e]=n.spikesides,this.lineWidth[e]=n.spikethickness):(this.enabled[e]=!1,this.drawSides[e]=!1)}},ee.exports=function(x){var e=new m;return e.merge(x),e}},{"../../../lib/str2rgbarray":540}],615:[function(y,ee,Q){"use strict";ee.exports=function(e){for(var n=e.axesOptions,t=e.glplot.axesPixels,a=e.fullSceneLayout,r=[[],[],[]],d=0;d<3;++d){var s=a[m[d]];if(s._length=(t[d].hi-t[d].lo)*t[d].pixelsPerDataUnit/e.dataScale[d],Math.abs(s._length)===1/0||isNaN(s._length))r[d]=[];else{s._input_range=s.range.slice(),s.range[0]=t[d].lo/e.dataScale[d],s.range[1]=t[d].hi/e.dataScale[d],s._m=1/(e.dataScale[d]*t[d].pixelsPerDataUnit),s.range[0]===s.range[1]&&(s.range[0]-=1,s.range[1]+=1);var i=s.tickmode;if("auto"===s.tickmode){s.tickmode="linear";var u=s.nticks||v.constrain(s._length/40,4,9);g.autoTicks(s,Math.abs(s.range[1]-s.range[0])/u)}for(var f=g.calcTicks(s,{msUTC:!0}),c=0;c<f.length;++c)f[c].x=f[c].x*e.dataScale[d],"date"===s.type&&(f[c].text=f[c].text.replace(/\<br\>/g," "));r[d]=f,s.tickmode=i}}for(n.ticks=r,d=0;d<3;++d)for(x[d]=.5*(e.glplot.bounds[0][d]+e.glplot.bounds[1][d]),c=0;c<2;++c)n.bounds[c][d]=e.glplot.bounds[c][d];e.contourLevels=function(h){for(var p=new Array(3),o=0;o<3;++o){for(var b=h[o],l=new Array(b.length),T=0;T<b.length;++T)l[T]=b[T].x;p[o]=l}return p}(r)};var g=y("../../cartesian/axes"),v=y("../../../lib"),m=["xaxis","yaxis","zaxis"],x=[0,0,0]},{"../../../lib":515,"../../cartesian/axes":566}],616:[function(y,ee,Q){"use strict";function g(v,m){var x,e,n=[0,0,0,0];for(x=0;x<4;++x)for(e=0;e<4;++e)n[e]+=v[4*x+e]*m[x];return n}ee.exports=function(v,m){return g(v.projection,g(v.view,g(v.model,[m[0],m[1],m[2],1])))}},{}],617:[function(y,ee,Q){"use strict";var g,v,m=y("../../../stackgl_modules").gl_plot3d,x=m.createCamera,e=m.createScene,n=y("webgl-context"),t=y("has-passive-events"),a=y("../../registry"),r=y("../../lib"),d=r.preserveDrawingBuffer(),s=y("../../plots/cartesian/axes"),i=y("../../components/fx"),u=y("../../lib/str2rgbarray"),f=y("../../lib/show_no_webgl_msg"),c=y("./project"),h=y("./layout/convert"),p=y("./layout/spikes"),o=y("./layout/tick_marks");function b(k,L){var M=document.createElement("div"),I=k.container;this.graphDiv=k.graphDiv;var P=document.createElementNS("http://www.w3.org/2000/svg","svg");P.style.position="absolute",P.style.top=P.style.left="0px",P.style.width=P.style.height="100%",P.style["z-index"]=20,P.style["pointer-events"]="none",M.appendChild(P),this.svgContainer=P,M.id=k.id,M.style.position="absolute",M.style.top=M.style.left="0px",M.style.width=M.style.height="100%",I.appendChild(M),this.fullLayout=L,this.id=k.id||"scene",this.fullSceneLayout=L[this.id],this.plotArgs=[[],{},{}],this.axesOptions=h(L,L[this.id]),this.spikeOptions=p(L[this.id]),this.container=M,this.staticMode=!!k.staticPlot,this.pixelRatio=this.pixelRatio||k.plotGlPixelRatio||2,this.dataScale=[1,1,1],this.contourLevels=[[],[],[]],this.convertAnnotations=a.getComponentMethod("annotations3d","convert"),this.drawAnnotations=a.getComponentMethod("annotations3d","draw"),this.initializeGLPlot()}var l=b.prototype;l.prepareOptions=function(){var k={canvas:this.canvas,gl:this.gl,glOptions:{preserveDrawingBuffer:d,premultipliedAlpha:!0,antialias:!0},container:this.container,axes:this.axesOptions,spikes:this.spikeOptions,pickRadius:10,snapToData:!0,autoScale:!0,autoBounds:!1,cameraObject:this.camera,pixelRatio:this.pixelRatio};if(this.staticMode){if(!(v||(g=document.createElement("canvas"),v=n({canvas:g,preserveDrawingBuffer:!0,premultipliedAlpha:!0,antialias:!0}))))throw new Error("error creating static canvas/context for image server");k.gl=v,k.canvas=g}return k};var T=!0;l.tryCreatePlot=function(){var k=this.prepareOptions(),L=!0;try{this.glplot=e(k)}catch{if(this.staticMode||!T||d)L=!1;else{r.warn(["webgl setup failed possibly due to","false preserveDrawingBuffer config.","The mobile/tablet device may not be detected by is-mobile module.","Enabling preserveDrawingBuffer in second attempt to create webgl scene..."].join(" "));try{d=k.glOptions.preserveDrawingBuffer=!0,this.glplot=e(k)}catch{d=k.glOptions.preserveDrawingBuffer=!1,L=!1}}}return T=!1,L},l.initializeGLCamera=function(){var k=this.fullSceneLayout.camera;this.camera=x(this.container,{center:[k.center.x,k.center.y,k.center.z],eye:[k.eye.x,k.eye.y,k.eye.z],up:[k.up.x,k.up.y,k.up.z],_ortho:"orthographic"===k.projection.type,zoomMin:.01,zoomMax:100,mode:"orbit"})},l.initializeGLPlot=function(){var k=this;if(k.initializeGLCamera(),!k.tryCreatePlot())return f(k);k.traces={},k.make4thDimension();var L=k.graphDiv,M=L.layout,I=function(){var S={};return k.isCameraChanged(M)&&(S[k.id+".camera"]=k.getCamera()),k.isAspectChanged(M)&&(S[k.id+".aspectratio"]=k.glplot.getAspectratio(),"manual"!==M[k.id].aspectmode&&(k.fullSceneLayout.aspectmode=M[k.id].aspectmode=S[k.id+".aspectmode"]="manual")),S},P=function(S){if(!1!==S.fullSceneLayout.dragmode){var E=I();S.saveLayout(M),S.graphDiv.emit("plotly_relayout",E)}};return k.glplot.canvas&&(k.glplot.canvas.addEventListener("mouseup",function(){P(k)}),k.glplot.canvas.addEventListener("wheel",function(S){if(L._context._scrollZoom.gl3d){if(k.camera._ortho){var E=S.deltaX>S.deltaY?1.1:.9090909090909091,z=k.glplot.getAspectratio();k.glplot.setAspectratio({x:E*z.x,y:E*z.y,z:E*z.z})}P(k)}},!!t&&{passive:!1}),k.glplot.canvas.addEventListener("mousemove",function(){if(!1!==k.fullSceneLayout.dragmode&&0!==k.camera.mouseListener.buttons){var S=I();k.graphDiv.emit("plotly_relayouting",S)}}),k.staticMode||k.glplot.canvas.addEventListener("webglcontextlost",function(S){L&&L.emit&&L.emit("plotly_webglcontextlost",{event:S,layer:k.id})},!1)),k.glplot.oncontextloss=function(){k.recoverContext()},k.glplot.onrender=function(){k.render()},!0},l.render=function(){var k,L=this,M=L.graphDiv,I=L.svgContainer,P=L.container.getBoundingClientRect();M._fullLayout._calcInverseTransform(M);var z=P.width*M._fullLayout._invScaleX,R=P.height*M._fullLayout._invScaleY;I.setAttributeNS(null,"viewBox","0 0 "+z+" "+R),I.setAttributeNS(null,"width",z),I.setAttributeNS(null,"height",R),o(L),L.glplot.axes.update(L.axesOptions);for(var q=Object.keys(L.traces),V=null,W=L.glplot.selection,K=0;K<q.length;++K)"skip"!==(k=L.traces[q[K]]).data.hoverinfo&&k.handlePick(W)&&(V=k),k.setContourLevels&&k.setContourLevels();function G(oe,de,se){var ge=L.fullSceneLayout[oe+"axis"];return"log"!==ge.type&&(de=ge.d2l(de)),s.hoverLabelText(ge,de,se)}if(null!==V){var $,Y=c(L.glplot.cameraParams,W.dataCoordinate),B=M._fullData[(k=V.data).index],N=W.index,U={xLabel:G("x",W.traceCoordinate[0],k.xhoverformat),yLabel:G("y",W.traceCoordinate[1],k.yhoverformat),zLabel:G("z",W.traceCoordinate[2],k.zhoverformat)},te=i.castHoverinfo(B,L.fullLayout,N),j=(te||"").split("+"),J=te&&"all"===te;B.hovertemplate||J||(-1===j.indexOf("x")&&(U.xLabel=void 0),-1===j.indexOf("y")&&(U.yLabel=void 0),-1===j.indexOf("z")&&(U.zLabel=void 0),-1===j.indexOf("text")&&(W.textLabel=void 0),-1===j.indexOf("name")&&(V.name=void 0));var X=[];"cone"===k.type||"streamtube"===k.type?(U.uLabel=G("x",W.traceCoordinate[3],k.uhoverformat),(J||-1!==j.indexOf("u"))&&X.push("u: "+U.uLabel),U.vLabel=G("y",W.traceCoordinate[4],k.vhoverformat),(J||-1!==j.indexOf("v"))&&X.push("v: "+U.vLabel),U.wLabel=G("z",W.traceCoordinate[5],k.whoverformat),(J||-1!==j.indexOf("w"))&&X.push("w: "+U.wLabel),U.normLabel=W.traceCoordinate[6].toPrecision(3),(J||-1!==j.indexOf("norm"))&&X.push("norm: "+U.normLabel),"streamtube"===k.type&&(U.divergenceLabel=W.traceCoordinate[7].toPrecision(3),(J||-1!==j.indexOf("divergence"))&&X.push("divergence: "+U.divergenceLabel)),W.textLabel&&X.push(W.textLabel),$=X.join("<br>")):"isosurface"===k.type||"volume"===k.type?(U.valueLabel=s.hoverLabelText(L._mockAxis,L._mockAxis.d2l(W.traceCoordinate[3]),k.valuehoverformat),X.push("value: "+U.valueLabel),W.textLabel&&X.push(W.textLabel),$=X.join("<br>")):$=W.textLabel;var re={x:W.traceCoordinate[0],y:W.traceCoordinate[1],z:W.traceCoordinate[2],data:B._input,fullData:B,curveNumber:B.index,pointNumber:N};i.appendArrayPointValue(re,B,N),k._module.eventData&&(re=B._module.eventData(re,W,B,{},N));var ne={points:[re]};if(L.fullSceneLayout.hovermode){var le=[];i.loneHover({trace:B,x:(.5+.5*Y[0]/Y[3])*z,y:(.5-.5*Y[1]/Y[3])*R,xLabel:U.xLabel,yLabel:U.yLabel,zLabel:U.zLabel,text:$,name:V.name,color:i.castHoverOption(B,N,"bgcolor")||V.color,borderColor:i.castHoverOption(B,N,"bordercolor"),fontFamily:i.castHoverOption(B,N,"font.family"),fontSize:i.castHoverOption(B,N,"font.size"),fontColor:i.castHoverOption(B,N,"font.color"),nameLength:i.castHoverOption(B,N,"namelength"),textAlign:i.castHoverOption(B,N,"align"),hovertemplate:r.castOption(B,N,"hovertemplate"),hovertemplateLabels:r.extendFlat({},re,U),eventData:[re]},{container:I,gd:M,inOut_bbox:le}),re.bbox=le[0]}M.emit(W.buttons&&W.distance<5?"plotly_click":"plotly_hover",ne),this.oldEventData=ne}else i.loneUnhover(I),this.oldEventData&&M.emit("plotly_unhover",this.oldEventData),this.oldEventData=void 0;L.drawAnnotations(L)},l.recoverContext=function(){var k=this;k.glplot.dispose();var L=function(){k.glplot.gl.isContextLost()?requestAnimationFrame(L):k.initializeGLPlot()?k.plot.apply(k,k.plotArgs):r.error("Catastrophic and unrecoverable WebGL error. Context lost.")};requestAnimationFrame(L)};var _=["xaxis","yaxis","zaxis"];function w(k,L,M){for(var I=k.fullSceneLayout,P=0;P<3;P++){var S=_[P],E=S.charAt(0),z=I[S],R=L[E],q=L[E+"calendar"],V=L["_"+E+"length"];if(r.isArrayOrTypedArray(R))for(var W,K=0;K<(V||R.length);K++)if(r.isArrayOrTypedArray(R[K]))for(var G=0;G<R[K].length;++G)W=z.d2l(R[K][G],0,q),!isNaN(W)&&isFinite(W)&&(M[0][P]=Math.min(M[0][P],W),M[1][P]=Math.max(M[1][P],W));else W=z.d2l(R[K],0,q),!isNaN(W)&&isFinite(W)&&(M[0][P]=Math.min(M[0][P],W),M[1][P]=Math.max(M[1][P],W));else M[0][P]=Math.min(M[0][P],0),M[1][P]=Math.max(M[1][P],V-1)}}l.plot=function(k,L,M){if(this.plotArgs=[k,L,M],!this.glplot.contextLost){var I,P,S,E,z,R,q=L[this.id],V=M[this.id];this.fullLayout=L,this.fullSceneLayout=q,this.axesOptions.merge(L,q),this.spikeOptions.merge(q),this.setViewport(q),this.updateFx(q.dragmode,q.hovermode),this.camera.enableWheel=this.graphDiv._context._scrollZoom.gl3d,this.glplot.setClearColor(u(q.bgcolor)),this.setConvert(z),k?Array.isArray(k)||(k=[k]):k=[];var W=[[1/0,1/0,1/0],[-1/0,-1/0,-1/0]];for(S=0;S<k.length;++S)!0===(I=k[S]).visible&&0!==I._length&&w(this,I,W);!function(Ae,ke){for(var Pe=Ae.fullSceneLayout,Ne=Pe.annotations||[],De=0;De<3;De++)for(var ze=_[De],Me=ze.charAt(0),Se=Pe[ze],Ie=0;Ie<Ne.length;Ie++){var Fe=Ne[Ie];if(Fe.visible){var Re=Se.r2l(Fe[Me]);!isNaN(Re)&&isFinite(Re)&&(ke[0][De]=Math.min(ke[0][De],Re),ke[1][De]=Math.max(ke[1][De],Re))}}}(this,W);var K=[1,1,1];for(E=0;E<3;++E)K[E]=W[1][E]===W[0][E]?1:1/(W[1][E]-W[0][E]);for(this.dataScale=K,this.convertAnnotations(this),S=0;S<k.length;++S)!0===(I=k[S]).visible&&0!==I._length&&((P=this.traces[I.uid])?P.data.type===I.type?P.update(I):(P.dispose(),P=I._module.plot(this,I),this.traces[I.uid]=P):(P=I._module.plot(this,I),this.traces[I.uid]=P),P.name=I.name);var G=Object.keys(this.traces);e:for(S=0;S<G.length;++S){for(E=0;E<k.length;++E)if(k[E].uid===G[S]&&!0===k[E].visible&&0!==k[E]._length)continue e;(P=this.traces[G[S]]).dispose(),delete this.traces[G[S]]}this.glplot.objects.sort(function(Ae,ke){return Ae._trace.data.index-ke._trace.data.index});var Y,$=[[0,0,0],[0,0,0]],B=[],N={};for(S=0;S<3;++S){if((R=(z=q[_[S]]).type)in N?(N[R].acc*=K[S],N[R].count+=1):N[R]={acc:K[S],count:1},z.autorange){$[0][S]=1/0,$[1][S]=-1/0;var U=this.glplot.objects,te=this.fullSceneLayout.annotations||[],j=z._name.charAt(0);for(E=0;E<U.length;E++){var J=U[E],X=J.bounds,re=J._trace.data._pad||0;$[0][S]="ErrorBars"===J.constructor.name&&z._lowerLogErrorBound?Math.min($[0][S],z._lowerLogErrorBound):Math.min($[0][S],X[0][S]/K[S]-re),$[1][S]=Math.max($[1][S],X[1][S]/K[S]+re)}for(E=0;E<te.length;E++){var ne=te[E];if(ne.visible){var le=z.r2l(ne[j]);$[0][S]=Math.min($[0][S],le),$[1][S]=Math.max($[1][S],le)}}if("rangemode"in z&&"tozero"===z.rangemode&&($[0][S]=Math.min($[0][S],0),$[1][S]=Math.max($[1][S],0)),$[0][S]>$[1][S])$[0][S]=-1,$[1][S]=1;else{var oe=$[1][S]-$[0][S];$[0][S]-=oe/32,$[1][S]+=oe/32}if("reversed"===z.autorange){var de=$[0][S];$[0][S]=$[1][S],$[1][S]=de}}else{var se=z.range;$[0][S]=z.r2l(se[0]),$[1][S]=z.r2l(se[1])}$[0][S]===$[1][S]&&($[0][S]-=1,$[1][S]+=1),B[S]=$[1][S]-$[0][S],this.glplot.setBounds(S,{min:$[0][S]*K[S],max:$[1][S]*K[S]})}var ge=q.aspectmode;if("cube"===ge)Y=[1,1,1];else if("manual"===ge){var _e=q.aspectratio;Y=[_e.x,_e.y,_e.z]}else{if("auto"!==ge&&"data"!==ge)throw new Error("scene.js aspectRatio was not one of the enumerated types");var Te=[1,1,1];for(S=0;S<3;++S){var we=N[R=(z=q[_[S]]).type];Te[S]=Math.pow(we.acc,1/we.count)/K[S]}Y="data"===ge||Math.max.apply(null,Te)/Math.min.apply(null,Te)<=4?Te:[1,1,1]}q.aspectratio.x=V.aspectratio.x=Y[0],q.aspectratio.y=V.aspectratio.y=Y[1],q.aspectratio.z=V.aspectratio.z=Y[2],this.glplot.setAspectratio(q.aspectratio),this.viewInitial.aspectratio||(this.viewInitial.aspectratio={x:q.aspectratio.x,y:q.aspectratio.y,z:q.aspectratio.z}),this.viewInitial.aspectmode||(this.viewInitial.aspectmode=q.aspectmode);var Oe=q.domain||null,fe=L._size||null;if(Oe&&fe){var ve=this.container.style;ve.position="absolute",ve.left=fe.l+Oe.x[0]*fe.w+"px",ve.top=fe.t+(1-Oe.y[1])*fe.h+"px",ve.width=fe.w*(Oe.x[1]-Oe.x[0])+"px",ve.height=fe.h*(Oe.y[1]-Oe.y[0])+"px"}this.glplot.redraw()}},l.destroy=function(){this.glplot&&(this.camera.mouseListener.enabled=!1,this.container.removeEventListener("wheel",this.camera.wheelListener),this.camera=null,this.glplot.dispose(),this.container.parentNode.removeChild(this.container),this.glplot=null)},l.getCamera=function(){var k;return this.camera.view.recalcMatrix(this.camera.view.lastT()),{up:{x:(k=this.camera).up[0],y:k.up[1],z:k.up[2]},center:{x:k.center[0],y:k.center[1],z:k.center[2]},eye:{x:k.eye[0],y:k.eye[1],z:k.eye[2]},projection:{type:!0===k._ortho?"orthographic":"perspective"}}},l.setViewport=function(k){var L,M=k.camera;this.camera.lookAt.apply(this,[[(L=M).eye.x,L.eye.y,L.eye.z],[L.center.x,L.center.y,L.center.z],[L.up.x,L.up.y,L.up.z]]),this.glplot.setAspectratio(k.aspectratio),"orthographic"===M.projection.type!==this.camera._ortho&&(this.glplot.redraw(),this.glplot.clearRGBA(),this.glplot.dispose(),this.initializeGLPlot())},l.isCameraChanged=function(k){var L=this.getCamera(),M=r.nestedProperty(k,this.id+".camera").get();var z,R,q,V,W,K,P=!1;if(void 0===M)P=!0;else{for(var S=0;S<3;S++)for(var E=0;E<3;E++)if(z=L,V=E,W=void 0,K=void 0,K=["x","y","z"],!(R=M)[(W=["up","center","eye"])[q=S]]||z[W[q]][K[V]]!==R[W[q]][K[V]]){P=!0;break}(!M.projection||L.projection&&L.projection.type!==M.projection.type)&&(P=!0)}return P},l.isAspectChanged=function(k){var L=this.glplot.getAspectratio(),M=r.nestedProperty(k,this.id+".aspectratio").get();return void 0===M||M.x!==L.x||M.y!==L.y||M.z!==L.z},l.saveLayout=function(k){var L,M,I,P,S,E,z=this.fullLayout,R=this.isCameraChanged(k),q=this.isAspectChanged(k),V=R||q;if(V){var W={};R&&(L=this.getCamera(),I=(M=r.nestedProperty(k,this.id+".camera")).get(),W[this.id+".camera"]=I),q&&(P=this.glplot.getAspectratio(),E=(S=r.nestedProperty(k,this.id+".aspectratio")).get(),W[this.id+".aspectratio"]=E),a.call("_storeDirectGUIEdit",k,z._preGUI,W),R&&(M.set(L),r.nestedProperty(z,this.id+".camera").set(L)),q&&(S.set(P),r.nestedProperty(z,this.id+".aspectratio").set(P),this.glplot.redraw())}return V},l.updateFx=function(k,L){var M=this.camera;if(M)if("orbit"===k)M.mode="orbit",M.keyBindingMode="rotate";else if("turntable"===k){M.up=[0,0,1],M.mode="turntable",M.keyBindingMode="rotate";var I=this.graphDiv,P=I._fullLayout,S=this.fullSceneLayout.camera,E=S.up.x,z=S.up.y,R=S.up.z;if(R/Math.sqrt(E*E+z*z+R*R)<.999){var q=this.id+".camera.up",V={x:0,y:0,z:1},W={};W[q]=V;var K=I.layout;a.call("_storeDirectGUIEdit",K,P._preGUI,W),S.up=V,r.nestedProperty(K,q).set(V)}}else M.keyBindingMode=k;this.fullSceneLayout.hovermode=L},l.toImage=function(k){k||(k="png"),this.staticMode&&this.container.appendChild(g),this.glplot.redraw();var L=this.glplot.gl,M=L.drawingBufferWidth,I=L.drawingBufferHeight;L.bindFramebuffer(L.FRAMEBUFFER,null);var P=new Uint8Array(M*I*4);L.readPixels(0,0,M,I,L.RGBA,L.UNSIGNED_BYTE,P),function(q,V,W){for(var K=0,G=W-1;K<G;++K,--G)for(var Y=0;Y<V;++Y)for(var $=0;$<4;++$){var B=4*(V*K+Y)+$,N=4*(V*G+Y)+$,U=q[B];q[B]=q[N],q[N]=U}}(P,M,I),function(q,V,W){for(var K=0;K<W;++K)for(var G=0;G<V;++G){var Y=4*(V*K+G),$=q[Y+3];if($>0)for(var B=255/$,N=0;N<3;++N)q[Y+N]=Math.min(B*q[Y+N],255)}}(P,M,I);var S=document.createElement("canvas");S.width=M,S.height=I;var E,z=S.getContext("2d",{willReadFrequently:!0}),R=z.createImageData(M,I);switch(R.data.set(P),z.putImageData(R,0,0),k){case"jpeg":E=S.toDataURL("image/jpeg");break;case"webp":E=S.toDataURL("image/webp");break;default:E=S.toDataURL("image/png")}return this.staticMode&&this.container.removeChild(g),E},l.setConvert=function(){for(var k=0;k<3;k++){var L=this.fullSceneLayout[_[k]];s.setConvert(L,this.fullLayout),L.setScale=r.noop}},l.make4thDimension=function(){var k=this.graphDiv._fullLayout;this._mockAxis={type:"linear",showexponent:"all",exponentformat:"B"},s.setConvert(this._mockAxis,k)},ee.exports=b},{"../../../stackgl_modules":1133,"../../components/fx":407,"../../lib":515,"../../lib/show_no_webgl_msg":537,"../../lib/str2rgbarray":540,"../../plots/cartesian/axes":566,"../../registry":647,"./layout/convert":611,"./layout/spikes":614,"./layout/tick_marks":615,"./project":616,"has-passive-events":229,"webgl-context":332}],618:[function(y,ee,Q){"use strict";ee.exports=function(g,v,m,x){x=x||g.length;for(var e=new Array(x),n=0;n<x;n++)e[n]=[g[n],v[n],m[n]];return e}},{}],619:[function(y,ee,Q){"use strict";var g=y("./font_attributes"),v=y("./animation_attributes"),m=y("../components/color/attributes"),x=y("../components/shapes/draw_newshape/attributes"),e=y("../components/selections/draw_newselection/attributes"),n=y("./pad_attributes"),t=y("../lib/extend").extendFlat,a=g({editType:"calc"});a.family.dflt='"Open Sans", verdana, arial, sans-serif',a.size.dflt=12,a.color.dflt=m.defaultLine,ee.exports={font:a,title:{text:{valType:"string",editType:"layoutstyle"},font:g({editType:"layoutstyle"}),xref:{valType:"enumerated",dflt:"container",values:["container","paper"],editType:"layoutstyle"},yref:{valType:"enumerated",dflt:"container",values:["container","paper"],editType:"layoutstyle"},x:{valType:"number",min:0,max:1,dflt:.5,editType:"layoutstyle"},y:{valType:"number",min:0,max:1,dflt:"auto",editType:"layoutstyle"},xanchor:{valType:"enumerated",dflt:"auto",values:["auto","left","center","right"],editType:"layoutstyle"},yanchor:{valType:"enumerated",dflt:"auto",values:["auto","top","middle","bottom"],editType:"layoutstyle"},pad:t(n({editType:"layoutstyle"}),{}),editType:"layoutstyle"},uniformtext:{mode:{valType:"enumerated",values:[!1,"hide","show"],dflt:!1,editType:"plot"},minsize:{valType:"number",min:0,dflt:0,editType:"plot"},editType:"plot"},autosize:{valType:"boolean",dflt:!1,editType:"none"},width:{valType:"number",min:10,dflt:700,editType:"plot"},height:{valType:"number",min:10,dflt:450,editType:"plot"},margin:{l:{valType:"number",min:0,dflt:80,editType:"plot"},r:{valType:"number",min:0,dflt:80,editType:"plot"},t:{valType:"number",min:0,dflt:100,editType:"plot"},b:{valType:"number",min:0,dflt:80,editType:"plot"},pad:{valType:"number",min:0,dflt:0,editType:"plot"},autoexpand:{valType:"boolean",dflt:!0,editType:"plot"},editType:"plot"},computed:{valType:"any",editType:"none"},paper_bgcolor:{valType:"color",dflt:m.background,editType:"plot"},plot_bgcolor:{valType:"color",dflt:m.background,editType:"layoutstyle"},autotypenumbers:{valType:"enumerated",values:["convert types","strict"],dflt:"convert types",editType:"calc"},separators:{valType:"string",editType:"plot"},hidesources:{valType:"boolean",dflt:!1,editType:"plot"},showlegend:{valType:"boolean",editType:"legend"},colorway:{valType:"colorlist",dflt:m.defaults,editType:"calc"},datarevision:{valType:"any",editType:"calc"},uirevision:{valType:"any",editType:"none"},editrevision:{valType:"any",editType:"none"},selectionrevision:{valType:"any",editType:"none"},template:{valType:"any",editType:"calc"},newshape:x.newshape,activeshape:x.activeshape,newselection:e.newselection,activeselection:e.activeselection,meta:{valType:"any",arrayOk:!0,editType:"plot"},transition:t({},v.transition,{editType:"none"}),_deprecated:{title:{valType:"string",editType:"layoutstyle"},titlefont:g({editType:"layoutstyle"})}}},{"../components/color/attributes":366,"../components/selections/draw_newselection/attributes":451,"../components/shapes/draw_newshape/attributes":463,"../lib/extend":505,"./animation_attributes":560,"./font_attributes":594,"./pad_attributes":627}],620:[function(y,ee,Q){"use strict";var g=y("../../lib/sort_object_keys"),v='\xa9 <a target="_blank" href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors',m=['\xa9 <a target="_blank" href="https://carto.com/">Carto</a>',v].join(" "),x=['Map tiles by <a target="_blank" href="https://stamen.com">Stamen Design</a>','under <a target="_blank" href="https://creativecommons.org/licenses/by/3.0">CC BY 3.0</a>',"|",'Data by <a target="_blank" href="https://openstreetmap.org">OpenStreetMap</a> contributors','under <a target="_blank" href="https://www.openstreetmap.org/copyright">ODbL</a>'].join(" "),e={"open-street-map":{id:"osm",version:8,sources:{"plotly-osm-tiles":{type:"raster",attribution:v,tiles:["https://a.tile.openstreetmap.org/{z}/{x}/{y}.png","https://b.tile.openstreetmap.org/{z}/{x}/{y}.png"],tileSize:256}},layers:[{id:"plotly-osm-tiles",type:"raster",source:"plotly-osm-tiles",minzoom:0,maxzoom:22}]},"white-bg":{id:"white-bg",version:8,sources:{},layers:[{id:"white-bg",type:"background",paint:{"background-color":"#FFFFFF"},minzoom:0,maxzoom:22}]},"carto-positron":{id:"carto-positron",version:8,sources:{"plotly-carto-positron":{type:"raster",attribution:m,tiles:["https://cartodb-basemaps-c.global.ssl.fastly.net/light_all/{z}/{x}/{y}.png"],tileSize:256}},layers:[{id:"plotly-carto-positron",type:"raster",source:"plotly-carto-positron",minzoom:0,maxzoom:22}]},"carto-darkmatter":{id:"carto-darkmatter",version:8,sources:{"plotly-carto-darkmatter":{type:"raster",attribution:m,tiles:["https://cartodb-basemaps-c.global.ssl.fastly.net/dark_all/{z}/{x}/{y}.png"],tileSize:256}},layers:[{id:"plotly-carto-darkmatter",type:"raster",source:"plotly-carto-darkmatter",minzoom:0,maxzoom:22}]},"stamen-terrain":{id:"stamen-terrain",version:8,sources:{"plotly-stamen-terrain":{type:"raster",attribution:x,tiles:["https://stamen-tiles.a.ssl.fastly.net/terrain/{z}/{x}/{y}.png"],tileSize:256}},layers:[{id:"plotly-stamen-terrain",type:"raster",source:"plotly-stamen-terrain",minzoom:0,maxzoom:22}]},"stamen-toner":{id:"stamen-toner",version:8,sources:{"plotly-stamen-toner":{type:"raster",attribution:x,tiles:["https://stamen-tiles.a.ssl.fastly.net/toner/{z}/{x}/{y}.png"],tileSize:256}},layers:[{id:"plotly-stamen-toner",type:"raster",source:"plotly-stamen-toner",minzoom:0,maxzoom:22}]},"stamen-watercolor":{id:"stamen-watercolor",version:8,sources:{"plotly-stamen-watercolor":{type:"raster",attribution:['Map tiles by <a target="_blank" href="https://stamen.com">Stamen Design</a>','under <a target="_blank" href="https://creativecommons.org/licenses/by/3.0">CC BY 3.0</a>',"|",'Data by <a target="_blank" href="https://openstreetmap.org">OpenStreetMap</a> contributors','under <a target="_blank" href="https://creativecommons.org/licenses/by-sa/3.0">CC BY SA</a>'].join(" "),tiles:["https://stamen-tiles.a.ssl.fastly.net/watercolor/{z}/{x}/{y}.png"],tileSize:256}},layers:[{id:"plotly-stamen-watercolor",type:"raster",source:"plotly-stamen-watercolor",minzoom:0,maxzoom:22}]}},n=g(e);ee.exports={requiredVersion:"1.10.1",styleUrlPrefix:"mapbox://styles/mapbox/",styleUrlSuffix:"v9",styleValuesMapbox:["basic","streets","outdoors","light","dark","satellite","satellite-streets"],styleValueDflt:"basic",stylesNonMapbox:e,styleValuesNonMapbox:n,traceLayerPrefix:"plotly-trace-layer-",layoutLayerPrefix:"plotly-layout-layer-",wrongVersionErrorMsg:["Your custom plotly.js bundle is not using the correct mapbox-gl version","Please install mapbox-gl@1.10.1."].join("\n"),noAccessTokenErrorMsg:["Missing Mapbox access token.","Mapbox trace type require a Mapbox access token to be registered.","For example:","  Plotly.newPlot(gd, data, layout, { mapboxAccessToken: 'my-access-token' });","More info here: https://www.mapbox.com/help/define-access-token/"].join("\n"),missingStyleErrorMsg:["No valid mapbox style found, please set `mapbox.style` to one of:",n.join(", "),"or register a Mapbox access token to use a Mapbox-served style."].join("\n"),multipleTokensErrorMsg:["Set multiple mapbox access token across different mapbox subplot,","using first token found as mapbox-gl does not allow multipleaccess tokens on the same page."].join("\n"),mapOnErrorMsg:"Mapbox error.",mapboxLogo:{path0:"m 10.5,1.24 c -5.11,0 -9.25,4.15 -9.25,9.25 0,5.1 4.15,9.25 9.25,9.25 5.1,0 9.25,-4.15 9.25,-9.25 0,-5.11 -4.14,-9.25 -9.25,-9.25 z m 4.39,11.53 c -1.93,1.93 -4.78,2.31 -6.7,2.31 -0.7,0 -1.41,-0.05 -2.1,-0.16 0,0 -1.02,-5.64 2.14,-8.81 0.83,-0.83 1.95,-1.28 3.13,-1.28 1.27,0 2.49,0.51 3.39,1.42 1.84,1.84 1.89,4.75 0.14,6.52 z",path1:"M 10.5,-0.01 C 4.7,-0.01 0,4.7 0,10.49 c 0,5.79 4.7,10.5 10.5,10.5 5.8,0 10.5,-4.7 10.5,-10.5 C 20.99,4.7 16.3,-0.01 10.5,-0.01 Z m 0,19.75 c -5.11,0 -9.25,-4.15 -9.25,-9.25 0,-5.1 4.14,-9.26 9.25,-9.26 5.11,0 9.25,4.15 9.25,9.25 0,5.13 -4.14,9.26 -9.25,9.26 z",path2:"M 14.74,6.25 C 12.9,4.41 9.98,4.35 8.23,6.1 5.07,9.27 6.09,14.91 6.09,14.91 c 0,0 5.64,1.02 8.81,-2.14 C 16.64,11 16.59,8.09 14.74,6.25 Z m -2.27,4.09 -0.91,1.87 -0.9,-1.87 -1.86,-0.91 1.86,-0.9 0.9,-1.87 0.91,1.87 1.86,0.9 z",polygon:"11.56,12.21 10.66,10.34 8.8,9.43 10.66,8.53 11.56,6.66 12.47,8.53 14.33,9.43 12.47,10.34"},styleRules:{map:"overflow:hidden;position:relative;","missing-css":"display:none;",canary:"background-color:salmon;","ctrl-bottom-left":"position: absolute; pointer-events: none; z-index: 2; bottom: 0; left: 0;","ctrl-bottom-right":"position: absolute; pointer-events: none; z-index: 2; right: 0; bottom: 0;",ctrl:"clear: both; pointer-events: auto; transform: translate(0, 0);","ctrl-attrib.mapboxgl-compact .mapboxgl-ctrl-attrib-inner":"display: none;","ctrl-attrib.mapboxgl-compact:hover .mapboxgl-ctrl-attrib-inner":"display: block; margin-top:2px","ctrl-attrib.mapboxgl-compact:hover":"padding: 2px 24px 2px 4px; visibility: visible; margin-top: 6px;","ctrl-attrib.mapboxgl-compact::after":'content: ""; cursor: pointer; position: absolute; background-image: url(\'data:image/svg+xml;charset=utf-8,%3Csvg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"%3E %3Cpath fill="%23333333" fill-rule="evenodd" d="M4,10a6,6 0 1,0 12,0a6,6 0 1,0 -12,0 M9,7a1,1 0 1,0 2,0a1,1 0 1,0 -2,0 M9,10a1,1 0 1,1 2,0l0,3a1,1 0 1,1 -2,0"/%3E %3C/svg%3E\'); background-color: rgba(255, 255, 255, 0.5); width: 24px; height: 24px; box-sizing: border-box; border-radius: 12px;',"ctrl-attrib.mapboxgl-compact":"min-height: 20px; padding: 0; margin: 10px; position: relative; background-color: #fff; border-radius: 3px 12px 12px 3px;","ctrl-bottom-right > .mapboxgl-ctrl-attrib.mapboxgl-compact::after":"bottom: 0; right: 0","ctrl-bottom-left > .mapboxgl-ctrl-attrib.mapboxgl-compact::after":"bottom: 0; left: 0","ctrl-bottom-left .mapboxgl-ctrl":"margin: 0 0 10px 10px; float: left;","ctrl-bottom-right .mapboxgl-ctrl":"margin: 0 10px 10px 0; float: right;","ctrl-attrib":"color: rgba(0, 0, 0, 0.75); text-decoration: none; font-size: 12px","ctrl-attrib a":"color: rgba(0, 0, 0, 0.75); text-decoration: none; font-size: 12px","ctrl-attrib a:hover":"color: inherit; text-decoration: underline;","ctrl-attrib .mapbox-improve-map":"font-weight: bold; margin-left: 2px;","attrib-empty":"display: none;","ctrl-logo":'display:block; width: 21px; height: 21px; background-image: url(\'data:image/svg+xml;charset=utf-8,%3C?xml version="1.0" encoding="utf-8"?%3E %3Csvg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 21 21" style="enable-background:new 0 0 21 21;" xml:space="preserve"%3E%3Cg transform="translate(0,0.01)"%3E%3Cpath d="m 10.5,1.24 c -5.11,0 -9.25,4.15 -9.25,9.25 0,5.1 4.15,9.25 9.25,9.25 5.1,0 9.25,-4.15 9.25,-9.25 0,-5.11 -4.14,-9.25 -9.25,-9.25 z m 4.39,11.53 c -1.93,1.93 -4.78,2.31 -6.7,2.31 -0.7,0 -1.41,-0.05 -2.1,-0.16 0,0 -1.02,-5.64 2.14,-8.81 0.83,-0.83 1.95,-1.28 3.13,-1.28 1.27,0 2.49,0.51 3.39,1.42 1.84,1.84 1.89,4.75 0.14,6.52 z" style="opacity:0.9;fill:%23ffffff;enable-background:new" class="st0"/%3E%3Cpath d="M 10.5,-0.01 C 4.7,-0.01 0,4.7 0,10.49 c 0,5.79 4.7,10.5 10.5,10.5 5.8,0 10.5,-4.7 10.5,-10.5 C 20.99,4.7 16.3,-0.01 10.5,-0.01 Z m 0,19.75 c -5.11,0 -9.25,-4.15 -9.25,-9.25 0,-5.1 4.14,-9.26 9.25,-9.26 5.11,0 9.25,4.15 9.25,9.25 0,5.13 -4.14,9.26 -9.25,9.26 z" style="opacity:0.35;enable-background:new" class="st1"/%3E%3Cpath d="M 14.74,6.25 C 12.9,4.41 9.98,4.35 8.23,6.1 5.07,9.27 6.09,14.91 6.09,14.91 c 0,0 5.64,1.02 8.81,-2.14 C 16.64,11 16.59,8.09 14.74,6.25 Z m -2.27,4.09 -0.91,1.87 -0.9,-1.87 -1.86,-0.91 1.86,-0.9 0.9,-1.87 0.91,1.87 1.86,0.9 z" style="opacity:0.35;enable-background:new" class="st1"/%3E%3Cpolygon points="11.56,12.21 10.66,10.34 8.8,9.43 10.66,8.53 11.56,6.66 12.47,8.53 14.33,9.43 12.47,10.34 " style="opacity:0.9;fill:%23ffffff;enable-background:new" class="st0"/%3E%3C/g%3E%3C/svg%3E\')'}}},{"../../lib/sort_object_keys":538}],621:[function(y,ee,Q){"use strict";var g=y("../../lib");ee.exports=function(v,m){var x=v.split(" "),e=x[0],n=x[1],t=g.isArrayOrTypedArray(m)?g.mean(m):m,a=.5+t/100,r=1.5+t/100,d=["",""],s=[0,0];switch(e){case"top":d[0]="top",s[1]=-r;break;case"bottom":d[0]="bottom",s[1]=r}switch(n){case"left":d[1]="right",s[0]=-a;break;case"right":d[1]="left",s[0]=a}return{anchor:d[0]&&d[1]?d.join("-"):d[0]?d[0]:d[1]?d[1]:"center",offset:s}}},{"../../lib":515}],622:[function(y,ee,Q){"use strict";var g=y("mapbox-gl/dist/mapbox-gl-unminified"),v=y("../../lib"),m=v.strTranslate,x=v.strScale,e=y("../../plots/get_data").getSubplotCalcData,n=y("../../constants/xmlns_namespaces"),t=y("@plotly/d3"),a=y("../../components/drawing"),r=y("../../lib/svg_text_utils"),d=y("./mapbox"),s=Q.constants=y("./constants");function i(u){return"string"==typeof u&&(-1!==s.styleValuesMapbox.indexOf(u)||0===u.indexOf("mapbox://"))}Q.name="mapbox",Q.attr="subplot",Q.idRoot="mapbox",Q.idRegex=Q.attrRegex=v.counterRegex("mapbox"),Q.attributes={subplot:{valType:"subplotid",dflt:"mapbox",editType:"calc"}},Q.layoutAttributes=y("./layout_attributes"),Q.supplyLayoutDefaults=y("./layout_defaults"),Q.plot=function(u){var f=u._fullLayout,c=u.calcdata,h=f._subplots.mapbox;if(g.version!==s.requiredVersion)throw new Error(s.wrongVersionErrorMsg);var p=function(w,k){var L=w._fullLayout;if(""===w._context.mapboxAccessToken)return"";for(var M=[],I=[],P=!1,S=!1,E=0;E<k.length;E++){var z=L[k[E]],R=z.accesstoken;i(z.style)&&(R?v.pushUnique(M,R):(i(z._input.style)&&(v.error("Uses Mapbox map style, but did not set an access token."),P=!0),S=!0)),R&&v.pushUnique(I,R)}if(S){var q=P?s.noAccessTokenErrorMsg:s.missingStyleErrorMsg;throw v.error(q),new Error(q)}return M.length?(M.length>1&&v.warn(s.multipleTokensErrorMsg),M[0]):(I.length&&v.log(["Listed mapbox access token(s)",I.join(","),"but did not use a Mapbox map style, ignoring token(s)."].join(" ")),"")}(u,h);g.accessToken=p;for(var o=0;o<h.length;o++){var b=h[o],l=e(c,"mapbox",b),T=f[b],_=T._subplot;_||(_=new d(u,b),f[b]._subplot=_),_.viewInitial||(_.viewInitial={center:v.extendFlat({},T.center),zoom:T.zoom,bearing:T.bearing,pitch:T.pitch}),_.plot(l,f,u._promises)}},Q.clean=function(u,f,c,h){for(var p=h._subplots.mapbox||[],o=0;o<p.length;o++){var b=p[o];!f[b]&&h[b]._subplot&&h[b]._subplot.destroy()}},Q.toSVG=function(u){for(var f=u._fullLayout,c=f._subplots.mapbox,h=f._size,p=0;p<c.length;p++){var o=f[c[p]],b=o.domain,l=o._subplot.toImage("png");f._glimages.append("svg:image").attr({xmlns:n.svg,"xlink:href":l,x:h.l+h.w*b.x[0],y:h.t+h.h*(1-b.y[1]),width:h.w*(b.x[1]-b.x[0]),height:h.h*(b.y[1]-b.y[0]),preserveAspectRatio:"none"});var T=t.select(o._subplot.div);if(null!==T.select(".mapboxgl-ctrl-logo").node().offsetParent){var _=f._glimages.append("g");_.attr("transform",m(h.l+h.w*b.x[0]+10,h.t+h.h*(1-b.y[0])-31)),_.append("path").attr("d",s.mapboxLogo.path0).style({opacity:.9,fill:"#ffffff","enable-background":"new"}),_.append("path").attr("d",s.mapboxLogo.path1).style("opacity",.35).style("enable-background","new"),_.append("path").attr("d",s.mapboxLogo.path2).style("opacity",.35).style("enable-background","new"),_.append("polygon").attr("points",s.mapboxLogo.polygon).style({opacity:.9,fill:"#ffffff","enable-background":"new"})}var w=T.select(".mapboxgl-ctrl-attrib").text().replace("Improve this map",""),k=f._glimages.append("g"),L=k.append("text");L.text(w).classed("static-attribution",!0).attr({"font-size":12,"font-family":"Arial",color:"rgba(0, 0, 0, 0.75)","text-anchor":"end","data-unformatted":w});var M=a.bBox(L.node()),I=h.w*(b.x[1]-b.x[0]);if(M.width>I/2){var P=w.split("|").join("<br>");L.text(P).attr("data-unformatted",P).call(r.convertToTspans,u),M=a.bBox(L.node())}L.attr("transform",m(-3,8-M.height)),k.insert("rect",".static-attribution").attr({x:-M.width-6,y:-M.height-3,width:M.width+6,height:M.height+3,fill:"rgba(255, 255, 255, 0.75)"});var S=1;M.width+6>I&&(S=I/(M.width+6));var E=[h.l+h.w*b.x[1],h.t+h.h*(1-b.y[0])];k.attr("transform",m(E[0],E[1])+x(S))}},Q.updateFx=function(u){for(var f=u._fullLayout,c=f._subplots.mapbox,h=0;h<c.length;h++)f[c[h]]._subplot.updateFx(f)}},{"../../components/drawing":389,"../../constants/xmlns_namespaces":492,"../../lib":515,"../../lib/svg_text_utils":541,"../../plots/get_data":602,"./constants":620,"./layout_attributes":624,"./layout_defaults":625,"./mapbox":626,"@plotly/d3":58,"mapbox-gl/dist/mapbox-gl-unminified":239}],623:[function(y,ee,Q){"use strict";var g=y("../../lib"),v=y("../../lib/svg_text_utils").sanitizeHTML,m=y("./convert_text_opts"),x=y("./constants");function e(r,d){this.subplot=r,this.uid=r.uid+"-"+d,this.index=d,this.idSource="source-"+this.uid,this.idLayer=x.layoutLayerPrefix+this.uid,this.sourceType=null,this.source=null,this.layerType=null,this.below=null,this.visible=!1}var n=e.prototype;function t(r){if(!r.visible)return!1;var d=r.source;if(Array.isArray(d)&&d.length>0){for(var s=0;s<d.length;s++)if("string"!=typeof d[s]||0===d[s].length)return!1;return!0}return g.isPlainObject(d)||"string"==typeof d&&d.length>0}function a(r){var d={},s={};switch(r.type){case"circle":g.extendFlat(s,{"circle-radius":r.circle.radius,"circle-color":r.color,"circle-opacity":r.opacity});break;case"line":g.extendFlat(s,{"line-width":r.line.width,"line-color":r.color,"line-opacity":r.opacity,"line-dasharray":r.line.dash});break;case"fill":g.extendFlat(s,{"fill-color":r.color,"fill-outline-color":r.fill.outlinecolor,"fill-opacity":r.opacity});break;case"symbol":var i=r.symbol,u=m(i.textposition,i.iconsize);g.extendFlat(d,{"icon-image":i.icon+"-15","icon-size":i.iconsize/10,"text-field":i.text,"text-size":i.textfont.size,"text-anchor":u.anchor,"text-offset":u.offset,"symbol-placement":i.placement}),g.extendFlat(s,{"icon-color":r.color,"text-color":i.textfont.color,"text-opacity":r.opacity});break;case"raster":g.extendFlat(s,{"raster-fade-duration":0,"raster-opacity":r.opacity})}return{layout:d,paint:s}}n.update=function(r){this.visible?this.needsNewImage(r)?this.updateImage(r):this.needsNewSource(r)?(this.removeLayer(),this.updateSource(r),this.updateLayer(r)):this.needsNewLayer(r)?this.updateLayer(r):this.updateStyle(r):(this.updateSource(r),this.updateLayer(r)),this.visible=t(r)},n.needsNewImage=function(r){return this.subplot.map.getSource(this.idSource)&&"image"===this.sourceType&&"image"===r.sourcetype&&(this.source!==r.source||JSON.stringify(this.coordinates)!==JSON.stringify(r.coordinates))},n.needsNewSource=function(r){return this.sourceType!==r.sourcetype||JSON.stringify(this.source)!==JSON.stringify(r.source)||this.layerType!==r.type},n.needsNewLayer=function(r){return this.layerType!==r.type||this.below!==this.subplot.belowLookup["layout-"+this.index]},n.lookupBelow=function(){return this.subplot.belowLookup["layout-"+this.index]},n.updateImage=function(r){this.subplot.map.getSource(this.idSource).updateImage({url:r.source,coordinates:r.coordinates});var d=this.findFollowingMapboxLayerId(this.lookupBelow());null!==d&&this.subplot.map.moveLayer(this.idLayer,d)},n.updateSource=function(r){var i,u,f,c,h,d=this.subplot.map;if(d.getSource(this.idSource)&&d.removeSource(this.idSource),this.sourceType=r.sourcetype,this.source=r.source,t(r)){var s=(c=(i=r).source,h={type:f=i.sourcetype},"geojson"===f?u="data":"vector"===f?u="string"==typeof c?"url":"tiles":"raster"===f?(u="tiles",h.tileSize=256):"image"===f&&(u="url",h.coordinates=i.coordinates),h[u]=c,i.sourceattribution&&(h.attribution=v(i.sourceattribution)),h);d.addSource(this.idSource,s)}},n.findFollowingMapboxLayerId=function(r){if("traces"===r)for(var d=this.subplot.getMapLayers(),s=0;s<d.length;s++){var i=d[s].id;if("string"==typeof i&&0===i.indexOf(x.traceLayerPrefix)){r=i;break}}return r},n.updateLayer=function(r){var d=this.subplot,s=a(r),i=this.lookupBelow(),u=this.findFollowingMapboxLayerId(i);this.removeLayer(),t(r)&&d.addLayer({id:this.idLayer,source:this.idSource,"source-layer":r.sourcelayer||"",type:r.type,minzoom:r.minzoom,maxzoom:r.maxzoom,layout:s.layout,paint:s.paint},u),this.layerType=r.type,this.below=i},n.updateStyle=function(r){if(t(r)){var d=a(r);this.subplot.setOptions(this.idLayer,"setLayoutProperty",d.layout),this.subplot.setOptions(this.idLayer,"setPaintProperty",d.paint)}},n.removeLayer=function(){var r=this.subplot.map;r.getLayer(this.idLayer)&&r.removeLayer(this.idLayer)},n.dispose=function(){var r=this.subplot.map;r.getLayer(this.idLayer)&&r.removeLayer(this.idLayer),r.getSource(this.idSource)&&r.removeSource(this.idSource)},ee.exports=function(r,d,s){var i=new e(r,d);return i.update(s),i}},{"../../lib":515,"../../lib/svg_text_utils":541,"./constants":620,"./convert_text_opts":621}],624:[function(y,ee,Q){"use strict";var g=y("../../lib"),v=y("../../components/color").defaultLine,m=y("../domain").attributes,x=y("../font_attributes"),e=y("../../traces/scatter/attributes").textposition,n=y("../../plot_api/edit_types").overrideAll,t=y("../../plot_api/plot_template").templatedArray,a=y("./constants"),r=x({});r.family.dflt="Open Sans Regular, Arial Unicode MS Regular",(ee.exports=n({_arrayAttrRegexps:[g.counterRegex("mapbox",".layers",!0)],domain:m({name:"mapbox"}),accesstoken:{valType:"string",noBlank:!0,strict:!0},style:{valType:"any",values:a.styleValuesMapbox.concat(a.styleValuesNonMapbox),dflt:a.styleValueDflt},center:{lon:{valType:"number",dflt:0},lat:{valType:"number",dflt:0}},zoom:{valType:"number",dflt:1},bearing:{valType:"number",dflt:0},pitch:{valType:"number",dflt:0},layers:t("layer",{visible:{valType:"boolean",dflt:!0},sourcetype:{valType:"enumerated",values:["geojson","vector","raster","image"],dflt:"geojson"},source:{valType:"any"},sourcelayer:{valType:"string",dflt:""},sourceattribution:{valType:"string"},type:{valType:"enumerated",values:["circle","line","fill","symbol","raster"],dflt:"circle"},coordinates:{valType:"any"},below:{valType:"string"},color:{valType:"color",dflt:v},opacity:{valType:"number",min:0,max:1,dflt:1},minzoom:{valType:"number",min:0,max:24,dflt:0},maxzoom:{valType:"number",min:0,max:24,dflt:24},circle:{radius:{valType:"number",dflt:15}},line:{width:{valType:"number",dflt:2},dash:{valType:"data_array"}},fill:{outlinecolor:{valType:"color",dflt:v}},symbol:{icon:{valType:"string",dflt:"marker"},iconsize:{valType:"number",dflt:10},text:{valType:"string",dflt:""},placement:{valType:"enumerated",values:["point","line","line-center"],dflt:"point"},textfont:r,textposition:g.extendFlat({},e,{arrayOk:!1})}})},"plot","from-root")).uirevision={valType:"any",editType:"none"}},{"../../components/color":367,"../../lib":515,"../../plot_api/edit_types":548,"../../plot_api/plot_template":555,"../../traces/scatter/attributes":936,"../domain":593,"../font_attributes":594,"./constants":620}],625:[function(y,ee,Q){"use strict";var g=y("../../lib"),v=y("../subplot_defaults"),m=y("../array_container_defaults"),x=y("./layout_attributes");function e(t,a,r,d){r("accesstoken",d.accessToken),r("style"),r("center.lon"),r("center.lat"),r("zoom"),r("bearing"),r("pitch"),m(t,a,{name:"layers",handleItemDefaults:n}),a._input=t}function n(t,a){function r(f,c){return g.coerce(t,a,x.layers,f,c)}if(r("visible")){var d,s=r("sourcetype"),i="raster"===s||"image"===s;r("source"),r("sourceattribution"),"vector"===s&&r("sourcelayer"),"image"===s&&r("coordinates"),i&&(d="raster");var u=r("type",d);i&&"raster"!==u&&(u=a.type="raster",g.log("Source types *raster* and *image* must drawn *raster* layer type.")),r("below"),r("color"),r("opacity"),r("minzoom"),r("maxzoom"),"circle"===u&&r("circle.radius"),"line"===u&&(r("line.width"),r("line.dash")),"fill"===u&&r("fill.outlinecolor"),"symbol"===u&&(r("symbol.icon"),r("symbol.iconsize"),r("symbol.text"),g.coerceFont(r,"symbol.textfont"),r("symbol.textposition"),r("symbol.placement"))}}ee.exports=function(t,a,r){v(t,a,r,{type:"mapbox",attributes:x,handleDefaults:e,partition:"y",accessToken:a._mapboxAccessToken})}},{"../../lib":515,"../array_container_defaults":561,"../subplot_defaults":641,"./layout_attributes":624}],626:[function(y,ee,Q){"use strict";var g=y("mapbox-gl/dist/mapbox-gl-unminified"),v=y("../../lib"),m=y("../../lib/geo_location_utils"),x=y("../../registry"),e=y("../cartesian/axes"),n=y("../../components/dragelement"),t=y("../../components/fx"),a=y("../../components/dragelement/helpers"),r=a.drawMode,d=a.selectMode,s=y("../../components/selections").prepSelect,i=y("../../components/selections").clearOutline,u=y("../../components/selections").clearSelectionsCache,f=y("../../components/selections").selectOnClick,c=y("./constants"),h=y("./layers");function p(w,k){this.id=k,this.gd=w;var L=w._fullLayout,M=w._context;this.container=L._glcontainer.node(),this.isStatic=M.staticPlot,this.uid=L._uid+"-"+this.id,this.div=null,this.xaxis=null,this.yaxis=null,this.createFramework(L),this.map=null,this.accessToken=null,this.styleObj=null,this.traceHash={},this.layerList=[],this.belowLookup={},this.dragging=!1,this.wheeling=!1}var o=p.prototype;o.plot=function(w,k,L){var M,I=this;I.map&&k[I.id].accesstoken!==I.accessToken&&(I.map.remove(),I.map=null,I.styleObj=null,I.traceHash={},I.layerList=[]),M=new Promise(I.map?function(S,E){I.updateMap(w,k,S,E)}:function(S,E){I.createMap(w,k,S,E)}),L.push(M)},o.createMap=function(w,k,L,M){var I=this,P=k[I.id],S=I.styleObj=l(P.style);I.accessToken=P.accesstoken;var E=I.map=new g.Map({container:I.div,style:S.style,center:_(P.center),zoom:P.zoom,bearing:P.bearing,pitch:P.pitch,interactive:!I.isStatic,preserveDrawingBuffer:I.isStatic,doubleClickZoom:!1,boxZoom:!1,attributionControl:!1}).addControl(new g.AttributionControl({compact:!0}));E._canvas.style.left="0px",E._canvas.style.top="0px",I.rejectOnError(M),I.isStatic||I.initFx(w,k);var z=[];z.push(new Promise(function(R){E.once("load",R)})),z=z.concat(m.fetchTraceGeoData(w)),Promise.all(z).then(function(){I.fillBelowLookup(w,k),I.updateData(w),I.updateLayout(k),I.resolveOnRender(L)}).catch(M)},o.updateMap=function(w,k,L,M){var I=this,P=I.map,S=k[this.id];I.rejectOnError(M);var E=[],z=l(S.style);JSON.stringify(I.styleObj)!==JSON.stringify(z)&&(I.styleObj=z,P.setStyle(z.style),I.traceHash={},E.push(new Promise(function(R){P.once("styledata",R)}))),E=E.concat(m.fetchTraceGeoData(w)),Promise.all(E).then(function(){I.fillBelowLookup(w,k),I.updateData(w),I.updateLayout(k),I.resolveOnRender(L)}).catch(M)},o.fillBelowLookup=function(w,k){var L,M,I=k[this.id].layers,P=this.belowLookup={},S=!1;for(L=0;L<w.length;L++){var E=w[L][0].trace,z=E._module;"string"==typeof E.below?M=E.below:z.getBelow&&(M=z.getBelow(E,this)),""===M&&(S=!0),P["trace-"+E.uid]=M||""}for(L=0;L<I.length;L++){var R=I[L];P["layout-"+L]=M="string"==typeof R.below?R.below:S?"traces":""}var q,V,W={};for(q in P)W[M=P[q]]?W[M].push(q):W[M]=[q];for(M in W){var K=W[M];if(K.length>1)for(L=0;L<K.length;L++)0===(q=K[L]).indexOf("trace-")?(V=q.split("trace-")[1],this.traceHash[V]&&(this.traceHash[V].below=null)):0===q.indexOf("layout-")&&(V=q.split("layout-")[1],this.layerList[V]&&(this.layerList[V].below=null))}};var b={choroplethmapbox:0,densitymapbox:1,scattermapbox:2};function l(w){var k={};return v.isPlainObject(w)?(k.id=w.id,k.style=w):"string"==typeof w?(k.id=w,k.style=-1!==c.styleValuesMapbox.indexOf(w)?T(w):c.stylesNonMapbox[w]?c.stylesNonMapbox[w]:w):(k.id=c.styleValueDflt,k.style=T(c.styleValueDflt)),k.transition={duration:0,delay:0},k}function T(w){return c.styleUrlPrefix+w+"-"+c.styleUrlSuffix}function _(w){return[w.lon,w.lat]}o.updateData=function(w){var k,L,M,I,P=this.traceHash,S=w.slice().sort(function(V,W){return b[V[0].trace.type]-b[W[0].trace.type]});for(M=0;M<S.length;M++){var E=S[M],z=!1;(k=P[(L=E[0].trace).uid])&&(k.type===L.type?(k.update(E),z=!0):k.dispose()),!z&&L._module&&(P[L.uid]=L._module.plot(this,E))}var R=Object.keys(P);e:for(M=0;M<R.length;M++){var q=R[M];for(I=0;I<w.length;I++)if(q===(L=w[I][0].trace).uid)continue e;(k=P[q]).dispose(),delete P[q]}},o.updateLayout=function(w){var k=this.map,L=w[this.id];this.dragging||this.wheeling||(k.setCenter(_(L.center)),k.setZoom(L.zoom),k.setBearing(L.bearing),k.setPitch(L.pitch)),this.updateLayers(w),this.updateFramework(w),this.updateFx(w),this.map.resize(),this.gd._context._scrollZoom.mapbox?k.scrollZoom.enable():k.scrollZoom.disable()},o.resolveOnRender=function(w){var k=this.map;k.on("render",function L(){k.loaded()&&(k.off("render",L),setTimeout(w,10))})},o.rejectOnError=function(w){var k=this.map;function L(){w(new Error(c.mapOnErrorMsg))}k.once("error",L),k.once("style.error",L),k.once("source.error",L),k.once("tile.error",L),k.once("layer.error",L)},o.createFramework=function(w){var k=this,L=k.div=document.createElement("div");L.id=k.uid,L.style.position="absolute",k.container.appendChild(L),k.xaxis={_id:"x",c2p:function(M){return k.project(M).x}},k.yaxis={_id:"y",c2p:function(M){return k.project(M).y}},k.updateFramework(w),k.mockAxis={type:"linear",showexponent:"all",exponentformat:"B"},e.setConvert(k.mockAxis,w)},o.initFx=function(w,k){var L=this,M=L.gd,I=L.map;function P(){t.loneUnhover(k._hoverlayer)}function S(){var E=L.getView();M.emit("plotly_relayouting",L.getViewEditsWithDerived(E))}I.on("moveend",function(E){if(L.map){var z=M._fullLayout;if(E.originalEvent||L.wheeling){var R=z[L.id];x.call("_storeDirectGUIEdit",M.layout,z._preGUI,L.getViewEdits(R));var q=L.getView();R._input.center=R.center=q.center,R._input.zoom=R.zoom=q.zoom,R._input.bearing=R.bearing=q.bearing,R._input.pitch=R.pitch=q.pitch,M.emit("plotly_relayout",L.getViewEditsWithDerived(q))}E.originalEvent&&"mouseup"===E.originalEvent.type?L.dragging=!1:L.wheeling&&(L.wheeling=!1),z._rehover&&z._rehover()}}),I.on("wheel",function(){L.wheeling=!0}),I.on("mousemove",function(E){var z=L.div.getBoundingClientRect(),R=[E.originalEvent.offsetX,E.originalEvent.offsetY];E.target.getBoundingClientRect=function(){return z},L.xaxis.p2c=function(){return I.unproject(R).lng},L.yaxis.p2c=function(){return I.unproject(R).lat},M._fullLayout._rehover=function(){M._fullLayout._hoversubplot===L.id&&M._fullLayout[L.id]&&t.hover(M,E,L.id)},t.hover(M,E,L.id),M._fullLayout._hoversubplot=L.id}),I.on("dragstart",function(){L.dragging=!0,P()}),I.on("zoomstart",P),I.on("mouseout",function(){M._fullLayout._hoversubplot=null}),I.on("drag",S),I.on("zoom",S),I.on("dblclick",function(){var E=M._fullLayout[L.id];x.call("_storeDirectGUIEdit",M.layout,M._fullLayout._preGUI,L.getViewEdits(E));var z=L.viewInitial;I.setCenter(_(z.center)),I.setZoom(z.zoom),I.setBearing(z.bearing),I.setPitch(z.pitch);var R=L.getView();E._input.center=E.center=R.center,E._input.zoom=E.zoom=R.zoom,E._input.bearing=E.bearing=R.bearing,E._input.pitch=E.pitch=R.pitch,M.emit("plotly_doubleclick",null),M.emit("plotly_relayout",L.getViewEditsWithDerived(R))}),L.clearOutline=function(){u(L.dragOptions),i(L.dragOptions.gd)},L.onClickInPanFn=function(E){return function(z){var R=M._fullLayout.clickmode;R.indexOf("select")>-1&&f(z.originalEvent,M,[L.xaxis],[L.yaxis],L.id,E),R.indexOf("event")>-1&&t.click(M,z.originalEvent)}}},o.updateFx=function(w){var k=this,L=k.map;if(!k.isStatic){var P=w.dragmode;k.dragOptions=v.extendDeep(k.dragOptions||{},{dragmode:w.dragmode,element:k.div,gd:k.gd,plotinfo:{id:k.id,domain:w[k.id].domain,xaxis:k.xaxis,yaxis:k.yaxis,fillRangeItems:function(z,R){R.isRect?(z.range={})[k.id]=[E([R.xmin,R.ymin]),E([R.xmax,R.ymax])]:(z.lassoPoints={})[k.id]=R.map(E)}},xaxes:[k.xaxis],yaxes:[k.yaxis],subplot:k.id}),L.off("click",k.onClickInPanHandler),d(P)||r(P)?(L.dragPan.disable(),L.on("zoomstart",k.clearSelect),k.dragOptions.prepFn=function(z,R,q){s(z,R,q,k.dragOptions,P)},n.init(k.dragOptions)):(L.dragPan.enable(),L.off("zoomstart",k.clearSelect),k.div.onmousedown=null,k.onClickInPanHandler=k.onClickInPanFn(k.dragOptions),L.on("click",k.onClickInPanHandler))}function E(z){var R=k.map.unproject(z);return[R.lng,R.lat]}},o.updateFramework=function(w){var k=w[this.id].domain,L=w._size,M=this.div.style;M.width=L.w*(k.x[1]-k.x[0])+"px",M.height=L.h*(k.y[1]-k.y[0])+"px",M.left=L.l+k.x[0]*L.w+"px",M.top=L.t+(1-k.y[1])*L.h+"px",this.xaxis._offset=L.l+k.x[0]*L.w,this.xaxis._length=L.w*(k.x[1]-k.x[0]),this.yaxis._offset=L.t+(1-k.y[1])*L.h,this.yaxis._length=L.h*(k.y[1]-k.y[0])},o.updateLayers=function(w){var k,L=w[this.id].layers,M=this.layerList;if(L.length!==M.length){for(k=0;k<M.length;k++)M[k].dispose();for(M=this.layerList=[],k=0;k<L.length;k++)M.push(h(this,k,L[k]))}else for(k=0;k<L.length;k++)M[k].update(L[k])},o.destroy=function(){this.map&&(this.map.remove(),this.map=null,this.container.removeChild(this.div))},o.toImage=function(){return this.map.stop(),this.map.getCanvas().toDataURL()},o.setOptions=function(w,k,L){for(var M in L)this.map[k](w,M,L[M])},o.getMapLayers=function(){return this.map.getStyle().layers},o.addLayer=function(w,k){var L=this.map;if("string"==typeof k){if(""===k)return void L.addLayer(w,k);for(var M=this.getMapLayers(),I=0;I<M.length;I++)if(k===M[I].id)return void L.addLayer(w,k);v.warn(["Trying to add layer with *below* value",k,"referencing a layer that does not exist","or that does not yet exist."].join(" "))}L.addLayer(w)},o.project=function(w){return this.map.project(new g.LngLat(w[0],w[1]))},o.getView=function(){var w=this.map,k=w.getCenter(),L={lon:k.lng,lat:k.lat},M=w.getCanvas(),I=parseInt(M.style.width),P=parseInt(M.style.height);return{center:L,zoom:w.getZoom(),bearing:w.getBearing(),pitch:w.getPitch(),_derived:{coordinates:[w.unproject([0,0]).toArray(),w.unproject([I,0]).toArray(),w.unproject([I,P]).toArray(),w.unproject([0,P]).toArray()]}}},o.getViewEdits=function(w){for(var k=this.id,L=["center","zoom","bearing","pitch"],M={},I=0;I<L.length;I++){var P=L[I];M[k+"."+P]=w[P]}return M},o.getViewEditsWithDerived=function(w){var k=this.id,L=this.getViewEdits(w);return L[k+"._derived"]=w._derived,L},ee.exports=p},{"../../components/dragelement":386,"../../components/dragelement/helpers":385,"../../components/fx":407,"../../components/selections":455,"../../lib":515,"../../lib/geo_location_utils":508,"../../registry":647,"../cartesian/axes":566,"./constants":620,"./layers":623,"mapbox-gl/dist/mapbox-gl-unminified":239}],627:[function(y,ee,Q){"use strict";ee.exports=function(g){var v=g.editType;return{t:{valType:"number",dflt:0,editType:v},r:{valType:"number",dflt:0,editType:v},b:{valType:"number",dflt:0,editType:v},l:{valType:"number",dflt:0,editType:v},editType:v}}},{}],628:[function(y,ee,Q){"use strict";var g=y("@plotly/d3"),v=y("d3-time-format").timeFormatLocale,m=y("d3-format").formatLocale,x=y("fast-isnumeric"),e=y("../registry"),n=y("../plot_api/plot_schema"),t=y("../plot_api/plot_template"),a=y("../lib"),r=y("../components/color"),d=y("../constants/numerical").BADNUM,s=y("./cartesian/axis_ids"),i=y("../components/shapes/handle_outline").clearOutline,u=y("./animation_attributes"),f=y("./frame_attributes"),c=y("../plots/get_data").getModuleCalcData,h=a.relinkPrivateKeys,p=a._,o=ee.exports={};a.extendFlat(o,e),o.attributes=y("./attributes"),o.attributes.type.values=o.allTypes,o.fontAttrs=y("./font_attributes"),o.layoutAttributes=y("./layout_attributes"),o.fontWeight="normal";var b=o.transformsRegistry,l=y("./command");o.executeAPICommand=l.executeAPICommand,o.computeAPICommandBindings=l.computeAPICommandBindings,o.manageCommandObserver=l.manageCommandObserver,o.hasSimpleAPICommandBindings=l.hasSimpleAPICommandBindings,o.redrawText=function(V){return V=a.getGraphDiv(V),new Promise(function(W){setTimeout(function(){V._fullLayout&&(e.getComponentMethod("annotations","draw")(V),e.getComponentMethod("legend","draw")(V),e.getComponentMethod("colorbar","draw")(V),W(o.previousPromises(V)))},300)})},o.resize=function(V){var W;V=a.getGraphDiv(V);var K=new Promise(function(G,Y){V&&!a.isHidden(V)||Y(new Error("Resize must be passed a displayed plot div element.")),V._redrawTimer&&clearTimeout(V._redrawTimer),V._resolveResize&&(W=V._resolveResize),V._resolveResize=G,V._redrawTimer=setTimeout(function(){if(!V.layout||V.layout.width&&V.layout.height||a.isHidden(V))G(V);else{delete V.layout.width,delete V.layout.height;var $=V.changed;V.autoplay=!0,e.call("relayout",V,{autosize:!0}).then(function(){V.changed=$,V._resolveResize===G&&(delete V._resolveResize,G(V))})}},100)});return W&&W(K),K},o.previousPromises=function(V){if((V._promises||[]).length)return Promise.all(V._promises).then(function(){V._promises=[]})},o.addLinks=function(V){if(V._context.showLink||V._context.showSources){var W=V._fullLayout,K=a.ensureSingle(W._paper,"text","js-plot-link-container",function(U){U.style({"font-family":'"Open Sans", Arial, sans-serif',"font-size":"12px",fill:r.defaultLine,"pointer-events":"all"}).each(function(){var te=g.select(this);te.append("tspan").classed("js-link-to-tool",!0),te.append("tspan").classed("js-link-spacer",!0),te.append("tspan").classed("js-sourcelinks",!0)})}),G=K.node(),Y={y:W._paper.attr("height")-9};document.body.contains(G)&&G.getComputedTextLength()>=W.width-20?(Y["text-anchor"]="start",Y.x=5):(Y["text-anchor"]="end",Y.x=W._paper.attr("width")-7),K.attr(Y);var $=K.select(".js-link-to-tool"),B=K.select(".js-link-spacer"),N=K.select(".js-sourcelinks");V._context.showSources&&V._context.showSources(V),V._context.showLink&&function(U,te){te.text("");var j=te.append("a").attr({"xlink:xlink:href":"#",class:"link--impt link--embedview","font-weight":"bold"}).text(U._context.linkText+" "+String.fromCharCode(187));if(U._context.sendData)j.on("click",function(){o.sendDataToCloud(U)});else{var J=window.location.pathname.split("/"),X=window.location.search;j.attr({"xlink:xlink:show":"new","xlink:xlink:href":"/"+J[2].split(".")[0]+"/"+J[1]+X})}}(V,$),B.text($.text()&&N.text()?" - ":"")}},o.sendDataToCloud=function(V){var W=(window.PLOTLYENV||{}).BASE_URL||V._context.plotlyServerURL;if(W){V.emit("plotly_beforeexport");var K=g.select(V).append("div").attr("id","hiddenform").style("display","none"),G=K.append("form").attr({action:W+"/external",method:"post",target:"_blank"});return G.append("input").attr({type:"text",name:"data"}).node().value=o.graphJson(V,!1,"keepdata"),G.node().submit(),K.remove(),V.emit("plotly_afterexport"),!1}};var T=["days","shortDays","months","shortMonths","periods","dateTime","date","time","decimal","thousands","grouping","currency"],_=["year","month","dayMonth","dayMonthYear"];function w(V,W){var K=V._context.locale;K||(K="en-US");var G=!1,Y={};function $(J){for(var X=!0,re=0;re<W.length;re++){var ne=W[re];Y[ne]||(J[ne]?Y[ne]=J[ne]:X=!1)}X&&(G=!0)}for(var B=0;B<2;B++){for(var N=V._context.locales,U=0;U<2;U++){var te=(N[K]||{}).format;if(te&&($(te),G))break;N=e.localeRegistry}var j=K.split("-")[0];if(G||j===K)break;K=j}return G||$(e.localeRegistry.en.format),Y}function k(V,W){var K={_fullLayout:W},G="x"===V._id.charAt(0),Y=V._mainAxis._anchorAxis,$="",B="",N="";if(Y&&(N=Y._mainAxis._id,$=G?V._id+N:N+V._id),!$||!W._plots[$]){$="";for(var U=V._counterAxes,te=0;te<U.length;te++){var j=U[te],J=G?V._id+j:j+V._id;B||(B=J);var X=s.getFromId(K,j);if(N&&X.overlaying===N){$=J;break}}}return $||B}function L(V){var W=V.transforms;if(Array.isArray(W)&&W.length)for(var K=0;K<W.length;K++){var G=W[K],Y=G._module||b[G.type];if(Y&&Y.makesData)return!0}return!1}function M(V,W,K,G){for(var Y=V.transforms,$=[V],B=0;B<Y.length;B++){var N=Y[B],U=b[N.type];U&&U.transform&&($=U.transform($,{transform:N,fullTrace:V,fullData:W,layout:K,fullLayout:G,transformIndex:B}))}return $}function I(V){return"string"==typeof V&&"px"===V.substr(V.length-2)&&parseFloat(V)}function P(V){var W=V.margin;if(!V._size){var K=V._size={l:Math.round(W.l),r:Math.round(W.r),t:Math.round(W.t),b:Math.round(W.b),p:Math.round(W.pad)};K.w=Math.round(V.width)-K.l-K.r,K.h=Math.round(V.height)-K.t-K.b}V._pushmargin||(V._pushmargin={}),V._pushmarginIds||(V._pushmarginIds={})}o.supplyDefaults=function(V,W){var Ie,Fe,K=W&&W.skipUpdateCalc,G=V._fullLayout||{};if(G._skipDefaults)delete G._skipDefaults;else{var Y,$=V._fullLayout={},B=V.layout||{},N=V._fullData||[],U=V._fullData=[],te=V.data||[],j=V.calcdata||[],J=V._context||{};V._transitionData||o.createTransitionData(V),$._dfltTitle={plot:p(V,"Click to enter Plot title"),x:p(V,"Click to enter X axis title"),y:p(V,"Click to enter Y axis title"),colorbar:p(V,"Click to enter Colorscale title"),annotation:p(V,"new text")},$._traceWord=p(V,"trace");var X=w(V,T);if($._mapboxAccessToken=J.mapboxAccessToken,G._initialAutoSizeIsDone){var re=G.width,ne=G.height;o.supplyLayoutGlobalDefaults(B,$,X),B.width||($.width=re),B.height||($.height=ne),o.sanitizeMargins($)}else{o.supplyLayoutGlobalDefaults(B,$,X);var le=!B.width||!B.height,oe=$.autosize;le&&(oe||J.autosizable)?o.plotAutoSize(V,B,$):le&&o.sanitizeMargins($),!oe&&le&&(B.width=$.width,B.height=$.height)}$._d3locale=((Ie=X).decimal=(Fe=$.separators).charAt(0),Ie.thousands=Fe.charAt(1),{numberFormat:function(Re){try{Re=m(Ie).format(a.adjustFormat(Re))}catch{return a.warnBadFormat(Re),a.noFormat}return Re},timeFormat:v(Ie).utcFormat}),$._extraFormat=w(V,_),$._initialAutoSizeIsDone=!0,$._dataLength=te.length,$._modules=[],$._visibleModules=[],$._basePlotModules=[];var se=$._subplots=function(){var Ie,Fe,Re=e.collectableSubplotTypes,Xe={};if(!Re){Re=[];var nt=e.subplotsRegistry;for(var ct in nt){var xt=nt[ct].attr;if(xt&&(Re.push(ct),Array.isArray(xt)))for(Fe=0;Fe<xt.length;Fe++)a.pushUnique(Re,xt[Fe])}}for(Ie=0;Ie<Re.length;Ie++)Xe[Re[Ie]]=[];return Xe}(),ge=$._splomAxes={x:{},y:{}},_e=$._splomSubplots={};$._splomGridDflt={},$._scatterStackOpts={},$._firstScatter={},$._alignmentOpts={},$._colorAxes={},$._requestRangeslider={},$._traceUids=function(Ie,Fe){var Re,Xe,nt=Fe.length,ct=[];for(Re=0;Re<Ie.length;Re++){var xt=Ie[Re]._fullInput;xt!==Xe&&ct.push(xt),Xe=xt}var dt=ct.length,tt=new Array(nt),Ke={};function mt(er,Wt){tt[Wt]=er,Ke[er]=1}function Bt(er,Wt){if(er&&"string"==typeof er&&!Ke[er])return mt(er,Wt),!0}for(Re=0;Re<nt;Re++){var Ut=Fe[Re].uid;"number"==typeof Ut&&(Ut=String(Ut)),Bt(Ut,Re)||Re<dt&&Bt(ct[Re].uid,Re)||mt(a.randstr(Ke),Re)}return tt}(N,te),$._globalTransforms=(V._context||{}).globalTransforms,o.supplyDataDefaults(te,U,B,$);var Te=Object.keys(ge.x),we=Object.keys(ge.y);if(Te.length>1&&we.length>1){for(e.getComponentMethod("grid","sizeDefaults")(B,$),Y=0;Y<Te.length;Y++)a.pushUnique(se.xaxis,Te[Y]);for(Y=0;Y<we.length;Y++)a.pushUnique(se.yaxis,we[Y]);for(var Oe in _e)a.pushUnique(se.cartesian,Oe)}if($._has=o._hasPlotType.bind($),N.length===U.length)for(Y=0;Y<U.length;Y++)h(U[Y],N[Y]);o.supplyLayoutModuleDefaults(B,$,U,V._transitionData);var fe=$._visibleModules,ve=[];for(Y=0;Y<fe.length;Y++){var Ae=fe[Y].crossTraceDefaults;Ae&&a.pushUnique(ve,Ae)}for(Y=0;Y<ve.length;Y++)ve[Y](U,$);$._hasOnlyLargeSploms=1===$._basePlotModules.length&&"splom"===$._basePlotModules[0].name&&Te.length>15&&we.length>15&&0===$.shapes.length&&0===$.images.length,o.linkSubplots(U,$,N,G),o.cleanPlot(U,$,N,G);var ke=!(!G._has||!G._has("gl2d")),Pe=!(!$._has||!$._has("gl2d")),Ne=!(!G._has||!G._has("cartesian"))||ke,De=!(!$._has||!$._has("cartesian"))||Pe;Ne&&!De?G._bgLayer.remove():De&&!Ne&&($._shouldCreateBgLayer=!0),G._zoomlayer&&!V._dragging&&i({_fullLayout:G}),function(Ie,Fe){var Re,Xe=[];Fe.meta&&(Re=Fe._meta={meta:Fe.meta,layout:{meta:Fe.meta}});for(var nt=0;nt<Ie.length;nt++){var ct=Ie[nt];ct.meta?Xe[ct.index]=ct._meta={meta:ct.meta}:Fe.meta&&(ct._meta={meta:Fe.meta}),Fe.meta&&(ct._meta.layout={meta:Fe.meta})}Xe.length&&(Re||(Re=Fe._meta={}),Re.data=Xe)}(U,$),h($,G),e.getComponentMethod("colorscale","crossTraceDefaults")(U,$),$._preGUI||($._preGUI={}),$._tracePreGUI||($._tracePreGUI={});var ze,Me=$._tracePreGUI,Se={};for(ze in Me)Se[ze]="old";for(Y=0;Y<U.length;Y++)Se[ze=U[Y]._fullInput.uid]||(Me[ze]={}),Se[ze]="new";for(ze in Se)"old"===Se[ze]&&delete Me[ze];P($),e.getComponentMethod("rangeslider","makeData")($),K||j.length!==U.length||o.supplyDefaultsUpdateCalc(j,U)}},o.supplyDefaultsUpdateCalc=function(V,W){for(var K=0;K<W.length;K++){var G=W[K],Y=(V[K]||[])[0];if(Y&&Y.trace){var $=Y.trace;if($._hasCalcTransform){var B,N,U,te=$._arrayAttrs;for(B=0;B<te.length;B++)U=a.nestedProperty($,N=te[B]).get().slice(),a.nestedProperty(G,N).set(U)}Y.trace=G}}},o.createTransitionData=function(V){V._transitionData||(V._transitionData={}),V._transitionData._frames||(V._transitionData._frames=[]),V._transitionData._frameHash||(V._transitionData._frameHash={}),V._transitionData._counter||(V._transitionData._counter=0),V._transitionData._interruptCallbacks||(V._transitionData._interruptCallbacks=[])},o._hasPlotType=function(V){var W,K=this._basePlotModules||[];for(W=0;W<K.length;W++)if(K[W].name===V)return!0;var G=this._modules||[];for(W=0;W<G.length;W++){var Y=G[W].name;if(Y===V)return!0;var $=e.modules[Y];if($&&$.categories[V])return!0}return!1},o.cleanPlot=function(V,W,K,G){var Y,$,B=G._basePlotModules||[];for(Y=0;Y<B.length;Y++){var N=B[Y];N.clean&&N.clean(V,W,K,G)}var U=G._has&&G._has("gl"),te=W._has&&W._has("gl");U&&!te&&void 0!==G._glcontainer&&(G._glcontainer.selectAll(".gl-canvas").remove(),G._glcontainer.selectAll(".no-webgl").remove(),G._glcanvas=null);var j=!!G._infolayer;e:for(Y=0;Y<K.length;Y++){var J=K[Y].uid;for($=0;$<V.length;$++)if(J===V[$].uid)continue e;j&&G._infolayer.select(".cb"+J).remove()}},o.linkSubplots=function(V,W,K,G){var Y,$,B=G._plots||{},N=W._plots={},U=W._subplots,te={_fullData:V,_fullLayout:W},j=U.cartesian.concat(U.gl2d||[]);for(Y=0;Y<j.length;Y++){var J,X=j[Y],re=B[X],ne=s.getFromId(te,X,"x"),le=s.getFromId(te,X,"y");for(re?J=N[X]=re:(J=N[X]={}).id=X,ne._counterAxes.push(le._id),le._counterAxes.push(ne._id),ne._subplotsWith.push(X),le._subplotsWith.push(X),J.xaxis=ne,J.yaxis=le,J._hasClipOnAxisFalse=!1,$=0;$<V.length;$++){var oe=V[$];if(oe.xaxis===J.xaxis._id&&oe.yaxis===J.yaxis._id&&!1===oe.cliponaxis){J._hasClipOnAxisFalse=!0;break}}}var de,se=s.list(te,null,!0);for(Y=0;Y<se.length;Y++){var ge=null;(de=se[Y]).overlaying&&(ge=s.getFromId(te,de.overlaying))&&ge.overlaying&&(de.overlaying=!1,ge=null),de._mainAxis=ge||de,ge&&(de.domain=ge.domain.slice()),de._anchorAxis="free"===de.anchor?null:s.getFromId(te,de.anchor)}for(Y=0;Y<se.length;Y++)if((de=se[Y])._counterAxes.sort(s.idSort),de._subplotsWith.sort(a.subplotSort),de._mainSubplot=k(de,W),de._counterAxes.length&&(de.spikemode&&-1!==de.spikemode.indexOf("across")||de.automargin&&de.mirror&&"free"!==de.anchor||e.getComponentMethod("rangeslider","isVisible")(de))){var _e=1,Te=0;for($=0;$<de._counterAxes.length;$++){var we=s.getFromId(te,de._counterAxes[$]);_e=Math.min(_e,we.domain[0]),Te=Math.max(Te,we.domain[1])}_e<Te&&(de._counterDomainMin=_e,de._counterDomainMax=Te)}},o.clearExpandedTraceDefaultColors=function(V){var W,K,G;for(K=[],(W=V._module._colorAttrs)||(V._module._colorAttrs=W=[],n.crawl(V._module.attributes,function(Y,$,B,N){K[N]=$,K.length=N+1,"color"===Y.valType&&void 0===Y.dflt&&W.push(K.join("."))})),G=0;G<W.length;G++)a.nestedProperty(V,"_input."+W[G]).get()||a.nestedProperty(V,W[G]).set(null)},o.supplyDataDefaults=function(V,W,K,G){var Y,$,B,N=G._modules,U=G._visibleModules,te=G._basePlotModules,j=0,J=0;function X(Oe){W.push(Oe);var fe=Oe._module;fe&&(a.pushUnique(N,fe),!0===Oe.visible&&a.pushUnique(U,fe),a.pushUnique(te,Oe._module.basePlotModule),j++,!1!==Oe._input.visible&&J++)}G._transformModules=[];var re={},ne=[],oe=t.traceTemplater((K.template||{}).data||{});for(Y=0;Y<V.length;Y++){if(($=oe.newTrace(B=V[Y])).uid=G._traceUids[Y],o.supplyTraceDefaults(B,$,J,G,Y),$.index=Y,$._input=B,$._expandedIndex=j,$.transforms&&$.transforms.length)for(var de=!1!==B.visible&&!1===$.visible,se=M($,W,K,G),ge=0;ge<se.length;ge++){var _e=se[ge],Te={_template:$._template,type:$.type,uid:$.uid+ge};de&&!1===_e.visible&&delete _e.visible,o.supplyTraceDefaults(_e,Te,j,G,Y),h(Te,_e),Te.index=Y,Te._input=B,Te._fullInput=$,Te._expandedIndex=j,Te._expandedInput=_e,X(Te)}else $._fullInput=$,$._expandedInput=$,X($);e.traceIs($,"carpetAxis")&&(re[$.carpet]=$),e.traceIs($,"carpetDependent")&&ne.push(Y)}for(Y=0;Y<ne.length;Y++)if(($=W[ne[Y]]).visible){var we=re[$.carpet];$._carpet=we,we&&we.visible?($.xaxis=we.xaxis,$.yaxis=we.yaxis):$.visible=!1}},o.supplyAnimationDefaults=function(V){var W;V=V||{};var K={};function G(Y,$){return a.coerce(V||{},K,u,Y,$)}if(G("mode"),G("direction"),G("fromcurrent"),Array.isArray(V.frame))for(K.frame=[],W=0;W<V.frame.length;W++)K.frame[W]=o.supplyAnimationFrameDefaults(V.frame[W]||{});else K.frame=o.supplyAnimationFrameDefaults(V.frame||{});if(Array.isArray(V.transition))for(K.transition=[],W=0;W<V.transition.length;W++)K.transition[W]=o.supplyAnimationTransitionDefaults(V.transition[W]||{});else K.transition=o.supplyAnimationTransitionDefaults(V.transition||{});return K},o.supplyAnimationFrameDefaults=function(V){var W={};function K(G,Y){return a.coerce(V||{},W,u.frame,G,Y)}return K("duration"),K("redraw"),W},o.supplyAnimationTransitionDefaults=function(V){var W={};function K(G,Y){return a.coerce(V||{},W,u.transition,G,Y)}return K("duration"),K("easing"),W},o.supplyFrameDefaults=function(V){var W={};function K(G,Y){return a.coerce(V,W,f,G,Y)}return K("group"),K("name"),K("traces"),K("baseframe"),K("data"),K("layout"),W},o.supplyTraceDefaults=function(V,W,K,G,Y){var $,B=G.colorway||r.defaults,N=B[K%B.length];function U(se,ge){return a.coerce(V,W,o.attributes,se,ge)}var te=U("visible");U("type"),U("name",G._traceWord+" "+Y),U("uirevision",G.uirevision);var j=o.getModule(W);if(W._module=j,j){var J=j.basePlotModule,X=J.attr,re=J.attributes;if(X&&re){var ne=G._subplots,le="";if(te||"gl2d"!==J.name){if(Array.isArray(X))for($=0;$<X.length;$++){var oe=X[$],de=a.coerce(V,W,re,oe);ne[oe]&&a.pushUnique(ne[oe],de),le+=de}else le=a.coerce(V,W,re,X);ne[J.name]&&a.pushUnique(ne[J.name],le)}}}return te&&(U("customdata"),U("ids"),U("meta"),e.traceIs(W,"showLegend")?(a.coerce(V,W,j.attributes.showlegend?j.attributes:o.attributes,"showlegend"),U("legendgroup"),U("legendgrouptitle.text"),U("legendrank"),W._dfltShowLegend=!0):W._dfltShowLegend=!1,j&&j.supplyDefaults(V,W,N,G),e.traceIs(W,"noOpacity")||U("opacity"),e.traceIs(W,"notLegendIsolatable")&&(W.visible=!!W.visible),e.traceIs(W,"noHover")||(W.hovertemplate||a.coerceHoverinfo(V,W,G),"parcats"!==W.type&&e.getComponentMethod("fx","supplyDefaults")(V,W,N,G)),j&&j.selectPoints&&U("selectedpoints"),o.supplyTransformDefaults(V,W,G)),W},o.hasMakesDataTransform=L,o.supplyTransformDefaults=function(V,W,K){if(W._length||L(V)){var G=K._globalTransforms||[],Y=K._transformModules||[];if(Array.isArray(V.transforms)||0!==G.length)for(var B=G.concat(V.transforms||[]),N=W.transforms=[],U=0;U<B.length;U++){var te,j=B[U],J=j.type,X=b[J],re=!(j._module&&j._module===X),ne=X&&"function"==typeof X.transform;X||a.warn("Unrecognized transform type "+J+"."),X&&X.supplyDefaults&&(re||ne)?((te=X.supplyDefaults(j,W,K,V)).type=J,te._module=X,a.pushUnique(Y,X)):te=a.extendFlat({},j),N.push(te)}}},o.supplyLayoutGlobalDefaults=function(V,W,K){function G(U,te){return a.coerce(V,W,o.layoutAttributes,U,te)}var Y=V.template;a.isPlainObject(Y)&&(W.template=Y,W._template=Y.layout,W._dataTemplate=Y.data),G("autotypenumbers");var $=a.coerceFont(G,"font");a.coerceFont(G,"title.font",a.extendFlat({},$,{size:Math.round(1.4*$.size)})),G("title.text",W._dfltTitle.plot),G("title.xref"),G("title.yref"),G("title.x"),G("title.y"),G("title.xanchor"),G("title.yanchor"),G("title.pad.t"),G("title.pad.r"),G("title.pad.b"),G("title.pad.l"),G("uniformtext.mode")&&G("uniformtext.minsize"),G("autosize",!(V.width&&V.height)),G("width"),G("height"),G("margin.l"),G("margin.r"),G("margin.t"),G("margin.b"),G("margin.pad"),G("margin.autoexpand"),V.width&&V.height&&o.sanitizeMargins(W),e.getComponentMethod("grid","sizeDefaults")(V,W),G("paper_bgcolor"),G("separators",K.decimal+K.thousands),G("hidesources"),G("colorway"),G("datarevision");var N=G("uirevision");G("editrevision",N),G("selectionrevision",N),e.getComponentMethod("modebar","supplyLayoutDefaults")(V,W),e.getComponentMethod("shapes","supplyDrawNewShapeDefaults")(V,W,G),e.getComponentMethod("selections","supplyDrawNewSelectionDefaults")(V,W,G),G("meta"),a.isPlainObject(V.transition)&&(G("transition.duration"),G("transition.easing"),G("transition.ordering")),e.getComponentMethod("calendars","handleDefaults")(V,W,"calendar"),e.getComponentMethod("fx","supplyLayoutGlobalDefaults")(V,W,G)},o.plotAutoSize=function(V,W,K){var G,Y,$=V._context||{},B=$.frameMargins,N=a.isPlotDiv(V);if(N&&V.emit("plotly_autosize"),$.fillFrame)G=window.innerWidth,Y=window.innerHeight,document.body.style.overflow="hidden";else{var U=N?window.getComputedStyle(V):{};if(G=I(U.width)||I(U.maxWidth)||K.width,Y=I(U.height)||I(U.maxHeight)||K.height,x(B)&&B>0){var te=1-2*B;G=Math.round(te*G),Y=Math.round(te*Y)}}var j=o.layoutAttributes.width.min,J=o.layoutAttributes.height.min;G<j&&(G=j),Y<J&&(Y=J);var X=!W.width&&Math.abs(K.width-G)>1,re=!W.height&&Math.abs(K.height-Y)>1;(re||X)&&(X&&(K.width=G),re&&(K.height=Y)),V._initialAutoSize||(V._initialAutoSize={width:G,height:Y}),o.sanitizeMargins(K)},o.supplyLayoutModuleDefaults=function(V,W,K,G){var Y,$,B,N=e.componentsRegistry,U=W._basePlotModules,te=e.subplotsRegistry.cartesian;for(Y in N)(B=N[Y]).includeBasePlot&&B.includeBasePlot(V,W);for(var j in U.length||U.push(te),W._has("cartesian")&&(e.getComponentMethod("grid","contentDefaults")(V,W),te.finalizeSubplots(V,W)),W._subplots)W._subplots[j].sort(a.subplotSort);for($=0;$<U.length;$++)(B=U[$]).supplyLayoutDefaults&&B.supplyLayoutDefaults(V,W,K);var J=W._modules;for($=0;$<J.length;$++)(B=J[$]).supplyLayoutDefaults&&B.supplyLayoutDefaults(V,W,K);var X=W._transformModules;for($=0;$<X.length;$++)(B=X[$]).supplyLayoutDefaults&&B.supplyLayoutDefaults(V,W,K,G);for(Y in N)(B=N[Y]).supplyLayoutDefaults&&B.supplyLayoutDefaults(V,W,K)},o.purge=function(V){var W=V._fullLayout||{};void 0!==W._glcontainer&&(W._glcontainer.selectAll(".gl-canvas").remove(),W._glcontainer.remove(),W._glcanvas=null),W._modeBar&&W._modeBar.destroy(),V._transitionData&&(V._transitionData._interruptCallbacks&&(V._transitionData._interruptCallbacks.length=0),V._transitionData._animationRaf&&window.cancelAnimationFrame(V._transitionData._animationRaf)),a.clearThrottle(),a.clearResponsive(V),delete V.data,delete V.layout,delete V._fullData,delete V._fullLayout,delete V.calcdata,delete V.empty,delete V.fid,delete V.undoqueue,delete V.undonum,delete V.autoplay,delete V.changed,delete V._promises,delete V._redrawTimer,delete V._hmlumcount,delete V._hmpixcount,delete V._transitionData,delete V._transitioning,delete V._initialAutoSize,delete V._transitioningWithDuration,delete V._dragging,delete V._dragged,delete V._dragdata,delete V._hoverdata,delete V._snapshotInProgress,delete V._editing,delete V._mouseDownTime,delete V._legendMouseDownTime,V.removeAllListeners&&V.removeAllListeners()},o.style=function(V){var W,K=V._fullLayout._visibleModules,G=[];for(W=0;W<K.length;W++){var Y=K[W];Y.style&&a.pushUnique(G,Y.style)}for(W=0;W<G.length;W++)G[W](V)},o.sanitizeMargins=function(V){if(V&&V.margin){var W,K=V.width,G=V.height,Y=V.margin,B=G-(Y.t+Y.b);K-(Y.l+Y.r)<0&&(W=(K-1)/(Y.l+Y.r),Y.l=Math.floor(W*Y.l),Y.r=Math.floor(W*Y.r)),B<0&&(W=(G-1)/(Y.t+Y.b),Y.t=Math.floor(W*Y.t),Y.b=Math.floor(W*Y.b))}},o.clearAutoMarginIds=function(V){V._fullLayout._pushmarginIds={}},o.allowAutoMargin=function(V,W){V._fullLayout._pushmarginIds[W]=1},o.autoMargin=function(V,W,K){var G=V._fullLayout,Y=G.width,$=G.height,B=G.margin,N=a.constrain(Y-B.l-B.r,2,64),U=a.constrain($-B.t-B.b,2,64),te=Math.max(0,Y-N),j=Math.max(0,$-U),J=G._pushmargin,X=G._pushmarginIds;if(!1!==B.autoexpand){if(K){var re=K.pad;if(void 0===re&&(re=Math.min(12,B.l,B.r,B.t,B.b)),te){var ne=(K.l+K.r)/te;ne>1&&(K.l/=ne,K.r/=ne)}if(j){var le=(K.t+K.b)/j;le>1&&(K.t/=le,K.b/=le)}J[W]={l:{val:void 0!==K.xl?K.xl:K.x,size:K.l+re},r:{val:void 0!==K.xr?K.xr:K.x,size:K.r+re},b:{val:void 0!==K.yb?K.yb:K.y,size:K.b+re},t:{val:void 0!==K.yt?K.yt:K.y,size:K.t+re}},X[W]=1}else delete J[W],delete X[W];if(!G._replotting)return o.doAutoMargin(V)}},o.doAutoMargin=function(V){var W=V._fullLayout,K=W.width,G=W.height;W._size||(W._size={}),P(W);var Y=W._size,$=W.margin,B=a.extendFlat({},Y),N=$.l,U=$.r,te=$.t,j=$.b,J=W._pushmargin,X=W._pushmarginIds;if(!1!==W.margin.autoexpand){for(var re in J)X[re]||delete J[re];for(var ne in J.base={l:{val:0,size:N},r:{val:1,size:U},t:{val:1,size:te},b:{val:0,size:j}},J){var le=J[ne].l||{},oe=J[ne].b||{},de=le.val,se=le.size,ge=oe.val,_e=oe.size;for(var Te in J){if(x(se)&&J[Te].r){var we=J[Te].r.val,Oe=J[Te].r.size;if(we>de){var fe=(se*we+(Oe-K)*de)/(we-de),ve=(Oe*(1-de)+(se-K)*(1-we))/(we-de);fe+ve>N+U&&(N=fe,U=ve)}}if(x(_e)&&J[Te].t){var Ae=J[Te].t.val,ke=J[Te].t.size;if(Ae>ge){var Pe=(_e*Ae+(ke-G)*ge)/(Ae-ge),Ne=(ke*(1-ge)+(_e-G)*(1-Ae))/(Ae-ge);Pe+Ne>j+te&&(j=Pe,te=Ne)}}}}}var nt,De=a.constrain(K-$.l-$.r,2,64),ze=a.constrain(G-$.t-$.b,2,64),Me=Math.max(0,K-De),Se=Math.max(0,G-ze);if(Me){var Ie=(N+U)/Me;Ie>1&&(N/=Ie,U/=Ie)}if(Se){var Fe=(j+te)/Se;Fe>1&&(j/=Fe,te/=Fe)}if(Y.l=Math.round(N),Y.r=Math.round(U),Y.t=Math.round(te),Y.b=Math.round(j),Y.p=Math.round($.pad),Y.w=Math.round(K)-Y.l-Y.r,Y.h=Math.round(G)-Y.t-Y.b,!W._replotting&&o.didMarginChange(B,Y)){"_redrawFromAutoMarginCount"in W?W._redrawFromAutoMarginCount++:W._redrawFromAutoMarginCount=1;var Re=3*(1+Object.keys(X).length);if(W._redrawFromAutoMarginCount<Re)return e.call("_doPlot",V);W._size=B,a.warn("Too many auto-margin redraws.")}nt=s.list(V,"",!0),["_adjustTickLabelsOverflow","_hideCounterAxisInsideTickLabels"].forEach(function(ct){for(var xt=0;xt<nt.length;xt++){var dt=nt[xt][ct];dt&&dt()}})};var S=["l","r","t","b","p","w","h"];function E(V,W,K){var G=!1,$=a.syncOrAsync([o.previousPromises,function(){if(V._transitionData)return V._transitioning=!1,function(B){var N=Promise.resolve();if(!B)return N;for(;B.length;)N=N.then(B.shift());return N}(V._transitionData._interruptCallbacks)},K.prepareFn,o.rehover,o.reselect,function(){return V.emit("plotly_transitioning",[]),new Promise(function(B){V._transitioning=!0,W.duration>0&&(V._transitioningWithDuration=!0),V._transitionData._interruptCallbacks.push(function(){G=!0}),K.redraw&&V._transitionData._interruptCallbacks.push(function(){return e.call("redraw",V)}),V._transitionData._interruptCallbacks.push(function(){V.emit("plotly_transitioninterrupted",[])});var N=0,U=0;function te(){return N++,function(){var j;U++,G||U!==N||(j=B,!V._transitionData||(function(J){if(J)for(;J.length;)J.shift()}(V._transitionData._interruptCallbacks),Promise.resolve().then(function(){if(K.redraw)return e.call("redraw",V)}).then(function(){V._transitioning=!1,V._transitioningWithDuration=!1,V.emit("plotly_transitioned",[])}).then(j)))}}K.runFn(te),setTimeout(te())})}],V);return $&&$.then||($=Promise.resolve()),$.then(function(){return V})}o.didMarginChange=function(V,W){for(var K=0;K<S.length;K++){var G=S[K],Y=V[G],$=W[G];if(!x(Y)||Math.abs($-Y)>1)return!0}return!1},o.graphJson=function(V,W,K,G,Y,$){(Y&&W&&!V._fullData||Y&&!W&&!V._fullLayout)&&o.supplyDefaults(V);var N=Y?V._fullLayout:V.layout,U=(V._transitionData||{})._frames;function te(X,re){if("function"==typeof X)return re?"_function_":null;if(a.isPlainObject(X)){var ne,le={};return Object.keys(X).sort().forEach(function(oe){if(-1===["_","["].indexOf(oe.charAt(0)))if("function"!=typeof X[oe]){if("keepdata"===K){if("src"===oe.substr(oe.length-3))return}else if("keepstream"===K){if("string"==typeof(ne=X[oe+"src"])&&ne.indexOf(":")>0&&!a.isPlainObject(X.stream))return}else if("keepall"!==K&&"string"==typeof(ne=X[oe+"src"])&&ne.indexOf(":")>0)return;le[oe]=te(X[oe],re)}else re&&(le[oe]="_function")}),le}return Array.isArray(X)?X.map(function(oe){return te(oe,re)}):a.isTypedArray(X)?a.simpleMap(X,a.identity):a.isJSDate(X)?a.ms2DateTimeLocal(+X):X}var j={data:((Y?V._fullData:V.data)||[]).map(function(X){var re=te(X);return W&&delete re.fit,re})};if(!W&&(j.layout=te(N),Y)){var J=N._size;j.layout.computed={margin:{b:J.b,l:J.l,r:J.r,t:J.t}}}return U&&(j.frames=te(U)),$&&(j.config=te(V._context,!0)),"object"===G?j:JSON.stringify(j)},o.modifyFrames=function(V,W){var K,G,Y,$=V._transitionData._frames,B=V._transitionData._frameHash;for(K=0;K<W.length;K++)switch((G=W[K]).type){case"replace":var N=($[G.index]||{}).name,U=(Y=G.value).name;$[G.index]=B[U]=Y,U!==N&&(delete B[N],B[U]=Y);break;case"insert":B[(Y=G.value).name]=Y,$.splice(G.index,0,Y);break;case"delete":delete B[(Y=$[G.index]).name],$.splice(G.index,1)}return Promise.resolve()},o.computeFrame=function(V,W){var K,G,Y,$,B=V._transitionData._frameHash;if(!W)throw new Error("computeFrame must be given a string frame name");var N=B[W.toString()];if(!N)return!1;for(var U=[N],te=[N.name];N.baseframe&&(N=B[N.baseframe.toString()])&&-1===te.indexOf(N.name);)U.push(N),te.push(N.name);for(var j={};N=U.pop();)if(N.layout&&(j.layout=o.extendLayout(j.layout,N.layout)),N.data){if(j.data||(j.data=[]),!(G=N.traces))for(G=[],K=0;K<N.data.length;K++)G[K]=K;for(j.traces||(j.traces=[]),K=0;K<N.data.length;K++)null!=(Y=G[K])&&(-1===($=j.traces.indexOf(Y))&&(j.traces[$=j.data.length]=Y),j.data[$]=o.extendTrace(j.data[$],N.data[K]))}return j},o.recomputeFrameHash=function(V){for(var W=V._transitionData._frameHash={},K=V._transitionData._frames,G=0;G<K.length;G++){var Y=K[G];Y&&Y.name&&(W[Y.name]=Y)}},o.extendObjectWithContainers=function(V,W,K){var G,Y,$,B,N,U,te,j=a.extendDeepNoArrays({},W||{}),J=a.expandObjectPaths(j),X={};if(K&&K.length)for($=0;$<K.length;$++)void 0===(Y=(G=a.nestedProperty(J,K[$])).get())?a.nestedProperty(X,K[$]).set(null):(G.set(null),a.nestedProperty(X,K[$]).set(Y));if(V=a.extendDeepNoArrays(V||{},J),K&&K.length)for($=0;$<K.length;$++)if(U=a.nestedProperty(X,K[$]).get()){for(te=(N=a.nestedProperty(V,K[$])).get(),Array.isArray(te)||N.set(te=[]),B=0;B<U.length;B++){var re=U[B];te[B]=null===re?null:o.extendObjectWithContainers(te[B],re)}N.set(te)}return V},o.dataArrayContainers=["transforms","dimensions"],o.layoutArrayContainers=e.layoutArrayContainers,o.extendTrace=function(V,W){return o.extendObjectWithContainers(V,W,o.dataArrayContainers)},o.extendLayout=function(V,W){return o.extendObjectWithContainers(V,W,o.layoutArrayContainers)},o.transition=function(V,W,K,G,Y,$){var B={redraw:Y.redraw},N={},U=[];return B.prepareFn=function(){for(var te=Array.isArray(W)?W.length:0,j=G.slice(0,te),J=0;J<j.length;J++){var X=j[J],re=V._fullData[X]._module;if(re){if(re.animatable){var ne=re.basePlotModule.name;N[ne]||(N[ne]=[]),N[ne].push(X)}V.data[j[J]]=o.extendTrace(V.data[j[J]],W[J])}}var le=a.expandObjectPaths(a.extendDeepNoArrays({},K)),oe=/^[xy]axis[0-9]*$/;for(var de in le)oe.test(de)&&delete le[de].range;o.extendLayout(V.layout,le),delete V.calcdata,o.supplyDefaults(V),o.doCalcdata(V);var se=a.expandObjectPaths(K);if(se){var ge=V._fullLayout._plots;for(var _e in ge){var Te=ge[_e],we=Te.xaxis,Oe=Te.yaxis,fe=we.range.slice(),ve=Oe.range.slice(),Ae=null,ke=null,Pe=null,Ne=null;Array.isArray(se[we._name+".range"])?Ae=se[we._name+".range"].slice():Array.isArray((se[we._name]||{}).range)&&(Ae=se[we._name].range.slice()),Array.isArray(se[Oe._name+".range"])?ke=se[Oe._name+".range"].slice():Array.isArray((se[Oe._name]||{}).range)&&(ke=se[Oe._name].range.slice()),fe&&Ae&&(we.r2l(fe[0])!==we.r2l(Ae[0])||we.r2l(fe[1])!==we.r2l(Ae[1]))&&(Pe={xr0:fe,xr1:Ae}),ve&&ke&&(Oe.r2l(ve[0])!==Oe.r2l(ke[0])||Oe.r2l(ve[1])!==Oe.r2l(ke[1]))&&(Ne={yr0:ve,yr1:ke}),(Pe||Ne)&&U.push(a.extendFlat({plotinfo:Te},Pe,Ne))}}return Promise.resolve()},B.runFn=function(te){var j,J,X=V._fullLayout._basePlotModules,re=U.length;if(K)for(J=0;J<X.length;J++)X[J].transitionAxes&&X[J].transitionAxes(V,U,$,te);for(var ne in re?((j=a.extendFlat({},$)).duration=0,delete N.cartesian):j=$,N){var le=N[ne];V._fullData[le[0]]._module.basePlotModule.plot(V,le,j,te)}},E(V,$,B)},o.transitionFromReact=function(V,W,K,G){var Y=V._fullLayout,$=Y.transition,B={},N=[];return B.prepareFn=function(){var U=Y._plots;for(var te in B.redraw=!1,"some"===W.anim&&(B.redraw=!0),"some"===K.anim&&(B.redraw=!0),U){var j=U[te],J=j.xaxis,X=j.yaxis,re=G[J._name].range.slice(),ne=G[X._name].range.slice(),le=J.range.slice(),oe=X.range.slice();J.setScale(),X.setScale();var de=null,se=null;J.r2l(re[0])===J.r2l(le[0])&&J.r2l(re[1])===J.r2l(le[1])||(de={xr0:re,xr1:le}),X.r2l(ne[0])===X.r2l(oe[0])&&X.r2l(ne[1])===X.r2l(oe[1])||(se={yr0:ne,yr1:oe}),(de||se)&&N.push(a.extendFlat({plotinfo:j},de,se))}return Promise.resolve()},B.runFn=function(U){for(var te,j,J,X=V._fullData,re=V._fullLayout._basePlotModules,ne=[],le=0;le<X.length;le++)ne.push(le);function oe(){if(V._fullLayout)for(var se=0;se<re.length;se++)re[se].transitionAxes&&re[se].transitionAxes(V,N,te,U)}function de(){if(V._fullLayout)for(var se=0;se<re.length;se++)re[se].plot(V,J,j,U)}N.length&&W.anim?"traces first"===$.ordering?(te=a.extendFlat({},$,{duration:0}),J=ne,j=$,setTimeout(oe,$.duration),de()):(te=$,J=null,j=a.extendFlat({},$,{duration:0}),setTimeout(de,te.duration),oe()):N.length?(te=$,oe()):W.anim&&(J=ne,j=$,de())},E(V,$,B)},o.doCalcdata=function(V,W){var K,G,Y,$,B=s.list(V),N=V._fullData,U=V._fullLayout,te=new Array(N.length),j=(V.calcdata||[]).slice();for(V.calcdata=te,U._numBoxes=0,U._numViolins=0,U._violinScaleGroupStats={},V._hmpixcount=0,V._hmlumcount=0,U._piecolormap={},U._sunburstcolormap={},U._treemapcolormap={},U._iciclecolormap={},U._funnelareacolormap={},Y=0;Y<N.length;Y++)Array.isArray(W)&&-1===W.indexOf(Y)&&(te[Y]=j[Y]);for(Y=0;Y<N.length;Y++)(K=N[Y])._arrayAttrs=n.findArrayAttributes(K),K._extremes={};var J=U._subplots.polar||[];for(Y=0;Y<J.length;Y++)B.push(U[J[Y]].radialaxis,U[J[Y]].angularaxis);for(var X in U._colorAxes){var re=U[X];!1!==re.cauto&&(delete re.cmin,delete re.cmax)}var ne=!1;function le(se){if(G=(K=N[se])._module,!0===K.visible&&K.transforms){if(G&&G.calc){var ge=G.calc(V,K);ge[0]&&ge[0].t&&ge[0].t._scene&&delete ge[0].t._scene.dirty}for($=0;$<K.transforms.length;$++){var _e=K.transforms[$];(G=b[_e.type])&&G.calcTransform&&(K._hasCalcTransform=!0,ne=!0,G.calcTransform(V,K,_e))}}}function oe(se,ge){if(!!(G=(K=N[se])._module).isContainer===ge){var _e=[];if(!0===K.visible&&0!==K._length){delete K._indexToPoints;var Te=K.transforms||[];for($=Te.length-1;$>=0;$--)if(Te[$].enabled){K._indexToPoints=Te[$]._indexToPoints;break}G&&G.calc&&(_e=G.calc(V,K))}Array.isArray(_e)&&_e[0]||(_e=[{x:d,y:d}]),_e[0].t||(_e[0].t={}),_e[0].trace=K,te[se]=_e}}for(R(B,N,U),Y=0;Y<N.length;Y++)oe(Y,!0);for(Y=0;Y<N.length;Y++)le(Y);for(ne&&R(B,N,U),Y=0;Y<N.length;Y++)oe(Y,!0);for(Y=0;Y<N.length;Y++)oe(Y,!1);q(V);var de=function(se,ge){var _e,Te,we,Oe,fe,ve=[];function Ae(Ht,Ve,We){var he=Ve._id.charAt(0);if("histogram2dcontour"===Ht){var ye=Ve._counterAxes[0],Be=s.getFromId(ge,ye),Ge="x"===he||"x"===ye&&"category"===Be.type,Je="y"===he||"y"===ye&&"category"===Be.type;return function(He,st){return 0===He||0===st||Ge&&He===We[st].length-1||Je&&st===We.length-1?-1:("y"===he?st:He)-1}}return function(He,st){return"y"===he?st:He}}var ke={min:function(Ht){return a.aggNums(Math.min,null,Ht)},max:function(Ht){return a.aggNums(Math.max,null,Ht)},sum:function(Ht){return a.aggNums(function(Ve,We){return Ve+We},null,Ht)},total:function(Ht){return a.aggNums(function(Ve,We){return Ve+We},null,Ht)},mean:function(Ht){return a.mean(Ht)},median:function(Ht){return a.median(Ht)}};for(_e=0;_e<se.length;_e++){var Pe=se[_e];if("category"===Pe.type){var Ne=Pe.categoryorder.match(z);if(Ne){var De=Ne[1],ze=Ne[2],Me=Pe._id.charAt(0),Se="x"===Me,Ie=[];for(Te=0;Te<Pe._categories.length;Te++)Ie.push([Pe._categories[Te],[]]);for(Te=0;Te<Pe._traceIndices.length;Te++){var Fe=Pe._traceIndices[Te],Re=ge._fullData[Fe];if(!0===Re.visible){var Xe=Re.type;e.traceIs(Re,"histogram")&&(delete Re._xautoBinFinished,delete Re._yautoBinFinished);var nt="splom"===Xe,ct="scattergl"===Xe,xt=ge.calcdata[Fe];for(we=0;we<xt.length;we++){var dt,tt,Ke=xt[we];if(nt){var mt=Re._axesDim[Pe._id];if(!Se){var Bt=Re._diag[mt][0];Bt&&(Pe=ge._fullLayout[s.id2name(Bt)])}var Ut=Ke.trace.dimensions[mt].values;for(Oe=0;Oe<Ut.length;Oe++)for(dt=Pe._categoriesMap[Ut[Oe]],fe=0;fe<Ke.trace.dimensions.length;fe++)fe!==mt&&Ie[dt][1].push(Ke.trace.dimensions[fe].values[Oe])}else if(ct){for(Oe=0;Oe<Ke.t.x.length;Oe++)Se?(dt=Ke.t.x[Oe],tt=Ke.t.y[Oe]):(dt=Ke.t.y[Oe],tt=Ke.t.x[Oe]),Ie[dt][1].push(tt);Ke.t&&Ke.t._scene&&delete Ke.t._scene.dirty}else if(Ke.hasOwnProperty("z")){var Wt=Ae(Re.type,Pe,tt=Ke.z);for(Oe=0;Oe<tt.length;Oe++)for(fe=0;fe<tt[Oe].length;fe++)(dt=Wt(fe,Oe))+1&&Ie[dt][1].push(tt[Oe][fe])}else for(void 0===(dt=Ke.p)&&(dt=Ke[Me]),void 0===(tt=Ke.s)&&(tt=Ke.v),void 0===tt&&(tt=Se?Ke.y:Ke.x),Array.isArray(tt)||(tt=void 0===tt?[]:[tt]),Oe=0;Oe<tt.length;Oe++)Ie[dt][1].push(tt[Oe])}}}Pe._categoriesValue=Ie;var rr=[];for(Te=0;Te<Ie.length;Te++)rr.push([Ie[Te][0],ke[De](Ie[Te][1])]);rr.sort(function(Ht,Ve){return Ht[1]-Ve[1]}),Pe._categoriesAggregatedValue=rr,Pe._initialCategories=rr.map(function(Ht){return Ht[0]}),"descending"===ze&&Pe._initialCategories.reverse(),ve=ve.concat(Pe.sortByInitialCategories())}}}return ve}(B,V);if(de.length){for(U._numBoxes=0,U._numViolins=0,Y=0;Y<de.length;Y++)oe(de[Y],!0);for(Y=0;Y<de.length;Y++)oe(de[Y],!1);q(V)}e.getComponentMethod("fx","calc")(V),e.getComponentMethod("errorbars","calc")(V)};var z=/(total|sum|min|max|mean|median) (ascending|descending)/;function R(V,W,K){var G={};function Y(U){U.clearCalc(),"multicategory"===U.type&&U.setupMultiCategory(W),G[U._id]=1}a.simpleMap(V,Y);for(var $=K._axisMatchGroups||[],B=0;B<$.length;B++)for(var N in $[B])G[N]||Y(K[s.id2name(N)])}function q(V){var W,K,G,Y=V._fullLayout,$=Y._visibleModules,B={};for(K=0;K<$.length;K++){var N=$[K],U=N.crossTraceCalc;if(U){var te=N.basePlotModule.name;B[te]?a.pushUnique(B[te],U):B[te]=[U]}}for(G in B){var j=B[G],J=Y._subplots[G];if(Array.isArray(J))for(W=0;W<J.length;W++){var X=J[W],re="cartesian"===G?Y._plots[X]:Y[X];for(K=0;K<j.length;K++)j[K](V,re,X)}else for(K=0;K<j.length;K++)j[K](V)}}o.rehover=function(V){V._fullLayout._rehover&&V._fullLayout._rehover()},o.redrag=function(V){V._fullLayout._redrag&&V._fullLayout._redrag()},o.reselect=function(V){e.getComponentMethod("selections","reselect")(V)},o.generalUpdatePerTraceModule=function(V,W,K,G){var Y,$=W.traceHash,B={};for(Y=0;Y<K.length;Y++){var N=K[Y],U=N[0].trace;U.visible&&(B[U.type]=B[U.type]||[],B[U.type].push(N))}for(var te in $)if(!B[te]){var j=$[te][0];j[0].trace.visible=!1,B[te]=[j]}for(var J in B){var X=B[J];X[0][0].trace._module.plot(V,W,a.filterVisible(X),G)}W.traceHash=B},o.plotBasePlot=function(V,W,K,G,Y){var $=e.getModule(V),B=c(W.calcdata,$)[0];$.plot(W,B,G,Y)},o.cleanBasePlot=function(V,W,K,G,Y){var $=Y._has&&Y._has(V),B=K._has&&K._has(V);$&&!B&&Y["_"+V+"layer"].selectAll("g.trace").remove()}},{"../components/color":367,"../components/shapes/handle_outline":468,"../constants/numerical":491,"../lib":515,"../plot_api/plot_schema":554,"../plot_api/plot_template":555,"../plots/get_data":602,"../registry":647,"./animation_attributes":560,"./attributes":562,"./cartesian/axis_ids":570,"./command":592,"./font_attributes":594,"./frame_attributes":595,"./layout_attributes":619,"@plotly/d3":58,"d3-format":112,"d3-time-format":120,"fast-isnumeric":190}],629:[function(y,ee,Q){"use strict";ee.exports={attr:"subplot",name:"polar",axisNames:["angularaxis","radialaxis"],axisName2dataArray:{angularaxis:"theta",radialaxis:"r"},layerNames:["draglayer","plotbg","backplot","angular-grid","radial-grid","frontplot","angular-line","radial-line","angular-axis","radial-axis"],radialDragBoxSize:50,angularDragBoxSize:30,cornerLen:25,cornerHalfWidth:2,MINDRAG:8,MINZOOM:20,OFFEDGE:20}},{}],630:[function(y,ee,Q){"use strict";var g=y("../../lib"),v=y("../../lib/polygon").tester,m=g.findIndexOfMin,x=g.isAngleInsideSector,e=g.angleDelta,n=g.angleDist;function t(s,i,u,f){var c,h,p=f[0],o=f[1],b=r(Math.sin(i)-Math.sin(s)),l=r(Math.cos(i)-Math.cos(s)),T=Math.tan(u),_=r(1/T),w=b/l,k=o-w*p;return _?b&&l?h=T*(c=k/(T-w)):l?(c=o*_,h=o):(c=p,h=p*T):b&&l?(c=0,h=k):l?(c=0,h=o):c=h=NaN,[c,h]}function a(s,i,u,f){return g.isFullCircle([i,u])?function(c,h){var p,o=h.length,b=new Array(o+1);for(p=0;p<o;p++){var l=h[p];b[p]=[c*Math.cos(l),c*Math.sin(l)]}return b[p]=b[0].slice(),b}(s,f):function(c,h,p,o){var b,l,T=o.length,_=[];function w(R){return[c*Math.cos(R),c*Math.sin(R)]}function k(R,q,V){return t(R,q,V,w(R))}function L(R){return g.mod(R,T)}function M(R){return x(R,[h,p])}var I=m(o,function(R){return M(R)?n(R,h):1/0}),P=k(o[I],o[L(I-1)],h);for(_.push(P),b=I,l=0;l<T;b++,l++){var S=o[L(b)];if(!M(S))break;_.push(w(S))}var E=m(o,function(R){return M(R)?n(R,p):1/0}),z=k(o[E],o[L(E+1)],p);return _.push(z),_.push([0,0]),_.push(_[0].slice()),_}(s,i,u,f)}function r(s){return Math.abs(s)>1e-10?s:0}function d(s,i,u){i=i||0,u=u||0;for(var f=s.length,c=new Array(f),h=0;h<f;h++){var p=s[h];c[h]=[i+p[0],u-p[1]]}return c}ee.exports={isPtInsidePolygon:function(s,i,u,f,c){if(!x(i,f))return!1;var h,p;u[0]<u[1]?(h=u[0],p=u[1]):(h=u[1],p=u[0]);var o=v(a(h,f[0],f[1],c)),b=v(a(p,f[0],f[1],c)),l=[s*Math.cos(i),s*Math.sin(i)];return b.contains(l)&&!o.contains(l)},findPolygonOffset:function(s,i,u,f){for(var c=1/0,h=1/0,p=a(s,i,u,f),o=0;o<p.length;o++){var b=p[o];c=Math.min(c,b[0]),h=Math.min(h,-b[1])}return[c,h]},findEnclosingVertexAngles:function(s,i){var u=m(i,function(c){var h=e(c,s);return h>0?h:1/0}),f=g.mod(u+1,i.length);return[i[u],i[f]]},findIntersectionXY:t,findXYatLength:function(s,i,u,f){var c=-i*u,h=i*i+1,p=2*(i*c-u),b=Math.sqrt(p*p-4*h*(c*c+u*u-s*s)),l=(-p+b)/(2*h),T=(-p-b)/(2*h);return[[l,i*l+c+f],[T,i*T+c+f]]},clampTiny:r,pathPolygon:function(s,i,u,f,c,h){return"M"+d(a(s,i,u,f),c,h).join("L")},pathPolygonAnnulus:function(s,i,u,f,c,h,p){var o,b;s<i?(o=s,b=i):(o=i,b=s);var l=d(a(o,u,f,c),h,p);return"M"+d(a(b,u,f,c),h,p).reverse().join("L")+"M"+l.join("L")}}},{"../../lib":515,"../../lib/polygon":527}],631:[function(y,ee,Q){"use strict";var g=y("../get_data").getSubplotCalcData,v=y("../../lib").counterRegex,m=y("./polar"),x=y("./constants"),e=x.attr,n=x.name,t=v(n),a={};a[e]={valType:"subplotid",dflt:n,editType:"calc"},ee.exports={attr:e,name:n,idRoot:n,idRegex:t,attrRegex:t,attributes:a,layoutAttributes:y("./layout_attributes"),supplyLayoutDefaults:y("./layout_defaults"),plot:function(r){for(var d=r._fullLayout,s=r.calcdata,i=d._subplots[n],u=0;u<i.length;u++){var f=i[u],c=g(s,n,f),h=d[f]._subplot;h||(h=m(r,f),d[f]._subplot=h),h.plot(c,d,r._promises)}},clean:function(r,d,s,i){for(var u=i._subplots[n]||[],f=i._has&&i._has("gl"),c=d._has&&d._has("gl"),h=f&&!c,p=0;p<u.length;p++){var o=u[p],b=i[o]._subplot;if(!d[o]&&b)for(var l in b.framework.remove(),b.layers["radial-axis-title"].remove(),b.clipPaths)b.clipPaths[l].remove();h&&b._scene&&(b._scene.destroy(),b._scene=null)}},toSVG:y("../cartesian").toSVG}},{"../../lib":515,"../cartesian":578,"../get_data":602,"./constants":629,"./layout_attributes":632,"./layout_defaults":633,"./polar":634}],632:[function(y,ee,Q){"use strict";var g=y("../../components/color/attributes"),v=y("../cartesian/layout_attributes"),m=y("../domain").attributes,x=y("../../lib").extendFlat,e=y("../../plot_api/edit_types").overrideAll,n=e({color:v.color,showline:x({},v.showline,{dflt:!0}),linecolor:v.linecolor,linewidth:v.linewidth,showgrid:x({},v.showgrid,{dflt:!0}),gridcolor:v.gridcolor,gridwidth:v.gridwidth,griddash:v.griddash},"plot","from-root"),t=e({tickmode:v.tickmode,nticks:v.nticks,tick0:v.tick0,dtick:v.dtick,tickvals:v.tickvals,ticktext:v.ticktext,ticks:v.ticks,ticklen:v.ticklen,tickwidth:v.tickwidth,tickcolor:v.tickcolor,ticklabelstep:v.ticklabelstep,showticklabels:v.showticklabels,showtickprefix:v.showtickprefix,tickprefix:v.tickprefix,showticksuffix:v.showticksuffix,ticksuffix:v.ticksuffix,showexponent:v.showexponent,exponentformat:v.exponentformat,minexponent:v.minexponent,separatethousands:v.separatethousands,tickfont:v.tickfont,tickangle:v.tickangle,tickformat:v.tickformat,tickformatstops:v.tickformatstops,layer:v.layer},"plot","from-root"),a={visible:x({},v.visible,{dflt:!0}),type:x({},v.type,{values:["-","linear","log","date","category"]}),autotypenumbers:v.autotypenumbers,autorange:x({},v.autorange,{editType:"plot"}),rangemode:{valType:"enumerated",values:["tozero","nonnegative","normal"],dflt:"tozero",editType:"calc"},range:x({},v.range,{items:[{valType:"any",editType:"plot",impliedEdits:{"^autorange":!1}},{valType:"any",editType:"plot",impliedEdits:{"^autorange":!1}}],editType:"plot"}),categoryorder:v.categoryorder,categoryarray:v.categoryarray,angle:{valType:"angle",editType:"plot"},side:{valType:"enumerated",values:["clockwise","counterclockwise"],dflt:"clockwise",editType:"plot"},title:{text:x({},v.title.text,{editType:"plot",dflt:""}),font:x({},v.title.font,{editType:"plot"}),editType:"plot"},hoverformat:v.hoverformat,uirevision:{valType:"any",editType:"none"},editType:"calc",_deprecated:{title:v._deprecated.title,titlefont:v._deprecated.titlefont}};x(a,n,t);var r={visible:x({},v.visible,{dflt:!0}),type:{valType:"enumerated",values:["-","linear","category"],dflt:"-",editType:"calc",_noTemplating:!0},autotypenumbers:v.autotypenumbers,categoryorder:v.categoryorder,categoryarray:v.categoryarray,thetaunit:{valType:"enumerated",values:["radians","degrees"],dflt:"degrees",editType:"calc"},period:{valType:"number",editType:"calc",min:0},direction:{valType:"enumerated",values:["counterclockwise","clockwise"],dflt:"counterclockwise",editType:"calc"},rotation:{valType:"angle",editType:"calc"},hoverformat:v.hoverformat,uirevision:{valType:"any",editType:"none"},editType:"calc"};x(r,n,t),ee.exports={domain:m({name:"polar",editType:"plot"}),sector:{valType:"info_array",items:[{valType:"number",editType:"plot"},{valType:"number",editType:"plot"}],dflt:[0,360],editType:"plot"},hole:{valType:"number",min:0,max:1,dflt:0,editType:"plot"},bgcolor:{valType:"color",editType:"plot",dflt:g.background},radialaxis:a,angularaxis:r,gridshape:{valType:"enumerated",values:["circular","linear"],dflt:"circular",editType:"plot"},uirevision:{valType:"any",editType:"none"},editType:"calc"}},{"../../components/color/attributes":366,"../../lib":515,"../../plot_api/edit_types":548,"../cartesian/layout_attributes":579,"../domain":593}],633:[function(y,ee,Q){"use strict";var g=y("../../lib"),v=y("../../components/color"),m=y("../../plot_api/plot_template"),x=y("../subplot_defaults"),e=y("../get_data").getSubplotData,n=y("../cartesian/tick_value_defaults"),t=y("../cartesian/tick_mark_defaults"),a=y("../cartesian/tick_label_defaults"),r=y("../cartesian/prefix_suffix_defaults"),d=y("../cartesian/category_order_defaults"),s=y("../cartesian/line_grid_defaults"),i=y("../cartesian/axis_autotype"),u=y("./layout_attributes"),f=y("./set_convert"),c=y("./constants"),h=c.axisNames;function p(b,l,T,_){var w=T("bgcolor");_.bgColor=v.combine(w,_.paper_bgcolor);var k=T("sector");T("hole");var L,M=e(_.fullData,c.name,_.id),I=_.layoutOut;function P(te,j){return T(L+"."+te,j)}for(var S=0;S<h.length;S++){g.isPlainObject(b[L=h[S]])||(b[L]={});var E=b[L],z=m.newContainer(l,L);z._id=z._name=L,z._attr=_.id+"."+L,z._traceIndices=M.map(function(te){return te._expandedIndex});var R=c.axisName2dataArray[L],q=o(E,z,P,M,R,_);d(E,z,P,{axData:M,dataAttr:R});var V=P("visible");switch(f(z,l,I),P("uirevision",l.uirevision),z._m=1,L){case"radialaxis":var W=P("autorange",!z.isValidRange(E.range));E.autorange=W,!W||"linear"!==q&&"-"!==q||P("rangemode"),"reversed"===W&&(z._m=-1),P("range"),z.cleanRange("range",{dfltRange:[0,1]});break;case"angularaxis":if("date"===q){g.log("Polar plots do not support date angular axes yet.");for(var K=0;K<M.length;K++)M[K].visible=!1;q=E.type=z.type="linear"}P("linear"===q?"thetaunit":"period");var G=P("direction");P("rotation",{counterclockwise:0,clockwise:90}[G])}if(r(E,z,P,z.type,{tickSuffixDflt:"degrees"===z.thetaunit?"\xb0":void 0}),V){var Y,$,B,N,U=_.font||{};$=(Y=P("color"))===E.color?Y:U.color,B=U.size,N=U.family,n(E,z,P,z.type),a(E,z,P,z.type,{font:{color:$,size:B,family:N}}),t(E,z,P,{outerTicks:!0}),s(E,z,P,{dfltColor:Y,bgColor:_.bgColor,blend:60,showLine:!0,showGrid:!0,noZeroLine:!0,attributes:u[L]}),P("layer"),"radialaxis"===L&&(P("side"),P("angle",k[0]),P("title.text"),g.coerceFont(P,"title.font",{color:$,size:g.bigFont(B),family:N}))}"category"!==q&&P("hoverformat"),z._input=E}"category"===l.angularaxis.type&&T("gridshape")}function o(b,l,T,_,w,k){var L=T("autotypenumbers",k.autotypenumbersDflt);if("-"===T("type")){for(var M,I=0;I<_.length;I++)if(_[I].visible){M=_[I];break}M&&M[w]&&(l.type=i(M[w],"gregorian",{noMultiCategory:!0,autotypenumbers:L})),"-"===l.type?l.type="linear":b.type=l.type}return l.type}ee.exports=function(b,l,T){x(b,l,T,{type:c.name,attributes:u,handleDefaults:p,font:l.font,autotypenumbersDflt:l.autotypenumbers,paper_bgcolor:l.paper_bgcolor,fullData:T,layoutOut:l})}},{"../../components/color":367,"../../lib":515,"../../plot_api/plot_template":555,"../cartesian/axis_autotype":567,"../cartesian/category_order_defaults":571,"../cartesian/line_grid_defaults":581,"../cartesian/prefix_suffix_defaults":583,"../cartesian/tick_label_defaults":587,"../cartesian/tick_mark_defaults":588,"../cartesian/tick_value_defaults":589,"../get_data":602,"../subplot_defaults":641,"./constants":629,"./layout_attributes":632,"./set_convert":635}],634:[function(y,ee,Q){"use strict";var g=y("@plotly/d3"),v=y("tinycolor2"),m=y("../../registry"),x=y("../../lib"),e=x.strRotate,n=x.strTranslate,t=y("../../components/color"),a=y("../../components/drawing"),r=y("../plots"),d=y("../../plots/cartesian/axes"),s=y("../cartesian/set_convert"),i=y("./set_convert"),u=y("../cartesian/autorange").doAutoRange,f=y("../cartesian/dragbox"),c=y("../../components/dragelement"),h=y("../../components/fx"),p=y("../../components/titles"),o=y("../../components/selections").prepSelect,b=y("../../components/selections").selectOnClick,l=y("../../components/selections").clearOutline,T=y("../../lib/setcursor"),_=y("../../lib/clear_gl_canvases"),w=y("../../plot_api/subroutines").redrawReglTraces,k=y("../../constants/alignment").MID_SHIFT,L=y("./constants"),M=y("./helpers"),I=y("../smith/helpers"),P=I.smith,S=I.reactanceArc,E=I.resistanceArc,z=I.smithTransform,R=x._,q=x.mod,V=x.deg2rad,W=x.rad2deg;function K(N,U,te){this.isSmith=te||!1,this.id=U,this.gd=N,this._hasClipOnAxisFalse=null,this.vangles=null,this.radialAxisAngle=null,this.traceHash={},this.layers={},this.clipPaths={},this.clipIds={},this.viewInitial={};var j=N._fullLayout;this.clipIds.forTraces="clip"+j._uid+U+"-for-traces",this.clipPaths.forTraces=j._clips.append("clipPath").attr("id",this.clipIds.forTraces),this.clipPaths.forTraces.append("path"),this.framework=j["_"+(te?"smith":"polar")+"layer"].append("g").attr("class",U),this.getHole=function(X){return this.isSmith?0:X.hole},this.getSector=function(X){return this.isSmith?[0,360]:X.sector},this.getRadial=function(X){return this.isSmith?X.realaxis:X.radialaxis},this.getAngular=function(X){return this.isSmith?X.imaginaryaxis:X.angularaxis},te||(this.radialTickLayout=null,this.angularTickLayout=null)}var G=K.prototype;function Y(N){var U=N.ticks+String(N.ticklen)+String(N.showticklabels);return"side"in N&&(U+=N.side),U}function $(N,U){return U[x.findIndexOfMin(U,function(te){return x.angleDist(N,te)})]}function B(N,U,te){return U?(N.attr("display",null),N.attr(te)):N&&N.attr("display","none"),N}ee.exports=function(N,U,te){return new K(N,U,te)},G.plot=function(N,U){for(var te=U[this.id],j=!1,J=0;J<N.length;J++)if(!1===N[J][0].trace.cliponaxis){j=!0;break}this._hasClipOnAxisFalse=j,this.updateLayers(U,te),this.updateLayout(U,te),r.generalUpdatePerTraceModule(this.gd,this,N,te),this.updateFx(U,te),this.isSmith&&(delete te.realaxis.range,delete te.imaginaryaxis.range)},G.updateLayers=function(N,U){var te=this.isSmith,j=this.layers,J=this.getRadial(U),X=this.getAngular(U),re=L.layerNames,ne=re.indexOf("frontplot"),le=re.slice(0,ne),oe="below traces"===X.layer,de="below traces"===J.layer;oe&&le.push("angular-line"),de&&le.push("radial-line"),oe&&le.push("angular-axis"),de&&le.push("radial-axis"),le.push("frontplot"),oe||le.push("angular-line"),de||le.push("radial-line"),oe||le.push("angular-axis"),de||le.push("radial-axis");var se=(te?"smith":"polar")+"sublayer",ge=this.framework.selectAll("."+se).data(le,String);ge.enter().append("g").attr("class",function(_e){return se+" "+_e}).each(function(_e){var Te=j[_e]=g.select(this);switch(_e){case"frontplot":te||Te.append("g").classed("barlayer",!0),Te.append("g").classed("scatterlayer",!0);break;case"backplot":Te.append("g").classed("maplayer",!0);break;case"plotbg":j.bg=Te.append("path");break;case"radial-grid":case"angular-grid":Te.style("fill","none");break;case"radial-line":Te.append("line").style("fill","none");break;case"angular-line":Te.append("path").style("fill","none")}}),ge.order()},G.updateLayout=function(N,U){var te=this.layers,j=N._size,J=this.getRadial(U),X=this.getAngular(U),re=U.domain.x,ne=U.domain.y;this.xOffset=j.l+j.w*re[0],this.yOffset=j.t+j.h*(1-ne[1]);var le=this.xLength=j.w*(re[1]-re[0]),oe=this.yLength=j.h*(ne[1]-ne[0]),de=this.getSector(U);this.sectorInRad=de.map(V);var se,ge,_e,Te,we,ct,Ke,mt,Bt,Ut,er,Wt,rr,Ht,Ve,Oe=this.sectorBBox=(Bt=(ct=de)[1]-(mt=ct[0]),er=(Ut=q(mt,360))+Bt,Wt=Math.cos(V(Ut)),rr=Math.sin(V(Ut)),Ht=Math.cos(V(er)),Ve=Math.sin(V(er)),Ke=Ut<=90&&er>=90||Ut>90&&er>=450?1:rr<=0&&Ve<=0?0:Math.max(rr,Ve),[Ut<=180&&er>=180||Ut>180&&er>=540?-1:Wt>=0&&Ht>=0?0:Math.min(Wt,Ht),Ut<=270&&er>=270||Ut>270&&er>=630?-1:rr>=0&&Ve>=0?0:Math.min(rr,Ve),er>=360?1:Wt<=0&&Ht<=0?0:Math.max(Wt,Ht),Ke]),fe=Oe[2]-Oe[0],Ae=oe/le,ke=Math.abs((Oe[3]-Oe[1])/fe);Ae>ke?(se=le,we=(oe-(ge=le*ke))/j.h/2,_e=[re[0],re[1]],Te=[ne[0]+we,ne[1]-we]):(ge=oe,we=(le-(se=oe/ke))/j.w/2,_e=[re[0]+we,re[1]-we],Te=[ne[0],ne[1]]),this.xLength2=se,this.yLength2=ge,this.xDomain2=_e,this.yDomain2=Te;var Pe,Ne=this.xOffset2=j.l+j.w*_e[0],De=this.yOffset2=j.t+j.h*(1-Te[1]),ze=this.radius=se/fe,Me=this.innerRadius=this.getHole(U)*ze,Se=this.cx=Ne-ze*Oe[0],Ie=this.cy=De+ze*Oe[3],Fe=this.cxx=Se-Ne,Re=this.cyy=Ie-De,Xe=J.side;"counterclockwise"===Xe?(Pe=Xe,Xe="top"):"clockwise"===Xe&&(Pe=Xe,Xe="bottom"),this.radialAxis=this.mockAxis(N,U,J,{_id:"x",side:Xe,_trueSide:Pe,domain:[Me/j.w,ze/j.w]}),this.angularAxis=this.mockAxis(N,U,X,{side:"right",domain:[0,Math.PI],autorange:!1}),this.doAutoRange(N,U),this.updateAngularAxis(N,U),this.updateRadialAxis(N,U),this.updateRadialAxisTitle(N,U),this.xaxis=this.mockCartesianAxis(N,U,{_id:"x",domain:_e}),this.yaxis=this.mockCartesianAxis(N,U,{_id:"y",domain:Te});var nt=this.pathSubplot();this.clipPaths.forTraces.select("path").attr("d",nt).attr("transform",n(Fe,Re)),te.frontplot.attr("transform",n(Ne,De)).call(a.setClipUrl,this._hasClipOnAxisFalse?null:this.clipIds.forTraces,this.gd),te.bg.attr("d",nt).attr("transform",n(Se,Ie)).call(t.fill,U.bgcolor)},G.mockAxis=function(N,U,te,j){var J=x.extendFlat({},te,j);return i(J,U,N),J},G.mockCartesianAxis=function(N,U,te){var j=this,J=j.isSmith,X=te._id,re=x.extendFlat({type:"linear"},te);s(re,N);var ne={x:[0,2],y:[1,3]};return re.setRange=function(){var le=j.sectorBBox,oe=ne[X],de=j.radialAxis._rl,se=(de[1]-de[0])/(1-j.getHole(U));re.range=[le[oe[0]]*se,le[oe[1]]*se]},re.isPtWithinRange="x"!==X||J?function(){return!0}:function(le){return j.isPtInside(le)},re.setRange(),re.setScale(),re},G.doAutoRange=function(N,U){var te=this.gd,j=this.radialAxis,J=this.getRadial(U);u(te,j);var X=j.range;J.range=X.slice(),J._input.range=X.slice(),j._rl=[j.r2l(X[0],null,"gregorian"),j.r2l(X[1],null,"gregorian")]},G.updateRadialAxis=function(N,U){var te=this,j=te.gd,J=te.layers,X=te.radius,re=te.innerRadius,ne=te.cx,le=te.cy,oe=te.getRadial(U),de=q(te.getSector(U)[0],360),se=te.radialAxis,ge=re<X,_e=te.isSmith;_e||(te.fillViewInitialKey("radialaxis.angle",oe.angle),te.fillViewInitialKey("radialaxis.range",se.range.slice()),se.setGeometry()),"auto"===se.tickangle&&de>90&&de<=270&&(se.tickangle=180);var Te=_e?function(ze){var Me=z(te,P([ze.x,0]));return n(Me[0]-ne,Me[1]-le)}:function(ze){return n(se.l2p(ze.x)+re,0)},we=_e?function(ze){return E(te,ze.x,-1/0,1/0)}:function(ze){return te.pathArc(se.r2p(ze.x)+re)},Oe=Y(oe);if(te.radialTickLayout!==Oe&&(J["radial-axis"].selectAll(".xtick").remove(),te.radialTickLayout=Oe),ge){se.setScale();var fe=0,ve=_e?(se.tickvals||[]).filter(function(ze){return ze>=0}).map(function(ze){return d.tickText(se,ze,!0,!1)}):d.calcTicks(se),Ae=_e?ve:d.clipEnds(se,ve),ke=d.getTickSigns(se)[2];_e&&(("top"===se.ticks&&"bottom"===se.side||"bottom"===se.ticks&&"top"===se.side)&&(ke=-ke),"top"===se.ticks&&"top"===se.side&&(fe=-se.ticklen),"bottom"===se.ticks&&"bottom"===se.side&&(fe=se.ticklen)),d.drawTicks(j,se,{vals:ve,layer:J["radial-axis"],path:d.makeTickPath(se,0,ke),transFn:Te,crisp:!1}),d.drawGrid(j,se,{vals:Ae,layer:J["radial-grid"],path:we,transFn:x.noop,crisp:!1}),d.drawLabels(j,se,{vals:ve,layer:J["radial-axis"],transFn:Te,labelFns:d.makeLabelFns(se,fe)})}var Pe=te.radialAxisAngle=te.vangles?W($(V(oe.angle),te.vangles)):oe.angle,Ne=n(ne,le),De=Ne+e(-Pe);B(J["radial-axis"],ge&&(oe.showticklabels||oe.ticks),{transform:De}),B(J["radial-grid"],ge&&oe.showgrid,{transform:_e?"":Ne}),B(J["radial-line"].select("line"),ge&&oe.showline,{x1:_e?-X:re,y1:0,x2:X,y2:0,transform:De}).attr("stroke-width",oe.linewidth).call(t.stroke,oe.linecolor)},G.updateRadialAxisTitle=function(N,U,te){if(!this.isSmith){var j=this.gd,J=this.radius,X=this.cx,re=this.cy,ne=this.getRadial(U),le=this.id+"title",oe=0;if(ne.title){var de=a.bBox(this.layers["radial-axis"].node()).height,se=ne.title.font.size,ge=ne.side;oe="top"===ge?se:"counterclockwise"===ge?-(de+.4*se):de+.8*se}var _e=void 0!==te?te:this.radialAxisAngle,Te=V(_e),we=Math.cos(Te),Oe=Math.sin(Te),fe=X+J/2*we+oe*Oe,ve=re-J/2*Oe+oe*we;this.layers["radial-axis-title"]=p.draw(j,le,{propContainer:ne,propName:this.id+".radialaxis.title",placeholder:R(j,"Click to enter radial axis title"),attributes:{x:fe,y:ve,"text-anchor":"middle"},transform:{rotate:-_e}})}},G.updateAngularAxis=function(N,U){var te=this,j=te.gd,J=te.layers,X=te.radius,re=te.innerRadius,ne=te.cx,le=te.cy,oe=te.getAngular(U),de=te.angularAxis,se=te.isSmith;se||(te.fillViewInitialKey("angularaxis.rotation",oe.rotation),de.setGeometry(),de.setScale());var ge=se?function(ze){var Me=z(te,P([0,ze.x]));return Math.atan2(Me[0]-ne,Me[1]-le)-Math.PI/2}:function(ze){return de.t2g(ze.x)};"linear"===de.type&&"radians"===de.thetaunit&&(de.tick0=W(de.tick0),de.dtick=W(de.dtick));var _e=function(ze){return n(ne+X*Math.cos(ze),le-X*Math.sin(ze))},Te=se?function(ze){var Me=z(te,P([0,ze.x]));return n(Me[0],Me[1])}:function(ze){return _e(ge(ze))},we=se?function(ze){var Me=z(te,P([0,ze.x])),Se=Math.atan2(Me[0]-ne,Me[1]-le)-Math.PI/2;return n(Me[0],Me[1])+e(-W(Se))}:function(ze){var Me=ge(ze);return _e(Me)+e(-W(Me))},Oe=se?function(ze){return S(te,ze.x,0,1/0)}:function(ze){var Me=ge(ze),Se=Math.cos(Me),Ie=Math.sin(Me);return"M"+[ne+re*Se,le-re*Ie]+"L"+[ne+X*Se,le-X*Ie]},fe=d.makeLabelFns(de,0).labelStandoff,ve={xFn:function(ze){var Me=ge(ze);return Math.cos(Me)*fe},yFn:function(ze){var Me=ge(ze),Se=Math.sin(Me)>0?.2:1;return-Math.sin(Me)*(fe+ze.fontSize*Se)+Math.abs(Math.cos(Me))*(ze.fontSize*k)},anchorFn:function(ze){var Me=ge(ze),Se=Math.cos(Me);return Math.abs(Se)<.1?"middle":Se>0?"start":"end"},heightFn:function(ze,Me,Se){var Ie=ge(ze);return-.5*(1+Math.sin(Ie))*Se}},Ae=Y(oe);te.angularTickLayout!==Ae&&(J["angular-axis"].selectAll("."+de._id+"tick").remove(),te.angularTickLayout=Ae);var ke,Pe=se?[1/0].concat(de.tickvals||[]).map(function(ze){return d.tickText(de,ze,!0,!1)}):d.calcTicks(de);if(se&&(Pe[0].text="\u221e",Pe[0].fontSize*=1.75),"linear"===U.gridshape?(ke=Pe.map(ge),x.angleDelta(ke[0],ke[1])<0&&(ke=ke.slice().reverse())):ke=null,te.vangles=ke,"category"===de.type&&(Pe=Pe.filter(function(ze){return x.isAngleInsideSector(ge(ze),te.sectorInRad)})),de.visible){var Ne="inside"===de.ticks?-1:1;d.drawTicks(j,de,{vals:Pe,layer:J["angular-axis"],path:"M"+Ne*((de.linewidth||1)/2)+",0h"+Ne*de.ticklen,transFn:we,crisp:!1}),d.drawGrid(j,de,{vals:Pe,layer:J["angular-grid"],path:Oe,transFn:x.noop,crisp:!1}),d.drawLabels(j,de,{vals:Pe,layer:J["angular-axis"],repositionOnUpdate:!0,transFn:Te,labelFns:ve})}B(J["angular-line"].select("path"),oe.showline,{d:te.pathSubplot(),transform:n(ne,le)}).attr("stroke-width",oe.linewidth).call(t.stroke,oe.linecolor)},G.updateFx=function(N,U){this.gd._context.staticPlot||(!this.isSmith&&(this.updateAngularDrag(N),this.updateRadialDrag(N,U,0),this.updateRadialDrag(N,U,1)),this.updateHoverAndMainDrag(N))},G.updateHoverAndMainDrag=function(N){var U,te,j=this,J=j.isSmith,X=j.gd,ne=N._zoomlayer,le=L.MINZOOM,oe=L.OFFEDGE,de=j.radius,se=j.innerRadius,ge=j.cx,_e=j.cy,Te=j.cxx,we=j.cyy,Oe=j.sectorInRad,fe=j.vangles,ve=j.radialAxis,Ae=M.clampTiny,ke=M.findXYatLength,Pe=M.findEnclosingVertexAngles,Ne=L.cornerHalfWidth,De=L.cornerLen/2,ze=f.makeDragger(j.layers,"path","maindrag",!1===N.dragmode?"none":"crosshair");g.select(ze).attr("d",j.pathSubplot()).attr("transform",n(ge,_e)),ze.onmousemove=function(Ge){h.hover(X,Ge,j.id),X._fullLayout._lasthover=ze,X._fullLayout._hoversubplot=j.id},ze.onmouseout=function(Ge){X._dragging||c.unhover(X,Ge)};var Me,Se,Ie,Fe,Re,Xe,nt,ct,xt,dt={element:ze,gd:X,subplot:j.id,plotinfo:{id:j.id,xaxis:j.xaxis,yaxis:j.yaxis},xaxes:[j.xaxis],yaxes:[j.yaxis]};function tt(Ge,Je){return Math.sqrt(Ge*Ge+Je*Je)}function Ke(Ge,Je){return tt(Ge-Te,Je-we)}function mt(Ge,Je){return Math.atan2(we-Je,Ge-Te)}function Bt(Ge,Je){return[Ge*Math.cos(Je),Ge*Math.sin(-Je)]}function Ut(Ge,Je){if(0===Ge)return j.pathSector(2*Ne);var He=De/Ge,st=Je-He,ot=Je+He,wt=Math.max(0,Math.min(Ge,de)),Ct=wt-Ne,rt=wt+Ne;return"M"+Bt(Ct,st)+"A"+[Ct,Ct]+" 0,0,0 "+Bt(Ct,ot)+"L"+Bt(rt,ot)+"A"+[rt,rt]+" 0,0,1 "+Bt(rt,st)+"Z"}function er(Ge,Je,He){if(0===Ge)return j.pathSector(2*Ne);var st,ot,wt=Bt(Ge,Je),Ct=Bt(Ge,He),rt=Ae((wt[0]+Ct[0])/2),ft=Ae((wt[1]+Ct[1])/2);if(rt&&ft){var Rt=ft/rt,kt=-1/Rt,Lt=ke(Ne,Rt,rt,ft);st=ke(De,kt,Lt[0][0],Lt[0][1]),ot=ke(De,kt,Lt[1][0],Lt[1][1])}else{var Ee,Ye;ft?(Ee=De,Ye=Ne):(Ee=Ne,Ye=De),st=[[rt-Ee,ft-Ye],[rt+Ee,ft-Ye]],ot=[[rt-Ee,ft+Ye],[rt+Ee,ft+Ye]]}return"M"+st.join("L")+"L"+ot.reverse().join("L")+"Z"}function Wt(Ge,Je){return Je=Math.max(Math.min(Je,de),se),Ge<oe?Ge=0:de-Ge<oe?Ge=de:Je<oe?Je=0:de-Je<oe&&(Je=de),Math.abs(Je-Ge)>le?(Ge<Je?(Ie=Ge,Fe=Je):(Ie=Je,Fe=Ge),!0):(Ie=null,Fe=null,!1)}function rr(Ge,Je){Je=Je||"M0,0Z",ct.attr("d",Ge=Ge||Re),xt.attr("d",Je),f.transitionZoombox(ct,xt,Xe,nt),Xe=!0;var He={};ye(He),X.emit("plotly_relayouting",He)}function Ht(Ge,Je){var He,st,ot=Me+(Ge*=U),wt=Se+(Je*=te),Ct=Ke(Me,Se),rt=Math.min(Ke(ot,wt),de),ft=mt(Me,Se);Wt(Ct,rt)&&(He=Re+j.pathSector(Fe),Ie&&(He+=j.pathSector(Ie)),st=Ut(Ie,ft)+Ut(Fe,ft)),rr(He,st)}function Ve(Ge,Je,He,st){var ot=M.findIntersectionXY(He,st,He,[Ge-Te,we-Je]);return tt(ot[0],ot[1])}function We(Ge,Je){var He,st,ot=Me+Ge,wt=Se+Je,Ct=mt(Me,Se),rt=mt(ot,wt),ft=Pe(Ct,fe),Rt=Pe(rt,fe);Wt(Ve(Me,Se,ft[0],ft[1]),Math.min(Ve(ot,wt,Rt[0],Rt[1]),de))&&(He=Re+j.pathSector(Fe),Ie&&(He+=j.pathSector(Ie)),st=[er(Ie,ft[0],ft[1]),er(Fe,ft[0],ft[1])].join(" ")),rr(He,st)}function he(){if(f.removeZoombox(X),null!==Ie&&null!==Fe){var Ge={};ye(Ge),f.showDoubleClickNotifier(X),m.call("_guiRelayout",X,Ge)}}function ye(Ge){var Je=ve._rl,He=(Je[1]-Je[0])/(1-se/de)/de;Ge[j.id+".radialaxis.range"]=[Je[0]+(Ie-se)*He,Je[0]+(Fe-se)*He]}function Be(Ge,Je){var He=X._fullLayout.clickmode;if(f.removeZoombox(X),2===Ge){var st={};for(var ot in j.viewInitial)st[j.id+"."+ot]=j.viewInitial[ot];X.emit("plotly_doubleclick",null),m.call("_guiRelayout",X,st)}He.indexOf("select")>-1&&1===Ge&&b(Je,X,[j.xaxis],[j.yaxis],j.id,dt),He.indexOf("event")>-1&&h.click(X,Je,j.id)}dt.prepFn=function(Ge,Je,He){var st=X._fullLayout.dragmode,ot=ze.getBoundingClientRect();X._fullLayout._calcInverseTransform(X),U=X._fullLayout._invScaleX,te=X._fullLayout._invScaleY;var Ct=x.apply3DTransform(X._fullLayout._invTransform)(Je-ot.left,He-ot.top);if(Me=Ct[0],Se=Ct[1],fe){var rt=M.findPolygonOffset(de,Oe[0],Oe[1],fe);Me+=Te+rt[0],Se+=we+rt[1]}switch(st){case"zoom":dt.clickFn=Be,J||(dt.moveFn=fe?We:Ht,dt.doneFn=he,Ie=null,Fe=null,Re=j.pathSubplot(),Xe=!1,nt=v(X._fullLayout[j.id].bgcolor).getLuminance(),(ct=f.makeZoombox(ne,nt,ge,_e,Re)).attr("fill-rule","evenodd"),xt=f.makeCorners(ne,ge,_e),l(X));break;case"select":case"lasso":o(Ge,Je,He,dt,st)}},c.init(dt)},G.updateRadialDrag=function(N,U,te){var j=this,J=j.gd,X=j.layers,re=j.radius,ne=j.innerRadius,le=j.cx,oe=j.cy,de=j.radialAxis,se=L.radialDragBoxSize,ge=se/2;if(de.visible){var _e,Te,we,Oe=V(j.radialAxisAngle),fe=de._rl,ve=fe[0],Ae=fe[1],ke=fe[te],Pe=.75*(fe[1]-fe[0])/(1-j.getHole(U))/re;te?(_e=le+(re+ge)*Math.cos(Oe),Te=oe-(re+ge)*Math.sin(Oe),we="radialdrag"):(_e=le+(ne-ge)*Math.cos(Oe),Te=oe-(ne-ge)*Math.sin(Oe),we="radialdrag-inner");var Ne,De,ze,Me=f.makeRectDragger(X,we,"crosshair",-ge,-ge,se,se),Se={element:Me,gd:J};!1===N.dragmode&&(Se.dragmode=!1),B(g.select(Me),de.visible&&ne<re,{transform:n(_e,Te)}),Se.prepFn=function(){Ne=null,De=null,ze=null,Se.moveFn=Ie,Se.doneFn=Fe,l(J)},Se.clampFn=function(nt,ct){return Math.sqrt(nt*nt+ct*ct)<L.MINDRAG&&(nt=0,ct=0),[nt,ct]},c.init(Se)}function Ie(nt,ct){if(Ne)Ne(nt,ct);else{var xt=[nt,-ct],dt=[Math.cos(Oe),Math.sin(Oe)],tt=Math.abs(x.dot(xt,dt)/Math.sqrt(x.dot(xt,xt)));isNaN(tt)||(Ne=tt<.5?Re:Xe)}var mt,Ke={};mt=Ke,null!==De?mt[j.id+".radialaxis.angle"]=De:null!==ze&&(mt[j.id+".radialaxis.range["+te+"]"]=ze),J.emit("plotly_relayouting",Ke)}function Fe(){null!==De?m.call("_guiRelayout",J,j.id+".radialaxis.angle",De):null!==ze&&m.call("_guiRelayout",J,j.id+".radialaxis.range["+te+"]",ze)}function Re(nt,ct){if(0!==te){De=Math.atan2(oe-(Te+ct),_e+nt-le),j.vangles&&(De=$(De,j.vangles)),De=W(De);var tt=n(le,oe)+e(-De);X["radial-axis"].attr("transform",tt),X["radial-line"].select("line").attr("transform",tt);var Ke=j.gd._fullLayout;j.updateRadialAxisTitle(Ke,Ke[j.id],De)}}function Xe(nt,ct){var xt=x.dot([nt,-ct],[Math.cos(Oe),Math.sin(Oe)]);if(ze=ke-Pe*xt,Pe>0==(te?ze>ve:ze<Ae)){var dt=J._fullLayout,tt=dt[j.id];de.range[te]=ze,de._rl[te]=ze,j.updateRadialAxis(dt,tt),j.xaxis.setRange(),j.xaxis.setScale(),j.yaxis.setRange(),j.yaxis.setScale();var Ke=!1;for(var mt in j.traceHash){var Bt=j.traceHash[mt],Ut=x.filterVisible(Bt);Bt[0][0].trace._module.plot(J,j,Ut,tt),m.traceIs(mt,"gl")&&Ut.length&&(Ke=!0)}Ke&&(_(J),w(J))}else ze=null}},G.updateAngularDrag=function(N){var U=this,te=U.gd,j=U.layers,J=U.radius,X=U.angularAxis,re=U.cx,ne=U.cy,le=U.cxx,oe=U.cyy,de=L.angularDragBoxSize,se=f.makeDragger(j,"path","angulardrag",!1===N.dragmode?"none":"move"),ge={element:se,gd:te};function _e(Se,Ie){return Math.atan2(oe+de-Ie,Se-le-de)}!1===N.dragmode?ge.dragmode=!1:g.select(se).attr("d",U.pathAnnulus(J,J+de)).attr("transform",n(re,ne)).call(T,"move");var Te,we,Oe,fe,ve,Ae,ke=j.frontplot.select(".scatterlayer").selectAll(".trace"),Pe=ke.selectAll(".point"),Ne=ke.selectAll(".textpoint");function De(Se,Ie){var Fe=U.gd._fullLayout,Re=Fe[U.id],Xe=_e(Te+Se*N._invScaleX,we+Ie*N._invScaleY),nt=W(Xe-Ae);if(fe=Oe+nt,j.frontplot.attr("transform",n(U.xOffset2,U.yOffset2)+e([-nt,le,oe])),U.vangles){ve=U.radialAxisAngle+nt;var ct=n(re,ne)+e(-nt),xt=n(re,ne)+e(-ve);j.bg.attr("transform",ct),j["radial-grid"].attr("transform",ct),j["radial-axis"].attr("transform",xt),j["radial-line"].select("line").attr("transform",xt),U.updateRadialAxisTitle(Fe,Re,ve)}else U.clipPaths.forTraces.select("path").attr("transform",n(le,oe)+e(nt));Pe.each(function(){var Ut=g.select(this),er=a.getTranslate(Ut);Ut.attr("transform",n(er.x,er.y)+e([nt]))}),Ne.each(function(){var Ut=g.select(this),er=Ut.select("text"),Wt=a.getTranslate(Ut);Ut.attr("transform",e([nt,er.attr("x"),er.attr("y")])+n(Wt.x,Wt.y))}),X.rotation=x.modHalf(fe,360),U.updateAngularAxis(Fe,Re),U._hasClipOnAxisFalse&&!x.isFullCircle(U.sectorInRad)&&ke.call(a.hideOutsideRangePoints,U);var dt=!1;for(var tt in U.traceHash)if(m.traceIs(tt,"gl")){var Ke=U.traceHash[tt],mt=x.filterVisible(Ke);Ke[0][0].trace._module.plot(te,U,mt,Re),mt.length&&(dt=!0)}dt&&(_(te),w(te));var Bt={};ze(Bt),te.emit("plotly_relayouting",Bt)}function ze(Se){Se[U.id+".angularaxis.rotation"]=fe,U.vangles&&(Se[U.id+".radialaxis.angle"]=ve)}function Me(){Ne.select("text").attr("transform",null);var Se={};ze(Se),m.call("_guiRelayout",te,Se)}ge.prepFn=function(Se,Ie,Fe){Oe=N[U.id].angularaxis.rotation;var Xe=se.getBoundingClientRect();Te=Ie-Xe.left,we=Fe-Xe.top,te._fullLayout._calcInverseTransform(te);var nt=x.apply3DTransform(N._invTransform)(Te,we);Ae=_e(Te=nt[0],we=nt[1]),ge.moveFn=De,ge.doneFn=Me,l(te)},U.vangles&&!x.isFullCircle(U.sectorInRad)&&(ge.prepFn=x.noop,T(g.select(se),null)),c.init(ge)},G.isPtInside=function(N){if(this.isSmith)return!0;var U=this.sectorInRad,te=this.vangles,j=this.angularAxis.c2g(N.theta),J=this.radialAxis,X=J.c2l(N.r);return(te?M.isPtInsidePolygon:x.isPtInsideSector)(X,j,J._rl,U,te)},G.pathArc=function(N){var U=this.sectorInRad,te=this.vangles;return(te?M.pathPolygon:x.pathArc)(N,U[0],U[1],te)},G.pathSector=function(N){var U=this.sectorInRad,te=this.vangles;return(te?M.pathPolygon:x.pathSector)(N,U[0],U[1],te)},G.pathAnnulus=function(N,U){var te=this.sectorInRad,j=this.vangles;return(j?M.pathPolygonAnnulus:x.pathAnnulus)(N,U,te[0],te[1],j)},G.pathSubplot=function(){var N=this.innerRadius,U=this.radius;return N?this.pathAnnulus(N,U):this.pathSector(U)},G.fillViewInitialKey=function(N,U){N in this.viewInitial||(this.viewInitial[N]=U)}},{"../../components/color":367,"../../components/dragelement":386,"../../components/drawing":389,"../../components/fx":407,"../../components/selections":455,"../../components/titles":476,"../../constants/alignment":483,"../../lib":515,"../../lib/clear_gl_canvases":499,"../../lib/setcursor":536,"../../plot_api/subroutines":556,"../../plots/cartesian/axes":566,"../../registry":647,"../cartesian/autorange":565,"../cartesian/dragbox":575,"../cartesian/set_convert":585,"../plots":628,"../smith/helpers":637,"./constants":629,"./helpers":630,"./set_convert":635,"@plotly/d3":58,tinycolor2:313}],635:[function(y,ee,Q){"use strict";var g=y("../../lib"),v=y("../cartesian/set_convert"),m=g.deg2rad,x=g.rad2deg;ee.exports=function(e,n,t){switch(v(e,t),e._id){case"x":case"radialaxis":d=n._subplot,(a=e).setGeometry=function(){var s=a._rl[0],i=a._rl[1],u=d.innerRadius,f=(d.radius-u)/(i-s),c=u/f,h=s>i?function(p){return p<=0}:function(p){return p>=0};a.c2g=function(p){var o=a.c2l(p)-s;return(h(o)?o:0)+c},a.g2c=function(p){return a.l2c(p+s-c)},a.g2p=function(p){return p*f},a.c2p=function(p){return a.g2p(a.c2g(p))}};break;case"angularaxis":!function(a,r){var d=a.type;if("linear"===d){var s=a.d2c,i=a.c2d;a.d2c=function(u,f){return c=s(u),"degrees"===f?m(c):c;var c},a.c2d=function(u,f){return i((c=u,"degrees"===f?x(c):c));var c}}a.makeCalcdata=function(u,f){var c,h,p=u[f],o=u._length,b=function(k){return a.d2c(k,u.thetaunit)};if(p){if(g.isTypedArray(p)&&"linear"===d){if(o===p.length)return p;if(p.subarray)return p.subarray(0,o)}for(c=new Array(o),h=0;h<o;h++)c[h]=b(p[h])}else{var l=f+"0",T="d"+f,_=l in u?b(u[l]):0,w=u[T]?b(u[T]):(a.period||2*Math.PI)/o;for(c=new Array(o),h=0;h<o;h++)c[h]=_+h*w}return c},a.setGeometry=function(){var u,f,c,h,p=r.sector,o=p.map(m),b={clockwise:-1,counterclockwise:1}[a.direction],l=m(a.rotation),T=function(L){return b*L+l},_=function(L){return(L-l)/b};switch(d){case"linear":f=u=g.identity,h=m,c=x,a.range=g.isFullCircle(o)?[p[0],p[0]+360]:o.map(_).map(x);break;case"category":var w=a._categories.length,k=a.period?Math.max(a.period,w):w;0===k&&(k=1),f=h=function(L){return 2*L*Math.PI/k},u=c=function(L){return L*k/Math.PI/2},a.range=[0,k]}a.c2g=function(L){return T(f(L))},a.g2c=function(L){return u(_(L))},a.t2g=function(L){return T(h(L))},a.g2t=function(L){return c(_(L))}}}(e,n)}var a,d}},{"../../lib":515,"../cartesian/set_convert":585}],636:[function(y,ee,Q){"use strict";ee.exports={attr:"subplot",name:"smith",axisNames:["realaxis","imaginaryaxis"],axisName2dataArray:{imaginaryaxis:"imag",realaxis:"real"}}},{}],637:[function(y,ee,Q){"use strict";function g(e){return e<0?-1:e>0?1:0}function v(e){var n=e[0],t=e[1];if(!isFinite(n)||!isFinite(t))return[1,0];var a=(n+1)*(n+1)+t*t;return[(n*n+t*t-1)/a,2*t/a]}function m(e,n){return[n[0]*e.radius+e.cx,-n[1]*e.radius+e.cy]}function x(e,n){return n*e.radius}ee.exports={smith:v,reactanceArc:function(e,n,t,a){var r=m(e,v([t,n])),d=r[0],s=r[1],i=m(e,v([a,n])),u=i[0],f=i[1];if(0===n)return["M"+d+","+s,"L"+u+","+f].join(" ");var c=x(e,1/Math.abs(n));return["M"+d+","+s,"A"+c+","+c+" 0 0,"+(n<0?1:0)+" "+u+","+f].join(" ")},resistanceArc:function(e,n,t,a){var r=x(e,1/(n+1)),d=m(e,v([n,t])),s=d[0],i=d[1],u=m(e,v([n,a])),f=u[0],c=u[1];if(g(t)!==g(a)){var h=m(e,v([n,0]));return["M"+s+","+i,"A"+r+","+r+" 0 0,"+(0<t?0:1)+" "+h[0]+","+h[1],"A"+r+","+r+" 0 0,"+(a<0?0:1)+f+","+c].join(" ")}return["M"+s+","+i,"A"+r+","+r+" 0 0,"+(a<t?0:1)+" "+f+","+c].join(" ")},smithTransform:m}},{}],638:[function(y,ee,Q){"use strict";var g=y("../get_data").getSubplotCalcData,v=y("../../lib").counterRegex,m=y("../polar/polar"),x=y("./constants"),e=x.attr,n=x.name,t=v(n),a={};a[e]={valType:"subplotid",dflt:n,editType:"calc"},ee.exports={attr:e,name:n,idRoot:n,idRegex:t,attrRegex:t,attributes:a,layoutAttributes:y("./layout_attributes"),supplyLayoutDefaults:y("./layout_defaults"),plot:function(r){for(var d=r._fullLayout,s=r.calcdata,i=d._subplots[n],u=0;u<i.length;u++){var f=i[u],c=g(s,n,f),h=d[f]._subplot;h||(h=m(r,f,!0),d[f]._subplot=h),h.plot(c,d,r._promises)}},clean:function(r,d,s,i){for(var u=i._subplots[n]||[],f=0;f<u.length;f++){var c=u[f],h=i[c]._subplot;if(!d[c]&&h)for(var p in h.framework.remove(),h.clipPaths)h.clipPaths[p].remove()}},toSVG:y("../cartesian").toSVG}},{"../../lib":515,"../cartesian":578,"../get_data":602,"../polar/polar":634,"./constants":636,"./layout_attributes":639,"./layout_defaults":640}],639:[function(y,ee,Q){"use strict";var g=y("../../components/color/attributes"),v=y("../cartesian/layout_attributes"),m=y("../domain").attributes,x=y("../../lib").extendFlat,e=y("../../plot_api/edit_types").overrideAll,n=e({color:v.color,showline:x({},v.showline,{dflt:!0}),linecolor:v.linecolor,linewidth:v.linewidth,showgrid:x({},v.showgrid,{dflt:!0}),gridcolor:v.gridcolor,gridwidth:v.gridwidth,griddash:v.griddash},"plot","from-root"),t=e({ticklen:v.ticklen,tickwidth:x({},v.tickwidth,{dflt:2}),tickcolor:v.tickcolor,showticklabels:v.showticklabels,showtickprefix:v.showtickprefix,tickprefix:v.tickprefix,showticksuffix:v.showticksuffix,ticksuffix:v.ticksuffix,tickfont:v.tickfont,tickformat:v.tickformat,hoverformat:v.hoverformat,layer:v.layer},"plot","from-root"),a=x({visible:x({},v.visible,{dflt:!0}),tickvals:{dflt:[.2,.5,1,2,5],valType:"data_array",editType:"plot"},tickangle:x({},v.tickangle,{dflt:90}),ticks:{valType:"enumerated",values:["top","bottom",""],editType:"ticks"},side:{valType:"enumerated",values:["top","bottom"],dflt:"top",editType:"plot"},editType:"calc"},n,t),r=x({visible:x({},v.visible,{dflt:!0}),tickvals:{valType:"data_array",editType:"plot"},ticks:v.ticks,editType:"calc"},n,t);ee.exports={domain:m({name:"smith",editType:"plot"}),bgcolor:{valType:"color",editType:"plot",dflt:g.background},realaxis:a,imaginaryaxis:r,editType:"calc"}},{"../../components/color/attributes":366,"../../lib":515,"../../plot_api/edit_types":548,"../cartesian/layout_attributes":579,"../domain":593}],640:[function(y,ee,Q){"use strict";var g,v,m,x=y("../../lib"),e=y("../../components/color"),n=y("../../plot_api/plot_template"),t=y("../subplot_defaults"),a=y("../get_data").getSubplotData,r=y("../cartesian/prefix_suffix_defaults"),d=y("../cartesian/tick_label_defaults"),s=y("../cartesian/line_grid_defaults"),i=y("../cartesian/set_convert"),u=y("./layout_attributes"),f=y("./constants"),c=f.axisNames,h=(g=function(o){return o.slice().reverse().map(function(b){return-b}).concat([0]).concat(o)},v=String,m={},function(o){var b=v?v(o):o;if(b in m)return m[b];var l=g(o);return m[b]=l,l});function p(o,b,l,T){var _=l("bgcolor");T.bgColor=e.combine(_,T.paper_bgcolor);var w,k=a(T.fullData,f.name,T.id),L=T.layoutOut;function M(G,Y){return l(w+"."+G,Y)}for(var I=0;I<c.length;I++){x.isPlainObject(o[w=c[I]])||(o[w]={});var P=o[w],S=n.newContainer(b,w);S._id=S._name=w,S._attr=T.id+"."+w,S._traceIndices=k.map(function(G){return G._expandedIndex});var E=M("visible");if(S.type="linear",i(S,L),r(P,S,M,S.type),E){var z,R,q,V,W="realaxis"===w;W&&M("side"),W?M("tickvals"):M("tickvals",h(b.realaxis.tickvals||u.realaxis.tickvals.dflt));var K=T.font||{};E&&(R=(z=M("color"))===P.color?z:K.color,q=K.size,V=K.family),d(P,S,M,S.type,{noTicklabelstep:!0,noAng:!W,noExp:!0,font:{color:R,size:q,family:V}}),x.coerce2(o,b,u,w+".ticklen"),x.coerce2(o,b,u,w+".tickwidth"),x.coerce2(o,b,u,w+".tickcolor",b.color),M("ticks")||(delete b[w].ticklen,delete b[w].tickwidth,delete b[w].tickcolor),s(P,S,M,{dfltColor:z,bgColor:T.bgColor,blend:60,showLine:!0,showGrid:!0,noZeroLine:!0,attributes:u[w]}),M("layer")}M("hoverformat"),delete S.type,S._input=P}}ee.exports=function(o,b,l){t(o,b,l,{noUirevision:!0,type:f.name,attributes:u,handleDefaults:p,font:b.font,paper_bgcolor:b.paper_bgcolor,fullData:l,layoutOut:b})}},{"../../components/color":367,"../../lib":515,"../../plot_api/plot_template":555,"../cartesian/line_grid_defaults":581,"../cartesian/prefix_suffix_defaults":583,"../cartesian/set_convert":585,"../cartesian/tick_label_defaults":587,"../get_data":602,"../subplot_defaults":641,"./constants":636,"./layout_attributes":639}],641:[function(y,ee,Q){"use strict";var g=y("../lib"),v=y("../plot_api/plot_template"),m=y("./domain").defaults;ee.exports=function(x,e,n,t){var a,r,s=t.attributes,i=t.handleDefaults,u=t.partition||"x",f=e._subplots[t.type],c=f.length,h=c&&f[0].replace(/\d+$/,"");function p(T,_){return g.coerce(a,r,s,T,_)}for(var o=0;o<c;o++){var b=f[o];a=x[b]?x[b]:x[b]={},r=v.newContainer(e,b,h),t.noUirevision||p("uirevision",e.uirevision);var l={};l[u]=[o/c,(o+1)/c],m(r,e,p,l),t.id=b,i(a,r,p,t)}}},{"../lib":515,"../plot_api/plot_template":555,"./domain":593}],642:[function(y,ee,Q){"use strict";function v(m){var x=m.description?" "+m.description:"",e=m.keys||[];if(e.length>0){for(var n=[],t=0;t<e.length;t++)n[t]="`"+e[t]+"`";x+="Finally, the template string has access to ",x=1===e.length?"variable "+n[0]:"variables "+n.slice(0,-1).join(", ")+" and "+n.slice(-1)+"."}return x}y("../constants/docs"),Q.hovertemplateAttrs=function(m,x){m=m||{},v(x=x||{});var e={valType:"string",dflt:"",editType:m.editType||"none"};return!1!==m.arrayOk&&(e.arrayOk=!0),e},Q.texttemplateAttrs=function(m,x){m=m||{},v(x=x||{});var e={valType:"string",dflt:"",editType:m.editType||"calc"};return!1!==m.arrayOk&&(e.arrayOk=!0),e}},{"../constants/docs":486}],643:[function(y,ee,Q){"use strict";var g=y("./ternary"),v=y("../../plots/get_data").getSubplotCalcData,m=y("../../lib").counterRegex;Q.name="ternary";var x=Q.attr="subplot";Q.idRoot="ternary",Q.idRegex=Q.attrRegex=m("ternary"),(Q.attributes={})[x]={valType:"subplotid",dflt:"ternary",editType:"calc"},Q.layoutAttributes=y("./layout_attributes"),Q.supplyLayoutDefaults=y("./layout_defaults"),Q.plot=function(e){for(var n=e._fullLayout,t=e.calcdata,a=n._subplots.ternary,r=0;r<a.length;r++){var d=a[r],s=v(t,"ternary",d),i=n[d]._subplot;i||(i=new g({id:d,graphDiv:e,container:n._ternarylayer.node()},n),n[d]._subplot=i),i.plot(s,n,e._promises)}},Q.clean=function(e,n,t,a){for(var r=a._subplots.ternary||[],d=0;d<r.length;d++){var s=r[d],i=a[s]._subplot;!n[s]&&i&&(i.plotContainer.remove(),i.clipDef.remove(),i.clipDefRelative.remove(),i.layers["a-title"].remove(),i.layers["b-title"].remove(),i.layers["c-title"].remove())}}},{"../../lib":515,"../../plots/get_data":602,"./layout_attributes":644,"./layout_defaults":645,"./ternary":646}],644:[function(y,ee,Q){"use strict";var g=y("../../components/color/attributes"),v=y("../domain").attributes,m=y("../cartesian/layout_attributes"),x=y("../../plot_api/edit_types").overrideAll,e=y("../../lib/extend").extendFlat,n={title:{text:m.title.text,font:m.title.font},color:m.color,tickmode:m.tickmode,nticks:e({},m.nticks,{dflt:6,min:1}),tick0:m.tick0,dtick:m.dtick,tickvals:m.tickvals,ticktext:m.ticktext,ticks:m.ticks,ticklen:m.ticklen,tickwidth:m.tickwidth,tickcolor:m.tickcolor,ticklabelstep:m.ticklabelstep,showticklabels:m.showticklabels,showtickprefix:m.showtickprefix,tickprefix:m.tickprefix,showticksuffix:m.showticksuffix,ticksuffix:m.ticksuffix,showexponent:m.showexponent,exponentformat:m.exponentformat,minexponent:m.minexponent,separatethousands:m.separatethousands,tickfont:m.tickfont,tickangle:m.tickangle,tickformat:m.tickformat,tickformatstops:m.tickformatstops,hoverformat:m.hoverformat,showline:e({},m.showline,{dflt:!0}),linecolor:m.linecolor,linewidth:m.linewidth,showgrid:e({},m.showgrid,{dflt:!0}),gridcolor:m.gridcolor,gridwidth:m.gridwidth,griddash:m.griddash,layer:m.layer,min:{valType:"number",dflt:0,min:0},_deprecated:{title:m._deprecated.title,titlefont:m._deprecated.titlefont}},t=ee.exports=x({domain:v({name:"ternary"}),bgcolor:{valType:"color",dflt:g.background},sum:{valType:"number",dflt:1,min:0},aaxis:n,baxis:n,caxis:n},"plot","from-root");t.uirevision={valType:"any",editType:"none"},t.aaxis.uirevision=t.baxis.uirevision=t.caxis.uirevision={valType:"any",editType:"none"}},{"../../components/color/attributes":366,"../../lib/extend":505,"../../plot_api/edit_types":548,"../cartesian/layout_attributes":579,"../domain":593}],645:[function(y,ee,Q){"use strict";var g=y("../../components/color"),v=y("../../plot_api/plot_template"),m=y("../../lib"),x=y("../subplot_defaults"),e=y("../cartesian/tick_label_defaults"),n=y("../cartesian/prefix_suffix_defaults"),t=y("../cartesian/tick_mark_defaults"),a=y("../cartesian/tick_value_defaults"),r=y("../cartesian/line_grid_defaults"),d=y("./layout_attributes"),s=["aaxis","baxis","caxis"];function i(f,c,h,p){var o,b,l,T=h("bgcolor"),_=h("sum");p.bgColor=g.combine(T,p.paper_bgcolor);for(var w=0;w<s.length;w++)b=f[o=s[w]]||{},(l=v.newContainer(c,o))._name=o,u(b,l,p,c);var k=c.aaxis,L=c.baxis,M=c.caxis;k.min+L.min+M.min>=_&&(k.min=0,L.min=0,M.min=0,f.aaxis&&delete f.aaxis.min,f.baxis&&delete f.baxis.min,f.caxis&&delete f.caxis.min)}function u(f,c,h,p){var o=d[c._name];function b(L,M){return m.coerce(f,c,o,L,M)}b("uirevision",p.uirevision),c.type="linear";var l=b("color"),T=l!==o.color.dflt?l:h.font.color,_=c._name.charAt(0).toUpperCase(),w="Component "+_,k=b("title.text",w);c._hovertitle=k===w?k:_,m.coerceFont(b,"title.font",{family:h.font.family,size:m.bigFont(h.font.size),color:T}),b("min"),a(f,c,b,"linear"),n(f,c,b,"linear"),e(f,c,b,"linear"),t(f,c,b,{outerTicks:!0}),b("showticklabels")&&(m.coerceFont(b,"tickfont",{family:h.font.family,size:h.font.size,color:T}),b("tickangle"),b("tickformat")),r(f,c,b,{dfltColor:l,bgColor:h.bgColor,blend:60,showLine:!0,showGrid:!0,noZeroLine:!0,attributes:o}),b("hoverformat"),b("layer")}ee.exports=function(f,c,h){x(f,c,h,{type:"ternary",attributes:d,handleDefaults:i,font:c.font,paper_bgcolor:c.paper_bgcolor})}},{"../../components/color":367,"../../lib":515,"../../plot_api/plot_template":555,"../cartesian/line_grid_defaults":581,"../cartesian/prefix_suffix_defaults":583,"../cartesian/tick_label_defaults":587,"../cartesian/tick_mark_defaults":588,"../cartesian/tick_value_defaults":589,"../subplot_defaults":641,"./layout_attributes":644}],646:[function(y,ee,Q){"use strict";var g=y("@plotly/d3"),v=y("tinycolor2"),m=y("../../registry"),x=y("../../lib"),e=x.strTranslate,n=x._,t=y("../../components/color"),a=y("../../components/drawing"),r=y("../cartesian/set_convert"),d=y("../../lib/extend").extendFlat,s=y("../plots"),i=y("../cartesian/axes"),u=y("../../components/dragelement"),f=y("../../components/fx"),c=y("../../components/dragelement/helpers"),h=c.freeMode,p=c.rectMode,o=y("../../components/titles"),b=y("../../components/selections").prepSelect,l=y("../../components/selections").selectOnClick,T=y("../../components/selections").clearOutline,_=y("../../components/selections").clearSelectionsCache,w=y("../cartesian/constants");function k(q,V){this.id=q.id,this.graphDiv=q.graphDiv,this.init(V),this.makeFramework(V),this.aTickLayout=null,this.bTickLayout=null,this.cTickLayout=null}ee.exports=k;var L=k.prototype;L.init=function(q){this.container=q._ternarylayer,this.defs=q._defs,this.layoutId=q._uid,this.traceHash={},this.layers={}},L.plot=function(q,V){var W=V[this.id],K=V._size;this._hasClipOnAxisFalse=!1;for(var G=0;G<q.length;G++)if(!1===q[G][0].trace.cliponaxis){this._hasClipOnAxisFalse=!0;break}this.updateLayers(W),this.adjustLayout(W,K),s.generalUpdatePerTraceModule(this.graphDiv,this,q,W),this.layers.plotbg.select("path").call(t.fill,W.bgcolor)},L.makeFramework=function(q){var V=this.graphDiv,W=q[this.id],K=this.clipId="clip"+this.layoutId+this.id,G=this.clipIdRelative="clip-relative"+this.layoutId+this.id;this.clipDef=x.ensureSingleById(q._clips,"clipPath",K,function(Y){Y.append("path").attr("d","M0,0Z")}),this.clipDefRelative=x.ensureSingleById(q._clips,"clipPath",G,function(Y){Y.append("path").attr("d","M0,0Z")}),this.plotContainer=x.ensureSingle(this.container,"g",this.id),this.updateLayers(W),a.setClipUrl(this.layers.backplot,K,V),a.setClipUrl(this.layers.grids,K,V)},L.updateLayers=function(q){var V=this.layers,W=["draglayer","plotbg","backplot","grids"];"below traces"===q.aaxis.layer&&W.push("aaxis","aline"),"below traces"===q.baxis.layer&&W.push("baxis","bline"),"below traces"===q.caxis.layer&&W.push("caxis","cline"),W.push("frontplot"),"above traces"===q.aaxis.layer&&W.push("aaxis","aline"),"above traces"===q.baxis.layer&&W.push("baxis","bline"),"above traces"===q.caxis.layer&&W.push("caxis","cline");var K=this.plotContainer.selectAll("g.toplevel").data(W,String),G=["agrid","bgrid","cgrid"];K.enter().append("g").attr("class",function(Y){return"toplevel "+Y}).each(function(Y){var $=g.select(this);V[Y]=$,"frontplot"===Y?$.append("g").classed("scatterlayer",!0):"backplot"===Y?$.append("g").classed("maplayer",!0):"plotbg"===Y?$.append("path").attr("d","M0,0Z"):"aline"===Y||"bline"===Y||"cline"===Y?$.append("path"):"grids"===Y&&G.forEach(function(B){V[B]=$.append("g").classed("grid "+B,!0)})}),K.order()};var M=Math.sqrt(4/3);L.adjustLayout=function(q,V){var W,K,G,Y,$,B,N=this,U=q.domain,te=(U.x[0]+U.x[1])/2,j=(U.y[0]+U.y[1])/2,J=U.x[1]-U.x[0],X=U.y[1]-U.y[0],re=J*V.w,ne=X*V.h,le=q.sum,oe=q.aaxis.min,de=q.baxis.min,se=q.caxis.min;re>M*ne?G=(Y=ne)*M:Y=(G=re)/M,$=J*G/re,B=X*Y/ne,K=V.t+V.h*(1-j)-Y/2,N.x0=W=V.l+V.w*te-G/2,N.y0=K,N.w=G,N.h=Y,N.sum=le,N.xaxis={type:"linear",range:[oe+2*se-le,le-oe-2*de],domain:[te-$/2,te+$/2],_id:"x"},r(N.xaxis,N.graphDiv._fullLayout),N.xaxis.setScale(),N.xaxis.isPtWithinRange=function(Ne){return Ne.a>=N.aaxis.range[0]&&Ne.a<=N.aaxis.range[1]&&Ne.b>=N.baxis.range[1]&&Ne.b<=N.baxis.range[0]&&Ne.c>=N.caxis.range[1]&&Ne.c<=N.caxis.range[0]},N.yaxis={type:"linear",range:[oe,le-de-se],domain:[j-B/2,j+B/2],_id:"y"},r(N.yaxis,N.graphDiv._fullLayout),N.yaxis.setScale(),N.yaxis.isPtWithinRange=function(){return!0};var ge=N.yaxis.domain[0],_e=N.aaxis=d({},q.aaxis,{range:[oe,le-de-se],side:"left",tickangle:(+q.aaxis.tickangle||0)-30,domain:[ge,ge+B*M],anchor:"free",position:0,_id:"y",_length:G});r(_e,N.graphDiv._fullLayout),_e.setScale();var Te=N.baxis=d({},q.baxis,{range:[le-oe-se,de],side:"bottom",domain:N.xaxis.domain,anchor:"free",position:0,_id:"x",_length:G});r(Te,N.graphDiv._fullLayout),Te.setScale();var we=N.caxis=d({},q.caxis,{range:[le-oe-de,se],side:"right",tickangle:(+q.caxis.tickangle||0)+30,domain:[ge,ge+B*M],anchor:"free",position:0,_id:"y",_length:G});r(we,N.graphDiv._fullLayout),we.setScale();var Oe="M"+W+","+(K+Y)+"h"+G+"l-"+G/2+",-"+Y+"Z";N.clipDef.select("path").attr("d",Oe),N.layers.plotbg.select("path").attr("d",Oe);var fe="M0,"+Y+"h"+G+"l-"+G/2+",-"+Y+"Z";N.clipDefRelative.select("path").attr("d",fe);var ve=e(W,K);N.plotContainer.selectAll(".scatterlayer,.maplayer").attr("transform",ve),N.clipDefRelative.select("path").attr("transform",null);var Ae=e(W-Te._offset,K+Y);N.layers.baxis.attr("transform",Ae),N.layers.bgrid.attr("transform",Ae);var ke=e(W+G/2,K)+"rotate(30)"+e(0,-_e._offset);N.layers.aaxis.attr("transform",ke),N.layers.agrid.attr("transform",ke);var Pe=e(W+G/2,K)+"rotate(-30)"+e(0,-we._offset);N.layers.caxis.attr("transform",Pe),N.layers.cgrid.attr("transform",Pe),N.drawAxes(!0),N.layers.aline.select("path").attr("d",_e.showline?"M"+W+","+(K+Y)+"l"+G/2+",-"+Y:"M0,0").call(t.stroke,_e.linecolor||"#000").style("stroke-width",(_e.linewidth||0)+"px"),N.layers.bline.select("path").attr("d",Te.showline?"M"+W+","+(K+Y)+"h"+G:"M0,0").call(t.stroke,Te.linecolor||"#000").style("stroke-width",(Te.linewidth||0)+"px"),N.layers.cline.select("path").attr("d",we.showline?"M"+(W+G/2)+","+K+"l"+G/2+","+Y:"M0,0").call(t.stroke,we.linecolor||"#000").style("stroke-width",(we.linewidth||0)+"px"),N.graphDiv._context.staticPlot||N.initInteractions(),a.setClipUrl(N.layers.frontplot,N._hasClipOnAxisFalse?null:N.clipId,N.graphDiv)},L.drawAxes=function(q){var V=this.graphDiv,W=this.id.substr(7)+"title",K=this.layers,G=this.aaxis,Y=this.baxis,$=this.caxis;if(this.drawAx(G),this.drawAx(Y),this.drawAx($),q){var B=Math.max(G.showticklabels?G.tickfont.size/2:0,($.showticklabels?.75*$.tickfont.size:0)+("outside"===$.ticks?.87*$.ticklen:0)),N=(Y.showticklabels?Y.tickfont.size:0)+("outside"===Y.ticks?Y.ticklen:0)+3;K["a-title"]=o.draw(V,"a"+W,{propContainer:G,propName:this.id+".aaxis.title",placeholder:n(V,"Click to enter Component A title"),attributes:{x:this.x0+this.w/2,y:this.y0-G.title.font.size/3-B,"text-anchor":"middle"}}),K["b-title"]=o.draw(V,"b"+W,{propContainer:Y,propName:this.id+".baxis.title",placeholder:n(V,"Click to enter Component B title"),attributes:{x:this.x0-N,y:this.y0+this.h+.83*Y.title.font.size+N,"text-anchor":"middle"}}),K["c-title"]=o.draw(V,"c"+W,{propContainer:$,propName:this.id+".caxis.title",placeholder:n(V,"Click to enter Component C title"),attributes:{x:this.x0+this.w+N,y:this.y0+this.h+.83*$.title.font.size+N,"text-anchor":"middle"}})}},L.drawAx=function(q){var V,W=this.graphDiv,K=q._name,G=K.charAt(0),Y=q._id,$=this.layers[K],B=G+"tickLayout",N=(V=q).ticks+String(V.ticklen)+String(V.showticklabels);this[B]!==N&&($.selectAll("."+Y+"tick").remove(),this[B]=N),q.setScale();var U=i.calcTicks(q),te=i.clipEnds(q,U),j=i.makeTransTickFn(q),J=i.getTickSigns(q)[2],X=x.deg2rad(30),re=J*(q.linewidth||1)/2,ne=J*q.ticklen,le=this.w,oe=this.h,de="b"===G?"M0,"+re+"l"+Math.sin(X)*ne+","+Math.cos(X)*ne:"M"+re+",0l"+Math.cos(X)*ne+","+-Math.sin(X)*ne,se={a:"M0,0l"+oe+",-"+le/2,b:"M0,0l-"+le/2+",-"+oe,c:"M0,0l-"+oe+","+le/2}[G];i.drawTicks(W,q,{vals:"inside"===q.ticks?te:U,layer:$,path:de,transFn:j,crisp:!1}),i.drawGrid(W,q,{vals:te,layer:this.layers[G+"grid"],path:se,transFn:j,crisp:!1}),i.drawLabels(W,q,{vals:U,layer:$,transFn:j,labelFns:i.makeLabelFns(q,0,30)})};var I=w.MINZOOM/2+.87,P="m-0.87,.5h"+I+"v3h-"+(I+5.2)+"l"+(I/2+2.6)+",-"+(.87*I+4.5)+"l2.6,1.5l-"+I/2+","+.87*I+"Z",S="m0.87,.5h-"+I+"v3h"+(I+5.2)+"l-"+(I/2+2.6)+",-"+(.87*I+4.5)+"l-2.6,1.5l"+I/2+","+.87*I+"Z",E="m0,1l"+I/2+","+.87*I+"l2.6,-1.5l-"+(I/2+2.6)+",-"+(.87*I+4.5)+"l-"+(I/2+2.6)+","+(.87*I+4.5)+"l2.6,1.5l"+I/2+",-"+.87*I+"Z",z=!0;function R(q){g.select(q).selectAll(".zoombox,.js-zoombox-backdrop,.js-zoombox-menu,.zoombox-corners").remove()}L.clearOutline=function(){_(this.dragOptions),T(this.dragOptions.gd)},L.initInteractions=function(){var q,V,W,K,G,Y,$,B,N,U,te,j,J=this,X=J.layers.plotbg.select("path").node(),re=J.graphDiv,ne=re._fullLayout._zoomlayer;function le(fe){var ve={};return ve[J.id+".aaxis.min"]=fe.a,ve[J.id+".baxis.min"]=fe.b,ve[J.id+".caxis.min"]=fe.c,ve}function oe(fe,ve){var Ae=re._fullLayout.clickmode;R(re),2===fe&&(re.emit("plotly_doubleclick",null),m.call("_guiRelayout",re,le({a:0,b:0,c:0}))),Ae.indexOf("select")>-1&&1===fe&&l(ve,re,[J.xaxis],[J.yaxis],J.id,J.dragOptions),Ae.indexOf("event")>-1&&f.click(re,ve,J.id)}function de(fe,ve){return 1-ve/J.h}function se(fe,ve){return 1-(fe+(J.h-ve)/Math.sqrt(3))/J.w}function ge(fe,ve){return(fe-(J.h-ve)/Math.sqrt(3))/J.w}function _e(fe,ve){var Ae=W+fe*q,ke=K+ve*V,Pe=Math.max(0,Math.min(1,de(0,K),de(0,ke))),Ne=Math.max(0,Math.min(1,se(W,K),se(Ae,ke))),De=Math.max(0,Math.min(1,ge(W,K),ge(Ae,ke))),ze=(Pe/2+De)*J.w,Me=(1-Pe/2-Ne)*J.w,Se=(ze+Me)/2,Ie=Me-ze,Fe=(1-Pe)*J.h,Re=Fe-Ie/M;Ie<w.MINZOOM?($=G,te.attr("d",N),j.attr("d","M0,0Z")):($={a:G.a+Pe*Y,b:G.b+Ne*Y,c:G.c+De*Y},te.attr("d",N+"M"+ze+","+Fe+"H"+Me+"L"+Se+","+Re+"L"+ze+","+Fe+"Z"),j.attr("d","M"+W+","+K+"m0.5,0.5h5v-2h-5v-5h-2v5h-5v2h5v5h2ZM"+ze+","+Fe+P+"M"+Me+","+Fe+S+"M"+Se+","+Re+E)),U||(te.transition().style("fill",B>.2?"rgba(0,0,0,0.4)":"rgba(255,255,255,0.3)").duration(200),j.transition().style("opacity",1).duration(200),U=!0),re.emit("plotly_relayouting",le($))}function Te(){R(re),$!==G&&(m.call("_guiRelayout",re,le($)),z&&re.data&&re._context.showTips&&(x.notifier(n(re,"Double-click to zoom back out"),"long"),z=!1))}function we(fe,ve){var Ae=fe/J.xaxis._m,ke=ve/J.yaxis._m,Pe=[($={a:G.a-ke,b:G.b+(Ae+ke)/2,c:G.c-(Ae-ke)/2}).a,$.b,$.c].sort(x.sorterAsc),Ne=Pe.indexOf($.a),De=Pe.indexOf($.b),ze=Pe.indexOf($.c);Pe[0]<0&&(Pe[1]+Pe[0]/2<0?(Pe[2]+=Pe[0]+Pe[1],Pe[0]=Pe[1]=0):(Pe[2]+=Pe[0]/2,Pe[1]+=Pe[0]/2,Pe[0]=0),ve=(G.a-($={a:Pe[Ne],b:Pe[De],c:Pe[ze]}).a)*J.yaxis._m,fe=(G.c-$.c-G.b+$.b)*J.xaxis._m);var Me=e(J.x0+fe,J.y0+ve);J.plotContainer.selectAll(".scatterlayer,.maplayer").attr("transform",Me);var Se=e(-fe,-ve);J.clipDefRelative.select("path").attr("transform",Se),J.aaxis.range=[$.a,J.sum-$.b-$.c],J.baxis.range=[J.sum-$.a-$.c,$.b],J.caxis.range=[J.sum-$.a-$.b,$.c],J.drawAxes(!1),J._hasClipOnAxisFalse&&J.plotContainer.select(".scatterlayer").selectAll(".trace").call(a.hideOutsideRangePoints,J),re.emit("plotly_relayouting",le($))}function Oe(){m.call("_guiRelayout",re,le($))}this.dragOptions={element:X,gd:re,plotinfo:{id:J.id,domain:re._fullLayout[J.id].domain,xaxis:J.xaxis,yaxis:J.yaxis},subplot:J.id,prepFn:function(fe,ve,Ae){J.dragOptions.xaxes=[J.xaxis],J.dragOptions.yaxes=[J.yaxis],q=re._fullLayout._invScaleX,V=re._fullLayout._invScaleY;var ke=J.dragOptions.dragmode=re._fullLayout.dragmode;J.dragOptions.minDrag=h(ke)?1:void 0,"zoom"===ke?(J.dragOptions.moveFn=_e,J.dragOptions.clickFn=oe,J.dragOptions.doneFn=Te,function(Pe,Ne,De){var ze=X.getBoundingClientRect();W=Ne-ze.left,K=De-ze.top,re._fullLayout._calcInverseTransform(re);var Se=x.apply3DTransform(re._fullLayout._invTransform)(W,K);W=Se[0],K=Se[1],$=G={a:J.aaxis.range[0],b:J.baxis.range[1],c:J.caxis.range[1]},Y=J.aaxis.range[1]-G.a,B=v(J.graphDiv._fullLayout[J.id].bgcolor).getLuminance(),N="M0,"+J.h+"L"+J.w/2+", 0L"+J.w+","+J.h+"Z",U=!1,te=ne.append("path").attr("class","zoombox").attr("transform",e(J.x0,J.y0)).style({fill:B>.2?"rgba(0,0,0,0)":"rgba(255,255,255,0)","stroke-width":0}).attr("d",N),j=ne.append("path").attr("class","zoombox-corners").attr("transform",e(J.x0,J.y0)).style({fill:t.background,stroke:t.defaultLine,"stroke-width":1,opacity:0}).attr("d","M0,0Z"),J.clearOutline(re)}(0,ve,Ae)):"pan"===ke?(J.dragOptions.moveFn=we,J.dragOptions.clickFn=oe,J.dragOptions.doneFn=Oe,$=G={a:J.aaxis.range[0],b:J.baxis.range[1],c:J.caxis.range[1]},J.clearOutline(re)):(p(ke)||h(ke))&&b(fe,ve,Ae,J.dragOptions,ke)}},X.onmousemove=function(fe){f.hover(re,fe,J.id),re._fullLayout._lasthover=X,re._fullLayout._hoversubplot=J.id},X.onmouseout=function(fe){re._dragging||u.unhover(re,fe)},u.init(this.dragOptions)}},{"../../components/color":367,"../../components/dragelement":386,"../../components/dragelement/helpers":385,"../../components/drawing":389,"../../components/fx":407,"../../components/selections":455,"../../components/titles":476,"../../lib":515,"../../lib/extend":505,"../../registry":647,"../cartesian/axes":566,"../cartesian/constants":573,"../cartesian/set_convert":585,"../plots":628,"@plotly/d3":58,tinycolor2:313}],647:[function(y,ee,Q){"use strict";var g=y("./lib/loggers"),v=y("./lib/noop"),m=y("./lib/push_unique"),x=y("./lib/is_plain_object"),e=y("./lib/dom").addStyleRule,n=y("./lib/extend"),t=y("./plots/attributes"),a=y("./plots/layout_attributes"),r=n.extendFlat,d=n.extendDeepAll;function s(l){var T=l.name,_=l.categories,w=l.meta;if(Q.modules[T])g.log("Type "+T+" already registered");else{Q.subplotsRegistry[l.basePlotModule.name]||function(z){var R=z.name;if(Q.subplotsRegistry[R])g.log("Plot type "+R+" already registered.");else for(var q in c(z),Q.subplotsRegistry[R]=z,Q.componentsRegistry)o(q,z.name)}(l.basePlotModule);for(var k={},L=0;L<_.length;L++)k[_[L]]=!0,Q.allCategories[_[L]]=!0;for(var M in Q.modules[T]={_module:l,categories:k},w&&Object.keys(w).length&&(Q.modules[T].meta=w),Q.allTypes.push(T),Q.componentsRegistry)h(M,T);l.layoutAttributes&&r(Q.traceLayoutAttributes,l.layoutAttributes);var I=l.basePlotModule,P=I.name;if("mapbox"===P){var S=I.constants.styleRules;for(var E in S)e(".js-plotly-plot .plotly .mapboxgl-"+E,S[E])}"geo"!==P&&"mapbox"!==P||void 0!==window.PlotlyGeoAssets||(window.PlotlyGeoAssets={topojson:{}})}}function i(l){if("string"!=typeof l.name)throw new Error("Component module *name* must be a string.");var T=l.name;for(var _ in Q.componentsRegistry[T]=l,l.layoutAttributes&&(l.layoutAttributes._isLinkedToArray&&m(Q.layoutArrayContainers,T),c(l)),Q.modules)h(T,_);for(var w in Q.subplotsRegistry)o(T,w);for(var k in Q.transformsRegistry)p(T,k);l.schema&&l.schema.layout&&d(a,l.schema.layout)}function u(l){if("string"!=typeof l.name)throw new Error("Transform module *name* must be a string.");var T="Transform module "+l.name,_="function"==typeof l.transform,w="function"==typeof l.calcTransform;if(!_&&!w)throw new Error(T+" is missing a *transform* or *calcTransform* method.");for(var k in _&&w&&g.log([T+" has both a *transform* and *calcTransform* methods.","Please note that all *transform* methods are executed","before all *calcTransform* methods."].join(" ")),x(l.attributes)||g.log(T+" registered without an *attributes* object."),"function"!=typeof l.supplyDefaults&&g.log(T+" registered without a *supplyDefaults* method."),Q.transformsRegistry[l.name]=l,Q.componentsRegistry)p(k,l.name)}function f(l){var T=l.name,_=T.split("-")[0],w=l.dictionary,k=l.format,L=w&&Object.keys(w).length,M=k&&Object.keys(k).length,I=Q.localeRegistry,P=I[T];if(P||(I[T]=P={}),_!==T){var S=I[_];S||(I[_]=S={}),L&&S.dictionary===P.dictionary&&(S.dictionary=w),M&&S.format===P.format&&(S.format=k)}L&&(P.dictionary=w),M&&(P.format=k)}function c(l){if(l.layoutAttributes){var T=l.layoutAttributes._arrayAttrRegexps;if(T)for(var _=0;_<T.length;_++)m(Q.layoutArrayRegexes,T[_])}}function h(l,T){var _=Q.componentsRegistry[l].schema;if(_&&_.traces){var w=_.traces[T];w&&d(Q.modules[T]._module.attributes,w)}}function p(l,T){var _=Q.componentsRegistry[l].schema;if(_&&_.transforms){var w=_.transforms[T];w&&d(Q.transformsRegistry[T].attributes,w)}}function o(l,T){var _=Q.componentsRegistry[l].schema;if(_&&_.subplots){var w=Q.subplotsRegistry[T],k=w.layoutAttributes,L="subplot"===w.attr?w.name:w.attr;Array.isArray(L)&&(L=L[0]);var M=_.subplots[L];k&&M&&d(k,M)}}function b(l){return"object"==typeof l&&(l=l.type),l}Q.modules={},Q.allCategories={},Q.allTypes=[],Q.subplotsRegistry={},Q.transformsRegistry={},Q.componentsRegistry={},Q.layoutArrayContainers=[],Q.layoutArrayRegexes=[],Q.traceLayoutAttributes={},Q.localeRegistry={},Q.apiMethodRegistry={},Q.collectableSubplotTypes=null,Q.register=function(l){if(Q.collectableSubplotTypes=null,!l)throw new Error("No argument passed to Plotly.register.");l&&!Array.isArray(l)&&(l=[l]);for(var T=0;T<l.length;T++){var _=l[T];if(!_)throw new Error("Invalid module was attempted to be registered!");switch(_.moduleType){case"trace":s(_);break;case"transform":u(_);break;case"component":i(_);break;case"locale":f(_);break;case"apiMethod":Q.apiMethodRegistry[_.name]=_.fn;break;default:throw new Error("Invalid module was attempted to be registered!")}}},Q.getModule=function(l){var T=Q.modules[b(l)];return!!T&&T._module},Q.traceIs=function(l,T){if("various"===(l=b(l)))return!1;var _=Q.modules[l];return _||(l&&g.log("Unrecognized trace type "+l+"."),_=Q.modules[t.type.dflt]),!!_.categories[T]},Q.getTransformIndices=function(l,T){for(var _=[],w=l.transforms||[],k=0;k<w.length;k++)w[k].type===T&&_.push(k);return _},Q.hasTransform=function(l,T){for(var _=l.transforms||[],w=0;w<_.length;w++)if(_[w].type===T)return!0;return!1},Q.getComponentMethod=function(l,T){var _=Q.componentsRegistry[l];return _&&_[T]||v},Q.call=function(){var l=arguments[0],T=[].slice.call(arguments,1);return Q.apiMethodRegistry[l].apply(null,T)}},{"./lib/dom":503,"./lib/extend":505,"./lib/is_plain_object":516,"./lib/loggers":519,"./lib/noop":524,"./lib/push_unique":530,"./plots/attributes":562,"./plots/layout_attributes":619}],648:[function(y,ee,Q){"use strict";var g=y("../registry"),v=y("../lib"),m=v.extendFlat,x=v.extendDeep;function e(n){var t;switch(n){case"themes__thumb":t={autosize:!0,width:150,height:150,title:{text:""},showlegend:!1,margin:{l:5,r:5,t:5,b:5,pad:0},annotations:[]};break;case"thumbnail":t={title:{text:""},hidesources:!0,showlegend:!1,borderwidth:0,bordercolor:"",margin:{l:1,r:1,t:1,b:1,pad:0},annotations:[]};break;default:t={}}return t}ee.exports=function(n,t){var a,s=n.layout,i=x([],n.data),u=x({},s,e(t.tileClass)),f=n._context||{};if(t.width&&(u.width=t.width),t.height&&(u.height=t.height),"thumbnail"===t.tileClass||"themes__thumb"===t.tileClass){u.annotations=[];var c=Object.keys(u);for(a=0;a<c.length;a++)["xaxis","yaxis","zaxis"].indexOf(c[a].slice(0,5))>-1&&(u[c[a]].title={text:""});for(a=0;a<i.length;a++){var h=i[a];h.showscale=!1,h.marker&&(h.marker.showscale=!1),g.traceIs(h,"pie-like")&&(h.textposition="none")}}if(Array.isArray(t.annotations))for(a=0;a<t.annotations.length;a++)u.annotations.push(t.annotations[a]);var p=Object.keys(u).filter(function(_){return _.match(/^scene\d*$/)});if(p.length){var o={};for("thumbnail"===t.tileClass&&(o={title:{text:""},showaxeslabels:!1,showticklabels:!1,linetickenable:!1}),a=0;a<p.length;a++){var b=u[p[a]];b.xaxis||(b.xaxis={}),b.yaxis||(b.yaxis={}),b.zaxis||(b.zaxis={}),m(b.xaxis,o),m(b.yaxis,o),m(b.zaxis,o),b._scene=null}}var l=document.createElement("div");t.tileClass&&(l.className=t.tileClass);var T={gd:l,td:l,layout:u,data:i,config:{staticPlot:void 0===t.staticPlot||t.staticPlot,plotGlPixelRatio:void 0===t.plotGlPixelRatio?2:t.plotGlPixelRatio,displaylogo:t.displaylogo||!1,showLink:t.showLink||!1,showTips:t.showTips||!1,mapboxAccessToken:f.mapboxAccessToken}};return"transparent"!==t.setBackground&&(T.config.setBackground=t.setBackground||"opaque"),T.gd.defaultLayout=e(t.tileClass),T}},{"../lib":515,"../registry":647}],649:[function(y,ee,Q){"use strict";var g=y("../lib"),v=y("../plot_api/to_image"),m=y("./filesaver"),x=y("./helpers");ee.exports=function(e,n){var t;return g.isPlainObject(e)||(t=g.getGraphDiv(e)),(n=n||{}).format=n.format||"png",n.width=n.width||null,n.height=n.height||null,n.imageDataOnly=!0,new Promise(function(a,r){t&&t._snapshotInProgress&&r(new Error("Snapshotting already in progress.")),g.isIE()&&"svg"!==n.format&&r(new Error(x.MSG_IE_BAD_FORMAT)),t&&(t._snapshotInProgress=!0);var d=v(e,n),s=n.filename||e.fn||"newplot";s+="."+n.format.replace("-","."),d.then(function(i){return t&&(t._snapshotInProgress=!1),m(i,s,n.format)}).then(function(i){a(i)}).catch(function(i){t&&(t._snapshotInProgress=!1),r(i)})})}},{"../lib":515,"../plot_api/to_image":558,"./filesaver":650,"./helpers":651}],650:[function(y,ee,Q){"use strict";var g=y("../lib"),v=y("./helpers");ee.exports=function(m,x,e){var n=document.createElement("a"),t="download"in n;return new Promise(function(a,r){var d,s;return g.isIE()?(d=v.createBlob(m,"svg"),window.navigator.msSaveBlob(d,x),d=null,a(x)):t?(d=v.createBlob(m,e),s=v.createObjectURL(d),n.href=s,n.download=x,document.body.appendChild(n),n.click(),document.body.removeChild(n),v.revokeObjectURL(s),d=null,a(x)):g.isSafari()?(v.octetStream(("svg"===e?",":";base64,")+encodeURIComponent(m)),a(x)):void r(new Error("download error"))})}},{"../lib":515,"./helpers":651}],651:[function(y,ee,Q){"use strict";var g=y("../registry");Q.getDelay=function(m){return m._has&&(m._has("gl3d")||m._has("gl2d")||m._has("mapbox"))?500:0},Q.getRedrawFunc=function(m){return function(){g.getComponentMethod("colorbar","draw")(m)}},Q.encodeSVG=function(m){return"data:image/svg+xml,"+encodeURIComponent(m)},Q.encodeJSON=function(m){return"data:application/json,"+encodeURIComponent(m)};var v=window.URL||window.webkitURL;Q.createObjectURL=function(m){return v.createObjectURL(m)},Q.revokeObjectURL=function(m){return v.revokeObjectURL(m)},Q.createBlob=function(m,x){if("svg"===x)return new window.Blob([m],{type:"image/svg+xml;charset=utf-8"});if("full-json"===x)return new window.Blob([m],{type:"application/json;charset=utf-8"});var e=function(n){for(var t=n.length,a=new ArrayBuffer(t),r=new Uint8Array(a),d=0;d<t;d++)r[d]=n.charCodeAt(d);return a}(window.atob(m));return new window.Blob([e],{type:"image/"+x})},Q.octetStream=function(m){document.location.href="data:application/octet-stream"+m},Q.IMAGE_URL_PREFIX=/^data:image\/\w+;base64,/,Q.MSG_IE_BAD_FORMAT="Sorry IE does not support downloading from canvas. Try {format:'svg'} instead."},{"../registry":647}],652:[function(y,ee,Q){"use strict";var g=y("./helpers"),v={getDelay:g.getDelay,getRedrawFunc:g.getRedrawFunc,clone:y("./cloneplot"),toSVG:y("./tosvg"),svgToImg:y("./svgtoimg"),toImage:y("./toimage"),downloadImage:y("./download")};ee.exports=v},{"./cloneplot":648,"./download":649,"./helpers":651,"./svgtoimg":653,"./toimage":654,"./tosvg":655}],653:[function(y,ee,Q){"use strict";var g=y("../lib"),v=y("events").EventEmitter,m=y("./helpers");ee.exports=function(x){var e=x.emitter||new v,n=new Promise(function(t,a){var r=window.Image,d=x.svg,s=x.format||"png";if(g.isIE()&&"svg"!==s){var i=new Error(m.MSG_IE_BAD_FORMAT);return a(i),x.promise?n:e.emit("error",i)}var u,f,c=x.canvas,h=x.scale||1,b=h*(x.width||300),l=h*(x.height||150),T=c.getContext("2d",{willReadFrequently:!0}),_=new r;"svg"===s||g.isSafari()?f=m.encodeSVG(d):(u=m.createBlob(d,"svg"),f=m.createObjectURL(u)),c.width=b,c.height=l,_.onload=function(){var w;switch(u=null,m.revokeObjectURL(f),"svg"!==s&&T.drawImage(_,0,0,b,l),s){case"jpeg":w=c.toDataURL("image/jpeg");break;case"png":w=c.toDataURL("image/png");break;case"webp":w=c.toDataURL("image/webp");break;case"svg":w=f;break;default:var k="Image format is not jpeg, png, svg or webp.";if(a(new Error(k)),!x.promise)return e.emit("error",k)}t(w),x.promise||e.emit("success",w)},_.onerror=function(w){if(u=null,m.revokeObjectURL(f),a(w),!x.promise)return e.emit("error",w)},_.src=f});return x.promise?n:e}},{"../lib":515,"./helpers":651,events:84}],654:[function(y,ee,Q){"use strict";var g=y("events").EventEmitter,v=y("../registry"),m=y("../lib"),x=y("./helpers"),e=y("./cloneplot"),n=y("./tosvg"),t=y("./svgtoimg");ee.exports=function(a,r){var d=new g,s=e(a,{format:"png"}),i=s.gd;i.style.position="absolute",i.style.left="-5000px",document.body.appendChild(i);var u=x.getRedrawFunc(i);return v.call("_doPlot",i,s.data,s.layout,s.config).then(u).then(function(){var f=x.getDelay(i._fullLayout);setTimeout(function(){var c=n(i),h=document.createElement("canvas");h.id=m.randstr(),(d=t({format:r.format,width:i._fullLayout.width,height:i._fullLayout.height,canvas:h,emitter:d,svg:c})).clean=function(){i&&document.body.removeChild(i)}},f)}).catch(function(f){d.emit("error",f)}),d}},{"../lib":515,"../registry":647,"./cloneplot":648,"./helpers":651,"./svgtoimg":653,"./tosvg":655,events:84}],655:[function(y,ee,Q){"use strict";var g=y("@plotly/d3"),v=y("../lib"),m=y("../components/drawing"),x=y("../components/color"),e=y("../constants/xmlns_namespaces"),n=/"/g,t=new RegExp('("TOBESTRIPPED)|(TOBESTRIPPED")',"g");ee.exports=function(a,r,d){var s,i=a._fullLayout,u=i._paper,f=i._toppaper,c=i.width,h=i.height;u.insert("rect",":first-child").call(m.setRect,0,0,c,h).call(x.fill,i.paper_bgcolor);var p=i._basePlotModules||[];for(s=0;s<p.length;s++){var o=p[s];o.toSVG&&o.toSVG(a)}if(f){var b=f.node().childNodes,l=Array.prototype.slice.call(b);for(s=0;s<l.length;s++){var T=l[s];T.childNodes.length&&u.node().appendChild(T)}}i._draggers&&i._draggers.remove(),u.node().style.background="",u.selectAll("text").attr({"data-unformatted":null,"data-math":null}).each(function(){var w=g.select(this);if("hidden"!==this.style.visibility&&"none"!==this.style.display){w.style({visibility:null,display:null});var k=this.style.fontFamily;k&&-1!==k.indexOf('"')&&w.style("font-family",k.replace(n,"TOBESTRIPPED"))}else w.remove()}),u.selectAll(".gradient_filled,.pattern_filled").each(function(){var w=g.select(this),k=this.style.fill;k&&-1!==k.indexOf("url(")&&w.style("fill",k.replace(n,"TOBESTRIPPED"));var L=this.style.stroke;L&&-1!==L.indexOf("url(")&&w.style("stroke",L.replace(n,"TOBESTRIPPED"))}),"pdf"!==r&&"eps"!==r||u.selectAll("#MathJax_SVG_glyphs path").attr("stroke-width",0),u.node().setAttributeNS(e.xmlns,"xmlns",e.svg),u.node().setAttributeNS(e.xmlns,"xmlns:xlink",e.xlink),"svg"===r&&d&&(u.attr("width",d*c),u.attr("height",d*h),u.attr("viewBox","0 0 "+c+" "+h));var w,k,L,_=(new window.XMLSerializer).serializeToString(u.node());return w=_,k=g.select("body").append("div").style({display:"none"}).html(""),L=w.replace(/(&[^;]*;)/gi,function(M){return"&lt;"===M?"&#60;":"&rt;"===M?"&#62;":-1!==M.indexOf("<")||-1!==M.indexOf(">")?"":k.html(M).text()}),k.remove(),_=(_=(_=L).replace(/&(?!\w+;|\#[0-9]+;| \#x[0-9A-F]+;)/g,"&amp;")).replace(t,"'"),v.isIE()&&(_=(_=(_=_.replace(/"/gi,"'")).replace(/(\('#)([^']*)('\))/gi,'("#$2")')).replace(/(\\')/gi,'"')),_}},{"../components/color":367,"../components/drawing":389,"../constants/xmlns_namespaces":492,"../lib":515,"@plotly/d3":58}],656:[function(y,ee,Q){"use strict";var g=y("../../lib");ee.exports=function(v,m){for(var x=0;x<v.length;x++)v[x].i=x;g.mergeArray(m.text,v,"tx"),g.mergeArray(m.hovertext,v,"htx");var e=m.marker;if(e){g.mergeArray(e.opacity,v,"mo",!0),g.mergeArray(e.color,v,"mc");var n=e.line;n&&(g.mergeArray(n.color,v,"mlc"),g.mergeArrayCastPositive(n.width,v,"mlw"))}}},{"../../lib":515}],657:[function(y,ee,Q){"use strict";var g=y("../scatter/attributes"),v=y("../../plots/cartesian/axis_format_attributes").axisHoverFormat,m=y("../../plots/template_attributes").hovertemplateAttrs,x=y("../../plots/template_attributes").texttemplateAttrs,e=y("../../components/colorscale/attributes"),n=y("../../plots/font_attributes"),t=y("./constants"),a=y("../../components/drawing/attributes").pattern,r=y("../../lib/extend").extendFlat,d=n({editType:"calc",arrayOk:!0,colorEditType:"style"}),s=r({},g.marker.line.width,{dflt:0}),i=r({width:s,editType:"calc"},e("marker.line")),u=r({line:i,editType:"calc"},e("marker"),{opacity:{valType:"number",arrayOk:!0,dflt:1,min:0,max:1,editType:"style"},pattern:a});ee.exports={x:g.x,x0:g.x0,dx:g.dx,y:g.y,y0:g.y0,dy:g.dy,xperiod:g.xperiod,yperiod:g.yperiod,xperiod0:g.xperiod0,yperiod0:g.yperiod0,xperiodalignment:g.xperiodalignment,yperiodalignment:g.yperiodalignment,xhoverformat:v("x"),yhoverformat:v("y"),text:g.text,texttemplate:x({editType:"plot"},{keys:t.eventDataKeys}),hovertext:g.hovertext,hovertemplate:m({},{keys:t.eventDataKeys}),textposition:{valType:"enumerated",values:["inside","outside","auto","none"],dflt:"auto",arrayOk:!0,editType:"calc"},insidetextanchor:{valType:"enumerated",values:["end","middle","start"],dflt:"end",editType:"plot"},textangle:{valType:"angle",dflt:"auto",editType:"plot"},textfont:r({},d,{}),insidetextfont:r({},d,{}),outsidetextfont:r({},d,{}),constraintext:{valType:"enumerated",values:["inside","outside","both","none"],dflt:"both",editType:"calc"},cliponaxis:r({},g.cliponaxis,{}),orientation:{valType:"enumerated",values:["v","h"],editType:"calc+clearAxisTypes"},base:{valType:"any",dflt:null,arrayOk:!0,editType:"calc"},offset:{valType:"number",dflt:null,arrayOk:!0,editType:"calc"},width:{valType:"number",dflt:null,min:0,arrayOk:!0,editType:"calc"},marker:u,offsetgroup:{valType:"string",dflt:"",editType:"calc"},alignmentgroup:{valType:"string",dflt:"",editType:"calc"},selected:{marker:{opacity:g.selected.marker.opacity,color:g.selected.marker.color,editType:"style"},textfont:g.selected.textfont,editType:"style"},unselected:{marker:{opacity:g.unselected.marker.opacity,color:g.unselected.marker.color,editType:"style"},textfont:g.unselected.textfont,editType:"style"},_deprecated:{bardir:{valType:"enumerated",editType:"calc",values:["v","h"]}}}},{"../../components/colorscale/attributes":374,"../../components/drawing/attributes":388,"../../lib/extend":505,"../../plots/cartesian/axis_format_attributes":569,"../../plots/font_attributes":594,"../../plots/template_attributes":642,"../scatter/attributes":936,"./constants":659}],658:[function(y,ee,Q){"use strict";var g=y("../../plots/cartesian/axes"),v=y("../../plots/cartesian/align_period"),m=y("../../components/colorscale/helpers").hasColorscale,x=y("../../components/colorscale/calc"),e=y("./arrays_to_calcdata"),n=y("../scatter/calc_selection");ee.exports=function(t,a){var r,d,s,i,u,f,c=g.getFromId(t,a.xaxis||"x"),h=g.getFromId(t,a.yaxis||"y"),p={msUTC:!(!a.base&&0!==a.base)};"h"===a.orientation?(r=c.makeCalcdata(a,"x",p),s=h.makeCalcdata(a,"y"),i=v(a,h,"y",s),u=!!a.yperiodalignment,f="y"):(r=h.makeCalcdata(a,"y",p),s=c.makeCalcdata(a,"x"),i=v(a,c,"x",s),u=!!a.xperiodalignment,f="x"),d=i.vals;for(var o=Math.min(d.length,r.length),b=new Array(o),l=0;l<o;l++)b[l]={p:d[l],s:r[l]},u&&(b[l].orig_p=s[l],b[l][f+"End"]=i.ends[l],b[l][f+"Start"]=i.starts[l]),a.ids&&(b[l].id=String(a.ids[l]));return m(a,"marker")&&x(t,a,{vals:a.marker.color,containerStr:"marker",cLetter:"c"}),m(a,"marker.line")&&x(t,a,{vals:a.marker.line.color,containerStr:"marker.line",cLetter:"c"}),e(b,a),n(b,a),b}},{"../../components/colorscale/calc":375,"../../components/colorscale/helpers":378,"../../plots/cartesian/align_period":563,"../../plots/cartesian/axes":566,"../scatter/calc_selection":938,"./arrays_to_calcdata":656}],659:[function(y,ee,Q){"use strict";ee.exports={TEXTPAD:3,eventDataKeys:["value","label"]}},{}],660:[function(y,ee,Q){"use strict";var g=y("fast-isnumeric"),v=y("../../lib").isArrayOrTypedArray,m=y("../../constants/numerical").BADNUM,x=y("../../registry"),e=y("../../plots/cartesian/axes"),n=y("../../plots/cartesian/constraints").getAxisGroup,t=y("./sieve.js");function a(o,b,l,T,_){if(T.length){var w,k,L,M;switch(function(I,P){var S,E;for(S=0;S<P.length;S++){var z,R=P[S],q=R[0].trace,V="funnel"===q.type?q._base:q.base,W="h"===q.orientation?q.xcalendar:q.ycalendar,K="category"===I.type||"multicategory"===I.type?function(){return null}:I.d2c;if(v(V)){for(E=0;E<Math.min(V.length,R.length);E++)z=K(V[E],0,W),g(z)?(R[E].b=+z,R[E].hasB=1):R[E].b=0;for(;E<R.length;E++)R[E].b=0}else{z=K(V,0,W);var G=g(z);for(z=G?z:0,E=0;E<R.length;E++)R[E].b=z,G&&(R[E].hasB=1)}}}(l,T),_.mode){case"overlay":r(b,l,T,_);break;case"group":for(w=[],k=[],L=0;L<T.length;L++)void 0===(M=T[L])[0].trace.offset?k.push(M):w.push(M);k.length&&(I=o,S=l,R=new t(k,{posAxis:P=b,sepNegVal:!1,overlapNoMerge:!(z=_).norm}),function(q,V,W,K){for(var G=q._fullLayout,B=W.minDiff,N=W.traces,U=N.length,te=W.positions.length!==W.distinctPositions.length,j=B*(1-K.gap),J=n(G,V._id)+N[0][0].trace.orientation,X=G._alignmentOpts[J]||{},re=0;re<U;re++){var ne,le,oe=N[re],de=oe[0].trace,ge=Object.keys((X[de.alignmentgroup]||{}).offsetGroups||{}).length,_e=(ne=ge?j/ge:te?j/U:j)*(1-(K.groupgap||0));le=ge?((2*de._offsetIndex+1-ge)*ne-_e)/2:te?((2*re+1-U)*ne-_e)/2:-_e/2;var Te=oe[0].t;Te.barwidth=_e,Te.poffset=le,Te.bargroupwidth=j,Te.bardelta=B}W.binWidth=N[0][0].t.barwidth/100,s(W),i(V,W),u(V,W,te)}(I,P,R,z),function(q,V){for(var W=q.traces,K=0;K<W.length;K++){var G=W[K];if(void 0===G[0].trace.base)for(var Y=new t([G],{posAxis:V,sepNegVal:!0,overlapNoMerge:!0}),$=0;$<G.length;$++){var B=G[$];if(B.p!==m){var N=Y.put(B.p,B.b+B.s);N&&(B.b=N)}}}}(R,P),z.norm?(c(R),h(S,R,z)):f(S,R)),w.length&&r(b,l,w,_);break;case"stack":case"relative":for(w=[],k=[],L=0;L<T.length;L++)void 0===(M=T[L])[0].trace.base?k.push(M):w.push(M);k.length&&function(I,P,S,E,z){var R=new t(E,{posAxis:P,sepNegVal:"relative"===z.mode,overlapNoMerge:!(z.norm||"stack"===z.mode||"relative"===z.mode)});d(P,R,z),function(G,Y,$){var B,N,U,te,j,J,X=p(G),re=Y.traces;for(te=0;te<re.length;te++)if("funnel"===(N=(B=re[te])[0].trace).type)for(j=0;j<B.length;j++)(J=B[j]).s!==m&&Y.put(J.p,-.5*J.s);for(te=0;te<re.length;te++){U="funnel"===(N=(B=re[te])[0].trace).type;var ne=[];for(j=0;j<B.length;j++)if((J=B[j]).s!==m){var le,oe=Y.put(J.p,le=U?J.s:J.s+J.b),de=oe+le;J.b=oe,J[X]=de,$.norm||(ne.push(de),J.hasB&&ne.push(oe))}$.norm||(N._extremes[G._id]=e.findExtremes(G,ne,{tozero:!0,padded:!0}))}}(S,R,z);for(var q=0;q<E.length;q++)for(var V=E[q],W=0;W<V.length;W++){var K=V[W];K.s!==m&&K.b+K.s===R.get(K.p,K.s)&&(K._outmost=!0)}z.norm&&h(S,R,z)}(0,b,l,k,_),w.length&&r(b,l,w,_)}!function(I,P){var S,E,z,R=p(P),q={},V=1/0,W=-1/0;for(S=0;S<I.length;S++)for(z=I[S],E=0;E<z.length;E++){var K=z[E].p;g(K)&&(V=Math.min(V,K),W=Math.max(W,K))}var G=1e4/(W-V),Y=q.round=function(J){return String(Math.round(G*(J-V)))};for(S=0;S<I.length;S++){(z=I[S])[0].t.extents=q;var $=z[0].t.poffset,B=Array.isArray($);for(E=0;E<z.length;E++){var N=z[E],U=N[R]-N.w/2;if(g(U)){var te=N[R]+N.w/2,j=Y(N.p);q[j]=q[j]?[Math.min(U,q[j][0]),Math.max(te,q[j][1])]:[U,te]}N.p0=N.p+(B?$[E]:$),N.p1=N.p0+N.w,N.s0=N.b,N.s1=N.s0+N.s}}}(T,b)}var I,P,S,z,R}function r(o,b,l,T){for(var _=0;_<l.length;_++){var k=new t([l[_]],{posAxis:o,sepNegVal:!1,overlapNoMerge:!T.norm});d(o,k,T),T.norm?(c(k),h(b,k,T)):f(b,k)}}function d(o,b,l){for(var T=b.minDiff,_=b.traces,w=T*(1-l.gap),k=w*(1-(l.groupgap||0)),L=-k/2,M=0;M<_.length;M++){var I=_[M][0].t;I.barwidth=k,I.poffset=L,I.bargroupwidth=w,I.bardelta=T}b.binWidth=_[0][0].t.barwidth/100,s(b),i(o,b),u(o,b)}function s(o){var b,l,T=o.traces;for(b=0;b<T.length;b++){var _,w=T[b],k=w[0],L=k.trace,M=k.t,I=L._offset||L.offset,P=M.poffset;if(v(I)){for(_=Array.prototype.slice.call(I,0,w.length),l=0;l<_.length;l++)g(_[l])||(_[l]=P);for(l=_.length;l<w.length;l++)_.push(P);M.poffset=_}else void 0!==I&&(M.poffset=I);var S=L._width||L.width,E=M.barwidth;if(v(S)){var z=Array.prototype.slice.call(S,0,w.length);for(l=0;l<z.length;l++)g(z[l])||(z[l]=E);for(l=z.length;l<w.length;l++)z.push(E);if(M.barwidth=z,void 0===I){for(_=[],l=0;l<w.length;l++)_.push(P+(E-z[l])/2);M.poffset=_}}else void 0!==S&&(M.barwidth=S,void 0===I&&(M.poffset=P+(E-S)/2))}}function i(o,b){for(var l=b.traces,T=p(o),_=0;_<l.length;_++)for(var w=l[_],k=w[0].t,L=k.poffset,M=Array.isArray(L),I=k.barwidth,P=Array.isArray(I),S=0;S<w.length;S++){var E=w[S],z=E.w=P?I[S]:I;E[T]=E.p+(M?L[S]:L)+z/2}}function u(o,b,l){var T=b.traces,_=b.minDiff/2;e.minDtick(o,b.minDiff,b.distinctPositions[0],l);for(var w=0;w<T.length;w++){var k,L,M,I,P=T[w],S=P[0],E=S.trace,z=[];for(I=0;I<P.length;I++)L=(k=P[I]).p-_,z.push(L,M=k.p+_);if(E.width||E.offset){var R=S.t,q=R.poffset,V=R.barwidth,W=Array.isArray(q),K=Array.isArray(V);for(I=0;I<P.length;I++)M=(L=(k=P[I]).p+(W?q[I]:q))+(K?V[I]:V),z.push(L,M)}E._extremes[o._id]=e.findExtremes(o,z,{padded:!1})}}function f(o,b){for(var l=b.traces,T=p(o),_=0;_<l.length;_++){for(var w=l[_],k=w[0].trace,L=[],M=!1,I=0;I<w.length;I++){var P=w[I],S=P.b,E=S+P.s;P[T]=E,L.push(E),P.hasB&&L.push(S),P.hasB&&P.b||(M=!0)}k._extremes[o._id]=e.findExtremes(o,L,{tozero:M,padded:!0})}}function c(o){for(var b=o.traces,l=0;l<b.length;l++)for(var T=b[l],_=0;_<T.length;_++){var w=T[_];w.s!==m&&o.put(w.p,w.b+w.s)}}function h(o,b,l){var T=b.traces,_=p(o),w="fraction"===l.norm?1:100,k=w/1e9,L=o.l2c(o.c2l(0)),M="stack"===l.mode?w:L;function I($){return g(o.c2l($))&&($<L-k||$>M+k||!g(L))}for(var P=0;P<T.length;P++){for(var S=T[P],E=S[0].trace,z=[],R=!1,q=!1,V=0;V<S.length;V++){var W=S[V];if(W.s!==m){var K=Math.abs(w/b.get(W.p,W.s));W.b*=K,W.s*=K;var G=W.b,Y=G+W.s;W[_]=Y,z.push(Y),q=q||I(Y),W.hasB&&(z.push(G),q=q||I(G)),W.hasB&&W.b||(R=!0)}}E._extremes[o._id]=e.findExtremes(o,z,{tozero:R,padded:q})}}function p(o){return o._id.charAt(0)}ee.exports={crossTraceCalc:function(o,b){for(var l=b.xaxis,T=b.yaxis,_=o._fullLayout,w=o._fullData,k=o.calcdata,L=[],M=[],I=0;I<w.length;I++){var P=w[I];if(!0===P.visible&&x.traceIs(P,"bar")&&P.xaxis===l._id&&P.yaxis===T._id&&("h"===P.orientation?L.push(k[I]):M.push(k[I]),P._computePh))for(var S=o.calcdata[I],E=0;E<S.length;E++)"function"==typeof S[E].ph0&&(S[E].ph0=S[E].ph0()),"function"==typeof S[E].ph1&&(S[E].ph1=S[E].ph1())}var z={xCat:"category"===l.type||"multicategory"===l.type,yCat:"category"===T.type||"multicategory"===T.type,mode:_.barmode,norm:_.barnorm,gap:_.bargap,groupgap:_.bargroupgap};a(o,l,T,M,z),a(o,T,l,L,z)},setGroupPositions:a}},{"../../constants/numerical":491,"../../lib":515,"../../plots/cartesian/axes":566,"../../plots/cartesian/constraints":574,"../../registry":647,"./sieve.js":670,"fast-isnumeric":190}],661:[function(y,ee,Q){"use strict";var g=y("../../lib"),v=y("../../components/color"),m=y("../../registry"),x=y("../scatter/xy_defaults"),e=y("../scatter/period_defaults"),n=y("./style_defaults"),t=y("../../plots/cartesian/constraints").getAxisGroup,a=y("./attributes"),r=g.coerceFont;function d(i,u,f,c){var h=u.orientation,o=t(f,u[{v:"x",h:"y"}[h]+"axis"])+h,b=f._alignmentOpts||{},l=c("alignmentgroup"),T=b[o];T||(T=b[o]={});var _=T[l];_?_.traces.push(u):_=T[l]={traces:[u],alignmentIndex:Object.keys(T).length,offsetGroups:{}};var w=c("offsetgroup"),k=_.offsetGroups,L=k[w];w&&(L||(L=k[w]={offsetIndex:Object.keys(k).length}),u._offsetIndex=L.offsetIndex)}function s(i,u,f,c,h,p){var o=!1!==(p=p||{}).moduleHasSelected,b=!1!==p.moduleHasUnselected,l=!1!==p.moduleHasConstrain,T=!1!==p.moduleHasCliponaxis,_=!1!==p.moduleHasTextangle,w=!1!==p.moduleHasInsideanchor,k=!!p.hasPathbar,L=Array.isArray(h)||"auto"===h,M=L||"inside"===h,I=L||"outside"===h;if(M||I){var P=r(c,"textfont",f.font),S=g.extendFlat({},P),E=!(i.textfont&&i.textfont.color);if(E&&delete S.color,r(c,"insidetextfont",S),k){var z=g.extendFlat({},P);E&&delete z.color,r(c,"pathbar.textfont",z)}I&&r(c,"outsidetextfont",P),o&&c("selected.textfont.color"),b&&c("unselected.textfont.color"),l&&c("constraintext"),T&&c("cliponaxis"),_&&c("textangle"),c("texttemplate")}M&&w&&c("insidetextanchor")}ee.exports={supplyDefaults:function(i,u,f,c){function h(l,T){return g.coerce(i,u,a,l,T)}if(x(i,u,c,h)){e(i,u,c,h),h("xhoverformat"),h("yhoverformat"),h("orientation",u.x&&!u.y?"h":"v"),h("base"),h("offset"),h("width"),h("text"),h("hovertext"),h("hovertemplate");var p=h("textposition");s(i,0,c,h,p,{moduleHasSelected:!0,moduleHasUnselected:!0,moduleHasConstrain:!0,moduleHasCliponaxis:!0,moduleHasTextangle:!0,moduleHasInsideanchor:!0}),n(i,u,h,f,c);var o=(u.marker.line||{}).color,b=m.getComponentMethod("errorbars","supplyDefaults");b(i,u,o||v.defaultLine,{axis:"y"}),b(i,u,o||v.defaultLine,{axis:"x",inherit:"y"}),g.coerceSelectionMarkerOpacity(u,h)}else u.visible=!1},crossTraceDefaults:function(i,u){var f;function c(p){return g.coerce(f._input,f,a,p)}if("group"===u.barmode)for(var h=0;h<i.length;h++)"bar"===(f=i[h]).type&&d(0,f,u,c)},handleGroupingDefaults:d,handleText:s}},{"../../components/color":367,"../../lib":515,"../../plots/cartesian/constraints":574,"../../registry":647,"../scatter/period_defaults":956,"../scatter/xy_defaults":963,"./attributes":657,"./style_defaults":672}],662:[function(y,ee,Q){"use strict";ee.exports=function(g,v,m){return g.x="xVal"in v?v.xVal:v.x,g.y="yVal"in v?v.yVal:v.y,v.xa&&(g.xaxis=v.xa),v.ya&&(g.yaxis=v.ya),"h"===m.orientation?(g.label=g.y,g.value=g.x):(g.label=g.x,g.value=g.y),g}},{}],663:[function(y,ee,Q){"use strict";var g=y("fast-isnumeric"),v=y("tinycolor2"),m=y("../../lib").isArrayOrTypedArray;Q.coerceString=function(x,e,n){if("string"==typeof e){if(e||!x.noBlank)return e}else if(("number"==typeof e||!0===e)&&!x.strict)return String(e);return void 0!==n?n:x.dflt},Q.coerceNumber=function(x,e,n){if(g(e)){e=+e;var t=x.min,a=x.max;if(!(void 0!==t&&e<t||void 0!==a&&e>a))return e}return void 0!==n?n:x.dflt},Q.coerceColor=function(x,e,n){return v(e).isValid()?e:void 0!==n?n:x.dflt},Q.coerceEnumerated=function(x,e,n){return x.coerceNumber&&(e=+e),-1!==x.values.indexOf(e)?e:void 0!==n?n:x.dflt},Q.getValue=function(x,e){var n;return Array.isArray(x)?e<x.length&&(n=x[e]):n=x,n},Q.getLineWidth=function(x,e){return 0<e.mlw?e.mlw:m(x.marker.line.width)?0:x.marker.line.width}},{"../../lib":515,"fast-isnumeric":190,tinycolor2:313}],664:[function(y,ee,Q){"use strict";var g=y("../../components/fx"),v=y("../../registry"),m=y("../../components/color"),x=y("../../lib").fillText,e=y("./helpers").getLineWidth,n=y("../../plots/cartesian/axes").hoverLabelText,t=y("../../constants/numerical").BADNUM;function a(d,s,i,u,f){var c,h,p,o,b,l,T,_=d.cd,w=_[0].trace,k=_[0].t,L="closest"===u,M="waterfall"===w.type,I=d.maxHoverDistance,P=d.maxSpikeDistance;"h"===w.orientation?(c=i,h=s,p="y",o="x",b=B,l=Y):(c=s,h=i,p="x",o="y",l=B,b=Y);var S=w[p+"period"],E=L||S;function z(ne){return q(ne,-1)}function R(ne){return q(ne,1)}function q(ne,le){return ne[p]+le*ne.w/2}function V(ne){return ne[p+"End"]-ne[p+"Start"]}var W=L?z:S?function(ne){return ne.p-V(ne)/2}:function(ne){return Math.min(z(ne),ne.p-k.bardelta/2)},K=L?R:S?function(ne){return ne.p+V(ne)/2}:function(ne){return Math.max(R(ne),ne.p+k.bardelta/2)};function G(ne,le,oe){return f.finiteRange&&(oe=0),g.inbox(ne-c,le-c,oe+Math.min(1,Math.abs(le-ne)/T)-1)}function Y(ne){return G(W(ne),K(ne),I)}function $(ne){var le=ne[o];if(M){var oe=Math.abs(ne.rawS)||0;h>0?le+=oe:h<0&&(le-=oe)}return le}function B(ne){var le=h,oe=ne.b,de=$(ne);return g.inbox(oe-le,de-le,I+(de-le)/(de-oe)-1)}var N=d[p+"a"],U=d[o+"a"];T=Math.abs(N.r2c(N.range[1])-N.r2c(N.range[0]));var ne,le,oe,de,te=g.getDistanceFunction(u,b,l,function(ne){return(b(ne)+l(ne))/2});if(g.getClosest(_,te,d),!1!==d.index&&_[d.index].p!==t){E||(W=function(ne){return Math.min(z(ne),ne.p-k.bargroupwidth/2)},K=function(ne){return Math.max(R(ne),ne.p+k.bargroupwidth/2)});var j=_[d.index],J=w.base?j.b+j.s:j.s;d[o+"0"]=d[o+"1"]=U.c2p(j[o],!0),d[o+"LabelVal"]=J;var X=k.extents[k.extents.round(j.p)];return d[p+"0"]=N.c2p(L?W(j):X[0],!0),d[p+"1"]=N.c2p(L?K(j):X[1],!0),d[p+"LabelVal"]=void 0!==j.orig_p?j.orig_p:j.p,d.labelLabel=n(N,d[p+"LabelVal"],w[p+"hoverformat"]),d.valueLabel=n(U,d[o+"LabelVal"],w[o+"hoverformat"]),d.baseLabel=n(U,j.b,w[o+"hoverformat"]),d.spikeDistance=(le=h,oe=(ne=j).b,de=$(ne),(g.inbox(oe-le,de-le,P+(de-le)/(de-oe)-1)+function(ne){return G(z(ne),R(ne),P)}(j))/2),d[p+"Spike"]=N.c2p(j.p,!0),x(j,w,d),d.hovertemplate=w.hovertemplate,d}}function r(d,s){var i=s.mcc||d.marker.color,u=s.mlcc||d.marker.line.color,f=e(d,s);return m.opacity(i)?i:m.opacity(u)&&f?u:void 0}ee.exports={hoverPoints:function(d,s,i,u,f){var c=a(d,s,i,u,f);if(c){var h=c.cd,p=h[0].trace,o=h[c.index];return c.color=r(p,o),v.getComponentMethod("errorbars","hoverInfo")(o,p,c),[c]}},hoverOnBars:a,getTraceColor:r}},{"../../components/color":367,"../../components/fx":407,"../../constants/numerical":491,"../../lib":515,"../../plots/cartesian/axes":566,"../../registry":647,"./helpers":663}],665:[function(y,ee,Q){"use strict";ee.exports={attributes:y("./attributes"),layoutAttributes:y("./layout_attributes"),supplyDefaults:y("./defaults").supplyDefaults,crossTraceDefaults:y("./defaults").crossTraceDefaults,supplyLayoutDefaults:y("./layout_defaults"),calc:y("./calc"),crossTraceCalc:y("./cross_trace_calc").crossTraceCalc,colorbar:y("../scatter/marker_colorbar"),arraysToCalcdata:y("./arrays_to_calcdata"),plot:y("./plot").plot,style:y("./style").style,styleOnSelect:y("./style").styleOnSelect,hoverPoints:y("./hover").hoverPoints,eventData:y("./event_data"),selectPoints:y("./select"),moduleType:"trace",name:"bar",basePlotModule:y("../../plots/cartesian"),categories:["bar-like","cartesian","svg","bar","oriented","errorBarsOK","showLegend","zoomScale"],animatable:!0,meta:{}}},{"../../plots/cartesian":578,"../scatter/marker_colorbar":954,"./arrays_to_calcdata":656,"./attributes":657,"./calc":658,"./cross_trace_calc":660,"./defaults":661,"./event_data":662,"./hover":664,"./layout_attributes":666,"./layout_defaults":667,"./plot":668,"./select":669,"./style":671}],666:[function(y,ee,Q){"use strict";ee.exports={barmode:{valType:"enumerated",values:["stack","group","overlay","relative"],dflt:"group",editType:"calc"},barnorm:{valType:"enumerated",values:["","fraction","percent"],dflt:"",editType:"calc"},bargap:{valType:"number",min:0,max:1,editType:"calc"},bargroupgap:{valType:"number",min:0,max:1,dflt:0,editType:"calc"}}},{}],667:[function(y,ee,Q){"use strict";var g=y("../../registry"),v=y("../../plots/cartesian/axes"),m=y("../../lib"),x=y("./layout_attributes");ee.exports=function(e,n,t){function a(p,o){return m.coerce(e,n,x,p,o)}for(var r=!1,d=!1,s=!1,i={},u=a("barmode"),f=0;f<t.length;f++){var c=t[f];if(g.traceIs(c,"bar")&&c.visible){if(r=!0,"group"===u){var h=c.xaxis+c.yaxis;i[h]&&(s=!0),i[h]=!0}c.visible&&"histogram"===c.type&&"category"!==v.getFromId({_fullLayout:n},c["v"===c.orientation?"xaxis":"yaxis"]).type&&(d=!0)}}r?("overlay"!==u&&a("barnorm"),a("bargap",d&&!s?0:.2),a("bargroupgap")):delete n.barmode}},{"../../lib":515,"../../plots/cartesian/axes":566,"../../registry":647,"./layout_attributes":666}],668:[function(y,ee,Q){"use strict";var g=y("@plotly/d3"),v=y("fast-isnumeric"),m=y("../../lib"),x=y("../../lib/svg_text_utils"),e=y("../../components/color"),n=y("../../components/drawing"),t=y("../../registry"),a=y("../../plots/cartesian/axes").tickText,r=y("./uniform_text"),d=r.recordMinTextSize,s=r.clearMinTextSize,i=y("./style"),u=y("./helpers"),f=y("./constants"),c=y("./attributes"),h=c.text,p=c.textposition,o=y("../../components/fx/helpers").appendArrayPointValue,b=f.TEXTPAD;function l(P){return P.id}function _(P,S){return P<S?1:-1}function w(P,S,E,z){var R;return!S.uniformtext.mode&&k(E)?(z&&(R=z()),P.transition().duration(E.duration).ease(E.easing).each("end",function(){R&&R()}).each("interrupt",function(){R&&R()})):P}function k(P){return P&&P.duration>0}function L(P){return"auto"===P?0:P}function M(P,S){var E=Math.PI/180*S,z=Math.abs(Math.sin(E)),R=Math.abs(Math.cos(E));return{x:P.width*R+P.height*z,y:P.width*z+P.height*R}}function I(P,S,E,z,R,q){var V=!!q.isHorizontal,W=!!q.constrained,K=q.angle||0,G=q.anchor||"end",Y="end"===G,$="start"===G,B=((q.leftToRight||0)+1)/2,N=1-B,U=R.width,te=R.height,j=Math.abs(S-P),J=Math.abs(z-E),X=j>2*b&&J>2*b?b:0;j-=2*X,J-=2*X;var re=L(K);"auto"!==K||U<=j&&te<=J||!(U>j||te>J)||(U>J||te>j)&&U<te==j<J||(re+=90);var ne=M(R,re),le=1;W&&(le=Math.min(1,j/ne.x,J/ne.y));var oe=R.left*N+R.right*B,de=(R.top+R.bottom)/2,se=(P+b)*N+(S-b)*B,ge=(E+z)/2,_e=0,Te=0;if($||Y){var we=(V?ne.x:ne.y)/2,Oe=V?_(P,S):_(E,z);V?$?(se=P+Oe*X,_e=-Oe*we):(se=S-Oe*X,_e=Oe*we):$?(ge=E+Oe*X,Te=-Oe*we):(ge=z-Oe*X,Te=Oe*we)}return{textX:oe,textY:de,targetX:se,targetY:ge,anchorX:_e,anchorY:Te,scale:le,rotate:re}}ee.exports={plot:function(P,S,E,z,R,q){var V=S.xaxis,W=S.yaxis,K=P._fullLayout;R||(R={mode:K.barmode,norm:K.barmode,gap:K.bargap,groupgap:K.bargroupgap},s("bar",K));var G=m.makeTraceGroups(z,E,"trace bars").each(function(Y){var $=g.select(this),B=Y[0].trace,te="bar"===B.type||"funnel"===B.type,j=0;"waterfall"===B.type&&B.connector.visible&&"between"===B.connector.mode&&(j=B.connector.line.width/2);var J="h"===B.orientation,X=k(R),re=m.ensureSingle($,"g","points"),ne=function T(P){if(P.ids)return l}(B),le=re.selectAll("g.point").data(m.identity,ne);le.enter().append("g").classed("point",!0),le.exit().remove(),le.each(function(de,se){var ge,_e,Se,Ie,Fe,Re,Xe,nt,ct,xt,Te=g.select(this),we=(Ie=V,Fe=W,nt=[],xt=(Re=J)?Fe:Ie,(Xe=[])[0]=(ct=Re?Ie:Fe).c2p((Se=de).s0,!0),nt[0]=xt.c2p(Se.p0,!0),Xe[1]=ct.c2p(Se.s1,!0),nt[1]=xt.c2p(Se.p1,!0),Re?[Xe,nt]:[nt,Xe]),Oe=we[0][0],fe=we[0][1],ve=we[1][0],Ae=we[1][1],ke=0==(J?fe-Oe:Ae-ve);if(ke&&te&&u.getLineWidth(B,de)&&(ke=!1),ke||(ke=!(v(Oe)&&v(fe)&&v(ve)&&v(Ae))),de.isBlank=ke,ke&&(J?fe=Oe:Ae=ve),j&&!ke&&(J?(Oe-=_(Oe,fe)*j,fe+=_(Oe,fe)*j):(ve-=_(ve,Ae)*j,Ae+=_(ve,Ae)*j)),"waterfall"===B.type){if(!ke){var Pe=B[de.dir].marker;ge=Pe.line.width,_e=Pe.color}}else ge=u.getLineWidth(B,de),_e=de.mc||B.marker.color;function Ne(Se){var Ie=g.round(ge/2%1,2);return 0===R.gap&&0===R.groupgap?g.round(Math.round(Se)-Ie,2):Se}if(!P._context.staticPlot){var De=e.opacity(_e)<1||ge>.01?Ne:function(Se,Ie,Fe){return Fe&&Se===Ie?Se:Math.abs(Se-Ie)>=2?Ne(Se):Se>Ie?Math.ceil(Se):Math.floor(Se)};Oe=De(Oe,fe,J),fe=De(fe,Oe,J),ve=De(ve,Ae,!J),Ae=De(Ae,ve,!J)}var ze=w(m.ensureSingle(Te,"path"),K,R,q);if(ze.style("vector-effect","non-scaling-stroke").attr("d",isNaN((fe-Oe)*(Ae-ve))||ke&&P._context.staticPlot?"M0,0Z":"M"+Oe+","+ve+"V"+Ae+"H"+fe+"V"+ve+"Z").call(n.setClipUrl,S.layerClipId,P),!K.uniformtext.mode&&X){var Me=n.makePointStyleFns(B);n.singlePointStyle(de,ze,B,Me,P)}(function(Se,Ie,Fe,Re,Xe,nt,ct,xt,dt,tt,Ke){var mt,Bt=Ie.xaxis,Ut=Ie.yaxis,er=Se._fullLayout;function Wt(Gt,jt,fr){return m.ensureSingle(Gt,"text").text(jt).attr({class:"bartext bartext-"+mt,"text-anchor":"middle","data-notex":1}).call(n.font,fr).call(x.convertToTspans,Se)}var jt,fr,kr,ur,Jt,$t,rr=Re[0].trace,Ht="h"===rr.orientation,Ve=(fr=Xe,kr=Bt,ur=Ut,Jt=($t=(jt=Re)[0].trace).texttemplate?function(Qt,cr,gr,Tr,Fr){var Nr=cr[0].trace,Xr=m.castOption(Nr,gr,"texttemplate");if(!Xr)return"";var un,$r,Pn,gn,dn="histogram"===Nr.type,An="waterfall"===Nr.type,Zn="funnel"===Nr.type,Rr="h"===Nr.orientation;function hn(li){return a(gn,gn.c2l(li),!0).text}Rr?(un="y",$r=Fr,Pn="x",gn=Tr):(un="x",$r=Tr,Pn="y",gn=Fr);var nn=cr[gr],Hr={};Hr.label=nn.p,Hr.labelLabel=Hr[un+"Label"]=a($r,$r.c2l(nn.p),!0).text;var Un=m.castOption(Nr,nn.i,"text");(0===Un||Un)&&(Hr.text=Un),Hr.value=nn.s,Hr.valueLabel=Hr[Pn+"Label"]=hn(nn.s);var vn={};o(vn,Nr,nn.i),(dn||void 0===vn.x)&&(vn.x=Rr?Hr.value:Hr.label),(dn||void 0===vn.y)&&(vn.y=Rr?Hr.label:Hr.value),(dn||void 0===vn.xLabel)&&(vn.xLabel=Rr?Hr.valueLabel:Hr.labelLabel),(dn||void 0===vn.yLabel)&&(vn.yLabel=Rr?Hr.labelLabel:Hr.valueLabel),An&&(Hr.delta=+nn.rawS||nn.s,Hr.deltaLabel=hn(Hr.delta),Hr.final=nn.v,Hr.finalLabel=hn(Hr.final),Hr.initial=Hr.final-Hr.delta,Hr.initialLabel=hn(Hr.initial)),Zn&&(Hr.value=nn.s,Hr.valueLabel=hn(Hr.value),Hr.percentInitial=nn.begR,Hr.percentInitialLabel=m.formatPercent(nn.begR),Hr.percentPrevious=nn.difR,Hr.percentPreviousLabel=m.formatPercent(nn.difR),Hr.percentTotal=nn.sumR,Hr.percenTotalLabel=m.formatPercent(nn.sumR));var Cn=m.castOption(Nr,nn.i,"customdata");return Cn&&(Hr.customdata=Cn),m.texttemplateString(Xr,Hr,Qt._d3locale,vn,Hr,Nr._meta||{})}(er,jt,fr,kr,ur):$t.textinfo?function(Qt,cr,gr,Tr){var Fr=Qt[0].trace,Nr="h"===Fr.orientation,Xr="waterfall"===Fr.type,un="funnel"===Fr.type;function $r(Cn){return a(Nr?gr:Tr,+Cn,!0).text}var Pn,dn=Qt[cr],An=Fr.textinfo.split("+"),Zn=[],Rr=function(Cn){return-1!==An.indexOf(Cn)};if(Rr("label")&&Zn.push(a(Nr?Tr:gr,Qt[cr].p,!0).text),Rr("text")&&(0===(Pn=m.castOption(Fr,dn.i,"text"))||Pn)&&Zn.push(Pn),Xr){var nn=+dn.rawS||dn.s,Hr=dn.v,Fn=Hr-nn;Rr("initial")&&Zn.push($r(Fn)),Rr("delta")&&Zn.push($r(nn)),Rr("final")&&Zn.push($r(Hr))}if(un){Rr("value")&&Zn.push($r(dn.s));var Un=0;Rr("percent initial")&&Un++,Rr("percent previous")&&Un++,Rr("percent total")&&Un++;var vn=Un>1;Rr("percent initial")&&(Pn=m.formatPercent(dn.begR),vn&&(Pn+=" of initial"),Zn.push(Pn)),Rr("percent previous")&&(Pn=m.formatPercent(dn.difR),vn&&(Pn+=" of previous"),Zn.push(Pn)),Rr("percent total")&&(Pn=m.formatPercent(dn.sumR),vn&&(Pn+=" of total"),Zn.push(Pn))}return Zn.join("<br>")}(jt,fr,kr,ur):u.getValue($t.text,fr),u.coerceString(h,Jt));mt=function(Gt,jt){var fr=u.getValue(Gt.textposition,jt);return u.coerceEnumerated(p,fr)}(rr,Xe);var he=Re[Xe],ye=!("stack"===tt.mode||"relative"===tt.mode)||he._outmost;if(Ve&&"none"!==mt&&(!he.isBlank&&nt!==ct&&xt!==dt||"auto"!==mt&&"inside"!==mt)){var Be=er.font,Ge=i.getBarColor(Re[Xe],rr),Je=i.getInsideTextFont(rr,Xe,Be,Ge),He=i.getOutsideTextFont(rr,Xe,Be),st=Fe.datum();Ht?"log"===Bt.type&&st.s0<=0&&(nt=Bt.range[0]<Bt.range[1]?0:Bt._length):"log"===Ut.type&&st.s0<=0&&(xt=Ut.range[0]<Ut.range[1]?Ut._length:0);var ot,wt,Ct,rt,ft,Rt=Math.abs(ct-nt)-2*b,kt=Math.abs(dt-xt)-2*b;if("outside"===mt&&(ye||he.hasB||(mt="inside")),"auto"===mt&&(ye?(mt="inside",ot=Wt(Fe,Ve,ft=m.ensureUniformFontSize(Se,Je)),rt=(wt=n.bBox(ot.node())).height,(Ct=wt.width)>0&&rt>0&&(Ct<=Rt&&rt<=kt||Ct<=kt&&rt<=Rt||(Ht?Rt>=Ct*(kt/rt):kt>=rt*(Rt/Ct)))?mt="inside":(mt="outside",ot.remove(),ot=null)):mt="inside"),!ot){var it=(ot=Wt(Fe,Ve,ft=m.ensureUniformFontSize(Se,"outside"===mt?He:Je))).attr("transform");if(ot.attr("transform",""),Ct=(wt=n.bBox(ot.node())).width,rt=wt.height,ot.attr("transform",it),Ct<=0||rt<=0)return void ot.remove()}var ht,Ft=rr.textangle;ht="outside"===mt?function(Gt,jt,fr,kr,ur,Jt){var $t,Qt=!!Jt.isHorizontal,cr=!!Jt.constrained,gr=Jt.angle||0,Tr=ur.width,Fr=ur.height,Nr=Math.abs(jt-Gt),Xr=Math.abs(kr-fr);$t=Qt?Xr>2*b?b:0:Nr>2*b?b:0;var un=1;cr&&(un=Qt?Math.min(1,Xr/Fr):Math.min(1,Nr/Tr));var $r=L(gr),Pn=M(ur,$r),gn=(Qt?Pn.x:Pn.y)/2,dn=(ur.left+ur.right)/2,An=(ur.top+ur.bottom)/2,Zn=(Gt+jt)/2,Rr=(fr+kr)/2,hn=0,nn=0,Hr=Qt?_(jt,Gt):_(fr,kr);return Qt?(Zn=jt-Hr*$t,hn=Hr*gn):(Rr=kr+Hr*$t,nn=-Hr*gn),{textX:dn,textY:An,targetX:Zn,targetY:Rr,anchorX:hn,anchorY:nn,scale:un,rotate:$r}}(nt,ct,xt,dt,wt,{isHorizontal:Ht,constrained:"both"===rr.constraintext||"outside"===rr.constraintext,angle:Ft}):I(nt,ct,xt,dt,wt,{isHorizontal:Ht,constrained:"both"===rr.constraintext||"inside"===rr.constraintext,angle:Ft,anchor:rr.insidetextanchor}),ht.fontSize=ft.size,d("histogram"===rr.type?"bar":rr.type,ht,er),he.transform=ht,w(ot,er,tt,Ke).attr("transform",m.getTextTransform(ht))}else Fe.select("text").remove()})(P,S,Te,Y,se,Oe,fe,ve,Ae,R,q),S.layerClipId&&n.hideOutsideRangePoint(de,Te.select("text"),V,W,B.xcalendar,B.ycalendar)}),n.setClipUrl($,!1===B.cliponaxis?null:S.layerClipId,P)});t.getComponentMethod("errorbars","plot")(P,G,S,R)},toMoveInsideBar:I}},{"../../components/color":367,"../../components/drawing":389,"../../components/fx/helpers":403,"../../lib":515,"../../lib/svg_text_utils":541,"../../plots/cartesian/axes":566,"../../registry":647,"./attributes":657,"./constants":659,"./helpers":663,"./style":671,"./uniform_text":673,"@plotly/d3":58,"fast-isnumeric":190}],669:[function(y,ee,Q){"use strict";function g(v,m,x,e,n){var t=m.c2p(e?v.s0:v.p0,!0),a=m.c2p(e?v.s1:v.p1,!0),r=x.c2p(e?v.p0:v.s0,!0),d=x.c2p(e?v.p1:v.s1,!0);return n?[(t+a)/2,(r+d)/2]:e?[a,(r+d)/2]:[(t+a)/2,d]}ee.exports=function(v,m){var x,e=v.cd,n=v.xaxis,t=v.yaxis,a=e[0].trace,r="funnel"===a.type,d="h"===a.orientation,s=[];if(!1===m)for(x=0;x<e.length;x++)e[x].selected=0;else for(x=0;x<e.length;x++){var i=e[x],u="ct"in i?i.ct:g(i,n,t,d,r);m.contains(u,!1,x,v)?(s.push({pointNumber:x,x:n.c2d(i.x),y:t.c2d(i.y)}),i.selected=1):i.selected=0}return s}},{}],670:[function(y,ee,Q){"use strict";ee.exports=m;var g=y("../../lib").distinctVals,v=y("../../constants/numerical").BADNUM;function m(x,e){this.traces=x,this.sepNegVal=e.sepNegVal,this.overlapNoMerge=e.overlapNoMerge;for(var n=1/0,t=[],a=0;a<x.length;a++){for(var r=x[a],d=0;d<r.length;d++){var s=r[d];s.p!==v&&t.push(s.p)}r[0]&&r[0].width1&&(n=Math.min(r[0].width1,n))}this.positions=t;var i=g(t);this.distinctPositions=i.vals,this.minDiff=1===i.vals.length&&n!==1/0?n:Math.min(i.minDiff,n);var u=(e.posAxis||{}).type;"category"!==u&&"multicategory"!==u||(this.minDiff=1),this.binWidth=this.minDiff,this.bins={}}m.prototype.put=function(x,e){var n=this.getLabel(x,e),t=this.bins[n]||0;return this.bins[n]=t+e,t},m.prototype.get=function(x,e){var n=this.getLabel(x,e);return this.bins[n]||0},m.prototype.getLabel=function(x,e){return(e<0&&this.sepNegVal?"v":"^")+(this.overlapNoMerge?x:Math.round(x/this.binWidth))}},{"../../constants/numerical":491,"../../lib":515}],671:[function(y,ee,Q){"use strict";var g=y("@plotly/d3"),v=y("../../components/color"),m=y("../../components/drawing"),x=y("../../lib"),e=y("../../registry"),n=y("./uniform_text").resizeText,t=y("./attributes"),a=t.textfont,r=t.insidetextfont,d=t.outsidetextfont,s=y("./helpers");function i(l,T,_){m.pointStyle(l.selectAll("path"),T,_),u(l,T,_)}function u(l,T,_){l.selectAll("text").each(function(w){var k=g.select(this),L=x.ensureUniformFontSize(_,f(k,w,T,_));m.font(k,L)})}function f(l,T,_,w){var k=w._fullLayout.font,L=_.textfont;if(l.classed("bartext-inside")){var M=b(T,_);L=h(_,T.i,k,M)}else l.classed("bartext-outside")&&(L=p(_,T.i,k));return L}function c(l,T,_){return o(a,l.textfont,T,_)}function h(l,T,_,w){var k=c(l,T,_);return(void 0===l._input.textfont||void 0===l._input.textfont.color||Array.isArray(l.textfont.color)&&void 0===l.textfont.color[T])&&(k={color:v.contrast(w),family:k.family,size:k.size}),o(r,l.insidetextfont,T,k)}function p(l,T,_){var w=c(l,T,_);return o(d,l.outsidetextfont,T,w)}function o(l,T,_,w){var k=s.getValue((T=T||{}).family,_),L=s.getValue(T.size,_),M=s.getValue(T.color,_);return{family:s.coerceString(l.family,k,w.family),size:s.coerceNumber(l.size,L,w.size),color:s.coerceColor(l.color,M,w.color)}}function b(l,T){return"waterfall"===T.type?T[l.dir].marker.color:l.mcc||l.mc||T.marker.color}ee.exports={style:function(l){var T=g.select(l).selectAll("g.barlayer").selectAll("g.trace");n(l,T,"bar");var _=T.size(),w=l._fullLayout;T.style("opacity",function(k){return k[0].trace.opacity}).each(function(k){("stack"===w.barmode&&_>1||0===w.bargap&&0===w.bargroupgap&&!k[0].trace.marker.line.width)&&g.select(this).attr("shape-rendering","crispEdges")}),T.selectAll("g.points").each(function(k){i(g.select(this),k[0].trace,l)}),e.getComponentMethod("errorbars","style")(T)},styleTextPoints:u,styleOnSelect:function(l,T,_){var k,L,M,I,P,S,w=T[0].trace;w.selectedpoints?(L=w,M=l,m.selectedPointStyle((k=_).selectAll("path"),L),I=k.selectAll("text"),P=L,S=M,I.each(function(E){var z,R=g.select(this);if(E.selected){z=x.ensureUniformFontSize(S,f(R,E,P,S));var q=P.selected.textfont&&P.selected.textfont.color;q&&(z.color=q),m.font(R,z)}else m.selectedTextStyle(R,P)})):(i(_,w,l),e.getComponentMethod("errorbars","style")(_))},getInsideTextFont:h,getOutsideTextFont:p,getBarColor:b,resizeText:n}},{"../../components/color":367,"../../components/drawing":389,"../../lib":515,"../../registry":647,"./attributes":657,"./helpers":663,"./uniform_text":673,"@plotly/d3":58}],672:[function(y,ee,Q){"use strict";var g=y("../../components/color"),v=y("../../components/colorscale/helpers").hasColorscale,m=y("../../components/colorscale/defaults"),x=y("../../lib").coercePattern;ee.exports=function(e,n,t,a,r){var d=t("marker.color",a),s=v(e,"marker");s&&m(e,n,r,t,{prefix:"marker.",cLetter:"c"}),t("marker.line.color",g.defaultLine),v(e,"marker.line")&&m(e,n,r,t,{prefix:"marker.line.",cLetter:"c"}),t("marker.line.width"),t("marker.opacity"),x(t,"marker.pattern",d,s),t("selected.marker.color"),t("unselected.marker.color")}},{"../../components/color":367,"../../components/colorscale/defaults":377,"../../components/colorscale/helpers":378,"../../lib":515}],673:[function(y,ee,Q){"use strict";var g=y("@plotly/d3"),v=y("../../lib");function m(x){return"_"+x+"Text_minsize"}ee.exports={recordMinTextSize:function(x,e,n){if(n.uniformtext.mode){var t=m(x),a=n.uniformtext.minsize,r=e.scale*e.fontSize;e.hide=r<a,n[t]=n[t]||1/0,e.hide||(n[t]=Math.min(n[t],Math.max(r,a)))}},clearMinTextSize:function(x,e){e[m(x)]=void 0},resizeText:function(x,e,n){var t=x._fullLayout,a=t["_"+n+"Text_minsize"];if(a){var r,d="hide"===t.uniformtext.mode;switch(n){case"funnelarea":case"pie":case"sunburst":r="g.slice";break;case"treemap":case"icicle":r="g.slice, g.pathbar";break;default:r="g.points > g.point"}e.selectAll(r).each(function(s){var i=s.transform;i&&(i.scale=d&&i.hide?0:a/i.fontSize,g.select(this).select("text").attr("transform",v.getTextTransform(i)))})}}}},{"../../lib":515,"@plotly/d3":58}],674:[function(y,ee,Q){"use strict";var g=y("../../plots/template_attributes").hovertemplateAttrs,v=y("../../lib/extend").extendFlat,m=y("../scatterpolar/attributes"),x=y("../bar/attributes");ee.exports={r:m.r,theta:m.theta,r0:m.r0,dr:m.dr,theta0:m.theta0,dtheta:m.dtheta,thetaunit:m.thetaunit,base:v({},x.base,{}),offset:v({},x.offset,{}),width:v({},x.width,{}),text:v({},x.text,{}),hovertext:v({},x.hovertext,{}),marker:x.marker,hoverinfo:m.hoverinfo,hovertemplate:g(),selected:x.selected,unselected:x.unselected}},{"../../lib/extend":505,"../../plots/template_attributes":642,"../bar/attributes":657,"../scatterpolar/attributes":1011}],675:[function(y,ee,Q){"use strict";var g=y("../../components/colorscale/helpers").hasColorscale,v=y("../../components/colorscale/calc"),m=y("../bar/arrays_to_calcdata"),x=y("../bar/cross_trace_calc").setGroupPositions,e=y("../scatter/calc_selection"),n=y("../../registry").traceIs,t=y("../../lib").extendFlat;ee.exports={calc:function(a,r){for(var d=a._fullLayout,s=r.subplot,u=d[s].angularaxis,f=d[s].radialaxis.makeCalcdata(r,"r"),c=u.makeCalcdata(r,"theta"),h=r._length,p=new Array(h),o=f,b=c,l=0;l<h;l++)p[l]={p:b[l],s:o[l]};function T(_){var w=r[_];void 0!==w&&(r["_"+_]=Array.isArray(w)?u.makeCalcdata(r,_):u.d2c(w,r.thetaunit))}return"linear"===u.type&&(T("width"),T("offset")),g(r,"marker")&&v(a,r,{vals:r.marker.color,containerStr:"marker",cLetter:"c"}),g(r,"marker.line")&&v(a,r,{vals:r.marker.line.color,containerStr:"marker.line",cLetter:"c"}),m(p,r),e(p,r),p},crossTraceCalc:function(a,r,d){for(var s=a.calcdata,i=[],u=0;u<s.length;u++){var f=s[u],c=f[0].trace;!0===c.visible&&n(c,"bar")&&c.subplot===d&&i.push(f)}var h=t({},r.radialaxis,{_id:"x"});x(a,r.angularaxis,h,i,{mode:r.barmode,norm:r.barnorm,gap:r.bargap,groupgap:r.bargroupgap})}}},{"../../components/colorscale/calc":375,"../../components/colorscale/helpers":378,"../../lib":515,"../../registry":647,"../bar/arrays_to_calcdata":656,"../bar/cross_trace_calc":660,"../scatter/calc_selection":938}],676:[function(y,ee,Q){"use strict";var g=y("../../lib"),v=y("../scatterpolar/defaults").handleRThetaDefaults,m=y("../bar/style_defaults"),x=y("./attributes");ee.exports=function(e,n,t,a){function r(d,s){return g.coerce(e,n,x,d,s)}v(e,n,a,r)?(r("thetaunit"),r("base"),r("offset"),r("width"),r("text"),r("hovertext"),r("hovertemplate"),m(e,n,r,t,a),g.coerceSelectionMarkerOpacity(n,r)):n.visible=!1}},{"../../lib":515,"../bar/style_defaults":672,"../scatterpolar/defaults":1013,"./attributes":674}],677:[function(y,ee,Q){"use strict";var g=y("../../components/fx"),v=y("../../lib"),m=y("../bar/hover").getTraceColor,x=v.fillText,e=y("../scatterpolar/hover").makeHoverPointText,n=y("../../plots/polar/helpers").isPtInsidePolygon;ee.exports=function(t,a,r){var d=t.cd,s=d[0].trace,i=t.subplot,u=i.radialAxis,c=i.vangles,h=c?n:v.isPtInsideSector,p=t.maxHoverDistance,o=i.angularAxis._period||2*Math.PI,b=Math.abs(u.g2p(Math.sqrt(a*a+r*r))),l=Math.atan2(r,a);if(u.range[0]>u.range[1]&&(l+=Math.PI),g.getClosest(d,function(w){return h(b,l,[w.rp0,w.rp1],[w.thetag0,w.thetag1],c)?p+Math.min(1,Math.abs(w.thetag1-w.thetag0)/o)-1+(w.rp1-b)/(w.rp1-w.rp0)-1:1/0},t),!1!==t.index){var T=d[t.index];t.x0=t.x1=T.ct[0],t.y0=t.y1=T.ct[1];var _=v.extendFlat({},T,{r:T.s,theta:T.p});return x(T,s,t),e(_,s,i,t),t.hovertemplate=s.hovertemplate,t.color=m(s,T),t.xLabelVal=t.yLabelVal=void 0,T.s<0&&(t.idealAlign="left"),[t]}}},{"../../components/fx":407,"../../lib":515,"../../plots/polar/helpers":630,"../bar/hover":664,"../scatterpolar/hover":1015}],678:[function(y,ee,Q){"use strict";ee.exports={moduleType:"trace",name:"barpolar",basePlotModule:y("../../plots/polar"),categories:["polar","bar","showLegend"],attributes:y("./attributes"),layoutAttributes:y("./layout_attributes"),supplyDefaults:y("./defaults"),supplyLayoutDefaults:y("./layout_defaults"),calc:y("./calc").calc,crossTraceCalc:y("./calc").crossTraceCalc,plot:y("./plot"),colorbar:y("../scatter/marker_colorbar"),formatLabels:y("../scatterpolar/format_labels"),style:y("../bar/style").style,styleOnSelect:y("../bar/style").styleOnSelect,hoverPoints:y("./hover"),selectPoints:y("../bar/select"),meta:{}}},{"../../plots/polar":631,"../bar/select":669,"../bar/style":671,"../scatter/marker_colorbar":954,"../scatterpolar/format_labels":1014,"./attributes":674,"./calc":675,"./defaults":676,"./hover":677,"./layout_attributes":679,"./layout_defaults":680,"./plot":681}],679:[function(y,ee,Q){"use strict";ee.exports={barmode:{valType:"enumerated",values:["stack","overlay"],dflt:"stack",editType:"calc"},bargap:{valType:"number",dflt:.1,min:0,max:1,editType:"calc"}}},{}],680:[function(y,ee,Q){"use strict";var g=y("../../lib"),v=y("./layout_attributes");ee.exports=function(m,x,e){var n,t={};function a(s,i){return g.coerce(m[n]||{},x[n],v,s,i)}for(var r=0;r<e.length;r++){var d=e[r];"barpolar"===d.type&&!0===d.visible&&(t[n=d.subplot]||(a("barmode"),a("bargap"),t[n]=1))}}},{"../../lib":515,"./layout_attributes":679}],681:[function(y,ee,Q){"use strict";var g=y("@plotly/d3"),v=y("fast-isnumeric"),m=y("../../lib"),x=y("../../components/drawing"),e=y("../../plots/polar/helpers");ee.exports=function(n,t,a){var c,h,p,r=t.xaxis,d=t.yaxis,s=t.radialAxis,i=t.angularAxis,u=(h=(c=t).cxx,p=c.cyy,c.vangles?function(o,b,l,T){var _,w;m.angleDelta(l,T)>0?(_=l,w=T):(_=T,w=l);var k=[e.findEnclosingVertexAngles(_,c.vangles)[0],(_+w)/2,e.findEnclosingVertexAngles(w,c.vangles)[1]];return e.pathPolygonAnnulus(o,b,_,w,k,h,p)}:function(o,b,l,T){return m.pathAnnulus(o,b,l,T,h,p)}),f=t.layers.frontplot.select("g.barlayer");m.makeTraceGroups(f,a,"trace bars").each(function(){var c=g.select(this),h=m.ensureSingle(c,"g","points").selectAll("g.point").data(m.identity);h.enter().append("g").style("vector-effect","non-scaling-stroke").style("stroke-miterlimit",2).classed("point",!0),h.exit().remove(),h.each(function(p){var o,b=g.select(this),l=p.rp0=s.c2p(p.s0),T=p.rp1=s.c2p(p.s1),_=p.thetag0=i.c2g(p.p0),w=p.thetag1=i.c2g(p.p1);if(v(l)&&v(T)&&v(_)&&v(w)&&l!==T&&_!==w){var k=s.c2g(p.s1),L=(_+w)/2;p.ct=[r.c2p(k*Math.cos(L)),d.c2p(k*Math.sin(L))],o=u(l,T,_,w)}else o="M0,0Z";m.ensureSingle(b,"path").attr("d",o)}),x.setClipUrl(c,t._hasClipOnAxisFalse?t.clipIds.forTraces:null,n)})}},{"../../components/drawing":389,"../../lib":515,"../../plots/polar/helpers":630,"@plotly/d3":58,"fast-isnumeric":190}],682:[function(y,ee,Q){"use strict";var g=y("../scatter/attributes"),v=y("../bar/attributes"),m=y("../../components/color/attributes"),x=y("../../plots/cartesian/axis_format_attributes").axisHoverFormat,e=y("../../plots/template_attributes").hovertemplateAttrs,n=y("../../lib/extend").extendFlat,t=g.marker,a=t.line;ee.exports={y:{valType:"data_array",editType:"calc+clearAxisTypes"},x:{valType:"data_array",editType:"calc+clearAxisTypes"},x0:{valType:"any",editType:"calc+clearAxisTypes"},y0:{valType:"any",editType:"calc+clearAxisTypes"},dx:{valType:"number",editType:"calc"},dy:{valType:"number",editType:"calc"},xperiod:g.xperiod,yperiod:g.yperiod,xperiod0:g.xperiod0,yperiod0:g.yperiod0,xperiodalignment:g.xperiodalignment,yperiodalignment:g.yperiodalignment,xhoverformat:x("x"),yhoverformat:x("y"),name:{valType:"string",editType:"calc+clearAxisTypes"},q1:{valType:"data_array",editType:"calc+clearAxisTypes"},median:{valType:"data_array",editType:"calc+clearAxisTypes"},q3:{valType:"data_array",editType:"calc+clearAxisTypes"},lowerfence:{valType:"data_array",editType:"calc"},upperfence:{valType:"data_array",editType:"calc"},notched:{valType:"boolean",editType:"calc"},notchwidth:{valType:"number",min:0,max:.5,dflt:.25,editType:"calc"},notchspan:{valType:"data_array",editType:"calc"},boxpoints:{valType:"enumerated",values:["all","outliers","suspectedoutliers",!1],editType:"calc"},jitter:{valType:"number",min:0,max:1,editType:"calc"},pointpos:{valType:"number",min:-2,max:2,editType:"calc"},boxmean:{valType:"enumerated",values:[!0,"sd",!1],editType:"calc"},mean:{valType:"data_array",editType:"calc"},sd:{valType:"data_array",editType:"calc"},orientation:{valType:"enumerated",values:["v","h"],editType:"calc+clearAxisTypes"},quartilemethod:{valType:"enumerated",values:["linear","exclusive","inclusive"],dflt:"linear",editType:"calc"},width:{valType:"number",min:0,dflt:0,editType:"calc"},marker:{outliercolor:{valType:"color",dflt:"rgba(0, 0, 0, 0)",editType:"style"},symbol:n({},t.symbol,{arrayOk:!1,editType:"plot"}),opacity:n({},t.opacity,{arrayOk:!1,dflt:1,editType:"style"}),size:n({},t.size,{arrayOk:!1,editType:"calc"}),color:n({},t.color,{arrayOk:!1,editType:"style"}),line:{color:n({},a.color,{arrayOk:!1,dflt:m.defaultLine,editType:"style"}),width:n({},a.width,{arrayOk:!1,dflt:0,editType:"style"}),outliercolor:{valType:"color",editType:"style"},outlierwidth:{valType:"number",min:0,dflt:1,editType:"style"},editType:"style"},editType:"plot"},line:{color:{valType:"color",editType:"style"},width:{valType:"number",min:0,dflt:2,editType:"style"},editType:"plot"},fillcolor:g.fillcolor,whiskerwidth:{valType:"number",min:0,max:1,dflt:.5,editType:"calc"},offsetgroup:v.offsetgroup,alignmentgroup:v.alignmentgroup,selected:{marker:g.selected.marker,editType:"style"},unselected:{marker:g.unselected.marker,editType:"style"},text:n({},g.text,{}),hovertext:n({},g.hovertext,{}),hovertemplate:e({}),hoveron:{valType:"flaglist",flags:["boxes","points"],dflt:"boxes+points",editType:"style"}}},{"../../components/color/attributes":366,"../../lib/extend":505,"../../plots/cartesian/axis_format_attributes":569,"../../plots/template_attributes":642,"../bar/attributes":657,"../scatter/attributes":936}],683:[function(y,ee,Q){"use strict";var g=y("fast-isnumeric"),v=y("../../plots/cartesian/axes"),m=y("../../plots/cartesian/align_period"),x=y("../../lib"),e=y("../../constants/numerical").BADNUM,n=x._;ee.exports=function(h,p){var o,b,l,T,_,w,k,L=h._fullLayout,M=v.getFromId(h,p.xaxis||"x"),I=v.getFromId(h,p.yaxis||"y"),P=[],S="violin"===p.type?"_numViolins":"_numBoxes";"h"===p.orientation?(l=M,T="x",_=I,w="y",k=!!p.yperiodalignment):(l=I,T="y",_=M,w="x",k=!!p.xperiodalignment);var E,z,R,q,V,W,K=function(Fe,Re,Xe,nt){var ct,xt=Re+"0"in Fe;if(Re in Fe||xt&&"d"+Re in Fe){var tt=Xe.makeCalcdata(Fe,Re);return[m(Fe,Xe,Re,tt).vals,tt]}ct=xt?Fe[Re+"0"]:"name"in Fe&&("category"===Xe.type||g(Fe.name)&&-1!==["linear","log"].indexOf(Xe.type)||x.isDateTime(Fe.name)&&"date"===Xe.type)?Fe.name:nt;for(var Ke="multicategory"===Xe.type?Xe.r2c_just_indices(ct):Xe.d2c(ct,0,Fe[Re+"calendar"]),mt=Fe._length,Bt=new Array(mt),Ut=0;Ut<mt;Ut++)Bt[Ut]=Ke;return[Bt]}(p,w,_,L[S]),G=K[0],Y=K[1],$=x.distinctVals(G,_),B=$.vals,N=$.minDiff/2,U="all"===(p.boxpoints||p.points)?x.identity:function(Fe){return Fe.v<E.lf||Fe.v>E.uf};if(p._hasPreCompStats){var te=p[T],j=function(Fe){return l.d2c((p[Fe]||[])[o])},J=1/0,X=-1/0;for(o=0;o<p._length;o++){var re=G[o];if(g(re)){if((E={}).pos=E[w]=re,k&&Y&&(E.orig_p=Y[o]),E.q1=j("q1"),E.med=j("median"),E.q3=j("q3"),z=[],te&&x.isArrayOrTypedArray(te[o]))for(b=0;b<te[o].length;b++)(W=l.d2c(te[o][b]))!==e&&(a(V={v:W,i:[o,b]},p,[o,b]),z.push(V));if(E.pts=z.sort(r),q=(R=E[T]=z.map(d)).length,E.med!==e&&E.q1!==e&&E.q3!==e&&E.med>=E.q1&&E.q3>=E.med){var ne=j("lowerfence");E.lf=ne!==e&&ne<=E.q1?ne:s(E,R,q);var le=j("upperfence");E.uf=le!==e&&le>=E.q3?le:i(E,R,q);var oe=j("mean");E.mean=oe!==e?oe:q?x.mean(R,q):(E.q1+E.q3)/2;var de=j("sd");E.sd=oe!==e&&de>=0?de:q?x.stdev(R,q,E.mean):E.q3-E.q1,E.lo=u(E),E.uo=f(E);var se=j("notchspan");se=se!==e&&se>0?se:c(E,q),E.ln=E.med-se,E.un=E.med+se;var ge=E.lf,_e=E.uf;p.boxpoints&&R.length&&(ge=Math.min(ge,R[0]),_e=Math.max(_e,R[q-1])),p.notched&&(ge=Math.min(ge,E.ln),_e=Math.max(_e,E.un)),E.min=ge,E.max=_e}else{var Te;x.warn(["Invalid input - make sure that q1 <= median <= q3","q1 = "+E.q1,"median = "+E.med,"q3 = "+E.q3].join("\n")),E.med=Te=E.med!==e?E.med:E.q1!==e?E.q3!==e?(E.q1+E.q3)/2:E.q1:E.q3!==e?E.q3:0,E.q1=E.q3=Te,E.lf=E.uf=Te,E.mean=E.sd=Te,E.ln=E.un=Te,E.min=E.max=Te}J=Math.min(J,E.min),X=Math.max(X,E.max),E.pts2=z.filter(U),P.push(E)}}p._extremes[l._id]=v.findExtremes(l,[J,X],{padded:!0})}else{var we=l.makeCalcdata(p,T),Oe=function(Fe,Re){for(var Xe=Fe.length,nt=new Array(Xe+1),ct=0;ct<Xe;ct++)nt[ct]=Fe[ct]-Re;return nt[Xe]=Fe[Xe-1]+Re,nt}(B,N),fe=B.length,ve=function(Fe){for(var Re=new Array(Fe),Xe=0;Xe<Fe;Xe++)Re[Xe]=[];return Re}(fe);for(o=0;o<p._length;o++)if(g(W=we[o])){var Ae=x.findBin(G[o],Oe);Ae>=0&&Ae<fe&&(a(V={v:W,i:o},p,o),ve[Ae].push(V))}var ke=1/0,Pe=-1/0,Ne=p.quartilemethod,De="exclusive"===Ne,ze="inclusive"===Ne;for(o=0;o<fe;o++)if(ve[o].length>0){var Me,Se;(E={}).pos=E[w]=B[o],z=E.pts=ve[o].sort(r),q=(R=E[T]=z.map(d)).length,E.min=R[0],E.max=R[q-1],E.mean=x.mean(R,q),E.sd=x.stdev(R,q,E.mean),E.med=x.interp(R,.5),q%2&&(De||ze)?(De?(Me=R.slice(0,q/2),Se=R.slice(q/2+1)):ze&&(Me=R.slice(0,q/2+1),Se=R.slice(q/2)),E.q1=x.interp(Me,.5),E.q3=x.interp(Se,.5)):(E.q1=x.interp(R,.25),E.q3=x.interp(R,.75)),E.lf=s(E,R,q),E.uf=i(E,R,q),E.lo=u(E),E.uo=f(E);var Ie=c(E,q);E.ln=E.med-Ie,E.un=E.med+Ie,ke=Math.min(ke,E.ln),Pe=Math.max(Pe,E.un),E.pts2=z.filter(U),P.push(E)}p._extremes[l._id]=v.findExtremes(l,p.notched?we.concat([ke,Pe]):we,{padded:!0})}return function(Fe,Re){if(x.isArrayOrTypedArray(Re.selectedpoints))for(var Xe=0;Xe<Fe.length;Xe++){for(var nt=Fe[Xe].pts||[],ct={},xt=0;xt<nt.length;xt++)ct[nt[xt].i]=xt;x.tagSelected(nt,Re,ct)}}(P,p),P.length>0?(P[0].t={num:L[S],dPos:N,posLetter:w,valLetter:T,labels:{med:n(h,"median:"),min:n(h,"min:"),q1:n(h,"q1:"),q3:n(h,"q3:"),max:n(h,"max:"),mean:n(h,"sd"===p.boxmean?"mean \xb1 \u03c3:":"mean:"),lf:n(h,"lower fence:"),uf:n(h,"upper fence:")}},L[S]++,P):[{t:{empty:!0}}]};var t={text:"tx",hovertext:"htx"};function a(h,p,o){for(var b in t)x.isArrayOrTypedArray(p[b])&&(Array.isArray(o)?x.isArrayOrTypedArray(p[b][o[0]])&&(h[t[b]]=p[b][o[0]][o[1]]):h[t[b]]=p[b][o])}function r(h,p){return h.v-p.v}function d(h){return h.v}function s(h,p,o){return 0===o?h.q1:Math.min(h.q1,p[Math.min(x.findBin(2.5*h.q1-1.5*h.q3,p,!0)+1,o-1)])}function i(h,p,o){return 0===o?h.q3:Math.max(h.q3,p[Math.max(x.findBin(2.5*h.q3-1.5*h.q1,p),0)])}function u(h){return 4*h.q1-3*h.q3}function f(h){return 4*h.q3-3*h.q1}function c(h,p){return 0===p?0:1.57*(h.q3-h.q1)/Math.sqrt(p)}},{"../../constants/numerical":491,"../../lib":515,"../../plots/cartesian/align_period":563,"../../plots/cartesian/axes":566,"fast-isnumeric":190}],684:[function(y,ee,Q){"use strict";var g=y("../../plots/cartesian/axes"),v=y("../../lib"),m=y("../../plots/cartesian/constraints").getAxisGroup,x=["v","h"];function e(n,t,a,r){var d,s,i,u=t.calcdata,f=t._fullLayout,c=r._id,h=c.charAt(0),p=[],o=0;for(d=0;d<a.length;d++)for(i=u[a[d]],s=0;s<i.length;s++)p.push(r.c2l(i[s].pos,!0)),o+=(i[s].pts2||[]).length;if(p.length){var b=v.distinctVals(p);"category"!==r.type&&"multicategory"!==r.type||(b.minDiff=1);var l=b.minDiff/2;g.minDtick(r,b.minDiff,b.vals[0],!0);var T=f["violin"===n?"_numViolins":"_numBoxes"],_="group"===f[n+"mode"]&&T>1,w=1-f[n+"gap"],k=1-f[n+"groupgap"];for(d=0;d<a.length;d++){var L,M,I,P,S,E,z=(i=u[a[d]])[0].trace,R=i[0].t,q=z.width,V=z.side;if(q)L=M=P=q/2,I=0;else if(L=l,_){var W=m(f,r._id)+z.orientation,G=Object.keys(((f._alignmentOpts[W]||{})[z.alignmentgroup]||{}).offsetGroups||{}).length,Y=G||T;M=L*w*k/Y,I=2*L*(((G?z._offsetIndex:R.num)+.5)/Y-.5)*w,P=L*w/Y}else M=L*w*k,I=0,P=L;R.dPos=L,R.bPos=I,R.bdPos=M,R.wHover=P;var $,B,N,U,te,j,J=I+M,X=Boolean(q);if("positive"===V?(S=L*(q?1:.5),$=J,E=$=I):"negative"===V?(S=$=I,E=L*(q?1:.5),B=J):(S=E=L,$=B=J),(z.boxpoints||z.points)&&o>0){var re=z.pointpos,ne=z.jitter,le=z.marker.size/2,oe=0;re+ne>=0&&((oe=J*(re+ne))>S?(X=!0,te=le,N=oe):oe>$&&(te=le,N=S)),oe<=S&&(N=S);var de=0;re-ne<=0&&((de=-J*(re-ne))>E?(X=!0,j=le,U=de):de>B&&(j=le,U=E)),de<=E&&(U=E)}else N=S,U=E;var se=new Array(i.length);for(s=0;s<i.length;s++)se[s]=i[s].pos;z._extremes[c]=g.findExtremes(r,se,{padded:X,vpadminus:U,vpadplus:N,vpadLinearized:!0,ppadminus:{x:j,y:te}[h],ppadplus:{x:te,y:j}[h]})}}}ee.exports={crossTraceCalc:function(n,t){for(var a=n.calcdata,r=t.xaxis,d=t.yaxis,s=0;s<x.length;s++){for(var i=x[s],u="h"===i?d:r,f=[],c=0;c<a.length;c++){var h=a[c],o=h[0].trace;!0!==o.visible||"box"!==o.type&&"candlestick"!==o.type||h[0].t.empty||(o.orientation||"v")!==i||o.xaxis!==r._id||o.yaxis!==d._id||f.push(c)}e("box",n,f,u)}},setPositionOffset:e}},{"../../lib":515,"../../plots/cartesian/axes":566,"../../plots/cartesian/constraints":574}],685:[function(y,ee,Q){"use strict";var g=y("../../lib"),v=y("../../registry"),m=y("../../components/color"),x=y("../scatter/period_defaults"),e=y("../bar/defaults").handleGroupingDefaults,n=y("../../plots/cartesian/axis_autotype"),t=y("./attributes");function a(d,s,i,u){function f(V){var W=0;return V&&V.length&&(W+=1,g.isArrayOrTypedArray(V[0])&&V[0].length&&(W+=1)),W}function c(V){return g.validate(d[V],t[V])}var h,p=i("y"),o=i("x");if("box"===s.type){var b=i("q1"),l=i("median"),T=i("q3");s._hasPreCompStats=b&&b.length&&l&&l.length&&T&&T.length,h=Math.min(g.minRowLength(b),g.minRowLength(l),g.minRowLength(T))}var _,w,k=f(p),L=f(o),M=k&&g.minRowLength(p),I=L&&g.minRowLength(o),P=u.calendar,S={autotypenumbers:u.autotypenumbers};if(s._hasPreCompStats)switch(String(L)+String(k)){case"00":var E=c("x0")||c("dx");_=!c("y0")&&!c("dy")||E?"v":"h",w=h;break;case"10":_="v",w=Math.min(h,I);break;case"20":_="h",w=Math.min(h,o.length);break;case"01":_="h",w=Math.min(h,M);break;case"02":_="v",w=Math.min(h,p.length);break;case"12":_="v",w=Math.min(h,I,p.length);break;case"21":_="h",w=Math.min(h,o.length,M);break;case"11":w=0;break;case"22":var z,R=!1;for(z=0;z<o.length;z++)if("category"===n(o[z],P,S)){R=!0;break}if(R)_="v",w=Math.min(h,I,p.length);else{for(z=0;z<p.length;z++)if("category"===n(p[z],P,S)){R=!0;break}R?(_="h",w=Math.min(h,o.length,M)):(_="v",w=Math.min(h,I,p.length))}}else k>0?(_="v",w=L>0?Math.min(I,M):Math.min(M)):L>0?(_="h",w=Math.min(I)):w=0;if(w){s._length=w;var q=i("orientation",_);s._hasPreCompStats?"v"===q&&0===L?(i("x0",0),i("dx",1)):"h"===q&&0===k&&(i("y0",0),i("dy",1)):"v"===q&&0===L?i("x0"):"h"===q&&0===k&&i("y0"),v.getComponentMethod("calendars","handleTraceDefaults")(d,s,["x","y"],u)}else s.visible=!1}function r(d,s,i,u){var f=u.prefix,c=g.coerce2(d,s,t,"marker.outliercolor"),h=i("marker.line.outliercolor"),p="outliers";s._hasPreCompStats?p="all":(c||h)&&(p="suspectedoutliers");var o=i(f+"points",p);o?(i("jitter","all"===o?.3:0),i("pointpos","all"===o?-1.5:0),i("marker.symbol"),i("marker.opacity"),i("marker.size"),i("marker.color",s.line.color),i("marker.line.color"),i("marker.line.width"),"suspectedoutliers"===o&&(i("marker.line.outliercolor",s.marker.color),i("marker.line.outlierwidth")),i("selected.marker.color"),i("unselected.marker.color"),i("selected.marker.size"),i("unselected.marker.size"),i("text"),i("hovertext")):delete s.marker;var b=i("hoveron");"all"!==b&&-1===b.indexOf("points")||i("hovertemplate"),g.coerceSelectionMarkerOpacity(s,i)}ee.exports={supplyDefaults:function(d,s,i,u){function f(T,_){return g.coerce(d,s,t,T,_)}if(a(d,s,f,u),!1!==s.visible){x(d,s,u,f),f("xhoverformat"),f("yhoverformat");var c=s._hasPreCompStats;c&&(f("lowerfence"),f("upperfence")),f("line.color",(d.marker||{}).color||i),f("line.width"),f("fillcolor",m.addOpacity(s.line.color,.5));var h=!1;if(c){var p=f("mean"),o=f("sd");p&&p.length&&(h=!0,o&&o.length&&(h="sd"))}f("boxmean",h),f("whiskerwidth"),f("width"),f("quartilemethod");var b=!1;if(c){var l=f("notchspan");l&&l.length&&(b=!0)}else g.validate(d.notchwidth,t.notchwidth)&&(b=!0);f("notched",b)&&f("notchwidth"),r(d,s,f,{prefix:"box"})}},crossTraceDefaults:function(d,s){var u;function f(p){return g.coerce(u._input,u,t,p)}for(var c=0;c<d.length;c++){var h=(u=d[c]).type;"box"!==h&&"violin"!==h||"group"===s[h+"mode"]&&e(u._input,u,s,f)}},handleSampleDefaults:a,handlePointsDefaults:r}},{"../../components/color":367,"../../lib":515,"../../plots/cartesian/axis_autotype":567,"../../registry":647,"../bar/defaults":661,"../scatter/period_defaults":956,"./attributes":682}],686:[function(y,ee,Q){"use strict";ee.exports=function(g,v){return v.hoverOnBox&&(g.hoverOnBox=v.hoverOnBox),"xVal"in v&&(g.x=v.xVal),"yVal"in v&&(g.y=v.yVal),v.xa&&(g.xaxis=v.xa),v.ya&&(g.yaxis=v.ya),g}},{}],687:[function(y,ee,Q){"use strict";var g=y("../../plots/cartesian/axes"),v=y("../../lib"),m=y("../../components/fx"),x=y("../../components/color"),e=v.fillText;function n(a,r,d,s){var i,u,f,c,h,p,o,b,l,T,_,w,k,L,M=a.cd,I=a.xa,P=a.ya,S=M[0].trace,E=M[0].t,z="violin"===S.type,R=E.bdPos,q=E.wHover,V=function(Te){return f.c2l(Te.pos)+E.bPos-f.c2l(p)};z&&"both"!==S.side?("positive"===S.side&&(l=function(Te){var we=V(Te);return m.inbox(we,we+q,T)},w=R,k=0),"negative"===S.side&&(l=function(Te){var we=V(Te);return m.inbox(we-q,we,T)},w=0,k=R)):(l=function(Te){var we=V(Te);return m.inbox(we-q,we+q,T)},w=k=R),L=z?function(Te){return m.inbox(Te.span[0]-h,Te.span[1]-h,T)}:function(Te){return m.inbox(Te.min-h,Te.max-h,T)},"h"===S.orientation?(h=r,p=d,o=L,b=l,i="y",f=P,u="x",c=I):(h=d,p=r,o=l,b=L,i="x",f=I,u="y",c=P);var W=Math.min(1,R/Math.abs(f.r2c(f.range[1])-f.r2c(f.range[0])));function K(Te){return(o(Te)+b(Te))/2}T=a.maxHoverDistance-W,_=a.maxSpikeDistance-W;var G=m.getDistanceFunction(s,o,b,K);if(m.getClosest(M,G,a),!1===a.index)return[];var Y=M[a.index],$=S.line.color,B=(S.marker||{}).color;a.color=x.opacity($)&&S.line.width?$:x.opacity(B)&&S.boxpoints?B:S.fillcolor,a[i+"0"]=f.c2p(Y.pos+E.bPos-k,!0),a[i+"1"]=f.c2p(Y.pos+E.bPos+w,!0),a[i+"LabelVal"]=void 0!==Y.orig_p?Y.orig_p:Y.pos;var N=i+"Spike";a.spikeDistance=K(Y)*_/T,a[N]=f.c2p(Y.pos,!0);var U=S.boxmean||(S.meanline||{}).visible,te=S.boxpoints||S.points,j=te&&U?["max","uf","q3","med","mean","q1","lf","min"]:te&&!U?["max","uf","q3","med","q1","lf","min"]:!te&&U?["max","q3","med","mean","q1","min"]:["max","q3","med","q1","min"];S.orientation===(c.range[1]<c.range[0]?"v":"h")&&j.reverse();for(var X=a.spikeDistance,re=a[N],ne=[],le=0;le<j.length;le++){var oe=j[le];if(oe in Y){var de=Y[oe],se=c.c2p(de,!0),ge=v.extendFlat({},a);ge.attr=oe,ge[u+"0"]=ge[u+"1"]=se,ge[u+"LabelVal"]=de,ge[u+"Label"]=(E.labels?E.labels[oe]+" ":"")+g.hoverLabelText(c,de,S[u+"hoverformat"]),ge.hoverOnBox=!0,"mean"===oe&&"sd"in Y&&"sd"===S.boxmean&&(ge[u+"err"]=Y.sd),ge.hovertemplate=!1,ne.push(ge)}}a.name="",a.spikeDistance=void 0,a[N]=void 0;for(var _e=0;_e<ne.length;_e++)"med"!==ne[_e].attr?(ne[_e].name="",ne[_e].spikeDistance=void 0,ne[_e][N]=void 0):(ne[_e].spikeDistance=X,ne[_e][N]=re);return ne}function t(a,r,d){for(var s,i,u,f=a.cd,c=a.xa,h=a.ya,p=f[0].trace,o=c.c2p(r),b=h.c2p(d),l=m.quadrature(function(z){var R=Math.max(3,z.mrc||0);return Math.max(Math.abs(c.c2p(z.x)-o)-R,1-3/R)},function(z){var R=Math.max(3,z.mrc||0);return Math.max(Math.abs(h.c2p(z.y)-b)-R,1-3/R)}),T=!1,_=0;_<f.length;_++){i=f[_];for(var w=0;w<(i.pts||[]).length;w++){var k=l(u=i.pts[w]);k<=a.distance&&(a.distance=k,T=[_,w])}}if(!T)return!1;u=(i=f[T[0]]).pts[T[1]];var L=c.c2p(u.x,!0),M=h.c2p(u.y,!0),I=u.mrc||1;s=v.extendFlat({},a,{index:u.i,color:(p.marker||{}).color,name:p.name,x0:L-I,x1:L+I,y0:M-I,y1:M+I,spikeDistance:a.distance,hovertemplate:p.hovertemplate});var P,S=i.orig_p,E=void 0!==S?S:i.pos;return"h"===p.orientation?(P=h,s.xLabelVal=u.x,s.yLabelVal=E):(P=c,s.xLabelVal=E,s.yLabelVal=u.y),s[P._id.charAt(0)+"Spike"]=P.c2p(i.pos,!0),e(u,p,s),s}ee.exports={hoverPoints:function(a,r,d,s){var i,u=a.cd[0].trace.hoveron,f=[];return-1!==u.indexOf("boxes")&&(f=f.concat(n(a,r,d,s))),-1!==u.indexOf("points")&&(i=t(a,r,d)),"closest"===s?i?[i]:f:(i&&f.push(i),f)},hoverOnBoxes:n,hoverOnPoints:t}},{"../../components/color":367,"../../components/fx":407,"../../lib":515,"../../plots/cartesian/axes":566}],688:[function(y,ee,Q){"use strict";ee.exports={attributes:y("./attributes"),layoutAttributes:y("./layout_attributes"),supplyDefaults:y("./defaults").supplyDefaults,crossTraceDefaults:y("./defaults").crossTraceDefaults,supplyLayoutDefaults:y("./layout_defaults").supplyLayoutDefaults,calc:y("./calc"),crossTraceCalc:y("./cross_trace_calc").crossTraceCalc,plot:y("./plot").plot,style:y("./style").style,styleOnSelect:y("./style").styleOnSelect,hoverPoints:y("./hover").hoverPoints,eventData:y("./event_data"),selectPoints:y("./select"),moduleType:"trace",name:"box",basePlotModule:y("../../plots/cartesian"),categories:["cartesian","svg","symbols","oriented","box-violin","showLegend","boxLayout","zoomScale"],meta:{}}},{"../../plots/cartesian":578,"./attributes":682,"./calc":683,"./cross_trace_calc":684,"./defaults":685,"./event_data":686,"./hover":687,"./layout_attributes":689,"./layout_defaults":690,"./plot":691,"./select":692,"./style":693}],689:[function(y,ee,Q){"use strict";ee.exports={boxmode:{valType:"enumerated",values:["group","overlay"],dflt:"overlay",editType:"calc"},boxgap:{valType:"number",min:0,max:1,dflt:.3,editType:"calc"},boxgroupgap:{valType:"number",min:0,max:1,dflt:.3,editType:"calc"}}},{}],690:[function(y,ee,Q){"use strict";var g=y("../../registry"),v=y("../../lib"),m=y("./layout_attributes");function x(e,n,t,a,r){for(var d=r+"Layout",s=!1,i=0;i<t.length;i++)if(g.traceIs(t[i],d)){s=!0;break}s&&(a(r+"mode"),a(r+"gap"),a(r+"groupgap"))}ee.exports={supplyLayoutDefaults:function(e,n,t){x(0,0,t,function(a,r){return v.coerce(e,n,m,a,r)},"box")},_supply:x}},{"../../lib":515,"../../registry":647,"./layout_attributes":689}],691:[function(y,ee,Q){"use strict";var g=y("@plotly/d3"),v=y("../../lib"),m=y("../../components/drawing");function x(t,a,r,d){var s,i,u="h"===r.orientation,f=a.val,c=a.pos,h=!!c.rangebreaks,p=d.bPos,o=d.wdPos||0,b=d.bPosPxOffset||0,l=r.whiskerwidth||0,T=r.notched||!1,_=T?1-2*r.notchwidth:1;Array.isArray(d.bdPos)?(s=d.bdPos[0],i=d.bdPos[1]):(s=d.bdPos,i=d.bdPos);var w=t.selectAll("path.box").data("violin"!==r.type||r.box.visible?v.identity:[]);w.enter().append("path").style("vector-effect","non-scaling-stroke").attr("class","box"),w.exit().remove(),w.each(function(k){if(k.empty)return"M0,0Z";var L=c.c2l(k.pos+p,!0),M=c.l2p(L-s)+b,I=c.l2p(L+i)+b,P=h?(M+I)/2:c.l2p(L)+b,S=r.whiskerwidth,E=h?M*S+(1-S)*P:c.l2p(L-o)+b,z=h?I*S+(1-S)*P:c.l2p(L+o)+b,R=c.l2p(L-s*_)+b,q=c.l2p(L+i*_)+b,V=f.c2p(k.q1,!0),W=f.c2p(k.q3,!0),K=v.constrain(f.c2p(k.med,!0),Math.min(V,W)+1,Math.max(V,W)-1),G=void 0===k.lf||!1===r.boxpoints,Y=f.c2p(G?k.min:k.lf,!0),$=f.c2p(G?k.max:k.uf,!0),B=f.c2p(k.ln,!0),N=f.c2p(k.un,!0);u?g.select(this).attr("d","M"+K+","+R+"V"+q+"M"+V+","+M+"V"+I+(T?"H"+B+"L"+K+","+q+"L"+N+","+I:"")+"H"+W+"V"+M+(T?"H"+N+"L"+K+","+R+"L"+B+","+M:"")+"ZM"+V+","+P+"H"+Y+"M"+W+","+P+"H"+$+(0===l?"":"M"+Y+","+E+"V"+z+"M"+$+","+E+"V"+z)):g.select(this).attr("d","M"+R+","+K+"H"+q+"M"+M+","+V+"H"+I+(T?"V"+B+"L"+q+","+K+"L"+I+","+N:"")+"V"+W+"H"+M+(T?"V"+N+"L"+R+","+K+"L"+M+","+B:"")+"ZM"+P+","+V+"V"+Y+"M"+P+","+W+"V"+$+(0===l?"":"M"+E+","+Y+"H"+z+"M"+E+","+$+"H"+z))})}function e(t,a,r,d){var s=a.x,i=a.y,u=d.bdPos,f=d.bPos,c=r.boxpoints||r.points;v.seedPseudoRandom();var h=t.selectAll("g.points").data(c?function(o){return o.forEach(function(b){b.t=d,b.trace=r}),o}:[]);h.enter().append("g").attr("class","points"),h.exit().remove();var p=h.selectAll("path").data(function(o){var b,l,T=o.pts2,_=Math.max((o.max-o.min)/10,o.q3-o.q1),w=1e-9*_,k=.01*_,L=[],M=0;if(r.jitter){if(0===_)for(M=1,L=new Array(T.length),b=0;b<T.length;b++)L[b]=1;else for(b=0;b<T.length;b++){var I=Math.max(0,b-5),P=T[I].v,S=Math.min(T.length-1,b+5),E=T[S].v;"all"!==c&&(T[b].v<o.lf?E=Math.min(E,o.lf):P=Math.max(P,o.uf));var z=Math.sqrt(k*(S-I)/(E-P+w))||0;z=v.constrain(Math.abs(z),0,1),L.push(z),M=Math.max(z,M)}l=2*r.jitter/(M||1)}for(b=0;b<T.length;b++){var R=T[b],q=R.v,V=r.jitter?l*L[b]*(v.pseudoRandom()-.5):0,W=o.pos+f+u*(r.pointpos+V);"h"===r.orientation?(R.y=W,R.x=q):(R.x=W,R.y=q),"suspectedoutliers"===c&&q<o.uo&&q>o.lo&&(R.so=!0)}return T});p.enter().append("path").classed("point",!0),p.exit().remove(),p.call(m.translatePoints,s,i)}function n(t,a,r,d){var s,i,u=a.val,f=a.pos,c=!!f.rangebreaks,h=d.bPos,p=d.bPosPxOffset||0,o=r.boxmean||(r.meanline||{}).visible;Array.isArray(d.bdPos)?(s=d.bdPos[0],i=d.bdPos[1]):(s=d.bdPos,i=d.bdPos);var b=t.selectAll("path.mean").data("box"===r.type&&r.boxmean||"violin"===r.type&&r.box.visible&&r.meanline.visible?v.identity:[]);b.enter().append("path").attr("class","mean").style({fill:"none","vector-effect":"non-scaling-stroke"}),b.exit().remove(),b.each(function(l){var T=f.c2l(l.pos+h,!0),_=f.l2p(T-s)+p,w=f.l2p(T+i)+p,k=c?(_+w)/2:f.l2p(T)+p,L=u.c2p(l.mean,!0),M=u.c2p(l.mean-l.sd,!0),I=u.c2p(l.mean+l.sd,!0);"h"===r.orientation?g.select(this).attr("d","M"+L+","+_+"V"+w+("sd"===o?"m0,0L"+M+","+k+"L"+L+","+_+"L"+I+","+k+"Z":"")):g.select(this).attr("d","M"+_+","+L+"H"+w+("sd"===o?"m0,0L"+k+","+M+"L"+_+","+L+"L"+k+","+I+"Z":""))})}ee.exports={plot:function(t,a,r,d){var s=a.xaxis,i=a.yaxis;v.makeTraceGroups(d,r,"trace boxes").each(function(u){var f,c,h=g.select(this),p=u[0],o=p.t,b=p.trace;o.wdPos=o.bdPos*b.whiskerwidth,!0!==b.visible||o.empty?h.remove():("h"===b.orientation?(f=i,c=s):(f=s,c=i),x(h,{pos:f,val:c},b,o),e(h,{x:s,y:i},b,o),n(h,{pos:f,val:c},b,o))})},plotBoxAndWhiskers:x,plotPoints:e,plotBoxMean:n}},{"../../components/drawing":389,"../../lib":515,"@plotly/d3":58}],692:[function(y,ee,Q){"use strict";ee.exports=function(g,v){var m,x,e=g.cd,n=g.xaxis,t=g.yaxis,a=[];if(!1===v)for(m=0;m<e.length;m++)for(x=0;x<(e[m].pts||[]).length;x++)e[m].pts[x].selected=0;else for(m=0;m<e.length;m++)for(x=0;x<(e[m].pts||[]).length;x++){var r=e[m].pts[x],d=n.c2p(r.x),s=t.c2p(r.y);v.contains([d,s],null,r.i,g)?(a.push({pointNumber:r.i,x:n.c2d(r.x),y:t.c2d(r.y)}),r.selected=1):r.selected=0}return a}},{}],693:[function(y,ee,Q){"use strict";var g=y("@plotly/d3"),v=y("../../components/color"),m=y("../../components/drawing");ee.exports={style:function(x,e,n){var t=n||g.select(x).selectAll("g.trace.boxes");t.style("opacity",function(a){return a[0].trace.opacity}),t.each(function(a){var r=g.select(this),d=a[0].trace,s=d.line.width;function i(c,h,p,o){c.style("stroke-width",h+"px").call(v.stroke,p).call(v.fill,o)}var u=r.selectAll("path.box");if("candlestick"===d.type)u.each(function(c){if(!c.empty){var h=g.select(this),p=d[c.dir];i(h,p.line.width,p.line.color,p.fillcolor),h.style("opacity",d.selectedpoints&&!c.selected?.3:1)}});else{i(u,s,d.line.color,d.fillcolor),r.selectAll("path.mean").style({"stroke-width":s,"stroke-dasharray":2*s+"px,"+s+"px"}).call(v.stroke,d.line.color);var f=r.selectAll("path.point");m.pointStyle(f,d,x)}})},styleOnSelect:function(x,e,n){var t=e[0].trace,a=n.selectAll("path.point");t.selectedpoints?m.selectedPointStyle(a,t):m.pointStyle(a,t,x)}}},{"../../components/color":367,"../../components/drawing":389,"@plotly/d3":58}],694:[function(y,ee,Q){"use strict";var g=y("../../lib").extendFlat,v=y("../../plots/cartesian/axis_format_attributes").axisHoverFormat,m=y("../ohlc/attributes"),x=y("../box/attributes");function e(n){return{line:{color:g({},x.line.color,{dflt:n}),width:x.line.width,editType:"style"},fillcolor:x.fillcolor,editType:"style"}}ee.exports={xperiod:m.xperiod,xperiod0:m.xperiod0,xperiodalignment:m.xperiodalignment,xhoverformat:v("x"),yhoverformat:v("y"),x:m.x,open:m.open,high:m.high,low:m.low,close:m.close,line:{width:g({},x.line.width,{}),editType:"style"},increasing:e(m.increasing.line.color.dflt),decreasing:e(m.decreasing.line.color.dflt),text:m.text,hovertext:m.hovertext,whiskerwidth:g({},x.whiskerwidth,{dflt:0}),hoverlabel:m.hoverlabel}},{"../../lib":515,"../../plots/cartesian/axis_format_attributes":569,"../box/attributes":682,"../ohlc/attributes":881}],695:[function(y,ee,Q){"use strict";var g=y("../../lib"),v=y("../../plots/cartesian/axes"),m=y("../../plots/cartesian/align_period"),x=y("../ohlc/calc").calcCommon;function e(n,t,a,r){return{min:a,q1:Math.min(n,r),med:r,q3:Math.max(n,r),max:t}}ee.exports=function(n,t){var a=n._fullLayout,r=v.getFromId(n,t.xaxis),d=v.getFromId(n,t.yaxis),s=r.makeCalcdata(t,"x"),i=m(t,r,"x",s).vals,u=x(n,t,s,i,d,e);return u.length?(g.extendFlat(u[0].t,{num:a._numBoxes,dPos:g.distinctVals(i).minDiff/2,posLetter:"x",valLetter:"y"}),a._numBoxes++,u):[{t:{empty:!0}}]}},{"../../lib":515,"../../plots/cartesian/align_period":563,"../../plots/cartesian/axes":566,"../ohlc/calc":882}],696:[function(y,ee,Q){"use strict";var g=y("../../lib"),v=y("../../components/color"),m=y("../ohlc/ohlc_defaults"),x=y("../scatter/period_defaults"),e=y("./attributes");function n(t,a,r,d){var s=r(d+".line.color");r(d+".line.width",a.line.width),r(d+".fillcolor",v.addOpacity(s,.5))}ee.exports=function(t,a,r,d){function s(i,u){return g.coerce(t,a,e,i,u)}m(t,a,s,d)?(x(t,a,d,s,{x:!0}),s("xhoverformat"),s("yhoverformat"),s("line.width"),n(0,a,s,"increasing"),n(0,a,s,"decreasing"),s("text"),s("hovertext"),s("whiskerwidth"),d._requestRangeslider[a.xaxis]=!0):a.visible=!1}},{"../../components/color":367,"../../lib":515,"../ohlc/ohlc_defaults":886,"../scatter/period_defaults":956,"./attributes":694}],697:[function(y,ee,Q){"use strict";ee.exports={moduleType:"trace",name:"candlestick",basePlotModule:y("../../plots/cartesian"),categories:["cartesian","svg","showLegend","candlestick","boxLayout"],meta:{},attributes:y("./attributes"),layoutAttributes:y("../box/layout_attributes"),supplyLayoutDefaults:y("../box/layout_defaults").supplyLayoutDefaults,crossTraceCalc:y("../box/cross_trace_calc").crossTraceCalc,supplyDefaults:y("./defaults"),calc:y("./calc"),plot:y("../box/plot").plot,layerName:"boxlayer",style:y("../box/style").style,hoverPoints:y("../ohlc/hover").hoverPoints,selectPoints:y("../ohlc/select")}},{"../../plots/cartesian":578,"../box/cross_trace_calc":684,"../box/layout_attributes":689,"../box/layout_defaults":690,"../box/plot":691,"../box/style":693,"../ohlc/hover":884,"../ohlc/select":888,"./attributes":694,"./calc":695,"./defaults":696}],698:[function(y,ee,Q){"use strict";var g=y("./axis_defaults"),v=y("../../plot_api/plot_template");ee.exports=function(m,x,e,n,t){var a,r,d,s;n("a")||(n("da"),n("a0")),n("b")||(n("db"),n("b0")),a=m,r=x,d=e,s=t,["aaxis","baxis"].forEach(function(i){var u=i.charAt(0),f=a[i]||{},c=v.newContainer(r,i);g(f,c,{noTicklabelstep:!0,tickfont:"x",id:u+"axis",letter:u,font:r.font,name:i,data:a[u],calendar:r.calendar,dfltColor:s,bgColor:d.paper_bgcolor,autotypenumbersDflt:d.autotypenumbers,fullLayout:d}),c._categories=c._categories||[],a[i]||"-"===f.type||(a[i]={type:f.type})})}},{"../../plot_api/plot_template":555,"./axis_defaults":703}],699:[function(y,ee,Q){"use strict";var g=y("../../lib").isArrayOrTypedArray;ee.exports=function(v){return function m(x,e){if(!g(x)||e>=10)return null;for(var n=1/0,t=-1/0,a=x.length,r=0;r<a;r++){var d=x[r];if(g(d)){var s=m(d,e+1);s&&(n=Math.min(s[0],n),t=Math.max(s[1],t))}else n=Math.min(d,n),t=Math.max(d,t)}return[n,t]}(v,0)}},{"../../lib":515}],700:[function(y,ee,Q){"use strict";var g=y("../../plots/font_attributes"),v=y("./axis_attributes"),m=y("../../components/color/attributes"),x=g({editType:"calc"});x.family.dflt='"Open Sans", verdana, arial, sans-serif',x.size.dflt=12,x.color.dflt=m.defaultLine,ee.exports={carpet:{valType:"string",editType:"calc"},x:{valType:"data_array",editType:"calc+clearAxisTypes"},y:{valType:"data_array",editType:"calc+clearAxisTypes"},a:{valType:"data_array",editType:"calc"},a0:{valType:"number",dflt:0,editType:"calc"},da:{valType:"number",dflt:1,editType:"calc"},b:{valType:"data_array",editType:"calc"},b0:{valType:"number",dflt:0,editType:"calc"},db:{valType:"number",dflt:1,editType:"calc"},cheaterslope:{valType:"number",dflt:1,editType:"calc"},aaxis:v,baxis:v,font:x,color:{valType:"color",dflt:m.defaultLine,editType:"plot"},transforms:void 0}},{"../../components/color/attributes":366,"../../plots/font_attributes":594,"./axis_attributes":702}],701:[function(y,ee,Q){"use strict";var g=y("../../lib").isArrayOrTypedArray;ee.exports=function(v,m,x,e){var n,t,a,r,d,s,i,u,f,c,h,p,o,b=g(x)?"a":"b",l=("a"===b?v.aaxis:v.baxis).smoothing,T="a"===b?v.a2i:v.b2j,_="a"===b?x:e,w="a"===b?e:x,k="a"===b?m.a.length:m.b.length,L="a"===b?m.b.length:m.a.length,M=Math.floor("a"===b?v.b2j(w):v.a2i(w)),I="a"===b?function($){return v.evalxy([],$,M)}:function($){return v.evalxy([],M,$)};l&&(a=Math.max(0,Math.min(L-2,M)),r=M-a,t="a"===b?function($,B){return v.dxydi([],$,a,B,r)}:function($,B){return v.dxydj([],a,$,r,B)});var P=T(_[0]),S=T(_[1]),E=P<S?1:-1,z=1e-8*(S-P),R=E>0?Math.floor:Math.ceil,q=E>0?Math.ceil:Math.floor,V=E>0?Math.min:Math.max,W=E>0?Math.max:Math.min,K=R(P+z),G=q(S-z),Y=[[i=I(P)]];for(n=K;n*E<G*E;n+=E)d=[],h=W(P,n),o=(p=V(S,n+E))-h,s=Math.max(0,Math.min(k-2,Math.floor(.5*(h+p)))),u=I(p),l&&(f=t(s,h-s),c=t(s,p-s),d.push([i[0]+f[0]/3*o,i[1]+f[1]/3*o]),d.push([u[0]-c[0]/3*o,u[1]-c[1]/3*o])),d.push(u),Y.push(d),i=u;return Y}},{"../../lib":515}],702:[function(y,ee,Q){"use strict";var g=y("../../plots/font_attributes"),v=y("../../components/color/attributes"),m=y("../../plots/cartesian/layout_attributes"),x=y("../../plots/cartesian/axis_format_attributes").descriptionWithDates,e=y("../../plot_api/edit_types").overrideAll,n=y("../../components/drawing/attributes").dash,t=y("../../lib/extend").extendFlat;ee.exports={color:{valType:"color",editType:"calc"},smoothing:{valType:"number",dflt:1,min:0,max:1.3,editType:"calc"},title:{text:{valType:"string",dflt:"",editType:"calc"},font:g({editType:"calc"}),offset:{valType:"number",dflt:10,editType:"calc"},editType:"calc"},type:{valType:"enumerated",values:["-","linear","date","category"],dflt:"-",editType:"calc"},autotypenumbers:m.autotypenumbers,autorange:{valType:"enumerated",values:[!0,!1,"reversed"],dflt:!0,editType:"calc"},rangemode:{valType:"enumerated",values:["normal","tozero","nonnegative"],dflt:"normal",editType:"calc"},range:{valType:"info_array",editType:"calc",items:[{valType:"any",editType:"calc"},{valType:"any",editType:"calc"}]},fixedrange:{valType:"boolean",dflt:!1,editType:"calc"},cheatertype:{valType:"enumerated",values:["index","value"],dflt:"value",editType:"calc"},tickmode:{valType:"enumerated",values:["linear","array"],dflt:"array",editType:"calc"},nticks:{valType:"integer",min:0,dflt:0,editType:"calc"},tickvals:{valType:"data_array",editType:"calc"},ticktext:{valType:"data_array",editType:"calc"},showticklabels:{valType:"enumerated",values:["start","end","both","none"],dflt:"start",editType:"calc"},tickfont:g({editType:"calc"}),tickangle:{valType:"angle",dflt:"auto",editType:"calc"},tickprefix:{valType:"string",dflt:"",editType:"calc"},showtickprefix:{valType:"enumerated",values:["all","first","last","none"],dflt:"all",editType:"calc"},ticksuffix:{valType:"string",dflt:"",editType:"calc"},showticksuffix:{valType:"enumerated",values:["all","first","last","none"],dflt:"all",editType:"calc"},showexponent:{valType:"enumerated",values:["all","first","last","none"],dflt:"all",editType:"calc"},exponentformat:{valType:"enumerated",values:["none","e","E","power","SI","B"],dflt:"B",editType:"calc"},minexponent:{valType:"number",dflt:3,min:0,editType:"calc"},separatethousands:{valType:"boolean",dflt:!1,editType:"calc"},tickformat:{valType:"string",dflt:"",editType:"calc",description:x("tick label")},tickformatstops:e(m.tickformatstops,"calc","from-root"),categoryorder:{valType:"enumerated",values:["trace","category ascending","category descending","array"],dflt:"trace",editType:"calc"},categoryarray:{valType:"data_array",editType:"calc"},labelpadding:{valType:"integer",dflt:10,editType:"calc"},labelprefix:{valType:"string",editType:"calc"},labelsuffix:{valType:"string",dflt:"",editType:"calc"},showline:{valType:"boolean",dflt:!1,editType:"calc"},linecolor:{valType:"color",dflt:v.defaultLine,editType:"calc"},linewidth:{valType:"number",min:0,dflt:1,editType:"calc"},gridcolor:{valType:"color",editType:"calc"},gridwidth:{valType:"number",min:0,dflt:1,editType:"calc"},griddash:t({},n,{editType:"calc"}),showgrid:{valType:"boolean",dflt:!0,editType:"calc"},minorgridcount:{valType:"integer",min:0,dflt:0,editType:"calc"},minorgridwidth:{valType:"number",min:0,dflt:1,editType:"calc"},minorgriddash:t({},n,{editType:"calc"}),minorgridcolor:{valType:"color",dflt:v.lightLine,editType:"calc"},startline:{valType:"boolean",editType:"calc"},startlinecolor:{valType:"color",editType:"calc"},startlinewidth:{valType:"number",dflt:1,editType:"calc"},endline:{valType:"boolean",editType:"calc"},endlinewidth:{valType:"number",dflt:1,editType:"calc"},endlinecolor:{valType:"color",editType:"calc"},tick0:{valType:"number",min:0,dflt:0,editType:"calc"},dtick:{valType:"number",min:0,dflt:1,editType:"calc"},arraytick0:{valType:"integer",min:0,dflt:0,editType:"calc"},arraydtick:{valType:"integer",min:1,dflt:1,editType:"calc"},_deprecated:{title:{valType:"string",editType:"calc"},titlefont:g({editType:"calc"}),titleoffset:{valType:"number",dflt:10,editType:"calc"}},editType:"calc"}},{"../../components/color/attributes":366,"../../components/drawing/attributes":388,"../../lib/extend":505,"../../plot_api/edit_types":548,"../../plots/cartesian/axis_format_attributes":569,"../../plots/cartesian/layout_attributes":579,"../../plots/font_attributes":594}],703:[function(y,ee,Q){"use strict";var g=y("./attributes"),v=y("../../components/color").addOpacity,m=y("../../registry"),x=y("../../lib"),e=y("../../plots/cartesian/tick_value_defaults"),n=y("../../plots/cartesian/tick_label_defaults"),t=y("../../plots/cartesian/prefix_suffix_defaults"),a=y("../../plots/cartesian/category_order_defaults"),r=y("../../plots/cartesian/set_convert"),d=y("../../plots/cartesian/axis_autotype");ee.exports=function(s,i,u){var f=u.letter,c=u.font||{},h=g[f+"axis"];function p(E,z){return x.coerce(s,i,h,E,z)}function o(E,z){return x.coerce2(s,i,h,E,z)}u.name&&(i._name=u.name,i._id=u.name),p("autotypenumbers",u.autotypenumbersDflt);var b=p("type");"-"===b&&(u.data&&function(E,z){if("-"===E.type){var R=E._id.charAt(0);E.type=d(z,E[R+"calendar"],{autotypenumbers:E.autotypenumbers})}}(i,u.data),"-"===i.type?i.type="linear":b=s.type=i.type),p("smoothing"),p("cheatertype"),p("showticklabels"),p("labelprefix",f+" = "),p("labelsuffix"),p("showtickprefix"),p("showticksuffix"),p("separatethousands"),p("tickformat"),p("exponentformat"),p("minexponent"),p("showexponent"),p("categoryorder"),p("tickmode"),p("tickvals"),p("ticktext"),p("tick0"),p("dtick"),"array"===i.tickmode&&(p("arraytick0"),p("arraydtick")),p("labelpadding"),i._hovertitle=f,"date"===b&&m.getComponentMethod("calendars","handleDefaults")(s,i,"calendar",u.calendar),r(i,u.fullLayout),i.c2p=x.identity;var l=p("color",u.dfltColor),T=l===s.color?l:c.color;p("title.text")&&(x.coerceFont(p,"title.font",{family:c.family,size:x.bigFont(c.size),color:T}),p("title.offset")),p("tickangle"),p("autorange",!i.isValidRange(s.range))&&p("rangemode"),p("range"),i.cleanRange(),p("fixedrange"),e(s,i,p,b),t(s,i,p,b,u),n(s,i,p,b,u),a(s,i,p,{data:u.data,dataAttr:f});var _=o("gridcolor",v(l,.3)),w=o("gridwidth"),k=o("griddash"),L=p("showgrid");L||(delete i.gridcolor,delete i.gridwidth,delete i.griddash);var M=o("startlinecolor",l),I=o("startlinewidth",w);p("startline",i.showgrid||!!M||!!I)||(delete i.startlinecolor,delete i.startlinewidth);var P=o("endlinecolor",l),S=o("endlinewidth",w);return p("endline",i.showgrid||!!P||!!S)||(delete i.endlinecolor,delete i.endlinewidth),L?(p("minorgridcount"),p("minorgridwidth",w),p("minorgriddash",k),p("minorgridcolor",v(_,.06)),i.minorgridcount||(delete i.minorgridwidth,delete i.minorgriddash,delete i.minorgridcolor)):(delete i.gridcolor,delete i.gridwidth,delete i.griddash),"none"===i.showticklabels&&(delete i.tickfont,delete i.tickangle,delete i.showexponent,delete i.exponentformat,delete i.minexponent,delete i.tickformat,delete i.showticksuffix,delete i.showtickprefix),i.showticksuffix||delete i.ticksuffix,i.showtickprefix||delete i.tickprefix,p("tickmode"),i}},{"../../components/color":367,"../../lib":515,"../../plots/cartesian/axis_autotype":567,"../../plots/cartesian/category_order_defaults":571,"../../plots/cartesian/prefix_suffix_defaults":583,"../../plots/cartesian/set_convert":585,"../../plots/cartesian/tick_label_defaults":587,"../../plots/cartesian/tick_value_defaults":589,"../../registry":647,"./attributes":700}],704:[function(y,ee,Q){"use strict";var g=y("../../plots/cartesian/axes"),v=y("../../lib").isArray1D,m=y("./cheater_basis"),x=y("./array_minmax"),e=y("./calc_gridlines"),n=y("./calc_labels"),t=y("./calc_clippath"),a=y("../heatmap/clean_2d_array"),r=y("./smooth_fill_2d_array"),d=y("../heatmap/convert_column_xyz"),s=y("./set_convert");ee.exports=function(i,u){var f=g.getFromId(i,u.xaxis),c=g.getFromId(i,u.yaxis),h=u.aaxis,p=u.baxis,o=u.x,b=u.y,l=[];o&&v(o)&&l.push("x"),b&&v(b)&&l.push("y"),l.length&&d(u,h,p,"a","b",l);var T=u._a=u._a||u.a,_=u._b=u._b||u.b;o=u._x||u.x,b=u._y||u.y;var w={};u._cheater&&(o=m("index"===h.cheatertype?T.length:T,"index"===p.cheatertype?_.length:_,u.cheaterslope)),u._x=o=a(o),u._y=b=a(b),r(o,T,_),r(b,T,_),s(u),u.setScale();var M=x(o),I=x(b),P=.5*(M[1]-M[0]),S=.5*(M[1]+M[0]),E=.5*(I[1]-I[0]),z=.5*(I[1]+I[0]);return I=[z-1.3*E,z+1.3*E],u._extremes[f._id]=g.findExtremes(f,M=[S-1.3*P,S+1.3*P],{padded:!0}),u._extremes[c._id]=g.findExtremes(c,I,{padded:!0}),e(u,"a","b"),e(u,"b","a"),n(u,h),n(u,p),w.clipsegments=t(u._xctrl,u._yctrl,h,p),w.x=o,w.y=b,w.a=T,w.b=_,[w]}},{"../../lib":515,"../../plots/cartesian/axes":566,"../heatmap/clean_2d_array":803,"../heatmap/convert_column_xyz":805,"./array_minmax":699,"./calc_clippath":705,"./calc_gridlines":706,"./calc_labels":707,"./cheater_basis":709,"./set_convert":722,"./smooth_fill_2d_array":723}],705:[function(y,ee,Q){"use strict";ee.exports=function(g,v,m,x){var e,n,t,a=[],r=!!m.smoothing,d=!!x.smoothing,s=g[0].length-1,i=g.length-1;for(e=0,n=[],t=[];e<=s;e++)n[e]=g[0][e],t[e]=v[0][e];for(a.push({x:n,y:t,bicubic:r}),e=0,n=[],t=[];e<=i;e++)n[e]=g[e][s],t[e]=v[e][s];for(a.push({x:n,y:t,bicubic:d}),e=s,n=[],t=[];e>=0;e--)n[s-e]=g[i][e],t[s-e]=v[i][e];for(a.push({x:n,y:t,bicubic:r}),e=i,n=[],t=[];e>=0;e--)n[i-e]=g[e][0],t[i-e]=v[e][0];return a.push({x:n,y:t,bicubic:d}),a}},{}],706:[function(y,ee,Q){"use strict";var g=y("../../plots/cartesian/axes"),v=y("../../lib/extend").extendFlat;ee.exports=function(m,x,e){var n,t,a,r,d,s,i,u,f,c,h,p,o,b,l=m["_"+x],T=m[x+"axis"],_=T._gridlines=[],w=T._minorgridlines=[],k=T._boundarylines=[],L=m["_"+e],M=m[e+"axis"];"array"===T.tickmode&&(T.tickvals=l.slice());var I=m._xctrl,P=m._yctrl,S=I[0].length,E=I.length,z=m._a.length,R=m._b.length;g.prepTicks(T),"array"===T.tickmode&&delete T.tickvals;var q=T.smoothing?3:1;function V(K){var G,Y,$,B,N,U,te,j,J,X,re,ne,le=[],oe=[],de={};if("b"===x)for(Y=m.b2j(K),$=Math.floor(Math.max(0,Math.min(R-2,Y))),B=Y-$,de.length=R,de.crossLength=z,de.xy=function(se){return m.evalxy([],se,Y)},de.dxy=function(se,ge){return m.dxydi([],se,$,ge,B)},G=0;G<z;G++)U=Math.min(z-2,G),te=G-U,j=m.evalxy([],G,Y),M.smoothing&&G>0&&(J=m.dxydi([],G-1,$,0,B),le.push(N[0]+J[0]/3),oe.push(N[1]+J[1]/3),X=m.dxydi([],G-1,$,1,B),le.push(j[0]-X[0]/3),oe.push(j[1]-X[1]/3)),le.push(j[0]),oe.push(j[1]),N=j;else for(G=m.a2i(K),U=Math.floor(Math.max(0,Math.min(z-2,G))),te=G-U,de.length=z,de.crossLength=R,de.xy=function(se){return m.evalxy([],G,se)},de.dxy=function(se,ge){return m.dxydj([],U,se,te,ge)},Y=0;Y<R;Y++)$=Math.min(R-2,Y),B=Y-$,j=m.evalxy([],G,Y),M.smoothing&&Y>0&&(re=m.dxydj([],U,Y-1,te,0),le.push(N[0]+re[0]/3),oe.push(N[1]+re[1]/3),ne=m.dxydj([],U,Y-1,te,1),le.push(j[0]-ne[0]/3),oe.push(j[1]-ne[1]/3)),le.push(j[0]),oe.push(j[1]),N=j;return de.axisLetter=x,de.axis=T,de.crossAxis=M,de.value=K,de.constvar=e,de.index=u,de.x=le,de.y=oe,de.smoothing=M.smoothing,de}function W(K){var G,Y,$,B,N,U=[],te=[],j={};if(j.length=l.length,j.crossLength=L.length,"b"===x)for($=Math.max(0,Math.min(R-2,K)),N=Math.min(1,Math.max(0,K-$)),j.xy=function(J){return m.evalxy([],J,K)},j.dxy=function(J,X){return m.dxydi([],J,$,X,N)},G=0;G<S;G++)U[G]=I[K*q][G],te[G]=P[K*q][G];else for(Y=Math.max(0,Math.min(z-2,K)),B=Math.min(1,Math.max(0,K-Y)),j.xy=function(J){return m.evalxy([],K,J)},j.dxy=function(J,X){return m.dxydj([],Y,J,B,X)},G=0;G<E;G++)U[G]=I[G][K*q],te[G]=P[G][K*q];return j.axisLetter=x,j.axis=T,j.crossAxis=M,j.value=l[K],j.constvar=e,j.index=K,j.x=U,j.y=te,j.smoothing=M.smoothing,j}if("array"===T.tickmode){for(r=5e-15,s=(d=[Math.floor((l.length-1-T.arraytick0)/T.arraydtick*(1+r)),Math.ceil(-T.arraytick0/T.arraydtick/(1+r))].sort(function(K,G){return K-G}))[0]-1,i=d[1]+1,u=s;u<i;u++)(t=T.arraytick0+T.arraydtick*u)<0||t>l.length-1||_.push(v(W(t),{color:T.gridcolor,width:T.gridwidth,dash:T.griddash}));for(u=s;u<i;u++)if(a=T.arraytick0+T.arraydtick*u,h=Math.min(a+T.arraydtick,l.length-1),!(a<0||a>l.length-1||h<0||h>l.length-1))for(p=l[a],o=l[h],n=0;n<T.minorgridcount;n++)(b=h-a)<=0||(c=p+(o-p)*(n+1)/(T.minorgridcount+1)*(T.arraydtick/b))<l[0]||c>l[l.length-1]||w.push(v(V(c),{color:T.minorgridcolor,width:T.minorgridwidth,dash:T.minorgriddash}));T.startline&&k.push(v(W(0),{color:T.startlinecolor,width:T.startlinewidth})),T.endline&&k.push(v(W(l.length-1),{color:T.endlinecolor,width:T.endlinewidth}))}else{for(r=5e-15,s=(d=[Math.floor((l[l.length-1]-T.tick0)/T.dtick*(1+r)),Math.ceil((l[0]-T.tick0)/T.dtick/(1+r))].sort(function(K,G){return K-G}))[0],i=d[1],u=s;u<=i;u++)_.push(v(V(f=T.tick0+T.dtick*u),{color:T.gridcolor,width:T.gridwidth,dash:T.griddash}));for(u=s-1;u<i+1;u++)for(f=T.tick0+T.dtick*u,n=0;n<T.minorgridcount;n++)(c=f+T.dtick*(n+1)/(T.minorgridcount+1))<l[0]||c>l[l.length-1]||w.push(v(V(c),{color:T.minorgridcolor,width:T.minorgridwidth,dash:T.minorgriddash}));T.startline&&k.push(v(V(l[0]),{color:T.startlinecolor,width:T.startlinewidth})),T.endline&&k.push(v(V(l[l.length-1]),{color:T.endlinecolor,width:T.endlinewidth}))}}},{"../../lib/extend":505,"../../plots/cartesian/axes":566}],707:[function(y,ee,Q){"use strict";var g=y("../../plots/cartesian/axes"),v=y("../../lib/extend").extendFlat;ee.exports=function(m,x){var e,n,t,a=x._labels=[],r=x._gridlines;for(e=0;e<r.length;e++)t=r[e],-1!==["start","both"].indexOf(x.showticklabels)&&(n=g.tickText(x,t.value),v(n,{prefix:void 0,suffix:void 0,endAnchor:!0,xy:t.xy(0),dxy:t.dxy(0,0),axis:t.axis,length:t.crossAxis.length,font:t.axis.tickfont,isFirst:0===e,isLast:e===r.length-1}),a.push(n)),-1!==["end","both"].indexOf(x.showticklabels)&&(n=g.tickText(x,t.value),v(n,{endAnchor:!1,xy:t.xy(t.crossLength-1),dxy:t.dxy(t.crossLength-2,1),axis:t.axis,length:t.crossAxis.length,font:t.axis.tickfont,isFirst:0===e,isLast:e===r.length-1}),a.push(n))}},{"../../lib/extend":505,"../../plots/cartesian/axes":566}],708:[function(y,ee,Q){"use strict";ee.exports=function(g,v,m,x){var e=g[0]-v[0],n=g[1]-v[1],t=m[0]-v[0],a=m[1]-v[1],r=Math.pow(e*e+n*n,.25),d=Math.pow(t*t+a*a,.25),s=(d*d*e-r*r*t)*x,i=(d*d*n-r*r*a)*x,u=d*(r+d)*3,f=r*(r+d)*3;return[[v[0]+(u&&s/u),v[1]+(u&&i/u)],[v[0]-(f&&s/f),v[1]-(f&&i/f)]]}},{}],709:[function(y,ee,Q){"use strict";var g=y("../../lib").isArrayOrTypedArray;ee.exports=function(v,m,x){var e,n,t,a,r,d,s=[],i=g(v)?v.length:v,u=g(m)?m.length:m,f=g(v)?v:null,c=g(m)?m:null;f&&(t=(f.length-1)/(f[f.length-1]-f[0])/(i-1)),c&&(a=(c.length-1)/(c[c.length-1]-c[0])/(u-1));var h=1/0,p=-1/0;for(n=0;n<u;n++)for(s[n]=[],r=c?(c[n]-c[0])*a:n/(u-1),e=0;e<i;e++)d=(f?(f[e]-f[0])*t:e/(i-1))-r*x,h=Math.min(d,h),p=Math.max(d,p),s[n][e]=d;var o=1/(p-h),b=-h*o;for(n=0;n<u;n++)for(e=0;e<i;e++)s[n][e]=o*s[n][e]+b;return s}},{"../../lib":515}],710:[function(y,ee,Q){"use strict";var g=y("./catmull_rom"),v=y("../../lib").ensureArray;function m(x,e,n){return[(2*(-.5*n[0]+1.5*e[0])+x[0])/3,(2*(-.5*n[1]+1.5*e[1])+x[1])/3]}ee.exports=function(x,e,n,t,a,r){var d,s,i,u,f,c,h,p,o,b,l=n[0].length,T=n.length,_=a?3*l-2:l,w=r?3*T-2:T;for(x=v(x,w),e=v(e,w),i=0;i<w;i++)x[i]=v(x[i],_),e[i]=v(e[i],_);for(s=0,u=0;s<T;s++,u+=r?3:1)for(f=x[u],c=e[u],h=n[s],p=t[s],d=0,i=0;d<l;d++,i+=a?3:1)f[i]=h[d],c[i]=p[d];if(a)for(s=0,u=0;s<T;s++,u+=r?3:1){for(d=1,i=3;d<l-1;d++,i+=3)o=g([n[s][d-1],t[s][d-1]],[n[s][d],t[s][d]],[n[s][d+1],t[s][d+1]],a),x[u][i-1]=o[0][0],e[u][i-1]=o[0][1],x[u][i+1]=o[1][0],e[u][i+1]=o[1][1];b=m([x[u][0],e[u][0]],[x[u][2],e[u][2]],[x[u][3],e[u][3]]),x[u][1]=b[0],e[u][1]=b[1],b=m([x[u][_-1],e[u][_-1]],[x[u][_-3],e[u][_-3]],[x[u][_-4],e[u][_-4]]),x[u][_-2]=b[0],e[u][_-2]=b[1]}if(r)for(i=0;i<_;i++){for(u=3;u<w-3;u+=3)o=g([x[u-3][i],e[u-3][i]],[x[u][i],e[u][i]],[x[u+3][i],e[u+3][i]],r),x[u-1][i]=o[0][0],e[u-1][i]=o[0][1],x[u+1][i]=o[1][0],e[u+1][i]=o[1][1];b=m([x[0][i],e[0][i]],[x[2][i],e[2][i]],[x[3][i],e[3][i]]),x[1][i]=b[0],e[1][i]=b[1],b=m([x[w-1][i],e[w-1][i]],[x[w-3][i],e[w-3][i]],[x[w-4][i],e[w-4][i]]),x[w-2][i]=b[0],e[w-2][i]=b[1]}if(a&&r)for(u=1;u<w;u+=(u+1)%3==0?2:1){for(i=3;i<_-3;i+=3)o=g([x[u][i-3],e[u][i-3]],[x[u][i],e[u][i]],[x[u][i+3],e[u][i+3]],a),x[u][i-1]=.5*(x[u][i-1]+o[0][0]),e[u][i-1]=.5*(e[u][i-1]+o[0][1]),x[u][i+1]=.5*(x[u][i+1]+o[1][0]),e[u][i+1]=.5*(e[u][i+1]+o[1][1]);b=m([x[u][0],e[u][0]],[x[u][2],e[u][2]],[x[u][3],e[u][3]]),x[u][1]=.5*(x[u][1]+b[0]),e[u][1]=.5*(e[u][1]+b[1]),b=m([x[u][_-1],e[u][_-1]],[x[u][_-3],e[u][_-3]],[x[u][_-4],e[u][_-4]]),x[u][_-2]=.5*(x[u][_-2]+b[0]),e[u][_-2]=.5*(e[u][_-2]+b[1])}return[x,e]}},{"../../lib":515,"./catmull_rom":708}],711:[function(y,ee,Q){"use strict";ee.exports={RELATIVE_CULL_TOLERANCE:1e-6}},{}],712:[function(y,ee,Q){"use strict";ee.exports=function(g,v,m){return v&&m?function(x,e,n,t,a){var r,u,f;x||(x=[]),e*=3,n*=3;var c=t*t,h=1-t,p=h*h,o=h*t*2,b=-3*p,l=3*(p-o),T=3*(o-c),_=3*c,w=a*a,k=w*a,L=1-a,M=L*L,I=M*L;for(f=0;f<g.length;f++)r=b*(u=g[f])[n][e]+l*u[n][e+1]+T*u[n][e+2]+_*u[n][e+3],x[f]=I*r+3*(M*a*(b*u[n+1][e]+l*u[n+1][e+1]+T*u[n+1][e+2]+_*u[n+1][e+3])+L*w*(b*u[n+2][e]+l*u[n+2][e+1]+T*u[n+2][e+2]+_*u[n+2][e+3]))+k*(b*u[n+3][e]+l*u[n+3][e+1]+T*u[n+3][e+2]+_*u[n+3][e+3]);return x}:v?function(x,e,n,t,a){var r,s,i;x||(x=[]),e*=3;var u=t*t,f=1-t,c=f*f,h=f*t*2,p=-3*c,o=3*(c-h),b=3*(h-u),l=3*u,T=1-a;for(s=0;s<g.length;s++)r=p*(i=g[s])[n][e]+o*i[n][e+1]+b*i[n][e+2]+l*i[n][e+3],x[s]=T*r+a*(p*i[n+1][e]+o*i[n+1][e+1]+b*i[n+1][e+2]+l*i[n+1][e+3]);return x}:m?function(x,e,n,t,a){var r,u,f;x||(x=[]),n*=3;var c=a*a,h=c*a,p=1-a,o=p*p,b=o*p;for(u=0;u<g.length;u++)r=(f=g[u])[n][e+1]-f[n][e],x[u]=b*r+3*(o*a*(f[n+1][e+1]-f[n+1][e])+p*c*(f[n+2][e+1]-f[n+2][e]))+h*(f[n+3][e+1]-f[n+3][e]);return x}:function(x,e,n,t,a){var r,s,i;x||(x=[]);var u=1-a;for(s=0;s<g.length;s++)r=(i=g[s])[n][e+1]-i[n][e],x[s]=u*r+a*(i[n+1][e+1]-i[n+1][e]);return x}}},{}],713:[function(y,ee,Q){"use strict";ee.exports=function(g,v,m){return v&&m?function(x,e,n,t,a){var r,u,f;x||(x=[]),e*=3,n*=3;var c=t*t,h=c*t,p=1-t,o=p*p,b=o*p,l=a*a,T=1-a,_=T*T,w=T*a*2,k=-3*_,L=3*(_-w),M=3*(w-l),I=3*l;for(f=0;f<g.length;f++)r=k*(u=g[f])[n][e]+L*u[n+1][e]+M*u[n+2][e]+I*u[n+3][e],x[f]=b*r+3*(o*t*(k*u[n][e+1]+L*u[n+1][e+1]+M*u[n+2][e+1]+I*u[n+3][e+1])+p*c*(k*u[n][e+2]+L*u[n+1][e+2]+M*u[n+2][e+2]+I*u[n+3][e+2]))+h*(k*u[n][e+3]+L*u[n+1][e+3]+M*u[n+2][e+3]+I*u[n+3][e+3]);return x}:v?function(x,e,n,t,a){var r,u,f;x||(x=[]),e*=3;var c=a*a,h=c*a,p=1-a,o=p*p,b=o*p;for(u=0;u<g.length;u++)r=(f=g[u])[n+1][e]-f[n][e],x[u]=b*r+3*(o*a*(f[n+1][e+1]-f[n][e+1])+p*c*(f[n+1][e+2]-f[n][e+2]))+h*(f[n+1][e+3]-f[n][e+3]);return x}:m?function(x,e,n,t,a){var r,s,i;x||(x=[]),n*=3;var u=1-t,f=a*a,c=1-a,h=c*c,p=c*a*2,o=-3*h,b=3*(h-p),l=3*(p-f),T=3*f;for(s=0;s<g.length;s++)r=o*(i=g[s])[n][e]+b*i[n+1][e]+l*i[n+2][e]+T*i[n+3][e],x[s]=u*r+t*(o*i[n][e+1]+b*i[n+1][e+1]+l*i[n+2][e+1]+T*i[n+3][e+1]);return x}:function(x,e,n,t,a){var r,s,i;x||(x=[]);var u=1-t;for(s=0;s<g.length;s++)r=(i=g[s])[n+1][e]-i[n][e],x[s]=u*r+t*(i[n+1][e+1]-i[n][e+1]);return x}}},{}],714:[function(y,ee,Q){"use strict";ee.exports=function(g,v,m,x,e){var n=v-2,t=m-2;return x&&e?function(a,r,d){var s,c,h;a||(a=[]);var p=Math.max(0,Math.min(Math.floor(r),n)),o=Math.max(0,Math.min(Math.floor(d),t)),b=Math.max(0,Math.min(1,r-p)),l=Math.max(0,Math.min(1,d-o));p*=3,o*=3;var T=b*b,_=T*b,w=1-b,k=w*w,L=k*w,M=l*l,I=M*l,P=1-l,S=P*P,E=S*P;for(h=0;h<g.length;h++)s=L*(c=g[h])[o][p]+3*(k*b*c[o][p+1]+w*T*c[o][p+2])+_*c[o][p+3],a[h]=E*s+3*(S*l*(L*c[o+1][p]+3*(k*b*c[o+1][p+1]+w*T*c[o+1][p+2])+_*c[o+1][p+3])+P*M*(L*c[o+2][p]+3*(k*b*c[o+2][p+1]+w*T*c[o+2][p+2])+_*c[o+2][p+3]))+I*(L*c[o+3][p]+3*(k*b*c[o+3][p+1]+w*T*c[o+3][p+2])+_*c[o+3][p+3]);return a}:x?function(a,r,d){a||(a=[]);var s,c,h,p=Math.max(0,Math.min(Math.floor(r),n)),o=Math.max(0,Math.min(Math.floor(d),t)),b=Math.max(0,Math.min(1,r-p)),l=Math.max(0,Math.min(1,d-o));p*=3;var T=b*b,_=T*b,w=1-b,k=w*w,L=k*w,M=1-l;for(c=0;c<g.length;c++)s=M*(h=g[c])[o][p]+l*h[o+1][p],a[c]=L*s+3*(k*b*(M*h[o][p+1]+l*h[o+1][p+1])+w*T*(M*h[o][p+2]+l*h[o+1][p+1]))+_*(M*h[o][p+3]+l*h[o+1][p+1]);return a}:e?function(a,r,d){a||(a=[]);var s,c,h,p=Math.max(0,Math.min(Math.floor(r),n)),o=Math.max(0,Math.min(Math.floor(d),t)),b=Math.max(0,Math.min(1,r-p)),l=Math.max(0,Math.min(1,d-o));o*=3;var T=l*l,_=T*l,w=1-l,k=w*w,L=k*w,M=1-b;for(c=0;c<g.length;c++)s=M*(h=g[c])[o][p]+b*h[o][p+1],a[c]=L*s+3*(k*l*(M*h[o+1][p]+b*h[o+1][p+1])+w*T*(M*h[o+2][p]+b*h[o+2][p+1]))+_*(M*h[o+3][p]+b*h[o+3][p+1]);return a}:function(a,r,d){a||(a=[]);var s,u,f,c=Math.max(0,Math.min(Math.floor(r),n)),h=Math.max(0,Math.min(Math.floor(d),t)),p=Math.max(0,Math.min(1,r-c)),o=Math.max(0,Math.min(1,d-h)),b=1-o,l=1-p;for(u=0;u<g.length;u++)s=l*(f=g[u])[h][c]+p*f[h][c+1],a[u]=b*s+o*(l*f[h+1][c]+p*f[h+1][c+1]);return a}}},{}],715:[function(y,ee,Q){"use strict";var g=y("../../lib"),v=y("./xy_defaults"),m=y("./ab_defaults"),x=y("./attributes"),e=y("../../components/color/attributes");ee.exports=function(n,t,a,r){function d(i,u){return g.coerce(n,t,x,i,u)}t._clipPathId="clip"+t.uid+"carpet";var s=d("color",e.defaultLine);g.coerceFont(d,"font"),d("carpet"),m(n,t,r,d,s),t.a&&t.b?(t.a.length<3&&(t.aaxis.smoothing=0),t.b.length<3&&(t.baxis.smoothing=0),v(n,t,d)||(t.visible=!1),t._cheater&&d("cheaterslope")):t.visible=!1}},{"../../components/color/attributes":366,"../../lib":515,"./ab_defaults":698,"./attributes":700,"./xy_defaults":724}],716:[function(y,ee,Q){"use strict";ee.exports={attributes:y("./attributes"),supplyDefaults:y("./defaults"),plot:y("./plot"),calc:y("./calc"),animatable:!0,isContainer:!0,moduleType:"trace",name:"carpet",basePlotModule:y("../../plots/cartesian"),categories:["cartesian","svg","carpet","carpetAxis","notLegendIsolatable","noMultiCategory","noHover","noSortingByValue"],meta:{}}},{"../../plots/cartesian":578,"./attributes":700,"./calc":704,"./defaults":715,"./plot":721}],717:[function(y,ee,Q){"use strict";ee.exports=function(g,v){for(var m,x=g._fullData.length,e=0;e<x;e++){var n=g._fullData[e];if(n.index!==v.index&&"carpet"===n.type&&(m||(m=n),n.carpet===v.carpet))return n}return m}},{}],718:[function(y,ee,Q){"use strict";ee.exports=function(g,v,m){if(0===g.length)return"";var x,e=[],n=m?3:1;for(x=0;x<g.length;x+=n)e.push(g[x]+","+v[x]),m&&x<g.length-n&&(e.push("C"),e.push([g[x+1]+","+v[x+1],g[x+2]+","+v[x+2]+" "].join(" ")));return e.join(m?"":"L")}},{}],719:[function(y,ee,Q){"use strict";var g=y("../../lib").isArrayOrTypedArray;ee.exports=function(v,m,x){var e;for(g(v)?v.length>m.length&&(v=v.slice(0,m.length)):v=[],e=0;e<m.length;e++)v[e]=x(m[e]);return v}},{"../../lib":515}],720:[function(y,ee,Q){"use strict";ee.exports=function(g,v,m,x,e,n){var t=e[0]*g.dpdx(v),a=e[1]*g.dpdy(m),r=1,d=1;if(n){var s=Math.sqrt(e[0]*e[0]+e[1]*e[1]),i=Math.sqrt(n[0]*n[0]+n[1]*n[1]);d=Math.max(0,(e[0]*n[0]+e[1]*n[1])/s/i)}var f=180*Math.atan2(a,t)/Math.PI;return f<-90?(f+=180,r=-r):f>90&&(f-=180,r=-r),{angle:f,flip:r,p:g.c2p(x,v,m),offsetMultplier:d}}},{}],721:[function(y,ee,Q){"use strict";var g=y("@plotly/d3"),v=y("../../components/drawing"),m=y("./map_1d_array"),x=y("./makepath"),e=y("./orient_text"),n=y("../../lib/svg_text_utils"),t=y("../../lib"),a=t.strRotate,r=t.strTranslate,d=y("../../constants/alignment");function s(h,p,o,b,l,T){var _="const-"+l+"-lines",w=o.selectAll("."+_).data(T);w.enter().append("path").classed(_,!0).style("vector-effect","non-scaling-stroke"),w.each(function(k){var L=k,I=L.y,P=m([],L.x,h.c2p),S=m([],I,p.c2p),E="M"+x(P,S,L.smoothing);g.select(this).attr("d",E).style("stroke-width",L.width).style("stroke",L.color).style("stroke-dasharray",v.dashStyle(L.dash,L.width)).style("fill","none")}),w.exit().remove()}function i(h,p,o,b,l,T,_,w){var k=T.selectAll("text."+w).data(_);k.enter().append("text").classed(w,!0);var L=0,M={};return k.each(function(I,P){var S;if("auto"===I.axis.tickangle)S=e(b,p,o,I.xy,I.dxy);else{var E=(I.axis.tickangle+180)*Math.PI/180;S=e(b,p,o,I.xy,[Math.cos(E),Math.sin(E)])}P||(M={angle:S.angle,flip:S.flip});var z=(I.endAnchor?-1:1)*S.flip,R=g.select(this).attr({"text-anchor":z>0?"start":"end","data-notex":1}).call(v.font,I.font).text(I.text).call(n.convertToTspans,h),q=v.bBox(this);R.attr("transform",r(S.p[0],S.p[1])+a(S.angle)+r(I.axis.labelpadding*z,.3*q.height)),L=Math.max(L,q.width+I.axis.labelpadding)}),k.exit().remove(),M.maxExtent=L,M}ee.exports=function(h,p,o,b){var l=p.xaxis,T=p.yaxis,_=h._fullLayout._clips;t.makeTraceGroups(b,o,"trace").each(function(w){var k=g.select(this),L=w[0],M=L.trace,I=M.aaxis,P=M.baxis,S=t.ensureSingle(k,"g","minorlayer"),E=t.ensureSingle(k,"g","majorlayer"),z=t.ensureSingle(k,"g","boundarylayer"),R=t.ensureSingle(k,"g","labellayer");k.style("opacity",M.opacity),s(l,T,E,0,"a",I._gridlines),s(l,T,E,0,"b",P._gridlines),s(l,T,S,0,"a",I._minorgridlines),s(l,T,S,0,"b",P._minorgridlines),s(l,T,z,0,"a-boundary",I._boundarylines),s(l,T,z,0,"b-boundary",P._boundarylines);var W,K,G,$,B,N,U,te,j,J,X,re,ne,le,oe,q=i(h,l,T,M,0,R,I._labels,"a-label"),V=i(h,l,T,M,0,R,P._labels,"b-label");W=h,K=R,G=M,$=l,B=T,N=q,U=V,re=t.aggNums(Math.min,null,G.a),ne=t.aggNums(Math.max,null,G.a),le=t.aggNums(Math.min,null,G.b),oe=t.aggNums(Math.max,null,G.b),J=G.ab2xy(te=.5*(re+ne),j=le,!0),X=G.dxyda_rough(te,j),void 0===N.angle&&t.extendFlat(N,e(G,$,B,J,G.dxydb_rough(te,j))),c(W,K,G,0,J,X,G.aaxis,$,B,N,"a-title"),J=G.ab2xy(te=re,j=.5*(le+oe),!0),X=G.dxydb_rough(te,j),void 0===U.angle&&t.extendFlat(U,e(G,$,B,J,G.dxyda_rough(te,j))),c(W,K,G,0,J,X,G.baxis,$,B,U,"b-title"),function(W,K,G,Y,$){var B,N,U,te,j=G.select("#"+W._clipPathId);j.size()||(j=G.append("clipPath").classed("carpetclip",!0));var J=t.ensureSingle(j,"path","carpetboundary"),X=K.clipsegments,re=[];for(te=0;te<X.length;te++)N=m([],(B=X[te]).x,Y.c2p),U=m([],B.y,$.c2p),re.push(x(N,U,B.bicubic));var ne="M"+re.join("L")+"Z";j.attr("id",W._clipPathId),J.attr("d",ne)}(M,L,_,l,T)})};var u=d.LINE_SPACING,f=(1-d.MID_SHIFT)/u+1;function c(h,p,o,b,l,T,_,w,k,L,M){var I=[];_.title.text&&I.push(_.title.text);var P=p.selectAll("text."+M).data(I),S=L.maxExtent;P.enter().append("text").classed(M,!0),P.each(function(){var E=e(o,w,k,l,T);-1===["start","both"].indexOf(_.showticklabels)&&(S=0);var z=_.title.font.size;S+=z+_.title.offset;var R=(L.angle+(L.flip<0?180:0)-E.angle+450)%360,q=R>90&&R<270,V=g.select(this);V.text(_.title.text).call(n.convertToTspans,h),q&&(S=(-n.lineCount(V)+f)*u*z-S),V.attr("transform",r(E.p[0],E.p[1])+a(E.angle)+r(0,S)).attr("text-anchor","middle").call(v.font,_.title.font)}),P.exit().remove()}},{"../../components/drawing":389,"../../constants/alignment":483,"../../lib":515,"../../lib/svg_text_utils":541,"./makepath":718,"./map_1d_array":719,"./orient_text":720,"@plotly/d3":58}],722:[function(y,ee,Q){"use strict";var g=y("./constants"),v=y("../../lib/search").findBin,m=y("./compute_control_points"),x=y("./create_spline_evaluator"),e=y("./create_i_derivative_evaluator"),n=y("./create_j_derivative_evaluator");ee.exports=function(t){var a=t._a,r=t._b,d=a.length,s=r.length,i=t.aaxis,u=t.baxis,f=a[0],c=a[d-1],h=r[0],p=r[s-1],o=a[a.length-1]-a[0],b=r[r.length-1]-r[0],l=o*g.RELATIVE_CULL_TOLERANCE,T=b*g.RELATIVE_CULL_TOLERANCE;f-=l,c+=l,h-=T,p+=T,t.isVisible=function(_,w){return _>f&&_<c&&w>h&&w<p},t.isOccluded=function(_,w){return _<f||_>c||w<h||w>p},t.setScale=function(){var k=m(t._xctrl,t._yctrl,t._x,t._y,i.smoothing,u.smoothing);t._xctrl=k[0],t._yctrl=k[1],t.evalxy=x([t._xctrl,t._yctrl],d,s,i.smoothing,u.smoothing),t.dxydi=e([t._xctrl,t._yctrl],i.smoothing,u.smoothing),t.dxydj=n([t._xctrl,t._yctrl],i.smoothing,u.smoothing)},t.i2a=function(_){var w=Math.max(0,Math.floor(_[0]),d-2),k=_[0]-w;return(1-k)*a[w]+k*a[w+1]},t.j2b=function(_){var w=Math.max(0,Math.floor(_[1]),d-2),k=_[1]-w;return(1-k)*r[w]+k*r[w+1]},t.ij2ab=function(_){return[t.i2a(_[0]),t.j2b(_[1])]},t.a2i=function(_){var w=Math.max(0,Math.min(v(_,a),d-2)),k=a[w];return Math.max(0,Math.min(d-1,w+(_-k)/(a[w+1]-k)))},t.b2j=function(_){var w=Math.max(0,Math.min(v(_,r),s-2)),k=r[w];return Math.max(0,Math.min(s-1,w+(_-k)/(r[w+1]-k)))},t.ab2ij=function(_){return[t.a2i(_[0]),t.b2j(_[1])]},t.i2c=function(_,w){return t.evalxy([],_,w)},t.ab2xy=function(_,w,k){if(!k&&(_<a[0]||_>a[d-1]|w<r[0]||w>r[s-1]))return[!1,!1];var L=t.a2i(_),M=t.b2j(w),I=t.evalxy([],L,M);if(k){var P,S,E,z,R=0,q=0,V=[];_<a[0]?(P=0,S=0,R=(_-a[0])/(a[1]-a[0])):_>a[d-1]?(P=d-2,S=1,R=(_-a[d-1])/(a[d-1]-a[d-2])):S=L-(P=Math.max(0,Math.min(d-2,Math.floor(L)))),w<r[0]?(E=0,z=0,q=(w-r[0])/(r[1]-r[0])):w>r[s-1]?(E=s-2,z=1,q=(w-r[s-1])/(r[s-1]-r[s-2])):z=M-(E=Math.max(0,Math.min(s-2,Math.floor(M)))),R&&(t.dxydi(V,P,E,S,z),I[0]+=V[0]*R,I[1]+=V[1]*R),q&&(t.dxydj(V,P,E,S,z),I[0]+=V[0]*q,I[1]+=V[1]*q)}return I},t.c2p=function(_,w,k){return[w.c2p(_[0]),k.c2p(_[1])]},t.p2x=function(_,w,k){return[w.p2c(_[0]),k.p2c(_[1])]},t.dadi=function(_){var w=Math.max(0,Math.min(a.length-2,_));return a[w+1]-a[w]},t.dbdj=function(_){var w=Math.max(0,Math.min(r.length-2,_));return r[w+1]-r[w]},t.dxyda=function(_,w,k,L){var M=t.dxydi(null,_,w,k,L),I=t.dadi(_,k);return[M[0]/I,M[1]/I]},t.dxydb=function(_,w,k,L){var M=t.dxydj(null,_,w,k,L),I=t.dbdj(w,L);return[M[0]/I,M[1]/I]},t.dxyda_rough=function(_,w,k){var L=o*(k||.1),M=t.ab2xy(_+L,w,!0),I=t.ab2xy(_-L,w,!0);return[.5*(M[0]-I[0])/L,.5*(M[1]-I[1])/L]},t.dxydb_rough=function(_,w,k){var L=b*(k||.1),M=t.ab2xy(_,w+L,!0),I=t.ab2xy(_,w-L,!0);return[.5*(M[0]-I[0])/L,.5*(M[1]-I[1])/L]},t.dpdx=function(_){return _._m},t.dpdy=function(_){return _._m}}},{"../../lib/search":535,"./compute_control_points":710,"./constants":711,"./create_i_derivative_evaluator":712,"./create_j_derivative_evaluator":713,"./create_spline_evaluator":714}],723:[function(y,ee,Q){"use strict";var g=y("../../lib");ee.exports=function(v,m,x){var e,n,t,a=[],r=[],d=v[0].length,s=v.length;var u,f,c,h,p,o,b,l,T,_,K,G,Y,$,B,k=0;for(e=0;e<d;e++)for(n=0;n<s;n++)void 0===v[n][e]&&(a.push(e),r.push(n),v[n][e]=(G=n,Y=void 0,$=void 0,B=void 0,$=0,B=0,(K=e)>0&&void 0!==(Y=v[G][K-1])&&(B++,$+=Y),K<d-1&&void 0!==(Y=v[G][K+1])&&(B++,$+=Y),G>0&&void 0!==(Y=v[G-1][K])&&(B++,$+=Y),G<s-1&&void 0!==(Y=v[G+1][K])&&(B++,$+=Y),$/Math.max(1,B))),k=Math.max(k,Math.abs(v[n][e]));if(!a.length)return v;var L=0,M=0,I=a.length;do{for(L=0,t=0;t<I;t++){n=r[t];var S,E,z,R,q,V=0,W=0;0===(e=a[t])?(E=m[R=Math.min(d-1,2)],W+=(S=v[n][1])+(S-v[n][R])*(m[0]-(z=m[1]))/(z-E),V++):e===d-1&&(E=m[R=Math.max(0,d-3)],W+=(S=v[n][d-2])+(S-v[n][R])*(m[d-1]-(z=m[d-2]))/(z-E),V++),(0===e||e===d-1)&&n>0&&n<s-1&&(W+=((f=x[n]-x[n-1])*v[n+1][e]+(u=x[n+1]-x[n])*v[n-1][e])/(f+u),V++),0===n?(E=x[q=Math.min(s-1,2)],W+=(S=v[1][e])+(S-v[q][e])*(x[0]-(z=x[1]))/(z-E),V++):n===s-1&&(E=x[q=Math.max(0,s-3)],W+=(S=v[s-2][e])+(S-v[q][e])*(x[s-1]-(z=x[s-2]))/(z-E),V++),(0===n||n===s-1)&&e>0&&e<d-1&&(W+=((f=m[e]-m[e-1])*v[n][e+1]+(u=m[e+1]-m[e])*v[n][e-1])/(f+u),V++),V?W/=V:(l=(p=x[n+1]-x[n])*(o=x[n]-x[n-1])*(p+o),W=((b=(c=m[e+1]-m[e])*(h=m[e]-m[e-1])*(c+h))*(o*v[n+1][e]+p*v[n-1][e])+l*(h*v[n][e+1]+c*v[n][e-1]))/(l*(h+c)+b*(o+p))),L+=(_=(T=W-v[n][e])/k)*_,v[n][e]+=T*(1+(V?0:.85))}L=Math.sqrt(L)}while(M++<100&&L>1e-5);return g.log("Smoother converged to",L,"after",M,"iterations"),v}},{"../../lib":515}],724:[function(y,ee,Q){"use strict";var g=y("../../lib").isArray1D;ee.exports=function(v,m,x){var e=x("x"),n=e&&e.length,t=x("y"),a=t&&t.length;if(!n&&!a)return!1;if(m._cheater=!e,n&&!g(e)||a&&!g(t))m._length=null;else{var r=n?e.length:1/0;a&&(r=Math.min(r,t.length)),m.a&&m.a.length&&(r=Math.min(r,m.a.length)),m.b&&m.b.length&&(r=Math.min(r,m.b.length)),m._length=r}return!0}},{"../../lib":515}],725:[function(y,ee,Q){"use strict";var g=y("../../plots/template_attributes").hovertemplateAttrs,v=y("../scattergeo/attributes"),m=y("../../components/colorscale/attributes"),x=y("../../plots/attributes"),e=y("../../components/color/attributes").defaultLine,n=y("../../lib/extend").extendFlat,t=v.marker.line;ee.exports=n({locations:{valType:"data_array",editType:"calc"},locationmode:v.locationmode,z:{valType:"data_array",editType:"calc"},geojson:n({},v.geojson,{}),featureidkey:v.featureidkey,text:n({},v.text,{}),hovertext:n({},v.hovertext,{}),marker:{line:{color:n({},t.color,{dflt:e}),width:n({},t.width,{dflt:1}),editType:"calc"},opacity:{valType:"number",arrayOk:!0,min:0,max:1,dflt:1,editType:"style"},editType:"calc"},selected:{marker:{opacity:v.selected.marker.opacity,editType:"plot"},editType:"plot"},unselected:{marker:{opacity:v.unselected.marker.opacity,editType:"plot"},editType:"plot"},hoverinfo:n({},x.hoverinfo,{editType:"calc",flags:["location","z","text","name"]}),hovertemplate:g(),showlegend:n({},x.showlegend,{dflt:!1})},m("",{cLetter:"z",editTypeOverride:"calc"}))},{"../../components/color/attributes":366,"../../components/colorscale/attributes":374,"../../lib/extend":505,"../../plots/attributes":562,"../../plots/template_attributes":642,"../scattergeo/attributes":978}],726:[function(y,ee,Q){"use strict";var g=y("fast-isnumeric"),v=y("../../constants/numerical").BADNUM,m=y("../../components/colorscale/calc"),x=y("../scatter/arrays_to_calcdata"),e=y("../scatter/calc_selection");function n(t){return t&&"string"==typeof t}ee.exports=function(t,a){var r,d=a._length,s=new Array(d);r=a.geojson?function(h){return n(h)||g(h)}:n;for(var i=0;i<d;i++){var u=s[i]={},f=a.locations[i],c=a.z[i];r(f)&&g(c)?(u.loc=f,u.z=c):(u.loc=null,u.z=v),u.index=i}return x(s,a),m(t,a,{vals:a.z,containerStr:"",cLetter:"z"}),e(s,a),s}},{"../../components/colorscale/calc":375,"../../constants/numerical":491,"../scatter/arrays_to_calcdata":935,"../scatter/calc_selection":938,"fast-isnumeric":190}],727:[function(y,ee,Q){"use strict";var g=y("../../lib"),v=y("../../components/colorscale/defaults"),m=y("./attributes");ee.exports=function(x,e,n,t){function a(u,f){return g.coerce(x,e,m,u,f)}var r=a("locations"),d=a("z");if(r&&r.length&&g.isArrayOrTypedArray(d)&&d.length){e._length=Math.min(r.length,d.length);var s,i=a("geojson");("string"==typeof i&&""!==i||g.isPlainObject(i))&&(s="geojson-id"),"geojson-id"===a("locationmode",s)&&a("featureidkey"),a("text"),a("hovertext"),a("hovertemplate"),a("marker.line.width")&&a("marker.line.color"),a("marker.opacity"),v(x,e,t,a,{prefix:"",cLetter:"z"}),g.coerceSelectionMarkerOpacity(e,a)}else e.visible=!1}},{"../../components/colorscale/defaults":377,"../../lib":515,"./attributes":725}],728:[function(y,ee,Q){"use strict";ee.exports=function(g,v,m,x,e){g.location=v.location,g.z=v.z;var n=x[e];return n.fIn&&n.fIn.properties&&(g.properties=n.fIn.properties),g.ct=n.ct,g}},{}],729:[function(y,ee,Q){"use strict";var g=y("../../plots/cartesian/axes"),v=y("./attributes"),m=y("../../lib").fillText;ee.exports=function(x,e,n){var t,a,r,d,s=x.cd,i=s[0].trace,u=x.subplot,f=[e,n],c=[e+360,n];for(a=0;a<s.length;a++)if(d=!1,(t=s[a])._polygons){for(r=0;r<t._polygons.length;r++)t._polygons[r].contains(f)&&(d=!d),t._polygons[r].contains(c)&&(d=!d);if(d)break}if(d&&t)return x.x0=x.x1=x.xa.c2p(t.ct),x.y0=x.y1=x.ya.c2p(t.ct),x.index=t.index,x.location=t.loc,x.z=t.z,x.zLabel=g.tickText(u.mockAxis,u.mockAxis.c2l(t.z),"hover").text,x.hovertemplate=t.hovertemplate,function(h,p,o){if(!p.hovertemplate){var b=o.hi||p.hoverinfo,l=String(o.loc),T="all"===b?v.hoverinfo.flags:b.split("+"),_=-1!==T.indexOf("name"),w=-1!==T.indexOf("location"),k=-1!==T.indexOf("z"),L=-1!==T.indexOf("text"),M=[];!_&&w?h.nameOverride=l:(_&&(h.nameOverride=p.name),w&&M.push(l)),k&&M.push(h.zLabel),L&&m(o,p,M),h.extraText=M.join("<br>")}}(x,i,t),[x]}},{"../../lib":515,"../../plots/cartesian/axes":566,"./attributes":725}],730:[function(y,ee,Q){"use strict";ee.exports={attributes:y("./attributes"),supplyDefaults:y("./defaults"),colorbar:y("../heatmap/colorbar"),calc:y("./calc"),calcGeoJSON:y("./plot").calcGeoJSON,plot:y("./plot").plot,style:y("./style").style,styleOnSelect:y("./style").styleOnSelect,hoverPoints:y("./hover"),eventData:y("./event_data"),selectPoints:y("./select"),moduleType:"trace",name:"choropleth",basePlotModule:y("../../plots/geo"),categories:["geo","noOpacity","showLegend"],meta:{}}},{"../../plots/geo":598,"../heatmap/colorbar":804,"./attributes":725,"./calc":726,"./defaults":727,"./event_data":728,"./hover":729,"./plot":731,"./select":732,"./style":733}],731:[function(y,ee,Q){"use strict";var g=y("@plotly/d3"),v=y("../../lib"),m=y("../../lib/geo_location_utils"),x=y("../../lib/topojson_utils").getTopojsonFeatures,e=y("../../plots/cartesian/autorange").findExtremes,n=y("./style").style;ee.exports={calcGeoJSON:function(t,a){for(var r=t[0].trace,d=a[r.geo],s=d._subplot,i=r.locationmode,u=r._length,f="geojson-id"===i?m.extractTraceFeature(t):x(r,s.topojson),c=[],h=[],p=0;p<u;p++){var o=t[p],b="geojson-id"===i?o.fOut:m.locationToFeature(i,o.loc,f);if(b){o.geojson=b,o.ct=b.properties.ct,o._polygons=m.feature2polygons(b);var l=m.computeBbox(b);c.push(l[0],l[2]),h.push(l[1],l[3])}else o.geojson=null}if("geojson"===d.fitbounds&&"geojson-id"===i){var T=m.computeBbox(m.getTraceGeojson(r));c=[T[0],T[2]],h=[T[1],T[3]]}var _={padded:!0};r._extremes.lon=e(d.lonaxis._ax,c,_),r._extremes.lat=e(d.lataxis._ax,h,_)},plot:function(t,a,r){var d=a.layers.backplot.select(".choroplethlayer");v.makeTraceGroups(d,r,"trace choropleth").each(function(s){var i=g.select(this).selectAll("path.choroplethlocation").data(v.identity);i.enter().append("path").classed("choroplethlocation",!0),i.exit().remove(),n(t,s)})}}},{"../../lib":515,"../../lib/geo_location_utils":508,"../../lib/topojson_utils":544,"../../plots/cartesian/autorange":565,"./style":733,"@plotly/d3":58}],732:[function(y,ee,Q){"use strict";ee.exports=function(g,v){var m,x,e,n,t,a=g.cd,r=g.xaxis,d=g.yaxis,s=[];if(!1===v)for(m=0;m<a.length;m++)a[m].selected=0;else for(m=0;m<a.length;m++)(e=(x=a[m]).ct)&&(n=r.c2p(e),t=d.c2p(e),v.contains([n,t],null,m,g)?(s.push({pointNumber:m,lon:e[0],lat:e[1]}),x.selected=1):x.selected=0);return s}},{}],733:[function(y,ee,Q){"use strict";var g=y("@plotly/d3"),v=y("../../components/color"),m=y("../../components/drawing"),x=y("../../components/colorscale");function e(n,t){var a=t[0].trace,r=t[0].node3.selectAll(".choroplethlocation"),d=a.marker||{},s=d.line||{},i=x.makeColorScaleFuncFromTrace(a);r.each(function(u){g.select(this).attr("fill",i(u.z)).call(v.stroke,u.mlc||s.color).call(m.dashLine,"",u.mlw||s.width||0).style("opacity",d.opacity)}),m.selectedPointStyle(r,a,n)}ee.exports={style:function(n,t){t&&e(n,t)},styleOnSelect:function(n,t){var r=t[0].trace;r.selectedpoints?m.selectedPointStyle(t[0].node3.selectAll(".choroplethlocation"),r,n):e(n,t)}}},{"../../components/color":367,"../../components/colorscale":379,"../../components/drawing":389,"@plotly/d3":58}],734:[function(y,ee,Q){"use strict";var g=y("../choropleth/attributes"),v=y("../../components/colorscale/attributes"),m=y("../../plots/template_attributes").hovertemplateAttrs,x=y("../../plots/attributes"),e=y("../../lib/extend").extendFlat;ee.exports=e({locations:{valType:"data_array",editType:"calc"},z:{valType:"data_array",editType:"calc"},geojson:{valType:"any",editType:"calc"},featureidkey:e({},g.featureidkey,{}),below:{valType:"string",editType:"plot"},text:g.text,hovertext:g.hovertext,marker:{line:{color:e({},g.marker.line.color,{editType:"plot"}),width:e({},g.marker.line.width,{editType:"plot"}),editType:"calc"},opacity:e({},g.marker.opacity,{editType:"plot"}),editType:"calc"},selected:{marker:{opacity:e({},g.selected.marker.opacity,{editType:"plot"}),editType:"plot"},editType:"plot"},unselected:{marker:{opacity:e({},g.unselected.marker.opacity,{editType:"plot"}),editType:"plot"},editType:"plot"},hoverinfo:g.hoverinfo,hovertemplate:m({},{keys:["properties"]}),showlegend:e({},x.showlegend,{dflt:!1})},v("",{cLetter:"z",editTypeOverride:"calc"}))},{"../../components/colorscale/attributes":374,"../../lib/extend":505,"../../plots/attributes":562,"../../plots/template_attributes":642,"../choropleth/attributes":725}],735:[function(y,ee,Q){"use strict";var g=y("fast-isnumeric"),v=y("../../lib"),m=y("../../components/colorscale"),x=y("../../components/drawing"),e=y("../../lib/geojson_utils").makeBlank,n=y("../../lib/geo_location_utils");function t(a){var r,d=a[0].trace,s=d._opts;if(d.selectedpoints){for(var i=x.makeSelectedPointStyleFns(d),u=0;u<a.length;u++){var f=a[u];f.fOut&&(f.fOut.properties.mo2=i.selectedOpacityFn(f))}r={type:"identity",property:"mo2"}}else r=v.isArrayOrTypedArray(d.marker.opacity)?{type:"identity",property:"mo"}:d.marker.opacity;return v.extendFlat(s.fill.paint,{"fill-opacity":r}),v.extendFlat(s.line.paint,{"line-opacity":r}),s}ee.exports={convert:function(a){var r=a[0].trace,d=!0===r.visible&&0!==r._length,s={layout:{visibility:"none"},paint:{}},i={layout:{visibility:"none"},paint:{}},u=r._opts={fill:s,line:i,geojson:e()};if(!d)return u;var f=n.extractTraceFeature(a);if(!f)return u;var c,h,p,o=m.makeColorScaleFuncFromTrace(r),b=r.marker,l=b.line||{};v.isArrayOrTypedArray(b.opacity)&&(c=function(M){var I=M.mo;return g(I)?+v.constrain(I,0,1):0}),v.isArrayOrTypedArray(l.color)&&(h=function(M){return M.mlc}),v.isArrayOrTypedArray(l.width)&&(p=function(M){return M.mlw});for(var T=0;T<a.length;T++){var _=a[T],w=_.fOut;if(w){var k=w.properties;k.fc=o(_.z),c&&(k.mo=c(_)),h&&(k.mlc=h(_)),p&&(k.mlw=p(_)),_.ct=k.ct,_._polygons=n.feature2polygons(w)}}var L=c?{type:"identity",property:"mo"}:b.opacity;return v.extendFlat(s.paint,{"fill-color":{type:"identity",property:"fc"},"fill-opacity":L}),v.extendFlat(i.paint,{"line-color":h?{type:"identity",property:"mlc"}:l.color,"line-width":p?{type:"identity",property:"mlw"}:l.width,"line-opacity":L}),s.layout.visibility="visible",i.layout.visibility="visible",u.geojson={type:"FeatureCollection",features:f},t(a),u},convertOnSelect:t}},{"../../components/colorscale":379,"../../components/drawing":389,"../../lib":515,"../../lib/geo_location_utils":508,"../../lib/geojson_utils":509,"fast-isnumeric":190}],736:[function(y,ee,Q){"use strict";var g=y("../../lib"),v=y("../../components/colorscale/defaults"),m=y("./attributes");ee.exports=function(x,e,n,t){function a(i,u){return g.coerce(x,e,m,i,u)}var r=a("locations"),d=a("z"),s=a("geojson");g.isArrayOrTypedArray(r)&&r.length&&g.isArrayOrTypedArray(d)&&d.length&&("string"==typeof s&&""!==s||g.isPlainObject(s))?(a("featureidkey"),e._length=Math.min(r.length,d.length),a("below"),a("text"),a("hovertext"),a("hovertemplate"),a("marker.line.width")&&a("marker.line.color"),a("marker.opacity"),v(x,e,t,a,{prefix:"",cLetter:"z"}),g.coerceSelectionMarkerOpacity(e,a)):e.visible=!1}},{"../../components/colorscale/defaults":377,"../../lib":515,"./attributes":734}],737:[function(y,ee,Q){"use strict";ee.exports={attributes:y("./attributes"),supplyDefaults:y("./defaults"),colorbar:y("../heatmap/colorbar"),calc:y("../choropleth/calc"),plot:y("./plot"),hoverPoints:y("../choropleth/hover"),eventData:y("../choropleth/event_data"),selectPoints:y("../choropleth/select"),styleOnSelect:function(g,v){v&&v[0].trace._glTrace.updateOnSelect(v)},getBelow:function(g,v){for(var m=v.getMapLayers(),x=m.length-2;x>=0;x--){var e=m[x].id;if("string"==typeof e&&0===e.indexOf("water"))for(var n=x+1;n<m.length;n++)if("string"==typeof(e=m[n].id)&&-1===e.indexOf("plotly-"))return e}},moduleType:"trace",name:"choroplethmapbox",basePlotModule:y("../../plots/mapbox"),categories:["mapbox","gl","noOpacity","showLegend"],meta:{hr_name:"choropleth_mapbox"}}},{"../../plots/mapbox":622,"../choropleth/calc":726,"../choropleth/event_data":728,"../choropleth/hover":729,"../choropleth/select":732,"../heatmap/colorbar":804,"./attributes":734,"./defaults":736,"./plot":738}],738:[function(y,ee,Q){"use strict";var g=y("./convert").convert,v=y("./convert").convertOnSelect,m=y("../../plots/mapbox/constants").traceLayerPrefix;function x(n,t){this.type="choroplethmapbox",this.subplot=n,this.uid=t,this.sourceId="source-"+t,this.layerList=[["fill",m+t+"-fill"],["line",m+t+"-line"]],this.below=null}var e=x.prototype;e.update=function(n){this._update(g(n))},e.updateOnSelect=function(n){this._update(v(n))},e._update=function(n){var t=this.subplot,a=this.layerList,r=t.belowLookup["trace-"+this.uid];t.map.getSource(this.sourceId).setData(n.geojson),r!==this.below&&(this._removeLayers(),this._addLayers(n,r),this.below=r);for(var d=0;d<a.length;d++){var s=a[d],u=s[1],f=n[s[0]];t.setOptions(u,"setLayoutProperty",f.layout),"visible"===f.layout.visibility&&t.setOptions(u,"setPaintProperty",f.paint)}},e._addLayers=function(n,t){for(var a=this.subplot,r=this.layerList,d=this.sourceId,s=0;s<r.length;s++){var i=r[s],u=i[0],f=n[u];a.addLayer({type:u,id:i[1],source:d,layout:f.layout,paint:f.paint},t)}},e._removeLayers=function(){for(var n=this.subplot.map,t=this.layerList,a=t.length-1;a>=0;a--)n.removeLayer(t[a][1])},e.dispose=function(){var n=this.subplot.map;this._removeLayers(),n.removeSource(this.sourceId)},ee.exports=function(n,t){var a=t[0].trace,r=new x(n,a.uid),d=r.sourceId,s=g(t),i=r.below=n.belowLookup["trace-"+a.uid];return n.map.addSource(d,{type:"geojson",data:s.geojson}),r._addLayers(s,i),t[0].trace._glTrace=r,r}},{"../../plots/mapbox/constants":620,"./convert":735}],739:[function(y,ee,Q){"use strict";var g=y("../../components/colorscale/attributes"),v=y("../../plots/cartesian/axis_format_attributes").axisHoverFormat,m=y("../../plots/template_attributes").hovertemplateAttrs,x=y("../mesh3d/attributes"),e=y("../../plots/attributes"),n=y("../../lib/extend").extendFlat,t={x:{valType:"data_array",editType:"calc+clearAxisTypes"},y:{valType:"data_array",editType:"calc+clearAxisTypes"},z:{valType:"data_array",editType:"calc+clearAxisTypes"},u:{valType:"data_array",editType:"calc"},v:{valType:"data_array",editType:"calc"},w:{valType:"data_array",editType:"calc"},sizemode:{valType:"enumerated",values:["scaled","absolute"],editType:"calc",dflt:"scaled"},sizeref:{valType:"number",editType:"calc",min:0},anchor:{valType:"enumerated",editType:"calc",values:["tip","tail","cm","center"],dflt:"cm"},text:{valType:"string",dflt:"",arrayOk:!0,editType:"calc"},hovertext:{valType:"string",dflt:"",arrayOk:!0,editType:"calc"},hovertemplate:m({editType:"calc"},{keys:["norm"]}),uhoverformat:v("u",1),vhoverformat:v("v",1),whoverformat:v("w",1),xhoverformat:v("x"),yhoverformat:v("y"),zhoverformat:v("z"),showlegend:n({},e.showlegend,{dflt:!1})};n(t,g("",{colorAttr:"u/v/w norm",showScaleDflt:!0,editTypeOverride:"calc"})),["opacity","lightposition","lighting"].forEach(function(a){t[a]=x[a]}),t.hoverinfo=n({},e.hoverinfo,{editType:"calc",flags:["x","y","z","u","v","w","norm","text","name"],dflt:"x+y+z+norm+text+name"}),t.transforms=void 0,ee.exports=t},{"../../components/colorscale/attributes":374,"../../lib/extend":505,"../../plots/attributes":562,"../../plots/cartesian/axis_format_attributes":569,"../../plots/template_attributes":642,"../mesh3d/attributes":876}],740:[function(y,ee,Q){"use strict";var g=y("../../components/colorscale/calc");ee.exports=function(v,m){for(var x=m.u,e=m.v,n=m.w,t=Math.min(m.x.length,m.y.length,m.z.length,x.length,e.length,n.length),a=-1/0,r=1/0,d=0;d<t;d++){var s=x[d],i=e[d],u=n[d],f=Math.sqrt(s*s+i*i+u*u);a=Math.max(a,f),r=Math.min(r,f)}m._len=t,m._normMax=a,g(v,m,{vals:[r,a],containerStr:"",cLetter:"c"})}},{"../../components/colorscale/calc":375}],741:[function(y,ee,Q){"use strict";var g=y("../../../stackgl_modules").gl_cone3d,v=y("../../../stackgl_modules").gl_cone3d.createConeMesh,m=y("../../lib").simpleMap,x=y("../../lib/gl_format_color").parseColorScale,e=y("../../components/colorscale").extractOpts,n=y("../../plots/gl3d/zip3");function t(u,f){this.scene=u,this.uid=f,this.mesh=null,this.data=null}var a=t.prototype;a.handlePick=function(u){if(u.object===this.mesh){var f=u.index=u.data.index,o=this.data.u[f],b=this.data.v[f],l=this.data.w[f];u.traceCoordinate=[this.data.x[f],this.data.y[f],this.data.z[f],o,b,l,Math.sqrt(o*o+b*b+l*l)];var T=this.data.hovertext||this.data.text;return Array.isArray(T)&&void 0!==T[f]?u.textLabel=T[f]:T&&(u.textLabel=T),!0}};var r={xaxis:0,yaxis:1,zaxis:2},d={tip:1,tail:0,cm:.25,center:.5},s={tip:1,tail:1,cm:.75,center:.5};function i(u,f){var c=u.fullSceneLayout,h=u.dataScale,p={};function o(_,w){var k=c[w],L=h[r[w]];return m(_,function(M){return k.d2l(M)*L})}p.vectors=n(o(f.u,"xaxis"),o(f.v,"yaxis"),o(f.w,"zaxis"),f._len),p.positions=n(o(f.x,"xaxis"),o(f.y,"yaxis"),o(f.z,"zaxis"),f._len);var b=e(f);p.colormap=x(f),p.vertexIntensityBounds=[b.min/f._normMax,b.max/f._normMax],p.coneOffset=d[f.anchor],p.coneSize="scaled"===f.sizemode?f.sizeref||.5:f.sizeref&&f._normMax?f.sizeref/f._normMax:.5;var l=g(p),T=f.lightposition;return l.lightPosition=[T.x,T.y,T.z],l.ambient=f.lighting.ambient,l.diffuse=f.lighting.diffuse,l.specular=f.lighting.specular,l.roughness=f.lighting.roughness,l.fresnel=f.lighting.fresnel,l.opacity=f.opacity,f._pad=s[f.anchor]*l.vectorScale*l.coneScale*f._normMax,l}a.update=function(u){this.data=u;var f=i(this.scene,u);this.mesh.update(f)},a.dispose=function(){this.scene.glplot.remove(this.mesh),this.mesh.dispose()},ee.exports=function(u,f){var c=u.glplot.gl,h=i(u,f),p=v(c,h),o=new t(u,f.uid);return o.mesh=p,o.data=f,p._trace=o,u.glplot.add(p),o}},{"../../../stackgl_modules":1133,"../../components/colorscale":379,"../../lib":515,"../../lib/gl_format_color":511,"../../plots/gl3d/zip3":618}],742:[function(y,ee,Q){"use strict";var g=y("../../lib"),v=y("../../components/colorscale/defaults"),m=y("./attributes");ee.exports=function(x,e,n,t){function a(c,h){return g.coerce(x,e,m,c,h)}var r=a("u"),d=a("v"),s=a("w"),i=a("x"),u=a("y"),f=a("z");r&&r.length&&d&&d.length&&s&&s.length&&i&&i.length&&u&&u.length&&f&&f.length?(a("sizeref"),a("sizemode"),a("anchor"),a("lighting.ambient"),a("lighting.diffuse"),a("lighting.specular"),a("lighting.roughness"),a("lighting.fresnel"),a("lightposition.x"),a("lightposition.y"),a("lightposition.z"),v(x,e,t,a,{prefix:"",cLetter:"c"}),a("text"),a("hovertext"),a("hovertemplate"),a("uhoverformat"),a("vhoverformat"),a("whoverformat"),a("xhoverformat"),a("yhoverformat"),a("zhoverformat"),e._length=null):e.visible=!1}},{"../../components/colorscale/defaults":377,"../../lib":515,"./attributes":739}],743:[function(y,ee,Q){"use strict";ee.exports={moduleType:"trace",name:"cone",basePlotModule:y("../../plots/gl3d"),categories:["gl3d","showLegend"],attributes:y("./attributes"),supplyDefaults:y("./defaults"),colorbar:{min:"cmin",max:"cmax"},calc:y("./calc"),plot:y("./convert"),eventData:function(g,v){return g.norm=v.traceCoordinate[6],g},meta:{}}},{"../../plots/gl3d":607,"./attributes":739,"./calc":740,"./convert":741,"./defaults":742}],744:[function(y,ee,Q){"use strict";var g=y("../heatmap/attributes"),v=y("../scatter/attributes"),m=y("../../plots/cartesian/axis_format_attributes"),x=m.axisHoverFormat,e=m.descriptionOnlyNumbers,n=y("../../components/colorscale/attributes"),t=y("../../components/drawing/attributes").dash,a=y("../../plots/font_attributes"),r=y("../../lib/extend").extendFlat,d=y("../../constants/filter_ops"),s=d.COMPARISON_OPS2,i=d.INTERVAL_OPS,u=v.line;ee.exports=r({z:g.z,x:g.x,x0:g.x0,dx:g.dx,y:g.y,y0:g.y0,dy:g.dy,xperiod:g.xperiod,yperiod:g.yperiod,xperiod0:v.xperiod0,yperiod0:v.yperiod0,xperiodalignment:g.xperiodalignment,yperiodalignment:g.yperiodalignment,text:g.text,hovertext:g.hovertext,transpose:g.transpose,xtype:g.xtype,ytype:g.ytype,xhoverformat:x("x"),yhoverformat:x("y"),zhoverformat:x("z",1),hovertemplate:g.hovertemplate,texttemplate:r({},g.texttemplate,{}),textfont:r({},g.textfont,{}),hoverongaps:g.hoverongaps,connectgaps:r({},g.connectgaps,{}),fillcolor:{valType:"color",editType:"calc"},autocontour:{valType:"boolean",dflt:!0,editType:"calc",impliedEdits:{"contours.start":void 0,"contours.end":void 0,"contours.size":void 0}},ncontours:{valType:"integer",dflt:15,min:1,editType:"calc"},contours:{type:{valType:"enumerated",values:["levels","constraint"],dflt:"levels",editType:"calc"},start:{valType:"number",dflt:null,editType:"plot",impliedEdits:{"^autocontour":!1}},end:{valType:"number",dflt:null,editType:"plot",impliedEdits:{"^autocontour":!1}},size:{valType:"number",dflt:null,min:0,editType:"plot",impliedEdits:{"^autocontour":!1}},coloring:{valType:"enumerated",values:["fill","heatmap","lines","none"],dflt:"fill",editType:"calc"},showlines:{valType:"boolean",dflt:!0,editType:"plot"},showlabels:{valType:"boolean",dflt:!1,editType:"plot"},labelfont:a({editType:"plot",colorEditType:"style"}),labelformat:{valType:"string",dflt:"",editType:"plot",description:e("contour label")},operation:{valType:"enumerated",values:[].concat(s).concat(i),dflt:"=",editType:"calc"},value:{valType:"any",dflt:0,editType:"calc"},editType:"calc",impliedEdits:{autocontour:!1}},line:{color:r({},u.color,{editType:"style+colorbars"}),width:{valType:"number",min:0,editType:"style+colorbars"},dash:t,smoothing:r({},u.smoothing,{}),editType:"plot"}},n("",{cLetter:"z",autoColorDflt:!1,editTypeOverride:"calc"}))},{"../../components/colorscale/attributes":374,"../../components/drawing/attributes":388,"../../constants/filter_ops":487,"../../lib/extend":505,"../../plots/cartesian/axis_format_attributes":569,"../../plots/font_attributes":594,"../heatmap/attributes":801,"../scatter/attributes":936}],745:[function(y,ee,Q){"use strict";var g=y("../../components/colorscale"),v=y("../heatmap/calc"),m=y("./set_contours"),x=y("./end_plus");ee.exports=function(e,n){var t=v(e,n),a=t[0].z;m(n,a);var r,d=n.contours,s=g.extractOpts(n);if("heatmap"===d.coloring&&s.auto&&!1===n.autocontour){var i=d.start,u=x(d),f=d.size||1,c=Math.floor((u-i)/f)+1;isFinite(f)||(f=1,c=1);var h=i-f/2;r=[h,h+c*f]}else r=a;return g.calc(e,n,{vals:r,cLetter:"z"}),t}},{"../../components/colorscale":379,"../heatmap/calc":802,"./end_plus":755,"./set_contours":763}],746:[function(y,ee,Q){"use strict";ee.exports=function(g,v){var m,x=g[0],e=x.z;switch(v.type){case"levels":var n=Math.min(e[0][0],e[0][1]);for(m=0;m<g.length;m++){var t=g[m];t.prefixBoundary=!t.edgepaths.length&&(n>t.level||t.starts.length&&n===t.level)}break;case"constraint":if(x.prefixBoundary=!1,x.edgepaths.length)return;var a=x.x.length,r=x.y.length,d=-1/0,s=1/0;for(m=0;m<r;m++)s=Math.min(s,e[m][0]),s=Math.min(s,e[m][a-1]),d=Math.max(d,e[m][0]),d=Math.max(d,e[m][a-1]);for(m=1;m<a-1;m++)s=Math.min(s,e[0][m]),s=Math.min(s,e[r-1][m]),d=Math.max(d,e[0][m]),d=Math.max(d,e[r-1][m]);var i,u,f=v.value;switch(v._operation){case">":f>d&&(x.prefixBoundary=!0);break;case"<":(f<s||x.starts.length&&f===s)&&(x.prefixBoundary=!0);break;case"[]":i=Math.min(f[0],f[1]),((u=Math.max(f[0],f[1]))<s||i>d||x.starts.length&&u===s)&&(x.prefixBoundary=!0);break;case"][":i=Math.min(f[0],f[1]),u=Math.max(f[0],f[1]),i<s&&u>d&&(x.prefixBoundary=!0)}}}},{}],747:[function(y,ee,Q){"use strict";var g=y("../../components/colorscale"),v=y("./make_color_map"),m=y("./end_plus");ee.exports={min:"zmin",max:"zmax",calc:function(x,e,n){var t=e.contours,a=e.line,r=t.size||1,d=t.coloring,s=v(e,{isColorbar:!0});if("heatmap"===d){var i=g.extractOpts(e);n._fillgradient=i.reversescale?g.flipScale(i.colorscale):i.colorscale,n._zrange=[i.min,i.max]}else"fill"===d&&(n._fillcolor=s);n._line={color:"lines"===d?s:a.color,width:!1!==t.showlines?a.width:0,dash:a.dash},n._levels={start:t.start,end:m(t),size:r}}}},{"../../components/colorscale":379,"./end_plus":755,"./make_color_map":760}],748:[function(y,ee,Q){"use strict";ee.exports={BOTTOMSTART:[1,9,13,104,713],TOPSTART:[4,6,7,104,713],LEFTSTART:[8,12,14,208,1114],RIGHTSTART:[2,3,11,208,1114],NEWDELTA:[null,[-1,0],[0,-1],[-1,0],[1,0],null,[0,-1],[-1,0],[0,1],[0,1],null,[0,1],[1,0],[1,0],[0,-1]],CHOOSESADDLE:{104:[4,1],208:[2,8],713:[7,13],1114:[11,14]},SADDLEREMAINDER:{1:4,2:8,4:1,7:13,8:2,11:14,13:7,14:11},LABELDISTANCE:2,LABELINCREASE:10,LABELMIN:3,LABELMAX:10,LABELOPTIMIZER:{EDGECOST:1,ANGLECOST:1,NEIGHBORCOST:5,SAMELEVELFACTOR:10,SAMELEVELDISTANCE:5,MAXCOST:100,INITIALSEARCHPOINTS:10,ITERATIONS:5}}},{}],749:[function(y,ee,Q){"use strict";var g=y("fast-isnumeric"),v=y("./label_defaults"),m=y("../../components/color"),x=m.addOpacity,e=m.opacity,n=y("../../constants/filter_ops"),t=n.CONSTRAINT_REDUCTION,a=n.COMPARISON_OPS2;ee.exports=function(r,d,s,i,u,f){var c,h,p,l,T,_,o=d.contours,b=s("contours.operation");o._operation=t[b],l=s,-1===a.indexOf((T=o).operation)?(l("contours.value",[0,1]),Array.isArray(T.value)?T.value.length>2?T.value=T.value.slice(2):0===T.length?T.value=[0,1]:T.length<2?(_=parseFloat(T.value[0]),T.value=[_,_+1]):T.value=[parseFloat(T.value[0]),parseFloat(T.value[1])]:g(T.value)&&(_=parseFloat(T.value),T.value=[_,_+1])):(l("contours.value",0),g(T.value)||(T.value=Array.isArray(T.value)?parseFloat(T.value[0]):0)),"="===b?c=o.showlines=!0:(c=s("contours.showlines"),p=s("fillcolor",x((r.line||{}).color||u,.5))),c&&(h=s("line.color",p&&e(p)?x(d.fillcolor,1):u),s("line.width",2),s("line.dash")),s("line.smoothing"),v(s,i,h,f)}},{"../../components/color":367,"../../constants/filter_ops":487,"./label_defaults":759,"fast-isnumeric":190}],750:[function(y,ee,Q){"use strict";var g=y("../../constants/filter_ops"),v=y("fast-isnumeric");function m(n,t){var a,r=Array.isArray(t);function d(s){return v(s)?+s:null}return-1!==g.COMPARISON_OPS2.indexOf(n)?a=d(r?t[0]:t):-1!==g.INTERVAL_OPS.indexOf(n)?a=r?[d(t[0]),d(t[1])]:[d(t),d(t)]:-1!==g.SET_OPS.indexOf(n)&&(a=r?t.map(d):[d(t)]),a}function x(n){return function(t){t=m(n,t);var a=Math.min(t[0],t[1]),r=Math.max(t[0],t[1]);return{start:a,end:r,size:r-a}}}function e(n){return function(t){return{start:t=m(n,t),end:1/0,size:1/0}}}ee.exports={"[]":x("[]"),"][":x("]["),">":e(">"),"<":e("<"),"=":e("=")}},{"../../constants/filter_ops":487,"fast-isnumeric":190}],751:[function(y,ee,Q){"use strict";ee.exports=function(g,v,m,x){var e=x("contours.start"),n=x("contours.end"),t=!1===e||!1===n,a=m("contours.size");!(t?v.autocontour=!0:m("autocontour",!1))&&a||m("ncontours")}},{}],752:[function(y,ee,Q){"use strict";var g=y("../../lib");function v(m){return g.extendFlat({},m,{edgepaths:g.extendDeep([],m.edgepaths),paths:g.extendDeep([],m.paths),starts:g.extendDeep([],m.starts)})}ee.exports=function(m,x){var e,n,t,a=function(s){return s.reverse()},r=function(s){return s};switch(x){case"=":case"<":return m;case">":for(1!==m.length&&g.warn("Contour data invalid for the specified inequality operation."),n=m[0],e=0;e<n.edgepaths.length;e++)n.edgepaths[e]=a(n.edgepaths[e]);for(e=0;e<n.paths.length;e++)n.paths[e]=a(n.paths[e]);for(e=0;e<n.starts.length;e++)n.starts[e]=a(n.starts[e]);return m;case"][":var d=a;a=r,r=d;case"[]":for(2!==m.length&&g.warn("Contour data invalid for the specified inequality range operation."),n=v(m[0]),t=v(m[1]),e=0;e<n.edgepaths.length;e++)n.edgepaths[e]=a(n.edgepaths[e]);for(e=0;e<n.paths.length;e++)n.paths[e]=a(n.paths[e]);for(e=0;e<n.starts.length;e++)n.starts[e]=a(n.starts[e]);for(;t.edgepaths.length;)n.edgepaths.push(r(t.edgepaths.shift()));for(;t.paths.length;)n.paths.push(r(t.paths.shift()));for(;t.starts.length;)n.starts.push(r(t.starts.shift()));return[n]}}},{"../../lib":515}],753:[function(y,ee,Q){"use strict";var g=y("../../lib"),v=y("../heatmap/xyz_defaults"),m=y("../scatter/period_defaults"),x=y("./constraint_defaults"),e=y("./contours_defaults"),n=y("./style_defaults"),t=y("../heatmap/label_defaults"),a=y("./attributes");ee.exports=function(r,d,s,i){function u(c,h){return g.coerce(r,d,a,c,h)}if(v(r,d,u,i)){m(r,d,i,u),u("xhoverformat"),u("yhoverformat"),u("text"),u("hovertext"),u("hoverongaps"),u("hovertemplate");var f="constraint"===u("contours.type");u("connectgaps",g.isArray1D(d.z)),f?x(r,d,u,i,s):(e(r,d,u,function(c){return g.coerce2(r,d,a,c)}),n(r,d,u,i)),d.contours&&"heatmap"===d.contours.coloring&&t(u,i)}else d.visible=!1}},{"../../lib":515,"../heatmap/label_defaults":811,"../heatmap/xyz_defaults":816,"../scatter/period_defaults":956,"./attributes":744,"./constraint_defaults":749,"./contours_defaults":751,"./style_defaults":765}],754:[function(y,ee,Q){"use strict";var g=y("../../lib"),v=y("./constraint_mapping"),m=y("./end_plus");ee.exports=function(x,e,n){for(var t="constraint"===x.type?v[x._operation](x.value):x,a=t.size,r=[],d=m(t),s=n.trace._carpetTrace,i=s?{xaxis:s.aaxis,yaxis:s.baxis,x:n.a,y:n.b}:{xaxis:e.xaxis,yaxis:e.yaxis,x:n.x,y:n.y},u=t.start;u<d;u+=a)if(r.push(g.extendFlat({level:u,crossings:{},starts:[],edgepaths:[],paths:[],z:n.z,smoothing:n.trace.line.smoothing},i)),r.length>1e3){g.warn("Too many contours, clipping at 1000",x);break}return r}},{"../../lib":515,"./constraint_mapping":750,"./end_plus":755}],755:[function(y,ee,Q){"use strict";ee.exports=function(g){return g.end+g.size/1e6}},{}],756:[function(y,ee,Q){"use strict";var g=y("../../lib"),v=y("./constants");function m(n,t,a,r){return Math.abs(n[0]-t[0])<a&&Math.abs(n[1]-t[1])<r}function x(n,t,a,r,d){var s,J,re,ne,le,i=t.join(","),u=n.crossings[i],f=(re=t,ne=0,le=0,(J=u)>20&&a?208===J||1114===J?ne=0===re[0]?1:-1:le=0===re[1]?1:-1:-1!==v.BOTTOMSTART.indexOf(J)?le=1:-1!==v.LEFTSTART.indexOf(J)?ne=1:-1!==v.TOPSTART.indexOf(J)?le=-1:ne=-1,[ne,le]),c=[e(n,t,[-f[0],-f[1]])],h=n.z.length,p=n.z[0].length,o=t.slice(),b=f.slice();for(s=0;s<1e4;s++){if(u>20?n.crossings[i]=v.SADDLEREMAINDER[u=v.CHOOSESADDLE[u][(f[0]||f[1])<0?0:1]]:delete n.crossings[i],!(f=v.NEWDELTA[u])){g.log("Found bad marching index:",u,t,n.level);break}if(c.push(e(n,t,f)),t[0]+=f[0],t[1]+=f[1],i=t.join(","),m(c[c.length-1],c[c.length-2],r,d)&&c.pop(),t[0]===o[0]&&t[1]===o[1]&&f[0]===b[0]&&f[1]===b[1]||a&&(f[0]&&(t[0]<0||t[0]>p-2)||f[1]&&(t[1]<0||t[1]>h-2)))break;u=n.crossings[i]}1e4===s&&g.log("Infinite loop in contour?");var T,_,w,k,L,M,I,P,S,E,z,R,q,V,W,K=m(c[0],c[c.length-1],r,d),G=0,Y=.2*n.smoothing,$=[],B=0;for(s=1;s<c.length;s++)void 0,void 0,V=(R=c[s])[2]-(q=c[s-1])[2],W=R[3]-q[3],G+=I=Math.sqrt(V*V+W*W),$.push(I);var N=G/$.length*Y;function U(J){return c[J%c.length]}for(s=c.length-2;s>=B;s--)if((T=$[s])<N){for(w=0,_=s-1;_>=B&&T+$[_]<N;_--)T+=$[_];if(K&&s===c.length-2)for(w=0;w<_&&T+$[w]<N;w++)T+=$[w];L=s-_+w+1,M=Math.floor((s+_+w+2)/2),k=K||s!==c.length-2?K||-1!==_?L%2?U(M):[(U(M)[0]+U(M+1)[0])/2,(U(M)[1]+U(M+1)[1])/2]:c[0]:c[c.length-1],c.splice(_+1,s-_+1,k),s=_+1,w&&(B=w),K&&(s===c.length-2?c[w]=c[c.length-1]:0===s&&(c[c.length-1]=c[0]))}for(c.splice(0,B),s=0;s<c.length;s++)c[s].length=2;if(!(c.length<2))if(K)c.pop(),n.paths.push(c);else{a||g.log("Unclosed interior contour?",n.level,o.join(","),c.join("L"));var te=!1;for(P=0;P<n.edgepaths.length;P++)if(E=n.edgepaths[P],!te&&m(E[0],c[c.length-1],r,d)){c.pop(),te=!0;var j=!1;for(S=0;S<n.edgepaths.length;S++)if(m((z=n.edgepaths[S])[z.length-1],c[0],r,d)){j=!0,c.shift(),n.edgepaths.splice(P,1),S===P?n.paths.push(c.concat(z)):(S>P&&S--,n.edgepaths[S]=z.concat(c,E));break}j||(n.edgepaths[P]=c.concat(E))}for(P=0;P<n.edgepaths.length&&!te;P++)m((E=n.edgepaths[P])[E.length-1],c[0],r,d)&&(c.shift(),n.edgepaths[P]=E.concat(c),te=!0);te||n.edgepaths.push(c)}}function e(n,t,a){var r=t[0]+Math.max(a[0],0),d=t[1]+Math.max(a[1],0),s=n.z[d][r],i=n.xaxis,u=n.yaxis;if(a[1]){var f=(n.level-s)/(n.z[d][r+1]-s),c=(1!==f?(1-f)*i.c2l(n.x[r]):0)+(0!==f?f*i.c2l(n.x[r+1]):0);return[i.c2p(i.l2c(c),!0),u.c2p(n.y[d],!0),r+f,d]}var h=(n.level-s)/(n.z[d+1][r]-s),p=(1!==h?(1-h)*u.c2l(n.y[d]):0)+(0!==h?h*u.c2l(n.y[d+1]):0);return[i.c2p(n.x[r],!0),u.c2p(u.l2c(p),!0),r,d+h]}ee.exports=function(n,t,a){var r,d,s,i;for(t=t||.01,a=a||.01,d=0;d<n.length;d++){for(s=n[d],i=0;i<s.starts.length;i++)x(s,s.starts[i],"edge",t,a);for(r=0;Object.keys(s.crossings).length&&r<1e4;)r++,x(s,Object.keys(s.crossings)[0].split(",").map(Number),void 0,t,a);1e4===r&&g.log("Infinite loop in contour?")}}},{"../../lib":515,"./constants":748}],757:[function(y,ee,Q){"use strict";var g=y("../../components/color"),v=y("../heatmap/hover");ee.exports=function(m,x,e,n,t){t||(t={}),t.isContour=!0;var a=v(m,x,e,n,t);return a&&a.forEach(function(r){var d=r.trace;"constraint"===d.contours.type&&(d.fillcolor&&g.opacity(d.fillcolor)?r.color=g.addOpacity(d.fillcolor,1):d.contours.showlines&&g.opacity(d.line.color)&&(r.color=g.addOpacity(d.line.color,1)))}),a}},{"../../components/color":367,"../heatmap/hover":808}],758:[function(y,ee,Q){"use strict";ee.exports={attributes:y("./attributes"),supplyDefaults:y("./defaults"),calc:y("./calc"),plot:y("./plot").plot,style:y("./style"),colorbar:y("./colorbar"),hoverPoints:y("./hover"),moduleType:"trace",name:"contour",basePlotModule:y("../../plots/cartesian"),categories:["cartesian","svg","2dMap","contour","showLegend"],meta:{}}},{"../../plots/cartesian":578,"./attributes":744,"./calc":745,"./colorbar":747,"./defaults":753,"./hover":757,"./plot":762,"./style":764}],759:[function(y,ee,Q){"use strict";var g=y("../../lib");ee.exports=function(v,m,x,e){if(e||(e={}),v("contours.showlabels")){var n=m.font;g.coerceFont(v,"contours.labelfont",{family:n.family,size:n.size,color:x}),v("contours.labelformat")}!1!==e.hasHover&&v("zhoverformat")}},{"../../lib":515}],760:[function(y,ee,Q){"use strict";var g=y("@plotly/d3"),v=y("../../components/colorscale"),m=y("./end_plus");ee.exports=function(x){var e=x.contours,n=e.start,t=m(e),a=e.size||1,r=Math.floor((t-n)/a)+1,d="lines"===e.coloring?0:1,s=v.extractOpts(x);isFinite(a)||(a=1,r=1);var i,u,f=s.reversescale?v.flipScale(s.colorscale):s.colorscale,c=f.length,h=new Array(c),p=new Array(c);if("heatmap"===e.coloring){var o=s.min,b=s.max;for(u=0;u<c;u++)h[u]=(i=f[u])[0]*(b-o)+o,p[u]=i[1];var l=g.extent([o,b,e.start,e.start+a*(r-1)]),T=l[o<b?0:1],_=l[o<b?1:0];T!==o&&(h.splice(0,0,T),p.splice(0,0,p[0])),_!==b&&(h.push(_),p.push(p[p.length-1]))}else for(u=0;u<c;u++)h[u]=((i=f[u])[0]*(r+d-1)-d/2)*a+n,p[u]=i[1];return v.makeColorScaleFunc({domain:h,range:p},{noNumericCheck:!0})}},{"../../components/colorscale":379,"./end_plus":755,"@plotly/d3":58}],761:[function(y,ee,Q){"use strict";var g=y("./constants");function v(m,x){var e=(x[0][0]>m?0:1)+(x[0][1]>m?0:2)+(x[1][1]>m?0:4)+(x[1][0]>m?0:8);return 5===e||10===e?m>(x[0][0]+x[0][1]+x[1][0]+x[1][1])/4?5===e?713:1114:5===e?104:208:15===e?0:e}ee.exports=function(m){var x,e,n,t,a,r,d,s,i,u=m[0].z,f=u.length,c=u[0].length,h=2===f||2===c;for(e=0;e<f-1;e++)for(t=[],0===e&&(t=t.concat(g.BOTTOMSTART)),e===f-2&&(t=t.concat(g.TOPSTART)),x=0;x<c-1;x++)for(n=t.slice(),0===x&&(n=n.concat(g.LEFTSTART)),x===c-2&&(n=n.concat(g.RIGHTSTART)),a=x+","+e,r=[[u[e][x],u[e][x+1]],[u[e+1][x],u[e+1][x+1]]],i=0;i<m.length;i++)(d=v((s=m[i]).level,r))&&(s.crossings[a]=d,-1!==n.indexOf(d)&&(s.starts.push([x,e]),h&&-1!==n.indexOf(d,n.indexOf(d)+1)&&s.starts.push([x,e])))}},{"./constants":748}],762:[function(y,ee,Q){"use strict";var g=y("@plotly/d3"),v=y("../../lib"),m=y("../../components/drawing"),x=y("../../components/colorscale"),e=y("../../lib/svg_text_utils"),n=y("../../plots/cartesian/axes"),t=y("../../plots/cartesian/set_convert"),a=y("../heatmap/plot"),r=y("./make_crossings"),d=y("./find_all_paths"),s=y("./empty_pathinfo"),i=y("./convert_to_constraints"),u=y("./close_boundaries"),f=y("./constants"),c=f.LABELOPTIMIZER;function h(b,l){var T,_,w,k,L,M,P="",S=0,E=b.edgepaths.map(function(K,G){return G}),z=!0;function R(K){return Math.abs(K[1]-l[2][1])<.01}function V(K){return Math.abs(K[0]-l[2][0])<.01}for(;E.length;){for(M=m.smoothopen(b.edgepaths[S],b.smoothing),P+=z?M:M.replace(/^M/,"L"),E.splice(E.indexOf(S),1),T=b.edgepaths[S][b.edgepaths[S].length-1],k=-1,w=0;w<4;w++){if(!T){v.log("Missing end?",S,b);break}for(Math.abs(T[1]-l[0][1])<.01&&!V(T)?_=l[1]:Math.abs(T[0]-l[0][0])<.01?_=l[0]:R(T)?_=l[3]:V(T)&&(_=l[2]),L=0;L<b.edgepaths.length;L++){var W=b.edgepaths[L][0];Math.abs(T[0]-_[0])<.01?Math.abs(T[0]-W[0])<.01&&(W[1]-T[1])*(_[1]-W[1])>=0&&(_=W,k=L):Math.abs(T[1]-_[1])<.01?Math.abs(T[1]-W[1])<.01&&(W[0]-T[0])*(_[0]-W[0])>=0&&(_=W,k=L):v.log("endpt to newendpt is not vert. or horz.",T,_,W)}if(T=_,k>=0)break;P+="L"+_}if(k===b.edgepaths.length){v.log("unclosed perimeter path");break}(z=-1===E.indexOf(S=k))&&(S=E[0],P+="Z")}for(S=0;S<b.paths.length;S++)P+=m.smoothclosed(b.paths[S],b.smoothing);return P}function p(b,l,T,_){var w=l.width/2,k=l.height/2,L=b.x,M=b.y,I=b.theta,P=Math.cos(I)*w,S=Math.sin(I)*w,E=(L>_.center?_.right-L:L-_.left)/(P+Math.abs(Math.sin(I)*k)),z=(M>_.middle?_.bottom-M:M-_.top)/(Math.abs(S)+Math.cos(I)*k);if(E<1||z<1)return 1/0;var R=c.EDGECOST*(1/(E-1)+1/(z-1));R+=c.ANGLECOST*I*I;for(var q=L-P,V=M-S,W=L+P,K=M+S,G=0;G<T.length;G++){var Y=T[G],$=Math.cos(Y.theta)*Y.width/2,B=Math.sin(Y.theta)*Y.width/2,N=2*v.segmentDistance(q,V,W,K,Y.x-$,Y.y-B,Y.x+$,Y.y+B)/(l.height+Y.height),U=Y.level===l.level,te=U?c.SAMELEVELDISTANCE:1;if(N<=te)return 1/0;R+=c.NEIGHBORCOST*(U?c.SAMELEVELFACTOR:1)/(N-te)}return R}function o(b){var l,T,_=b.trace._emptypoints,w=[],k=b.z.length,L=b.z[0].length,M=[];for(l=0;l<L;l++)M.push(1);for(l=0;l<k;l++)w.push(M.slice());for(l=0;l<_.length;l++)w[(T=_[l])[0]][T[1]]=0;return b.zmask=w,w}Q.plot=function(b,l,T,_){var w=l.xaxis,k=l.yaxis;v.makeTraceGroups(_,T,"contour").each(function(L){var M=g.select(this),I=L[0],S=I.x,E=I.y,z=I.trace.contours,R=s(z,l,I),q=v.ensureSingle(M,"g","heatmapcoloring"),V=[];"heatmap"===z.coloring&&(V=[L]),a(b,l,V,q),r(R),d(R);var U,te,j,W=w.c2p(S[0],!0),K=w.c2p(S[S.length-1],!0),G=k.c2p(E[0],!0),Y=k.c2p(E[E.length-1],!0),$=[[W,Y],[K,Y],[K,G],[W,G]],B=R;"constraint"===z.type&&(B=i(R,z._operation)),U=$,te=z,(j=v.ensureSingle(M,"g","contourbg").selectAll("path").data("fill"===te.coloring?[0]:[])).enter().append("path"),j.exit().remove(),j.attr("d","M"+U.join("L")+"Z").style("stroke","none"),function(N,U,te,j){var J="fill"===j.coloring||"constraint"===j.type&&"="!==j._operation,X="M"+te.join("L")+"Z";J&&u(U,j);var re=v.ensureSingle(N,"g","contourfill").selectAll("path").data(J?U:[]);re.enter().append("path"),re.exit().remove(),re.each(function(ne){var le=(ne.prefixBoundary?X:"")+h(ne,te);le?g.select(this).attr("d",le).style("stroke","none"):g.select(this).remove()})}(M,B,$,z),function(N,U,te,j,J){var X=v.ensureSingle(N,"g","contourlines"),re=!1!==J.showlines,ne=J.showlabels,le=re&&ne,oe=Q.createLines(X,re||ne,U),de=Q.createLineClip(X,le,te,j.trace.uid),se=N.selectAll("g.contourlabels").data(ne?[0]:[]);if(se.exit().remove(),se.enter().append("g").classed("contourlabels",!0),ne){var ge=[],_e=[];v.clearLocationCache();var Te=Q.labelFormatter(te,j),we=m.tester.append("text").attr("data-notex",1).call(m.font,J.labelfont),Oe=U[0].xaxis,fe=U[0].yaxis,ve=Oe._length,Ae=fe._length,ke=Oe.range,Pe=fe.range,Ne=v.aggNums(Math.min,null,j.x),De=v.aggNums(Math.max,null,j.x),ze=v.aggNums(Math.min,null,j.y),Me=v.aggNums(Math.max,null,j.y),Se=Math.max(Oe.c2p(Ne,!0),0),Ie=Math.min(Oe.c2p(De,!0),ve),Fe=Math.max(fe.c2p(Me,!0),0),Re=Math.min(fe.c2p(ze,!0),Ae),Xe={};ke[0]<ke[1]?(Xe.left=Se,Xe.right=Ie):(Xe.left=Ie,Xe.right=Se),Pe[0]<Pe[1]?(Xe.top=Fe,Xe.bottom=Re):(Xe.top=Re,Xe.bottom=Fe),Xe.middle=(Xe.top+Xe.bottom)/2,Xe.center=(Xe.left+Xe.right)/2,ge.push([[Xe.left,Xe.top],[Xe.right,Xe.top],[Xe.right,Xe.bottom],[Xe.left,Xe.bottom]]);var nt=Math.sqrt(ve*ve+Ae*Ae),ct=f.LABELDISTANCE*nt/Math.max(1,U.length/f.LABELINCREASE);oe.each(function(xt){var dt=Q.calcTextOpts(xt.level,Te,we,te);g.select(this).selectAll("path").each(function(){var tt=v.getVisibleSegment(this,Xe,dt.height/2);if(tt&&!(tt.len<(dt.width+dt.height)*f.LABELMIN))for(var Ke=Math.min(Math.ceil(tt.len/ct),f.LABELMAX),mt=0;mt<Ke;mt++){var Bt=Q.findBestTextLocation(this,tt,dt,_e,Xe);if(!Bt)break;Q.addLabelData(Bt,dt,_e,ge)}})}),we.remove(),Q.drawLabels(se,_e,te,de,le?ge:null)}ne&&!re&&oe.remove()}(M,R,b,I,z),function(N,U,te,j,J){var X=j.trace,ne="clip"+X.uid,le=te._fullLayout._clips.selectAll("#"+ne).data(X.connectgaps?[]:[0]);if(le.enter().append("clipPath").classed("contourclip",!0).attr("id",ne),le.exit().remove(),!1===X.connectgaps){var oe={level:.9,crossings:{},starts:[],edgepaths:[],paths:[],xaxis:U.xaxis,yaxis:U.yaxis,x:j.x,y:j.y,z:o(j),smoothing:0};r([oe]),d([oe]),u([oe],{type:"levels"}),v.ensureSingle(le,"path","").attr("d",(oe.prefixBoundary?"M"+J.join("L")+"Z":"")+h(oe,J))}else ne=null;m.setClipUrl(N,ne,te)}(M,l,b,I,$)})},Q.createLines=function(b,l,T){var _=T[0].smoothing,w=b.selectAll("g.contourlevel").data(l?T:[]);if(w.exit().remove(),w.enter().append("g").classed("contourlevel",!0),l){var k=w.selectAll("path.openline").data(function(M){return M.pedgepaths||M.edgepaths});k.exit().remove(),k.enter().append("path").classed("openline",!0),k.attr("d",function(M){return m.smoothopen(M,_)}).style("stroke-miterlimit",1).style("vector-effect","non-scaling-stroke");var L=w.selectAll("path.closedline").data(function(M){return M.ppaths||M.paths});L.exit().remove(),L.enter().append("path").classed("closedline",!0),L.attr("d",function(M){return m.smoothclosed(M,_)}).style("stroke-miterlimit",1).style("vector-effect","non-scaling-stroke")}return w},Q.createLineClip=function(b,l,T,_){var w=l?"clipline"+_:null,k=T._fullLayout._clips.selectAll("#"+w).data(l?[0]:[]);return k.exit().remove(),k.enter().append("clipPath").classed("contourlineclip",!0).attr("id",w),m.setClipUrl(b,w,T),k},Q.labelFormatter=function(b,l){var T=b._fullLayout,_=l.trace,w=_.contours,k={type:"linear",_id:"ycontour",showexponent:"all",exponentformat:"B"};if(w.labelformat)k.tickformat=w.labelformat,t(k,T);else{var L=x.extractOpts(_);if(L&&L.colorbar&&L.colorbar._axis)k=L.colorbar._axis;else{if("constraint"===w.type){var M=w.value;k.range=Array.isArray(M)?[M[0],M[M.length-1]]:[M,M]}else k.range=[w.start,w.end],k.nticks=(w.end-w.start)/w.size;k.range[0]===k.range[1]&&(k.range[1]+=k.range[0]||1),k.nticks||(k.nticks=1e3),t(k,T),n.prepTicks(k),k._tmin=null,k._tmax=null}}return function(I){return n.tickText(k,I).text}},Q.calcTextOpts=function(b,l,T,_){var w=l(b);T.text(w).call(e.convertToTspans,_);var k=T.node(),L=m.bBox(k,!0);return{text:w,width:L.width,height:L.height,fontSize:+k.style["font-size"].replace("px",""),level:b,dy:(L.top+L.bottom)/2}},Q.findBestTextLocation=function(b,l,T,_,w){var k,L,M,I,P,S=T.width;l.isClosed?(k=l.min+(L=l.len/c.INITIALSEARCHPOINTS)/2,M=l.max):(k=l.min+(L=(l.len-S)/(c.INITIALSEARCHPOINTS+1))+S/2,M=l.max-(L+S)/2);for(var E=1/0,z=0;z<c.ITERATIONS;z++){for(var R=k;R<M;R+=L){var q=v.getTextLocation(b,l.total,R,S),V=p(q,T,_,w);V<E&&(E=V,P=q,I=R)}if(E>2*c.MAXCOST)break;z&&(L/=2),M=(k=I-L/2)+1.5*L}if(E<=c.MAXCOST)return P},Q.addLabelData=function(b,l,T,_){var w=l.fontSize,k=l.width+w/3,L=Math.max(0,l.height-w/3),M=b.x,I=b.y,P=b.theta,S=Math.sin(P),E=Math.cos(P),z=function(q,V){return[M+q*E-V*S,I+q*S+V*E]},R=[z(-k/2,-L/2),z(-k/2,L/2),z(k/2,L/2),z(k/2,-L/2)];T.push({text:l.text,x:M,y:I,dy:l.dy,theta:P,level:l.level,width:k,height:L}),_.push(R)},Q.drawLabels=function(b,l,T,_,w){var k=b.selectAll("text").data(l,function(I){return I.text+","+I.x+","+I.y+","+I.theta});if(k.exit().remove(),k.enter().append("text").attr({"data-notex":1,"text-anchor":"middle"}).each(function(I){var P=I.x+Math.sin(I.theta)*I.dy,S=I.y-Math.cos(I.theta)*I.dy;g.select(this).text(I.text).attr({x:P,y:S,transform:"rotate("+180*I.theta/Math.PI+" "+P+" "+S+")"}).call(e.convertToTspans,T)}),w){for(var L="",M=0;M<w.length;M++)L+="M"+w[M].join("L")+"Z";v.ensureSingle(_,"path","").attr("d",L)}}},{"../../components/colorscale":379,"../../components/drawing":389,"../../lib":515,"../../lib/svg_text_utils":541,"../../plots/cartesian/axes":566,"../../plots/cartesian/set_convert":585,"../heatmap/plot":813,"./close_boundaries":746,"./constants":748,"./convert_to_constraints":752,"./empty_pathinfo":754,"./find_all_paths":756,"./make_crossings":761,"@plotly/d3":58}],763:[function(y,ee,Q){"use strict";var g=y("../../plots/cartesian/axes"),v=y("../../lib");function m(x,e,n){var t={type:"linear",range:[x,e]};return g.autoTicks(t,(e-x)/(n||15)),t}ee.exports=function(x,e){var n=x.contours;if(x.autocontour){var t=x.zmin,a=x.zmax;(x.zauto||void 0===t)&&(t=v.aggNums(Math.min,null,e)),(x.zauto||void 0===a)&&(a=v.aggNums(Math.max,null,e));var r=m(t,a,x.ncontours);n.size=r.dtick,n.start=g.tickFirst(r),r.range.reverse(),n.end=g.tickFirst(r),n.start===t&&(n.start+=n.size),n.end===a&&(n.end-=n.size),n.start>n.end&&(n.start=n.end=(n.start+n.end)/2),x._input.contours||(x._input.contours={}),v.extendFlat(x._input.contours,{start:n.start,end:n.end,size:n.size}),x._input.autocontour=!0}else if("constraint"!==n.type){var d,s=n.start,i=n.end,u=x._input.contours;s>i&&(n.start=u.start=i,i=n.end=u.end=s,s=n.start),!(n.size>0)&&(d=s===i?1:m(s,i,x.ncontours).dtick,u.size=n.size=d)}}},{"../../lib":515,"../../plots/cartesian/axes":566}],764:[function(y,ee,Q){"use strict";var g=y("@plotly/d3"),v=y("../../components/drawing"),m=y("../heatmap/style"),x=y("./make_color_map");ee.exports=function(e){var n=g.select(e).selectAll("g.contour");n.style("opacity",function(t){return t[0].trace.opacity}),n.each(function(t){var a=g.select(this),r=t[0].trace,d=r.contours,s=r.line,i=d.size||1,u=d.start,f="constraint"===d.type,c=!f&&"lines"===d.coloring,h=!f&&"fill"===d.coloring,p=c||h?x(r):null;a.selectAll("g.contourlevel").each(function(l){g.select(this).selectAll("path").call(v.lineGroupStyle,s.width,c?p(l.level):s.color,s.dash)});var o=d.labelfont;if(a.selectAll("g.contourlabels text").each(function(l){v.font(g.select(this),{family:o.family,size:o.size,color:o.color||(c?p(l.level):s.color)})}),f)a.selectAll("g.contourfill path").style("fill",r.fillcolor);else if(h){var b;a.selectAll("g.contourfill path").style("fill",function(l){return void 0===b&&(b=l.level),p(l.level+.5*i)}),void 0===b&&(b=u),a.selectAll("g.contourbg path").style("fill",p(b-.5*i))}}),m(e)}},{"../../components/drawing":389,"../heatmap/style":814,"./make_color_map":760,"@plotly/d3":58}],765:[function(y,ee,Q){"use strict";var g=y("../../components/colorscale/defaults"),v=y("./label_defaults");ee.exports=function(m,x,e,n,t){var a,r=e("contours.coloring"),d="";"fill"===r&&(a=e("contours.showlines")),!1!==a&&("lines"!==r&&(d=e("line.color","#000")),e("line.width",.5),e("line.dash")),"none"!==r&&(!0!==m.showlegend&&(x.showlegend=!1),x._dfltShowLegend=!1,g(m,x,n,e,{prefix:"",cLetter:"z"})),e("line.smoothing"),v(e,n,d,t)}},{"../../components/colorscale/defaults":377,"./label_defaults":759}],766:[function(y,ee,Q){"use strict";var g=y("../heatmap/attributes"),v=y("../contour/attributes"),m=y("../../components/colorscale/attributes"),x=y("../../lib/extend").extendFlat,e=v.contours;ee.exports=x({carpet:{valType:"string",editType:"calc"},z:g.z,a:g.x,a0:g.x0,da:g.dx,b:g.y,b0:g.y0,db:g.dy,text:g.text,hovertext:g.hovertext,transpose:g.transpose,atype:g.xtype,btype:g.ytype,fillcolor:v.fillcolor,autocontour:v.autocontour,ncontours:v.ncontours,contours:{type:e.type,start:e.start,end:e.end,size:e.size,coloring:{valType:"enumerated",values:["fill","lines","none"],dflt:"fill",editType:"calc"},showlines:e.showlines,showlabels:e.showlabels,labelfont:e.labelfont,labelformat:e.labelformat,operation:e.operation,value:e.value,editType:"calc",impliedEdits:{autocontour:!1}},line:{color:v.line.color,width:v.line.width,dash:v.line.dash,smoothing:v.line.smoothing,editType:"plot"},transforms:void 0},m("",{cLetter:"z",autoColorDflt:!1}))},{"../../components/colorscale/attributes":374,"../../lib/extend":505,"../contour/attributes":744,"../heatmap/attributes":801}],767:[function(y,ee,Q){"use strict";var g=y("../../components/colorscale/calc"),v=y("../../lib"),m=y("../heatmap/convert_column_xyz"),x=y("../heatmap/clean_2d_array"),e=y("../heatmap/interp2d"),n=y("../heatmap/find_empties"),t=y("../heatmap/make_bound_array"),a=y("./defaults"),r=y("../carpet/lookup_carpetid"),d=y("../contour/set_contours");ee.exports=function(s,i){var u=i._carpetTrace=r(s,i);if(u&&u.visible&&"legendonly"!==u.visible){if(!i.a||!i.b){var f=s.data[u.index],c=s.data[i.index];c.a||(c.a=f.a),c.b||(c.b=f.b),a(c,i,i._defaultColor,s._fullLayout)}var h=function(p,o){var b,l,T,_,w,k,L,M=o._carpetTrace,I=M.aaxis,P=M.baxis;I._minDtick=0,P._minDtick=0,v.isArray1D(o.z)&&m(o,I,P,"a","b",["z"]),b=o._a=o._a||o.a,_=o._b=o._b||o.b,b=b?I.makeCalcdata(o,"_a"):[],_=_?P.makeCalcdata(o,"_b"):[],l=o.a0||0,T=o.da||1,w=o.b0||0,k=o.db||1,L=o._z=x(o._z||o.z,o.transpose),o._emptypoints=n(L),e(L,o._emptypoints);var S=v.maxRowLength(L),V={a:t(o,"scaled"===o.xtype?"":b,l,T,S,I),b:t(o,"scaled"===o.ytype?"":_,w,k,L.length,P),z:L};return"levels"===o.contours.type&&"none"!==o.contours.coloring&&g(p,o,{vals:L,containerStr:"",cLetter:"z"}),[V]}(s,i);return d(i,i._z),h}}},{"../../components/colorscale/calc":375,"../../lib":515,"../carpet/lookup_carpetid":717,"../contour/set_contours":763,"../heatmap/clean_2d_array":803,"../heatmap/convert_column_xyz":805,"../heatmap/find_empties":807,"../heatmap/interp2d":810,"../heatmap/make_bound_array":812,"./defaults":768}],768:[function(y,ee,Q){"use strict";var g=y("../../lib"),v=y("../heatmap/xyz_defaults"),m=y("./attributes"),x=y("../contour/constraint_defaults"),e=y("../contour/contours_defaults"),n=y("../contour/style_defaults");ee.exports=function(t,a,r,d){function s(i,u){return g.coerce(t,a,m,i,u)}if(s("carpet"),t.a&&t.b){if(!v(t,a,s,d,"a","b"))return void(a.visible=!1);s("text"),"constraint"===s("contours.type")?x(t,a,s,d,r,{hasHover:!1}):(e(t,a,s,function(i){return g.coerce2(t,a,m,i)}),n(t,a,s,d,{hasHover:!1}))}else a._defaultColor=r,a._length=null}},{"../../lib":515,"../contour/constraint_defaults":749,"../contour/contours_defaults":751,"../contour/style_defaults":765,"../heatmap/xyz_defaults":816,"./attributes":766}],769:[function(y,ee,Q){"use strict";ee.exports={attributes:y("./attributes"),supplyDefaults:y("./defaults"),colorbar:y("../contour/colorbar"),calc:y("./calc"),plot:y("./plot"),style:y("../contour/style"),moduleType:"trace",name:"contourcarpet",basePlotModule:y("../../plots/cartesian"),categories:["cartesian","svg","carpet","contour","symbols","showLegend","hasLines","carpetDependent","noHover","noSortingByValue"],meta:{}}},{"../../plots/cartesian":578,"../contour/colorbar":747,"../contour/style":764,"./attributes":766,"./calc":767,"./defaults":768,"./plot":770}],770:[function(y,ee,Q){"use strict";var g=y("@plotly/d3"),v=y("../carpet/map_1d_array"),m=y("../carpet/makepath"),x=y("../../components/drawing"),e=y("../../lib"),n=y("../contour/make_crossings"),t=y("../contour/find_all_paths"),a=y("../contour/plot"),r=y("../contour/constants"),d=y("../contour/convert_to_constraints"),s=y("../contour/empty_pathinfo"),i=y("../contour/close_boundaries"),u=y("../carpet/lookup_carpetid"),f=y("../carpet/axis_aligned_line");function c(o,b,l){var T=o.getPointAtLength(b),_=o.getPointAtLength(l),w=_.x-T.x,k=_.y-T.y,L=Math.sqrt(w*w+k*k);return[w/L,k/L]}function h(o){var b=Math.sqrt(o[0]*o[0]+o[1]*o[1]);return[o[0]/b,o[1]/b]}function p(o,b){var l=Math.abs(o[0]*b[0]+o[1]*b[1]);return Math.sqrt(1-l*l)/l}ee.exports=function(o,b,l,T){var _=b.xaxis,w=b.yaxis;e.makeTraceGroups(T,l,"contour").each(function(k){var L=g.select(this),M=k[0],I=M.trace,P=I._carpetTrace=u(o,I),S=o.calcdata[P.index][0];if(P.visible&&"legendonly"!==P.visible){var E=M.a,z=M.b,R=I.contours,q=s(R,b,M),V="constraint"===R.type,W=R._operation,K=V?"="===W?"lines":"fill":R.coloring,G=[[E[0],z[z.length-1]],[E[E.length-1],z[z.length-1]],[E[E.length-1],z[0]],[E[0],z[0]]];n(q),t(q,1e-8*(E[E.length-1]-E[0]),1e-8*(z[z.length-1]-z[0]));var B,N,U,te,j=q;"constraint"===R.type&&(j=d(q,W)),function(ne,le){var oe,de,se,ge,_e,Te,we,Oe,fe;for(oe=0;oe<ne.length;oe++){for(_e=(ge=ne[oe]).pedgepaths=[],Te=ge.ppaths=[],de=0;de<ge.edgepaths.length;de++){for(fe=ge.edgepaths[de],we=[],se=0;se<fe.length;se++)we[se]=le(fe[se]);_e.push(we)}for(de=0;de<ge.paths.length;de++){for(fe=ge.paths[de],Oe=[],se=0;se<fe.length;se++)Oe[se]=le(fe[se]);Te.push(Oe)}}}(q,re);var J=[];for(te=S.clipsegments.length-1;te>=0;te--)N=v([],(B=S.clipsegments[te]).x,_.c2p),U=v([],B.y,w.c2p),N.reverse(),U.reverse(),J.push(m(N,U,B.bicubic));var X="M"+J.join("L")+"Z";(function(ne,le,oe,de,se,ge){var _e,Te,we,Oe,fe=e.ensureSingle(ne,"g","contourbg").selectAll("path").data("fill"!==ge||se?[]:[0]);fe.enter().append("path"),fe.exit().remove();var ve=[];for(Oe=0;Oe<le.length;Oe++)Te=v([],(_e=le[Oe]).x,oe.c2p),we=v([],_e.y,de.c2p),ve.push(m(Te,we,_e.bicubic));fe.attr("d","M"+ve.join("L")+"Z").style("stroke","none")})(L,S.clipsegments,_,w,V,K),function(ne,le,oe,de,se,ge,_e,Te,we,Oe,fe){var ve="fill"===Oe;ve&&i(se,ne.contours);var Ae=e.ensureSingle(le,"g","contourfill").selectAll("path").data(ve?se:[]);Ae.enter().append("path"),Ae.exit().remove(),Ae.each(function(ke){var Pe=(ke.prefixBoundary?fe:"")+function(Ne,De,ze,Me,Se,Ie,Fe,Re){var Xe,nt,ct,xt,dt,tt,Ke,mt="",Bt=De.edgepaths.map(function(Ge,Je){return Je}),Ut=!0,er=1e-4*Math.abs(ze[0][0]-ze[2][0]),Wt=1e-4*Math.abs(ze[0][1]-ze[2][1]);function rr(Ge){return Math.abs(Ge[1]-ze[0][1])<Wt}function Ht(Ge){return Math.abs(Ge[1]-ze[2][1])<Wt}function Ve(Ge){return Math.abs(Ge[0]-ze[0][0])<er}function We(Ge){return Math.abs(Ge[0]-ze[2][0])<er}function he(Ge,Je){var He,st,ot,wt,Ct="";for(rr(Ge)&&!We(Ge)||Ht(Ge)&&!Ve(Ge)?(wt=Se.aaxis,ot=f(Se,Ie,[Ge[0],Je[0]],.5*(Ge[1]+Je[1]))):(wt=Se.baxis,ot=f(Se,Ie,.5*(Ge[0]+Je[0]),[Ge[1],Je[1]])),He=1;He<ot.length;He++)for(Ct+=wt.smoothing?"C":"L",st=0;st<ot[He].length;st++){var rt=ot[He][st];Ct+=[Fe.c2p(rt[0]),Re.c2p(rt[1])]+" "}return Ct}for(Xe=0,nt=null;Bt.length;){for(nt&&(mt+=he(nt,De.edgepaths[Xe][0])),Ke=x.smoothopen(De.edgepaths[Xe].map(Me),De.smoothing),mt+=Ut?Ke:Ke.replace(/^M/,"L"),Bt.splice(Bt.indexOf(Xe),1),nt=De.edgepaths[Xe][De.edgepaths[Xe].length-1],dt=-1,xt=0;xt<4;xt++){if(!nt){e.log("Missing end?",Xe,De);break}for(rr(nt)&&!We(nt)?ct=ze[1]:Ve(nt)?ct=ze[0]:Ht(nt)?ct=ze[3]:We(nt)&&(ct=ze[2]),tt=0;tt<De.edgepaths.length;tt++){var Be=De.edgepaths[tt][0];Math.abs(nt[0]-ct[0])<er?Math.abs(nt[0]-Be[0])<er&&(Be[1]-nt[1])*(ct[1]-Be[1])>=0&&(ct=Be,dt=tt):Math.abs(nt[1]-ct[1])<Wt?Math.abs(nt[1]-Be[1])<Wt&&(Be[0]-nt[0])*(ct[0]-Be[0])>=0&&(ct=Be,dt=tt):e.log("endpt to newendpt is not vert. or horz.",nt,ct,Be)}if(dt>=0)break;mt+=he(nt,ct),nt=ct}if(dt===De.edgepaths.length){e.log("unclosed perimeter path");break}(Ut=-1===Bt.indexOf(Xe=dt))&&(Xe=Bt[0],mt+=he(nt,ct)+"Z",nt=null)}for(Xe=0;Xe<De.paths.length;Xe++)mt+=x.smoothclosed(De.paths[Xe].map(Me),De.smoothing);return mt}(0,ke,ge,_e,Te,we,oe,de);Pe?g.select(this).attr("d",Pe).style("stroke","none"):g.select(this).remove()})}(I,L,_,w,j,G,re,P,S,K,X),function(ne,le,oe,de,se,ge,_e){var Te=e.ensureSingle(ne,"g","contourlines"),we=!1!==se.showlines,Oe=se.showlabels,fe=we&&Oe,ve=a.createLines(Te,we||Oe,le),Ae=a.createLineClip(Te,fe,oe,de.trace.uid),ke=ne.selectAll("g.contourlabels").data(Oe?[0]:[]);if(ke.exit().remove(),ke.enter().append("g").classed("contourlabels",!0),Oe){var De=ge.xaxis._length,ze=ge.yaxis._length,Me=[[[0,0],[De,0],[De,ze],[0,ze]]],Se=[];e.clearLocationCache();var Ie=a.labelFormatter(oe,de),Fe=x.tester.append("text").attr("data-notex",1).call(x.font,se.labelfont),Re={left:0,right:De,center:De/2,top:0,bottom:ze,middle:ze/2},Xe=Math.sqrt(De*De+ze*ze),nt=r.LABELDISTANCE*Xe/Math.max(1,le.length/r.LABELINCREASE);ve.each(function(ct){var xt=a.calcTextOpts(ct.level,Ie,Fe,oe);g.select(this).selectAll("path").each(function(dt){var tt=e.getVisibleSegment(this,Re,xt.height/2);if(tt&&(function(Ut,er,Wt,rr,Ht,Ve){for(var We,he=0;he<Wt.pedgepaths.length;he++)er===Wt.pedgepaths[he]&&(We=Wt.edgepaths[he]);if(We){var ye=Ht.a[0],Be=Ht.a[Ht.a.length-1],Ge=Ht.b[0],Je=Ht.b[Ht.b.length-1],st=c(Ut,0,1),ot=c(Ut,rr.total,rr.total-1),wt=He(We[0],st),Ct=rr.total-He(We[We.length-1],ot);rr.min<wt&&(rr.min=wt),rr.max>Ct&&(rr.max=Ct),rr.len=rr.max-rr.min}function He(rt,ft){var Rt,kt=0;return(Math.abs(rt[0]-ye)<.1||Math.abs(rt[0]-Be)<.1)&&(Rt=h(Ht.dxydb_rough(rt[0],rt[1],.1)),kt=Math.max(kt,Ve*p(ft,Rt)/2)),(Math.abs(rt[1]-Ge)<.1||Math.abs(rt[1]-Je)<.1)&&(Rt=h(Ht.dxyda_rough(rt[0],rt[1],.1)),kt=Math.max(kt,Ve*p(ft,Rt)/2)),kt}}(this,dt,ct,tt,_e,xt.height),!(tt.len<(xt.width+xt.height)*r.LABELMIN)))for(var Ke=Math.min(Math.ceil(tt.len/nt),r.LABELMAX),mt=0;mt<Ke;mt++){var Bt=a.findBestTextLocation(this,tt,xt,Se,Re);if(!Bt)break;a.addLabelData(Bt,xt,Se,Me)}})}),Fe.remove(),a.drawLabels(ke,Se,oe,Ae,fe?Me:null)}Oe&&!we&&ve.remove()}(L,q,o,M,R,b,P),x.setClipUrl(L,P._clipPathId,o)}function re(ne){var le=P.ab2xy(ne[0],ne[1],!0);return[_.c2p(le[0]),w.c2p(le[1])]}})}},{"../../components/drawing":389,"../../lib":515,"../carpet/axis_aligned_line":701,"../carpet/lookup_carpetid":717,"../carpet/makepath":718,"../carpet/map_1d_array":719,"../contour/close_boundaries":746,"../contour/constants":748,"../contour/convert_to_constraints":752,"../contour/empty_pathinfo":754,"../contour/find_all_paths":756,"../contour/make_crossings":761,"../contour/plot":762,"@plotly/d3":58}],771:[function(y,ee,Q){"use strict";var g=y("../../components/colorscale/attributes"),v=y("../../plots/template_attributes").hovertemplateAttrs,m=y("../../plots/attributes"),x=y("../scattermapbox/attributes"),e=y("../../lib/extend").extendFlat;ee.exports=e({lon:x.lon,lat:x.lat,z:{valType:"data_array",editType:"calc"},radius:{valType:"number",editType:"plot",arrayOk:!0,min:1,dflt:30},below:{valType:"string",editType:"plot"},text:x.text,hovertext:x.hovertext,hoverinfo:e({},m.hoverinfo,{flags:["lon","lat","z","text","name"]}),hovertemplate:v(),showlegend:e({},m.showlegend,{dflt:!1})},g("",{cLetter:"z",editTypeOverride:"calc"}))},{"../../components/colorscale/attributes":374,"../../lib/extend":505,"../../plots/attributes":562,"../../plots/template_attributes":642,"../scattermapbox/attributes":1002}],772:[function(y,ee,Q){"use strict";var g=y("fast-isnumeric"),v=y("../../lib").isArrayOrTypedArray,m=y("../../constants/numerical").BADNUM,x=y("../../components/colorscale/calc"),e=y("../../lib")._;ee.exports=function(n,t){for(var a=t._length,r=new Array(a),d=t.z,s=v(d)&&d.length,i=0;i<a;i++){var u=r[i]={},f=t.lon[i],c=t.lat[i];if(u.lonlat=g(f)&&g(c)?[+f,+c]:[m,m],s){var h=d[i];u.z=g(h)?h:m}}return x(n,t,{vals:s?d:[0,1],containerStr:"",cLetter:"z"}),a&&(r[0].t={labels:{lat:e(n,"lat:")+" ",lon:e(n,"lon:")+" "}}),r}},{"../../components/colorscale/calc":375,"../../constants/numerical":491,"../../lib":515,"fast-isnumeric":190}],773:[function(y,ee,Q){"use strict";var g=y("fast-isnumeric"),v=y("../../lib"),m=y("../../components/color"),x=y("../../components/colorscale"),e=y("../../constants/numerical").BADNUM,n=y("../../lib/geojson_utils").makeBlank;ee.exports=function(t){var a=t[0].trace,r=!0===a.visible&&0!==a._length,d=a._opts={heatmap:{layout:{visibility:"none"},paint:{}},geojson:n()};if(!r)return d;var s,i=[],u=a.z,f=a.radius,c=v.isArrayOrTypedArray(u)&&u.length,h=v.isArrayOrTypedArray(f);for(s=0;s<t.length;s++){var p=t[s],o=p.lonlat;if(o[0]!==e){var b={};if(c){var l=p.z;b.z=l!==e?l:0}h&&(b.r=g(f[s])&&f[s]>0?+f[s]:0),i.push({type:"Feature",geometry:{type:"Point",coordinates:o},properties:b})}}var T=x.extractOpts(a),_=T.reversescale?x.flipScale(T.colorscale):T.colorscale,w=_[0][1],k=["interpolate",["linear"],["heatmap-density"],0,m.opacity(w)<1?w:m.addOpacity(w,0)];for(s=1;s<_.length;s++)k.push(_[s][0],_[s][1]);return v.extendFlat(d.heatmap.paint,{"heatmap-weight":c?["interpolate",["linear"],["get","z"],T.min,0,T.max,1]:1/(T.max-T.min),"heatmap-color":k,"heatmap-radius":h?{type:"identity",property:"r"}:a.radius,"heatmap-opacity":a.opacity}),d.geojson={type:"FeatureCollection",features:i},d.heatmap.layout.visibility="visible",d}},{"../../components/color":367,"../../components/colorscale":379,"../../constants/numerical":491,"../../lib":515,"../../lib/geojson_utils":509,"fast-isnumeric":190}],774:[function(y,ee,Q){"use strict";var g=y("../../lib"),v=y("../../components/colorscale/defaults"),m=y("./attributes");ee.exports=function(x,e,n,t){function a(i,u){return g.coerce(x,e,m,i,u)}var r=a("lon")||[],d=a("lat")||[],s=Math.min(r.length,d.length);s?(e._length=s,a("z"),a("radius"),a("below"),a("text"),a("hovertext"),a("hovertemplate"),v(x,e,t,a,{prefix:"",cLetter:"z"})):e.visible=!1}},{"../../components/colorscale/defaults":377,"../../lib":515,"./attributes":771}],775:[function(y,ee,Q){"use strict";ee.exports=function(g,v){return g.lon=v.lon,g.lat=v.lat,g.z=v.z,g}},{}],776:[function(y,ee,Q){"use strict";var g=y("../../plots/cartesian/axes"),v=y("../scattermapbox/hover").hoverPoints,m=y("../scattermapbox/hover").getExtraText;ee.exports=function(x,e,n){var t=v(x,e,n);if(t){var a=t[0],r=a.cd,d=r[0].trace,s=r[a.index];if(delete a.color,"z"in s){var i=a.subplot.mockAxis;a.z=s.z,a.zLabel=g.tickText(i,i.c2l(s.z),"hover").text}return a.extraText=m(d,s,r[0].t.labels),[a]}}},{"../../plots/cartesian/axes":566,"../scattermapbox/hover":1007}],777:[function(y,ee,Q){"use strict";ee.exports={attributes:y("./attributes"),supplyDefaults:y("./defaults"),colorbar:y("../heatmap/colorbar"),formatLabels:y("../scattermapbox/format_labels"),calc:y("./calc"),plot:y("./plot"),hoverPoints:y("./hover"),eventData:y("./event_data"),getBelow:function(g,v){for(var m=v.getMapLayers(),x=0;x<m.length;x++){var e=m[x],n=e.id;if("symbol"===e.type&&"string"==typeof n&&-1===n.indexOf("plotly-"))return n}},moduleType:"trace",name:"densitymapbox",basePlotModule:y("../../plots/mapbox"),categories:["mapbox","gl","showLegend"],meta:{hr_name:"density_mapbox"}}},{"../../plots/mapbox":622,"../heatmap/colorbar":804,"../scattermapbox/format_labels":1006,"./attributes":771,"./calc":772,"./defaults":774,"./event_data":775,"./hover":776,"./plot":778}],778:[function(y,ee,Q){"use strict";var g=y("./convert"),v=y("../../plots/mapbox/constants").traceLayerPrefix;function m(e,n){this.type="densitymapbox",this.subplot=e,this.uid=n,this.sourceId="source-"+n,this.layerList=[["heatmap",v+n+"-heatmap"]],this.below=null}var x=m.prototype;x.update=function(e){var n=this.subplot,t=this.layerList,a=g(e),r=n.belowLookup["trace-"+this.uid];n.map.getSource(this.sourceId).setData(a.geojson),r!==this.below&&(this._removeLayers(),this._addLayers(a,r),this.below=r);for(var d=0;d<t.length;d++){var s=t[d],u=s[1],f=a[s[0]];n.setOptions(u,"setLayoutProperty",f.layout),"visible"===f.layout.visibility&&n.setOptions(u,"setPaintProperty",f.paint)}},x._addLayers=function(e,n){for(var t=this.subplot,a=this.layerList,r=this.sourceId,d=0;d<a.length;d++){var s=a[d],i=s[0],u=e[i];t.addLayer({type:i,id:s[1],source:r,layout:u.layout,paint:u.paint},n)}},x._removeLayers=function(){for(var e=this.subplot.map,n=this.layerList,t=n.length-1;t>=0;t--)e.removeLayer(n[t][1])},x.dispose=function(){var e=this.subplot.map;this._removeLayers(),e.removeSource(this.sourceId)},ee.exports=function(e,n){var t=n[0].trace,a=new m(e,t.uid),r=a.sourceId,d=g(n),s=a.below=e.belowLookup["trace-"+t.uid];return e.map.addSource(r,{type:"geojson",data:d.geojson}),a._addLayers(d,s),a}},{"../../plots/mapbox/constants":620,"./convert":773}],779:[function(y,ee,Q){"use strict";var g=y("../../lib");ee.exports=function(v,m){for(var x=0;x<v.length;x++)v[x].i=x;g.mergeArray(m.text,v,"tx"),g.mergeArray(m.hovertext,v,"htx");var e=m.marker;if(e){g.mergeArray(e.opacity,v,"mo"),g.mergeArray(e.color,v,"mc");var n=e.line;n&&(g.mergeArray(n.color,v,"mlc"),g.mergeArrayCastPositive(n.width,v,"mlw"))}}},{"../../lib":515}],780:[function(y,ee,Q){"use strict";var g,v=y("../bar/attributes"),m=y("../scatter/attributes").line,x=y("../../plots/attributes"),e=y("../../plots/cartesian/axis_format_attributes").axisHoverFormat,n=y("../../plots/template_attributes").hovertemplateAttrs,t=y("../../plots/template_attributes").texttemplateAttrs,a=y("./constants"),r=y("../../lib/extend").extendFlat,d=y("../../components/color");ee.exports={x:v.x,x0:v.x0,dx:v.dx,y:v.y,y0:v.y0,dy:v.dy,xperiod:v.xperiod,yperiod:v.yperiod,xperiod0:v.xperiod0,yperiod0:v.yperiod0,xperiodalignment:v.xperiodalignment,yperiodalignment:v.yperiodalignment,xhoverformat:e("x"),yhoverformat:e("y"),hovertext:v.hovertext,hovertemplate:n({},{keys:a.eventDataKeys}),hoverinfo:r({},x.hoverinfo,{flags:["name","x","y","text","percent initial","percent previous","percent total"]}),textinfo:{valType:"flaglist",flags:["label","text","percent initial","percent previous","percent total","value"],extras:["none"],editType:"plot",arrayOk:!1},texttemplate:t({editType:"plot"},{keys:a.eventDataKeys.concat(["label","value"])}),text:v.text,textposition:v.textposition,insidetextanchor:r({},v.insidetextanchor,{dflt:"middle"}),textangle:r({},v.textangle,{dflt:0}),textfont:v.textfont,insidetextfont:v.insidetextfont,outsidetextfont:v.outsidetextfont,constraintext:v.constraintext,cliponaxis:v.cliponaxis,orientation:r({},v.orientation,{}),offset:r({},v.offset,{arrayOk:!1}),width:r({},v.width,{arrayOk:!1}),marker:(g=r({},v.marker),delete g.pattern,g),connector:{fillcolor:{valType:"color",editType:"style"},line:{color:r({},m.color,{dflt:d.defaultLine}),width:r({},m.width,{dflt:0,editType:"plot"}),dash:m.dash,editType:"style"},visible:{valType:"boolean",dflt:!0,editType:"plot"},editType:"plot"},offsetgroup:v.offsetgroup,alignmentgroup:v.alignmentgroup}},{"../../components/color":367,"../../lib/extend":505,"../../plots/attributes":562,"../../plots/cartesian/axis_format_attributes":569,"../../plots/template_attributes":642,"../bar/attributes":657,"../scatter/attributes":936,"./constants":782}],781:[function(y,ee,Q){"use strict";var g=y("../../plots/cartesian/axes"),v=y("../../plots/cartesian/align_period"),m=y("./arrays_to_calcdata"),x=y("../scatter/calc_selection"),e=y("../../constants/numerical").BADNUM;function n(t){return t===e?0:t}ee.exports=function(t,a){var r,d,s,i,u,f,c,h,p=g.getFromId(t,a.xaxis||"x"),o=g.getFromId(t,a.yaxis||"y");"h"===a.orientation?(r=p.makeCalcdata(a,"x"),s=o.makeCalcdata(a,"y"),i=v(a,o,"y",s),u=!!a.yperiodalignment,f="y"):(r=o.makeCalcdata(a,"y"),s=p.makeCalcdata(a,"x"),i=v(a,p,"x",s),u=!!a.xperiodalignment,f="x"),d=i.vals;var b,l=Math.min(d.length,r.length),T=new Array(l);for(a._base=[],c=0;c<l;c++){r[c]<0&&(r[c]=e);var _=!1;r[c]!==e&&c+1<l&&r[c+1]!==e&&(_=!0),h=T[c]={p:d[c],s:r[c],cNext:_},a._base[c]=-.5*h.s,u&&(T[c].orig_p=s[c],T[c][f+"End"]=i.ends[c],T[c][f+"Start"]=i.starts[c]),a.ids&&(h.id=String(a.ids[c])),0===c&&(T[0].vTotal=0),T[0].vTotal+=n(h.s),h.begR=n(h.s)/n(T[0].s)}for(c=0;c<l;c++)(h=T[c]).s!==e&&(h.sumR=h.s/T[0].vTotal,h.difR=void 0!==b?h.s/b:1,b=h.s);return m(T,a),x(T,a),T}},{"../../constants/numerical":491,"../../plots/cartesian/align_period":563,"../../plots/cartesian/axes":566,"../scatter/calc_selection":938,"./arrays_to_calcdata":779}],782:[function(y,ee,Q){"use strict";ee.exports={eventDataKeys:["percentInitial","percentPrevious","percentTotal"]}},{}],783:[function(y,ee,Q){"use strict";var g=y("../bar/cross_trace_calc").setGroupPositions;ee.exports=function(v,m){var x,e,n=v._fullLayout,t=v._fullData,a=v.calcdata,r=m.xaxis,d=m.yaxis,s=[],i=[],u=[];for(e=0;e<t.length;e++){var f=t[e];!0===f.visible&&f.xaxis===r._id&&f.yaxis===d._id&&"funnel"===f.type&&(x=a[e],"h"===f.orientation?u.push(x):i.push(x),s.push(x))}var h={mode:n.funnelmode,norm:n.funnelnorm,gap:n.funnelgap,groupgap:n.funnelgroupgap};for(g(v,r,d,i,h),g(v,d,r,u,h),e=0;e<s.length;e++){x=s[e];for(var p=0;p<x.length;p++)p+1<x.length&&(x[p].nextP0=x[p+1].p0,x[p].nextS0=x[p+1].s0,x[p].nextP1=x[p+1].p1,x[p].nextS1=x[p+1].s1)}}},{"../bar/cross_trace_calc":660}],784:[function(y,ee,Q){"use strict";var g=y("../../lib"),v=y("../bar/defaults").handleGroupingDefaults,m=y("../bar/defaults").handleText,x=y("../scatter/xy_defaults"),e=y("../scatter/period_defaults"),n=y("./attributes"),t=y("../../components/color");ee.exports={supplyDefaults:function(a,r,d,s){function i(h,p){return g.coerce(a,r,n,h,p)}if(x(a,r,s,i)){e(a,r,s,i),i("xhoverformat"),i("yhoverformat"),i("orientation",r.y&&!r.x?"v":"h"),i("offset"),i("width");var u=i("text");i("hovertext"),i("hovertemplate");var f=i("textposition");m(a,r,s,i,f,{moduleHasSelected:!1,moduleHasUnselected:!1,moduleHasConstrain:!0,moduleHasCliponaxis:!0,moduleHasTextangle:!0,moduleHasInsideanchor:!0}),"none"===r.textposition||r.texttemplate||i("textinfo",Array.isArray(u)?"text+value":"value");var c=i("marker.color",d);i("marker.line.color",t.defaultLine),i("marker.line.width"),i("connector.visible")&&(i("connector.fillcolor",(p=g.isArrayOrTypedArray(h=c)?"#000":h,t.addOpacity(p,.5*t.opacity(p)))),i("connector.line.width")&&(i("connector.line.color"),i("connector.line.dash")))}else r.visible=!1;var h,p},crossTraceDefaults:function(a,r){var d,s;function i(f){return g.coerce(s._input,s,n,f)}if("group"===r.funnelmode)for(var u=0;u<a.length;u++)d=(s=a[u])._input,v(d,s,r,i)}}},{"../../components/color":367,"../../lib":515,"../bar/defaults":661,"../scatter/period_defaults":956,"../scatter/xy_defaults":963,"./attributes":780}],785:[function(y,ee,Q){"use strict";ee.exports=function(g,v){return g.x="xVal"in v?v.xVal:v.x,g.y="yVal"in v?v.yVal:v.y,"percentInitial"in v&&(g.percentInitial=v.percentInitial),"percentPrevious"in v&&(g.percentPrevious=v.percentPrevious),"percentTotal"in v&&(g.percentTotal=v.percentTotal),v.xa&&(g.xaxis=v.xa),v.ya&&(g.yaxis=v.ya),g}},{}],786:[function(y,ee,Q){"use strict";var g=y("../../components/color").opacity,v=y("../bar/hover").hoverOnBars,m=y("../../lib").formatPercent;ee.exports=function(x,e,n,t,a){var l,T,_,w,k,r=v(x,e,n,t,a);if(r){var d=r.cd,s=d[0].trace,u=d[r.index];r[("h"===s.orientation?"x":"y")+"LabelVal"]=u.s,r.percentInitial=u.begR,r.percentInitialLabel=m(u.begR,1),r.percentPrevious=u.difR,r.percentPreviousLabel=m(u.difR,1),r.percentTotal=u.sumR,r.percentTotalLabel=m(u.sumR,1);var f=u.hi||s.hoverinfo,c=[];if(f&&"none"!==f&&"skip"!==f){var h="all"===f,p=f.split("+"),o=function(b){return h||-1!==p.indexOf(b)};o("percent initial")&&c.push(r.percentInitialLabel+" of initial"),o("percent previous")&&c.push(r.percentPreviousLabel+" of previous"),o("percent total")&&c.push(r.percentTotalLabel+" of total")}return r.extraText=c.join("<br>"),r.color=(T=s.marker,w=(l=u).mlc||T.line.color,k=l.mlw||T.line.width,g(_=l.mc||T.color)?_:g(w)&&k?w:void 0),[r]}}},{"../../components/color":367,"../../lib":515,"../bar/hover":664}],787:[function(y,ee,Q){"use strict";ee.exports={attributes:y("./attributes"),layoutAttributes:y("./layout_attributes"),supplyDefaults:y("./defaults").supplyDefaults,crossTraceDefaults:y("./defaults").crossTraceDefaults,supplyLayoutDefaults:y("./layout_defaults"),calc:y("./calc"),crossTraceCalc:y("./cross_trace_calc"),plot:y("./plot"),style:y("./style").style,hoverPoints:y("./hover"),eventData:y("./event_data"),selectPoints:y("../bar/select"),moduleType:"trace",name:"funnel",basePlotModule:y("../../plots/cartesian"),categories:["bar-like","cartesian","svg","oriented","showLegend","zoomScale"],meta:{}}},{"../../plots/cartesian":578,"../bar/select":669,"./attributes":780,"./calc":781,"./cross_trace_calc":783,"./defaults":784,"./event_data":785,"./hover":786,"./layout_attributes":788,"./layout_defaults":789,"./plot":790,"./style":791}],788:[function(y,ee,Q){"use strict";ee.exports={funnelmode:{valType:"enumerated",values:["stack","group","overlay"],dflt:"stack",editType:"calc"},funnelgap:{valType:"number",min:0,max:1,editType:"calc"},funnelgroupgap:{valType:"number",min:0,max:1,dflt:0,editType:"calc"}}},{}],789:[function(y,ee,Q){"use strict";var g=y("../../lib"),v=y("./layout_attributes");ee.exports=function(m,x,e){var n=!1;function t(d,s){return g.coerce(m,x,v,d,s)}for(var a=0;a<e.length;a++){var r=e[a];if(r.visible&&"funnel"===r.type){n=!0;break}}n&&(t("funnelmode"),t("funnelgap",.2),t("funnelgroupgap"))}},{"../../lib":515,"./layout_attributes":788}],790:[function(y,ee,Q){"use strict";var g=y("@plotly/d3"),v=y("../../lib"),m=y("../../components/drawing"),x=y("../../constants/numerical").BADNUM,e=y("../bar/plot"),n=y("../bar/uniform_text").clearMinTextSize;function t(a,r,d,s){var i=[],u=[],f=s?r:d,c=s?d:r;return i[0]=f.c2p(a.s0,!0),u[0]=c.c2p(a.p0,!0),i[1]=f.c2p(a.s1,!0),u[1]=c.c2p(a.p1,!0),i[2]=f.c2p(a.nextS0,!0),u[2]=c.c2p(a.nextP0,!0),i[3]=f.c2p(a.nextS1,!0),u[3]=c.c2p(a.nextP1,!0),s?[i,u]:[u,i]}ee.exports=function(a,r,d,s){var u,f,p,o,i=a._fullLayout;n("funnel",i),u=a,p=(f=r).xaxis,o=f.yaxis,v.makeTraceGroups(s,d,"trace bars").each(function(b){var l=g.select(this),T=b[0].trace,_=v.ensureSingle(l,"g","regions");if(T.connector&&T.connector.visible){var w="h"===T.orientation,k=_.selectAll("g.region").data(v.identity);k.enter().append("g").classed("region",!0),k.exit().remove();var L=k.size();k.each(function(M,I){if(I===L-1||M.cNext){var P=t(M,p,o,w),S=P[0],E=P[1],z="";S[0]!==x&&E[0]!==x&&S[1]!==x&&E[1]!==x&&S[2]!==x&&E[2]!==x&&S[3]!==x&&E[3]!==x&&(z+=w?"M"+S[0]+","+E[1]+"L"+S[2]+","+E[2]+"H"+S[3]+"L"+S[1]+","+E[1]+"Z":"M"+S[1]+","+E[1]+"L"+S[2]+","+E[3]+"V"+E[2]+"L"+S[1]+","+E[0]+"Z"),""===z&&(z="M0,0Z"),v.ensureSingle(g.select(this),"path").attr("d",z).call(m.setClipUrl,f.layerClipId,u)}})}else _.remove()}),function(u,f,c,h){var p=f.xaxis,o=f.yaxis;v.makeTraceGroups(h,c,"trace bars").each(function(b){var l=g.select(this),T=b[0].trace,_=v.ensureSingle(l,"g","lines");if(T.connector&&T.connector.visible&&T.connector.line.width){var w="h"===T.orientation,k=_.selectAll("g.line").data(v.identity);k.enter().append("g").classed("line",!0),k.exit().remove();var L=k.size();k.each(function(M,I){if(I===L-1||M.cNext){var P=t(M,p,o,w),S=P[0],E=P[1],z="";void 0!==S[3]&&void 0!==E[3]&&(w?(z+="M"+S[0]+","+E[1]+"L"+S[2]+","+E[2],z+="M"+S[1]+","+E[1]+"L"+S[3]+","+E[2]):(z+="M"+S[1]+","+E[1]+"L"+S[2]+","+E[3],z+="M"+S[1]+","+E[0]+"L"+S[2]+","+E[2])),""===z&&(z="M0,0Z"),v.ensureSingle(g.select(this),"path").attr("d",z).call(m.setClipUrl,f.layerClipId,u)}})}else _.remove()})}(a,r,d,s),e.plot(a,r,d,s,{mode:i.funnelmode,norm:i.funnelmode,gap:i.funnelgap,groupgap:i.funnelgroupgap})}},{"../../components/drawing":389,"../../constants/numerical":491,"../../lib":515,"../bar/plot":668,"../bar/uniform_text":673,"@plotly/d3":58}],791:[function(y,ee,Q){"use strict";var g=y("@plotly/d3"),v=y("../../components/drawing"),m=y("../../components/color"),x=y("../../constants/interactions").DESELECTDIM,e=y("../bar/style"),n=y("../bar/uniform_text").resizeText,t=e.styleTextPoints;ee.exports={style:function(a,r,d){var s=d||g.select(a).selectAll("g.funnellayer").selectAll("g.trace");n(a,s,"funnel"),s.style("opacity",function(i){return i[0].trace.opacity}),s.each(function(i){var u=g.select(this),f=i[0].trace;u.selectAll(".point > path").each(function(c){if(!c.isBlank){var h=f.marker;g.select(this).call(m.fill,c.mc||h.color).call(m.stroke,c.mlc||h.line.color).call(v.dashLine,h.line.dash,c.mlw||h.line.width).style("opacity",f.selectedpoints&&!c.selected?x:1)}}),t(u,f,a),u.selectAll(".regions").each(function(){g.select(this).selectAll("path").style("stroke-width",0).call(m.fill,f.connector.fillcolor)}),u.selectAll(".lines").each(function(){var c=f.connector.line;v.lineGroupStyle(g.select(this).selectAll("path"),c.width,c.color,c.dash)})})}}},{"../../components/color":367,"../../components/drawing":389,"../../constants/interactions":490,"../bar/style":671,"../bar/uniform_text":673,"@plotly/d3":58}],792:[function(y,ee,Q){"use strict";var g=y("../pie/attributes"),v=y("../../plots/attributes"),m=y("../../plots/domain").attributes,x=y("../../plots/template_attributes").hovertemplateAttrs,e=y("../../plots/template_attributes").texttemplateAttrs,n=y("../../lib/extend").extendFlat;ee.exports={labels:g.labels,label0:g.label0,dlabel:g.dlabel,values:g.values,marker:{colors:g.marker.colors,line:{color:n({},g.marker.line.color,{dflt:null}),width:n({},g.marker.line.width,{dflt:1}),editType:"calc"},editType:"calc"},text:g.text,hovertext:g.hovertext,scalegroup:n({},g.scalegroup,{}),textinfo:n({},g.textinfo,{flags:["label","text","value","percent"]}),texttemplate:e({editType:"plot"},{keys:["label","color","value","text","percent"]}),hoverinfo:n({},v.hoverinfo,{flags:["label","text","value","percent","name"]}),hovertemplate:x({},{keys:["label","color","value","text","percent"]}),textposition:n({},g.textposition,{values:["inside","none"],dflt:"inside"}),textfont:g.textfont,insidetextfont:g.insidetextfont,title:{text:g.title.text,font:g.title.font,position:n({},g.title.position,{values:["top left","top center","top right"],dflt:"top center"}),editType:"plot"},domain:m({name:"funnelarea",trace:!0,editType:"calc"}),aspectratio:{valType:"number",min:0,dflt:1,editType:"plot"},baseratio:{valType:"number",min:0,max:1,dflt:.333,editType:"plot"}}},{"../../lib/extend":505,"../../plots/attributes":562,"../../plots/domain":593,"../../plots/template_attributes":642,"../pie/attributes":910}],793:[function(y,ee,Q){"use strict";var g=y("../../plots/plots");Q.name="funnelarea",Q.plot=function(v,m,x,e){g.plotBasePlot(Q.name,v,m,x,e)},Q.clean=function(v,m,x,e){g.cleanBasePlot(Q.name,v,m,x,e)}},{"../../plots/plots":628}],794:[function(y,ee,Q){"use strict";var g=y("../pie/calc");ee.exports={calc:function(v,m){return g.calc(v,m)},crossTraceCalc:function(v){g.crossTraceCalc(v,{type:"funnelarea"})}}},{"../pie/calc":912}],795:[function(y,ee,Q){"use strict";var g=y("../../lib"),v=y("./attributes"),m=y("../../plots/domain").defaults,x=y("../bar/defaults").handleText,e=y("../pie/defaults").handleLabelsAndValues;ee.exports=function(n,t,a,r){function d(b,l){return g.coerce(n,t,v,b,l)}var s=d("labels"),i=d("values"),u=e(s,i),f=u.len;if(t._hasLabels=u.hasLabels,t._hasValues=u.hasValues,!t._hasLabels&&t._hasValues&&(d("label0"),d("dlabel")),f){t._length=f,d("marker.line.width")&&d("marker.line.color",r.paper_bgcolor),d("marker.colors"),d("scalegroup");var c,h=d("text"),p=d("texttemplate");if(p||(c=d("textinfo",Array.isArray(h)?"text+percent":"percent")),d("hovertext"),d("hovertemplate"),p||c&&"none"!==c){var o=d("textposition");x(n,t,r,d,o,{moduleHasSelected:!1,moduleHasUnselected:!1,moduleHasConstrain:!1,moduleHasCliponaxis:!1,moduleHasTextangle:!1,moduleHasInsideanchor:!1})}m(t,r,d),d("title.text")&&(d("title.position"),g.coerceFont(d,"title.font",r.font)),d("aspectratio"),d("baseratio")}else t.visible=!1}},{"../../lib":515,"../../plots/domain":593,"../bar/defaults":661,"../pie/defaults":913,"./attributes":792}],796:[function(y,ee,Q){"use strict";ee.exports={moduleType:"trace",name:"funnelarea",basePlotModule:y("./base_plot"),categories:["pie-like","funnelarea","showLegend"],attributes:y("./attributes"),layoutAttributes:y("./layout_attributes"),supplyDefaults:y("./defaults"),supplyLayoutDefaults:y("./layout_defaults"),calc:y("./calc").calc,crossTraceCalc:y("./calc").crossTraceCalc,plot:y("./plot"),style:y("./style"),styleOne:y("../pie/style_one"),meta:{}}},{"../pie/style_one":921,"./attributes":792,"./base_plot":793,"./calc":794,"./defaults":795,"./layout_attributes":797,"./layout_defaults":798,"./plot":799,"./style":800}],797:[function(y,ee,Q){"use strict";var g=y("../pie/layout_attributes").hiddenlabels;ee.exports={hiddenlabels:g,funnelareacolorway:{valType:"colorlist",editType:"calc"},extendfunnelareacolors:{valType:"boolean",dflt:!0,editType:"calc"}}},{"../pie/layout_attributes":917}],798:[function(y,ee,Q){"use strict";var g=y("../../lib"),v=y("./layout_attributes");ee.exports=function(m,x){function e(n,t){return g.coerce(m,x,v,n,t)}e("hiddenlabels"),e("funnelareacolorway",x.colorway),e("extendfunnelareacolors")}},{"../../lib":515,"./layout_attributes":797}],799:[function(y,ee,Q){"use strict";var g=y("@plotly/d3"),v=y("../../components/drawing"),m=y("../../lib"),x=m.strScale,e=m.strTranslate,n=y("../../lib/svg_text_utils"),t=y("../bar/plot").toMoveInsideBar,a=y("../bar/uniform_text"),r=a.recordMinTextSize,d=a.clearMinTextSize,s=y("../pie/helpers"),i=y("../pie/plot"),u=i.attachFxHandlers,f=i.determineInsideTextFont,c=i.layoutAreas,h=i.prerenderTitles,p=i.positionTitleOutside,o=i.formatSliceLabel;function b(l,T){return"l"+(T[0]-l[0])+","+(T[1]-l[1])}ee.exports=function(l,T){var _=l._fullLayout;d("funnelarea",_),h(T,l),c(T,_._size),m.makeTraceGroups(_._funnelarealayer,T,"trace").each(function(w){var k=g.select(this),L=w[0],M=L.trace;(function(I){if(I.length){var P=I[0],S=P.trace,E=S.aspectratio,z=S.baseratio;z>.999&&(z=.999);var R,Y,$,q=Math.pow(z,2),V=P.vTotal,W=V,K=V*q/(1-q)/V,B=[];for(B.push(G()),Y=I.length-1;Y>-1;Y--)($=I[Y]).hidden||(K+=$.v/W,B.push(G()));var U=1/0,te=-1/0;for(Y=0;Y<B.length;Y++)R=B[Y],U=Math.min(U,R[1]),te=Math.max(te,R[1]);for(Y=0;Y<B.length;Y++)B[Y][1]-=(te+U)/2;var J=P.r,X=(te-U)/2,re=J/B[B.length-1][0],ne=J/X*E;for(P.r=ne*X,Y=0;Y<B.length;Y++)B[Y][0]*=re,B[Y][1]*=ne;var _e,Te,le=[-(R=B[0])[0],R[1]],oe=[R[0],R[1]],de=0;for(Y=I.length-1;Y>-1;Y--)if(!($=I[Y]).hidden){var se=B[de+=1][0],ge=B[de][1];$.TL=[-se,ge],$.TR=[se,ge],$.BL=le,$.BR=oe,$.pxmid=[.5*((_e=$.TR)[0]+(Te=$.BR)[0]),.5*(_e[1]+Te[1])],le=$.TL,oe=$.TR}}function G(){var we,Oe={x:we=Math.sqrt(K),y:-we};return[Oe.x,Oe.y]}})(w),k.each(function(){var I=g.select(this).selectAll("g.slice").data(w);I.enter().append("g").classed("slice",!0),I.exit().remove(),I.each(function(S,E){if(S.hidden)g.select(this).selectAll("path,g").remove();else{S.pointNumber=S.i,S.curveNumber=M.index;var z=L.cx,R=L.cy,q=g.select(this),V=q.selectAll("path.surface").data([S]);V.enter().append("path").classed("surface",!0).style({"pointer-events":"all"}),q.call(u,l,w);var W="M"+(z+S.TR[0])+","+(R+S.TR[1])+b(S.TR,S.BR)+b(S.BR,S.BL)+b(S.BL,S.TL)+"Z";V.attr("d",W),o(l,S,L);var K=s.castOption(M.textposition,S.pts),G=q.selectAll("g.slicetext").data(S.text&&"none"!==K?[0]:[]);G.enter().append("g").classed("slicetext",!0),G.exit().remove(),G.each(function(){var Y=m.ensureSingle(g.select(this),"text","",function(X){X.attr("data-notex",1)}),$=m.ensureUniformFontSize(l,f(M,S,_.font));Y.text(S.text).attr({class:"slicetext",transform:"","text-anchor":"middle"}).call(v.font,$).call(n.convertToTspans,l);var B,N,U,te=v.bBox(Y.node()),j=Math.min(S.BL[1],S.BR[1])+R,J=Math.max(S.TL[1],S.TR[1])+R;N=Math.max(S.TL[0],S.BL[0])+z,U=Math.min(S.TR[0],S.BR[0])+z,(B=t(N,U,j,J,te,{isHorizontal:!0,constrained:!0,angle:0,anchor:"middle"})).fontSize=$.size,r(M.type,B,_),w[E].transform=B,Y.attr("transform",m.getTextTransform(B))})}});var P=g.select(this).selectAll("g.titletext").data(M.title.text?[0]:[]);P.enter().append("g").classed("titletext",!0),P.exit().remove(),P.each(function(){var S=m.ensureSingle(g.select(this),"text","",function(R){R.attr("data-notex",1)}),E=M.title.text;M._meta&&(E=m.templateString(E,M._meta)),S.text(E).attr({class:"titletext",transform:"","text-anchor":"middle"}).call(v.font,M.title.font).call(n.convertToTspans,l);var z=p(L,_._size);S.attr("transform",e(z.x,z.y)+x(Math.min(1,z.scale))+e(z.tx,z.ty))})})})}},{"../../components/drawing":389,"../../lib":515,"../../lib/svg_text_utils":541,"../bar/plot":668,"../bar/uniform_text":673,"../pie/helpers":915,"../pie/plot":919,"@plotly/d3":58}],800:[function(y,ee,Q){"use strict";var g=y("@plotly/d3"),v=y("../pie/style_one"),m=y("../bar/uniform_text").resizeText;ee.exports=function(x){var e=x._fullLayout._funnelarealayer.selectAll(".trace");m(x,e,"funnelarea"),e.each(function(n){var t=n[0].trace,a=g.select(this);a.style({opacity:t.opacity}),a.selectAll("path.surface").each(function(r){g.select(this).call(v,r,t)})})}},{"../bar/uniform_text":673,"../pie/style_one":921,"@plotly/d3":58}],801:[function(y,ee,Q){"use strict";var g=y("../scatter/attributes"),v=y("../../plots/attributes"),m=y("../../plots/font_attributes"),x=y("../../plots/cartesian/axis_format_attributes").axisHoverFormat,e=y("../../plots/template_attributes").hovertemplateAttrs,n=y("../../plots/template_attributes").texttemplateAttrs,t=y("../../components/colorscale/attributes"),a=y("../../lib/extend").extendFlat;ee.exports=a({z:{valType:"data_array",editType:"calc"},x:a({},g.x,{impliedEdits:{xtype:"array"}}),x0:a({},g.x0,{impliedEdits:{xtype:"scaled"}}),dx:a({},g.dx,{impliedEdits:{xtype:"scaled"}}),y:a({},g.y,{impliedEdits:{ytype:"array"}}),y0:a({},g.y0,{impliedEdits:{ytype:"scaled"}}),dy:a({},g.dy,{impliedEdits:{ytype:"scaled"}}),xperiod:a({},g.xperiod,{impliedEdits:{xtype:"scaled"}}),yperiod:a({},g.yperiod,{impliedEdits:{ytype:"scaled"}}),xperiod0:a({},g.xperiod0,{impliedEdits:{xtype:"scaled"}}),yperiod0:a({},g.yperiod0,{impliedEdits:{ytype:"scaled"}}),xperiodalignment:a({},g.xperiodalignment,{impliedEdits:{xtype:"scaled"}}),yperiodalignment:a({},g.yperiodalignment,{impliedEdits:{ytype:"scaled"}}),text:{valType:"data_array",editType:"calc"},hovertext:{valType:"data_array",editType:"calc"},transpose:{valType:"boolean",dflt:!1,editType:"calc"},xtype:{valType:"enumerated",values:["array","scaled"],editType:"calc+clearAxisTypes"},ytype:{valType:"enumerated",values:["array","scaled"],editType:"calc+clearAxisTypes"},zsmooth:{valType:"enumerated",values:["fast","best",!1],dflt:!1,editType:"calc"},hoverongaps:{valType:"boolean",dflt:!0,editType:"none"},connectgaps:{valType:"boolean",editType:"calc"},xgap:{valType:"number",dflt:0,min:0,editType:"plot"},ygap:{valType:"number",dflt:0,min:0,editType:"plot"},xhoverformat:x("x"),yhoverformat:x("y"),zhoverformat:x("z",1),hovertemplate:e(),texttemplate:n({arrayOk:!1,editType:"plot"},{keys:["x","y","z","text"]}),textfont:m({editType:"plot",autoSize:!0,autoColor:!0,colorEditType:"style"}),showlegend:a({},v.showlegend,{dflt:!1})},{transforms:void 0},t("",{cLetter:"z",autoColorDflt:!1}))},{"../../components/colorscale/attributes":374,"../../lib/extend":505,"../../plots/attributes":562,"../../plots/cartesian/axis_format_attributes":569,"../../plots/font_attributes":594,"../../plots/template_attributes":642,"../scatter/attributes":936}],802:[function(y,ee,Q){"use strict";var g=y("../../registry"),v=y("../../lib"),m=y("../../plots/cartesian/axes"),x=y("../../plots/cartesian/align_period"),e=y("../histogram2d/calc"),n=y("../../components/colorscale/calc"),t=y("./convert_column_xyz"),a=y("./clean_2d_array"),r=y("./interp2d"),d=y("./find_empties"),s=y("./make_bound_array"),i=y("../../constants/numerical").BADNUM;function u(f){for(var c=[],h=f.length,p=0;p<h;p++){var o=f[p];o!==i&&c.push(o)}return c}ee.exports=function(f,c){var h,p,o,b,l,T,_,w,k,L,M,I=m.getFromId(f,c.xaxis||"x"),P=m.getFromId(f,c.yaxis||"y"),S=g.traceIs(c,"contour"),E=g.traceIs(c,"histogram"),z=g.traceIs(c,"gl2d"),R=S?"best":c.zsmooth;if(I._minDtick=0,P._minDtick=0,E)b=(M=e(f,c)).orig_x,h=M.x,p=M.x0,o=M.dx,w=M.orig_y,l=M.y,T=M.y0,_=M.dy,k=M.z;else{var q=c.z;v.isArray1D(q)?(t(c,I,P,"x","y",["z"]),h=c._x,l=c._y,q=c._z):(b=c.x?I.makeCalcdata(c,"x"):[],w=c.y?P.makeCalcdata(c,"y"):[],h=x(c,I,"x",b).vals,l=x(c,P,"y",w).vals,c._x=h,c._y=l),p=c.x0,o=c.dx,T=c.y0,_=c.dy,k=a(q,c,I,P)}function V(X){R=c._input.zsmooth=c.zsmooth=!1,v.warn('cannot use zsmooth: "fast": '+X)}if((I.rangebreaks||P.rangebreaks)&&(k=function(X,re,ne){for(var le=[],oe=-1,de=0;de<ne.length;de++)if(re[de]!==i){le[++oe]=[];for(var se=0;se<ne[de].length;se++)X[se]!==i&&le[oe].push(ne[de][se])}return le}(h,l,k),E||(h=u(h),l=u(l),c._x=h,c._y=l)),E||!S&&!c.connectgaps||(c._emptypoints=d(k),r(k,c._emptypoints)),"fast"===R)if("log"===I.type||"log"===P.type)V("log axis found");else if(!E){if(h.length){var W=(h[h.length-1]-h[0])/(h.length-1),K=Math.abs(W/100);for(L=0;L<h.length-1;L++)if(Math.abs(h[L+1]-h[L]-W)>K){V("x scale is not linear");break}}if(l.length&&"fast"===R){var G=(l[l.length-1]-l[0])/(l.length-1),Y=Math.abs(G/100);for(L=0;L<l.length-1;L++)if(Math.abs(l[L+1]-l[L]-G)>Y){V("y scale is not linear");break}}}var $=v.maxRowLength(k),B="scaled"===c.xtype?"":h,N=s(c,B,p,o,$,I),U="scaled"===c.ytype?"":l,te=s(c,U,T,_,k.length,P);z||(c._extremes[I._id]=m.findExtremes(I,N),c._extremes[P._id]=m.findExtremes(P,te));var j={x:N,y:te,z:k,text:c._text||c.text,hovertext:c._hovertext||c.hovertext};if(c.xperiodalignment&&b&&(j.orig_x=b),c.yperiodalignment&&w&&(j.orig_y=w),B&&B.length===N.length-1&&(j.xCenter=B),U&&U.length===te.length-1&&(j.yCenter=U),E&&(j.xRanges=M.xRanges,j.yRanges=M.yRanges,j.pts=M.pts),S||n(f,c,{vals:k,cLetter:"z"}),S&&c.contours&&"heatmap"===c.contours.coloring){var J={type:"contour"===c.type?"heatmap":"histogram2d",xcalendar:c.xcalendar,ycalendar:c.ycalendar};j.xfill=s(J,B,p,o,$,I),j.yfill=s(J,U,T,_,k.length,P)}return[j]}},{"../../components/colorscale/calc":375,"../../constants/numerical":491,"../../lib":515,"../../plots/cartesian/align_period":563,"../../plots/cartesian/axes":566,"../../registry":647,"../histogram2d/calc":835,"./clean_2d_array":803,"./convert_column_xyz":805,"./find_empties":807,"./interp2d":810,"./make_bound_array":812}],803:[function(y,ee,Q){"use strict";var g=y("fast-isnumeric"),v=y("../../lib"),m=y("../../constants/numerical").BADNUM;ee.exports=function(x,e,n,t){var a,r,d,s,i,u;function f(l){if(g(l))return+l}if(e&&e.transpose){for(a=0,i=0;i<x.length;i++)a=Math.max(a,x[i].length);if(0===a)return!1;d=function(l){return l.length},s=function(l,T,_){return(l[_]||[])[T]}}else a=x.length,d=function(l,T){return l[T].length},s=function(l,T,_){return(l[T]||[])[_]};function h(l){if(e&&"carpet"!==e.type&&"contourcarpet"!==e.type&&l&&"category"===l.type&&e["_"+l._id.charAt(0)].length){var T=l._id.charAt(0),_={},w=e["_"+T+"CategoryMap"]||e[T];for(i=0;i<w.length;i++)_[w[i]]=i;return function(k){var L=_[l._categories[k]];return L+1?L:m}}return v.identity}var p=h(n),o=h(t);t&&"category"===t.type&&(a=t._categories.length);var l,T,_,b=new Array(a);for(i=0;i<a;i++)for(r=n&&"category"===n.type?n._categories.length:d(x,i),b[i]=new Array(r),u=0;u<r;u++)b[i][u]=f((l=x,T=o(i),_=p(u),T===m||_===m?m:s(l,T,_)));return b}},{"../../constants/numerical":491,"../../lib":515,"fast-isnumeric":190}],804:[function(y,ee,Q){"use strict";ee.exports={min:"zmin",max:"zmax"}},{}],805:[function(y,ee,Q){"use strict";var g=y("../../lib"),v=y("../../constants/numerical").BADNUM,m=y("../../plots/cartesian/align_period");ee.exports=function(x,e,n,t,a,r){var d=x._length,s=e.makeCalcdata(x,t),i=n.makeCalcdata(x,a);s=m(x,e,t,s).vals,i=m(x,n,a,i).vals;var u,f,c,h,p=x.text,o=void 0!==p&&g.isArray1D(p),b=x.hovertext,l=void 0!==b&&g.isArray1D(b),T=g.distinctVals(s),_=T.vals,w=g.distinctVals(i),k=w.vals,L=[],M=k.length,I=_.length;for(u=0;u<r.length;u++)L[u]=g.init2dArray(M,I);o&&(c=g.init2dArray(M,I)),l&&(h=g.init2dArray(M,I));var P=g.init2dArray(M,I);for(u=0;u<d;u++)if(s[u]!==v&&i[u]!==v){var S=g.findBin(s[u]+T.minDiff/2,_),E=g.findBin(i[u]+w.minDiff/2,k);for(f=0;f<r.length;f++)L[f][E][S]=x[r[f]][u],P[E][S]=u;o&&(c[E][S]=p[u]),l&&(h[E][S]=b[u])}for(x["_"+t]=_,x["_"+a]=k,f=0;f<r.length;f++)x["_"+r[f]]=L[f];o&&(x._text=c),l&&(x._hovertext=h),e&&"category"===e.type&&(x["_"+t+"CategoryMap"]=_.map(function(R){return e._categories[R]})),n&&"category"===n.type&&(x["_"+a+"CategoryMap"]=k.map(function(R){return n._categories[R]})),x._after2before=P}},{"../../constants/numerical":491,"../../lib":515,"../../plots/cartesian/align_period":563}],806:[function(y,ee,Q){"use strict";var g=y("../../lib"),v=y("./xyz_defaults"),m=y("./label_defaults"),x=y("../scatter/period_defaults"),e=y("./style_defaults"),n=y("../../components/colorscale/defaults"),t=y("./attributes");ee.exports=function(a,r,d,s){function i(u,f){return g.coerce(a,r,t,u,f)}v(a,r,i,s)?(x(a,r,s,i),i("xhoverformat"),i("yhoverformat"),i("text"),i("hovertext"),i("hovertemplate"),m(i,s),e(a,r,i,s),i("hoverongaps"),i("connectgaps",g.isArray1D(r.z)&&!1!==r.zsmooth),n(a,r,s,i,{prefix:"",cLetter:"z"})):r.visible=!1}},{"../../components/colorscale/defaults":377,"../../lib":515,"../scatter/period_defaults":956,"./attributes":801,"./label_defaults":811,"./style_defaults":815,"./xyz_defaults":816}],807:[function(y,ee,Q){"use strict";var g=y("../../lib").maxRowLength;ee.exports=function(v){var m,x,e,n,t,a,r,d,s=[],i={},u=[],f=v[0],c=[],h=[0,0,0],p=g(v);for(x=0;x<v.length;x++)for(m=c,c=f,f=v[x+1]||[],e=0;e<p;e++)void 0===c[e]&&((a=(void 0!==c[e-1]?1:0)+(void 0!==c[e+1]?1:0)+(void 0!==m[e]?1:0)+(void 0!==f[e]?1:0))?(0===x&&a++,0===e&&a++,x===v.length-1&&a++,e===c.length-1&&a++,a<4&&(i[[x,e]]=[x,e,a]),s.push([x,e,a])):u.push([x,e]));for(;u.length;){for(r={},d=!1,t=u.length-1;t>=0;t--)(a=((i[[(x=(n=u[t])[0])-1,e=n[1]]]||h)[2]+(i[[x+1,e]]||h)[2]+(i[[x,e-1]]||h)[2]+(i[[x,e+1]]||h)[2])/20)&&(r[n]=[x,e,a],u.splice(t,1),d=!0);if(!d)throw"findEmpties iterated with no new neighbors";for(n in r)i[n]=r[n],s.push(r[n])}return s.sort(function(o,b){return b[2]-o[2]})}},{"../../lib":515}],808:[function(y,ee,Q){"use strict";var g=y("../../components/fx"),v=y("../../lib"),m=y("../../plots/cartesian/axes"),x=y("../../components/colorscale").extractOpts;ee.exports=function(e,n,t,a,r){r||(r={});var d,s,i,u,f=r.isContour,c=e.cd[0],h=c.trace,p=e.xa,o=e.ya,b=c.x,l=c.y,T=c.z,_=c.xCenter,w=c.yCenter,k=c.zmask,L=h.zhoverformat,M=b,I=l;if(!1!==e.index){try{i=Math.round(e.index[1]),u=Math.round(e.index[0])}catch{return void v.error("Error hovering on heatmap, pointNumber must be [row,col], found:",e.index)}if(i<0||i>=T[0].length||u<0||u>T.length)return}else{if(g.inbox(n-b[0],n-b[b.length-1],0)>0||g.inbox(t-l[0],t-l[l.length-1],0)>0)return;if(f){var P;for(M=[2*b[0]-b[1]],P=1;P<b.length;P++)M.push((b[P]+b[P-1])/2);for(M.push([2*b[b.length-1]-b[b.length-2]]),I=[2*l[0]-l[1]],P=1;P<l.length;P++)I.push((l[P]+l[P-1])/2);I.push([2*l[l.length-1]-l[l.length-2]])}i=Math.max(0,Math.min(M.length-2,v.findBin(n,M))),u=Math.max(0,Math.min(I.length-2,v.findBin(t,I)))}var S,E,z=p.c2p(b[i]),R=p.c2p(b[i+1]),q=o.c2p(l[u]),V=o.c2p(l[u+1]);f?(R=z,d=(S=c.orig_x||b)[i],V=q,s=(E=c.orig_y||l)[u]):(S=c.orig_x||_||b,E=c.orig_y||w||l,d=_?S[i]:(S[i]+S[i+1])/2,s=w?E[u]:(E[u]+E[u+1])/2,p&&"category"===p.type&&(d=b[i]),o&&"category"===o.type&&(s=l[u]),h.zsmooth&&(z=R=p.c2p(d),q=V=o.c2p(s)));var W=T[u][i];if(k&&!k[u][i]&&(W=void 0),void 0!==W||h.hoverongaps){var K;Array.isArray(c.hovertext)&&Array.isArray(c.hovertext[u])?K=c.hovertext[u][i]:Array.isArray(c.text)&&Array.isArray(c.text[u])&&(K=c.text[u][i]);var G=x(h),$=m.tickText({type:"linear",range:[G.min,G.max],hoverformat:L,_separators:p._separators,_numFormat:p._numFormat},W,"hover").text;return[v.extendFlat(e,{index:h._after2before?h._after2before[u][i]:[u,i],distance:e.maxHoverDistance,spikeDistance:e.maxSpikeDistance,x0:z,x1:R,y0:q,y1:V,xLabelVal:d,yLabelVal:s,zLabelVal:W,zLabel:$,text:K})]}}},{"../../components/colorscale":379,"../../components/fx":407,"../../lib":515,"../../plots/cartesian/axes":566}],809:[function(y,ee,Q){"use strict";ee.exports={attributes:y("./attributes"),supplyDefaults:y("./defaults"),calc:y("./calc"),plot:y("./plot"),colorbar:y("./colorbar"),style:y("./style"),hoverPoints:y("./hover"),moduleType:"trace",name:"heatmap",basePlotModule:y("../../plots/cartesian"),categories:["cartesian","svg","2dMap","showLegend"],meta:{}}},{"../../plots/cartesian":578,"./attributes":801,"./calc":802,"./colorbar":804,"./defaults":806,"./hover":808,"./plot":813,"./style":814}],810:[function(y,ee,Q){"use strict";var g=y("../../lib"),v=[[-1,0],[1,0],[0,-1],[0,1]];function m(e){return.5-.25*Math.min(1,.5*e)}function x(e,n,t){var a,r,d,s,i,u,f,c,h,p,o,b,l,T=0;for(s=0;s<n.length;s++){for(o=e[r=(a=n[s])[0]][d=a[1]],p=0,h=0,i=0;i<4;i++)(f=e[r+(u=v[i])[0]])&&void 0!==(c=f[d+u[1]])&&(0===p?b=l=c:(b=Math.min(b,c),l=Math.max(l,c)),h++,p+=c);if(0===h)throw"iterateInterp2d order is wrong: no defined neighbors";e[r][d]=p/h,void 0===o?h<4&&(T=1):(e[r][d]=(1+t)*e[r][d]-t*o,l>b&&(T=Math.max(T,Math.abs(e[r][d]-o)/(l-b))))}return T}ee.exports=function(e,n){var t,a=1;for(x(e,n),t=0;t<n.length&&!(n[t][2]<4);t++);for(n=n.slice(t),t=0;t<100&&a>.01;t++)a=x(e,n,m(a));return a>.01&&g.log("interp2d didn't converge quickly",a),e}},{"../../lib":515}],811:[function(y,ee,Q){"use strict";var g=y("../../lib");ee.exports=function(v,m){v("texttemplate");var x=g.extendFlat({},m.font,{color:"auto",size:"auto"});g.coerceFont(v,"textfont",x)}},{"../../lib":515}],812:[function(y,ee,Q){"use strict";var g=y("../../registry"),v=y("../../lib").isArrayOrTypedArray;ee.exports=function(m,x,e,n,t,a){var r,d,s,i=[],u=g.traceIs(m,"contour"),f=g.traceIs(m,"histogram"),c=g.traceIs(m,"gl2d");if(v(x)&&x.length>1&&!f&&"category"!==a.type){var h=x.length;if(!(h<=t))return x.slice(0,u?t:t+1);if(u||c)i=x.slice(0,t);else if(1===t)i=[x[0]-.5,x[0]+.5];else{for(i=[1.5*x[0]-.5*x[1]],s=1;s<h;s++)i.push(.5*(x[s-1]+x[s]));i.push(1.5*x[h-1]-.5*x[h-2])}if(h<t){var p=i[i.length-1],o=p-i[i.length-2];for(s=h;s<t;s++)i.push(p+=o)}}else{var b=m[a._id.charAt(0)+"calendar"];for(r=f?a.r2c(e,0,b):v(x)&&1===x.length?x[0]:void 0===e?0:("log"===a.type?a.d2c:a.r2c)(e,0,b),d=n||1,s=u||c?0:-.5;s<t;s++)i.push(r+d*s)}return i}},{"../../lib":515,"../../registry":647}],813:[function(y,ee,Q){"use strict";var g=y("@plotly/d3"),v=y("tinycolor2"),m=y("../../registry"),x=y("../../components/drawing"),e=y("../../plots/cartesian/axes"),n=y("../../lib"),t=y("../../lib/svg_text_utils"),a=y("../scatter/format_labels"),r=y("../../components/color"),d=y("../../components/colorscale").extractOpts,s=y("../../components/colorscale").makeColorScaleFuncFromTrace,i=y("../../constants/xmlns_namespaces"),u=y("../../constants/alignment").LINE_SPACING;function f(b){return b.selectAll("g.heatmap-label")}function c(b){f(b).remove()}function h(b,l){var T=l.length-2,_=n.constrain(n.findBin(b,l),0,T),w=l[_],L=n.constrain(_+(b-w)/(l[_+1]-w)-.5,0,T),M=Math.round(L),I=Math.abs(L-M);return L&&L!==T&&I?{bin0:M,frac:I,bin1:Math.round(M+I/(L-M))}:{bin0:M,bin1:M,frac:0}}function p(b,l){var T=l.length-1,_=n.constrain(n.findBin(b,l),0,T),w=l[_],k=(b-w)/(l[_+1]-w)||0;return k<=0?{bin0:_,bin1:_,frac:0}:k<.5?{bin0:_,bin1:_+1,frac:k}:{bin0:_+1,bin1:_,frac:1-k}}function o(b,l,T){b[l]=T[0],b[l+1]=T[1],b[l+2]=T[2],b[l+3]=Math.round(255*T[3])}ee.exports=function(b,l,T,_){var w=l.xaxis,k=l.yaxis;n.makeTraceGroups(_,T,"hm").each(function(L){var M,I,P,S,E,z,R,q,V=g.select(this),W=L[0],K=W.trace,G=K.xgap||0,Y=K.ygap||0,$=W.z,B=W.x,N=W.y,U=W.xCenter,te=W.yCenter,j=m.traceIs(K,"contour"),J=j?"best":K.zsmooth,X=$.length,re=n.maxRowLength($),ne=!1,le=!1;for(z=0;void 0===M&&z<B.length-1;)M=w.c2p(B[z]),z++;for(z=B.length-1;void 0===I&&z>0;)I=w.c2p(B[z]),z--;for(I<M&&(P=I,I=M,M=P,ne=!0),z=0;void 0===S&&z<N.length-1;)S=k.c2p(N[z]),z++;for(z=N.length-1;void 0===E&&z>0;)E=k.c2p(N[z]),z--;if(E<S&&(P=S,S=E,E=P,le=!0),j&&(U=B,te=N,B=W.xfill,N=W.yfill),"fast"!==J){var oe="best"===J?0:.5;M=Math.max(-oe*w._length,M),I=Math.min((1+oe)*w._length,I),S=Math.max(-oe*k._length,S),E=Math.min((1+oe)*k._length,E)}var de,se,ge=Math.round(I-M),_e=Math.round(E-S);if(ge<=0||_e<=0)return V.selectAll("image").data([]).exit().remove(),void c(V);"fast"===J?(de=re,se=X):(de=ge,se=_e);var Te=document.createElement("canvas");Te.width=de,Te.height=se;var we,Oe,fe=Te.getContext("2d"),ve=s(K,{noNumericCheck:!0,returnArray:!0});"fast"===J?(we=ne?function(gn){return re-1-gn}:n.identity,Oe=le?function(gn){return X-1-gn}:n.identity):(we=function(gn){return n.constrain(Math.round(w.c2p(B[gn])-M),0,ge)},Oe=function(gn){return n.constrain(Math.round(k.c2p(N[gn])-S),0,_e)});var Ae,ke,Pe,Ne,De=Oe(0),ze=[De,De],Me=ne?0:1,Se=le?0:1,Ie=0,Fe=0,Re=0,Xe=0;function nt(gn,dn){if(void 0!==gn){var An=ve(gn);return An[0]=Math.round(An[0]),An[1]=Math.round(An[1]),An[2]=Math.round(An[2]),Ie+=dn,Fe+=An[0]*dn,Re+=An[1]*dn,Xe+=An[2]*dn,An}return[0,0,0,0]}function ct(gn,dn,An,Zn){var Rr=gn[An.bin0];if(void 0===Rr)return nt(void 0,1);var nn=gn[An.bin1],Hr=dn[An.bin0],Fn=dn[An.bin1];return nt(Rr+An.frac*(nn-Rr||0)+Zn.frac*((Hr-Rr||0)+An.frac*(void 0===nn?void 0===Fn?0:void 0===Hr?2*(Fn-Rr):2*(2*Fn-Hr-Rr)/3:void 0===Fn?void 0===Hr?0:2*(2*Rr-nn-Hr)/3:void 0===Hr?2*(2*Fn-nn-Rr)/3:Fn+Rr-nn-Hr)))}if(J){var xt,dt=0;try{xt=new Uint8Array(ge*_e*4)}catch{xt=new Array(ge*_e*4)}if("best"===J){var tt,Ke,mt,Bt=U||B,Ut=te||N,er=new Array(Bt.length),Wt=new Array(Ut.length),rr=new Array(ge),Ht=U?p:h,Ve=te?p:h;for(z=0;z<Bt.length;z++)er[z]=Math.round(w.c2p(Bt[z])-M);for(z=0;z<Ut.length;z++)Wt[z]=Math.round(k.c2p(Ut[z])-S);for(z=0;z<ge;z++)rr[z]=Ht(z,er);for(R=0;R<_e;R++)for(Ke=$[(tt=Ve(R,Wt)).bin0],mt=$[tt.bin1],z=0;z<ge;z++,dt+=4)o(xt,dt,Ne=ct(Ke,mt,rr[z],tt))}else for(R=0;R<X;R++)for(Pe=$[R],ze=Oe(R),z=0;z<ge;z++)Ne=nt(Pe[z],1),o(xt,dt=4*(ze*ge+we(z)),Ne);var We=fe.createImageData(ge,_e);try{We.data.set(xt)}catch{var he=We.data,ye=he.length;for(R=0;R<ye;R++)he[R]=xt[R]}fe.putImageData(We,0,0)}else{var Be=Math.floor(G/2),Ge=Math.floor(Y/2);for(R=0;R<X;R++)if(Pe=$[R],ze.reverse(),ze[Se]=Oe(R+1),ze[0]!==ze[1]&&void 0!==ze[0]&&void 0!==ze[1])for(Ae=[ke=we(0),ke],z=0;z<re;z++)Ae.reverse(),Ae[Me]=we(z+1),Ae[0]!==Ae[1]&&void 0!==Ae[0]&&void 0!==Ae[1]&&(Ne=nt(Pe[z],(Ae[1]-Ae[0])*(ze[1]-ze[0])),fe.fillStyle="rgba("+Ne.join(",")+")",fe.fillRect(Ae[0]+Be,ze[0]+Ge,Ae[1]-Ae[0]-G,ze[1]-ze[0]-Y))}Fe=Math.round(Fe/Ie),Re=Math.round(Re/Ie),Xe=Math.round(Xe/Ie);var Je=v("rgb("+Fe+","+Re+","+Xe+")");b._hmpixcount=(b._hmpixcount||0)+Ie,b._hmlumcount=(b._hmlumcount||0)+Ie*Je.getLuminance();var He=V.selectAll("image").data(L);He.enter().append("svg:image").attr({xmlns:i.svg,preserveAspectRatio:"none"}),He.attr({height:_e,width:ge,x:M,y:S,"xlink:href":Te.toDataURL("image/png")}),c(V);var st=K.texttemplate;if(st){var ot=d(K),wt={type:"linear",range:[ot.min,ot.max],_separators:w._separators,_numFormat:w._numFormat},Ct="histogram2dcontour"===K.type,rt="contour"===K.type,ft=rt?X-1:X,Rt=rt?1:0,kt=rt?re-1:re,Lt=[];for(z=rt?1:0;z<ft;z++){var Ee;if(rt)Ee=W.y[z];else if(Ct){if(0===z||z===X-1)continue;Ee=W.y[z]}else if(W.yCenter)Ee=W.yCenter[z];else{if(z+1===X&&void 0===W.y[z+1])continue;Ee=(W.y[z]+W.y[z+1])/2}var Ye=Math.round(k.c2p(Ee));if(!(0>Ye||Ye>k._length))for(R=Rt;R<kt;R++){var it;if(rt)it=W.x[R];else if(Ct){if(0===R||R===re-1)continue;it=W.x[R]}else if(W.xCenter)it=W.xCenter[R];else{if(R+1===re&&void 0===W.x[R+1])continue;it=(W.x[R]+W.x[R+1])/2}var ht=Math.round(w.c2p(it));if(!(0>ht||ht>w._length)){var At=a({x:it,y:Ee},K,b._fullLayout);At.x=it,At.y=Ee;var Ft=W.z[z][R];void 0===Ft?(At.z="",At.zLabel=""):(At.z=Ft,At.zLabel=e.tickText(wt,Ft,"hover").text);var Gt=W.text&&W.text[z]&&W.text[z][R];void 0!==Gt&&!1!==Gt||(Gt=""),At.text=Gt;var jt=n.texttemplateString(st,At,b._fullLayout._d3locale,At,K._meta||{});if(jt){var fr=jt.split("<br>"),kr=fr.length,ur=0;for(q=0;q<kr;q++)ur=Math.max(ur,fr[q].length);Lt.push({l:kr,c:ur,t:jt,x:ht,y:Ye,z:Ft})}}}}var Jt=K.textfont,$t=Jt.family,Qt=Jt.size,cr=b._fullLayout.font.size;if(!Qt||"auto"===Qt){var gr=1/0,Tr=1/0,Fr=0,Nr=0;for(q=0;q<Lt.length;q++){var Xr=Lt[q];if(Fr=Math.max(Fr,Xr.l),Nr=Math.max(Nr,Xr.c),q<Lt.length-1){var un=Lt[q+1],$r=Math.abs(un.x-Xr.x),Pn=Math.abs(un.y-Xr.y);$r&&(gr=Math.min(gr,$r)),Pn&&(Tr=Math.min(Tr,Pn))}}isFinite(gr)&&isFinite(Tr)?(gr-=G,Tr-=Y,gr/=Nr,Tr/=Fr,gr/=u/2,Tr/=u,Qt=Math.min(Math.floor(gr),Math.floor(Tr),cr)):Qt=cr}if(Qt<=0||!isFinite(Qt))return;f(V).data(Lt).enter().append("g").classed("heatmap-label",1).append("text").attr("text-anchor","middle").each(function(gn){var Zn,dn=g.select(this),An=Jt.color;An&&"auto"!==An||(An=r.contrast("rgba("+ve(gn.z).join()+")")),dn.attr("data-notex",1).call(t.positionText,(Zn=gn,Zn.x),function(Zn){return Zn.y-Qt*(Zn.l*u/2-1)}(gn)).call(x.font,$t,Qt,An).text(gn.t).call(t.convertToTspans,b)})}})}},{"../../components/color":367,"../../components/colorscale":379,"../../components/drawing":389,"../../constants/alignment":483,"../../constants/xmlns_namespaces":492,"../../lib":515,"../../lib/svg_text_utils":541,"../../plots/cartesian/axes":566,"../../registry":647,"../scatter/format_labels":945,"@plotly/d3":58,tinycolor2:313}],814:[function(y,ee,Q){"use strict";var g=y("@plotly/d3");ee.exports=function(v){g.select(v).selectAll(".hm image").style("opacity",function(m){return m.trace.opacity})}},{"@plotly/d3":58}],815:[function(y,ee,Q){"use strict";ee.exports=function(g,v,m){!1===m("zsmooth")&&(m("xgap"),m("ygap")),m("zhoverformat")}},{}],816:[function(y,ee,Q){"use strict";var g=y("fast-isnumeric"),v=y("../../lib"),m=y("../../registry");function x(e,n){var t=n(e);return"scaled"===(t?n(e+"type","array"):"scaled")&&(n(e+"0"),n("d"+e)),t}ee.exports=function(e,n,t,a,r,d){var s,i,u=t("z");if(r=r||"x",d=d||"y",void 0===u||!u.length)return 0;if(v.isArray1D(e.z)){s=t(r),i=t(d);var f=v.minRowLength(s),c=v.minRowLength(i);if(0===f||0===c)return 0;n._length=Math.min(f,c,u.length)}else{if(s=x(r,t),i=x(d,t),!function(h){for(var p,o=!0,b=!1,l=!1,T=0;T<h.length;T++){if(!v.isArrayOrTypedArray(p=h[T])){o=!1;break}p.length>0&&(b=!0);for(var _=0;_<p.length;_++)if(g(p[_])){l=!0;break}}return o&&b&&l}(u))return 0;t("transpose"),n._length=null}return"heatmapgl"===e.type||m.getComponentMethod("calendars","handleTraceDefaults")(e,n,[r,d],a),!0}},{"../../lib":515,"../../registry":647,"fast-isnumeric":190}],817:[function(y,ee,Q){"use strict";for(var g=y("../heatmap/attributes"),v=y("../../components/colorscale/attributes"),m=y("../../lib/extend").extendFlat,x=y("../../plot_api/edit_types").overrideAll,e=["z","x","x0","dx","y","y0","dy","text","transpose","xtype","ytype"],n={},t=0;t<e.length;t++){var a=e[t];n[a]=g[a]}n.zsmooth={valType:"enumerated",values:["fast",!1],dflt:"fast",editType:"calc"},m(n,v("",{cLetter:"z",autoColorDflt:!1})),ee.exports=x(n,"calc","nested")},{"../../components/colorscale/attributes":374,"../../lib/extend":505,"../../plot_api/edit_types":548,"../heatmap/attributes":801}],818:[function(y,ee,Q){"use strict";var g=y("../../../stackgl_modules").gl_heatmap2d,v=y("../../plots/cartesian/axes"),m=y("../../lib/str2rgbarray");function x(n,t){this.scene=n,this.uid=t,this.type="heatmapgl",this.name="",this.hoverinfo="all",this.xData=[],this.yData=[],this.zData=[],this.textLabels=[],this.idToIndex=[],this.bounds=[0,0,0,0],this.options={zsmooth:"fast",z:[],x:[],y:[],shape:[0,0],colorLevels:[0],colorValues:[0,0,0,1]},this.heatmap=g(n.glplot,this.options),this.heatmap._trace=this}var e=x.prototype;e.handlePick=function(n){var t=this.options,a=t.shape,r=n.pointId,d=r%a[0],s=Math.floor(r/a[0]);return{trace:this,dataCoord:n.dataCoord,traceCoord:[t.x[d],t.y[s],t.z[r]],textLabel:this.textLabels[r],name:this.name,pointIndex:[s,d],hoverinfo:this.hoverinfo}},e.update=function(n,t){var a=t[0];this.index=n.index,this.name=n.name,this.hoverinfo=n.hoverinfo;var r=a.z;this.options.z=[].concat.apply([],r),this.options.shape=[r[0].length,r.length],this.options.x=a.x,this.options.y=a.y,this.options.zsmooth=n.zsmooth;var i=function(p){for(var o=p.colorscale,b=p.zmin,l=p.zmax,T=o.length,_=new Array(T),w=new Array(4*T),k=0;k<T;k++){var L=o[k],M=m(L[1]);_[k]=b+L[0]*(l-b);for(var I=0;I<4;I++)w[4*k+I]=M[I]}return{colorLevels:_,colorValues:w}}(n);this.options.colorLevels=i.colorLevels,this.options.colorValues=i.colorValues,this.textLabels=[].concat.apply([],n.text),this.heatmap.update(this.options);var u,f,c=this.scene.xaxis,h=this.scene.yaxis;!1===n.zsmooth&&(u={ppad:a.x[1]-a.x[0]},f={ppad:a.y[1]-a.y[0]}),n._extremes[c._id]=v.findExtremes(c,a.x,u),n._extremes[h._id]=v.findExtremes(h,a.y,f)},e.dispose=function(){this.heatmap.dispose()},ee.exports=function(n,t,a){var r=new x(n,t.uid);return r.update(t,a),r}},{"../../../stackgl_modules":1133,"../../lib/str2rgbarray":540,"../../plots/cartesian/axes":566}],819:[function(y,ee,Q){"use strict";var g=y("../../lib"),v=y("../heatmap/xyz_defaults"),m=y("../../components/colorscale/defaults"),x=y("./attributes");ee.exports=function(e,n,t,a){function r(d,s){return g.coerce(e,n,x,d,s)}v(e,n,r,a)?(r("text"),r("zsmooth"),m(e,n,a,r,{prefix:"",cLetter:"z"})):n.visible=!1}},{"../../components/colorscale/defaults":377,"../../lib":515,"../heatmap/xyz_defaults":816,"./attributes":817}],820:[function(y,ee,Q){"use strict";["*heatmapgl* trace is deprecated!","Please consider switching to the *heatmap* or *image* trace types.","Alternatively you could contribute/sponsor rewriting this trace type","based on cartesian features and using regl framework."].join(" "),ee.exports={attributes:y("./attributes"),supplyDefaults:y("./defaults"),colorbar:y("../heatmap/colorbar"),calc:y("../heatmap/calc"),plot:y("./convert"),moduleType:"trace",name:"heatmapgl",basePlotModule:y("../../plots/gl2d"),categories:["gl","gl2d","2dMap"],meta:{}}},{"../../plots/gl2d":605,"../heatmap/calc":802,"../heatmap/colorbar":804,"./attributes":817,"./convert":818,"./defaults":819}],821:[function(y,ee,Q){"use strict";var g=y("../bar/attributes"),v=y("../../plots/cartesian/axis_format_attributes").axisHoverFormat,m=y("../../plots/template_attributes").hovertemplateAttrs,x=y("../../plots/template_attributes").texttemplateAttrs,e=y("../../plots/font_attributes"),n=y("./bin_attributes"),t=y("./constants"),a=y("../../lib/extend").extendFlat;ee.exports={x:{valType:"data_array",editType:"calc+clearAxisTypes"},y:{valType:"data_array",editType:"calc+clearAxisTypes"},xhoverformat:v("x"),yhoverformat:v("y"),text:a({},g.text,{}),hovertext:a({},g.hovertext,{}),orientation:g.orientation,histfunc:{valType:"enumerated",values:["count","sum","avg","min","max"],dflt:"count",editType:"calc"},histnorm:{valType:"enumerated",values:["","percent","probability","density","probability density"],dflt:"",editType:"calc"},cumulative:{enabled:{valType:"boolean",dflt:!1,editType:"calc"},direction:{valType:"enumerated",values:["increasing","decreasing"],dflt:"increasing",editType:"calc"},currentbin:{valType:"enumerated",values:["include","exclude","half"],dflt:"include",editType:"calc"},editType:"calc"},nbinsx:{valType:"integer",min:0,dflt:0,editType:"calc"},xbins:n("x",!0),nbinsy:{valType:"integer",min:0,dflt:0,editType:"calc"},ybins:n("y",!0),autobinx:{valType:"boolean",dflt:null,editType:"calc"},autobiny:{valType:"boolean",dflt:null,editType:"calc"},bingroup:{valType:"string",dflt:"",editType:"calc"},hovertemplate:m({},{keys:t.eventDataKeys}),texttemplate:x({arrayOk:!1,editType:"plot"},{keys:["label","value"]}),textposition:a({},g.textposition,{arrayOk:!1}),textfont:e({arrayOk:!1,editType:"plot",colorEditType:"style"}),outsidetextfont:e({arrayOk:!1,editType:"plot",colorEditType:"style"}),insidetextfont:e({arrayOk:!1,editType:"plot",colorEditType:"style"}),insidetextanchor:g.insidetextanchor,textangle:g.textangle,cliponaxis:g.cliponaxis,constraintext:g.constraintext,marker:g.marker,offsetgroup:g.offsetgroup,alignmentgroup:g.alignmentgroup,selected:g.selected,unselected:g.unselected,_deprecated:{bardir:g._deprecated.bardir}}},{"../../lib/extend":505,"../../plots/cartesian/axis_format_attributes":569,"../../plots/font_attributes":594,"../../plots/template_attributes":642,"../bar/attributes":657,"./bin_attributes":823,"./constants":827}],822:[function(y,ee,Q){"use strict";ee.exports=function(g,v){for(var m=g.length,x=0,e=0;e<m;e++)v[e]?(g[e]/=v[e],x+=g[e]):g[e]=null;return x}},{}],823:[function(y,ee,Q){"use strict";ee.exports=function(g,v){return{start:{valType:"any",editType:"calc"},end:{valType:"any",editType:"calc"},size:{valType:"any",editType:"calc"},editType:"calc"}}},{}],824:[function(y,ee,Q){"use strict";var g=y("fast-isnumeric");ee.exports={count:function(v,m,x){return x[v]++,1},sum:function(v,m,x,e){var n=e[m];return g(n)?(n=Number(n),x[v]+=n,n):0},avg:function(v,m,x,e,n){var t=e[m];return g(t)&&(t=Number(t),x[v]+=t,n[v]++),0},min:function(v,m,x,e){var n=e[m];if(g(n)){if(n=Number(n),!g(x[v]))return x[v]=n,n;if(x[v]>n){var t=n-x[v];return x[v]=n,t}}return 0},max:function(v,m,x,e){var n=e[m];if(g(n)){if(n=Number(n),!g(x[v]))return x[v]=n,n;if(x[v]<n){var t=n-x[v];return x[v]=n,t}}return 0}}},{"fast-isnumeric":190}],825:[function(y,ee,Q){"use strict";var g=y("../../constants/numerical"),v=g.ONEAVGYEAR,m=g.ONEAVGMONTH,x=g.ONEDAY,e=g.ONEHOUR,n=g.ONEMIN,t=g.ONESEC,a=y("../../plots/cartesian/axes").tickIncrement;function r(u,f,c,h){if(u*f<=0)return 1/0;for(var p=Math.abs(f-u),o="date"===c.type,b=d(p,o),l=0;l<10;l++){var T=d(80*b,o);if(b===T||!s(T,u,f,o,c,h))break;b=T}return b}function d(u,f){return f&&u>t?u>x?u>1.1*v?v:u>1.1*m?m:x:u>e?e:u>n?n:t:Math.pow(10,Math.floor(Math.log(u)/Math.LN10))}function s(u,f,c,h,p,o){if(h&&u>x){var b=i(f,p,o),l=i(c,p,o),T=u===v?0:1;return b[T]!==l[T]}return Math.floor(c/u)-Math.floor(f/u)>.1}function i(u,f,c){var h=f.c2d(u,v,c).split("-");return""===h[0]&&(h.unshift(),h[0]="-"+h[0]),h}ee.exports=function(u,f,c,h,p){var o,b,l=-1.1*f,T=-.1*f,_=u-T,w=c[0],k=c[1],L=Math.min(r(w+T,w+_,h,p),r(k+T,k+_,h,p)),M=Math.min(r(w+l,w+T,h,p),r(k+l,k+T,h,p));if(L>M&&M<Math.abs(k-w)/4e3?(o=L,b=!1):(o=Math.min(L,M),b=!0),"date"===h.type&&o>x){var I=o===v?1:6,P=o===v?"M12":"M1";return function(S,E){var z=h.c2d(S,v,p),R=z.indexOf("-",I);R>0&&(z=z.substr(0,R));var q=h.d2c(z,0,p);if(q<S){var V=a(q,P,!1,p);(q+V)/2<S+u&&(q=V)}return E&&b?a(q,P,!0,p):q}}return function(S,E){var z=o*Math.round(S/o);return z+o/10<S&&z+.9*o<S+u&&(z+=o),E&&b&&(z-=o),z}}},{"../../constants/numerical":491,"../../plots/cartesian/axes":566}],826:[function(y,ee,Q){"use strict";var g=y("fast-isnumeric"),v=y("../../lib"),m=y("../../registry"),x=y("../../plots/cartesian/axes"),e=y("../bar/arrays_to_calcdata"),n=y("./bin_functions"),t=y("./norm_functions"),a=y("./average"),r=y("./bin_label_vals");function d(s,i,u,f,c){var h,p,o,b,l,T,_,w=f+"bins",k=s._fullLayout,M=k._histogramBinOpts[i["_"+f+"bingroup"]],I="overlay"===k.barmode,P=function(se){return u.r2c(se,0,b)},S=function(se){return u.c2r(se,0,b)},E="date"===u.type?function(se){return se||0===se?v.cleanDate(se,null,b):null}:function(se){return g(se)?Number(se):null};function z(se,ge,_e){ge[se+"Found"]?(ge[se]=E(ge[se]),null===ge[se]&&(ge[se]=_e[se])):(T[se]=ge[se]=_e[se],v.nestedProperty(p[0],w+"."+se).set(_e[se]))}if(i["_"+f+"autoBinFinished"])delete i["_"+f+"autoBinFinished"];else{p=M.traces;var R=[],q=!0,V=!1,W=!1;for(h=0;h<p.length;h++)if((o=p[h]).visible){var K=M.dirs[h];l=o["_"+K+"pos0"]=u.makeCalcdata(o,K),R=v.concat(R,l),delete o["_"+f+"autoBinFinished"],!0===i.visible&&(q?q=!1:(delete o._autoBin,o["_"+f+"autoBinFinished"]=1),m.traceIs(o,"2dMap")&&(V=!0),"histogram2dcontour"===o.type&&(W=!0))}var G=x.autoBin(R,u,M.nbins,V,b=p[0][f+"calendar"],M.sizeFound&&M.size),Y=p[0]._autoBin={};if(T=Y[M.dirs[0]]={},W&&(M.size||(G.start=S(x.tickIncrement(P(G.start),G.size,!0,b))),void 0===M.end&&(G.end=S(x.tickIncrement(P(G.end),G.size,!1,b)))),I&&!m.traceIs(i,"2dMap")&&0===G._dataSpan&&"category"!==u.type&&"multicategory"!==u.type){if(c)return[G,l,!0];G=function(se,ge,_e,Te,we){var Oe,fe,ve,Ae=se._fullLayout,ke=function(ct,xt){for(var dt=xt.xaxis,tt=xt.yaxis,Ke=xt.orientation,mt=[],Bt=ct._fullData,Ut=0;Ut<Bt.length;Ut++){var er=Bt[Ut];"histogram"===er.type&&!0===er.visible&&er.orientation===Ke&&er.xaxis===dt&&er.yaxis===tt&&mt.push(er)}return mt}(se,ge),Pe=!1,Ne=1/0,De=[ge];for(Oe=0;Oe<ke.length;Oe++)if((fe=ke[Oe])===ge)Pe=!0;else if(Pe){var ze=d(se,fe,_e,Te,!0),Me=ze[0],Se=ze[2];fe["_"+Te+"autoBinFinished"]=1,fe["_"+Te+"pos0"]=ze[1],Se?De.push(fe):Ne=Math.min(Ne,Me.size)}else ve=Ae._histogramBinOpts[fe["_"+Te+"bingroup"]],Ne=Math.min(Ne,ve.size||fe[we].size);var Ie=new Array(De.length);for(Oe=0;Oe<De.length;Oe++)for(var Fe=De[Oe]["_"+Te+"pos0"],Re=0;Re<Fe.length;Re++)if(void 0!==Fe[Re]){Ie[Oe]=Fe[Re];break}for(isFinite(Ne)||(Ne=v.distinctVals(Ie).minDiff),Oe=0;Oe<De.length;Oe++){var Xe=(fe=De[Oe])[Te+"calendar"],nt={start:_e.c2r(Ie[Oe]-Ne/2,0,Xe),end:_e.c2r(Ie[Oe]+Ne/2,0,Xe),size:Ne};fe._input[we]=fe[we]=nt,(ve=Ae._histogramBinOpts[fe["_"+Te+"bingroup"]])&&v.extendFlat(ve,nt)}return ge[we]}(s,i,u,f,w)}(_=o.cumulative||{}).enabled&&"include"!==_.currentbin&&("decreasing"===_.direction?G.start=S(x.tickIncrement(P(G.start),G.size,!0,b)):G.end=S(x.tickIncrement(P(G.end),G.size,!1,b))),M.size=G.size,M.sizeFound||(T.size=G.size,v.nestedProperty(p[0],w+".size").set(G.size)),z("start",M,G),z("end",M,G)}l=i["_"+f+"pos0"],delete i["_"+f+"pos0"];var $=i._input[w]||{},B=v.extendFlat({},M),N=M.start,U=u.r2l($.start),te=void 0!==U;if((M.startFound||te)&&U!==u.r2l(N)){var j=te?U:v.aggNums(Math.min,null,l),J={type:"category"===u.type||"multicategory"===u.type?"linear":u.type,r2l:u.r2l,dtick:M.size,tick0:N,calendar:b,range:[j,x.tickIncrement(j,M.size,!1,b)].map(u.l2r)},X=x.tickFirst(J);X>u.r2l(j)&&(X=x.tickIncrement(X,M.size,!0,b)),B.start=u.l2r(X),te||v.nestedProperty(i,w+".start").set(B.start)}var re=M.end,ne=u.r2l($.end),le=void 0!==ne;if((M.endFound||le)&&ne!==u.r2l(re)){var oe=le?ne:v.aggNums(Math.max,null,l);B.end=u.l2r(oe),le||v.nestedProperty(i,w+".start").set(B.end)}var de="autobin"+f;return!1===i._input[de]&&(i._input[w]=v.extendFlat({},i[w]||{}),delete i._input[de],delete i[de]),[B,l]}ee.exports={calc:function(s,i){var u,f,c,h,p=[],o=[],b="h"===i.orientation,l=x.getFromId(s,b?i.yaxis:i.xaxis),T=b?"y":"x",_={x:"y",y:"x"}[T],w=i[T+"calendar"],k=i.cumulative,L=d(s,i,l,T),M=L[0],I=L[1],P="string"==typeof M.size,S=[],E=P?S:M,z=[],R=[],q=[],V=0,W=i.histnorm,K=i.histfunc,G=-1!==W.indexOf("density");k.enabled&&G&&(W=W.replace(/ ?density$/,""),G=!1);var Y,$="max"===K||"min"===K?null:0,B=n.count,N=t[W],U=!1,te=function(fe){return l.r2c(fe,0,w)};for(v.isArrayOrTypedArray(i[_])&&"count"!==K&&(Y=i[_],U="avg"===K,B=n[K]),u=te(M.start),c=te(M.end)+(u-x.tickIncrement(u,M.size,!1,w))/1e6;u<c&&p.length<1e6&&(f=x.tickIncrement(u,M.size,!1,w),p.push((u+f)/2),o.push($),q.push([]),S.push(u),G&&z.push(1/(f-u)),U&&R.push(0),!(f<=u));)u=f;S.push(u),P||"date"!==l.type||(E={start:te(E.start),end:te(E.end),size:E.size}),s._fullLayout._roundFnOpts||(s._fullLayout._roundFnOpts={});var j=i["_"+T+"bingroup"],J={leftGap:1/0,rightGap:1/0};j&&(s._fullLayout._roundFnOpts[j]||(s._fullLayout._roundFnOpts[j]=J),J=s._fullLayout._roundFnOpts[j]);var X,re=o.length,ne=!0,le=J.leftGap,oe=J.rightGap,de={};for(u=0;u<I.length;u++){var se=I[u];(h=v.findBin(se,E))>=0&&h<re&&(V+=B(h,u,o,Y,R),ne&&q[h].length&&se!==I[q[h][0]]&&(ne=!1),q[h].push(u),de[u]=h,le=Math.min(le,se-S[h]),oe=Math.min(oe,S[h+1]-se))}J.leftGap=le,J.rightGap=oe,ne||(X=function(fe,ve){return function(){var Ae=s._fullLayout._roundFnOpts[j];return r(Ae.leftGap,Ae.rightGap,S,l,w)(fe,ve)}}),U&&(V=a(o,R)),N&&N(o,V,z),k.enabled&&function(fe,ve,Ae){var ke,Pe,Ne;function De(Me){Ne=fe[Me],fe[Me]/=2}function ze(Me){fe[Me]=Ne+(Pe=fe[Me])/2,Ne+=Pe}if("half"===Ae)if("increasing"===ve)for(De(0),ke=1;ke<fe.length;ke++)ze(ke);else for(De(fe.length-1),ke=fe.length-2;ke>=0;ke--)ze(ke);else if("increasing"===ve){for(ke=1;ke<fe.length;ke++)fe[ke]+=fe[ke-1];"exclude"===Ae&&(fe.unshift(0),fe.pop())}else{for(ke=fe.length-2;ke>=0;ke--)fe[ke]+=fe[ke+1];"exclude"===Ae&&(fe.push(0),fe.shift())}}(o,k.direction,k.currentbin);var ge=Math.min(p.length,o.length),_e=[],Te=0,we=ge-1;for(u=0;u<ge;u++)if(o[u]){Te=u;break}for(u=ge-1;u>=Te;u--)if(o[u]){we=u;break}for(u=Te;u<=we;u++)if(g(p[u])&&g(o[u])){var Oe={p:p[u],s:o[u],b:0};k.enabled||(Oe.pts=q[u],ne?Oe.ph0=Oe.ph1=q[u].length?I[q[u][0]]:p[u]:(i._computePh=!0,Oe.ph0=X(S[u]),Oe.ph1=X(S[u+1],!0))),_e.push(Oe)}return 1===_e.length&&(_e[0].width1=x.tickIncrement(_e[0].p,M.size,!1,w)-_e[0].p),e(_e,i),v.isArrayOrTypedArray(i.selectedpoints)&&v.tagSelected(_e,i,de),_e},calcAllAutoBins:d}},{"../../lib":515,"../../plots/cartesian/axes":566,"../../registry":647,"../bar/arrays_to_calcdata":656,"./average":822,"./bin_functions":824,"./bin_label_vals":825,"./norm_functions":833,"fast-isnumeric":190}],827:[function(y,ee,Q){"use strict";ee.exports={eventDataKeys:["binNumber"]}},{}],828:[function(y,ee,Q){"use strict";var g=y("../../lib"),v=y("../../plots/cartesian/axis_ids"),m=y("../../registry").traceIs,x=y("../bar/defaults").handleGroupingDefaults,e=g.nestedProperty,n=y("../../plots/cartesian/constraints").getAxisGroup,t=[{aStr:{x:"xbins.start",y:"ybins.start"},name:"start"},{aStr:{x:"xbins.end",y:"ybins.end"},name:"end"},{aStr:{x:"xbins.size",y:"ybins.size"},name:"size"},{aStr:{x:"nbinsx",y:"nbinsy"},name:"nbins"}],a=["x","y"];ee.exports=function(r,d){var s,i,u,f,c,h,p,o=d._histogramBinOpts={},b=[],l={},T=[];function _(G,Y){return g.coerce(s._input,s,s._module.attributes,G,Y)}function w(G){return"v"===G.orientation?"x":"y"}function k(G,Y,$){var B=G.uid+"__"+$;Y||(Y=B);var N=v.getFromTrace({_fullLayout:d},G,$).type,U=G[$+"calendar"]||"",te=o[Y],j=!0;te&&(N===te.axType&&U===te.calendar?(j=!1,te.traces.push(G),te.dirs.push($)):(Y=B,N!==te.axType&&g.warn(["Attempted to group the bins of trace",G.index,"set on a","type:"+N,"axis","with bins on","type:"+te.axType,"axis."].join(" ")),U!==te.calendar&&g.warn(["Attempted to group the bins of trace",G.index,"set with a",U,"calendar","with bins",te.calendar?"on a "+te.calendar+" calendar":"w/o a set calendar"].join(" ")))),j&&(o[Y]={traces:[G],dirs:[$],axType:N,calendar:G[$+"calendar"]||""}),G["_"+$+"bingroup"]=Y}for(c=0;c<r.length;c++)m(s=r[c],"histogram")&&(b.push(s),delete s._xautoBinFinished,delete s._yautoBinFinished,m(s,"2dMap")||x(s._input,s,d,_));var L=d._alignmentOpts||{};for(c=0;c<b.length;c++){if(u="",!m(s=b[c],"2dMap")){if(f=w(s),"group"===d.barmode&&s.alignmentgroup){var I=n(d,s[f+"axis"])+s.orientation;(L[I]||{})[s.alignmentgroup]&&(u=I)}u||"overlay"===d.barmode||(u=n(d,s.xaxis)+n(d,s.yaxis)+w(s))}u?(l[u]||(l[u]=[]),l[u].push(s)):T.push(s)}for(u in l)if(1!==(i=l[u]).length){var P=!1;for(i.length&&(s=i[0],P=_("bingroup")),u=P||u,c=0;c<i.length;c++){var S=(s=i[c])._input.bingroup;S&&S!==u&&g.warn(["Trace",s.index,"must match","within bingroup",u+".","Ignoring its bingroup:",S,"setting."].join(" ")),s.bingroup=u,k(s,u,w(s))}}else T.push(i[0]);for(c=0;c<T.length;c++){s=T[c];var E=_("bingroup");if(m(s,"2dMap"))for(p=0;p<2;p++){var z=_((f=a[p])+"bingroup",E?E+"__"+f:null);k(s,z,f)}else k(s,E,w(s))}for(u in o){var R=o[u];for(i=R.traces,h=0;h<t.length;h++){var q,V,W=t[h],K=W.name;if("nbins"!==K||!R.sizeFound){for(c=0;c<i.length;c++){if(void 0!==e((s=i[c])._input,q=W.aStr[f=R.dirs[c]]).get()){R[K]=_(q),R[K+"Found"]=!0;break}(V=(s._autoBin||{})[f]||{})[K]&&e(s,q).set(V[K])}if("start"===K||"end"===K)for(;c<i.length;c++)(s=i[c])["_"+f+"bingroup"]&&_(q,(V=(s._autoBin||{})[f]||{})[K]);"nbins"!==K||R.sizeFound||R.nbinsFound||(s=i[0],R[K]=_(q))}}}}},{"../../lib":515,"../../plots/cartesian/axis_ids":570,"../../plots/cartesian/constraints":574,"../../registry":647,"../bar/defaults":661}],829:[function(y,ee,Q){"use strict";var g=y("../../registry"),v=y("../../lib"),m=y("../../components/color"),x=y("../bar/defaults").handleText,e=y("../bar/style_defaults"),n=y("./attributes");ee.exports=function(t,a,r,d){function s(T,_){return v.coerce(t,a,n,T,_)}var i=s("x"),u=s("y");s("cumulative.enabled")&&(s("cumulative.direction"),s("cumulative.currentbin")),s("text");var f=s("textposition");x(t,a,d,s,f,{moduleHasSelected:!0,moduleHasUnselected:!0,moduleHasConstrain:!0,moduleHasCliponaxis:!0,moduleHasTextangle:!0,moduleHasInsideanchor:!0}),s("hovertext"),s("hovertemplate"),s("xhoverformat"),s("yhoverformat");var c=s("orientation",u&&!i?"h":"v"),h="v"===c?"x":"y",p="v"===c?"y":"x",o=i&&u?Math.min(v.minRowLength(i)&&v.minRowLength(u)):v.minRowLength(a[h]||[]);if(o){a._length=o,g.getComponentMethod("calendars","handleTraceDefaults")(t,a,["x","y"],d),a[p]&&s("histfunc"),s("histnorm"),s("autobin"+h),e(t,a,s,r,d),v.coerceSelectionMarkerOpacity(a,s);var b=(a.marker.line||{}).color,l=g.getComponentMethod("errorbars","supplyDefaults");l(t,a,b||m.defaultLine,{axis:"y"}),l(t,a,b||m.defaultLine,{axis:"x",inherit:"y"})}else a.visible=!1}},{"../../components/color":367,"../../lib":515,"../../registry":647,"../bar/defaults":661,"../bar/style_defaults":672,"./attributes":821}],830:[function(y,ee,Q){"use strict";ee.exports=function(g,v,m,x,e){if(g.x="xVal"in v?v.xVal:v.x,g.y="yVal"in v?v.yVal:v.y,"zLabelVal"in v&&(g.z=v.zLabelVal),v.xa&&(g.xaxis=v.xa),v.ya&&(g.yaxis=v.ya),!(m.cumulative||{}).enabled){var n,t=Array.isArray(e)?x[0].pts[e[0]][e[1]]:x[e].pts;if(g.pointNumbers=t,g.binNumber=g.pointNumber,delete g.pointNumber,delete g.pointIndex,m._indexToPoints){n=[];for(var a=0;a<t.length;a++)n=n.concat(m._indexToPoints[t[a]])}else n=t;g.pointIndices=n}return g}},{}],831:[function(y,ee,Q){"use strict";var g=y("../bar/hover").hoverPoints,v=y("../../plots/cartesian/axes").hoverLabelText;ee.exports=function(m,x,e,n,t){var a=g(m,x,e,n,t);if(a){var r=(m=a[0]).cd[m.index],d=m.cd[0].trace;if(!d.cumulative.enabled){var s="h"===d.orientation?"y":"x";m[s+"Label"]=v(m[s+"a"],[r.ph0,r.ph1],d[s+"hoverformat"])}return a}}},{"../../plots/cartesian/axes":566,"../bar/hover":664}],832:[function(y,ee,Q){"use strict";ee.exports={attributes:y("./attributes"),layoutAttributes:y("../bar/layout_attributes"),supplyDefaults:y("./defaults"),crossTraceDefaults:y("./cross_trace_defaults"),supplyLayoutDefaults:y("../bar/layout_defaults"),calc:y("./calc").calc,crossTraceCalc:y("../bar/cross_trace_calc").crossTraceCalc,plot:y("../bar/plot").plot,layerName:"barlayer",style:y("../bar/style").style,styleOnSelect:y("../bar/style").styleOnSelect,colorbar:y("../scatter/marker_colorbar"),hoverPoints:y("./hover"),selectPoints:y("../bar/select"),eventData:y("./event_data"),moduleType:"trace",name:"histogram",basePlotModule:y("../../plots/cartesian"),categories:["bar-like","cartesian","svg","bar","histogram","oriented","errorBarsOK","showLegend"],meta:{}}},{"../../plots/cartesian":578,"../bar/cross_trace_calc":660,"../bar/layout_attributes":666,"../bar/layout_defaults":667,"../bar/plot":668,"../bar/select":669,"../bar/style":671,"../scatter/marker_colorbar":954,"./attributes":821,"./calc":826,"./cross_trace_defaults":828,"./defaults":829,"./event_data":830,"./hover":831}],833:[function(y,ee,Q){"use strict";ee.exports={percent:function(g,v){for(var m=g.length,x=100/v,e=0;e<m;e++)g[e]*=x},probability:function(g,v){for(var m=g.length,x=0;x<m;x++)g[x]/=v},density:function(g,v,m,x){var e=g.length;x=x||1;for(var n=0;n<e;n++)g[n]*=m[n]*x},"probability density":function(g,v,m,x){var e=g.length;x&&(v/=x);for(var n=0;n<e;n++)g[n]*=m[n]/v}}},{}],834:[function(y,ee,Q){"use strict";var g=y("../histogram/attributes"),v=y("../histogram/bin_attributes"),m=y("../heatmap/attributes"),x=y("../../plots/attributes"),e=y("../../plots/cartesian/axis_format_attributes").axisHoverFormat,n=y("../../plots/template_attributes").hovertemplateAttrs,t=y("../../plots/template_attributes").texttemplateAttrs,a=y("../../components/colorscale/attributes"),r=y("../../lib/extend").extendFlat;ee.exports=r({x:g.x,y:g.y,z:{valType:"data_array",editType:"calc"},marker:{color:{valType:"data_array",editType:"calc"},editType:"calc"},histnorm:g.histnorm,histfunc:g.histfunc,nbinsx:g.nbinsx,xbins:v("x"),nbinsy:g.nbinsy,ybins:v("y"),autobinx:g.autobinx,autobiny:g.autobiny,bingroup:r({},g.bingroup,{}),xbingroup:r({},g.bingroup,{}),ybingroup:r({},g.bingroup,{}),xgap:m.xgap,ygap:m.ygap,zsmooth:m.zsmooth,xhoverformat:e("x"),yhoverformat:e("y"),zhoverformat:e("z",1),hovertemplate:n({},{keys:"z"}),texttemplate:t({arrayOk:!1,editType:"plot"},{keys:"z"}),textfont:m.textfont,showlegend:r({},x.showlegend,{dflt:!1})},a("",{cLetter:"z",autoColorDflt:!1}))},{"../../components/colorscale/attributes":374,"../../lib/extend":505,"../../plots/attributes":562,"../../plots/cartesian/axis_format_attributes":569,"../../plots/template_attributes":642,"../heatmap/attributes":801,"../histogram/attributes":821,"../histogram/bin_attributes":823}],835:[function(y,ee,Q){"use strict";var g=y("../../lib"),v=y("../../plots/cartesian/axes"),m=y("../histogram/bin_functions"),x=y("../histogram/norm_functions"),e=y("../histogram/average"),n=y("../histogram/bin_label_vals"),t=y("../histogram/calc").calcAllAutoBins;function a(s,i,u,f){var c,h=new Array(s);if(f)for(c=0;c<s;c++)h[c]=1/(i[c+1]-i[c]);else{var p=1/u;for(c=0;c<s;c++)h[c]=p}return h}function r(s,i){return{start:s(i.start),end:s(i.end),size:i.size}}function d(s,i,u,f,c,h){var p,o=s.length-1,b=new Array(o),l=n(u,f,s,c,h);for(p=0;p<o;p++){var T=(i||[])[p];b[p]=void 0===T?[l(s[p]),l(s[p+1],!0)]:[T,T]}return b}ee.exports=function(s,i){var u,f,c,h,p=v.getFromId(s,i.xaxis),o=v.getFromId(s,i.yaxis),b=i.xcalendar,l=i.ycalendar,T=function(tt){return p.r2c(tt,0,b)},_=function(tt){return o.r2c(tt,0,l)},w=t(s,i,p,"x"),k=w[0],L=w[1],M=t(s,i,o,"y"),I=M[0],P=M[1],S=i._length;L.length>S&&L.splice(S,L.length-S),P.length>S&&P.splice(S,P.length-S);var E=[],z=[],R=[],q="string"==typeof k.size,V="string"==typeof I.size,W=[],K=[],G=q?W:k,Y=V?K:I,$=0,B=[],N=[],U=i.histnorm,te=i.histfunc,j=-1!==U.indexOf("density"),J="max"===te||"min"===te?null:0,X=m.count,re=x[U],ne=!1,le=[],oe=[],de="z"in i?i.z:"marker"in i&&Array.isArray(i.marker.color)?i.marker.color:"";de&&"count"!==te&&(ne="avg"===te,X=m[te]);var se=k.size,ge=T(k.start),_e=T(k.end)+(ge-v.tickIncrement(ge,se,!1,b))/1e6;for(u=ge;u<_e;u=v.tickIncrement(u,se,!1,b))z.push(J),W.push(u),ne&&R.push(0);W.push(u);var we=z.length,Oe=(u-ge)/we,fe=p.c2r(ge+Oe/2,0,b),ve=I.size,Ae=_(I.start),ke=_(I.end)+(Ae-v.tickIncrement(Ae,ve,!1,l))/1e6;for(u=Ae;u<ke;u=v.tickIncrement(u,ve,!1,l)){E.push(z.slice()),K.push(u);var Pe=new Array(we);for(f=0;f<we;f++)Pe[f]=[];N.push(Pe),ne&&B.push(R.slice())}K.push(u);var Ne=E.length,De=(u-Ae)/Ne,ze=o.c2r(Ae+De/2,0,l);j&&(le=a(z.length,G,Oe,q),oe=a(E.length,Y,De,V)),q||"date"!==p.type||(G=r(T,G)),V||"date"!==o.type||(Y=r(_,Y));var Me=!0,Se=!0,Ie=new Array(we),Fe=new Array(Ne),Re=1/0,Xe=1/0,nt=1/0,ct=1/0;for(u=0;u<S;u++){var xt=L[u],dt=P[u];c=g.findBin(xt,G),h=g.findBin(dt,Y),c>=0&&c<we&&h>=0&&h<Ne&&($+=X(c,u,E[h],de,B[h]),N[h][c].push(u),Me&&(void 0===Ie[c]?Ie[c]=xt:Ie[c]!==xt&&(Me=!1)),Se&&(void 0===Fe[h]?Fe[h]=dt:Fe[h]!==dt&&(Se=!1)),Re=Math.min(Re,xt-W[c]),Xe=Math.min(Xe,W[c+1]-xt),nt=Math.min(nt,dt-K[h]),ct=Math.min(ct,K[h+1]-dt))}if(ne)for(h=0;h<Ne;h++)$+=e(E[h],B[h]);if(re)for(h=0;h<Ne;h++)re(E[h],$,le,oe[h]);return{x:L,xRanges:d(W,Me&&Ie,Re,Xe,p,b),x0:fe,dx:Oe,y:P,yRanges:d(K,Se&&Fe,nt,ct,o,l),y0:ze,dy:De,z:E,pts:N}}},{"../../lib":515,"../../plots/cartesian/axes":566,"../histogram/average":822,"../histogram/bin_functions":824,"../histogram/bin_label_vals":825,"../histogram/calc":826,"../histogram/norm_functions":833}],836:[function(y,ee,Q){"use strict";var g=y("../../lib"),v=y("./sample_defaults"),m=y("../heatmap/style_defaults"),x=y("../../components/colorscale/defaults"),e=y("../heatmap/label_defaults"),n=y("./attributes");ee.exports=function(t,a,r,d){function s(i,u){return g.coerce(t,a,n,i,u)}v(t,a,s,d),!1!==a.visible&&(m(t,a,s,d),x(t,a,d,s,{prefix:"",cLetter:"z"}),s("hovertemplate"),e(s,d),s("xhoverformat"),s("yhoverformat"))}},{"../../components/colorscale/defaults":377,"../../lib":515,"../heatmap/label_defaults":811,"../heatmap/style_defaults":815,"./attributes":834,"./sample_defaults":839}],837:[function(y,ee,Q){"use strict";var g=y("../heatmap/hover"),v=y("../../plots/cartesian/axes").hoverLabelText;ee.exports=function(m,x,e,n,t){var a=g(m,x,e,n,t);if(a){var r=(m=a[0]).index,i=m.cd[0],u=i.trace,f=i.xRanges[r[1]],c=i.yRanges[r[0]];return m.xLabel=v(m.xa,[f[0],f[1]],u.xhoverformat),m.yLabel=v(m.ya,[c[0],c[1]],u.yhoverformat),a}}},{"../../plots/cartesian/axes":566,"../heatmap/hover":808}],838:[function(y,ee,Q){"use strict";ee.exports={attributes:y("./attributes"),supplyDefaults:y("./defaults"),crossTraceDefaults:y("../histogram/cross_trace_defaults"),calc:y("../heatmap/calc"),plot:y("../heatmap/plot"),layerName:"heatmaplayer",colorbar:y("../heatmap/colorbar"),style:y("../heatmap/style"),hoverPoints:y("./hover"),eventData:y("../histogram/event_data"),moduleType:"trace",name:"histogram2d",basePlotModule:y("../../plots/cartesian"),categories:["cartesian","svg","2dMap","histogram","showLegend"],meta:{}}},{"../../plots/cartesian":578,"../heatmap/calc":802,"../heatmap/colorbar":804,"../heatmap/plot":813,"../heatmap/style":814,"../histogram/cross_trace_defaults":828,"../histogram/event_data":830,"./attributes":834,"./defaults":836,"./hover":837}],839:[function(y,ee,Q){"use strict";var g=y("../../registry"),v=y("../../lib");ee.exports=function(m,x,e,n){var t=e("x"),a=e("y"),r=v.minRowLength(t),d=v.minRowLength(a);r&&d?(x._length=Math.min(r,d),g.getComponentMethod("calendars","handleTraceDefaults")(m,x,["x","y"],n),(e("z")||e("marker.color"))&&e("histfunc"),e("histnorm"),e("autobinx"),e("autobiny")):x.visible=!1}},{"../../lib":515,"../../registry":647}],840:[function(y,ee,Q){"use strict";var g=y("../histogram2d/attributes"),v=y("../contour/attributes"),m=y("../../components/colorscale/attributes"),x=y("../../plots/cartesian/axis_format_attributes").axisHoverFormat,e=y("../../lib/extend").extendFlat;ee.exports=e({x:g.x,y:g.y,z:g.z,marker:g.marker,histnorm:g.histnorm,histfunc:g.histfunc,nbinsx:g.nbinsx,xbins:g.xbins,nbinsy:g.nbinsy,ybins:g.ybins,autobinx:g.autobinx,autobiny:g.autobiny,bingroup:g.bingroup,xbingroup:g.xbingroup,ybingroup:g.ybingroup,autocontour:v.autocontour,ncontours:v.ncontours,contours:v.contours,line:{color:v.line.color,width:e({},v.line.width,{dflt:.5}),dash:v.line.dash,smoothing:v.line.smoothing,editType:"plot"},xhoverformat:x("x"),yhoverformat:x("y"),zhoverformat:x("z",1),hovertemplate:g.hovertemplate,texttemplate:v.texttemplate,textfont:v.textfont},m("",{cLetter:"z",editTypeOverride:"calc"}))},{"../../components/colorscale/attributes":374,"../../lib/extend":505,"../../plots/cartesian/axis_format_attributes":569,"../contour/attributes":744,"../histogram2d/attributes":834}],841:[function(y,ee,Q){"use strict";var g=y("../../lib"),v=y("../histogram2d/sample_defaults"),m=y("../contour/contours_defaults"),x=y("../contour/style_defaults"),e=y("../heatmap/label_defaults"),n=y("./attributes");ee.exports=function(t,a,r,d){function s(i,u){return g.coerce(t,a,n,i,u)}v(t,a,s,d),!1!==a.visible&&(m(t,a,s,function(i){return g.coerce2(t,a,n,i)}),x(t,a,s,d),s("xhoverformat"),s("yhoverformat"),s("hovertemplate"),a.contours&&"heatmap"===a.contours.coloring&&e(s,d))}},{"../../lib":515,"../contour/contours_defaults":751,"../contour/style_defaults":765,"../heatmap/label_defaults":811,"../histogram2d/sample_defaults":839,"./attributes":840}],842:[function(y,ee,Q){"use strict";ee.exports={attributes:y("./attributes"),supplyDefaults:y("./defaults"),crossTraceDefaults:y("../histogram/cross_trace_defaults"),calc:y("../contour/calc"),plot:y("../contour/plot").plot,layerName:"contourlayer",style:y("../contour/style"),colorbar:y("../contour/colorbar"),hoverPoints:y("../contour/hover"),moduleType:"trace",name:"histogram2dcontour",basePlotModule:y("../../plots/cartesian"),categories:["cartesian","svg","2dMap","contour","histogram","showLegend"],meta:{}}},{"../../plots/cartesian":578,"../contour/calc":745,"../contour/colorbar":747,"../contour/hover":757,"../contour/plot":762,"../contour/style":764,"../histogram/cross_trace_defaults":828,"./attributes":840,"./defaults":841}],843:[function(y,ee,Q){"use strict";var g=y("../../plots/template_attributes").hovertemplateAttrs,v=y("../../plots/template_attributes").texttemplateAttrs,m=y("../../components/colorscale/attributes"),x=y("../../plots/domain").attributes,e=y("../pie/attributes"),n=y("../sunburst/attributes"),t=y("../treemap/attributes"),a=y("../treemap/constants"),r=y("../../lib/extend").extendFlat;ee.exports={labels:n.labels,parents:n.parents,values:n.values,branchvalues:n.branchvalues,count:n.count,level:n.level,maxdepth:n.maxdepth,tiling:{orientation:{valType:"enumerated",values:["v","h"],dflt:"h",editType:"plot"},flip:t.tiling.flip,pad:{valType:"number",min:0,dflt:0,editType:"plot"},editType:"calc"},marker:r({colors:n.marker.colors,line:n.marker.line,editType:"calc"},m("marker",{colorAttr:"colors",anim:!1})),leaf:n.leaf,pathbar:t.pathbar,text:e.text,textinfo:n.textinfo,texttemplate:v({editType:"plot"},{keys:a.eventDataKeys.concat(["label","value"])}),hovertext:e.hovertext,hoverinfo:n.hoverinfo,hovertemplate:g({},{keys:a.eventDataKeys}),textfont:e.textfont,insidetextfont:e.insidetextfont,outsidetextfont:t.outsidetextfont,textposition:t.textposition,sort:e.sort,root:n.root,domain:x({name:"icicle",trace:!0,editType:"calc"})}},{"../../components/colorscale/attributes":374,"../../lib/extend":505,"../../plots/domain":593,"../../plots/template_attributes":642,"../pie/attributes":910,"../sunburst/attributes":1058,"../treemap/attributes":1084,"../treemap/constants":1087}],844:[function(y,ee,Q){"use strict";var g=y("../../plots/plots");Q.name="icicle",Q.plot=function(v,m,x,e){g.plotBasePlot(Q.name,v,m,x,e)},Q.clean=function(v,m,x,e){g.cleanBasePlot(Q.name,v,m,x,e)}},{"../../plots/plots":628}],845:[function(y,ee,Q){"use strict";var g=y("../sunburst/calc");Q.calc=function(v,m){return g.calc(v,m)},Q.crossTraceCalc=function(v){return g._runCrossTraceCalc("icicle",v)}},{"../sunburst/calc":1060}],846:[function(y,ee,Q){"use strict";var g=y("../../lib"),v=y("./attributes"),m=y("../../components/color"),x=y("../../plots/domain").defaults,e=y("../bar/defaults").handleText,n=y("../bar/constants").TEXTPAD,t=y("../../components/colorscale"),a=t.hasColorscale,r=t.handleDefaults;ee.exports=function(d,s,i,u){function f(T,_){return g.coerce(d,s,v,T,_)}var c=f("labels"),h=f("parents");if(c&&c.length&&h&&h.length){var p=f("values");f(p&&p.length?"branchvalues":"count"),f("level"),f("maxdepth"),f("tiling.orientation"),f("tiling.flip"),f("tiling.pad");var o=f("text");f("texttemplate"),s.texttemplate||f("textinfo",Array.isArray(o)?"text+label":"label"),f("hovertext"),f("hovertemplate");var b=f("pathbar.visible");e(d,s,u,f,"auto",{hasPathbar:b,moduleHasSelected:!1,moduleHasUnselected:!1,moduleHasConstrain:!1,moduleHasCliponaxis:!1,moduleHasTextangle:!1,moduleHasInsideanchor:!1}),f("textposition"),f("marker.line.width")&&f("marker.line.color",u.paper_bgcolor),f("marker.colors");var l=s._hasColorscale=a(d,"marker","colors")||(d.marker||{}).coloraxis;l&&r(d,s,u,f,{prefix:"marker.",cLetter:"c"}),f("leaf.opacity",l?1:.7),s._hovered={marker:{line:{width:2,color:m.contrast(u.paper_bgcolor)}}},b&&(f("pathbar.thickness",s.pathbar.textfont.size+2*n),f("pathbar.side"),f("pathbar.edgeshape")),f("sort"),f("root.color"),x(s,u,f),s._length=null}else s.visible=!1}},{"../../components/color":367,"../../components/colorscale":379,"../../lib":515,"../../plots/domain":593,"../bar/constants":659,"../bar/defaults":661,"./attributes":843}],847:[function(y,ee,Q){"use strict";var g=y("@plotly/d3"),v=y("../../lib"),m=y("../../components/drawing"),x=y("../../lib/svg_text_utils"),e=y("./partition"),n=y("./style").styleOne,t=y("../treemap/constants"),a=y("../sunburst/helpers"),r=y("../sunburst/fx"),d=y("../sunburst/plot").formatSliceLabel;ee.exports=function(s,i,u,f,c){var h=c.width,p=c.height,o=c.viewX,b=c.viewY,l=c.pathSlice,T=c.toMoveInsideSlice,_=c.strTransform,w=c.hasTransition,k=c.handleSlicesExit,L=c.makeUpdateSliceInterpolator,M=c.makeUpdateTextInterpolator,I=c.prevEntry,P=s._fullLayout,S=i[0].trace,E=-1!==S.textposition.indexOf("left"),z=-1!==S.textposition.indexOf("right"),R=-1!==S.textposition.indexOf("bottom"),q=e(u,[h,p],{flipX:S.tiling.flip.indexOf("x")>-1,flipY:S.tiling.flip.indexOf("y")>-1,orientation:S.tiling.orientation,pad:{inner:S.tiling.pad},maxDepth:S._maxDepth}).descendants(),V=1/0,W=-1/0;q.forEach(function(B){var N=B.depth;N>=S._maxDepth?(B.x0=B.x1=(B.x0+B.x1)/2,B.y0=B.y1=(B.y0+B.y1)/2):(V=Math.min(V,N),W=Math.max(W,N))}),f=f.data(q,a.getPtId),S._maxVisibleLayers=isFinite(W)?W-V+1:0,f.enter().append("g").classed("slice",!0),k(f,!1,{},[h,p],l),f.order();var K=null;if(w&&I){var G=a.getPtId(I);f.each(function(B){null===K&&a.getPtId(B)===G&&(K={x0:B.x0,x1:B.x1,y0:B.y0,y1:B.y1})})}var Y=function(){return K||{x0:0,x1:h,y0:0,y1:p}},$=f;return w&&($=$.transition().each("end",function(){var B=g.select(this);a.setSliceCursor(B,s,{hideOnRoot:!0,hideOnLeaves:!1,isTransitioning:!1})})),$.each(function(B){B._x0=o(B.x0),B._x1=o(B.x1),B._y0=b(B.y0),B._y1=b(B.y1),B._hoverX=o(B.x1-S.tiling.pad),B._hoverY=b(R?B.y1-S.tiling.pad/2:B.y0+S.tiling.pad/2);var N=g.select(this),U=v.ensureSingle(N,"path","surface",function(X){X.style("pointer-events","all")});w?U.transition().attrTween("d",function(X){var re=L(X,!1,Y(),[h,p],{orientation:S.tiling.orientation,flipX:S.tiling.flip.indexOf("x")>-1,flipY:S.tiling.flip.indexOf("y")>-1});return function(ne){return l(re(ne))}}):U.attr("d",l),N.call(r,u,s,i,{styleOne:n,eventDataKeys:t.eventDataKeys,transitionTime:t.CLICK_TRANSITION_TIME,transitionEasing:t.CLICK_TRANSITION_EASING}).call(a.setSliceCursor,s,{isTransitioning:s._transitioning}),U.call(n,B,S,{hovered:!1}),B._text=B.x0===B.x1||B.y0===B.y1?"":d(B,u,S,i,P)||"";var te=v.ensureSingle(N,"g","slicetext"),j=v.ensureSingle(te,"text","",function(X){X.attr("data-notex",1)}),J=v.ensureUniformFontSize(s,a.determineTextFont(S,B,P.font));j.text(B._text||" ").classed("slicetext",!0).attr("text-anchor",z?"end":E?"start":"middle").call(m.font,J).call(x.convertToTspans,s),B.textBB=m.bBox(j.node()),B.transform=T(B,{fontSize:J.size}),B.transform.fontSize=J.size,w?j.transition().attrTween("transform",function(X){var re=M(X,!1,Y(),[h,p]);return function(ne){return _(re(ne))}}):j.attr("transform",_(B))}),K}},{"../../components/drawing":389,"../../lib":515,"../../lib/svg_text_utils":541,"../sunburst/fx":1063,"../sunburst/helpers":1064,"../sunburst/plot":1068,"../treemap/constants":1087,"./partition":851,"./style":853,"@plotly/d3":58}],848:[function(y,ee,Q){"use strict";ee.exports={moduleType:"trace",name:"icicle",basePlotModule:y("./base_plot"),categories:[],animatable:!0,attributes:y("./attributes"),layoutAttributes:y("./layout_attributes"),supplyDefaults:y("./defaults"),supplyLayoutDefaults:y("./layout_defaults"),calc:y("./calc").calc,crossTraceCalc:y("./calc").crossTraceCalc,plot:y("./plot"),style:y("./style").style,colorbar:y("../scatter/marker_colorbar"),meta:{}}},{"../scatter/marker_colorbar":954,"./attributes":843,"./base_plot":844,"./calc":845,"./defaults":846,"./layout_attributes":849,"./layout_defaults":850,"./plot":852,"./style":853}],849:[function(y,ee,Q){"use strict";ee.exports={iciclecolorway:{valType:"colorlist",editType:"calc"},extendiciclecolors:{valType:"boolean",dflt:!0,editType:"calc"}}},{}],850:[function(y,ee,Q){"use strict";var g=y("../../lib"),v=y("./layout_attributes");ee.exports=function(m,x){function e(n,t){return g.coerce(m,x,v,n,t)}e("iciclecolorway",x.colorway),e("extendiciclecolors")}},{"../../lib":515,"./layout_attributes":849}],851:[function(y,ee,Q){"use strict";var g=y("d3-hierarchy"),v=y("../treemap/flip_tree");ee.exports=function(m,x,e){var n=e.flipX,t=e.flipY,a="h"===e.orientation,r=e.maxDepth,d=x[0],s=x[1];r&&(d=(m.height+1)*x[0]/Math.min(m.height+1,r),s=(m.height+1)*x[1]/Math.min(m.height+1,r));var i=g.partition().padding(e.pad.inner).size(a?[x[1],d]:[x[0],s])(m);return(a||n||t)&&v(i,x,{swapXY:a,flipX:n,flipY:t}),i}},{"../treemap/flip_tree":1092,"d3-hierarchy":115}],852:[function(y,ee,Q){"use strict";var g=y("../treemap/draw"),v=y("./draw_descendants");ee.exports=function(m,x,e,n){return g(m,x,e,n,{type:"icicle",drawDescendants:v})}},{"../treemap/draw":1089,"./draw_descendants":847}],853:[function(y,ee,Q){"use strict";var g=y("@plotly/d3"),v=y("../../components/color"),m=y("../../lib"),x=y("../bar/uniform_text").resizeText;function e(n,t,a){var r=t.data.data,d=!t.children,s=r.i,i=m.castOption(a,s,"marker.line.color")||v.defaultLine,u=m.castOption(a,s,"marker.line.width")||0;n.style("stroke-width",u).call(v.fill,r.color).call(v.stroke,i).style("opacity",d?a.leaf.opacity:null)}ee.exports={style:function(n){var t=n._fullLayout._iciclelayer.selectAll(".trace");x(n,t,"icicle"),t.each(function(a){var r=g.select(this),d=a[0].trace;r.style("opacity",d.opacity),r.selectAll("path.surface").each(function(s){g.select(this).call(e,s,d)})})},styleOne:e}},{"../../components/color":367,"../../lib":515,"../bar/uniform_text":673,"@plotly/d3":58}],854:[function(y,ee,Q){"use strict";for(var g=y("../../plots/attributes"),v=y("../../plots/template_attributes").hovertemplateAttrs,m=y("../../lib/extend").extendFlat,x=y("./constants").colormodel,e=["rgb","rgba","rgba256","hsl","hsla"],n=[],t=[],a=0;a<e.length;a++){var r=x[e[a]];n.push("For the `"+e[a]+"` colormodel, it is ["+(r.zminDflt||r.min).join(", ")+"]."),t.push("For the `"+e[a]+"` colormodel, it is ["+(r.zmaxDflt||r.max).join(", ")+"].")}ee.exports=m({source:{valType:"string",editType:"calc"},z:{valType:"data_array",editType:"calc"},colormodel:{valType:"enumerated",values:e,editType:"calc"},zsmooth:{valType:"enumerated",values:["fast",!1],dflt:!1,editType:"plot"},zmin:{valType:"info_array",items:[{valType:"number",editType:"calc"},{valType:"number",editType:"calc"},{valType:"number",editType:"calc"},{valType:"number",editType:"calc"}],editType:"calc"},zmax:{valType:"info_array",items:[{valType:"number",editType:"calc"},{valType:"number",editType:"calc"},{valType:"number",editType:"calc"},{valType:"number",editType:"calc"}],editType:"calc"},x0:{valType:"any",dflt:0,editType:"calc+clearAxisTypes"},y0:{valType:"any",dflt:0,editType:"calc+clearAxisTypes"},dx:{valType:"number",dflt:1,editType:"calc"},dy:{valType:"number",dflt:1,editType:"calc"},text:{valType:"data_array",editType:"plot"},hovertext:{valType:"data_array",editType:"plot"},hoverinfo:m({},g.hoverinfo,{flags:["x","y","z","color","name","text"],dflt:"x+y+z+text+name"}),hovertemplate:v({},{keys:["z","color","colormodel"]}),transforms:void 0})},{"../../lib/extend":505,"../../plots/attributes":562,"../../plots/template_attributes":642,"./constants":856}],855:[function(y,ee,Q){"use strict";var g=y("../../lib"),v=y("./constants"),m=y("fast-isnumeric"),x=y("../../plots/cartesian/axes"),e=y("../../lib").maxRowLength,n=y("./helpers").getImageSize;function t(r,d,s,i){return function(u){return g.constrain((u-r)*d,s,i)}}function a(r,d){return function(s){return g.constrain(s,r,d)}}ee.exports=function(r,d){var s,i;if(d._hasZ)s=d.z.length,i=e(d.z);else if(d._hasSource){var u=n(d.source);s=u.height,i=u.width}var f,c=x.getFromId(r,d.xaxis||"x"),h=x.getFromId(r,d.yaxis||"y"),p=c.d2c(d.x0)-d.dx/2,o=h.d2c(d.y0)-d.dy/2,b=[p,p+i*d.dx],l=[o,o+s*d.dy];if(c&&"log"===c.type)for(f=0;f<i;f++)b.push(p+f*d.dx);if(h&&"log"===h.type)for(f=0;f<s;f++)l.push(o+f*d.dy);return d._extremes[c._id]=x.findExtremes(c,b),d._extremes[h._id]=x.findExtremes(h,l),d._scaler=function(T){var _=v.colormodel[T.colormodel],w=(_.colormodel||T.colormodel).length;T._sArray=[];for(var k=0;k<w;k++)T._sArray.push(_.min[k]!==T.zmin[k]||_.max[k]!==T.zmax[k]?t(T.zmin[k],(_.max[k]-_.min[k])/(T.zmax[k]-T.zmin[k]),_.min[k],_.max[k]):a(_.min[k],_.max[k]));return function(L){for(var M=L.slice(0,w),I=0;I<w;I++){var P=M[I];if(!m(P))return!1;M[I]=T._sArray[I](P)}return M}}(d),[{x0:p,y0:o,z:d.z,w:i,h:s}]}},{"../../lib":515,"../../plots/cartesian/axes":566,"./constants":856,"./helpers":859,"fast-isnumeric":190}],856:[function(y,ee,Q){"use strict";ee.exports={colormodel:{rgb:{min:[0,0,0],max:[255,255,255],fmt:function(g){return g.slice(0,3)},suffix:["","",""]},rgba:{min:[0,0,0,0],max:[255,255,255,1],fmt:function(g){return g.slice(0,4)},suffix:["","","",""]},rgba256:{colormodel:"rgba",zminDflt:[0,0,0,0],zmaxDflt:[255,255,255,255],min:[0,0,0,0],max:[255,255,255,1],fmt:function(g){return g.slice(0,4)},suffix:["","","",""]},hsl:{min:[0,0,0],max:[360,100,100],fmt:function(g){var v=g.slice(0,3);return v[1]=v[1]+"%",v[2]=v[2]+"%",v},suffix:["\xb0","%","%"]},hsla:{min:[0,0,0,0],max:[360,100,100,1],fmt:function(g){var v=g.slice(0,4);return v[1]=v[1]+"%",v[2]=v[2]+"%",v},suffix:["\xb0","%","%",""]}},pixelatedStyle:["image-rendering: optimizeSpeed","image-rendering: -moz-crisp-edges","image-rendering: -o-crisp-edges","image-rendering: -webkit-optimize-contrast","image-rendering: optimize-contrast","image-rendering: crisp-edges","image-rendering: pixelated",""].join("; ")}},{}],857:[function(y,ee,Q){"use strict";var g=y("../../lib"),v=y("./attributes"),m=y("./constants"),x=y("../../snapshot/helpers").IMAGE_URL_PREFIX;ee.exports=function(e,n){function t(d,s){return g.coerce(e,n,v,d,s)}t("source"),n.source&&!n.source.match(x)&&delete n.source,n._hasSource=!!n.source;var a,r=t("z");n._hasZ=!(void 0===r||!r.length||!r[0]||!r[0].length),n._hasZ||n._hasSource?(t("x0"),t("y0"),t("dx"),t("dy"),n._hasZ?(t("colormodel","rgb"),t("zmin",(a=m.colormodel[n.colormodel]).zminDflt||a.min),t("zmax",a.zmaxDflt||a.max)):n._hasSource&&(n.colormodel="rgba256",n.zmin=(a=m.colormodel[n.colormodel]).zminDflt,n.zmax=a.zmaxDflt),t("zsmooth"),t("text"),t("hovertext"),t("hovertemplate"),n._length=null):n.visible=!1}},{"../../lib":515,"../../snapshot/helpers":651,"./attributes":854,"./constants":856}],858:[function(y,ee,Q){"use strict";ee.exports=function(g,v){return"xVal"in v&&(g.x=v.xVal),"yVal"in v&&(g.y=v.yVal),v.xa&&(g.xaxis=v.xa),v.ya&&(g.yaxis=v.ya),g.color=v.color,g.colormodel=v.trace.colormodel,g.z||(g.z=v.color),g}},{}],859:[function(y,ee,Q){"use strict";var g=y("probe-image-size/sync"),v=y("../../snapshot/helpers").IMAGE_URL_PREFIX,m=y("buffer/").Buffer;Q.getImageSize=function(x){var e=x.replace(v,""),n=new m(e,"base64");return g(n)}},{"../../snapshot/helpers":651,"buffer/":85,"probe-image-size/sync":277}],860:[function(y,ee,Q){"use strict";var g=y("../../components/fx"),v=y("../../lib"),m=y("./constants");ee.exports=function(x,e,n){var t=x.cd[0],a=t.trace,r=x.xa,d=x.ya;if(!(g.inbox(e-t.x0,e-(t.x0+t.w*a.dx),0)>0||g.inbox(n-t.y0,n-(t.y0+t.h*a.dy),0)>0)){var s,i=Math.floor((e-t.x0)/a.dx),u=Math.floor(Math.abs(n-t.y0)/a.dy);if(a._hasZ?s=t.z[u][i]:a._hasSource&&(s=a._canvas.el.getContext("2d",{willReadFrequently:!0}).getImageData(i,u,1,1).data),s){var f,c=t.hi||a.hoverinfo;if(c){var h=c.split("+");-1!==h.indexOf("all")&&(h=["color"]),-1!==h.indexOf("color")&&(f=!0)}var p,o=m.colormodel[a.colormodel],b=o.colormodel||a.colormodel,l=b.length,T=a._scaler(s),_=o.suffix,w=[];(a.hovertemplate||f)&&(w.push("["+[T[0]+_[0],T[1]+_[1],T[2]+_[2]].join(", ")),4===l&&w.push(", "+T[3]+_[3]),w.push("]"),w=w.join(""),x.extraText=b.toUpperCase()+": "+w),Array.isArray(a.hovertext)&&Array.isArray(a.hovertext[u])?p=a.hovertext[u][i]:Array.isArray(a.text)&&Array.isArray(a.text[u])&&(p=a.text[u][i]);var k=d.c2p(t.y0+(u+.5)*a.dy),L=t.x0+(i+.5)*a.dx,M=t.y0+(u+.5)*a.dy,I="["+s.slice(0,a.colormodel.length).join(", ")+"]";return[v.extendFlat(x,{index:[u,i],x0:r.c2p(t.x0+i*a.dx),x1:r.c2p(t.x0+(i+1)*a.dx),y0:k,y1:k,color:T,xVal:L,xLabelVal:L,yVal:M,yLabelVal:M,zLabelVal:I,text:p,hovertemplateLabels:{zLabel:I,colorLabel:w,"color[0]Label":T[0]+_[0],"color[1]Label":T[1]+_[1],"color[2]Label":T[2]+_[2],"color[3]Label":T[3]+_[3]}})]}}}},{"../../components/fx":407,"../../lib":515,"./constants":856}],861:[function(y,ee,Q){"use strict";ee.exports={attributes:y("./attributes"),supplyDefaults:y("./defaults"),calc:y("./calc"),plot:y("./plot"),style:y("./style"),hoverPoints:y("./hover"),eventData:y("./event_data"),moduleType:"trace",name:"image",basePlotModule:y("../../plots/cartesian"),categories:["cartesian","svg","2dMap","noSortingByValue"],animatable:!1,meta:{}}},{"../../plots/cartesian":578,"./attributes":854,"./calc":855,"./defaults":857,"./event_data":858,"./hover":860,"./plot":862,"./style":863}],862:[function(y,ee,Q){"use strict";var g=y("@plotly/d3"),v=y("../../lib"),m=v.strTranslate,x=y("../../constants/xmlns_namespaces"),e=y("./constants"),n=v.isIOS()||v.isSafari()||v.isIE();ee.exports=function(t,a,r,d){var s=a.xaxis,i=a.yaxis,u=!(n||t._context._exportedPlot);v.makeTraceGroups(d,r,"im").each(function(f){var c=g.select(this),h=f[0],p=h.trace,o=("fast"===p.zsmooth||!1===p.zsmooth&&u)&&!p._hasZ&&p._hasSource&&"linear"===s.type&&"linear"===i.type;p._realImage=o;var b,l,T,_,w,k,L=h.z,M=h.x0,I=h.y0,P=h.w,S=h.h,E=p.dx,z=p.dy;for(k=0;void 0===b&&k<P;)b=s.c2p(M+k*E),k++;for(k=P;void 0===l&&k>0;)l=s.c2p(M+k*E),k--;for(k=0;void 0===_&&k<S;)_=i.c2p(I+k*z),k++;for(k=S;void 0===w&&k>0;)w=i.c2p(I+k*z),k--;l<b&&(T=l,l=b,b=T),w<_&&(T=_,_=w,w=T),!o&&(b=Math.max(-.5*s._length,b),l=Math.min(1.5*s._length,l),_=Math.max(-.5*i._length,_),w=Math.min(1.5*i._length,w));var R=Math.round(l-b),q=Math.round(w-_);if(R<=0||q<=0)c.selectAll("image").data([]).exit().remove();else{var V=c.selectAll("image").data([f]);V.enter().append("svg:image").attr({xmlns:x.svg,preserveAspectRatio:"none"}),V.exit().remove();var W=!1===p.zsmooth?e.pixelatedStyle:"";if(o){var K=v.simpleMap(s.range,s.r2l),G=v.simpleMap(i.range,i.r2l),Y=K[1]<K[0],$=G[1]>G[0];if(Y||$){var B=b+R/2,N=_+q/2;W+="transform:"+m(B+"px",N+"px")+"scale("+(Y?-1:1)+","+($?-1:1)+")"+m(-B+"px",-N+"px")+";"}}V.attr("style",W);var U=new Promise(function(j){if(p._hasZ)j();else if(p._hasSource)if(p._canvas&&p._canvas.el.width===P&&p._canvas.el.height===S&&p._canvas.source===p.source)j();else{var J=document.createElement("canvas");J.width=P,J.height=S;var X=J.getContext("2d",{willReadFrequently:!0});p._image=p._image||new Image;var re=p._image;re.onload=function(){X.drawImage(re,0,0),p._canvas={el:J,source:p.source},j()},re.setAttribute("src",p.source)}}).then(function(){var j;if(p._hasZ)j=te(function(X,re){return L[re][X]}).toDataURL("image/png");else if(p._hasSource)if(o)j=p.source;else{var J=p._canvas.el.getContext("2d",{willReadFrequently:!0}).getImageData(0,0,P,S).data;j=te(function(X,re){var ne=4*(re*P+X);return[J[ne],J[ne+1],J[ne+2],J[ne+3]]}).toDataURL("image/png")}V.attr({"xlink:href":j,height:q,width:R,x:b,y:_})});t._promises.push(U)}function te(j){var J=document.createElement("canvas");J.width=R,J.height=q;var X,re=J.getContext("2d",{willReadFrequently:!0}),ne=function(fe){return v.constrain(Math.round(s.c2p(M+fe*E)-b),0,R)},le=function(fe){return v.constrain(Math.round(i.c2p(I+fe*z)-_),0,q)},oe=e.colormodel[p.colormodel],de=oe.colormodel||p.colormodel,se=oe.fmt;for(k=0;k<h.w;k++){var ge=ne(k),_e=ne(k+1);if(_e!==ge&&!isNaN(_e)&&!isNaN(ge))for(var Te=0;Te<h.h;Te++){var we=le(Te),Oe=le(Te+1);Oe===we||isNaN(Oe)||isNaN(we)||!j(k,Te)||(X=p._scaler(j(k,Te)),re.fillStyle=X?de+"("+se(X).join(",")+")":"rgba(0,0,0,0)",re.fillRect(ge,we,_e-ge,Oe-we))}}return J}})}},{"../../constants/xmlns_namespaces":492,"../../lib":515,"./constants":856,"@plotly/d3":58}],863:[function(y,ee,Q){"use strict";var g=y("@plotly/d3");ee.exports=function(v){g.select(v).selectAll(".im image").style("opacity",function(m){return m[0].trace.opacity})}},{"@plotly/d3":58}],864:[function(y,ee,Q){"use strict";var g=y("../../lib/extend").extendFlat,v=y("../../lib/extend").extendDeep,m=y("../../plot_api/edit_types").overrideAll,x=y("../../plots/font_attributes"),e=y("../../components/color/attributes"),n=y("../../plots/domain").attributes,t=y("../../plots/cartesian/layout_attributes"),a=y("../../plot_api/plot_template").templatedArray,r=y("../../constants/delta.js"),d=y("../../plots/cartesian/axis_format_attributes").descriptionOnlyNumbers,s=x({editType:"plot",colorEditType:"plot"}),i={color:{valType:"color",editType:"plot"},line:{color:{valType:"color",dflt:e.defaultLine,editType:"plot"},width:{valType:"number",min:0,dflt:0,editType:"plot"},editType:"calc"},thickness:{valType:"number",min:0,max:1,dflt:1,editType:"plot"},editType:"calc"},u={valType:"info_array",items:[{valType:"number",editType:"plot"},{valType:"number",editType:"plot"}],editType:"plot"},f=a("step",v({},i,{range:u}));ee.exports={mode:{valType:"flaglist",editType:"calc",flags:["number","delta","gauge"],dflt:"number"},value:{valType:"number",editType:"calc",anim:!0},align:{valType:"enumerated",values:["left","center","right"],editType:"plot"},domain:n({name:"indicator",trace:!0,editType:"calc"}),title:{text:{valType:"string",editType:"plot"},align:{valType:"enumerated",values:["left","center","right"],editType:"plot"},font:g({},s,{}),editType:"plot"},number:{valueformat:{valType:"string",dflt:"",editType:"plot",description:d("value")},font:g({},s,{}),prefix:{valType:"string",dflt:"",editType:"plot"},suffix:{valType:"string",dflt:"",editType:"plot"},editType:"plot"},delta:{reference:{valType:"number",editType:"calc"},position:{valType:"enumerated",values:["top","bottom","left","right"],dflt:"bottom",editType:"plot"},relative:{valType:"boolean",editType:"plot",dflt:!1},valueformat:{valType:"string",editType:"plot",description:d("value")},increasing:{symbol:{valType:"string",dflt:r.INCREASING.SYMBOL,editType:"plot"},color:{valType:"color",dflt:r.INCREASING.COLOR,editType:"plot"},editType:"plot"},decreasing:{symbol:{valType:"string",dflt:r.DECREASING.SYMBOL,editType:"plot"},color:{valType:"color",dflt:r.DECREASING.COLOR,editType:"plot"},editType:"plot"},font:g({},s,{}),prefix:{valType:"string",dflt:"",editType:"plot"},suffix:{valType:"string",dflt:"",editType:"plot"},editType:"calc"},gauge:{shape:{valType:"enumerated",editType:"plot",dflt:"angular",values:["angular","bullet"]},bar:v({},i,{color:{dflt:"green"}}),bgcolor:{valType:"color",editType:"plot"},bordercolor:{valType:"color",dflt:e.defaultLine,editType:"plot"},borderwidth:{valType:"number",min:0,dflt:1,editType:"plot"},axis:m({range:u,visible:g({},t.visible,{dflt:!0}),tickmode:t.tickmode,nticks:t.nticks,tick0:t.tick0,dtick:t.dtick,tickvals:t.tickvals,ticktext:t.ticktext,ticks:g({},t.ticks,{dflt:"outside"}),ticklen:t.ticklen,tickwidth:t.tickwidth,tickcolor:t.tickcolor,ticklabelstep:t.ticklabelstep,showticklabels:t.showticklabels,tickfont:x({}),tickangle:t.tickangle,tickformat:t.tickformat,tickformatstops:t.tickformatstops,tickprefix:t.tickprefix,showtickprefix:t.showtickprefix,ticksuffix:t.ticksuffix,showticksuffix:t.showticksuffix,separatethousands:t.separatethousands,exponentformat:t.exponentformat,minexponent:t.minexponent,showexponent:t.showexponent,editType:"plot"},"plot"),steps:f,threshold:{line:{color:g({},i.line.color,{}),width:g({},i.line.width,{dflt:1}),editType:"plot"},thickness:g({},i.thickness,{dflt:.85}),value:{valType:"number",editType:"calc",dflt:!1},editType:"plot"},editType:"plot"}}},{"../../components/color/attributes":366,"../../constants/delta.js":485,"../../lib/extend":505,"../../plot_api/edit_types":548,"../../plot_api/plot_template":555,"../../plots/cartesian/axis_format_attributes":569,"../../plots/cartesian/layout_attributes":579,"../../plots/domain":593,"../../plots/font_attributes":594}],865:[function(y,ee,Q){"use strict";var g=y("../../plots/plots");Q.name="indicator",Q.plot=function(v,m,x,e){g.plotBasePlot(Q.name,v,m,x,e)},Q.clean=function(v,m,x,e){g.cleanBasePlot(Q.name,v,m,x,e)}},{"../../plots/plots":628}],866:[function(y,ee,Q){"use strict";ee.exports={calc:function(g,v){var m=[],x=v.value;"number"!=typeof v._lastValue&&(v._lastValue=v.value);var e=v._lastValue,n=e;return v._hasDelta&&"number"==typeof v.delta.reference&&(n=v.delta.reference),m[0]={y:x,lastY:e,delta:x-n,relativeDelta:(x-n)/n},m}}},{}],867:[function(y,ee,Q){"use strict";ee.exports={defaultNumberFontSize:80,bulletNumberDomainSize:.25,bulletPadding:.025,innerRadius:.75,valueThickness:.5,titlePadding:5,horizontalPadding:10}},{}],868:[function(y,ee,Q){"use strict";var g=y("../../lib"),v=y("./attributes"),m=y("../../plots/domain").defaults,x=y("../../plot_api/plot_template"),e=y("../../plots/array_container_defaults"),n=y("./constants.js"),t=y("../../plots/cartesian/tick_value_defaults"),a=y("../../plots/cartesian/tick_mark_defaults"),r=y("../../plots/cartesian/tick_label_defaults"),d=y("../../plots/cartesian/prefix_suffix_defaults");function s(i,u){function f(c,h){return g.coerce(i,u,v.gauge.steps,c,h)}f("color"),f("line.color"),f("line.width"),f("range"),f("thickness")}ee.exports={supplyDefaults:function(i,u,f,c){function h(P,S){return g.coerce(i,u,v,P,S)}m(u,c,h),h("mode"),u._hasNumber=-1!==u.mode.indexOf("number"),u._hasDelta=-1!==u.mode.indexOf("delta"),u._hasGauge=-1!==u.mode.indexOf("gauge");var p=h("value");u._range=[0,"number"==typeof p?1.5*p:1];var o,b,l,T,_,w,k=new Array(2);function L(P,S){return g.coerce(l,T,v.gauge,P,S)}function M(P,S){return g.coerce(_,w,v.gauge.axis,P,S)}if(u._hasNumber&&(h("number.valueformat"),h("number.font.color",c.font.color),h("number.font.family",c.font.family),h("number.font.size"),void 0===u.number.font.size&&(u.number.font.size=n.defaultNumberFontSize,k[0]=!0),h("number.prefix"),h("number.suffix"),o=u.number.font.size),u._hasDelta&&(h("delta.font.color",c.font.color),h("delta.font.family",c.font.family),h("delta.font.size"),void 0===u.delta.font.size&&(u.delta.font.size=(u._hasNumber?.5:1)*(o||n.defaultNumberFontSize),k[1]=!0),h("delta.reference",u.value),h("delta.relative"),h("delta.valueformat",u.delta.relative?"2%":""),h("delta.increasing.symbol"),h("delta.increasing.color"),h("delta.decreasing.symbol"),h("delta.decreasing.color"),h("delta.position"),h("delta.prefix"),h("delta.suffix"),b=u.delta.font.size),u._scaleNumbers=(!u._hasNumber||k[0])&&(!u._hasDelta||k[1])||!1,h("title.font.color",c.font.color),h("title.font.family",c.font.family),h("title.font.size",.25*(o||b||n.defaultNumberFontSize)),h("title.text"),u._hasGauge){(l=i.gauge)||(l={}),T=x.newContainer(u,"gauge"),L("shape"),(u._isBullet="bullet"===u.gauge.shape)||h("title.align","center"),(u._isAngular="angular"===u.gauge.shape)||h("align","center"),L("bgcolor",c.paper_bgcolor),L("borderwidth"),L("bordercolor"),L("bar.color"),L("bar.line.color"),L("bar.line.width"),L("bar.thickness",n.valueThickness*("bullet"===u.gauge.shape?.5:1)),e(l,T,{name:"steps",handleItemDefaults:s}),L("threshold.value"),L("threshold.thickness"),L("threshold.line.width"),L("threshold.line.color"),_={},l&&(_=l.axis||{}),w=x.newContainer(T,"axis"),M("visible"),u._range=M("range",u._range);var I={outerTicks:!0};t(_,w,M,"linear"),d(_,w,M,"linear",I),r(_,w,M,"linear",I),a(_,w,M,I)}else h("title.align","center"),h("align","center"),u._isAngular=u._isBullet=!1;u._length=null}}},{"../../lib":515,"../../plot_api/plot_template":555,"../../plots/array_container_defaults":561,"../../plots/cartesian/prefix_suffix_defaults":583,"../../plots/cartesian/tick_label_defaults":587,"../../plots/cartesian/tick_mark_defaults":588,"../../plots/cartesian/tick_value_defaults":589,"../../plots/domain":593,"./attributes":864,"./constants.js":867}],869:[function(y,ee,Q){"use strict";ee.exports={moduleType:"trace",name:"indicator",basePlotModule:y("./base_plot"),categories:["svg","noOpacity","noHover"],animatable:!0,attributes:y("./attributes"),supplyDefaults:y("./defaults").supplyDefaults,calc:y("./calc").calc,plot:y("./plot"),meta:{}}},{"./attributes":864,"./base_plot":865,"./calc":866,"./defaults":868,"./plot":870}],870:[function(y,ee,Q){"use strict";var g=y("@plotly/d3"),v=y("d3-interpolate").interpolate,m=y("d3-interpolate").interpolateNumber,x=y("../../lib"),e=x.strScale,n=x.strTranslate,t=x.rad2deg,a=y("../../constants/alignment").MID_SHIFT,r=y("../../components/drawing"),d=y("./constants"),s=y("../../lib/svg_text_utils"),i=y("../../plots/cartesian/axes"),u=y("../../plots/cartesian/axis_defaults"),f=y("../../plots/cartesian/position_defaults"),c=y("../../plots/cartesian/layout_attributes"),h=y("../../components/color"),p={left:"start",center:"middle",right:"end"},o={left:0,center:.5,right:1},b=/[yzafpn\xb5mkMGTPEZY]/;function l(M){return M&&M.duration>0}function T(M){M.each(function(I){h.stroke(g.select(this),I.line.color)}).each(function(I){h.fill(g.select(this),I.color)}).style("stroke-width",function(I){return I.line.width})}function _(M,I,P){var S=M._fullLayout,E=x.extendFlat({type:"linear",ticks:"outside",range:P,showline:!0},I),z={type:"linear",_id:"x"+I._id},R={letter:"x",font:S.font,noHover:!0,noTickson:!0};function q(V,W){return x.coerce(E,z,c,V,W)}return u(E,z,q,R,S),f(E,z,q,R),z}function w(M,I,P){return[Math.min(I/M.width,P/M.height),M,I+"x"+P]}function k(M,I,P,S){var E=document.createElementNS("http://www.w3.org/2000/svg","text"),z=g.select(E);return z.text(M).attr("x",0).attr("y",0).attr("text-anchor",P).attr("data-unformatted",M).call(s.convertToTspans,S).call(r.font,I),r.bBox(z.node())}function L(M,I,P,S,E,z){var R="_cache"+I;M[R]&&M[R].key===E||(M[R]={key:E,value:P});var q=x.aggNums(z,null,[M[R].value,S],2);return M[R].value=q,q}ee.exports=function(M,I,P,S){var E,z=M._fullLayout;l(P)&&S&&(E=S()),x.makeTraceGroups(z._indicatorlayer,I,"trace").each(function(R){var q,V,W,K,G,Y=R[0].trace,$=g.select(this),B=Y._hasGauge,N=Y._isAngular,U=Y._isBullet,te=Y.domain,j={w:z._size.w*(te.x[1]-te.x[0]),h:z._size.h*(te.y[1]-te.y[0]),l:z._size.l+z._size.w*te.x[0],r:z._size.r+z._size.w*(1-te.x[1]),t:z._size.t+z._size.h*(1-te.y[1]),b:z._size.b+z._size.h*te.y[0]},J=j.l+j.w/2,X=j.t+j.h/2,re=Math.min(j.w/2,j.h),ne=d.innerRadius*re,le=Y.align||"center";if(V=X,B){if(N&&(q=J,V=X+re/2,W=function(Oe){return fe=Oe,[(ve=.9*ne)/Math.sqrt(fe.width/2*(fe.width/2)+fe.height*fe.height),fe,ve];var fe,ve}),U){var oe=d.bulletPadding,de=1-d.bulletNumberDomainSize+oe;q=j.l+(de+(1-de)*o[le])*j.w,W=function(Oe){return w(Oe,(d.bulletNumberDomainSize-oe)*j.w,j.h)}}}else q=j.l+o[le]*j.w,W=function(Oe){return w(Oe,j.w,j.h)};(function(Oe,fe,ve,Ae){var ke,Pe,Ne,De=ve[0].trace,ze=Ae.numbersX,Me=Ae.numbersY,Se=De.align||"center",Ie=p[Se],Fe=Ae.transitionOpts,Re=Ae.onComplete,Xe=x.ensureSingle(fe,"g","numbers"),nt=[];De._hasNumber&&nt.push("number"),De._hasDelta&&(nt.push("delta"),"left"===De.delta.position&&nt.reverse());var ct=Xe.selectAll("text").data(nt);function xt(Wt,rr,Ht,Ve){if(!Wt.match("s")||Ht>=0==Ve>=0||rr(Ht).slice(-1).match(b)||rr(Ve).slice(-1).match(b))return rr;var We=Wt.slice().replace("s","f").replace(/\d+/,function(ye){return parseInt(ye)-1}),he=_(Oe,{tickformat:We});return function(ye){return Math.abs(ye)<1?i.tickText(he,ye).text:rr(ye)}}ct.enter().append("text"),ct.attr("text-anchor",function(){return Ie}).attr("class",function(Wt){return Wt}).attr("x",null).attr("y",null).attr("dx",null).attr("dy",null),ct.exit().remove();var dt,tt=De.mode+De.align;if(De._hasDelta&&(dt=function(){var Wt=_(Oe,{tickformat:De.delta.valueformat},De._range);Wt.setScale(),i.prepTicks(Wt);var rr=function(Je){return i.tickText(Wt,Je).text},Ht=De.delta.suffix,Ve=De.delta.prefix,We=function(Je){return De.delta.relative?Je.relativeDelta:Je.delta},he=function(Je,He){return 0===Je||"number"!=typeof Je||isNaN(Je)?"-":(Je>0?De.delta.increasing.symbol:De.delta.decreasing.symbol)+Ve+He(Je)+Ht},ye=function(Je){return Je.delta>=0?De.delta.increasing.color:De.delta.decreasing.color};void 0===De._deltaLastValue&&(De._deltaLastValue=We(ve[0]));var Be=Xe.select("text.delta");function Ge(){Be.text(he(We(ve[0]),rr)).call(h.fill,ye(ve[0])).call(s.convertToTspans,Oe)}return Be.call(r.font,De.delta.font).call(h.fill,ye({delta:De._deltaLastValue})),l(Fe)?Be.transition().duration(Fe.duration).ease(Fe.easing).tween("text",function(){var Je=g.select(this),He=We(ve[0]),st=De._deltaLastValue,ot=xt(De.delta.valueformat,rr,st,He),wt=m(st,He);return De._deltaLastValue=He,function(Ct){Je.text(he(wt(Ct),ot)),Je.call(h.fill,ye({delta:wt(Ct)}))}}).each("end",function(){Ge(),Re&&Re()}).each("interrupt",function(){Ge(),Re&&Re()}):Ge(),Pe=k(he(We(ve[0]),rr),De.delta.font,Ie,Oe),Be}(),tt+=De.delta.position+De.delta.font.size+De.delta.font.family+De.delta.valueformat,tt+=De.delta.increasing.symbol+De.delta.decreasing.symbol,Ne=Pe),De._hasNumber&&(function(){var Wt=_(Oe,{tickformat:De.number.valueformat},De._range);Wt.setScale(),i.prepTicks(Wt);var rr=function(ye){return i.tickText(Wt,ye).text},Ht=De.number.suffix,Ve=De.number.prefix,We=Xe.select("text.number");function he(){var ye="number"==typeof ve[0].y?Ve+rr(ve[0].y)+Ht:"-";We.text(ye).call(r.font,De.number.font).call(s.convertToTspans,Oe)}l(Fe)?We.transition().duration(Fe.duration).ease(Fe.easing).each("end",function(){he(),Re&&Re()}).each("interrupt",function(){he(),Re&&Re()}).attrTween("text",function(){var ye=g.select(this),Be=m(ve[0].lastY,ve[0].y);De._lastValue=ve[0].y;var Ge=xt(De.number.valueformat,rr,ve[0].lastY,ve[0].y);return function(Je){ye.text(Ve+Ge(Be(Je))+Ht)}}):he(),ke=k(Ve+rr(ve[0].y)+Ht,De.number.font,Ie,Oe)}(),tt+=De.number.font.size+De.number.font.family+De.number.valueformat+De.number.suffix+De.number.prefix,Ne=ke),De._hasDelta&&De._hasNumber){var Ke,mt,Bt=[(ke.left+ke.right)/2,(ke.top+ke.bottom)/2],Ut=[(Pe.left+Pe.right)/2,(Pe.top+Pe.bottom)/2],er=.75*De.delta.font.size;"left"===De.delta.position&&(Ke=L(De,"deltaPos",0,-1*(ke.width*o[De.align]+Pe.width*(1-o[De.align])+er),tt,Math.min),mt=Bt[1]-Ut[1],Ne={width:ke.width+Pe.width+er,height:Math.max(ke.height,Pe.height),left:Pe.left+Ke,right:ke.right,top:Math.min(ke.top,Pe.top+mt),bottom:Math.max(ke.bottom,Pe.bottom+mt)}),"right"===De.delta.position&&(Ke=L(De,"deltaPos",0,ke.width*(1-o[De.align])+Pe.width*o[De.align]+er,tt,Math.max),mt=Bt[1]-Ut[1],Ne={width:ke.width+Pe.width+er,height:Math.max(ke.height,Pe.height),left:ke.left,right:Pe.right+Ke,top:Math.min(ke.top,Pe.top+mt),bottom:Math.max(ke.bottom,Pe.bottom+mt)}),"bottom"===De.delta.position&&(Ke=null,mt=Pe.height,Ne={width:Math.max(ke.width,Pe.width),height:ke.height+Pe.height,left:Math.min(ke.left,Pe.left),right:Math.max(ke.right,Pe.right),top:ke.bottom-ke.height,bottom:ke.bottom+Pe.height}),"top"===De.delta.position&&(Ke=null,mt=ke.top,Ne={width:Math.max(ke.width,Pe.width),height:ke.height+Pe.height,left:Math.min(ke.left,Pe.left),right:Math.max(ke.right,Pe.right),top:ke.bottom-ke.height-Pe.height,bottom:ke.bottom}),dt.attr({dx:Ke,dy:mt})}(De._hasNumber||De._hasDelta)&&Xe.attr("transform",function(){var rr,Wt=Ae.numbersScaler(Ne),Ht=L(De,"numbersScale",1,Wt[0],tt+=Wt[2],Math.min);De._scaleNumbers||(Ht=1),De._numbersTop=Ht*Ne.top+(rr=De._isAngular?Me-Ht*Ne.bottom:Me-Ht*(Ne.top+Ne.bottom)/2);var Ve=Ne[Se];"center"===Se&&(Ve=(Ne.left+Ne.right)/2);var We=ze-Ht*Ve;return We=L(De,"numbersTranslate",0,We,tt,Math.max),n(We,rr)+e(Ht)})})(M,$,R,{numbersX:q,numbersY:V,numbersScaler:W,transitionOpts:P,onComplete:E}),B&&(K={range:Y.gauge.axis.range,color:Y.gauge.bgcolor,line:{color:Y.gauge.bordercolor,width:0},thickness:1},G={range:Y.gauge.axis.range,color:"rgba(0, 0, 0, 0)",line:{color:Y.gauge.bordercolor,width:Y.gauge.borderwidth},thickness:1});var se=$.selectAll("g.angular").data(N?R:[]);se.exit().remove();var ge=$.selectAll("g.angularaxis").data(N?R:[]);ge.exit().remove(),N&&function(Oe,fe,ve,Ae){var ke,Pe,Ne,De,ze=ve[0].trace,Me=Ae.size,Se=Ae.radius,Ie=Ae.innerRadius,Fe=Ae.gaugeBg,Re=Ae.gaugeOutline,Xe=[Me.l+Me.w/2,Me.t+Me.h/2+Se/2],nt=Ae.gauge,ct=Ae.layer,xt=Ae.transitionOpts,dt=Ae.onComplete,tt=Math.PI/2;function Ke(Ct){var rt=ze.gauge.axis.range[0],ft=(Ct-rt)/(ze.gauge.axis.range[1]-rt)*Math.PI-tt;return ft<-tt?-tt:ft>tt?tt:ft}function mt(Ct){return g.svg.arc().innerRadius((Ie+Se)/2-Ct/2*(Se-Ie)).outerRadius((Ie+Se)/2+Ct/2*(Se-Ie)).startAngle(-tt)}function Bt(Ct){Ct.attr("d",function(rt){return mt(rt.thickness).startAngle(Ke(rt.range[0])).endAngle(Ke(rt.range[1]))()})}nt.enter().append("g").classed("angular",!0),nt.attr("transform",n(Xe[0],Xe[1])),ct.enter().append("g").classed("angularaxis",!0).classed("crisp",!0),ct.selectAll("g.xangularaxistick,path,text").remove(),(ke=_(Oe,ze.gauge.axis)).type="linear",ke.range=ze.gauge.axis.range,ke._id="xangularaxis",ke.ticklabeloverflow="allow",ke.setScale();var Ut=function(Ct){return(ke.range[0]-Ct.x)/(ke.range[1]-ke.range[0])*Math.PI+Math.PI},er={},Wt=i.makeLabelFns(ke,0).labelStandoff;er.xFn=function(Ct){var rt=Ut(Ct);return Math.cos(rt)*Wt},er.yFn=function(Ct){var rt=Ut(Ct),ft=Math.sin(rt)>0?.2:1;return-Math.sin(rt)*(Wt+Ct.fontSize*ft)+Math.abs(Math.cos(rt))*(Ct.fontSize*a)},er.anchorFn=function(Ct){var rt=Ut(Ct),ft=Math.cos(rt);return Math.abs(ft)<.1?"middle":ft>0?"start":"end"},er.heightFn=function(Ct,rt,ft){var Rt=Ut(Ct);return-.5*(1+Math.sin(Rt))*ft};var rr=function(Ct){return n(Xe[0]+Se*Math.cos(Ct),Xe[1]-Se*Math.sin(Ct))};Ne=function(Ct){return rr(Ut(Ct))},Pe=i.calcTicks(ke),De=i.getTickSigns(ke)[2],ke.visible&&(i.drawTicks(Oe,ke,{vals:Pe,layer:ct,path:"M"+(De="inside"===ke.ticks?-1:1)*((ke.linewidth||1)/2)+",0h"+De*ke.ticklen,transFn:function(Ct){var rt=Ut(Ct);return rr(rt)+"rotate("+-t(rt)+")"}}),i.drawLabels(Oe,ke,{vals:Pe,layer:ct,transFn:Ne,labelFns:er}));var Ve=[Fe].concat(ze.gauge.steps),We=nt.selectAll("g.bg-arc").data(Ve);We.enter().append("g").classed("bg-arc",!0).append("path"),We.select("path").call(Bt).call(T),We.exit().remove();var he=mt(ze.gauge.bar.thickness),ye=nt.selectAll("g.value-arc").data([ze.gauge.bar]);ye.enter().append("g").classed("value-arc",!0).append("path");var Ge,Je,He,Be=ye.select("path");l(xt)?(Be.transition().duration(xt.duration).ease(xt.easing).each("end",function(){dt&&dt()}).each("interrupt",function(){dt&&dt()}).attrTween("d",(Ge=he,Je=Ke(ve[0].lastY),He=Ke(ve[0].y),function(){var Ct=v(Je,He);return function(rt){return Ge.endAngle(Ct(rt))()}})),ze._lastValue=ve[0].y):Be.attr("d","number"==typeof ve[0].y?he.endAngle(Ke(ve[0].y)):"M0,0Z"),Be.call(T),ye.exit().remove(),Ve=[];var st=ze.gauge.threshold.value;(st||0===st)&&Ve.push({range:[st,st],color:ze.gauge.threshold.color,line:{color:ze.gauge.threshold.line.color,width:ze.gauge.threshold.line.width},thickness:ze.gauge.threshold.thickness});var ot=nt.selectAll("g.threshold-arc").data(Ve);ot.enter().append("g").classed("threshold-arc",!0).append("path"),ot.select("path").call(Bt).call(T),ot.exit().remove();var wt=nt.selectAll("g.gauge-outline").data([Re]);wt.enter().append("g").classed("gauge-outline",!0).append("path"),wt.select("path").call(Bt).call(T),wt.exit().remove()}(M,0,R,{radius:re,innerRadius:ne,gauge:se,layer:ge,size:j,gaugeBg:K,gaugeOutline:G,transitionOpts:P,onComplete:E});var _e=$.selectAll("g.bullet").data(U?R:[]);_e.exit().remove();var Te=$.selectAll("g.bulletaxis").data(U?R:[]);Te.exit().remove(),U&&function(Oe,fe,ve,Ae){var ke,Pe,Ne,De,ze,Me=ve[0].trace,Se=Ae.gauge,Ie=Ae.layer,Fe=Ae.gaugeBg,Re=Ae.gaugeOutline,Xe=Ae.size,nt=Me.domain,ct=Ae.transitionOpts,xt=Ae.onComplete;Se.enter().append("g").classed("bullet",!0),Se.attr("transform",n(Xe.l,Xe.t)),Ie.enter().append("g").classed("bulletaxis",!0).classed("crisp",!0),Ie.selectAll("g.xbulletaxistick,path,text").remove();var dt=Xe.h,tt=Me.gauge.bar.thickness*dt,Ke=nt.x[0],mt=nt.x[0]+(nt.x[1]-nt.x[0])*(Me._hasNumber||Me._hasDelta?1-d.bulletNumberDomainSize:1);function Bt(We){We.attr("width",function(he){return Math.max(0,ke.c2p(he.range[1])-ke.c2p(he.range[0]))}).attr("x",function(he){return ke.c2p(he.range[0])}).attr("y",function(he){return.5*(1-he.thickness)*dt}).attr("height",function(he){return he.thickness*dt})}(ke=_(Oe,Me.gauge.axis))._id="xbulletaxis",ke.domain=[Ke,mt],ke.setScale(),Pe=i.calcTicks(ke),Ne=i.makeTransTickFn(ke),De=i.getTickSigns(ke)[2],ze=Xe.t+Xe.h,ke.visible&&(i.drawTicks(Oe,ke,{vals:"inside"===ke.ticks?i.clipEnds(ke,Pe):Pe,layer:Ie,path:i.makeTickPath(ke,ze,De),transFn:Ne}),i.drawLabels(Oe,ke,{vals:Pe,layer:Ie,transFn:Ne,labelFns:i.makeLabelFns(ke,ze)}));var Ut=[Fe].concat(Me.gauge.steps),er=Se.selectAll("g.bg-bullet").data(Ut);er.enter().append("g").classed("bg-bullet",!0).append("rect"),er.select("rect").call(Bt).call(T),er.exit().remove();var Wt=Se.selectAll("g.value-bullet").data([Me.gauge.bar]);Wt.enter().append("g").classed("value-bullet",!0).append("rect"),Wt.select("rect").attr("height",tt).attr("y",(dt-tt)/2).call(T),l(ct)?Wt.select("rect").transition().duration(ct.duration).ease(ct.easing).each("end",function(){xt&&xt()}).each("interrupt",function(){xt&&xt()}).attr("width",Math.max(0,ke.c2p(Math.min(Me.gauge.axis.range[1],ve[0].y)))):Wt.select("rect").attr("width","number"==typeof ve[0].y?Math.max(0,ke.c2p(Math.min(Me.gauge.axis.range[1],ve[0].y))):0),Wt.exit().remove();var rr=ve.filter(function(){return Me.gauge.threshold.value||0===Me.gauge.threshold.value}),Ht=Se.selectAll("g.threshold-bullet").data(rr);Ht.enter().append("g").classed("threshold-bullet",!0).append("line"),Ht.select("line").attr("x1",ke.c2p(Me.gauge.threshold.value)).attr("x2",ke.c2p(Me.gauge.threshold.value)).attr("y1",(1-Me.gauge.threshold.thickness)/2*dt).attr("y2",(1-(1-Me.gauge.threshold.thickness)/2)*dt).call(h.stroke,Me.gauge.threshold.line.color).style("stroke-width",Me.gauge.threshold.line.width),Ht.exit().remove();var Ve=Se.selectAll("g.gauge-outline").data([Re]);Ve.enter().append("g").classed("gauge-outline",!0).append("rect"),Ve.select("rect").call(Bt).call(T),Ve.exit().remove()}(M,0,R,{gauge:_e,layer:Te,size:j,gaugeBg:K,gaugeOutline:G,transitionOpts:P,onComplete:E});var we=$.selectAll("text.title").data(R);we.exit().remove(),we.enter().append("text").classed("title",!0),we.attr("text-anchor",function(){return U?p.right:p[Y.title.align]}).text(Y.title.text).call(r.font,Y.title.font).call(s.convertToTspans,M),we.attr("transform",function(){var Oe,fe=j.l+j.w*o[Y.title.align],ve=d.titlePadding,Ae=r.bBox(we.node());return B?(N&&(Oe=Y.gauge.axis.visible?r.bBox(ge.node()).top-ve-Ae.bottom:j.t+j.h/2-re/2-Ae.bottom-ve),U&&(Oe=V-(Ae.top+Ae.bottom)/2,fe=j.l-d.bulletPadding*j.w)):Oe=Y._numbersTop-ve-Ae.bottom,n(fe,Oe)})})}},{"../../components/color":367,"../../components/drawing":389,"../../constants/alignment":483,"../../lib":515,"../../lib/svg_text_utils":541,"../../plots/cartesian/axes":566,"../../plots/cartesian/axis_defaults":568,"../../plots/cartesian/layout_attributes":579,"../../plots/cartesian/position_defaults":582,"./constants":867,"@plotly/d3":58,"d3-interpolate":116}],871:[function(y,ee,Q){"use strict";var g=y("../../components/colorscale/attributes"),v=y("../../plots/cartesian/axis_format_attributes").axisHoverFormat,m=y("../../plots/template_attributes").hovertemplateAttrs,x=y("../mesh3d/attributes"),e=y("../../plots/attributes"),n=y("../../lib/extend").extendFlat,t=y("../../plot_api/edit_types").overrideAll,a=ee.exports=t(n({x:{valType:"data_array"},y:{valType:"data_array"},z:{valType:"data_array"},value:{valType:"data_array"},isomin:{valType:"number"},isomax:{valType:"number"},surface:{show:{valType:"boolean",dflt:!0},count:{valType:"integer",dflt:2,min:1},fill:{valType:"number",min:0,max:1,dflt:1},pattern:{valType:"flaglist",flags:["A","B","C","D","E"],extras:["all","odd","even"],dflt:"all"}},spaceframe:{show:{valType:"boolean",dflt:!1},fill:{valType:"number",min:0,max:1,dflt:.15}},slices:{x:{show:{valType:"boolean",dflt:!1},locations:{valType:"data_array",dflt:[]},fill:{valType:"number",min:0,max:1,dflt:1}},y:{show:{valType:"boolean",dflt:!1},locations:{valType:"data_array",dflt:[]},fill:{valType:"number",min:0,max:1,dflt:1}},z:{show:{valType:"boolean",dflt:!1},locations:{valType:"data_array",dflt:[]},fill:{valType:"number",min:0,max:1,dflt:1}}},caps:{x:{show:{valType:"boolean",dflt:!0},fill:{valType:"number",min:0,max:1,dflt:1}},y:{show:{valType:"boolean",dflt:!0},fill:{valType:"number",min:0,max:1,dflt:1}},z:{show:{valType:"boolean",dflt:!0},fill:{valType:"number",min:0,max:1,dflt:1}}},text:{valType:"string",dflt:"",arrayOk:!0},hovertext:{valType:"string",dflt:"",arrayOk:!0},hovertemplate:m(),xhoverformat:v("x"),yhoverformat:v("y"),zhoverformat:v("z"),valuehoverformat:v("value",1),showlegend:n({},e.showlegend,{dflt:!1})},g("",{colorAttr:"`value`",showScaleDflt:!0,editTypeOverride:"calc"}),{opacity:x.opacity,lightposition:x.lightposition,lighting:x.lighting,flatshading:x.flatshading,contour:x.contour,hoverinfo:n({},e.hoverinfo)}),"calc","nested");a.flatshading.dflt=!0,a.lighting.facenormalsepsilon.dflt=0,a.x.editType=a.y.editType=a.z.editType=a.value.editType="calc+clearAxisTypes",a.transforms=void 0},{"../../components/colorscale/attributes":374,"../../lib/extend":505,"../../plot_api/edit_types":548,"../../plots/attributes":562,"../../plots/cartesian/axis_format_attributes":569,"../../plots/template_attributes":642,"../mesh3d/attributes":876}],872:[function(y,ee,Q){"use strict";var g=y("../../components/colorscale/calc"),v=y("../streamtube/calc").processGrid,m=y("../streamtube/calc").filter;ee.exports=function(x,e){e._len=Math.min(e.x.length,e.y.length,e.z.length,e.value.length),e._x=m(e.x,e._len),e._y=m(e.y,e._len),e._z=m(e.z,e._len),e._value=m(e.value,e._len);var n=v(e);e._gridFill=n.fill,e._Xs=n.Xs,e._Ys=n.Ys,e._Zs=n.Zs,e._len=n.len;for(var t=1/0,a=-1/0,r=0;r<e._len;r++){var d=e._value[r];t=Math.min(t,d),a=Math.max(a,d)}e._minValues=t,e._maxValues=a,e._vMin=e.isomin??t,e._vMax=void 0===e.isomax||null===e.isomin?a:e.isomax,g(x,e,{vals:[e._vMin,e._vMax],containerStr:"",cLetter:"c"})}},{"../../components/colorscale/calc":375,"../streamtube/calc":1054}],873:[function(y,ee,Q){"use strict";var g=y("../../../stackgl_modules").gl_mesh3d,v=y("../../lib/gl_format_color").parseColorScale,m=y("../../lib/str2rgbarray"),x=y("../../components/colorscale").extractOpts,e=y("../../plots/gl3d/zip3"),n=function(s,i){for(var u=i.length-1;u>0;u--){var f=Math.min(i[u],i[u-1]),c=Math.max(i[u],i[u-1]);if(c>f&&f<s&&s<=c)return{id:u,distRatio:(c-s)/(c-f)}}return{id:0,distRatio:0}};function t(s,i,u){this.scene=s,this.uid=u,this.mesh=i,this.name="",this.data=null,this.showContour=!1}var a=t.prototype;a.handlePick=function(s){if(s.object===this.mesh){var i=s.data.index,f=this.data._meshY[i],c=this.data._meshZ[i],h=this.data._Ys.length,p=this.data._Zs.length,o=n(this.data._meshX[i],this.data._Xs).id,b=n(f,this.data._Ys).id,l=n(c,this.data._Zs).id,T=s.index=l+p*b+p*h*o;s.traceCoordinate=[this.data._meshX[T],this.data._meshY[T],this.data._meshZ[T],this.data._value[T]];var _=this.data.hovertext||this.data.text;return Array.isArray(_)&&void 0!==_[T]?s.textLabel=_[T]:_&&(s.textLabel=_),!0}},a.update=function(s){var i=this.scene,u=i.fullSceneLayout;function f(p,o,b,l){return o.map(function(T){return p.d2l(T,0,l)*b})}this.data=d(s);var c={positions:e(f(u.xaxis,s._meshX,i.dataScale[0],s.xcalendar),f(u.yaxis,s._meshY,i.dataScale[1],s.ycalendar),f(u.zaxis,s._meshZ,i.dataScale[2],s.zcalendar)),cells:e(s._meshI,s._meshJ,s._meshK),lightPosition:[s.lightposition.x,s.lightposition.y,s.lightposition.z],ambient:s.lighting.ambient,diffuse:s.lighting.diffuse,specular:s.lighting.specular,roughness:s.lighting.roughness,fresnel:s.lighting.fresnel,vertexNormalsEpsilon:s.lighting.vertexnormalsepsilon,faceNormalsEpsilon:s.lighting.facenormalsepsilon,opacity:s.opacity,contourEnable:s.contour.show,contourColor:m(s.contour.color).slice(0,3),contourWidth:s.contour.width,useFacetNormals:s.flatshading},h=x(s);c.vertexIntensity=s._meshIntensity,c.vertexIntensityBounds=[h.min,h.max],c.colormap=v(s),this.mesh.update(c)},a.dispose=function(){this.scene.glplot.remove(this.mesh),this.mesh.dispose()};var r=["xyz","xzy","yxz","yzx","zxy","zyx"];function d(s){s._meshI=[],s._meshJ=[],s._meshK=[];var i,u,f,c,h,p,o,b=s.surface.show,l=s.spaceframe.show,T=s.surface.fill,_=s.spaceframe.fill,w=!1,k=!1,L=0,M=s._Xs,I=s._Ys,P=s._Zs,S=M.length,E=I.length,z=P.length,R=r.indexOf(s._gridFill.replace(/-/g,"").replace(/\+/g,"")),q=function(Se,Ie,Fe){switch(R){case 5:return Fe+z*Ie+z*E*Se;case 4:return Fe+z*Se+z*S*Ie;case 3:return Ie+E*Fe+E*z*Se;case 2:return Ie+E*Se+E*S*Fe;case 1:return Se+S*Fe+S*z*Ie;default:return Se+S*Ie+S*E*Fe}},V=s._minValues,W=s._maxValues,K=s._vMin,G=s._vMax;function Y(Se,Ie,Fe){for(var Re=p.length,Xe=u;Xe<Re;Xe++)if(Se===f[Xe]&&Ie===c[Xe]&&Fe===h[Xe])return Xe;return-1}function $(){u=i}function B(){f=[],c=[],h=[],p=[],i=0,$()}function N(Se,Ie,Fe,Re){return f.push(Se),c.push(Ie),h.push(Fe),p.push(Re),++i-1}function U(Se,Ie,Fe){for(var Re=[],Xe=0;Xe<Se.length;Xe++)Re[Xe]=Se[Xe]*(1-Fe)+Fe*Ie[Xe];return Re}function te(Se){o=Se}function j(Se,Ie){return"all"===Se||null===Se||Se.indexOf(Ie)>-1}function J(Se,Ie){return null===Se?Ie:Se}function X(Se,Ie,Fe){$();var Xe,nt,Ht,Ve,We,he,ye,Be,Ge,Je,He,st,ot,wt,Ct,ct=[Ie],xt=[Fe];if(o>=1)ct=[Ie],xt=[Fe];else if(o>0){var dt=(Ve=Fe,Je=U(Be=function(rt,ft,Rt){for(var kt=[],Lt=0;Lt<rt.length;Lt++)kt[Lt]=(rt[Lt]+ft[Lt]+Rt[Lt])/3;return kt}(We=(Ht=Ie)[0],he=Ht[1],ye=Ht[2]),We,Ge=Math.sqrt(1-o)),{xyzv:[[We,he,He=U(Be,he,Ge)],[He,Je,We],[he,ye,st=U(Be,ye,Ge)],[st,He,he],[ye,We,Je],[Je,st,ye]],abc:[[ot=Ve[0],wt=Ve[1],-1],[-1,-1,ot],[wt,Ct=Ve[2],-1],[-1,-1,wt],[Ct,ot,-1],[-1,-1,Ct]]});ct=dt.xyzv,xt=dt.abc}for(var tt=0;tt<ct.length;tt++){Ie=ct[tt],Fe=xt[tt];for(var Ke=[],mt=0;mt<3;mt++){var Bt=Ie[mt][0],Ut=Ie[mt][1],er=Ie[mt][2],Wt=Ie[mt][3],rr=Fe[mt]>-1?Fe[mt]:Y(Bt,Ut,er);Ke[mt]=rr>-1?rr:N(Bt,Ut,er,J(Se,Wt))}Xe=Ke[1],nt=Ke[2],s._meshI.push(Ke[0]),s._meshJ.push(Xe),s._meshK.push(nt),++L}}function re(Se,Ie,Fe,Re){var Xe=Se[3];Xe<Fe&&(Xe=Fe),Xe>Re&&(Xe=Re);for(var nt=(Se[3]-Xe)/(Se[3]-Ie[3]+1e-9),ct=[],xt=0;xt<4;xt++)ct[xt]=(1-nt)*Se[xt]+nt*Ie[xt];return ct}function ne(Se,Ie,Fe){return Se>=Ie&&Se<=Fe}function le(Se){var Ie=.001*(G-K);return Se>=K-Ie&&Se<=G+Ie}function oe(Se){for(var Ie=[],Fe=0;Fe<4;Fe++){var Re=Se[Fe];Ie.push([s._x[Re],s._y[Re],s._z[Re],s._value[Re]])}return Ie}function de(Se,Ie,Fe,Re,Xe,nt){nt||(nt=1),Fe=[-1,-1,-1];var ct=!1,xt=[ne(Ie[0][3],Re,Xe),ne(Ie[1][3],Re,Xe),ne(Ie[2][3],Re,Xe)];if(!xt[0]&&!xt[1]&&!xt[2])return!1;var dt=function(Ke,mt,Bt){return le(mt[0][3])&&le(mt[1][3])&&le(mt[2][3])?(X(Ke,mt,Bt),!0):nt<3&&de(Ke,mt,Bt,K,G,++nt)};if(xt[0]&&xt[1]&&xt[2])return dt(Se,Ie,Fe)||ct;var tt=!1;return[[0,1,2],[2,0,1],[1,2,0]].forEach(function(Ke){if(xt[Ke[0]]&&xt[Ke[1]]&&!xt[Ke[2]]){var mt=Ie[Ke[0]],Bt=Ie[Ke[1]],Ut=Ie[Ke[2]],er=re(Ut,mt,Re,Xe),Wt=re(Ut,Bt,Re,Xe);ct=dt(Se,[Wt,er,mt],[-1,-1,Fe[Ke[0]]])||ct,ct=dt(Se,[mt,Bt,Wt],[Fe[Ke[0]],Fe[Ke[1]],-1])||ct,tt=!0}}),tt||[[0,1,2],[1,2,0],[2,0,1]].forEach(function(Ke){if(xt[Ke[0]]&&!xt[Ke[1]]&&!xt[Ke[2]]){var mt=Ie[Ke[0]],Ut=Ie[Ke[2]],er=re(Ie[Ke[1]],mt,Re,Xe),Wt=re(Ut,mt,Re,Xe);ct=dt(Se,[Wt,er,mt],[-1,-1,Fe[Ke[0]]])||ct,tt=!0}}),ct}function se(Se,Ie,Fe,Re){var dt,tt,Ke,mt,Xe=!1,nt=oe(Ie),ct=[ne(nt[0][3],Fe,Re),ne(nt[1][3],Fe,Re),ne(nt[2][3],Fe,Re),ne(nt[3][3],Fe,Re)];if(!(ct[0]||ct[1]||ct[2]||ct[3]))return Xe;if(ct[0]&&ct[1]&&ct[2]&&ct[3])return k&&(dt=Se,tt=nt,Ke=Ie,(mt=function(Bt,Ut,er){X(dt,[tt[Bt],tt[Ut],tt[er]],[Ke[Bt],Ke[Ut],Ke[er]])})(0,1,2),mt(3,0,1),mt(2,3,0),Xe=void mt(1,2,3)||Xe),Xe;var xt=!1;return[[0,1,2,3],[3,0,1,2],[2,3,0,1],[1,2,3,0]].forEach(function(dt){if(ct[dt[0]]&&ct[dt[1]]&&ct[dt[2]]&&!ct[dt[3]]){var tt=nt[dt[0]],Ke=nt[dt[1]],mt=nt[dt[2]],Bt=nt[dt[3]];if(k)Xe=X(Se,[tt,Ke,mt],[Ie[dt[0]],Ie[dt[1]],Ie[dt[2]]])||Xe;else{var Ut=re(Bt,tt,Fe,Re),er=re(Bt,Ke,Fe,Re),Wt=re(Bt,mt,Fe,Re);Xe=X(null,[Ut,er,Wt],[-1,-1,-1])||Xe}xt=!0}}),xt||([[0,1,2,3],[1,2,3,0],[2,3,0,1],[3,0,1,2],[0,2,3,1],[1,3,2,0]].forEach(function(dt){if(ct[dt[0]]&&ct[dt[1]]&&!ct[dt[2]]&&!ct[dt[3]]){var tt=nt[dt[0]],Ke=nt[dt[1]],mt=nt[dt[2]],Bt=nt[dt[3]],Ut=re(mt,tt,Fe,Re),er=re(mt,Ke,Fe,Re),Wt=re(Bt,Ke,Fe,Re),rr=re(Bt,tt,Fe,Re);k?(Xe=X(Se,[tt,rr,Ut],[Ie[dt[0]],-1,-1])||Xe,Xe=X(Se,[Ke,er,Wt],[Ie[dt[1]],-1,-1])||Xe):(null,Ve=[Ut,er,Wt,rr],We=[-1,-1,-1,-1],(he=function(ye,Be,Ge){X(null,[Ve[ye],Ve[Be],Ve[Ge]],[We[ye],We[Be],We[Ge]])})(0,1,2),Xe=void he(2,3,0)||Xe),xt=!0}var Ve,We,he}),xt||[[0,1,2,3],[1,2,3,0],[2,3,0,1],[3,0,1,2]].forEach(function(dt){if(ct[dt[0]]&&!ct[dt[1]]&&!ct[dt[2]]&&!ct[dt[3]]){var tt=nt[dt[0]],mt=nt[dt[2]],Bt=nt[dt[3]],Ut=re(nt[dt[1]],tt,Fe,Re),er=re(mt,tt,Fe,Re),Wt=re(Bt,tt,Fe,Re);k?(Xe=X(Se,[tt,Ut,er],[Ie[dt[0]],-1,-1])||Xe,Xe=X(Se,[tt,er,Wt],[Ie[dt[0]],-1,-1])||Xe,Xe=X(Se,[tt,Wt,Ut],[Ie[dt[0]],-1,-1])||Xe):Xe=X(null,[Ut,er,Wt],[-1,-1,-1])||Xe,xt=!0}})),Xe}function ge(Se,Ie,Fe,Re,Xe,nt,ct,xt,dt,tt,Ke){var mt=!1;return w&&(j(Se,"A")&&(mt=se(null,[Ie,Fe,Re,nt],tt,Ke)||mt),j(Se,"B")&&(mt=se(null,[Fe,Re,Xe,dt],tt,Ke)||mt),j(Se,"C")&&(mt=se(null,[Fe,nt,ct,dt],tt,Ke)||mt),j(Se,"D")&&(mt=se(null,[Re,nt,xt,dt],tt,Ke)||mt),j(Se,"E")&&(mt=se(null,[Fe,Re,nt,dt],tt,Ke)||mt)),k&&(mt=se(Se,[Fe,Re,nt,dt],tt,Ke)||mt),mt}function _e(Se,Ie,Fe,Re,Xe,nt,ct,xt){return[!0===xt[0]||de(Se,oe([Ie,Fe,Re]),[Ie,Fe,Re],nt,ct),!0===xt[1]||de(Se,oe([Re,Xe,Ie]),[Re,Xe,Ie],nt,ct)]}function Te(Se,Ie,Fe,Re,Xe,nt,ct,xt,dt){return xt?_e(Se,Ie,Fe,Xe,Re,nt,ct,dt):_e(Se,Fe,Xe,Re,Ie,nt,ct,dt)}function we(Se,Ie,Fe,Re,Xe,nt,ct){var xt,dt,tt,Ke,mt=!1,Bt=function(){mt=de(Se,[xt,dt,tt],[-1,-1,-1],Xe,nt)||mt,mt=de(Se,[tt,Ke,xt],[-1,-1,-1],Xe,nt)||mt},Ut=ct[0],er=ct[1],Wt=ct[2];return Ut&&(xt=U(oe([q(Ie,Fe-0,Re-0)])[0],oe([q(Ie-1,Fe-0,Re-0)])[0],Ut),dt=U(oe([q(Ie,Fe-0,Re-1)])[0],oe([q(Ie-1,Fe-0,Re-1)])[0],Ut),tt=U(oe([q(Ie,Fe-1,Re-1)])[0],oe([q(Ie-1,Fe-1,Re-1)])[0],Ut),Ke=U(oe([q(Ie,Fe-1,Re-0)])[0],oe([q(Ie-1,Fe-1,Re-0)])[0],Ut),Bt()),er&&(xt=U(oe([q(Ie-0,Fe,Re-0)])[0],oe([q(Ie-0,Fe-1,Re-0)])[0],er),dt=U(oe([q(Ie-0,Fe,Re-1)])[0],oe([q(Ie-0,Fe-1,Re-1)])[0],er),tt=U(oe([q(Ie-1,Fe,Re-1)])[0],oe([q(Ie-1,Fe-1,Re-1)])[0],er),Ke=U(oe([q(Ie-1,Fe,Re-0)])[0],oe([q(Ie-1,Fe-1,Re-0)])[0],er),Bt()),Wt&&(xt=U(oe([q(Ie-0,Fe-0,Re)])[0],oe([q(Ie-0,Fe-0,Re-1)])[0],Wt),dt=U(oe([q(Ie-0,Fe-1,Re)])[0],oe([q(Ie-0,Fe-1,Re-1)])[0],Wt),tt=U(oe([q(Ie-1,Fe-1,Re)])[0],oe([q(Ie-1,Fe-1,Re-1)])[0],Wt),Ke=U(oe([q(Ie-1,Fe-0,Re)])[0],oe([q(Ie-1,Fe-0,Re-1)])[0],Wt),Bt()),mt}function Oe(Se,Ie,Fe,Re,Xe,nt,ct,xt,dt,tt,Ke,mt){var Bt=Se;return mt?(w&&"even"===Se&&(Bt=null),ge(Bt,Ie,Fe,Re,Xe,nt,ct,xt,dt,tt,Ke)):(w&&"odd"===Se&&(Bt=null),ge(Bt,dt,xt,ct,nt,Xe,Re,Fe,Ie,tt,Ke))}function fe(Se,Ie,Fe,Re,Xe){for(var nt=[],ct=0,xt=0;xt<Ie.length;xt++)for(var dt=Ie[xt],tt=1;tt<z;tt++)for(var Ke=1;Ke<E;Ke++)nt.push(Te(Se,q(dt,Ke-1,tt-1),q(dt,Ke-1,tt),q(dt,Ke,tt-1),q(dt,Ke,tt),Fe,Re,(dt+Ke+tt)%2,Xe&&Xe[ct]?Xe[ct]:[])),ct++;return nt}function ve(Se,Ie,Fe,Re,Xe){for(var nt=[],ct=0,xt=0;xt<Ie.length;xt++)for(var dt=Ie[xt],tt=1;tt<S;tt++)for(var Ke=1;Ke<z;Ke++)nt.push(Te(Se,q(tt-1,dt,Ke-1),q(tt,dt,Ke-1),q(tt-1,dt,Ke),q(tt,dt,Ke),Fe,Re,(tt+dt+Ke)%2,Xe&&Xe[ct]?Xe[ct]:[])),ct++;return nt}function Ae(Se,Ie,Fe,Re,Xe){for(var nt=[],ct=0,xt=0;xt<Ie.length;xt++)for(var dt=Ie[xt],tt=1;tt<E;tt++)for(var Ke=1;Ke<S;Ke++)nt.push(Te(Se,q(Ke-1,tt-1,dt),q(Ke-1,tt,dt),q(Ke,tt-1,dt),q(Ke,tt,dt),Fe,Re,(Ke+tt+dt)%2,Xe&&Xe[ct]?Xe[ct]:[])),ct++;return nt}function ke(Se,Ie,Fe){for(var Re=1;Re<z;Re++)for(var Xe=1;Xe<E;Xe++)for(var nt=1;nt<S;nt++)Oe(Se,q(nt-1,Xe-1,Re-1),q(nt-1,Xe-1,Re),q(nt-1,Xe,Re-1),q(nt-1,Xe,Re),q(nt,Xe-1,Re-1),q(nt,Xe-1,Re),q(nt,Xe,Re-1),q(nt,Xe,Re),Ie,Fe,(nt+Xe+Re)%2)}function Pe(Se,Ie,Fe){w=!0,ke(Se,Ie,Fe),w=!1}function Ne(Se,Ie,Fe,Re,Xe,nt){for(var ct=[],dt=0;dt<Ie.length;dt++)for(var tt=Ie[dt],Ke=1;Ke<z;Ke++)for(var mt=1;mt<E;mt++)ct.push(we(Se,tt,mt,Ke,Fe,Re,Xe[dt]));return ct}function De(Se,Ie,Fe,Re,Xe,nt){for(var ct=[],dt=0;dt<Ie.length;dt++)for(var tt=Ie[dt],Ke=1;Ke<S;Ke++)for(var mt=1;mt<z;mt++)ct.push(we(Se,Ke,tt,mt,Fe,Re,Xe[dt]));return ct}function ze(Se,Ie,Fe,Re,Xe,nt){for(var ct=[],dt=0;dt<Ie.length;dt++)for(var tt=Ie[dt],Ke=1;Ke<E;Ke++)for(var mt=1;mt<S;mt++)ct.push(we(Se,mt,Ke,tt,Fe,Re,Xe[dt]));return ct}function Me(Se,Ie){for(var Fe=[],Re=Se;Re<Ie;Re++)Fe.push(Re);return Fe}return function(){if(B(),function(){for(var xt=0;xt<S;xt++)for(var dt=0;dt<E;dt++)for(var tt=0;tt<z;tt++){var Ke=q(xt,dt,tt);N(s._x[Ke],s._y[Ke],s._z[Ke],s._value[Ke])}}(),l&&_&&(te(_),k=!0,ke(null,K,G),k=!1),b&&T){te(T);for(var Se=s.surface.pattern,Ie=s.surface.count,Fe=0;Fe<Ie;Fe++){var Re=1===Ie?.5:Fe/(Ie-1),Xe=(1-Re)*K+Re*G,nt=Math.abs(Xe-V)>Math.abs(Xe-W)?[V,Xe]:[Xe,W];Pe(Se,nt[0],nt[1])}}var ct=[[Math.min(K,W),Math.max(K,W)],[Math.min(V,G),Math.max(V,G)]];["x","y","z"].forEach(function(xt){for(var dt=[],tt=0;tt<ct.length;tt++){var Ke=0,mt=ct[tt][0],Bt=ct[tt][1],Ut=s.slices[xt];if(Ut.show&&Ut.fill){te(Ut.fill);var er=[],Wt=[],rr=[];if(Ut.locations.length)for(var Ht=0;Ht<Ut.locations.length;Ht++){var Ve=n(Ut.locations[Ht],"x"===xt?M:"y"===xt?I:P);0===Ve.distRatio?er.push(Ve.id):Ve.id>0&&(Wt.push(Ve.id),rr.push("x"===xt?[Ve.distRatio,0,0]:"y"===xt?[0,Ve.distRatio,0]:[0,0,Ve.distRatio]))}else er=Me(1,"x"===xt?S-1:"y"===xt?E-1:z-1);Wt.length>0&&(dt[Ke]="x"===xt?Ne(null,Wt,mt,Bt,rr):"y"===xt?De(null,Wt,mt,Bt,rr):ze(null,Wt,mt,Bt,rr),Ke++),er.length>0&&(dt[Ke]="x"===xt?fe(null,er,mt,Bt,dt[Ke]):"y"===xt?ve(null,er,mt,Bt,dt[Ke]):Ae(null,er,mt,Bt,dt[Ke]),Ke++)}var We=s.caps[xt];We.show&&We.fill&&(te(We.fill),dt[Ke]="x"===xt?fe(null,[0,S-1],mt,Bt,dt[Ke]):"y"===xt?ve(null,[0,E-1],mt,Bt,dt[Ke]):Ae(null,[0,z-1],mt,Bt,dt[Ke]),Ke++)}}),0===L&&B(),s._meshX=f,s._meshY=c,s._meshZ=h,s._meshIntensity=p,s._Xs=M,s._Ys=I,s._Zs=P}(),s}ee.exports={findNearestOnAxis:n,generateIsoMeshes:d,createIsosurfaceTrace:function(s,i){var f=g({gl:s.glplot.gl}),c=new t(s,f,i.uid);return f._trace=c,c.update(i),s.glplot.add(f),c}}},{"../../../stackgl_modules":1133,"../../components/colorscale":379,"../../lib/gl_format_color":511,"../../lib/str2rgbarray":540,"../../plots/gl3d/zip3":618}],874:[function(y,ee,Q){"use strict";var g=y("../../lib"),v=y("../../registry"),m=y("./attributes"),x=y("../../components/colorscale/defaults");function e(n,t,a,r,d){var s=d("isomin"),i=d("isomax");null!=i&&null!=s&&s>i&&(t.isomin=null,t.isomax=null);var u=d("x"),f=d("y"),c=d("z"),h=d("value");u&&u.length&&f&&f.length&&c&&c.length&&h&&h.length?(v.getComponentMethod("calendars","handleTraceDefaults")(n,t,["x","y","z"],r),d("valuehoverformat"),["x","y","z"].forEach(function(p){d(p+"hoverformat");var o="caps."+p;d(o+".show")&&d(o+".fill");var b="slices."+p;d(b+".show")&&(d(b+".fill"),d(b+".locations"))}),d("spaceframe.show")&&d("spaceframe.fill"),d("surface.show")&&(d("surface.count"),d("surface.fill"),d("surface.pattern")),d("contour.show")&&(d("contour.color"),d("contour.width")),["text","hovertext","hovertemplate","lighting.ambient","lighting.diffuse","lighting.specular","lighting.roughness","lighting.fresnel","lighting.vertexnormalsepsilon","lighting.facenormalsepsilon","lightposition.x","lightposition.y","lightposition.z","flatshading","opacity"].forEach(function(p){d(p)}),x(n,t,r,d,{prefix:"",cLetter:"c"}),t._length=null):t.visible=!1}ee.exports={supplyDefaults:function(n,t,a,r){e(n,t,0,r,function(d,s){return g.coerce(n,t,m,d,s)})},supplyIsoDefaults:e}},{"../../components/colorscale/defaults":377,"../../lib":515,"../../registry":647,"./attributes":871}],875:[function(y,ee,Q){"use strict";ee.exports={attributes:y("./attributes"),supplyDefaults:y("./defaults").supplyDefaults,calc:y("./calc"),colorbar:{min:"cmin",max:"cmax"},plot:y("./convert").createIsosurfaceTrace,moduleType:"trace",name:"isosurface",basePlotModule:y("../../plots/gl3d"),categories:["gl3d","showLegend"],meta:{}}},{"../../plots/gl3d":607,"./attributes":871,"./calc":872,"./convert":873,"./defaults":874}],876:[function(y,ee,Q){"use strict";var g=y("../../components/colorscale/attributes"),v=y("../../plots/cartesian/axis_format_attributes").axisHoverFormat,m=y("../../plots/template_attributes").hovertemplateAttrs,x=y("../surface/attributes"),e=y("../../plots/attributes"),n=y("../../lib/extend").extendFlat;ee.exports=n({x:{valType:"data_array",editType:"calc+clearAxisTypes"},y:{valType:"data_array",editType:"calc+clearAxisTypes"},z:{valType:"data_array",editType:"calc+clearAxisTypes"},i:{valType:"data_array",editType:"calc"},j:{valType:"data_array",editType:"calc"},k:{valType:"data_array",editType:"calc"},text:{valType:"string",dflt:"",arrayOk:!0,editType:"calc"},hovertext:{valType:"string",dflt:"",arrayOk:!0,editType:"calc"},hovertemplate:m({editType:"calc"}),xhoverformat:v("x"),yhoverformat:v("y"),zhoverformat:v("z"),delaunayaxis:{valType:"enumerated",values:["x","y","z"],dflt:"z",editType:"calc"},alphahull:{valType:"number",dflt:-1,editType:"calc"},intensity:{valType:"data_array",editType:"calc"},intensitymode:{valType:"enumerated",values:["vertex","cell"],dflt:"vertex",editType:"calc"},color:{valType:"color",editType:"calc"},vertexcolor:{valType:"data_array",editType:"calc"},facecolor:{valType:"data_array",editType:"calc"},transforms:void 0},g("",{colorAttr:"`intensity`",showScaleDflt:!0,editTypeOverride:"calc"}),{opacity:x.opacity,flatshading:{valType:"boolean",dflt:!1,editType:"calc"},contour:{show:n({},x.contours.x.show,{}),color:x.contours.x.color,width:x.contours.x.width,editType:"calc"},lightposition:{x:n({},x.lightposition.x,{dflt:1e5}),y:n({},x.lightposition.y,{dflt:1e5}),z:n({},x.lightposition.z,{dflt:0}),editType:"calc"},lighting:n({vertexnormalsepsilon:{valType:"number",min:0,max:1,dflt:1e-12,editType:"calc"},facenormalsepsilon:{valType:"number",min:0,max:1,dflt:1e-6,editType:"calc"},editType:"calc"},x.lighting),hoverinfo:n({},e.hoverinfo,{editType:"calc"}),showlegend:n({},e.showlegend,{dflt:!1})})},{"../../components/colorscale/attributes":374,"../../lib/extend":505,"../../plots/attributes":562,"../../plots/cartesian/axis_format_attributes":569,"../../plots/template_attributes":642,"../surface/attributes":1070}],877:[function(y,ee,Q){"use strict";var g=y("../../components/colorscale/calc");ee.exports=function(v,m){m.intensity&&g(v,m,{vals:m.intensity,containerStr:"",cLetter:"c"})}},{"../../components/colorscale/calc":375}],878:[function(y,ee,Q){"use strict";var g=y("../../../stackgl_modules").gl_mesh3d,v=y("../../../stackgl_modules").delaunay_triangulate,m=y("../../../stackgl_modules").alpha_shape,x=y("../../../stackgl_modules").convex_hull,e=y("../../lib/gl_format_color").parseColorScale,n=y("../../lib/str2rgbarray"),t=y("../../components/colorscale").extractOpts,a=y("../../plots/gl3d/zip3");function r(c,h,p){this.scene=c,this.uid=p,this.mesh=h,this.name="",this.color="#fff",this.data=null,this.showContour=!1}var d=r.prototype;function s(c){for(var h=[],p=c.length,o=0;o<p;o++)h[o]=n(c[o]);return h}function i(c,h,p,o){for(var b=[],l=h.length,T=0;T<l;T++)b[T]=c.d2l(h[T],0,o)*p;return b}function u(c){for(var h=[],p=c.length,o=0;o<p;o++)h[o]=Math.round(c[o]);return h}function f(c,h){for(var p=c.length,o=0;o<p;o++)if(c[o]<=-.5||c[o]>=h-.5)return!1;return!0}d.handlePick=function(c){if(c.object===this.mesh){var h=c.index=c.data.index;c.traceCoordinate=c.data._cellCenter?c.data.dataCoordinate:[this.data.x[h],this.data.y[h],this.data.z[h]];var p=this.data.hovertext||this.data.text;return Array.isArray(p)&&void 0!==p[h]?c.textLabel=p[h]:p&&(c.textLabel=p),!0}},d.update=function(c){var h=this.scene,p=h.fullSceneLayout;this.data=c;var o,b=c.x.length,l=a(i(p.xaxis,c.x,h.dataScale[0],c.xcalendar),i(p.yaxis,c.y,h.dataScale[1],c.ycalendar),i(p.zaxis,c.z,h.dataScale[2],c.zcalendar));if(c.i&&c.j&&c.k){if(c.i.length!==c.j.length||c.j.length!==c.k.length||!f(c.i,b)||!f(c.j,b)||!f(c.k,b))return;o=a(u(c.i),u(c.j),u(c.k))}else o=0===c.alphahull?x(l):c.alphahull>0?m(c.alphahull,l):function(k,L){for(var M=["x","y","z"].indexOf(k),I=[],P=L.length,S=0;S<P;S++)I[S]=[L[S][(M+1)%3],L[S][(M+2)%3]];return v(I)}(c.delaunayaxis,l);var T={positions:l,cells:o,lightPosition:[c.lightposition.x,c.lightposition.y,c.lightposition.z],ambient:c.lighting.ambient,diffuse:c.lighting.diffuse,specular:c.lighting.specular,roughness:c.lighting.roughness,fresnel:c.lighting.fresnel,vertexNormalsEpsilon:c.lighting.vertexnormalsepsilon,faceNormalsEpsilon:c.lighting.facenormalsepsilon,opacity:c.opacity,contourEnable:c.contour.show,contourColor:n(c.contour.color).slice(0,3),contourWidth:c.contour.width,useFacetNormals:c.flatshading};if(c.intensity){var _=t(c);this.color="#fff";var w=c.intensitymode;T[w+"Intensity"]=c.intensity,T[w+"IntensityBounds"]=[_.min,_.max],T.colormap=e(c)}else c.vertexcolor?(this.color=c.vertexcolor[0],T.vertexColors=s(c.vertexcolor)):c.facecolor?(this.color=c.facecolor[0],T.cellColors=s(c.facecolor)):(this.color=c.color,T.meshColor=n(c.color));this.mesh.update(T)},d.dispose=function(){this.scene.glplot.remove(this.mesh),this.mesh.dispose()},ee.exports=function(c,h){var o=g({gl:c.glplot.gl}),b=new r(c,o,h.uid);return o._trace=b,b.update(h),c.glplot.add(o),b}},{"../../../stackgl_modules":1133,"../../components/colorscale":379,"../../lib/gl_format_color":511,"../../lib/str2rgbarray":540,"../../plots/gl3d/zip3":618}],879:[function(y,ee,Q){"use strict";var g=y("../../registry"),v=y("../../lib"),m=y("../../components/colorscale/defaults"),x=y("./attributes");ee.exports=function(e,n,t,a){function r(s,i){return v.coerce(e,n,x,s,i)}function d(s){var i=s.map(function(u){var f=r(u);return f&&v.isArrayOrTypedArray(f)?f:null});return i.every(function(u){return u&&u.length===i[0].length})&&i}d(["x","y","z"])?(d(["i","j","k"]),(!n.i||n.j&&n.k)&&(!n.j||n.k&&n.i)&&(!n.k||n.i&&n.j)?(g.getComponentMethod("calendars","handleTraceDefaults")(e,n,["x","y","z"],a),["lighting.ambient","lighting.diffuse","lighting.specular","lighting.roughness","lighting.fresnel","lighting.vertexnormalsepsilon","lighting.facenormalsepsilon","lightposition.x","lightposition.y","lightposition.z","flatshading","alphahull","delaunayaxis","opacity"].forEach(function(s){r(s)}),r("contour.show")&&(r("contour.color"),r("contour.width")),"intensity"in e?(r("intensity"),r("intensitymode"),m(e,n,a,r,{prefix:"",cLetter:"c"})):(n.showscale=!1,"facecolor"in e?r("facecolor"):"vertexcolor"in e?r("vertexcolor"):r("color",t)),r("text"),r("hovertext"),r("hovertemplate"),r("xhoverformat"),r("yhoverformat"),r("zhoverformat"),n._length=null):n.visible=!1):n.visible=!1}},{"../../components/colorscale/defaults":377,"../../lib":515,"../../registry":647,"./attributes":876}],880:[function(y,ee,Q){"use strict";ee.exports={attributes:y("./attributes"),supplyDefaults:y("./defaults"),calc:y("./calc"),colorbar:{min:"cmin",max:"cmax"},plot:y("./convert"),moduleType:"trace",name:"mesh3d",basePlotModule:y("../../plots/gl3d"),categories:["gl3d","showLegend"],meta:{}}},{"../../plots/gl3d":607,"./attributes":876,"./calc":877,"./convert":878,"./defaults":879}],881:[function(y,ee,Q){"use strict";var g=y("../../lib").extendFlat,v=y("../scatter/attributes"),m=y("../../plots/cartesian/axis_format_attributes").axisHoverFormat,x=y("../../components/drawing/attributes").dash,e=y("../../components/fx/attributes"),n=y("../../constants/delta.js"),t=n.INCREASING.COLOR,a=n.DECREASING.COLOR,r=v.line;function d(s){return{line:{color:g({},r.color,{dflt:s}),width:r.width,dash:x,editType:"style"},editType:"style"}}ee.exports={xperiod:v.xperiod,xperiod0:v.xperiod0,xperiodalignment:v.xperiodalignment,xhoverformat:m("x"),yhoverformat:m("y"),x:{valType:"data_array",editType:"calc+clearAxisTypes"},open:{valType:"data_array",editType:"calc"},high:{valType:"data_array",editType:"calc"},low:{valType:"data_array",editType:"calc"},close:{valType:"data_array",editType:"calc"},line:{width:g({},r.width,{}),dash:g({},x,{}),editType:"style"},increasing:d(t),decreasing:d(a),text:{valType:"string",dflt:"",arrayOk:!0,editType:"calc"},hovertext:{valType:"string",dflt:"",arrayOk:!0,editType:"calc"},tickwidth:{valType:"number",min:0,max:.5,dflt:.3,editType:"calc"},hoverlabel:g({},e.hoverlabel,{split:{valType:"boolean",dflt:!1,editType:"style"}})}},{"../../components/drawing/attributes":388,"../../components/fx/attributes":398,"../../constants/delta.js":485,"../../lib":515,"../../plots/cartesian/axis_format_attributes":569,"../scatter/attributes":936}],882:[function(y,ee,Q){"use strict";var g=y("../../lib"),v=g._,m=y("../../plots/cartesian/axes"),x=y("../../plots/cartesian/align_period"),e=y("../../constants/numerical").BADNUM;function n(a,r,d,s){return{o:a,h:r,l:d,c:s}}function t(a,r,d,s,i,u){for(var f=i.makeCalcdata(r,"open"),c=i.makeCalcdata(r,"high"),h=i.makeCalcdata(r,"low"),p=i.makeCalcdata(r,"close"),o=Array.isArray(r.text),b=Array.isArray(r.hovertext),l=!0,T=null,_=!!r.xperiodalignment,w=[],k=0;k<s.length;k++){var L=s[k],M=f[k],I=c[k],P=h[k],S=p[k];if(L!==e&&M!==e&&I!==e&&P!==e&&S!==e){S===M?null!==T&&S!==T&&(l=S>T):l=S>M,T=S;var E=u(M,I,P,S);E.pos=L,E.yc=(M+S)/2,E.i=k,E.dir=l?"increasing":"decreasing",E.x=E.pos,E.y=[P,I],_&&(E.orig_p=d[k]),o&&(E.tx=r.text[k]),b&&(E.htx=r.hovertext[k]),w.push(E)}else w.push({pos:L,empty:!0})}return r._extremes[i._id]=m.findExtremes(i,g.concat(h,c),{padded:!0}),w.length&&(w[0].t={labels:{open:v(a,"open:")+" ",high:v(a,"high:")+" ",low:v(a,"low:")+" ",close:v(a,"close:")+" "}}),w}ee.exports={calc:function(a,r){var d=m.getFromId(a,r.xaxis),s=m.getFromId(a,r.yaxis),i=function(p,o,b){var l=b._minDiff;if(!l){var T,_=p._fullData,w=[];for(l=1/0,T=0;T<_.length;T++){var k=_[T];if("ohlc"===k.type&&!0===k.visible&&k.xaxis===o._id){w.push(k);var L=o.makeCalcdata(k,"x");k._origX=L;var M=x(b,o,"x",L).vals;k._xcalc=M;var I=g.distinctVals(M).minDiff;I&&isFinite(I)&&(l=Math.min(l,I))}}for(l===1/0&&(l=1),T=0;T<w.length;T++)w[T]._minDiff=l}return l*b.tickwidth}(a,d,r),u=r._minDiff;r._minDiff=null;var f=r._origX;r._origX=null;var c=r._xcalc;r._xcalc=null;var h=t(a,r,f,c,s,n);return r._extremes[d._id]=m.findExtremes(d,c,{vpad:u/2}),h.length?(g.extendFlat(h[0].t,{wHover:u/2,tickLen:i}),h):[{t:{empty:!0}}]},calcCommon:t}},{"../../constants/numerical":491,"../../lib":515,"../../plots/cartesian/align_period":563,"../../plots/cartesian/axes":566}],883:[function(y,ee,Q){"use strict";var g=y("../../lib"),v=y("./ohlc_defaults"),m=y("../scatter/period_defaults"),x=y("./attributes");function e(n,t,a,r){a(r+".line.color"),a(r+".line.width",t.line.width),a(r+".line.dash",t.line.dash)}ee.exports=function(n,t,a,r){function d(s,i){return g.coerce(n,t,x,s,i)}v(n,t,d,r)?(m(n,t,r,d,{x:!0}),d("xhoverformat"),d("yhoverformat"),d("line.width"),d("line.dash"),e(0,t,d,"increasing"),e(0,t,d,"decreasing"),d("text"),d("hovertext"),d("tickwidth"),r._requestRangeslider[t.xaxis]=!0):t.visible=!1}},{"../../lib":515,"../scatter/period_defaults":956,"./attributes":881,"./ohlc_defaults":886}],884:[function(y,ee,Q){"use strict";var g=y("../../plots/cartesian/axes"),v=y("../../lib"),m=y("../../components/fx"),x=y("../../components/color"),e=y("../../lib").fillText,n=y("../../constants/delta.js"),t={increasing:n.INCREASING.SYMBOL,decreasing:n.DECREASING.SYMBOL};function a(s,i,u,f){var c,h,p=s.cd,o=s.xa,b=p[0].trace,l=p[0].t,T=b.type,_="ohlc"===T?"l":"min",w="ohlc"===T?"h":"max",k=l.bPos||0,L=l.bdPos||l.tickLen,M=l.wHover,I=Math.min(1,L/Math.abs(o.r2c(o.range[1])-o.r2c(o.range[0])));function P(W){var K=W.pos+k-i;return m.inbox(K-M,K+M,c)}function S(W){var K=W[_],G=W[w];return K===G||m.inbox(K-u,G-u,c)}function E(W){return(P(W)+S(W))/2}c=s.maxHoverDistance-I,h=s.maxSpikeDistance-I;var z=m.getDistanceFunction(f,P,S,E);if(m.getClosest(p,z,s),!1===s.index)return null;var R=p[s.index];if(R.empty)return null;var q=b[R.dir],V=q.line.color;return s.color=x.opacity(V)&&q.line.width?V:q.fillcolor,s.x0=o.c2p(R.pos+k-L,!0),s.x1=o.c2p(R.pos+k+L,!0),s.xLabelVal=void 0!==R.orig_p?R.orig_p:R.pos,s.spikeDistance=E(R)*h/c,s.xSpike=o.c2p(R.pos,!0),s}function r(s,i,u,f){var c=s.cd,h=s.ya,p=c[0].trace,o=c[0].t,b=[],l=a(s,i,u,f);if(!l)return[];var T=c[l.index].hi||p.hoverinfo,_=T.split("+");if("all"!==T&&-1===_.indexOf("y"))return[];for(var w=["high","open","close","low"],k={},L=0;L<w.length;L++){var M,I=w[L],P=p[I][l.index],S=h.c2p(P,!0);P in k?(M=k[P]).yLabel+="<br>"+o.labels[I]+g.hoverLabelText(h,P,p.yhoverformat):((M=v.extendFlat({},l)).y0=M.y1=S,M.yLabelVal=P,M.yLabel=o.labels[I]+g.hoverLabelText(h,P,p.yhoverformat),M.name="",b.push(M),k[P]=M)}return b}function d(s,i,u,f){var c=s.cd,h=s.ya,p=c[0].trace,o=c[0].t,b=a(s,i,u,f);if(!b)return[];var l=c[b.index],T=b.index=l.i,_=l.dir;function w(E){return o.labels[E]+g.hoverLabelText(h,p[E][T],p.yhoverformat)}var k=l.hi||p.hoverinfo,L=k.split("+"),M="all"===k,I=M||-1!==L.indexOf("y"),P=M||-1!==L.indexOf("text"),S=I?[w("open"),w("high"),w("low"),w("close")+"  "+t[_]]:[];return P&&e(l,p,S),b.extraText=S.join("<br>"),b.y0=b.y1=h.c2p(l.yc,!0),[b]}ee.exports={hoverPoints:function(s,i,u,f){return s.cd[0].trace.hoverlabel.split?r(s,i,u,f):d(s,i,u,f)},hoverSplit:r,hoverOnPoints:d}},{"../../components/color":367,"../../components/fx":407,"../../constants/delta.js":485,"../../lib":515,"../../plots/cartesian/axes":566}],885:[function(y,ee,Q){"use strict";ee.exports={moduleType:"trace",name:"ohlc",basePlotModule:y("../../plots/cartesian"),categories:["cartesian","svg","showLegend"],meta:{},attributes:y("./attributes"),supplyDefaults:y("./defaults"),calc:y("./calc").calc,plot:y("./plot"),style:y("./style"),hoverPoints:y("./hover").hoverPoints,selectPoints:y("./select")}},{"../../plots/cartesian":578,"./attributes":881,"./calc":882,"./defaults":883,"./hover":884,"./plot":887,"./select":888,"./style":889}],886:[function(y,ee,Q){"use strict";var g=y("../../registry"),v=y("../../lib");ee.exports=function(m,x,e,n){var t=e("x"),a=e("open"),r=e("high"),d=e("low"),s=e("close");if(e("hoverlabel.split"),g.getComponentMethod("calendars","handleTraceDefaults")(m,x,["x"],n),a&&r&&d&&s){var i=Math.min(a.length,r.length,d.length,s.length);return t&&(i=Math.min(i,v.minRowLength(t))),x._length=i,i}}},{"../../lib":515,"../../registry":647}],887:[function(y,ee,Q){"use strict";var g=y("@plotly/d3"),v=y("../../lib");ee.exports=function(m,x,e,n){var t=x.yaxis,a=x.xaxis,r=!!a.rangebreaks;v.makeTraceGroups(n,e,"trace ohlc").each(function(d){var s=g.select(this),i=d[0],u=i.t;if(!0!==i.trace.visible||u.empty)s.remove();else{var f=u.tickLen,c=s.selectAll("path").data(v.identity);c.enter().append("path"),c.exit().remove(),c.attr("d",function(h){if(h.empty)return"M0,0Z";var p=a.c2p(h.pos-f,!0),o=a.c2p(h.pos+f,!0),b=r?(p+o)/2:a.c2p(h.pos,!0);return"M"+p+","+t.c2p(h.o,!0)+"H"+b+"M"+b+","+t.c2p(h.h,!0)+"V"+t.c2p(h.l,!0)+"M"+o+","+t.c2p(h.c,!0)+"H"+b})}})}},{"../../lib":515,"@plotly/d3":58}],888:[function(y,ee,Q){"use strict";ee.exports=function(g,v){var m,x=g.cd,e=g.xaxis,n=g.yaxis,t=[],a=x[0].t.bPos||0;if(!1===v)for(m=0;m<x.length;m++)x[m].selected=0;else for(m=0;m<x.length;m++){var r=x[m];v.contains([e.c2p(r.pos+a),n.c2p(r.yc)],null,r.i,g)?(t.push({pointNumber:r.i,x:e.c2d(r.pos),y:n.c2d(r.yc)}),r.selected=1):r.selected=0}return t}},{}],889:[function(y,ee,Q){"use strict";var g=y("@plotly/d3"),v=y("../../components/drawing"),m=y("../../components/color");ee.exports=function(x,e,n){var t=n||g.select(x).selectAll("g.ohlclayer").selectAll("g.trace");t.style("opacity",function(a){return a[0].trace.opacity}),t.each(function(a){var r=a[0].trace;g.select(this).selectAll("path").each(function(d){if(!d.empty){var s=r[d.dir].line;g.select(this).style("fill","none").call(m.stroke,s.color).call(v.dashLine,s.dash,s.width).style("opacity",r.selectedpoints&&!d.selected?.3:1)}})})}},{"../../components/color":367,"../../components/drawing":389,"@plotly/d3":58}],890:[function(y,ee,Q){"use strict";var g=y("../../lib/extend").extendFlat,v=y("../../plots/attributes"),m=y("../../plots/font_attributes"),x=y("../../components/colorscale/attributes"),e=y("../../plots/template_attributes").hovertemplateAttrs,n=y("../../plots/domain").attributes,t=g({editType:"calc"},x("line",{editTypeOverride:"calc"}),{shape:{valType:"enumerated",values:["linear","hspline"],dflt:"linear",editType:"plot"},hovertemplate:e({editType:"plot",arrayOk:!1},{keys:["count","probability"]})});ee.exports={domain:n({name:"parcats",trace:!0,editType:"calc"}),hoverinfo:g({},v.hoverinfo,{flags:["count","probability"],editType:"plot",arrayOk:!1}),hoveron:{valType:"enumerated",values:["category","color","dimension"],dflt:"category",editType:"plot"},hovertemplate:e({editType:"plot",arrayOk:!1},{keys:["count","probability","category","categorycount","colorcount","bandcolorcount"]}),arrangement:{valType:"enumerated",values:["perpendicular","freeform","fixed"],dflt:"perpendicular",editType:"plot"},bundlecolors:{valType:"boolean",dflt:!0,editType:"plot"},sortpaths:{valType:"enumerated",values:["forward","backward"],dflt:"forward",editType:"plot"},labelfont:m({editType:"calc"}),tickfont:m({editType:"calc"}),dimensions:{_isLinkedToArray:"dimension",label:{valType:"string",editType:"calc"},categoryorder:{valType:"enumerated",values:["trace","category ascending","category descending","array"],dflt:"trace",editType:"calc"},categoryarray:{valType:"data_array",editType:"calc"},ticktext:{valType:"data_array",editType:"calc"},values:{valType:"data_array",dflt:[],editType:"calc"},displayindex:{valType:"integer",editType:"calc"},editType:"calc",visible:{valType:"boolean",dflt:!0,editType:"calc"}},line:t,counts:{valType:"number",min:0,dflt:1,arrayOk:!0,editType:"calc"},customdata:void 0,hoverlabel:void 0,ids:void 0,legendgroup:void 0,legendrank:void 0,opacity:void 0,selectedpoints:void 0,showlegend:void 0}},{"../../components/colorscale/attributes":374,"../../lib/extend":505,"../../plots/attributes":562,"../../plots/domain":593,"../../plots/font_attributes":594,"../../plots/template_attributes":642}],891:[function(y,ee,Q){"use strict";var g=y("../../plots/get_data").getModuleCalcData,v=y("./plot");Q.name="parcats",Q.plot=function(m,x,e,n){var t=g(m.calcdata,"parcats");t.length&&v(m,t[0],e,n)},Q.clean=function(m,x,e,n){var t=n._has&&n._has("parcats"),a=x._has&&x._has("parcats");t&&!a&&n._paperdiv.selectAll(".parcats").remove()}},{"../../plots/get_data":602,"./plot":896}],892:[function(y,ee,Q){"use strict";var g=y("../../lib/gup").wrap,v=y("../../components/colorscale/helpers").hasColorscale,m=y("../../components/colorscale/calc"),x=y("../../lib/filter_unique.js"),e=y("../../components/drawing"),n=y("../../lib"),t=y("fast-isnumeric");function a(s,i,u){s.valueInds.push(i),s.count+=u}function r(s,i,u){return{categoryInds:s,color:i,rawColor:u,valueInds:[],count:0}}function d(s,i,u){s.valueInds.push(i),s.count+=u}ee.exports=function(s,i){var u=n.filterVisible(i.dimensions);if(0===u.length)return[];var f,c,h,p=u.map(function(Y){var $;if("trace"===Y.categoryorder)$=null;else if("array"===Y.categoryorder)$=Y.categoryarray;else{$=x(Y.values);for(var B=!0,N=0;N<$.length;N++)if(!t($[N])){B=!1;break}$.sort(B?n.sorterAsc:void 0),"category descending"===Y.categoryorder&&($=$.reverse())}return function(U,te){te=null==te?[]:te.map(function(de){return de});var j={},J={},X=[];te.forEach(function(de,se){j[de]=0,J[de]=se});for(var re=0;re<U.length;re++){var ne,le=U[re];void 0===j[le]?(j[le]=1,ne=te.push(le)-1,J[le]=ne):(j[le]++,ne=J[le]),X.push(ne)}var oe=te.map(function(de){return j[de]});return{uniqueValues:te,uniqueCounts:oe,inds:X}}(Y.values,$)});f=n.isArrayOrTypedArray(i.counts)?i.counts:[i.counts],function(Y){var $;if(function(B){for(var N=new Array(B.length),U=0;U<B.length;U++){if(B[U]<0||B[U]>=B.length||void 0!==N[B[U]])return!1;N[B[U]]=!0}return!0}(Y.map(function(B){return B.displayindex})))for($=0;$<Y.length;$++)Y[$]._displayindex=Y[$].displayindex;else for($=0;$<Y.length;$++)Y[$]._displayindex=$}(u),u.forEach(function(Y,$){!function(B,N){B._categoryarray=N.uniqueValues,B._ticktext=null==B.ticktext?[]:B.ticktext.slice();for(var U=B._ticktext.length;U<N.uniqueValues.length;U++)B._ticktext.push(N.uniqueValues[U])}(Y,p[$])});var o,b=i.line;b?(v(i,"line")&&m(s,i,{vals:i.line.color,containerStr:"line",cLetter:"c"}),o=e.tryColorscale(b)):o=n.identity;var l,T,_,w,k,L=u[0].values.length,M={},I=p.map(function(Y){return Y.inds});for(h=0,l=0;l<L;l++){var P=[];for(T=0;T<I.length;T++)P.push(I[T][l]);h+=c=f[l%f.length];var S=(_=l,w=void 0,k=void 0,n.isArrayOrTypedArray(b.color)?k=w=b.color[_%b.color.length]:w=b.color,{color:o(w),rawColor:k}),E=P+"-"+S.rawColor;void 0===M[E]&&(M[E]=r(P,S.color,S.rawColor)),d(M[E],l,c)}var z,Y,$,B,N,R=u.map(function(Y,$){return{dimensionInd:$,containerInd:Y._index,displayInd:Y._displayindex,dimensionLabel:Y.label,count:h,categories:[],dragX:null}});for(l=0;l<L;l++)for(c=f[l%f.length],T=0;T<R.length;T++){var q=R[T].containerInd,V=p[T].inds[l],W=R[T].categories;void 0===W[V]&&(W[V]={dimensionInd:T,categoryInd:z=V,categoryValue:i.dimensions[q]._categoryarray[V],displayInd:z,categoryLabel:i.dimensions[q]._ticktext[V],valueInds:[],count:0,dragY:null}),a(W[V],l,c)}return g(($=M,B=h,N=(Y=R).map(function(U){return U.categories.length}).reduce(function(U,te){return Math.max(U,te)}),{dimensions:Y,paths:$,trace:void 0,maxCats:N,count:B}))}},{"../../components/colorscale/calc":375,"../../components/colorscale/helpers":378,"../../components/drawing":389,"../../lib":515,"../../lib/filter_unique.js":506,"../../lib/gup":512,"fast-isnumeric":190}],893:[function(y,ee,Q){"use strict";var g=y("../../lib"),v=y("../../components/colorscale/helpers").hasColorscale,m=y("../../components/colorscale/defaults"),x=y("../../plots/domain").defaults,e=y("../../plots/array_container_defaults"),n=y("./attributes"),t=y("../parcoords/merge_length");function a(r,d){function s(o,b){return g.coerce(r,d,n.dimensions,o,b)}var i=s("values"),u=s("visible");if(i&&i.length||(u=d.visible=!1),u){s("label"),s("displayindex",d._index);var f,c=r.categoryarray,h=Array.isArray(c)&&c.length>0;h&&(f="array");var p=s("categoryorder",f);"array"===p?(s("categoryarray"),s("ticktext")):(delete r.categoryarray,delete r.ticktext),h||"array"!==p||(d.categoryorder="trace")}}ee.exports=function(r,d,s,i){function u(o,b){return g.coerce(r,d,n,o,b)}var f=e(r,d,{name:"dimensions",handleItemDefaults:a}),c=function(o,b,l,T,_){_("line.shape"),_("line.hovertemplate");var w=_("line.color",T.colorway[0]);if(v(o,"line")&&g.isArrayOrTypedArray(w)){if(w.length)return _("line.colorscale"),m(o,b,T,_,{prefix:"line.",cLetter:"c"}),w.length;b.line.color=l}return 1/0}(r,d,s,i,u);x(d,i,u),Array.isArray(f)&&f.length||(d.visible=!1),t(d,f,"values",c),u("hoveron"),u("hovertemplate"),u("arrangement"),u("bundlecolors"),u("sortpaths"),u("counts");var h={family:i.font.family,size:Math.round(i.font.size),color:i.font.color};g.coerceFont(u,"labelfont",h);var p={family:i.font.family,size:Math.round(i.font.size/1.2),color:i.font.color};g.coerceFont(u,"tickfont",p)}},{"../../components/colorscale/defaults":377,"../../components/colorscale/helpers":378,"../../lib":515,"../../plots/array_container_defaults":561,"../../plots/domain":593,"../parcoords/merge_length":907,"./attributes":890}],894:[function(y,ee,Q){"use strict";ee.exports={attributes:y("./attributes"),supplyDefaults:y("./defaults"),calc:y("./calc"),plot:y("./plot"),colorbar:{container:"line",min:"cmin",max:"cmax"},moduleType:"trace",name:"parcats",basePlotModule:y("./base_plot"),categories:["noOpacity"],meta:{}}},{"./attributes":890,"./base_plot":891,"./calc":892,"./defaults":893,"./plot":896}],895:[function(y,ee,Q){"use strict";var g=y("@plotly/d3"),v=y("d3-interpolate").interpolateNumber,m=y("../../plot_api/plot_api"),x=y("../../components/fx"),e=y("../../lib"),n=e.strTranslate,t=y("../../components/drawing"),a=y("tinycolor2"),r=y("../../lib/svg_text_utils");function d(B,N,U,te){var j=B.map(W.bind(0,N,U)),J=te.selectAll("g.parcatslayer").data([null]);J.enter().append("g").attr("class","parcatslayer").style("pointer-events","all");var X=J.selectAll("g.trace.parcats").data(j,s),re=X.enter().append("g").attr("class","trace parcats");X.attr("transform",function(we){return n(we.x,we.y)}),re.append("g").attr("class","paths");var ne=X.select("g.paths").selectAll("path.path").data(function(we){return we.paths},s);ne.attr("fill",function(we){return we.model.color});var le=ne.enter().append("path").attr("class","path").attr("stroke-opacity",0).attr("fill",function(we){return we.model.color}).attr("fill-opacity",0);b(le),ne.attr("d",function(we){return we.svgD}),le.empty()||ne.sort(u),ne.exit().remove(),ne.on("mouseover",f).on("mouseout",c).on("click",o),re.append("g").attr("class","dimensions");var oe=X.select("g.dimensions").selectAll("g.dimension").data(function(we){return we.dimensions},s);oe.enter().append("g").attr("class","dimension"),oe.attr("transform",function(we){return n(we.x,0)}),oe.exit().remove();var de=oe.selectAll("g.category").data(function(we){return we.categories},s),se=de.enter().append("g").attr("class","category");de.attr("transform",function(we){return n(0,we.y)}),se.append("rect").attr("class","catrect").attr("pointer-events","none"),de.select("rect.catrect").attr("fill","none").attr("width",function(we){return we.width}).attr("height",function(we){return we.height}),T(se);var ge=de.selectAll("rect.bandrect").data(function(we){return we.bands},s);ge.each(function(){e.raiseToTop(this)}),ge.attr("fill",function(we){return we.color});var _e=ge.enter().append("rect").attr("class","bandrect").attr("stroke-opacity",0).attr("fill",function(we){return we.color}).attr("fill-opacity",0);ge.attr("fill",function(we){return we.color}).attr("width",function(we){return we.width}).attr("height",function(we){return we.height}).attr("y",function(we){return we.y}).attr("cursor",function(we){return"fixed"===we.parcatsViewModel.arrangement?"default":"perpendicular"===we.parcatsViewModel.arrangement?"ns-resize":"move"}),_(_e),ge.exit().remove(),se.append("text").attr("class","catlabel").attr("pointer-events","none");var Te=N._fullLayout.paper_bgcolor;de.select("text.catlabel").attr("text-anchor",function(we){return i(we)?"start":"end"}).attr("alignment-baseline","middle").style("text-shadow",r.makeTextShadow(Te)).style("fill","rgb(0, 0, 0)").attr("x",function(we){return i(we)?we.width+5:-5}).attr("y",function(we){return we.height/2}).text(function(we){return we.model.categoryLabel}).each(function(we){t.font(g.select(this),we.parcatsViewModel.categorylabelfont),r.convertToTspans(g.select(this),N)}),se.append("text").attr("class","dimlabel"),de.select("text.dimlabel").attr("text-anchor","middle").attr("alignment-baseline","baseline").attr("cursor",function(we){return"fixed"===we.parcatsViewModel.arrangement?"default":"ew-resize"}).attr("x",function(we){return we.width/2}).attr("y",-5).text(function(we,Oe){return 0===Oe?we.parcatsViewModel.model.dimensions[we.model.dimensionInd].dimensionLabel:null}).each(function(we){t.font(g.select(this),we.parcatsViewModel.labelfont)}),de.selectAll("rect.bandrect").on("mouseover",I).on("mouseout",P),de.exit().remove(),oe.call(g.behavior.drag().origin(function(we){return{x:we.x,y:0}}).on("dragstart",S).on("drag",E).on("dragend",z)),X.each(function(we){we.traceSelection=g.select(this),we.pathSelection=g.select(this).selectAll("g.paths").selectAll("path.path"),we.dimensionSelection=g.select(this).selectAll("g.dimensions").selectAll("g.dimension")}),X.exit().remove()}function s(B){return B.key}function i(B){return B.model.dimensionInd===B.parcatsViewModel.dimensions[B.parcatsViewModel.dimensions.length-1].model.dimensionInd}function u(B,N){return B.model.rawColor>N.model.rawColor?1:B.model.rawColor<N.model.rawColor?-1:0}function f(B){if(!B.parcatsViewModel.dragDimension&&-1===B.parcatsViewModel.hoverinfoItems.indexOf("skip")){e.raiseToTop(this),l(g.select(this));var N=h(B),U=p(B);if(B.parcatsViewModel.graphDiv.emit("plotly_hover",{points:N,event:g.event,constraints:U}),-1===B.parcatsViewModel.hoverinfoItems.indexOf("none")){var te,j,J,X=g.mouse(this)[0],re=B.parcatsViewModel.graphDiv,ne=B.parcatsViewModel.trace,le=re._fullLayout,oe=le._paperdiv.node().getBoundingClientRect(),de=B.parcatsViewModel.graphDiv.getBoundingClientRect();for(J=0;J<B.leftXs.length-1;J++)if(B.leftXs[J]+B.dimWidths[J]-2<=X&&X<=B.leftXs[J+1]+2){var se=B.parcatsViewModel.dimensions[J];te=(se.x+se.width+B.parcatsViewModel.dimensions[J+1].x)/2,j=(B.topYs[J]+B.topYs[J+1]+B.height)/2;break}var _e=B.parcatsViewModel.x+te,Te=B.parcatsViewModel.y+j,we=a.mostReadable(B.model.color,["black","white"]),Oe=B.model.count,fe=Oe/B.parcatsViewModel.model.count,ve={countLabel:Oe,probabilityLabel:fe.toFixed(3)},Ae=[];-1!==B.parcatsViewModel.hoverinfoItems.indexOf("count")&&Ae.push(["Count:",ve.countLabel].join(" ")),-1!==B.parcatsViewModel.hoverinfoItems.indexOf("probability")&&Ae.push(["P:",ve.probabilityLabel].join(" "));var ke=Ae.join("<br>"),Pe=g.mouse(re)[0];x.loneHover({trace:ne,x:_e-oe.left+de.left,y:Te-oe.top+de.top,text:ke,color:B.model.color,borderColor:"black",fontFamily:'Monaco, "Courier New", monospace',fontSize:10,fontColor:we,idealAlign:Pe<_e?"right":"left",hovertemplate:(ne.line||{}).hovertemplate,hovertemplateLabels:ve,eventData:[{data:ne._input,fullData:ne,count:Oe,probability:fe}]},{container:le._hoverlayer.node(),outerContainer:le._paper.node(),gd:re})}}}function c(B){if(!B.parcatsViewModel.dragDimension&&(b(g.select(this)),x.loneUnhover(B.parcatsViewModel.graphDiv._fullLayout._hoverlayer.node()),B.parcatsViewModel.pathSelection.sort(u),-1===B.parcatsViewModel.hoverinfoItems.indexOf("skip"))){var N=h(B),U=p(B);B.parcatsViewModel.graphDiv.emit("plotly_unhover",{points:N,event:g.event,constraints:U})}}function h(B){for(var N=[],U=R(B.parcatsViewModel),te=0;te<B.model.valueInds.length;te++)N.push({curveNumber:U,pointNumber:B.model.valueInds[te]});return N}function p(B){for(var N={},U=B.parcatsViewModel.model.dimensions,te=0;te<U.length;te++){var j=U[te];N[j.containerInd]=j.categories[B.model.categoryInds[te]].categoryValue}return void 0!==B.model.rawColor&&(N.color=B.model.rawColor),N}function o(B){if(-1===B.parcatsViewModel.hoverinfoItems.indexOf("skip")){var N=h(B),U=p(B);B.parcatsViewModel.graphDiv.emit("plotly_click",{points:N,event:g.event,constraints:U})}}function b(B){B.attr("fill",function(N){return N.model.color}).attr("fill-opacity",.6).attr("stroke","lightgray").attr("stroke-width",.2).attr("stroke-opacity",1)}function l(B){B.attr("fill-opacity",.8).attr("stroke",function(N){return a.mostReadable(N.model.color,["black","white"])}).attr("stroke-width",.3)}function T(B){B.select("rect.catrect").attr("stroke","black").attr("stroke-width",1).attr("stroke-opacity",1)}function _(B){B.attr("stroke","black").attr("stroke-width",.2).attr("stroke-opacity",1).attr("fill-opacity",1)}function w(B){var U=B.categoryViewModel.model.dimensionInd,te=B.categoryViewModel.model.categoryInd;return B.parcatsViewModel.pathSelection.filter(function(j){return j.model.categoryInds[U]===te&&j.model.color===B.color})}function k(B,N,U){var te=g.select(B).datum(),j=te.categoryViewModel.model,J=te.parcatsViewModel.graphDiv,X=g.select(B.parentNode).selectAll("rect.bandrect"),re=[];X.each(function(le){w(le).each(function(oe){Array.prototype.push.apply(re,h(oe))})});var ne={};ne[j.dimensionInd]=j.categoryValue,J.emit(N,{points:re,event:U,constraints:ne})}function L(B,N,U){var te=g.select(B).datum(),j=te.categoryViewModel.model,J=te.parcatsViewModel.graphDiv,X=w(te),re=[];X.each(function(le){Array.prototype.push.apply(re,h(le))});var ne={};ne[j.dimensionInd]=j.categoryValue,void 0!==te.rawColor&&(ne.color=te.rawColor),J.emit(N,{points:re,event:U,constraints:ne})}function M(B,N,U){B._fullLayout._calcInverseTransform(B);var te,j,J=B._fullLayout._invScaleX,X=B._fullLayout._invScaleY,re=g.select(U.parentNode).select("rect.catrect"),ne=re.node().getBoundingClientRect(),le=re.datum(),oe=le.parcatsViewModel,se=oe.trace,ge=ne.top+ne.height/2;oe.dimensions.length>1&&oe.model.dimensions[le.model.dimensionInd].displayInd===oe.dimensions.length-1?(te=ne.left,j="left"):(te=ne.left+ne.width,j="right");var _e=le.model.count,Te=le.model.categoryLabel,we=_e/le.parcatsViewModel.model.count,Oe={countLabel:_e,categoryLabel:Te,probabilityLabel:we.toFixed(3)},fe=[];-1!==le.parcatsViewModel.hoverinfoItems.indexOf("count")&&fe.push(["Count:",Oe.countLabel].join(" ")),-1!==le.parcatsViewModel.hoverinfoItems.indexOf("probability")&&fe.push(["P("+Oe.categoryLabel+"):",Oe.probabilityLabel].join(" "));var ve=fe.join("<br>");return{trace:se,x:J*(te-N.left),y:X*(ge-N.top),text:ve,color:"lightgray",borderColor:"black",fontFamily:'Monaco, "Courier New", monospace',fontSize:12,fontColor:"black",idealAlign:j,hovertemplate:se.hovertemplate,hovertemplateLabels:Oe,eventData:[{data:se._input,fullData:se,count:_e,category:Te,probability:we}]}}function I(B){if(!B.parcatsViewModel.dragDimension&&-1===B.parcatsViewModel.hoverinfoItems.indexOf("skip")){if(g.mouse(this)[1]<-1)return;var N,U=B.parcatsViewModel.graphDiv,te=U._fullLayout,j=te._paperdiv.node().getBoundingClientRect(),J=B.parcatsViewModel.hoveron;"color"===J?(l(ne=w(re=g.select(this).datum())),ne.each(function(){e.raiseToTop(this)}),g.select(this.parentNode).selectAll("rect.bandrect").filter(function(le){return le.color===re.color}).each(function(){e.raiseToTop(this),g.select(this).attr("stroke","black").attr("stroke-width",1.5)}),L(this,"plotly_hover",g.event)):(function(X){g.select(X.parentNode).selectAll("rect.bandrect").each(function(re){var ne=w(re);l(ne),ne.each(function(){e.raiseToTop(this)})}),g.select(X.parentNode).select("rect.catrect").attr("stroke","black").attr("stroke-width",2.5)}(this),k(this,"plotly_hover",g.event)),-1===B.parcatsViewModel.hoverinfoItems.indexOf("none")&&("category"===J?N=M(U,j,this):"color"===J?N=function(X,re,ne){X._fullLayout._calcInverseTransform(X);var le,oe,de=X._fullLayout._invScaleX,se=X._fullLayout._invScaleY,ge=ne.getBoundingClientRect(),_e=g.select(ne).datum(),Te=_e.categoryViewModel,we=Te.parcatsViewModel,fe=we.trace,ve=ge.y+ge.height/2;we.dimensions.length>1&&we.model.dimensions[Te.model.dimensionInd].displayInd===we.dimensions.length-1?(le=ge.left,oe="left"):(le=ge.left+ge.width,oe="right");var Ae=Te.model.categoryLabel,ke=_e.parcatsViewModel.model.count,Pe=0;_e.categoryViewModel.bands.forEach(function(nt){nt.color===_e.color&&(Pe+=nt.count)});var Ne=Te.model.count,De=0;we.pathSelection.each(function(nt){nt.model.color===_e.color&&(De+=nt.model.count)});var ze=Pe/ke,Me=Pe/De,Se=Pe/Ne,Ie={countLabel:ke,categoryLabel:Ae,probabilityLabel:ze.toFixed(3)},Fe=[];-1!==Te.parcatsViewModel.hoverinfoItems.indexOf("count")&&Fe.push(["Count:",Ie.countLabel].join(" ")),-1!==Te.parcatsViewModel.hoverinfoItems.indexOf("probability")&&(Fe.push("P(color \u2229 "+Ae+"): "+Ie.probabilityLabel),Fe.push("P("+Ae+" | color): "+Me.toFixed(3)),Fe.push("P(color | "+Ae+"): "+Se.toFixed(3)));var Re=Fe.join("<br>"),Xe=a.mostReadable(_e.color,["black","white"]);return{trace:fe,x:de*(le-re.left),y:se*(ve-re.top),text:Re,color:_e.color,borderColor:"black",fontFamily:'Monaco, "Courier New", monospace',fontColor:Xe,fontSize:10,idealAlign:oe,hovertemplate:fe.hovertemplate,hovertemplateLabels:Ie,eventData:[{data:fe._input,fullData:fe,category:Ae,count:ke,probability:ze,categorycount:Ne,colorcount:De,bandcolorcount:Pe}]}}(U,j,this):"dimension"===J&&(N=function(X,re,ne){var le=[];return g.select(ne.parentNode.parentNode).selectAll("g.category").select("rect.catrect").each(function(){le.push(M(X,re,this))}),le}(U,j,this)),N&&x.loneHover(N,{container:te._hoverlayer.node(),outerContainer:te._paper.node(),gd:U}))}var re,ne}function P(B){var N=B.parcatsViewModel;!N.dragDimension&&(b(N.pathSelection),T(N.dimensionSelection.selectAll("g.category")),_(N.dimensionSelection.selectAll("g.category").selectAll("rect.bandrect")),x.loneUnhover(N.graphDiv._fullLayout._hoverlayer.node()),N.pathSelection.sort(u),-1===N.hoverinfoItems.indexOf("skip"))&&("color"===B.parcatsViewModel.hoveron?L(this,"plotly_unhover",g.event):k(this,"plotly_unhover",g.event))}function S(B){"fixed"!==B.parcatsViewModel.arrangement&&(B.dragDimensionDisplayInd=B.model.displayInd,B.initialDragDimensionDisplayInds=B.parcatsViewModel.model.dimensions.map(function(N){return N.displayInd}),B.dragHasMoved=!1,B.dragCategoryDisplayInd=null,g.select(this).selectAll("g.category").select("rect.catrect").each(function(N){var U=g.mouse(this)[0],te=g.mouse(this)[1];-2<=U&&U<=N.width+2&&-2<=te&&te<=N.height+2&&(B.dragCategoryDisplayInd=N.model.displayInd,B.initialDragCategoryDisplayInds=B.model.categories.map(function(j){return j.displayInd}),N.model.dragY=N.y,e.raiseToTop(this.parentNode),g.select(this.parentNode).selectAll("rect.bandrect").each(function(j){j.y<te&&te<=j.y+j.height&&(B.potentialClickBand=this)}))}),B.parcatsViewModel.dragDimension=B,x.loneUnhover(B.parcatsViewModel.graphDiv._fullLayout._hoverlayer.node()))}function E(B){if("fixed"!==B.parcatsViewModel.arrangement&&(B.dragHasMoved=!0,null!==B.dragDimensionDisplayInd)){var N=B.dragDimensionDisplayInd,U=N-1,te=N+1,j=B.parcatsViewModel.dimensions[N];if(null!==B.dragCategoryDisplayInd){var J=j.categories[B.dragCategoryDisplayInd];J.model.dragY+=g.event.dy;var X=J.model.dragY,re=J.model.displayInd,ne=j.categories,le=ne[re-1],oe=ne[re+1];void 0!==le&&X<le.y+le.height/2&&(J.model.displayInd=le.model.displayInd,le.model.displayInd=re),void 0!==oe&&X+J.height>oe.y+oe.height/2&&(J.model.displayInd=oe.model.displayInd,oe.model.displayInd=re),B.dragCategoryDisplayInd=J.model.displayInd}if(null===B.dragCategoryDisplayInd||"freeform"===B.parcatsViewModel.arrangement){j.model.dragX=g.event.x;var de=B.parcatsViewModel.dimensions[U],se=B.parcatsViewModel.dimensions[te];void 0!==de&&j.model.dragX<de.x+de.width&&(j.model.displayInd=de.model.displayInd,de.model.displayInd=N),void 0!==se&&j.model.dragX+j.width>se.x&&(j.model.displayInd=se.model.displayInd,se.model.displayInd=B.dragDimensionDisplayInd),B.dragDimensionDisplayInd=j.model.displayInd}Y(B.parcatsViewModel),G(B.parcatsViewModel),V(B.parcatsViewModel),q(B.parcatsViewModel)}}function z(B){if("fixed"!==B.parcatsViewModel.arrangement&&null!==B.dragDimensionDisplayInd){g.select(this).selectAll("text").attr("font-weight","normal");var N={},U=R(B.parcatsViewModel),te=B.parcatsViewModel.model.dimensions.map(function(oe){return oe.displayInd}),j=B.initialDragDimensionDisplayInds.some(function(oe,de){return oe!==te[de]});j&&te.forEach(function(oe,de){N["dimensions["+B.parcatsViewModel.model.dimensions[de].containerInd+"].displayindex"]=oe});var J=!1;if(null!==B.dragCategoryDisplayInd){var X=B.model.categories.map(function(oe){return oe.displayInd});if(J=B.initialDragCategoryDisplayInds.some(function(oe,de){return oe!==X[de]})){var re=B.model.categories.slice().sort(function(oe,de){return oe.displayInd-de.displayInd}),ne=re.map(function(oe){return oe.categoryValue}),le=re.map(function(oe){return oe.categoryLabel});N["dimensions["+B.model.containerInd+"].categoryarray"]=[ne],N["dimensions["+B.model.containerInd+"].ticktext"]=[le],N["dimensions["+B.model.containerInd+"].categoryorder"]="array"}}-1===B.parcatsViewModel.hoverinfoItems.indexOf("skip")&&!B.dragHasMoved&&B.potentialClickBand&&("color"===B.parcatsViewModel.hoveron?L(B.potentialClickBand,"plotly_click",g.event.sourceEvent):k(B.potentialClickBand,"plotly_click",g.event.sourceEvent)),B.model.dragX=null,null!==B.dragCategoryDisplayInd&&(B.parcatsViewModel.dimensions[B.dragDimensionDisplayInd].categories[B.dragCategoryDisplayInd].model.dragY=null,B.dragCategoryDisplayInd=null),B.dragDimensionDisplayInd=null,B.parcatsViewModel.dragDimension=null,B.dragHasMoved=null,B.potentialClickBand=null,Y(B.parcatsViewModel),G(B.parcatsViewModel),g.transition().duration(300).ease("cubic-in-out").each(function(){V(B.parcatsViewModel,!0),q(B.parcatsViewModel,!0)}).each("end",function(){(j||J)&&m.restyle(B.parcatsViewModel.graphDiv,N,[U])})}}function R(B){for(var N,U=B.graphDiv._fullData,te=0;te<U.length;te++)if(B.key===U[te].uid){N=te;break}return N}function q(B,N){var U;void 0===N&&(N=!1),B.pathSelection.data(function(te){return te.paths},s),(U=B.pathSelection,N?U.transition():U).attr("d",function(te){return te.svgD})}function V(B,N){function U(X){return N?X.transition():X}void 0===N&&(N=!1),B.dimensionSelection.data(function(X){return X.dimensions},s);var te=B.dimensionSelection.selectAll("g.category").data(function(X){return X.categories},s);U(B.dimensionSelection).attr("transform",function(X){return n(X.x,0)}),U(te).attr("transform",function(X){return n(0,X.y)}),te.select(".dimlabel").text(function(X,re){return 0===re?X.parcatsViewModel.model.dimensions[X.model.dimensionInd].dimensionLabel:null}),te.select(".catlabel").attr("text-anchor",function(X){return i(X)?"start":"end"}).attr("x",function(X){return i(X)?X.width+5:-5}).each(function(X){var re,ne;i(X)?(re=X.width+5,ne="start"):(re=-5,ne="end"),g.select(this).selectAll("tspan").attr("x",re).attr("text-anchor",ne)});var j=te.selectAll("rect.bandrect").data(function(X){return X.bands},s),J=j.enter().append("rect").attr("class","bandrect").attr("cursor","move").attr("stroke-opacity",0).attr("fill",function(X){return X.color}).attr("fill-opacity",0);j.attr("fill",function(X){return X.color}).attr("width",function(X){return X.width}).attr("height",function(X){return X.height}).attr("y",function(X){return X.y}),_(J),j.each(function(){e.raiseToTop(this)}),j.exit().remove()}function W(B,N,U){var te,j=U[0],J=N.margin||{l:80,r:80,t:100,b:80},X=j.trace,re=X.domain,ne=N.width,le=N.height,oe=Math.floor(ne*(re.x[1]-re.x[0])),de=Math.floor(le*(re.y[1]-re.y[0])),se=re.x[0]*ne+J.l,ge=N.height-re.y[1]*N.height+J.t,_e=X.line.shape;te="all"===X.hoverinfo?["count","probability"]:(X.hoverinfo||"").split("+");var Te={trace:X,key:X.uid,model:j,x:se,y:ge,width:oe,height:de,hoveron:X.hoveron,hoverinfoItems:te,arrangement:X.arrangement,bundlecolors:X.bundlecolors,sortpaths:X.sortpaths,labelfont:X.labelfont,categorylabelfont:X.tickfont,pathShape:_e,dragDimension:null,margin:J,paths:[],dimensions:[],graphDiv:B,traceSelection:null,pathSelection:null,dimensionSelection:null};return j.dimensions&&(Y(Te),G(Te)),Te}function K(B,N,U,te,j){var J,X,re=[],ne=[];for(X=0;X<U.length-1;X++)J=v(U[X]+B[X],B[X+1]),re.push(J(j)),ne.push(J(1-j));var le="M "+B[0]+","+N[0];for(le+="l"+U[0]+",0 ",X=1;X<U.length;X++)le+="C"+re[X-1]+","+N[X-1]+" "+ne[X-1]+","+N[X]+" "+B[X]+","+N[X],le+="l"+U[X]+",0 ";for(le+="l0,"+te+" ",le+="l -"+U[U.length-1]+",0 ",X=U.length-2;X>=0;X--)le+="C"+ne[X]+","+(N[X+1]+te)+" "+re[X]+","+(N[X]+te)+" "+(B[X]+U[X])+","+(N[X]+te),le+="l-"+U[X]+",0 ";return le+"Z"}function G(B){var N=B.dimensions,U=B.model,te=N.map(function(Fe){return Fe.categories.map(function(Re){return Re.y})}),j=B.model.dimensions.map(function(Fe){return Fe.categories.map(function(Re){return Re.displayInd})}),J=B.model.dimensions.map(function(Fe){return Fe.displayInd}),X=B.dimensions.map(function(Fe){return Fe.model.dimensionInd}),re=N.map(function(Fe){return Fe.x}),ne=N.map(function(Fe){return Fe.width}),le=[];for(var oe in U.paths)U.paths.hasOwnProperty(oe)&&le.push(U.paths[oe]);function de(Fe){var Re=Fe.categoryInds.map(function(Xe,nt){return j[nt][Xe]});return X.map(function(Xe){return Re[Xe]})}le.sort(function(Fe,Re){var Xe=de(Fe),nt=de(Re);return"backward"===B.sortpaths&&(Xe.reverse(),nt.reverse()),Xe.push(Fe.valueInds[0]),nt.push(Re.valueInds[0]),B.bundlecolors&&(Xe.unshift(Fe.rawColor),nt.unshift(Re.rawColor)),Xe<nt?-1:Xe>nt?1:0});for(var se=new Array(le.length),ge=N[0].model.count,_e=N[0].categories.map(function(Fe){return Fe.height}).reduce(function(Fe,Re){return Fe+Re}),Te=0;Te<le.length;Te++){var we,Oe=le[Te];we=ge>0?_e*(Oe.count/ge):0;for(var fe,ve=new Array(te.length),Ae=0;Ae<Oe.categoryInds.length;Ae++){var Pe=j[Ae][Oe.categoryInds[Ae]],Ne=J[Ae];ve[Ne]=te[Ne][Pe],te[Ne][Pe]+=we;var De=B.dimensions[Ne].categories[Pe],ze=De.bands.length,Me=De.bands[ze-1];if(void 0===Me||Oe.rawColor!==Me.rawColor){var Se=void 0===Me?0:Me.y+Me.height;De.bands.push({key:Se,color:Oe.color,rawColor:Oe.rawColor,height:we,width:De.width,count:Oe.count,y:Se,categoryViewModel:De,parcatsViewModel:B})}else{var Ie=De.bands[ze-1];Ie.height+=we,Ie.count+=Oe.count}}fe=K(re,ve,ne,we,"hspline"===B.pathShape?.5:0),se[Te]={key:Oe.valueInds[0],model:Oe,height:we,leftXs:re,topYs:ve,dimWidths:ne,svgD:fe,parcatsViewModel:B}}B.paths=se}function Y(B){var N=B.model.dimensions.map(function(X){return{displayInd:X.displayInd,dimensionInd:X.dimensionInd}});N.sort(function(X,re){return X.displayInd-re.displayInd});var U=[];for(var te in N)U.push($(B,B.model.dimensions[N[te].dimensionInd]));B.dimensions=U}function $(B,N){var U,te=B.model.dimensions.length;U=40+(te>1?(B.width-80-16)/(te-1):0)*N.displayInd;var J,X,re,le,oe=[],de=B.model.maxCats,se=N.categories.length,ge=N.count,_e=B.height-8*(de-1),Te=8*(de-se)/2,we=N.categories.map(function(Oe){return{displayInd:Oe.displayInd,categoryInd:Oe.categoryInd}});for(we.sort(function(Oe,fe){return Oe.displayInd-fe.displayInd}),le=0;le<se;le++)re={key:(X=N.categories[we[le].categoryInd]).valueInds[0],model:X,width:16,height:J=ge>0?X.count/ge*_e:0,y:null!==X.dragY?X.dragY:Te,bands:[],parcatsViewModel:B},Te=Te+J+8,oe.push(re);return{key:N.dimensionInd,x:null!==N.dragX?N.dragX:U,y:0,width:16,model:N,categories:oe,parcatsViewModel:B,dragCategoryDisplayInd:null,dragDimensionDisplayInd:null,initialDragDimensionDisplayInds:null,initialDragCategoryDisplayInds:null,dragHasMoved:null,potentialClickBand:null}}ee.exports=function(B,N,U,te){d(U,B,te,N)}},{"../../components/drawing":389,"../../components/fx":407,"../../lib":515,"../../lib/svg_text_utils":541,"../../plot_api/plot_api":552,"@plotly/d3":58,"d3-interpolate":116,tinycolor2:313}],896:[function(y,ee,Q){"use strict";var g=y("./parcats");ee.exports=function(v,m,x,e){var n=v._fullLayout,a=n._size;g(v,n._paper,m,{width:a.w,height:a.h,margin:{t:a.t,r:a.r,b:a.b,l:a.l}},x,e)}},{"./parcats":895}],897:[function(y,ee,Q){"use strict";var g=y("../../components/colorscale/attributes"),v=y("../../plots/cartesian/layout_attributes"),m=y("../../plots/font_attributes"),x=y("../../plots/domain").attributes,e=y("../../lib/extend").extendFlat,n=y("../../plot_api/plot_template").templatedArray;ee.exports={domain:x({name:"parcoords",trace:!0,editType:"plot"}),labelangle:{valType:"angle",dflt:0,editType:"plot"},labelside:{valType:"enumerated",values:["top","bottom"],dflt:"top",editType:"plot"},labelfont:m({editType:"plot"}),tickfont:m({editType:"plot"}),rangefont:m({editType:"plot"}),dimensions:n("dimension",{label:{valType:"string",editType:"plot"},tickvals:e({},v.tickvals,{editType:"plot"}),ticktext:e({},v.ticktext,{editType:"plot"}),tickformat:e({},v.tickformat,{editType:"plot"}),visible:{valType:"boolean",dflt:!0,editType:"plot"},range:{valType:"info_array",items:[{valType:"number",editType:"plot"},{valType:"number",editType:"plot"}],editType:"plot"},constraintrange:{valType:"info_array",freeLength:!0,dimensions:"1-2",items:[{valType:"any",editType:"plot"},{valType:"any",editType:"plot"}],editType:"plot"},multiselect:{valType:"boolean",dflt:!0,editType:"plot"},values:{valType:"data_array",editType:"calc"},editType:"calc"}),line:e({editType:"calc"},g("line",{colorscaleDflt:"Viridis",autoColorDflt:!1,editTypeOverride:"calc"})),unselected:{line:{color:{valType:"color",dflt:"#7f7f7f",editType:"plot"},opacity:{valType:"number",min:0,max:1,dflt:"auto",editType:"plot"},editType:"plot"},editType:"plot"}}},{"../../components/colorscale/attributes":374,"../../lib/extend":505,"../../plot_api/plot_template":555,"../../plots/cartesian/layout_attributes":579,"../../plots/domain":593,"../../plots/font_attributes":594}],898:[function(y,ee,Q){"use strict";var g=y("./constants"),v=y("@plotly/d3"),m=y("../../lib/gup").keyFun,x=y("../../lib/gup").repeat,e=y("../../lib").sorterAsc,n=y("../../lib").strTranslate,t=g.bar.snapRatio;function a(M,I){return M*(1-t)+I*t}var r=g.bar.snapClose;function d(M,I){return M*(1-r)+I*r}function s(M,I,P,S){if(function($,B){for(var N=0;N<B.length;N++)if($>=B[N][0]&&$<=B[N][1])return!0;return!1}(P,S))return P;var E=M?-1:1,z=0,R=I.length-1;if(E<0){var q=z;z=R,R=q}for(var V=I[z],W=V,K=z;E*K<E*R;K+=E){var G=K+E,Y=I[G];if(E*P<E*d(V,Y))return a(V,W);if(E*P<E*Y||G===R)return a(Y,V);W=V,V=Y}}function i(M){M.attr("x",-g.bar.captureWidth/2).attr("width",g.bar.captureWidth)}function u(M){M.attr("visibility","visible").style("visibility","visible").attr("fill","yellow").attr("opacity",0)}function f(M){if(!M.brush.filterSpecified)return"0,"+M.height;for(var I,P,S,E=c(M.brush.filter.getConsolidated(),M.height),z=[0],R=E.length?E[0][0]:null,q=0;q<E.length;q++)P=(I=E[q])[1]-I[0],z.push(R),z.push(P),(S=q+1)<E.length&&(R=E[S][0]-I[1]);return z.push(M.height),z}function c(M,I){return M.map(function(P){return P.map(function(S){return Math.max(0,S*I)}).sort(e)})}function h(){v.select(document.body).style("cursor",null)}function p(M){M.attr("stroke-dasharray",f)}function o(M,I){var P=v.select(M).selectAll(".highlight, .highlight-shadow");p(I?P.transition().duration(g.bar.snapDuration).each("end",I):P)}function b(M,I){var P,S=M.brush,E=NaN,z={};if(S.filterSpecified){var R=M.height,q=S.filter.getConsolidated(),V=c(q,R),W=NaN,K=NaN,G=NaN;for(P=0;P<=V.length;P++){var Y=V[P];if(Y&&Y[0]<=I&&I<=Y[1]){W=P;break}if(K=P?P-1:NaN,Y&&Y[0]>I){G=P;break}}if(E=W,isNaN(E)&&(E=isNaN(K)||isNaN(G)?isNaN(K)?G:K:I-V[K][1]<V[G][0]-I?K:G),!isNaN(E)){var $=V[E],B=function(j,J){var X=g.bar.handleHeight;if(!(J>j[1]+X||J<j[0]-X))return J>=.9*j[1]+.1*j[0]?"n":J<=.9*j[0]+.1*j[1]?"s":"ns"}($,I);B&&(z.interval=q[E],z.intervalPix=$,z.region=B)}}if(M.ordinal&&!z.region){var N=M.unitTickvals,U=M.unitToPaddedPx.invert(I);for(P=0;P<N.length;P++){var te=[.25*N[Math.max(P-1,0)]+.75*N[P],.25*N[Math.min(P+1,N.length-1)]+.75*N[P]];if(U>=te[0]&&U<=te[1]){z.clickableOrdinalRange=te;break}}}return z}function l(M,I){v.event.sourceEvent.stopPropagation();var P=I.height-v.mouse(M)[1]-2*g.verticalPadding,S=I.brush.svgBrush;S.wasDragged=!0,S._dragging=!0,S.newExtent=S.grabbingBar?[P-S.grabPoint,P+S.barLength-S.grabPoint].map(I.unitToPaddedPx.invert):[S.startExtent,I.unitToPaddedPx.invert(P)].sort(e),I.brush.filterSpecified=!0,S.extent=S.stayingIntervals.concat([S.newExtent]),S.brushCallback(I),o(M.parentNode)}function T(M,I){var P=b(I,I.height-v.mouse(M)[1]-2*g.verticalPadding),S="crosshair";P.clickableOrdinalRange?S="pointer":P.region&&(S=P.region+"-resize"),v.select(document.body).style("cursor",S)}function _(M){M.on("mousemove",function(I){v.event.preventDefault(),I.parent.inBrushDrag||T(this,I)}).on("mouseleave",function(I){I.parent.inBrushDrag||h()}).call(v.behavior.drag().on("dragstart",function(I){!function(P,S){v.event.sourceEvent.stopPropagation();var E=S.height-v.mouse(P)[1]-2*g.verticalPadding,z=S.unitToPaddedPx.invert(E),R=S.brush,q=b(S,E),V=q.interval,W=R.svgBrush;if(W.wasDragged=!1,W.grabbingBar="ns"===q.region,W.grabbingBar){var K=V.map(S.unitToPaddedPx);W.grabPoint=E-K[0]-g.verticalPadding,W.barLength=K[1]-K[0]}W.clickableOrdinalRange=q.clickableOrdinalRange,W.stayingIntervals=S.multiselect&&R.filterSpecified?R.filter.getConsolidated():[],V&&(W.stayingIntervals=W.stayingIntervals.filter(function(G){return G[0]!==V[0]&&G[1]!==V[1]})),W.startExtent=q.region?V["s"===q.region?1:0]:z,S.parent.inBrushDrag=!0,W.brushStartCallback()}(this,I)}).on("drag",function(I){l(this,I)}).on("dragend",function(I){!function(P,S){var E=S.brush,z=E.filter,R=E.svgBrush;R._dragging||(T(P,S),l(P,S),S.brush.svgBrush.wasDragged=!1),R._dragging=!1,v.event.sourceEvent.stopPropagation();var q=R.grabbingBar;if(R.grabbingBar=!1,R.grabLocation=void 0,S.parent.inBrushDrag=!1,h(),!R.wasDragged)return R.wasDragged=void 0,R.clickableOrdinalRange?E.filterSpecified&&S.multiselect?R.extent.push(R.clickableOrdinalRange):(R.extent=[R.clickableOrdinalRange],E.filterSpecified=!0):q?(R.extent=R.stayingIntervals,0===R.extent.length&&k(E)):k(E),R.brushCallback(S),o(P.parentNode),void R.brushEndCallback(E.filterSpecified?z.getConsolidated():[]);var V=function(){z.set(z.getConsolidated())};if(S.ordinal){var W=S.unitTickvals;W[W.length-1]<W[0]&&W.reverse(),R.newExtent=[s(0,W,R.newExtent[0],R.stayingIntervals),s(1,W,R.newExtent[1],R.stayingIntervals)];var K=R.newExtent[1]>R.newExtent[0];R.extent=R.stayingIntervals.concat(K?[R.newExtent]:[]),R.extent.length||k(E),R.brushCallback(S),K?o(P.parentNode,V):(V(),o(P.parentNode))}else V();R.brushEndCallback(E.filterSpecified?z.getConsolidated():[])}(this,I)}))}function w(M,I){return M[0]-I[0]}function k(M){M.filterSpecified=!1,M.svgBrush.extent=[[-1/0,1/0]]}function L(M){for(var I,P=M.slice(),S=[],E=P.shift();E;){for(I=E.slice();(E=P.shift())&&E[0]<=I[1];)I[1]=Math.max(I[1],E[1]);S.push(I)}return 1===S.length&&S[0][0]>S[0][1]&&(S=[]),S}ee.exports={makeBrush:function(M,I,P,S,E,z){var R,V,W,K,q=(K=[],{set:function(G){1===(K=G.map(function(Y){return Y.slice().sort(e)}).sort(w)).length&&K[0][0]===-1/0&&K[0][1]===1/0&&(K=[[0,-1]]),V=L(K),W=K.reduce(function(Y,$){return[Math.min(Y[0],$[0]),Math.max(Y[1],$[1])]},[1/0,-1/0])},get:function(){return K.slice()},getConsolidated:function(){return V},getBounds:function(){return W}});return q.set(P),{filter:q,filterSpecified:I,svgBrush:{extent:[],brushStartCallback:S,brushCallback:(R=E,function(V){var G,W=V.brush,K=(G=W,G.svgBrush.extent.map(function(Y){return Y.slice()})).slice();W.filter.set(K),R()}),brushEndCallback:z}}},ensureAxisBrush:function(M,I){var P=M.selectAll("."+g.cn.axisBrush).data(x,m);P.enter().append("g").classed(g.cn.axisBrush,!0),function(S,E){var z=S.selectAll(".background").data(x);z.enter().append("rect").classed("background",!0).call(i).call(u).style("pointer-events","auto").attr("transform",n(0,g.verticalPadding)),z.call(_).attr("height",function(V){return V.height-g.verticalPadding});var R=S.selectAll(".highlight-shadow").data(x);R.enter().append("line").classed("highlight-shadow",!0).attr("x",-g.bar.width/2).attr("stroke-width",g.bar.width+g.bar.strokeWidth).attr("stroke",E).attr("opacity",g.bar.strokeOpacity).attr("stroke-linecap","butt"),R.attr("y1",function(V){return V.height}).call(p);var q=S.selectAll(".highlight").data(x);q.enter().append("line").classed("highlight",!0).attr("x",-g.bar.width/2).attr("stroke-width",g.bar.width-g.bar.strokeWidth).attr("stroke",g.bar.fillColor).attr("opacity",g.bar.fillOpacity).attr("stroke-linecap","butt"),q.attr("y1",function(V){return V.height}).call(p)}(P,I)},cleanRanges:function(M,I){if(Array.isArray(M[0])?(M=M.map(function(S){return S.sort(e)}),M=I.multiselect?L(M.sort(w)):[M[0]]):M=[M.sort(e)],I.tickvals){var P=I.tickvals.slice().sort(e);if(!(M=M.map(function(S){var E=[s(0,P,S[0],[]),s(1,P,S[1],[])];if(E[1]>E[0])return E}).filter(function(S){return S})).length)return}return M.length>1?M:M[0]}}},{"../../lib":515,"../../lib/gup":512,"./constants":902,"@plotly/d3":58}],899:[function(y,ee,Q){"use strict";ee.exports={attributes:y("./attributes"),supplyDefaults:y("./defaults"),calc:y("./calc"),colorbar:{container:"line",min:"cmin",max:"cmax"},moduleType:"trace",name:"parcoords",basePlotModule:y("./base_plot"),categories:["gl","regl","noOpacity","noHover"],meta:{}}},{"./attributes":897,"./base_plot":900,"./calc":901,"./defaults":903}],900:[function(y,ee,Q){"use strict";var g=y("@plotly/d3"),v=y("../../plots/get_data").getModuleCalcData,m=y("./plot"),x=y("../../constants/xmlns_namespaces");Q.name="parcoords",Q.plot=function(e){var n=v(e.calcdata,"parcoords")[0];n.length&&m(e,n)},Q.clean=function(e,n,t,a){var r=a._has&&a._has("parcoords"),d=n._has&&n._has("parcoords");r&&!d&&(a._paperdiv.selectAll(".parcoords").remove(),a._glimages.selectAll("*").remove())},Q.toSVG=function(e){var n=e._fullLayout._glimages,t=g.select(e).selectAll(".svg-container");t.filter(function(a,r){return r===t.size()-1}).selectAll(".gl-canvas-context, .gl-canvas-focus").each(function(){var a=this.toDataURL("image/png");n.append("svg:image").attr({xmlns:x.svg,"xlink:href":a,preserveAspectRatio:"none",x:0,y:0,width:this.style.width,height:this.style.height})}),window.setTimeout(function(){g.selectAll("#filterBarPattern").attr("id","filterBarPattern")},60)}},{"../../constants/xmlns_namespaces":492,"../../plots/get_data":602,"./plot":909,"@plotly/d3":58}],901:[function(y,ee,Q){"use strict";var g=y("../../lib").isArrayOrTypedArray,v=y("../../components/colorscale"),m=y("../../lib/gup").wrap;ee.exports=function(x,e){var n,t;return v.hasColorscale(e,"line")&&g(e.line.color)?(n=e.line.color,t=v.extractOpts(e.line).colorscale,v.calc(x,e,{vals:n,containerStr:"line",cLetter:"c"})):(n=function(a){for(var r=new Array(a),d=0;d<a;d++)r[d]=.5;return r}(e._length),t=[[0,e.line.color],[1,e.line.color]]),m({lineColor:n,cscale:t})}},{"../../components/colorscale":379,"../../lib":515,"../../lib/gup":512}],902:[function(y,ee,Q){"use strict";ee.exports={maxDimensionCount:60,overdrag:45,verticalPadding:2,tickDistance:50,canvasPixelRatio:1,blockLineCount:5e3,layers:["contextLineLayer","focusLineLayer","pickLineLayer"],axisTitleOffset:28,axisExtentOffset:10,bar:{width:4,captureWidth:10,fillColor:"magenta",fillOpacity:1,snapDuration:150,snapRatio:.25,snapClose:.01,strokeOpacity:1,strokeWidth:1,handleHeight:8,handleOpacity:1,handleOverlap:0},cn:{axisExtentText:"axis-extent-text",parcoordsLineLayers:"parcoords-line-layers",parcoordsLineLayer:"parcoords-lines",parcoords:"parcoords",parcoordsControlView:"parcoords-control-view",yAxis:"y-axis",axisOverlays:"axis-overlays",axis:"axis",axisHeading:"axis-heading",axisTitle:"axis-title",axisExtent:"axis-extent",axisExtentTop:"axis-extent-top",axisExtentTopText:"axis-extent-top-text",axisExtentBottom:"axis-extent-bottom",axisExtentBottomText:"axis-extent-bottom-text",axisBrush:"axis-brush"},id:{filterBarPattern:"filter-bar-pattern"}}},{}],903:[function(y,ee,Q){"use strict";var g=y("../../lib"),v=y("../../components/colorscale/helpers").hasColorscale,m=y("../../components/colorscale/defaults"),x=y("../../plots/domain").defaults,e=y("../../plots/array_container_defaults"),n=y("../../plots/cartesian/axes"),t=y("./attributes"),a=y("./axisbrush"),r=y("./constants").maxDimensionCount,d=y("./merge_length");function s(i,u,f,c){function h(T,_){return g.coerce(i,u,t.dimensions,T,_)}var p=h("values"),o=h("visible");if(p&&p.length||(o=u.visible=!1),o){h("label"),h("tickvals"),h("ticktext"),h("tickformat");var b=h("range");u._ax={_id:"y",type:"linear",showexponent:"all",exponentformat:"B",range:b},n.setConvert(u._ax,c.layout),h("multiselect");var l=h("constraintrange");l&&(u.constraintrange=a.cleanRanges(l,u))}}ee.exports=function(i,u,f,c){function h(T,_){return g.coerce(i,u,t,T,_)}var p=i.dimensions;Array.isArray(p)&&p.length>r&&(g.log("parcoords traces support up to "+r+" dimensions at the moment"),p.splice(r));var o=e(i,u,{name:"dimensions",layout:c,handleItemDefaults:s}),b=function(T,_,w,k,L){var M=L("line.color",w);if(v(T,"line")&&g.isArrayOrTypedArray(M)){if(M.length)return L("line.colorscale"),m(T,_,k,L,{prefix:"line.",cLetter:"c"}),M.length;_.line.color=w}return 1/0}(i,u,f,c,h);x(u,c,h),Array.isArray(o)&&o.length||(u.visible=!1),d(u,o,"values",b);var l={family:c.font.family,size:Math.round(c.font.size/1.2),color:c.font.color};g.coerceFont(h,"labelfont",l),g.coerceFont(h,"tickfont",l),g.coerceFont(h,"rangefont",l),h("labelangle"),h("labelside"),h("unselected.line.color"),h("unselected.line.opacity")}},{"../../components/colorscale/defaults":377,"../../components/colorscale/helpers":378,"../../lib":515,"../../plots/array_container_defaults":561,"../../plots/cartesian/axes":566,"../../plots/domain":593,"./attributes":897,"./axisbrush":898,"./constants":902,"./merge_length":907}],904:[function(y,ee,Q){"use strict";var g=y("../../lib").isTypedArray;Q.convertTypedArray=function(v){return g(v)?Array.prototype.slice.call(v):v},Q.isOrdinal=function(v){return!!v.tickvals},Q.isVisible=function(v){return v.visible||!("visible"in v)}},{"../../lib":515}],905:[function(y,ee,Q){"use strict";var g=y("./base_index");g.plot=y("./plot"),ee.exports=g},{"./base_index":899,"./plot":909}],906:[function(y,ee,Q){"use strict";var g=y("glslify"),v=g(["precision highp float;\n#define GLSLIFY 1\n\nvarying vec4 fragColor;\n\nattribute vec4 p01_04, p05_08, p09_12, p13_16,\n               p17_20, p21_24, p25_28, p29_32,\n               p33_36, p37_40, p41_44, p45_48,\n               p49_52, p53_56, p57_60, colors;\n\nuniform mat4 dim0A, dim1A, dim0B, dim1B, dim0C, dim1C, dim0D, dim1D,\n             loA, hiA, loB, hiB, loC, hiC, loD, hiD;\n\nuniform vec2 resolution, viewBoxPos, viewBoxSize;\nuniform float maskHeight;\nuniform float drwLayer; // 0: context, 1: focus, 2: pick\nuniform vec4 contextColor;\nuniform sampler2D maskTexture, palette;\n\nbool isPick    = (drwLayer > 1.5);\nbool isContext = (drwLayer < 0.5);\n\nconst vec4 ZEROS = vec4(0.0, 0.0, 0.0, 0.0);\nconst vec4 UNITS = vec4(1.0, 1.0, 1.0, 1.0);\n\nfloat val(mat4 p, mat4 v) {\n    return dot(matrixCompMult(p, v) * UNITS, UNITS);\n}\n\nfloat axisY(float ratio, mat4 A, mat4 B, mat4 C, mat4 D) {\n    float y1 = val(A, dim0A) + val(B, dim0B) + val(C, dim0C) + val(D, dim0D);\n    float y2 = val(A, dim1A) + val(B, dim1B) + val(C, dim1C) + val(D, dim1D);\n    return y1 * (1.0 - ratio) + y2 * ratio;\n}\n\nint iMod(int a, int b) {\n    return a - b * (a / b);\n}\n\nbool fOutside(float p, float lo, float hi) {\n    return (lo < hi) && (lo > p || p > hi);\n}\n\nbool vOutside(vec4 p, vec4 lo, vec4 hi) {\n    return (\n        fOutside(p[0], lo[0], hi[0]) ||\n        fOutside(p[1], lo[1], hi[1]) ||\n        fOutside(p[2], lo[2], hi[2]) ||\n        fOutside(p[3], lo[3], hi[3])\n    );\n}\n\nbool mOutside(mat4 p, mat4 lo, mat4 hi) {\n    return (\n        vOutside(p[0], lo[0], hi[0]) ||\n        vOutside(p[1], lo[1], hi[1]) ||\n        vOutside(p[2], lo[2], hi[2]) ||\n        vOutside(p[3], lo[3], hi[3])\n    );\n}\n\nbool outsideBoundingBox(mat4 A, mat4 B, mat4 C, mat4 D) {\n    return mOutside(A, loA, hiA) ||\n           mOutside(B, loB, hiB) ||\n           mOutside(C, loC, hiC) ||\n           mOutside(D, loD, hiD);\n}\n\nbool outsideRasterMask(mat4 A, mat4 B, mat4 C, mat4 D) {\n    mat4 pnts[4];\n    pnts[0] = A;\n    pnts[1] = B;\n    pnts[2] = C;\n    pnts[3] = D;\n\n    for(int i = 0; i < 4; ++i) {\n        for(int j = 0; j < 4; ++j) {\n            for(int k = 0; k < 4; ++k) {\n                if(0 == iMod(\n                    int(255.0 * texture2D(maskTexture,\n                        vec2(\n                            (float(i * 2 + j / 2) + 0.5) / 8.0,\n                            (pnts[i][j][k] * (maskHeight - 1.0) + 1.0) / maskHeight\n                        ))[3]\n                    ) / int(pow(2.0, float(iMod(j * 4 + k, 8)))),\n                    2\n                )) return true;\n            }\n        }\n    }\n    return false;\n}\n\nvec4 position(bool isContext, float v, mat4 A, mat4 B, mat4 C, mat4 D) {\n    float x = 0.5 * sign(v) + 0.5;\n    float y = axisY(x, A, B, C, D);\n    float z = 1.0 - abs(v);\n\n    z += isContext ? 0.0 : 2.0 * float(\n        outsideBoundingBox(A, B, C, D) ||\n        outsideRasterMask(A, B, C, D)\n    );\n\n    return vec4(\n        2.0 * (vec2(x, y) * viewBoxSize + viewBoxPos) / resolution - 1.0,\n        z,\n        1.0\n    );\n}\n\nvoid main() {\n    mat4 A = mat4(p01_04, p05_08, p09_12, p13_16);\n    mat4 B = mat4(p17_20, p21_24, p25_28, p29_32);\n    mat4 C = mat4(p33_36, p37_40, p41_44, p45_48);\n    mat4 D = mat4(p49_52, p53_56, p57_60, ZEROS);\n\n    float v = colors[3];\n\n    gl_Position = position(isContext, v, A, B, C, D);\n\n    fragColor =\n        isContext ? vec4(contextColor) :\n        isPick ? vec4(colors.rgb, 1.0) : texture2D(palette, vec2(abs(v), 0.5));\n}\n"]),m=g(["precision highp float;\n#define GLSLIFY 1\n\nvarying vec4 fragColor;\n\nvoid main() {\n    gl_FragColor = fragColor;\n}\n"]),x=y("./constants").maxDimensionCount,e=y("../../lib"),n=new Uint8Array(4),t=new Uint8Array(4),a={shape:[256,1],format:"rgba",type:"uint8",mag:"nearest",min:"nearest"};function r(o,b,l,T,_){var w=o._gl;w.enable(w.SCISSOR_TEST),w.scissor(b,l,T,_),o.clear({color:[0,0,0,0],depth:1})}function d(o,b,l,T,_,w){var k=w.key;l.drawCompleted||(o.read({x:0,y:0,width:1,height:1,data:n}),l.drawCompleted=!0),function L(M){var I=Math.min(T,_-M*T);0===M&&(window.cancelAnimationFrame(l.currentRafs[k]),delete l.currentRafs[k],r(o,w.scissorX,w.scissorY,w.scissorWidth,w.viewBoxSize[1])),l.clearOnly||(w.count=2*I,w.offset=2*M*T,b(w),M*T+I<_&&(l.currentRafs[k]=window.requestAnimationFrame(function(){L(M+1)})),l.drawCompleted=!1)}(0)}function s(o,b){for(var l=new Array(256),T=0;T<256;T++)l[T]=o(T/255).concat(b);return l}function i(o,b){return(o>>>8*b)%256/255}function u(o,b,l){for(var T=new Array(8*b),_=0,w=0;w<b;w++)for(var k=0;k<2;k++)for(var L=0;L<4;L++){var M=4*o+L,I=l[64*w+M];63===M&&0===k&&(I*=-1),T[_++]=I}return T}function f(o){var b="0"+o;return b.substr(b.length-2)}function c(o){return o<x?"p"+f(o+1)+"_"+f(o+4):"colors"}function h(o,b,l,T,_,w,k,L,M,I,P,S,E,z){for(var R=[[],[]],q=0;q<64;q++)R[0][q]=q===_?1:0,R[1][q]=q===w?1:0;var V=o.lines.canvasOverdrag*z,W=o.domain,K=o.canvasWidth*z,G=o.canvasHeight*z,Y=o.pad.l*z,$=o.pad.b*z,B=o.layoutHeight*z,N=o.layoutWidth*z,U=o.deselectedLines.color,te=o.deselectedLines.opacity;return e.extendFlat({key:P,resolution:[K,G],viewBoxPos:[(k*=z)+V,L*=z],viewBoxSize:[M*=z,I*=z],i0:_,i1:w,dim0A:R[0].slice(0,16),dim0B:R[0].slice(16,32),dim0C:R[0].slice(32,48),dim0D:R[0].slice(48,64),dim1A:R[1].slice(0,16),dim1B:R[1].slice(16,32),dim1C:R[1].slice(32,48),dim1D:R[1].slice(48,64),drwLayer:S,contextColor:[U[0]/255,U[1]/255,U[2]/255,"auto"!==te?U[3]*te:Math.max(1/255,Math.pow(1/o.lines.color.length,1/3))],scissorX:(T===b?0:k+V)+(Y-V)+N*W.x[0],scissorWidth:(T===l?K-k+V:M+.5)+(T===b?k+V:0),scissorY:L+$+B*W.y[0],scissorHeight:I,viewportX:Y-V+N*W.x[0],viewportY:$+B*W.y[0],viewportWidth:K,viewportHeight:G},E)}function p(o){var b=Math.max(0,Math.floor(2047*o[0]),0),l=Math.min(2047,Math.ceil(2047*o[1]),2047);return[Math.min(b,l),Math.max(b,l)]}ee.exports=function(o,b){var l,_,w,k,L=b.context,M=b.pick,I=b.regl,P=I._gl,S=P.getParameter(P.ALIASED_LINE_WIDTH_RANGE),E=Math.max(S[0],Math.min(S[1],b.viewModel.plotGlPixelRatio)),z={currentRafs:{},drawCompleted:!0,clearOnly:!1},R=function(G){for(var Y={},$=0;$<=x;$+=4)Y[c($)]=G.buffer({usage:"dynamic",type:"float",data:new Uint8Array(0)});return Y}(I),q=I.texture(a),V=[];K(b);var W=I({profile:!1,blend:{enable:L,func:{srcRGB:"src alpha",dstRGB:"one minus src alpha",srcAlpha:1,dstAlpha:1},equation:{rgb:"add",alpha:"add"},color:[0,0,0,0]},depth:{enable:!L,mask:!0,func:"less",range:[0,1]},cull:{enable:!0,face:"back"},scissor:{enable:!0,box:{x:I.prop("scissorX"),y:I.prop("scissorY"),width:I.prop("scissorWidth"),height:I.prop("scissorHeight")}},viewport:{x:I.prop("viewportX"),y:I.prop("viewportY"),width:I.prop("viewportWidth"),height:I.prop("viewportHeight")},dither:!1,vert:v,frag:m,primitive:"lines",lineWidth:E,attributes:R,uniforms:{resolution:I.prop("resolution"),viewBoxPos:I.prop("viewBoxPos"),viewBoxSize:I.prop("viewBoxSize"),dim0A:I.prop("dim0A"),dim1A:I.prop("dim1A"),dim0B:I.prop("dim0B"),dim1B:I.prop("dim1B"),dim0C:I.prop("dim0C"),dim1C:I.prop("dim1C"),dim0D:I.prop("dim0D"),dim1D:I.prop("dim1D"),loA:I.prop("loA"),hiA:I.prop("hiA"),loB:I.prop("loB"),hiB:I.prop("hiB"),loC:I.prop("loC"),hiC:I.prop("hiC"),loD:I.prop("loD"),hiD:I.prop("hiD"),palette:q,contextColor:I.prop("contextColor"),maskTexture:I.prop("maskTexture"),drwLayer:I.prop("drwLayer"),maskHeight:I.prop("maskHeight")},offset:I.prop("offset"),count:I.prop("count")});function K(G){l=G.model,_=G.viewModel.dimensions.slice(),w=_[0]?_[0].values.length:0;var Y=l.lines,$=M?Y.color.map(function(N,U){return U/Y.color.length}):Y.color,B=function(N,U,te){for(var J=new Array(N*(x+4)),X=0,re=0;re<N;re++){for(var ne=0;ne<x;ne++)J[X++]=ne<U.length?U[ne].paddedUnitValues[re]:.5;J[X++]=i(re,2),J[X++]=i(re,1),J[X++]=i(re,0),J[X++]=Math.max(1e-6,Math.min(.999999,te[re]))}return J}(w,_,$);(function(N,U,te){for(var j=0;j<=x;j+=4)N[c(j)](u(j/4,U,te))})(R,w,B),L||M||(q=I.texture(e.extendFlat({data:s(l.unitToColor,255)},a)))}return{render:function(G,Y,$){var B,N,U,te=G.length,j=1/0,J=-1/0;for(B=0;B<te;B++)G[B].dim0.canvasX<j&&(j=G[B].dim0.canvasX,N=B),G[B].dim1.canvasX>J&&(J=G[B].dim1.canvasX,U=B);0===te&&r(I,0,0,l.canvasWidth,l.canvasHeight);var X=function(we){var Oe,fe,ve,Ae=[[],[]];for(ve=0;ve<64;ve++){var ke=!we&&ve<_.length?_[ve].brush.filter.getBounds():[-1/0,1/0];Ae[0][ve]=ke[0],Ae[1][ve]=ke[1]}var Pe=new Array(16384);for(Oe=0;Oe<16384;Oe++)Pe[Oe]=255;if(!we)for(Oe=0;Oe<_.length;Oe++){var Ne=Oe%8,De=(Oe-Ne)/8,ze=Math.pow(2,Ne),Me=_[Oe].brush.filter.get();if(!(Me.length<2)){var Se=p(Me[0])[1];for(fe=1;fe<Me.length;fe++){var Ie=p(Me[fe]);for(ve=Se+1;ve<Ie[0];ve++)Pe[8*ve+De]&=~ze;Se=Math.max(Se,Ie[1])}}}var Fe={shape:[8,2048],format:"alpha",type:"uint8",mag:"nearest",min:"nearest",data:Pe};return k?k(Fe):k=I.texture(Fe),{maskTexture:k,maskHeight:2048,loA:Ae[0].slice(0,16),loB:Ae[0].slice(16,32),loC:Ae[0].slice(32,48),loD:Ae[0].slice(48,64),hiA:Ae[1].slice(0,16),hiB:Ae[1].slice(16,32),hiC:Ae[1].slice(32,48),hiD:Ae[1].slice(48,64)}}(L);for(B=0;B<te;B++){var re=G[B],ne=re.dim0.crossfilterDimensionIndex,le=re.dim1.crossfilterDimensionIndex,oe=re.canvasX,de=re.canvasY,se=oe+re.panelSizeX,ge=re.plotGlPixelRatio;if(Y||!V[ne]||V[ne][0]!==oe||V[ne][1]!==se){V[ne]=[oe,se];var _e=h(l,N,U,B,ne,le,oe,de,re.panelSizeX,re.panelSizeY,re.dim0.crossfilterDimensionIndex,L?0:M?2:1,X,ge);z.clearOnly=$,d(I,W,z,Y?l.lines.blockLineCount:w,w,_e)}}},readPixel:function(G,Y){return I.read({x:G,y:Y,width:1,height:1,data:t}),t},readPixels:function(G,Y,$,B){var N=new Uint8Array(4*$*B);return I.read({x:G,y:Y,width:$,height:B,data:N}),N},destroy:function(){for(var G in o.style["pointer-events"]="none",q.destroy(),k&&k.destroy(),R)R[G].destroy()},update:K}}},{"../../lib":515,"./constants":902,glslify:227}],907:[function(y,ee,Q){"use strict";ee.exports=function(g,v,m,x){var e,n;for(x||(x=1/0),e=0;e<v.length;e++)(n=v[e]).visible&&(x=Math.min(x,n[m].length));for(x===1/0&&(x=0),g._length=x,e=0;e<v.length;e++)(n=v[e]).visible&&(n._length=x);return x}},{}],908:[function(y,ee,Q){"use strict";var g=y("@plotly/d3"),v=y("../../lib"),m=v.numberFormat,x=y("color-rgba"),e=y("../../plots/cartesian/axes"),n=v.strRotate,t=v.strTranslate,a=y("../../lib/svg_text_utils"),r=y("../../components/drawing"),d=y("../../components/colorscale"),s=y("../../lib/gup"),i=s.keyFun,u=s.repeat,f=s.unwrap,c=y("./helpers"),h=y("./constants"),p=y("./axisbrush"),o=y("./lines");function b(V,W,K){return v.aggNums(V,null,W,K)}function l(V,W){return _(b(Math.min,V,W),b(Math.max,V,W))}function T(V){var W=V.range;return W?_(W[0],W[1]):l(V.values,V._length)}function _(V,W){return!isNaN(V)&&isFinite(V)||(V=0),!isNaN(W)&&isFinite(W)||(W=0),V===W&&(0===V?(V-=1,W+=1):(V*=.9,W*=1.1)),[V,W]}function w(V,W,K,G,Y){var $,B,N=T(K);return G?g.scale.ordinal().domain(G.map(($=m(K.tickformat),B=Y,B?function(U,te){return B[te]??$(U)}:$))).range(G.map(function(U){return V-W+(U-N[0])/(N[1]-N[0])*(2*W-V)})):g.scale.linear().domain(N).range([V-W,W])}function k(V){if(V.tickvals){var W=T(V);return g.scale.ordinal().domain(V.tickvals).range(V.tickvals.map(function(K){return(K-W[0])/(W[1]-W[0])}))}}function L(V){var W=V.map(function(Y){return Y[0]}),K=V.map(function(Y){var $=x(Y[1]);return g.rgb("rgb("+$[0]+","+$[1]+","+$[2]+")")}),G="rgb".split("").map(function(Y){return g.scale.linear().clamp(!0).domain(W).range(K.map(($=Y,function(B){return B[$]})));var $});return function(Y){return G.map(function($){return $(Y)})}}function M(V){return V.dimensions.some(function(W){return W.brush.filterSpecified})}function I(V,W,K){var G=f(W),Y=G.trace,$=c.convertTypedArray(G.lineColor),B=Y.line,N={color:x(Y.unselected.line.color),opacity:Y.unselected.line.opacity},U=d.extractOpts(B),te=U.reversescale?d.flipScale(G.cscale):G.cscale,j=Y.domain,J=Y.dimensions,X=V.width,re=Y.labelangle,ne=Y.labelside,le=Y.labelfont,oe=Y.tickfont,de=Y.rangefont,se=v.extendDeepNoArrays({},B,{color:$.map(g.scale.linear().domain(T({values:$,range:[U.min,U.max],_length:Y._length}))),blockLineCount:h.blockLineCount,canvasOverdrag:h.overdrag*h.canvasPixelRatio}),ge=Math.floor(X*(j.x[1]-j.x[0])),_e=Math.floor(V.height*(j.y[1]-j.y[0])),Te=V.margin||{l:80,r:80,t:100,b:80},we=ge,Oe=_e;return{key:K,colCount:J.filter(c.isVisible).length,dimensions:J,tickDistance:h.tickDistance,unitToColor:L(te),lines:se,deselectedLines:N,labelAngle:re,labelSide:ne,labelFont:le,tickFont:oe,rangeFont:de,layoutWidth:X,layoutHeight:V.height,domain:j,translateX:j.x[0]*X,translateY:V.height-j.y[1]*V.height,pad:Te,canvasWidth:we*h.canvasPixelRatio+2*se.canvasOverdrag,canvasHeight:Oe*h.canvasPixelRatio,width:we,height:Oe,canvasPixelRatio:h.canvasPixelRatio}}function P(V,W,K){var X,re,G=K.width,Y=K.height,$=K.dimensions,B=K.canvasPixelRatio,N=function(X){return G*X/Math.max(1,K.colCount-1)},U=h.verticalPadding/Y,te=(X=Y,re=h.verticalPadding,g.scale.linear().range([re,X-re])),j={key:K.key,xScale:N,model:K,inBrushDrag:!1},J={};return j.dimensions=$.filter(c.isVisible).map(function(X,re){var Pe,Ne,ne=(Pe=X,Ne=U,g.scale.linear().domain(T(Pe)).range([Ne,1-Ne])),le=J[X.label];J[X.label]=(le||0)+1;var oe=X.label+(le?"__"+le:""),de=X.constraintrange,se=de&&de.length;se&&!Array.isArray(de[0])&&(de=[de]);var ge=se?de.map(function(Pe){return Pe.map(ne)}):[[-1/0,1/0]],_e=X.values;_e.length>X._length&&(_e=_e.slice(0,X._length));var Te,we=X.tickvals;function Oe(Pe,Ne){return{val:Pe,text:Te[Ne]}}function fe(Pe,Ne){return Pe.val-Ne.val}if(Array.isArray(we)&&we.length){Te=X.ticktext,Array.isArray(Te)&&Te.length?Te.length>we.length?Te=Te.slice(0,we.length):we.length>Te.length&&(we=we.slice(0,Te.length)):Te=we.map(m(X.tickformat));for(var ve=1;ve<we.length;ve++)if(we[ve]<we[ve-1]){for(var Ae=we.map(Oe).sort(fe),ke=0;ke<we.length;ke++)we[ke]=Ae[ke].val,Te[ke]=Ae[ke].text;break}}else we=void 0;return _e=c.convertTypedArray(_e),{key:oe,label:X.label,tickFormat:X.tickformat,tickvals:we,ticktext:Te,ordinal:c.isOrdinal(X),multiselect:X.multiselect,xIndex:re,crossfilterDimensionIndex:re,visibleIndex:X._index,height:Y,values:_e,paddedUnitValues:_e.map(ne),unitTickvals:we&&we.map(ne),xScale:N,x:N(re),canvasX:N(re)*B,unitToPaddedPx:te,domainScale:w(Y,h.verticalPadding,X,we,Te),ordinalScale:k(X),parent:j,model:K,brush:p.makeBrush(V,se,ge,function(){V.linePickActive(!1)},function(){var Pe=j;Pe.focusLayer&&Pe.focusLayer.render(Pe.panels,!0);var Ne=M(Pe);!V.contextShown()&&Ne?(Pe.contextLayer&&Pe.contextLayer.render(Pe.panels,!0),V.contextShown(!0)):V.contextShown()&&!Ne&&(Pe.contextLayer&&Pe.contextLayer.render(Pe.panels,!0,!0),V.contextShown(!1))},function(Pe){if(j.focusLayer.render(j.panels,!0),j.pickLayer&&j.pickLayer.render(j.panels,!0),V.linePickActive(!0),W&&W.filterChanged){var Ne=ne.invert,De=Pe.map(function(ze){return ze.map(Ne).sort(v.sorterAsc)}).sort(function(ze,Me){return ze[0]-Me[0]});W.filterChanged(j.key,X._index,De)}})}}),j}function S(V){V.classed(h.cn.axisExtentText,!0).attr("text-anchor","middle").style("cursor","default")}function E(V,W){var G=V*Math.PI/180;return{dir:"top"===W?1:-1,dx:Math.sin(G),dy:Math.cos(G),degrees:V}}function z(V,W,K){for(var G=W.panels||(W.panels=[]),Y=V.data(),$=0;$<Y.length-1;$++){var B=G[$]||(G[$]={}),N=Y[$],U=Y[$+1];B.dim0=N,B.dim1=U,B.canvasX=N.canvasX,B.panelSizeX=U.canvasX-N.canvasX,B.panelSizeY=W.model.canvasHeight,B.y=0,B.canvasY=0,B.plotGlPixelRatio=K}}function R(V,W){return e.tickText(V._ax,W,!1).text}function q(V,W){if(V.ordinal)return"";var K=V.domainScale.domain();return R(V.model.dimensions[V.visibleIndex],K[W?K.length-1:0])}ee.exports=function(V,W,K,G){var Y=V._fullLayout,$=Y._toppaper,B=Y._glcontainer,N=V._context.plotGlPixelRatio,U=V._fullLayout.paper_bgcolor;!function(ke){for(var Pe=0;Pe<ke.length;Pe++)for(var Ne=0;Ne<ke[Pe].length;Ne++)for(var De=ke[Pe][Ne].trace,ze=De.dimensions,Me=0;Me<ze.length;Me++){var Se=ze[Me].values,Ie=ze[Me]._ax;Ie&&(Ie.range=Ie.range?_(Ie.range[0],Ie.range[1]):l(Se,De._length),Ie.dtick||(Ie.dtick=.01*(Math.abs(Ie.range[1]-Ie.range[0])||1)),Ie.tickformat=ze[Me].tickformat,e.calcTicks(Ie),Ie.cleanRange())}}(W);var te,j,J=(te=!0,j=!1,{linePickActive:function(ke){return arguments.length?te=!!ke:te},contextShown:function(ke){return arguments.length?j=!!ke:j}}),X=W.filter(function(ke){return f(ke).trace.visible}).map(I.bind(0,K)).map(P.bind(0,J,G));B.each(function(ke,Pe){return v.extendFlat(ke,X[Pe])});var re=B.selectAll(".gl-canvas").each(function(ke){ke.viewModel=X[0],ke.viewModel.plotGlPixelRatio=N,ke.viewModel.paperColor=U,ke.model=ke.viewModel?ke.viewModel.model:null}),ne=null;re.filter(function(ke){return ke.pick}).style("pointer-events","auto").on("mousemove",function(ke){if(J.linePickActive()&&ke.lineLayer&&G&&G.hover){var Pe=g.event,Ne=this.width,De=this.height,ze=g.mouse(this),Me=ze[0],Se=ze[1];if(Me<0||Se<0||Me>=Ne||Se>=De)return;var Ie=ke.lineLayer.readPixel(Me,De-1-Se),Fe=0!==Ie[3],Re=Fe?Ie[2]+256*(Ie[1]+256*Ie[0]):null,Xe={x:Me,y:Se,clientX:Pe.clientX,clientY:Pe.clientY,dataIndex:ke.model.key,curveNumber:Re};Re!==ne&&(Fe?G.hover(Xe):G.unhover&&G.unhover(Xe),ne=Re)}}),re.style("opacity",function(ke){return ke.pick?0:1}),$.style("background","rgba(255, 255, 255, 0)");var le=$.selectAll("."+h.cn.parcoords).data(X,i);le.exit().remove(),le.enter().append("g").classed(h.cn.parcoords,!0).style("shape-rendering","crispEdges").style("pointer-events","none"),le.attr("transform",function(ke){return t(ke.model.translateX,ke.model.translateY)});var oe=le.selectAll("."+h.cn.parcoordsControlView).data(u,i);oe.enter().append("g").classed(h.cn.parcoordsControlView,!0),oe.attr("transform",function(ke){return t(ke.model.pad.l,ke.model.pad.t)});var de=oe.selectAll("."+h.cn.yAxis).data(function(ke){return ke.dimensions},i);de.enter().append("g").classed(h.cn.yAxis,!0),oe.each(function(ke){z(de,ke,N)}),re.each(function(ke){ke.viewModel&&(!ke.lineLayer||G?ke.lineLayer=o(this,ke):ke.lineLayer.update(ke),(ke.key||0===ke.key)&&(ke.viewModel[ke.key]=ke.lineLayer),ke.lineLayer.render(ke.viewModel.panels,!ke.context||G))}),de.attr("transform",function(ke){return t(ke.xScale(ke.xIndex),0)}),de.call(g.behavior.drag().origin(function(ke){return ke}).on("drag",function(ke){var Pe=ke.parent;J.linePickActive(!1),ke.x=Math.max(-h.overdrag,Math.min(ke.model.width+h.overdrag,g.event.x)),ke.canvasX=ke.x*ke.model.canvasPixelRatio,de.sort(function(Ne,De){return Ne.x-De.x}).each(function(Ne,De){Ne.xIndex=De,Ne.x=ke===Ne?Ne.x:Ne.xScale(Ne.xIndex),Ne.canvasX=Ne.x*Ne.model.canvasPixelRatio}),z(de,Pe,N),de.filter(function(Ne){return 0!==Math.abs(ke.xIndex-Ne.xIndex)}).attr("transform",function(Ne){return t(Ne.xScale(Ne.xIndex),0)}),g.select(this).attr("transform",t(ke.x,0)),de.each(function(Ne,De,ze){ze===ke.parent.key&&(Pe.dimensions[De]=Ne)}),Pe.contextLayer&&Pe.contextLayer.render(Pe.panels,!1,!M(Pe)),Pe.focusLayer.render&&Pe.focusLayer.render(Pe.panels)}).on("dragend",function(ke){var Pe=ke.parent;ke.x=ke.xScale(ke.xIndex),ke.canvasX=ke.x*ke.model.canvasPixelRatio,z(de,Pe,N),g.select(this).attr("transform",function(Ne){return t(Ne.x,0)}),Pe.contextLayer&&Pe.contextLayer.render(Pe.panels,!1,!M(Pe)),Pe.focusLayer&&Pe.focusLayer.render(Pe.panels),Pe.pickLayer&&Pe.pickLayer.render(Pe.panels,!0),J.linePickActive(!0),G&&G.axesMoved&&G.axesMoved(Pe.key,Pe.dimensions.map(function(Ne){return Ne.crossfilterDimensionIndex}))})),de.exit().remove();var se=de.selectAll("."+h.cn.axisOverlays).data(u,i);se.enter().append("g").classed(h.cn.axisOverlays,!0),se.selectAll("."+h.cn.axis).remove();var ge=se.selectAll("."+h.cn.axis).data(u,i);ge.enter().append("g").classed(h.cn.axis,!0),ge.each(function(ke){var Pe=ke.model.height/ke.model.tickDistance,Ne=ke.domainScale,De=Ne.domain();g.select(this).call(g.svg.axis().orient("left").tickSize(4).outerTickSize(2).ticks(Pe,ke.tickFormat).tickValues(ke.ordinal?De:null).tickFormat(function(ze){return c.isOrdinal(ke)?ze:R(ke.model.dimensions[ke.visibleIndex],ze)}).scale(Ne)),r.font(ge.selectAll("text"),ke.model.tickFont)}),ge.selectAll(".domain, .tick>line").attr("fill","none").attr("stroke","black").attr("stroke-opacity",.25).attr("stroke-width","1px"),ge.selectAll("text").style("text-shadow",a.makeTextShadow(U)).style("cursor","default");var _e=se.selectAll("."+h.cn.axisHeading).data(u,i);_e.enter().append("g").classed(h.cn.axisHeading,!0);var Te=_e.selectAll("."+h.cn.axisTitle).data(u,i);Te.enter().append("text").classed(h.cn.axisTitle,!0).attr("text-anchor","middle").style("cursor","ew-resize").style("pointer-events","auto"),Te.text(function(ke){return ke.label}).each(function(ke){var Pe=g.select(this);r.font(Pe,ke.model.labelFont),a.convertToTspans(Pe,V)}).attr("transform",function(ke){var Pe=E(ke.model.labelAngle,ke.model.labelSide),Ne=h.axisTitleOffset;return(Pe.dir>0?"":t(0,2*Ne+ke.model.height))+n(Pe.degrees)+t(-Ne*Pe.dx,-Ne*Pe.dy)}).attr("text-anchor",function(ke){var Pe=E(ke.model.labelAngle,ke.model.labelSide);return 2*Math.abs(Pe.dx)>Math.abs(Pe.dy)?Pe.dir*Pe.dx<0?"start":"end":"middle"});var we=se.selectAll("."+h.cn.axisExtent).data(u,i);we.enter().append("g").classed(h.cn.axisExtent,!0);var Oe=we.selectAll("."+h.cn.axisExtentTop).data(u,i);Oe.enter().append("g").classed(h.cn.axisExtentTop,!0),Oe.attr("transform",t(0,-h.axisExtentOffset));var fe=Oe.selectAll("."+h.cn.axisExtentTopText).data(u,i);fe.enter().append("text").classed(h.cn.axisExtentTopText,!0).call(S),fe.text(function(ke){return q(ke,!0)}).each(function(ke){r.font(g.select(this),ke.model.rangeFont)});var ve=we.selectAll("."+h.cn.axisExtentBottom).data(u,i);ve.enter().append("g").classed(h.cn.axisExtentBottom,!0),ve.attr("transform",function(ke){return t(0,ke.model.height+h.axisExtentOffset)});var Ae=ve.selectAll("."+h.cn.axisExtentBottomText).data(u,i);Ae.enter().append("text").classed(h.cn.axisExtentBottomText,!0).attr("dy","0.75em").call(S),Ae.text(function(ke){return q(ke,!1)}).each(function(ke){r.font(g.select(this),ke.model.rangeFont)}),p.ensureAxisBrush(se,U)}},{"../../components/colorscale":379,"../../components/drawing":389,"../../lib":515,"../../lib/gup":512,"../../lib/svg_text_utils":541,"../../plots/cartesian/axes":566,"./axisbrush":898,"./constants":902,"./helpers":904,"./lines":906,"@plotly/d3":58,"color-rgba":91}],909:[function(y,ee,Q){"use strict";var g=y("./parcoords"),v=y("../../lib/prepare_regl"),m=y("./helpers").isVisible,x={};function e(n,t,a){var r=t.indexOf(a),d=n.indexOf(r);return-1===d&&(d+=t.length),d}(ee.exports=function(n,t){var a=n._fullLayout;if(v(n,[],x)){var r={},d={},s={},i={},u=a._size;t.forEach(function(f,c){var h=f[0].trace;s[c]=h.index;var p=i[c]=h._fullInput.index;r[c]=n.data[p].dimensions,d[c]=n.data[p].dimensions.slice()}),g(n,t,{width:u.w,height:u.h,margin:{t:u.t,r:u.r,b:u.b,l:u.l}},{filterChanged:function(f,c,h){var p=d[f][c],o=h.map(function(k){return k.slice()}),b="dimensions["+c+"].constraintrange",l=a._tracePreGUI[n._fullData[s[f]]._fullInput.uid];void 0===l[b]&&(l[b]=p.constraintrange||null);var _=n._fullData[s[f]].dimensions[c];o.length?(1===o.length&&(o=o[0]),p.constraintrange=o,_.constraintrange=o.slice(),o=[o]):(delete p.constraintrange,delete _.constraintrange,o=null);var w={};w[b]=o,n.emit("plotly_restyle",[w,[i[f]]])},hover:function(f){n.emit("plotly_hover",f)},unhover:function(f){n.emit("plotly_unhover",f)},axesMoved:function(f,c){var p,o,h=(p=c,o=d[f].filter(m),function(b,l){return e(p,o,b)-e(p,o,l)});r[f].sort(h),d[f].filter(function(p){return!m(p)}).sort(function(p){return d[f].indexOf(p)}).forEach(function(p){r[f].splice(r[f].indexOf(p),1),r[f].splice(d[f].indexOf(p),0,p)}),n.emit("plotly_restyle",[{dimensions:[r[f]]},[i[f]]])}})}}).reglPrecompiled=x},{"../../lib/prepare_regl":528,"./helpers":904,"./parcoords":908}],910:[function(y,ee,Q){"use strict";var g=y("../../plots/attributes"),v=y("../../plots/domain").attributes,m=y("../../plots/font_attributes"),x=y("../../components/color/attributes"),e=y("../../plots/template_attributes").hovertemplateAttrs,n=y("../../plots/template_attributes").texttemplateAttrs,t=y("../../lib/extend").extendFlat,a=m({editType:"plot",arrayOk:!0,colorEditType:"plot"});ee.exports={labels:{valType:"data_array",editType:"calc"},label0:{valType:"number",dflt:0,editType:"calc"},dlabel:{valType:"number",dflt:1,editType:"calc"},values:{valType:"data_array",editType:"calc"},marker:{colors:{valType:"data_array",editType:"calc"},line:{color:{valType:"color",dflt:x.defaultLine,arrayOk:!0,editType:"style"},width:{valType:"number",min:0,dflt:0,arrayOk:!0,editType:"style"},editType:"calc"},editType:"calc"},text:{valType:"data_array",editType:"plot"},hovertext:{valType:"string",dflt:"",arrayOk:!0,editType:"style"},scalegroup:{valType:"string",dflt:"",editType:"calc"},textinfo:{valType:"flaglist",flags:["label","text","value","percent"],extras:["none"],editType:"calc"},hoverinfo:t({},g.hoverinfo,{flags:["label","text","value","percent","name"]}),hovertemplate:e({},{keys:["label","color","value","percent","text"]}),texttemplate:n({editType:"plot"},{keys:["label","color","value","percent","text"]}),textposition:{valType:"enumerated",values:["inside","outside","auto","none"],dflt:"auto",arrayOk:!0,editType:"plot"},textfont:t({},a,{}),insidetextorientation:{valType:"enumerated",values:["horizontal","radial","tangential","auto"],dflt:"auto",editType:"plot"},insidetextfont:t({},a,{}),outsidetextfont:t({},a,{}),automargin:{valType:"boolean",dflt:!1,editType:"plot"},title:{text:{valType:"string",dflt:"",editType:"plot"},font:t({},a,{}),position:{valType:"enumerated",values:["top left","top center","top right","middle center","bottom left","bottom center","bottom right"],editType:"plot"},editType:"plot"},domain:v({name:"pie",trace:!0,editType:"calc"}),hole:{valType:"number",min:0,max:1,dflt:0,editType:"calc"},sort:{valType:"boolean",dflt:!0,editType:"calc"},direction:{valType:"enumerated",values:["clockwise","counterclockwise"],dflt:"counterclockwise",editType:"calc"},rotation:{valType:"number",min:-360,max:360,dflt:0,editType:"calc"},pull:{valType:"number",min:0,max:1,dflt:0,arrayOk:!0,editType:"calc"},_deprecated:{title:{valType:"string",dflt:"",editType:"calc"},titlefont:t({},a,{}),titleposition:{valType:"enumerated",values:["top left","top center","top right","middle center","bottom left","bottom center","bottom right"],editType:"calc"}}}},{"../../components/color/attributes":366,"../../lib/extend":505,"../../plots/attributes":562,"../../plots/domain":593,"../../plots/font_attributes":594,"../../plots/template_attributes":642}],911:[function(y,ee,Q){"use strict";var g=y("../../plots/plots");Q.name="pie",Q.plot=function(v,m,x,e){g.plotBasePlot(Q.name,v,m,x,e)},Q.clean=function(v,m,x,e){g.cleanBasePlot(Q.name,v,m,x,e)}},{"../../plots/plots":628}],912:[function(y,ee,Q){"use strict";var g=y("fast-isnumeric"),v=y("tinycolor2"),m=y("../../components/color"),x={};function e(t){return function(a,r){return!!a&&!!(a=v(a)).isValid()&&(a=m.addOpacity(a,a.getAlpha()),t[r]||(t[r]=a),a)}}function n(t,a){var r,d=JSON.stringify(t),s=a[d];if(!s){for(s=t.slice(),r=0;r<t.length;r++)s.push(v(t[r]).lighten(20).toHexString());for(r=0;r<t.length;r++)s.push(v(t[r]).darken(20).toHexString());a[d]=s}return s}ee.exports={calc:function(t,a){var r,d,s=[],i=t._fullLayout,u=i.hiddenlabels||[],f=a.labels,c=a.marker.colors||[],h=a.values,p=a._length,o=a._hasValues&&p;if(a.dlabel)for(f=new Array(p),r=0;r<p;r++)f[r]=String(a.label0+r*a.dlabel);var b={},l=e(i["_"+a.type+"colormap"]),T=0,_=!1;for(r=0;r<p;r++){var w,k,L;if(o){if(!g(w=h[r]))continue;w=+w}else w=1;void 0!==(k=f[r])&&""!==k||(k=r);var M=b[k=String(k)];void 0===M?(b[k]=s.length,(L=-1!==u.indexOf(k))||(T+=w),s.push({v:w,label:k,color:l(c[r],k),i:r,pts:[r],hidden:L})):(_=!0,(d=s[M]).v+=w,d.pts.push(r),d.hidden||(T+=w),!1===d.color&&c[r]&&(d.color=l(c[r],k)))}return s=s.filter(function(I){return I.v>=0}),("funnelarea"===a.type?_:a.sort)&&s.sort(function(I,P){return P.v-I.v}),s[0]&&(s[0].vTotal=T),s},crossTraceCalc:function(t,a){var r=(a||{}).type;r||(r="pie");var d=t._fullLayout,s=t.calcdata,i=d[r+"colorway"],u=d["_"+r+"colormap"];d["extend"+r+"colors"]&&(i=n(i,x));for(var f=0,c=0;c<s.length;c++){var h=s[c];if(h[0].trace.type===r)for(var p=0;p<h.length;p++){var o=h[p];!1===o.color&&(u[o.label]?o.color=u[o.label]:(u[o.label]=o.color=i[f%i.length],f++))}}},makePullColorFn:e,generateExtendedColors:n}},{"../../components/color":367,"fast-isnumeric":190,tinycolor2:313}],913:[function(y,ee,Q){"use strict";var g=y("fast-isnumeric"),v=y("../../lib"),m=y("./attributes"),x=y("../../plots/domain").defaults,e=y("../bar/defaults").handleText;function n(t,a){var r=Array.isArray(t),d=v.isArrayOrTypedArray(a),s=Math.min(r?t.length:1/0,d?a.length:1/0);if(isFinite(s)||(s=0),s&&d){for(var i,u=0;u<s;u++){var f=a[u];if(g(f)&&f>0){i=!0;break}}i||(s=0)}return{hasLabels:r,hasValues:d,len:s}}ee.exports={handleLabelsAndValues:n,supplyDefaults:function(t,a,r,d){function s(l,T){return v.coerce(t,a,m,l,T)}var i=n(s("labels"),s("values")),u=i.len;if(a._hasLabels=i.hasLabels,a._hasValues=i.hasValues,!a._hasLabels&&a._hasValues&&(s("label0"),s("dlabel")),u){a._length=u,s("marker.line.width")&&s("marker.line.color"),s("marker.colors"),s("scalegroup");var f,c=s("text"),h=s("texttemplate");if(h||(f=s("textinfo",Array.isArray(c)?"text+percent":"percent")),s("hovertext"),s("hovertemplate"),h||f&&"none"!==f){var p=s("textposition");e(t,a,d,s,p,{moduleHasSelected:!1,moduleHasUnselected:!1,moduleHasConstrain:!1,moduleHasCliponaxis:!1,moduleHasTextangle:!1,moduleHasInsideanchor:!1}),(Array.isArray(p)||"auto"===p||"outside"===p)&&s("automargin"),("inside"===p||"auto"===p||Array.isArray(p))&&s("insidetextorientation")}x(a,d,s);var o=s("hole");if(s("title.text")){var b=s("title.position",o?"middle center":"top center");o||"middle center"!==b||(a.title.position="top center"),v.coerceFont(s,"title.font",d.font)}s("sort"),s("direction"),s("rotation"),s("pull")}else a.visible=!1}}},{"../../lib":515,"../../plots/domain":593,"../bar/defaults":661,"./attributes":910,"fast-isnumeric":190}],914:[function(y,ee,Q){"use strict";var g=y("../../components/fx/helpers").appendArrayMultiPointValues;ee.exports=function(v,m){var x={curveNumber:m.index,pointNumbers:v.pts,data:m._input,fullData:m,label:v.label,color:v.color,value:v.v,percent:v.percent,text:v.text,bbox:v.bbox,v:v.v};return 1===v.pts.length&&(x.pointNumber=x.i=v.pts[0]),g(x,m,v.pts),"funnelarea"===m.type&&(delete x.v,delete x.i),x}},{"../../components/fx/helpers":403}],915:[function(y,ee,Q){"use strict";var g=y("../../lib");function v(m){return-1!==m.indexOf("e")?m.replace(/[.]?0+e/,"e"):-1!==m.indexOf(".")?m.replace(/[.]?0+$/,""):m}Q.formatPiePercent=function(m,x){var e=v((100*m).toPrecision(3));return g.numSeparate(e,x)+"%"},Q.formatPieValue=function(m,x){var e=v(m.toPrecision(10));return g.numSeparate(e,x)},Q.getFirstFilled=function(m,x){if(Array.isArray(m))for(var e=0;e<x.length;e++){var n=m[x[e]];if(n||0===n||""===n)return n}},Q.castOption=function(m,x){return Array.isArray(m)?Q.getFirstFilled(m,x):m||void 0},Q.getRotationAngle=function(m){return("auto"===m?0:m)*Math.PI/180}},{"../../lib":515}],916:[function(y,ee,Q){"use strict";ee.exports={attributes:y("./attributes"),supplyDefaults:y("./defaults").supplyDefaults,supplyLayoutDefaults:y("./layout_defaults"),layoutAttributes:y("./layout_attributes"),calc:y("./calc").calc,crossTraceCalc:y("./calc").crossTraceCalc,plot:y("./plot").plot,style:y("./style"),styleOne:y("./style_one"),moduleType:"trace",name:"pie",basePlotModule:y("./base_plot"),categories:["pie-like","pie","showLegend"],meta:{}}},{"./attributes":910,"./base_plot":911,"./calc":912,"./defaults":913,"./layout_attributes":917,"./layout_defaults":918,"./plot":919,"./style":920,"./style_one":921}],917:[function(y,ee,Q){"use strict";ee.exports={hiddenlabels:{valType:"data_array",editType:"calc"},piecolorway:{valType:"colorlist",editType:"calc"},extendpiecolors:{valType:"boolean",dflt:!0,editType:"calc"}}},{}],918:[function(y,ee,Q){"use strict";var g=y("../../lib"),v=y("./layout_attributes");ee.exports=function(m,x){function e(n,t){return g.coerce(m,x,v,n,t)}e("hiddenlabels"),e("piecolorway",x.colorway),e("extendpiecolors")}},{"../../lib":515,"./layout_attributes":917}],919:[function(y,ee,Q){"use strict";var g=y("@plotly/d3"),v=y("../../plots/plots"),m=y("../../components/fx"),x=y("../../components/color"),e=y("../../components/drawing"),n=y("../../lib"),t=n.strScale,a=n.strTranslate,r=y("../../lib/svg_text_utils"),d=y("../bar/uniform_text"),s=d.recordMinTextSize,i=d.clearMinTextSize,u=y("../bar/constants").TEXTPAD,f=y("./helpers"),c=y("./event_data"),h=y("../../lib").isValidTextValue;function p(W,K,G){var Y=G[0],$=Y.cx,B=Y.cy,N=Y.trace,U="funnelarea"===N.type;"_hasHoverLabel"in N||(N._hasHoverLabel=!1),"_hasHoverEvent"in N||(N._hasHoverEvent=!1),W.on("mouseover",function(te){var j=K._fullLayout,J=K._fullData[N.index];if(!K._dragging&&!1!==j.hovermode){var X=J.hoverinfo;if(Array.isArray(X)&&(X=m.castHoverinfo({hoverinfo:[f.castOption(X,te.pts)],_module:N._module},j,0)),"all"===X&&(X="label+text+value+percent+name"),J.hovertemplate||"none"!==X&&"skip"!==X&&X){var re=te.rInscribed||0,ne=$+te.pxmid[0]*(1-re),le=B+te.pxmid[1]*(1-re),oe=j.separators,de=[];if(X&&-1!==X.indexOf("label")&&de.push(te.label),te.text=f.castOption(J.hovertext||J.text,te.pts),X&&-1!==X.indexOf("text")){var se=te.text;n.isValidTextValue(se)&&de.push(se)}te.value=te.v,te.valueLabel=f.formatPieValue(te.v,oe),X&&-1!==X.indexOf("value")&&de.push(te.valueLabel),te.percent=te.v/Y.vTotal,te.percentLabel=f.formatPiePercent(te.percent,oe),X&&-1!==X.indexOf("percent")&&de.push(te.percentLabel);var ge=J.hoverlabel,_e=ge.font,Te=[];m.loneHover({trace:N,x0:ne-re*Y.r,x1:ne+re*Y.r,y:le,_x0:U?$+te.TL[0]:ne-re*Y.r,_x1:U?$+te.TR[0]:ne+re*Y.r,_y0:U?B+te.TL[1]:le-re*Y.r,_y1:U?B+te.BL[1]:le+re*Y.r,text:de.join("<br>"),name:J.hovertemplate||-1!==X.indexOf("name")?J.name:void 0,idealAlign:te.pxmid[0]<0?"left":"right",color:f.castOption(ge.bgcolor,te.pts)||te.color,borderColor:f.castOption(ge.bordercolor,te.pts),fontFamily:f.castOption(_e.family,te.pts),fontSize:f.castOption(_e.size,te.pts),fontColor:f.castOption(_e.color,te.pts),nameLength:f.castOption(ge.namelength,te.pts),textAlign:f.castOption(ge.align,te.pts),hovertemplate:f.castOption(J.hovertemplate,te.pts),hovertemplateLabels:te,eventData:[c(te,J)]},{container:j._hoverlayer.node(),outerContainer:j._paper.node(),gd:K,inOut_bbox:Te}),te.bbox=Te[0],N._hasHoverLabel=!0}N._hasHoverEvent=!0,K.emit("plotly_hover",{points:[c(te,J)],event:g.event})}}),W.on("mouseout",function(te){var j=K._fullLayout,J=K._fullData[N.index],X=g.select(this).datum();N._hasHoverEvent&&(te.originalEvent=g.event,K.emit("plotly_unhover",{points:[c(X,J)],event:g.event}),N._hasHoverEvent=!1),N._hasHoverLabel&&(m.loneUnhover(j._hoverlayer.node()),N._hasHoverLabel=!1)}),W.on("click",function(te){K._dragging||!1===K._fullLayout.hovermode||(K._hoverdata=[c(te,K._fullData[N.index])],m.click(K,g.event))})}function o(W,K,G){var Y=f.castOption(W.insidetextfont.color,K.pts);!Y&&W._input.textfont&&(Y=f.castOption(W._input.textfont.color,K.pts));var $=f.castOption(W.insidetextfont.family,K.pts)||f.castOption(W.textfont.family,K.pts)||G.family,B=f.castOption(W.insidetextfont.size,K.pts)||f.castOption(W.textfont.size,K.pts)||G.size;return{color:Y||x.contrast(K.color),family:$,size:B}}function b(W,K){for(var G,Y,$=0;$<W.length;$++)if((Y=(G=W[$][0]).trace).title.text){var B=Y.title.text;Y._meta&&(B=n.templateString(B,Y._meta));var N=e.tester.append("text").attr("data-notex",1).text(B).call(e.font,Y.title.font).call(r.convertToTspans,K),U=e.bBox(N.node(),!0);G.titleBox={width:U.width,height:U.height},N.remove()}}function l(W,K,G){var Y=G.r||K.rpx1,$=K.rInscribed;if(K.startangle===K.stopangle)return{rCenter:1-$,scale:0,rotate:0,textPosAngle:0};var B,N=K.ring,U=1===N&&Math.abs(K.startangle-K.stopangle)===2*Math.PI,te=K.halfangle,j=K.midangle,J=G.trace.insidetextorientation,X="horizontal"===J,re="tangential"===J,ne="radial"===J,le="auto"===J,oe=[];if(!le){var de,se=function(fe,ve){if(Me=(Ne=K).stopangle,(ze=Ne.startangle)>(De=fe)&&De>Me||ze<De&&De<Me){var Ae=Math.abs(fe-K.startangle),ke=Math.abs(fe-K.stopangle),Pe=Ae<ke?Ae:ke;(B="tan"===ve?_(W,Y,N,Pe,0):T(W,Y,N,Pe,Math.PI/2)).textPosAngle=fe,oe.push(B)}var Ne,De,ze,Me};if(X||re){for(de=4;de>=-4;de-=2)se(Math.PI*de,"tan");for(de=4;de>=-4;de-=2)se(Math.PI*(de+1),"tan")}if(X||ne){for(de=4;de>=-4;de-=2)se(Math.PI*(de+1.5),"rad");for(de=4;de>=-4;de-=2)se(Math.PI*(de+.5),"rad")}}if(U||le||X){var ge=Math.sqrt(W.width*W.width+W.height*W.height);if((B={scale:$*Y*2/ge,rCenter:1-$,rotate:0}).textPosAngle=(K.startangle+K.stopangle)/2,B.scale>=1)return B;oe.push(B)}(le||ne)&&((B=T(W,Y,N,te,j)).textPosAngle=(K.startangle+K.stopangle)/2,oe.push(B)),(le||re)&&((B=_(W,Y,N,te,j)).textPosAngle=(K.startangle+K.stopangle)/2,oe.push(B));for(var _e=0,Te=0,we=0;we<oe.length;we++){var Oe=oe[we].scale;if(Te<Oe&&(Te=Oe,_e=we),!le&&Te>=1)break}return oe[_e]}function T(W,K,G,Y,$){K=Math.max(0,K-2*u);var B=W.width/W.height,N=L(B,Y,K,G);return{scale:2*N/W.height,rCenter:w(B,N/K),rotate:k($)}}function _(W,K,G,Y,$){K=Math.max(0,K-2*u);var B=W.height/W.width,N=L(B,Y,K,G);return{scale:2*N/W.width,rCenter:w(B,N/K),rotate:k($+Math.PI/2)}}function w(W,K){return Math.cos(K)-W*K}function k(W){return(180/Math.PI*W+720)%180-90}function L(W,K,G,Y){var $=W+1/(2*Math.tan(K));return G*Math.min(1/(Math.sqrt($*$+.5)+$),Y/(Math.sqrt(W*W+Y/2)+W))}function M(W,K){return W.v!==K.vTotal||K.trace.hole?Math.min(1/(1+1/Math.sin(W.halfangle)),W.ring/2):1}function I(W,K){var G=K.pxmid[0],Y=K.pxmid[1],$=W.width/2,B=W.height/2;return G<0&&($*=-1),Y<0&&(B*=-1),{scale:1,rCenter:1,rotate:0,x:$+Math.abs(B)*($>0?1:-1)/2,y:B/(1+G*G/(Y*Y)),outside:!0}}function P(W,K){var G,Y,$,B=W.trace,N={x:W.cx,y:W.cy},U={tx:0,ty:0};U.ty+=B.title.font.size,$=E(B),-1!==B.title.position.indexOf("top")?(N.y-=(1+$)*W.r,U.ty-=W.titleBox.height):-1!==B.title.position.indexOf("bottom")&&(N.y+=(1+$)*W.r);var j,J=W.r/(void 0===(j=W.trace.aspectratio)?1:j),X=K.w*(B.domain.x[1]-B.domain.x[0])/2;return-1!==B.title.position.indexOf("left")?(X+=J,N.x-=(1+$)*J,U.tx+=W.titleBox.width/2):-1!==B.title.position.indexOf("center")?X*=2:-1!==B.title.position.indexOf("right")&&(X+=J,N.x+=(1+$)*J,U.tx-=W.titleBox.width/2),G=X/W.titleBox.width,Y=S(W,K)/W.titleBox.height,{x:N.x,y:N.y,scale:Math.min(G,Y),tx:U.tx,ty:U.ty}}function S(W,K){var G=W.trace;return Math.min(W.titleBox.height,K.h*(G.domain.y[1]-G.domain.y[0])/2)}function E(W){var K,G=W.pull;if(!G)return 0;if(Array.isArray(G))for(G=0,K=0;K<W.pull.length;K++)W.pull[K]>G&&(G=W.pull[K]);return G}function z(W,K){for(var G=[],Y=0;Y<W.length;Y++){var $=W[Y][0],B=$.trace,N=B.domain,U=K.w*(N.x[1]-N.x[0]),te=K.h*(N.y[1]-N.y[0]);B.title.text&&"middle center"!==B.title.position&&(te-=S($,K));var J=te/2;"funnelarea"!==B.type||B.scalegroup||(J/=B.aspectratio),$.r=Math.min(U/2,J)/(1+E(B)),$.cx=K.l+K.w*(B.domain.x[1]+B.domain.x[0])/2,$.cy=K.t+K.h*(1-B.domain.y[0])-te/2,B.title.text&&-1!==B.title.position.indexOf("bottom")&&($.cy-=S($,K)),B.scalegroup&&-1===G.indexOf(B.scalegroup)&&G.push(B.scalegroup)}!function(X,re){for(var ne,le,oe,de=0;de<re.length;de++){var se=1/0,ge=re[de];for(le=0;le<X.length;le++)if((oe=(ne=X[le][0]).trace).scalegroup===ge){var _e;if("pie"===oe.type)_e=ne.r*ne.r;else if("funnelarea"===oe.type){var Te,we;oe.aspectratio>1?we=(Te=ne.r)/oe.aspectratio:Te=(we=ne.r)*oe.aspectratio,_e=(Te*=(1+oe.baseratio)/2)*we}se=Math.min(se,_e/ne.vTotal)}for(le=0;le<X.length;le++)if((oe=(ne=X[le][0]).trace).scalegroup===ge){var Oe=se*ne.vTotal;"funnelarea"===oe.type&&(Oe/=(1+oe.baseratio)/2,Oe/=oe.aspectratio),ne.r=Math.sqrt(Oe)}}}(W,G)}function R(W,K){return[W*Math.sin(K),-W*Math.cos(K)]}function q(W,K,G){var _e,Y=W._fullLayout,$=G.trace,B=$.texttemplate,N=$.textinfo;if(!B&&N&&"none"!==N){var U,te=N.split("+"),j=function(_e){return-1!==te.indexOf(_e)},J=j("label"),X=j("text"),re=j("value"),ne=j("percent"),le=Y.separators;if(U=J?[K.label]:[],X){var oe=f.getFirstFilled($.text,K.pts);h(oe)&&U.push(oe)}re&&U.push(f.formatPieValue(K.v,le)),ne&&U.push(f.formatPiePercent(K.v/G.vTotal,le)),K.text=U.join("<br>")}if(B){var de=n.castOption($,K.i,"texttemplate");if(de){var se={label:(_e=K).label,value:_e.v,valueLabel:f.formatPieValue(_e.v,Y.separators),percent:_e.v/G.vTotal,percentLabel:f.formatPiePercent(_e.v/G.vTotal,Y.separators),color:_e.color,text:_e.text,customdata:n.castOption($,_e.i,"customdata")},ge=f.getFirstFilled($.text,K.pts);(h(ge)||""===ge)&&(se.text=ge),K.text=n.texttemplateString(de,se,W._fullLayout._d3locale,se,$._meta||{})}else K.text=""}}function V(W,K){var G=W.rotate*Math.PI/180,Y=Math.cos(G),$=Math.sin(G),B=(K.left+K.right)/2,N=(K.top+K.bottom)/2;W.textX=B*Y-N*$,W.textY=B*$+N*Y,W.noCenter=!0}ee.exports={plot:function(W,K){var G=W._fullLayout,Y=G._size;i("pie",G),b(K,W),z(K,Y);var $=n.makeTraceGroups(G._pielayer,K,"trace").each(function(B){var N=g.select(this),U=B[0],te=U.trace;(function(j){var J,X,re,ne=j[0],le=ne.r,oe=ne.trace,de=f.getRotationAngle(oe.rotation),se=2*Math.PI/ne.vTotal,ge="px0",_e="px1";if("counterclockwise"===oe.direction){for(J=0;J<j.length&&j[J].hidden;J++);if(J===j.length)return;de+=se*j[J].v,se*=-1,ge="px1",_e="px0"}for(re=R(le,de),J=0;J<j.length;J++)(X=j[J]).hidden||(X[ge]=re,X.startangle=de,X.pxmid=R(le,de+=se*X.v/2),X.midangle=de,re=R(le,de+=se*X.v/2),X.stopangle=de,X[_e]=re,X.largeArc=X.v>ne.vTotal/2?1:0,X.halfangle=Math.PI*Math.min(X.v/ne.vTotal,.5),X.ring=1-oe.hole,X.rInscribed=M(X,ne))})(B),N.attr("stroke-linejoin","round"),N.each(function(){var j=g.select(this).selectAll("g.slice").data(B);j.enter().append("g").classed("slice",!0),j.exit().remove();var J=[[[],[]],[[],[]]],X=!1;j.each(function(_e,Te){if(_e.hidden)g.select(this).selectAll("path,g").remove();else{_e.pointNumber=_e.i,_e.curveNumber=te.index,J[_e.pxmid[1]<0?0:1][_e.pxmid[0]<0?0:1].push(_e);var we=U.cx,Oe=U.cy,fe=g.select(this),ve=fe.selectAll("path.surface").data([_e]);if(ve.enter().append("path").classed("surface",!0).style({"pointer-events":"all"}),fe.call(p,W,B),te.pull){var Ae=+f.castOption(te.pull,_e.pts)||0;Ae>0&&(we+=Ae*_e.pxmid[0],Oe+=Ae*_e.pxmid[1])}_e.cxFinal=we,_e.cyFinal=Oe;var ke=te.hole;if(_e.v===U.vTotal){var Pe="M"+(we+_e.px0[0])+","+(Oe+_e.px0[1])+Se(_e.px0,_e.pxmid,!0,1)+Se(_e.pxmid,_e.px0,!0,1)+"Z";ve.attr("d",ke?"M"+(we+ke*_e.px0[0])+","+(Oe+ke*_e.px0[1])+Se(_e.px0,_e.pxmid,!1,ke)+Se(_e.pxmid,_e.px0,!1,ke)+"Z"+Pe:Pe)}else{var Ne=Se(_e.px0,_e.px1,!0,1);if(ke){var De=1-ke;ve.attr("d","M"+(we+ke*_e.px1[0])+","+(Oe+ke*_e.px1[1])+Se(_e.px1,_e.px0,!1,ke)+"l"+De*_e.px0[0]+","+De*_e.px0[1]+Ne+"Z")}else ve.attr("d","M"+we+","+Oe+"l"+_e.px0[0]+","+_e.px0[1]+Ne+"Z")}q(W,_e,U);var ze=f.castOption(te.textposition,_e.pts),Me=fe.selectAll("g.slicetext").data(_e.text&&"none"!==ze?[0]:[]);Me.enter().append("g").classed("slicetext",!0),Me.exit().remove(),Me.each(function(){var tt,Ke,mt,Ie=n.ensureSingle(g.select(this),"text","",function(tt){tt.attr("data-notex",1)}),Fe=n.ensureUniformFontSize(W,"outside"===ze?(mt=G.font,{color:f.castOption((tt=te).outsidetextfont.color,(Ke=_e).pts)||f.castOption(tt.textfont.color,Ke.pts)||mt.color,family:f.castOption(tt.outsidetextfont.family,Ke.pts)||f.castOption(tt.textfont.family,Ke.pts)||mt.family,size:f.castOption(tt.outsidetextfont.size,Ke.pts)||f.castOption(tt.textfont.size,Ke.pts)||mt.size}):o(te,_e,G.font));Ie.text(_e.text).attr({class:"slicetext",transform:"","text-anchor":"middle"}).call(e.font,Fe).call(r.convertToTspans,W);var Re,Xe=e.bBox(Ie.node());if("outside"===ze)Re=I(Xe,_e);else if(Re=l(Xe,_e,U),"auto"===ze&&Re.scale<1){var nt=n.ensureUniformFontSize(W,te.outsidetextfont);Ie.call(e.font,nt),Re=I(Xe=e.bBox(Ie.node()),_e)}var ct=Re.textPosAngle,xt=void 0===ct?_e.pxmid:R(U.r,ct);if(Re.targetX=we+xt[0]*Re.rCenter+(Re.x||0),Re.targetY=Oe+xt[1]*Re.rCenter+(Re.y||0),V(Re,Xe),Re.outside){var dt=Re.targetY;_e.yLabelMin=dt-Xe.height/2,_e.yLabelMid=dt,_e.yLabelMax=dt+Xe.height/2,_e.labelExtraX=0,_e.labelExtraY=0,X=!0}Re.fontSize=Fe.size,s(te.type,Re,G),B[Te].transform=Re,Ie.attr("transform",n.getTextTransform(Re))})}function Se(Ie,Fe,Re,Xe){return"a"+Xe*U.r+","+Xe*U.r+" 0 "+_e.largeArc+(Re?" 1 ":" 0 ")+Xe*(Fe[0]-Ie[0])+","+Xe*(Fe[1]-Ie[1])}});var Te,re=g.select(this).selectAll("g.titletext").data(te.title.text?[0]:[]);if(re.enter().append("g").classed("titletext",!0),re.exit().remove(),re.each(function(){var _e,Oe,fe,Te=n.ensureSingle(g.select(this),"text","",function(Oe){Oe.attr("data-notex",1)}),we=te.title.text;te._meta&&(we=n.templateString(we,te._meta)),Te.text(we).attr({class:"titletext",transform:"","text-anchor":"middle"}).call(e.font,te.title.font).call(r.convertToTspans,W),_e="middle center"===te.title.position?(Oe=U,fe=Math.sqrt(Oe.titleBox.width*Oe.titleBox.width+Oe.titleBox.height*Oe.titleBox.height),{x:Oe.cx,y:Oe.cy,scale:Oe.trace.hole*Oe.r*2/fe,tx:0,ty:-Oe.titleBox.height/2+Oe.trace.title.font.size}):P(U,Y),Te.attr("transform",a(_e.x,_e.y)+t(Math.min(1,_e.scale))+a(_e.tx,_e.ty))}),X&&function(_e,Te){var we,Oe,fe,ve,Ae,ke,Pe,Ne,De,ze,Me,Se,Ie;function Fe(ct,xt){return ct.pxmid[1]-xt.pxmid[1]}function Re(ct,xt){return xt.pxmid[1]-ct.pxmid[1]}function Xe(ct,xt){xt||(xt={});var dt,tt,Ke,mt,Bt=xt.labelExtraY+(Oe?xt.yLabelMax:xt.yLabelMin),Ut=Oe?ct.yLabelMin:ct.yLabelMax,er=Oe?ct.yLabelMax:ct.yLabelMin,Wt=ct.cyFinal+Ae(ct.px0[1],ct.px1[1]),rr=Bt-Ut;if(rr*Pe>0&&(ct.labelExtraY=rr),Array.isArray(Te.pull))for(tt=0;tt<ze.length;tt++)(Ke=ze[tt])===ct||(f.castOption(Te.pull,ct.pts)||0)>=(f.castOption(Te.pull,Ke.pts)||0)||((ct.pxmid[1]-Ke.pxmid[1])*Pe>0?(rr=Ke.cyFinal+Ae(Ke.px0[1],Ke.px1[1])-Ut-ct.labelExtraY)*Pe>0&&(ct.labelExtraY+=rr):(er+ct.labelExtraY-Wt)*Pe>0&&(dt=3*ke*Math.abs(tt-ze.indexOf(ct)),(mt=Ke.cxFinal+ve(Ke.px0[0],Ke.px1[0])+dt-(ct.cxFinal+ct.pxmid[0])-ct.labelExtraX)*ke>0&&(ct.labelExtraX+=mt)))}for(Oe=0;Oe<2;Oe++)for(fe=Oe?Fe:Re,Ae=Oe?Math.max:Math.min,Pe=Oe?1:-1,we=0;we<2;we++){for(ve=we?Math.max:Math.min,ke=we?1:-1,(Ne=_e[Oe][we]).sort(fe),ze=(De=_e[1-Oe][we]).concat(Ne),Se=[],Me=0;Me<Ne.length;Me++)void 0!==Ne[Me].yLabelMid&&Se.push(Ne[Me]);for(Ie=!1,Me=0;Oe&&Me<De.length;Me++)if(void 0!==De[Me].yLabelMid){Ie=De[Me];break}for(Me=0;Me<Se.length;Me++){var nt=Me&&Se[Me-1];Ie&&!Me&&(nt=Ie),Xe(Se[Me],nt)}}}(J,te),Te=te,j.each(function(we){var Oe=g.select(this);if(we.labelExtraX||we.labelExtraY){var fe=Oe.select("g.slicetext text");we.transform.targetX+=we.labelExtraX,we.transform.targetY+=we.labelExtraY,fe.attr("transform",n.getTextTransform(we.transform));var ve=we.cxFinal+we.pxmid[0],Ae="M"+ve+","+(we.cyFinal+we.pxmid[1]),ke=(we.yLabelMax-we.yLabelMin)*(we.pxmid[0]<0?-1:1)/4;if(we.labelExtraX){var Pe=we.labelExtraX*we.pxmid[1]/we.pxmid[0],Ne=we.yLabelMid+we.labelExtraY-(we.cyFinal+we.pxmid[1]);Math.abs(Pe)>Math.abs(Ne)?Ae+="l"+Ne*we.pxmid[0]/we.pxmid[1]+","+Ne+"H"+(ve+we.labelExtraX+ke):Ae+="l"+we.labelExtraX+","+Pe+"v"+(Ne-Pe)+"h"+ke}else Ae+="V"+(we.yLabelMid+we.labelExtraY)+"h"+ke;n.ensureSingle(Oe,"path","textline").call(x.stroke,Te.outsidetextfont.color).attr({"stroke-width":Math.min(2,Te.outsidetextfont.size/8),d:Ae,fill:"none"})}else Oe.select("path.textline").remove()}),X&&te.automargin){var ne=e.bBox(N.node()),le=te.domain,se=(Y.w*(le.x[1]-le.x[0])*.5-U.r)/Y.w,ge=(Y.h*(le.y[1]-le.y[0])*.5-U.r)/Y.h;v.autoMargin(W,"pie."+te.uid+".automargin",{xl:le.x[0]-se,xr:le.x[1]+se,yb:le.y[0]-ge,yt:le.y[1]+ge,l:Math.max(U.cx-U.r-ne.left,0),r:Math.max(ne.right-(U.cx+U.r),0),b:Math.max(ne.bottom-(U.cy+U.r),0),t:Math.max(U.cy-U.r-ne.top,0),pad:5})}})});setTimeout(function(){$.selectAll("tspan").each(function(){var B=g.select(this);B.attr("dy")&&B.attr("dy",B.attr("dy"))})},0)},formatSliceLabel:q,transformInsideText:l,determineInsideTextFont:o,positionTitleOutside:P,prerenderTitles:b,layoutAreas:z,attachFxHandlers:p,computeTransform:V}},{"../../components/color":367,"../../components/drawing":389,"../../components/fx":407,"../../lib":515,"../../lib/svg_text_utils":541,"../../plots/plots":628,"../bar/constants":659,"../bar/uniform_text":673,"./event_data":914,"./helpers":915,"@plotly/d3":58}],920:[function(y,ee,Q){"use strict";var g=y("@plotly/d3"),v=y("./style_one"),m=y("../bar/uniform_text").resizeText;ee.exports=function(x){var e=x._fullLayout._pielayer.selectAll(".trace");m(x,e,"pie"),e.each(function(n){var t=n[0].trace,a=g.select(this);a.style({opacity:t.opacity}),a.selectAll("path.surface").each(function(r){g.select(this).call(v,r,t)})})}},{"../bar/uniform_text":673,"./style_one":921,"@plotly/d3":58}],921:[function(y,ee,Q){"use strict";var g=y("../../components/color"),v=y("./helpers").castOption;ee.exports=function(m,x,e){var n=e.marker.line,t=v(n.color,x.pts)||g.defaultLine,a=v(n.width,x.pts)||0;m.style("stroke-width",a).call(g.fill,x.color).call(g.stroke,t)}},{"../../components/color":367,"./helpers":915}],922:[function(y,ee,Q){"use strict";var g=y("../scatter/attributes");ee.exports={x:g.x,y:g.y,xy:{valType:"data_array",editType:"calc"},indices:{valType:"data_array",editType:"calc"},xbounds:{valType:"data_array",editType:"calc"},ybounds:{valType:"data_array",editType:"calc"},text:g.text,marker:{color:{valType:"color",arrayOk:!1,editType:"calc"},opacity:{valType:"number",min:0,max:1,dflt:1,arrayOk:!1,editType:"calc"},blend:{valType:"boolean",dflt:null,editType:"calc"},sizemin:{valType:"number",min:.1,max:2,dflt:.5,editType:"calc"},sizemax:{valType:"number",min:.1,dflt:20,editType:"calc"},border:{color:{valType:"color",arrayOk:!1,editType:"calc"},arearatio:{valType:"number",min:0,max:1,dflt:0,editType:"calc"},editType:"calc"},editType:"calc"},transforms:void 0}},{"../scatter/attributes":936}],923:[function(y,ee,Q){"use strict";var g=y("../../../stackgl_modules").gl_pointcloud2d,v=y("../../lib/str2rgbarray"),m=y("../../plots/cartesian/autorange").findExtremes,x=y("../scatter/get_trace_color");function e(t,a){this.scene=t,this.uid=a,this.type="pointcloud",this.pickXData=[],this.pickYData=[],this.xData=[],this.yData=[],this.textLabels=[],this.color="rgb(0, 0, 0)",this.name="",this.hoverinfo="all",this.idToIndex=new Int32Array(0),this.bounds=[0,0,0,0],this.pointcloudOptions={positions:new Float32Array(0),idToIndex:this.idToIndex,sizemin:.5,sizemax:12,color:[0,0,0,1],areaRatio:1,borderColor:[0,0,0,1]},this.pointcloud=g(t.glplot,this.pointcloudOptions),this.pointcloud._trace=this}var n=e.prototype;n.handlePick=function(t){var a=this.idToIndex[t.pointId];return{trace:this,dataCoord:t.dataCoord,traceCoord:this.pickXYData?[this.pickXYData[2*a],this.pickXYData[2*a+1]]:[this.pickXData[a],this.pickYData[a]],textLabel:Array.isArray(this.textLabels)?this.textLabels[a]:this.textLabels,color:this.color,name:this.name,pointIndex:a,hoverinfo:this.hoverinfo}},n.update=function(t){this.index=t.index,this.textLabels=t.text,this.name=t.name,this.hoverinfo=t.hoverinfo,this.bounds=[1/0,1/0,-1/0,-1/0],this.updateFast(t),this.color=x(t,{})},n.updateFast=function(t){var a,r,d,s,i,u,f=this.xData=this.pickXData=t.x,c=this.yData=this.pickYData=t.y,h=this.pickXYData=t.xy,o=t.indices,b=this.bounds;if(h){if(d=h,a=h.length>>>1,t.xbounds&&t.ybounds)b[0]=t.xbounds[0],b[2]=t.xbounds[1],b[1]=t.ybounds[0],b[3]=t.ybounds[1];else for(u=0;u<a;u++)i=d[2*u+1],(s=d[2*u])<b[0]&&(b[0]=s),s>b[2]&&(b[2]=s),i<b[1]&&(b[1]=i),i>b[3]&&(b[3]=i);if(o)r=o;else for(r=new Int32Array(a),u=0;u<a;u++)r[u]=u}else for(a=f.length,d=new Float32Array(2*a),r=new Int32Array(a),u=0;u<a;u++)s=f[u],i=c[u],r[u]=u,d[2*u]=s,d[2*u+1]=i,s<b[0]&&(b[0]=s),s>b[2]&&(b[2]=s),i<b[1]&&(b[1]=i),i>b[3]&&(b[3]=i);this.idToIndex=r,this.pointcloudOptions.idToIndex=r,this.pointcloudOptions.positions=d;var l=v(t.marker.color),T=v(t.marker.border.color),_=t.opacity*t.marker.opacity;l[3]*=_,this.pointcloudOptions.color=l;var w=t.marker.blend;null===w&&(w=f.length<100||c.length<100),this.pointcloudOptions.blend=w,T[3]*=_,this.pointcloudOptions.borderColor=T;var k=t.marker.sizemin,L=Math.max(t.marker.sizemax,t.marker.sizemin);this.pointcloudOptions.sizeMin=k,this.pointcloudOptions.sizeMax=L,this.pointcloudOptions.areaRatio=t.marker.border.arearatio,this.pointcloud.update(this.pointcloudOptions);var M=this.scene.xaxis,I=this.scene.yaxis,P=L/2||.5;t._extremes[M._id]=m(M,[b[0],b[2]],{ppad:P}),t._extremes[I._id]=m(I,[b[1],b[3]],{ppad:P})},n.dispose=function(){this.pointcloud.dispose()},ee.exports=function(t,a){var r=new e(t,a.uid);return r.update(a),r}},{"../../../stackgl_modules":1133,"../../lib/str2rgbarray":540,"../../plots/cartesian/autorange":565,"../scatter/get_trace_color":946}],924:[function(y,ee,Q){"use strict";var g=y("../../lib"),v=y("./attributes");ee.exports=function(m,x,e){function n(t,a){return g.coerce(m,x,v,t,a)}n("x"),n("y"),n("xbounds"),n("ybounds"),m.xy&&m.xy instanceof Float32Array&&(x.xy=m.xy),m.indices&&m.indices instanceof Int32Array&&(x.indices=m.indices),n("text"),n("marker.color",e),n("marker.opacity"),n("marker.blend"),n("marker.sizemin"),n("marker.sizemax"),n("marker.border.color",e),n("marker.border.arearatio"),x._length=null}},{"../../lib":515,"./attributes":922}],925:[function(y,ee,Q){"use strict";["*pointcloud* trace is deprecated!","Please consider switching to the *scattergl* trace type."].join(" "),ee.exports={attributes:y("./attributes"),supplyDefaults:y("./defaults"),calc:y("../scatter3d/calc"),plot:y("./convert"),moduleType:"trace",name:"pointcloud",basePlotModule:y("../../plots/gl2d"),categories:["gl","gl2d","showLegend"],meta:{}}},{"../../plots/gl2d":605,"../scatter3d/calc":965,"./attributes":922,"./convert":923,"./defaults":924}],926:[function(y,ee,Q){"use strict";var g=y("../../plots/font_attributes"),v=y("../../plots/attributes"),m=y("../../components/color/attributes"),x=y("../../components/fx/attributes"),e=y("../../plots/domain").attributes,n=y("../../plots/template_attributes").hovertemplateAttrs,t=y("../../components/colorscale/attributes"),a=y("../../plot_api/plot_template").templatedArray,r=y("../../plots/cartesian/axis_format_attributes").descriptionOnlyNumbers,d=y("../../lib/extend").extendFlat,s=y("../../plot_api/edit_types").overrideAll;(ee.exports=s({hoverinfo:d({},v.hoverinfo,{flags:[],arrayOk:!1}),hoverlabel:x.hoverlabel,domain:e({name:"sankey",trace:!0}),orientation:{valType:"enumerated",values:["v","h"],dflt:"h"},valueformat:{valType:"string",dflt:".3s",description:r("value")},valuesuffix:{valType:"string",dflt:""},arrangement:{valType:"enumerated",values:["snap","perpendicular","freeform","fixed"],dflt:"snap"},textfont:g({}),customdata:void 0,node:{label:{valType:"data_array",dflt:[]},groups:{valType:"info_array",impliedEdits:{x:[],y:[]},dimensions:2,freeLength:!0,dflt:[],items:{valType:"number",editType:"calc"}},x:{valType:"data_array",dflt:[]},y:{valType:"data_array",dflt:[]},color:{valType:"color",arrayOk:!0},customdata:{valType:"data_array",editType:"calc"},line:{color:{valType:"color",dflt:m.defaultLine,arrayOk:!0},width:{valType:"number",min:0,dflt:.5,arrayOk:!0}},pad:{valType:"number",arrayOk:!1,min:0,dflt:20},thickness:{valType:"number",arrayOk:!1,min:1,dflt:20},hoverinfo:{valType:"enumerated",values:["all","none","skip"],dflt:"all"},hoverlabel:x.hoverlabel,hovertemplate:n({},{keys:["value","label"]})},link:{label:{valType:"data_array",dflt:[]},color:{valType:"color",arrayOk:!0},customdata:{valType:"data_array",editType:"calc"},line:{color:{valType:"color",dflt:m.defaultLine,arrayOk:!0},width:{valType:"number",min:0,dflt:0,arrayOk:!0}},source:{valType:"data_array",dflt:[]},target:{valType:"data_array",dflt:[]},value:{valType:"data_array",dflt:[]},hoverinfo:{valType:"enumerated",values:["all","none","skip"],dflt:"all"},hoverlabel:x.hoverlabel,hovertemplate:n({},{keys:["value","label"]}),colorscales:a("concentrationscales",{editType:"calc",label:{valType:"string",editType:"calc",dflt:""},cmax:{valType:"number",editType:"calc",dflt:1},cmin:{valType:"number",editType:"calc",dflt:0},colorscale:d(t().colorscale,{dflt:[[0,"white"],[1,"black"]]})})}},"calc","nested")).transforms=void 0},{"../../components/color/attributes":366,"../../components/colorscale/attributes":374,"../../components/fx/attributes":398,"../../lib/extend":505,"../../plot_api/edit_types":548,"../../plot_api/plot_template":555,"../../plots/attributes":562,"../../plots/cartesian/axis_format_attributes":569,"../../plots/domain":593,"../../plots/font_attributes":594,"../../plots/template_attributes":642}],927:[function(y,ee,Q){"use strict";var g=y("../../plot_api/edit_types").overrideAll,v=y("../../plots/get_data").getModuleCalcData,m=y("./plot"),x=y("../../components/fx/layout_attributes"),e=y("../../lib/setcursor"),n=y("../../components/dragelement"),t=y("../../components/selections").prepSelect,a=y("../../lib"),r=y("../../registry");function d(s,i){var u=s._fullData[i],f=s._fullLayout,c=f.dragmode,p=u._bgRect;if(p&&"pan"!==c&&"zoom"!==c){e(p,"pan"===f.dragmode?"move":"crosshair");var o={_id:"x",c2p:a.identity,_offset:u._sankey.translateX,_length:u._sankey.width},b={_id:"y",c2p:a.identity,_offset:u._sankey.translateY,_length:u._sankey.height},l={gd:s,element:p.node(),plotinfo:{id:i,xaxis:o,yaxis:b,fillRangeItems:a.noop},subplot:i,xaxes:[o],yaxes:[b],doneFnCompleted:function(T){var _,w=s._fullData[i],k=w.node.groups.slice(),L=[];function M(E){for(var z=w._sankey.graph.nodes,R=0;R<z.length;R++)if(z[R].pointNumber===E)return z[R]}for(var I=0;I<T.length;I++){var P=M(T[I].pointNumber);if(P)if(P.group){for(var S=0;S<P.childrenNodes.length;S++)L.push(P.childrenNodes[S].pointNumber);k[P.pointNumber-w.node._count]=!1}else L.push(P.pointNumber)}_=k.filter(Boolean).concat([L]),r.call("_guiRestyle",s,{"node.groups":[_]},i)},prepFn:function(T,_,w){t(T,_,w,l,c)}};n.init(l)}}Q.name="sankey",Q.baseLayoutAttrOverrides=g({hoverlabel:x.hoverlabel},"plot","nested"),Q.plot=function(s){var i=v(s.calcdata,"sankey")[0];m(s,i),Q.updateFx(s)},Q.clean=function(s,i,u,f){var c=f._has&&f._has("sankey"),h=i._has&&i._has("sankey");c&&!h&&(f._paperdiv.selectAll(".sankey").remove(),f._paperdiv.selectAll(".bgsankey").remove())},Q.updateFx=function(s){for(var i=0;i<s._fullData.length;i++)d(s,i)}},{"../../components/dragelement":386,"../../components/fx/layout_attributes":408,"../../components/selections":455,"../../lib":515,"../../lib/setcursor":536,"../../plot_api/edit_types":548,"../../plots/get_data":602,"../../registry":647,"./plot":932}],928:[function(y,ee,Q){"use strict";var g=y("strongly-connected-components"),v=y("../../lib"),m=y("../../lib/gup").wrap,x=v.isArrayOrTypedArray,e=v.isIndex,n=y("../../components/colorscale");ee.exports=function(a,r){var d=function t(a){var r,d=a.node,s=a.link,i=[],u=x(s.color),f=x(s.customdata),c={},h={},p=s.colorscales.length;for(r=0;r<p;r++){var o=s.colorscales[r],b=n.extractScale(o,{cLetter:"c"}),l=n.makeColorScaleFunc(b);h[o.label]=l}var T=0;for(r=0;r<s.value.length;r++)s.source[r]>T&&(T=s.source[r]),s.target[r]>T&&(T=s.target[r]);var _,w=T+1;a.node._count=w;var k=a.node.groups,L={};for(r=0;r<k.length;r++){var M=k[r];for(_=0;_<M.length;_++){var I=M[_],P=w+r;L.hasOwnProperty(I)?v.warn("Node "+I+" is already part of a group."):L[I]=P}}var S={source:[],target:[]};for(r=0;r<s.value.length;r++){var E=s.value[r],z=s.source[r],R=s.target[r];if(E>0&&e(z,w)&&e(R,w)&&(!L.hasOwnProperty(z)||!L.hasOwnProperty(R)||L[z]!==L[R])){L.hasOwnProperty(R)&&(R=L[R]),L.hasOwnProperty(z)&&(z=L[z]),c[z=+z]=c[R=+R]=!0;var q="";s.label&&s.label[r]&&(q=s.label[r]);var V=null;q&&h.hasOwnProperty(q)&&(V=h[q]),i.push({pointNumber:r,label:q,color:u?s.color[r]:s.color,customdata:f?s.customdata[r]:s.customdata,concentrationscale:V,source:z,target:R,value:+E}),S.source.push(z),S.target.push(R)}}var W=w+k.length,K=x(d.color),G=x(d.customdata),Y=[];for(r=0;r<W;r++)c[r]&&Y.push({group:r>w-1,childrenNodes:[],pointNumber:r,label:d.label[r],color:K?d.color[r]:d.color,customdata:G?d.customdata[r]:d.customdata});var B=!1;return function(N,U,te){for(var j=v.init2dArray(N,0),J=0;J<Math.min(U.length,te.length);J++)if(v.isIndex(U[J],N)&&v.isIndex(te[J],N)){if(U[J]===te[J])return!0;j[U[J]].push(te[J])}return g(j).components.some(function(X){return X.length>1})}(W,S.source,S.target)&&(B=!0),{circular:B,links:i,nodes:Y,groups:k,groupLookup:L}}(r);return m({circular:d.circular,_nodes:d.nodes,_links:d.links,_groups:d.groups,_groupLookup:d.groupLookup})}},{"../../components/colorscale":379,"../../lib":515,"../../lib/gup":512,"strongly-connected-components":307}],929:[function(y,ee,Q){"use strict";ee.exports={nodeTextOffsetHorizontal:4,nodeTextOffsetVertical:3,nodePadAcross:10,sankeyIterations:50,forceIterations:5,forceTicksPerFrame:10,duration:500,ease:"linear",cn:{sankey:"sankey",sankeyLinks:"sankey-links",sankeyLink:"sankey-link",sankeyNodeSet:"sankey-node-set",sankeyNode:"sankey-node",nodeRect:"node-rect",nodeLabel:"node-label"}}},{}],930:[function(y,ee,Q){"use strict";var g=y("../../lib"),v=y("./attributes"),m=y("../../components/color"),x=y("tinycolor2"),e=y("../../plots/domain").defaults,n=y("../../components/fx/hoverlabel_defaults"),t=y("../../plot_api/plot_template"),a=y("../../plots/array_container_defaults");function r(d,s){function i(u,f){return g.coerce(d,s,v.link.colorscales,u,f)}i("label"),i("cmin"),i("cmax"),i("colorscale")}ee.exports=function(d,s,i,u){function f(L,M){return g.coerce(d,s,v,L,M)}var c=g.extendDeep(u.hoverlabel,d.hoverlabel),h=d.node,p=t.newContainer(s,"node");function o(L,M){return g.coerce(h,p,v.node,L,M)}o("label"),o("groups"),o("x"),o("y"),o("pad"),o("thickness"),o("line.color"),o("line.width"),o("hoverinfo",d.hoverinfo),n(h,p,o,c),o("hovertemplate");var b=u.colorway;o("color",p.label.map(function(L,M){return m.addOpacity(b[M%b.length],.8)})),o("customdata");var l=d.link||{},T=t.newContainer(s,"link");function _(L,M){return g.coerce(l,T,v.link,L,M)}_("label"),_("source"),_("target"),_("value"),_("line.color"),_("line.width"),_("hoverinfo",d.hoverinfo),n(l,T,_,c),_("hovertemplate");var w,k=x(u.paper_bgcolor).getLuminance()<.333?"rgba(255, 255, 255, 0.6)":"rgba(0, 0, 0, 0.2)";_("color",g.repeat(k,T.value.length)),_("customdata"),a(l,T,{name:"colorscales",handleItemDefaults:r}),e(s,u,f),f("orientation"),f("valueformat"),f("valuesuffix"),p.x.length&&p.y.length&&(w="freeform"),f("arrangement",w),g.coerceFont(f,"textfont",g.extendFlat({},u.font)),s._length=null}},{"../../components/color":367,"../../components/fx/hoverlabel_defaults":405,"../../lib":515,"../../plot_api/plot_template":555,"../../plots/array_container_defaults":561,"../../plots/domain":593,"./attributes":926,tinycolor2:313}],931:[function(y,ee,Q){"use strict";ee.exports={attributes:y("./attributes"),supplyDefaults:y("./defaults"),calc:y("./calc"),plot:y("./plot"),moduleType:"trace",name:"sankey",basePlotModule:y("./base_plot"),selectPoints:y("./select.js"),categories:["noOpacity"],meta:{}}},{"./attributes":926,"./base_plot":927,"./calc":928,"./defaults":930,"./plot":932,"./select.js":934}],932:[function(y,ee,Q){"use strict";var g=y("@plotly/d3"),v=y("../../lib"),m=v.numberFormat,x=y("./render"),e=y("../../components/fx"),n=y("../../components/color"),t=y("./constants").cn,a=v._;function r(l){return""!==l}function d(l,T){return l.filter(function(_){return _.key===T.traceId})}function s(l,T){g.select(l).select("path").style("fill-opacity",T),g.select(l).select("rect").style("fill-opacity",T)}function i(l){g.select(l).select("text.name").style("fill","black")}function u(l){return function(T){return-1!==l.node.sourceLinks.indexOf(T.link)||-1!==l.node.targetLinks.indexOf(T.link)}}function f(l){return function(T){return-1!==T.node.sourceLinks.indexOf(l.link)||-1!==T.node.targetLinks.indexOf(l.link)}}function c(l,T,_){T&&_&&d(_,T).selectAll("."+t.sankeyLink).filter(u(T)).call(p.bind(0,T,_,!1))}function h(l,T,_){T&&_&&d(_,T).selectAll("."+t.sankeyLink).filter(u(T)).call(o.bind(0,T,_,!1))}function p(l,T,_,w){var k=w.datum().link.label;w.style("fill-opacity",function(L){if(!L.link.concentrationscale)return.4}),k&&d(T,l).selectAll("."+t.sankeyLink).filter(function(L){return L.link.label===k}).style("fill-opacity",function(L){if(!L.link.concentrationscale)return.4}),_&&d(T,l).selectAll("."+t.sankeyNode).filter(f(l)).call(c)}function o(l,T,_,w){var k=w.datum().link.label;w.style("fill-opacity",function(L){return L.tinyColorAlpha}),k&&d(T,l).selectAll("."+t.sankeyLink).filter(function(L){return L.link.label===k}).style("fill-opacity",function(L){return L.tinyColorAlpha}),_&&d(T,l).selectAll(t.sankeyNode).filter(f(l)).call(h)}function b(l,T){var w=v.nestedProperty(l.hoverlabel||{},T).get();return!Array.isArray(w)&&w}ee.exports=function(l,T){for(var _=l._fullLayout,w=_._paper,k=_._size,L=0;L<l._fullData.length;L++)if(l._fullData[L].visible&&l._fullData[L].type===t.sankey&&!l._fullData[L]._viewInitial){var M=l._fullData[L].node;l._fullData[L]._viewInitial={node:{groups:M.groups.slice(),x:M.x.slice(),y:M.y.slice()}}}var I=a(l,"source:")+" ",P=a(l,"target:")+" ",S=a(l,"concentration:")+" ",E=a(l,"incoming flow count:")+" ",z=a(l,"outgoing flow count:")+" ";x(l,w,T,{width:k.w,height:k.h,margin:{t:k.t,r:k.r,b:k.b,l:k.l}},{linkEvents:{hover:function(R,q,V){!1!==l._fullLayout.hovermode&&(g.select(R).call(p.bind(0,q,V,!0)),"skip"!==q.link.trace.link.hoverinfo&&(q.link.fullData=q.link.trace,l.emit("plotly_hover",{event:g.event,points:[q.link]})))},follow:function(R,q){if(!1!==l._fullLayout.hovermode){var V=q.link.trace.link;if("none"!==V.hoverinfo&&"skip"!==V.hoverinfo){for(var W=[],K=0,G=0;G<q.flow.links.length;G++){var Y=q.flow.links[G];if("closest"!==l._fullLayout.hovermode||q.link.pointNumber===Y.pointNumber){q.link.pointNumber===Y.pointNumber&&(K=G),Y.fullData=Y.trace,V=q.link.trace.link;var $=N(Y),B={valueLabel:m(q.valueFormat)(Y.value)+q.valueSuffix};W.push({x:$[0],y:$[1],name:B.valueLabel,text:[Y.label||"",I+Y.source.label,P+Y.target.label,Y.concentrationscale?S+m("%0.2f")(Y.flow.labelConcentration):""].filter(r).join("<br>"),color:b(V,"bgcolor")||n.addOpacity(Y.color,1),borderColor:b(V,"bordercolor"),fontFamily:b(V,"font.family"),fontSize:b(V,"font.size"),fontColor:b(V,"font.color"),nameLength:b(V,"namelength"),textAlign:b(V,"align"),idealAlign:g.event.x<$[0]?"right":"left",hovertemplate:V.hovertemplate,hovertemplateLabels:B,eventData:[Y]})}}e.loneHover(W,{container:_._hoverlayer.node(),outerContainer:_._paper.node(),gd:l,anchorIndex:K}).each(function(){q.link.concentrationscale||s(this,.65),i(this)})}}function N(U){var te,j;U.circular?(te=(U.circularPathData.leftInnerExtent+U.circularPathData.rightInnerExtent)/2,j=U.circularPathData.verticalFullExtent):(te=(U.source.x1+U.target.x0)/2,j=(U.y0+U.y1)/2);var J=[te,j];return"v"===U.trace.orientation&&J.reverse(),J[0]+=q.parent.translateX,J[1]+=q.parent.translateY,J}},unhover:function(R,q,V){!1!==l._fullLayout.hovermode&&(g.select(R).call(o.bind(0,q,V,!0)),"skip"!==q.link.trace.link.hoverinfo&&(q.link.fullData=q.link.trace,l.emit("plotly_unhover",{event:g.event,points:[q.link]})),e.loneUnhover(_._hoverlayer.node()))},select:function(R,q){var V=q.link;V.originalEvent=g.event,l._hoverdata=[V],e.click(l,{target:!0})}},nodeEvents:{hover:function(R,q,V){!1!==l._fullLayout.hovermode&&(g.select(R).call(c,q,V),"skip"!==q.node.trace.node.hoverinfo&&(q.node.fullData=q.node.trace,l.emit("plotly_hover",{event:g.event,points:[q.node]})))},follow:function(R,q){if(!1!==l._fullLayout.hovermode){var V=q.node.trace.node;if("none"!==V.hoverinfo&&"skip"!==V.hoverinfo){var W=g.select(R).select("."+t.nodeRect),K=l._fullLayout._paperdiv.node().getBoundingClientRect(),G=W.node().getBoundingClientRect(),Y=G.left-2-K.left,$=G.right+2-K.left,B=G.top+G.height/4-K.top,N={valueLabel:m(q.valueFormat)(q.node.value)+q.valueSuffix};q.node.fullData=q.node.trace,l._fullLayout._calcInverseTransform(l);var U=l._fullLayout._invScaleX,j=e.loneHover({x0:U*Y,x1:U*$,y:l._fullLayout._invScaleY*B,name:m(q.valueFormat)(q.node.value)+q.valueSuffix,text:[q.node.label,E+q.node.targetLinks.length,z+q.node.sourceLinks.length].filter(r).join("<br>"),color:b(V,"bgcolor")||q.tinyColorHue,borderColor:b(V,"bordercolor"),fontFamily:b(V,"font.family"),fontSize:b(V,"font.size"),fontColor:b(V,"font.color"),nameLength:b(V,"namelength"),textAlign:b(V,"align"),idealAlign:"left",hovertemplate:V.hovertemplate,hovertemplateLabels:N,eventData:[q.node]},{container:_._hoverlayer.node(),outerContainer:_._paper.node(),gd:l});s(j,.85),i(j)}}},unhover:function(R,q,V){!1!==l._fullLayout.hovermode&&(g.select(R).call(h,q,V),"skip"!==q.node.trace.node.hoverinfo&&(q.node.fullData=q.node.trace,l.emit("plotly_unhover",{event:g.event,points:[q.node]})),e.loneUnhover(_._hoverlayer.node()))},select:function(R,q,V){var W=q.node;W.originalEvent=g.event,l._hoverdata=[W],g.select(R).call(h,q,V),e.click(l,{target:!0})}}})}},{"../../components/color":367,"../../components/fx":407,"../../lib":515,"./constants":929,"./render":933,"@plotly/d3":58}],933:[function(y,ee,Q){"use strict";var g=y("d3-force"),v=y("d3-interpolate").interpolateNumber,m=y("@plotly/d3"),x=y("@plotly/d3-sankey"),e=y("@plotly/d3-sankey-circular"),n=y("./constants"),t=y("tinycolor2"),a=y("../../components/color"),r=y("../../components/drawing"),d=y("../../lib"),s=d.strTranslate,i=d.strRotate,u=y("../../lib/gup"),f=u.keyFun,c=u.repeat,h=u.unwrap,p=y("../../lib/svg_text_utils"),o=y("../../registry"),b=y("../../constants/alignment"),l=b.CAP_SHIFT,T=b.LINE_SPACING;function _(G,Y,$){var B,N=h(Y),U=N.trace,te=U.domain,j="h"===U.orientation,J=U.node.pad,X=U.node.thickness,re=G.width*(te.x[1]-te.x[0]),ne=G.height*(te.y[1]-te.y[0]),le=N._nodes,oe=N._links,de=N.circular;(B=de?e.sankeyCircular().circularLinkGap(0):x.sankey()).iterations(n.sankeyIterations).size(j?[re,ne]:[ne,re]).nodeWidth(X).nodePadding(J).nodeId(function(Pe){return Pe.pointNumber}).nodes(le).links(oe);var se,ge,_e,Te=B();for(var we in B.nodePadding()<J&&d.warn("node.pad was reduced to ",B.nodePadding()," to fit within the figure."),N._groupLookup){var Oe,fe=parseInt(N._groupLookup[we]);for(se=0;se<Te.nodes.length;se++)if(Te.nodes[se].pointNumber===fe){Oe=Te.nodes[se];break}if(Oe){var ve={pointNumber:parseInt(we),x0:Oe.x0,x1:Oe.x1,y0:Oe.y0,y1:Oe.y1,partOfGroup:!0,sourceLinks:[],targetLinks:[]};Te.nodes.unshift(ve),Oe.childrenNodes.unshift(ve)}}if(function(){for(se=0;se<Te.nodes.length;se++){var Pe,Ne,De=Te.nodes[se],ze={};for(ge=0;ge<De.targetLinks.length;ge++)Pe=(Ne=De.targetLinks[ge]).source.pointNumber+":"+Ne.target.pointNumber,ze.hasOwnProperty(Pe)||(ze[Pe]=[]),ze[Pe].push(Ne);var Me=Object.keys(ze);for(ge=0;ge<Me.length;ge++){var Se=ze[Pe=Me[ge]],Ie=0,Fe={};for(_e=0;_e<Se.length;_e++)Fe[(Ne=Se[_e]).label]||(Fe[Ne.label]=0),Fe[Ne.label]+=Ne.value,Ie+=Ne.value;for(_e=0;_e<Se.length;_e++)(Ne=Se[_e]).flow={value:Ie,labelConcentration:Fe[Ne.label]/Ie,concentration:Ne.value/Ie,links:Se},Ne.concentrationscale&&(Ne.color=t(Ne.concentrationscale(Ne.flow.labelConcentration)))}var Re=0;for(ge=0;ge<De.sourceLinks.length;ge++)Re+=De.sourceLinks[ge].value;for(ge=0;ge<De.sourceLinks.length;ge++)(Ne=De.sourceLinks[ge]).concentrationOut=Ne.value/Re;var Xe=0;for(ge=0;ge<De.targetLinks.length;ge++)Xe+=De.targetLinks[ge].value;for(ge=0;ge<De.targetLinks.length;ge++)(Ne=De.targetLinks[ge]).concenrationIn=Ne.value/Xe}}(),U.node.x.length&&U.node.y.length){for(se=0;se<Math.min(U.node.x.length,U.node.y.length,Te.nodes.length);se++)if(U.node.x[se]&&U.node.y[se]){var Ae=[U.node.x[se]*re,U.node.y[se]*ne];Te.nodes[se].x0=Ae[0]-X/2,Te.nodes[se].x1=Ae[0]+X/2;var ke=Te.nodes[se].y1-Te.nodes[se].y0;Te.nodes[se].y0=Ae[1]-ke/2,Te.nodes[se].y1=Ae[1]+ke/2}"snap"===U.arrangement&&function(Pe){var Ne,De,ze=Pe.map(function(Re,Xe){return{x0:Re.x0,index:Xe}}).sort(function(Re,Xe){return Re.x0-Xe.x0}),Me=[],Se=-1,Ie=-1/0;for(se=0;se<ze.length;se++){var Fe=Pe[ze[se].index];Fe.x0>Ie+X&&(Se+=1,Ne=Fe.x0),Ie=Fe.x0,Me[Se]||(Me[Se]=[]),Me[Se].push(Fe),Fe.x0+=De=Ne-Fe.x0,Fe.x1+=De}return Me}(le=Te.nodes).forEach(function(Ne){var De,ze,Me,Se=0,Ie=Ne.length;for(Ne.sort(function(Fe,Re){return Fe.y0-Re.y0}),Me=0;Me<Ie;++Me)(De=Ne[Me]).y0>=Se||(ze=Se-De.y0)>1e-6&&(De.y0+=ze,De.y1+=ze),Se=De.y1+J}),B.update(Te)}return{circular:de,key:$,trace:U,guid:d.randstr(),horizontal:j,width:re,height:ne,nodePad:U.node.pad,nodeLineColor:U.node.line.color,nodeLineWidth:U.node.line.width,linkLineColor:U.link.line.color,linkLineWidth:U.link.line.width,valueFormat:U.valueformat,valueSuffix:U.valuesuffix,textFont:U.textfont,translateX:te.x[0]*G.width+G.margin.l,translateY:G.height-te.y[1]*G.height+G.margin.t,dragParallel:j?ne:re,dragPerpendicular:j?re:ne,arrangement:U.arrangement,sankey:B,graph:Te,forceLayouts:{},interactionState:{dragInProgress:!1,hovered:!1}}}function w(G,Y,$){var B=t(Y.color),N=Y.source.label+"|"+Y.target.label+"__"+$;return Y.trace=G.trace,Y.curveNumber=G.trace.index,{circular:G.circular,key:N,traceId:G.key,pointNumber:Y.pointNumber,link:Y,tinyColorHue:a.tinyRGB(B),tinyColorAlpha:B.getAlpha(),linkPath:k,linkLineColor:G.linkLineColor,linkLineWidth:G.linkLineWidth,valueFormat:G.valueFormat,valueSuffix:G.valueSuffix,sankey:G.sankey,parent:G,interactionState:G.interactionState,flow:Y.flow}}function k(){return function(G){if(G.link.circular)return $=(Y=G.link).width/2,B=Y.circularPathData,"top"===Y.circularLinkType?"M "+B.targetX+" "+(B.targetY+$)+" L"+B.rightInnerExtent+" "+(B.targetY+$)+"A"+(B.rightLargeArcRadius+$)+" "+(B.rightSmallArcRadius+$)+" 0 0 1 "+(B.rightFullExtent-$)+" "+(B.targetY-B.rightSmallArcRadius)+"L"+(B.rightFullExtent-$)+" "+B.verticalRightInnerExtent+"A"+(B.rightLargeArcRadius+$)+" "+(B.rightLargeArcRadius+$)+" 0 0 1 "+B.rightInnerExtent+" "+(B.verticalFullExtent-$)+"L"+B.leftInnerExtent+" "+(B.verticalFullExtent-$)+"A"+(B.leftLargeArcRadius+$)+" "+(B.leftLargeArcRadius+$)+" 0 0 1 "+(B.leftFullExtent+$)+" "+B.verticalLeftInnerExtent+"L"+(B.leftFullExtent+$)+" "+(B.sourceY-B.leftSmallArcRadius)+"A"+(B.leftLargeArcRadius+$)+" "+(B.leftSmallArcRadius+$)+" 0 0 1 "+B.leftInnerExtent+" "+(B.sourceY+$)+"L"+B.sourceX+" "+(B.sourceY+$)+"L"+B.sourceX+" "+(B.sourceY-$)+"L"+B.leftInnerExtent+" "+(B.sourceY-$)+"A"+(B.leftLargeArcRadius-$)+" "+(B.leftSmallArcRadius-$)+" 0 0 0 "+(B.leftFullExtent-$)+" "+(B.sourceY-B.leftSmallArcRadius)+"L"+(B.leftFullExtent-$)+" "+B.verticalLeftInnerExtent+"A"+(B.leftLargeArcRadius-$)+" "+(B.leftLargeArcRadius-$)+" 0 0 0 "+B.leftInnerExtent+" "+(B.verticalFullExtent+$)+"L"+B.rightInnerExtent+" "+(B.verticalFullExtent+$)+"A"+(B.rightLargeArcRadius-$)+" "+(B.rightLargeArcRadius-$)+" 0 0 0 "+(B.rightFullExtent+$)+" "+B.verticalRightInnerExtent+"L"+(B.rightFullExtent+$)+" "+(B.targetY-B.rightSmallArcRadius)+"A"+(B.rightLargeArcRadius-$)+" "+(B.rightSmallArcRadius-$)+" 0 0 0 "+B.rightInnerExtent+" "+(B.targetY-$)+"L"+B.targetX+" "+(B.targetY-$)+"Z":"M "+B.targetX+" "+(B.targetY-$)+" L"+B.rightInnerExtent+" "+(B.targetY-$)+"A"+(B.rightLargeArcRadius+$)+" "+(B.rightSmallArcRadius+$)+" 0 0 0 "+(B.rightFullExtent-$)+" "+(B.targetY+B.rightSmallArcRadius)+"L"+(B.rightFullExtent-$)+" "+B.verticalRightInnerExtent+"A"+(B.rightLargeArcRadius+$)+" "+(B.rightLargeArcRadius+$)+" 0 0 0 "+B.rightInnerExtent+" "+(B.verticalFullExtent+$)+"L"+B.leftInnerExtent+" "+(B.verticalFullExtent+$)+"A"+(B.leftLargeArcRadius+$)+" "+(B.leftLargeArcRadius+$)+" 0 0 0 "+(B.leftFullExtent+$)+" "+B.verticalLeftInnerExtent+"L"+(B.leftFullExtent+$)+" "+(B.sourceY+B.leftSmallArcRadius)+"A"+(B.leftLargeArcRadius+$)+" "+(B.leftSmallArcRadius+$)+" 0 0 0 "+B.leftInnerExtent+" "+(B.sourceY-$)+"L"+B.sourceX+" "+(B.sourceY-$)+"L"+B.sourceX+" "+(B.sourceY+$)+"L"+B.leftInnerExtent+" "+(B.sourceY+$)+"A"+(B.leftLargeArcRadius-$)+" "+(B.leftSmallArcRadius-$)+" 0 0 1 "+(B.leftFullExtent-$)+" "+(B.sourceY+B.leftSmallArcRadius)+"L"+(B.leftFullExtent-$)+" "+B.verticalLeftInnerExtent+"A"+(B.leftLargeArcRadius-$)+" "+(B.leftLargeArcRadius-$)+" 0 0 1 "+B.leftInnerExtent+" "+(B.verticalFullExtent-$)+"L"+B.rightInnerExtent+" "+(B.verticalFullExtent-$)+"A"+(B.rightLargeArcRadius-$)+" "+(B.rightLargeArcRadius-$)+" 0 0 1 "+(B.rightFullExtent+$)+" "+B.verticalRightInnerExtent+"L"+(B.rightFullExtent+$)+" "+(B.targetY+B.rightSmallArcRadius)+"A"+(B.rightLargeArcRadius-$)+" "+(B.rightSmallArcRadius-$)+" 0 0 1 "+B.rightInnerExtent+" "+(B.targetY+$)+"L"+B.targetX+" "+(B.targetY+$)+"Z";var Y,$,B,N=G.link.source.x1,U=G.link.target.x0,te=v(N,U),j=te(.5),J=te(.5),X=G.link.y0-G.link.width/2,re=G.link.y0+G.link.width/2,ne=G.link.y1-G.link.width/2,le=G.link.y1+G.link.width/2;return"M"+N+","+X+"C"+j+","+X+" "+J+","+ne+" "+U+","+ne+"L"+U+","+le+"C"+J+","+le+" "+j+","+re+" "+N+","+re+"Z"}}function L(G,Y){var $=t(Y.color),B=n.nodePadAcross,N=G.nodePad/2;Y.dx=Y.x1-Y.x0,Y.dy=Y.y1-Y.y0;var U=Y.dx,te=Math.max(.5,Y.dy),j="node_"+Y.pointNumber;return Y.group&&(j=d.randstr()),Y.trace=G.trace,Y.curveNumber=G.trace.index,{index:Y.pointNumber,key:j,partOfGroup:Y.partOfGroup||!1,group:Y.group,traceId:G.key,trace:G.trace,node:Y,nodePad:G.nodePad,nodeLineColor:G.nodeLineColor,nodeLineWidth:G.nodeLineWidth,textFont:G.textFont,size:G.horizontal?G.height:G.width,visibleWidth:Math.ceil(U),visibleHeight:te,zoneX:-B,zoneY:-N,zoneWidth:U+2*B,zoneHeight:te+2*N,labelY:G.horizontal?Y.dy/2+1:Y.dx/2+1,left:1===Y.originalLayer,sizeAcross:G.width,forceLayouts:G.forceLayouts,horizontal:G.horizontal,darkBackground:$.getBrightness()<=128,tinyColorHue:a.tinyRGB($),tinyColorAlpha:$.getAlpha(),valueFormat:G.valueFormat,valueSuffix:G.valueSuffix,sankey:G.sankey,graph:G.graph,arrangement:G.arrangement,uniqueNodeLabelPathId:[G.guid,G.key,j].join("_"),interactionState:G.interactionState,figure:G}}function M(G){G.attr("transform",function(Y){return s(Y.node.x0.toFixed(3),Y.node.y0.toFixed(3))})}function I(G){G.call(M)}function P(G,Y){G.call(I),Y.attr("d",k())}function S(G){G.attr("width",function(Y){return Y.node.x1-Y.node.x0}).attr("height",function(Y){return Y.visibleHeight})}function E(G){return G.link.width>1||G.linkLineWidth>0}function z(G){return s(G.translateX,G.translateY)+(G.horizontal?"matrix(1 0 0 1 0 0)":"matrix(0 1 1 0 0 0)")}function R(G,Y,$){G.on(".basic",null).on("mouseover.basic",function(B){B.interactionState.dragInProgress||B.partOfGroup||($.hover(this,B,Y),B.interactionState.hovered=[this,B])}).on("mousemove.basic",function(B){B.interactionState.dragInProgress||B.partOfGroup||($.follow(this,B),B.interactionState.hovered=[this,B])}).on("mouseout.basic",function(B){B.interactionState.dragInProgress||B.partOfGroup||($.unhover(this,B,Y),B.interactionState.hovered=!1)}).on("click.basic",function(B){B.interactionState.hovered&&($.unhover(this,B,Y),B.interactionState.hovered=!1),B.interactionState.dragInProgress||B.partOfGroup||$.select(this,B,Y)})}function q(G,Y,$,B){var N=m.behavior.drag().origin(function(U){return{x:U.node.x0+U.visibleWidth/2,y:U.node.y0+U.visibleHeight/2}}).on("dragstart",function(U){if("fixed"!==U.arrangement&&(d.ensureSingle(B._fullLayout._infolayer,"g","dragcover",function(j){B._fullLayout._dragCover=j}),d.raiseToTop(this),U.interactionState.dragInProgress=U.node,W(U.node),U.interactionState.hovered&&($.nodeEvents.unhover.apply(0,U.interactionState.hovered),U.interactionState.hovered=!1),"snap"===U.arrangement)){var te=U.traceId+"|"+U.key;U.forceLayouts[te]?U.forceLayouts[te].alpha(1):function(j,J,X,re){!function(le){for(var oe=0;oe<le.length;oe++)le[oe].y=(le[oe].y0+le[oe].y1)/2,le[oe].x=(le[oe].x0+le[oe].x1)/2}(X.graph.nodes);var oe,de,se,ne=X.graph.nodes.filter(function(le){return le.originalX===X.node.originalX}).filter(function(le){return!le.partOfGroup});X.forceLayouts[J]=g.forceSimulation(ne).alphaDecay(0).force("collide",g.forceCollide().radius(function(le){return le.dy/2+X.nodePad/2}).strength(1).iterations(n.forceIterations)).force("constrain",(oe=J,de=ne,se=X,function(){for(var ge=0,_e=0;_e<de.length;_e++){var Te=de[_e];Te===se.interactionState.dragInProgress?(Te.x=Te.lastDraggedX,Te.y=Te.lastDraggedY):(Te.vx=(Te.originalX-Te.x)/n.forceTicksPerFrame,Te.y=Math.min(se.size-Te.dy/2,Math.max(Te.dy/2,Te.y))),ge=Math.max(ge,Math.abs(Te.vx),Math.abs(Te.vy))}!se.interactionState.dragInProgress&&ge<.1&&se.forceLayouts[oe].alpha()>0&&se.forceLayouts[oe].alpha(0)})).stop()}(0,te,U),j=G,J=Y,X=U,re=te,ne=B,window.requestAnimationFrame(function le(){var oe;for(oe=0;oe<n.forceTicksPerFrame;oe++)X.forceLayouts[re].tick();if(function(se){for(var ge=0;ge<se.length;ge++)se[ge].y0=se[ge].y-se[ge].dy/2,se[ge].y1=se[ge].y0+se[ge].dy,se[ge].x0=se[ge].x-se[ge].dx/2,se[ge].x1=se[ge].x0+se[ge].dx}(X.graph.nodes),X.sankey.update(X.graph),P(j.filter(K(X)),J),X.forceLayouts[re].alpha()>0)window.requestAnimationFrame(le);else{var de=X.node.originalX;X.node.x0=de-X.visibleWidth/2,X.node.x1=de+X.visibleWidth/2,V(X,ne)}})}var j,J,X,re,ne}).on("drag",function(U){if("fixed"!==U.arrangement){var te=m.event.x,j=m.event.y;"snap"===U.arrangement?(U.node.x0=te-U.visibleWidth/2,U.node.x1=te+U.visibleWidth/2,U.node.y0=j-U.visibleHeight/2,U.node.y1=j+U.visibleHeight/2):("freeform"===U.arrangement&&(U.node.x0=te-U.visibleWidth/2,U.node.x1=te+U.visibleWidth/2),j=Math.max(0,Math.min(U.size-U.visibleHeight/2,j)),U.node.y0=j-U.visibleHeight/2,U.node.y1=j+U.visibleHeight/2),W(U.node),"snap"!==U.arrangement&&(U.sankey.update(U.graph),P(G.filter(K(U)),Y))}}).on("dragend",function(U){if("fixed"!==U.arrangement){U.interactionState.dragInProgress=!1;for(var te=0;te<U.node.childrenNodes.length;te++)U.node.childrenNodes[te].x=U.node.x,U.node.childrenNodes[te].y=U.node.y;"snap"!==U.arrangement&&V(U,B)}});G.on(".drag",null).call(N)}function V(G,Y){for(var $=[],B=[],N=0;N<G.graph.nodes.length;N++){var te=(G.graph.nodes[N].y0+G.graph.nodes[N].y1)/2;$.push((G.graph.nodes[N].x0+G.graph.nodes[N].x1)/2/G.figure.width),B.push(te/G.figure.height)}o.call("_guiRestyle",Y,{"node.x":[$],"node.y":[B]},G.trace.index).then(function(){Y._fullLayout._dragCover&&Y._fullLayout._dragCover.remove()})}function W(G){G.lastDraggedX=G.x0+G.dx/2,G.lastDraggedY=G.y0+G.dy/2}function K(G){return function(Y){return Y.node.originalX===G.node.originalX}}ee.exports=function(G,Y,$,B,N){var U=!1;d.ensureSingle(G._fullLayout._infolayer,"g","first-render",function(){U=!0});var te=G._fullLayout._dragCover,j=$.filter(function(se){return h(se).trace.visible}).map(_.bind(null,B)),J=Y.selectAll("."+n.cn.sankey).data(j,f);J.exit().remove(),J.enter().append("g").classed(n.cn.sankey,!0).style("box-sizing","content-box").style("position","absolute").style("left",0).style("shape-rendering","geometricPrecision").style("pointer-events","auto").attr("transform",z),J.each(function(se,ge){G._fullData[ge]._sankey=se;var _e="bgsankey-"+se.trace.uid+"-"+ge;d.ensureSingle(G._fullLayout._draggers,"rect",_e),G._fullData[ge]._bgRect=m.select("."+_e),G._fullData[ge]._bgRect.style("pointer-events","all").attr("width",se.width).attr("height",se.height).attr("x",se.translateX).attr("y",se.translateY).classed("bgsankey",!0).style({fill:"transparent","stroke-width":0})}),J.transition().ease(n.ease).duration(n.duration).attr("transform",z);var X=J.selectAll("."+n.cn.sankeyLinks).data(c,f);X.enter().append("g").classed(n.cn.sankeyLinks,!0).style("fill","none");var re=X.selectAll("."+n.cn.sankeyLink).data(function(se){return se.graph.links.filter(function(ge){return ge.value}).map(w.bind(null,se))},f);re.enter().append("path").classed(n.cn.sankeyLink,!0).call(R,J,N.linkEvents),re.style("stroke",function(se){return E(se)?a.tinyRGB(t(se.linkLineColor)):se.tinyColorHue}).style("stroke-opacity",function(se){return E(se)?a.opacity(se.linkLineColor):se.tinyColorAlpha}).style("fill",function(se){return se.tinyColorHue}).style("fill-opacity",function(se){return se.tinyColorAlpha}).style("stroke-width",function(se){return E(se)?se.linkLineWidth:1}).attr("d",k()),re.style("opacity",function(){return G._context.staticPlot||U||te?1:0}).transition().ease(n.ease).duration(n.duration).style("opacity",1),re.exit().transition().ease(n.ease).duration(n.duration).style("opacity",0).remove();var ne=J.selectAll("."+n.cn.sankeyNodeSet).data(c,f);ne.enter().append("g").classed(n.cn.sankeyNodeSet,!0),ne.style("cursor",function(se){switch(se.arrangement){case"fixed":return"default";case"perpendicular":return"ns-resize";default:return"move"}});var le=ne.selectAll("."+n.cn.sankeyNode).data(function(se){var ge=se.graph.nodes;return function(_e){var Te,we=[];for(Te=0;Te<_e.length;Te++)_e[Te].originalX=(_e[Te].x0+_e[Te].x1)/2,_e[Te].originalY=(_e[Te].y0+_e[Te].y1)/2,-1===we.indexOf(_e[Te].originalX)&&we.push(_e[Te].originalX);for(we.sort(function(Oe,fe){return Oe-fe}),Te=0;Te<_e.length;Te++)_e[Te].originalLayerIndex=we.indexOf(_e[Te].originalX),_e[Te].originalLayer=_e[Te].originalLayerIndex/(we.length-1)}(ge),ge.map(L.bind(null,se))},f);le.enter().append("g").classed(n.cn.sankeyNode,!0).call(M).style("opacity",function(se){return!G._context.staticPlot&&!U||se.partOfGroup?0:1}),le.call(R,J,N.nodeEvents).call(q,re,N,G),le.transition().ease(n.ease).duration(n.duration).call(M).style("opacity",function(se){return se.partOfGroup?0:1}),le.exit().transition().ease(n.ease).duration(n.duration).style("opacity",0).remove();var oe=le.selectAll("."+n.cn.nodeRect).data(c);oe.enter().append("rect").classed(n.cn.nodeRect,!0).call(S),oe.style("stroke-width",function(se){return se.nodeLineWidth}).style("stroke",function(se){return a.tinyRGB(t(se.nodeLineColor))}).style("stroke-opacity",function(se){return a.opacity(se.nodeLineColor)}).style("fill",function(se){return se.tinyColorHue}).style("fill-opacity",function(se){return se.tinyColorAlpha}),oe.transition().ease(n.ease).duration(n.duration).call(S);var de=le.selectAll("."+n.cn.nodeLabel).data(c);de.enter().append("text").classed(n.cn.nodeLabel,!0).style("cursor","default"),de.attr("data-notex",1).text(function(se){return se.node.label}).each(function(se){var ge=m.select(this);r.font(ge,se.textFont),p.convertToTspans(ge,G)}).style("text-shadow",p.makeTextShadow(G._fullLayout.paper_bgcolor)).attr("text-anchor",function(se){return se.horizontal&&se.left?"end":"start"}).attr("transform",function(se){var ge=m.select(this),_e=p.lineCount(ge),we=se.nodeLineWidth/2+3,Oe=((se.horizontal?se.visibleHeight:se.visibleWidth)-se.textFont.size*((_e-1)*T-l))/2;se.horizontal&&(se.left?we=-we:we+=se.visibleWidth);var fe=se.horizontal?"":"scale(-1,1)"+i(90);return s(se.horizontal?we:Oe,se.horizontal?Oe:we)+fe}),de.transition().ease(n.ease).duration(n.duration)}},{"../../components/color":367,"../../components/drawing":389,"../../constants/alignment":483,"../../lib":515,"../../lib/gup":512,"../../lib/svg_text_utils":541,"../../registry":647,"./constants":929,"@plotly/d3":58,"@plotly/d3-sankey":57,"@plotly/d3-sankey-circular":56,"d3-force":111,"d3-interpolate":116,tinycolor2:313}],934:[function(y,ee,Q){"use strict";ee.exports=function(g,v){for(var m=[],x=g.cd[0].trace,e=x._sankey.graph.nodes,n=0;n<e.length;n++){var t=e[n];if(!t.partOfGroup){var a=[(t.x0+t.x1)/2,(t.y0+t.y1)/2];"v"===x.orientation&&a.reverse(),v&&v.contains(a,!1,n,g)&&m.push({pointNumber:t.pointNumber})}}return m}},{}],935:[function(y,ee,Q){"use strict";var g=y("../../lib");ee.exports=function(v,m){for(var x=0;x<v.length;x++)v[x].i=x;g.mergeArray(m.text,v,"tx"),g.mergeArray(m.texttemplate,v,"txt"),g.mergeArray(m.hovertext,v,"htx"),g.mergeArray(m.customdata,v,"data"),g.mergeArray(m.textposition,v,"tp"),m.textfont&&(g.mergeArrayCastPositive(m.textfont.size,v,"ts"),g.mergeArray(m.textfont.color,v,"tc"),g.mergeArray(m.textfont.family,v,"tf"));var e=m.marker;if(e){g.mergeArrayCastPositive(e.size,v,"ms"),g.mergeArrayCastPositive(e.opacity,v,"mo"),g.mergeArray(e.symbol,v,"mx"),g.mergeArray(e.color,v,"mc");var n=e.line;e.line&&(g.mergeArray(n.color,v,"mlc"),g.mergeArrayCastPositive(n.width,v,"mlw"));var t=e.gradient;t&&"none"!==t.type&&(g.mergeArray(t.type,v,"mgt"),g.mergeArray(t.color,v,"mgc"))}}},{"../../lib":515}],936:[function(y,ee,Q){"use strict";var g=y("../../plots/cartesian/axis_format_attributes").axisHoverFormat,v=y("../../plots/template_attributes").texttemplateAttrs,m=y("../../plots/template_attributes").hovertemplateAttrs,x=y("../../components/colorscale/attributes"),e=y("../../plots/font_attributes"),n=y("../../components/drawing/attributes").dash,t=y("../../components/drawing/attributes").pattern,a=y("../../components/drawing"),r=y("./constants"),d=y("../../lib/extend").extendFlat;ee.exports={x:{valType:"data_array",editType:"calc+clearAxisTypes",anim:!0},x0:{valType:"any",dflt:0,editType:"calc+clearAxisTypes",anim:!0},dx:{valType:"number",dflt:1,editType:"calc",anim:!0},y:{valType:"data_array",editType:"calc+clearAxisTypes",anim:!0},y0:{valType:"any",dflt:0,editType:"calc+clearAxisTypes",anim:!0},dy:{valType:"number",dflt:1,editType:"calc",anim:!0},xperiod:{valType:"any",dflt:0,editType:"calc"},yperiod:{valType:"any",dflt:0,editType:"calc"},xperiod0:{valType:"any",editType:"calc"},yperiod0:{valType:"any",editType:"calc"},xperiodalignment:{valType:"enumerated",values:["start","middle","end"],dflt:"middle",editType:"calc"},yperiodalignment:{valType:"enumerated",values:["start","middle","end"],dflt:"middle",editType:"calc"},xhoverformat:g("x"),yhoverformat:g("y"),stackgroup:{valType:"string",dflt:"",editType:"calc"},orientation:{valType:"enumerated",values:["v","h"],editType:"calc"},groupnorm:{valType:"enumerated",values:["","fraction","percent"],dflt:"",editType:"calc"},stackgaps:{valType:"enumerated",values:["infer zero","interpolate"],dflt:"infer zero",editType:"calc"},text:{valType:"string",dflt:"",arrayOk:!0,editType:"calc"},texttemplate:v({},{}),hovertext:{valType:"string",dflt:"",arrayOk:!0,editType:"style"},mode:{valType:"flaglist",flags:["lines","markers","text"],extras:["none"],editType:"calc"},hoveron:{valType:"flaglist",flags:["points","fills"],editType:"style"},hovertemplate:m({},{keys:r.eventDataKeys}),line:{color:{valType:"color",editType:"style",anim:!0},width:{valType:"number",min:0,dflt:2,editType:"style",anim:!0},shape:{valType:"enumerated",values:["linear","spline","hv","vh","hvh","vhv"],dflt:"linear",editType:"plot"},smoothing:{valType:"number",min:0,max:1.3,dflt:1,editType:"plot"},dash:d({},n,{editType:"style"}),simplify:{valType:"boolean",dflt:!0,editType:"plot"},editType:"plot"},connectgaps:{valType:"boolean",dflt:!1,editType:"calc"},cliponaxis:{valType:"boolean",dflt:!0,editType:"plot"},fill:{valType:"enumerated",values:["none","tozeroy","tozerox","tonexty","tonextx","toself","tonext"],editType:"calc"},fillcolor:{valType:"color",editType:"style",anim:!0},fillpattern:t,marker:d({symbol:{valType:"enumerated",values:a.symbolList,dflt:"circle",arrayOk:!0,editType:"style"},opacity:{valType:"number",min:0,max:1,arrayOk:!0,editType:"style",anim:!0},size:{valType:"number",min:0,dflt:6,arrayOk:!0,editType:"calc",anim:!0},maxdisplayed:{valType:"number",min:0,dflt:0,editType:"plot"},sizeref:{valType:"number",dflt:1,editType:"calc"},sizemin:{valType:"number",min:0,dflt:0,editType:"calc"},sizemode:{valType:"enumerated",values:["diameter","area"],dflt:"diameter",editType:"calc"},line:d({width:{valType:"number",min:0,arrayOk:!0,editType:"style",anim:!0},editType:"calc"},x("marker.line",{anim:!0})),gradient:{type:{valType:"enumerated",values:["radial","horizontal","vertical","none"],arrayOk:!0,dflt:"none",editType:"calc"},color:{valType:"color",arrayOk:!0,editType:"calc"},editType:"calc"},editType:"calc"},x("marker",{anim:!0})),selected:{marker:{opacity:{valType:"number",min:0,max:1,editType:"style"},color:{valType:"color",editType:"style"},size:{valType:"number",min:0,editType:"style"},editType:"style"},textfont:{color:{valType:"color",editType:"style"},editType:"style"},editType:"style"},unselected:{marker:{opacity:{valType:"number",min:0,max:1,editType:"style"},color:{valType:"color",editType:"style"},size:{valType:"number",min:0,editType:"style"},editType:"style"},textfont:{color:{valType:"color",editType:"style"},editType:"style"},editType:"style"},textposition:{valType:"enumerated",values:["top left","top center","top right","middle left","middle center","middle right","bottom left","bottom center","bottom right"],dflt:"middle center",arrayOk:!0,editType:"calc"},textfont:e({editType:"calc",colorEditType:"style",arrayOk:!0})}},{"../../components/colorscale/attributes":374,"../../components/drawing":389,"../../components/drawing/attributes":388,"../../lib/extend":505,"../../plots/cartesian/axis_format_attributes":569,"../../plots/font_attributes":594,"../../plots/template_attributes":642,"./constants":940}],937:[function(y,ee,Q){"use strict";var g=y("fast-isnumeric"),v=y("../../lib"),m=y("../../plots/cartesian/axes"),x=y("../../plots/cartesian/align_period"),e=y("../../constants/numerical").BADNUM,n=y("./subtypes"),t=y("./colorscale_calc"),a=y("./arrays_to_calcdata"),r=y("./calc_selection");function d(c,h,p,o,b,l,T){var _=h._length,w=c._fullLayout,k=p._id,L=o._id,M=w._firstScatter[u(h)]===h.uid,I=(f(h,w,p,o)||{}).orientation,P=h.fill;p._minDtick=0,o._minDtick=0;var S={padded:!0},E={padded:!0};T&&(S.ppad=E.ppad=T);var z=_<2||b[0]!==b[_-1]||l[0]!==l[_-1];z&&("tozerox"===P||"tonextx"===P&&(M||"h"===I))?S.tozero=!0:(h.error_y||{}).visible||"tonexty"!==P&&"tozeroy"!==P&&(n.hasMarkers(h)||n.hasText(h))||(S.padded=!1,S.ppad=0),z&&("tozeroy"===P||"tonexty"===P&&(M||"v"===I))?E.tozero=!0:"tonextx"!==P&&"tozerox"!==P||(E.padded=!1),k&&(h._extremes[k]=m.findExtremes(p,b,S)),L&&(h._extremes[L]=m.findExtremes(o,l,E))}function s(c,h){if(n.hasMarkers(c)){var p,o=c.marker,b=1.6*(c.marker.sizeref||1);if(p="area"===c.marker.sizemode?function(k){return Math.max(Math.sqrt((k||0)/b),3)}:function(k){return Math.max((k||0)/b,3)},v.isArrayOrTypedArray(o.size)){var l={type:"linear"};m.setConvert(l);for(var T=l.makeCalcdata(c.marker,"size"),_=new Array(h),w=0;w<h;w++)_[w]=p(T[w]);return _}return p(o.size)}}function i(c,h){var p=u(h),o=c._firstScatter;o[p]||(o[p]=h.uid)}function u(c){var h=c.stackgroup;return c.xaxis+c.yaxis+c.type+(h?"-"+h:"")}function f(c,h,p,o){var b=c.stackgroup;if(b){var l=h._scatterStackOpts[p._id+o._id][b],T="v"===l.orientation?o:p;return"linear"===T.type||"log"===T.type?l:void 0}}ee.exports={calc:function(c,h){var p,o,b,l,T,_,w=c._fullLayout,k=m.getFromId(c,h.xaxis||"x"),L=m.getFromId(c,h.yaxis||"y"),M=k.makeCalcdata(h,"x"),I=L.makeCalcdata(h,"y"),P=x(h,k,"x",M),S=x(h,L,"y",I),E=P.vals,z=S.vals,R=h._length,q=new Array(R),V=h.ids,W=f(h,w,k,L),K=!1;i(w,h);var G,Y="x",$="y";W?(v.pushUnique(W.traceIndices,h._expandedIndex),(p="v"===W.orientation)?($="s",G="x"):(Y="s",G="y"),T="interpolate"===W.stackgaps):d(c,h,k,L,E,z,s(h,R));var B=!!h.xperiodalignment,N=!!h.yperiodalignment;for(o=0;o<R;o++){var U=q[o]={},te=g(E[o]),j=g(z[o]);te&&j?(U[Y]=E[o],U[$]=z[o],B&&(U.orig_x=M[o],U.xEnd=P.ends[o],U.xStart=P.starts[o]),N&&(U.orig_y=I[o],U.yEnd=S.ends[o],U.yStart=S.starts[o])):W&&(p?te:j)?(U[G]=p?E[o]:z[o],U.gap=!0,T?(U.s=e,K=!0):U.s=0):U[Y]=U[$]=e,V&&(U.id=String(V[o]))}if(a(q,h),t(c,h),r(q,h),W){for(o=0;o<q.length;)q[o][G]===e?q.splice(o,1):o++;if(v.sort(q,function(ne,le){return ne[G]-le[G]||ne.i-le.i}),K){for(o=0;o<q.length-1&&q[o].gap;)o++;for((_=q[o].s)||(_=q[o].s=0),b=0;b<o;b++)q[b].s=_;for(l=q.length-1;l>o&&q[l].gap;)l--;for(_=q[l].s,b=q.length-1;b>l;b--)q[b].s=_;for(;o<l;)if(q[++o].gap){for(b=o+1;q[b].gap;)b++;for(var J=q[o-1][G],X=q[o-1].s,re=(q[b].s-X)/(q[b][G]-J);o<b;)q[o].s=X+(q[o][G]-J)*re,o++}}}return q},calcMarkerSize:s,calcAxisExpansion:d,setFirstScatter:i,getStackOpts:f}},{"../../constants/numerical":491,"../../lib":515,"../../plots/cartesian/align_period":563,"../../plots/cartesian/axes":566,"./arrays_to_calcdata":935,"./calc_selection":938,"./colorscale_calc":939,"./subtypes":961,"fast-isnumeric":190}],938:[function(y,ee,Q){"use strict";var g=y("../../lib");ee.exports=function(v,m){g.isArrayOrTypedArray(m.selectedpoints)&&g.tagSelected(v,m)}},{"../../lib":515}],939:[function(y,ee,Q){"use strict";var g=y("../../components/colorscale/helpers").hasColorscale,v=y("../../components/colorscale/calc"),m=y("./subtypes");ee.exports=function(x,e){m.hasLines(e)&&g(e,"line")&&v(x,e,{vals:e.line.color,containerStr:"line",cLetter:"c"}),m.hasMarkers(e)&&(g(e,"marker")&&v(x,e,{vals:e.marker.color,containerStr:"marker",cLetter:"c"}),g(e,"marker.line")&&v(x,e,{vals:e.marker.line.color,containerStr:"marker.line",cLetter:"c"}))}},{"../../components/colorscale/calc":375,"../../components/colorscale/helpers":378,"./subtypes":961}],940:[function(y,ee,Q){"use strict";ee.exports={PTS_LINESONLY:20,minTolerance:.2,toleranceGrowth:10,maxScreensAway:20,eventDataKeys:[]}},{}],941:[function(y,ee,Q){"use strict";var g=y("./calc");function v(m,x,e,n,t,a,r){t[n]=!0;var i,u,c,h,p,d={i:null,gap:!0,s:0};if(d[r]=e,m.splice(x,0,d),x&&e===m[x-1][r]){var s=m[x-1];d.s=s.s,d.i=s.i,d.gap=s.gap}else a&&(d.s=(c=r,h=(i=m)[(u=x)-1],(p=i[u+1])?h?h.s+(p.s-h.s)*(e-h[c])/(p[c]-h[c]):p.s:h.s));x||(m[0].t=m[1].t,m[0].trace=m[1].trace,delete m[1].t,delete m[1].trace)}ee.exports=function(m,x){var e=x.xaxis,n=x.yaxis,a=m._fullLayout._scatterStackOpts[e._id+n._id];if(a){var r,d,s,i,u,f,c,h,p,o,b,l,T,_,w,k=m.calcdata;for(var L in a){var M=(o=a[L]).traceIndices;if(M.length){for(b="interpolate"===o.stackgaps,l=o.groupnorm,"v"===o.orientation?(T="x",_="y"):(T="y",_="x"),w=new Array(M.length),r=0;r<w.length;r++)w[r]=!1;f=k[M[0]];var I=new Array(f.length);for(r=0;r<f.length;r++)I[r]=f[r][T];for(r=1;r<M.length;r++){for(u=k[M[r]],d=s=0;d<u.length;d++){for(c=u[d][T];c>I[s]&&s<I.length;s++)v(u,d,I[s],r,w,b,T),d++;if(c!==I[s]){for(i=0;i<r;i++)v(k[M[i]],s,c,i,w,b,T);I.splice(s,0,c)}s++}for(;s<I.length;s++)v(u,d,I[s],r,w,b,T),d++}var P=I.length;for(d=0;d<f.length;d++){for(h=f[d][_]=f[d].s,r=1;r<M.length;r++)(u=k[M[r]])[0].trace._rawLength=u[0].trace._length,u[0].trace._length=P,u[d][_]=h+=u[d].s;if(l)for(p=("fraction"===l?h:h/100)||1,r=0;r<M.length;r++){var S=k[M[r]][d];S[_]/=p,S.sNorm=S.s/p}}for(r=0;r<M.length;r++){var E=(u=k[M[r]])[0].trace,z=g.calcMarkerSize(E,E._rawLength),R=Array.isArray(z);if(z&&w[r]||R){var q=z;for(z=new Array(P),d=0;d<P;d++)z[d]=u[d].gap?0:R?q[u[d].i]:q}var V=new Array(P),W=new Array(P);for(d=0;d<P;d++)V[d]=u[d].x,W[d]=u[d].y;g.calcAxisExpansion(m,E,e,n,V,W,z),u[0].t.orientation=o.orientation}}}}}},{"./calc":937}],942:[function(y,ee,Q){"use strict";ee.exports=function(g){for(var v=0;v<g.length;v++){var m=g[v];if("scatter"===m.type){var x=m.fill;if("none"!==x&&"toself"!==x&&(m.opacity=void 0,"tonexty"===x||"tonextx"===x))for(var e=v-1;e>=0;e--){var n=g[e];if("scatter"===n.type&&n.xaxis===m.xaxis&&n.yaxis===m.yaxis){n.opacity=void 0;break}}}}}},{}],943:[function(y,ee,Q){"use strict";var g=y("../../lib"),v=y("../../registry"),m=y("./attributes"),x=y("./constants"),e=y("./subtypes"),n=y("./xy_defaults"),t=y("./period_defaults"),a=y("./stack_defaults"),r=y("./marker_defaults"),d=y("./line_defaults"),s=y("./line_shape_defaults"),i=y("./text_defaults"),u=y("./fillcolor_defaults"),f=y("../../lib").coercePattern;ee.exports=function(c,h,p,o){function b(I,P){return g.coerce(c,h,m,I,P)}var l=n(c,h,o,b);if(l||(h.visible=!1),h.visible){t(c,h,o,b),b("xhoverformat"),b("yhoverformat");var T=a(c,h,o,b),_=!T&&l<x.PTS_LINESONLY?"lines+markers":"lines";b("text"),b("hovertext"),b("mode",_),e.hasLines(h)&&(d(c,h,p,o,b),s(c,h,b),b("connectgaps"),b("line.simplify")),e.hasMarkers(h)&&r(c,h,p,o,b,{gradient:!0}),e.hasText(h)&&(b("texttemplate"),i(c,h,o,b));var w=[];(e.hasMarkers(h)||e.hasText(h))&&(b("cliponaxis"),b("marker.maxdisplayed"),w.push("points")),b("fill",T?T.fillDflt:"none"),"none"!==h.fill&&(u(c,h,p,b),e.hasLines(h)||s(c,h,b),f(b,"fillpattern",h.fillcolor,!1));var k=(h.line||{}).color,L=(h.marker||{}).color;"tonext"!==h.fill&&"toself"!==h.fill||w.push("fills"),b("hoveron",w.join("+")||"points"),"fills"!==h.hoveron&&b("hovertemplate");var M=v.getComponentMethod("errorbars","supplyDefaults");M(c,h,k||L||p,{axis:"y"}),M(c,h,k||L||p,{axis:"x",inherit:"y"}),g.coerceSelectionMarkerOpacity(h,b)}}},{"../../lib":515,"../../registry":647,"./attributes":936,"./constants":940,"./fillcolor_defaults":944,"./line_defaults":949,"./line_shape_defaults":951,"./marker_defaults":955,"./period_defaults":956,"./stack_defaults":959,"./subtypes":961,"./text_defaults":962,"./xy_defaults":963}],944:[function(y,ee,Q){"use strict";var g=y("../../components/color"),v=y("../../lib").isArrayOrTypedArray;ee.exports=function(m,x,e,n){var t=!1;if(x.marker){var a=x.marker.color,r=(x.marker.line||{}).color;a&&!v(a)?t=a:r&&!v(r)&&(t=r)}n("fillcolor",g.addOpacity((x.line||{}).color||t||e,.5))}},{"../../components/color":367,"../../lib":515}],945:[function(y,ee,Q){"use strict";var g=y("../../plots/cartesian/axes");ee.exports=function(v,m,x){var e={},n={_fullLayout:x},t=g.getFromTrace(n,m,"x"),a=g.getFromTrace(n,m,"y");return e.xLabel=g.tickText(t,t.c2l(v.x),!0).text,e.yLabel=g.tickText(a,a.c2l(v.y),!0).text,e}},{"../../plots/cartesian/axes":566}],946:[function(y,ee,Q){"use strict";var g=y("../../components/color"),v=y("./subtypes");ee.exports=function(m,x){var e,n;if("lines"===m.mode)return(e=m.line.color)&&g.opacity(e)?e:m.fillcolor;if("none"===m.mode)return m.fill?m.fillcolor:"";var t=x.mcc||(m.marker||{}).color,a=x.mlcc||((m.marker||{}).line||{}).color;return(n=t&&g.opacity(t)?t:a&&g.opacity(a)&&(x.mlw||((m.marker||{}).line||{}).width)?a:"")?g.opacity(n)<.3?g.addOpacity(n,.3):n:(e=(m.line||{}).color)&&g.opacity(e)&&v.hasLines(m)&&m.line.width?e:m.fillcolor}},{"../../components/color":367,"./subtypes":961}],947:[function(y,ee,Q){"use strict";var g=y("../../lib"),v=y("../../components/fx"),m=y("../../registry"),x=y("./get_trace_color"),e=y("../../components/color"),n=g.fillText;ee.exports=function(t,a,r,d){var s=t.cd,i=s[0].trace,u=t.xa,f=t.ya,c=u.c2p(a),h=f.c2p(r),p=[c,h],o=i.hoveron||"",b=-1!==i.mode.indexOf("markers")?3:.5,l=!!i.xperiodalignment,T=!!i.yperiodalignment;if(-1!==o.indexOf("points")){var _=function(oe){var de=Math.max(b,oe.mrc||0),se=u.c2p(oe.x)-c,ge=f.c2p(oe.y)-h;return Math.max(Math.sqrt(se*se+ge*ge)-de,1-b/de)},w=v.getDistanceFunction(d,function(oe){if(l){var de=u.c2p(oe.xStart),se=u.c2p(oe.xEnd);return c>=Math.min(de,se)&&c<=Math.max(de,se)?0:1/0}var ge=Math.max(3,oe.mrc||0),_e=1-1/ge,Te=Math.abs(u.c2p(oe.x)-c);return Te<ge?_e*Te/ge:Te-ge+_e},function(oe){if(T){var de=f.c2p(oe.yStart),se=f.c2p(oe.yEnd);return h>=Math.min(de,se)&&h<=Math.max(de,se)?0:1/0}var ge=Math.max(3,oe.mrc||0),_e=1-1/ge,Te=Math.abs(f.c2p(oe.y)-h);return Te<ge?_e*Te/ge:Te-ge+_e},_);if(v.getClosest(s,w,t),!1!==t.index){var k=s[t.index],L=u.c2p(k.x,!0),M=f.c2p(k.y,!0),I=k.mrc||1;t.index=k.i;var P=s[0].t.orientation,S=P&&(k.sNorm||k.s),E="h"===P?S:void 0!==k.orig_x?k.orig_x:k.x,z="v"===P?S:void 0!==k.orig_y?k.orig_y:k.y;return g.extendFlat(t,{color:x(i,k),x0:L-I,x1:L+I,xLabelVal:E,y0:M-I,y1:M+I,yLabelVal:z,spikeDistance:_(k),hovertemplate:i.hovertemplate}),n(k,i,t),m.getComponentMethod("errorbars","hoverInfo")(k,i,t),[t]}}if(-1!==o.indexOf("fills")&&i._polygons){var R,q,V,W,K,G,$,B,N=i._polygons,U=[],te=!1,j=1/0,J=-1/0,X=1/0,re=-1/0;for(R=0;R<N.length;R++)(V=N[R]).contains(p)&&(te=!te,U.push(V),X=Math.min(X,V.ymin),re=Math.max(re,V.ymax));if(te){var ne=((X=Math.max(X,0))+(re=Math.min(re,f._length)))/2;for(R=0;R<U.length;R++)for(W=U[R].pts,q=1;q<W.length;q++)($=W[q-1][1])>ne!=(B=W[q][1])>=ne&&(G=W[q-1][0],B-$&&(K=G+(W[q][0]-G)*(ne-$)/(B-$),j=Math.min(j,K),J=Math.max(J,K)));j=Math.max(j,0),J=Math.min(J,u._length);var le=e.defaultLine;return e.opacity(i.fillcolor)?le=i.fillcolor:e.opacity((i.line||{}).color)&&(le=i.line.color),g.extendFlat(t,{distance:t.maxHoverDistance,x0:j,x1:J,y0:ne,y1:ne,color:le,hovertemplate:!1}),delete t.index,t.text=i.text&&!Array.isArray(i.text)?String(i.text):i.name,[t]}}}},{"../../components/color":367,"../../components/fx":407,"../../lib":515,"../../registry":647,"./get_trace_color":946}],948:[function(y,ee,Q){"use strict";var g=y("./subtypes");ee.exports={hasLines:g.hasLines,hasMarkers:g.hasMarkers,hasText:g.hasText,isBubble:g.isBubble,attributes:y("./attributes"),supplyDefaults:y("./defaults"),crossTraceDefaults:y("./cross_trace_defaults"),calc:y("./calc").calc,crossTraceCalc:y("./cross_trace_calc"),arraysToCalcdata:y("./arrays_to_calcdata"),plot:y("./plot"),colorbar:y("./marker_colorbar"),formatLabels:y("./format_labels"),style:y("./style").style,styleOnSelect:y("./style").styleOnSelect,hoverPoints:y("./hover"),selectPoints:y("./select"),animatable:!0,moduleType:"trace",name:"scatter",basePlotModule:y("../../plots/cartesian"),categories:["cartesian","svg","symbols","errorBarsOK","showLegend","scatter-like","zoomScale"],meta:{}}},{"../../plots/cartesian":578,"./arrays_to_calcdata":935,"./attributes":936,"./calc":937,"./cross_trace_calc":941,"./cross_trace_defaults":942,"./defaults":943,"./format_labels":945,"./hover":947,"./marker_colorbar":954,"./plot":957,"./select":958,"./style":960,"./subtypes":961}],949:[function(y,ee,Q){"use strict";var g=y("../../lib").isArrayOrTypedArray,v=y("../../components/colorscale/helpers").hasColorscale,m=y("../../components/colorscale/defaults");ee.exports=function(x,e,n,t,a,r){var d=(x.marker||{}).color;a("line.color",n),v(x,"line")?m(x,e,t,a,{prefix:"line.",cLetter:"c"}):a("line.color",!g(d)&&d||n),a("line.width"),(r||{}).noDash||a("line.dash")}},{"../../components/colorscale/defaults":377,"../../components/colorscale/helpers":378,"../../lib":515}],950:[function(y,ee,Q){"use strict";var g=y("../../constants/numerical"),v=g.BADNUM,m=g.LOG_CLIP,x=m+.5,e=m-.5,n=y("../../lib"),t=n.segmentsIntersect,a=n.constrain,r=y("./constants");ee.exports=function(d,s){var i,u,f,c,h,p,o,b,l,T,_,w,k,L,M,I,P,S,E=s.xaxis,z=s.yaxis,R="log"===E.type,q="log"===z.type,V=E._length,W=z._length,K=s.connectGaps,G=s.baseTolerance,Y=s.shape,$="linear"===Y,B=s.fill&&"none"!==s.fill,N=[],U=r.minTolerance,te=d.length,j=new Array(te),J=0;function X(Re){var Xe=d[Re];if(!Xe)return!1;var nt=s.linearized?E.l2p(Xe.x):E.c2p(Xe.x),ct=s.linearized?z.l2p(Xe.y):z.c2p(Xe.y);if(nt===v){if(R&&(nt=E.c2p(Xe.x,!0)),nt===v)return!1;q&&ct===v&&(nt*=Math.abs(E._m*W*(E._m>0?x:e)/(z._m*V*(z._m>0?x:e)))),nt*=1e3}if(ct===v){if(q&&(ct=z.c2p(Xe.y,!0)),ct===v)return!1;ct*=1e3}return[nt,ct]}function re(Re,Xe,nt,ct){var xt=nt-Re,dt=ct-Xe,tt=.5-Re,Ke=.5-Xe,mt=xt*xt+dt*dt,Bt=xt*tt+dt*Ke;if(Bt>0&&Bt<mt){var Ut=tt*dt-Ke*xt;if(Ut*Ut<mt)return!0}}function ne(Re,Xe){var nt=Re[0]/V,ct=Re[1]/W,xt=Math.max(0,-nt,nt-1,-ct,ct-1);return xt&&void 0!==P&&re(nt,ct,P,S)&&(xt=0),xt&&Xe&&re(nt,ct,Xe[0]/V,Xe[1]/W)&&(xt=0),(1+r.toleranceGrowth*xt)*G}function le(Re,Xe){var nt=Re[0]-Xe[0],ct=Re[1]-Xe[1];return Math.sqrt(nt*nt+ct*ct)}var oe,de,se,ge,_e,Te,we,Oe=r.maxScreensAway,fe=-V*Oe,ve=V*(1+Oe),Ae=-W*Oe,ke=W*(1+Oe),Pe=[[fe,Ae,ve,Ae],[ve,Ae,ve,ke],[ve,ke,fe,ke],[fe,ke,fe,Ae]];function Ne(Re){if(Re[0]<fe||Re[0]>ve||Re[1]<Ae||Re[1]>ke)return[a(Re[0],fe,ve),a(Re[1],Ae,ke)]}function De(Re,Xe){return Re[0]===Xe[0]&&(Re[0]===fe||Re[0]===ve)||Re[1]===Xe[1]&&(Re[1]===Ae||Re[1]===ke)||void 0}function ze(Re,Xe,nt){return function(ct,xt){var dt=Ne(ct),tt=Ne(xt),Ke=[];if(dt&&tt&&De(dt,tt))return Ke;dt&&Ke.push(dt),tt&&Ke.push(tt);var mt=2*n.constrain((ct[Re]+xt[Re])/2,Xe,nt)-((dt||ct)[Re]+(tt||xt)[Re]);return mt&&((dt&&tt?mt>0==dt[Re]>tt[Re]?dt:tt:dt||tt)[Re]+=mt),Ke}}function Me(Re){var Xe=Re[0],nt=Re[1],ct=Xe===j[J-1][0],xt=nt===j[J-1][1];if(!ct||!xt)if(J>1){var dt=Xe===j[J-2][0],tt=nt===j[J-2][1];ct&&(Xe===fe||Xe===ve)&&dt?tt?J--:j[J-1]=Re:xt&&(nt===Ae||nt===ke)&&tt?dt?J--:j[J-1]=Re:j[J++]=Re}else j[J++]=Re}function Se(Re){j[J-1][0]!==Re[0]&&j[J-1][1]!==Re[1]&&Me([se,ge]),Me(Re),_e=null,se=ge=0}function Ie(Re){if(P=Re[0]/V,S=Re[1]/W,de=Re[1]<Ae?Ae:Re[1]>ke?ke:0,(oe=Re[0]<fe?fe:Re[0]>ve?ve:0)||de){if(J)if(_e){var Xe=we(_e,Re);Xe.length>1&&(Se(Xe[0]),j[J++]=Xe[1])}else Te=we(j[J-1],Re)[0],j[J++]=Te;else j[J++]=[oe||Re[0],de||Re[1]];var nt=j[J-1];oe&&de&&(nt[0]!==oe||nt[1]!==de)?(_e&&(se!==oe&&ge!==de?Me(se&&ge?(dt=(xt=Re)[0]-(ct=_e)[0],tt=(xt[1]-ct[1])/dt,(ct[1]*xt[0]-xt[1]*ct[0])/dt>0?[tt>0?fe:ve,ke]:[tt>0?ve:fe,Ae]):[se||oe,ge||de]):se&&ge&&Me([se,ge])),Me([oe,de])):se-oe&&ge-de&&Me([oe||se,de||ge]),_e=Re,se=oe,ge=de}else _e&&Se(we(_e,Re)[0]),j[J++]=Re;var ct,xt,dt,tt}for("linear"===Y||"spline"===Y?we=function(Re,Xe){for(var nt=[],ct=0,xt=0;xt<4;xt++){var dt=Pe[xt],tt=t(Re[0],Re[1],Xe[0],Xe[1],dt[0],dt[1],dt[2],dt[3]);tt&&(!ct||Math.abs(tt.x-nt[0][0])>1||Math.abs(tt.y-nt[0][1])>1)&&(tt=[tt.x,tt.y],ct&&le(tt,Re)<le(nt[0],Re)?nt.unshift(tt):nt.push(tt),ct++)}return nt}:"hv"===Y||"vh"===Y?we=function(Re,Xe){var nt=[],ct=Ne(Re),xt=Ne(Xe);return ct&&xt&&De(ct,xt)||(ct&&nt.push(ct),xt&&nt.push(xt)),nt}:"hvh"===Y?we=ze(0,fe,ve):"vhv"===Y&&(we=ze(1,Ae,ke)),i=0;i<te;i++)if(u=X(i)){for(J=0,_e=null,Ie(u),i++;i<te;i++){if(!(c=X(i))){if(K)continue;break}if($&&s.simplify){var Fe=X(i+1);if(T=le(c,u),B&&(0===J||J===te-1)||!(T<ne(c,Fe)*U)){for(b=[(c[0]-u[0])/T,(c[1]-u[1])/T],h=u,_=T,w=L=M=0,o=!1,f=c,i++;i<d.length;i++){if(p=Fe,Fe=X(i+1),!p){if(K)continue;break}if(I=(l=[p[0]-u[0],p[1]-u[1]])[0]*b[1]-l[1]*b[0],L=Math.min(L,I),(M=Math.max(M,I))-L>ne(p,Fe))break;f=p,(k=l[0]*b[0]+l[1]*b[1])>_?(_=k,c=p,o=!1):k<w&&(w=k,h=p,o=!0)}if(o?(Ie(c),f!==h&&Ie(h)):(h!==u&&Ie(h),f!==c&&Ie(c)),Ie(f),i>=d.length||!p)break;Ie(p),u=p}}else Ie(c)}_e&&Me([se||_e[0],ge||_e[1]]),N.push(j.slice(0,J))}return N}},{"../../constants/numerical":491,"../../lib":515,"./constants":940}],951:[function(y,ee,Q){"use strict";ee.exports=function(g,v,m){"spline"===m("line.shape")&&m("line.smoothing")}},{}],952:[function(y,ee,Q){"use strict";var g={tonextx:1,tonexty:1,tonext:1};ee.exports=function(v,m,x){var e,n,t,a,r,d={},s=!1,i=-1,u=0,f=-1;for(n=0;n<x.length;n++)(t=(e=x[n][0].trace).stackgroup||"")?t in d?r=d[t]:(r=d[t]=u,u++):e.fill in g&&f>=0?r=f:(r=f=u,u++),r<i&&(s=!0),e._groupIndex=i=r;var c=x.slice();s&&c.sort(function(p,o){var b=p[0].trace,l=o[0].trace;return b._groupIndex-l._groupIndex||b.index-l.index});var h={};for(n=0;n<c.length;n++)t=(e=c[n][0].trace).stackgroup||"",!0===e.visible?(e._nexttrace=null,e.fill in g&&(e._prevtrace=(a=h[t])||null,a&&(a._nexttrace=e)),e._ownfill=e.fill&&("tozero"===e.fill.substr(0,6)||"toself"===e.fill||"to"===e.fill.substr(0,2)&&!e._prevtrace),h[t]=e):e._prevtrace=e._nexttrace=e._ownfill=null;return c}},{}],953:[function(y,ee,Q){"use strict";var g=y("fast-isnumeric");ee.exports=function(v,m){m||(m=2);var x=v.marker,e=x.sizeref||1,n=x.sizemin||0,t="area"===x.sizemode?function(a){return Math.sqrt(a/e)}:function(a){return a/e};return function(a){var r=t(a/m);return g(r)&&r>0?Math.max(r,n):0}}},{"fast-isnumeric":190}],954:[function(y,ee,Q){"use strict";ee.exports={container:"marker",min:"cmin",max:"cmax"}},{}],955:[function(y,ee,Q){"use strict";var g=y("../../components/color"),v=y("../../components/colorscale/helpers").hasColorscale,m=y("../../components/colorscale/defaults"),x=y("./subtypes");ee.exports=function(e,n,t,a,r,d){var s=x.isBubble(e),i=(e.line||{}).color;d=d||{},i&&(t=i),r("marker.symbol"),r("marker.opacity",s?.7:1),r("marker.size"),r("marker.color",t),v(e,"marker")&&m(e,n,a,r,{prefix:"marker.",cLetter:"c"}),d.noSelect||(r("selected.marker.color"),r("unselected.marker.color"),r("selected.marker.size"),r("unselected.marker.size")),d.noLine||(r("marker.line.color",i&&!Array.isArray(i)&&n.marker.color!==i?i:s?g.background:g.defaultLine),v(e,"marker.line")&&m(e,n,a,r,{prefix:"marker.line.",cLetter:"c"}),r("marker.line.width",s?1:0)),s&&(r("marker.sizeref"),r("marker.sizemin"),r("marker.sizemode")),d.gradient&&"none"!==r("marker.gradient.type")&&r("marker.gradient.color")}},{"../../components/color":367,"../../components/colorscale/defaults":377,"../../components/colorscale/helpers":378,"./subtypes":961}],956:[function(y,ee,Q){"use strict";var g=y("../../lib").dateTick0,v=y("../../constants/numerical").ONEWEEK;function m(x,e){return g(e,x%v==0?1:0)}ee.exports=function(x,e,n,t,a){if(a||(a={x:!0,y:!0}),a.x){var r=t("xperiod");r&&(t("xperiod0",m(r,e.xcalendar)),t("xperiodalignment"))}if(a.y){var d=t("yperiod");d&&(t("yperiod0",m(d,e.ycalendar)),t("yperiodalignment"))}}},{"../../constants/numerical":491,"../../lib":515}],957:[function(y,ee,Q){"use strict";var g=y("@plotly/d3"),v=y("../../registry"),m=y("../../lib"),x=m.ensureSingle,e=m.identity,n=y("../../components/drawing"),t=y("./subtypes"),a=y("./line_points"),r=y("./link_traces"),d=y("../../lib/polygon").tester;function s(i,u,f,c,h,p,o){var b;!function(ve,Ae,ke,Pe,Ne){var De=ke.xaxis,ze=ke.yaxis,Me=g.extent(m.simpleMap(De.range,De.r2c)),Se=g.extent(m.simpleMap(ze.range,ze.r2c)),Ie=Pe[0].trace;if(t.hasMarkers(Ie)){var Fe=Ie.marker.maxdisplayed;if(0!==Fe){var Re=Pe.filter(function(xt){return xt.x>=Me[0]&&xt.x<=Me[1]&&xt.y>=Se[0]&&xt.y<=Se[1]}),Xe=Math.ceil(Re.length/Fe),nt=0;Ne.forEach(function(xt,dt){var tt=xt[0].trace;t.hasMarkers(tt)&&tt.marker.maxdisplayed>0&&dt<Ae&&nt++});var ct=Math.round(nt*Xe/3+Math.floor(nt/3)*Xe/7.1);Pe.forEach(function(xt){delete xt.vis}),Re.forEach(function(xt,dt){0===Math.round((dt+ct)%Xe)&&(xt.vis=!0)})}}}(0,u,f,c,h);var l=!!o&&o.duration>0;function T(ve){return l?ve.transition():ve}var _=f.xaxis,w=f.yaxis,k=c[0].trace,L=k.line,M=g.select(p),I=x(M,"g","errorbars"),P=x(M,"g","lines"),S=x(M,"g","points"),E=x(M,"g","text");if(v.getComponentMethod("errorbars","plot")(i,I,f,o),!0===k.visible){var z,R;T(M).style("opacity",k.opacity);var q=k.fill.charAt(k.fill.length-1);"x"!==q&&"y"!==q&&(q=""),c[0][f.isRangePlot?"nodeRangePlot3":"node3"]=M;var V,W,K="",G=[],Y=k._prevtrace;Y&&(K=Y._prevRevpath||"",R=Y._nextFill,G=Y._polygons);var $,B,N,U,te,j,J,X="",re="",ne=[],le=m.noop;if(z=k._ownFill,t.hasLines(k)||"none"!==k.fill){for(R&&R.datum(c),-1!==["hv","vh","hvh","vhv"].indexOf(L.shape)?($=n.steps(L.shape),B=n.steps(L.shape.split("").reverse().join(""))):$=B="spline"===L.shape?function(ve){var Ae=ve[ve.length-1];return ve.length>1&&ve[0][0]===Ae[0]&&ve[0][1]===Ae[1]?n.smoothclosed(ve.slice(1),L.smoothing):n.smoothopen(ve,L.smoothing)}:function(ve){return"M"+ve.join("L")},N=function(ve){return B(ve.reverse())},ne=a(c,{xaxis:_,yaxis:w,connectGaps:k.connectgaps,baseTolerance:Math.max(L.width||1,3)/4,shape:L.shape,simplify:L.simplify,fill:k.fill}),J=k._polygons=new Array(ne.length),b=0;b<ne.length;b++)k._polygons[b]=d(ne[b]);ne.length&&(U=ne[0][0],j=(te=ne[ne.length-1])[te.length-1]),le=function(ve){return function(Ae){if(V=$(Ae),W=N(Ae),X?q?(X+="L"+V.substr(1),re=W+"L"+re.substr(1)):(X+="Z"+V,re=W+"Z"+re):(X=V,re=W),t.hasLines(k)&&Ae.length>1){var ke=g.select(this);if(ke.datum(c),ve)T(ke.style("opacity",0).attr("d",V).call(n.lineGroupStyle)).style("opacity",1);else{var Pe=T(ke);Pe.attr("d",V),n.singleLineStyle(c,Pe)}}}}}var oe=P.selectAll(".js-line").data(ne);T(oe.exit()).style("opacity",0).remove(),oe.each(le(!1)),oe.enter().append("path").classed("js-line",!0).style("vector-effect","non-scaling-stroke").call(n.lineGroupStyle).each(le(!0)),n.setClipUrl(oe,f.layerClipId,i),ne.length?(z?(z.datum(c),U&&j&&(q?("y"===q?U[1]=j[1]=w.c2p(0,!0):"x"===q&&(U[0]=j[0]=_.c2p(0,!0)),T(z).attr("d","M"+j+"L"+U+"L"+X.substr(1)).call(n.singleFillStyle,i)):T(z).attr("d",X+"Z").call(n.singleFillStyle,i))):R&&("tonext"===k.fill.substr(0,6)&&X&&K?("tonext"===k.fill?T(R).attr("d",X+"Z"+K+"Z").call(n.singleFillStyle,i):T(R).attr("d",X+"L"+K.substr(1)+"Z").call(n.singleFillStyle,i),k._polygons=k._polygons.concat(G)):(se(R),k._polygons=null)),k._prevRevpath=re,k._prevPolygons=J):(z?se(z):R&&se(R),k._polygons=k._prevRevpath=k._prevPolygons=null),S.datum(c),E.datum(c),function(ve,Ae,ke){var Pe,Ne=ke[0].trace,De=t.hasMarkers(Ne),ze=t.hasText(Ne),Me=function Oe(ve){if(ve.ids)return we}(Ne),Se=fe,Ie=fe;if(De||ze){var Fe=e,Re=Ne.stackgroup,Xe=Re&&"infer zero"===i._fullLayout._scatterStackOpts[_._id+w._id][Re].stackgaps;Ne.marker.maxdisplayed||Ne._needsCull?Fe=Xe?_e:ge:Re&&!Xe&&(Fe=Te),De&&(Se=Fe),ze&&(Ie=Fe)}var nt,ct=(Pe=ve.selectAll("path.point").data(Se,Me)).enter().append("path").classed("point",!0);l&&ct.call(n.pointStyle,Ne,i).call(n.translatePoints,_,w).style("opacity",0).transition().style("opacity",1),Pe.order(),De&&(nt=n.makePointStyleFns(Ne)),Pe.each(function(xt){var dt=g.select(this),tt=T(dt);n.translatePoint(xt,tt,_,w)?(n.singlePointStyle(xt,tt,Ne,nt,i),f.layerClipId&&n.hideOutsideRangePoint(xt,tt,_,w,Ne.xcalendar,Ne.ycalendar),Ne.customdata&&dt.classed("plotly-customdata",null!=xt.data)):tt.remove()}),l?Pe.exit().transition().style("opacity",0).remove():Pe.exit().remove(),(Pe=Ae.selectAll("g").data(Ie,Me)).enter().append("g").classed("textpoint",!0).append("text"),Pe.order(),Pe.each(function(xt){var dt=g.select(this),tt=T(dt.select("text"));n.translatePoint(xt,tt,_,w)?f.layerClipId&&n.hideOutsideRangePoint(xt,dt,_,w,Ne.xcalendar,Ne.ycalendar):dt.remove()}),Pe.selectAll("text").call(n.textPointStyle,Ne,i).each(function(xt){var dt=_.c2p(xt.x),tt=w.c2p(xt.y);g.select(this).selectAll("tspan.line").each(function(){T(g.select(this)).attr({x:dt,y:tt})})}),Pe.exit().remove()}(S,E,c);var de=!1===k.cliponaxis?null:f.layerClipId;n.setClipUrl(S,de,i),n.setClipUrl(E,de,i)}function se(ve){T(ve).attr("d","M0,0Z")}function ge(ve){return ve.filter(function(Ae){return!Ae.gap&&Ae.vis})}function _e(ve){return ve.filter(function(Ae){return Ae.vis})}function Te(ve){return ve.filter(function(Ae){return!Ae.gap})}function we(ve){return ve.id}function fe(){return!1}}ee.exports=function(i,u,f,c,h,p){var o,b,w,L,l=!h,T=!!h&&h.duration>0,_=r(i,u,f);(o=c.selectAll("g.trace").data(_,function(w){return w[0].trace.uid})).enter().append("g").attr("class",function(w){return"trace scatter trace"+w[0].trace.uid}).style("stroke-miterlimit",2),o.order(),w=i,L=u,o.each(function(M){var I=x(g.select(this),"g","fills");n.setClipUrl(I,L.layerClipId,w);var P=M[0].trace,S=[];P._ownfill&&S.push("_ownFill"),P._nexttrace&&S.push("_nextFill");var E=I.selectAll("g").data(S,e);E.enter().append("g"),E.exit().each(function(z){P[z]=null}).remove(),E.order().each(function(z){P[z]=x(g.select(this),"path","js-fill")})}),T?(p&&(b=p()),g.transition().duration(h.duration).ease(h.easing).each("end",function(){b&&b()}).each("interrupt",function(){b&&b()}).each(function(){c.selectAll("g.trace").each(function(w,k){s(i,k,u,w,_,this,h)})})):o.each(function(w,k){s(i,k,u,w,_,this,h)}),l&&o.exit().remove(),c.selectAll("path:not([d])").remove()}},{"../../components/drawing":389,"../../lib":515,"../../lib/polygon":527,"../../registry":647,"./line_points":950,"./link_traces":952,"./subtypes":961,"@plotly/d3":58}],958:[function(y,ee,Q){"use strict";var g=y("./subtypes");ee.exports=function(v,m){var x,e,n,t,a=v.cd,r=v.xaxis,d=v.yaxis,s=[],i=a[0].trace;if(!g.hasMarkers(i)&&!g.hasText(i))return[];if(!1===m)for(x=0;x<a.length;x++)a[x].selected=0;else for(x=0;x<a.length;x++)n=r.c2p((e=a[x]).x),t=d.c2p(e.y),null!==e.i&&m.contains([n,t],!1,x,v)?(s.push({pointNumber:e.i,x:r.c2d(e.x),y:d.c2d(e.y)}),e.selected=1):e.selected=0;return s}},{"./subtypes":961}],959:[function(y,ee,Q){"use strict";var g=["orientation","groupnorm","stackgaps"];ee.exports=function(v,m,x,e){var n=x._scatterStackOpts,t=e("stackgroup");if(t){var a=m.xaxis+m.yaxis,r=n[a];r||(r=n[a]={});var d=r[t],s=!1;d?d.traces.push(m):(d=r[t]={traceIndices:[],traces:[m]},s=!0);for(var i={orientation:m.x&&!m.y?"h":"v"},u=0;u<g.length;u++){var f=g[u],c=f+"Found";if(!d[c]){var h=void 0!==v[f],p="orientation"===f;if((h||s)&&(d[f]=e(f,i[f]),p&&(d.fillDflt="h"===d[f]?"tonextx":"tonexty"),h&&(d[c]=!0,!s&&(delete d.traces[0][f],p))))for(var o=0;o<d.traces.length-1;o++){var b=d.traces[o];b._input.fill!==b.fill&&(b.fill=d.fillDflt)}}}return d}}},{}],960:[function(y,ee,Q){"use strict";var g=y("@plotly/d3"),v=y("../../components/drawing"),m=y("../../registry");function x(n,t,a){v.pointStyle(n.selectAll("path.point"),t,a)}function e(n,t,a){v.textPointStyle(n.selectAll("text"),t,a)}ee.exports={style:function(n){var t=g.select(n).selectAll("g.trace.scatter");t.style("opacity",function(a){return a[0].trace.opacity}),t.selectAll("g.points").each(function(a){x(g.select(this),a.trace||a[0].trace,n)}),t.selectAll("g.text").each(function(a){e(g.select(this),a.trace||a[0].trace,n)}),t.selectAll("g.trace path.js-line").call(v.lineGroupStyle),t.selectAll("g.trace path.js-fill").call(v.fillGroupStyle,n),m.getComponentMethod("errorbars","style")(t)},stylePoints:x,styleText:e,styleOnSelect:function(n,t,a){var r=t[0].trace;r.selectedpoints?(v.selectedPointStyle(a.selectAll("path.point"),r),v.selectedTextStyle(a.selectAll("text"),r)):(x(a,r,n),e(a,r,n))}}},{"../../components/drawing":389,"../../registry":647,"@plotly/d3":58}],961:[function(y,ee,Q){"use strict";var g=y("../../lib");ee.exports={hasLines:function(v){return v.visible&&v.mode&&-1!==v.mode.indexOf("lines")},hasMarkers:function(v){return v.visible&&(v.mode&&-1!==v.mode.indexOf("markers")||"splom"===v.type)},hasText:function(v){return v.visible&&v.mode&&-1!==v.mode.indexOf("text")},isBubble:function(v){return g.isPlainObject(v.marker)&&g.isArrayOrTypedArray(v.marker.size)}}},{"../../lib":515}],962:[function(y,ee,Q){"use strict";var g=y("../../lib");ee.exports=function(v,m,x,e,n){n=n||{},e("textposition"),g.coerceFont(e,"textfont",x.font),n.noSelect||(e("selected.textfont.color"),e("unselected.textfont.color"))}},{"../../lib":515}],963:[function(y,ee,Q){"use strict";var g=y("../../lib"),v=y("../../registry");ee.exports=function(m,x,e,n){var t,a=n("x"),r=n("y");if(v.getComponentMethod("calendars","handleTraceDefaults")(m,x,["x","y"],e),a){var d=g.minRowLength(a);r?t=Math.min(d,g.minRowLength(r)):(t=d,n("y0"),n("dy"))}else{if(!r)return 0;t=g.minRowLength(r),n("x0"),n("dx")}return x._length=t,t}},{"../../lib":515,"../../registry":647}],964:[function(y,ee,Q){"use strict";var g=y("../scatter/attributes"),v=y("../../components/colorscale/attributes"),m=y("../../plots/cartesian/axis_format_attributes").axisHoverFormat,x=y("../../plots/template_attributes").hovertemplateAttrs,e=y("../../plots/template_attributes").texttemplateAttrs,n=y("../../plots/attributes"),t=y("../../constants/gl3d_dashes"),a=y("../../constants/gl3d_markers"),r=y("../../lib/extend").extendFlat,d=y("../../plot_api/edit_types").overrideAll,s=y("../../lib/sort_object_keys"),u=g.marker,f=u.line,c=r({width:g.line.width,dash:{valType:"enumerated",values:s(t),dflt:"solid"}},v("line")),h=ee.exports=d({x:g.x,y:g.y,z:{valType:"data_array"},text:r({},g.text,{}),texttemplate:e({},{}),hovertext:r({},g.hovertext,{}),hovertemplate:x(),xhoverformat:m("x"),yhoverformat:m("y"),zhoverformat:m("z"),mode:r({},g.mode,{dflt:"lines+markers"}),surfaceaxis:{valType:"enumerated",values:[-1,0,1,2],dflt:-1},surfacecolor:{valType:"color"},projection:{x:{show:{valType:"boolean",dflt:!1},opacity:{valType:"number",min:0,max:1,dflt:1},scale:{valType:"number",min:0,max:10,dflt:2/3}},y:{show:{valType:"boolean",dflt:!1},opacity:{valType:"number",min:0,max:1,dflt:1},scale:{valType:"number",min:0,max:10,dflt:2/3}},z:{show:{valType:"boolean",dflt:!1},opacity:{valType:"number",min:0,max:1,dflt:1},scale:{valType:"number",min:0,max:10,dflt:2/3}}},connectgaps:g.connectgaps,line:c,marker:r({symbol:{valType:"enumerated",values:s(a),dflt:"circle",arrayOk:!0},size:r({},u.size,{dflt:8}),sizeref:u.sizeref,sizemin:u.sizemin,sizemode:u.sizemode,opacity:r({},u.opacity,{arrayOk:!1}),colorbar:u.colorbar,line:r({width:r({},f.width,{arrayOk:!1})},v("marker.line"))},v("marker")),textposition:r({},g.textposition,{dflt:"top center"}),textfont:{color:g.textfont.color,size:g.textfont.size,family:r({},g.textfont.family,{arrayOk:!1})},opacity:n.opacity,hoverinfo:r({},n.hoverinfo)},"calc","nested");h.x.editType=h.y.editType=h.z.editType="calc+clearAxisTypes"},{"../../components/colorscale/attributes":374,"../../constants/gl3d_dashes":488,"../../constants/gl3d_markers":489,"../../lib/extend":505,"../../lib/sort_object_keys":538,"../../plot_api/edit_types":548,"../../plots/attributes":562,"../../plots/cartesian/axis_format_attributes":569,"../../plots/template_attributes":642,"../scatter/attributes":936}],965:[function(y,ee,Q){"use strict";var g=y("../scatter/arrays_to_calcdata"),v=y("../scatter/colorscale_calc");ee.exports=function(m,x){var e=[{x:!1,y:!1,trace:x,t:{}}];return g(e,x),v(m,x),e}},{"../scatter/arrays_to_calcdata":935,"../scatter/colorscale_calc":939}],966:[function(y,ee,Q){"use strict";var g=y("../../registry");function v(m,x,e,n){if(!x||!x.visible)return null;for(var t=g.getComponentMethod("errorbars","makeComputeError")(x),a=new Array(m.length),r=0;r<m.length;r++){var d=t(+m[r],r);if("log"===n.type){var s=n.c2l(m[r]),i=m[r]-d[0],u=m[r]+d[1];if(a[r]=[(n.c2l(i,!0)-s)*e,(n.c2l(u,!0)-s)*e],i>0){var f=n.c2l(i);n._lowerLogErrorBound||(n._lowerLogErrorBound=f),n._lowerErrorBound=Math.min(n._lowerLogErrorBound,f)}}else a[r]=[-d[0]*e,d[1]*e]}return a}ee.exports=function(m,x,e){var n=[v(m.x,m.error_x,x[0],e.xaxis),v(m.y,m.error_y,x[1],e.yaxis),v(m.z,m.error_z,x[2],e.zaxis)],t=function(u){for(var f=0;f<u.length;f++)if(u[f])return u[f].length;return 0}(n);if(0===t)return null;for(var a=new Array(t),r=0;r<t;r++){for(var d=[[0,0,0],[0,0,0]],s=0;s<3;s++)if(n[s])for(var i=0;i<2;i++)d[i][s]=n[s][r][i];a[r]=d}return a}},{"../../registry":647}],967:[function(y,ee,Q){"use strict";var g=y("../../../stackgl_modules").gl_line3d,v=y("../../../stackgl_modules").gl_scatter3d,m=y("../../../stackgl_modules").gl_error3d,x=y("../../../stackgl_modules").gl_mesh3d,e=y("../../../stackgl_modules").delaunay_triangulate,n=y("../../lib"),t=y("../../lib/str2rgbarray"),a=y("../../lib/gl_format_color").formatColor,r=y("../scatter/make_bubble_size_func"),d=y("../../constants/gl3d_dashes"),s=y("../../constants/gl3d_markers"),i=y("../../plots/cartesian/axes"),u=y("../../components/fx/helpers").appendArrayPointValue,f=y("./calc_errors");function c(L,M){this.scene=L,this.uid=M,this.linePlot=null,this.scatterPlot=null,this.errorBars=null,this.textMarkers=null,this.delaunayMesh=null,this.color=null,this.mode="",this.dataPoints=[],this.axesBounds=[[-1/0,-1/0,-1/0],[1/0,1/0,1/0]],this.textLabels=null,this.data=null}var h=c.prototype;function p(L){return null==L?0:L.indexOf("left")>-1?-1:L.indexOf("right")>-1?1:0}function o(L){return null==L?0:L.indexOf("top")>-1?-1:L.indexOf("bottom")>-1?1:0}function b(L,M){return M(4*L)}function l(L){return s[L]}function T(L,M,I,P,S){var E=null;if(n.isArrayOrTypedArray(L)){E=[];for(var z=0;z<M;z++)E[z]=void 0===L[z]?P:I(L[z],S)}else E=I(L,n.identity);return E}function w(L){if(n.isArrayOrTypedArray(L)){var M=L[0];return n.isArrayOrTypedArray(M)&&(L=M),"rgb("+L.slice(0,3).map(function(I){return Math.round(255*I)})+")"}return null}function k(L){return n.isArrayOrTypedArray(L)?4===L.length&&"number"==typeof L[0]?w(L):L.map(w):null}h.handlePick=function(L){if(L.object&&(L.object===this.linePlot||L.object===this.delaunayMesh||L.object===this.textMarkers||L.object===this.scatterPlot)){var M=L.index=L.data.index;return L.object.highlight&&L.object.highlight(null),this.scatterPlot&&(L.object=this.scatterPlot,this.scatterPlot.highlight(L.data)),L.textLabel="",this.textLabels&&(Array.isArray(this.textLabels)?(this.textLabels[M]||0===this.textLabels[M])&&(L.textLabel=this.textLabels[M]):L.textLabel=this.textLabels),L.traceCoordinate=[this.data.x[M],this.data.y[M],this.data.z[M]],!0}},h.update=function(L){var M,I,P,S,E=this.scene.glplot.gl,z=d.solid;this.data=L;var R=function _(L,M){var I,P,S,E,z,R,q=[],V=L.fullSceneLayout,W=L.dataScale,K=V.xaxis,G=V.yaxis,Y=V.zaxis,$=M.marker,B=M.line,N=M.x||[],U=M.y||[],te=M.z||[],j=N.length,J=M.xcalendar,X=M.ycalendar,re=M.zcalendar;for(z=0;z<j;z++)I=K.d2l(N[z],0,J)*W[0],P=G.d2l(U[z],0,X)*W[1],S=Y.d2l(te[z],0,re)*W[2],q[z]=[I,P,S];if(Array.isArray(M.text))R=M.text;else if(void 0!==M.text)for(R=new Array(j),z=0;z<j;z++)R[z]=M.text;function ne(Pe,Ne){var De=V[Pe];return i.tickText(De,De.d2l(Ne),!0).text}var le=M.texttemplate;if(le){var oe=L.fullLayout._d3locale,de=Array.isArray(le),se=de?Math.min(le.length,j):j,ge=de?function(Pe){return le[Pe]}:function(){return le};for(R=new Array(se),z=0;z<se;z++){var _e={x:N[z],y:U[z],z:te[z]},Te={xLabel:ne("xaxis",N[z]),yLabel:ne("yaxis",U[z]),zLabel:ne("zaxis",te[z])},we={};u(we,M,z);var Oe=M._meta||{};R[z]=n.texttemplateString(ge(z),Te,oe,we,_e,Oe)}}if(E={position:q,mode:M.mode,text:R},"line"in M&&(E.lineColor=a(B,1,j),E.lineWidth=B.width,E.lineDashes=B.dash),"marker"in M){var fe=r(M);E.scatterColor=a($,1,j),E.scatterSize=T($.size,j,b,20,fe),E.scatterMarker=T($.symbol,j,l,"\u25cf"),E.scatterLineWidth=$.line.width,E.scatterLineColor=a($.line,1,j),E.scatterAngle=0}"textposition"in M&&(E.textOffset=function(Pe){var Ne=[0,0];if(Array.isArray(Pe))for(var De=0;De<Pe.length;De++)Ne[De]=[0,0],Pe[De]&&(Ne[De][0]=p(Pe[De]),Ne[De][1]=o(Pe[De]));else Ne[0]=p(Pe),Ne[1]=o(Pe);return Ne}(M.textposition),E.textColor=a(M.textfont,1,j),E.textSize=T(M.textfont.size,j,n.identity,12),E.textFont=M.textfont.family,E.textAngle=0);var ve=["x","y","z"];for(E.project=[!1,!1,!1],E.projectScale=[1,1,1],E.projectOpacity=[1,1,1],z=0;z<3;++z){var Ae=M.projection[ve[z]];(E.project[z]=Ae.show)&&(E.projectOpacity[z]=Ae.opacity,E.projectScale[z]=Ae.scale)}E.errorBounds=f(M,W,V);var ke=function(Pe){for(var Ne=[0,0,0],De=[[0,0,0],[0,0,0],[0,0,0]],ze=[1,1,1],Me=0;Me<3;Me++){var Se=Pe[Me];Se&&!1!==Se.copy_zstyle&&!1!==Pe[2].visible&&(Se=Pe[2]),Se&&Se.visible&&(Ne[Me]=Se.width/2,De[Me]=t(Se.color),ze[Me]=Se.thickness)}return{capSize:Ne,color:De,lineWidth:ze}}([M.error_x,M.error_y,M.error_z]);return E.errorColor=ke.color,E.errorLineWidth=ke.lineWidth,E.errorCapSize=ke.capSize,E.delaunayAxis=M.surfaceaxis,E.delaunayColor=t(M.surfacecolor),E}(this.scene,L);"mode"in R&&(this.mode=R.mode),"lineDashes"in R&&R.lineDashes in d&&(z=d[R.lineDashes]),this.color=k(R.scatterColor)||k(R.lineColor),this.dataPoints=R.position,M={gl:this.scene.glplot.gl,position:R.position,color:R.lineColor,lineWidth:R.lineWidth||1,dashes:z[0],dashScale:z[1],opacity:L.opacity,connectGaps:L.connectgaps},-1!==this.mode.indexOf("lines")?this.linePlot?this.linePlot.update(M):(this.linePlot=g(M),this.linePlot._trace=this,this.scene.glplot.add(this.linePlot)):this.linePlot&&(this.scene.glplot.remove(this.linePlot),this.linePlot.dispose(),this.linePlot=null);var q=L.opacity;if(L.marker&&L.marker.opacity&&(q*=L.marker.opacity),I={gl:this.scene.glplot.gl,position:R.position,color:R.scatterColor,size:R.scatterSize,glyph:R.scatterMarker,opacity:q,orthographic:!0,lineWidth:R.scatterLineWidth,lineColor:R.scatterLineColor,project:R.project,projectScale:R.projectScale,projectOpacity:R.projectOpacity},-1!==this.mode.indexOf("markers")?this.scatterPlot?this.scatterPlot.update(I):(this.scatterPlot=v(I),this.scatterPlot._trace=this,this.scatterPlot.highlightScale=1,this.scene.glplot.add(this.scatterPlot)):this.scatterPlot&&(this.scene.glplot.remove(this.scatterPlot),this.scatterPlot.dispose(),this.scatterPlot=null),S={gl:this.scene.glplot.gl,position:R.position,glyph:R.text,color:R.textColor,size:R.textSize,angle:R.textAngle,alignment:R.textOffset,font:R.textFont,orthographic:!0,lineWidth:0,project:!1,opacity:L.opacity},this.textLabels=L.hovertext||L.text,-1!==this.mode.indexOf("text")?this.textMarkers?this.textMarkers.update(S):(this.textMarkers=v(S),this.textMarkers._trace=this,this.textMarkers.highlightScale=1,this.scene.glplot.add(this.textMarkers)):this.textMarkers&&(this.scene.glplot.remove(this.textMarkers),this.textMarkers.dispose(),this.textMarkers=null),P={gl:this.scene.glplot.gl,position:R.position,color:R.errorColor,error:R.errorBounds,lineWidth:R.errorLineWidth,capSize:R.errorCapSize,opacity:L.opacity},this.errorBars?R.errorBounds?this.errorBars.update(P):(this.scene.glplot.remove(this.errorBars),this.errorBars.dispose(),this.errorBars=null):R.errorBounds&&(this.errorBars=m(P),this.errorBars._trace=this,this.scene.glplot.add(this.errorBars)),R.delaunayAxis>=0){var V=function(W,K,G){var Y,$=(G+1)%3,B=(G+2)%3,N=[],U=[];for(Y=0;Y<W.length;++Y){var te=W[Y];!isNaN(te[$])&&isFinite(te[$])&&!isNaN(te[B])&&isFinite(te[B])&&(N.push([te[$],te[B]]),U.push(Y))}var j=e(N);for(Y=0;Y<j.length;++Y)for(var J=j[Y],X=0;X<J.length;++X)J[X]=U[J[X]];return{positions:W,cells:j,meshColor:K}}(R.position,R.delaunayColor,R.delaunayAxis);V.opacity=L.opacity,this.delaunayMesh?this.delaunayMesh.update(V):(V.gl=E,this.delaunayMesh=x(V),this.delaunayMesh._trace=this,this.scene.glplot.add(this.delaunayMesh))}else this.delaunayMesh&&(this.scene.glplot.remove(this.delaunayMesh),this.delaunayMesh.dispose(),this.delaunayMesh=null)},h.dispose=function(){this.linePlot&&(this.scene.glplot.remove(this.linePlot),this.linePlot.dispose()),this.scatterPlot&&(this.scene.glplot.remove(this.scatterPlot),this.scatterPlot.dispose()),this.errorBars&&(this.scene.glplot.remove(this.errorBars),this.errorBars.dispose()),this.textMarkers&&(this.scene.glplot.remove(this.textMarkers),this.textMarkers.dispose()),this.delaunayMesh&&(this.scene.glplot.remove(this.delaunayMesh),this.delaunayMesh.dispose())},ee.exports=function(L,M){var I=new c(L,M.uid);return I.update(M),I}},{"../../../stackgl_modules":1133,"../../components/fx/helpers":403,"../../constants/gl3d_dashes":488,"../../constants/gl3d_markers":489,"../../lib":515,"../../lib/gl_format_color":511,"../../lib/str2rgbarray":540,"../../plots/cartesian/axes":566,"../scatter/make_bubble_size_func":953,"./calc_errors":966}],968:[function(y,ee,Q){"use strict";var g=y("../../registry"),v=y("../../lib"),m=y("../scatter/subtypes"),x=y("../scatter/marker_defaults"),e=y("../scatter/line_defaults"),n=y("../scatter/text_defaults"),t=y("./attributes");ee.exports=function(a,r,d,s){function i(b,l){return v.coerce(a,r,t,b,l)}if(b=a,l=r,_=s,w=0,k=(T=i)("x"),L=T("y"),M=T("z"),g.getComponentMethod("calendars","handleTraceDefaults")(b,l,["x","y","z"],_),k&&L&&M&&(w=Math.min(k.length,L.length,M.length),l._length=l._xlength=l._ylength=l._zlength=w),w){i("text"),i("hovertext"),i("hovertemplate"),i("xhoverformat"),i("yhoverformat"),i("zhoverformat"),i("mode"),m.hasLines(r)&&(i("connectgaps"),e(a,r,d,s,i)),m.hasMarkers(r)&&x(a,r,d,s,i,{noSelect:!0}),m.hasText(r)&&(i("texttemplate"),n(a,r,s,i,{noSelect:!0}));var u=(r.line||{}).color,f=(r.marker||{}).color;i("surfaceaxis")>=0&&i("surfacecolor",u||f);for(var c=["x","y","z"],h=0;h<3;++h){var p="projection."+c[h];i(p+".show")&&(i(p+".opacity"),i(p+".scale"))}var o=g.getComponentMethod("errorbars","supplyDefaults");o(a,r,u||f||d,{axis:"z"}),o(a,r,u||f||d,{axis:"y",inherit:"z"}),o(a,r,u||f||d,{axis:"x",inherit:"z"})}else r.visible=!1;var b,l,T,_,w,k,L,M}},{"../../lib":515,"../../registry":647,"../scatter/line_defaults":949,"../scatter/marker_defaults":955,"../scatter/subtypes":961,"../scatter/text_defaults":962,"./attributes":964}],969:[function(y,ee,Q){"use strict";ee.exports={plot:y("./convert"),attributes:y("./attributes"),markerSymbols:y("../../constants/gl3d_markers"),supplyDefaults:y("./defaults"),colorbar:[{container:"marker",min:"cmin",max:"cmax"},{container:"line",min:"cmin",max:"cmax"}],calc:y("./calc"),moduleType:"trace",name:"scatter3d",basePlotModule:y("../../plots/gl3d"),categories:["gl3d","symbols","showLegend","scatter-like"],meta:{}}},{"../../constants/gl3d_markers":489,"../../plots/gl3d":607,"./attributes":964,"./calc":965,"./convert":967,"./defaults":968}],970:[function(y,ee,Q){"use strict";var g=y("../scatter/attributes"),v=y("../../plots/attributes"),m=y("../../plots/template_attributes").hovertemplateAttrs,x=y("../../plots/template_attributes").texttemplateAttrs,e=y("../../components/colorscale/attributes"),n=y("../../lib/extend").extendFlat,t=g.marker,a=g.line,r=t.line;ee.exports={carpet:{valType:"string",editType:"calc"},a:{valType:"data_array",editType:"calc"},b:{valType:"data_array",editType:"calc"},mode:n({},g.mode,{dflt:"markers"}),text:n({},g.text,{}),texttemplate:x({editType:"plot"},{keys:["a","b","text"]}),hovertext:n({},g.hovertext,{}),line:{color:a.color,width:a.width,dash:a.dash,shape:n({},a.shape,{values:["linear","spline"]}),smoothing:a.smoothing,editType:"calc"},connectgaps:g.connectgaps,fill:n({},g.fill,{values:["none","toself","tonext"],dflt:"none"}),fillcolor:g.fillcolor,marker:n({symbol:t.symbol,opacity:t.opacity,maxdisplayed:t.maxdisplayed,size:t.size,sizeref:t.sizeref,sizemin:t.sizemin,sizemode:t.sizemode,line:n({width:r.width,editType:"calc"},e("marker.line")),gradient:t.gradient,editType:"calc"},e("marker")),textfont:g.textfont,textposition:g.textposition,selected:g.selected,unselected:g.unselected,hoverinfo:n({},v.hoverinfo,{flags:["a","b","text","name"]}),hoveron:g.hoveron,hovertemplate:m()}},{"../../components/colorscale/attributes":374,"../../lib/extend":505,"../../plots/attributes":562,"../../plots/template_attributes":642,"../scatter/attributes":936}],971:[function(y,ee,Q){"use strict";var g=y("fast-isnumeric"),v=y("../scatter/colorscale_calc"),m=y("../scatter/arrays_to_calcdata"),x=y("../scatter/calc_selection"),e=y("../scatter/calc").calcMarkerSize,n=y("../carpet/lookup_carpetid");ee.exports=function(t,a){var r=a._carpetTrace=n(t,a);if(r&&r.visible&&"legendonly"!==r.visible){var d;a.xaxis=r.xaxis,a.yaxis=r.yaxis;var s,i,u=a._length,f=new Array(u),c=!1;for(d=0;d<u;d++)if(i=a.b[d],g(s=a.a[d])&&g(i)){var h=r.ab2xy(+s,+i,!0),p=r.isVisible(+s,+i);p||(c=!0),f[d]={x:h[0],y:h[1],a:s,b:i,vis:p}}else f[d]={x:!1,y:!1};return a._needsCull=c,f[0].carpet=r,f[0].trace=a,e(a,u),v(t,a),m(f,a),x(f,a),f}}},{"../carpet/lookup_carpetid":717,"../scatter/arrays_to_calcdata":935,"../scatter/calc":937,"../scatter/calc_selection":938,"../scatter/colorscale_calc":939,"fast-isnumeric":190}],972:[function(y,ee,Q){"use strict";var g=y("../../lib"),v=y("../scatter/constants"),m=y("../scatter/subtypes"),x=y("../scatter/marker_defaults"),e=y("../scatter/line_defaults"),n=y("../scatter/line_shape_defaults"),t=y("../scatter/text_defaults"),a=y("../scatter/fillcolor_defaults"),r=y("./attributes");ee.exports=function(d,s,i,u){function f(b,l){return g.coerce(d,s,r,b,l)}f("carpet"),s.xaxis="x",s.yaxis="y";var c=f("a"),h=f("b"),p=Math.min(c.length,h.length);if(p){s._length=p,f("text"),f("texttemplate"),f("hovertext"),f("mode",p<v.PTS_LINESONLY?"lines+markers":"lines"),m.hasLines(s)&&(e(d,s,i,u,f),n(d,s,f),f("connectgaps")),m.hasMarkers(s)&&x(d,s,i,u,f,{gradient:!0}),m.hasText(s)&&t(d,s,u,f);var o=[];(m.hasMarkers(s)||m.hasText(s))&&(f("marker.maxdisplayed"),o.push("points")),f("fill"),"none"!==s.fill&&(a(d,s,i,f),m.hasLines(s)||n(d,s,f)),"tonext"!==s.fill&&"toself"!==s.fill||o.push("fills"),"fills"!==f("hoveron",o.join("+")||"points")&&f("hovertemplate"),g.coerceSelectionMarkerOpacity(s,f)}else s.visible=!1}},{"../../lib":515,"../scatter/constants":940,"../scatter/fillcolor_defaults":944,"../scatter/line_defaults":949,"../scatter/line_shape_defaults":951,"../scatter/marker_defaults":955,"../scatter/subtypes":961,"../scatter/text_defaults":962,"./attributes":970}],973:[function(y,ee,Q){"use strict";ee.exports=function(g,v,m,x,e){var n=x[e];return g.a=n.a,g.b=n.b,g.y=n.y,g}},{}],974:[function(y,ee,Q){"use strict";ee.exports=function(g,v){var m={},x=v._carpet,e=x.ab2ij([g.a,g.b]),n=Math.floor(e[0]),t=e[0]-n,a=Math.floor(e[1]),d=x.evalxy([],n,a,t,e[1]-a);return m.yLabel=d[1].toFixed(3),m}},{}],975:[function(y,ee,Q){"use strict";var g=y("../scatter/hover"),v=y("../../lib").fillText;ee.exports=function(m,x,e,n){var t=g(m,x,e,n);if(t&&!1!==t[0].index){var a=t[0];if(void 0===a.index){var d=m.xa._length,s=d*(1-a.y0/m.ya._length)/2,i=d-s;return a.x0=Math.max(Math.min(a.x0,i),s),a.x1=Math.max(Math.min(a.x1,i),s),t}var u=a.cd[a.index];a.a=u.a,a.b=u.b,a.xLabelVal=void 0,a.yLabelVal=void 0;var f=a.trace,c=f._carpet,h=f._module.formatLabels(u,f);a.yLabel=h.yLabel,delete a.text;var p=[];if(!f.hovertemplate){var o=(u.hi||f.hoverinfo).split("+");-1!==o.indexOf("all")&&(o=["a","b","text"]),-1!==o.indexOf("a")&&b(c.aaxis,u.a),-1!==o.indexOf("b")&&b(c.baxis,u.b),p.push("y: "+a.yLabel),-1!==o.indexOf("text")&&v(u,f,p),a.extraText=p.join("<br>")}return t}function b(l,T){var _;_=l.labelprefix&&l.labelprefix.length>0?l.labelprefix.replace(/ = $/,""):l._hovertitle,p.push(_+": "+T.toFixed(3)+l.labelsuffix)}}},{"../../lib":515,"../scatter/hover":947}],976:[function(y,ee,Q){"use strict";ee.exports={attributes:y("./attributes"),supplyDefaults:y("./defaults"),colorbar:y("../scatter/marker_colorbar"),formatLabels:y("./format_labels"),calc:y("./calc"),plot:y("./plot"),style:y("../scatter/style").style,styleOnSelect:y("../scatter/style").styleOnSelect,hoverPoints:y("./hover"),selectPoints:y("../scatter/select"),eventData:y("./event_data"),moduleType:"trace",name:"scattercarpet",basePlotModule:y("../../plots/cartesian"),categories:["svg","carpet","symbols","showLegend","carpetDependent","zoomScale"],meta:{}}},{"../../plots/cartesian":578,"../scatter/marker_colorbar":954,"../scatter/select":958,"../scatter/style":960,"./attributes":970,"./calc":971,"./defaults":972,"./event_data":973,"./format_labels":974,"./hover":975,"./plot":977}],977:[function(y,ee,Q){"use strict";var g=y("../scatter/plot"),v=y("../../plots/cartesian/axes"),m=y("../../components/drawing");ee.exports=function(x,e,n,t){var a,d,s=n[0][0].carpet,i={xaxis:v.getFromId(x,s.xaxis||"x"),yaxis:v.getFromId(x,s.yaxis||"y"),plot:e.plot};for(g(x,i,n,t),a=0;a<n.length;a++)d=t.selectAll("g.trace"+n[a][0].trace.uid+" .js-line"),m.setClipUrl(d,n[a][0].carpet._clipPathId,x)}},{"../../components/drawing":389,"../../plots/cartesian/axes":566,"../scatter/plot":957}],978:[function(y,ee,Q){"use strict";var g=y("../../plots/template_attributes").hovertemplateAttrs,v=y("../../plots/template_attributes").texttemplateAttrs,m=y("../scatter/attributes"),x=y("../../plots/attributes"),e=y("../../components/colorscale/attributes"),n=y("../../components/drawing/attributes").dash,t=y("../../lib/extend").extendFlat,a=y("../../plot_api/edit_types").overrideAll,r=m.marker,d=m.line,s=r.line;ee.exports=a({lon:{valType:"data_array"},lat:{valType:"data_array"},locations:{valType:"data_array"},locationmode:{valType:"enumerated",values:["ISO-3","USA-states","country names","geojson-id"],dflt:"ISO-3"},geojson:{valType:"any",editType:"calc"},featureidkey:{valType:"string",editType:"calc",dflt:"id"},mode:t({},m.mode,{dflt:"markers"}),text:t({},m.text,{}),texttemplate:v({editType:"plot"},{keys:["lat","lon","location","text"]}),hovertext:t({},m.hovertext,{}),textfont:m.textfont,textposition:m.textposition,line:{color:d.color,width:d.width,dash:n},connectgaps:m.connectgaps,marker:t({symbol:r.symbol,opacity:r.opacity,size:r.size,sizeref:r.sizeref,sizemin:r.sizemin,sizemode:r.sizemode,colorbar:r.colorbar,line:t({width:s.width},e("marker.line")),gradient:r.gradient},e("marker")),fill:{valType:"enumerated",values:["none","toself"],dflt:"none"},fillcolor:m.fillcolor,selected:m.selected,unselected:m.unselected,hoverinfo:t({},x.hoverinfo,{flags:["lon","lat","location","text","name"]}),hovertemplate:g()},"calc","nested")},{"../../components/colorscale/attributes":374,"../../components/drawing/attributes":388,"../../lib/extend":505,"../../plot_api/edit_types":548,"../../plots/attributes":562,"../../plots/template_attributes":642,"../scatter/attributes":936}],979:[function(y,ee,Q){"use strict";var g=y("fast-isnumeric"),v=y("../../constants/numerical").BADNUM,m=y("../scatter/colorscale_calc"),x=y("../scatter/arrays_to_calcdata"),e=y("../scatter/calc_selection"),n=y("../../lib")._;function t(a){return a&&"string"==typeof a}ee.exports=function(a,r){var d,s=Array.isArray(r.locations),i=s?r.locations.length:r._length,u=new Array(i);d=r.geojson?function(b){return t(b)||g(b)}:t;for(var f=0;f<i;f++){var c=u[f]={};if(s){var h=r.locations[f];c.loc=d(h)?h:null}else{var p=r.lon[f],o=r.lat[f];c.lonlat=g(p)&&g(o)?[+p,+o]:[v,v]}}return x(u,r),m(a,r),e(u,r),i&&(u[0].t={labels:{lat:n(a,"lat:")+" ",lon:n(a,"lon:")+" "}}),u}},{"../../constants/numerical":491,"../../lib":515,"../scatter/arrays_to_calcdata":935,"../scatter/calc_selection":938,"../scatter/colorscale_calc":939,"fast-isnumeric":190}],980:[function(y,ee,Q){"use strict";var g=y("../../lib"),v=y("../scatter/subtypes"),m=y("../scatter/marker_defaults"),x=y("../scatter/line_defaults"),e=y("../scatter/text_defaults"),n=y("../scatter/fillcolor_defaults"),t=y("./attributes");ee.exports=function(a,r,d,s){function i(b,l){return g.coerce(a,r,t,b,l)}var u,f=i("locations");if(f&&f.length){var c,h=i("geojson");("string"==typeof h&&""!==h||g.isPlainObject(h))&&(c="geojson-id"),"geojson-id"===i("locationmode",c)&&i("featureidkey"),u=f.length}else{var p=i("lon")||[],o=i("lat")||[];u=Math.min(p.length,o.length)}u?(r._length=u,i("text"),i("hovertext"),i("hovertemplate"),i("mode"),v.hasLines(r)&&(x(a,r,d,s,i),i("connectgaps")),v.hasMarkers(r)&&m(a,r,d,s,i,{gradient:!0}),v.hasText(r)&&(i("texttemplate"),e(a,r,s,i)),i("fill"),"none"!==r.fill&&n(a,r,d,i),g.coerceSelectionMarkerOpacity(r,i)):r.visible=!1}},{"../../lib":515,"../scatter/fillcolor_defaults":944,"../scatter/line_defaults":949,"../scatter/marker_defaults":955,"../scatter/subtypes":961,"../scatter/text_defaults":962,"./attributes":978}],981:[function(y,ee,Q){"use strict";ee.exports=function(g,v,m,x,e){g.lon=v.lon,g.lat=v.lat,g.location=v.loc?v.loc:null;var n=x[e];return n.fIn&&n.fIn.properties&&(g.properties=n.fIn.properties),g}},{}],982:[function(y,ee,Q){"use strict";var g=y("../../plots/cartesian/axes");ee.exports=function(v,m,x){var e={},n=x[m.geo]._subplot.mockAxis,t=v.lonlat;return e.lonLabel=g.tickText(n,n.c2l(t[0]),!0).text,e.latLabel=g.tickText(n,n.c2l(t[1]),!0).text,e}},{"../../plots/cartesian/axes":566}],983:[function(y,ee,Q){"use strict";var g=y("../../components/fx"),v=y("../../constants/numerical").BADNUM,m=y("../scatter/get_trace_color"),x=y("../../lib").fillText,e=y("./attributes");ee.exports=function(n,t,a){var r=n.cd,d=r[0].trace,s=n.xa,i=n.ya,u=n.subplot,f=u.projection.isLonLatOverEdges,c=u.project;if(g.getClosest(r,function(_){var w=_.lonlat;if(w[0]===v||f(w))return 1/0;var k=c(w),L=c([t,a]),M=Math.abs(k[0]-L[0]),I=Math.abs(k[1]-L[1]),P=Math.max(3,_.mrc||0);return Math.max(Math.sqrt(M*M+I*I)-P,1-3/P)},n),!1!==n.index){var h=r[n.index],p=h.lonlat,o=[s.c2p(p),i.c2p(p)],b=h.mrc||1;n.x0=o[0]-b,n.x1=o[0]+b,n.y0=o[1]-b,n.y1=o[1]+b,n.loc=h.loc,n.lon=p[0],n.lat=p[1];var l={};l[d.geo]={_subplot:u};var T=d._module.formatLabels(h,d,l);return n.lonLabel=T.lonLabel,n.latLabel=T.latLabel,n.color=m(d,h),n.extraText=function(_,w,k,L){if(!_.hovertemplate){var M=w.hi||_.hoverinfo,I="all"===M?e.hoverinfo.flags:M.split("+"),P=-1!==I.indexOf("location")&&Array.isArray(_.locations),S=-1!==I.indexOf("lon"),E=-1!==I.indexOf("lat"),z=-1!==I.indexOf("text"),R=[];return P?R.push(w.loc):S&&E?R.push("("+q(k.latLabel)+", "+q(k.lonLabel)+")"):S?R.push(L.lon+q(k.lonLabel)):E&&R.push(L.lat+q(k.latLabel)),z&&x(w,_,R),R.join("<br>")}function q(V){return V+"\xb0"}}(d,h,n,r[0].t.labels),n.hovertemplate=d.hovertemplate,[n]}}},{"../../components/fx":407,"../../constants/numerical":491,"../../lib":515,"../scatter/get_trace_color":946,"./attributes":978}],984:[function(y,ee,Q){"use strict";ee.exports={attributes:y("./attributes"),supplyDefaults:y("./defaults"),colorbar:y("../scatter/marker_colorbar"),formatLabels:y("./format_labels"),calc:y("./calc"),calcGeoJSON:y("./plot").calcGeoJSON,plot:y("./plot").plot,style:y("./style"),styleOnSelect:y("../scatter/style").styleOnSelect,hoverPoints:y("./hover"),eventData:y("./event_data"),selectPoints:y("./select"),moduleType:"trace",name:"scattergeo",basePlotModule:y("../../plots/geo"),categories:["geo","symbols","showLegend","scatter-like"],meta:{}}},{"../../plots/geo":598,"../scatter/marker_colorbar":954,"../scatter/style":960,"./attributes":978,"./calc":979,"./defaults":980,"./event_data":981,"./format_labels":982,"./hover":983,"./plot":985,"./select":986,"./style":987}],985:[function(y,ee,Q){"use strict";var g=y("@plotly/d3"),v=y("../../lib"),m=y("../../lib/topojson_utils").getTopojsonFeatures,x=y("../../lib/geojson_utils"),e=y("../../lib/geo_location_utils"),n=y("../../plots/cartesian/autorange").findExtremes,t=y("../../constants/numerical").BADNUM,a=y("../scatter/calc").calcMarkerSize,r=y("../scatter/subtypes"),d=y("./style");ee.exports={calcGeoJSON:function(s,i){var u,f,c=s[0].trace,h=i[c.geo],p=h._subplot,o=c._length;if(Array.isArray(c.locations)){var b=c.locationmode,l="geojson-id"===b?e.extractTraceFeature(s):m(c,p.topojson);for(u=0;u<o;u++){f=s[u];var T="geojson-id"===b?f.fOut:e.locationToFeature(b,f.loc,l);f.lonlat=T?T.properties.ct:[t,t]}}var _,w,k={padded:!0};if("geojson"===h.fitbounds&&"geojson-id"===c.locationmode){var L=e.computeBbox(e.getTraceGeojson(c));_=[L[0],L[2]],w=[L[1],L[3]]}else{for(_=new Array(o),w=new Array(o),u=0;u<o;u++)_[u]=(f=s[u]).lonlat[0],w[u]=f.lonlat[1];k.ppad=a(c,o)}c._extremes.lon=n(h.lonaxis._ax,_,k),c._extremes.lat=n(h.lataxis._ax,w,k)},plot:function(s,i,u){var f=i.layers.frontplot.select(".scatterlayer"),c=v.makeTraceGroups(f,u,"trace scattergeo");function h(p,o){p.lonlat[0]===t&&g.select(o).remove()}c.selectAll("*").remove(),c.each(function(p){var o=g.select(this),b=p[0].trace;if(r.hasLines(b)||"none"!==b.fill){var l=x.calcTraceToLineCoords(p),T="none"!==b.fill?x.makePolygon(l):x.makeLine(l);o.selectAll("path.js-line").data([{geojson:T,trace:b}]).enter().append("path").classed("js-line",!0).style("stroke-miterlimit",2)}r.hasMarkers(b)&&o.selectAll("path.point").data(v.identity).enter().append("path").classed("point",!0).each(function(_){h(_,this)}),r.hasText(b)&&o.selectAll("g").data(v.identity).enter().append("g").append("text").each(function(_){h(_,this)}),d(s,p)})}}},{"../../constants/numerical":491,"../../lib":515,"../../lib/geo_location_utils":508,"../../lib/geojson_utils":509,"../../lib/topojson_utils":544,"../../plots/cartesian/autorange":565,"../scatter/calc":937,"../scatter/subtypes":961,"./style":987,"@plotly/d3":58}],986:[function(y,ee,Q){"use strict";var g=y("../scatter/subtypes"),v=y("../../constants/numerical").BADNUM;ee.exports=function(m,x){var e,n,t,a,r,d=m.cd,s=m.xaxis,i=m.yaxis,u=[],f=d[0].trace;if(!g.hasMarkers(f)&&!g.hasText(f))return[];if(!1===x)for(r=0;r<d.length;r++)d[r].selected=0;else for(r=0;r<d.length;r++)(n=(e=d[r]).lonlat)[0]!==v&&(t=s.c2p(n),a=i.c2p(n),x.contains([t,a],null,r,m)?(u.push({pointNumber:r,lon:n[0],lat:n[1]}),e.selected=1):e.selected=0);return u}},{"../../constants/numerical":491,"../scatter/subtypes":961}],987:[function(y,ee,Q){"use strict";var g=y("@plotly/d3"),v=y("../../components/drawing"),m=y("../../components/color"),x=y("../scatter/style"),e=x.stylePoints,n=x.styleText;ee.exports=function(t,a){var r,d,s,i;a&&(r=t,s=(d=a)[0].trace,(i=d[0].node3).style("opacity",d[0].trace.opacity),e(i,s,r),n(i,s,r),i.selectAll("path.js-line").style("fill","none").each(function(u){var f=g.select(this),c=u.trace,h=c.line||{};f.call(m.stroke,h.color).call(v.dashLine,h.dash||"",h.width||0),"none"!==c.fill&&f.call(m.fill,c.fillcolor)}))}},{"../../components/color":367,"../../components/drawing":389,"../scatter/style":960,"@plotly/d3":58}],988:[function(y,ee,Q){"use strict";var g=y("../../plots/attributes"),v=y("../scatter/attributes"),m=y("../../plots/cartesian/axis_format_attributes").axisHoverFormat,x=y("../../components/colorscale/attributes"),e=y("../../lib/sort_object_keys"),n=y("../../lib/extend").extendFlat,t=y("../../plot_api/edit_types").overrideAll,a=y("./constants").DASHES,r=v.line,d=v.marker,s=d.line,i=ee.exports=t({x:v.x,x0:v.x0,dx:v.dx,y:v.y,y0:v.y0,dy:v.dy,xperiod:v.xperiod,yperiod:v.yperiod,xperiod0:v.xperiod0,yperiod0:v.yperiod0,xperiodalignment:v.xperiodalignment,yperiodalignment:v.yperiodalignment,xhoverformat:m("x"),yhoverformat:m("y"),text:v.text,hovertext:v.hovertext,textposition:v.textposition,textfont:v.textfont,mode:{valType:"flaglist",flags:["lines","markers","text"],extras:["none"]},line:{color:r.color,width:r.width,shape:{valType:"enumerated",values:["linear","hv","vh","hvh","vhv"],dflt:"linear",editType:"plot"},dash:{valType:"enumerated",values:e(a),dflt:"solid"}},marker:n({},x("marker"),{symbol:d.symbol,size:d.size,sizeref:d.sizeref,sizemin:d.sizemin,sizemode:d.sizemode,opacity:d.opacity,colorbar:d.colorbar,line:n({},x("marker.line"),{width:s.width})}),connectgaps:v.connectgaps,fill:n({},v.fill,{dflt:"none"}),fillcolor:v.fillcolor,selected:{marker:v.selected.marker,textfont:v.selected.textfont},unselected:{marker:v.unselected.marker,textfont:v.unselected.textfont},opacity:g.opacity},"calc","nested");i.x.editType=i.y.editType=i.x0.editType=i.y0.editType="calc+clearAxisTypes",i.hovertemplate=v.hovertemplate,i.texttemplate=v.texttemplate},{"../../components/colorscale/attributes":374,"../../lib/extend":505,"../../lib/sort_object_keys":538,"../../plot_api/edit_types":548,"../../plots/attributes":562,"../../plots/cartesian/axis_format_attributes":569,"../scatter/attributes":936,"./constants":991}],989:[function(y,ee,Q){"use strict";var g=y("./hover");ee.exports={moduleType:"trace",name:"scattergl",basePlotModule:y("../../plots/cartesian"),categories:["gl","regl","cartesian","symbols","errorBarsOK","showLegend","scatter-like"],attributes:y("./attributes"),supplyDefaults:y("./defaults"),crossTraceDefaults:y("../scatter/cross_trace_defaults"),colorbar:y("../scatter/marker_colorbar"),formatLabels:y("./format_labels"),calc:y("./calc"),hoverPoints:g.hoverPoints,selectPoints:y("./select"),meta:{}}},{"../../plots/cartesian":578,"../scatter/cross_trace_defaults":942,"../scatter/marker_colorbar":954,"./attributes":988,"./calc":990,"./defaults":993,"./format_labels":995,"./hover":997,"./select":1001}],990:[function(y,ee,Q){"use strict";var g=y("@plotly/point-cluster"),v=y("../../lib"),m=y("../../plots/cartesian/axis_ids"),x=y("../../plots/cartesian/autorange").findExtremes,e=y("../../plots/cartesian/align_period"),n=y("../scatter/calc"),t=n.calcMarkerSize,a=n.calcAxisExpansion,r=n.setFirstScatter,d=y("../scatter/colorscale_calc"),s=y("./convert"),i=y("./scene_update"),u=y("../../constants/numerical").BADNUM,f=y("./constants").TOO_MANY_POINTS;function c(h,p,o){var b=h._extremes[p._id],l=x(p,o._bnds,{padded:!0});b.min=b.min.concat(l.min),b.max=b.max.concat(l.max)}ee.exports=function(h,p){var o,b=h._fullLayout,l=m.getFromId(h,p.xaxis),T=m.getFromId(h,p.yaxis),_=b._plots[p.xaxis+p.yaxis],w=p._length,k=w>=f,L=2*w,M={},I=l.makeCalcdata(p,"x"),P=T.makeCalcdata(p,"y"),S=e(p,l,"x",I),E=e(p,T,"y",P),z=S.vals,R=E.vals;p._x=z,p._y=R,p.xperiodalignment&&(p._origX=I,p._xStarts=S.starts,p._xEnds=S.ends),p.yperiodalignment&&(p._origY=P,p._yStarts=E.starts,p._yEnds=E.ends);var q=new Array(L),V=new Array(w);for(o=0;o<w;o++)q[2*o]=z[o]===u?NaN:z[o],q[2*o+1]=R[o]===u?NaN:R[o],V[o]=o;if("log"===l.type)for(o=0;o<L;o+=2)q[o]=l.c2l(q[o]);if("log"===T.type)for(o=1;o<L;o+=2)q[o]=T.c2l(q[o]);k&&"log"!==l.type&&"log"!==T.type?M.tree=g(q):M.ids=V,d(h,p);var W,K=function(Y,$,B,N,U,te){var j=s.style(Y,B);if(j.marker&&(j.marker.positions=N),j.line&&N.length>1&&v.extendFlat(j.line,s.linePositions(Y,B,N)),j.errorX||j.errorY){var J=s.errorBarPositions(Y,B,N,U,te);j.errorX&&v.extendFlat(j.errorX,J.x),j.errorY&&v.extendFlat(j.errorY,J.y)}return j.text&&(v.extendFlat(j.text,{positions:N},s.textPosition(Y,B,j.text,j.marker)),v.extendFlat(j.textSel,{positions:N},s.textPosition(Y,B,j.text,j.markerSel)),v.extendFlat(j.textUnsel,{positions:N},s.textPosition(Y,B,j.text,j.markerUnsel))),j}(h,0,p,q,z,R),G=i(h,_);return r(b,p),k?K.marker&&(W=K.marker.sizeAvg||Math.max(K.marker.size,3)):W=t(p,w),a(h,p,l,T,z,R,W),K.errorX&&c(p,l,K.errorX),K.errorY&&c(p,T,K.errorY),K.fill&&!G.fill2d&&(G.fill2d=!0),K.marker&&!G.scatter2d&&(G.scatter2d=!0),K.line&&!G.line2d&&(G.line2d=!0),!K.errorX&&!K.errorY||G.error2d||(G.error2d=!0),K.text&&!G.glText&&(G.glText=!0),K.marker&&(K.marker.snap=w),G.lineOptions.push(K.line),G.errorXOptions.push(K.errorX),G.errorYOptions.push(K.errorY),G.fillOptions.push(K.fill),G.markerOptions.push(K.marker),G.markerSelectedOptions.push(K.markerSel),G.markerUnselectedOptions.push(K.markerUnsel),G.textOptions.push(K.text),G.textSelectedOptions.push(K.textSel),G.textUnselectedOptions.push(K.textUnsel),G.selectBatch.push([]),G.unselectBatch.push([]),M._scene=G,M.index=G.count,M.x=z,M.y=R,M.positions=q,G.count++,[{x:!1,y:!1,t:M,trace:p}]}},{"../../constants/numerical":491,"../../lib":515,"../../plots/cartesian/align_period":563,"../../plots/cartesian/autorange":565,"../../plots/cartesian/axis_ids":570,"../scatter/calc":937,"../scatter/colorscale_calc":939,"./constants":991,"./convert":992,"./scene_update":1e3,"@plotly/point-cluster":59}],991:[function(y,ee,Q){"use strict";ee.exports={TOO_MANY_POINTS:1e5,SYMBOL_SDF_SIZE:200,SYMBOL_SIZE:20,SYMBOL_STROKE:1,DOT_RE:/-dot/,OPEN_RE:/-open/,DASHES:{solid:[1],dot:[1,1],dash:[4,1],longdash:[8,1],dashdot:[4,1,1,1],longdashdot:[8,1,1,1]}}},{}],992:[function(y,ee,Q){"use strict";var g=y("fast-isnumeric"),v=y("svg-path-sdf"),m=y("color-normalize"),x=y("../../registry"),e=y("../../lib"),n=y("../../components/drawing"),t=y("../../plots/cartesian/axis_ids"),a=y("../../lib/gl_format_color").formatColor,r=y("../scatter/subtypes"),d=y("../scatter/make_bubble_size_func"),s=y("./helpers"),i=y("./constants"),u=y("../../constants/interactions").DESELECTDIM,f={start:1,left:1,end:-1,right:-1,middle:0,center:0,bottom:1,top:-1},c=y("../../components/fx/helpers").appendArrayPointValue;function h(I,P){var S,E=I._fullLayout,z=P._length,R=P.textfont,q=P.textposition,V=Array.isArray(q)?q:[q],W=R.color,K=R.size,G=R.family,Y={},$=I._context.plotGlPixelRatio,B=P.texttemplate;if(B){Y.text=[];var N=E._d3locale,U=Array.isArray(B),te=U?Math.min(B.length,z):z,j=U?function(de){return B[de]}:function(){return B};for(S=0;S<te;S++){var J={i:S},X=P._module.formatLabels(J,P,E),re={};c(re,P,S);var ne=P._meta||{};Y.text.push(e.texttemplateString(j(S),X,N,re,J,ne))}}else Y.text=Array.isArray(P.text)&&P.text.length<z?P.text.slice():P.text;if(Array.isArray(Y.text))for(S=Y.text.length;S<z;S++)Y.text[S]="";for(Y.opacity=P.opacity,Y.font={},Y.align=[],Y.baseline=[],S=0;S<V.length;S++){var le=V[S].split(/\s+/);switch(le[1]){case"left":Y.align.push("right");break;case"right":Y.align.push("left");break;default:Y.align.push(le[1])}switch(le[0]){case"top":Y.baseline.push("bottom");break;case"bottom":Y.baseline.push("top");break;default:Y.baseline.push(le[0])}}if(Array.isArray(W))for(Y.color=new Array(z),S=0;S<z;S++)Y.color[S]=W[S];else Y.color=W;if(e.isArrayOrTypedArray(K)||Array.isArray(G))for(Y.font=new Array(z),S=0;S<z;S++){var oe=Y.font[S]={};oe.size=(e.isTypedArray(K)?K[S]:Array.isArray(K)?g(K[S])?K[S]:0:K)*$,oe.family=Array.isArray(G)?G[S]:G}else Y.font={size:K*$,family:G};return Y}function p(I){var P,S,E=I._length,z=I.marker,R={},q=e.isArrayOrTypedArray(z.symbol),V=e.isArrayOrTypedArray(z.color),W=e.isArrayOrTypedArray(z.line.color),K=e.isArrayOrTypedArray(z.opacity),G=e.isArrayOrTypedArray(z.size),Y=e.isArrayOrTypedArray(z.line.width);if(q||(S=s.isOpenSymbol(z.symbol)),q||V||W||K){R.colors=new Array(E),R.borderColors=new Array(E);var $=a(z,z.opacity,E),B=a(z.line,z.opacity,E);if(!Array.isArray(B[0])){var N=B;for(B=Array(E),P=0;P<E;P++)B[P]=N}if(!Array.isArray($[0])){var U=$;for($=Array(E),P=0;P<E;P++)$[P]=U}for(R.colors=$,R.borderColors=B,P=0;P<E;P++)q&&(S=s.isOpenSymbol(z.symbol[P])),S&&(B[P]=$[P].slice(),$[P]=$[P].slice(),$[P][3]=0);R.opacity=I.opacity}else S?(R.color=m(z.color,"uint8"),R.color[3]=0,R.borderColor=m(z.color,"uint8")):(R.color=m(z.color,"uint8"),R.borderColor=m(z.line.color,"uint8")),R.opacity=I.opacity*z.opacity;if(q)for(R.markers=new Array(E),P=0;P<E;P++)R.markers[P]=M(z.symbol[P]);else R.marker=M(z.symbol);var j,J=d(I,1);if(G||Y){var X,re=R.sizes=new Array(E),ne=R.borderSizes=new Array(E),le=0;if(G){for(P=0;P<E;P++)re[P]=J(z.size[P]),le+=re[P];X=le/E}else for(j=J(z.size),P=0;P<E;P++)re[P]=j;if(Y)for(P=0;P<E;P++)ne[P]=z.line.width[P];else for(j=z.line.width,P=0;P<E;P++)ne[P]=j;R.sizeAvg=X}else R.size=J(z&&z.size||10),R.borderSizes=J(z.line.width);return R}function o(I,P){var E={};return P&&(P.marker&&P.marker.symbol?E=p(e.extendFlat({},I.marker,P.marker)):P.marker&&(P.marker.size&&(E.size=P.marker.size),P.marker.color&&(E.colors=P.marker.color),void 0!==P.marker.opacity&&(E.opacity=P.marker.opacity))),E}function b(I,P,S){var E={};if(!S)return E;if(S.textfont){var z={opacity:1,text:P.text,texttemplate:P.texttemplate,textposition:P.textposition,textfont:e.extendFlat({},P.textfont)};S.textfont&&e.extendFlat(z.textfont,S.textfont),E=h(I,z)}return E}function l(I,P,S){var E={capSize:2*P.width*S,lineWidth:P.thickness*S,color:P.color};return P.copy_ystyle&&(E=I.error_y),E}var T=i.SYMBOL_SDF_SIZE,_=i.SYMBOL_SIZE,w=i.SYMBOL_STROKE,k={},L=n.symbolFuncs[0](.05*_);function M(I){if("circle"===I)return null;var P,S,E=n.symbolNumber(I),z=n.symbolFuncs[E%100],R=!!n.symbolNoDot[E%100],q=!!n.symbolNoFill[E%100],V=s.isDotSymbol(I);return k[I]?k[I]:(P=V&&!R?z(1.1*_)+L:z(_),S=v(P,{w:T,h:T,viewBox:[-_,-_,_,_],stroke:q?w:-w}),k[I]=S,S||null)}ee.exports={style:function(I,P){var S,E={marker:void 0,markerSel:void 0,markerUnsel:void 0,line:void 0,fill:void 0,errorX:void 0,errorY:void 0,text:void 0,textSel:void 0,textUnsel:void 0},z=I._context.plotGlPixelRatio;if(!0!==P.visible)return E;if(r.hasText(P)&&(E.text=h(I,P),E.textSel=b(I,P,P.selected),E.textUnsel=b(I,P,P.unselected)),r.hasMarkers(P)&&(E.marker=p(P),E.markerSel=o(P,P.selected),E.markerUnsel=o(P,P.unselected),!P.unselected&&e.isArrayOrTypedArray(P.marker.opacity))){var R=P.marker.opacity;for(E.markerUnsel.opacity=new Array(R.length),S=0;S<R.length;S++)E.markerUnsel.opacity[S]=u*R[S]}if(r.hasLines(P)){E.line={overlay:!0,thickness:P.line.width*z,color:P.line.color,opacity:P.opacity};var q=(i.DASHES[P.line.dash]||[1]).slice();for(S=0;S<q.length;++S)q[S]*=P.line.width*z;E.line.dashes=q}return P.error_x&&P.error_x.visible&&(E.errorX=l(P,P.error_x,z)),P.error_y&&P.error_y.visible&&(E.errorY=l(P,P.error_y,z)),P.fill&&"none"!==P.fill&&(E.fill={closed:!0,fill:P.fillcolor,thickness:0}),E},markerStyle:p,markerSelection:o,linePositions:function(I,P,S){var E,z,R=S.length,q=R/2;if(r.hasLines(P)&&q)if("hv"===P.line.shape){for(E=[],z=0;z<q-1;z++)isNaN(S[2*z])||isNaN(S[2*z+1])?E.push(NaN,NaN,NaN,NaN):(E.push(S[2*z],S[2*z+1]),isNaN(S[2*z+2])||isNaN(S[2*z+3])?E.push(NaN,NaN):E.push(S[2*z+2],S[2*z+1]));E.push(S[R-2],S[R-1])}else if("hvh"===P.line.shape){for(E=[],z=0;z<q-1;z++)if(isNaN(S[2*z])||isNaN(S[2*z+1])||isNaN(S[2*z+2])||isNaN(S[2*z+3]))isNaN(S[2*z])||isNaN(S[2*z+1])?E.push(NaN,NaN):E.push(S[2*z],S[2*z+1]),E.push(NaN,NaN);else{var V=(S[2*z]+S[2*z+2])/2;E.push(S[2*z],S[2*z+1],V,S[2*z+1],V,S[2*z+3])}E.push(S[R-2],S[R-1])}else if("vhv"===P.line.shape){for(E=[],z=0;z<q-1;z++)if(isNaN(S[2*z])||isNaN(S[2*z+1])||isNaN(S[2*z+2])||isNaN(S[2*z+3]))isNaN(S[2*z])||isNaN(S[2*z+1])?E.push(NaN,NaN):E.push(S[2*z],S[2*z+1]),E.push(NaN,NaN);else{var W=(S[2*z+1]+S[2*z+3])/2;E.push(S[2*z],S[2*z+1],S[2*z],W,S[2*z+2],W)}E.push(S[R-2],S[R-1])}else if("vh"===P.line.shape){for(E=[],z=0;z<q-1;z++)isNaN(S[2*z])||isNaN(S[2*z+1])?E.push(NaN,NaN,NaN,NaN):(E.push(S[2*z],S[2*z+1]),isNaN(S[2*z+2])||isNaN(S[2*z+3])?E.push(NaN,NaN):E.push(S[2*z],S[2*z+3]));E.push(S[R-2],S[R-1])}else E=S;var K=!1;for(z=0;z<E.length;z++)if(isNaN(E[z])){K=!0;break}var G=K||E.length>i.TOO_MANY_POINTS||r.hasMarkers(P)?"rect":"round";if(K&&P.connectgaps){var Y=E[0],$=E[1];for(z=0;z<E.length;z+=2)isNaN(E[z])||isNaN(E[z+1])?(E[z]=Y,E[z+1]=$):(Y=E[z],$=E[z+1])}return{join:G,positions:E}},errorBarPositions:function(I,P,S,E,z){var R=x.getComponentMethod("errorbars","makeComputeError"),q=t.getFromId(I,P.xaxis),V=t.getFromId(I,P.yaxis),W=S.length/2,K={};function G(Y,$){var B=$._id.charAt(0),N=P["error_"+B];if(N&&N.visible&&("linear"===$.type||"log"===$.type)){for(var U=R(N),te={x:0,y:1}[B],j={x:[0,1,2,3],y:[2,3,0,1]}[B],J=new Float64Array(4*W),X=1/0,re=-1/0,ne=0,le=0;ne<W;ne++,le+=4){var oe=Y[ne];if(g(oe)){var de=S[2*ne+te],se=U(oe,ne),ge=se[0],_e=se[1];if(g(ge)&&g(_e)){var we=oe+_e;J[le+j[0]]=de-$.c2l(oe-ge),J[le+j[1]]=$.c2l(we)-de,J[le+j[2]]=0,J[le+j[3]]=0,X=Math.min(X,oe-ge),re=Math.max(re,oe+_e)}}}K[B]={positions:S,errors:J,_bnds:[X,re]}}}return G(E,q),G(z,V),K},textPosition:function(I,P,S,E){var z,R=P._length,q={};if(r.hasMarkers(P)){var V=S.font,W=S.align,K=S.baseline;for(q.offset=new Array(R),z=0;z<R;z++){var G=E.sizes?E.sizes[z]:E.size,Y=Array.isArray(V)?V[z].size:V.size,$=Array.isArray(W)?W.length>1?W[z]:W[0]:W,B=Array.isArray(K)?K.length>1?K[z]:K[0]:K,U=f[B],te=G?G/.8+1:0;q.offset[z]=[f[$]*te/Y,(-U*te-.5*U)/Y]}}return q}}},{"../../components/drawing":389,"../../components/fx/helpers":403,"../../constants/interactions":490,"../../lib":515,"../../lib/gl_format_color":511,"../../plots/cartesian/axis_ids":570,"../../registry":647,"../scatter/make_bubble_size_func":953,"../scatter/subtypes":961,"./constants":991,"./helpers":996,"color-normalize":89,"fast-isnumeric":190,"svg-path-sdf":311}],993:[function(y,ee,Q){"use strict";var g=y("../../lib"),v=y("../../registry"),m=y("./helpers"),x=y("./attributes"),e=y("../scatter/constants"),n=y("../scatter/subtypes"),t=y("../scatter/xy_defaults"),a=y("../scatter/period_defaults"),r=y("../scatter/marker_defaults"),d=y("../scatter/line_defaults"),s=y("../scatter/fillcolor_defaults"),i=y("../scatter/text_defaults");ee.exports=function(u,f,c,h){function p(L,M){return g.coerce(u,f,x,L,M)}var o=!!u.marker&&m.isOpenSymbol(u.marker.symbol),b=n.isBubble(u),l=t(u,f,h,p);if(l){a(u,f,h,p),p("xhoverformat"),p("yhoverformat");var T=l<e.PTS_LINESONLY?"lines+markers":"lines";p("text"),p("hovertext"),p("hovertemplate"),p("mode",T),n.hasLines(f)&&(p("connectgaps"),d(u,f,c,h,p),p("line.shape")),n.hasMarkers(f)&&(r(u,f,c,h,p),p("marker.line.width",o||b?1:0)),n.hasText(f)&&(p("texttemplate"),i(u,f,h,p));var _=(f.line||{}).color,w=(f.marker||{}).color;p("fill"),"none"!==f.fill&&s(u,f,c,p);var k=v.getComponentMethod("errorbars","supplyDefaults");k(u,f,_||w||c,{axis:"y"}),k(u,f,_||w||c,{axis:"x",inherit:"y"}),g.coerceSelectionMarkerOpacity(f,p)}else f.visible=!1}},{"../../lib":515,"../../registry":647,"../scatter/constants":940,"../scatter/fillcolor_defaults":944,"../scatter/line_defaults":949,"../scatter/marker_defaults":955,"../scatter/period_defaults":956,"../scatter/subtypes":961,"../scatter/text_defaults":962,"../scatter/xy_defaults":963,"./attributes":988,"./helpers":996}],994:[function(y,ee,Q){"use strict";var g=y("../../lib"),v=y("../../components/color"),m=y("../../constants/interactions").DESELECTDIM;ee.exports={styleTextSelection:function(x){var e,n,t=x[0],a=t.trace,r=t.t,d=r._scene,s=r.index,i=d.selectBatch[s],u=d.unselectBatch[s],f=d.textOptions[s],c=d.textSelectedOptions[s]||{},h=d.textUnselectedOptions[s]||{},p=g.extendFlat({},f);if(i.length||u.length){var o=c.color,b=h.color,l=f.color,T=Array.isArray(l);for(p.color=new Array(a._length),e=0;e<i.length;e++)p.color[n=i[e]]=o||(T?l[n]:l);for(e=0;e<u.length;e++){n=u[e];var _=T?l[n]:l;p.color[n]=b||(o?_:v.addOpacity(_,m))}}d.glText[s].update(p)}}},{"../../components/color":367,"../../constants/interactions":490,"../../lib":515}],995:[function(y,ee,Q){"use strict";var g=y("../scatter/format_labels");ee.exports=function(v,m,x){var e=v.i;return"x"in v||(v.x=m._x[e]),"y"in v||(v.y=m._y[e]),g(v,m,x)}},{"../scatter/format_labels":945}],996:[function(y,ee,Q){"use strict";var g=y("./constants");Q.isOpenSymbol=function(v){return"string"==typeof v?g.OPEN_RE.test(v):v%200>100},Q.isDotSymbol=function(v){return"string"==typeof v?g.DOT_RE.test(v):v>200}},{"./constants":991}],997:[function(y,ee,Q){"use strict";var g=y("../../registry"),v=y("../../lib"),m=y("../scatter/get_trace_color");function x(e,n,t,a){var r=e.xa,d=e.ya,s=e.distance,i=e.dxy,u=e.index,f={pointNumber:u,x:n[u],y:t[u]};f.tx=Array.isArray(a.text)?a.text[u]:a.text,f.htx=Array.isArray(a.hovertext)?a.hovertext[u]:a.hovertext,f.data=Array.isArray(a.customdata)?a.customdata[u]:a.customdata,f.tp=Array.isArray(a.textposition)?a.textposition[u]:a.textposition;var c=a.textfont;c&&(f.ts=v.isArrayOrTypedArray(c.size)?c.size[u]:c.size,f.tc=Array.isArray(c.color)?c.color[u]:c.color,f.tf=Array.isArray(c.family)?c.family[u]:c.family);var h=a.marker;h&&(f.ms=v.isArrayOrTypedArray(h.size)?h.size[u]:h.size,f.mo=v.isArrayOrTypedArray(h.opacity)?h.opacity[u]:h.opacity,f.mx=v.isArrayOrTypedArray(h.symbol)?h.symbol[u]:h.symbol,f.mc=v.isArrayOrTypedArray(h.color)?h.color[u]:h.color);var p=h&&h.line;p&&(f.mlc=Array.isArray(p.color)?p.color[u]:p.color,f.mlw=v.isArrayOrTypedArray(p.width)?p.width[u]:p.width);var o=h&&h.gradient;o&&"none"!==o.type&&(f.mgt=Array.isArray(o.type)?o.type[u]:o.type,f.mgc=Array.isArray(o.color)?o.color[u]:o.color);var b=r.c2p(f.x,!0),l=d.c2p(f.y,!0),T=f.mrc||1,_=a.hoverlabel;_&&(f.hbg=Array.isArray(_.bgcolor)?_.bgcolor[u]:_.bgcolor,f.hbc=Array.isArray(_.bordercolor)?_.bordercolor[u]:_.bordercolor,f.hts=v.isArrayOrTypedArray(_.font.size)?_.font.size[u]:_.font.size,f.htc=Array.isArray(_.font.color)?_.font.color[u]:_.font.color,f.htf=Array.isArray(_.font.family)?_.font.family[u]:_.font.family,f.hnl=v.isArrayOrTypedArray(_.namelength)?_.namelength[u]:_.namelength);var w=a.hoverinfo;w&&(f.hi=Array.isArray(w)?w[u]:w);var k=a.hovertemplate;k&&(f.ht=Array.isArray(k)?k[u]:k);var L={};L[e.index]=f;var M=a._origX,I=a._origY,P=v.extendFlat({},e,{color:m(a,f),x0:b-T,x1:b+T,xLabelVal:M?M[u]:f.x,y0:l-T,y1:l+T,yLabelVal:I?I[u]:f.y,cd:L,distance:s,spikeDistance:i,hovertemplate:f.ht});return f.htx?P.text=f.htx:f.tx?P.text=f.tx:a.text&&(P.text=a.text),v.fillText(f,a,P),g.getComponentMethod("errorbars","hoverInfo")(f,a,P),P}ee.exports={hoverPoints:function(e,n,t,a){var r,d,s,i,u,f,c,h,p,o,b=e.cd,l=b[0].t,T=b[0].trace,_=e.xa,w=e.ya,k=l.x,L=l.y,M=_.c2p(n),I=w.c2p(t),P=e.distance;if(l.tree){var S=_.p2c(M-P),E=_.p2c(M+P),z=w.p2c(I-P),R=w.p2c(I+P);r="x"===a?l.tree.range(Math.min(S,E),Math.min(w._rl[0],w._rl[1]),Math.max(S,E),Math.max(w._rl[0],w._rl[1])):l.tree.range(Math.min(S,E),Math.min(z,R),Math.max(S,E),Math.max(z,R))}else r=l.ids;var q=P;if("x"===a){var V=!!T.xperiodalignment,W=!!T.yperiodalignment;for(f=0;f<r.length;f++){if(i=k[d=r[f]],c=Math.abs(_.c2p(i)-M),V){var K=_.c2p(T._xStarts[d]),G=_.c2p(T._xEnds[d]);c=M>=Math.min(K,G)&&M<=Math.max(K,G)?0:1/0}if(c<q){if(q=c,h=w.c2p(u=L[d])-I,W){var Y=w.c2p(T._yStarts[d]),$=w.c2p(T._yEnds[d]);h=I>=Math.min(Y,$)&&I<=Math.max(Y,$)?0:1/0}o=Math.sqrt(c*c+h*h),s=r[f]}}}else for(f=r.length-1;f>-1;f--)i=k[d=r[f]],u=L[d],c=_.c2p(i)-M,h=w.c2p(u)-I,(p=Math.sqrt(c*c+h*h))<q&&(q=o=p,s=d);return e.index=s,e.distance=q,e.dxy=o,void 0===s?[e]:[x(e,k,L,T)]},calcHover:x}},{"../../lib":515,"../../registry":647,"../scatter/get_trace_color":946}],998:[function(y,ee,Q){arguments[4][905][0].apply(Q,arguments)},{"./base_index":989,"./plot":999,dup:905}],999:[function(y,ee,Q){"use strict";var g=y("regl-scatter2d"),v=y("regl-line2d"),m=y("regl-error2d"),x=y("gl-text"),e=y("../../lib"),n=y("../../components/dragelement/helpers").selectMode,t=y("../../lib/prepare_regl"),a=y("../scatter/subtypes"),r=y("../scatter/link_traces"),d=y("./edit_style").styleTextSelection,s={};function i(u,f,c,h){var p=u._size,k=p.w*h,L=p.h*h;return[p.l*h+f.domain[0]*k,p.b*h+c.domain[0]*L,u.width*h-p.r*h-(1-f.domain[1])*k,u.height*h-p.t*h-(1-c.domain[1])*L]}(ee.exports=function(u,f,c){if(c.length){var h,p,o=u._fullLayout,b=f._scene,l=f.xaxis,T=f.yaxis;if(b)if(t(u,["ANGLE_instanced_arrays","OES_element_index_uint"],s)){var _=b.count,w=o._glcanvas.data()[0].regl;if(r(u,f,c),b.dirty){if(!0===b.error2d&&(b.error2d=m(w)),!0===b.line2d&&(b.line2d=v(w)),!0===b.scatter2d&&(b.scatter2d=g(w)),!0===b.fill2d&&(b.fill2d=v(w)),!0===b.glText)for(b.glText=new Array(_),h=0;h<_;h++)b.glText[h]=new x(w);if(b.glText){if(_>b.glText.length){var k=_-b.glText.length;for(h=0;h<k;h++)b.glText.push(new x(w))}else _<b.glText.length&&b.glText.splice(_,b.glText.length-_).forEach(function(J){J.destroy()});for(h=0;h<_;h++)b.glText[h].update(b.textOptions[h])}if(b.line2d&&(b.line2d.update(b.lineOptions),b.lineOptions=b.lineOptions.map(function(J){if(J&&J.positions){for(var X=J.positions,re=0;re<X.length&&(isNaN(X[re])||isNaN(X[re+1]));)re+=2;for(var ne=X.length-2;ne>re&&(isNaN(X[ne])||isNaN(X[ne+1]));)ne-=2;J.positions=X.slice(re,ne+2)}return J}),b.line2d.update(b.lineOptions)),b.error2d){var M=(b.errorXOptions||[]).concat(b.errorYOptions||[]);b.error2d.update(M)}b.scatter2d&&b.scatter2d.update(b.markerOptions),b.fillOrder=e.repeat(null,_),b.fill2d&&(b.fillOptions=b.fillOptions.map(function(J,X){var re=c[X];if(J&&re&&re[0]&&re[0].trace){var ne,le,oe=re[0],de=oe.trace,se=oe.t,ge=b.lineOptions[X],_e=[];de._ownfill&&_e.push(X),de._nexttrace&&_e.push(X+1),_e.length&&(b.fillOrder[X]=_e);var Te,we,Oe=[],fe=ge&&ge.positions||se.positions;if("tozeroy"===de.fill){for(Te=0;Te<fe.length&&isNaN(fe[Te+1]);)Te+=2;for(we=fe.length-2;we>Te&&isNaN(fe[we+1]);)we-=2;0!==fe[Te+1]&&(Oe=[fe[Te],0]),Oe=Oe.concat(fe.slice(Te,we+2)),0!==fe[we+1]&&(Oe=Oe.concat([fe[we],0]))}else if("tozerox"===de.fill){for(Te=0;Te<fe.length&&isNaN(fe[Te]);)Te+=2;for(we=fe.length-2;we>Te&&isNaN(fe[we]);)we-=2;0!==fe[Te]&&(Oe=[0,fe[Te+1]]),Oe=Oe.concat(fe.slice(Te,we+2)),0!==fe[we]&&(Oe=Oe.concat([0,fe[we+1]]))}else if("toself"===de.fill||"tonext"===de.fill){for(Oe=[],ne=0,J.splitNull=!0,le=0;le<fe.length;le+=2)(isNaN(fe[le])||isNaN(fe[le+1]))&&((Oe=Oe.concat(fe.slice(ne,le))).push(fe[ne],fe[ne+1]),Oe.push(null,null),ne=le+2);Oe=Oe.concat(fe.slice(ne)),ne&&Oe.push(fe[ne],fe[ne+1])}else{var ve=de._nexttrace;if(ve){var Ae=b.lineOptions[X+1];if(Ae){var ke=Ae.positions;if("tonexty"===de.fill){for(Oe=fe.slice(),X=Math.floor(ke.length/2);X--;){var Pe=ke[2*X],Ne=ke[2*X+1];isNaN(Pe)||isNaN(Ne)||Oe.push(Pe,Ne)}J.fill=ve.fillcolor}}}}if(de._prevtrace&&"tonext"===de._prevtrace.fill){var De=b.lineOptions[X-1].positions,ze=Oe.length/2,Me=[ne=ze];for(le=0;le<De.length;le+=2)(isNaN(De[le])||isNaN(De[le+1]))&&(Me.push(le/2+ze+1),ne=le+2);Oe=Oe.concat(De),J.hole=Me}return J.fillmode=de.fill,J.opacity=de.opacity,J.positions=Oe,J}}),b.fill2d.update(b.fillOptions))}var P=n(o.dragmode),S=o.clickmode.indexOf("select")>-1;for(h=0;h<_;h++){var E=c[h][0],z=E.trace,R=E.t,q=R.index,V=z._length,W=R.x,K=R.y;if(z.selectedpoints||P||S){if(P||(P=!0),z.selectedpoints){var G=b.selectBatch[q]=e.selIndices2selPoints(z),Y={};for(p=0;p<G.length;p++)Y[G[p]]=1;var $=[];for(p=0;p<V;p++)Y[p]||$.push(p);b.unselectBatch[q]=$}var B=R.xpx=new Array(V),N=R.ypx=new Array(V);for(p=0;p<V;p++)B[p]=l.c2p(W[p]),N[p]=T.c2p(K[p])}else R.xpx=R.ypx=null}if(P){if(b.select2d||(b.select2d=g(o._glcanvas.data()[1].regl)),b.scatter2d){var U=new Array(_);for(h=0;h<_;h++)U[h]=b.selectBatch[h].length||b.unselectBatch[h].length?b.markerUnselectedOptions[h]:{};b.scatter2d.update(U)}b.select2d&&(b.select2d.update(b.markerOptions),b.select2d.update(b.markerSelectedOptions)),b.glText&&c.forEach(function(J){a.hasText(((J||[])[0]||{}).trace||{})&&d(J)})}else b.scatter2d&&b.scatter2d.update(b.markerOptions);var te={viewport:i(o,l,T,u._context.plotGlPixelRatio),range:[(l._rl||l.range)[0],(T._rl||T.range)[0],(l._rl||l.range)[1],(T._rl||T.range)[1]]},j=e.repeat(te,b.count);b.fill2d&&b.fill2d.update(j),b.line2d&&b.line2d.update(j),b.error2d&&b.error2d.update(j.concat(j)),b.scatter2d&&b.scatter2d.update(j),b.select2d&&b.select2d.update(j),b.glText&&b.glText.forEach(function(J){J.update(te)})}else b.init()}}).reglPrecompiled=s},{"../../components/dragelement/helpers":385,"../../lib":515,"../../lib/prepare_regl":528,"../scatter/link_traces":952,"../scatter/subtypes":961,"./edit_style":994,"gl-text":225,"regl-error2d":280,"regl-line2d":281,"regl-scatter2d":282}],1e3:[function(y,ee,Q){"use strict";var g=y("../../lib");ee.exports=function(v,m){var x=m._scene,e={count:0,dirty:!0,lineOptions:[],fillOptions:[],markerOptions:[],markerSelectedOptions:[],markerUnselectedOptions:[],errorXOptions:[],errorYOptions:[],textOptions:[],textSelectedOptions:[],textUnselectedOptions:[],selectBatch:[],unselectBatch:[]},n={fill2d:!1,scatter2d:!1,error2d:!1,line2d:!1,glText:!1,select2d:!1};return m._scene||((x=m._scene={}).init=function(){g.extendFlat(x,n,e)},x.init(),x.update=function(t){var a=g.repeat(t,x.count);if(x.fill2d&&x.fill2d.update(a),x.scatter2d&&x.scatter2d.update(a),x.line2d&&x.line2d.update(a),x.error2d&&x.error2d.update(a.concat(a)),x.select2d&&x.select2d.update(a),x.glText)for(var r=0;r<x.count;r++)x.glText[r].update(t)},x.draw=function(){for(var t=x.count,a=x.fill2d,r=x.error2d,d=x.line2d,s=x.scatter2d,i=x.glText,u=x.select2d,f=x.selectBatch,c=x.unselectBatch,h=0;h<t;h++){if(a&&x.fillOrder[h]&&a.draw(x.fillOrder[h]),d&&x.lineOptions[h]&&d.draw(h),r&&(x.errorXOptions[h]&&r.draw(h),x.errorYOptions[h]&&r.draw(h+t)),s&&x.markerOptions[h])if(c[h].length){var p=g.repeat([],x.count);p[h]=c[h],s.draw(p)}else f[h].length||s.draw(h);i[h]&&x.textOptions[h]&&i[h].render()}u&&u.draw(f),x.dirty=!1},x.destroy=function(){x.fill2d&&x.fill2d.destroy&&x.fill2d.destroy(),x.scatter2d&&x.scatter2d.destroy&&x.scatter2d.destroy(),x.error2d&&x.error2d.destroy&&x.error2d.destroy(),x.line2d&&x.line2d.destroy&&x.line2d.destroy(),x.select2d&&x.select2d.destroy&&x.select2d.destroy(),x.glText&&x.glText.forEach(function(t){t.destroy&&t.destroy()}),x.lineOptions=null,x.fillOptions=null,x.markerOptions=null,x.markerSelectedOptions=null,x.markerUnselectedOptions=null,x.errorXOptions=null,x.errorYOptions=null,x.textOptions=null,x.textSelectedOptions=null,x.textUnselectedOptions=null,x.selectBatch=null,x.unselectBatch=null,m._scene=null}),x.dirty||g.extendFlat(x,e),x}},{"../../lib":515}],1001:[function(y,ee,Q){"use strict";var g=y("../scatter/subtypes"),v=y("./edit_style").styleTextSelection;ee.exports=function(m,x){var e=m.cd,n=m.xaxis,t=m.yaxis,a=[],r=e[0].trace,d=e[0].t,s=r._length,i=d.x,u=d.y,f=d._scene,c=d.index;if(!f)return a;var h=g.hasText(r),p=g.hasMarkers(r);if(!0!==r.visible||!p&&!h)return a;var b=[],l=[];if(!1!==x&&!x.degenerate)for(var T=0;T<s;T++)x.contains([d.xpx[T],d.ypx[T]],!1,T,m)?(b.push(T),a.push({pointNumber:T,x:n.c2d(i[T]),y:t.c2d(u[T])})):l.push(T);if(p){var _=f.scatter2d;if(b.length||l.length){if(!f.selectBatch[c].length&&!f.unselectBatch[c].length){var w=new Array(f.count);w[c]=f.markerUnselectedOptions[c],_.update.apply(_,w)}}else{var k=new Array(f.count);k[c]=f.markerOptions[c],_.update.apply(_,k)}}return f.selectBatch[c]=b,f.unselectBatch[c]=l,h&&v(e),a}},{"../scatter/subtypes":961,"./edit_style":994}],1002:[function(y,ee,Q){"use strict";var g=y("../../plots/template_attributes").hovertemplateAttrs,v=y("../../plots/template_attributes").texttemplateAttrs,m=y("../scattergeo/attributes"),x=y("../scatter/attributes"),e=y("../../plots/mapbox/layout_attributes"),n=y("../../plots/attributes"),t=y("../../components/colorscale/attributes"),a=y("../../lib/extend").extendFlat,r=y("../../plot_api/edit_types").overrideAll,d=m.line,s=m.marker;ee.exports=r({lon:m.lon,lat:m.lat,mode:a({},x.mode,{dflt:"markers"}),text:a({},x.text,{}),texttemplate:v({editType:"plot"},{keys:["lat","lon","text"]}),hovertext:a({},x.hovertext,{}),line:{color:d.color,width:d.width},connectgaps:x.connectgaps,marker:a({symbol:{valType:"string",dflt:"circle",arrayOk:!0},angle:{valType:"number",dflt:"auto",arrayOk:!0},allowoverlap:{valType:"boolean",dflt:!1},opacity:s.opacity,size:s.size,sizeref:s.sizeref,sizemin:s.sizemin,sizemode:s.sizemode},t("marker")),fill:m.fill,fillcolor:x.fillcolor,textfont:e.layers.symbol.textfont,textposition:e.layers.symbol.textposition,below:{valType:"string"},selected:{marker:x.selected.marker},unselected:{marker:x.unselected.marker},hoverinfo:a({},n.hoverinfo,{flags:["lon","lat","text","name"]}),hovertemplate:g()},"calc","nested")},{"../../components/colorscale/attributes":374,"../../lib/extend":505,"../../plot_api/edit_types":548,"../../plots/attributes":562,"../../plots/mapbox/layout_attributes":624,"../../plots/template_attributes":642,"../scatter/attributes":936,"../scattergeo/attributes":978}],1003:[function(y,ee,Q){"use strict";var g=y("fast-isnumeric"),v=y("../../lib"),m=y("../../constants/numerical").BADNUM,x=y("../../lib/geojson_utils"),e=y("../../components/colorscale"),n=y("../../components/drawing"),t=y("../scatter/make_bubble_size_func"),a=y("../scatter/subtypes"),r=y("../../plots/mapbox/convert_text_opts"),d=y("../../components/fx/helpers").appendArrayPointValue,s=y("../../lib/svg_text_utils").NEWLINES,i=y("../../lib/svg_text_utils").BR_TAG_ALL;function u(){return{geojson:x.makeBlank(),layout:{visibility:"none"},paint:{}}}function f(p,o){return v.isArrayOrTypedArray(p)?o?function(b){return g(p[b])?+p[b]:0}:function(b){return p[b]}:p?function(){return p}:c}function c(){return""}function h(p){return p[0]===m}ee.exports=function(p,o){var b,l=o[0].trace,T=!0===l.visible&&0!==l._length,_="none"!==l.fill,w=a.hasLines(l),k=a.hasMarkers(l),L=a.hasText(l),M=k&&"circle"===l.marker.symbol,I=k&&"circle"!==l.marker.symbol,P=u(),S=u(),E=u(),z=u(),R={fill:P,line:S,circle:E,symbol:z};if(!T)return R;if((_||w)&&(b=x.calcTraceToLineCoords(o)),_&&(P.geojson=x.makePolygon(b),P.layout.visibility="visible",v.extendFlat(P.paint,{"fill-color":l.fillcolor})),w&&(S.geojson=x.makeLine(b),S.layout.visibility="visible",v.extendFlat(S.paint,{"line-width":l.line.width,"line-color":l.line.color,"line-opacity":l.opacity})),M){var q=function(K){var G,Y,$,B,N=K[0].trace,U=N.marker,te=N.selectedpoints,j=v.isArrayOrTypedArray(U.color),J=v.isArrayOrTypedArray(U.size),X=v.isArrayOrTypedArray(U.opacity);function re(Te){return N.opacity*Te}j&&(Y=e.hasColorscale(N,"marker")?e.makeColorScaleFuncFromTrace(U):v.identity),J&&($=t(N)),X&&(B=function(Te){return re(g(Te)?+v.constrain(Te,0,1):0)});var ne,_e,le=[];for(G=0;G<K.length;G++){var oe=K[G],de=oe.lonlat;if(!h(de)){var se={};Y&&(se.mcc=oe.mcc=Y(oe.mc)),$&&(se.mrc=oe.mrc=$(oe.ms)),B&&(se.mo=B(oe.mo)),te&&(se.selected=oe.selected||0),le.push({type:"Feature",geometry:{type:"Point",coordinates:de},properties:se})}}if(te)for(ne=n.makeSelectedPointStyleFns(N),G=0;G<le.length;G++){var ge=le[G].properties;ne.selectedOpacityFn&&(ge.mo=re(ne.selectedOpacityFn(ge))),ne.selectedColorFn&&(ge.mcc=ne.selectedColorFn(ge)),ne.selectedSizeFn&&(ge.mrc=ne.selectedSizeFn(ge))}return{geojson:{type:"FeatureCollection",features:le},mcc:j||ne&&ne.selectedColorFn?{type:"identity",property:"mcc"}:U.color,mrc:J||ne&&ne.selectedSizeFn?{type:"identity",property:"mrc"}:(_e=U.size,_e/2),mo:X||ne&&ne.selectedOpacityFn?{type:"identity",property:"mo"}:re(U.opacity)}}(o);E.geojson=q.geojson,E.layout.visibility="visible",v.extendFlat(E.paint,{"circle-color":q.mcc,"circle-radius":q.mrc,"circle-opacity":q.mo})}if((I||L)&&(z.geojson=function(K,G){for(var Y=G._fullLayout,$=K[0].trace,B=$.marker||{},N=B.symbol,U=B.angle,te="circle"!==N?f(N):c,j="auto"!==U?f(U,!0):c,J=a.hasText($)?f($.text):c,X=[],re=0;re<K.length;re++){var ne=K[re];if(!h(ne.lonlat)){var le,oe=$.texttemplate;if(oe){var de=Array.isArray(oe)?oe[re]||"":oe,se=$._module.formatLabels(ne,$,Y),ge={};d(ge,$,ne.i),le=v.texttemplateString(de,se,Y._d3locale,ge,ne,$._meta||{})}else le=J(re);le&&(le=le.replace(s,"").replace(i,"\n")),X.push({type:"Feature",geometry:{type:"Point",coordinates:ne.lonlat},properties:{symbol:te(re),angle:j(re),text:le}})}}return{type:"FeatureCollection",features:X}}(o,p),v.extendFlat(z.layout,{visibility:"visible","icon-image":"{symbol}-15","text-field":"{text}"}),I&&(v.extendFlat(z.layout,{"icon-size":l.marker.size/10}),"angle"in l.marker&&"auto"!==l.marker.angle&&v.extendFlat(z.layout,{"icon-rotate":{type:"identity",property:"angle"},"icon-rotation-alignment":"map"}),z.layout["icon-allow-overlap"]=l.marker.allowoverlap,v.extendFlat(z.paint,{"icon-opacity":l.opacity*l.marker.opacity,"icon-color":l.marker.color})),L)){var W=r(l.textposition,(l.marker||{}).size);v.extendFlat(z.layout,{"text-size":l.textfont.size,"text-anchor":W.anchor,"text-offset":W.offset}),v.extendFlat(z.paint,{"text-color":l.textfont.color,"text-opacity":l.opacity})}return R}},{"../../components/colorscale":379,"../../components/drawing":389,"../../components/fx/helpers":403,"../../constants/numerical":491,"../../lib":515,"../../lib/geojson_utils":509,"../../lib/svg_text_utils":541,"../../plots/mapbox/convert_text_opts":621,"../scatter/make_bubble_size_func":953,"../scatter/subtypes":961,"fast-isnumeric":190}],1004:[function(y,ee,Q){"use strict";var g=y("../../lib"),v=y("../scatter/subtypes"),m=y("../scatter/marker_defaults"),x=y("../scatter/line_defaults"),e=y("../scatter/text_defaults"),n=y("../scatter/fillcolor_defaults"),t=y("./attributes");ee.exports=function(a,r,d,s){function i(f,c){return g.coerce(a,r,t,f,c)}if(c=r,p=(h=i)("lon")||[],o=h("lat")||[],b=Math.min(p.length,o.length),c._length=b,b){if(i("text"),i("texttemplate"),i("hovertext"),i("hovertemplate"),i("mode"),i("below"),v.hasLines(r)&&(x(a,r,d,s,i,{noDash:!0}),i("connectgaps")),v.hasMarkers(r)){m(a,r,d,s,i,{noLine:!0}),i("marker.allowoverlap"),i("marker.angle");var u=r.marker;"circle"!==u.symbol&&(g.isArrayOrTypedArray(u.size)&&(u.size=u.size[0]),g.isArrayOrTypedArray(u.color)&&(u.color=u.color[0]))}v.hasText(r)&&e(a,r,s,i,{noSelect:!0}),i("fill"),"none"!==r.fill&&n(a,r,d,i),g.coerceSelectionMarkerOpacity(r,i)}else r.visible=!1;var c,h,p,o,b}},{"../../lib":515,"../scatter/fillcolor_defaults":944,"../scatter/line_defaults":949,"../scatter/marker_defaults":955,"../scatter/subtypes":961,"../scatter/text_defaults":962,"./attributes":1002}],1005:[function(y,ee,Q){"use strict";ee.exports=function(g,v){return g.lon=v.lon,g.lat=v.lat,g}},{}],1006:[function(y,ee,Q){"use strict";var g=y("../../plots/cartesian/axes");ee.exports=function(v,m,x){var e={},n=x[m.subplot]._subplot.mockAxis,t=v.lonlat;return e.lonLabel=g.tickText(n,n.c2l(t[0]),!0).text,e.latLabel=g.tickText(n,n.c2l(t[1]),!0).text,e}},{"../../plots/cartesian/axes":566}],1007:[function(y,ee,Q){"use strict";var g=y("../../components/fx"),v=y("../../lib"),m=y("../scatter/get_trace_color"),x=v.fillText,e=y("../../constants/numerical").BADNUM;function n(t,a,r){if(!t.hovertemplate){var d=(a.hi||t.hoverinfo).split("+"),s=-1!==d.indexOf("all"),i=-1!==d.indexOf("lon"),u=-1!==d.indexOf("lat"),f=a.lonlat,c=[];return s||i&&u?c.push("("+h(f[1])+", "+h(f[0])+")"):i?c.push(r.lon+h(f[0])):u&&c.push(r.lat+h(f[1])),(s||-1!==d.indexOf("text"))&&x(a,t,c),c.join("<br>")}function h(p){return p+"\xb0"}}ee.exports={hoverPoints:function(t,a,r){var d=t.cd,s=d[0].trace,i=t.xa,u=t.ya,f=t.subplot,c=360*(a>=0?Math.floor((a+180)/360):Math.ceil((a-180)/360)),h=a-c;if(g.getClosest(d,function(L){var M=L.lonlat;if(M[0]===e)return 1/0;var I=v.modHalf(M[0],360),P=M[1],S=f.project([I,P]),E=S.x-i.c2p([h,P]),z=S.y-u.c2p([I,r]),R=Math.max(3,L.mrc||0);return Math.max(Math.sqrt(E*E+z*z)-R,1-3/R)},t),!1!==t.index){var p=d[t.index],o=p.lonlat,b=[v.modHalf(o[0],360)+c,o[1]],l=i.c2p(b),T=u.c2p(b),_=p.mrc||1;t.x0=l-_,t.x1=l+_,t.y0=T-_,t.y1=T+_;var w={};w[s.subplot]={_subplot:f};var k=s._module.formatLabels(p,s,w);return t.lonLabel=k.lonLabel,t.latLabel=k.latLabel,t.color=m(s,p),t.extraText=n(s,p,d[0].t.labels),t.hovertemplate=s.hovertemplate,[t]}},getExtraText:n}},{"../../components/fx":407,"../../constants/numerical":491,"../../lib":515,"../scatter/get_trace_color":946}],1008:[function(y,ee,Q){"use strict";ee.exports={attributes:y("./attributes"),supplyDefaults:y("./defaults"),colorbar:y("../scatter/marker_colorbar"),formatLabels:y("./format_labels"),calc:y("../scattergeo/calc"),plot:y("./plot"),hoverPoints:y("./hover").hoverPoints,eventData:y("./event_data"),selectPoints:y("./select"),styleOnSelect:function(g,v){v&&v[0].trace._glTrace.update(v)},moduleType:"trace",name:"scattermapbox",basePlotModule:y("../../plots/mapbox"),categories:["mapbox","gl","symbols","showLegend","scatter-like"],meta:{}}},{"../../plots/mapbox":622,"../scatter/marker_colorbar":954,"../scattergeo/calc":979,"./attributes":1002,"./defaults":1004,"./event_data":1005,"./format_labels":1006,"./hover":1007,"./plot":1009,"./select":1010}],1009:[function(y,ee,Q){"use strict";var g=y("./convert"),v=y("../../plots/mapbox/constants").traceLayerPrefix,m=["fill","line","circle","symbol"];function x(n,t){this.type="scattermapbox",this.subplot=n,this.uid=t,this.sourceIds={fill:"source-"+t+"-fill",line:"source-"+t+"-line",circle:"source-"+t+"-circle",symbol:"source-"+t+"-symbol"},this.layerIds={fill:v+t+"-fill",line:v+t+"-line",circle:v+t+"-circle",symbol:v+t+"-symbol"},this.below=null}var e=x.prototype;e.addSource=function(n,t){this.subplot.map.addSource(this.sourceIds[n],{type:"geojson",data:t.geojson})},e.setSourceData=function(n,t){this.subplot.map.getSource(this.sourceIds[n]).setData(t.geojson)},e.addLayer=function(n,t,a){this.subplot.addLayer({type:n,id:this.layerIds[n],source:this.sourceIds[n],layout:t.layout,paint:t.paint},a)},e.update=function(n){var t,a,r,d=this.subplot,s=d.map,i=g(d.gd,n),u=d.belowLookup["trace-"+this.uid];if(u!==this.below){for(t=m.length-1;t>=0;t--)s.removeLayer(this.layerIds[a=m[t]]);for(t=0;t<m.length;t++)r=i[a=m[t]],this.addLayer(a,r,u);this.below=u}for(t=0;t<m.length;t++)r=i[a=m[t]],d.setOptions(this.layerIds[a],"setLayoutProperty",r.layout),"visible"===r.layout.visibility&&(this.setSourceData(a,r),d.setOptions(this.layerIds[a],"setPaintProperty",r.paint));n[0].trace._glTrace=this},e.dispose=function(){for(var n=this.subplot.map,t=m.length-1;t>=0;t--){var a=m[t];n.removeLayer(this.layerIds[a]),n.removeSource(this.sourceIds[a])}},ee.exports=function(n,t){for(var a=t[0].trace,r=new x(n,a.uid),d=g(n.gd,t),s=r.below=n.belowLookup["trace-"+a.uid],i=0;i<m.length;i++){var u=m[i],f=d[u];r.addSource(u,f),r.addLayer(u,f,s)}return t[0].trace._glTrace=r,r}},{"../../plots/mapbox/constants":620,"./convert":1003}],1010:[function(y,ee,Q){"use strict";var g=y("../../lib"),v=y("../scatter/subtypes"),m=y("../../constants/numerical").BADNUM;ee.exports=function(x,e){var n,t=x.cd,a=x.xaxis,r=x.yaxis,d=[];if(!v.hasMarkers(t[0].trace))return[];if(!1===e)for(n=0;n<t.length;n++)t[n].selected=0;else for(n=0;n<t.length;n++){var i=t[n],u=i.lonlat;if(u[0]!==m){var f=[g.modHalf(u[0],360),u[1]],c=[a.c2p(f),r.c2p(f)];e.contains(c,null,n,x)?(d.push({pointNumber:n,lon:u[0],lat:u[1]}),i.selected=1):i.selected=0}}return d}},{"../../constants/numerical":491,"../../lib":515,"../scatter/subtypes":961}],1011:[function(y,ee,Q){"use strict";var g=y("../../plots/template_attributes").hovertemplateAttrs,v=y("../../plots/template_attributes").texttemplateAttrs,m=y("../../lib/extend").extendFlat,x=y("../scatter/attributes"),e=y("../../plots/attributes"),n=x.line;ee.exports={mode:x.mode,r:{valType:"data_array",editType:"calc+clearAxisTypes"},theta:{valType:"data_array",editType:"calc+clearAxisTypes"},r0:{valType:"any",dflt:0,editType:"calc+clearAxisTypes"},dr:{valType:"number",dflt:1,editType:"calc"},theta0:{valType:"any",dflt:0,editType:"calc+clearAxisTypes"},dtheta:{valType:"number",editType:"calc"},thetaunit:{valType:"enumerated",values:["radians","degrees","gradians"],dflt:"degrees",editType:"calc+clearAxisTypes"},text:x.text,texttemplate:v({editType:"plot"},{keys:["r","theta","text"]}),hovertext:x.hovertext,line:{color:n.color,width:n.width,dash:n.dash,shape:m({},n.shape,{values:["linear","spline"]}),smoothing:n.smoothing,editType:"calc"},connectgaps:x.connectgaps,marker:x.marker,cliponaxis:m({},x.cliponaxis,{dflt:!1}),textposition:x.textposition,textfont:x.textfont,fill:m({},x.fill,{values:["none","toself","tonext"],dflt:"none"}),fillcolor:x.fillcolor,hoverinfo:m({},e.hoverinfo,{flags:["r","theta","text","name"]}),hoveron:x.hoveron,hovertemplate:g(),selected:x.selected,unselected:x.unselected}},{"../../lib/extend":505,"../../plots/attributes":562,"../../plots/template_attributes":642,"../scatter/attributes":936}],1012:[function(y,ee,Q){"use strict";var g=y("fast-isnumeric"),v=y("../../constants/numerical").BADNUM,m=y("../../plots/cartesian/axes"),x=y("../scatter/colorscale_calc"),e=y("../scatter/arrays_to_calcdata"),n=y("../scatter/calc_selection"),t=y("../scatter/calc").calcMarkerSize;ee.exports=function(a,r){for(var d=a._fullLayout,s=r.subplot,i=d[s].radialaxis,u=d[s].angularaxis,f=i.makeCalcdata(r,"r"),c=u.makeCalcdata(r,"theta"),h=r._length,p=new Array(h),o=0;o<h;o++){var b=f[o],l=c[o],T=p[o]={};g(b)&&g(l)?(T.r=b,T.theta=l):T.r=v}var _=t(r,h);return r._extremes.x=m.findExtremes(i,f,{ppad:_}),x(a,r),e(p,r),n(p,r),p}},{"../../constants/numerical":491,"../../plots/cartesian/axes":566,"../scatter/arrays_to_calcdata":935,"../scatter/calc":937,"../scatter/calc_selection":938,"../scatter/colorscale_calc":939,"fast-isnumeric":190}],1013:[function(y,ee,Q){"use strict";var g=y("../../lib"),v=y("../scatter/subtypes"),m=y("../scatter/marker_defaults"),x=y("../scatter/line_defaults"),e=y("../scatter/line_shape_defaults"),n=y("../scatter/text_defaults"),t=y("../scatter/fillcolor_defaults"),a=y("../scatter/constants").PTS_LINESONLY,r=y("./attributes");function d(s,i,u,f){var c,h=f("r"),p=f("theta");if(h)p?c=Math.min(h.length,p.length):(c=h.length,f("theta0"),f("dtheta"));else{if(!p)return 0;c=i.theta.length,f("r0"),f("dr")}return i._length=c,c}ee.exports={handleRThetaDefaults:d,supplyDefaults:function(s,i,u,f){function c(o,b){return g.coerce(s,i,r,o,b)}var h=d(0,i,0,c);if(h){c("thetaunit"),c("mode",h<a?"lines+markers":"lines"),c("text"),c("hovertext"),"fills"!==i.hoveron&&c("hovertemplate"),v.hasLines(i)&&(x(s,i,u,f,c),e(s,i,c),c("connectgaps")),v.hasMarkers(i)&&m(s,i,u,f,c,{gradient:!0}),v.hasText(i)&&(c("texttemplate"),n(s,i,f,c));var p=[];(v.hasMarkers(i)||v.hasText(i))&&(c("cliponaxis"),c("marker.maxdisplayed"),p.push("points")),c("fill"),"none"!==i.fill&&(t(s,i,u,c),v.hasLines(i)||e(s,i,c)),"tonext"!==i.fill&&"toself"!==i.fill||p.push("fills"),c("hoveron",p.join("+")||"points"),g.coerceSelectionMarkerOpacity(i,c)}else i.visible=!1}}},{"../../lib":515,"../scatter/constants":940,"../scatter/fillcolor_defaults":944,"../scatter/line_defaults":949,"../scatter/line_shape_defaults":951,"../scatter/marker_defaults":955,"../scatter/subtypes":961,"../scatter/text_defaults":962,"./attributes":1011}],1014:[function(y,ee,Q){"use strict";var g=y("../../lib"),v=y("../../plots/cartesian/axes");ee.exports=function(m,x,e){var n,t,a={},r=e[x.subplot]._subplot;r?(n=r.radialAxis,t=r.angularAxis):(n=(r=e[x.subplot]).radialaxis,t=r.angularaxis);var d=n.c2l(m.r);a.rLabel=v.tickText(n,d,!0).text;var s="degrees"===t.thetaunit?g.rad2deg(m.theta):m.theta;return a.thetaLabel=v.tickText(t,s,!0).text,a}},{"../../lib":515,"../../plots/cartesian/axes":566}],1015:[function(y,ee,Q){"use strict";var g=y("../scatter/hover");function v(m,x,e,n){var t=e.radialAxis,a=e.angularAxis;t._hovertitle="r",a._hovertitle="\u03b8";var r={};r[x.subplot]={_subplot:e};var d=x._module.formatLabels(m,x,r);n.rLabel=d.rLabel,n.thetaLabel=d.thetaLabel;var i=[];function u(c,h){i.push(c._hovertitle+": "+h)}if(!x.hovertemplate){var f=(m.hi||x.hoverinfo).split("+");-1!==f.indexOf("all")&&(f=["r","theta","text"]),-1!==f.indexOf("r")&&u(t,n.rLabel),-1!==f.indexOf("theta")&&u(a,n.thetaLabel),-1!==f.indexOf("text")&&n.text&&(i.push(n.text),delete n.text),n.extraText=i.join("<br>")}}ee.exports={hoverPoints:function(m,x,e,n){var t=g(m,x,e,n);if(t&&!1!==t[0].index){var a=t[0];if(void 0===a.index)return t;var r=m.subplot,d=a.cd[a.index],s=a.trace;if(r.isPtInside(d))return a.xLabelVal=void 0,a.yLabelVal=void 0,v(d,s,r,a),a.hovertemplate=s.hovertemplate,t}},makeHoverPointText:v}},{"../scatter/hover":947}],1016:[function(y,ee,Q){"use strict";ee.exports={moduleType:"trace",name:"scatterpolar",basePlotModule:y("../../plots/polar"),categories:["polar","symbols","showLegend","scatter-like"],attributes:y("./attributes"),supplyDefaults:y("./defaults").supplyDefaults,colorbar:y("../scatter/marker_colorbar"),formatLabels:y("./format_labels"),calc:y("./calc"),plot:y("./plot"),style:y("../scatter/style").style,styleOnSelect:y("../scatter/style").styleOnSelect,hoverPoints:y("./hover").hoverPoints,selectPoints:y("../scatter/select"),meta:{}}},{"../../plots/polar":631,"../scatter/marker_colorbar":954,"../scatter/select":958,"../scatter/style":960,"./attributes":1011,"./calc":1012,"./defaults":1013,"./format_labels":1014,"./hover":1015,"./plot":1017}],1017:[function(y,ee,Q){"use strict";var g=y("../scatter/plot"),v=y("../../constants/numerical").BADNUM;ee.exports=function(m,x,e){for(var n=x.layers.frontplot.select("g.scatterlayer"),t={xaxis:x.xaxis,yaxis:x.yaxis,plot:x.framework,layerClipId:x._hasClipOnAxisFalse?x.clipIds.forTraces:null},a=x.radialAxis,r=x.angularAxis,d=0;d<e.length;d++)for(var s=e[d],i=0;i<s.length;i++){var u=s[i],f=u.r;if(f===v)u.x=u.y=v;else{var c=a.c2g(f),h=r.c2g(u.theta);u.x=c*Math.cos(h),u.y=c*Math.sin(h)}}g(m,t,e,n)}},{"../../constants/numerical":491,"../scatter/plot":957}],1018:[function(y,ee,Q){"use strict";var g=y("../scatterpolar/attributes"),v=y("../scattergl/attributes"),m=y("../../plots/template_attributes").texttemplateAttrs;ee.exports={mode:g.mode,r:g.r,theta:g.theta,r0:g.r0,dr:g.dr,theta0:g.theta0,dtheta:g.dtheta,thetaunit:g.thetaunit,text:g.text,texttemplate:m({editType:"plot"},{keys:["r","theta","text"]}),hovertext:g.hovertext,hovertemplate:g.hovertemplate,line:v.line,connectgaps:v.connectgaps,marker:v.marker,fill:v.fill,fillcolor:v.fillcolor,textposition:v.textposition,textfont:v.textfont,hoverinfo:g.hoverinfo,selected:g.selected,unselected:g.unselected}},{"../../plots/template_attributes":642,"../scattergl/attributes":988,"../scatterpolar/attributes":1011}],1019:[function(y,ee,Q){"use strict";ee.exports={moduleType:"trace",name:"scatterpolargl",basePlotModule:y("../../plots/polar"),categories:["gl","regl","polar","symbols","showLegend","scatter-like"],attributes:y("./attributes"),supplyDefaults:y("./defaults"),colorbar:y("../scatter/marker_colorbar"),formatLabels:y("./format_labels"),calc:y("./calc"),hoverPoints:y("./hover").hoverPoints,selectPoints:y("../scattergl/select"),meta:{}}},{"../../plots/polar":631,"../scatter/marker_colorbar":954,"../scattergl/select":1001,"./attributes":1018,"./calc":1020,"./defaults":1021,"./format_labels":1022,"./hover":1023}],1020:[function(y,ee,Q){"use strict";var g=y("../scatter/colorscale_calc"),v=y("../scatter/calc").calcMarkerSize,m=y("../scattergl/convert"),x=y("../../plots/cartesian/axes"),e=y("../scattergl/constants").TOO_MANY_POINTS;ee.exports=function(n,t){var a=n._fullLayout,r=t.subplot,d=a[r].radialaxis,s=a[r].angularaxis,i=t._r=d.makeCalcdata(t,"r"),u=t._theta=s.makeCalcdata(t,"theta"),f=t._length,c={};f<i.length&&(i=i.slice(0,f)),f<u.length&&(u=u.slice(0,f)),c.r=i,c.theta=u,g(n,t);var h,p=c.opts=m.style(n,t);return f<e?h=v(t,f):p.marker&&(h=2*(p.marker.sizeAvg||Math.max(p.marker.size,3))),t._extremes.x=x.findExtremes(d,i,{ppad:h}),[{x:!1,y:!1,t:c,trace:t}]}},{"../../plots/cartesian/axes":566,"../scatter/calc":937,"../scatter/colorscale_calc":939,"../scattergl/constants":991,"../scattergl/convert":992}],1021:[function(y,ee,Q){"use strict";var g=y("../../lib"),v=y("../scatter/subtypes"),m=y("../scatterpolar/defaults").handleRThetaDefaults,x=y("../scatter/marker_defaults"),e=y("../scatter/line_defaults"),n=y("../scatter/text_defaults"),t=y("../scatter/fillcolor_defaults"),a=y("../scatter/constants").PTS_LINESONLY,r=y("./attributes");ee.exports=function(d,s,i,u){function f(h,p){return g.coerce(d,s,r,h,p)}var c=m(d,s,u,f);c?(f("thetaunit"),f("mode",c<a?"lines+markers":"lines"),f("text"),f("hovertext"),"fills"!==s.hoveron&&f("hovertemplate"),v.hasLines(s)&&(e(d,s,i,u,f),f("connectgaps")),v.hasMarkers(s)&&x(d,s,i,u,f),v.hasText(s)&&(f("texttemplate"),n(d,s,u,f)),f("fill"),"none"!==s.fill&&t(d,s,i,f),g.coerceSelectionMarkerOpacity(s,f)):s.visible=!1}},{"../../lib":515,"../scatter/constants":940,"../scatter/fillcolor_defaults":944,"../scatter/line_defaults":949,"../scatter/marker_defaults":955,"../scatter/subtypes":961,"../scatter/text_defaults":962,"../scatterpolar/defaults":1013,"./attributes":1018}],1022:[function(y,ee,Q){"use strict";var g=y("../scatterpolar/format_labels");ee.exports=function(v,m,x){var e=v.i;return"r"in v||(v.r=m._r[e]),"theta"in v||(v.theta=m._theta[e]),g(v,m,x)}},{"../scatterpolar/format_labels":1014}],1023:[function(y,ee,Q){"use strict";var g=y("../scattergl/hover"),v=y("../scatterpolar/hover").makeHoverPointText;ee.exports={hoverPoints:function(m,x,e,n){var t=m.cd[0].t,a=t.r,r=t.theta,d=g.hoverPoints(m,x,e,n);if(d&&!1!==d[0].index){var s=d[0];if(void 0===s.index)return d;var i=m.subplot,u=s.cd[s.index],f=s.trace;if(u.r=a[s.index],u.theta=r[s.index],i.isPtInside(u))return s.xLabelVal=void 0,s.yLabelVal=void 0,v(u,f,i,s),d}}}},{"../scattergl/hover":997,"../scatterpolar/hover":1015}],1024:[function(y,ee,Q){arguments[4][905][0].apply(Q,arguments)},{"./base_index":1019,"./plot":1025,dup:905}],1025:[function(y,ee,Q){"use strict";var g=y("@plotly/point-cluster"),v=y("fast-isnumeric"),m=y("../scattergl/plot"),x=y("../scattergl/scene_update"),e=y("../scattergl/convert"),n=y("../../lib"),t=y("../scattergl/constants").TOO_MANY_POINTS;ee.exports=function(a,r,d){if(d.length){var s=r.radialAxis,i=r.angularAxis,u=x(a,r);return d.forEach(function(f){if(f&&f[0]&&f[0].trace){var c,h=f[0],p=h.trace,o=h.t,b=p._length,l=o.r,T=o.theta,_=o.opts,w=l.slice(),k=T.slice();for(c=0;c<l.length;c++)r.isPtInside({r:l[c],theta:T[c]})||(w[c]=NaN,k[c]=NaN);var L=new Array(2*b),M=Array(b),I=Array(b);for(c=0;c<b;c++){var P,S,E=w[c];if(v(E)){var z=s.c2g(E),R=i.c2g(k[c],p.thetaunit);P=z*Math.cos(R),S=z*Math.sin(R)}else P=S=NaN;M[c]=L[2*c]=P,I[c]=L[2*c+1]=S}o.tree=g(L),_.marker&&b>=t&&(_.marker.cluster=o.tree),_.marker&&(_.markerSel.positions=_.markerUnsel.positions=_.marker.positions=L),_.line&&L.length>1&&n.extendFlat(_.line,e.linePositions(a,p,L)),_.text&&(n.extendFlat(_.text,{positions:L},e.textPosition(a,p,_.text,_.marker)),n.extendFlat(_.textSel,{positions:L},e.textPosition(a,p,_.text,_.markerSel)),n.extendFlat(_.textUnsel,{positions:L},e.textPosition(a,p,_.text,_.markerUnsel))),_.fill&&!u.fill2d&&(u.fill2d=!0),_.marker&&!u.scatter2d&&(u.scatter2d=!0),_.line&&!u.line2d&&(u.line2d=!0),_.text&&!u.glText&&(u.glText=!0),u.lineOptions.push(_.line),u.fillOptions.push(_.fill),u.markerOptions.push(_.marker),u.markerSelectedOptions.push(_.markerSel),u.markerUnselectedOptions.push(_.markerUnsel),u.textOptions.push(_.text),u.textSelectedOptions.push(_.textSel),u.textUnselectedOptions.push(_.textUnsel),u.selectBatch.push([]),u.unselectBatch.push([]),o.x=M,o.y=I,o.rawx=M,o.rawy=I,o.r=l,o.theta=T,o.positions=L,o._scene=u,o.index=u.count,u.count++}}),m(a,r,d)}},ee.exports.reglPrecompiled={}},{"../../lib":515,"../scattergl/constants":991,"../scattergl/convert":992,"../scattergl/plot":999,"../scattergl/scene_update":1e3,"@plotly/point-cluster":59,"fast-isnumeric":190}],1026:[function(y,ee,Q){"use strict";var g=y("../../plots/template_attributes").hovertemplateAttrs,v=y("../../plots/template_attributes").texttemplateAttrs,m=y("../../lib/extend").extendFlat,x=y("../scatter/attributes"),e=y("../../plots/attributes"),n=x.line;ee.exports={mode:x.mode,real:{valType:"data_array",editType:"calc+clearAxisTypes"},imag:{valType:"data_array",editType:"calc+clearAxisTypes"},text:x.text,texttemplate:v({editType:"plot"},{keys:["real","imag","text"]}),hovertext:x.hovertext,line:{color:n.color,width:n.width,dash:n.dash,shape:m({},n.shape,{values:["linear","spline"]}),smoothing:n.smoothing,editType:"calc"},connectgaps:x.connectgaps,marker:x.marker,cliponaxis:m({},x.cliponaxis,{dflt:!1}),textposition:x.textposition,textfont:x.textfont,fill:m({},x.fill,{values:["none","toself","tonext"],dflt:"none"}),fillcolor:x.fillcolor,hoverinfo:m({},e.hoverinfo,{flags:["real","imag","text","name"]}),hoveron:x.hoveron,hovertemplate:g(),selected:x.selected,unselected:x.unselected}},{"../../lib/extend":505,"../../plots/attributes":562,"../../plots/template_attributes":642,"../scatter/attributes":936}],1027:[function(y,ee,Q){"use strict";var g=y("fast-isnumeric"),v=y("../../constants/numerical").BADNUM,m=y("../scatter/colorscale_calc"),x=y("../scatter/arrays_to_calcdata"),e=y("../scatter/calc_selection"),n=y("../scatter/calc").calcMarkerSize;ee.exports=function(t,a){for(var r=t._fullLayout,d=a.subplot,i=r[d].imaginaryaxis,u=r[d].realaxis.makeCalcdata(a,"real"),f=i.makeCalcdata(a,"imag"),c=a._length,h=new Array(c),p=0;p<c;p++){var o=u[p],b=f[p],l=h[p]={};g(o)&&g(b)?(l.real=o,l.imag=b):l.real=v}return n(a,c),m(t,a),x(h,a),e(h,a),h}},{"../../constants/numerical":491,"../scatter/arrays_to_calcdata":935,"../scatter/calc":937,"../scatter/calc_selection":938,"../scatter/colorscale_calc":939,"fast-isnumeric":190}],1028:[function(y,ee,Q){"use strict";var g=y("../../lib"),v=y("../scatter/subtypes"),m=y("../scatter/marker_defaults"),x=y("../scatter/line_defaults"),e=y("../scatter/line_shape_defaults"),n=y("../scatter/text_defaults"),t=y("../scatter/fillcolor_defaults"),a=y("../scatter/constants").PTS_LINESONLY,r=y("./attributes");ee.exports=function(d,s,i,u){function f(p,o){return g.coerce(d,s,r,p,o)}var o,l,T,_,w,c=(o=s,_=(l=f)("real"),w=l("imag"),_&&w&&(T=Math.min(_.length,w.length)),o._length=T,T);if(c){f("mode",c<a?"lines+markers":"lines"),f("text"),f("hovertext"),"fills"!==s.hoveron&&f("hovertemplate"),v.hasLines(s)&&(x(d,s,i,u,f),e(d,s,f),f("connectgaps")),v.hasMarkers(s)&&m(d,s,i,u,f,{gradient:!0}),v.hasText(s)&&(f("texttemplate"),n(d,s,u,f));var h=[];(v.hasMarkers(s)||v.hasText(s))&&(f("cliponaxis"),f("marker.maxdisplayed"),h.push("points")),f("fill"),"none"!==s.fill&&(t(d,s,i,f),v.hasLines(s)||e(d,s,f)),"tonext"!==s.fill&&"toself"!==s.fill||h.push("fills"),f("hoveron",h.join("+")||"points"),g.coerceSelectionMarkerOpacity(s,f)}else s.visible=!1}},{"../../lib":515,"../scatter/constants":940,"../scatter/fillcolor_defaults":944,"../scatter/line_defaults":949,"../scatter/line_shape_defaults":951,"../scatter/marker_defaults":955,"../scatter/subtypes":961,"../scatter/text_defaults":962,"./attributes":1026}],1029:[function(y,ee,Q){"use strict";var g=y("../../plots/cartesian/axes");ee.exports=function(v,m,x){var e={},n=x[m.subplot]._subplot;return e.realLabel=g.tickText(n.radialAxis,v.real,!0).text,e.imagLabel=g.tickText(n.angularAxis,v.imag,!0).text,e}},{"../../plots/cartesian/axes":566}],1030:[function(y,ee,Q){"use strict";var g=y("../scatter/hover");function v(m,x,e,n){var t=e.radialAxis,a=e.angularAxis;t._hovertitle="real",a._hovertitle="imag";var r={};r[x.subplot]={_subplot:e};var d=x._module.formatLabels(m,x,r);n.realLabel=d.realLabel,n.imagLabel=d.imagLabel;var i=[];function u(c,h){i.push(c._hovertitle+": "+h)}if(!x.hovertemplate){var f=(m.hi||x.hoverinfo).split("+");-1!==f.indexOf("all")&&(f=["real","imag","text"]),-1!==f.indexOf("real")&&u(t,n.realLabel),-1!==f.indexOf("imag")&&u(a,n.imagLabel),-1!==f.indexOf("text")&&n.text&&(i.push(n.text),delete n.text),n.extraText=i.join("<br>")}}ee.exports={hoverPoints:function(m,x,e,n){var t=g(m,x,e,n);if(t&&!1!==t[0].index){var a=t[0];if(void 0===a.index)return t;var r=m.subplot,d=a.cd[a.index],s=a.trace;if(r.isPtInside(d))return a.xLabelVal=void 0,a.yLabelVal=void 0,v(d,s,r,a),a.hovertemplate=s.hovertemplate,t}},makeHoverPointText:v}},{"../scatter/hover":947}],1031:[function(y,ee,Q){"use strict";ee.exports={moduleType:"trace",name:"scattersmith",basePlotModule:y("../../plots/smith"),categories:["smith","symbols","showLegend","scatter-like"],attributes:y("./attributes"),supplyDefaults:y("./defaults"),colorbar:y("../scatter/marker_colorbar"),formatLabels:y("./format_labels"),calc:y("./calc"),plot:y("./plot"),style:y("../scatter/style").style,styleOnSelect:y("../scatter/style").styleOnSelect,hoverPoints:y("./hover").hoverPoints,selectPoints:y("../scatter/select"),meta:{}}},{"../../plots/smith":638,"../scatter/marker_colorbar":954,"../scatter/select":958,"../scatter/style":960,"./attributes":1026,"./calc":1027,"./defaults":1028,"./format_labels":1029,"./hover":1030,"./plot":1032}],1032:[function(y,ee,Q){"use strict";var g=y("../scatter/plot"),v=y("../../constants/numerical").BADNUM,m=y("../../plots/smith/helpers").smith;ee.exports=function(x,e,n){for(var t=e.layers.frontplot.select("g.scatterlayer"),a={xaxis:e.xaxis,yaxis:e.yaxis,plot:e.framework,layerClipId:e._hasClipOnAxisFalse?e.clipIds.forTraces:null},r=0;r<n.length;r++)for(var d=n[r],s=0;s<d.length;s++){var i=d[s],u=i.real;if(u===v)i.x=i.y=v;else{var f=m([u,i.imag]);i.x=f[0],i.y=f[1]}}g(x,a,n,t)}},{"../../constants/numerical":491,"../../plots/smith/helpers":637,"../scatter/plot":957}],1033:[function(y,ee,Q){"use strict";var g=y("../../plots/template_attributes").hovertemplateAttrs,v=y("../../plots/template_attributes").texttemplateAttrs,m=y("../scatter/attributes"),x=y("../../plots/attributes"),e=y("../../components/colorscale/attributes"),n=y("../../components/drawing/attributes").dash,t=y("../../lib/extend").extendFlat,a=m.marker,r=m.line,d=a.line;ee.exports={a:{valType:"data_array",editType:"calc"},b:{valType:"data_array",editType:"calc"},c:{valType:"data_array",editType:"calc"},sum:{valType:"number",dflt:0,min:0,editType:"calc"},mode:t({},m.mode,{dflt:"markers"}),text:t({},m.text,{}),texttemplate:v({editType:"plot"},{keys:["a","b","c","text"]}),hovertext:t({},m.hovertext,{}),line:{color:r.color,width:r.width,dash:n,shape:t({},r.shape,{values:["linear","spline"]}),smoothing:r.smoothing,editType:"calc"},connectgaps:m.connectgaps,cliponaxis:m.cliponaxis,fill:t({},m.fill,{values:["none","toself","tonext"],dflt:"none"}),fillcolor:m.fillcolor,marker:t({symbol:a.symbol,opacity:a.opacity,maxdisplayed:a.maxdisplayed,size:a.size,sizeref:a.sizeref,sizemin:a.sizemin,sizemode:a.sizemode,line:t({width:d.width,editType:"calc"},e("marker.line")),gradient:a.gradient,editType:"calc"},e("marker")),textfont:m.textfont,textposition:m.textposition,selected:m.selected,unselected:m.unselected,hoverinfo:t({},x.hoverinfo,{flags:["a","b","c","text","name"]}),hoveron:m.hoveron,hovertemplate:g()}},{"../../components/colorscale/attributes":374,"../../components/drawing/attributes":388,"../../lib/extend":505,"../../plots/attributes":562,"../../plots/template_attributes":642,"../scatter/attributes":936}],1034:[function(y,ee,Q){"use strict";var g=y("fast-isnumeric"),v=y("../scatter/colorscale_calc"),m=y("../scatter/arrays_to_calcdata"),x=y("../scatter/calc_selection"),e=y("../scatter/calc").calcMarkerSize,n=["a","b","c"],t={a:["b","c"],b:["a","c"],c:["a","b"]};ee.exports=function(a,r){var d,s,i,u,f,c,h=a._fullLayout[r.subplot].sum,p=r.sum||h,o={a:r.a,b:r.b,c:r.c};for(d=0;d<n.length;d++)if(!o[i=n[d]]){for(f=o[t[i][0]],c=o[t[i][1]],u=new Array(f.length),s=0;s<f.length;s++)u[s]=p-f[s]-c[s];o[i]=u}var b,l,T,_,L=r._length,M=new Array(L);for(d=0;d<L;d++)l=o.b[d],T=o.c[d],g(b=o.a[d])&&g(l)&&g(T)?(1!=(_=h/((b=+b)+(l=+l)+(T=+T)))&&(b*=_,l*=_,T*=_),M[d]={x:T-l,y:b,a:b,b:l,c:T}):M[d]={x:!1,y:!1};return e(r,L),v(a,r),m(M,r),x(M,r),M}},{"../scatter/arrays_to_calcdata":935,"../scatter/calc":937,"../scatter/calc_selection":938,"../scatter/colorscale_calc":939,"fast-isnumeric":190}],1035:[function(y,ee,Q){"use strict";var g=y("../../lib"),v=y("../scatter/constants"),m=y("../scatter/subtypes"),x=y("../scatter/marker_defaults"),e=y("../scatter/line_defaults"),n=y("../scatter/line_shape_defaults"),t=y("../scatter/text_defaults"),a=y("../scatter/fillcolor_defaults"),r=y("./attributes");ee.exports=function(d,s,i,u){function f(l,T){return g.coerce(d,s,r,l,T)}var c,h=f("a"),p=f("b"),o=f("c");if(h?(c=h.length,p?(c=Math.min(c,p.length),o&&(c=Math.min(c,o.length))):c=o?Math.min(c,o.length):0):p&&o&&(c=Math.min(p.length,o.length)),c){s._length=c,f("sum"),f("text"),f("hovertext"),"fills"!==s.hoveron&&f("hovertemplate"),f("mode",c<v.PTS_LINESONLY?"lines+markers":"lines"),m.hasLines(s)&&(e(d,s,i,u,f),n(d,s,f),f("connectgaps")),m.hasMarkers(s)&&x(d,s,i,u,f,{gradient:!0}),m.hasText(s)&&(f("texttemplate"),t(d,s,u,f));var b=[];(m.hasMarkers(s)||m.hasText(s))&&(f("cliponaxis"),f("marker.maxdisplayed"),b.push("points")),f("fill"),"none"!==s.fill&&(a(d,s,i,f),m.hasLines(s)||n(d,s,f)),"tonext"!==s.fill&&"toself"!==s.fill||b.push("fills"),f("hoveron",b.join("+")||"points"),g.coerceSelectionMarkerOpacity(s,f)}else s.visible=!1}},{"../../lib":515,"../scatter/constants":940,"../scatter/fillcolor_defaults":944,"../scatter/line_defaults":949,"../scatter/line_shape_defaults":951,"../scatter/marker_defaults":955,"../scatter/subtypes":961,"../scatter/text_defaults":962,"./attributes":1033}],1036:[function(y,ee,Q){"use strict";ee.exports=function(g,v,m,x,e){if(v.xa&&(g.xaxis=v.xa),v.ya&&(g.yaxis=v.ya),x[e]){var n=x[e];g.a=n.a,g.b=n.b,g.c=n.c}else g.a=v.a,g.b=v.b,g.c=v.c;return g}},{}],1037:[function(y,ee,Q){"use strict";var g=y("../../plots/cartesian/axes");ee.exports=function(v,m,x){var e={},n=x[m.subplot]._subplot;return e.aLabel=g.tickText(n.aaxis,v.a,!0).text,e.bLabel=g.tickText(n.baxis,v.b,!0).text,e.cLabel=g.tickText(n.caxis,v.c,!0).text,e}},{"../../plots/cartesian/axes":566}],1038:[function(y,ee,Q){"use strict";var g=y("../scatter/hover");ee.exports=function(v,m,x,e){var n=g(v,m,x,e);if(n&&!1!==n[0].index){var t=n[0];if(void 0===t.index){var r=v.xa._length,d=r*(1-t.y0/v.ya._length)/2,s=r-d;return t.x0=Math.max(Math.min(t.x0,s),d),t.x1=Math.max(Math.min(t.x1,s),d),n}var i=t.cd[t.index],u=t.trace,f=t.subplot;t.a=i.a,t.b=i.b,t.c=i.c,t.xLabelVal=void 0,t.yLabelVal=void 0;var c={};c[u.subplot]={_subplot:f};var h=u._module.formatLabels(i,u,c);t.aLabel=h.aLabel,t.bLabel=h.bLabel,t.cLabel=h.cLabel;var o=[];if(!u.hovertemplate){var b=(i.hi||u.hoverinfo).split("+");-1!==b.indexOf("all")&&(b=["a","b","c"]),-1!==b.indexOf("a")&&l(f.aaxis,t.aLabel),-1!==b.indexOf("b")&&l(f.baxis,t.bLabel),-1!==b.indexOf("c")&&l(f.caxis,t.cLabel)}return t.extraText=o.join("<br>"),t.hovertemplate=u.hovertemplate,n}function l(T,_){o.push(T._hovertitle+": "+_)}}},{"../scatter/hover":947}],1039:[function(y,ee,Q){"use strict";ee.exports={attributes:y("./attributes"),supplyDefaults:y("./defaults"),colorbar:y("../scatter/marker_colorbar"),formatLabels:y("./format_labels"),calc:y("./calc"),plot:y("./plot"),style:y("../scatter/style").style,styleOnSelect:y("../scatter/style").styleOnSelect,hoverPoints:y("./hover"),selectPoints:y("../scatter/select"),eventData:y("./event_data"),moduleType:"trace",name:"scatterternary",basePlotModule:y("../../plots/ternary"),categories:["ternary","symbols","showLegend","scatter-like"],meta:{}}},{"../../plots/ternary":643,"../scatter/marker_colorbar":954,"../scatter/select":958,"../scatter/style":960,"./attributes":1033,"./calc":1034,"./defaults":1035,"./event_data":1036,"./format_labels":1037,"./hover":1038,"./plot":1040}],1040:[function(y,ee,Q){"use strict";var g=y("../scatter/plot");ee.exports=function(v,m,x){var e=m.plotContainer;e.select(".scatterlayer").selectAll("*").remove();var n={xaxis:m.xaxis,yaxis:m.yaxis,plot:e,layerClipId:m._hasClipOnAxisFalse?m.clipIdRelative:null},t=m.layers.frontplot.select("g.scatterlayer");g(v,n,x,t)}},{"../scatter/plot":957}],1041:[function(y,ee,Q){"use strict";var g=y("../scatter/attributes"),v=y("../../components/colorscale/attributes"),m=y("../../plots/cartesian/axis_format_attributes").axisHoverFormat,x=y("../../plots/template_attributes").hovertemplateAttrs,e=y("../scattergl/attributes"),n=y("../../plots/cartesian/constants").idRegex,t=y("../../plot_api/plot_template").templatedArray,a=y("../../lib/extend").extendFlat,r=g.marker,d=r.line,s=a(v("marker.line",{editTypeOverride:"calc"}),{width:a({},d.width,{editType:"calc"}),editType:"calc"}),i=a(v("marker"),{symbol:r.symbol,size:a({},r.size,{editType:"markerSize"}),sizeref:r.sizeref,sizemin:r.sizemin,sizemode:r.sizemode,opacity:r.opacity,colorbar:r.colorbar,line:s,editType:"calc"});function u(f){return{valType:"info_array",freeLength:!0,editType:"calc",items:{valType:"subplotid",regex:n[f],editType:"plot"}}}i.color.editType=i.cmin.editType=i.cmax.editType="style",ee.exports={dimensions:t("dimension",{visible:{valType:"boolean",dflt:!0,editType:"calc"},label:{valType:"string",editType:"calc"},values:{valType:"data_array",editType:"calc+clearAxisTypes"},axis:{type:{valType:"enumerated",values:["linear","log","date","category"],editType:"calc+clearAxisTypes"},matches:{valType:"boolean",dflt:!1,editType:"calc"},editType:"calc+clearAxisTypes"},editType:"calc+clearAxisTypes"}),text:a({},e.text,{}),hovertext:a({},e.hovertext,{}),hovertemplate:x(),xhoverformat:m("x"),yhoverformat:m("y"),marker:i,xaxes:u("x"),yaxes:u("y"),diagonal:{visible:{valType:"boolean",dflt:!0,editType:"calc"},editType:"calc"},showupperhalf:{valType:"boolean",dflt:!0,editType:"calc"},showlowerhalf:{valType:"boolean",dflt:!0,editType:"calc"},selected:{marker:e.selected.marker,editType:"calc"},unselected:{marker:e.unselected.marker,editType:"calc"},opacity:e.opacity}},{"../../components/colorscale/attributes":374,"../../lib/extend":505,"../../plot_api/plot_template":555,"../../plots/cartesian/axis_format_attributes":569,"../../plots/cartesian/constants":573,"../../plots/template_attributes":642,"../scatter/attributes":936,"../scattergl/attributes":988}],1042:[function(y,ee,Q){"use strict";var g=y("../../registry"),v=y("../../components/grid");ee.exports={moduleType:"trace",name:"splom",categories:["gl","regl","cartesian","symbols","showLegend","scatter-like"],attributes:y("./attributes"),supplyDefaults:y("./defaults"),colorbar:y("../scatter/marker_colorbar"),calc:y("./calc"),plot:y("./plot"),hoverPoints:y("./hover").hoverPoints,selectPoints:y("./select"),editStyle:y("./edit_style"),meta:{}},g.register(v)},{"../../components/grid":411,"../../registry":647,"../scatter/marker_colorbar":954,"./attributes":1041,"./calc":1044,"./defaults":1045,"./edit_style":1046,"./hover":1048,"./plot":1050,"./select":1052}],1043:[function(y,ee,Q){"use strict";var g=y("regl-line2d"),v=y("../../registry"),m=y("../../lib/prepare_regl"),x=y("../../plots/get_data").getModuleCalcData,e=y("../../plots/cartesian"),n=y("../../plots/cartesian/axis_ids").getFromId,t=y("../../plots/cartesian/axes").shouldShowZeroLine,a={};function r(s,i,u){for(var c=i._visibleDims,h=u.viewOpts.ranges=new Array(u.matrixOptions.data.length),p=0;p<c.length;p++){var o=c[p],b=h[p]=new Array(4),l=n(s,i._diag[o][0]);l&&(b[0]=l.r2l(l.range[0]),b[2]=l.r2l(l.range[1]));var T=n(s,i._diag[o][1]);T&&(b[1]=T.r2l(T.range[0]),b[3]=T.r2l(T.range[1]))}u.selectBatch.length||u.unselectBatch.length?u.matrix.update({ranges:h},{ranges:h}):u.matrix.update({ranges:h})}function d(s){var i=s._fullLayout,u=i._glcanvas.data()[0].regl,f=i._splomGrid;f||(f=i._splomGrid=g(u)),f.update(function(c){var h,p=c._context.plotGlPixelRatio,o=c._fullLayout,b=o._size,l=[0,0,o.width*p,o.height*p],T={};function _(G,Y,$,B,N,U){$*=p,B*=p,N*=p,U*=p;var te=Y[G+"color"],j=Y[G+"width"],J=String(te+j);J in T?T[J].data.push(NaN,NaN,$,B,N,U):T[J]={data:[$,B,N,U],join:"rect",thickness:j*p,color:te,viewport:l,range:l,overlay:!1}}for(h in o._splomSubplots){var w,k,L=o._plots[h],M=L.xaxis,I=L.yaxis,P=M._gridVals,S=I._gridVals,E=M._offset,z=M._length,R=I._length,q=b.b+I.domain[0]*b.h,V=-I._m,W=-V*I.r2l(I.range[0],I.calendar);if(M.showgrid)for(h=0;h<P.length;h++)w=E+M.l2p(P[h].x),_("grid",M,w,q,w,q+R);if(I.showgrid)for(h=0;h<S.length;h++)_("grid",I,E,k=q+W+V*S[h].x,E+z,k);t(c,M,I)&&(w=E+M.l2p(0),_("zeroline",M,w,q,w,q+R)),t(c,I,M)&&_("zeroline",I,E,k=q+W+0,E+z,k)}var K=[];for(h in T)K.push(T[h]);return K}(s))}ee.exports={name:"splom",attr:e.attr,attrRegex:e.attrRegex,layoutAttributes:e.layoutAttributes,supplyLayoutDefaults:e.supplyLayoutDefaults,drawFramework:e.drawFramework,plot:function(s){var i=s._fullLayout,u=v.getModule("splom"),f=x(s.calcdata,u)[0];m(s,["ANGLE_instanced_arrays","OES_element_index_uint"],a)&&(i._hasOnlyLargeSploms&&d(s),u.plot(s,{},f))},drag:function(s){var i=s.calcdata,u=s._fullLayout;u._hasOnlyLargeSploms&&d(s);for(var f=0;f<i.length;f++){var c=i[f][0].trace,h=u._splomScenes[c.uid];"splom"===c.type&&h&&h.matrix&&r(s,c,h)}},updateGrid:d,clean:function(s,i,u,f){var c,h={};if(f._splomScenes){for(c=0;c<s.length;c++){var p=s[c];"splom"===p.type&&(h[p.uid]=1)}for(c=0;c<u.length;c++){var o=u[c];if(!h[o.uid]){var b=f._splomScenes[o.uid];b&&b.destroy&&b.destroy(),f._splomScenes[o.uid]=null,delete f._splomScenes[o.uid]}}}0===Object.keys(f._splomScenes||{}).length&&delete f._splomScenes,f._splomGrid&&!i._hasOnlyLargeSploms&&f._hasOnlyLargeSploms&&(f._splomGrid.destroy(),f._splomGrid=null,delete f._splomGrid),e.clean(s,i,u,f)},updateFx:e.updateFx,toSVG:e.toSVG,reglPrecompiled:a}},{"../../lib/prepare_regl":528,"../../plots/cartesian":578,"../../plots/cartesian/axes":566,"../../plots/cartesian/axis_ids":570,"../../plots/get_data":602,"../../registry":647,"regl-line2d":281}],1044:[function(y,ee,Q){"use strict";var g=y("../../lib"),v=y("../../plots/cartesian/axis_ids"),m=y("../scatter/calc").calcMarkerSize,x=y("../scatter/calc").calcAxisExpansion,e=y("../scatter/colorscale_calc"),n=y("../scattergl/convert").markerSelection,t=y("../scattergl/convert").markerStyle,a=y("./scene_update"),r=y("../../constants/numerical").BADNUM,d=y("../scattergl/constants").TOO_MANY_POINTS;ee.exports=function(s,i){var u,f,c,h,p,o,b=i.dimensions,l=i._length,T={},_=T.cdata=[],w=T.data=[],k=i._visibleDims=[];function L(I,P){for(var S=I.makeCalcdata({v:P.values,vcalendar:i.calendar},"v"),E=0;E<S.length;E++)S[E]=S[E]===r?NaN:S[E];_.push(S),w.push("log"===I.type?g.simpleMap(S,I.c2l):S)}for(u=0;u<b.length;u++)if((c=b[u]).visible){if(h=v.getFromId(s,i._diag[u][0]),p=v.getFromId(s,i._diag[u][1]),h&&p&&h.type!==p.type){g.log("Skipping splom dimension "+u+" with conflicting axis types");continue}h?(L(h,c),p&&"category"===p.type&&(p._categories=h._categories.slice())):L(p,c),k.push(u)}for(e(s,i),g.extendFlat(T,t(i)),o=_.length*l>d?T.sizeAvg||Math.max(T.size,3):m(i,l),f=0;f<k.length;f++)c=b[u=k[f]],h=v.getFromId(s,i._diag[u][0])||{},p=v.getFromId(s,i._diag[u][1])||{},x(s,i,h,p,_[f],_[f],o);var M=a(s,i);return M.matrix||(M.matrix=!0),M.matrixOptions=T,M.selectedOptions=n(i,i.selected),M.unselectedOptions=n(i,i.unselected),[{x:!1,y:!1,t:{},trace:i}]}},{"../../constants/numerical":491,"../../lib":515,"../../plots/cartesian/axis_ids":570,"../scatter/calc":937,"../scatter/colorscale_calc":939,"../scattergl/constants":991,"../scattergl/convert":992,"./scene_update":1051}],1045:[function(y,ee,Q){"use strict";var g=y("../../lib"),v=y("../../plots/array_container_defaults"),m=y("./attributes"),x=y("../scatter/subtypes"),e=y("../scatter/marker_defaults"),n=y("../parcoords/merge_length"),t=y("../scattergl/helpers").isOpenSymbol;function a(r,d){function s(u,f){return g.coerce(r,d,m.dimensions,u,f)}s("label");var i=s("values");i&&i.length?s("visible"):d.visible=!1,s("axis.type"),s("axis.matches")}ee.exports=function(r,d,s,i){function u(l,T){return g.coerce(r,d,m,l,T)}var f=v(r,d,{name:"dimensions",handleItemDefaults:a}),c=u("diagonal.visible"),h=u("showupperhalf"),p=u("showlowerhalf");if(n(d,f,"values")&&(c||h||p)){u("text"),u("hovertext"),u("hovertemplate"),u("xhoverformat"),u("yhoverformat"),e(r,d,s,i,u);var o=t(d.marker.symbol),b=x.isBubble(d);u("marker.line.width",o||b?1:0),function(l,T,_,w){var k,L,M=T.dimensions,I=M.length,P=T.showupperhalf,S=T.showlowerhalf,E=T.diagonal.visible,z=new Array(I),R=new Array(I);for(k=0;k<I;k++){var q=k?k+1:"";z[k]="x"+q,R[k]="y"+q}var V=w("xaxes",z),W=w("yaxes",R),K=T._diag=new Array(I);T._xaxes={},T._yaxes={};var G=[],Y=[];function $(ne,le,oe,de){if(ne){var se=ne.charAt(0),ge=_._splomAxes[se];if(T["_"+se+"axes"][ne]=1,de.push(ne),!(ne in ge)){var _e=ge[ne]={};oe&&(_e.label=oe.label||"",oe.visible&&oe.axis&&(oe.axis.type&&(_e.type=oe.axis.type),oe.axis.matches&&(_e.matches=le)))}}}var B=!E&&!S,N=!E&&!P;for(T._axesDim={},k=0;k<I;k++){var U=M[k],te=0===k,j=k===I-1,J=te&&B||j&&N?void 0:V[k],X=te&&N||j&&B?void 0:W[k];$(J,X,U,G),$(X,J,U,Y),K[k]=[J,X],T._axesDim[J]=k,T._axesDim[X]=k}for(k=0;k<G.length;k++)for(L=0;L<Y.length;L++){var re=G[k]+Y[L];k>L&&P||k<L&&S?_._splomSubplots[re]=1:k!==L||!E&&S&&P||(_._splomSubplots[re]=1)}(!S||!E&&P&&S)&&(_._splomGridDflt.xside="bottom",_._splomGridDflt.yside="left")}(0,d,i,u),g.coerceSelectionMarkerOpacity(d,u)}else d.visible=!1}},{"../../lib":515,"../../plots/array_container_defaults":561,"../parcoords/merge_length":907,"../scatter/marker_defaults":955,"../scatter/subtypes":961,"../scattergl/helpers":996,"./attributes":1041}],1046:[function(y,ee,Q){"use strict";var g=y("../../lib"),v=y("../scatter/colorscale_calc"),m=y("../scattergl/convert").markerStyle;ee.exports=function(x,e){var n=e.trace,t=x._fullLayout._splomScenes[n.uid];if(t){v(x,n),g.extendFlat(t.matrixOptions,m(n));var a=g.extendFlat({},t.matrixOptions,t.viewOpts);t.matrix.update(a,null)}}},{"../../lib":515,"../scatter/colorscale_calc":939,"../scattergl/convert":992}],1047:[function(y,ee,Q){"use strict";Q.getDimIndex=function(g,v){for(var m=v._id,x={x:0,y:1}[m.charAt(0)],e=g._visibleDims,n=0;n<e.length;n++)if(g._diag[e[n]][x]===m)return n;return!1}},{}],1048:[function(y,ee,Q){"use strict";var g=y("./helpers"),v=y("../scattergl/hover").calcHover;ee.exports={hoverPoints:function(m,x,e){var n=m.cd[0].trace,t=m.scene.matrixOptions.cdata,a=m.xa,r=m.ya,d=a.c2p(x),s=r.c2p(e),i=m.distance,u=g.getDimIndex(n,a),f=g.getDimIndex(n,r);if(!1===u||!1===f)return[m];for(var c,h,p=t[u],o=t[f],b=i,l=0;l<p.length;l++){var _=o[l],w=a.c2p(p[l])-d,k=r.c2p(_)-s,L=Math.sqrt(w*w+k*k);L<b&&(b=h=L,c=l)}return m.index=c,m.distance=b,m.dxy=h,void 0===c?[m]:[v(m,p,o,n)]}}},{"../scattergl/hover":997,"./helpers":1047}],1049:[function(y,ee,Q){"use strict";var g=y("./base_index");g.basePlotModule=y("./base_plot"),ee.exports=g},{"./base_index":1042,"./base_plot":1043}],1050:[function(y,ee,Q){"use strict";var g=y("regl-splom"),v=y("../../lib"),m=y("../../plots/cartesian/axis_ids"),x=y("../../components/dragelement/helpers").selectMode;function e(n,t){var a,r,d,s,i,u=n._fullLayout,f=u._size,c=t.trace,h=t.t,p=u._splomScenes[c.uid],o=p.matrixOptions,b=o.cdata,l=u._glcanvas.data()[0].regl,T=u.dragmode;if(0!==b.length){o.lower=c.showupperhalf,o.upper=c.showlowerhalf,o.diagonal=c.diagonal.visible;var _=c._visibleDims,w=b.length,k=p.viewOpts={};for(k.ranges=new Array(w),k.domains=new Array(w),i=0;i<_.length;i++){d=_[i];var L=k.ranges[i]=new Array(4),M=k.domains[i]=new Array(4);(a=m.getFromId(n,c._diag[d][0]))&&(L[0]=a._rl[0],L[2]=a._rl[1],M[0]=a.domain[0],M[2]=a.domain[1]),(r=m.getFromId(n,c._diag[d][1]))&&(L[1]=r._rl[0],L[3]=r._rl[1],M[1]=r.domain[0],M[3]=r.domain[1])}var I=n._context.plotGlPixelRatio,P=f.l*I,S=f.b*I;k.viewport=[P,S,f.w*I+P,f.h*I+S],!0===p.matrix&&(p.matrix=g(l));var R=u.clickmode.indexOf("select")>-1,q=!0;if(x(T)||c.selectedpoints||R){var V=c._length;if(c.selectedpoints){p.selectBatch=c.selectedpoints;var W=c.selectedpoints,K={};for(d=0;d<W.length;d++)K[W[d]]=!0;var G=[];for(d=0;d<V;d++)K[d]||G.push(d);p.unselectBatch=G}var Y=h.xpx=new Array(w),$=h.ypx=new Array(w);for(i=0;i<_.length;i++){if(a=m.getFromId(n,c._diag[d=_[i]][0]))for(Y[i]=new Array(V),s=0;s<V;s++)Y[i][s]=a.c2p(b[i][s]);if(r=m.getFromId(n,c._diag[d][1]))for($[i]=new Array(V),s=0;s<V;s++)$[i][s]=r.c2p(b[i][s])}if(p.selectBatch.length||p.unselectBatch.length){var B=v.extendFlat({},o,p.unselectedOptions,k),N=v.extendFlat({},o,p.selectedOptions,k);p.matrix.update(B,N),q=!1}}else h.xpx=h.ypx=null;if(q){var U=v.extendFlat({},o,k);p.matrix.update(U,null)}}}ee.exports=function(n,t,a){if(a.length)for(var r=0;r<a.length;r++)e(n,a[r][0])}},{"../../components/dragelement/helpers":385,"../../lib":515,"../../plots/cartesian/axis_ids":570,"regl-splom":283}],1051:[function(y,ee,Q){"use strict";var g=y("../../lib");ee.exports=function(v,m){var x=v._fullLayout,e=m.uid,n=x._splomScenes;n||(n=x._splomScenes={});var t={dirty:!0,selectBatch:[],unselectBatch:[]},a=n[m.uid];return a||((a=n[e]=g.extendFlat({},t,{matrix:!1,selectBatch:[],unselectBatch:[]})).draw=function(){a.matrix&&a.matrix.draw&&(a.selectBatch.length||a.unselectBatch.length?a.matrix.draw(a.unselectBatch,a.selectBatch):a.matrix.draw()),a.dirty=!1},a.destroy=function(){a.matrix&&a.matrix.destroy&&a.matrix.destroy(),a.matrixOptions=null,a.selectBatch=null,a.unselectBatch=null,a=null}),a.dirty||g.extendFlat(a,t),a}},{"../../lib":515}],1052:[function(y,ee,Q){"use strict";var g=y("../../lib"),v=g.pushUnique,m=y("../scatter/subtypes"),x=y("./helpers");ee.exports=function(e,n){var t=e.cd,a=t[0].trace,r=t[0].t,d=e.scene,s=d.matrixOptions.cdata,i=e.xaxis,u=e.yaxis,f=[];if(!d)return f;var c=!m.hasMarkers(a)&&!m.hasText(a);if(!0!==a.visible||c)return f;var h=x.getDimIndex(a,i),p=x.getDimIndex(a,u);if(!1===h||!1===p)return f;var o=r.xpx[h],b=r.ypx[p],l=s[h],T=s[p],_=(e.scene.selectBatch||[]).slice(),w=[];if(!1!==n&&!n.degenerate)for(var k=0;k<l.length;k++)n.contains([o[k],b[k]],null,k,e)?(f.push({pointNumber:k,x:l[k],y:T[k]}),v(_,k)):-1!==_.indexOf(k)?v(_,k):w.push(k);var L=d.matrixOptions;return _.length||w.length?d.selectBatch.length||d.unselectBatch.length||d.matrix.update(d.unselectedOptions,g.extendFlat({},L,d.selectedOptions,d.viewOpts)):d.matrix.update(L,null),d.selectBatch=_,d.unselectBatch=w,f}},{"../../lib":515,"../scatter/subtypes":961,"./helpers":1047}],1053:[function(y,ee,Q){"use strict";var g=y("../../components/colorscale/attributes"),v=y("../../plots/cartesian/axis_format_attributes").axisHoverFormat,m=y("../../plots/template_attributes").hovertemplateAttrs,x=y("../mesh3d/attributes"),e=y("../../plots/attributes"),n=y("../../lib/extend").extendFlat,t={x:{valType:"data_array",editType:"calc+clearAxisTypes"},y:{valType:"data_array",editType:"calc+clearAxisTypes"},z:{valType:"data_array",editType:"calc+clearAxisTypes"},u:{valType:"data_array",editType:"calc"},v:{valType:"data_array",editType:"calc"},w:{valType:"data_array",editType:"calc"},starts:{x:{valType:"data_array",editType:"calc"},y:{valType:"data_array",editType:"calc"},z:{valType:"data_array",editType:"calc"},editType:"calc"},maxdisplayed:{valType:"integer",min:0,dflt:1e3,editType:"calc"},sizeref:{valType:"number",editType:"calc",min:0,dflt:1},text:{valType:"string",dflt:"",editType:"calc"},hovertext:{valType:"string",dflt:"",editType:"calc"},hovertemplate:m({editType:"calc"},{keys:["tubex","tubey","tubez","tubeu","tubev","tubew","norm","divergence"]}),uhoverformat:v("u",1),vhoverformat:v("v",1),whoverformat:v("w",1),xhoverformat:v("x"),yhoverformat:v("y"),zhoverformat:v("z"),showlegend:n({},e.showlegend,{dflt:!1})};n(t,g("",{colorAttr:"u/v/w norm",showScaleDflt:!0,editTypeOverride:"calc"})),["opacity","lightposition","lighting"].forEach(function(a){t[a]=x[a]}),t.hoverinfo=n({},e.hoverinfo,{editType:"calc",flags:["x","y","z","u","v","w","norm","divergence","text","name"],dflt:"x+y+z+norm+text+name"}),t.transforms=void 0,ee.exports=t},{"../../components/colorscale/attributes":374,"../../lib/extend":505,"../../plots/attributes":562,"../../plots/cartesian/axis_format_attributes":569,"../../plots/template_attributes":642,"../mesh3d/attributes":876}],1054:[function(y,ee,Q){"use strict";var g=y("../../lib"),v=y("../../components/colorscale/calc");function m(n){var t,a,r,d,s,i,u,f,c,h,p,o,b=n._x,l=n._y,T=n._z,_=n._len,w=-1/0,k=1/0,L=-1/0,M=1/0,I=-1/0,P=1/0,S="";for(_&&(u=b[0],c=l[0],p=T[0]),_>1&&(f=b[_-1],h=l[_-1],o=T[_-1]),t=0;t<_;t++)w=Math.max(w,b[t]),k=Math.min(k,b[t]),L=Math.max(L,l[t]),M=Math.min(M,l[t]),I=Math.max(I,T[t]),P=Math.min(P,T[t]),d||b[t]===u||(d=!0,S+="x"),s||l[t]===c||(s=!0,S+="y"),i||T[t]===p||(i=!0,S+="z");d||(S+="x"),s||(S+="y"),i||(S+="z");var E=x(n._x),z=x(n._y),R=x(n._z);S=(S=(S=S.replace("x",(u>f?"-":"+")+"x")).replace("y",(c>h?"-":"+")+"y")).replace("z",(p>o?"-":"+")+"z");var q=function(){_=0,E=[],z=[],R=[]};(!_||_<E.length*z.length*R.length)&&q();var V=function(se){return"x"===se?b:"y"===se?l:T},W=function(se){return"x"===se?E:"y"===se?z:R},K=function(se){return se[_-1]<se[0]?-1:1},G=V(S[1]),Y=V(S[3]),$=V(S[5]),B=W(S[1]).length,N=W(S[3]).length,U=W(S[5]).length,te=!1,j=function(se,ge,_e){return B*(N*se+ge)+_e},J=K(V(S[1])),X=K(V(S[3])),re=K(V(S[5]));for(t=0;t<U-1;t++){for(a=0;a<N-1;a++){for(r=0;r<B-1;r++){var ne=j(t,a,r),le=j(t,a,r+1),oe=j(t,a+1,r),de=j(t+1,a,r);if(G[ne]*J<G[le]*J&&Y[ne]*X<Y[oe]*X&&$[ne]*re<$[de]*re||(te=!0),te)break}if(te)break}if(te)break}return te&&(g.warn("Encountered arbitrary coordinates! Unable to input data grid."),q()),{xMin:k,yMin:M,zMin:P,xMax:w,yMax:L,zMax:I,Xs:E,Ys:z,Zs:R,len:_,fill:S}}function x(n){return g.distinctVals(n).vals}function e(n,t){if(void 0===t&&(t=n.length),g.isTypedArray(n))return n.subarray(0,t);for(var a=[],r=0;r<t;r++)a[r]=+n[r];return a}ee.exports={calc:function(n,t){t._len=Math.min(t.u.length,t.v.length,t.w.length,t.x.length,t.y.length,t.z.length),t._u=e(t.u,t._len),t._v=e(t.v,t._len),t._w=e(t.w,t._len),t._x=e(t.x,t._len),t._y=e(t.y,t._len),t._z=e(t.z,t._len);var a=m(t);t._gridFill=a.fill,t._Xs=a.Xs,t._Ys=a.Ys,t._Zs=a.Zs,t._len=a.len;var r,d,s,i=0;t.starts&&(r=e(t.starts.x||[]),d=e(t.starts.y||[]),s=e(t.starts.z||[]),i=Math.min(r.length,d.length,s.length)),t._startsX=r||[],t._startsY=d||[],t._startsZ=s||[];var u,f=0,c=1/0;for(u=0;u<t._len;u++){var h=t._u[u],p=t._v[u],o=t._w[u],b=Math.sqrt(h*h+p*p+o*o);f=Math.max(f,b),c=Math.min(c,b)}for(v(n,t,{vals:[c,f],containerStr:"",cLetter:"c"}),u=0;u<i;u++){var l=r[u];a.xMax=Math.max(a.xMax,l),a.xMin=Math.min(a.xMin,l);var T=d[u];a.yMax=Math.max(a.yMax,T),a.yMin=Math.min(a.yMin,T);var _=s[u];a.zMax=Math.max(a.zMax,_),a.zMin=Math.min(a.zMin,_)}t._slen=i,t._normMax=f,t._xbnds=[a.xMin,a.xMax],t._ybnds=[a.yMin,a.yMax],t._zbnds=[a.zMin,a.zMax]},filter:e,processGrid:m}},{"../../components/colorscale/calc":375,"../../lib":515}],1055:[function(y,ee,Q){"use strict";var g=y("../../../stackgl_modules").gl_streamtube3d,v=g.createTubeMesh,m=y("../../lib"),x=y("../../lib/gl_format_color").parseColorScale,e=y("../../components/colorscale").extractOpts,n=y("../../plots/gl3d/zip3"),t={xaxis:0,yaxis:1,zaxis:2};function a(u,f){this.scene=u,this.uid=f,this.mesh=null,this.data=null}var r=a.prototype;function d(u){var f=u.length;return f>2?u.slice(1,f-1):2===f?[(u[0]+u[1])/2]:u}function s(u){var f=u.length;return 1===f?[.5,.5]:[u[1]-u[0],u[f-1]-u[f-2]]}function i(u,f){var c=u.fullSceneLayout,h=u.dataScale,p=f._len,o={};function b(B,N){var U=c[N],te=h[t[N]];return m.simpleMap(B,function(j){return U.d2l(j)*te})}if(o.vectors=n(b(f._u,"xaxis"),b(f._v,"yaxis"),b(f._w,"zaxis"),p),!p)return{positions:[],cells:[]};var l=b(f._Xs,"xaxis"),T=b(f._Ys,"yaxis"),_=b(f._Zs,"zaxis");if(o.meshgrid=[l,T,_],o.gridFill=f._gridFill,f._slen)o.startingPositions=n(b(f._startsX,"xaxis"),b(f._startsY,"yaxis"),b(f._startsZ,"zaxis"));else{for(var w=T[0],k=d(l),L=d(_),M=new Array(k.length*L.length),I=0,P=0;P<k.length;P++)for(var S=0;S<L.length;S++)M[I++]=[k[P],w,L[S]];o.startingPositions=M}o.colormap=x(f),o.tubeSize=f.sizeref,o.maxLength=f.maxdisplayed;var E=b(f._xbnds,"xaxis"),z=b(f._ybnds,"yaxis"),R=b(f._zbnds,"zaxis"),q=s(l),V=s(T),W=s(_),G=g(o,[[E[0]-q[0],z[0]-V[0],R[0]-W[0]],[E[1]+q[1],z[1]+V[1],R[1]+W[1]]]),Y=e(f);G.vertexIntensityBounds=[Y.min/f._normMax,Y.max/f._normMax];var $=f.lightposition;return G.lightPosition=[$.x,$.y,$.z],G.ambient=f.lighting.ambient,G.diffuse=f.lighting.diffuse,G.specular=f.lighting.specular,G.roughness=f.lighting.roughness,G.fresnel=f.lighting.fresnel,G.opacity=f.opacity,f._pad=G.tubeScale*f.sizeref*2,G}r.handlePick=function(u){var f=this.scene.fullSceneLayout,c=this.scene.dataScale;function h(b,l){var _=c[t[l]];return f[l].l2c(b)/_}if(u.object===this.mesh){var p=u.data.position,o=u.data.velocity;return u.traceCoordinate=[h(p[0],"xaxis"),h(p[1],"yaxis"),h(p[2],"zaxis"),h(o[0],"xaxis"),h(o[1],"yaxis"),h(o[2],"zaxis"),u.data.intensity*this.data._normMax,u.data.divergence],u.textLabel=this.data.hovertext||this.data.text,!0}},r.update=function(u){this.data=u;var f=i(this.scene,u);this.mesh.update(f)},r.dispose=function(){this.scene.glplot.remove(this.mesh),this.mesh.dispose()},ee.exports=function(u,f){var c=u.glplot.gl,h=i(u,f),p=v(c,h),o=new a(u,f.uid);return o.mesh=p,o.data=f,p._trace=o,u.glplot.add(p),o}},{"../../../stackgl_modules":1133,"../../components/colorscale":379,"../../lib":515,"../../lib/gl_format_color":511,"../../plots/gl3d/zip3":618}],1056:[function(y,ee,Q){"use strict";var g=y("../../lib"),v=y("../../components/colorscale/defaults"),m=y("./attributes");ee.exports=function(x,e,n,t){function a(c,h){return g.coerce(x,e,m,c,h)}var r=a("u"),d=a("v"),s=a("w"),i=a("x"),u=a("y"),f=a("z");r&&r.length&&d&&d.length&&s&&s.length&&i&&i.length&&u&&u.length&&f&&f.length?(a("starts.x"),a("starts.y"),a("starts.z"),a("maxdisplayed"),a("sizeref"),a("lighting.ambient"),a("lighting.diffuse"),a("lighting.specular"),a("lighting.roughness"),a("lighting.fresnel"),a("lightposition.x"),a("lightposition.y"),a("lightposition.z"),v(x,e,t,a,{prefix:"",cLetter:"c"}),a("text"),a("hovertext"),a("hovertemplate"),a("uhoverformat"),a("vhoverformat"),a("whoverformat"),a("xhoverformat"),a("yhoverformat"),a("zhoverformat"),e._length=null):e.visible=!1}},{"../../components/colorscale/defaults":377,"../../lib":515,"./attributes":1053}],1057:[function(y,ee,Q){"use strict";ee.exports={moduleType:"trace",name:"streamtube",basePlotModule:y("../../plots/gl3d"),categories:["gl3d","showLegend"],attributes:y("./attributes"),supplyDefaults:y("./defaults"),colorbar:{min:"cmin",max:"cmax"},calc:y("./calc").calc,plot:y("./convert"),eventData:function(g,v){return g.tubex=g.x,g.tubey=g.y,g.tubez=g.z,g.tubeu=v.traceCoordinate[3],g.tubev=v.traceCoordinate[4],g.tubew=v.traceCoordinate[5],g.norm=v.traceCoordinate[6],g.divergence=v.traceCoordinate[7],delete g.x,delete g.y,delete g.z,g},meta:{}}},{"../../plots/gl3d":607,"./attributes":1053,"./calc":1054,"./convert":1055,"./defaults":1056}],1058:[function(y,ee,Q){"use strict";var g=y("../../plots/attributes"),v=y("../../plots/template_attributes").hovertemplateAttrs,m=y("../../plots/template_attributes").texttemplateAttrs,x=y("../../components/colorscale/attributes"),e=y("../../plots/domain").attributes,n=y("../pie/attributes"),t=y("./constants"),a=y("../../lib/extend").extendFlat;ee.exports={labels:{valType:"data_array",editType:"calc"},parents:{valType:"data_array",editType:"calc"},values:{valType:"data_array",editType:"calc"},branchvalues:{valType:"enumerated",values:["remainder","total"],dflt:"remainder",editType:"calc"},count:{valType:"flaglist",flags:["branches","leaves"],dflt:"leaves",editType:"calc"},level:{valType:"any",editType:"plot",anim:!0},maxdepth:{valType:"integer",editType:"plot",dflt:-1},marker:a({colors:{valType:"data_array",editType:"calc"},line:{color:a({},n.marker.line.color,{dflt:null}),width:a({},n.marker.line.width,{dflt:1}),editType:"calc"},editType:"calc"},x("marker",{colorAttr:"colors",anim:!1})),leaf:{opacity:{valType:"number",editType:"style",min:0,max:1},editType:"plot"},text:n.text,textinfo:{valType:"flaglist",flags:["label","text","value","current path","percent root","percent entry","percent parent"],extras:["none"],editType:"plot"},texttemplate:m({editType:"plot"},{keys:t.eventDataKeys.concat(["label","value"])}),hovertext:n.hovertext,hoverinfo:a({},g.hoverinfo,{flags:["label","text","value","name","current path","percent root","percent entry","percent parent"],dflt:"label+text+value+name"}),hovertemplate:v({},{keys:t.eventDataKeys}),textfont:n.textfont,insidetextorientation:n.insidetextorientation,insidetextfont:n.insidetextfont,outsidetextfont:a({},n.outsidetextfont,{}),rotation:{valType:"angle",dflt:0,editType:"plot"},sort:n.sort,root:{color:{valType:"color",editType:"calc",dflt:"rgba(0,0,0,0)"},editType:"calc"},domain:e({name:"sunburst",trace:!0,editType:"calc"})}},{"../../components/colorscale/attributes":374,"../../lib/extend":505,"../../plots/attributes":562,"../../plots/domain":593,"../../plots/template_attributes":642,"../pie/attributes":910,"./constants":1061}],1059:[function(y,ee,Q){"use strict";var g=y("../../plots/plots");Q.name="sunburst",Q.plot=function(v,m,x,e){g.plotBasePlot(Q.name,v,m,x,e)},Q.clean=function(v,m,x,e){g.cleanBasePlot(Q.name,v,m,x,e)}},{"../../plots/plots":628}],1060:[function(y,ee,Q){"use strict";var g=y("d3-hierarchy"),v=y("fast-isnumeric"),m=y("../../lib"),x=y("../../components/colorscale").makeColorScaleFuncFromTrace,e=y("../pie/calc").makePullColorFn,n=y("../pie/calc").generateExtendedColors,t=y("../../components/colorscale").calc,a=y("../../constants/numerical").ALMOST_EQUAL,r={},d={},s={};Q.calc=function(i,u){var f,c,h,p,o,b,l=i._fullLayout,T=u.ids,_=m.isArrayOrTypedArray(T),w=u.labels,k=u.parents,L=u.values,M=m.isArrayOrTypedArray(L),I=[],P={},S={},E=function(X){return X||"number"==typeof X},z=function(X){return!M||v(L[X])&&L[X]>=0};_?(f=Math.min(T.length,k.length),c=function(X){return E(T[X])&&z(X)},h=function(X){return String(T[X])}):(f=Math.min(w.length,k.length),c=function(X){return E(w[X])&&z(X)},h=function(X){return String(w[X])}),M&&(f=Math.min(f,L.length));for(var R=0;R<f;R++)if(c(R)){var q=h(R),V=E(k[R])?String(k[R]):"",W={i:R,id:q,pid:V,label:E(w[R])?String(w[R]):""};M&&(W.v=+L[R]),I.push(W),o=q,P[p=V]?P[p].push(o):P[p]=[o],S[o]=1}if(P[""]){if(P[""].length>1){for(var K=m.randstr(),G=0;G<I.length;G++)""===I[G].pid&&(I[G].pid=K);I.unshift({hasMultipleRoots:!0,id:K,pid:"",label:""})}}else{var Y,$=[];for(Y in P)S[Y]||$.push(Y);if(1!==$.length)return m.warn(["Multiple implied roots, cannot build",u.type,"hierarchy of",u.name+".","These roots include:",$.join(", ")].join(" "));I.unshift({hasImpliedRoot:!0,id:Y=$[0],pid:"",label:Y})}try{b=g.stratify().id(function(X){return X.id}).parentId(function(X){return X.pid})(I)}catch(X){return m.warn(["Failed to build",u.type,"hierarchy of",u.name+".","Error:",X.message].join(" "))}var B=g.hierarchy(b),N=!1;if(M)switch(u.branchvalues){case"remainder":B.sum(function(X){return X.data.v});break;case"total":B.each(function(X){var re=X.data.data,ne=re.v;if(X.children){var le=X.children.reduce(function(oe,de){return oe+de.data.data.v},0);if((re.hasImpliedRoot||re.hasMultipleRoots)&&(ne=le),ne<le*a)return N=!0,m.warn(["Total value for node",X.data.data.id,"of",u.name,"is smaller than the sum of its children.","\nparent value =",ne,"\nchildren sum =",le].join(" "))}X.value=ne})}else!function X(re,ne,le){var oe=0,de=re.children;if(de){for(var se=de.length,ge=0;ge<se;ge++)oe+=X(de[ge],ne,le);le.branches&&oe++}else le.leaves&&oe++;return re.value=re.data.data.value=oe,ne._values||(ne._values=[]),ne._values[re.data.data.i]=oe,oe}(B,u,{branches:-1!==u.count.indexOf("branches"),leaves:-1!==u.count.indexOf("leaves")});if(!N){var U,te;u.sort&&B.sort(function(X,re){return re.value-X.value});var j=u.marker.colors||[];return u._hasColorscale?(!!j.length||(j=M?u.values:u._values),t(i,u,{vals:j,containerStr:"marker",cLetter:"c"}),te=x(u.marker)):U=e(l["_"+u.type+"colormap"]),B.each(function(X){var re=X.data.data;re.color=u._hasColorscale?te(j[re.i]):U(j[re.i],re.id)}),I[0].hierarchy=B,I}},Q._runCrossTraceCalc=function(i,u){var f=u._fullLayout,c=u.calcdata,h=f[i+"colorway"],p=f["_"+i+"colormap"];f["extend"+i+"colors"]&&(h=n(h,"icicle"===i?s:"treemap"===i?d:r));var o,b=0;function l(w){var k=w.data.data,L=k.id;!1===k.color&&(p[L]?k.color=p[L]:w.parent?w.parent.parent?k.color=w.parent.data.data.color:(p[L]=k.color=h[b%h.length],b++):k.color=o)}for(var T=0;T<c.length;T++){var _=c[T][0];_.trace.type===i&&_.hierarchy&&(o=_.trace.root.color,_.hierarchy.each(l))}},Q.crossTraceCalc=function(i){return Q._runCrossTraceCalc("sunburst",i)}},{"../../components/colorscale":379,"../../constants/numerical":491,"../../lib":515,"../pie/calc":912,"d3-hierarchy":115,"fast-isnumeric":190}],1061:[function(y,ee,Q){"use strict";ee.exports={CLICK_TRANSITION_TIME:750,CLICK_TRANSITION_EASING:"linear",eventDataKeys:["currentPath","root","entry","percentRoot","percentEntry","percentParent"]}},{}],1062:[function(y,ee,Q){"use strict";var g=y("../../lib"),v=y("./attributes"),m=y("../../plots/domain").defaults,x=y("../bar/defaults").handleText,e=y("../../components/colorscale"),n=e.hasColorscale,t=e.handleDefaults;ee.exports=function(a,r,d,s){function i(o,b){return g.coerce(a,r,v,o,b)}var u=i("labels"),f=i("parents");if(u&&u.length&&f&&f.length){var c=i("values");i(c&&c.length?"branchvalues":"count"),i("level"),i("maxdepth"),i("marker.line.width")&&i("marker.line.color",s.paper_bgcolor),i("marker.colors");var h=r._hasColorscale=n(a,"marker","colors")||(a.marker||{}).coloraxis;h&&t(a,r,s,i,{prefix:"marker.",cLetter:"c"}),i("leaf.opacity",h?1:.7);var p=i("text");i("texttemplate"),r.texttemplate||i("textinfo",Array.isArray(p)?"text+label":"label"),i("hovertext"),i("hovertemplate"),x(a,r,s,i,"auto",{moduleHasSelected:!1,moduleHasUnselected:!1,moduleHasConstrain:!1,moduleHasCliponaxis:!1,moduleHasTextangle:!1,moduleHasInsideanchor:!1}),i("insidetextorientation"),i("sort"),i("rotation"),i("root.color"),m(r,s,i),r._length=null}else r.visible=!1}},{"../../components/colorscale":379,"../../lib":515,"../../plots/domain":593,"../bar/defaults":661,"./attributes":1058}],1063:[function(y,ee,Q){"use strict";var g=y("@plotly/d3"),v=y("../../registry"),m=y("../../components/fx/helpers").appendArrayPointValue,x=y("../../components/fx"),e=y("../../lib"),n=y("../../lib/events"),t=y("./helpers"),a=y("../pie/helpers").formatPieValue;function r(d,s,i){for(var u=d.data.data,f={curveNumber:s.index,pointNumber:u.i,data:s._input,fullData:s},c=0;c<i.length;c++){var h=i[c];h in d&&(f[h]=d[h])}return"parentString"in d&&!t.isHierarchyRoot(d)&&(f.parent=d.parentString),m(f,s,u.i),f}ee.exports=function(d,s,i,u,f){var c=u[0],h=c.trace,p=c.hierarchy,o="sunburst"===h.type,b="treemap"===h.type||"icicle"===h.type;"_hasHoverLabel"in h||(h._hasHoverLabel=!1),"_hasHoverEvent"in h||(h._hasHoverEvent=!1),d.on("mouseover",function(l){var T=i._fullLayout;if(!i._dragging&&!1!==T.hovermode){var _,w=i._fullData[h.index],k=l.data.data,L=k.i,M=t.isHierarchyRoot(l),I=t.getParent(p,l),P=t.getValue(l),S=function(J){return e.castOption(w,L,J)},E=S("hovertemplate"),z=x.castHoverinfo(w,T,L),R=T.separators;if(E||z&&"none"!==z&&"skip"!==z){var q,V;o&&(q=c.cx+l.pxmid[0]*(1-l.rInscribed),V=c.cy+l.pxmid[1]*(1-l.rInscribed)),b&&(q=l._hoverX,V=l._hoverY);var W,K={},G=[],Y=[],$=function(J){return-1!==G.indexOf(J)};z&&(G="all"===z?w._module.attributes.hoverinfo.flags:z.split("+")),K.label=k.label,$("label")&&K.label&&Y.push(K.label),k.hasOwnProperty("v")&&(K.value=k.v,K.valueLabel=a(K.value,R),$("value")&&Y.push(K.valueLabel)),K.currentPath=l.currentPath=t.getPath(l.data),$("current path")&&!M&&Y.push(K.currentPath);var B=[],N=function(){-1===B.indexOf(W)&&(Y.push(W),B.push(W))};K.percentParent=l.percentParent=P/t.getValue(I),K.parent=l.parentString=t.getPtLabel(I),$("percent parent")&&(W=t.formatPercent(K.percentParent,R)+" of "+K.parent,N()),K.percentEntry=l.percentEntry=P/t.getValue(s),K.entry=l.entry=t.getPtLabel(s),!$("percent entry")||M||l.onPathbar||(W=t.formatPercent(K.percentEntry,R)+" of "+K.entry,N()),K.percentRoot=l.percentRoot=P/t.getValue(p),K.root=l.root=t.getPtLabel(p),$("percent root")&&!M&&(W=t.formatPercent(K.percentRoot,R)+" of "+K.root,N()),K.text=S("hovertext")||S("text"),$("text")&&e.isValidTextValue(W=K.text)&&Y.push(W),_=[r(l,w,f.eventDataKeys)];var U={trace:w,y:V,_x0:l._x0,_x1:l._x1,_y0:l._y0,_y1:l._y1,text:Y.join("<br>"),name:E||$("name")?w.name:void 0,color:S("hoverlabel.bgcolor")||k.color,borderColor:S("hoverlabel.bordercolor"),fontFamily:S("hoverlabel.font.family"),fontSize:S("hoverlabel.font.size"),fontColor:S("hoverlabel.font.color"),nameLength:S("hoverlabel.namelength"),textAlign:S("hoverlabel.align"),hovertemplate:E,hovertemplateLabels:K,eventData:_};o&&(U.x0=q-l.rInscribed*l.rpx1,U.x1=q+l.rInscribed*l.rpx1,U.idealAlign=l.pxmid[0]<0?"left":"right"),b&&(U.x=q,U.idealAlign=q<0?"left":"right");var te=[];x.loneHover(U,{container:T._hoverlayer.node(),outerContainer:T._paper.node(),gd:i,inOut_bbox:te}),_[0].bbox=te[0],h._hasHoverLabel=!0}if(b){var j=d.select("path.surface");f.styleOne(j,l,w,{hovered:!0})}h._hasHoverEvent=!0,i.emit("plotly_hover",{points:_||[r(l,w,f.eventDataKeys)],event:g.event})}}),d.on("mouseout",function(l){var T=i._fullLayout,_=i._fullData[h.index],w=g.select(this).datum();if(h._hasHoverEvent&&(l.originalEvent=g.event,i.emit("plotly_unhover",{points:[r(w,_,f.eventDataKeys)],event:g.event}),h._hasHoverEvent=!1),h._hasHoverLabel&&(x.loneUnhover(T._hoverlayer.node()),h._hasHoverLabel=!1),b){var k=d.select("path.surface");f.styleOne(k,w,_,{hovered:!1})}}),d.on("click",function(l){var T=i._fullLayout,_=i._fullData[h.index],w=o&&(t.isHierarchyRoot(l)||t.isLeaf(l)),k=t.getPtId(l),L=t.isEntry(l)?t.findEntryWithChild(p,k):t.findEntryWithLevel(p,k),M=t.getPtId(L),I={points:[r(l,_,f.eventDataKeys)],event:g.event};w||(I.nextLevel=M);var P=n.triggerHandler(i,"plotly_"+h.type+"click",I);if(!1!==P&&T.hovermode&&(i._hoverdata=[r(l,_,f.eventDataKeys)],x.click(i,g.event)),!w&&!1!==P&&!i._dragging&&!i._transitioning){v.call("_storeDirectGUIEdit",_,T._tracePreGUI[_.uid],{level:_.level});var S={data:[{level:M}],traces:[h.index]},E={frame:{redraw:!1,duration:f.transitionTime},transition:{duration:f.transitionTime,easing:f.transitionEasing},mode:"immediate",fromcurrent:!0};x.loneUnhover(T._hoverlayer.node()),v.call("animate",i,S,E)}})}},{"../../components/fx":407,"../../components/fx/helpers":403,"../../lib":515,"../../lib/events":504,"../../registry":647,"../pie/helpers":915,"./helpers":1064,"@plotly/d3":58}],1064:[function(y,ee,Q){"use strict";var g=y("../../lib"),v=y("../../components/color"),m=y("../../lib/setcursor"),x=y("../pie/helpers");function e(n){return n.data.data.pid}Q.findEntryWithLevel=function(n,t){var a;return t&&n.eachAfter(function(r){if(Q.getPtId(r)===t)return a=r.copy()}),a||n},Q.findEntryWithChild=function(n,t){var a;return n.eachAfter(function(r){for(var d=r.children||[],s=0;s<d.length;s++)if(Q.getPtId(d[s])===t)return a=r.copy()}),a||n},Q.isEntry=function(n){return!n.parent},Q.isLeaf=function(n){return!n.children},Q.getPtId=function(n){return n.data.data.id},Q.getPtLabel=function(n){return n.data.data.label},Q.getValue=function(n){return n.value},Q.isHierarchyRoot=function(n){return""===e(n)},Q.setSliceCursor=function(n,t,a){var r=a.isTransitioning;if(!r){var d=n.datum();r=a.hideOnRoot&&Q.isHierarchyRoot(d)||a.hideOnLeaves&&Q.isLeaf(d)}m(n,r?null:"pointer")},Q.getInsideTextFontKey=function(n,t,a,r,d){var i=a.data.data.i;return g.castOption(t,i,((d||{}).onPathbar?"pathbar.textfont":"insidetextfont")+"."+n)||g.castOption(t,i,"textfont."+n)||r.size},Q.getOutsideTextFontKey=function(n,t,a,r){var d=a.data.data.i;return g.castOption(t,d,"outsidetextfont."+n)||g.castOption(t,d,"textfont."+n)||r.size},Q.isOutsideText=function(n,t){return!n._hasColorscale&&Q.isHierarchyRoot(t)},Q.determineTextFont=function(n,t,a,r){return Q.isOutsideText(n,t)?{color:Q.getOutsideTextFontKey("color",d=n,s=t,i=a),family:Q.getOutsideTextFontKey("family",d,s,i),size:Q.getOutsideTextFontKey("size",d,s,i)}:function(d,s,i,u){var c=s.data.data,h=c.i,p=g.castOption(d,h,((u||{}).onPathbar?"pathbar.textfont":"insidetextfont")+".color");return!p&&d._input.textfont&&(p=g.castOption(d._input,h,"textfont.color")),{color:p||v.contrast(c.color),family:Q.getInsideTextFontKey("family",d,s,i,u),size:Q.getInsideTextFontKey("size",d,s,i,u)}}(n,t,a,r);var d,s,i},Q.hasTransition=function(n){return!!(n&&n.duration>0)},Q.getMaxDepth=function(n){return n.maxdepth>=0?n.maxdepth:1/0},Q.isHeader=function(n,t){return!(Q.isLeaf(n)||n.depth===t._maxDepth-1)},Q.getParent=function(n,t){return Q.findEntryWithLevel(n,e(t))},Q.listPath=function(n,t){var a=n.parent;if(!a)return[];var r=t?[a.data[t]]:[a];return Q.listPath(a,t).concat(r)},Q.getPath=function(n){return Q.listPath(n,"label").join("/")+"/"},Q.formatValue=x.formatPieValue,Q.formatPercent=function(n,t){var a=g.formatPercent(n,0);return"0%"===a&&(a=x.formatPiePercent(n,t)),a}},{"../../components/color":367,"../../lib":515,"../../lib/setcursor":536,"../pie/helpers":915}],1065:[function(y,ee,Q){"use strict";ee.exports={moduleType:"trace",name:"sunburst",basePlotModule:y("./base_plot"),categories:[],animatable:!0,attributes:y("./attributes"),layoutAttributes:y("./layout_attributes"),supplyDefaults:y("./defaults"),supplyLayoutDefaults:y("./layout_defaults"),calc:y("./calc").calc,crossTraceCalc:y("./calc").crossTraceCalc,plot:y("./plot").plot,style:y("./style").style,colorbar:y("../scatter/marker_colorbar"),meta:{}}},{"../scatter/marker_colorbar":954,"./attributes":1058,"./base_plot":1059,"./calc":1060,"./defaults":1062,"./layout_attributes":1066,"./layout_defaults":1067,"./plot":1068,"./style":1069}],1066:[function(y,ee,Q){"use strict";ee.exports={sunburstcolorway:{valType:"colorlist",editType:"calc"},extendsunburstcolors:{valType:"boolean",dflt:!0,editType:"calc"}}},{}],1067:[function(y,ee,Q){"use strict";var g=y("../../lib"),v=y("./layout_attributes");ee.exports=function(m,x){function e(n,t){return g.coerce(m,x,v,n,t)}e("sunburstcolorway",x.colorway),e("extendsunburstcolors")}},{"../../lib":515,"./layout_attributes":1066}],1068:[function(y,ee,Q){"use strict";var g=y("@plotly/d3"),v=y("d3-hierarchy"),m=y("d3-interpolate").interpolate,x=y("../../components/drawing"),e=y("../../lib"),n=y("../../lib/svg_text_utils"),t=y("../bar/uniform_text"),a=t.recordMinTextSize,r=t.clearMinTextSize,d=y("../pie/plot"),s=y("../pie/helpers").getRotationAngle,i=d.computeTransform,u=d.transformInsideText,f=y("./style").styleOne,c=y("../bar/style").resizeText,h=y("./fx"),p=y("./constants"),o=y("./helpers");function b(T,_,w,k){var L=T._fullLayout,M=!L.uniformtext.mode&&o.hasTransition(k),I=g.select(w).selectAll("g.slice"),P=_[0],S=P.trace,z=o.findEntryWithLevel(P.hierarchy,S.level),R=o.getMaxDepth(S),q=L._size,V=S.domain,K=q.h*(V.y[1]-V.y[0]),G=.5*Math.min(q.w*(V.x[1]-V.x[0]),K),Y=P.cx=q.l+q.w*(V.x[1]+V.x[0])/2,$=P.cy=q.t+q.h*(1-V.y[0])-K/2;if(!z)return I.remove();var B=null,N={};M&&I.each(function(Oe){N[o.getPtId(Oe)]={rpx0:Oe.rpx0,rpx1:Oe.rpx1,x0:Oe.x0,x1:Oe.x1,transform:Oe.transform},!B&&o.isEntry(Oe)&&(B=Oe)});var Oe,U=(Oe=z,v.partition().size([2*Math.PI,Oe.height+1])(Oe)).descendants(),te=z.height+1,j=0,J=R;P.hasMultipleRoots&&o.isHierarchyRoot(z)&&(U=U.slice(1),te-=1,j=1,J+=1),U=U.filter(function(Oe){return Oe.y1<=J});var X=s(S.rotation);X&&U.forEach(function(Oe){Oe.x0+=X,Oe.x1+=X});var re=Math.min(te,R),ne=function(Oe){return(Oe-j)/re*G},le=function(Oe,fe){return[Oe*Math.cos(fe),-Oe*Math.sin(fe)]},oe=function(Oe){return e.pathAnnulus(Oe.rpx0,Oe.rpx1,Oe.x0,Oe.x1,Y,$)},de=function(Oe){return Y+l(Oe)[0]*(Oe.transform.rCenter||0)+(Oe.transform.x||0)},se=function(Oe){return $+l(Oe)[1]*(Oe.transform.rCenter||0)+(Oe.transform.y||0)};(I=I.data(U,o.getPtId)).enter().append("g").classed("slice",!0),M?I.exit().transition().each(function(){var Oe=g.select(this);Oe.select("path.surface").transition().attrTween("d",function(fe){var ve=function(Ae){var ke,Pe=o.getPtId(Ae),Ne=N[Pe],De=N[o.getPtId(z)];if(De){var ze=(Ae.x1>De.x1?2*Math.PI:0)+X;ke=Ae.rpx1<De.rpx1?{x0:Ae.x0,x1:Ae.x1,rpx0:0,rpx1:0}:{x0:ze,x1:ze,rpx0:Ae.rpx0,rpx1:Ae.rpx1}}else{var Me,Se=o.getPtId(Ae.parent);I.each(function(nt){if(o.getPtId(nt)===Se)return Me=nt});var Ie,Fe=Me.children;Fe.forEach(function(nt,ct){if(o.getPtId(nt)===Pe)return Ie=ct});var Re=Fe.length,Xe=m(Me.x0,Me.x1);ke={rpx0:G,rpx1:G,x0:Xe(Ie/Re),x1:Xe((Ie+1)/Re)}}return m(Ne,ke)}(fe);return function(Ae){return oe(ve(Ae))}}),Oe.select("g.slicetext").attr("opacity",0)}).remove():I.exit().remove(),I.order();var ge=null;if(M&&B){var _e=o.getPtId(B);I.each(function(Oe){null===ge&&o.getPtId(Oe)===_e&&(ge=Oe.x1)})}var Te=I;function we(Oe){var fe=Oe.parent,ve=N[o.getPtId(fe)],Ae={};if(ve){var ke=fe.children,Pe=ke.indexOf(Oe),Ne=ke.length,De=m(ve.x0,ve.x1);Ae.x0=De(Pe/Ne),Ae.x1=De(Pe/Ne)}else Ae.x0=Ae.x1=0;return Ae}M&&(Te=Te.transition().each("end",function(){var Oe=g.select(this);o.setSliceCursor(Oe,T,{hideOnRoot:!0,hideOnLeaves:!0,isTransitioning:!1})})),Te.each(function(Oe){var ze,fe=g.select(this),ve=e.ensureSingle(fe,"path","surface",function(ze){ze.style("pointer-events","all")});Oe.rpx0=ne(Oe.y0),Oe.rpx1=ne(Oe.y1),Oe.xmid=(Oe.x0+Oe.x1)/2,Oe.pxmid=le(Oe.rpx1,Oe.xmid),Oe.midangle=-(Oe.xmid-Math.PI/2),Oe.startangle=-(Oe.x0-Math.PI/2),Oe.stopangle=-(Oe.x1-Math.PI/2),Oe.halfangle=.5*Math.min(e.angleDelta(Oe.x0,Oe.x1)||Math.PI,Math.PI),Oe.ring=1-Oe.rpx0/Oe.rpx1,Oe.rInscribed=0===(ze=Oe).rpx0&&e.isFullCircle([ze.x0,ze.x1])?1:Math.max(0,Math.min(1/(1+1/Math.sin(ze.halfangle)),ze.ring/2)),M?ve.transition().attrTween("d",function(ze){var Me=function(Se){var Ie,Fe=N[o.getPtId(Se)],Re={x0:Se.x0,x1:Se.x1,rpx0:Se.rpx0,rpx1:Se.rpx1};if(Fe)Ie=Fe;else if(B)if(Se.parent)if(ge){var Xe=(Se.x1>ge?2*Math.PI:0)+X;Ie={x0:Xe,x1:Xe}}else e.extendFlat(Ie={rpx0:G,rpx1:G},we(Se));else Ie={rpx0:0,rpx1:0};else Ie={x0:X,x1:X};return m(Ie,Re)}(ze);return function(Se){return oe(Me(Se))}}):ve.attr("d",oe),fe.call(h,z,T,_,{eventDataKeys:p.eventDataKeys,transitionTime:p.CLICK_TRANSITION_TIME,transitionEasing:p.CLICK_TRANSITION_EASING}).call(o.setSliceCursor,T,{hideOnRoot:!0,hideOnLeaves:!0,isTransitioning:T._transitioning}),ve.call(f,Oe,S);var Ae=e.ensureSingle(fe,"g","slicetext"),ke=e.ensureSingle(Ae,"text","",function(ze){ze.attr("data-notex",1)}),Pe=e.ensureUniformFontSize(T,o.determineTextFont(S,Oe,L.font));ke.text(Q.formatSliceLabel(Oe,z,S,_,L)).classed("slicetext",!0).attr("text-anchor","middle").call(x.font,Pe).call(n.convertToTspans,T);var Ne=x.bBox(ke.node());Oe.transform=u(Ne,Oe,P),Oe.transform.targetX=de(Oe),Oe.transform.targetY=se(Oe);var De=function(ze,Me){var Se=ze.transform;return i(Se,Me),Se.fontSize=Pe.size,a(S.type,Se,L),e.getTextTransform(Se)};M?ke.transition().attrTween("transform",function(ze){var Me=function(Se){var Ie,Fe=N[o.getPtId(Se)],Re=Se.transform;if(Fe)Ie=Fe;else if(Ie={rpx1:Se.rpx1,transform:{textPosAngle:Re.textPosAngle,scale:0,rotate:Re.rotate,rCenter:Re.rCenter,x:Re.x,y:Re.y}},B)if(Se.parent)if(ge){var Xe=Se.x1>ge?2*Math.PI:0;Ie.x0=Ie.x1=Xe}else e.extendFlat(Ie,we(Se));else Ie.x0=Ie.x1=X;else Ie.x0=Ie.x1=X;var nt=m(Ie.transform.textPosAngle,Se.transform.textPosAngle),ct=m(Ie.rpx1,Se.rpx1),xt=m(Ie.x0,Se.x0),dt=m(Ie.x1,Se.x1),tt=m(Ie.transform.scale,Re.scale),Ke=m(Ie.transform.rotate,Re.rotate),mt=0===Re.rCenter?3:0===Ie.transform.rCenter?1/3:1,Bt=m(Ie.transform.rCenter,Re.rCenter);return function(Ut){var er=ct(Ut),Wt=xt(Ut),rr=dt(Ut),Ht=Bt(Math.pow(Ut,mt)),Ve={pxmid:le(er,(Wt+rr)/2),rpx1:er,transform:{textPosAngle:nt(Ut),rCenter:Ht,x:Re.x,y:Re.y}};return a(S.type,Re,L),{transform:{targetX:de(Ve),targetY:se(Ve),scale:tt(Ut),rotate:Ke(Ut),rCenter:Ht}}}}(ze);return function(Se){return De(Me(Se),Ne)}}):ke.attr("transform",De(Oe,Ne))})}function l(T){return w=T.transform.textPosAngle,[(_=T.rpx1)*Math.sin(w),-_*Math.cos(w)];var _,w}Q.plot=function(T,_,w,k){var L,M,I=T._fullLayout,P=I._sunburstlayer,S=!w,E=!I.uniformtext.mode&&o.hasTransition(w);r("sunburst",I),(L=P.selectAll("g.trace.sunburst").data(_,function(z){return z[0].trace.uid})).enter().append("g").classed("trace",!0).classed("sunburst",!0).attr("stroke-linejoin","round"),L.order(),E?(k&&(M=k()),g.transition().duration(w.duration).ease(w.easing).each("end",function(){M&&M()}).each("interrupt",function(){M&&M()}).each(function(){P.selectAll("g.trace").each(function(z){b(T,z,this,w)})})):(L.each(function(z){b(T,z,this,w)}),I.uniformtext.mode&&c(T,I._sunburstlayer.selectAll(".trace"),"sunburst")),S&&L.exit().remove()},Q.formatSliceLabel=function(T,_,w,k,L){var M=w.texttemplate,I=w.textinfo;if(!(M||I&&"none"!==I))return"";var P=L.separators,E=T.data.data,z=k[0].hierarchy,R=o.isHierarchyRoot(T),q=o.getParent(z,T),V=o.getValue(T);if(!M){var W,K=I.split("+"),G=function(X){return-1!==K.indexOf(X)},Y=[];if(G("label")&&E.label&&Y.push(E.label),E.hasOwnProperty("v")&&G("value")&&Y.push(o.formatValue(E.v,P)),!R){G("current path")&&Y.push(o.getPath(T.data));var $=0;G("percent parent")&&$++,G("percent entry")&&$++,G("percent root")&&$++;var B=$>1;if($){var N,U=function(X){W=o.formatPercent(N,P),B&&(W+=" of "+X),Y.push(W)};G("percent parent")&&!R&&(N=V/o.getValue(q),U("parent")),G("percent entry")&&(N=V/o.getValue(_),U("entry")),G("percent root")&&(N=V/o.getValue(z),U("root"))}}return G("text")&&(W=e.castOption(w,E.i,"text"),e.isValidTextValue(W)&&Y.push(W)),Y.join("<br>")}var te=e.castOption(w,E.i,"texttemplate");if(!te)return"";var j={};E.label&&(j.label=E.label),E.hasOwnProperty("v")&&(j.value=E.v,j.valueLabel=o.formatValue(E.v,P)),j.currentPath=o.getPath(T.data),R||(j.percentParent=V/o.getValue(q),j.percentParentLabel=o.formatPercent(j.percentParent,P),j.parent=o.getPtLabel(q)),j.percentEntry=V/o.getValue(_),j.percentEntryLabel=o.formatPercent(j.percentEntry,P),j.entry=o.getPtLabel(_),j.percentRoot=V/o.getValue(z),j.percentRootLabel=o.formatPercent(j.percentRoot,P),j.root=o.getPtLabel(z),E.hasOwnProperty("color")&&(j.color=E.color);var J=e.castOption(w,E.i,"text");return(e.isValidTextValue(J)||""===J)&&(j.text=J),j.customdata=e.castOption(w,E.i,"customdata"),e.texttemplateString(te,j,L._d3locale,j,w._meta||{})}},{"../../components/drawing":389,"../../lib":515,"../../lib/svg_text_utils":541,"../bar/style":671,"../bar/uniform_text":673,"../pie/helpers":915,"../pie/plot":919,"./constants":1061,"./fx":1063,"./helpers":1064,"./style":1069,"@plotly/d3":58,"d3-hierarchy":115,"d3-interpolate":116}],1069:[function(y,ee,Q){"use strict";var g=y("@plotly/d3"),v=y("../../components/color"),m=y("../../lib"),x=y("../bar/uniform_text").resizeText;function e(n,t,a){var r=t.data.data,d=!t.children,s=r.i,i=m.castOption(a,s,"marker.line.color")||v.defaultLine,u=m.castOption(a,s,"marker.line.width")||0;n.style("stroke-width",u).call(v.fill,r.color).call(v.stroke,i).style("opacity",d?a.leaf.opacity:null)}ee.exports={style:function(n){var t=n._fullLayout._sunburstlayer.selectAll(".trace");x(n,t,"sunburst"),t.each(function(a){var r=g.select(this),d=a[0].trace;r.style("opacity",d.opacity),r.selectAll("path.surface").each(function(s){g.select(this).call(e,s,d)})})},styleOne:e}},{"../../components/color":367,"../../lib":515,"../bar/uniform_text":673,"@plotly/d3":58}],1070:[function(y,ee,Q){"use strict";var g=y("../../components/color"),v=y("../../components/colorscale/attributes"),m=y("../../plots/cartesian/axis_format_attributes").axisHoverFormat,x=y("../../plots/template_attributes").hovertemplateAttrs,e=y("../../plots/attributes"),n=y("../../lib/extend").extendFlat,t=y("../../plot_api/edit_types").overrideAll;function a(d){return{show:{valType:"boolean",dflt:!1},start:{valType:"number",dflt:null,editType:"plot"},end:{valType:"number",dflt:null,editType:"plot"},size:{valType:"number",dflt:null,min:0,editType:"plot"},project:{x:{valType:"boolean",dflt:!1},y:{valType:"boolean",dflt:!1},z:{valType:"boolean",dflt:!1}},color:{valType:"color",dflt:g.defaultLine},usecolormap:{valType:"boolean",dflt:!1},width:{valType:"number",min:1,max:16,dflt:2},highlight:{valType:"boolean",dflt:!0},highlightcolor:{valType:"color",dflt:g.defaultLine},highlightwidth:{valType:"number",min:1,max:16,dflt:2}}}var r=ee.exports=t(n({z:{valType:"data_array"},x:{valType:"data_array"},y:{valType:"data_array"},text:{valType:"string",dflt:"",arrayOk:!0},hovertext:{valType:"string",dflt:"",arrayOk:!0},hovertemplate:x(),xhoverformat:m("x"),yhoverformat:m("y"),zhoverformat:m("z"),connectgaps:{valType:"boolean",dflt:!1,editType:"calc"},surfacecolor:{valType:"data_array"}},v("",{colorAttr:"z or surfacecolor",showScaleDflt:!0,autoColorDflt:!1,editTypeOverride:"calc"}),{contours:{x:a(),y:a(),z:a()},hidesurface:{valType:"boolean",dflt:!1},lightposition:{x:{valType:"number",min:-1e5,max:1e5,dflt:10},y:{valType:"number",min:-1e5,max:1e5,dflt:1e4},z:{valType:"number",min:-1e5,max:1e5,dflt:0}},lighting:{ambient:{valType:"number",min:0,max:1,dflt:.8},diffuse:{valType:"number",min:0,max:1,dflt:.8},specular:{valType:"number",min:0,max:2,dflt:.05},roughness:{valType:"number",min:0,max:1,dflt:.5},fresnel:{valType:"number",min:0,max:5,dflt:.2}},opacity:{valType:"number",min:0,max:1,dflt:1},opacityscale:{valType:"any",editType:"calc"},_deprecated:{zauto:n({},v.zauto,{}),zmin:n({},v.zmin,{}),zmax:n({},v.zmax,{})},hoverinfo:n({},e.hoverinfo),showlegend:n({},e.showlegend,{dflt:!1})}),"calc","nested");r.x.editType=r.y.editType=r.z.editType="calc+clearAxisTypes",r.transforms=void 0},{"../../components/color":367,"../../components/colorscale/attributes":374,"../../lib/extend":505,"../../plot_api/edit_types":548,"../../plots/attributes":562,"../../plots/cartesian/axis_format_attributes":569,"../../plots/template_attributes":642}],1071:[function(y,ee,Q){"use strict";var g=y("../../components/colorscale/calc");ee.exports=function(v,m){g(v,m,m.surfacecolor?{vals:m.surfacecolor,containerStr:"",cLetter:"c"}:{vals:m.z,containerStr:"",cLetter:"c"})}},{"../../components/colorscale/calc":375}],1072:[function(y,ee,Q){"use strict";var g=y("../../../stackgl_modules").gl_surface3d,v=y("../../../stackgl_modules").ndarray,m=y("../../../stackgl_modules").ndarray_linear_interpolate.d2,x=y("../heatmap/interp2d"),e=y("../heatmap/find_empties"),n=y("../../lib").isArrayOrTypedArray,t=y("../../lib/gl_format_color").parseColorScale,a=y("../../lib/str2rgbarray"),r=y("../../components/colorscale").extractOpts;function d(w,k,L){this.scene=w,this.uid=L,this.surface=k,this.data=null,this.showContour=[!1,!1,!1],this.contourStart=[null,null,null],this.contourEnd=[null,null,null],this.contourSize=[0,0,0],this.minValues=[1/0,1/0,1/0],this.maxValues=[-1/0,-1/0,-1/0],this.dataScaleX=1,this.dataScaleY=1,this.refineData=!0,this.objectOffset=[0,0,0]}var s=d.prototype;s.getXat=function(w,k,L,M){var I=n(this.data.x)?n(this.data.x[0])?this.data.x[k][w]:this.data.x[w]:w;return void 0===L?I:M.d2l(I,0,L)},s.getYat=function(w,k,L,M){var I=n(this.data.y)?n(this.data.y[0])?this.data.y[k][w]:this.data.y[k]:k;return void 0===L?I:M.d2l(I,0,L)},s.getZat=function(w,k,L,M){var I=this.data.z[k][w];return null===I&&this.data.connectgaps&&this.data._interpolatedZ&&(I=this.data._interpolatedZ[k][w]),void 0===L?I:M.d2l(I,0,L)},s.handlePick=function(w){if(w.object===this.surface){var L=(w.data.index[1]-1)/this.dataScaleY-1,M=Math.max(Math.min(Math.round((w.data.index[0]-1)/this.dataScaleX-1),this.data.z[0].length-1),0),I=Math.max(Math.min(Math.round(L),this.data._ylength-1),0);w.index=[M,I],w.traceCoordinate=[this.getXat(M,I),this.getYat(M,I),this.getZat(M,I)],w.dataCoordinate=[this.getXat(M,I,this.data.xcalendar,this.scene.fullSceneLayout.xaxis),this.getYat(M,I,this.data.ycalendar,this.scene.fullSceneLayout.yaxis),this.getZat(M,I,this.data.zcalendar,this.scene.fullSceneLayout.zaxis)];for(var P=0;P<3;P++)null!=w.dataCoordinate[P]&&(w.dataCoordinate[P]*=this.scene.dataScale[P]);var E=this.data.hovertext||this.data.text;return w.textLabel=Array.isArray(E)&&E[I]&&void 0!==E[I][M]?E[I][M]:E||"",w.data.dataCoordinate=w.dataCoordinate.slice(),this.surface.highlight(w.data),this.scene.glplot.spikes.position=w.dataCoordinate,!0}};var i=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509,521,523,541,547,557,563,569,571,577,587,593,599,601,607,613,617,619,631,641,643,647,653,659,661,673,677,683,691,701,709,719,727,733,739,743,751,757,761,769,773,787,797,809,811,821,823,827,829,839,853,857,859,863,877,881,883,887,907,911,919,929,937,941,947,953,967,971,977,983,991,997,1009,1013,1019,1021,1031,1033,1039,1049,1051,1061,1063,1069,1087,1091,1093,1097,1103,1109,1117,1123,1129,1151,1153,1163,1171,1181,1187,1193,1201,1213,1217,1223,1229,1231,1237,1249,1259,1277,1279,1283,1289,1291,1297,1301,1303,1307,1319,1321,1327,1361,1367,1373,1381,1399,1409,1423,1427,1429,1433,1439,1447,1451,1453,1459,1471,1481,1483,1487,1489,1493,1499,1511,1523,1531,1543,1549,1553,1559,1567,1571,1579,1583,1597,1601,1607,1609,1613,1619,1621,1627,1637,1657,1663,1667,1669,1693,1697,1699,1709,1721,1723,1733,1741,1747,1753,1759,1777,1783,1787,1789,1801,1811,1823,1831,1847,1861,1867,1871,1873,1877,1879,1889,1901,1907,1913,1931,1933,1949,1951,1973,1979,1987,1993,1997,1999,2003,2011,2017,2027,2029,2039,2053,2063,2069,2081,2083,2087,2089,2099,2111,2113,2129,2131,2137,2141,2143,2153,2161,2179,2203,2207,2213,2221,2237,2239,2243,2251,2267,2269,2273,2281,2287,2293,2297,2309,2311,2333,2339,2341,2347,2351,2357,2371,2377,2381,2383,2389,2393,2399,2411,2417,2423,2437,2441,2447,2459,2467,2473,2477,2503,2521,2531,2539,2543,2549,2551,2557,2579,2591,2593,2609,2617,2621,2633,2647,2657,2659,2663,2671,2677,2683,2687,2689,2693,2699,2707,2711,2713,2719,2729,2731,2741,2749,2753,2767,2777,2789,2791,2797,2801,2803,2819,2833,2837,2843,2851,2857,2861,2879,2887,2897,2903,2909,2917,2927,2939,2953,2957,2963,2969,2971,2999];function u(w,k){if(w<k)return 0;for(var L=0;0===Math.floor(w%k);)w/=k,L++;return L}function f(w){for(var k=[],L=0;L<i.length;L++)k.push(u(w,i[L]));return k}function c(w){for(var k=f(w),L=w,M=0;M<i.length;M++)if(k[M]>0){L=i[M];break}return L}function h(w,k){if(!(w<1||k<1)){for(var L=f(w),M=f(k),I=1,P=0;P<i.length;P++)I*=Math.pow(i[P],Math.max(L[P],M[P]));return I}}s.calcXnums=function(w){var k,L=[];for(k=1;k<w;k++){var M=this.getXat(k-1,0),I=this.getXat(k,0);L[k-1]=I!==M&&null!=M&&null!=I?Math.abs(I-M):0}var P=0;for(k=1;k<w;k++)P+=L[k-1];for(k=1;k<w;k++)L[k-1]=0===L[k-1]?1:Math.round(P/L[k-1]);return L},s.calcYnums=function(w){var k,L=[];for(k=1;k<w;k++){var M=this.getYat(0,k-1),I=this.getYat(0,k);L[k-1]=I!==M&&null!=M&&null!=I?Math.abs(I-M):0}var P=0;for(k=1;k<w;k++)P+=L[k-1];for(k=1;k<w;k++)L[k-1]=0===L[k-1]?1:Math.round(P/L[k-1]);return L};var p=[1,2,4,6,12,24,36,48,60,120,180,240,360,720,840,1260],o=p[9],b=p[13];function l(w,k,L){var M=L[8]+L[2]*k[0]+L[5]*k[1];return w[0]=(L[6]+L[0]*k[0]+L[3]*k[1])/M,w[1]=(L[7]+L[1]*k[0]+L[4]*k[1])/M,w}function T(w,k,L){return function(M,I,P,S){for(var E=[0,0],z=M.shape[0],R=M.shape[1],q=0;q<z;q++)for(var V=0;V<R;V++)P(E,[q,V],S),M.set(q,V,m(I,E[0],E[1]))}(w,k,l,L),w}function _(w,k){for(var L=!1,M=0;M<w.length;M++)if(k===w[M]){L=!0;break}!1===L&&w.push(k)}s.estimateScale=function(w,k){for(var L=1+function(I){if(0!==I.length){for(var P=1,S=0;S<I.length;S++)P=h(P,I[S]);return P}}(0===k?this.calcXnums(w):this.calcYnums(w));L<o;)L*=2;for(;L>b;)L--,L/=c(L),++L<o&&(L=b);var M=Math.round(L/w);return M>1?M:1},s.refineCoords=function(w){for(var k=this.dataScaleX,L=this.dataScaleY,M=w[0].shape[0],I=w[0].shape[1],P=0|Math.floor(w[0].shape[0]*k+1),S=0|Math.floor(w[0].shape[1]*L+1),E=1+M+1,z=1+I+1,R=v(new Float32Array(E*z),[E,z]),q=[1/k,0,0,0,1/L,0,0,0,1],V=0;V<w.length;++V){this.surface.padField(R,w[V]);var W=v(new Float32Array(P*S),[P,S]);T(W,R,q),w[V]=W}},s.setContourLevels=function(){var w,k,M=[[],[],[]],I=[!1,!1,!1],P=!1;for(w=0;w<3;++w)if(this.showContour[w]&&(P=!0,this.contourSize[w]>0&&null!==this.contourStart[w]&&null!==this.contourEnd[w]&&this.contourEnd[w]>this.contourStart[w]))for(I[w]=!0,k=this.contourStart[w];k<this.contourEnd[w];k+=this.contourSize[w])_(M[w],k*this.scene.dataScale[w]);if(P){var S=[[],[],[]];for(w=0;w<3;++w)this.showContour[w]&&(S[w]=I[w]?M[w]:this.scene.contourLevels[w]);this.surface.update({levels:S})}},s.update=function(w){var k,L,M,I,P=this.scene,S=P.fullSceneLayout,E=this.surface,z=t(w),R=P.dataScale,q=w.z[0].length,V=w._ylength,W=P.contourLevels;this.data=w;var K=[];for(k=0;k<3;k++)for(K[k]=[],L=0;L<q;L++)K[k][L]=[];for(L=0;L<q;L++)for(M=0;M<V;M++)K[0][L][M]=this.getXat(L,M,w.xcalendar,S.xaxis),K[1][L][M]=this.getYat(L,M,w.ycalendar,S.yaxis),K[2][L][M]=this.getZat(L,M,w.zcalendar,S.zaxis);if(w.connectgaps)for(w._emptypoints=e(K[2]),x(K[2],w._emptypoints),w._interpolatedZ=[],L=0;L<q;L++)for(w._interpolatedZ[L]=[],M=0;M<V;M++)w._interpolatedZ[L][M]=K[2][L][M];for(k=0;k<3;k++)for(L=0;L<q;L++)for(M=0;M<V;M++)null==(I=K[k][L][M])?K[k][L][M]=NaN:I=K[k][L][M]*=R[k];for(k=0;k<3;k++)for(L=0;L<q;L++)for(M=0;M<V;M++)null!=(I=K[k][L][M])&&(this.minValues[k]>I&&(this.minValues[k]=I),this.maxValues[k]<I&&(this.maxValues[k]=I));for(k=0;k<3;k++)this.objectOffset[k]=.5*(this.minValues[k]+this.maxValues[k]);for(k=0;k<3;k++)for(L=0;L<q;L++)for(M=0;M<V;M++)null!=(I=K[k][L][M])&&(K[k][L][M]-=this.objectOffset[k]);var G=[v(new Float32Array(q*V),[q,V]),v(new Float32Array(q*V),[q,V]),v(new Float32Array(q*V),[q,V])];for(k=0;k<3;k++)for(L=0;L<q;L++)for(M=0;M<V;M++)G[k].set(L,M,K[k][L][M]);K=[];var Y={colormap:z,levels:[[],[],[]],showContour:[!0,!0,!0],showSurface:!w.hidesurface,contourProject:[[!1,!1,!1],[!1,!1,!1],[!1,!1,!1]],contourWidth:[1,1,1],contourColor:[[1,1,1,1],[1,1,1,1],[1,1,1,1]],contourTint:[1,1,1],dynamicColor:[[1,1,1,1],[1,1,1,1],[1,1,1,1]],dynamicWidth:[1,1,1],dynamicTint:[1,1,1],opacityscale:w.opacityscale,opacity:w.opacity},$=r(w);if(Y.intensityBounds=[$.min,$.max],w.surfacecolor){var B=v(new Float32Array(q*V),[q,V]);for(L=0;L<q;L++)for(M=0;M<V;M++)B.set(L,M,w.surfacecolor[M][L]);G.push(B)}else Y.intensityBounds[0]*=R[2],Y.intensityBounds[1]*=R[2];(b<G[0].shape[0]||b<G[0].shape[1])&&(this.refineData=!1),!0===this.refineData&&(this.dataScaleX=this.estimateScale(G[0].shape[0],0),this.dataScaleY=this.estimateScale(G[0].shape[1],1),1===this.dataScaleX&&1===this.dataScaleY||this.refineCoords(G)),w.surfacecolor&&(Y.intensity=G.pop());var j,J,X,N=[!0,!0,!0],U=["x","y","z"];for(k=0;k<3;++k){var te=w.contours[U[k]];N[k]=te.highlight,Y.showContour[k]=te.show||te.highlight,Y.showContour[k]&&(Y.contourProject[k]=[te.project.x,te.project.y,te.project.z],te.show?(this.showContour[k]=!0,Y.levels[k]=W[k],E.highlightColor[k]=Y.contourColor[k]=a(te.color),E.highlightTint[k]=Y.contourTint[k]=te.usecolormap?0:1,Y.contourWidth[k]=te.width,this.contourStart[k]=te.start,this.contourEnd[k]=te.end,this.contourSize[k]=te.size):(this.showContour[k]=!1,this.contourStart[k]=null,this.contourEnd[k]=null,this.contourSize[k]=0),te.highlight&&(Y.dynamicColor[k]=a(te.highlightcolor),Y.dynamicWidth[k]=te.highlightwidth))}(J=(j=z)[0].rgb)[0]===(X=j[j.length-1].rgb)[0]&&J[1]===X[1]&&J[2]===X[2]&&J[3]===X[3]&&(Y.vertexColor=!0),Y.objectOffset=this.objectOffset,Y.coords=G,E.update(Y),E.visible=w.visible,E.enableDynamic=N,E.enableHighlight=N,E.snapToData=!0,"lighting"in w&&(E.ambientLight=w.lighting.ambient,E.diffuseLight=w.lighting.diffuse,E.specularLight=w.lighting.specular,E.roughness=w.lighting.roughness,E.fresnel=w.lighting.fresnel),"lightposition"in w&&(E.lightPosition=[w.lightposition.x,w.lightposition.y,w.lightposition.z])},s.dispose=function(){this.scene.glplot.remove(this.surface),this.surface.dispose()},ee.exports=function(w,k){var M=g({gl:w.glplot.gl}),I=new d(w,M,k.uid);return M._trace=I,I.update(k),w.glplot.add(M),I}},{"../../../stackgl_modules":1133,"../../components/colorscale":379,"../../lib":515,"../../lib/gl_format_color":511,"../../lib/str2rgbarray":540,"../heatmap/find_empties":807,"../heatmap/interp2d":810}],1073:[function(y,ee,Q){"use strict";var g=y("../../registry"),v=y("../../lib"),m=y("../../components/colorscale/defaults"),x=y("./attributes");function e(t,a,r,d){var s=d("opacityscale");"max"===s?a.opacityscale=[[0,.1],[1,1]]:"min"===s?a.opacityscale=[[0,1],[1,.1]]:"extremes"===s?a.opacityscale=function(i,u){for(var f=[],c=0;c<32;c++){var h=c/31,p=.1+.9*(1-Math.pow(Math.sin(1*h*Math.PI),2));f.push([h,Math.max(0,Math.min(1,p))])}return f}():function(i){var u=0;if(!Array.isArray(i)||i.length<2||!i[0]||!i[i.length-1]||0!=+i[0][0]||1!=+i[i.length-1][0])return!1;for(var f=0;f<i.length;f++){var c=i[f];if(2!==c.length||+c[0]<u)return!1;u=+c[0]}return!0}(s)||(a.opacityscale=void 0)}function n(t,a,r){a in t&&!(r in t)&&(t[r]=t[a])}ee.exports={supplyDefaults:function(t,a,r,d){var s,i;function u(_,w){return v.coerce(t,a,x,_,w)}var f=u("x"),c=u("y"),h=u("z");if(!h||!h.length||f&&f.length<1||c&&c.length<1)a.visible=!1;else{a._xlength=Array.isArray(f)&&v.isArrayOrTypedArray(f[0])?h.length:h[0].length,a._ylength=h.length,g.getComponentMethod("calendars","handleTraceDefaults")(t,a,["x","y","z"],d),u("text"),u("hovertext"),u("hovertemplate"),u("xhoverformat"),u("yhoverformat"),u("zhoverformat"),["lighting.ambient","lighting.diffuse","lighting.specular","lighting.roughness","lighting.fresnel","lightposition.x","lightposition.y","lightposition.z","hidesurface","connectgaps","opacity"].forEach(function(_){u(_)});var p=u("surfacecolor"),o=["x","y","z"];for(s=0;s<3;++s){var b="contours."+o[s],l=u(b+".show"),T=u(b+".highlight");if(l||T)for(i=0;i<3;++i)u(b+".project."+o[i]);l&&(u(b+".color"),u(b+".width"),u(b+".usecolormap")),T&&(u(b+".highlightcolor"),u(b+".highlightwidth")),u(b+".start"),u(b+".end"),u(b+".size")}p||(n(t,"zmin","cmin"),n(t,"zmax","cmax"),n(t,"zauto","cauto")),m(t,a,d,u,{prefix:"",cLetter:"c"}),e(0,a,0,u),a._length=null}},opacityscaleDefaults:e}},{"../../components/colorscale/defaults":377,"../../lib":515,"../../registry":647,"./attributes":1070}],1074:[function(y,ee,Q){"use strict";ee.exports={attributes:y("./attributes"),supplyDefaults:y("./defaults").supplyDefaults,colorbar:{min:"cmin",max:"cmax"},calc:y("./calc"),plot:y("./convert"),moduleType:"trace",name:"surface",basePlotModule:y("../../plots/gl3d"),categories:["gl3d","2dMap","showLegend"],meta:{}}},{"../../plots/gl3d":607,"./attributes":1070,"./calc":1071,"./convert":1072,"./defaults":1073}],1075:[function(y,ee,Q){"use strict";var g=y("../../components/annotations/attributes"),v=y("../../lib/extend").extendFlat,m=y("../../plot_api/edit_types").overrideAll,x=y("../../plots/font_attributes"),e=y("../../plots/domain").attributes,n=y("../../plots/cartesian/axis_format_attributes").descriptionOnlyNumbers;(ee.exports=m({domain:e({name:"table",trace:!0}),columnwidth:{valType:"number",arrayOk:!0,dflt:null},columnorder:{valType:"data_array"},header:{values:{valType:"data_array",dflt:[]},format:{valType:"data_array",dflt:[],description:n("cell value")},prefix:{valType:"string",arrayOk:!0,dflt:null},suffix:{valType:"string",arrayOk:!0,dflt:null},height:{valType:"number",dflt:28},align:v({},g.align,{arrayOk:!0}),line:{width:{valType:"number",arrayOk:!0,dflt:1},color:{valType:"color",arrayOk:!0,dflt:"grey"}},fill:{color:{valType:"color",arrayOk:!0,dflt:"white"}},font:v({},x({arrayOk:!0}))},cells:{values:{valType:"data_array",dflt:[]},format:{valType:"data_array",dflt:[],description:n("cell value")},prefix:{valType:"string",arrayOk:!0,dflt:null},suffix:{valType:"string",arrayOk:!0,dflt:null},height:{valType:"number",dflt:20},align:v({},g.align,{arrayOk:!0}),line:{width:{valType:"number",arrayOk:!0,dflt:1},color:{valType:"color",arrayOk:!0,dflt:"grey"}},fill:{color:{valType:"color",arrayOk:!0,dflt:"white"}},font:v({},x({arrayOk:!0}))}},"calc","from-root")).transforms=void 0},{"../../components/annotations/attributes":350,"../../lib/extend":505,"../../plot_api/edit_types":548,"../../plots/cartesian/axis_format_attributes":569,"../../plots/domain":593,"../../plots/font_attributes":594}],1076:[function(y,ee,Q){"use strict";var g=y("../../plots/get_data").getModuleCalcData,v=y("./plot");Q.name="table",Q.plot=function(m){var x=g(m.calcdata,"table")[0];x.length&&v(m,x)},Q.clean=function(m,x,e,n){var t=n._has&&n._has("table"),a=x._has&&x._has("table");t&&!a&&n._paperdiv.selectAll(".table").remove()}},{"../../plots/get_data":602,"./plot":1083}],1077:[function(y,ee,Q){"use strict";var g=y("../../lib/gup").wrap;ee.exports=function(){return g({})}},{"../../lib/gup":512}],1078:[function(y,ee,Q){"use strict";ee.exports={cellPad:8,columnExtentOffset:10,columnTitleOffset:28,emptyHeaderHeight:16,latexCheck:/^\$.*\$$/,goldenRatio:1.618,lineBreaker:"<br>",maxDimensionCount:60,overdrag:45,releaseTransitionDuration:120,releaseTransitionEase:"cubic-out",scrollbarCaptureWidth:18,scrollbarHideDelay:1e3,scrollbarHideDuration:1e3,scrollbarOffset:5,scrollbarWidth:8,transitionDuration:100,transitionEase:"cubic-out",uplift:5,wrapSpacer:" ",wrapSplitCharacter:" ",cn:{table:"table",tableControlView:"table-control-view",scrollBackground:"scroll-background",yColumn:"y-column",columnBlock:"column-block",scrollAreaClip:"scroll-area-clip",scrollAreaClipRect:"scroll-area-clip-rect",columnBoundary:"column-boundary",columnBoundaryClippath:"column-boundary-clippath",columnBoundaryRect:"column-boundary-rect",columnCells:"column-cells",columnCell:"column-cell",cellRect:"cell-rect",cellText:"cell-text",cellTextHolder:"cell-text-holder",scrollbarKit:"scrollbar-kit",scrollbar:"scrollbar",scrollbarSlider:"scrollbar-slider",scrollbarGlyph:"scrollbar-glyph",scrollbarCaptureZone:"scrollbar-capture-zone"}}},{}],1079:[function(y,ee,Q){"use strict";var g=y("./constants"),v=y("../../lib/extend").extendFlat,m=y("fast-isnumeric");function x(s){if(Array.isArray(s)){for(var i=0,u=0;u<s.length;u++)i=Math.max(i,x(s[u]));return i}return s}function e(s,i){return s+i}function n(s){var i,u=s.slice(),f=1/0,c=0;for(i=0;i<u.length;i++)Array.isArray(u[i])||(u[i]=[u[i]]),f=Math.min(f,u[i].length),c=Math.max(c,u[i].length);if(f!==c)for(i=0;i<u.length;i++){var h=c-u[i].length;h&&(u[i]=u[i].concat(t(h)))}return u}function t(s){for(var i=new Array(s),u=0;u<s;u++)i[u]="";return i}function a(s){return s.calcdata.columns.reduce(function(i,u){return u.xIndex<s.xIndex?i+u.columnWidth:i},0)}function r(s,i){return Object.keys(s).map(function(u){return v({},s[u],{auxiliaryBlocks:i})})}function d(s,i){for(var u,f={},c=0,h=0,p={firstRowIndex:null,lastRowIndex:null,rows:[]},o=0,b=0,l=0;l<s.length;l++)p.rows.push({rowIndex:l,rowHeight:u=s[l]}),((h+=u)>=i||l===s.length-1)&&(f[c]=p,p.key=b++,p.firstRowIndex=o,p.lastRowIndex=l,p={firstRowIndex:null,lastRowIndex:null,rows:[]},c+=h,o=l+1,h=0);return f}ee.exports=function(s,i){var u=n(i.cells.values),f=function(R){return R.slice(i.header.values.length,R.length)},c=n(i.header.values);c.length&&!c[0].length&&(c[0]=[""],c=n(c));var h=c.concat(f(u).map(function(){return t((c[0]||[""]).length)})),p=i.domain,o=Math.floor(s._fullLayout._size.w*(p.x[1]-p.x[0])),b=Math.floor(s._fullLayout._size.h*(p.y[1]-p.y[0])),l=i.header.values.length?h[0].map(function(){return i.header.height}):[g.emptyHeaderHeight],T=u.length?u[0].map(function(){return i.cells.height}):[],_=l.reduce(e,0),w=d(T,b-_+g.uplift),k=r(d(l,_),[]),L=r(w,k),M={},I=i._fullInput.columnorder.concat(f(u.map(function(R,q){return q}))),P=h.map(function(R,q){var V=Array.isArray(i.columnwidth)?i.columnwidth[Math.min(q,i.columnwidth.length-1)]:i.columnwidth;return m(V)?Number(V):1}),S=P.reduce(e,0);P=P.map(function(R){return R/S*o});var E=Math.max(x(i.header.line.width),x(i.cells.line.width)),z={key:i.uid+s._context.staticPlot,translateX:p.x[0]*s._fullLayout._size.w,translateY:s._fullLayout._size.h*(1-p.y[1]),size:s._fullLayout._size,width:o,maxLineWidth:E,height:b,columnOrder:I,groupHeight:b,rowBlocks:L,headerRowBlocks:k,scrollY:0,cells:v({},i.cells,{values:u}),headerCells:v({},i.header,{values:h}),gdColumns:h.map(function(R){return R[0]}),gdColumnsOriginalOrder:h.map(function(R){return R[0]}),prevPages:[0,0],scrollbarState:{scrollbarScrollInProgress:!1},columns:h.map(function(R,q){return M[R]=(M[R]||0)+1,{key:R+"__"+M[R],label:R,specIndex:q,xIndex:I[q],xScale:a,x:void 0,calcdata:void 0,columnWidth:P[q]}})};return z.columns.forEach(function(R){R.calcdata=z,R.x=a(R)}),z}},{"../../lib/extend":505,"./constants":1078,"fast-isnumeric":190}],1080:[function(y,ee,Q){"use strict";var g=y("../../lib/extend").extendFlat;Q.splitToPanels=function(v){var m=[0,0],x=g({},v,{key:"header",type:"header",page:0,prevPages:m,currentRepaint:[null,null],dragHandle:!0,values:v.calcdata.headerCells.values[v.specIndex],rowBlocks:v.calcdata.headerRowBlocks,calcdata:g({},v.calcdata,{cells:v.calcdata.headerCells})});return[g({},v,{key:"cells1",type:"cells",page:0,prevPages:m,currentRepaint:[null,null],dragHandle:!1,values:v.calcdata.cells.values[v.specIndex],rowBlocks:v.calcdata.rowBlocks}),g({},v,{key:"cells2",type:"cells",page:1,prevPages:m,currentRepaint:[null,null],dragHandle:!1,values:v.calcdata.cells.values[v.specIndex],rowBlocks:v.calcdata.rowBlocks}),x]},Q.splitToCells=function(v){var x,e,n,m=[n=(e=(x=v).rowBlocks[x.page])?e.rows[0].rowIndex:0,e?n+e.rows.length:0];return(v.values||[]).slice(m[0],m[1]).map(function(x,e){return{keyWithinBlock:e+("string"==typeof x&&x.match(/[<$&> ]/)?"_keybuster_"+Math.random():""),key:m[0]+e,column:v,calcdata:v.calcdata,page:v.page,rowBlocks:v.rowBlocks,value:x}})}},{"../../lib/extend":505}],1081:[function(y,ee,Q){"use strict";var g=y("../../lib"),v=y("./attributes"),m=y("../../plots/domain").defaults;ee.exports=function(x,e,n,t){function a(r,d){return g.coerce(x,e,v,r,d)}m(e,t,a),a("columnwidth"),a("header.values"),a("header.format"),a("header.align"),a("header.prefix"),a("header.suffix"),a("header.height"),a("header.line.width"),a("header.line.color"),a("header.fill.color"),g.coerceFont(a,"header.font",g.extendFlat({},t.font)),function(r,d){for(var i=r.header.values.length,u=(r.columnorder||[]).slice(0,i),f=u.slice().sort(function(p,o){return p-o}),c=u.map(function(p){return f.indexOf(p)}),h=c.length;h<i;h++)c.push(h);d("columnorder",c)}(e,a),a("cells.values"),a("cells.format"),a("cells.align"),a("cells.prefix"),a("cells.suffix"),a("cells.height"),a("cells.line.width"),a("cells.line.color"),a("cells.fill.color"),g.coerceFont(a,"cells.font",g.extendFlat({},t.font)),e._length=null}},{"../../lib":515,"../../plots/domain":593,"./attributes":1075}],1082:[function(y,ee,Q){"use strict";ee.exports={attributes:y("./attributes"),supplyDefaults:y("./defaults"),calc:y("./calc"),plot:y("./plot"),moduleType:"trace",name:"table",basePlotModule:y("./base_plot"),categories:["noOpacity"],meta:{}}},{"./attributes":1075,"./base_plot":1076,"./calc":1077,"./defaults":1081,"./plot":1083}],1083:[function(y,ee,Q){"use strict";var g=y("./constants"),v=y("@plotly/d3"),m=y("../../lib").numberFormat,x=y("../../lib/gup"),e=y("../../components/drawing"),n=y("../../lib/svg_text_utils"),t=y("../../lib").raiseToTop,a=y("../../lib").strTranslate,r=y("../../lib").cancelTransition,d=y("./data_preparation_helper"),s=y("./data_split_helpers"),i=y("../../components/color");function u(G){return Math.ceil(G.calcdata.maxLineWidth/2)}function f(G,Y){return"clip"+G._fullLayout._uid+"_scrollAreaBottomClip_"+Y.key}function c(G,Y){return"clip"+G._fullLayout._uid+"_columnBoundaryClippath_"+Y.calcdata.key+"_"+Y.specIndex}function h(G){return[].concat.apply([],G.map(function(Y){return Y})).map(function(Y){return Y.__data__})}function p(G,Y,$){var B=G.selectAll("."+g.cn.scrollbarKit).data(x.repeat,x.keyFun);B.enter().append("g").classed(g.cn.scrollbarKit,!0).style("shape-rendering","geometricPrecision"),B.each(function(J){var ne,X=J.scrollbarState;X.totalHeight=q(ne=J.rowBlocks,ne.length-1)+(ne.length?V(ne[ne.length-1],1/0):1),X.scrollableAreaHeight=J.groupHeight-L(J),X.currentlyVisibleHeight=Math.min(X.totalHeight,X.scrollableAreaHeight),X.ratio=X.currentlyVisibleHeight/X.totalHeight,X.barLength=Math.max(X.ratio*X.currentlyVisibleHeight,g.goldenRatio*g.scrollbarWidth),X.barWiggleRoom=X.currentlyVisibleHeight-X.barLength,X.wiggleRoom=Math.max(0,X.totalHeight-X.scrollableAreaHeight),X.topY=0===X.barWiggleRoom?0:J.scrollY/X.wiggleRoom*X.barWiggleRoom,X.bottomY=X.topY+X.barLength,X.dragMultiplier=X.wiggleRoom/X.barWiggleRoom}).attr("transform",function(J){return a(J.width+g.scrollbarWidth/2+g.scrollbarOffset,L(J))});var N=B.selectAll("."+g.cn.scrollbar).data(x.repeat,x.keyFun);N.enter().append("g").classed(g.cn.scrollbar,!0);var U=N.selectAll("."+g.cn.scrollbarSlider).data(x.repeat,x.keyFun);U.enter().append("g").classed(g.cn.scrollbarSlider,!0),U.attr("transform",function(J){return a(0,J.scrollbarState.topY||0)});var te=U.selectAll("."+g.cn.scrollbarGlyph).data(x.repeat,x.keyFun);te.enter().append("line").classed(g.cn.scrollbarGlyph,!0).attr("stroke","black").attr("stroke-width",g.scrollbarWidth).attr("stroke-linecap","round").attr("y1",g.scrollbarWidth/2),te.attr("y2",function(J){return J.scrollbarState.barLength-g.scrollbarWidth/2}).attr("stroke-opacity",function(J){return J.columnDragInProgress||!J.scrollbarState.barWiggleRoom||$?0:.4}),te.transition().delay(0).duration(0),te.transition().delay(g.scrollbarHideDelay).duration(g.scrollbarHideDuration).attr("stroke-opacity",0);var j=N.selectAll("."+g.cn.scrollbarCaptureZone).data(x.repeat,x.keyFun);j.enter().append("line").classed(g.cn.scrollbarCaptureZone,!0).attr("stroke","white").attr("stroke-opacity",.01).attr("stroke-width",g.scrollbarCaptureWidth).attr("stroke-linecap","butt").attr("y1",0).on("mousedown",function(J){var X=v.event.y,re=this.getBoundingClientRect(),ne=J.scrollbarState,le=X-re.top,oe=v.scale.linear().domain([0,ne.scrollableAreaHeight]).range([0,ne.totalHeight]).clamp(!0);ne.topY<=le&&le<=ne.bottomY||I(Y,G,null,oe(le-ne.barLength/2))(J)}).call(v.behavior.drag().origin(function(J){return v.event.stopPropagation(),J.scrollbarState.scrollbarScrollInProgress=!0,J}).on("drag",I(Y,G)).on("dragend",function(){})),j.attr("y2",function(J){return J.scrollbarState.scrollableAreaHeight}),Y._context.staticPlot&&(te.remove(),j.remove())}function o(G,Y,$,B){var j,N=function(te){var j=te.selectAll("."+g.cn.columnCell).data(s.splitToCells,function(J){return J.keyWithinBlock});return j.enter().append("g").classed(g.cn.columnCell,!0),j.exit().remove(),j}(((j=$.selectAll("."+g.cn.columnCells).data(x.repeat,x.keyFun)).enter().append("g").classed(g.cn.columnCells,!0),j.exit().remove(),j));N.each(function(j,J){var X=j.calcdata.cells.font,re=j.column.specIndex,ne={size:T(X.size,re,J),color:T(X.color,re,J),family:T(X.family,re,J)};j.rowNumber=j.key,j.align=T(j.calcdata.cells.align,re,J),j.cellBorderWidth=T(j.calcdata.cells.line.width,re,J),j.font=ne}),function(te){te.attr("width",function(j){return j.column.columnWidth}).attr("stroke-width",function(j){return j.cellBorderWidth}).each(function(j){var J=v.select(this);i.stroke(J,T(j.calcdata.cells.line.color,j.column.specIndex,j.rowNumber)),i.fill(J,T(j.calcdata.cells.fill.color,j.column.specIndex,j.rowNumber))})}(function(te){var j=te.selectAll("."+g.cn.cellRect).data(x.repeat,function(J){return J.keyWithinBlock});return j.enter().append("rect").classed(g.cn.cellRect,!0),j}(N));var U=function(te){var j=te.selectAll("."+g.cn.cellText).data(x.repeat,function(J){return J.keyWithinBlock});return j.enter().append("text").classed(g.cn.cellText,!0).style("cursor",function(){return"auto"}).on("mousedown",function(){v.event.stopPropagation()}),j}(function(te){var j=te.selectAll("."+g.cn.cellTextHolder).data(x.repeat,function(J){return J.keyWithinBlock});return j.enter().append("g").classed(g.cn.cellTextHolder,!0).style("shape-rendering","geometricPrecision"),j}(N));(function(te){te.each(function(j){e.font(v.select(this),j.font)})})(U),b(U,Y,B,G),R(N)}function b(G,Y,$,B){G.text(function(N){var U=N.column.specIndex,te=N.rowNumber,j=N.value,J="string"==typeof j,X=J&&j.match(/<br>/i),re=!J||X;N.mayHaveMarkup=J&&j.match(/[<&>]/);var ne,le="string"==typeof(ne=j)&&ne.match(g.latexCheck);N.latex=le;var oe,de,se=le?"":T(N.calcdata.cells.prefix,U,te)||"",ge=le?"":T(N.calcdata.cells.suffix,U,te)||"",_e=le?null:T(N.calcdata.cells.format,U,te)||null,Te=se+(_e?m(_e)(N.value):N.value)+ge;if(N.wrappingNeeded=!N.wrapped&&!re&&!le&&(oe=l(Te)),N.cellHeightMayIncrease=X||le||N.mayHaveMarkup||(void 0===oe?l(Te):oe),N.needsConvertToTspans=N.mayHaveMarkup||N.wrappingNeeded||N.latex,N.wrappingNeeded){var we=(" "===g.wrapSplitCharacter?Te.replace(/<a href=/gi,"<a_href="):Te).split(g.wrapSplitCharacter),Oe=" "===g.wrapSplitCharacter?we.map(function(fe){return fe.replace(/<a_href=/gi,"<a href=")}):we;N.fragments=Oe.map(function(fe){return{text:fe,width:null}}),N.fragments.push({fragment:g.wrapSpacer,width:null}),de=Oe.join(g.lineBreaker)+g.lineBreaker+g.wrapSpacer}else delete N.fragments,de=Te;return de}).attr("dy",function(N){return N.needsConvertToTspans?0:"0.75em"}).each(function(N){var U=v.select(this);N.needsConvertToTspans?n.convertToTspans(U,B,(N.wrappingNeeded?S:E)($,this,Y,B,N)):v.select(this.parentNode).attr("transform",function(j){return a(z(j),g.cellPad)}).attr("text-anchor",function(j){return{left:"start",center:"middle",right:"end"}[j.align]})})}function l(G){return-1!==G.indexOf(g.wrapSplitCharacter)}function T(G,Y,$){if(Array.isArray(G)){var B=G[Math.min(Y,G.length-1)];return Array.isArray(B)?B[Math.min($,B.length-1)]:B}return G}function _(G,Y,$){G.transition().ease(g.releaseTransitionEase).duration(g.releaseTransitionDuration).attr("transform",a(Y.x,$))}function w(G){return"cells"===G.type}function k(G){return"header"===G.type}function L(G){return(G.rowBlocks.length?G.rowBlocks[0].auxiliaryBlocks:[]).reduce(function(Y,$){return Y+V($,1/0)},0)}function M(G,Y,$){var B=h(Y)[0];if(void 0!==B){var N=B.rowBlocks,U=B.calcdata,te=q(N,N.length),j=B.calcdata.groupHeight-L(B),J=U.scrollY=Math.max(0,Math.min(te-j,U.scrollY)),X=function(re,ne,le){for(var oe=[],de=0,se=0;se<re.length;se++){for(var ge=re[se],_e=ge.rows,Te=0,we=0;we<_e.length;we++)Te+=_e[we].rowHeight;ge.allRowsHeight=Te,ne<de+Te&&ne+le>de&&oe.push(se),de+=Te}return oe}(N,J,j);1===X.length&&(X[0]===N.length-1?X.unshift(X[0]-1):X.push(X[0]+1)),X[0]%2&&X.reverse(),Y.each(function(re,ne){re.page=X[ne],re.scrollY=J}),Y.attr("transform",function(re){var ne=q(re.rowBlocks,re.page)-re.scrollY;return a(0,ne)}),G&&(P(G,$,Y,X,B.prevPages,B,0),P(G,$,Y,X,B.prevPages,B,1),p($,G))}}function I(G,Y,$,B){return function(N){var U=N.calcdata?N.calcdata:N,te=Y.filter(function(re){return U.key===re.key}),J=U.scrollY;U.scrollY=void 0===B?U.scrollY+($||U.scrollbarState.dragMultiplier)*v.event.dy:B;var X=te.selectAll("."+g.cn.yColumn).selectAll("."+g.cn.columnBlock).filter(w);return M(G,X,te),U.scrollY===J}}function P(G,Y,$,B,N,U,te){B[te]!==N[te]&&(clearTimeout(U.currentRepaint[te]),U.currentRepaint[te]=setTimeout(function(){var j=$.filter(function(J,X){return X===te&&B[X]!==N[X]});o(G,Y,j,$),N[te]=B[te]}))}function S(G,Y,$,B){return function(){var N=v.select(Y.parentNode);N.each(function(U){var te=U.fragments;N.selectAll("tspan.line").each(function(de,se){te[se].width=this.getComputedTextLength()});var j,J,X=te[te.length-1].width,re=te.slice(0,-1),ne=[],le=0,oe=U.column.columnWidth-2*g.cellPad;for(U.value="";re.length;)le+(J=(j=re.shift()).width+X)>oe&&(U.value+=ne.join(g.wrapSpacer)+g.lineBreaker,ne=[],le=0),ne.push(j.text),le+=J;le&&(U.value+=ne.join(g.wrapSpacer)),U.wrapped=!0}),N.selectAll("tspan.line").remove(),b(N.select("."+g.cn.cellText),$,G,B),v.select(Y.parentNode.parentNode).call(R)}}function E(G,Y,$,B,N){return function(){if(!N.settledY){var U=v.select(Y.parentNode),te=K(N),j=N.key-te.firstRowIndex,J=te.rows[j].rowHeight,X=N.cellHeightMayIncrease?Y.parentNode.getBoundingClientRect().height+2*g.cellPad:J,re=Math.max(X,J);re-te.rows[j].rowHeight&&(te.rows[j].rowHeight=re,G.selectAll("."+g.cn.columnCell).call(R),M(null,G.filter(w),0),p($,B,!0)),U.attr("transform",function(){var ne=this.parentNode.getBoundingClientRect(),le=v.select(this.parentNode).select("."+g.cn.cellRect).node().getBoundingClientRect(),oe=this.transform.baseVal.consolidate(),de=le.top-ne.top+(oe?oe.matrix.f:g.cellPad);return a(z(N,v.select(this.parentNode).select("."+g.cn.cellTextHolder).node().getBoundingClientRect().width),de)}),N.settledY=!0}}}function z(G,Y){switch(G.align){case"left":default:return g.cellPad;case"right":return G.column.columnWidth-(Y||0)-g.cellPad;case"center":return(G.column.columnWidth-(Y||0))/2}}function R(G){G.attr("transform",function(Y){var $=Y.rowBlocks[0].auxiliaryBlocks.reduce(function(N,U){return N+V(U,1/0)},0),B=V(K(Y),Y.key);return a(0,B+$)}).selectAll("."+g.cn.cellRect).attr("height",function(Y){return($=K(Y),B=Y.key,$.rows[B-$.firstRowIndex]).rowHeight;var $,B})}function q(G,Y){for(var $=0,B=Y-1;B>=0;B--)$+=W(G[B]);return $}function V(G,Y){for(var $=0,B=0;B<G.rows.length&&G.rows[B].rowIndex<Y;B++)$+=G.rows[B].rowHeight;return $}function W(G){var Y=G.allRowsHeight;if(void 0!==Y)return Y;for(var $=0,B=0;B<G.rows.length;B++)$+=G.rows[B].rowHeight;return G.allRowsHeight=$,$}function K(G){return G.rowBlocks[G.page]}ee.exports=function(G,Y){var $=!G._context.staticPlot,B=G._fullLayout._paper.selectAll("."+g.cn.table).data(Y.map(function(ge){var _e=x.unwrap(ge).trace;return d(G,_e)}),x.keyFun);B.exit().remove(),B.enter().append("g").classed(g.cn.table,!0).attr("overflow","visible").style("box-sizing","content-box").style("position","absolute").style("left",0).style("overflow","visible").style("shape-rendering","crispEdges").style("pointer-events","all"),B.attr("width",function(ge){return ge.width+ge.size.l+ge.size.r}).attr("height",function(ge){return ge.height+ge.size.t+ge.size.b}).attr("transform",function(ge){return a(ge.translateX,ge.translateY)});var N=B.selectAll("."+g.cn.tableControlView).data(x.repeat,x.keyFun),U=N.enter().append("g").classed(g.cn.tableControlView,!0).style("box-sizing","content-box");if($){var te="onwheel"in document?"wheel":"mousewheel";U.on("mousemove",function(ge){N.filter(function(_e){return ge===_e}).call(p,G)}).on(te,function(ge){ge.scrollbarState.wheeling||(ge.scrollbarState.wheeling=!0,I(G,N,null,ge.scrollY+v.event.deltaY)(ge)||(v.event.stopPropagation(),v.event.preventDefault()),ge.scrollbarState.wheeling=!1)}).call(p,G,!0)}N.attr("transform",function(ge){return a(ge.size.l,ge.size.t)});var j=N.selectAll("."+g.cn.scrollBackground).data(x.repeat,x.keyFun);j.enter().append("rect").classed(g.cn.scrollBackground,!0).attr("fill","none"),j.attr("width",function(ge){return ge.width}).attr("height",function(ge){return ge.height}),N.each(function(ge){e.setClipUrl(v.select(this),f(G,ge),G)});var J=N.selectAll("."+g.cn.yColumn).data(function(ge){return ge.columns},x.keyFun);J.enter().append("g").classed(g.cn.yColumn,!0),J.exit().remove(),J.attr("transform",function(ge){return a(ge.x,0)}),$&&J.call(v.behavior.drag().origin(function(ge){return _(v.select(this),ge,-g.uplift),t(this),ge.calcdata.columnDragInProgress=!0,p(N.filter(function(_e){return ge.calcdata.key===_e.key}),G),ge}).on("drag",function(ge){var _e=v.select(this),Te=function(we){return(ge===we?v.event.x:we.x)+we.columnWidth/2};ge.x=Math.max(-g.overdrag,Math.min(ge.calcdata.width+g.overdrag-ge.columnWidth,v.event.x)),h(J).filter(function(we){return we.calcdata.key===ge.calcdata.key}).sort(function(we,Oe){return Te(we)-Te(Oe)}).forEach(function(we,Oe){we.xIndex=Oe,we.x=ge===we?we.x:we.xScale(we)}),J.filter(function(we){return ge!==we}).transition().ease(g.transitionEase).duration(g.transitionDuration).attr("transform",function(we){return a(we.x,0)}),_e.call(r).attr("transform",a(ge.x,-g.uplift))}).on("dragend",function(ge){var we,Oe,fe,ve,_e=v.select(this),Te=ge.calcdata;ge.x=ge.xScale(ge),ge.calcdata.columnDragInProgress=!1,_(_e,ge,0),we=G,Oe=Te,fe=Te.columns.map(function(we){return we.xIndex}),ve=Oe.gdColumnsOriginalOrder,Oe.gdColumns.sort(function(Ae,ke){return fe[ve.indexOf(Ae)]-fe[ve.indexOf(ke)]}),Oe.columnorder=fe,we.emit("plotly_restyle")})),J.each(function(ge){e.setClipUrl(v.select(this),c(G,ge),G)});var X=J.selectAll("."+g.cn.columnBlock).data(s.splitToPanels,x.keyFun);X.enter().append("g").classed(g.cn.columnBlock,!0).attr("id",function(ge){return ge.key}),X.style("cursor",function(ge){return ge.dragHandle?"ew-resize":ge.calcdata.scrollbarState.barWiggleRoom?"ns-resize":"default"});var re=X.filter(k),ne=X.filter(w);$&&ne.call(v.behavior.drag().origin(function(ge){return v.event.stopPropagation(),ge}).on("drag",I(G,N,-1)).on("dragend",function(){})),o(G,N,re,X),o(G,N,ne,X);var le=N.selectAll("."+g.cn.scrollAreaClip).data(x.repeat,x.keyFun);le.enter().append("clipPath").classed(g.cn.scrollAreaClip,!0).attr("id",function(ge){return f(G,ge)});var oe=le.selectAll("."+g.cn.scrollAreaClipRect).data(x.repeat,x.keyFun);oe.enter().append("rect").classed(g.cn.scrollAreaClipRect,!0).attr("x",-g.overdrag).attr("y",-g.uplift).attr("fill","none"),oe.attr("width",function(ge){return ge.width+2*g.overdrag}).attr("height",function(ge){return ge.height+g.uplift}),J.selectAll("."+g.cn.columnBoundary).data(x.repeat,x.keyFun).enter().append("g").classed(g.cn.columnBoundary,!0);var de=J.selectAll("."+g.cn.columnBoundaryClippath).data(x.repeat,x.keyFun);de.enter().append("clipPath").classed(g.cn.columnBoundaryClippath,!0),de.attr("id",function(ge){return c(G,ge)});var se=de.selectAll("."+g.cn.columnBoundaryRect).data(x.repeat,x.keyFun);se.enter().append("rect").classed(g.cn.columnBoundaryRect,!0).attr("fill","none"),se.attr("width",function(ge){return ge.columnWidth+2*u(ge)}).attr("height",function(ge){return ge.calcdata.height+2*u(ge)+g.uplift}).attr("x",function(ge){return-u(ge)}).attr("y",function(ge){return-u(ge)}),M(null,ne,N)}},{"../../components/color":367,"../../components/drawing":389,"../../lib":515,"../../lib/gup":512,"../../lib/svg_text_utils":541,"./constants":1078,"./data_preparation_helper":1079,"./data_split_helpers":1080,"@plotly/d3":58}],1084:[function(y,ee,Q){"use strict";var g=y("../../plots/template_attributes").hovertemplateAttrs,v=y("../../plots/template_attributes").texttemplateAttrs,m=y("../../components/colorscale/attributes"),x=y("../../plots/domain").attributes,e=y("../pie/attributes"),n=y("../sunburst/attributes"),t=y("./constants"),a=y("../../lib/extend").extendFlat;ee.exports={labels:n.labels,parents:n.parents,values:n.values,branchvalues:n.branchvalues,count:n.count,level:n.level,maxdepth:n.maxdepth,tiling:{packing:{valType:"enumerated",values:["squarify","binary","dice","slice","slice-dice","dice-slice"],dflt:"squarify",editType:"plot"},squarifyratio:{valType:"number",min:1,dflt:1,editType:"plot"},flip:{valType:"flaglist",flags:["x","y"],dflt:"",editType:"plot"},pad:{valType:"number",min:0,dflt:3,editType:"plot"},editType:"calc"},marker:a({pad:{t:{valType:"number",min:0,editType:"plot"},l:{valType:"number",min:0,editType:"plot"},r:{valType:"number",min:0,editType:"plot"},b:{valType:"number",min:0,editType:"plot"},editType:"calc"},colors:n.marker.colors,depthfade:{valType:"enumerated",values:[!0,!1,"reversed"],editType:"style"},line:n.marker.line,editType:"calc"},m("marker",{colorAttr:"colors",anim:!1})),pathbar:{visible:{valType:"boolean",dflt:!0,editType:"plot"},side:{valType:"enumerated",values:["top","bottom"],dflt:"top",editType:"plot"},edgeshape:{valType:"enumerated",values:[">","<","|","/","\\"],dflt:">",editType:"plot"},thickness:{valType:"number",min:12,editType:"plot"},textfont:a({},e.textfont,{}),editType:"calc"},text:e.text,textinfo:n.textinfo,texttemplate:v({editType:"plot"},{keys:t.eventDataKeys.concat(["label","value"])}),hovertext:e.hovertext,hoverinfo:n.hoverinfo,hovertemplate:g({},{keys:t.eventDataKeys}),textfont:e.textfont,insidetextfont:e.insidetextfont,outsidetextfont:a({},e.outsidetextfont,{}),textposition:{valType:"enumerated",values:["top left","top center","top right","middle left","middle center","middle right","bottom left","bottom center","bottom right"],dflt:"top left",editType:"plot"},sort:e.sort,root:n.root,domain:x({name:"treemap",trace:!0,editType:"calc"})}},{"../../components/colorscale/attributes":374,"../../lib/extend":505,"../../plots/domain":593,"../../plots/template_attributes":642,"../pie/attributes":910,"../sunburst/attributes":1058,"./constants":1087}],1085:[function(y,ee,Q){"use strict";var g=y("../../plots/plots");Q.name="treemap",Q.plot=function(v,m,x,e){g.plotBasePlot(Q.name,v,m,x,e)},Q.clean=function(v,m,x,e){g.cleanBasePlot(Q.name,v,m,x,e)}},{"../../plots/plots":628}],1086:[function(y,ee,Q){"use strict";var g=y("../sunburst/calc");Q.calc=function(v,m){return g.calc(v,m)},Q.crossTraceCalc=function(v){return g._runCrossTraceCalc("treemap",v)}},{"../sunburst/calc":1060}],1087:[function(y,ee,Q){"use strict";ee.exports={CLICK_TRANSITION_TIME:750,CLICK_TRANSITION_EASING:"poly",eventDataKeys:["currentPath","root","entry","percentRoot","percentEntry","percentParent"],gapWithPathbar:1}},{}],1088:[function(y,ee,Q){"use strict";var g=y("../../lib"),v=y("./attributes"),m=y("../../components/color"),x=y("../../plots/domain").defaults,e=y("../bar/defaults").handleText,n=y("../bar/constants").TEXTPAD,t=y("../../components/colorscale"),a=t.hasColorscale,r=t.handleDefaults;ee.exports=function(d,s,i,u){function f(w,k){return g.coerce(d,s,v,w,k)}var c=f("labels"),h=f("parents");if(c&&c.length&&h&&h.length){var p=f("values");f(p&&p.length?"branchvalues":"count"),f("level"),f("maxdepth"),"squarify"===f("tiling.packing")&&f("tiling.squarifyratio"),f("tiling.flip"),f("tiling.pad");var o=f("text");f("texttemplate"),s.texttemplate||f("textinfo",Array.isArray(o)?"text+label":"label"),f("hovertext"),f("hovertemplate");var b=f("pathbar.visible");e(d,s,u,f,"auto",{hasPathbar:b,moduleHasSelected:!1,moduleHasUnselected:!1,moduleHasConstrain:!1,moduleHasCliponaxis:!1,moduleHasTextangle:!1,moduleHasInsideanchor:!1}),f("textposition");var l=-1!==s.textposition.indexOf("bottom");f("marker.line.width")&&f("marker.line.color",u.paper_bgcolor);var T=f("marker.colors");(s._hasColorscale=a(d,"marker","colors")||(d.marker||{}).coloraxis)?r(d,s,u,f,{prefix:"marker.",cLetter:"c"}):f("marker.depthfade",!(T||[]).length);var _=2*s.textfont.size;f("marker.pad.t",l?_/4:_),f("marker.pad.l",_/4),f("marker.pad.r",_/4),f("marker.pad.b",l?_:_/4),s._hovered={marker:{line:{width:2,color:m.contrast(u.paper_bgcolor)}}},b&&(f("pathbar.thickness",s.pathbar.textfont.size+2*n),f("pathbar.side"),f("pathbar.edgeshape")),f("sort"),f("root.color"),x(s,u,f),s._length=null}else s.visible=!1}},{"../../components/color":367,"../../components/colorscale":379,"../../lib":515,"../../plots/domain":593,"../bar/constants":659,"../bar/defaults":661,"./attributes":1084}],1089:[function(y,ee,Q){"use strict";var g=y("@plotly/d3"),v=y("../sunburst/helpers"),m=y("../bar/uniform_text").clearMinTextSize,x=y("../bar/style").resizeText,e=y("./plot_one");ee.exports=function(n,t,a,r,d){var s,i,u=d.type,f=d.drawDescendants,c=n._fullLayout,h=c["_"+u+"layer"],p=!a;m(u,c),(s=h.selectAll("g.trace."+u).data(t,function(o){return o[0].trace.uid})).enter().append("g").classed("trace",!0).classed(u,!0),s.order(),!c.uniformtext.mode&&v.hasTransition(a)?(r&&(i=r()),g.transition().duration(a.duration).ease(a.easing).each("end",function(){i&&i()}).each("interrupt",function(){i&&i()}).each(function(){h.selectAll("g.trace").each(function(o){e(n,o,this,a,f)})})):(s.each(function(o){e(n,o,this,a,f)}),c.uniformtext.mode&&x(n,h.selectAll(".trace"),u)),p&&s.exit().remove()}},{"../bar/style":671,"../bar/uniform_text":673,"../sunburst/helpers":1064,"./plot_one":1098,"@plotly/d3":58}],1090:[function(y,ee,Q){"use strict";var g=y("@plotly/d3"),v=y("../../lib"),m=y("../../components/drawing"),x=y("../../lib/svg_text_utils"),e=y("./partition"),n=y("./style").styleOne,t=y("./constants"),a=y("../sunburst/helpers"),r=y("../sunburst/fx");ee.exports=function(d,s,i,u,f){var c=f.barDifY,h=f.width,p=f.height,o=f.viewX,b=f.viewY,l=f.pathSlice,T=f.toMoveInsideSlice,_=f.strTransform,w=f.hasTransition,k=f.handleSlicesExit,L=f.makeUpdateSliceInterpolator,M=f.makeUpdateTextInterpolator,I={},P=d._fullLayout,S=s[0],E=S.trace,z=S.hierarchy,R=h/E._entryDepth,q=a.listPath(i.data,"id"),V=e(z.copy(),[h,p],{packing:"dice",pad:{inner:0,top:0,left:0,right:0,bottom:0}}).descendants();(V=V.filter(function(K){var G=q.indexOf(K.data.id);return-1!==G&&(K.x0=R*G,K.x1=R*(G+1),K.y0=c,K.y1=c+p,K.onPathbar=!0,!0)})).reverse(),(u=u.data(V,a.getPtId)).enter().append("g").classed("pathbar",!0),k(u,!0,I,[h,p],l),u.order();var W=u;w&&(W=W.transition().each("end",function(){var K=g.select(this);a.setSliceCursor(K,d,{hideOnRoot:!1,hideOnLeaves:!1,isTransitioning:!1})})),W.each(function(K){K._x0=o(K.x0),K._x1=o(K.x1),K._y0=b(K.y0),K._y1=b(K.y1),K._hoverX=o(K.x1-Math.min(h,p)/2),K._hoverY=b(K.y1-p/2);var G=g.select(this),Y=v.ensureSingle(G,"path","surface",function(U){U.style("pointer-events","all")});w?Y.transition().attrTween("d",function(U){var te=L(U,!0,I,[h,p]);return function(j){return l(te(j))}}):Y.attr("d",l),G.call(r,i,d,s,{styleOne:n,eventDataKeys:t.eventDataKeys,transitionTime:t.CLICK_TRANSITION_TIME,transitionEasing:t.CLICK_TRANSITION_EASING}).call(a.setSliceCursor,d,{hideOnRoot:!1,hideOnLeaves:!1,isTransitioning:d._transitioning}),Y.call(n,K,E,{hovered:!1}),K._text=(a.getPtLabel(K)||"").split("<br>").join(" ")||"";var $=v.ensureSingle(G,"g","slicetext"),B=v.ensureSingle($,"text","",function(U){U.attr("data-notex",1)}),N=v.ensureUniformFontSize(d,a.determineTextFont(E,K,P.font,{onPathbar:!0}));B.text(K._text||" ").classed("slicetext",!0).attr("text-anchor","start").call(m.font,N).call(x.convertToTspans,d),K.textBB=m.bBox(B.node()),K.transform=T(K,{fontSize:N.size,onPathbar:!0}),K.transform.fontSize=N.size,w?B.transition().attrTween("transform",function(U){var te=M(U,!0,I,[h,p]);return function(j){return _(te(j))}}):B.attr("transform",_(K))})}},{"../../components/drawing":389,"../../lib":515,"../../lib/svg_text_utils":541,"../sunburst/fx":1063,"../sunburst/helpers":1064,"./constants":1087,"./partition":1096,"./style":1099,"@plotly/d3":58}],1091:[function(y,ee,Q){"use strict";var g=y("@plotly/d3"),v=y("../../lib"),m=y("../../components/drawing"),x=y("../../lib/svg_text_utils"),e=y("./partition"),n=y("./style").styleOne,t=y("./constants"),a=y("../sunburst/helpers"),r=y("../sunburst/fx"),d=y("../sunburst/plot").formatSliceLabel;ee.exports=function(s,i,u,f,c){var h=c.width,p=c.height,o=c.viewX,b=c.viewY,l=c.pathSlice,T=c.toMoveInsideSlice,_=c.strTransform,w=c.hasTransition,k=c.handleSlicesExit,L=c.makeUpdateSliceInterpolator,M=c.makeUpdateTextInterpolator,I=c.prevEntry,P=s._fullLayout,S=i[0].trace,E=-1!==S.textposition.indexOf("left"),z=-1!==S.textposition.indexOf("right"),R=-1!==S.textposition.indexOf("bottom"),q=!R&&!S.marker.pad.t||R&&!S.marker.pad.b,V=e(u,[h,p],{packing:S.tiling.packing,squarifyratio:S.tiling.squarifyratio,flipX:S.tiling.flip.indexOf("x")>-1,flipY:S.tiling.flip.indexOf("y")>-1,pad:{inner:S.tiling.pad,top:S.marker.pad.t,left:S.marker.pad.l,right:S.marker.pad.r,bottom:S.marker.pad.b}}).descendants(),W=1/0,K=-1/0;V.forEach(function(N){var U=N.depth;U>=S._maxDepth?(N.x0=N.x1=(N.x0+N.x1)/2,N.y0=N.y1=(N.y0+N.y1)/2):(W=Math.min(W,U),K=Math.max(K,U))}),f=f.data(V,a.getPtId),S._maxVisibleLayers=isFinite(K)?K-W+1:0,f.enter().append("g").classed("slice",!0),k(f,!1,{},[h,p],l),f.order();var G=null;if(w&&I){var Y=a.getPtId(I);f.each(function(N){null===G&&a.getPtId(N)===Y&&(G={x0:N.x0,x1:N.x1,y0:N.y0,y1:N.y1})})}var $=function(){return G||{x0:0,x1:h,y0:0,y1:p}},B=f;return w&&(B=B.transition().each("end",function(){var N=g.select(this);a.setSliceCursor(N,s,{hideOnRoot:!0,hideOnLeaves:!1,isTransitioning:!1})})),B.each(function(N){var U=a.isHeader(N,S);N._x0=o(N.x0),N._x1=o(N.x1),N._y0=b(N.y0),N._y1=b(N.y1),N._hoverX=o(N.x1-S.marker.pad.r),N._hoverY=b(R?N.y1-S.marker.pad.b/2:N.y0+S.marker.pad.t/2);var te=g.select(this),j=v.ensureSingle(te,"path","surface",function(ne){ne.style("pointer-events","all")});w?j.transition().attrTween("d",function(ne){var le=L(ne,!1,$(),[h,p]);return function(oe){return l(le(oe))}}):j.attr("d",l),te.call(r,u,s,i,{styleOne:n,eventDataKeys:t.eventDataKeys,transitionTime:t.CLICK_TRANSITION_TIME,transitionEasing:t.CLICK_TRANSITION_EASING}).call(a.setSliceCursor,s,{isTransitioning:s._transitioning}),j.call(n,N,S,{hovered:!1}),N._text=N.x0===N.x1||N.y0===N.y1?"":U?q?"":a.getPtLabel(N)||"":d(N,u,S,i,P)||"";var J=v.ensureSingle(te,"g","slicetext"),X=v.ensureSingle(J,"text","",function(ne){ne.attr("data-notex",1)}),re=v.ensureUniformFontSize(s,a.determineTextFont(S,N,P.font));X.text(N._text||" ").classed("slicetext",!0).attr("text-anchor",z?"end":E||U?"start":"middle").call(m.font,re).call(x.convertToTspans,s),N.textBB=m.bBox(X.node()),N.transform=T(N,{fontSize:re.size,isHeader:U}),N.transform.fontSize=re.size,w?X.transition().attrTween("transform",function(ne){var le=M(ne,!1,$(),[h,p]);return function(oe){return _(le(oe))}}):X.attr("transform",_(N))}),G}},{"../../components/drawing":389,"../../lib":515,"../../lib/svg_text_utils":541,"../sunburst/fx":1063,"../sunburst/helpers":1064,"../sunburst/plot":1068,"./constants":1087,"./partition":1096,"./style":1099,"@plotly/d3":58}],1092:[function(y,ee,Q){"use strict";ee.exports=function g(v,m,x){var e;x.swapXY&&(e=v.x0,v.x0=v.y0,v.y0=e,e=v.x1,v.x1=v.y1,v.y1=e),x.flipX&&(e=v.x0,v.x0=m[0]-v.x1,v.x1=m[0]-e),x.flipY&&(e=v.y0,v.y0=m[1]-v.y1,v.y1=m[1]-e);var n=v.children;if(n)for(var t=0;t<n.length;t++)g(n[t],m,x)}},{}],1093:[function(y,ee,Q){"use strict";ee.exports={moduleType:"trace",name:"treemap",basePlotModule:y("./base_plot"),categories:[],animatable:!0,attributes:y("./attributes"),layoutAttributes:y("./layout_attributes"),supplyDefaults:y("./defaults"),supplyLayoutDefaults:y("./layout_defaults"),calc:y("./calc").calc,crossTraceCalc:y("./calc").crossTraceCalc,plot:y("./plot"),style:y("./style").style,colorbar:y("../scatter/marker_colorbar"),meta:{}}},{"../scatter/marker_colorbar":954,"./attributes":1084,"./base_plot":1085,"./calc":1086,"./defaults":1088,"./layout_attributes":1094,"./layout_defaults":1095,"./plot":1097,"./style":1099}],1094:[function(y,ee,Q){"use strict";ee.exports={treemapcolorway:{valType:"colorlist",editType:"calc"},extendtreemapcolors:{valType:"boolean",dflt:!0,editType:"calc"}}},{}],1095:[function(y,ee,Q){"use strict";var g=y("../../lib"),v=y("./layout_attributes");ee.exports=function(m,x){function e(n,t){return g.coerce(m,x,v,n,t)}e("treemapcolorway",x.colorway),e("extendtreemapcolors")}},{"../../lib":515,"./layout_attributes":1094}],1096:[function(y,ee,Q){"use strict";var g=y("d3-hierarchy"),v=y("./flip_tree");ee.exports=function(m,x,e){var n,t=e.flipX,a=e.flipY,r="dice-slice"===e.packing,d=e.pad[a?"bottom":"top"],s=e.pad[t?"right":"left"],i=e.pad[t?"left":"right"],u=e.pad[a?"top":"bottom"];r&&(n=s,s=d,d=n,n=i,i=u,u=n);var f=g.treemap().tile(function(c,h){switch(c){case"squarify":return g.treemapSquarify.ratio(h);case"binary":return g.treemapBinary;case"dice":return g.treemapDice;case"slice":return g.treemapSlice;default:return g.treemapSliceDice}}(e.packing,e.squarifyratio)).paddingInner(e.pad.inner).paddingLeft(s).paddingRight(i).paddingTop(d).paddingBottom(u).size(r?[x[1],x[0]]:x)(m);return(r||t||a)&&v(f,x,{swapXY:r,flipX:t,flipY:a}),f}},{"./flip_tree":1092,"d3-hierarchy":115}],1097:[function(y,ee,Q){"use strict";var g=y("./draw"),v=y("./draw_descendants");ee.exports=function(m,x,e,n){return g(m,x,e,n,{type:"treemap",drawDescendants:v})}},{"./draw":1089,"./draw_descendants":1091}],1098:[function(y,ee,Q){"use strict";var g=y("@plotly/d3"),v=y("d3-interpolate").interpolate,m=y("../sunburst/helpers"),x=y("../../lib"),e=y("../bar/constants").TEXTPAD,n=y("../bar/plot").toMoveInsideBar,t=y("../bar/uniform_text").recordMinTextSize,a=y("./constants"),r=y("./draw_ancestors");function d(s){return m.isHierarchyRoot(s)?"":m.getPtId(s)}ee.exports=function(s,i,u,f,c){var h=s._fullLayout,p=i[0],o=p.trace,b="icicle"===o.type,l=p.hierarchy,T=m.findEntryWithLevel(l,o.level),_=g.select(u),w=_.selectAll("g.pathbar"),k=_.selectAll("g.slice");if(!T)return w.remove(),void k.remove();var L=m.isHierarchyRoot(T),M=!h.uniformtext.mode&&m.hasTransition(f),I=m.getMaxDepth(o),P=h._size,S=o.domain,E=P.w*(S.x[1]-S.x[0]),z=P.h*(S.y[1]-S.y[0]),R=E,q=o.pathbar.thickness,V=o.marker.line.width+a.gapWithPathbar,W=o.pathbar.visible?o.pathbar.side.indexOf("bottom")>-1?z+V:-(q+V):0,K={x0:R,x1:R,y0:W,y1:W+q},G=function(Pe,Ne,De){var ze=o.tiling.pad,Me=function(Re){return Re-ze<=Ne.x0},Se=function(Re){return Re+ze>=Ne.x1},Ie=function(Re){return Re-ze<=Ne.y0},Fe=function(Re){return Re+ze>=Ne.y1};return Pe.x0===Ne.x0&&Pe.x1===Ne.x1&&Pe.y0===Ne.y0&&Pe.y1===Ne.y1?{x0:Pe.x0,x1:Pe.x1,y0:Pe.y0,y1:Pe.y1}:{x0:Me(Pe.x0-ze)?0:Se(Pe.x0-ze)?De[0]:Pe.x0,x1:Me(Pe.x1+ze)?0:Se(Pe.x1+ze)?De[0]:Pe.x1,y0:Ie(Pe.y0-ze)?0:Fe(Pe.y0-ze)?De[1]:Pe.y0,y1:Ie(Pe.y1+ze)?0:Fe(Pe.y1+ze)?De[1]:Pe.y1}},Y=null,$={},B={},N=null,U=function(Pe,Ne){return Ne?$[d(Pe)]:B[d(Pe)]};p.hasMultipleRoots&&L&&I++,o._maxDepth=I,o._backgroundColor=h.paper_bgcolor,o._entryDepth=T.data.depth,o._atRootLevel=L;var j=-E/2+P.l+P.w*(S.x[1]+S.x[0])/2,J=-z/2+P.t+P.h*(1-(S.y[1]+S.y[0])/2),X=function(Pe){return j+Pe},re=function(Pe){return J+Pe},ne=re(0),le=X(0),oe=function(Pe){return le+Pe},de=function(Pe){return ne+Pe};function se(Pe,Ne){return Pe+","+Ne}var ge=oe(0),_e=function(Pe){Pe.x=Math.max(ge,Pe.x)},Te=o.pathbar.edgeshape,we=function(Pe,Ne){var De=Pe.x0,ze=Pe.x1,Me=Pe.y0,Se=Pe.y1,Ie=Pe.textBB,Fe=function(mt){return-1!==o.textposition.indexOf(mt)},Re=Fe("bottom"),Xe=Fe("top")||Ne.isHeader&&!Re?"start":Re?"end":"middle",nt=Fe("right"),ct=Fe("left")||Ne.onPathbar?-1:nt?1:0,xt=o[b?"tiling":"marker"].pad;if(Ne.isHeader){if((De+=(b?xt:xt.l)-e)>=(ze-=(b?xt:xt.r)-e)){var dt=(De+ze)/2;De=dt,ze=dt}var tt;Re?Me<(tt=Se-(b?xt:xt.b))&&tt<Se&&(Me=tt):Me<(tt=Me+(b?xt:xt.t))&&tt<Se&&(Se=tt)}var Ke=n(De,ze,Me,Se,Ie,{isHorizontal:!1,constrained:!0,angle:0,anchor:Xe,leftToRight:ct});return Ke.fontSize=Ne.fontSize,Ke.targetX=X(Ke.targetX),Ke.targetY=re(Ke.targetY),isNaN(Ke.targetX)||isNaN(Ke.targetY)?{}:(De!==ze&&Me!==Se&&t(o.type,Ke,h),{scale:Ke.scale,rotate:Ke.rotate,textX:Ke.textX,textY:Ke.textY,anchorX:Ke.anchorX,anchorY:Ke.anchorY,targetX:Ke.targetX,targetY:Ke.targetY})},Oe=function(Pe,Ne){for(var De,ze=0,Me=Pe;!De&&ze<I;)ze++,(Me=Me.parent)?De=U(Me,Ne):ze=I;return De||{}},fe=function(Pe,Ne,De,ze,Me){var Se,Ie=U(Pe,Ne);if(Ie)Se=Ie;else if(Ne)Se=K;else if(Y)if(Pe.parent){var Fe=N||De;Fe&&!Ne?Se=G(Pe,Fe,ze):x.extendFlat(Se={},Oe(Pe,Ne))}else Se=x.extendFlat({},Pe),b&&("h"===Me.orientation?Me.flipX?Se.x0=Pe.x1:Se.x1=0:Me.flipY?Se.y0=Pe.y1:Se.y1=0);else Se={};return v(Se,{x0:Pe.x0,x1:Pe.x1,y0:Pe.y0,y1:Pe.y1})},ve=function(Pe,Ne,De,ze){var Me=U(Pe,Ne),Se={},Ie=function(Pe,Ne,De,ze){return Ne?$[d(l)]||K:Pe.data.depth-T.data.depth<I?G(Pe,B[o.level]||De,ze):{}}(Pe,Ne,De,ze);x.extendFlat(Se,{transform:we({x0:Ie.x0,x1:Ie.x1,y0:Ie.y0,y1:Ie.y1,textBB:Pe.textBB,_text:Pe._text},{isHeader:m.isHeader(Pe,o)})}),Me?Se=Me:Pe.parent&&x.extendFlat(Se,Oe(Pe,Ne));var Fe=Pe.transform;return Pe.x0!==Pe.x1&&Pe.y0!==Pe.y1&&t(o.type,Fe,h),v(Se,{transform:{scale:Fe.scale,rotate:Fe.rotate,textX:Fe.textX,textY:Fe.textY,anchorX:Fe.anchorX,anchorY:Fe.anchorY,targetX:Fe.targetX,targetY:Fe.targetY}})},Ae=function(Pe,Ne,De,ze,Me){var Se=ze[0],Ie=ze[1];M?Pe.exit().transition().each(function(){var Fe=g.select(this);Fe.select("path.surface").transition().attrTween("d",function(Re){var Xe=function(nt,ct,xt,dt){var tt,Ke=U(nt,ct);if(ct)tt=K;else{var mt=U(T,ct);tt=mt?G(nt,mt,dt):{}}return v(Ke,tt)}(Re,Ne,0,[Se,Ie]);return function(nt){return Me(Xe(nt))}}),Fe.select("g.slicetext").attr("opacity",0)}).remove():Pe.exit().remove()},ke=function(Pe){var Ne=Pe.transform;return Pe.x0!==Pe.x1&&Pe.y0!==Pe.y1&&t(o.type,Ne,h),x.getTextTransform({textX:Ne.textX,textY:Ne.textY,anchorX:Ne.anchorX,anchorY:Ne.anchorY,targetX:Ne.targetX,targetY:Ne.targetY,scale:Ne.scale,rotate:Ne.rotate})};M&&(w.each(function(Pe){$[d(Pe)]={x0:Pe.x0,x1:Pe.x1,y0:Pe.y0,y1:Pe.y1},Pe.transform&&($[d(Pe)].transform={textX:Pe.transform.textX,textY:Pe.transform.textY,anchorX:Pe.transform.anchorX,anchorY:Pe.transform.anchorY,targetX:Pe.transform.targetX,targetY:Pe.transform.targetY,scale:Pe.transform.scale,rotate:Pe.transform.rotate})}),k.each(function(Pe){B[d(Pe)]={x0:Pe.x0,x1:Pe.x1,y0:Pe.y0,y1:Pe.y1},Pe.transform&&(B[d(Pe)].transform={textX:Pe.transform.textX,textY:Pe.transform.textY,anchorX:Pe.transform.anchorX,anchorY:Pe.transform.anchorY,targetX:Pe.transform.targetX,targetY:Pe.transform.targetY,scale:Pe.transform.scale,rotate:Pe.transform.rotate}),!Y&&m.isEntry(Pe)&&(Y=Pe)})),N=c(s,i,T,k,{width:E,height:z,viewX:X,viewY:re,pathSlice:function(Pe){var Ne=X(Pe.x0),De=X(Pe.x1),ze=re(Pe.y0),Me=re(Pe.y1);return De-Ne&&Me-ze?"M"+se(Ne,ze+0)+"L"+se(De-0,ze)+"L"+se(De,Me-0)+"L"+se(Ne+0,Me)+"Z":""},toMoveInsideSlice:we,prevEntry:Y,makeUpdateSliceInterpolator:fe,makeUpdateTextInterpolator:ve,handleSlicesExit:Ae,hasTransition:M,strTransform:ke}),o.pathbar.visible?r(s,i,T,w,{barDifY:W,width:R,height:q,viewX:oe,viewY:de,pathSlice:function(Pe){var Ne=oe(Math.max(Math.min(Pe.x0,Pe.x0),0)),De=oe(Math.min(Math.max(Pe.x1,Pe.x1),R)),ze=de(Pe.y0),Me=de(Pe.y1),Se=q/2,Ie={},Fe={};Ie.x=Ne,Fe.x=De,Ie.y=Fe.y=(ze+Me)/2;var Re={x:Ne,y:ze},Xe={x:De,y:ze},nt={x:De,y:Me},ct={x:Ne,y:Me};return">"===Te?(Re.x-=Se,Xe.x-=Se,nt.x-=Se,ct.x-=Se):"/"===Te?(nt.x-=Se,ct.x-=Se,Ie.x-=Se/2,Fe.x-=Se/2):"\\"===Te?(Re.x-=Se,Xe.x-=Se,Ie.x-=Se/2,Fe.x-=Se/2):"<"===Te&&(Ie.x-=Se,Fe.x-=Se),_e(Re),_e(ct),_e(Ie),_e(Xe),_e(nt),_e(Fe),"M"+se(Re.x,Re.y)+"L"+se(Xe.x,Xe.y)+"L"+se(Fe.x,Fe.y)+"L"+se(nt.x,nt.y)+"L"+se(ct.x,ct.y)+"L"+se(Ie.x,Ie.y)+"Z"},toMoveInsideSlice:we,makeUpdateSliceInterpolator:fe,makeUpdateTextInterpolator:ve,handleSlicesExit:Ae,hasTransition:M,strTransform:ke}):w.remove()}},{"../../lib":515,"../bar/constants":659,"../bar/plot":668,"../bar/uniform_text":673,"../sunburst/helpers":1064,"./constants":1087,"./draw_ancestors":1090,"@plotly/d3":58,"d3-interpolate":116}],1099:[function(y,ee,Q){"use strict";var g=y("@plotly/d3"),v=y("../../components/color"),m=y("../../lib"),x=y("../sunburst/helpers"),e=y("../bar/uniform_text").resizeText;function n(t,a,r,d){var s,i,u=(d||{}).hovered,f=a.data.data,c=f.i,h=f.color,p=x.isHierarchyRoot(a),o=1;if(u)s=r._hovered.marker.line.color,i=r._hovered.marker.line.width;else if(p&&h===r.root.color)o=100,s="rgba(0,0,0,0)",i=0;else if(s=m.castOption(r,c,"marker.line.color")||v.defaultLine,i=m.castOption(r,c,"marker.line.width")||0,!r._hasColorscale&&!a.onPathbar){var b=r.marker.depthfade;if(b){var l,T=v.combine(v.addOpacity(r._backgroundColor,.75),h);if(!0===b){var _=x.getMaxDepth(r);l=isFinite(_)?x.isLeaf(a)?0:r._maxVisibleLayers-(a.data.depth-r._entryDepth):a.data.height+1}else l=a.data.depth-r._entryDepth,r._atRootLevel||l++;if(l>0)for(var w=0;w<l;w++)h=v.combine(v.addOpacity(T,.5*w/l),h)}}t.style("stroke-width",i).call(v.fill,h).call(v.stroke,s).style("opacity",o)}ee.exports={style:function(t){var a=t._fullLayout._treemaplayer.selectAll(".trace");e(t,a,"treemap"),a.each(function(r){var d=g.select(this),s=r[0].trace;d.style("opacity",s.opacity),d.selectAll("path.surface").each(function(i){g.select(this).call(n,i,s,{hovered:!1})})})},styleOne:n}},{"../../components/color":367,"../../lib":515,"../bar/uniform_text":673,"../sunburst/helpers":1064,"@plotly/d3":58}],1100:[function(y,ee,Q){"use strict";var g=y("../box/attributes"),v=y("../../lib/extend").extendFlat,m=y("../../plots/cartesian/axis_format_attributes").axisHoverFormat;ee.exports={y:g.y,x:g.x,x0:g.x0,y0:g.y0,xhoverformat:m("x"),yhoverformat:m("y"),name:v({},g.name,{}),orientation:v({},g.orientation,{}),bandwidth:{valType:"number",min:0,editType:"calc"},scalegroup:{valType:"string",dflt:"",editType:"calc"},scalemode:{valType:"enumerated",values:["width","count"],dflt:"width",editType:"calc"},spanmode:{valType:"enumerated",values:["soft","hard","manual"],dflt:"soft",editType:"calc"},span:{valType:"info_array",items:[{valType:"any",editType:"calc"},{valType:"any",editType:"calc"}],editType:"calc"},line:{color:{valType:"color",editType:"style"},width:{valType:"number",min:0,dflt:2,editType:"style"},editType:"plot"},fillcolor:g.fillcolor,points:v({},g.boxpoints,{}),jitter:v({},g.jitter,{}),pointpos:v({},g.pointpos,{}),width:v({},g.width,{}),marker:g.marker,text:g.text,hovertext:g.hovertext,hovertemplate:g.hovertemplate,quartilemethod:g.quartilemethod,box:{visible:{valType:"boolean",dflt:!1,editType:"plot"},width:{valType:"number",min:0,max:1,dflt:.25,editType:"plot"},fillcolor:{valType:"color",editType:"style"},line:{color:{valType:"color",editType:"style"},width:{valType:"number",min:0,editType:"style"},editType:"style"},editType:"plot"},meanline:{visible:{valType:"boolean",dflt:!1,editType:"plot"},color:{valType:"color",editType:"style"},width:{valType:"number",min:0,editType:"style"},editType:"plot"},side:{valType:"enumerated",values:["both","positive","negative"],dflt:"both",editType:"calc"},offsetgroup:g.offsetgroup,alignmentgroup:g.alignmentgroup,selected:g.selected,unselected:g.unselected,hoveron:{valType:"flaglist",flags:["violins","points","kde"],dflt:"violins+points+kde",extras:["all"],editType:"style"}}},{"../../lib/extend":505,"../../plots/cartesian/axis_format_attributes":569,"../box/attributes":682}],1101:[function(y,ee,Q){"use strict";var g=y("../../lib"),v=y("../../plots/cartesian/axes"),m=y("../box/calc"),x=y("./helpers"),e=y("../../constants/numerical").BADNUM;function n(a,r,d){var s=r.max-r.min;if(!s)return a.bandwidth?a.bandwidth:0;if(a.bandwidth)return Math.max(a.bandwidth,s/1e4);var f,i=d.length,u=g.stdev(d,i-1,r.mean);return Math.max((f=i,1.059*Math.min(u,(r.q3-r.q1)/1.349)*Math.pow(f,-.2)),s/100)}function t(a,r,d,s){var i,u=a.spanmode,f=a.span||[],h=[r.min-2*s,r.max+2*s];function p(b){var l=f[b],T="multicategory"===d.type?d.r2c(l):d.d2c(l,0,a[r.valLetter+"calendar"]);return T===e?h[b]:T}var o={type:"linear",range:i="soft"===u?h:"hard"===u?[r.min,r.max]:[p(0),p(1)]};return v.setConvert(o),o.cleanRange(),i}ee.exports=function(a,r){var d=m(a,r);if(d[0].t.empty)return d;for(var s=a._fullLayout,i=v.getFromId(a,r["h"===r.orientation?"xaxis":"yaxis"]),u=1/0,f=-1/0,c=0,h=0,p=0;p<d.length;p++){var o=d[p],b=o.pts.map(x.extractVal),l=o.bandwidth=n(r,o,b),T=o.span=t(r,o,i,l);if(o.min===o.max&&0===l)T=o.span=[o.min,o.max],o.density=[{v:1,t:T[0]}],o.bandwidth=l,c=Math.max(c,1);else{var _=T[1]-T[0],w=Math.ceil(_/(l/3)),k=_/w;if(!isFinite(k)||!isFinite(w))return g.error("Something went wrong with computing the violin span"),d[0].t.empty=!0,d;var L=x.makeKDE(o,r,b);o.density=new Array(w);for(var M=0,I=T[0];I<T[1]+k/2;M++,I+=k){var P=L(I);o.density[M]={v:P,t:I},c=Math.max(c,P)}}h=Math.max(h,b.length),u=Math.min(u,T[0]),f=Math.max(f,T[1])}var S=v.findExtremes(i,[u,f],{padded:!0});if(r._extremes[i._id]=S,r.width)d[0].t.maxKDE=c;else{var E=s._violinScaleGroupStats,z=r.scalegroup,R=E[z];R?(R.maxKDE=Math.max(R.maxKDE,c),R.maxCount=Math.max(R.maxCount,h)):E[z]={maxKDE:c,maxCount:h}}return d[0].t.labels.kde=g._(a,"kde:"),d}},{"../../constants/numerical":491,"../../lib":515,"../../plots/cartesian/axes":566,"../box/calc":683,"./helpers":1104}],1102:[function(y,ee,Q){"use strict";var g=y("../box/cross_trace_calc").setPositionOffset,v=["v","h"];ee.exports=function(m,x){for(var e=m.calcdata,n=x.xaxis,t=x.yaxis,a=0;a<v.length;a++){for(var r=v[a],d="h"===r?t:n,s=[],i=0;i<e.length;i++){var u=e[i],c=u[0].trace;!0!==c.visible||"violin"!==c.type||u[0].t.empty||c.orientation!==r||c.xaxis!==n._id||c.yaxis!==t._id||s.push(i)}g("violin",m,s,d)}}},{"../box/cross_trace_calc":684}],1103:[function(y,ee,Q){"use strict";var g=y("../../lib"),v=y("../../components/color"),m=y("../box/defaults"),x=y("./attributes");ee.exports=function(e,n,t,a){function r(_,w){return g.coerce(e,n,x,_,w)}function d(_,w){return g.coerce2(e,n,x,_,w)}if(m.handleSampleDefaults(e,n,r,a),!1!==n.visible){r("bandwidth"),r("side"),r("width")||(r("scalegroup",n.name),r("scalemode"));var s,i=r("span");Array.isArray(i)&&(s="manual"),r("spanmode",s);var u=r("line.color",(e.marker||{}).color||t),f=r("line.width"),c=r("fillcolor",v.addOpacity(n.line.color,.5));m.handlePointsDefaults(e,n,r,{prefix:""});var h=d("box.width"),p=d("box.fillcolor",c),o=d("box.line.color",u),b=d("box.line.width",f);r("box.visible",Boolean(h||p||o||b))||(n.box={visible:!1});var l=d("meanline.color",u),T=d("meanline.width",f);r("meanline.visible",Boolean(l||T))||(n.meanline={visible:!1}),r("quartilemethod")}}},{"../../components/color":367,"../../lib":515,"../box/defaults":685,"./attributes":1100}],1104:[function(y,ee,Q){"use strict";var g=y("../../lib"),v=function(m){return 1/Math.sqrt(2*Math.PI)*Math.exp(-.5*m*m)};Q.makeKDE=function(m,x,e){var n=e.length,t=v,a=m.bandwidth,r=1/(n*a);return function(d){for(var s=0,i=0;i<n;i++)s+=t((d-e[i])/a);return r*s}},Q.getPositionOnKdePath=function(m,x,e){var n,t;"h"===x.orientation?(n="y",t="x"):(n="x",t="y");var a=g.findPointOnPath(m.path,e,t,{pathLength:m.pathLength}),r=m.posCenterPx,d=a[n];return[d,"both"===x.side?2*r-d:r]},Q.getKdeValue=function(m,x,e){var n=m.pts.map(Q.extractVal);return Q.makeKDE(m,x,n)(e)/m.posDensityScale},Q.extractVal=function(m){return m.v}},{"../../lib":515}],1105:[function(y,ee,Q){"use strict";var g=y("../../lib"),v=y("../../plots/cartesian/axes"),m=y("../box/hover"),x=y("./helpers");ee.exports=function(e,n,t,a,r){r||(r={});var d,s,i=r.hoverLayer,u=e.cd,f=u[0].trace,c=f.hoveron,h=-1!==c.indexOf("violins"),p=-1!==c.indexOf("kde"),o=[];if(h||p){var b=m.hoverOnBoxes(e,n,t,a);if(p&&b.length>0){var l,T,_,w,k,L=e.xa,M=e.ya;"h"===f.orientation?(k=n,l="y",_=M,T="x",w=L):(k=t,l="x",_=L,T="y",w=M);var I=u[e.index];if(k>=I.span[0]&&k<=I.span[1]){var P=g.extendFlat({},e),S=w.c2p(k,!0),E=x.getKdeValue(I,f,k),z=x.getPositionOnKdePath(I,f,S),R=_._offset,q=_._length;P[l+"0"]=z[0],P[l+"1"]=z[1],P[T+"0"]=P[T+"1"]=S,P[T+"Label"]=T+": "+v.hoverLabelText(w,k,f[T+"hoverformat"])+", "+u[0].t.labels.kde+" "+E.toFixed(3);for(var V=0,W=0;W<b.length;W++)if("med"===b[W].attr){V=W;break}P.spikeDistance=b[V].spikeDistance;var K=l+"Spike";P[K]=b[V][K],b[V].spikeDistance=void 0,b[V][K]=void 0,P.hovertemplate=!1,o.push(P),(s={stroke:e.color})[l+"1"]=g.constrain(R+z[0],R,R+q),s[l+"2"]=g.constrain(R+z[1],R,R+q),s[T+"1"]=s[T+"2"]=w._offset+S}}h&&(o=o.concat(b))}-1!==c.indexOf("points")&&(d=m.hoverOnPoints(e,n,t));var G=i.selectAll(".violinline-"+f.uid).data(s?[0]:[]);return G.enter().append("line").classed("violinline-"+f.uid,!0).attr("stroke-width",1.5),G.exit().remove(),G.attr(s),"closest"===a?d?[d]:o:(d&&o.push(d),o)}},{"../../lib":515,"../../plots/cartesian/axes":566,"../box/hover":687,"./helpers":1104}],1106:[function(y,ee,Q){"use strict";ee.exports={attributes:y("./attributes"),layoutAttributes:y("./layout_attributes"),supplyDefaults:y("./defaults"),crossTraceDefaults:y("../box/defaults").crossTraceDefaults,supplyLayoutDefaults:y("./layout_defaults"),calc:y("./calc"),crossTraceCalc:y("./cross_trace_calc"),plot:y("./plot"),style:y("./style"),styleOnSelect:y("../scatter/style").styleOnSelect,hoverPoints:y("./hover"),selectPoints:y("../box/select"),moduleType:"trace",name:"violin",basePlotModule:y("../../plots/cartesian"),categories:["cartesian","svg","symbols","oriented","box-violin","showLegend","violinLayout","zoomScale"],meta:{}}},{"../../plots/cartesian":578,"../box/defaults":685,"../box/select":692,"../scatter/style":960,"./attributes":1100,"./calc":1101,"./cross_trace_calc":1102,"./defaults":1103,"./hover":1105,"./layout_attributes":1107,"./layout_defaults":1108,"./plot":1109,"./style":1110}],1107:[function(y,ee,Q){"use strict";var g=y("../box/layout_attributes"),v=y("../../lib").extendFlat;ee.exports={violinmode:v({},g.boxmode,{}),violingap:v({},g.boxgap,{}),violingroupgap:v({},g.boxgroupgap,{})}},{"../../lib":515,"../box/layout_attributes":689}],1108:[function(y,ee,Q){"use strict";var g=y("../../lib"),v=y("./layout_attributes"),m=y("../box/layout_defaults");ee.exports=function(x,e,n){m._supply(x,e,n,function(t,a){return g.coerce(x,e,v,t,a)},"violin")}},{"../../lib":515,"../box/layout_defaults":690,"./layout_attributes":1107}],1109:[function(y,ee,Q){"use strict";var g=y("@plotly/d3"),v=y("../../lib"),m=y("../../components/drawing"),x=y("../box/plot"),e=y("../scatter/line_points"),n=y("./helpers");ee.exports=function(t,a,r,d){var s=t._fullLayout,i=a.xaxis,u=a.yaxis;function f(c){var h=e(c,{xaxis:i,yaxis:u,connectGaps:!0,baseTolerance:.75,shape:"spline",simplify:!0,linearized:!0});return m.smoothopen(h[0],1)}v.makeTraceGroups(d,r,"trace violins").each(function(c){var h=g.select(this),p=c[0],o=p.t,b=p.trace;if(!0!==b.visible||o.empty)h.remove();else{var l=o.bPos,T=o.bdPos,_=a[o.valLetter+"axis"],w=a[o.posLetter+"axis"],k="both"===b.side,L=k||"positive"===b.side,M=k||"negative"===b.side,I=h.selectAll("path.violin").data(v.identity);I.enter().append("path").style("vector-effect","non-scaling-stroke").attr("class","violin"),I.exit().remove(),I.each(function(W){var K,G,Y,$,B,N,U,te,j=g.select(this),J=W.density,X=J.length,re=w.c2l(W.pos+l,!0),ne=w.l2p(re);if(b.width)K=o.maxKDE/T;else{var le=s._violinScaleGroupStats[b.scalegroup];K="count"===b.scalemode?le.maxKDE/T*(le.maxCount/W.pts.length):le.maxKDE/T}if(L){for(U=new Array(X),B=0;B<X;B++)(te=U[B]={})[o.posLetter]=re+J[B].v/K,te[o.valLetter]=_.c2l(J[B].t,!0);G=f(U)}if(M){for(U=new Array(X),N=0,B=X-1;N<X;N++,B--)(te=U[N]={})[o.posLetter]=re-J[B].v/K,te[o.valLetter]=_.c2l(J[B].t,!0);Y=f(U)}if(k)$=G+"L"+Y.substr(1)+"Z";else{var oe=[ne,_.c2p(J[0].t)],de=[ne,_.c2p(J[X-1].t)];"h"===b.orientation&&(oe.reverse(),de.reverse()),$=L?"M"+oe+"L"+G.substr(1)+"L"+de:"M"+de+"L"+Y.substr(1)+"L"+oe}j.attr("d",$),W.posCenterPx=ne,W.posDensityScale=K*T,W.path=j.node(),W.pathLength=W.path.getTotalLength()/(k?2:1)});var P,S,E,z=b.box,R=z.width,q=(z.line||{}).width;k?(P=T*R,S=0):L?(P=[0,T*R/2],S=q*{x:1,y:-1}[o.posLetter]):(P=[T*R/2,0],S=q*{x:-1,y:1}[o.posLetter]),x.plotBoxAndWhiskers(h,{pos:w,val:_},b,{bPos:l,bdPos:P,bPosPxOffset:S}),x.plotBoxMean(h,{pos:w,val:_},b,{bPos:l,bdPos:P,bPosPxOffset:S}),!b.box.visible&&b.meanline.visible&&(E=v.identity);var V=h.selectAll("path.meanline").data(E||[]);V.enter().append("path").attr("class","meanline").style("fill","none").style("vector-effect","non-scaling-stroke"),V.exit().remove(),V.each(function(W){var K=_.c2p(W.mean,!0),G=n.getPositionOnKdePath(W,b,K);g.select(this).attr("d","h"===b.orientation?"M"+K+","+G[0]+"V"+G[1]:"M"+G[0]+","+K+"H"+G[1])}),x.plotPoints(h,{x:i,y:u},b,o)}})}},{"../../components/drawing":389,"../../lib":515,"../box/plot":691,"../scatter/line_points":950,"./helpers":1104,"@plotly/d3":58}],1110:[function(y,ee,Q){"use strict";var g=y("@plotly/d3"),v=y("../../components/color"),m=y("../scatter/style").stylePoints;ee.exports=function(x){var e=g.select(x).selectAll("g.trace.violins");e.style("opacity",function(n){return n[0].trace.opacity}),e.each(function(n){var t=n[0].trace,a=g.select(this),r=t.box||{},d=r.line||{},s=t.meanline||{},i=s.width;a.selectAll("path.violin").style("stroke-width",t.line.width+"px").call(v.stroke,t.line.color).call(v.fill,t.fillcolor),a.selectAll("path.box").style("stroke-width",d.width+"px").call(v.stroke,d.color).call(v.fill,r.fillcolor);var u={"stroke-width":i+"px","stroke-dasharray":2*i+"px,"+i+"px"};a.selectAll("path.mean").style(u).call(v.stroke,s.color),a.selectAll("path.meanline").style(u).call(v.stroke,s.color),m(a,t,x)})}},{"../../components/color":367,"../scatter/style":960,"@plotly/d3":58}],1111:[function(y,ee,Q){"use strict";var g=y("../../components/colorscale/attributes"),v=y("../isosurface/attributes"),m=y("../surface/attributes"),x=y("../../plots/attributes"),e=y("../../lib/extend").extendFlat,n=y("../../plot_api/edit_types").overrideAll,t=ee.exports=n(e({x:v.x,y:v.y,z:v.z,value:v.value,isomin:v.isomin,isomax:v.isomax,surface:v.surface,spaceframe:{show:{valType:"boolean",dflt:!1},fill:{valType:"number",min:0,max:1,dflt:1}},slices:v.slices,caps:v.caps,text:v.text,hovertext:v.hovertext,xhoverformat:v.xhoverformat,yhoverformat:v.yhoverformat,zhoverformat:v.zhoverformat,valuehoverformat:v.valuehoverformat,hovertemplate:v.hovertemplate},g("",{colorAttr:"`value`",showScaleDflt:!0,editTypeOverride:"calc"}),{colorbar:v.colorbar,opacity:v.opacity,opacityscale:m.opacityscale,lightposition:v.lightposition,lighting:v.lighting,flatshading:v.flatshading,contour:v.contour,hoverinfo:e({},x.hoverinfo),showlegend:e({},x.showlegend,{dflt:!1})}),"calc","nested");t.x.editType=t.y.editType=t.z.editType=t.value.editType="calc+clearAxisTypes",t.transforms=void 0},{"../../components/colorscale/attributes":374,"../../lib/extend":505,"../../plot_api/edit_types":548,"../../plots/attributes":562,"../isosurface/attributes":871,"../surface/attributes":1070}],1112:[function(y,ee,Q){"use strict";var g=y("../../../stackgl_modules").gl_mesh3d,v=y("../../lib/gl_format_color").parseColorScale,m=y("../../lib/str2rgbarray"),x=y("../../components/colorscale").extractOpts,e=y("../../plots/gl3d/zip3"),n=y("../isosurface/convert").findNearestOnAxis,t=y("../isosurface/convert").generateIsoMeshes;function a(d,s,i){this.scene=d,this.uid=i,this.mesh=s,this.name="",this.data=null,this.showContour=!1}var r=a.prototype;r.handlePick=function(d){if(d.object===this.mesh){var s=d.data.index,u=this.data._meshY[s],f=this.data._meshZ[s],c=this.data._Ys.length,h=this.data._Zs.length,p=n(this.data._meshX[s],this.data._Xs).id,o=n(u,this.data._Ys).id,b=n(f,this.data._Zs).id,l=d.index=b+h*o+h*c*p;d.traceCoordinate=[this.data._meshX[l],this.data._meshY[l],this.data._meshZ[l],this.data._value[l]];var T=this.data.hovertext||this.data.text;return Array.isArray(T)&&void 0!==T[l]?d.textLabel=T[l]:T&&(d.textLabel=T),!0}},r.update=function(d){var s=this.scene,i=s.fullSceneLayout;function u(h,p,o,b){return p.map(function(l){return h.d2l(l,0,b)*o})}this.data=t(d);var f={positions:e(u(i.xaxis,d._meshX,s.dataScale[0],d.xcalendar),u(i.yaxis,d._meshY,s.dataScale[1],d.ycalendar),u(i.zaxis,d._meshZ,s.dataScale[2],d.zcalendar)),cells:e(d._meshI,d._meshJ,d._meshK),lightPosition:[d.lightposition.x,d.lightposition.y,d.lightposition.z],ambient:d.lighting.ambient,diffuse:d.lighting.diffuse,specular:d.lighting.specular,roughness:d.lighting.roughness,fresnel:d.lighting.fresnel,vertexNormalsEpsilon:d.lighting.vertexnormalsepsilon,faceNormalsEpsilon:d.lighting.facenormalsepsilon,opacity:d.opacity,opacityscale:d.opacityscale,contourEnable:d.contour.show,contourColor:m(d.contour.color).slice(0,3),contourWidth:d.contour.width,useFacetNormals:d.flatshading},c=x(d);f.vertexIntensity=d._meshIntensity,f.vertexIntensityBounds=[c.min,c.max],f.colormap=v(d),this.mesh.update(f)},r.dispose=function(){this.scene.glplot.remove(this.mesh),this.mesh.dispose()},ee.exports=function(d,s){var u=g({gl:d.glplot.gl}),f=new a(d,u,s.uid);return u._trace=f,f.update(s),d.glplot.add(u),f}},{"../../../stackgl_modules":1133,"../../components/colorscale":379,"../../lib/gl_format_color":511,"../../lib/str2rgbarray":540,"../../plots/gl3d/zip3":618,"../isosurface/convert":873}],1113:[function(y,ee,Q){"use strict";var g=y("../../lib"),v=y("./attributes"),m=y("../isosurface/defaults").supplyIsoDefaults,x=y("../surface/defaults").opacityscaleDefaults;ee.exports=function(e,n,t,a){function r(d,s){return g.coerce(e,n,v,d,s)}m(e,n,t,a,r),x(e,n,a,r)}},{"../../lib":515,"../isosurface/defaults":874,"../surface/defaults":1073,"./attributes":1111}],1114:[function(y,ee,Q){"use strict";ee.exports={attributes:y("./attributes"),supplyDefaults:y("./defaults"),calc:y("../isosurface/calc"),colorbar:{min:"cmin",max:"cmax"},plot:y("./convert"),moduleType:"trace",name:"volume",basePlotModule:y("../../plots/gl3d"),categories:["gl3d","showLegend"],meta:{}}},{"../../plots/gl3d":607,"../isosurface/calc":872,"./attributes":1111,"./convert":1112,"./defaults":1113}],1115:[function(y,ee,Q){"use strict";var g=y("../bar/attributes"),v=y("../scatter/attributes").line,m=y("../../plots/attributes"),x=y("../../plots/cartesian/axis_format_attributes").axisHoverFormat,e=y("../../plots/template_attributes").hovertemplateAttrs,n=y("../../plots/template_attributes").texttemplateAttrs,t=y("./constants"),a=y("../../lib/extend").extendFlat,r=y("../../components/color");function d(s){return{marker:{color:a({},g.marker.color,{arrayOk:!1,editType:"style"}),line:{color:a({},g.marker.line.color,{arrayOk:!1,editType:"style"}),width:a({},g.marker.line.width,{arrayOk:!1,editType:"style"}),editType:"style"},editType:"style"},editType:"style"}}ee.exports={measure:{valType:"data_array",dflt:[],editType:"calc"},base:{valType:"number",dflt:null,arrayOk:!1,editType:"calc"},x:g.x,x0:g.x0,dx:g.dx,y:g.y,y0:g.y0,dy:g.dy,xperiod:g.xperiod,yperiod:g.yperiod,xperiod0:g.xperiod0,yperiod0:g.yperiod0,xperiodalignment:g.xperiodalignment,yperiodalignment:g.yperiodalignment,xhoverformat:x("x"),yhoverformat:x("y"),hovertext:g.hovertext,hovertemplate:e({},{keys:t.eventDataKeys}),hoverinfo:a({},m.hoverinfo,{flags:["name","x","y","text","initial","delta","final"]}),textinfo:{valType:"flaglist",flags:["label","text","initial","delta","final"],extras:["none"],editType:"plot",arrayOk:!1},texttemplate:n({editType:"plot"},{keys:t.eventDataKeys.concat(["label"])}),text:g.text,textposition:g.textposition,insidetextanchor:g.insidetextanchor,textangle:g.textangle,textfont:g.textfont,insidetextfont:g.insidetextfont,outsidetextfont:g.outsidetextfont,constraintext:g.constraintext,cliponaxis:g.cliponaxis,orientation:g.orientation,offset:g.offset,width:g.width,increasing:d(),decreasing:d(),totals:d(),connector:{line:{color:a({},v.color,{dflt:r.defaultLine}),width:a({},v.width,{editType:"plot"}),dash:v.dash,editType:"plot"},mode:{valType:"enumerated",values:["spanning","between"],dflt:"between",editType:"plot"},visible:{valType:"boolean",dflt:!0,editType:"plot"},editType:"plot"},offsetgroup:g.offsetgroup,alignmentgroup:g.alignmentgroup}},{"../../components/color":367,"../../lib/extend":505,"../../plots/attributes":562,"../../plots/cartesian/axis_format_attributes":569,"../../plots/template_attributes":642,"../bar/attributes":657,"../scatter/attributes":936,"./constants":1117}],1116:[function(y,ee,Q){"use strict";var g=y("../../plots/cartesian/axes"),v=y("../../plots/cartesian/align_period"),m=y("../../lib").mergeArray,x=y("../scatter/calc_selection"),e=y("../../constants/numerical").BADNUM;function n(a){return"a"===a||"absolute"===a}function t(a){return"t"===a||"total"===a}ee.exports=function(a,r){var d,s,i,u,f,c,h=g.getFromId(a,r.xaxis||"x"),p=g.getFromId(a,r.yaxis||"y");"h"===r.orientation?(d=h.makeCalcdata(r,"x"),i=p.makeCalcdata(r,"y"),u=v(r,p,"y",i),f=!!r.yperiodalignment,c="y"):(d=p.makeCalcdata(r,"y"),i=h.makeCalcdata(r,"x"),u=v(r,h,"x",i),f=!!r.xperiodalignment,c="x"),s=u.vals;for(var o,b=Math.min(s.length,d.length),l=new Array(b),T=0,_=!1,w=0;w<b;w++){var k=d[w]||0,L=!1;(d[w]!==e||t(r.measure[w])||n(r.measure[w]))&&w+1<b&&(d[w+1]!==e||t(r.measure[w+1])||n(r.measure[w+1]))&&(L=!0);var M=l[w]={i:w,p:s[w],s:k,rawS:k,cNext:L};n(r.measure[w])?(T=M.s,M.isSum=!0,M.dir="totals",M.s=T):t(r.measure[w])?(M.isSum=!0,M.dir="totals",M.s=T):(M.isSum=!1,M.dir=M.rawS<0?"decreasing":"increasing",M.s=T+(o=M.s),T+=o),"totals"===M.dir&&(_=!0),f&&(l[w].orig_p=i[w],l[w][c+"End"]=u.ends[w],l[w][c+"Start"]=u.starts[w]),r.ids&&(M.id=String(r.ids[w])),M.v=(r.base||0)+T}return l.length&&(l[0].hasTotals=_),m(r.text,l,"tx"),m(r.hovertext,l,"htx"),x(l,r),l}},{"../../constants/numerical":491,"../../lib":515,"../../plots/cartesian/align_period":563,"../../plots/cartesian/axes":566,"../scatter/calc_selection":938}],1117:[function(y,ee,Q){"use strict";ee.exports={eventDataKeys:["initial","delta","final"]}},{}],1118:[function(y,ee,Q){"use strict";var g=y("../bar/cross_trace_calc").setGroupPositions;ee.exports=function(v,m){var x,e,n=v._fullLayout,t=v._fullData,a=v.calcdata,r=m.xaxis,d=m.yaxis,s=[],i=[],u=[];for(e=0;e<t.length;e++){var f=t[e];!0===f.visible&&f.xaxis===r._id&&f.yaxis===d._id&&"waterfall"===f.type&&(x=a[e],"h"===f.orientation?u.push(x):i.push(x),s.push(x))}var c={mode:n.waterfallmode,norm:n.waterfallnorm,gap:n.waterfallgap,groupgap:n.waterfallgroupgap};for(g(v,r,d,i,c),g(v,d,r,u,c),e=0;e<s.length;e++){x=s[e];for(var h=0;h<x.length;h++){var p=x[h];!1===p.isSum&&(p.s0+=0===h?0:x[h-1].s),h+1<x.length&&(x[h].nextP0=x[h+1].p0,x[h].nextS0=x[h+1].s0)}}}},{"../bar/cross_trace_calc":660}],1119:[function(y,ee,Q){"use strict";var g=y("../../lib"),v=y("../bar/defaults").handleGroupingDefaults,m=y("../bar/defaults").handleText,x=y("../scatter/xy_defaults"),e=y("../scatter/period_defaults"),n=y("./attributes"),t=y("../../components/color"),a=y("../../constants/delta.js"),r=a.INCREASING.COLOR,d=a.DECREASING.COLOR;function s(i,u,f){i(u+".marker.color",f),i(u+".marker.line.color",t.defaultLine),i(u+".marker.line.width")}ee.exports={supplyDefaults:function(i,u,f,c){function h(o,b){return g.coerce(i,u,n,o,b)}if(x(i,u,c,h)){e(i,u,c,h),h("xhoverformat"),h("yhoverformat"),h("measure"),h("orientation",u.x&&!u.y?"h":"v"),h("base"),h("offset"),h("width"),h("text"),h("hovertext"),h("hovertemplate");var p=h("textposition");m(i,u,c,h,p,{moduleHasSelected:!1,moduleHasUnselected:!1,moduleHasConstrain:!0,moduleHasCliponaxis:!0,moduleHasTextangle:!0,moduleHasInsideanchor:!0}),"none"!==u.textposition&&(h("texttemplate"),u.texttemplate||h("textinfo")),s(h,"increasing",r),s(h,"decreasing",d),s(h,"totals","#4499FF"),h("connector.visible")&&(h("connector.mode"),h("connector.line.width")&&(h("connector.line.color"),h("connector.line.dash")))}else u.visible=!1},crossTraceDefaults:function(i,u){var f,c;function h(o){return g.coerce(c._input,c,n,o)}if("group"===u.waterfallmode)for(var p=0;p<i.length;p++)f=(c=i[p])._input,v(f,c,u,h)}}},{"../../components/color":367,"../../constants/delta.js":485,"../../lib":515,"../bar/defaults":661,"../scatter/period_defaults":956,"../scatter/xy_defaults":963,"./attributes":1115}],1120:[function(y,ee,Q){"use strict";ee.exports=function(g,v){return g.x="xVal"in v?v.xVal:v.x,g.y="yVal"in v?v.yVal:v.y,"initial"in v&&(g.initial=v.initial),"delta"in v&&(g.delta=v.delta),"final"in v&&(g.final=v.final),v.xa&&(g.xaxis=v.xa),v.ya&&(g.yaxis=v.ya),g}},{}],1121:[function(y,ee,Q){"use strict";var g=y("../../plots/cartesian/axes").hoverLabelText,v=y("../../components/color").opacity,m=y("../bar/hover").hoverOnBars,x=y("../../constants/delta.js"),e=x.INCREASING.SYMBOL,n=x.DECREASING.SYMBOL;ee.exports=function(t,a,r,d,s){var S,E,z,R,i=m(t,a,r,d,s);if(i){var u=i.cd,f=u[0].trace,c="h"===f.orientation,h=c?"x":"y",p=c?t.xa:t.ya,o=u[i.index],b=o.isSum?o.b+o.s:o.rawS;if(!o.isSum){i.initial=o.b+o.s-b,i.delta=b,i.final=i.initial+i.delta;var l=M(Math.abs(i.delta));i.deltaLabel=b<0?"("+l+")":l,i.finalLabel=M(i.final),i.initialLabel=M(i.initial)}var T=o.hi||f.hoverinfo,_=[];if(T&&"none"!==T&&"skip"!==T){var w="all"===T,k=T.split("+"),L=function(I){return w||-1!==k.indexOf(I)};o.isSum||(!L("final")||L(c?"x":"y")||_.push(i.finalLabel),L("delta")&&_.push(b<0?i.deltaLabel+" "+n:i.deltaLabel+" "+e),L("initial")&&_.push("Initial: "+i.initialLabel))}return _.length&&(i.extraText=_.join("<br>")),i.color=(z=(S=f[o.dir].marker).line.color,R=S.line.width,v(E=S.color)?E:v(z)&&R?z:void 0),[i]}function M(I){return g(p,I,f[h+"hoverformat"])}}},{"../../components/color":367,"../../constants/delta.js":485,"../../plots/cartesian/axes":566,"../bar/hover":664}],1122:[function(y,ee,Q){"use strict";ee.exports={attributes:y("./attributes"),layoutAttributes:y("./layout_attributes"),supplyDefaults:y("./defaults").supplyDefaults,crossTraceDefaults:y("./defaults").crossTraceDefaults,supplyLayoutDefaults:y("./layout_defaults"),calc:y("./calc"),crossTraceCalc:y("./cross_trace_calc"),plot:y("./plot"),style:y("./style").style,hoverPoints:y("./hover"),eventData:y("./event_data"),selectPoints:y("../bar/select"),moduleType:"trace",name:"waterfall",basePlotModule:y("../../plots/cartesian"),categories:["bar-like","cartesian","svg","oriented","showLegend","zoomScale"],meta:{}}},{"../../plots/cartesian":578,"../bar/select":669,"./attributes":1115,"./calc":1116,"./cross_trace_calc":1118,"./defaults":1119,"./event_data":1120,"./hover":1121,"./layout_attributes":1123,"./layout_defaults":1124,"./plot":1125,"./style":1126}],1123:[function(y,ee,Q){"use strict";ee.exports={waterfallmode:{valType:"enumerated",values:["group","overlay"],dflt:"group",editType:"calc"},waterfallgap:{valType:"number",min:0,max:1,editType:"calc"},waterfallgroupgap:{valType:"number",min:0,max:1,dflt:0,editType:"calc"}}},{}],1124:[function(y,ee,Q){"use strict";var g=y("../../lib"),v=y("./layout_attributes");ee.exports=function(m,x,e){var n=!1;function t(d,s){return g.coerce(m,x,v,d,s)}for(var a=0;a<e.length;a++){var r=e[a];if(r.visible&&"waterfall"===r.type){n=!0;break}}n&&(t("waterfallmode"),t("waterfallgap",.2),t("waterfallgroupgap"))}},{"../../lib":515,"./layout_attributes":1123}],1125:[function(y,ee,Q){"use strict";var g=y("@plotly/d3"),v=y("../../lib"),m=y("../../components/drawing"),x=y("../../constants/numerical").BADNUM,e=y("../bar/plot"),n=y("../bar/uniform_text").clearMinTextSize;ee.exports=function(t,a,r,d){var i,u,h,p,s=t._fullLayout;n("waterfall",s),e.plot(t,a,r,d,{mode:s.waterfallmode,norm:s.waterfallmode,gap:s.waterfallgap,groupgap:s.waterfallgroupgap}),i=t,h=(u=a).xaxis,p=u.yaxis,v.makeTraceGroups(d,r,"trace bars").each(function(o){var b=g.select(this),l=o[0].trace,T=v.ensureSingle(b,"g","lines");if(l.connector&&l.connector.visible){var _="h"===l.orientation,w=l.connector.mode,k=T.selectAll("g.line").data(v.identity);k.enter().append("g").classed("line",!0),k.exit().remove();var L=k.size();k.each(function(M,I){if(I===L-1||M.cNext){var P=(q=h,V=p,G=[],$=(W=_)?V:q,(K=[])[0]=(Y=W?q:V).c2p((R=M).s0,!0),G[0]=$.c2p(R.p0,!0),K[1]=Y.c2p(R.s1,!0),G[1]=$.c2p(R.p1,!0),K[2]=Y.c2p(R.nextS0,!0),G[2]=$.c2p(R.nextP0,!0),W?[K,G]:[G,K]),S=P[0],E=P[1],z="";S[0]!==x&&E[0]!==x&&S[1]!==x&&E[1]!==x&&("spanning"===w&&!M.isSum&&I>0&&(z+=_?"M"+S[0]+","+E[1]+"V"+E[0]:"M"+S[1]+","+E[0]+"H"+S[0]),"between"!==w&&(M.isSum||I<L-1)&&(z+=_?"M"+S[1]+","+E[0]+"V"+E[1]:"M"+S[0]+","+E[1]+"H"+S[1]),S[2]!==x&&E[2]!==x&&(z+=_?"M"+S[1]+","+E[1]+"V"+E[2]:"M"+S[1]+","+E[1]+"H"+S[2])),""===z&&(z="M0,0Z"),v.ensureSingle(g.select(this),"path").attr("d",z).call(m.setClipUrl,u.layerClipId,i)}var R,q,V,W,K,G,Y,$})}else T.remove()})}},{"../../components/drawing":389,"../../constants/numerical":491,"../../lib":515,"../bar/plot":668,"../bar/uniform_text":673,"@plotly/d3":58}],1126:[function(y,ee,Q){"use strict";var g=y("@plotly/d3"),v=y("../../components/drawing"),m=y("../../components/color"),x=y("../../constants/interactions").DESELECTDIM,e=y("../bar/style"),n=y("../bar/uniform_text").resizeText,t=e.styleTextPoints;ee.exports={style:function(a,r,d){var s=d||g.select(a).selectAll("g.waterfalllayer").selectAll("g.trace");n(a,s,"waterfall"),s.style("opacity",function(i){return i[0].trace.opacity}),s.each(function(i){var u=g.select(this),f=i[0].trace;u.selectAll(".point > path").each(function(c){if(!c.isBlank){var h=f[c.dir].marker;g.select(this).call(m.fill,h.color).call(m.stroke,h.line.color).call(v.dashLine,h.line.dash,h.line.width).style("opacity",f.selectedpoints&&!c.selected?x:1)}}),t(u,f,a),u.selectAll(".lines").each(function(){var c=f.connector.line;v.lineGroupStyle(g.select(this).selectAll("path"),c.width,c.color,c.dash)})})}}},{"../../components/color":367,"../../components/drawing":389,"../../constants/interactions":490,"../bar/style":671,"../bar/uniform_text":673,"@plotly/d3":58}],1127:[function(y,ee,Q){"use strict";var g=y("../plots/cartesian/axes"),v=y("../lib"),m=y("../plot_api/plot_schema"),x=y("./helpers").pointsAccessorFunction,e=y("../constants/numerical").BADNUM;Q.moduleType="transform",Q.name="aggregate";var n=Q.attributes={enabled:{valType:"boolean",dflt:!0,editType:"calc"},groups:{valType:"string",strict:!0,noBlank:!0,arrayOk:!0,dflt:"x",editType:"calc"},aggregations:{_isLinkedToArray:"aggregation",target:{valType:"string",editType:"calc"},func:{valType:"enumerated",values:["count","sum","avg","median","mode","rms","stddev","min","max","first","last","change","range"],dflt:"first",editType:"calc"},funcmode:{valType:"enumerated",values:["sample","population"],dflt:"sample",editType:"calc"},enabled:{valType:"boolean",dflt:!0,editType:"calc"},editType:"calc"},editType:"calc"},t=n.aggregations;function a(i,u,f,c){if(c.enabled){for(var h=c.target,p=v.nestedProperty(u,h),o=p.get(),b=function(_,w){var L=w.d2c,M=w.c2d;switch(_.func){case"count":return r;case"first":return d;case"last":return s;case"sum":return function(I,P){for(var S=0,E=0;E<P.length;E++){var z=L(I[P[E]]);z!==e&&(S+=z)}return M(S)};case"avg":return function(I,P){for(var S=0,E=0,z=0;z<P.length;z++){var R=L(I[P[z]]);R!==e&&(S+=R,E++)}return E?M(S/E):e};case"min":return function(I,P){for(var S=1/0,E=0;E<P.length;E++){var z=L(I[P[E]]);z!==e&&(S=Math.min(S,z))}return S===1/0?e:M(S)};case"max":return function(I,P){for(var S=-1/0,E=0;E<P.length;E++){var z=L(I[P[E]]);z!==e&&(S=Math.max(S,z))}return S===-1/0?e:M(S)};case"range":return function(I,P){for(var S=1/0,E=-1/0,z=0;z<P.length;z++){var R=L(I[P[z]]);R!==e&&(S=Math.min(S,R),E=Math.max(E,R))}return E===-1/0||S===1/0?e:M(E-S)};case"change":return function(I,P){var S=L(I[P[0]]),E=L(I[P[P.length-1]]);return S===e||E===e?e:M(E-S)};case"median":return function(I,P){for(var S=[],E=0;E<P.length;E++){var z=L(I[P[E]]);z!==e&&S.push(z)}if(!S.length)return e;S.sort(v.sorterAsc);var R=(S.length-1)/2;return M((S[Math.floor(R)]+S[Math.ceil(R)])/2)};case"mode":return function(I,P){for(var S={},E=0,z=e,R=0;R<P.length;R++){var q=L(I[P[R]]);if(q!==e){var V=S[q]=(S[q]||0)+1;V>E&&(E=V,z=q)}}return E?M(z):e};case"rms":return function(I,P){for(var S=0,E=0,z=0;z<P.length;z++){var R=L(I[P[z]]);R!==e&&(S+=R*R,E++)}return E?M(Math.sqrt(S/E)):e};case"stddev":return function(I,P){var S,E=0,z=0,R=1,q=e;for(S=0;S<P.length&&q===e;S++)q=L(I[P[S]]);if(q===e)return e;for(;S<P.length;S++){var V=L(I[P[S]]);if(V!==e){var W=V-q;E+=W,z+=W*W,R++}}var K="sample"===_.funcmode?R-1:R;return K?Math.sqrt((z-E*E/R)/K):0}}}(c,g.getDataConversions(i,u,h,o)),l=new Array(f.length),T=0;T<f.length;T++)l[T]=b(o,f[T]);p.set(l),"count"===c.func&&v.pushUnique(u._arrayAttrs,h)}}function r(i,u){return u.length}function d(i,u){return i[u[0]]}function s(i,u){return i[u[u.length-1]]}Q.supplyDefaults=function(i,u){var f,c={};function h(M,I){return v.coerce(i,c,n,M,I)}if(!h("enabled"))return c;var p=m.findArrayAttributes(u),o={};for(f=0;f<p.length;f++)o[p[f]]=1;var b=h("groups");if(!Array.isArray(b)){if(!o[b])return c.enabled=!1,c;o[b]=0}var l,T=i.aggregations||[],_=c.aggregations=new Array(T.length);function w(M,I){return v.coerce(T[f],l,t,M,I)}for(f=0;f<T.length;f++){l={_index:f};var k=w("target"),L=w("func");w("enabled")&&k&&(o[k]||"count"===L&&void 0===o[k])?("stddev"===L&&w("funcmode"),o[k]=0,_[f]=l):_[f]={enabled:!1,_index:f}}for(f=0;f<p.length;f++)o[p[f]]&&_.push({target:p[f],func:t.func.dflt,enabled:!0,_index:-1});return c},Q.calcTransform=function(i,u,f){if(f.enabled){var c=f.groups,h=v.getTargetArray(u,{target:c});if(h){var p,o,b,T={},_={},w=[],k=x(u.transforms,f),L=h.length;for(u._length&&(L=Math.min(L,u._length)),p=0;p<L;p++)void 0===(b=T[o=h[p]])?(T[o]=w.length,w.push([p]),_[T[o]]=k(p)):(w[b].push(p),_[T[o]]=(_[T[o]]||[]).concat(k(p)));f._indexToPoints=_;var M=f.aggregations;for(p=0;p<M.length;p++)a(i,u,w,M[p]);"string"==typeof c&&a(i,u,w,{target:c,func:"first",enabled:!0}),u._length=w.length}}}},{"../constants/numerical":491,"../lib":515,"../plot_api/plot_schema":554,"../plots/cartesian/axes":566,"./helpers":1130}],1128:[function(y,ee,Q){"use strict";var g=y("../lib"),v=y("../registry"),m=y("../plots/cartesian/axes"),x=y("./helpers").pointsAccessorFunction,e=y("../constants/filter_ops"),n=e.COMPARISON_OPS,t=e.INTERVAL_OPS,a=e.SET_OPS;Q.moduleType="transform",Q.name="filter",Q.attributes={enabled:{valType:"boolean",dflt:!0,editType:"calc"},target:{valType:"string",strict:!0,noBlank:!0,arrayOk:!0,dflt:"x",editType:"calc"},operation:{valType:"enumerated",values:[].concat(n).concat(t).concat(a),dflt:"=",editType:"calc"},value:{valType:"any",dflt:0,editType:"calc"},preservegaps:{valType:"boolean",dflt:!1,editType:"calc"},editType:"calc"},Q.supplyDefaults=function(r){var d={};function s(f,c){return g.coerce(r,d,Q.attributes,f,c)}if(s("enabled")){var i=s("target");if(g.isArrayOrTypedArray(i)&&0===i.length)return d.enabled=!1,d;s("preservegaps"),s("operation"),s("value");var u=v.getComponentMethod("calendars","handleDefaults");u(r,d,"valuecalendar",null),u(r,d,"targetcalendar",null)}return d},Q.calcTransform=function(r,d,s){if(s.enabled){var i=g.getTargetArray(d,s);if(i){var u=s.target,f=i.length;d._length&&(f=Math.min(f,d._length));var c=s.targetcalendar,h=d._arrayAttrs,p=s.preservegaps;if("string"==typeof u){var o=g.nestedProperty(d,u+"calendar").get();o&&(c=o)}var b,l,T=function(P,S,E){var z=P.operation,R=P.value,q=Array.isArray(R);function V(Y){return-1!==Y.indexOf(z)}var W,K=function(Y){return S(Y,0,P.valuecalendar)},G=function(Y){return S(Y,0,E)};switch(V(n)?W=K(q?R[0]:R):V(t)?W=q?[K(R[0]),K(R[1])]:[K(R),K(R)]:V(a)&&(W=q?R.map(K):[K(R)]),z){case"=":return function(Y){return G(Y)===W};case"!=":return function(Y){return G(Y)!==W};case"<":return function(Y){return G(Y)<W};case"<=":return function(Y){return G(Y)<=W};case">":return function(Y){return G(Y)>W};case">=":return function(Y){return G(Y)>=W};case"[]":return function(Y){var $=G(Y);return $>=W[0]&&$<=W[1]};case"()":return function(Y){var $=G(Y);return $>W[0]&&$<W[1]};case"[)":return function(Y){var $=G(Y);return $>=W[0]&&$<W[1]};case"(]":return function(Y){var $=G(Y);return $>W[0]&&$<=W[1]};case"][":return function(Y){var $=G(Y);return $<=W[0]||$>=W[1]};case")(":return function(Y){var $=G(Y);return $<W[0]||$>W[1]};case"](":return function(Y){var $=G(Y);return $<=W[0]||$>W[1]};case")[":return function(Y){var $=G(Y);return $<W[0]||$>=W[1]};case"{}":return function(Y){return-1!==W.indexOf(G(Y))};case"}{":return function(Y){return-1===W.indexOf(G(Y))}}}(s,m.getDataToCoordFunc(r,d,u,i),c),_={},w={},k=0;p?(b=function(P){_[P.astr]=g.extendDeep([],P.get()),P.set(new Array(f))},l=function(P,S){var E=_[P.astr][S];P.get()[S]=E}):(b=function(P){_[P.astr]=g.extendDeep([],P.get()),P.set([])},l=function(P,S){var E=_[P.astr][S];P.get().push(E)}),I(b);for(var L=x(d.transforms,s),M=0;M<f;M++)T(i[M])?(I(l,M),w[k++]=L(M)):p&&k++;s._indexToPoints=w,d._length=k}}function I(P,S){for(var E=0;E<h.length;E++)P(g.nestedProperty(d,h[E]),S)}}},{"../constants/filter_ops":487,"../lib":515,"../plots/cartesian/axes":566,"../registry":647,"./helpers":1130}],1129:[function(y,ee,Q){"use strict";var g=y("../lib"),v=y("../plot_api/plot_schema"),m=y("../plots/plots"),x=y("./helpers").pointsAccessorFunction;function e(n,t){var a,r,d,s,i,u,f,c,h,p,o=t.transform,b=t.transformIndex,l=n.transforms[b].groups,T=x(n.transforms,o);if(!g.isArrayOrTypedArray(l)||0===l.length)return[n];var _=g.filterUnique(l),w=new Array(_.length),k=l.length,L=v.findArrayAttributes(n),M=o.styles||[],I={};for(a=0;a<M.length;a++)I[M[a].target]=M[a].value;o.styles&&(p=g.keyedContainer(o,"styles","target","value.name"));var P={},S={};for(a=0;a<_.length;a++){P[u=_[a]]=a,S[u]=0,(f=w[a]=g.extendDeepNoArrays({},n))._group=u,f.transforms[b]._indexToPoints={};var E=null;for(p&&(E=p.get(u)),f.name=E||""===E?E:g.templateString(o.nameformat,{trace:n.name,group:u}),c=f.transforms,f.transforms=[],r=0;r<c.length;r++)f.transforms[r]=g.extendDeepNoArrays({},c[r]);for(r=0;r<L.length;r++)g.nestedProperty(f,L[r]).set([])}for(d=0;d<L.length;d++){for(s=L[d],r=0,h=[];r<_.length;r++)h[r]=g.nestedProperty(w[r],s).get();for(i=g.nestedProperty(n,s).get(),r=0;r<k;r++)h[P[l[r]]].push(i[r])}for(r=0;r<k;r++)(f=w[P[l[r]]]).transforms[b]._indexToPoints[S[l[r]]]=T(r),S[l[r]]++;for(a=0;a<_.length;a++)u=_[a],m.clearExpandedTraceDefaultColors(f=w[a]),f=g.extendDeepNoArrays(f,I[u]||{});return w}Q.moduleType="transform",Q.name="groupby",Q.attributes={enabled:{valType:"boolean",dflt:!0,editType:"calc"},groups:{valType:"data_array",dflt:[],editType:"calc"},nameformat:{valType:"string",editType:"calc"},styles:{_isLinkedToArray:"style",target:{valType:"string",editType:"calc"},value:{valType:"any",dflt:{},editType:"calc",_compareAsJSON:!0},editType:"calc"},editType:"calc"},Q.supplyDefaults=function(n,t,a){var r,d={};function s(h,p){return g.coerce(n,d,Q.attributes,h,p)}if(!s("enabled"))return d;s("groups"),s("nameformat",a._dataLength>1?"%{group} (%{trace})":"%{group}");var i=n.styles,u=d.styles=[];if(i)for(r=0;r<i.length;r++){var f=u[r]={};g.coerce(i[r],u[r],Q.attributes.styles,"target");var c=g.coerce(i[r],u[r],Q.attributes.styles,"value");g.isPlainObject(c)?f.value=g.extendDeep({},c):c&&delete f.value}return d},Q.transform=function(n,t){var a,r,d,s=[];for(r=0;r<n.length;r++)for(a=e(n[r],t),d=0;d<a.length;d++)s.push(a[d]);return s}},{"../lib":515,"../plot_api/plot_schema":554,"../plots/plots":628,"./helpers":1130}],1130:[function(y,ee,Q){"use strict";Q.pointsAccessorFunction=function(g,v){for(var m,x,e=0;e<g.length&&(m=g[e])!==v;e++)m._indexToPoints&&!1!==m.enabled&&(x=m._indexToPoints);return x?function(n){return x[n]}:function(n){return[n]}}},{}],1131:[function(y,ee,Q){"use strict";var g=y("../lib"),v=y("../plots/cartesian/axes"),m=y("./helpers").pointsAccessorFunction,x=y("../constants/numerical").BADNUM;Q.moduleType="transform",Q.name="sort",Q.attributes={enabled:{valType:"boolean",dflt:!0,editType:"calc"},target:{valType:"string",strict:!0,noBlank:!0,arrayOk:!0,dflt:"x",editType:"calc"},order:{valType:"enumerated",values:["ascending","descending"],dflt:"ascending",editType:"calc"},editType:"calc"},Q.supplyDefaults=function(e){var n={};function t(a,r){return g.coerce(e,n,Q.attributes,a,r)}return t("enabled")&&(t("target"),t("order")),n},Q.calcTransform=function(e,n,t){if(t.enabled){var a=g.getTargetArray(n,t);if(a){var r=t.target,d=a.length;n._length&&(d=Math.min(d,n._length));var s,i,u=n._arrayAttrs,f=function(l,T,_,w){var k,L=new Array(w),M=new Array(w);for(k=0;k<w;k++)L[k]={v:T[k],i:k};for(L.sort(function(I,P){switch(I.order){case"ascending":return function(S,E){var z=P(S.v),R=P(E.v);return z===x?1:R===x?-1:z-R};case"descending":return function(S,E){var z=P(S.v),R=P(E.v);return z===x?1:R===x?-1:R-z}}}(l,_)),k=0;k<w;k++)M[k]=L[k].i;return M}(t,a,v.getDataToCoordFunc(e,n,r,a),d),c=m(n.transforms,t),h={};for(s=0;s<u.length;s++){var p=g.nestedProperty(n,u[s]),o=p.get(),b=new Array(d);for(i=0;i<d;i++)b[i]=o[f[i]];p.set(b)}for(i=0;i<d;i++)h[i]=c(f[i]);t._indexToPoints=h,n._length=d}}}},{"../constants/numerical":491,"../lib":515,"../plots/cartesian/axes":566,"./helpers":1130}],1132:[function(y,ee,Q){"use strict";Q.version="2.13.2"},{}],1133:[function(y,ee,Q){(function(g){(function(){!function(v){"object"==typeof Q&&void 0!==ee?ee.exports=v():(typeof window<"u"?window:void 0!==g?g:typeof self<"u"?self:this).stackgl=v()}(function(){return function v(m,x,e){function n(r,d){if(!x[r]){if(!m[r]){var s="function"==typeof y&&y;if(!d&&s)return s(r,!0);if(t)return t(r,!0);var i=new Error("Cannot find module '"+r+"'");throw i.code="MODULE_NOT_FOUND",i}var u=x[r]={exports:{}};m[r][0].call(u.exports,function(f){return n(m[r][1][f]||f)},u,u.exports,v,m,x,e)}return x[r].exports}for(var t="function"==typeof y&&y,a=0;a<e.length;a++)n(e[a]);return n}({1:[function(v,m,x){"use strict";x.byteLength=function(u){var f=s(u),h=f[1];return 3*(f[0]+h)/4-h},x.toByteArray=function(u){var f,c,k,h=s(u),p=h[0],o=h[1],b=new t(3*(p+(k=o))/4-k),l=0,T=o>0?p-4:p;for(c=0;c<T;c+=4)f=n[u.charCodeAt(c)]<<18|n[u.charCodeAt(c+1)]<<12|n[u.charCodeAt(c+2)]<<6|n[u.charCodeAt(c+3)],b[l++]=f>>16&255,b[l++]=f>>8&255,b[l++]=255&f;return 2===o&&(f=n[u.charCodeAt(c)]<<2|n[u.charCodeAt(c+1)]>>4,b[l++]=255&f),1===o&&(f=n[u.charCodeAt(c)]<<10|n[u.charCodeAt(c+1)]<<4|n[u.charCodeAt(c+2)]>>2,b[l++]=f>>8&255,b[l++]=255&f),b},x.fromByteArray=function(u){for(var f,c=u.length,h=c%3,p=[],o=0,b=c-h;o<b;o+=16383)p.push(i(u,o,o+16383>b?b:o+16383));return 1===h?p.push(e[(f=u[c-1])>>2]+e[f<<4&63]+"=="):2===h&&p.push(e[(f=(u[c-2]<<8)+u[c-1])>>10]+e[f>>4&63]+e[f<<2&63]+"="),p.join("")};for(var e=[],n=[],t=typeof Uint8Array<"u"?Uint8Array:Array,a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",r=0,d=a.length;r<d;++r)e[r]=a[r],n[a.charCodeAt(r)]=r;function s(u){var f=u.length;if(f%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var c=u.indexOf("=");return-1===c&&(c=f),[c,c===f?0:4-c%4]}function i(u,f,c){for(var p,o=[],b=f;b<c;b+=3)o.push(e[(p=(u[b]<<16&16711680)+(u[b+1]<<8&65280)+(255&u[b+2]))>>18&63]+e[p>>12&63]+e[p>>6&63]+e[63&p]);return o.join("")}n["-".charCodeAt(0)]=62,n["_".charCodeAt(0)]=63},{}],2:[function(v,m,x){},{}],3:[function(v,m,x){(function(e){(function(){"use strict";var n=v("base64-js"),t=v("ieee754");function a(j){if(j>2147483647)throw new RangeError('The value "'+j+'" is invalid for option "size"');var J=new Uint8Array(j);return J.__proto__=r.prototype,J}function r(j,J,X){if("number"==typeof j){if("string"==typeof J)throw new TypeError('The "string" argument must be of type string. Received type number');return i(j)}return d(j,J,X)}function d(j,J,X){if("string"==typeof j)return function(le,oe){if("string"==typeof oe&&""!==oe||(oe="utf8"),!r.isEncoding(oe))throw new TypeError("Unknown encoding: "+oe);var de=0|c(le,oe),se=a(de),ge=se.write(le,oe);return ge!==de&&(se=se.slice(0,ge)),se}(j,J);if(ArrayBuffer.isView(j))return u(j);if(null==j)throw TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof j);if(U(j,ArrayBuffer)||j&&U(j.buffer,ArrayBuffer))return function(le,oe,de){if(oe<0||le.byteLength<oe)throw new RangeError('"offset" is outside of buffer bounds');if(le.byteLength<oe+(de||0))throw new RangeError('"length" is outside of buffer bounds');var se;return(se=void 0===oe&&void 0===de?new Uint8Array(le):void 0===de?new Uint8Array(le,oe):new Uint8Array(le,oe,de)).__proto__=r.prototype,se}(j,J,X);if("number"==typeof j)throw new TypeError('The "value" argument must not be of type number. Received type number');var re=j.valueOf&&j.valueOf();if(null!=re&&re!==j)return r.from(re,J,X);var ne=function(le){if(r.isBuffer(le)){var oe=0|f(le.length),de=a(oe);return 0===de.length||le.copy(de,0,0,oe),de}return void 0!==le.length?"number"!=typeof le.length||te(le.length)?a(0):u(le):"Buffer"===le.type&&Array.isArray(le.data)?u(le.data):void 0}(j);if(ne)return ne;if(typeof Symbol<"u"&&null!=Symbol.toPrimitive&&"function"==typeof j[Symbol.toPrimitive])return r.from(j[Symbol.toPrimitive]("string"),J,X);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof j)}function s(j){if("number"!=typeof j)throw new TypeError('"size" argument must be of type number');if(j<0)throw new RangeError('The value "'+j+'" is invalid for option "size"')}function i(j){return s(j),a(j<0?0:0|f(j))}function u(j){for(var J=j.length<0?0:0|f(j.length),X=a(J),re=0;re<J;re+=1)X[re]=255&j[re];return X}function f(j){if(j>=2147483647)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+2147483647..toString(16)+" bytes");return 0|j}function c(j,J){if(r.isBuffer(j))return j.length;if(ArrayBuffer.isView(j)||U(j,ArrayBuffer))return j.byteLength;if("string"!=typeof j)throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof j);var X=j.length,re=arguments.length>2&&!0===arguments[2];if(!re&&0===X)return 0;for(var ne=!1;;)switch(J){case"ascii":case"latin1":case"binary":return X;case"utf8":case"utf-8":return $(j).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*X;case"hex":return X>>>1;case"base64":return B(j).length;default:if(ne)return re?-1:$(j).length;J=(""+J).toLowerCase(),ne=!0}}function h(j,J,X){var re=!1;if((void 0===J||J<0)&&(J=0),J>this.length||((void 0===X||X>this.length)&&(X=this.length),X<=0)||(X>>>=0)<=(J>>>=0))return"";for(j||(j="utf8");;)switch(j){case"hex":return E(this,J,X);case"utf8":case"utf-8":return I(this,J,X);case"ascii":return P(this,J,X);case"latin1":case"binary":return S(this,J,X);case"base64":return M(this,J,X);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return z(this,J,X);default:if(re)throw new TypeError("Unknown encoding: "+j);j=(j+"").toLowerCase(),re=!0}}function p(j,J,X){var re=j[J];j[J]=j[X],j[X]=re}function o(j,J,X,re,ne){if(0===j.length)return-1;if("string"==typeof X?(re=X,X=0):X>2147483647?X=2147483647:X<-2147483648&&(X=-2147483648),te(X=+X)&&(X=ne?0:j.length-1),X<0&&(X=j.length+X),X>=j.length){if(ne)return-1;X=j.length-1}else if(X<0){if(!ne)return-1;X=0}if("string"==typeof J&&(J=r.from(J,re)),r.isBuffer(J))return 0===J.length?-1:b(j,J,X,re,ne);if("number"==typeof J)return J&=255,"function"==typeof Uint8Array.prototype.indexOf?ne?Uint8Array.prototype.indexOf.call(j,J,X):Uint8Array.prototype.lastIndexOf.call(j,J,X):b(j,[J],X,re,ne);throw new TypeError("val must be string, number or Buffer")}function b(j,J,X,re,ne){var le,oe=1,de=j.length,se=J.length;if(void 0!==re&&("ucs2"===(re=String(re).toLowerCase())||"ucs-2"===re||"utf16le"===re||"utf-16le"===re)){if(j.length<2||J.length<2)return-1;oe=2,de/=2,se/=2,X/=2}function ge(Oe,fe){return 1===oe?Oe[fe]:Oe.readUInt16BE(fe*oe)}if(ne){var _e=-1;for(le=X;le<de;le++)if(ge(j,le)===ge(J,-1===_e?0:le-_e)){if(-1===_e&&(_e=le),le-_e+1===se)return _e*oe}else-1!==_e&&(le-=le-_e),_e=-1}else for(X+se>de&&(X=de-se),le=X;le>=0;le--){for(var Te=!0,we=0;we<se;we++)if(ge(j,le+we)!==ge(J,we)){Te=!1;break}if(Te)return le}return-1}function l(j,J,X,re){X=Number(X)||0;var ne=j.length-X;re?(re=Number(re))>ne&&(re=ne):re=ne;var le=J.length;re>le/2&&(re=le/2);for(var oe=0;oe<re;++oe){var de=parseInt(J.substr(2*oe,2),16);if(te(de))return oe;j[X+oe]=de}return oe}function T(j,J,X,re){return N($(J,j.length-X),j,X,re)}function _(j,J,X,re){return N(function(ne){for(var le=[],oe=0;oe<ne.length;++oe)le.push(255&ne.charCodeAt(oe));return le}(J),j,X,re)}function w(j,J,X,re){return _(j,J,X,re)}function k(j,J,X,re){return N(B(J),j,X,re)}function L(j,J,X,re){return N(function(ne,le){for(var oe,de,ge=[],_e=0;_e<ne.length&&!((le-=2)<0);++_e)de=(oe=ne.charCodeAt(_e))>>8,ge.push(oe%256),ge.push(de);return ge}(J,j.length-X),j,X,re)}function M(j,J,X){return n.fromByteArray(0===J&&X===j.length?j:j.slice(J,X))}function I(j,J,X){X=Math.min(j.length,X);for(var re=[],ne=J;ne<X;){var le,oe,de,se,ge=j[ne],_e=null,Te=ge>239?4:ge>223?3:ge>191?2:1;if(ne+Te<=X)switch(Te){case 1:ge<128&&(_e=ge);break;case 2:128==(192&(le=j[ne+1]))&&(se=(31&ge)<<6|63&le)>127&&(_e=se);break;case 3:oe=j[ne+2],128==(192&(le=j[ne+1]))&&128==(192&oe)&&(se=(15&ge)<<12|(63&le)<<6|63&oe)>2047&&(se<55296||se>57343)&&(_e=se);break;case 4:oe=j[ne+2],de=j[ne+3],128==(192&(le=j[ne+1]))&&128==(192&oe)&&128==(192&de)&&(se=(15&ge)<<18|(63&le)<<12|(63&oe)<<6|63&de)>65535&&se<1114112&&(_e=se)}null===_e?(_e=65533,Te=1):_e>65535&&(re.push((_e-=65536)>>>10&1023|55296),_e=56320|1023&_e),re.push(_e),ne+=Te}return function(we){var Oe=we.length;if(Oe<=4096)return String.fromCharCode.apply(String,we);for(var fe="",ve=0;ve<Oe;)fe+=String.fromCharCode.apply(String,we.slice(ve,ve+=4096));return fe}(re)}function P(j,J,X){var re="";X=Math.min(j.length,X);for(var ne=J;ne<X;++ne)re+=String.fromCharCode(127&j[ne]);return re}function S(j,J,X){var re="";X=Math.min(j.length,X);for(var ne=J;ne<X;++ne)re+=String.fromCharCode(j[ne]);return re}function E(j,J,X){var re=j.length;(!J||J<0)&&(J=0),(!X||X<0||X>re)&&(X=re);for(var ne="",le=J;le<X;++le)ne+=Y(j[le]);return ne}function z(j,J,X){for(var re=j.slice(J,X),ne="",le=0;le<re.length;le+=2)ne+=String.fromCharCode(re[le]+256*re[le+1]);return ne}function R(j,J,X){if(j%1!=0||j<0)throw new RangeError("offset is not uint");if(j+J>X)throw new RangeError("Trying to access beyond buffer length")}function q(j,J,X,re,ne,le){if(!r.isBuffer(j))throw new TypeError('"buffer" argument must be a Buffer instance');if(J>ne||J<le)throw new RangeError('"value" argument is out of bounds');if(X+re>j.length)throw new RangeError("Index out of range")}function V(j,J,X,re,ne,le){if(X+re>j.length)throw new RangeError("Index out of range");if(X<0)throw new RangeError("Index out of range")}function W(j,J,X,re,ne){return J=+J,X>>>=0,ne||V(j,0,X,4),t.write(j,J,X,re,23,4),X+4}function K(j,J,X,re,ne){return J=+J,X>>>=0,ne||V(j,0,X,8),t.write(j,J,X,re,52,8),X+8}x.Buffer=r,x.SlowBuffer=function(j){return+j!=j&&(j=0),r.alloc(+j)},x.INSPECT_MAX_BYTES=50,x.kMaxLength=2147483647,(r.TYPED_ARRAY_SUPPORT=function(){try{var j=new Uint8Array(1);return j.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===j.foo()}catch{return!1}}())||typeof console>"u"||"function"!=typeof console.error||console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),Object.defineProperty(r.prototype,"parent",{enumerable:!0,get:function(){if(r.isBuffer(this))return this.buffer}}),Object.defineProperty(r.prototype,"offset",{enumerable:!0,get:function(){if(r.isBuffer(this))return this.byteOffset}}),typeof Symbol<"u"&&null!=Symbol.species&&r[Symbol.species]===r&&Object.defineProperty(r,Symbol.species,{value:null,configurable:!0,enumerable:!1,writable:!1}),r.poolSize=8192,r.from=function(j,J,X){return d(j,J,X)},r.prototype.__proto__=Uint8Array.prototype,r.__proto__=Uint8Array,r.alloc=function(j,J,X){return ne=J,le=X,s(re=j),re<=0?a(re):void 0!==ne?"string"==typeof le?a(re).fill(ne,le):a(re).fill(ne):a(re);var re,ne,le},r.allocUnsafe=function(j){return i(j)},r.allocUnsafeSlow=function(j){return i(j)},r.isBuffer=function(j){return null!=j&&!0===j._isBuffer&&j!==r.prototype},r.compare=function(j,J){if(U(j,Uint8Array)&&(j=r.from(j,j.offset,j.byteLength)),U(J,Uint8Array)&&(J=r.from(J,J.offset,J.byteLength)),!r.isBuffer(j)||!r.isBuffer(J))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(j===J)return 0;for(var X=j.length,re=J.length,ne=0,le=Math.min(X,re);ne<le;++ne)if(j[ne]!==J[ne]){X=j[ne],re=J[ne];break}return X<re?-1:re<X?1:0},r.isEncoding=function(j){switch(String(j).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},r.concat=function(j,J){if(!Array.isArray(j))throw new TypeError('"list" argument must be an Array of Buffers');if(0===j.length)return r.alloc(0);var X;if(void 0===J)for(J=0,X=0;X<j.length;++X)J+=j[X].length;var re=r.allocUnsafe(J),ne=0;for(X=0;X<j.length;++X){var le=j[X];if(U(le,Uint8Array)&&(le=r.from(le)),!r.isBuffer(le))throw new TypeError('"list" argument must be an Array of Buffers');le.copy(re,ne),ne+=le.length}return re},r.byteLength=c,r.prototype._isBuffer=!0,r.prototype.swap16=function(){var j=this.length;if(j%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var J=0;J<j;J+=2)p(this,J,J+1);return this},r.prototype.swap32=function(){var j=this.length;if(j%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var J=0;J<j;J+=4)p(this,J,J+3),p(this,J+1,J+2);return this},r.prototype.swap64=function(){var j=this.length;if(j%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var J=0;J<j;J+=8)p(this,J,J+7),p(this,J+1,J+6),p(this,J+2,J+5),p(this,J+3,J+4);return this},r.prototype.toLocaleString=r.prototype.toString=function(){var j=this.length;return 0===j?"":0===arguments.length?I(this,0,j):h.apply(this,arguments)},r.prototype.equals=function(j){if(!r.isBuffer(j))throw new TypeError("Argument must be a Buffer");return this===j||0===r.compare(this,j)},r.prototype.inspect=function(){var j="",J=x.INSPECT_MAX_BYTES;return j=this.toString("hex",0,J).replace(/(.{2})/g,"$1 ").trim(),this.length>J&&(j+=" ... "),"<Buffer "+j+">"},r.prototype.compare=function(j,J,X,re,ne){if(U(j,Uint8Array)&&(j=r.from(j,j.offset,j.byteLength)),!r.isBuffer(j))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof j);if(void 0===J&&(J=0),void 0===X&&(X=j?j.length:0),void 0===re&&(re=0),void 0===ne&&(ne=this.length),J<0||X>j.length||re<0||ne>this.length)throw new RangeError("out of range index");if(re>=ne&&J>=X)return 0;if(re>=ne)return-1;if(J>=X)return 1;if(this===j)return 0;for(var le=(ne>>>=0)-(re>>>=0),oe=(X>>>=0)-(J>>>=0),de=Math.min(le,oe),se=this.slice(re,ne),ge=j.slice(J,X),_e=0;_e<de;++_e)if(se[_e]!==ge[_e]){le=se[_e],oe=ge[_e];break}return le<oe?-1:oe<le?1:0},r.prototype.includes=function(j,J,X){return-1!==this.indexOf(j,J,X)},r.prototype.indexOf=function(j,J,X){return o(this,j,J,X,!0)},r.prototype.lastIndexOf=function(j,J,X){return o(this,j,J,X,!1)},r.prototype.write=function(j,J,X,re){if(void 0===J)re="utf8",X=this.length,J=0;else if(void 0===X&&"string"==typeof J)re=J,X=this.length,J=0;else{if(!isFinite(J))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");J>>>=0,isFinite(X)?(X>>>=0,void 0===re&&(re="utf8")):(re=X,X=void 0)}var ne=this.length-J;if((void 0===X||X>ne)&&(X=ne),j.length>0&&(X<0||J<0)||J>this.length)throw new RangeError("Attempt to write outside buffer bounds");re||(re="utf8");for(var le=!1;;)switch(re){case"hex":return l(this,j,J,X);case"utf8":case"utf-8":return T(this,j,J,X);case"ascii":return _(this,j,J,X);case"latin1":case"binary":return w(this,j,J,X);case"base64":return k(this,j,J,X);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return L(this,j,J,X);default:if(le)throw new TypeError("Unknown encoding: "+re);re=(""+re).toLowerCase(),le=!0}},r.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}},r.prototype.slice=function(j,J){var X=this.length;(j=~~j)<0?(j+=X)<0&&(j=0):j>X&&(j=X),(J=void 0===J?X:~~J)<0?(J+=X)<0&&(J=0):J>X&&(J=X),J<j&&(J=j);var re=this.subarray(j,J);return re.__proto__=r.prototype,re},r.prototype.readUIntLE=function(j,J,X){j>>>=0,J>>>=0,X||R(j,J,this.length);for(var re=this[j],ne=1,le=0;++le<J&&(ne*=256);)re+=this[j+le]*ne;return re},r.prototype.readUIntBE=function(j,J,X){j>>>=0,J>>>=0,X||R(j,J,this.length);for(var re=this[j+--J],ne=1;J>0&&(ne*=256);)re+=this[j+--J]*ne;return re},r.prototype.readUInt8=function(j,J){return j>>>=0,J||R(j,1,this.length),this[j]},r.prototype.readUInt16LE=function(j,J){return j>>>=0,J||R(j,2,this.length),this[j]|this[j+1]<<8},r.prototype.readUInt16BE=function(j,J){return j>>>=0,J||R(j,2,this.length),this[j]<<8|this[j+1]},r.prototype.readUInt32LE=function(j,J){return j>>>=0,J||R(j,4,this.length),(this[j]|this[j+1]<<8|this[j+2]<<16)+16777216*this[j+3]},r.prototype.readUInt32BE=function(j,J){return j>>>=0,J||R(j,4,this.length),16777216*this[j]+(this[j+1]<<16|this[j+2]<<8|this[j+3])},r.prototype.readIntLE=function(j,J,X){j>>>=0,J>>>=0,X||R(j,J,this.length);for(var re=this[j],ne=1,le=0;++le<J&&(ne*=256);)re+=this[j+le]*ne;return re>=(ne*=128)&&(re-=Math.pow(2,8*J)),re},r.prototype.readIntBE=function(j,J,X){j>>>=0,J>>>=0,X||R(j,J,this.length);for(var re=J,ne=1,le=this[j+--re];re>0&&(ne*=256);)le+=this[j+--re]*ne;return le>=(ne*=128)&&(le-=Math.pow(2,8*J)),le},r.prototype.readInt8=function(j,J){return j>>>=0,J||R(j,1,this.length),128&this[j]?-1*(255-this[j]+1):this[j]},r.prototype.readInt16LE=function(j,J){j>>>=0,J||R(j,2,this.length);var X=this[j]|this[j+1]<<8;return 32768&X?4294901760|X:X},r.prototype.readInt16BE=function(j,J){j>>>=0,J||R(j,2,this.length);var X=this[j+1]|this[j]<<8;return 32768&X?4294901760|X:X},r.prototype.readInt32LE=function(j,J){return j>>>=0,J||R(j,4,this.length),this[j]|this[j+1]<<8|this[j+2]<<16|this[j+3]<<24},r.prototype.readInt32BE=function(j,J){return j>>>=0,J||R(j,4,this.length),this[j]<<24|this[j+1]<<16|this[j+2]<<8|this[j+3]},r.prototype.readFloatLE=function(j,J){return j>>>=0,J||R(j,4,this.length),t.read(this,j,!0,23,4)},r.prototype.readFloatBE=function(j,J){return j>>>=0,J||R(j,4,this.length),t.read(this,j,!1,23,4)},r.prototype.readDoubleLE=function(j,J){return j>>>=0,J||R(j,8,this.length),t.read(this,j,!0,52,8)},r.prototype.readDoubleBE=function(j,J){return j>>>=0,J||R(j,8,this.length),t.read(this,j,!1,52,8)},r.prototype.writeUIntLE=function(j,J,X,re){j=+j,J>>>=0,X>>>=0,re||q(this,j,J,X,Math.pow(2,8*X)-1,0);var ne=1,le=0;for(this[J]=255&j;++le<X&&(ne*=256);)this[J+le]=j/ne&255;return J+X},r.prototype.writeUIntBE=function(j,J,X,re){j=+j,J>>>=0,X>>>=0,re||q(this,j,J,X,Math.pow(2,8*X)-1,0);var ne=X-1,le=1;for(this[J+ne]=255&j;--ne>=0&&(le*=256);)this[J+ne]=j/le&255;return J+X},r.prototype.writeUInt8=function(j,J,X){return j=+j,J>>>=0,X||q(this,j,J,1,255,0),this[J]=255&j,J+1},r.prototype.writeUInt16LE=function(j,J,X){return j=+j,J>>>=0,X||q(this,j,J,2,65535,0),this[J]=255&j,this[J+1]=j>>>8,J+2},r.prototype.writeUInt16BE=function(j,J,X){return j=+j,J>>>=0,X||q(this,j,J,2,65535,0),this[J]=j>>>8,this[J+1]=255&j,J+2},r.prototype.writeUInt32LE=function(j,J,X){return j=+j,J>>>=0,X||q(this,j,J,4,4294967295,0),this[J+3]=j>>>24,this[J+2]=j>>>16,this[J+1]=j>>>8,this[J]=255&j,J+4},r.prototype.writeUInt32BE=function(j,J,X){return j=+j,J>>>=0,X||q(this,j,J,4,4294967295,0),this[J]=j>>>24,this[J+1]=j>>>16,this[J+2]=j>>>8,this[J+3]=255&j,J+4},r.prototype.writeIntLE=function(j,J,X,re){if(j=+j,J>>>=0,!re){var ne=Math.pow(2,8*X-1);q(this,j,J,X,ne-1,-ne)}var le=0,oe=1,de=0;for(this[J]=255&j;++le<X&&(oe*=256);)j<0&&0===de&&0!==this[J+le-1]&&(de=1),this[J+le]=(j/oe>>0)-de&255;return J+X},r.prototype.writeIntBE=function(j,J,X,re){if(j=+j,J>>>=0,!re){var ne=Math.pow(2,8*X-1);q(this,j,J,X,ne-1,-ne)}var le=X-1,oe=1,de=0;for(this[J+le]=255&j;--le>=0&&(oe*=256);)j<0&&0===de&&0!==this[J+le+1]&&(de=1),this[J+le]=(j/oe>>0)-de&255;return J+X},r.prototype.writeInt8=function(j,J,X){return j=+j,J>>>=0,X||q(this,j,J,1,127,-128),j<0&&(j=255+j+1),this[J]=255&j,J+1},r.prototype.writeInt16LE=function(j,J,X){return j=+j,J>>>=0,X||q(this,j,J,2,32767,-32768),this[J]=255&j,this[J+1]=j>>>8,J+2},r.prototype.writeInt16BE=function(j,J,X){return j=+j,J>>>=0,X||q(this,j,J,2,32767,-32768),this[J]=j>>>8,this[J+1]=255&j,J+2},r.prototype.writeInt32LE=function(j,J,X){return j=+j,J>>>=0,X||q(this,j,J,4,2147483647,-2147483648),this[J]=255&j,this[J+1]=j>>>8,this[J+2]=j>>>16,this[J+3]=j>>>24,J+4},r.prototype.writeInt32BE=function(j,J,X){return j=+j,J>>>=0,X||q(this,j,J,4,2147483647,-2147483648),j<0&&(j=4294967295+j+1),this[J]=j>>>24,this[J+1]=j>>>16,this[J+2]=j>>>8,this[J+3]=255&j,J+4},r.prototype.writeFloatLE=function(j,J,X){return W(this,j,J,!0,X)},r.prototype.writeFloatBE=function(j,J,X){return W(this,j,J,!1,X)},r.prototype.writeDoubleLE=function(j,J,X){return K(this,j,J,!0,X)},r.prototype.writeDoubleBE=function(j,J,X){return K(this,j,J,!1,X)},r.prototype.copy=function(j,J,X,re){if(!r.isBuffer(j))throw new TypeError("argument should be a Buffer");if(X||(X=0),re||0===re||(re=this.length),J>=j.length&&(J=j.length),J||(J=0),re>0&&re<X&&(re=X),re===X||0===j.length||0===this.length)return 0;if(J<0)throw new RangeError("targetStart out of bounds");if(X<0||X>=this.length)throw new RangeError("Index out of range");if(re<0)throw new RangeError("sourceEnd out of bounds");re>this.length&&(re=this.length),j.length-J<re-X&&(re=j.length-J+X);var ne=re-X;if(this===j&&"function"==typeof Uint8Array.prototype.copyWithin)this.copyWithin(J,X,re);else if(this===j&&X<J&&J<re)for(var le=ne-1;le>=0;--le)j[le+J]=this[le+X];else Uint8Array.prototype.set.call(j,this.subarray(X,re),J);return ne},r.prototype.fill=function(j,J,X,re){if("string"==typeof j){if("string"==typeof J?(re=J,J=0,X=this.length):"string"==typeof X&&(re=X,X=this.length),void 0!==re&&"string"!=typeof re)throw new TypeError("encoding must be a string");if("string"==typeof re&&!r.isEncoding(re))throw new TypeError("Unknown encoding: "+re);if(1===j.length){var ne=j.charCodeAt(0);("utf8"===re&&ne<128||"latin1"===re)&&(j=ne)}}else"number"==typeof j&&(j&=255);if(J<0||this.length<J||this.length<X)throw new RangeError("Out of range index");if(X<=J)return this;var le;if(J>>>=0,X=void 0===X?this.length:X>>>0,j||(j=0),"number"==typeof j)for(le=J;le<X;++le)this[le]=j;else{var oe=r.isBuffer(j)?j:r.from(j,re),de=oe.length;if(0===de)throw new TypeError('The value "'+j+'" is invalid for argument "value"');for(le=0;le<X-J;++le)this[le+J]=oe[le%de]}return this};var G=/[^+/0-9A-Za-z-_]/g;function Y(j){return j<16?"0"+j.toString(16):j.toString(16)}function $(j,J){var X;J=J||1/0;for(var re=j.length,ne=null,le=[],oe=0;oe<re;++oe){if((X=j.charCodeAt(oe))>55295&&X<57344){if(!ne){if(X>56319){(J-=3)>-1&&le.push(239,191,189);continue}if(oe+1===re){(J-=3)>-1&&le.push(239,191,189);continue}ne=X;continue}if(X<56320){(J-=3)>-1&&le.push(239,191,189),ne=X;continue}X=65536+(ne-55296<<10|X-56320)}else ne&&(J-=3)>-1&&le.push(239,191,189);if(ne=null,X<128){if((J-=1)<0)break;le.push(X)}else if(X<2048){if((J-=2)<0)break;le.push(X>>6|192,63&X|128)}else if(X<65536){if((J-=3)<0)break;le.push(X>>12|224,X>>6&63|128,63&X|128)}else{if(!(X<1114112))throw new Error("Invalid code point");if((J-=4)<0)break;le.push(X>>18|240,X>>12&63|128,X>>6&63|128,63&X|128)}}return le}function B(j){return n.toByteArray(function(J){if((J=(J=J.split("=")[0]).trim().replace(G,"")).length<2)return"";for(;J.length%4!=0;)J+="=";return J}(j))}function N(j,J,X,re){for(var ne=0;ne<re&&!(ne+X>=J.length||ne>=j.length);++ne)J[ne+X]=j[ne];return ne}function U(j,J){return j instanceof J||null!=j&&null!=j.constructor&&null!=j.constructor.name&&j.constructor.name===J.name}function te(j){return j!=j}}).call(this)}).call(this,v("buffer").Buffer)},{"base64-js":1,buffer:3,ieee754:4}],4:[function(v,m,x){x.read=function(e,n,t,a,r){var d,s,i=8*r-a-1,u=(1<<i)-1,f=u>>1,c=-7,h=t?r-1:0,p=t?-1:1,o=e[n+h];for(h+=p,d=o&(1<<-c)-1,o>>=-c,c+=i;c>0;d=256*d+e[n+h],h+=p,c-=8);for(s=d&(1<<-c)-1,d>>=-c,c+=a;c>0;s=256*s+e[n+h],h+=p,c-=8);if(0===d)d=1-f;else{if(d===u)return s?NaN:1/0*(o?-1:1);s+=Math.pow(2,a),d-=f}return(o?-1:1)*s*Math.pow(2,d-a)},x.write=function(e,n,t,a,r,d){var s,i,u,f=8*d-r-1,c=(1<<f)-1,h=c>>1,p=23===r?Math.pow(2,-24)-Math.pow(2,-77):0,o=a?0:d-1,b=a?1:-1,l=n<0||0===n&&1/n<0?1:0;for(n=Math.abs(n),isNaN(n)||n===1/0?(i=isNaN(n)?1:0,s=c):(s=Math.floor(Math.log(n)/Math.LN2),n*(u=Math.pow(2,-s))<1&&(s--,u*=2),(n+=s+h>=1?p/u:p*Math.pow(2,1-h))*u>=2&&(s++,u/=2),s+h>=c?(i=0,s=c):s+h>=1?(i=(n*u-1)*Math.pow(2,r),s+=h):(i=n*Math.pow(2,h-1)*Math.pow(2,r),s=0));r>=8;e[t+o]=255&i,o+=b,i/=256,r-=8);for(s=s<<r|i,f+=r;f>0;e[t+o]=255&s,o+=b,s/=256,f-=8);e[t+o-b]|=128*l}},{}],5:[function(v,m,x){var e,n,t=m.exports={};function a(){throw new Error("setTimeout has not been defined")}function r(){throw new Error("clearTimeout has not been defined")}function d(b){if(e===setTimeout)return setTimeout(b,0);if((e===a||!e)&&setTimeout)return e=setTimeout,setTimeout(b,0);try{return e(b,0)}catch{try{return e.call(null,b,0)}catch{return e.call(this,b,0)}}}!function(){try{e="function"==typeof setTimeout?setTimeout:a}catch{e=a}try{n="function"==typeof clearTimeout?clearTimeout:r}catch{n=r}}();var s,i=[],u=!1,f=-1;function c(){u&&s&&(u=!1,s.length?i=s.concat(i):f=-1,i.length&&h())}function h(){if(!u){var b=d(c);u=!0;for(var l=i.length;l;){for(s=i,i=[];++f<l;)s&&s[f].run();f=-1,l=i.length}s=null,u=!1,function(T){if(n===clearTimeout)return clearTimeout(T);if((n===r||!n)&&clearTimeout)return n=clearTimeout,clearTimeout(T);try{n(T)}catch{try{return n.call(null,T)}catch{return n.call(this,T)}}}(b)}}function p(b,l){this.fun=b,this.array=l}function o(){}t.nextTick=function(b){var l=new Array(arguments.length-1);if(arguments.length>1)for(var T=1;T<arguments.length;T++)l[T-1]=arguments[T];i.push(new p(b,l)),1!==i.length||u||d(h)},p.prototype.run=function(){this.fun.apply(null,this.array)},t.title="browser",t.browser=!0,t.env={},t.argv=[],t.version="",t.versions={},t.on=o,t.addListener=o,t.once=o,t.off=o,t.removeListener=o,t.removeAllListeners=o,t.emit=o,t.prependListener=o,t.prependOnceListener=o,t.listeners=function(b){return[]},t.binding=function(b){throw new Error("process.binding is not supported")},t.cwd=function(){return"/"},t.chdir=function(b){throw new Error("process.chdir is not supported")},t.umask=function(){return 0}},{}],6:[function(v,m,x){m.exports={alpha_shape:v("alpha-shape"),convex_hull:v("convex-hull"),delaunay_triangulate:v("delaunay-triangulate"),gl_cone3d:v("gl-cone3d"),gl_error3d:v("gl-error3d"),gl_heatmap2d:v("gl-heatmap2d"),gl_line3d:v("gl-line3d"),gl_mesh3d:v("gl-mesh3d"),gl_plot2d:v("gl-plot2d"),gl_plot3d:v("gl-plot3d"),gl_pointcloud2d:v("gl-pointcloud2d"),gl_scatter3d:v("gl-scatter3d"),gl_select_box:v("gl-select-box"),gl_spikes2d:v("gl-spikes2d"),gl_streamtube3d:v("gl-streamtube3d"),gl_surface3d:v("gl-surface3d"),ndarray:v("ndarray"),ndarray_linear_interpolate:v("ndarray-linear-interpolate")}},{"alpha-shape":12,"convex-hull":58,"delaunay-triangulate":63,"gl-cone3d":79,"gl-error3d":84,"gl-heatmap2d":88,"gl-line3d":91,"gl-mesh3d":112,"gl-plot2d":118,"gl-plot3d":121,"gl-pointcloud2d":123,"gl-scatter3d":128,"gl-select-box":130,"gl-spikes2d":139,"gl-streamtube3d":143,"gl-surface3d":145,ndarray:259,"ndarray-linear-interpolate":253}],7:[function(v,m,x){"use strict";m.exports=function(d){var s=(d=d||{}).eye||[0,0,1],i=d.center||[0,0,0],u=d.up||[0,1,0],f=d.distanceLimits||[0,1/0],c=d.mode||"turntable",h=e(),p=n(),o=t();return h.setDistanceLimits(f[0],f[1]),h.lookAt(0,s,i,u),p.setDistanceLimits(f[0],f[1]),p.lookAt(0,s,i,u),o.setDistanceLimits(f[0],f[1]),o.lookAt(0,s,i,u),new a({turntable:h,orbit:p,matrix:o},c)};var e=v("turntable-camera-controller"),n=v("orbit-camera-controller"),t=v("matrix-camera-controller");function a(d,s){this._controllerNames=Object.keys(d),this._controllerList=this._controllerNames.map(function(i){return d[i]}),this._mode=s,this._active=d[s],this._active||(this._mode="turntable",this._active=d.turntable),this.modes=this._controllerNames,this.computedMatrix=this._active.computedMatrix,this.computedEye=this._active.computedEye,this.computedUp=this._active.computedUp,this.computedCenter=this._active.computedCenter,this.computedRadius=this._active.computedRadius}var r=a.prototype;r.flush=function(d){for(var s=this._controllerList,i=0;i<s.length;++i)s[i].flush(d)},r.idle=function(d){for(var s=this._controllerList,i=0;i<s.length;++i)s[i].idle(d)},r.lookAt=function(d,s,i,u){for(var f=this._controllerList,c=0;c<f.length;++c)f[c].lookAt(d,s,i,u)},r.rotate=function(d,s,i,u){for(var f=this._controllerList,c=0;c<f.length;++c)f[c].rotate(d,s,i,u)},r.pan=function(d,s,i,u){for(var f=this._controllerList,c=0;c<f.length;++c)f[c].pan(d,s,i,u)},r.translate=function(d,s,i,u){for(var f=this._controllerList,c=0;c<f.length;++c)f[c].translate(d,s,i,u)},r.setMatrix=function(d,s){for(var i=this._controllerList,u=0;u<i.length;++u)i[u].setMatrix(d,s)},r.setDistanceLimits=function(d,s){for(var i=this._controllerList,u=0;u<i.length;++u)i[u].setDistanceLimits(d,s)},r.setDistance=function(d,s){for(var i=this._controllerList,u=0;u<i.length;++u)i[u].setDistance(d,s)},r.recalcMatrix=function(d){this._active.recalcMatrix(d)},r.getDistance=function(d){return this._active.getDistance(d)},r.getDistanceLimits=function(d){return this._active.getDistanceLimits(d)},r.lastT=function(){return this._active.lastT()},r.setMode=function(d){if(d!==this._mode){var s=this._controllerNames.indexOf(d);if(!(s<0)){var i=this._active,u=this._controllerList[s],f=Math.max(i.lastT(),u.lastT());i.recalcMatrix(f),u.setMatrix(f,i.computedMatrix),this._active=u,this._mode=d,this.computedMatrix=this._active.computedMatrix,this.computedEye=this._active.computedEye,this.computedUp=this._active.computedUp,this.computedCenter=this._active.computedCenter,this.computedRadius=this._active.computedRadius}}},r.getMode=function(){return this._mode}},{"matrix-camera-controller":245,"orbit-camera-controller":263,"turntable-camera-controller":305}],8:[function(v,m,x){"use strict";var e=typeof WeakMap>"u"?v("weak-map"):WeakMap,n=v("gl-buffer"),t=v("gl-vao"),a=new e;m.exports=function(r){var d=a.get(r),s=d&&(d._triangleBuffer.handle||d._triangleBuffer.buffer);if(!s||!r.isBuffer(s)){var i=n(r,new Float32Array([-1,-1,-1,4,4,-1]));(d=t(r,[{buffer:i,type:r.FLOAT,size:2}]))._triangleBuffer=i,a.set(r,d)}d.bind(),r.drawArrays(r.TRIANGLES,0,3),d.unbind()}},{"gl-buffer":78,"gl-vao":150,"weak-map":313}],9:[function(v,m,x){var e=v("pad-left");m.exports=function(n,t,a){t="number"==typeof t?t:1,a=a||": ";var r=n.split(/\r?\n/),d=String(r.length+t-1).length;return r.map(function(s,i){var u=i+t,f=String(u).length;return e(u,d-f)+a+s}).join("\n")}},{"pad-left":264}],10:[function(v,m,x){"use strict";m.exports=function(t){var a=t.length;if(0===a)return[];if(1===a)return[0];for(var r=t[0].length,d=[t[0]],s=[0],i=1;i<a;++i)if(d.push(t[i]),n(d,r)){if(s.push(i),s.length===r+1)return s}else d.pop();return s};var e=v("robust-orientation");function n(t,a){for(var r=new Array(a+1),d=0;d<t.length;++d)r[d]=t[d];for(d=0;d<=t.length;++d){for(var s=t.length;s<=a;++s){for(var i=new Array(a),u=0;u<a;++u)i[u]=Math.pow(s+1-d,u);r[s]=i}if(e.apply(void 0,r))return!0}return!1}},{"robust-orientation":284}],11:[function(v,m,x){"use strict";m.exports=function(t,a){return e(a).filter(function(r){for(var d=new Array(r.length),s=0;s<r.length;++s)d[s]=a[r[s]];return n(d)*t<1})};var e=v("delaunay-triangulate"),n=v("circumradius")},{circumradius:49,"delaunay-triangulate":63}],12:[function(v,m,x){m.exports=function(t,a){return n(e(t,a))};var e=v("alpha-complex"),n=v("simplicial-complex-boundary")},{"alpha-complex":11,"simplicial-complex-boundary":290}],13:[function(v,m,x){m.exports=function(e){return atob(e)}},{}],14:[function(v,m,x){"use strict";m.exports=function(t,a){for(var r=a.length,d=new Array(r+1),s=0;s<r;++s){for(var i=new Array(r+1),u=0;u<=r;++u)i[u]=t[u][s];d[s]=i}for(d[r]=new Array(r+1),s=0;s<=r;++s)d[r][s]=1;var f=new Array(r+1);for(s=0;s<r;++s)f[s]=a[s];f[r]=1;var c=e(d,f),h=n(c[r+1]);0===h&&(h=1);var p=new Array(r+1);for(s=0;s<=r;++s)p[s]=n(c[s])/h;return p};var e=v("robust-linear-solve");function n(t){for(var a=0,r=0;r<t.length;++r)a+=t[r];return a}},{"robust-linear-solve":283}],15:[function(v,m,x){"use strict";var e=v("./lib/rationalize");m.exports=function(n,t){return e(n[0].mul(t[1]).add(t[0].mul(n[1])),n[1].mul(t[1]))}},{"./lib/rationalize":25}],16:[function(v,m,x){"use strict";m.exports=function(e,n){return e[0].mul(n[1]).cmp(n[0].mul(e[1]))}},{}],17:[function(v,m,x){"use strict";var e=v("./lib/rationalize");m.exports=function(n,t){return e(n[0].mul(t[1]),n[1].mul(t[0]))}},{"./lib/rationalize":25}],18:[function(v,m,x){"use strict";var e=v("./is-rat"),n=v("./lib/is-bn"),t=v("./lib/num-to-bn"),a=v("./lib/str-to-bn"),r=v("./lib/rationalize"),d=v("./div");m.exports=function s(i,u){if(e(i))return u?d(i,s(u)):[i[0].clone(),i[1].clone()];var f,c,h=0;if(n(i))f=i.clone();else if("string"==typeof i)f=a(i);else{if(0===i)return[t(0),t(1)];if(i===Math.floor(i))f=t(i);else{for(;i!==Math.floor(i);)i*=Math.pow(2,256),h-=256;f=t(i)}}if(e(u))f.mul(u[1]),c=u[0].clone();else if(n(u))c=u.clone();else if("string"==typeof u)c=a(u);else if(u)if(u===Math.floor(u))c=t(u);else{for(;u!==Math.floor(u);)u*=Math.pow(2,256),h+=256;c=t(u)}else c=t(1);return h>0?f=f.ushln(h):h<0&&(c=c.ushln(-h)),r(f,c)}},{"./div":17,"./is-rat":19,"./lib/is-bn":23,"./lib/num-to-bn":24,"./lib/rationalize":25,"./lib/str-to-bn":26}],19:[function(v,m,x){"use strict";var e=v("./lib/is-bn");m.exports=function(n){return Array.isArray(n)&&2===n.length&&e(n[0])&&e(n[1])}},{"./lib/is-bn":23}],20:[function(v,m,x){"use strict";var e=v("bn.js");m.exports=function(n){return n.cmp(new e(0))}},{"bn.js":33}],21:[function(v,m,x){"use strict";var e=v("./bn-sign");m.exports=function(n){var t=n.length,a=n.words,r=0;if(1===t)r=a[0];else if(2===t)r=a[0]+67108864*a[1];else for(var d=0;d<t;d++)r+=a[d]*Math.pow(67108864,d);return e(n)*r}},{"./bn-sign":20}],22:[function(v,m,x){"use strict";var e=v("double-bits"),n=v("bit-twiddle").countTrailingZeros;m.exports=function(t){var a=n(e.lo(t));if(a<32)return a;var r=n(e.hi(t));return r>20?52:r+32}},{"bit-twiddle":32,"double-bits":64}],23:[function(v,m,x){"use strict";v("bn.js"),m.exports=function(e){return e&&"object"==typeof e&&Boolean(e.words)}},{"bn.js":33}],24:[function(v,m,x){"use strict";var e=v("bn.js"),n=v("double-bits");m.exports=function(t){var a=n.exponent(t);return a<52?new e(t):new e(t*Math.pow(2,52-a)).ushln(a-52)}},{"bn.js":33,"double-bits":64}],25:[function(v,m,x){"use strict";var e=v("./num-to-bn"),n=v("./bn-sign");m.exports=function(t,a){var r=n(t),d=n(a);if(0===r)return[e(0),e(1)];if(0===d)return[e(0),e(0)];d<0&&(t=t.neg(),a=a.neg());var s=t.gcd(a);return s.cmpn(1)?[t.div(s),a.div(s)]:[t,a]}},{"./bn-sign":20,"./num-to-bn":24}],26:[function(v,m,x){"use strict";var e=v("bn.js");m.exports=function(n){return new e(n)}},{"bn.js":33}],27:[function(v,m,x){"use strict";var e=v("./lib/rationalize");m.exports=function(n,t){return e(n[0].mul(t[0]),n[1].mul(t[1]))}},{"./lib/rationalize":25}],28:[function(v,m,x){"use strict";var e=v("./lib/bn-sign");m.exports=function(n){return e(n[0])*e(n[1])}},{"./lib/bn-sign":20}],29:[function(v,m,x){"use strict";var e=v("./lib/rationalize");m.exports=function(n,t){return e(n[0].mul(t[1]).sub(n[1].mul(t[0])),n[1].mul(t[1]))}},{"./lib/rationalize":25}],30:[function(v,m,x){"use strict";var e=v("./lib/bn-to-num"),n=v("./lib/ctz");m.exports=function(t){var a=t[0],r=t[1];if(0===a.cmpn(0))return 0;var d=a.abs().divmod(r.abs()),i=e(d.div),u=d.mod,f=a.negative!==r.negative?-1:1;if(0===u.cmpn(0))return f*i;if(i){var c=n(i)+4,h=e(u.ushln(c).divRound(r));return f*(i+h*Math.pow(2,-c))}var p=r.bitLength()-u.bitLength()+53;return h=e(u.ushln(p).divRound(r)),p<1023?f*h*Math.pow(2,-p):f*(h*=Math.pow(2,-1023))*Math.pow(2,1023-p)}},{"./lib/bn-to-num":21,"./lib/ctz":22}],31:[function(v,m,x){"use strict";function e(s,i,u,f,c){for(var h=c+1;f<=c;){var p=f+c>>>1,o=s[p];(void 0!==u?u(o,i):o-i)>=0?(h=p,c=p-1):f=p+1}return h}function n(s,i,u,f,c){for(var h=c+1;f<=c;){var p=f+c>>>1,o=s[p];(void 0!==u?u(o,i):o-i)>0?(h=p,c=p-1):f=p+1}return h}function t(s,i,u,f,c){for(var h=f-1;f<=c;){var p=f+c>>>1,o=s[p];(void 0!==u?u(o,i):o-i)<0?(h=p,f=p+1):c=p-1}return h}function a(s,i,u,f,c){for(var h=f-1;f<=c;){var p=f+c>>>1,o=s[p];(void 0!==u?u(o,i):o-i)<=0?(h=p,f=p+1):c=p-1}return h}function r(s,i,u,f,c){for(;f<=c;){var h=f+c>>>1,p=s[h],o=void 0!==u?u(p,i):p-i;if(0===o)return h;o<=0?f=h+1:c=h-1}return-1}function d(s,i,u,f,c,h){return"function"==typeof u?h(s,i,u,void 0===f?0:0|f,void 0===c?s.length-1:0|c):h(s,i,void 0,void 0===u?0:0|u,void 0===f?s.length-1:0|f)}m.exports={ge:function(s,i,u,f,c){return d(s,i,u,f,c,e)},gt:function(s,i,u,f,c){return d(s,i,u,f,c,n)},lt:function(s,i,u,f,c){return d(s,i,u,f,c,t)},le:function(s,i,u,f,c){return d(s,i,u,f,c,a)},eq:function(s,i,u,f,c){return d(s,i,u,f,c,r)}}},{}],32:[function(v,m,x){"use strict";function e(t){var a=32;return(t&=-t)&&a--,65535&t&&(a-=16),16711935&t&&(a-=8),252645135&t&&(a-=4),858993459&t&&(a-=2),1431655765&t&&(a-=1),a}x.INT_BITS=32,x.INT_MAX=2147483647,x.INT_MIN=-1<<31,x.sign=function(t){return(t>0)-(t<0)},x.abs=function(t){var a=t>>31;return(t^a)-a},x.min=function(t,a){return a^(t^a)&-(t<a)},x.max=function(t,a){return t^(t^a)&-(t<a)},x.isPow2=function(t){return!(t&t-1||!t)},x.log2=function(t){var a,r;return a=(t>65535)<<4,a|=r=((t>>>=a)>255)<<3,a|=r=((t>>>=r)>15)<<2,(a|=r=((t>>>=r)>3)<<1)|(t>>>=r)>>1},x.log10=function(t){return t>=1e9?9:t>=1e8?8:t>=1e7?7:t>=1e6?6:t>=1e5?5:t>=1e4?4:t>=1e3?3:t>=100?2:t>=10?1:0},x.popCount=function(t){return 16843009*((t=(858993459&(t-=t>>>1&1431655765))+(t>>>2&858993459))+(t>>>4)&252645135)>>>24},x.countTrailingZeros=e,x.nextPow2=function(t){return t+=0===t,--t,t|=t>>>1,t|=t>>>2,t|=t>>>4,1+((t|=t>>>8)|t>>>16)},x.prevPow2=function(t){return t|=t>>>1,t|=t>>>2,t|=t>>>4,t|=t>>>8,(t|=t>>>16)-(t>>>1)},x.parity=function(t){return t^=t>>>16,t^=t>>>8,t^=t>>>4,27030>>>(t&=15)&1};var n=new Array(256);(function(t){for(var a=0;a<256;++a){var r=a,d=a,s=7;for(r>>>=1;r;r>>>=1)d<<=1,d|=1&r,--s;t[a]=d<<s&255}})(n),x.reverse=function(t){return n[255&t]<<24|n[t>>>8&255]<<16|n[t>>>16&255]<<8|n[t>>>24&255]},x.interleave2=function(t,a){return(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t&=65535)|t<<8))|t<<4))|t<<2))|t<<1))|(a=1431655765&((a=858993459&((a=252645135&((a=16711935&((a&=65535)|a<<8))|a<<4))|a<<2))|a<<1))<<1},x.deinterleave2=function(t,a){return(t=65535&((t=16711935&((t=252645135&((t=858993459&((t=t>>>a&1431655765)|t>>>1))|t>>>2))|t>>>4))|t>>>16))<<16>>16},x.interleave3=function(t,a,r){return t=1227133513&((t=3272356035&((t=251719695&((t=4278190335&((t&=1023)|t<<16))|t<<8))|t<<4))|t<<2),(t|=(a=1227133513&((a=3272356035&((a=251719695&((a=4278190335&((a&=1023)|a<<16))|a<<8))|a<<4))|a<<2))<<1)|(r=1227133513&((r=3272356035&((r=251719695&((r=4278190335&((r&=1023)|r<<16))|r<<8))|r<<4))|r<<2))<<2},x.deinterleave3=function(t,a){return(t=1023&((t=4278190335&((t=251719695&((t=3272356035&((t=t>>>a&1227133513)|t>>>2))|t>>>4))|t>>>8))|t>>>16))<<22>>22},x.nextCombination=function(t){var a=t|t-1;return a+1|(~a&-~a)-1>>>e(t)+1}},{}],33:[function(v,m,x){!function(e,n){"use strict";function t(S,E){if(!S)throw new Error(E||"Assertion failed")}function a(S,E){S.super_=E;var z=function(){};z.prototype=E.prototype,S.prototype=new z,S.prototype.constructor=S}function r(S,E,z){if(r.isBN(S))return S;this.negative=0,this.words=null,this.length=0,this.red=null,null!==S&&("le"!==E&&"be"!==E||(z=E,E=10),this._init(S||0,E||10,z||"be"))}var d;"object"==typeof e?e.exports=r:n.BN=r,r.BN=r,r.wordSize=26;try{d=typeof window<"u"&&void 0!==window.Buffer?window.Buffer:v("buffer").Buffer}catch{}function s(S,E){var z=S.charCodeAt(E);return z>=65&&z<=70?z-55:z>=97&&z<=102?z-87:z-48&15}function i(S,E,z){var R=s(S,z);return z-1>=E&&(R|=s(S,z-1)<<4),R}function u(S,E,z,R){for(var q=0,V=Math.min(S.length,z),W=E;W<V;W++){var K=S.charCodeAt(W)-48;q*=R,q+=K>=49?K-49+10:K>=17?K-17+10:K}return q}r.isBN=function(S){return S instanceof r||null!==S&&"object"==typeof S&&S.constructor.wordSize===r.wordSize&&Array.isArray(S.words)},r.max=function(S,E){return S.cmp(E)>0?S:E},r.min=function(S,E){return S.cmp(E)<0?S:E},r.prototype._init=function(S,E,z){if("number"==typeof S)return this._initNumber(S,E,z);if("object"==typeof S)return this._initArray(S,E,z);"hex"===E&&(E=16),t(E===(0|E)&&E>=2&&E<=36);var R=0;"-"===(S=S.toString().replace(/\s+/g,""))[0]&&(R++,this.negative=1),R<S.length&&(16===E?this._parseHex(S,R,z):(this._parseBase(S,E,R),"le"===z&&this._initArray(this.toArray(),E,z)))},r.prototype._initNumber=function(S,E,z){S<0&&(this.negative=1,S=-S),S<67108864?(this.words=[67108863&S],this.length=1):S<4503599627370496?(this.words=[67108863&S,S/67108864&67108863],this.length=2):(t(S<9007199254740992),this.words=[67108863&S,S/67108864&67108863,1],this.length=3),"le"===z&&this._initArray(this.toArray(),E,z)},r.prototype._initArray=function(S,E,z){if(t("number"==typeof S.length),S.length<=0)return this.words=[0],this.length=1,this;this.length=Math.ceil(S.length/3),this.words=new Array(this.length);for(var R=0;R<this.length;R++)this.words[R]=0;var q,V,W=0;if("be"===z)for(R=S.length-1,q=0;R>=0;R-=3)this.words[q]|=(V=S[R]|S[R-1]<<8|S[R-2]<<16)<<W&67108863,this.words[q+1]=V>>>26-W&67108863,(W+=24)>=26&&(W-=26,q++);else if("le"===z)for(R=0,q=0;R<S.length;R+=3)this.words[q]|=(V=S[R]|S[R+1]<<8|S[R+2]<<16)<<W&67108863,this.words[q+1]=V>>>26-W&67108863,(W+=24)>=26&&(W-=26,q++);return this.strip()},r.prototype._parseHex=function(S,E,z){this.length=Math.ceil((S.length-E)/6),this.words=new Array(this.length);for(var R=0;R<this.length;R++)this.words[R]=0;var q,V=0,W=0;if("be"===z)for(R=S.length-1;R>=E;R-=2)q=i(S,E,R)<<V,this.words[W]|=67108863&q,V>=18?(V-=18,this.words[W+=1]|=q>>>26):V+=8;else for(R=(S.length-E)%2==0?E+1:E;R<S.length;R+=2)q=i(S,E,R)<<V,this.words[W]|=67108863&q,V>=18?(V-=18,this.words[W+=1]|=q>>>26):V+=8;this.strip()},r.prototype._parseBase=function(S,E,z){this.words=[0],this.length=1;for(var R=0,q=1;q<=67108863;q*=E)R++;R--,q=q/E|0;for(var V=S.length-z,W=V%R,K=Math.min(V,V-W)+z,G=0,Y=z;Y<K;Y+=R)G=u(S,Y,Y+R,E),this.imuln(q),this.words[0]+G<67108864?this.words[0]+=G:this._iaddn(G);if(0!==W){var $=1;for(G=u(S,Y,S.length,E),Y=0;Y<W;Y++)$*=E;this.imuln($),this.words[0]+G<67108864?this.words[0]+=G:this._iaddn(G)}this.strip()},r.prototype.copy=function(S){S.words=new Array(this.length);for(var E=0;E<this.length;E++)S.words[E]=this.words[E];S.length=this.length,S.negative=this.negative,S.red=this.red},r.prototype.clone=function(){var S=new r(null);return this.copy(S),S},r.prototype._expand=function(S){for(;this.length<S;)this.words[this.length++]=0;return this},r.prototype.strip=function(){for(;this.length>1&&0===this.words[this.length-1];)this.length--;return this._normSign()},r.prototype._normSign=function(){return 1===this.length&&0===this.words[0]&&(this.negative=0),this},r.prototype.inspect=function(){return(this.red?"<BN-R: ":"<BN: ")+this.toString(16)+">"};var f=["","0","00","000","0000","00000","000000","0000000","00000000","000000000","0000000000","00000000000","000000000000","0000000000000","00000000000000","000000000000000","0000000000000000","00000000000000000","000000000000000000","0000000000000000000","00000000000000000000","000000000000000000000","0000000000000000000000","00000000000000000000000","000000000000000000000000","0000000000000000000000000"],c=[0,0,25,16,12,11,10,9,8,8,7,7,7,7,6,6,6,6,6,6,6,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5],h=[0,0,33554432,43046721,16777216,48828125,60466176,40353607,16777216,43046721,1e7,19487171,35831808,62748517,7529536,11390625,16777216,24137569,34012224,47045881,64e6,4084101,5153632,6436343,7962624,9765625,11881376,14348907,17210368,20511149,243e5,28629151,33554432,39135393,45435424,52521875,60466176];function p(S,E,z){z.negative=E.negative^S.negative;var R=S.length+E.length|0;z.length=R,R=R-1|0;var q=0|S.words[0],V=0|E.words[0],W=q*V,G=W/67108864|0;z.words[0]=67108863&W;for(var Y=1;Y<R;Y++){for(var $=G>>>26,B=67108863&G,N=Math.min(Y,E.length-1),U=Math.max(0,Y-S.length+1);U<=N;U++)$+=(W=(q=0|S.words[Y-U|0])*(V=0|E.words[U])+B)/67108864|0,B=67108863&W;z.words[Y]=0|B,G=0|$}return 0!==G?z.words[Y]=0|G:z.length--,z.strip()}r.prototype.toString=function(S,E){var z;if(E=0|E||1,16===(S=S||10)||"hex"===S){z="";for(var R=0,q=0,V=0;V<this.length;V++){var W=this.words[V],K=(16777215&(W<<R|q)).toString(16);z=0!=(q=W>>>24-R&16777215)||V!==this.length-1?f[6-K.length]+K+z:K+z,(R+=2)>=26&&(R-=26,V--)}for(0!==q&&(z=q.toString(16)+z);z.length%E!=0;)z="0"+z;return 0!==this.negative&&(z="-"+z),z}if(S===(0|S)&&S>=2&&S<=36){var G=c[S],Y=h[S];z="";var $=this.clone();for($.negative=0;!$.isZero();){var B=$.modn(Y).toString(S);z=($=$.idivn(Y)).isZero()?B+z:f[G-B.length]+B+z}for(this.isZero()&&(z="0"+z);z.length%E!=0;)z="0"+z;return 0!==this.negative&&(z="-"+z),z}t(!1,"Base should be between 2 and 36")},r.prototype.toNumber=function(){var S=this.words[0];return 2===this.length?S+=67108864*this.words[1]:3===this.length&&1===this.words[2]?S+=4503599627370496+67108864*this.words[1]:this.length>2&&t(!1,"Number can only safely store up to 53 bits"),0!==this.negative?-S:S},r.prototype.toJSON=function(){return this.toString(16)},r.prototype.toBuffer=function(S,E){return t(void 0!==d),this.toArrayLike(d,S,E)},r.prototype.toArray=function(S,E){return this.toArrayLike(Array,S,E)},r.prototype.toArrayLike=function(S,E,z){var R=this.byteLength(),q=z||Math.max(1,R);t(R<=q,"byte array longer than desired length"),t(q>0,"Requested array length <= 0"),this.strip();var V,W,K="le"===E,G=new S(q),Y=this.clone();if(K){for(W=0;!Y.isZero();W++)V=Y.andln(255),Y.iushrn(8),G[W]=V;for(;W<q;W++)G[W]=0}else{for(W=0;W<q-R;W++)G[W]=0;for(W=0;!Y.isZero();W++)V=Y.andln(255),Y.iushrn(8),G[q-W-1]=V}return G},r.prototype._countBits=Math.clz32?function(S){return 32-Math.clz32(S)}:function(S){var E=S,z=0;return E>=4096&&(z+=13,E>>>=13),E>=64&&(z+=7,E>>>=7),E>=8&&(z+=4,E>>>=4),E>=2&&(z+=2,E>>>=2),z+E},r.prototype._zeroBits=function(S){if(0===S)return 26;var E=S,z=0;return 0==(8191&E)&&(z+=13,E>>>=13),0==(127&E)&&(z+=7,E>>>=7),0==(15&E)&&(z+=4,E>>>=4),0==(3&E)&&(z+=2,E>>>=2),0==(1&E)&&z++,z},r.prototype.bitLength=function(){var E=this._countBits(this.words[this.length-1]);return 26*(this.length-1)+E},r.prototype.zeroBits=function(){if(this.isZero())return 0;for(var S=0,E=0;E<this.length;E++){var z=this._zeroBits(this.words[E]);if(S+=z,26!==z)break}return S},r.prototype.byteLength=function(){return Math.ceil(this.bitLength()/8)},r.prototype.toTwos=function(S){return 0!==this.negative?this.abs().inotn(S).iaddn(1):this.clone()},r.prototype.fromTwos=function(S){return this.testn(S-1)?this.notn(S).iaddn(1).ineg():this.clone()},r.prototype.isNeg=function(){return 0!==this.negative},r.prototype.neg=function(){return this.clone().ineg()},r.prototype.ineg=function(){return this.isZero()||(this.negative^=1),this},r.prototype.iuor=function(S){for(;this.length<S.length;)this.words[this.length++]=0;for(var E=0;E<S.length;E++)this.words[E]=this.words[E]|S.words[E];return this.strip()},r.prototype.ior=function(S){return t(0==(this.negative|S.negative)),this.iuor(S)},r.prototype.or=function(S){return this.length>S.length?this.clone().ior(S):S.clone().ior(this)},r.prototype.uor=function(S){return this.length>S.length?this.clone().iuor(S):S.clone().iuor(this)},r.prototype.iuand=function(S){var E;E=this.length>S.length?S:this;for(var z=0;z<E.length;z++)this.words[z]=this.words[z]&S.words[z];return this.length=E.length,this.strip()},r.prototype.iand=function(S){return t(0==(this.negative|S.negative)),this.iuand(S)},r.prototype.and=function(S){return this.length>S.length?this.clone().iand(S):S.clone().iand(this)},r.prototype.uand=function(S){return this.length>S.length?this.clone().iuand(S):S.clone().iuand(this)},r.prototype.iuxor=function(S){var E,z;this.length>S.length?(E=this,z=S):(E=S,z=this);for(var R=0;R<z.length;R++)this.words[R]=E.words[R]^z.words[R];if(this!==E)for(;R<E.length;R++)this.words[R]=E.words[R];return this.length=E.length,this.strip()},r.prototype.ixor=function(S){return t(0==(this.negative|S.negative)),this.iuxor(S)},r.prototype.xor=function(S){return this.length>S.length?this.clone().ixor(S):S.clone().ixor(this)},r.prototype.uxor=function(S){return this.length>S.length?this.clone().iuxor(S):S.clone().iuxor(this)},r.prototype.inotn=function(S){t("number"==typeof S&&S>=0);var E=0|Math.ceil(S/26),z=S%26;this._expand(E),z>0&&E--;for(var R=0;R<E;R++)this.words[R]=67108863&~this.words[R];return z>0&&(this.words[R]=~this.words[R]&67108863>>26-z),this.strip()},r.prototype.notn=function(S){return this.clone().inotn(S)},r.prototype.setn=function(S,E){t("number"==typeof S&&S>=0);var z=S/26|0,R=S%26;return this._expand(z+1),this.words[z]=E?this.words[z]|1<<R:this.words[z]&~(1<<R),this.strip()},r.prototype.iadd=function(S){var E,z,R;if(0!==this.negative&&0===S.negative)return this.negative=0,E=this.isub(S),this.negative^=1,this._normSign();if(0===this.negative&&0!==S.negative)return S.negative=0,E=this.isub(S),S.negative=1,E._normSign();this.length>S.length?(z=this,R=S):(z=S,R=this);for(var q=0,V=0;V<R.length;V++)this.words[V]=67108863&(E=(0|z.words[V])+(0|R.words[V])+q),q=E>>>26;for(;0!==q&&V<z.length;V++)this.words[V]=67108863&(E=(0|z.words[V])+q),q=E>>>26;if(this.length=z.length,0!==q)this.words[this.length]=q,this.length++;else if(z!==this)for(;V<z.length;V++)this.words[V]=z.words[V];return this},r.prototype.add=function(S){var E;return 0!==S.negative&&0===this.negative?(S.negative=0,E=this.sub(S),S.negative^=1,E):0===S.negative&&0!==this.negative?(this.negative=0,E=S.sub(this),this.negative=1,E):this.length>S.length?this.clone().iadd(S):S.clone().iadd(this)},r.prototype.isub=function(S){if(0!==S.negative){S.negative=0;var E=this.iadd(S);return S.negative=1,E._normSign()}if(0!==this.negative)return this.negative=0,this.iadd(S),this.negative=1,this._normSign();var z,R,q=this.cmp(S);if(0===q)return this.negative=0,this.length=1,this.words[0]=0,this;q>0?(z=this,R=S):(z=S,R=this);for(var V=0,W=0;W<R.length;W++)V=(E=(0|z.words[W])-(0|R.words[W])+V)>>26,this.words[W]=67108863&E;for(;0!==V&&W<z.length;W++)V=(E=(0|z.words[W])+V)>>26,this.words[W]=67108863&E;if(0===V&&W<z.length&&z!==this)for(;W<z.length;W++)this.words[W]=z.words[W];return this.length=Math.max(this.length,W),z!==this&&(this.negative=1),this.strip()},r.prototype.sub=function(S){return this.clone().isub(S)};var o=function(S,E,z){var R,q,V,W=S.words,K=E.words,G=z.words,Y=0,$=0|W[0],B=8191&$,N=$>>>13,U=0|W[1],te=8191&U,j=U>>>13,J=0|W[2],X=8191&J,re=J>>>13,ne=0|W[3],le=8191&ne,oe=ne>>>13,de=0|W[4],se=8191&de,ge=de>>>13,_e=0|W[5],Te=8191&_e,we=_e>>>13,Oe=0|W[6],fe=8191&Oe,ve=Oe>>>13,Ae=0|W[7],ke=8191&Ae,Pe=Ae>>>13,Ne=0|W[8],De=8191&Ne,ze=Ne>>>13,Me=0|W[9],Se=8191&Me,Ie=Me>>>13,Fe=0|K[0],Re=8191&Fe,Xe=Fe>>>13,nt=0|K[1],ct=8191&nt,xt=nt>>>13,dt=0|K[2],tt=8191&dt,Ke=dt>>>13,mt=0|K[3],Bt=8191&mt,Ut=mt>>>13,er=0|K[4],Wt=8191&er,rr=er>>>13,Ht=0|K[5],Ve=8191&Ht,We=Ht>>>13,he=0|K[6],ye=8191&he,Be=he>>>13,Ge=0|K[7],Je=8191&Ge,He=Ge>>>13,st=0|K[8],ot=8191&st,wt=st>>>13,Ct=0|K[9],rt=8191&Ct,ft=Ct>>>13;z.negative=S.negative^E.negative,z.length=19;var Rt=(Y+(R=Math.imul(B,Re))|0)+((8191&(q=(q=Math.imul(B,Xe))+Math.imul(N,Re)|0))<<13)|0;Y=((V=Math.imul(N,Xe))+(q>>>13)|0)+(Rt>>>26)|0,Rt&=67108863,R=Math.imul(te,Re),q=(q=Math.imul(te,Xe))+Math.imul(j,Re)|0,V=Math.imul(j,Xe);var kt=(Y+(R=R+Math.imul(B,ct)|0)|0)+((8191&(q=(q=q+Math.imul(B,xt)|0)+Math.imul(N,ct)|0))<<13)|0;Y=((V=V+Math.imul(N,xt)|0)+(q>>>13)|0)+(kt>>>26)|0,kt&=67108863,R=Math.imul(X,Re),q=(q=Math.imul(X,Xe))+Math.imul(re,Re)|0,V=Math.imul(re,Xe),R=R+Math.imul(te,ct)|0,q=(q=q+Math.imul(te,xt)|0)+Math.imul(j,ct)|0,V=V+Math.imul(j,xt)|0;var Lt=(Y+(R=R+Math.imul(B,tt)|0)|0)+((8191&(q=(q=q+Math.imul(B,Ke)|0)+Math.imul(N,tt)|0))<<13)|0;Y=((V=V+Math.imul(N,Ke)|0)+(q>>>13)|0)+(Lt>>>26)|0,Lt&=67108863,R=Math.imul(le,Re),q=(q=Math.imul(le,Xe))+Math.imul(oe,Re)|0,V=Math.imul(oe,Xe),R=R+Math.imul(X,ct)|0,q=(q=q+Math.imul(X,xt)|0)+Math.imul(re,ct)|0,V=V+Math.imul(re,xt)|0,R=R+Math.imul(te,tt)|0,q=(q=q+Math.imul(te,Ke)|0)+Math.imul(j,tt)|0,V=V+Math.imul(j,Ke)|0;var Ee=(Y+(R=R+Math.imul(B,Bt)|0)|0)+((8191&(q=(q=q+Math.imul(B,Ut)|0)+Math.imul(N,Bt)|0))<<13)|0;Y=((V=V+Math.imul(N,Ut)|0)+(q>>>13)|0)+(Ee>>>26)|0,Ee&=67108863,R=Math.imul(se,Re),q=(q=Math.imul(se,Xe))+Math.imul(ge,Re)|0,V=Math.imul(ge,Xe),R=R+Math.imul(le,ct)|0,q=(q=q+Math.imul(le,xt)|0)+Math.imul(oe,ct)|0,V=V+Math.imul(oe,xt)|0,R=R+Math.imul(X,tt)|0,q=(q=q+Math.imul(X,Ke)|0)+Math.imul(re,tt)|0,V=V+Math.imul(re,Ke)|0,R=R+Math.imul(te,Bt)|0,q=(q=q+Math.imul(te,Ut)|0)+Math.imul(j,Bt)|0,V=V+Math.imul(j,Ut)|0;var Ye=(Y+(R=R+Math.imul(B,Wt)|0)|0)+((8191&(q=(q=q+Math.imul(B,rr)|0)+Math.imul(N,Wt)|0))<<13)|0;Y=((V=V+Math.imul(N,rr)|0)+(q>>>13)|0)+(Ye>>>26)|0,Ye&=67108863,R=Math.imul(Te,Re),q=(q=Math.imul(Te,Xe))+Math.imul(we,Re)|0,V=Math.imul(we,Xe),R=R+Math.imul(se,ct)|0,q=(q=q+Math.imul(se,xt)|0)+Math.imul(ge,ct)|0,V=V+Math.imul(ge,xt)|0,R=R+Math.imul(le,tt)|0,q=(q=q+Math.imul(le,Ke)|0)+Math.imul(oe,tt)|0,V=V+Math.imul(oe,Ke)|0,R=R+Math.imul(X,Bt)|0,q=(q=q+Math.imul(X,Ut)|0)+Math.imul(re,Bt)|0,V=V+Math.imul(re,Ut)|0,R=R+Math.imul(te,Wt)|0,q=(q=q+Math.imul(te,rr)|0)+Math.imul(j,Wt)|0,V=V+Math.imul(j,rr)|0;var it=(Y+(R=R+Math.imul(B,Ve)|0)|0)+((8191&(q=(q=q+Math.imul(B,We)|0)+Math.imul(N,Ve)|0))<<13)|0;Y=((V=V+Math.imul(N,We)|0)+(q>>>13)|0)+(it>>>26)|0,it&=67108863,R=Math.imul(fe,Re),q=(q=Math.imul(fe,Xe))+Math.imul(ve,Re)|0,V=Math.imul(ve,Xe),R=R+Math.imul(Te,ct)|0,q=(q=q+Math.imul(Te,xt)|0)+Math.imul(we,ct)|0,V=V+Math.imul(we,xt)|0,R=R+Math.imul(se,tt)|0,q=(q=q+Math.imul(se,Ke)|0)+Math.imul(ge,tt)|0,V=V+Math.imul(ge,Ke)|0,R=R+Math.imul(le,Bt)|0,q=(q=q+Math.imul(le,Ut)|0)+Math.imul(oe,Bt)|0,V=V+Math.imul(oe,Ut)|0,R=R+Math.imul(X,Wt)|0,q=(q=q+Math.imul(X,rr)|0)+Math.imul(re,Wt)|0,V=V+Math.imul(re,rr)|0,R=R+Math.imul(te,Ve)|0,q=(q=q+Math.imul(te,We)|0)+Math.imul(j,Ve)|0,V=V+Math.imul(j,We)|0;var ht=(Y+(R=R+Math.imul(B,ye)|0)|0)+((8191&(q=(q=q+Math.imul(B,Be)|0)+Math.imul(N,ye)|0))<<13)|0;Y=((V=V+Math.imul(N,Be)|0)+(q>>>13)|0)+(ht>>>26)|0,ht&=67108863,R=Math.imul(ke,Re),q=(q=Math.imul(ke,Xe))+Math.imul(Pe,Re)|0,V=Math.imul(Pe,Xe),R=R+Math.imul(fe,ct)|0,q=(q=q+Math.imul(fe,xt)|0)+Math.imul(ve,ct)|0,V=V+Math.imul(ve,xt)|0,R=R+Math.imul(Te,tt)|0,q=(q=q+Math.imul(Te,Ke)|0)+Math.imul(we,tt)|0,V=V+Math.imul(we,Ke)|0,R=R+Math.imul(se,Bt)|0,q=(q=q+Math.imul(se,Ut)|0)+Math.imul(ge,Bt)|0,V=V+Math.imul(ge,Ut)|0,R=R+Math.imul(le,Wt)|0,q=(q=q+Math.imul(le,rr)|0)+Math.imul(oe,Wt)|0,V=V+Math.imul(oe,rr)|0,R=R+Math.imul(X,Ve)|0,q=(q=q+Math.imul(X,We)|0)+Math.imul(re,Ve)|0,V=V+Math.imul(re,We)|0,R=R+Math.imul(te,ye)|0,q=(q=q+Math.imul(te,Be)|0)+Math.imul(j,ye)|0,V=V+Math.imul(j,Be)|0;var At=(Y+(R=R+Math.imul(B,Je)|0)|0)+((8191&(q=(q=q+Math.imul(B,He)|0)+Math.imul(N,Je)|0))<<13)|0;Y=((V=V+Math.imul(N,He)|0)+(q>>>13)|0)+(At>>>26)|0,At&=67108863,R=Math.imul(De,Re),q=(q=Math.imul(De,Xe))+Math.imul(ze,Re)|0,V=Math.imul(ze,Xe),R=R+Math.imul(ke,ct)|0,q=(q=q+Math.imul(ke,xt)|0)+Math.imul(Pe,ct)|0,V=V+Math.imul(Pe,xt)|0,R=R+Math.imul(fe,tt)|0,q=(q=q+Math.imul(fe,Ke)|0)+Math.imul(ve,tt)|0,V=V+Math.imul(ve,Ke)|0,R=R+Math.imul(Te,Bt)|0,q=(q=q+Math.imul(Te,Ut)|0)+Math.imul(we,Bt)|0,V=V+Math.imul(we,Ut)|0,R=R+Math.imul(se,Wt)|0,q=(q=q+Math.imul(se,rr)|0)+Math.imul(ge,Wt)|0,V=V+Math.imul(ge,rr)|0,R=R+Math.imul(le,Ve)|0,q=(q=q+Math.imul(le,We)|0)+Math.imul(oe,Ve)|0,V=V+Math.imul(oe,We)|0,R=R+Math.imul(X,ye)|0,q=(q=q+Math.imul(X,Be)|0)+Math.imul(re,ye)|0,V=V+Math.imul(re,Be)|0,R=R+Math.imul(te,Je)|0,q=(q=q+Math.imul(te,He)|0)+Math.imul(j,Je)|0,V=V+Math.imul(j,He)|0;var Ft=(Y+(R=R+Math.imul(B,ot)|0)|0)+((8191&(q=(q=q+Math.imul(B,wt)|0)+Math.imul(N,ot)|0))<<13)|0;Y=((V=V+Math.imul(N,wt)|0)+(q>>>13)|0)+(Ft>>>26)|0,Ft&=67108863,R=Math.imul(Se,Re),q=(q=Math.imul(Se,Xe))+Math.imul(Ie,Re)|0,V=Math.imul(Ie,Xe),R=R+Math.imul(De,ct)|0,q=(q=q+Math.imul(De,xt)|0)+Math.imul(ze,ct)|0,V=V+Math.imul(ze,xt)|0,R=R+Math.imul(ke,tt)|0,q=(q=q+Math.imul(ke,Ke)|0)+Math.imul(Pe,tt)|0,V=V+Math.imul(Pe,Ke)|0,R=R+Math.imul(fe,Bt)|0,q=(q=q+Math.imul(fe,Ut)|0)+Math.imul(ve,Bt)|0,V=V+Math.imul(ve,Ut)|0,R=R+Math.imul(Te,Wt)|0,q=(q=q+Math.imul(Te,rr)|0)+Math.imul(we,Wt)|0,V=V+Math.imul(we,rr)|0,R=R+Math.imul(se,Ve)|0,q=(q=q+Math.imul(se,We)|0)+Math.imul(ge,Ve)|0,V=V+Math.imul(ge,We)|0,R=R+Math.imul(le,ye)|0,q=(q=q+Math.imul(le,Be)|0)+Math.imul(oe,ye)|0,V=V+Math.imul(oe,Be)|0,R=R+Math.imul(X,Je)|0,q=(q=q+Math.imul(X,He)|0)+Math.imul(re,Je)|0,V=V+Math.imul(re,He)|0,R=R+Math.imul(te,ot)|0,q=(q=q+Math.imul(te,wt)|0)+Math.imul(j,ot)|0,V=V+Math.imul(j,wt)|0;var Gt=(Y+(R=R+Math.imul(B,rt)|0)|0)+((8191&(q=(q=q+Math.imul(B,ft)|0)+Math.imul(N,rt)|0))<<13)|0;Y=((V=V+Math.imul(N,ft)|0)+(q>>>13)|0)+(Gt>>>26)|0,Gt&=67108863,R=Math.imul(Se,ct),q=(q=Math.imul(Se,xt))+Math.imul(Ie,ct)|0,V=Math.imul(Ie,xt),R=R+Math.imul(De,tt)|0,q=(q=q+Math.imul(De,Ke)|0)+Math.imul(ze,tt)|0,V=V+Math.imul(ze,Ke)|0,R=R+Math.imul(ke,Bt)|0,q=(q=q+Math.imul(ke,Ut)|0)+Math.imul(Pe,Bt)|0,V=V+Math.imul(Pe,Ut)|0,R=R+Math.imul(fe,Wt)|0,q=(q=q+Math.imul(fe,rr)|0)+Math.imul(ve,Wt)|0,V=V+Math.imul(ve,rr)|0,R=R+Math.imul(Te,Ve)|0,q=(q=q+Math.imul(Te,We)|0)+Math.imul(we,Ve)|0,V=V+Math.imul(we,We)|0,R=R+Math.imul(se,ye)|0,q=(q=q+Math.imul(se,Be)|0)+Math.imul(ge,ye)|0,V=V+Math.imul(ge,Be)|0,R=R+Math.imul(le,Je)|0,q=(q=q+Math.imul(le,He)|0)+Math.imul(oe,Je)|0,V=V+Math.imul(oe,He)|0,R=R+Math.imul(X,ot)|0,q=(q=q+Math.imul(X,wt)|0)+Math.imul(re,ot)|0,V=V+Math.imul(re,wt)|0;var jt=(Y+(R=R+Math.imul(te,rt)|0)|0)+((8191&(q=(q=q+Math.imul(te,ft)|0)+Math.imul(j,rt)|0))<<13)|0;Y=((V=V+Math.imul(j,ft)|0)+(q>>>13)|0)+(jt>>>26)|0,jt&=67108863,R=Math.imul(Se,tt),q=(q=Math.imul(Se,Ke))+Math.imul(Ie,tt)|0,V=Math.imul(Ie,Ke),R=R+Math.imul(De,Bt)|0,q=(q=q+Math.imul(De,Ut)|0)+Math.imul(ze,Bt)|0,V=V+Math.imul(ze,Ut)|0,R=R+Math.imul(ke,Wt)|0,q=(q=q+Math.imul(ke,rr)|0)+Math.imul(Pe,Wt)|0,V=V+Math.imul(Pe,rr)|0,R=R+Math.imul(fe,Ve)|0,q=(q=q+Math.imul(fe,We)|0)+Math.imul(ve,Ve)|0,V=V+Math.imul(ve,We)|0,R=R+Math.imul(Te,ye)|0,q=(q=q+Math.imul(Te,Be)|0)+Math.imul(we,ye)|0,V=V+Math.imul(we,Be)|0,R=R+Math.imul(se,Je)|0,q=(q=q+Math.imul(se,He)|0)+Math.imul(ge,Je)|0,V=V+Math.imul(ge,He)|0,R=R+Math.imul(le,ot)|0,q=(q=q+Math.imul(le,wt)|0)+Math.imul(oe,ot)|0,V=V+Math.imul(oe,wt)|0;var fr=(Y+(R=R+Math.imul(X,rt)|0)|0)+((8191&(q=(q=q+Math.imul(X,ft)|0)+Math.imul(re,rt)|0))<<13)|0;Y=((V=V+Math.imul(re,ft)|0)+(q>>>13)|0)+(fr>>>26)|0,fr&=67108863,R=Math.imul(Se,Bt),q=(q=Math.imul(Se,Ut))+Math.imul(Ie,Bt)|0,V=Math.imul(Ie,Ut),R=R+Math.imul(De,Wt)|0,q=(q=q+Math.imul(De,rr)|0)+Math.imul(ze,Wt)|0,V=V+Math.imul(ze,rr)|0,R=R+Math.imul(ke,Ve)|0,q=(q=q+Math.imul(ke,We)|0)+Math.imul(Pe,Ve)|0,V=V+Math.imul(Pe,We)|0,R=R+Math.imul(fe,ye)|0,q=(q=q+Math.imul(fe,Be)|0)+Math.imul(ve,ye)|0,V=V+Math.imul(ve,Be)|0,R=R+Math.imul(Te,Je)|0,q=(q=q+Math.imul(Te,He)|0)+Math.imul(we,Je)|0,V=V+Math.imul(we,He)|0,R=R+Math.imul(se,ot)|0,q=(q=q+Math.imul(se,wt)|0)+Math.imul(ge,ot)|0,V=V+Math.imul(ge,wt)|0;var kr=(Y+(R=R+Math.imul(le,rt)|0)|0)+((8191&(q=(q=q+Math.imul(le,ft)|0)+Math.imul(oe,rt)|0))<<13)|0;Y=((V=V+Math.imul(oe,ft)|0)+(q>>>13)|0)+(kr>>>26)|0,kr&=67108863,R=Math.imul(Se,Wt),q=(q=Math.imul(Se,rr))+Math.imul(Ie,Wt)|0,V=Math.imul(Ie,rr),R=R+Math.imul(De,Ve)|0,q=(q=q+Math.imul(De,We)|0)+Math.imul(ze,Ve)|0,V=V+Math.imul(ze,We)|0,R=R+Math.imul(ke,ye)|0,q=(q=q+Math.imul(ke,Be)|0)+Math.imul(Pe,ye)|0,V=V+Math.imul(Pe,Be)|0,R=R+Math.imul(fe,Je)|0,q=(q=q+Math.imul(fe,He)|0)+Math.imul(ve,Je)|0,V=V+Math.imul(ve,He)|0,R=R+Math.imul(Te,ot)|0,q=(q=q+Math.imul(Te,wt)|0)+Math.imul(we,ot)|0,V=V+Math.imul(we,wt)|0;var ur=(Y+(R=R+Math.imul(se,rt)|0)|0)+((8191&(q=(q=q+Math.imul(se,ft)|0)+Math.imul(ge,rt)|0))<<13)|0;Y=((V=V+Math.imul(ge,ft)|0)+(q>>>13)|0)+(ur>>>26)|0,ur&=67108863,R=Math.imul(Se,Ve),q=(q=Math.imul(Se,We))+Math.imul(Ie,Ve)|0,V=Math.imul(Ie,We),R=R+Math.imul(De,ye)|0,q=(q=q+Math.imul(De,Be)|0)+Math.imul(ze,ye)|0,V=V+Math.imul(ze,Be)|0,R=R+Math.imul(ke,Je)|0,q=(q=q+Math.imul(ke,He)|0)+Math.imul(Pe,Je)|0,V=V+Math.imul(Pe,He)|0,R=R+Math.imul(fe,ot)|0,q=(q=q+Math.imul(fe,wt)|0)+Math.imul(ve,ot)|0,V=V+Math.imul(ve,wt)|0;var Jt=(Y+(R=R+Math.imul(Te,rt)|0)|0)+((8191&(q=(q=q+Math.imul(Te,ft)|0)+Math.imul(we,rt)|0))<<13)|0;Y=((V=V+Math.imul(we,ft)|0)+(q>>>13)|0)+(Jt>>>26)|0,Jt&=67108863,R=Math.imul(Se,ye),q=(q=Math.imul(Se,Be))+Math.imul(Ie,ye)|0,V=Math.imul(Ie,Be),R=R+Math.imul(De,Je)|0,q=(q=q+Math.imul(De,He)|0)+Math.imul(ze,Je)|0,V=V+Math.imul(ze,He)|0,R=R+Math.imul(ke,ot)|0,q=(q=q+Math.imul(ke,wt)|0)+Math.imul(Pe,ot)|0,V=V+Math.imul(Pe,wt)|0;var $t=(Y+(R=R+Math.imul(fe,rt)|0)|0)+((8191&(q=(q=q+Math.imul(fe,ft)|0)+Math.imul(ve,rt)|0))<<13)|0;Y=((V=V+Math.imul(ve,ft)|0)+(q>>>13)|0)+($t>>>26)|0,$t&=67108863,R=Math.imul(Se,Je),q=(q=Math.imul(Se,He))+Math.imul(Ie,Je)|0,V=Math.imul(Ie,He),R=R+Math.imul(De,ot)|0,q=(q=q+Math.imul(De,wt)|0)+Math.imul(ze,ot)|0,V=V+Math.imul(ze,wt)|0;var Qt=(Y+(R=R+Math.imul(ke,rt)|0)|0)+((8191&(q=(q=q+Math.imul(ke,ft)|0)+Math.imul(Pe,rt)|0))<<13)|0;Y=((V=V+Math.imul(Pe,ft)|0)+(q>>>13)|0)+(Qt>>>26)|0,Qt&=67108863,R=Math.imul(Se,ot),q=(q=Math.imul(Se,wt))+Math.imul(Ie,ot)|0,V=Math.imul(Ie,wt);var cr=(Y+(R=R+Math.imul(De,rt)|0)|0)+((8191&(q=(q=q+Math.imul(De,ft)|0)+Math.imul(ze,rt)|0))<<13)|0;Y=((V=V+Math.imul(ze,ft)|0)+(q>>>13)|0)+(cr>>>26)|0,cr&=67108863;var gr=(Y+(R=Math.imul(Se,rt))|0)+((8191&(q=(q=Math.imul(Se,ft))+Math.imul(Ie,rt)|0))<<13)|0;return Y=((V=Math.imul(Ie,ft))+(q>>>13)|0)+(gr>>>26)|0,gr&=67108863,G[0]=Rt,G[1]=kt,G[2]=Lt,G[3]=Ee,G[4]=Ye,G[5]=it,G[6]=ht,G[7]=At,G[8]=Ft,G[9]=Gt,G[10]=jt,G[11]=fr,G[12]=kr,G[13]=ur,G[14]=Jt,G[15]=$t,G[16]=Qt,G[17]=cr,G[18]=gr,0!==Y&&(G[19]=Y,z.length++),z};function b(S,E,z){return(new l).mulp(S,E,z)}function l(S,E){this.x=S,this.y=E}Math.imul||(o=p),r.prototype.mulTo=function(S,E){var z=this.length+S.length;return 10===this.length&&10===S.length?o(this,S,E):z<63?p(this,S,E):z<1024?function(R,q,V){V.negative=q.negative^R.negative,V.length=R.length+q.length;for(var W=0,K=0,G=0;G<V.length-1;G++){var Y=K;K=0;for(var $=67108863&W,B=Math.min(G,q.length-1),N=Math.max(0,G-R.length+1);N<=B;N++){var te=(0|R.words[G-N])*(0|q.words[N]),j=67108863&te;$=67108863&(j=j+$|0),K+=(Y=(Y=Y+(te/67108864|0)|0)+(j>>>26)|0)>>>26,Y&=67108863}V.words[G]=$,W=Y,Y=K}return 0!==W?V.words[G]=W:V.length--,V.strip()}(this,S,E):b(this,S,E)},l.prototype.makeRBT=function(S){for(var E=new Array(S),z=r.prototype._countBits(S)-1,R=0;R<S;R++)E[R]=this.revBin(R,z,S);return E},l.prototype.revBin=function(S,E,z){if(0===S||S===z-1)return S;for(var R=0,q=0;q<E;q++)R|=(1&S)<<E-q-1,S>>=1;return R},l.prototype.permute=function(S,E,z,R,q,V){for(var W=0;W<V;W++)R[W]=E[S[W]],q[W]=z[S[W]]},l.prototype.transform=function(S,E,z,R,q,V){this.permute(V,S,E,z,R,q);for(var W=1;W<q;W<<=1)for(var K=W<<1,G=Math.cos(2*Math.PI/K),Y=Math.sin(2*Math.PI/K),$=0;$<q;$+=K)for(var B=G,N=Y,U=0;U<W;U++){var te=z[$+U],j=R[$+U],J=z[$+U+W],X=R[$+U+W],re=B*J-N*X;X=B*X+N*J,z[$+U]=te+(J=re),R[$+U]=j+X,z[$+U+W]=te-J,R[$+U+W]=j-X,U!==K&&(re=G*B-Y*N,N=G*N+Y*B,B=re)}},l.prototype.guessLen13b=function(S,E){var z=1|Math.max(E,S),R=1&z,q=0;for(z=z/2|0;z;z>>>=1)q++;return 1<<q+1+R},l.prototype.conjugate=function(S,E,z){if(!(z<=1))for(var R=0;R<z/2;R++){var q=S[R];S[R]=S[z-R-1],S[z-R-1]=q,q=E[R],E[R]=-E[z-R-1],E[z-R-1]=-q}},l.prototype.normalize13b=function(S,E){for(var z=0,R=0;R<E/2;R++){var q=8192*Math.round(S[2*R+1]/E)+Math.round(S[2*R]/E)+z;S[R]=67108863&q,z=q<67108864?0:q/67108864|0}return S},l.prototype.convert13b=function(S,E,z,R){for(var q=0,V=0;V<E;V++)z[2*V]=8191&(q+=0|S[V]),z[2*V+1]=8191&(q>>>=13),q>>>=13;for(V=2*E;V<R;++V)z[V]=0;t(0===q),t(0==(-8192&q))},l.prototype.stub=function(S){for(var E=new Array(S),z=0;z<S;z++)E[z]=0;return E},l.prototype.mulp=function(S,E,z){var R=2*this.guessLen13b(S.length,E.length),q=this.makeRBT(R),V=this.stub(R),W=new Array(R),K=new Array(R),G=new Array(R),Y=new Array(R),$=new Array(R),B=new Array(R),N=z.words;N.length=R,this.convert13b(S.words,S.length,W,R),this.convert13b(E.words,E.length,Y,R),this.transform(W,V,K,G,R,q),this.transform(Y,V,$,B,R,q);for(var U=0;U<R;U++){var te=K[U]*$[U]-G[U]*B[U];G[U]=K[U]*B[U]+G[U]*$[U],K[U]=te}return this.conjugate(K,G,R),this.transform(K,G,N,V,R,q),this.conjugate(N,V,R),this.normalize13b(N,R),z.negative=S.negative^E.negative,z.length=S.length+E.length,z.strip()},r.prototype.mul=function(S){var E=new r(null);return E.words=new Array(this.length+S.length),this.mulTo(S,E)},r.prototype.mulf=function(S){var E=new r(null);return E.words=new Array(this.length+S.length),b(this,S,E)},r.prototype.imul=function(S){return this.clone().mulTo(S,this)},r.prototype.imuln=function(S){t("number"==typeof S),t(S<67108864);for(var E=0,z=0;z<this.length;z++){var R=(0|this.words[z])*S,q=(67108863&R)+(67108863&E);E>>=26,E+=R/67108864|0,E+=q>>>26,this.words[z]=67108863&q}return 0!==E&&(this.words[z]=E,this.length++),this},r.prototype.muln=function(S){return this.clone().imuln(S)},r.prototype.sqr=function(){return this.mul(this)},r.prototype.isqr=function(){return this.imul(this.clone())},r.prototype.pow=function(S){var E=function(V){for(var W=new Array(V.bitLength()),K=0;K<W.length;K++){var Y=K%26;W[K]=(V.words[K/26|0]&1<<Y)>>>Y}return W}(S);if(0===E.length)return new r(1);for(var z=this,R=0;R<E.length&&0===E[R];R++,z=z.sqr());if(++R<E.length)for(var q=z.sqr();R<E.length;R++,q=q.sqr())0!==E[R]&&(z=z.mul(q));return z},r.prototype.iushln=function(S){t("number"==typeof S&&S>=0);var E,z=S%26,R=(S-z)/26,q=67108863>>>26-z<<26-z;if(0!==z){var V=0;for(E=0;E<this.length;E++){var W=this.words[E]&q;this.words[E]=(0|this.words[E])-W<<z|V,V=W>>>26-z}V&&(this.words[E]=V,this.length++)}if(0!==R){for(E=this.length-1;E>=0;E--)this.words[E+R]=this.words[E];for(E=0;E<R;E++)this.words[E]=0;this.length+=R}return this.strip()},r.prototype.ishln=function(S){return t(0===this.negative),this.iushln(S)},r.prototype.iushrn=function(S,E,z){var R;t("number"==typeof S&&S>=0),R=E?(E-E%26)/26:0;var q=S%26,V=Math.min((S-q)/26,this.length),W=67108863^67108863>>>q<<q,K=z;if(R-=V,R=Math.max(0,R),K){for(var G=0;G<V;G++)K.words[G]=this.words[G];K.length=V}if(0!==V)if(this.length>V)for(this.length-=V,G=0;G<this.length;G++)this.words[G]=this.words[G+V];else this.words[0]=0,this.length=1;var Y=0;for(G=this.length-1;G>=0&&(0!==Y||G>=R);G--){var $=0|this.words[G];this.words[G]=Y<<26-q|$>>>q,Y=$&W}return K&&0!==Y&&(K.words[K.length++]=Y),0===this.length&&(this.words[0]=0,this.length=1),this.strip()},r.prototype.ishrn=function(S,E,z){return t(0===this.negative),this.iushrn(S,E,z)},r.prototype.shln=function(S){return this.clone().ishln(S)},r.prototype.ushln=function(S){return this.clone().iushln(S)},r.prototype.shrn=function(S){return this.clone().ishrn(S)},r.prototype.ushrn=function(S){return this.clone().iushrn(S)},r.prototype.testn=function(S){t("number"==typeof S&&S>=0);var E=S%26,z=(S-E)/26;return!(this.length<=z||!(this.words[z]&1<<E))},r.prototype.imaskn=function(S){t("number"==typeof S&&S>=0);var E=S%26,z=(S-E)/26;return t(0===this.negative,"imaskn works only with positive numbers"),this.length<=z?this:(0!==E&&z++,this.length=Math.min(z,this.length),0!==E&&(this.words[this.length-1]&=67108863^67108863>>>E<<E),this.strip())},r.prototype.maskn=function(S){return this.clone().imaskn(S)},r.prototype.iaddn=function(S){return t("number"==typeof S),t(S<67108864),S<0?this.isubn(-S):0!==this.negative?1===this.length&&(0|this.words[0])<S?(this.words[0]=S-(0|this.words[0]),this.negative=0,this):(this.negative=0,this.isubn(S),this.negative=1,this):this._iaddn(S)},r.prototype._iaddn=function(S){this.words[0]+=S;for(var E=0;E<this.length&&this.words[E]>=67108864;E++)this.words[E]-=67108864,E===this.length-1?this.words[E+1]=1:this.words[E+1]++;return this.length=Math.max(this.length,E+1),this},r.prototype.isubn=function(S){if(t("number"==typeof S),t(S<67108864),S<0)return this.iaddn(-S);if(0!==this.negative)return this.negative=0,this.iaddn(S),this.negative=1,this;if(this.words[0]-=S,1===this.length&&this.words[0]<0)this.words[0]=-this.words[0],this.negative=1;else for(var E=0;E<this.length&&this.words[E]<0;E++)this.words[E]+=67108864,this.words[E+1]-=1;return this.strip()},r.prototype.addn=function(S){return this.clone().iaddn(S)},r.prototype.subn=function(S){return this.clone().isubn(S)},r.prototype.iabs=function(){return this.negative=0,this},r.prototype.abs=function(){return this.clone().iabs()},r.prototype._ishlnsubmul=function(S,E,z){var R,q;this._expand(S.length+z);var W=0;for(R=0;R<S.length;R++){q=(0|this.words[R+z])+W;var K=(0|S.words[R])*E;W=((q-=67108863&K)>>26)-(K/67108864|0),this.words[R+z]=67108863&q}for(;R<this.length-z;R++)W=(q=(0|this.words[R+z])+W)>>26,this.words[R+z]=67108863&q;if(0===W)return this.strip();for(t(-1===W),W=0,R=0;R<this.length;R++)W=(q=-(0|this.words[R])+W)>>26,this.words[R]=67108863&q;return this.negative=1,this.strip()},r.prototype._wordDiv=function(S,E){var z,R=this.clone(),q=S,V=0|q.words[q.length-1];0!=(z=26-this._countBits(V))&&(q=q.ushln(z),R.iushln(z),V=0|q.words[q.length-1]);var W,K=R.length-q.length;if("mod"!==E){(W=new r(null)).length=K+1,W.words=new Array(W.length);for(var G=0;G<W.length;G++)W.words[G]=0}var Y=R.clone()._ishlnsubmul(q,1,K);0===Y.negative&&(R=Y,W&&(W.words[K]=1));for(var $=K-1;$>=0;$--){var B=67108864*(0|R.words[q.length+$])+(0|R.words[q.length+$-1]);for(B=Math.min(B/V|0,67108863),R._ishlnsubmul(q,B,$);0!==R.negative;)B--,R.negative=0,R._ishlnsubmul(q,1,$),R.isZero()||(R.negative^=1);W&&(W.words[$]=B)}return W&&W.strip(),R.strip(),"div"!==E&&0!==z&&R.iushrn(z),{div:W||null,mod:R}},r.prototype.divmod=function(S,E,z){return t(!S.isZero()),this.isZero()?{div:new r(0),mod:new r(0)}:0!==this.negative&&0===S.negative?(V=this.neg().divmod(S,E),"mod"!==E&&(R=V.div.neg()),"div"!==E&&(q=V.mod.neg(),z&&0!==q.negative&&q.iadd(S)),{div:R,mod:q}):0===this.negative&&0!==S.negative?(V=this.divmod(S.neg(),E),"mod"!==E&&(R=V.div.neg()),{div:R,mod:V.mod}):0!=(this.negative&S.negative)?(V=this.neg().divmod(S.neg(),E),"div"!==E&&(q=V.mod.neg(),z&&0!==q.negative&&q.isub(S)),{div:V.div,mod:q}):S.length>this.length||this.cmp(S)<0?{div:new r(0),mod:this}:1===S.length?"div"===E?{div:this.divn(S.words[0]),mod:null}:"mod"===E?{div:null,mod:new r(this.modn(S.words[0]))}:{div:this.divn(S.words[0]),mod:new r(this.modn(S.words[0]))}:this._wordDiv(S,E);var R,q,V},r.prototype.div=function(S){return this.divmod(S,"div",!1).div},r.prototype.mod=function(S){return this.divmod(S,"mod",!1).mod},r.prototype.umod=function(S){return this.divmod(S,"mod",!0).mod},r.prototype.divRound=function(S){var E=this.divmod(S);if(E.mod.isZero())return E.div;var z=0!==E.div.negative?E.mod.isub(S):E.mod,R=S.ushrn(1),q=S.andln(1),V=z.cmp(R);return V<0||1===q&&0===V?E.div:0!==E.div.negative?E.div.isubn(1):E.div.iaddn(1)},r.prototype.modn=function(S){t(S<=67108863);for(var E=(1<<26)%S,z=0,R=this.length-1;R>=0;R--)z=(E*z+(0|this.words[R]))%S;return z},r.prototype.idivn=function(S){t(S<=67108863);for(var E=0,z=this.length-1;z>=0;z--){var R=(0|this.words[z])+67108864*E;this.words[z]=R/S|0,E=R%S}return this.strip()},r.prototype.divn=function(S){return this.clone().idivn(S)},r.prototype.egcd=function(S){t(0===S.negative),t(!S.isZero());var E=this,z=S.clone();E=0!==E.negative?E.umod(S):E.clone();for(var R=new r(1),q=new r(0),V=new r(0),W=new r(1),K=0;E.isEven()&&z.isEven();)E.iushrn(1),z.iushrn(1),++K;for(var G=z.clone(),Y=E.clone();!E.isZero();){for(var $=0,B=1;0==(E.words[0]&B)&&$<26;++$,B<<=1);if($>0)for(E.iushrn($);$-- >0;)(R.isOdd()||q.isOdd())&&(R.iadd(G),q.isub(Y)),R.iushrn(1),q.iushrn(1);for(var N=0,U=1;0==(z.words[0]&U)&&N<26;++N,U<<=1);if(N>0)for(z.iushrn(N);N-- >0;)(V.isOdd()||W.isOdd())&&(V.iadd(G),W.isub(Y)),V.iushrn(1),W.iushrn(1);E.cmp(z)>=0?(E.isub(z),R.isub(V),q.isub(W)):(z.isub(E),V.isub(R),W.isub(q))}return{a:V,b:W,gcd:z.iushln(K)}},r.prototype._invmp=function(S){t(0===S.negative),t(!S.isZero());var E=this,z=S.clone();E=0!==E.negative?E.umod(S):E.clone();for(var R,q=new r(1),V=new r(0),W=z.clone();E.cmpn(1)>0&&z.cmpn(1)>0;){for(var K=0,G=1;0==(E.words[0]&G)&&K<26;++K,G<<=1);if(K>0)for(E.iushrn(K);K-- >0;)q.isOdd()&&q.iadd(W),q.iushrn(1);for(var Y=0,$=1;0==(z.words[0]&$)&&Y<26;++Y,$<<=1);if(Y>0)for(z.iushrn(Y);Y-- >0;)V.isOdd()&&V.iadd(W),V.iushrn(1);E.cmp(z)>=0?(E.isub(z),q.isub(V)):(z.isub(E),V.isub(q))}return(R=0===E.cmpn(1)?q:V).cmpn(0)<0&&R.iadd(S),R},r.prototype.gcd=function(S){if(this.isZero())return S.abs();if(S.isZero())return this.abs();var E=this.clone(),z=S.clone();E.negative=0,z.negative=0;for(var R=0;E.isEven()&&z.isEven();R++)E.iushrn(1),z.iushrn(1);for(;;){for(;E.isEven();)E.iushrn(1);for(;z.isEven();)z.iushrn(1);var q=E.cmp(z);if(q<0){var V=E;E=z,z=V}else if(0===q||0===z.cmpn(1))break;E.isub(z)}return z.iushln(R)},r.prototype.invm=function(S){return this.egcd(S).a.umod(S)},r.prototype.isEven=function(){return 0==(1&this.words[0])},r.prototype.isOdd=function(){return 1==(1&this.words[0])},r.prototype.andln=function(S){return this.words[0]&S},r.prototype.bincn=function(S){t("number"==typeof S);var E=S%26,z=(S-E)/26,R=1<<E;if(this.length<=z)return this._expand(z+1),this.words[z]|=R,this;for(var q=R,V=z;0!==q&&V<this.length;V++){var W=0|this.words[V];q=(W+=q)>>>26,this.words[V]=W&=67108863}return 0!==q&&(this.words[V]=q,this.length++),this},r.prototype.isZero=function(){return 1===this.length&&0===this.words[0]},r.prototype.cmpn=function(S){var E,z=S<0;if(0!==this.negative&&!z)return-1;if(0===this.negative&&z)return 1;if(this.strip(),this.length>1)E=1;else{z&&(S=-S),t(S<=67108863,"Number is too big");var R=0|this.words[0];E=R===S?0:R<S?-1:1}return 0!==this.negative?0|-E:E},r.prototype.cmp=function(S){if(0!==this.negative&&0===S.negative)return-1;if(0===this.negative&&0!==S.negative)return 1;var E=this.ucmp(S);return 0!==this.negative?0|-E:E},r.prototype.ucmp=function(S){if(this.length>S.length)return 1;if(this.length<S.length)return-1;for(var E=0,z=this.length-1;z>=0;z--){var R=0|this.words[z],q=0|S.words[z];if(R!==q){R<q?E=-1:R>q&&(E=1);break}}return E},r.prototype.gtn=function(S){return 1===this.cmpn(S)},r.prototype.gt=function(S){return 1===this.cmp(S)},r.prototype.gten=function(S){return this.cmpn(S)>=0},r.prototype.gte=function(S){return this.cmp(S)>=0},r.prototype.ltn=function(S){return-1===this.cmpn(S)},r.prototype.lt=function(S){return-1===this.cmp(S)},r.prototype.lten=function(S){return this.cmpn(S)<=0},r.prototype.lte=function(S){return this.cmp(S)<=0},r.prototype.eqn=function(S){return 0===this.cmpn(S)},r.prototype.eq=function(S){return 0===this.cmp(S)},r.red=function(S){return new I(S)},r.prototype.toRed=function(S){return t(!this.red,"Already a number in reduction context"),t(0===this.negative,"red works only with positives"),S.convertTo(this)._forceRed(S)},r.prototype.fromRed=function(){return t(this.red,"fromRed works only with numbers in reduction context"),this.red.convertFrom(this)},r.prototype._forceRed=function(S){return this.red=S,this},r.prototype.forceRed=function(S){return t(!this.red,"Already a number in reduction context"),this._forceRed(S)},r.prototype.redAdd=function(S){return t(this.red,"redAdd works only with red numbers"),this.red.add(this,S)},r.prototype.redIAdd=function(S){return t(this.red,"redIAdd works only with red numbers"),this.red.iadd(this,S)},r.prototype.redSub=function(S){return t(this.red,"redSub works only with red numbers"),this.red.sub(this,S)},r.prototype.redISub=function(S){return t(this.red,"redISub works only with red numbers"),this.red.isub(this,S)},r.prototype.redShl=function(S){return t(this.red,"redShl works only with red numbers"),this.red.shl(this,S)},r.prototype.redMul=function(S){return t(this.red,"redMul works only with red numbers"),this.red._verify2(this,S),this.red.mul(this,S)},r.prototype.redIMul=function(S){return t(this.red,"redMul works only with red numbers"),this.red._verify2(this,S),this.red.imul(this,S)},r.prototype.redSqr=function(){return t(this.red,"redSqr works only with red numbers"),this.red._verify1(this),this.red.sqr(this)},r.prototype.redISqr=function(){return t(this.red,"redISqr works only with red numbers"),this.red._verify1(this),this.red.isqr(this)},r.prototype.redSqrt=function(){return t(this.red,"redSqrt works only with red numbers"),this.red._verify1(this),this.red.sqrt(this)},r.prototype.redInvm=function(){return t(this.red,"redInvm works only with red numbers"),this.red._verify1(this),this.red.invm(this)},r.prototype.redNeg=function(){return t(this.red,"redNeg works only with red numbers"),this.red._verify1(this),this.red.neg(this)},r.prototype.redPow=function(S){return t(this.red&&!S.red,"redPow(normalNum)"),this.red._verify1(this),this.red.pow(this,S)};var T={k256:null,p224:null,p192:null,p25519:null};function _(S,E){this.name=S,this.p=new r(E,16),this.n=this.p.bitLength(),this.k=new r(1).iushln(this.n).isub(this.p),this.tmp=this._tmp()}function w(){_.call(this,"k256","ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f")}function k(){_.call(this,"p224","ffffffff ffffffff ffffffff ffffffff 00000000 00000000 00000001")}function L(){_.call(this,"p192","ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff")}function M(){_.call(this,"25519","7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed")}function I(S){if("string"==typeof S){var E=r._prime(S);this.m=E.p,this.prime=E}else t(S.gtn(1),"modulus must be greater than 1"),this.m=S,this.prime=null}function P(S){I.call(this,S),this.shift=this.m.bitLength(),this.shift%26!=0&&(this.shift+=26-this.shift%26),this.r=new r(1).iushln(this.shift),this.r2=this.imod(this.r.sqr()),this.rinv=this.r._invmp(this.m),this.minv=this.rinv.mul(this.r).isubn(1).div(this.m),this.minv=this.minv.umod(this.r),this.minv=this.r.sub(this.minv)}_.prototype._tmp=function(){var S=new r(null);return S.words=new Array(Math.ceil(this.n/13)),S},_.prototype.ireduce=function(S){var E,z=S;do{this.split(z,this.tmp),E=(z=(z=this.imulK(z)).iadd(this.tmp)).bitLength()}while(E>this.n);var R=E<this.n?-1:z.ucmp(this.p);return 0===R?(z.words[0]=0,z.length=1):R>0?z.isub(this.p):void 0!==z.strip?z.strip():z._strip(),z},_.prototype.split=function(S,E){S.iushrn(this.n,0,E)},_.prototype.imulK=function(S){return S.imul(this.k)},a(w,_),w.prototype.split=function(S,E){for(var z=Math.min(S.length,9),R=0;R<z;R++)E.words[R]=S.words[R];if(E.length=z,S.length<=9)return S.words[0]=0,void(S.length=1);var q=S.words[9];for(E.words[E.length++]=4194303&q,R=10;R<S.length;R++){var V=0|S.words[R];S.words[R-10]=(4194303&V)<<4|q>>>22,q=V}S.words[R-10]=q>>>=22,S.length-=0===q&&S.length>10?10:9},w.prototype.imulK=function(S){S.words[S.length]=0,S.words[S.length+1]=0,S.length+=2;for(var E=0,z=0;z<S.length;z++){var R=0|S.words[z];S.words[z]=67108863&(E+=977*R),E=64*R+(E/67108864|0)}return 0===S.words[S.length-1]&&(S.length--,0===S.words[S.length-1]&&S.length--),S},a(k,_),a(L,_),a(M,_),M.prototype.imulK=function(S){for(var E=0,z=0;z<S.length;z++){var R=19*(0|S.words[z])+E,q=67108863&R;R>>>=26,S.words[z]=q,E=R}return 0!==E&&(S.words[S.length++]=E),S},r._prime=function(S){if(T[S])return T[S];var E;if("k256"===S)E=new w;else if("p224"===S)E=new k;else if("p192"===S)E=new L;else{if("p25519"!==S)throw new Error("Unknown prime "+S);E=new M}return T[S]=E,E},I.prototype._verify1=function(S){t(0===S.negative,"red works only with positives"),t(S.red,"red works only with red numbers")},I.prototype._verify2=function(S,E){t(0==(S.negative|E.negative),"red works only with positives"),t(S.red&&S.red===E.red,"red works only with red numbers")},I.prototype.imod=function(S){return this.prime?this.prime.ireduce(S)._forceRed(this):S.umod(this.m)._forceRed(this)},I.prototype.neg=function(S){return S.isZero()?S.clone():this.m.sub(S)._forceRed(this)},I.prototype.add=function(S,E){this._verify2(S,E);var z=S.add(E);return z.cmp(this.m)>=0&&z.isub(this.m),z._forceRed(this)},I.prototype.iadd=function(S,E){this._verify2(S,E);var z=S.iadd(E);return z.cmp(this.m)>=0&&z.isub(this.m),z},I.prototype.sub=function(S,E){this._verify2(S,E);var z=S.sub(E);return z.cmpn(0)<0&&z.iadd(this.m),z._forceRed(this)},I.prototype.isub=function(S,E){this._verify2(S,E);var z=S.isub(E);return z.cmpn(0)<0&&z.iadd(this.m),z},I.prototype.shl=function(S,E){return this._verify1(S),this.imod(S.ushln(E))},I.prototype.imul=function(S,E){return this._verify2(S,E),this.imod(S.imul(E))},I.prototype.mul=function(S,E){return this._verify2(S,E),this.imod(S.mul(E))},I.prototype.isqr=function(S){return this.imul(S,S.clone())},I.prototype.sqr=function(S){return this.mul(S,S)},I.prototype.sqrt=function(S){if(S.isZero())return S.clone();var E=this.m.andln(3);if(t(E%2==1),3===E){var z=this.m.add(new r(1)).iushrn(2);return this.pow(S,z)}for(var R=this.m.subn(1),q=0;!R.isZero()&&0===R.andln(1);)q++,R.iushrn(1);t(!R.isZero());var V=new r(1).toRed(this),W=V.redNeg(),K=this.m.subn(1).iushrn(1),G=this.m.bitLength();for(G=new r(2*G*G).toRed(this);0!==this.pow(G,K).cmp(W);)G.redIAdd(W);for(var Y=this.pow(G,R),$=this.pow(S,R.addn(1).iushrn(1)),B=this.pow(S,R),N=q;0!==B.cmp(V);){for(var U=B,te=0;0!==U.cmp(V);te++)U=U.redSqr();t(te<N);var j=this.pow(Y,new r(1).iushln(N-te-1));$=$.redMul(j),Y=j.redSqr(),B=B.redMul(Y),N=te}return $},I.prototype.invm=function(S){var E=S._invmp(this.m);return 0!==E.negative?(E.negative=0,this.imod(E).redNeg()):this.imod(E)},I.prototype.pow=function(S,E){if(E.isZero())return new r(1).toRed(this);if(0===E.cmpn(1))return S.clone();var z=new Array(16);z[0]=new r(1).toRed(this),z[1]=S;for(var R=2;R<z.length;R++)z[R]=this.mul(z[R-1],S);var q=z[0],V=0,W=0,K=E.bitLength()%26;for(0===K&&(K=26),R=E.length-1;R>=0;R--){for(var G=E.words[R],Y=K-1;Y>=0;Y--){var $=G>>Y&1;q!==z[0]&&(q=this.sqr(q)),0!==$||0!==V?(V<<=1,V|=$,(4==++W||0===R&&0===Y)&&(q=this.mul(q,z[V]),W=0,V=0)):W=0}K=26}return q},I.prototype.convertTo=function(S){var E=S.umod(this.m);return E===S?E.clone():E},I.prototype.convertFrom=function(S){var E=S.clone();return E.red=null,E},r.mont=function(S){return new P(S)},a(P,I),P.prototype.convertTo=function(S){return this.imod(S.ushln(this.shift))},P.prototype.convertFrom=function(S){var E=this.imod(S.mul(this.rinv));return E.red=null,E},P.prototype.imul=function(S,E){if(S.isZero()||E.isZero())return S.words[0]=0,S.length=1,S;var z=S.imul(E),R=z.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),q=z.isub(R).iushrn(this.shift),V=q;return q.cmp(this.m)>=0?V=q.isub(this.m):q.cmpn(0)<0&&(V=q.iadd(this.m)),V._forceRed(this)},P.prototype.mul=function(S,E){if(S.isZero()||E.isZero())return new r(0)._forceRed(this);var z=S.mul(E),R=z.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),q=z.isub(R).iushrn(this.shift),V=q;return q.cmp(this.m)>=0?V=q.isub(this.m):q.cmpn(0)<0&&(V=q.iadd(this.m)),V._forceRed(this)},P.prototype.invm=function(S){return this.imod(S._invmp(this.m).mul(this.r2))._forceRed(this)}}(void 0===m||m,this)},{buffer:2}],34:[function(v,m,x){"use strict";m.exports=function(e){var n,t,a,r=e.length,d=0;for(n=0;n<r;++n)d+=e[n].length;var s=new Array(d),i=0;for(n=0;n<r;++n){var u=e[n],f=u.length;for(t=0;t<f;++t){var c=s[i++]=new Array(f-1),h=0;for(a=0;a<f;++a)a!==t&&(c[h++]=u[a]);if(1&t){var p=c[1];c[1]=c[0],c[0]=p}}}return s}},{}],35:[function(v,m,x){"use strict";m.exports=function(c,h,p){switch(arguments.length){case 1:return u(c);case 2:return"function"==typeof h?s(c,c,h,!0):f(c,h);case 3:return s(c,h,p,!1);default:throw new Error("box-intersect: Invalid arguments")}};var e,n=v("typedarray-pool"),t=v("./lib/sweep"),a=v("./lib/intersect");function r(c,h){for(var p=0;p<c;++p)if(!(h[p]<=h[p+c]))return!0;return!1}function d(c,h,p,o){for(var b=0,l=0,T=0,_=c.length;T<_;++T){var w=c[T];if(!r(h,w)){for(var k=0;k<2*h;++k)p[b++]=w[k];o[l++]=T}}return l}function s(c,h,p,o){var b=c.length,l=h.length;if(!(b<=0||l<=0)){var T=c[0].length>>>1;if(!(T<=0)){var _,w=n.mallocDouble(2*T*b),k=n.mallocInt32(b);if((b=d(c,T,w,k))>0){if(1===T&&o)t.init(b),_=t.sweepComplete(T,p,0,b,w,k,0,b,w,k);else{var L=n.mallocDouble(2*T*l),M=n.mallocInt32(l);(l=d(h,T,L,M))>0&&(t.init(b+l),_=1===T?t.sweepBipartite(T,p,0,b,w,k,0,l,L,M):a(T,p,o,b,w,k,l,L,M),n.free(L),n.free(M))}n.free(w),n.free(k)}return _}}}function i(c,h){e.push([c,h])}function u(c){return e=[],s(c,c,i,!0),e}function f(c,h){return e=[],s(c,h,i,!1),e}},{"./lib/intersect":37,"./lib/sweep":41,"typedarray-pool":308}],36:[function(v,m,x){"use strict";function e(n){return n?function(t,a,r,d,s,i,u,f,c,h,p){return s-d>c-f?function(o,b,l,T,_,w,k,L,M,I,P){for(var S=2*o,E=T,z=S*T;E<_;++E,z+=S){var R=w[b+z],q=w[b+z+o],V=k[E];e:for(var W=L,K=S*L;W<M;++W,K+=S){var $=P[W];if(!(I[b+K+o]<R||q<I[b+K])){for(var B=b+1;B<o;++B)if(w[B+o+z]<I[B+K]||I[B+o+K]<w[B+z])continue e;var J=l(V,$);if(void 0!==J)return J}}}}(t,a,r,d,s,i,u,f,c,h,p):function(o,b,l,T,_,w,k,L,M,I,P){for(var S=2*o,E=L,z=S*L;E<M;++E,z+=S){var R=I[b+z],q=I[b+z+o],V=P[E];e:for(var W=T,K=S*T;W<_;++W,K+=S){var $=k[W];if(!(q<w[b+K]||w[b+K+o]<R)){for(var B=b+1;B<o;++B)if(w[B+o+K]<I[B+z]||I[B+o+z]<w[B+K])continue e;var J=l($,V);if(void 0!==J)return J}}}}(t,a,r,d,s,i,u,f,c,h,p)}:function(t,a,r,d,s,i,u,f,c,h,p,o){return i-s>h-c?d?function(b,l,T,_,w,k,L,M,I,P,S){for(var E=2*b,z=_,R=E*_;z<w;++z,R+=E){var q=k[l+R],V=k[l+R+b],W=L[z];e:for(var K=M,G=E*M;K<I;++K,G+=E){var Y=P[l+G],$=S[K];if(!(Y<=q||V<Y)){for(var B=l+1;B<b;++B)if(k[B+b+R]<P[B+G]||P[B+b+G]<k[B+R])continue e;var J=T($,W);if(void 0!==J)return J}}}}(t,a,r,s,i,u,f,c,h,p,o):function(b,l,T,_,w,k,L,M,I,P,S){for(var E=2*b,z=_,R=E*_;z<w;++z,R+=E){var q=k[l+R],V=k[l+R+b],W=L[z];e:for(var K=M,G=E*M;K<I;++K,G+=E){var Y=P[l+G],$=S[K];if(!(Y<q||V<Y)){for(var B=l+1;B<b;++B)if(k[B+b+R]<P[B+G]||P[B+b+G]<k[B+R])continue e;var J=T(W,$);if(void 0!==J)return J}}}}(t,a,r,s,i,u,f,c,h,p,o):d?function(b,l,T,_,w,k,L,M,I,P,S){for(var E=2*b,z=M,R=E*M;z<I;++z,R+=E){var q=P[l+R],V=S[z];e:for(var W=_,K=E*_;W<w;++W,K+=E){var $=L[W];if(!(q<=k[l+K]||k[l+K+b]<q)){for(var B=l+1;B<b;++B)if(k[B+b+K]<P[B+R]||P[B+b+R]<k[B+K])continue e;var J=T(V,$);if(void 0!==J)return J}}}}(t,a,r,s,i,u,f,c,h,p,o):function(b,l,T,_,w,k,L,M,I,P,S){for(var E=2*b,z=M,R=E*M;z<I;++z,R+=E){var q=P[l+R],V=S[z];e:for(var W=_,K=E*_;W<w;++W,K+=E){var $=L[W];if(!(q<k[l+K]||k[l+K+b]<q)){for(var B=l+1;B<b;++B)if(k[B+b+K]<P[B+R]||P[B+b+R]<k[B+K])continue e;var J=T($,V);if(void 0!==J)return J}}}}(t,a,r,s,i,u,f,c,h,p,o)}}x.partial=e(!1),x.full=e(!0)},{}],37:[function(v,m,x){"use strict";m.exports=function(k,L,M,I,P,S,E,z,R){!function(Ae,ke){var Pe=8*n.log2(ke+1)*(Ae+1)|0,Ne=n.nextPow2(6*Pe);b.length<Ne&&(e.free(b),b=e.mallocInt32(Ne));var De=n.nextPow2(2*Pe);l.length<De&&(e.free(l),l=e.mallocDouble(De))}(k,I+E);var q,V=0,W=2*k;for(T(V++,0,0,I,0,E,M?16:0,-1/0,1/0),M||T(V++,0,0,E,0,I,1,-1/0,1/0);V>0;){var K=6*(V-=1),G=b[K],Y=b[K+1],$=b[K+2],B=b[K+3],N=b[K+4],U=b[K+5],te=2*V,j=l[te],J=l[te+1],X=1&U,re=!!(16&U),ne=P,le=S,oe=z,de=R;if(X&&(ne=z,le=R,oe=P,de=S),!(2&U&&($=c(k,G,Y,$,ne,le,J),Y>=$)||4&U&&(Y=h(k,G,Y,$,ne,le,j))>=$)){var se=$-Y,ge=N-B;if(re){if(k*se*(se+ge)<1<<22){if(void 0!==(q=d.scanComplete(k,G,L,Y,$,ne,le,B,N,oe,de)))return q;continue}}else{if(k*Math.min(se,ge)<128){if(void 0!==(q=a(k,G,L,X,Y,$,ne,le,B,N,oe,de)))return q;continue}if(k*se*ge<1<<22){if(void 0!==(q=d.scanBipartite(k,G,L,X,Y,$,ne,le,B,N,oe,de)))return q;continue}}var _e=u(k,G,Y,$,ne,le,j,J);if(Y<_e)if(k*(_e-Y)<128){if(void 0!==(q=r(k,G+1,L,Y,_e,ne,le,B,N,oe,de)))return q}else if(G===k-2){if(void 0!==(q=X?d.sweepBipartite(k,L,B,N,oe,de,Y,_e,ne,le):d.sweepBipartite(k,L,Y,_e,ne,le,B,N,oe,de)))return q}else T(V++,G+1,Y,_e,B,N,X,-1/0,1/0),T(V++,G+1,B,N,Y,_e,1^X,-1/0,1/0);if(_e<$){var Te=s(k,G,B,N,oe,de),we=oe[W*Te+G],Oe=f(k,G,Te,N,oe,de,we);if(Oe<N&&T(V++,G,_e,$,Oe,N,(4|X)+(re?16:0),we,J),B<Te&&T(V++,G,_e,$,B,Te,(2|X)+(re?16:0),j,we),Te+1===Oe){if(void 0!==(q=re?w(k,G,L,_e,$,ne,le,Te,oe,de[Te]):_(k,G,L,X,_e,$,ne,le,Te,oe,de[Te])))return q}else if(Te<Oe){var fe;if(re){if(_e<(fe=p(k,G,_e,$,ne,le,we))){var ve=f(k,G,_e,fe,ne,le,we);if(G===k-2){if(_e<ve&&void 0!==(q=d.sweepComplete(k,L,_e,ve,ne,le,Te,Oe,oe,de))||ve<fe&&void 0!==(q=d.sweepBipartite(k,L,ve,fe,ne,le,Te,Oe,oe,de)))return q}else _e<ve&&T(V++,G+1,_e,ve,Te,Oe,16,-1/0,1/0),ve<fe&&(T(V++,G+1,ve,fe,Te,Oe,0,-1/0,1/0),T(V++,G+1,Te,Oe,ve,fe,1,-1/0,1/0))}}else _e<(fe=X?o(k,G,_e,$,ne,le,we):p(k,G,_e,$,ne,le,we))&&(G===k-2?q=X?d.sweepBipartite(k,L,Te,Oe,oe,de,_e,fe,ne,le):d.sweepBipartite(k,L,_e,fe,ne,le,Te,Oe,oe,de):(T(V++,G+1,_e,fe,Te,Oe,X,-1/0,1/0),T(V++,G+1,Te,Oe,_e,fe,1^X,-1/0,1/0)))}}}}};var e=v("typedarray-pool"),n=v("bit-twiddle"),t=v("./brute"),a=t.partial,r=t.full,d=v("./sweep"),s=v("./median"),i=v("./partition"),u=i("!(lo>=p0)&&!(p1>=hi)"),f=i("lo===p0"),c=i("lo<p0"),h=i("hi<=p0"),p=i("lo<=p0&&p0<=hi"),o=i("lo<p0&&p0<=hi"),b=e.mallocInt32(1024),l=e.mallocDouble(1024);function T(k,L,M,I,P,S,E,z,R){var q=6*k;b[q]=L,b[q+1]=M,b[q+2]=I,b[q+3]=P,b[q+4]=S,b[q+5]=E;var V=2*k;l[V]=z,l[V+1]=R}function _(k,L,M,I,P,S,E,z,R,q,V){var W=2*k,K=R*W,G=q[K+L];e:for(var Y=P,$=P*W;Y<S;++Y,$+=W){var B=E[$+L],N=E[$+L+k];if(!(G<B||N<G||I&&G===B)){for(var U,te=z[Y],j=L+1;j<k;++j)if(B=E[$+j],(N=E[$+j+k])<q[K+j]||q[K+j+k]<B)continue e;if(void 0!==(U=I?M(V,te):M(te,V)))return U}}}function w(k,L,M,I,P,S,E,z,R,q){var V=2*k,W=z*V,K=R[W+L];e:for(var G=I,Y=I*V;G<P;++G,Y+=V){var $=E[G];if($!==q){var B=S[Y+L],N=S[Y+L+k];if(!(K<B||N<K)){for(var U=L+1;U<k;++U)if(B=S[Y+U],(N=S[Y+U+k])<R[W+U]||R[W+U+k]<B)continue e;var J=M($,q);if(void 0!==J)return J}}}}},{"./brute":36,"./median":38,"./partition":39,"./sweep":41,"bit-twiddle":32,"typedarray-pool":308}],38:[function(v,m,x){"use strict";m.exports=function(t,a,r,d,s,i){if(d<=r+1)return r;for(var u=r,f=d,c=d+r>>>1,h=2*t,p=c,o=s[h*c+a];u<f;){if(f-u<8){n(t,a,u,f,s,i),o=s[h*c+a];break}var b=f-u,l=Math.random()*b+u|0,T=s[h*l+a],_=Math.random()*b+u|0,w=s[h*_+a],k=Math.random()*b+u|0,L=s[h*k+a];T<=w?L>=w?(p=_,o=w):T>=L?(p=l,o=T):(p=k,o=L):w>=L?(p=_,o=w):L>=T?(p=l,o=T):(p=k,o=L);for(var M=h*(f-1),I=h*p,P=0;P<h;++P,++M,++I){var S=s[M];s[M]=s[I],s[I]=S}var E=i[f-1];for(i[f-1]=i[p],i[p]=E,M=h*(f-1),I=h*(p=e(t,a,u,f-1,s,i,o)),P=0;P<h;++P,++M,++I)S=s[M],s[M]=s[I],s[I]=S;if(E=i[f-1],i[f-1]=i[p],i[p]=E,c<p){for(f=p-1;u<f&&s[h*(f-1)+a]===o;)f-=1;f+=1}else{if(!(p<c))break;for(u=p+1;u<f&&s[h*u+a]===o;)u+=1}}return e(t,a,r,c,s,i,s[h*c+a])};var e=v("./partition")("lo<p0");function n(t,a,r,d,s,i){for(var u=2*t,f=u*(r+1)+a,c=r+1;c<d;++c,f+=u)for(var h=s[f],p=c,o=u*(c-1);p>r&&s[o+a]>h;--p,o-=u){for(var b=o,l=o+u,T=0;T<u;++T,++b,++l){var _=s[b];s[b]=s[l],s[l]=_}var w=i[p];i[p]=i[p-1],i[p-1]=w}}},{"./partition":39}],39:[function(v,m,x){"use strict";m.exports=function(n){return e[n]};var e={"lo===p0":function(n,t,a,r,d,s,i){for(var u=2*n,f=u*a,c=f,h=a,p=t,o=a;r>o;++o,f+=u)if(d[f+p]===i)if(h===o)h+=1,c+=u;else{for(var b=0;u>b;++b){var l=d[f+b];d[f+b]=d[c],d[c++]=l}var T=s[o];s[o]=s[h],s[h++]=T}return h},"lo<p0":function(n,t,a,r,d,s,i){for(var u=2*n,f=u*a,c=f,h=a,p=t,o=a;r>o;++o,f+=u)if(d[f+p]<i)if(h===o)h+=1,c+=u;else{for(var b=0;u>b;++b){var l=d[f+b];d[f+b]=d[c],d[c++]=l}var T=s[o];s[o]=s[h],s[h++]=T}return h},"lo<=p0":function(n,t,a,r,d,s,i){for(var u=2*n,f=u*a,c=f,h=a,p=n+t,o=a;r>o;++o,f+=u)if(d[f+p]<=i)if(h===o)h+=1,c+=u;else{for(var b=0;u>b;++b){var l=d[f+b];d[f+b]=d[c],d[c++]=l}var T=s[o];s[o]=s[h],s[h++]=T}return h},"hi<=p0":function(n,t,a,r,d,s,i){for(var u=2*n,f=u*a,c=f,h=a,p=n+t,o=a;r>o;++o,f+=u)if(d[f+p]<=i)if(h===o)h+=1,c+=u;else{for(var b=0;u>b;++b){var l=d[f+b];d[f+b]=d[c],d[c++]=l}var T=s[o];s[o]=s[h],s[h++]=T}return h},"lo<p0&&p0<=hi":function(n,t,a,r,d,s,i){for(var u=2*n,f=u*a,c=f,h=a,p=t,o=n+t,b=a;r>b;++b,f+=u)if(d[f+p]<i&&i<=d[f+o])if(h===b)h+=1,c+=u;else{for(var _=0;u>_;++_){var w=d[f+_];d[f+_]=d[c],d[c++]=w}var k=s[b];s[b]=s[h],s[h++]=k}return h},"lo<=p0&&p0<=hi":function(n,t,a,r,d,s,i){for(var u=2*n,f=u*a,c=f,h=a,p=t,o=n+t,b=a;r>b;++b,f+=u)if(d[f+p]<=i&&i<=d[f+o])if(h===b)h+=1,c+=u;else{for(var _=0;u>_;++_){var w=d[f+_];d[f+_]=d[c],d[c++]=w}var k=s[b];s[b]=s[h],s[h++]=k}return h},"!(lo>=p0)&&!(p1>=hi)":function(n,t,a,r,d,s,i,u){for(var f=2*n,c=f*a,h=c,p=a,o=t,b=n+t,l=a;r>l;++l,c+=f)if(!(d[c+o]>=i||u>=d[c+b]))if(p===l)p+=1,h+=f;else{for(var w=0;f>w;++w){var k=d[c+w];d[c+w]=d[h],d[h++]=k}var L=s[l];s[l]=s[p],s[p++]=L}return p}}},{}],40:[function(v,m,x){"use strict";function e(i,u,f){for(var c=2*(i+1),h=i+1;h<=u;++h){for(var p=f[c++],o=f[c++],b=h,l=c-2;b-- >i;){var T=f[l-2],_=f[l-1];if(T<p||T===p&&_<o)break;f[l]=T,f[l+1]=_,l-=2}f[l]=p,f[l+1]=o}}function n(i,u,f){var c=f[i*=2],h=f[i+1];f[i]=f[u*=2],f[i+1]=f[u+1],f[u]=c,f[u+1]=h}function t(i,u,f){f[i*=2]=f[u*=2],f[i+1]=f[u+1]}function a(i,u,f,c){f*=2;var h=c[i*=2],p=c[i+1];c[i]=c[u*=2],c[i+1]=c[u+1],c[u]=c[f],c[u+1]=c[f+1],c[f]=h,c[f+1]=p}function r(i,u,f,c,h){h[i*=2]=h[u*=2],h[u]=f,h[i+1]=h[u+1],h[u+1]=c}function d(i,u,f){var c=f[i*=2],h=f[u*=2];return!(c<h)&&(c!==h||f[i+1]>f[u+1])}function s(i,u,f,c){var h=c[i*=2];return h<u||h===u&&c[i+1]<f}m.exports=function(i,u){u<=128?e(0,u-1,i):function f(c,h,p){var o=(h-c+1)/6|0,b=c+o,l=h-o,T=c+h>>1,_=T-o,w=T+o,k=b,L=_,M=T,I=w,P=l,S=c+1,E=h-1,z=0;d(k,L,p)&&(z=k,k=L,L=z),d(I,P,p)&&(z=I,I=P,P=z),d(k,M,p)&&(z=k,k=M,M=z),d(L,M,p)&&(z=L,L=M,M=z),d(k,I,p)&&(z=k,k=I,I=z),d(M,I,p)&&(z=M,M=I,I=z),d(L,P,p)&&(z=L,L=P,P=z),d(L,M,p)&&(z=L,L=M,M=z),d(I,P,p)&&(z=I,I=P,P=z);for(var R=p[2*L],q=p[2*L+1],V=p[2*I],W=p[2*I+1],K=2*k,G=2*M,Y=2*P,$=2*b,B=2*T,N=2*l,U=0;U<2;++U){var j=p[G+U],J=p[Y+U];p[$+U]=p[K+U],p[B+U]=j,p[N+U]=J}t(_,c,p),t(w,h,p);for(var X=S;X<=E;++X)if(s(X,R,q,p))X!==S&&n(X,S,p),++S;else if(!s(X,V,W,p))for(;;){if(s(E,V,W,p)){s(E,R,q,p)?(a(X,S,E,p),++S,--E):(n(X,E,p),--E);break}if(--E<X)break}r(c,S-1,R,q,p),r(h,E+1,V,W,p),S-2-c<=32?e(c,S-2,p):f(c,S-2,p),h-(E+2)<=32?e(E+2,h,p):f(E+2,h,p),E-S<=32?e(S,E,p):f(S,E,p)}(0,u-1,i)}},{}],41:[function(v,m,x){"use strict";m.exports={init:function(p){var o=n.nextPow2(p);a.length<o&&(e.free(a),a=e.mallocInt32(o)),r.length<o&&(e.free(r),r=e.mallocInt32(o)),d.length<o&&(e.free(d),d=e.mallocInt32(o)),s.length<o&&(e.free(s),s=e.mallocInt32(o)),i.length<o&&(e.free(i),i=e.mallocInt32(o)),u.length<o&&(e.free(u),u=e.mallocInt32(o));var b=8*o;f.length<b&&(e.free(f),f=e.mallocDouble(b))},sweepBipartite:function(p,o,b,l,T,_,w,k,L,M){for(var I=0,P=2*p,S=p-1,E=P-1,z=b;z<l;++z){var R=_[z],q=P*z;f[I++]=T[q+S],f[I++]=-(R+1),f[I++]=T[q+E],f[I++]=R}for(z=w;z<k;++z){R=M[z]+(1<<28);var V=P*z;f[I++]=L[V+S],f[I++]=-R,f[I++]=L[V+E],f[I++]=R}var W=I>>>1;t(f,W);var K=0,G=0;for(z=0;z<W;++z){var Y=0|f[2*z+1];if(Y>=1<<28)c(d,s,G--,Y=Y-(1<<28)|0);else if(Y>=0)c(a,r,K--,Y);else if(Y<=-(1<<28)){Y=-Y-(1<<28)|0;for(var $=0;$<K;++$)if(void 0!==(B=o(a[$],Y)))return B;h(d,s,G++,Y)}else{for(Y=-Y-1|0,$=0;$<G;++$){var B;if(void 0!==(B=o(Y,d[$])))return B}h(a,r,K++,Y)}}},sweepComplete:function(p,o,b,l,T,_,w,k,L,M){for(var I=0,P=2*p,S=p-1,E=P-1,z=b;z<l;++z){var R=_[z]+1<<1,q=P*z;f[I++]=T[q+S],f[I++]=-R,f[I++]=T[q+E],f[I++]=R}for(z=w;z<k;++z){R=M[z]+1<<1;var V=P*z;f[I++]=L[V+S],f[I++]=1|-R,f[I++]=L[V+E],f[I++]=1|R}var W=I>>>1;t(f,W);var K=0,G=0,Y=0;for(z=0;z<W;++z){var $=0|f[2*z+1],B=1&$;if(z<W-1&&$>>1==f[2*z+3]>>1&&(B=2,z+=1),$<0){for(var N=-($>>1)-1,U=0;U<Y;++U)if(void 0!==(te=o(i[U],N)))return te;if(0!==B)for(U=0;U<K;++U)if(void 0!==(te=o(a[U],N)))return te;if(1!==B)for(U=0;U<G;++U){var te;if(void 0!==(te=o(d[U],N)))return te}0===B?h(a,r,K++,N):1===B?h(d,s,G++,N):2===B&&h(i,u,Y++,N)}else N=($>>1)-1,0===B?c(a,r,K--,N):1===B?c(d,s,G--,N):2===B&&c(i,u,Y--,N)}},scanBipartite:function(p,o,b,l,T,_,w,k,L,M,I,P){var S=0,E=2*p,z=o,R=o+p,q=1,V=1;l?V=1<<28:q=1<<28;for(var W=T;W<_;++W){var K=W+q,G=E*W;f[S++]=w[G+z],f[S++]=-K,f[S++]=w[G+R],f[S++]=K}for(W=L;W<M;++W)K=W+V,f[S++]=I[E*W+z],f[S++]=-K;var $=S>>>1;t(f,$);var B=0;for(W=0;W<$;++W){var N=0|f[2*W+1];if(N<0){var U=!1;if((K=-N)>=1<<28?(U=!l,K-=1<<28):(U=!!l,K-=1),U)h(a,r,B++,K);else{var te=P[K],j=E*K,J=I[j+o+1],X=I[j+o+1+p];e:for(var re=0;re<B;++re){var ne=a[re],le=E*ne;if(!(X<w[le+o+1]||w[le+o+1+p]<J)){for(var oe=o+2;oe<p;++oe)if(I[j+oe+p]<w[le+oe]||w[le+oe+p]<I[j+oe])continue e;var de,se=k[ne];if(void 0!==(de=l?b(te,se):b(se,te)))return de}}}}else c(a,r,B--,N-q)}},scanComplete:function(p,o,b,l,T,_,w,k,L,M,I){for(var P=0,S=2*p,E=o,z=o+p,R=l;R<T;++R){var q=R+268435456,V=S*R;f[P++]=_[V+E],f[P++]=-q,f[P++]=_[V+z],f[P++]=q}for(R=k;R<L;++R)q=R+1,f[P++]=M[S*R+E],f[P++]=-q;var K=P>>>1;t(f,K);var G=0;for(R=0;R<K;++R){var Y=0|f[2*R+1];if(Y<0)if((q=-Y)>=1<<28)a[G++]=q-(1<<28);else{var $=I[q-=1],B=S*q,N=M[B+o+1],U=M[B+o+1+p];e:for(var te=0;te<G;++te){var j=a[te],J=w[j];if(J===$)break;var X=S*j;if(!(U<_[X+o+1]||_[X+o+1+p]<N)){for(var re=o+2;re<p;++re)if(M[B+re+p]<_[X+re]||_[X+re+p]<M[B+re])continue e;var ne=b(J,$);if(void 0!==ne)return ne}}}else{for(q=Y-(1<<28),te=G-1;te>=0;--te)if(a[te]===q){for(re=te+1;re<G;++re)a[re-1]=a[re];break}--G}}}};var e=v("typedarray-pool"),n=v("bit-twiddle"),t=v("./sort"),a=e.mallocInt32(1024),r=e.mallocInt32(1024),d=e.mallocInt32(1024),s=e.mallocInt32(1024),i=e.mallocInt32(1024),u=e.mallocInt32(1024),f=e.mallocDouble(8192);function c(p,o,b,l){var T=o[l],_=p[b-1];p[T]=_,o[_]=T}function h(p,o,b,l){p[b]=l,o[l]=b}},{"./sort":40,"bit-twiddle":32,"typedarray-pool":308}],42:[function(v,m,x){"use strict";var e=v("./lib/monotone"),n=v("./lib/triangulation"),t=v("./lib/delaunay"),a=v("./lib/filter");function r(i){return[Math.min(i[0],i[1]),Math.max(i[0],i[1])]}function d(i,u){return i[0]-u[0]||i[1]-u[1]}function s(i,u,f){return u in i?i[u]:f}m.exports=function(i,u,f){Array.isArray(u)?(f=f||{},u=u||[]):(f=u||{},u=[]);var c=!!s(f,"delaunay",!0),h=!!s(f,"interior",!0),p=!!s(f,"exterior",!0),o=!!s(f,"infinity",!1);if(!h&&!p||0===i.length)return[];var b=e(i,u);if(c||h!==p||o){for(var l=n(i.length,u.map(r).sort(d)),T=0;T<b.length;++T){var _=b[T];l.addTriangle(_[0],_[1],_[2])}return c&&t(i,l),p?h?o?a(l,0,o):l.cells():a(l,1,o):a(l,-1)}return b}},{"./lib/delaunay":43,"./lib/filter":44,"./lib/monotone":45,"./lib/triangulation":46}],43:[function(v,m,x){"use strict";var e=v("robust-in-sphere")[4];function n(t,a,r,d,s,i){var u=a.opposite(d,s);if(!(u<0)){if(s<d){var f=d;d=s,s=f,f=i,i=u,u=f}a.isConstraint(d,s)||e(t[d],t[s],t[i],t[u])<0&&r.push(d,s)}}v("binary-search-bounds"),m.exports=function(t,a){for(var r=[],d=t.length,s=a.stars,i=0;i<d;++i)for(var u=s[i],f=1;f<u.length;f+=2)if(!((o=u[f])<i||a.isConstraint(i,o))){for(var c=u[f-1],h=-1,p=1;p<u.length;p+=2)if(u[p-1]===o){h=u[p];break}h<0||e(t[i],t[o],t[c],t[h])<0&&r.push(i,o)}for(;r.length>0;){for(var o=r.pop(),b=(c=-1,h=-1,u=s[i=r.pop()],1);b<u.length;b+=2){var l=u[b-1],T=u[b];l===o?h=T:T===o&&(c=l)}c<0||h<0||e(t[i],t[o],t[c],t[h])>=0||(a.flip(i,o),n(t,a,r,c,i,h),n(t,a,r,i,h,c),n(t,a,r,h,o,c),n(t,a,r,o,c,h))}}},{"binary-search-bounds":31,"robust-in-sphere":282}],44:[function(v,m,x){"use strict";var e,n=v("binary-search-bounds");function t(r,d,s,i,u,f,c){this.cells=r,this.neighbor=d,this.flags=i,this.constraint=s,this.active=u,this.next=f,this.boundary=c}function a(r,d){return r[0]-d[0]||r[1]-d[1]||r[2]-d[2]}m.exports=function(r,d,s){var i=function(L,M){for(var I=L.cells(),P=I.length,S=0;S<P;++S){var E=(B=I[S])[0],z=B[1],R=B[2];z<R?z<E&&(B[0]=z,B[1]=R,B[2]=E):R<E&&(B[0]=R,B[1]=E,B[2]=z)}I.sort(a);var q=new Array(P);for(S=0;S<q.length;++S)q[S]=0;var V=[],W=[],K=new Array(3*P),G=new Array(3*P),Y=null;M&&(Y=[]);var $=new t(I,K,G,q,V,W,Y);for(S=0;S<P;++S)for(var B=I[S],N=0;N<3;++N){var U=K[3*S+N]=$.locate(z=B[(N+1)%3],E=B[N],L.opposite(z,E)),te=G[3*S+N]=L.isConstraint(E,z);U<0&&(te?W.push(S):(V.push(S),q[S]=1),M&&Y.push([z,E,-1]))}return $}(r,s);if(0===d)return s?i.cells.concat(i.boundary):i.cells;for(var u=1,f=i.active,c=i.next,h=i.flags,p=i.cells,o=i.constraint,b=i.neighbor;f.length>0||c.length>0;){for(;f.length>0;){var l=f.pop();if(h[l]!==-u){h[l]=u;for(var T=0;T<3;++T){var _=b[3*l+T];_>=0&&0===h[_]&&(o[3*l+T]?c.push(_):(f.push(_),h[_]=u))}}}var w=c;c=f,f=w,c.length=0,u=-u}var k=function(L,M,I){for(var P=0,S=0;S<L.length;++S)M[S]===I&&(L[P++]=L[S]);return L.length=P,L}(p,h,d);return s?k.concat(i.boundary):k},t.prototype.locate=(e=[0,0,0],function(r,d,s){var i=r,u=d,f=s;return d<s?d<r&&(i=d,u=s,f=r):s<r&&(i=s,u=r,f=d),i<0?-1:(e[0]=i,e[1]=u,e[2]=f,n.eq(this.cells,e,a))})},{"binary-search-bounds":31}],45:[function(v,m,x){"use strict";var e=v("binary-search-bounds"),n=v("robust-orientation")[3];function t(c,h,p,o,b){this.a=c,this.b=h,this.idx=p,this.lowerIds=o,this.upperIds=b}function a(c,h,p,o){this.a=c,this.b=h,this.type=p,this.idx=o}function r(c,h){var p=c.a[0]-h.a[0]||c.a[1]-h.a[1]||c.type-h.type;return p||(0!==c.type&&(p=n(c.a,c.b,h.b))?p:c.idx-h.idx)}function d(c,h){return n(c.a,c.b,h)}function s(c,h,p,o,b){for(var l=e.lt(h,o,d),T=e.gt(h,o,d),_=l;_<T;++_){for(var w=h[_],k=w.lowerIds,L=k.length;L>1&&n(p[k[L-2]],p[k[L-1]],o)>0;)c.push([k[L-1],k[L-2],b]),L-=1;k.length=L,k.push(b);var M=w.upperIds;for(L=M.length;L>1&&n(p[M[L-2]],p[M[L-1]],o)<0;)c.push([M[L-2],M[L-1],b]),L-=1;M.length=L,M.push(b)}}function i(c,h){var p;return(p=c.a[0]<h.a[0]?n(c.a,c.b,h.a):n(h.b,h.a,c.a))?p:(p=h.b[0]<c.b[0]?n(c.a,c.b,h.b):n(h.b,h.a,c.b))||c.idx-h.idx}function u(c,h,p){var o=e.le(c,p,i),b=c[o],l=b.upperIds,T=l[l.length-1];b.upperIds=[T],c.splice(o+1,0,new t(p.a,p.b,p.idx,[T],l))}function f(c,h,p){var o=p.a;p.a=p.b,p.b=o;var b=e.eq(c,p,i);c[b-1].upperIds=c[b].upperIds,c.splice(b,1)}m.exports=function(c,h){for(var p=c.length,o=h.length,b=[],l=0;l<p;++l)b.push(new a(c[l],null,0,l));for(l=0;l<o;++l){var T=h[l],_=c[T[0]],w=c[T[1]];_[0]<w[0]?b.push(new a(_,w,2,l),new a(w,_,1,l)):_[0]>w[0]&&b.push(new a(w,_,2,l),new a(_,w,1,l))}b.sort(r);for(var k=b[0].a[0]-(1+Math.abs(b[0].a[0]))*Math.pow(2,-52),L=[new t([k,1],[k,0],-1,[],[],[],[])],M=[],I=(l=0,b.length);l<I;++l){var P=b[l],S=P.type;0===S?s(M,L,c,P.a,P.idx):2===S?u(L,0,P):f(L,0,P)}return M}},{"binary-search-bounds":31,"robust-orientation":284}],46:[function(v,m,x){"use strict";var e=v("binary-search-bounds");function n(r,d){this.stars=r,this.edges=d}m.exports=function(r,d){for(var s=new Array(r),i=0;i<r;++i)s[i]=[];return new n(s,d)};var t=n.prototype;function a(r,d,s){for(var i=1,u=r.length;i<u;i+=2)if(r[i-1]===d&&r[i]===s)return r[i-1]=r[u-2],r[i]=r[u-1],void(r.length=u-2)}t.isConstraint=function(){var r=[0,0];function d(s,i){return s[0]-i[0]||s[1]-i[1]}return function(s,i){return r[0]=Math.min(s,i),r[1]=Math.max(s,i),e.eq(this.edges,r,d)>=0}}(),t.removeTriangle=function(r,d,s){var i=this.stars;a(i[r],d,s),a(i[d],s,r),a(i[s],r,d)},t.addTriangle=function(r,d,s){var i=this.stars;i[r].push(d,s),i[d].push(s,r),i[s].push(r,d)},t.opposite=function(r,d){for(var s=this.stars[d],i=1,u=s.length;i<u;i+=2)if(s[i]===r)return s[i-1];return-1},t.flip=function(r,d){var s=this.opposite(r,d),i=this.opposite(d,r);this.removeTriangle(r,d,s),this.removeTriangle(d,r,i),this.addTriangle(r,i,s),this.addTriangle(d,s,i)},t.edges=function(){for(var r=this.stars,d=[],s=0,i=r.length;s<i;++s)for(var u=r[s],f=0,c=u.length;f<c;f+=2)d.push([u[f],u[f+1]]);return d},t.cells=function(){for(var r=this.stars,d=[],s=0,i=r.length;s<i;++s)for(var u=r[s],f=0,c=u.length;f<c;f+=2){var h=u[f],p=u[f+1];s<Math.min(h,p)&&d.push([s,h,p])}return d}},{"binary-search-bounds":31}],47:[function(v,m,x){"use strict";m.exports=function(e){for(var n=1,t=1;t<e.length;++t)for(var a=0;a<t;++a)if(e[t]<e[a])n=-n;else if(e[a]===e[t])return 0;return n}},{}],48:[function(v,m,x){"use strict";var e=v("dup"),n=v("robust-linear-solve");function t(d,s){for(var i=0,u=d.length,f=0;f<u;++f)i+=d[f]*s[f];return i}function a(d){var s=d.length;if(0===s)return[];var i=e([d.length+1,d.length+1],1),u=e([d.length+1],1);i[s][s]=0;for(var f=0;f<s;++f){for(var c=0;c<=f;++c)i[c][f]=i[f][c]=2*t(d[f],d[c]);u[f]=t(d[f],d[f])}var h=n(i,u),p=0,o=h[s+1];for(f=0;f<o.length;++f)p+=o[f];var b=new Array(s);for(f=0;f<s;++f){o=h[f];var l=0;for(c=0;c<o.length;++c)l+=o[c];b[f]=l/p}return b}function r(d){if(0===d.length)return[];for(var s=d[0].length,i=e([s]),u=a(d),f=0;f<d.length;++f)for(var c=0;c<s;++c)i[c]+=d[f][c]*u[f];return i}r.barycenetric=a,m.exports=r},{dup:65,"robust-linear-solve":283}],49:[function(v,m,x){m.exports=function(n){for(var t=e(n),a=0,r=0;r<n.length;++r)for(var d=n[r],s=0;s<t.length;++s)a+=Math.pow(d[s]-t[s],2);return Math.sqrt(a/n.length)};var e=v("circumcenter")},{circumcenter:48}],50:[function(v,m,x){"use strict";m.exports=function(T,_,w){var k,S,z,R;if(w){k=_;for(var L=new Array(_.length),M=0;M<_.length;++M){var I=_[M];L[M]=[I[0],I[1],w[M]]}_=L}for(var P=(z=!!w,void 0,b(_,R=h(S=T,[],c(S)),z),!!R);l(T,_,!!w);)P=!0;if(w&&P)for(k.length=0,w.length=0,M=0;M<_.length;++M)k.push([(I=_[M])[0],I[1]]),w.push(I[2]);return P};var e=v("union-find"),n=v("box-intersect"),t=v("robust-segment-intersect"),a=v("big-rat"),r=v("big-rat/cmp"),d=v("big-rat/to-float"),s=v("rat-vec"),i=v("nextafter"),u=v("./lib/rat-seg-intersect");function f(T){var _=d(T);return[i(_,-1/0),i(_,1/0)]}function c(T){for(var _=new Array(T.length),w=0;w<T.length;++w){var k=T[w];_[w]=[i(k[0],-1/0),i(k[1],-1/0),i(k[0],1/0),i(k[1],1/0)]}return _}function h(T,_,w){for(var k=_.length,L=new e(k),M=[],I=0;I<_.length;++I){var P=_[I],S=f(P[0]),E=f(P[1]);M.push([i(S[0],-1/0),i(E[0],-1/0),i(S[1],1/0),i(E[1],1/0)])}n(M,function(W,K){L.link(W,K)});var z=!0,R=new Array(k);for(I=0;I<k;++I)(V=L.find(I))!==I&&(z=!1,T[V]=[Math.min(T[I][0],T[V][0]),Math.min(T[I][1],T[V][1])]);if(z)return null;var q=0;for(I=0;I<k;++I){var V;(V=L.find(I))===I?(R[I]=q,T[q++]=T[I]):R[I]=-1}for(T.length=q,I=0;I<k;++I)R[I]<0&&(R[I]=R[L.find(I)]);return R}function p(T,_){return T[0]-_[0]||T[1]-_[1]}function o(T,_){return T[0]-_[0]||T[1]-_[1]||(T[2]<_[2]?-1:T[2]>_[2]?1:0)}function b(T,_,w){if(0!==T.length){if(_)for(var k=0;k<T.length;++k){var L=_[(I=T[k])[0]],M=_[I[1]];I[0]=Math.min(L,M),I[1]=Math.max(L,M)}else for(k=0;k<T.length;++k){var I;L=(I=T[k])[0],M=I[1],I[0]=Math.min(L,M),I[1]=Math.max(L,M)}T.sort(w?o:p);var P=1;for(k=1;k<T.length;++k){var S=T[k-1],E=T[k];(E[0]!==S[0]||E[1]!==S[1]||w&&E[2]!==S[2])&&(T[P++]=E)}T.length=P}}function l(T,_,w){var S,E,R,k=function(S,E){for(var z=new Array(E.length),R=0;R<E.length;++R){var q=E[R],V=S[q[0]],W=S[q[1]];z[R]=[i(Math.min(V[0],W[0]),-1/0),i(Math.min(V[1],W[1]),-1/0),i(Math.max(V[0],W[0]),1/0),i(Math.max(V[1],W[1]),1/0)]}return z}(T,_),L=(S=T,E=_,R=[],n(k,function(q,V){var W=E[q],K=E[V];W[0]!==K[0]&&W[0]!==K[1]&&W[1]!==K[0]&&W[1]!==K[1]&&t(S[W[0]],S[W[1]],S[K[0]],S[K[1]])&&R.push([q,V])}),R),I=function(S,E,z,R){var q=[];return n(z,R,function(V,W){var K=E[V];if(K[0]!==W&&K[1]!==W){var G=S[W];t(S[K[0]],S[K[1]],G,G)&&q.push([V,W])}}),q}(T,_,k,c(T)),P=h(T,function(S,E,z,R,q){var V,W,K=S.map(function(ge){return[a(ge[0]),a(ge[1])]});for(V=0;V<z.length;++V){var G=z[V],Y=G[1],$=E[W=G[0]],B=E[Y],N=u(s(S[$[0]]),s(S[$[1]]),s(S[B[0]]),s(S[B[1]]));if(N){var U=S.length;S.push([d(N[0]),d(N[1])]),K.push(N),R.push([W,U],[Y,U])}}for(R.sort(function(ge,_e){if(ge[0]!==_e[0])return ge[0]-_e[0];var Te=K[ge[1]],we=K[_e[1]];return r(Te[0],we[0])||r(Te[1],we[1])}),V=R.length-1;V>=0;--V){var te=E[W=(de=R[V])[0]],j=te[0],J=te[1],X=S[j],re=S[J];if((X[0]-re[0]||X[1]-re[1])<0){var ne=j;j=J,J=ne}te[0]=j;var le,oe=te[1]=de[1];for(q&&(le=te[2]);V>0&&R[V-1][0]===W;){var de,se=(de=R[--V])[1];E.push(q?[oe,se,le]:[oe,se]),oe=se}E.push(q?[oe,J,le]:[oe,J])}return K}(T,_,L,I,w));return b(_,P,w),!!P||L.length>0||I.length>0}},{"./lib/rat-seg-intersect":51,"big-rat":18,"big-rat/cmp":16,"big-rat/to-float":30,"box-intersect":35,nextafter:260,"rat-vec":273,"robust-segment-intersect":287,"union-find":309}],51:[function(v,m,x){"use strict";m.exports=function(u,f,c,h){var p=r(f,u),o=r(h,c),b=i(p,o);if(0===a(b))return null;var T=i(o,r(u,c)),_=n(T,b),w=s(p,_);return d(u,w)};var e=v("big-rat/mul"),n=v("big-rat/div"),t=v("big-rat/sub"),a=v("big-rat/sign"),r=v("rat-vec/sub"),d=v("rat-vec/add"),s=v("rat-vec/muls");function i(u,f){return t(e(u[0],f[1]),e(u[1],f[0]))}},{"big-rat/div":17,"big-rat/mul":27,"big-rat/sign":28,"big-rat/sub":29,"rat-vec/add":272,"rat-vec/muls":274,"rat-vec/sub":275}],52:[function(v,m,x){m.exports={jet:[{index:0,rgb:[0,0,131]},{index:.125,rgb:[0,60,170]},{index:.375,rgb:[5,255,255]},{index:.625,rgb:[255,255,0]},{index:.875,rgb:[250,0,0]},{index:1,rgb:[128,0,0]}],hsv:[{index:0,rgb:[255,0,0]},{index:.169,rgb:[253,255,2]},{index:.173,rgb:[247,255,2]},{index:.337,rgb:[0,252,4]},{index:.341,rgb:[0,252,10]},{index:.506,rgb:[1,249,255]},{index:.671,rgb:[2,0,253]},{index:.675,rgb:[8,0,253]},{index:.839,rgb:[255,0,251]},{index:.843,rgb:[255,0,245]},{index:1,rgb:[255,0,6]}],hot:[{index:0,rgb:[0,0,0]},{index:.3,rgb:[230,0,0]},{index:.6,rgb:[255,210,0]},{index:1,rgb:[255,255,255]}],spring:[{index:0,rgb:[255,0,255]},{index:1,rgb:[255,255,0]}],summer:[{index:0,rgb:[0,128,102]},{index:1,rgb:[255,255,102]}],autumn:[{index:0,rgb:[255,0,0]},{index:1,rgb:[255,255,0]}],winter:[{index:0,rgb:[0,0,255]},{index:1,rgb:[0,255,128]}],bone:[{index:0,rgb:[0,0,0]},{index:.376,rgb:[84,84,116]},{index:.753,rgb:[169,200,200]},{index:1,rgb:[255,255,255]}],copper:[{index:0,rgb:[0,0,0]},{index:.804,rgb:[255,160,102]},{index:1,rgb:[255,199,127]}],greys:[{index:0,rgb:[0,0,0]},{index:1,rgb:[255,255,255]}],yignbu:[{index:0,rgb:[8,29,88]},{index:.125,rgb:[37,52,148]},{index:.25,rgb:[34,94,168]},{index:.375,rgb:[29,145,192]},{index:.5,rgb:[65,182,196]},{index:.625,rgb:[127,205,187]},{index:.75,rgb:[199,233,180]},{index:.875,rgb:[237,248,217]},{index:1,rgb:[255,255,217]}],greens:[{index:0,rgb:[0,68,27]},{index:.125,rgb:[0,109,44]},{index:.25,rgb:[35,139,69]},{index:.375,rgb:[65,171,93]},{index:.5,rgb:[116,196,118]},{index:.625,rgb:[161,217,155]},{index:.75,rgb:[199,233,192]},{index:.875,rgb:[229,245,224]},{index:1,rgb:[247,252,245]}],yiorrd:[{index:0,rgb:[128,0,38]},{index:.125,rgb:[189,0,38]},{index:.25,rgb:[227,26,28]},{index:.375,rgb:[252,78,42]},{index:.5,rgb:[253,141,60]},{index:.625,rgb:[254,178,76]},{index:.75,rgb:[254,217,118]},{index:.875,rgb:[255,237,160]},{index:1,rgb:[255,255,204]}],bluered:[{index:0,rgb:[0,0,255]},{index:1,rgb:[255,0,0]}],rdbu:[{index:0,rgb:[5,10,172]},{index:.35,rgb:[106,137,247]},{index:.5,rgb:[190,190,190]},{index:.6,rgb:[220,170,132]},{index:.7,rgb:[230,145,90]},{index:1,rgb:[178,10,28]}],picnic:[{index:0,rgb:[0,0,255]},{index:.1,rgb:[51,153,255]},{index:.2,rgb:[102,204,255]},{index:.3,rgb:[153,204,255]},{index:.4,rgb:[204,204,255]},{index:.5,rgb:[255,255,255]},{index:.6,rgb:[255,204,255]},{index:.7,rgb:[255,153,255]},{index:.8,rgb:[255,102,204]},{index:.9,rgb:[255,102,102]},{index:1,rgb:[255,0,0]}],rainbow:[{index:0,rgb:[150,0,90]},{index:.125,rgb:[0,0,200]},{index:.25,rgb:[0,25,255]},{index:.375,rgb:[0,152,255]},{index:.5,rgb:[44,255,150]},{index:.625,rgb:[151,255,0]},{index:.75,rgb:[255,234,0]},{index:.875,rgb:[255,111,0]},{index:1,rgb:[255,0,0]}],portland:[{index:0,rgb:[12,51,131]},{index:.25,rgb:[10,136,186]},{index:.5,rgb:[242,211,56]},{index:.75,rgb:[242,143,56]},{index:1,rgb:[217,30,30]}],blackbody:[{index:0,rgb:[0,0,0]},{index:.2,rgb:[230,0,0]},{index:.4,rgb:[230,210,0]},{index:.7,rgb:[255,255,255]},{index:1,rgb:[160,200,255]}],earth:[{index:0,rgb:[0,0,130]},{index:.1,rgb:[0,180,180]},{index:.2,rgb:[40,210,40]},{index:.4,rgb:[230,230,50]},{index:.6,rgb:[120,70,20]},{index:1,rgb:[255,255,255]}],electric:[{index:0,rgb:[0,0,0]},{index:.15,rgb:[30,0,100]},{index:.4,rgb:[120,0,100]},{index:.6,rgb:[160,90,0]},{index:.8,rgb:[230,200,0]},{index:1,rgb:[255,250,220]}],alpha:[{index:0,rgb:[255,255,255,0]},{index:1,rgb:[255,255,255,1]}],viridis:[{index:0,rgb:[68,1,84]},{index:.13,rgb:[71,44,122]},{index:.25,rgb:[59,81,139]},{index:.38,rgb:[44,113,142]},{index:.5,rgb:[33,144,141]},{index:.63,rgb:[39,173,129]},{index:.75,rgb:[92,200,99]},{index:.88,rgb:[170,220,50]},{index:1,rgb:[253,231,37]}],inferno:[{index:0,rgb:[0,0,4]},{index:.13,rgb:[31,12,72]},{index:.25,rgb:[85,15,109]},{index:.38,rgb:[136,34,106]},{index:.5,rgb:[186,54,85]},{index:.63,rgb:[227,89,51]},{index:.75,rgb:[249,140,10]},{index:.88,rgb:[249,201,50]},{index:1,rgb:[252,255,164]}],magma:[{index:0,rgb:[0,0,4]},{index:.13,rgb:[28,16,68]},{index:.25,rgb:[79,18,123]},{index:.38,rgb:[129,37,129]},{index:.5,rgb:[181,54,122]},{index:.63,rgb:[229,80,100]},{index:.75,rgb:[251,135,97]},{index:.88,rgb:[254,194,135]},{index:1,rgb:[252,253,191]}],plasma:[{index:0,rgb:[13,8,135]},{index:.13,rgb:[75,3,161]},{index:.25,rgb:[125,3,168]},{index:.38,rgb:[168,34,150]},{index:.5,rgb:[203,70,121]},{index:.63,rgb:[229,107,93]},{index:.75,rgb:[248,148,65]},{index:.88,rgb:[253,195,40]},{index:1,rgb:[240,249,33]}],warm:[{index:0,rgb:[125,0,179]},{index:.13,rgb:[172,0,187]},{index:.25,rgb:[219,0,170]},{index:.38,rgb:[255,0,130]},{index:.5,rgb:[255,63,74]},{index:.63,rgb:[255,123,0]},{index:.75,rgb:[234,176,0]},{index:.88,rgb:[190,228,0]},{index:1,rgb:[147,255,0]}],cool:[{index:0,rgb:[125,0,179]},{index:.13,rgb:[116,0,218]},{index:.25,rgb:[98,74,237]},{index:.38,rgb:[68,146,231]},{index:.5,rgb:[0,204,197]},{index:.63,rgb:[0,247,146]},{index:.75,rgb:[0,255,88]},{index:.88,rgb:[40,255,8]},{index:1,rgb:[147,255,0]}],"rainbow-soft":[{index:0,rgb:[125,0,179]},{index:.1,rgb:[199,0,180]},{index:.2,rgb:[255,0,121]},{index:.3,rgb:[255,108,0]},{index:.4,rgb:[222,194,0]},{index:.5,rgb:[150,255,0]},{index:.6,rgb:[0,255,55]},{index:.7,rgb:[0,246,150]},{index:.8,rgb:[50,167,222]},{index:.9,rgb:[103,51,235]},{index:1,rgb:[124,0,186]}],bathymetry:[{index:0,rgb:[40,26,44]},{index:.13,rgb:[59,49,90]},{index:.25,rgb:[64,76,139]},{index:.38,rgb:[63,110,151]},{index:.5,rgb:[72,142,158]},{index:.63,rgb:[85,174,163]},{index:.75,rgb:[120,206,163]},{index:.88,rgb:[187,230,172]},{index:1,rgb:[253,254,204]}],cdom:[{index:0,rgb:[47,15,62]},{index:.13,rgb:[87,23,86]},{index:.25,rgb:[130,28,99]},{index:.38,rgb:[171,41,96]},{index:.5,rgb:[206,67,86]},{index:.63,rgb:[230,106,84]},{index:.75,rgb:[242,149,103]},{index:.88,rgb:[249,193,135]},{index:1,rgb:[254,237,176]}],chlorophyll:[{index:0,rgb:[18,36,20]},{index:.13,rgb:[25,63,41]},{index:.25,rgb:[24,91,59]},{index:.38,rgb:[13,119,72]},{index:.5,rgb:[18,148,80]},{index:.63,rgb:[80,173,89]},{index:.75,rgb:[132,196,122]},{index:.88,rgb:[175,221,162]},{index:1,rgb:[215,249,208]}],density:[{index:0,rgb:[54,14,36]},{index:.13,rgb:[89,23,80]},{index:.25,rgb:[110,45,132]},{index:.38,rgb:[120,77,178]},{index:.5,rgb:[120,113,213]},{index:.63,rgb:[115,151,228]},{index:.75,rgb:[134,185,227]},{index:.88,rgb:[177,214,227]},{index:1,rgb:[230,241,241]}],"freesurface-blue":[{index:0,rgb:[30,4,110]},{index:.13,rgb:[47,14,176]},{index:.25,rgb:[41,45,236]},{index:.38,rgb:[25,99,212]},{index:.5,rgb:[68,131,200]},{index:.63,rgb:[114,156,197]},{index:.75,rgb:[157,181,203]},{index:.88,rgb:[200,208,216]},{index:1,rgb:[241,237,236]}],"freesurface-red":[{index:0,rgb:[60,9,18]},{index:.13,rgb:[100,17,27]},{index:.25,rgb:[142,20,29]},{index:.38,rgb:[177,43,27]},{index:.5,rgb:[192,87,63]},{index:.63,rgb:[205,125,105]},{index:.75,rgb:[216,162,148]},{index:.88,rgb:[227,199,193]},{index:1,rgb:[241,237,236]}],oxygen:[{index:0,rgb:[64,5,5]},{index:.13,rgb:[106,6,15]},{index:.25,rgb:[144,26,7]},{index:.38,rgb:[168,64,3]},{index:.5,rgb:[188,100,4]},{index:.63,rgb:[206,136,11]},{index:.75,rgb:[220,174,25]},{index:.88,rgb:[231,215,44]},{index:1,rgb:[248,254,105]}],par:[{index:0,rgb:[51,20,24]},{index:.13,rgb:[90,32,35]},{index:.25,rgb:[129,44,34]},{index:.38,rgb:[159,68,25]},{index:.5,rgb:[182,99,19]},{index:.63,rgb:[199,134,22]},{index:.75,rgb:[212,171,35]},{index:.88,rgb:[221,210,54]},{index:1,rgb:[225,253,75]}],phase:[{index:0,rgb:[145,105,18]},{index:.13,rgb:[184,71,38]},{index:.25,rgb:[186,58,115]},{index:.38,rgb:[160,71,185]},{index:.5,rgb:[110,97,218]},{index:.63,rgb:[50,123,164]},{index:.75,rgb:[31,131,110]},{index:.88,rgb:[77,129,34]},{index:1,rgb:[145,105,18]}],salinity:[{index:0,rgb:[42,24,108]},{index:.13,rgb:[33,50,162]},{index:.25,rgb:[15,90,145]},{index:.38,rgb:[40,118,137]},{index:.5,rgb:[59,146,135]},{index:.63,rgb:[79,175,126]},{index:.75,rgb:[120,203,104]},{index:.88,rgb:[193,221,100]},{index:1,rgb:[253,239,154]}],temperature:[{index:0,rgb:[4,35,51]},{index:.13,rgb:[23,51,122]},{index:.25,rgb:[85,59,157]},{index:.38,rgb:[129,79,143]},{index:.5,rgb:[175,95,130]},{index:.63,rgb:[222,112,101]},{index:.75,rgb:[249,146,66]},{index:.88,rgb:[249,196,65]},{index:1,rgb:[232,250,91]}],turbidity:[{index:0,rgb:[34,31,27]},{index:.13,rgb:[65,50,41]},{index:.25,rgb:[98,69,52]},{index:.38,rgb:[131,89,57]},{index:.5,rgb:[161,112,59]},{index:.63,rgb:[185,140,66]},{index:.75,rgb:[202,174,88]},{index:.88,rgb:[216,209,126]},{index:1,rgb:[233,246,171]}],"velocity-blue":[{index:0,rgb:[17,32,64]},{index:.13,rgb:[35,52,116]},{index:.25,rgb:[29,81,156]},{index:.38,rgb:[31,113,162]},{index:.5,rgb:[50,144,169]},{index:.63,rgb:[87,173,176]},{index:.75,rgb:[149,196,189]},{index:.88,rgb:[203,221,211]},{index:1,rgb:[254,251,230]}],"velocity-green":[{index:0,rgb:[23,35,19]},{index:.13,rgb:[24,64,38]},{index:.25,rgb:[11,95,45]},{index:.38,rgb:[39,123,35]},{index:.5,rgb:[95,146,12]},{index:.63,rgb:[152,165,18]},{index:.75,rgb:[201,186,69]},{index:.88,rgb:[233,216,137]},{index:1,rgb:[255,253,205]}],cubehelix:[{index:0,rgb:[0,0,0]},{index:.07,rgb:[22,5,59]},{index:.13,rgb:[60,4,105]},{index:.2,rgb:[109,1,135]},{index:.27,rgb:[161,0,147]},{index:.33,rgb:[210,2,142]},{index:.4,rgb:[251,11,123]},{index:.47,rgb:[255,29,97]},{index:.53,rgb:[255,54,69]},{index:.6,rgb:[255,85,46]},{index:.67,rgb:[255,120,34]},{index:.73,rgb:[255,157,37]},{index:.8,rgb:[241,191,57]},{index:.87,rgb:[224,220,93]},{index:.93,rgb:[218,241,142]},{index:1,rgb:[227,253,198]}]}},{}],53:[function(v,m,x){"use strict";var e=v("./colorScale"),n=v("lerp");function t(d){return[d[0]/255,d[1]/255,d[2]/255,d[3]]}function a(d){for(var s,i="#",u=0;u<3;++u)i+=("00"+(s=(s=d[u]).toString(16))).substr(s.length);return i}function r(d){return"rgba("+d.join(",")+")"}m.exports=function(d){var s,i,u,f,c,h,p,o,b,l;if(d||(d={}),o=(d.nshades||72)-1,p=d.format||"hex",(h=d.colormap)||(h="jet"),"string"==typeof h){if(h=h.toLowerCase(),!e[h])throw Error(h+" not a supported colorscale");c=e[h]}else{if(!Array.isArray(h))throw Error("unsupported colormap option",h);c=h.slice()}if(c.length>o+1)throw new Error(h+" map requires nshades to be at least size "+c.length);b=Array.isArray(d.alpha)?2!==d.alpha.length?[1,1]:d.alpha.slice():"number"==typeof d.alpha?[d.alpha,d.alpha]:[1,1],s=c.map(function(L){return Math.round(L.index*o)}),b[0]=Math.min(Math.max(b[0],0),1),b[1]=Math.min(Math.max(b[1],0),1);var T=c.map(function(L,M){var I=c[M].index,P=c[M].rgb.slice();return 4===P.length&&P[3]>=0&&P[3]<=1||(P[3]=b[0]+(b[1]-b[0])*I),P}),_=[];for(l=0;l<s.length-1;++l){f=s[l+1]-s[l],i=T[l],u=T[l+1];for(var w=0;w<f;w++){var k=w/f;_.push([Math.round(n(i[0],u[0],k)),Math.round(n(i[1],u[1],k)),Math.round(n(i[2],u[2],k)),n(i[3],u[3],k)])}}return _.push(c[c.length-1].rgb.concat(b[1])),"hex"===p?_=_.map(a):"rgbaString"===p?_=_.map(r):"float"===p&&(_=_.map(t)),_}},{"./colorScale":52,lerp:240}],54:[function(v,m,x){"use strict";m.exports=function(s,i,u,f){var c=e(i,u,f);if(0===c){var h=n(e(s,i,u)),p=n(e(s,i,f));if(h===p){if(0===h){var o=d(s,i,u);return o===d(s,i,f)?0:o?1:-1}return 0}return 0===p?h>0||d(s,i,f)?-1:1:0===h?p>0||d(s,i,u)?1:-1:n(p-h)}var l=e(s,i,u);return l>0?c>0&&e(s,i,f)>0?1:-1:l<0?c>0||e(s,i,f)>0?1:-1:e(s,i,f)>0||d(s,i,u)?1:-1};var e=v("robust-orientation"),n=v("signum"),t=v("two-sum"),a=v("robust-product"),r=v("robust-sum");function d(s,i,u){var f=t(s[0],-i[0]),c=t(s[1],-i[1]),h=t(u[0],-i[0]),p=t(u[1],-i[1]),o=r(a(f,h),a(c,p));return o[o.length-1]>=0}},{"robust-orientation":284,"robust-product":285,"robust-sum":289,signum:55,"two-sum":307}],55:[function(v,m,x){"use strict";m.exports=function(e){return e<0?-1:e>0?1:0}},{}],56:[function(v,m,x){m.exports=function(t,a){var r=t.length,d=t.length-a.length;if(d)return d;switch(r){case 0:return 0;case 1:return t[0]-a[0];case 2:return t[0]+t[1]-a[0]-a[1]||e(t[0],t[1])-e(a[0],a[1]);case 3:var s=t[0]+t[1],i=a[0]+a[1];if(d=s+t[2]-(i+a[2]))return d;var u=e(t[0],t[1]),f=e(a[0],a[1]);return e(u,t[2])-e(f,a[2])||e(u+t[2],s)-e(f+a[2],i);case 4:var c=t[0],h=t[1],p=t[2],o=t[3],b=a[0],l=a[1],T=a[2],_=a[3];return c+h+p+o-(b+l+T+_)||e(c,h,p,o)-e(b,l,T,_,b)||e(c+h,c+p,c+o,h+p,h+o,p+o)-e(b+l,b+T,b+_,l+T,l+_,T+_)||e(c+h+p,c+h+o,c+p+o,h+p+o)-e(b+l+T,b+l+_,b+T+_,l+T+_);default:for(var w=t.slice().sort(n),k=a.slice().sort(n),L=0;L<r;++L)if(d=w[L]-k[L])return d;return 0}};var e=Math.min;function n(t,a){return t-a}},{}],57:[function(v,m,x){"use strict";var e=v("compare-cell"),n=v("cell-orientation");m.exports=function(t,a){return e(t,a)||n(t)-n(a)}},{"cell-orientation":47,"compare-cell":56}],58:[function(v,m,x){"use strict";var e=v("./lib/ch1d"),n=v("./lib/ch2d"),t=v("./lib/chnd");m.exports=function(a){var r=a.length;if(0===r)return[];if(1===r)return[[0]];var d=a[0].length;return 0===d?[]:1===d?e(a):2===d?n(a):t(a,d)}},{"./lib/ch1d":59,"./lib/ch2d":60,"./lib/chnd":61}],59:[function(v,m,x){"use strict";m.exports=function(e){for(var n=0,t=0,a=1;a<e.length;++a)e[a][0]<e[n][0]&&(n=a),e[a][0]>e[t][0]&&(t=a);return n<t?[[n],[t]]:n>t?[[t],[n]]:[[n]]}},{}],60:[function(v,m,x){"use strict";m.exports=function(n){var t=e(n),a=t.length;if(a<=2)return[];for(var r=new Array(a),d=t[a-1],s=0;s<a;++s){var i=t[s];r[s]=[d,i],d=i}return r};var e=v("monotone-convex-hull-2d")},{"monotone-convex-hull-2d":246}],61:[function(v,m,x){"use strict";m.exports=function(t,a){try{return e(t,!0)}catch{var r=n(t);if(r.length<=a)return[];var d=function(i,u){for(var f=i.length,c=new Array(f),h=0;h<u.length;++h)c[h]=i[u[h]];var p=u.length;for(h=0;h<f;++h)u.indexOf(h)<0&&(c[p++]=i[h]);return c}(t,r);return function(i,u){for(var f=i.length,c=u.length,h=0;h<f;++h)for(var p=i[h],o=0;o<p.length;++o){var b=p[o];if(b<c)p[o]=u[b];else{b-=c;for(var l=0;l<c;++l)b>=u[l]&&(b+=1);p[o]=b}}return i}(e(d,!0),r)}};var e=v("incremental-convex-hull"),n=v("affine-hull")},{"affine-hull":10,"incremental-convex-hull":233}],62:[function(v,m,x){"use strict";m.exports=function(e,n,t,a,r,d){var s=r-1,i=r*r,u=s*s,f=(1+2*r)*u,c=r*u,h=i*(3-2*r),p=i*s;if(e.length){d||(d=new Array(e.length));for(var o=e.length-1;o>=0;--o)d[o]=f*e[o]+c*n[o]+h*t[o]+p*a[o];return d}return f*e+c*n+h*t+p*a},m.exports.derivative=function(e,n,t,a,r,d){var s=6*r*r-6*r,i=3*r*r-4*r+1,u=-6*r*r+6*r,f=3*r*r-2*r;if(e.length){d||(d=new Array(e.length));for(var c=e.length-1;c>=0;--c)d[c]=s*e[c]+i*n[c]+u*t[c]+f*a[c];return d}return s*e+i*n+u*t[c]+f*a}},{}],63:[function(v,m,x){"use strict";var e=v("incremental-convex-hull"),n=v("uniq");function t(r,d){this.point=r,this.index=d}function a(r,d){for(var s=r.point,i=d.point,u=s.length,f=0;f<u;++f){var c=i[f]-s[f];if(c)return c}return 0}m.exports=function(r,d){var s=r.length;if(0===s)return[];var i=r[0].length;if(i<1)return[];if(1===i)return function(I,P,S){if(1===I)return S?[[-1,0]]:[];var E=P.map(function(W,K){return[W[0],K]});E.sort(function(W,K){return W[0]-K[0]});for(var z=new Array(I-1),R=1;R<I;++R)z[R-1]=[E[R-1][1],E[R][1]];return S&&z.push([-1,z[0][1]],[z[I-1][1],-1]),z}(s,r,d);for(var u=new Array(s),f=1,c=0;c<s;++c){for(var h=r[c],p=new Array(i+1),o=0,b=0;b<i;++b){var l=h[b];p[b]=l,o+=l*l}p[i]=o,u[c]=new t(p,c),f=Math.max(o,f)}n(u,a),s=u.length;var T=new Array(s+i+1),_=new Array(s+i+1),w=(i+1)*(i+1)*f,k=new Array(i+1);for(c=0;c<=i;++c)k[c]=0;for(k[i]=w,T[0]=k.slice(),_[0]=-1,c=0;c<=i;++c)(p=k.slice())[c]=1,T[c+1]=p,_[c+1]=-1;for(c=0;c<s;++c){var L=u[c];T[c+i+1]=L.point,_[c+i+1]=L.index}var M=e(T,!1);if(M=M.filter(d?function(I){for(var P=0,S=0;S<=i;++S){var E=_[I[S]];if(E<0&&++P>=2)return!1;I[S]=E}return!0}:function(I){for(var P=0;P<=i;++P){var S=_[I[P]];if(S<0)return!1;I[P]=S}return!0}),1&i)for(c=0;c<M.length;++c)p=(L=M[c])[0],L[0]=L[1],L[1]=p;return M}},{"incremental-convex-hull":233,uniq:310}],64:[function(v,m,x){(function(e){(function(){var n=!1;if(typeof Float64Array<"u"){var t=new Float64Array(1),a=new Uint32Array(t.buffer);t[0]=1,n=!0,1072693248===a[1]?(m.exports=function(d){return t[0]=d,[a[0],a[1]]},m.exports.pack=function(d,s){return a[0]=d,a[1]=s,t[0]},m.exports.lo=function(d){return t[0]=d,a[0]},m.exports.hi=function(d){return t[0]=d,a[1]}):1072693248===a[0]?(m.exports=function(d){return t[0]=d,[a[1],a[0]]},m.exports.pack=function(d,s){return a[1]=d,a[0]=s,t[0]},m.exports.lo=function(d){return t[0]=d,a[1]},m.exports.hi=function(d){return t[0]=d,a[0]}):n=!1}if(!n){var r=new e(8);m.exports=function(d){return r.writeDoubleLE(d,0,!0),[r.readUInt32LE(0,!0),r.readUInt32LE(4,!0)]},m.exports.pack=function(d,s){return r.writeUInt32LE(d,0,!0),r.writeUInt32LE(s,4,!0),r.readDoubleLE(0,!0)},m.exports.lo=function(d){return r.writeDoubleLE(d,0,!0),r.readUInt32LE(0,!0)},m.exports.hi=function(d){return r.writeDoubleLE(d,0,!0),r.readUInt32LE(4,!0)}}m.exports.sign=function(d){return m.exports.hi(d)>>>31},m.exports.exponent=function(d){return(m.exports.hi(d)<<1>>>21)-1023},m.exports.fraction=function(d){var s=m.exports.lo(d),i=m.exports.hi(d),u=1048575&i;return 2146435072&i&&(u+=1<<20),[s,u]},m.exports.denormalized=function(d){return!(2146435072&m.exports.hi(d))}}).call(this)}).call(this,v("buffer").Buffer)},{buffer:3}],65:[function(v,m,x){"use strict";m.exports=function(e,n){switch(void 0===n&&(n=0),typeof e){case"number":if(e>0)return function(t,a){var r,d;for(r=new Array(t),d=0;d<t;++d)r[d]=a;return r}(0|e,n);break;case"object":if("number"==typeof e.length)return function t(a,r,d){var s=0|a[d];if(s<=0)return[];var i,u=new Array(s);if(d===a.length-1)for(i=0;i<s;++i)u[i]=r;else for(i=0;i<s;++i)u[i]=t(a,r,d+1);return u}(e,n,0)}return[]}},{}],66:[function(v,m,x){"use strict";m.exports=function(n,t){var a=n.length;if("number"!=typeof t){t=0;for(var r=0;r<a;++r){var d=n[r];t=Math.max(t,d[0],d[1])}t=1+(0|t)}t|=0;var s=new Array(t);for(r=0;r<t;++r)s[r]=[];for(r=0;r<a;++r)s[(d=n[r])[0]].push(d[1]),s[d[1]].push(d[0]);for(var i=0;i<t;++i)e(s[i],function(u,f){return u-f});return s};var e=v("uniq")},{uniq:310}],67:[function(v,m,x){"use strict";m.exports=function(e,n,t){var a=n||0,r=t||1;return[[e[12]+e[0],e[13]+e[1],e[14]+e[2],e[15]+e[3]],[e[12]-e[0],e[13]-e[1],e[14]-e[2],e[15]-e[3]],[e[12]+e[4],e[13]+e[5],e[14]+e[6],e[15]+e[7]],[e[12]-e[4],e[13]-e[5],e[14]-e[6],e[15]-e[7]],[a*e[12]+e[8],a*e[13]+e[9],a*e[14]+e[10],a*e[15]+e[11]],[r*e[12]-e[8],r*e[13]-e[9],r*e[14]-e[10],r*e[15]-e[11]]]}},{}],68:[function(v,m,x){"use strict";m.exports=function(s,i,u){switch(arguments.length){case 0:return new a([0],[0],0);case 1:return"number"==typeof s?new a(f=d(s),f,0):new a(s,d(s.length),0);case 2:if("number"==typeof i){var f=d(s.length);return new a(s,f,+i)}u=0;case 3:if(s.length!==i.length)throw new Error("state and velocity lengths must match");return new a(s,i,u)}};var e=v("cubic-hermite"),n=v("binary-search-bounds");function t(s,i,u){return Math.min(i,Math.max(s,u))}function a(s,i,u){this.dimension=s.length,this.bounds=[new Array(this.dimension),new Array(this.dimension)];for(var f=0;f<this.dimension;++f)this.bounds[0][f]=-1/0,this.bounds[1][f]=1/0;this._state=s.slice().reverse(),this._velocity=i.slice().reverse(),this._time=[u],this._scratch=[s.slice(),s.slice(),s.slice(),s.slice(),s.slice()]}var r=a.prototype;function d(s){for(var i=new Array(s),u=0;u<s;++u)i[u]=0;return i}r.flush=function(s){var i=n.gt(this._time,s)-1;i<=0||(this._time.splice(0,i),this._state.splice(0,i*this.dimension),this._velocity.splice(0,i*this.dimension))},r.curve=function(s){var i=this._time,u=i.length,f=n.le(i,s),c=this._scratch[0],h=this._state,p=this._velocity,o=this.dimension,b=this.bounds;if(f<0)for(var l=o-1,T=0;T<o;++T,--l)c[T]=h[l];else if(f>=u-1){l=h.length-1;var _=s-i[u-1];for(T=0;T<o;++T,--l)c[T]=h[l]+_*p[l]}else{l=o*(f+1)-1;var w=i[f],k=i[f+1]-w||1,L=this._scratch[1],M=this._scratch[2],I=this._scratch[3],P=this._scratch[4],S=!0;for(T=0;T<o;++T,--l)L[T]=h[l],I[T]=p[l]*k,M[T]=h[l+o],P[T]=p[l+o]*k,S=S&&L[T]===M[T]&&I[T]===P[T]&&0===I[T];if(S)for(T=0;T<o;++T)c[T]=L[T];else e(L,I,M,P,(s-w)/k,c)}var E=b[0],z=b[1];for(T=0;T<o;++T)c[T]=t(E[T],z[T],c[T]);return c},r.dcurve=function(s){var i=this._time,u=i.length,f=n.le(i,s),c=this._scratch[0],h=this._state,p=this._velocity,o=this.dimension;if(f>=u-1)for(var b=h.length-1,l=0;l<o;++l,--b)c[l]=p[b];else{b=o*(f+1)-1;var T=i[f],_=i[f+1]-T||1,w=this._scratch[1],k=this._scratch[2],L=this._scratch[3],M=this._scratch[4],I=!0;for(l=0;l<o;++l,--b)w[l]=h[b],L[l]=p[b]*_,k[l]=h[b+o],M[l]=p[b+o]*_,I=I&&w[l]===k[l]&&L[l]===M[l]&&0===L[l];if(I)for(l=0;l<o;++l)c[l]=0;else for(e.derivative(w,L,k,M,(s-T)/_,c),l=0;l<o;++l)c[l]/=_}return c},r.lastT=function(){var s=this._time;return s[s.length-1]},r.stable=function(){for(var s=this._velocity,i=s.length,u=this.dimension-1;u>=0;--u)if(s[--i])return!1;return!0},r.jump=function(s){var i=this.lastT(),u=this.dimension;if(!(s<i||arguments.length!==u+1)){var f=this._state,c=this._velocity,h=f.length-this.dimension,p=this.bounds,o=p[0],b=p[1];this._time.push(i,s);for(var l=0;l<2;++l)for(var T=0;T<u;++T)f.push(f[h++]),c.push(0);for(this._time.push(s),T=u;T>0;--T)f.push(t(o[T-1],b[T-1],arguments[T])),c.push(0)}},r.push=function(s){var i=this.lastT(),u=this.dimension;if(!(s<i||arguments.length!==u+1)){var f=this._state,c=this._velocity,h=f.length-this.dimension,p=s-i,o=this.bounds,b=o[0],l=o[1],T=p>1e-6?1/p:0;this._time.push(s);for(var _=u;_>0;--_){var w=t(b[_-1],l[_-1],arguments[_]);f.push(w),c.push((w-f[h++])*T)}}},r.set=function(s){var i=this.dimension;if(!(s<this.lastT()||arguments.length!==i+1)){var u=this._state,f=this._velocity,c=this.bounds,h=c[0],p=c[1];this._time.push(s);for(var o=i;o>0;--o)u.push(t(h[o-1],p[o-1],arguments[o])),f.push(0)}},r.move=function(s){var i=this.lastT(),u=this.dimension;if(!(s<=i||arguments.length!==u+1)){var f=this._state,c=this._velocity,h=f.length-this.dimension,p=this.bounds,o=p[0],b=p[1],l=s-i,T=l>1e-6?1/l:0;this._time.push(s);for(var _=u;_>0;--_){var w=arguments[_];f.push(t(o[_-1],b[_-1],f[h++]+w)),c.push(w*T)}}},r.idle=function(s){var i=this.lastT();if(!(s<i)){var u=this.dimension,f=this._state,c=this._velocity,h=f.length-u,p=this.bounds,o=p[0],b=p[1],l=s-i;this._time.push(s);for(var T=u-1;T>=0;--T)f.push(t(o[T],b[T],f[h]+l*c[h])),c.push(0),h+=1}}},{"binary-search-bounds":31,"cubic-hermite":62}],69:[function(v,m,x){"use strict";function e(o,b,l,T,_,w){this._color=o,this.key=b,this.value=l,this.left=T,this.right=_,this._count=w}function n(o){return new e(o._color,o.key,o.value,o.left,o.right,o._count)}function t(o,b){return new e(o,b.key,b.value,b.left,b.right,b._count)}function a(o){o._count=1+(o.left?o.left._count:0)+(o.right?o.right._count:0)}function r(o,b){this._compare=o,this.root=b}m.exports=function(o){return new r(o||p,null)};var d=r.prototype;function s(o,b){var l;return b.left&&(l=s(o,b.left))?l:(l=o(b.key,b.value))||(b.right?s(o,b.right):void 0)}function i(o,b,l,T){var _;return b(o,T.key)<=0&&(T.left&&(_=i(o,b,l,T.left))||(_=l(T.key,T.value)))?_:T.right?i(o,b,l,T.right):void 0}function u(o,b,l,T,_){var w,k=l(o,_.key),L=l(b,_.key);return k<=0&&(_.left&&(w=u(o,b,l,T,_.left))||L>0&&(w=T(_.key,_.value)))?w:L>0&&_.right?u(o,b,l,T,_.right):void 0}function f(o,b){this.tree=o,this._stack=b}Object.defineProperty(d,"keys",{get:function(){var o=[];return this.forEach(function(b,l){o.push(b)}),o}}),Object.defineProperty(d,"values",{get:function(){var o=[];return this.forEach(function(b,l){o.push(l)}),o}}),Object.defineProperty(d,"length",{get:function(){return this.root?this.root._count:0}}),d.insert=function(o,b){for(var l=this._compare,T=this.root,_=[],w=[];T;){var k=l(o,T.key);_.push(T),w.push(k),T=k<=0?T.left:T.right}_.push(new e(0,o,b,null,null,1));for(var L=_.length-2;L>=0;--L)T=_[L],_[L]=w[L]<=0?new e(T._color,T.key,T.value,_[L+1],T.right,T._count+1):new e(T._color,T.key,T.value,T.left,_[L+1],T._count+1);for(L=_.length-1;L>1;--L){var M=_[L-1];if(T=_[L],1===M._color||1===T._color)break;var I=_[L-2];if(I.left===M)if(M.left===T){if(!(P=I.right)||0!==P._color){I._color=0,I.left=M.right,M._color=1,M.right=I,_[L-2]=M,_[L-1]=T,a(I),a(M),L>=3&&((S=_[L-3]).left===I?S.left=M:S.right=M);break}M._color=1,I.right=t(1,P),I._color=0,L-=1}else{if(!(P=I.right)||0!==P._color){M.right=T.left,I._color=0,I.left=T.right,T._color=1,T.left=M,T.right=I,_[L-2]=T,_[L-1]=M,a(I),a(M),a(T),L>=3&&((S=_[L-3]).left===I?S.left=T:S.right=T);break}M._color=1,I.right=t(1,P),I._color=0,L-=1}else if(M.right===T){if(!(P=I.left)||0!==P._color){I._color=0,I.right=M.left,M._color=1,M.left=I,_[L-2]=M,_[L-1]=T,a(I),a(M),L>=3&&((S=_[L-3]).right===I?S.right=M:S.left=M);break}M._color=1,I.left=t(1,P),I._color=0,L-=1}else{var P;if(!(P=I.left)||0!==P._color){var S;M.left=T.right,I._color=0,I.right=T.left,T._color=1,T.right=M,T.left=I,_[L-2]=T,_[L-1]=M,a(I),a(M),a(T),L>=3&&((S=_[L-3]).right===I?S.right=T:S.left=T);break}M._color=1,I.left=t(1,P),I._color=0,L-=1}}return _[0]._color=1,new r(l,_[0])},d.forEach=function(o,b,l){if(this.root)switch(arguments.length){case 1:return s(o,this.root);case 2:return i(b,this._compare,o,this.root);case 3:return this._compare(b,l)>=0?void 0:u(b,l,this._compare,o,this.root)}},Object.defineProperty(d,"begin",{get:function(){for(var o=[],b=this.root;b;)o.push(b),b=b.left;return new f(this,o)}}),Object.defineProperty(d,"end",{get:function(){for(var o=[],b=this.root;b;)o.push(b),b=b.right;return new f(this,o)}}),d.at=function(o){if(o<0)return new f(this,[]);for(var b=this.root,l=[];;){if(l.push(b),b.left){if(o<b.left._count){b=b.left;continue}o-=b.left._count}if(!o)return new f(this,l);if(o-=1,!b.right||o>=b.right._count)break;b=b.right}return new f(this,[])},d.ge=function(o){for(var b=this._compare,l=this.root,T=[],_=0;l;){var w=b(o,l.key);T.push(l),w<=0&&(_=T.length),l=w<=0?l.left:l.right}return T.length=_,new f(this,T)},d.gt=function(o){for(var b=this._compare,l=this.root,T=[],_=0;l;){var w=b(o,l.key);T.push(l),w<0&&(_=T.length),l=w<0?l.left:l.right}return T.length=_,new f(this,T)},d.lt=function(o){for(var b=this._compare,l=this.root,T=[],_=0;l;){var w=b(o,l.key);T.push(l),w>0&&(_=T.length),l=w<=0?l.left:l.right}return T.length=_,new f(this,T)},d.le=function(o){for(var b=this._compare,l=this.root,T=[],_=0;l;){var w=b(o,l.key);T.push(l),w>=0&&(_=T.length),l=w<0?l.left:l.right}return T.length=_,new f(this,T)},d.find=function(o){for(var b=this._compare,l=this.root,T=[];l;){var _=b(o,l.key);if(T.push(l),0===_)return new f(this,T);l=_<=0?l.left:l.right}return new f(this,[])},d.remove=function(o){var b=this.find(o);return b?b.remove():this},d.get=function(o){for(var b=this._compare,l=this.root;l;){var T=b(o,l.key);if(0===T)return l.value;l=T<=0?l.left:l.right}};var c=f.prototype;function h(o,b){o.key=b.key,o.value=b.value,o.left=b.left,o.right=b.right,o._color=b._color,o._count=b._count}function p(o,b){return o<b?-1:o>b?1:0}Object.defineProperty(c,"valid",{get:function(){return this._stack.length>0}}),Object.defineProperty(c,"node",{get:function(){return this._stack.length>0?this._stack[this._stack.length-1]:null},enumerable:!0}),c.clone=function(){return new f(this.tree,this._stack.slice())},c.remove=function(){var o=this._stack;if(0===o.length)return this.tree;var b=new Array(o.length),l=o[o.length-1];b[b.length-1]=new e(l._color,l.key,l.value,l.left,l.right,l._count);for(var T=o.length-2;T>=0;--T)b[T]=(l=o[T]).left===o[T+1]?new e(l._color,l.key,l.value,b[T+1],l.right,l._count):new e(l._color,l.key,l.value,l.left,b[T+1],l._count);if((l=b[b.length-1]).left&&l.right){var _=b.length;for(l=l.left;l.right;)b.push(l),l=l.right;var w=b[_-1];for(b.push(new e(l._color,w.key,w.value,l.left,l.right,l._count)),b[_-1].key=l.key,b[_-1].value=l.value,T=b.length-2;T>=_;--T)b[T]=new e((l=b[T])._color,l.key,l.value,l.left,b[T+1],l._count);b[_-1].left=b[_]}if(0===(l=b[b.length-1])._color){var k=b[b.length-2];for(k.left===l?k.left=null:k.right===l&&(k.right=null),b.pop(),T=0;T<b.length;++T)b[T]._count--;return new r(this.tree._compare,b[0])}if(l.left||l.right){for(l.left?h(l,l.left):l.right&&h(l,l.right),l._color=1,T=0;T<b.length-1;++T)b[T]._count--;return new r(this.tree._compare,b[0])}if(1===b.length)return new r(this.tree._compare,null);for(T=0;T<b.length;++T)b[T]._count--;var L=b[b.length-2];return function(M){for(var I,P,S,E,z=M.length-1;z>=0;--z){if(I=M[z],0===z)return void(I._color=1);if((P=M[z-1]).left===I){if((S=P.right).right&&0===S.right._color)return E=(S=P.right=n(S)).right=n(S.right),P.right=S.left,S.left=P,S.right=E,S._color=P._color,I._color=1,P._color=1,E._color=1,a(P),a(S),z>1&&((R=M[z-2]).left===P?R.left=S:R.right=S),void(M[z-1]=S);if(S.left&&0===S.left._color)return E=(S=P.right=n(S)).left=n(S.left),P.right=E.left,S.left=E.right,E.left=P,E.right=S,E._color=P._color,P._color=1,S._color=1,I._color=1,a(P),a(S),a(E),z>1&&((R=M[z-2]).left===P?R.left=E:R.right=E),void(M[z-1]=E);if(1===S._color){if(0===P._color)return P._color=1,void(P.right=t(0,S));P.right=t(0,S);continue}S=n(S),P.right=S.left,S.left=P,S._color=P._color,P._color=0,a(P),a(S),z>1&&((R=M[z-2]).left===P?R.left=S:R.right=S),M[z-1]=S,M[z]=P,z+1<M.length?M[z+1]=I:M.push(I),z+=2}else{if((S=P.left).left&&0===S.left._color)return E=(S=P.left=n(S)).left=n(S.left),P.left=S.right,S.right=P,S.left=E,S._color=P._color,I._color=1,P._color=1,E._color=1,a(P),a(S),z>1&&((R=M[z-2]).right===P?R.right=S:R.left=S),void(M[z-1]=S);if(S.right&&0===S.right._color)return E=(S=P.left=n(S)).right=n(S.right),P.left=E.right,S.right=E.left,E.right=P,E.left=S,E._color=P._color,P._color=1,S._color=1,I._color=1,a(P),a(S),a(E),z>1&&((R=M[z-2]).right===P?R.right=E:R.left=E),void(M[z-1]=E);if(1===S._color){if(0===P._color)return P._color=1,void(P.left=t(0,S));P.left=t(0,S);continue}var R;S=n(S),P.left=S.right,S.right=P,S._color=P._color,P._color=0,a(P),a(S),z>1&&((R=M[z-2]).right===P?R.right=S:R.left=S),M[z-1]=S,M[z]=P,z+1<M.length?M[z+1]=I:M.push(I),z+=2}}}(b),L.left===l?L.left=null:L.right=null,new r(this.tree._compare,b[0])},Object.defineProperty(c,"key",{get:function(){if(this._stack.length>0)return this._stack[this._stack.length-1].key},enumerable:!0}),Object.defineProperty(c,"value",{get:function(){if(this._stack.length>0)return this._stack[this._stack.length-1].value},enumerable:!0}),Object.defineProperty(c,"index",{get:function(){var o=0,b=this._stack;if(0===b.length){var l=this.tree.root;return l?l._count:0}b[b.length-1].left&&(o=b[b.length-1].left._count);for(var T=b.length-2;T>=0;--T)b[T+1]===b[T].right&&(++o,b[T].left&&(o+=b[T].left._count));return o},enumerable:!0}),c.next=function(){var o=this._stack;if(0!==o.length){var b=o[o.length-1];if(b.right)for(b=b.right;b;)o.push(b),b=b.left;else for(o.pop();o.length>0&&o[o.length-1].right===b;)b=o[o.length-1],o.pop()}},Object.defineProperty(c,"hasNext",{get:function(){var o=this._stack;if(0===o.length)return!1;if(o[o.length-1].right)return!0;for(var b=o.length-1;b>0;--b)if(o[b-1].left===o[b])return!0;return!1}}),c.update=function(o){var b=this._stack;if(0===b.length)throw new Error("Can't update empty node!");var l=new Array(b.length),T=b[b.length-1];l[l.length-1]=new e(T._color,T.key,o,T.left,T.right,T._count);for(var _=b.length-2;_>=0;--_)l[_]=(T=b[_]).left===b[_+1]?new e(T._color,T.key,T.value,l[_+1],T.right,T._count):new e(T._color,T.key,T.value,T.left,l[_+1],T._count);return new r(this.tree._compare,l[0])},c.prev=function(){var o=this._stack;if(0!==o.length){var b=o[o.length-1];if(b.left)for(b=b.left;b;)o.push(b),b=b.right;else for(o.pop();o.length>0&&o[o.length-1].left===b;)b=o[o.length-1],o.pop()}},Object.defineProperty(c,"hasPrev",{get:function(){var o=this._stack;if(0===o.length)return!1;if(o[o.length-1].left)return!0;for(var b=o.length-1;b>0;--b)if(o[b-1].right===o[b])return!0;return!1}})},{}],70:[function(v,m,x){"use strict";m.exports=function(_,w){var k=new i(_);return k.update(w),k};var e=v("./lib/text.js"),n=v("./lib/lines.js"),t=v("./lib/background.js"),a=v("./lib/cube.js"),r=v("./lib/ticks.js"),d=new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]);function s(_,w){return _[0]=w[0],_[1]=w[1],_[2]=w[2],_}function i(_){this.gl=_,this.pixelRatio=1,this.bounds=[[-10,-10,-10],[10,10,10]],this.ticks=[[],[],[]],this.autoTicks=!0,this.tickSpacing=[1,1,1],this.tickEnable=[!0,!0,!0],this.tickFont=["sans-serif","sans-serif","sans-serif"],this.tickSize=[12,12,12],this.tickAngle=[0,0,0],this.tickAlign=["auto","auto","auto"],this.tickColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.tickPad=[10,10,10],this.lastCubeProps={cubeEdges:[0,0,0],axis:[0,0,0]},this.labels=["x","y","z"],this.labelEnable=[!0,!0,!0],this.labelFont="sans-serif",this.labelSize=[20,20,20],this.labelAngle=[0,0,0],this.labelAlign=["auto","auto","auto"],this.labelColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.labelPad=[10,10,10],this.lineEnable=[!0,!0,!0],this.lineMirror=[!1,!1,!1],this.lineWidth=[1,1,1],this.lineColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.lineTickEnable=[!0,!0,!0],this.lineTickMirror=[!1,!1,!1],this.lineTickLength=[0,0,0],this.lineTickWidth=[1,1,1],this.lineTickColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.gridEnable=[!0,!0,!0],this.gridWidth=[1,1,1],this.gridColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.zeroEnable=[!0,!0,!0],this.zeroLineColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.zeroLineWidth=[2,2,2],this.backgroundEnable=[!1,!1,!1],this.backgroundColor=[[.8,.8,.8,.5],[.8,.8,.8,.5],[.8,.8,.8,.5]],this._firstInit=!0,this._text=null,this._lines=null,this._background=t(_)}var u=i.prototype;function f(){this.primalOffset=[0,0,0],this.primalMinor=[0,0,0],this.mirrorOffset=[0,0,0],this.mirrorMinor=[0,0,0]}u.update=function(_){function w(W,K,G){if(G in _){var Y,$=_[G],B=this[G];this[G]=Y=(W?Array.isArray($)&&Array.isArray($[0]):Array.isArray($))?[K($[0]),K($[1]),K($[2])]:[K($),K($),K($)];for(var N=0;N<3;++N)if(Y[N]!==B[N])return!0}return!1}_=_||{};var k,L=w.bind(this,!1,Number),M=w.bind(this,!1,Boolean),I=w.bind(this,!1,String),P=w.bind(this,!0,function(W){if(Array.isArray(W)){if(3===W.length)return[+W[0],+W[1],+W[2],1];if(4===W.length)return[+W[0],+W[1],+W[2],+W[3]]}return[0,0,0,1]}),S=!1,E=!1;if("bounds"in _)for(var z=_.bounds,R=0;R<2;++R)for(var q=0;q<3;++q)z[R][q]!==this.bounds[R][q]&&(E=!0),this.bounds[R][q]=z[R][q];if("ticks"in _)for(k=_.ticks,S=!0,this.autoTicks=!1,R=0;R<3;++R)this.tickSpacing[R]=0;else L("tickSpacing")&&(this.autoTicks=!0,E=!0);if(this._firstInit&&("ticks"in _||"tickSpacing"in _||(this.autoTicks=!0),E=!0,S=!0,this._firstInit=!1),E&&this.autoTicks&&(k=r.create(this.bounds,this.tickSpacing),S=!0),S){for(R=0;R<3;++R)k[R].sort(function(W,K){return W.x-K.x});r.equal(k,this.ticks)?S=!1:this.ticks=k}M("tickEnable"),I("tickFont")&&(S=!0),L("tickSize"),L("tickAngle"),L("tickPad"),P("tickColor");var V=I("labels");I("labelFont")&&(V=!0),M("labelEnable"),L("labelSize"),L("labelPad"),P("labelColor"),M("lineEnable"),M("lineMirror"),L("lineWidth"),P("lineColor"),M("lineTickEnable"),M("lineTickMirror"),L("lineTickLength"),L("lineTickWidth"),P("lineTickColor"),M("gridEnable"),L("gridWidth"),P("gridColor"),M("zeroEnable"),P("zeroLineColor"),L("zeroLineWidth"),M("backgroundEnable"),P("backgroundColor"),this._text?this._text&&(V||S)&&this._text.update(this.bounds,this.labels,this.labelFont,this.ticks,this.tickFont):this._text=e(this.gl,this.bounds,this.labels,this.labelFont,this.ticks,this.tickFont),this._lines&&S&&(this._lines.dispose(),this._lines=null),this._lines||(this._lines=n(this.gl,this.bounds,this.ticks))};var c=[new f,new f,new f];function h(_,w,k,L,M){for(var I=_.primalOffset,P=_.primalMinor,S=_.mirrorOffset,E=_.mirrorMinor,z=L[w],R=0;R<3;++R)if(w!==R){var q=I,V=S,W=P,K=E;z&1<<R&&(q=S,V=I,W=E,K=P),q[R]=k[0][R],V[R]=k[1][R],M[R]>0?(W[R]=-1,K[R]=0):(W[R]=0,K[R]=1)}}var p=[0,0,0],o={model:d,view:d,projection:d,_ortho:!1};u.isOpaque=function(){return!0},u.isTransparent=function(){return!1},u.drawTransparent=function(_){};var b=[0,0,0],l=[0,0,0],T=[0,0,0];u.draw=function(_){for(var w=this.gl,k=(_=_||o).model||d,L=_.view||d,M=_.projection||d,I=this.bounds,P=_._ortho||!1,S=a(k,L,M,I,P),E=S.cubeEdges,z=S.axis,K=(P?2:1)*this.pixelRatio*(M[3]*L[12]+M[7]*L[13]+M[11]*L[14]+M[15]*L[15])/w.drawingBufferHeight,G=0;G<3;++G)this.lastCubeProps.cubeEdges[G]=E[G],this.lastCubeProps.axis[G]=z[G];var Y=c;for(G=0;G<3;++G)h(c[G],G,this.bounds,E,z);w=this.gl;var $,le,oe,Oe,fe,ve,Ae,ke,Pe,Ne,De,ze,B=p;for(G=0;G<3;++G)B[G]=this.backgroundEnable[G]?z[G]:0;for(this._background.draw(k,L,M,I,B,this.backgroundColor),this._lines.bind(k,L,M,this),G=0;G<3;++G){var N=[0,0,0];N[G]=z[G]>0?I[1][G]:I[0][G];for(var U=0;U<2;++U){var te=(G+1+U)%3,j=(G+1+(1^U))%3;this.gridEnable[te]&&this._lines.drawGrid(te,j,this.bounds,N,this.gridColor[te],this.gridWidth[te]*this.pixelRatio)}for(U=0;U<2;++U)te=(G+1+U)%3,this.zeroEnable[j=(G+1+(1^U))%3]&&Math.min(I[0][j],I[1][j])<=0&&Math.max(I[0][j],I[1][j])>=0&&this._lines.drawZero(te,j,this.bounds,N,this.zeroLineColor[j],this.zeroLineWidth[j]*this.pixelRatio)}for(G=0;G<3;++G){this.lineEnable[G]&&this._lines.drawAxisLine(G,this.bounds,Y[G].primalOffset,this.lineColor[G],this.lineWidth[G]*this.pixelRatio),this.lineMirror[G]&&this._lines.drawAxisLine(G,this.bounds,Y[G].mirrorOffset,this.lineColor[G],this.lineWidth[G]*this.pixelRatio);var J=s(b,Y[G].primalMinor),X=s(l,Y[G].mirrorMinor),re=this.lineTickLength;for(U=0;U<3;++U){var ne=K/k[5*U];J[U]*=re[U]*ne,X[U]*=re[U]*ne}this.lineTickEnable[G]&&this._lines.drawAxisTicks(G,Y[G].primalOffset,J,this.lineTickColor[G],this.lineTickWidth[G]*this.pixelRatio),this.lineTickMirror[G]&&this._lines.drawAxisTicks(G,Y[G].mirrorOffset,X,this.lineTickColor[G],this.lineTickWidth[G]*this.pixelRatio)}function de(Oe){(oe=[0,0,0])[Oe]=1}for(this._lines.unbind(),this._text.bind(k,L,M,this.pixelRatio),G=0;G<3;++G){var ge=Y[G].primalMinor,_e=Y[G].mirrorMinor,Te=s(T,Y[G].primalOffset);for(U=0;U<3;++U)this.lineTickEnable[G]&&(Te[U]+=K*ge[U]*Math.max(this.lineTickLength[U],0)/k[5*U]);var we=[0,0,0];if(we[G]=1,this.tickEnable[G]){for(-3600===this.tickAngle[G]?(this.tickAngle[G]=0,this.tickAlign[G]="auto"):this.tickAlign[G]=-1,$[0]="auto"===($=[this.tickAlign[G],.5,le=1])[0]?0:parseInt(""+$[0]),oe=[0,0,0],Ae=void 0,ke=void 0,Pe=void 0,Ne=void 0,De=void 0,ze=void 0,Ne=(fe=ge)[ke=((Oe=G)+2)%3],De=(ve=_e)[Ae=(Oe+1)%3],ze=ve[ke],(Pe=fe[Ae])>0&&ze>0||Pe>0&&ze<0||Pe<0&&ze>0||Pe<0&&ze<0?de(Ae):(Ne>0&&De>0||Ne>0&&De<0||Ne<0&&De>0||Ne<0&&De<0)&&de(ke),U=0;U<3;++U)Te[U]+=K*ge[U]*this.tickPad[U]/k[5*U];this._text.drawTicks(G,this.tickSize[G],this.tickAngle[G],Te,this.tickColor[G],we,oe,$)}if(this.labelEnable[G]){for(le=0,oe=[0,0,0],this.labels[G].length>4&&(de(G),le=1),$[0]="auto"===($=[this.labelAlign[G],.5,le])[0]?0:parseInt(""+$[0]),U=0;U<3;++U)Te[U]+=K*ge[U]*this.labelPad[U]/k[5*U];Te[G]+=.5*(I[0][G]+I[1][G]),this._text.drawLabel(G,this.labelSize[G],this.labelAngle[G],Te,this.labelColor[G],[0,0,0],oe,$)}}this._text.unbind()},u.dispose=function(){this._text.dispose(),this._lines.dispose(),this._background.dispose(),this._lines=null,this._text=null,this._background=null,this.gl=null}},{"./lib/background.js":71,"./lib/cube.js":72,"./lib/lines.js":73,"./lib/text.js":75,"./lib/ticks.js":76}],71:[function(v,m,x){"use strict";m.exports=function(d){for(var s=[],i=[],u=0,f=0;f<3;++f)for(var c=(f+1)%3,h=(f+2)%3,p=[0,0,0],o=[0,0,0],b=-1;b<=1;b+=2){i.push(u,u+2,u+1,u+1,u+2,u+3),p[f]=b,o[f]=b;for(var l=-1;l<=1;l+=2){p[c]=l;for(var T=-1;T<=1;T+=2)p[h]=T,s.push(p[0],p[1],p[2],o[0],o[1],o[2]),u+=1}var _=c;c=h,h=_}var w=e(d,new Float32Array(s)),k=e(d,new Uint16Array(i),d.ELEMENT_ARRAY_BUFFER),L=n(d,[{buffer:w,type:d.FLOAT,size:3,offset:0,stride:24},{buffer:w,type:d.FLOAT,size:3,offset:12,stride:24}],k),M=t(d);return M.attributes.position.location=0,M.attributes.normal.location=1,new a(d,w,L,M)};var e=v("gl-buffer"),n=v("gl-vao"),t=v("./shaders").bg;function a(d,s,i,u){this.gl=d,this.buffer=s,this.vao=i,this.shader=u}var r=a.prototype;r.draw=function(d,s,i,u,f,c){for(var h=!1,p=0;p<3;++p)h=h||f[p];if(h){var o=this.gl;o.enable(o.POLYGON_OFFSET_FILL),o.polygonOffset(1,2),this.shader.bind(),this.shader.uniforms={model:d,view:s,projection:i,bounds:u,enable:f,colors:c},this.vao.bind(),this.vao.draw(this.gl.TRIANGLES,36),this.vao.unbind(),o.disable(o.POLYGON_OFFSET_FILL)}},r.dispose=function(){this.vao.dispose(),this.buffer.dispose(),this.shader.dispose()}},{"./shaders":74,"gl-buffer":78,"gl-vao":150}],72:[function(v,m,x){"use strict";m.exports=function(l,T,_,w,k){n(r,T,l),n(r,_,r);for(var L=0,M=0;M<2;++M){i[2]=w[M][2];for(var I=0;I<2;++I){i[1]=w[I][1];for(var P=0;P<2;++P)i[0]=w[P][0],f(d[L],i,r),L+=1}}var S=-1;for(M=0;M<8;++M){for(var E=d[M][3],z=0;z<3;++z)s[M][z]=d[M][z]/E;k&&(s[M][2]*=-1),E<0&&(S<0||s[M][2]<s[S][2])&&(S=M)}if(S<0){S=0;for(var R=0;R<3;++R){for(var q=(R+2)%3,V=(R+1)%3,W=-1,K=-1,G=0;G<2;++G){var Y=(B=G<<R)+(G<<q)+(1-G<<V),$=B+(1-G<<q)+(G<<V);a(s[B],s[Y],s[$],u)<0||(G?W=1:K=1)}if(W<0||K<0)K>W&&(S|=1<<R);else{for(G=0;G<2;++G){Y=(B=G<<R)+(G<<q)+(1-G<<V);var B,N=h([d[B],d[Y],d[$=B+(1-G<<q)+(G<<V)],d[B+(1<<q)+(1<<V)]]);G?W=N:K=N}K>W&&(S|=1<<R)}}}var U=7^S,te=-1;for(M=0;M<8;++M)M!==S&&M!==U&&(te<0||s[te][1]>s[M][1])&&(te=M);var j=-1;for(M=0;M<3;++M)(X=te^1<<M)!==S&&X!==U&&(j<0&&(j=X),(V=s[X])[0]<s[j][0]&&(j=X));var J=-1;for(M=0;M<3;++M){var X;(X=te^1<<M)!==S&&X!==U&&X!==j&&(J<0&&(J=X),(V=s[X])[0]>s[J][0]&&(J=X))}var re=p;re[0]=re[1]=re[2]=0,re[e.log2(j^te)]=te&j,re[e.log2(te^J)]=te&J;var ne=7^J;ne===S||ne===U?re[e.log2(J^(ne=7^j))]=ne&J:re[e.log2(j^ne)]=ne&j;var le=o,oe=S;for(R=0;R<3;++R)le[R]=oe&1<<R?-1:1;return b};var e=v("bit-twiddle"),n=v("gl-mat4/multiply"),t=v("split-polygon"),a=v("robust-orientation"),r=new Array(16),d=new Array(8),s=new Array(8),i=new Array(3),u=[0,0,0];function f(l,T,_){for(var w=0;w<4;++w){l[w]=_[12+w];for(var k=0;k<3;++k)l[w]+=T[k]*_[4*k+w]}}!function(){for(var l=0;l<8;++l)d[l]=[1,1,1,1],s[l]=[1,1,1]}();var c=[[0,0,1,0,0],[0,0,-1,1,0],[0,-1,0,1,0],[0,1,0,1,0],[-1,0,0,1,0],[1,0,0,1,0]];function h(l){for(var T=0;T<c.length;++T)if((l=t.positive(l,c[T])).length<3)return 0;var _=l[0],w=_[0]/_[3],k=_[1]/_[3],L=0;for(T=1;T+1<l.length;++T){var M=l[T],I=l[T+1];L+=Math.abs((M[0]/M[3]-w)*(I[1]/I[3]-k)-(M[1]/M[3]-k)*(I[0]/I[3]-w))}return L}var p=[1,1,1],o=[0,0,0],b={cubeEdges:p,axis:o}},{"bit-twiddle":32,"gl-mat4/multiply":100,"robust-orientation":284,"split-polygon":300}],73:[function(v,m,x){"use strict";m.exports=function(p,o,b){var l=[],T=[0,0,0],_=[0,0,0],w=[0,0,0],k=[0,0,0];l.push(0,0,1,0,1,1,0,0,-1,0,0,-1,0,1,1,0,1,-1);for(var L=0;L<3;++L){for(var M=l.length/3|0,I=0;I<b[L].length;++I){var P=+b[L][I].x;l.push(P,0,1,P,1,1,P,0,-1,P,0,-1,P,1,1,P,1,-1)}var S=l.length/3|0;T[L]=M,_[L]=S-M,M=l.length/3|0;for(var E=0;E<b[L].length;++E)l.push(P=+b[L][E].x,0,1,P,1,1,P,0,-1,P,0,-1,P,1,1,P,1,-1);S=l.length/3|0,w[L]=M,k[L]=S-M}var z=e(p,new Float32Array(l)),R=n(p,[{buffer:z,type:p.FLOAT,size:3,stride:0,offset:0}]),q=t(p);return q.attributes.position.location=0,new c(p,z,R,q,_,T,k,w)};var e=v("gl-buffer"),n=v("gl-vao"),t=v("./shaders").line,a=[0,0,0],r=[0,0,0],d=[0,0,0],s=[0,0,0],i=[1,1];function u(p){return p[0]=p[1]=p[2]=0,p}function f(p,o){return p[0]=o[0],p[1]=o[1],p[2]=o[2],p}function c(p,o,b,l,T,_,w,k){this.gl=p,this.vertBuffer=o,this.vao=b,this.shader=l,this.tickCount=T,this.tickOffset=_,this.gridCount=w,this.gridOffset=k}var h=c.prototype;h.bind=function(p,o,b){this.shader.bind(),this.shader.uniforms.model=p,this.shader.uniforms.view=o,this.shader.uniforms.projection=b,i[0]=this.gl.drawingBufferWidth,i[1]=this.gl.drawingBufferHeight,this.shader.uniforms.screenShape=i,this.vao.bind()},h.unbind=function(){this.vao.unbind()},h.drawAxisLine=function(p,o,b,l,T){var _=u(r);this.shader.uniforms.majorAxis=r,_[p]=o[1][p]-o[0][p],this.shader.uniforms.minorAxis=_;var w,k=f(s,b);k[p]+=o[0][p],this.shader.uniforms.offset=k,this.shader.uniforms.lineWidth=T,this.shader.uniforms.color=l,(w=u(d))[(p+2)%3]=1,this.shader.uniforms.screenAxis=w,this.vao.draw(this.gl.TRIANGLES,6),(w=u(d))[(p+1)%3]=1,this.shader.uniforms.screenAxis=w,this.vao.draw(this.gl.TRIANGLES,6)},h.drawAxisTicks=function(p,o,b,l,T){if(this.tickCount[p]){var _=u(a);_[p]=1,this.shader.uniforms.majorAxis=_,this.shader.uniforms.offset=o,this.shader.uniforms.minorAxis=b,this.shader.uniforms.color=l,this.shader.uniforms.lineWidth=T;var w=u(d);w[p]=1,this.shader.uniforms.screenAxis=w,this.vao.draw(this.gl.TRIANGLES,this.tickCount[p],this.tickOffset[p])}},h.drawGrid=function(p,o,b,l,T,_){if(this.gridCount[p]){var w=u(r);w[o]=b[1][o]-b[0][o],this.shader.uniforms.minorAxis=w;var k=f(s,l);k[o]+=b[0][o],this.shader.uniforms.offset=k;var L=u(a);L[p]=1,this.shader.uniforms.majorAxis=L;var M=u(d);M[p]=1,this.shader.uniforms.screenAxis=M,this.shader.uniforms.lineWidth=_,this.shader.uniforms.color=T,this.vao.draw(this.gl.TRIANGLES,this.gridCount[p],this.gridOffset[p])}},h.drawZero=function(p,o,b,l,T,_){var w=u(r);this.shader.uniforms.majorAxis=w,w[p]=b[1][p]-b[0][p],this.shader.uniforms.minorAxis=w;var k=f(s,l);k[p]+=b[0][p],this.shader.uniforms.offset=k;var L=u(d);L[o]=1,this.shader.uniforms.screenAxis=L,this.shader.uniforms.lineWidth=_,this.shader.uniforms.color=T,this.vao.draw(this.gl.TRIANGLES,6)},h.dispose=function(){this.vao.dispose(),this.vertBuffer.dispose(),this.shader.dispose()}},{"./shaders":74,"gl-buffer":78,"gl-vao":150}],74:[function(v,m,x){"use strict";var e=v("glslify"),n=v("gl-shader"),t=e(["precision highp float;\n#define GLSLIFY 1\n\nattribute vec3 position;\n\nuniform mat4 model, view, projection;\nuniform vec3 offset, majorAxis, minorAxis, screenAxis;\nuniform float lineWidth;\nuniform vec2 screenShape;\n\nvec3 project(vec3 p) {\n  vec4 pp = projection * view * model * vec4(p, 1.0);\n  return pp.xyz / max(pp.w, 0.0001);\n}\n\nvoid main() {\n  vec3 major = position.x * majorAxis;\n  vec3 minor = position.y * minorAxis;\n\n  vec3 vPosition = major + minor + offset;\n  vec3 pPosition = project(vPosition);\n  vec3 offset = project(vPosition + screenAxis * position.z);\n\n  vec2 screen = normalize((offset - pPosition).xy * screenShape) / screenShape;\n\n  gl_Position = vec4(pPosition + vec3(0.5 * screen * lineWidth, 0), 1.0);\n}\n"]),a=e(["precision highp float;\n#define GLSLIFY 1\n\nuniform vec4 color;\nvoid main() {\n  gl_FragColor = color;\n}"]);x.line=function(u){return n(u,t,a,null,[{name:"position",type:"vec3"}])};var r=e(["precision highp float;\n#define GLSLIFY 1\n\nattribute vec3 position;\n\nuniform mat4 model, view, projection;\nuniform vec3 offset, axis, alignDir, alignOpt;\nuniform float scale, angle, pixelScale;\nuniform vec2 resolution;\n\nvec3 project(vec3 p) {\n  vec4 pp = projection * view * model * vec4(p, 1.0);\n  return pp.xyz / max(pp.w, 0.0001);\n}\n\nfloat computeViewAngle(vec3 a, vec3 b) {\n  vec3 A = project(a);\n  vec3 B = project(b);\n\n  return atan(\n    (B.y - A.y) * resolution.y,\n    (B.x - A.x) * resolution.x\n  );\n}\n\nconst float PI = 3.141592;\nconst float TWO_PI = 2.0 * PI;\nconst float HALF_PI = 0.5 * PI;\nconst float ONE_AND_HALF_PI = 1.5 * PI;\n\nint option = int(floor(alignOpt.x + 0.001));\nfloat hv_ratio =       alignOpt.y;\nbool enableAlign =    (alignOpt.z != 0.0);\n\nfloat mod_angle(float a) {\n  return mod(a, PI);\n}\n\nfloat positive_angle(float a) {\n  return mod_angle((a < 0.0) ?\n    a + TWO_PI :\n    a\n  );\n}\n\nfloat look_upwards(float a) {\n  float b = positive_angle(a);\n  return ((b > HALF_PI) && (b <= ONE_AND_HALF_PI)) ?\n    b - PI :\n    b;\n}\n\nfloat look_horizontal_or_vertical(float a, float ratio) {\n  // ratio controls the ratio between being horizontal to (vertical + horizontal)\n  // if ratio is set to 0.5 then it is 50%, 50%.\n  // when using a higher ratio e.g. 0.75 the result would\n  // likely be more horizontal than vertical.\n\n  float b = positive_angle(a);\n\n  return\n    (b < (      ratio) * HALF_PI) ? 0.0 :\n    (b < (2.0 - ratio) * HALF_PI) ? -HALF_PI :\n    (b < (2.0 + ratio) * HALF_PI) ? 0.0 :\n    (b < (4.0 - ratio) * HALF_PI) ? HALF_PI :\n                                    0.0;\n}\n\nfloat roundTo(float a, float b) {\n  return float(b * floor((a + 0.5 * b) / b));\n}\n\nfloat look_round_n_directions(float a, int n) {\n  float b = positive_angle(a);\n  float div = TWO_PI / float(n);\n  float c = roundTo(b, div);\n  return look_upwards(c);\n}\n\nfloat applyAlignOption(float rawAngle, float delta) {\n  return\n    (option >  2) ? look_round_n_directions(rawAngle + delta, option) :       // option 3-n: round to n directions\n    (option == 2) ? look_horizontal_or_vertical(rawAngle + delta, hv_ratio) : // horizontal or vertical\n    (option == 1) ? rawAngle + delta :       // use free angle, and flip to align with one direction of the axis\n    (option == 0) ? look_upwards(rawAngle) : // use free angle, and stay upwards\n    (option ==-1) ? 0.0 :                    // useful for backward compatibility, all texts remains horizontal\n                    rawAngle;                // otherwise return back raw input angle\n}\n\nbool isAxisTitle = (axis.x == 0.0) &&\n                   (axis.y == 0.0) &&\n                   (axis.z == 0.0);\n\nvoid main() {\n  //Compute world offset\n  float axisDistance = position.z;\n  vec3 dataPosition = axisDistance * axis + offset;\n\n  float beta = angle; // i.e. user defined attributes for each tick\n\n  float axisAngle;\n  float clipAngle;\n  float flip;\n\n  if (enableAlign) {\n    axisAngle = (isAxisTitle) ? HALF_PI :\n                      computeViewAngle(dataPosition, dataPosition + axis);\n    clipAngle = computeViewAngle(dataPosition, dataPosition + alignDir);\n\n    axisAngle += (sin(axisAngle) < 0.0) ? PI : 0.0;\n    clipAngle += (sin(clipAngle) < 0.0) ? PI : 0.0;\n\n    flip = (dot(vec2(cos(axisAngle), sin(axisAngle)),\n                vec2(sin(clipAngle),-cos(clipAngle))) > 0.0) ? 1.0 : 0.0;\n\n    beta += applyAlignOption(clipAngle, flip * PI);\n  }\n\n  //Compute plane offset\n  vec2 planeCoord = position.xy * pixelScale;\n\n  mat2 planeXform = scale * mat2(\n     cos(beta), sin(beta),\n    -sin(beta), cos(beta)\n  );\n\n  vec2 viewOffset = 2.0 * planeXform * planeCoord / resolution;\n\n  //Compute clip position\n  vec3 clipPosition = project(dataPosition);\n\n  //Apply text offset in clip coordinates\n  clipPosition += vec3(viewOffset, 0.0);\n\n  //Done\n  gl_Position = vec4(clipPosition, 1.0);\n}"]),d=e(["precision highp float;\n#define GLSLIFY 1\n\nuniform vec4 color;\nvoid main() {\n  gl_FragColor = color;\n}"]);x.text=function(u){return n(u,r,d,null,[{name:"position",type:"vec3"}])};var s=e(["precision highp float;\n#define GLSLIFY 1\n\nattribute vec3 position;\nattribute vec3 normal;\n\nuniform mat4 model, view, projection;\nuniform vec3 enable;\nuniform vec3 bounds[2];\n\nvarying vec3 colorChannel;\n\nvoid main() {\n\n  vec3 signAxis = sign(bounds[1] - bounds[0]);\n\n  vec3 realNormal = signAxis * normal;\n\n  if(dot(realNormal, enable) > 0.0) {\n    vec3 minRange = min(bounds[0], bounds[1]);\n    vec3 maxRange = max(bounds[0], bounds[1]);\n    vec3 nPosition = mix(minRange, maxRange, 0.5 * (position + 1.0));\n    gl_Position = projection * view * model * vec4(nPosition, 1.0);\n  } else {\n    gl_Position = vec4(0,0,0,0);\n  }\n\n  colorChannel = abs(realNormal);\n}"]),i=e(["precision highp float;\n#define GLSLIFY 1\n\nuniform vec4 colors[3];\n\nvarying vec3 colorChannel;\n\nvoid main() {\n  gl_FragColor = colorChannel.x * colors[0] +\n                 colorChannel.y * colors[1] +\n                 colorChannel.z * colors[2];\n}"]);x.bg=function(u){return n(u,s,i,null,[{name:"position",type:"vec3"},{name:"normal",type:"vec3"}])}},{"gl-shader":132,glslify:231}],75:[function(v,m,x){(function(e){(function(){"use strict";m.exports=function(c,h,p,o,b,l){var T=n(c),_=t(c,[{buffer:T,size:3}]),w=r(c);w.attributes.position.location=0;var k=new i(c,w,T,_);return k.update(h,p,o,b,l),k};var n=v("gl-buffer"),t=v("gl-vao"),a=v("vectorize-text"),r=v("./shaders").text,d=window||e.global||{},s=d.__TEXT_CACHE||{};function i(c,h,p,o){this.gl=c,this.shader=h,this.buffer=p,this.vao=o,this.tickOffset=this.tickCount=this.labelOffset=this.labelCount=null}d.__TEXT_CACHE={};var u=i.prototype,f=[0,0];u.bind=function(c,h,p,o){this.vao.bind(),this.shader.bind();var b=this.shader.uniforms;b.model=c,b.view=h,b.projection=p,b.pixelScale=o,f[0]=this.gl.drawingBufferWidth,f[1]=this.gl.drawingBufferHeight,this.shader.uniforms.resolution=f},u.unbind=function(){this.vao.unbind()},u.update=function(c,h,p,o,b){var l=[];function T(S,E,z,R,q,V){var W=s[z];W||(W=s[z]={});var K=W[E];K||(K=W[E]=function(J,X){try{return a(J,X)}catch(re){return console.warn('error vectorizing text:"'+J+'" error:',re),{cells:[],positions:[]}}}(E,{triangles:!0,font:z,textAlign:"center",textBaseline:"middle",lineSpacing:q,styletags:V}));for(var G=(R||12)/12,Y=K.positions,$=K.cells,B=0,N=$.length;B<N;++B)for(var U=$[B],te=2;te>=0;--te){var j=Y[U[te]];l.push(G*j[0],-G*j[1],S)}}for(var _=[0,0,0],w=[0,0,0],k=[0,0,0],L=[0,0,0],M={breaklines:!0,bolds:!0,italics:!0,subscripts:!0,superscripts:!0},I=0;I<3;++I){k[I]=l.length/3|0,T(.5*(c[0][I]+c[1][I]),h[I],p[I],12,1.25,M),L[I]=(l.length/3|0)-k[I],_[I]=l.length/3|0;for(var P=0;P<o[I].length;++P)o[I][P].text&&T(o[I][P].x,o[I][P].text,o[I][P].font||b,o[I][P].fontSize||12,1.25,M);w[I]=(l.length/3|0)-_[I]}this.buffer.update(l),this.tickOffset=_,this.tickCount=w,this.labelOffset=k,this.labelCount=L},u.drawTicks=function(c,h,p,o,b,l,T,_){this.tickCount[c]&&(this.shader.uniforms.axis=l,this.shader.uniforms.color=b,this.shader.uniforms.angle=p,this.shader.uniforms.scale=h,this.shader.uniforms.offset=o,this.shader.uniforms.alignDir=T,this.shader.uniforms.alignOpt=_,this.vao.draw(this.gl.TRIANGLES,this.tickCount[c],this.tickOffset[c]))},u.drawLabel=function(c,h,p,o,b,l,T,_){this.labelCount[c]&&(this.shader.uniforms.axis=l,this.shader.uniforms.color=b,this.shader.uniforms.angle=p,this.shader.uniforms.scale=h,this.shader.uniforms.offset=o,this.shader.uniforms.alignDir=T,this.shader.uniforms.alignOpt=_,this.vao.draw(this.gl.TRIANGLES,this.labelCount[c],this.labelOffset[c]))},u.dispose=function(){this.shader.dispose(),this.vao.dispose(),this.buffer.dispose()}}).call(this)}).call(this,v("_process"))},{"./shaders":74,_process:5,"gl-buffer":78,"gl-vao":150,"vectorize-text":311}],76:[function(v,m,x){"use strict";function e(n,t){var a=n+"",r=a.indexOf("."),d=0;r>=0&&(d=a.length-r-1);var s=Math.pow(10,d),i=Math.round(n*t*s),u=i+"";if(u.indexOf("e")>=0)return u;var f=i/s,c=i%s;i<0?(f=0|-Math.ceil(f),c=0|-c):(f=0|Math.floor(f),c|=0);var h=""+f;if(i<0&&(h="-"+h),d){for(var p=""+c;p.length<d;)p="0"+p;return h+"."+p}return h}x.create=function(n,t){for(var a=[],r=0;r<3;++r){for(var d=[],s=0;s*t[r]<=n[1][r];++s)d.push({x:s*t[r],text:e(t[r],s)});for(s=-1;s*t[r]>=n[0][r];--s)d.push({x:s*t[r],text:e(t[r],s)});a.push(d)}return a},x.equal=function(n,t){for(var a=0;a<3;++a){if(n[a].length!==t[a].length)return!1;for(var r=0;r<n[a].length;++r){var d=n[a][r],s=t[a][r];if(d.x!==s.x||d.text!==s.text||d.font!==s.font||d.fontColor!==s.fontColor||d.fontSize!==s.fontSize||d.dx!==s.dx||d.dy!==s.dy)return!1}}return!0}},{}],77:[function(v,m,x){"use strict";m.exports=function(b,l,T,_,w){var k=l.model||s,L=l.view||s,M=l.projection||s,I=l._ortho||!1,P=b.bounds,S=(w=w||t(k,L,M,P,I)).axis;a(i,L,k),a(i,M,i);for(var E=p,z=0;z<3;++z)E[z].lo=1/0,E[z].hi=-1/0,E[z].pixelsPerDataUnit=1/0;var R=e(r(i,i));r(i,i);for(var q=0;q<3;++q){var V=(q+1)%3,W=(q+2)%3,K=o;e:for(z=0;z<2;++z){var G=[];if(S[q]<0!=!!z){K[q]=P[z][q];for(var Y=0;Y<2;++Y){K[V]=P[Y^z][V];for(var $=0;$<2;++$)K[W]=P[$^Y^z][W],G.push(K.slice())}var B=I?5:4;for(Y=B;Y===B;++Y){if(0===G.length)continue e;G=n.positive(G,R[Y])}for(Y=0;Y<G.length;++Y){var N=h(o,i,W=G[Y],T,_);for($=0;$<3;++$)E[$].lo=Math.min(E[$].lo,W[$]),E[$].hi=Math.max(E[$].hi,W[$]),$!==q&&(E[$].pixelsPerDataUnit=Math.min(E[$].pixelsPerDataUnit,Math.abs(N[$])))}}}}return E};var e=v("extract-frustum-planes"),n=v("split-polygon"),t=v("./lib/cube.js"),a=v("gl-mat4/multiply"),r=v("gl-mat4/transpose"),d=v("gl-vec4/transformMat4"),s=new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]),i=new Float32Array(16);function u(b,l,T){this.lo=b,this.hi=l,this.pixelsPerDataUnit=T}var f=[0,0,0,1],c=[0,0,0,1];function h(b,l,T,_,w){for(var k=0;k<3;++k){for(var L=f,M=c,I=0;I<3;++I)M[I]=L[I]=T[I];M[3]=L[3]=1,M[k]+=1,d(M,M,l),M[3]<0&&(b[k]=1/0),L[k]-=1,d(L,L,l),L[3]<0&&(b[k]=1/0);var P=(L[0]/L[3]-M[0]/M[3])*_,S=(L[1]/L[3]-M[1]/M[3])*w;b[k]=.25*Math.sqrt(P*P+S*S)}return b}var p=[new u(1/0,-1/0,1/0),new u(1/0,-1/0,1/0),new u(1/0,-1/0,1/0)],o=[0,0,0]},{"./lib/cube.js":72,"extract-frustum-planes":67,"gl-mat4/multiply":100,"gl-mat4/transpose":109,"gl-vec4/transformMat4":221,"split-polygon":300}],78:[function(v,m,x){"use strict";var e=v("typedarray-pool"),n=v("ndarray-ops"),t=v("ndarray"),a=["uint8","uint8_clamped","uint16","uint32","int8","int16","int32","float32"];function r(u,f,c,h,p){this.gl=u,this.type=f,this.handle=c,this.length=h,this.usage=p}var d=r.prototype;function s(u,f,c,h,p,o){var b=p.length*p.BYTES_PER_ELEMENT;if(o<0)return u.bufferData(f,p,h),b;if(b+o>c)throw new Error("gl-buffer: If resizing buffer, must not specify offset");return u.bufferSubData(f,o,p),c}d.bind=function(){this.gl.bindBuffer(this.type,this.handle)},d.unbind=function(){this.gl.bindBuffer(this.type,null)},d.dispose=function(){this.gl.deleteBuffer(this.handle)},d.update=function(u,f){if("number"!=typeof f&&(f=-1),this.bind(),"object"==typeof u&&void 0!==u.shape){var c=u.dtype;if(a.indexOf(c)<0&&(c="float32"),this.type===this.gl.ELEMENT_ARRAY_BUFFER&&(c=gl.getExtension("OES_element_index_uint")&&"uint16"!==c?"uint32":"uint16"),c===u.dtype&&function(b,l){for(var T=1,_=l.length-1;_>=0;--_){if(l[_]!==T)return!1;T*=b[_]}return!0}(u.shape,u.stride))this.length=s(this.gl,this.type,this.length,this.usage,0===u.offset&&u.data.length===u.shape[0]?u.data:u.data.subarray(u.offset,u.shape[0]),f);else{var h=e.malloc(u.size,c),p=t(h,u.shape);n.assign(p,u),this.length=s(this.gl,this.type,this.length,this.usage,f<0?h:h.subarray(0,u.size),f),e.free(h)}}else if(Array.isArray(u)){var o;o=function i(u,f){for(var c=e.malloc(u.length,f),h=u.length,p=0;p<h;++p)c[p]=u[p];return c}(u,this.type===this.gl.ELEMENT_ARRAY_BUFFER?"uint16":"float32"),this.length=s(this.gl,this.type,this.length,this.usage,f<0?o:o.subarray(0,u.length),f),e.free(o)}else if("object"==typeof u&&"number"==typeof u.length)this.length=s(this.gl,this.type,this.length,this.usage,u,f);else{if("number"!=typeof u&&void 0!==u)throw new Error("gl-buffer: Invalid data type");if(f>=0)throw new Error("gl-buffer: Cannot specify offset when resizing buffer");(u|=0)<=0&&(u=1),this.gl.bufferData(this.type,0|u,this.usage),this.length=u}},m.exports=function(u,f,c,h){if(h=h||u.DYNAMIC_DRAW,(c=c||u.ARRAY_BUFFER)!==u.ARRAY_BUFFER&&c!==u.ELEMENT_ARRAY_BUFFER)throw new Error("gl-buffer: Invalid type for webgl buffer, must be either gl.ARRAY_BUFFER or gl.ELEMENT_ARRAY_BUFFER");if(h!==u.DYNAMIC_DRAW&&h!==u.STATIC_DRAW&&h!==u.STREAM_DRAW)throw new Error("gl-buffer: Invalid usage for buffer, must be either gl.DYNAMIC_DRAW, gl.STATIC_DRAW or gl.STREAM_DRAW");var p=u.createBuffer(),o=new r(u,c,p,0,h);return o.update(f),o}},{ndarray:259,"ndarray-ops":254,"typedarray-pool":308}],79:[function(v,m,x){"use strict";var e=v("gl-vec3");m.exports=function(t,a){var r=t.positions,d=t.vectors,s={positions:[],vertexIntensity:[],vertexIntensityBounds:t.vertexIntensityBounds,vectors:[],cells:[],coneOffset:t.coneOffset,colormap:t.colormap};if(0===t.positions.length)return a&&(a[0]=[0,0,0],a[1]=[0,0,0]),s;for(var i=0,u=1/0,f=-1/0,c=1/0,h=-1/0,p=1/0,o=-1/0,b=null,l=null,T=[],_=1/0,w=!1,k=0;k<r.length;k++){var L=r[k];u=Math.min(L[0],u),f=Math.max(L[0],f),c=Math.min(L[1],c),h=Math.max(L[1],h),p=Math.min(L[2],p),o=Math.max(L[2],o);var M=d[k];if(e.length(M)>i&&(i=e.length(M)),k){var I=2*e.distance(b,L)/(e.length(l)+e.length(M));I?(_=Math.min(_,I),w=!1):w=!0}w||(b=L,l=M),T.push(M)}var S=[f,h,o];a&&(a[0]=[u,c,p],a[1]=S),0===i&&(i=1);var E=1/i;isFinite(_)||(_=1),s.vectorScale=_;var z=t.coneSize||.5;t.absoluteConeSize&&(z=t.absoluteConeSize*E),s.coneScale=z,k=0;for(var R=0;k<r.length;k++)for(var q=(L=r[k])[0],V=L[1],W=L[2],K=T[k],G=e.length(K)*E,Y=0;Y<8;Y++){s.positions.push([q,V,W,R++]),s.positions.push([q,V,W,R++]),s.positions.push([q,V,W,R++]),s.positions.push([q,V,W,R++]),s.positions.push([q,V,W,R++]),s.positions.push([q,V,W,R++]),s.vectors.push(K),s.vectors.push(K),s.vectors.push(K),s.vectors.push(K),s.vectors.push(K),s.vectors.push(K),s.vertexIntensity.push(G,G,G),s.vertexIntensity.push(G,G,G);var $=s.positions.length;s.cells.push([$-6,$-5,$-4],[$-3,$-2,$-1])}return s};var n=v("./lib/shaders");m.exports.createMesh=v("./create_mesh"),m.exports.createConeMesh=function(t,a){return m.exports.createMesh(t,a,{shaders:n,traceType:"cone"})}},{"./create_mesh":80,"./lib/shaders":81,"gl-vec3":169}],80:[function(v,m,x){"use strict";var e=v("gl-shader"),n=v("gl-buffer"),t=v("gl-vao"),a=v("gl-texture2d"),r=v("gl-mat4/multiply"),d=v("gl-mat4/invert"),s=v("ndarray"),i=v("colormap"),u=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];function f(o,b,l,T,_,w,k,L,M,I,P){this.gl=o,this.pixelRatio=1,this.cells=[],this.positions=[],this.intensity=[],this.texture=b,this.dirty=!0,this.triShader=l,this.pickShader=T,this.trianglePositions=_,this.triangleVectors=w,this.triangleColors=L,this.triangleUVs=M,this.triangleIds=k,this.triangleVAO=I,this.triangleCount=0,this.pickId=1,this.bounds=[[1/0,1/0,1/0],[-1/0,-1/0,-1/0]],this.clipBounds=[[-1/0,-1/0,-1/0],[1/0,1/0,1/0]],this.lightPosition=[1e5,1e5,0],this.ambientLight=.8,this.diffuseLight=.8,this.specularLight=2,this.roughness=.5,this.fresnel=1.5,this.opacity=1,this.traceType=P,this.tubeScale=1,this.coneScale=2,this.vectorScale=1,this.coneOffset=.25,this._model=u,this._view=u,this._projection=u,this._resolution=[1,1]}var c=f.prototype;function h(o,b){var l=e(o,b.meshShader.vertex,b.meshShader.fragment,null,b.meshShader.attributes);return l.attributes.position.location=0,l.attributes.color.location=2,l.attributes.uv.location=3,l.attributes.vector.location=4,l}function p(o,b){var l=e(o,b.pickShader.vertex,b.pickShader.fragment,null,b.pickShader.attributes);return l.attributes.position.location=0,l.attributes.id.location=1,l.attributes.vector.location=4,l}c.isOpaque=function(){return this.opacity>=1},c.isTransparent=function(){return this.opacity<1},c.pickSlots=1,c.setPickBase=function(o){this.pickId=o},c.update=function(o){o=o||{};var b=this.gl;this.dirty=!0,"lightPosition"in o&&(this.lightPosition=o.lightPosition),"opacity"in o&&(this.opacity=o.opacity),"ambient"in o&&(this.ambientLight=o.ambient),"diffuse"in o&&(this.diffuseLight=o.diffuse),"specular"in o&&(this.specularLight=o.specular),"roughness"in o&&(this.roughness=o.roughness),"fresnel"in o&&(this.fresnel=o.fresnel),void 0!==o.tubeScale&&(this.tubeScale=o.tubeScale),void 0!==o.vectorScale&&(this.vectorScale=o.vectorScale),void 0!==o.coneScale&&(this.coneScale=o.coneScale),void 0!==o.coneOffset&&(this.coneOffset=o.coneOffset),o.colormap&&(this.texture.shape=[256,256],this.texture.minFilter=b.LINEAR_MIPMAP_LINEAR,this.texture.magFilter=b.LINEAR,this.texture.setPixels(function(te){for(var j=i({colormap:te,nshades:256,format:"rgba"}),J=new Uint8Array(1024),X=0;X<256;++X){for(var re=j[X],ne=0;ne<3;++ne)J[4*X+ne]=re[ne];J[4*X+3]=255*re[3]}return s(J,[256,256,4],[4,0,1])}(o.colormap)),this.texture.generateMipmap());var l=o.cells,T=o.positions,_=o.vectors;if(T&&l&&_){var w=[],k=[],L=[],M=[],I=[];this.cells=l,this.positions=T,this.vectors=_;var P=o.meshColor||[1,1,1,1],S=o.vertexIntensity,E=1/0,z=-1/0;if(S)if(o.vertexIntensityBounds)E=+o.vertexIntensityBounds[0],z=+o.vertexIntensityBounds[1];else for(var R=0;R<S.length;++R){var q=S[R];E=Math.min(E,q),z=Math.max(z,q)}else for(R=0;R<T.length;++R)q=T[R][2],E=Math.min(E,q),z=Math.max(z,q);for(this.intensity=S||function(te){for(var j=te.length,J=new Array(j),X=0;X<j;++X)J[X]=te[X][2];return J}(T),this.bounds=[[1/0,1/0,1/0],[-1/0,-1/0,-1/0]],R=0;R<T.length;++R)for(var V=T[R],W=0;W<3;++W)!isNaN(V[W])&&isFinite(V[W])&&(this.bounds[0][W]=Math.min(this.bounds[0][W],V[W]),this.bounds[1][W]=Math.max(this.bounds[1][W],V[W]));var K=0;e:for(R=0;R<l.length;++R){var G=l[R];if(3===G.length){for(W=0;W<3;++W){V=T[$=G[W]];for(var Y=0;Y<3;++Y)if(isNaN(V[Y])||!isFinite(V[Y]))continue e}for(W=0;W<3;++W){var $;V=T[$=G[2-W]],w.push(V[0],V[1],V[2],V[3]);var B=_[$];k.push(B[0],B[1],B[2],B[3]||0);var N;L.push(P[0],P[1],P[2],3===P.length?1:P[3]),M.push((N=S?[(S[$]-E)/(z-E),0]:[(V[2]-E)/(z-E),0])[0],N[1]),I.push(R)}K+=1}}this.triangleCount=K,this.trianglePositions.update(w),this.triangleVectors.update(k),this.triangleColors.update(L),this.triangleUVs.update(M),this.triangleIds.update(new Uint32Array(I))}},c.drawTransparent=c.draw=function(o){for(var b=this.gl,l=(o=o||{}).model||u,T=o.view||u,_=o.projection||u,w=[[-1e6,-1e6,-1e6],[1e6,1e6,1e6]],k=0;k<3;++k)w[0][k]=Math.max(w[0][k],this.clipBounds[0][k]),w[1][k]=Math.min(w[1][k],this.clipBounds[1][k]);var L={model:l,view:T,projection:_,inverseModel:u.slice(),clipBounds:w,kambient:this.ambientLight,kdiffuse:this.diffuseLight,kspecular:this.specularLight,roughness:this.roughness,fresnel:this.fresnel,eyePosition:[0,0,0],lightPosition:[0,0,0],opacity:this.opacity,tubeScale:this.tubeScale,vectorScale:this.vectorScale,coneScale:this.coneScale,coneOffset:this.coneOffset,texture:0};L.inverseModel=d(L.inverseModel,L.model),b.disable(b.CULL_FACE),this.texture.bind(0);var M=new Array(16);for(r(M,L.view,L.model),r(M,L.projection,M),d(M,M),k=0;k<3;++k)L.eyePosition[k]=M[12+k]/M[15];var I=M[15];for(k=0;k<3;++k)I+=this.lightPosition[k]*M[4*k+3];for(k=0;k<3;++k){for(var P=M[12+k],S=0;S<3;++S)P+=M[4*S+k]*this.lightPosition[S];L.lightPosition[k]=P/I}if(this.triangleCount>0){var E=this.triShader;E.bind(),E.uniforms=L,this.triangleVAO.bind(),b.drawArrays(b.TRIANGLES,0,3*this.triangleCount),this.triangleVAO.unbind()}},c.drawPick=function(o){for(var b=this.gl,l=(o=o||{}).model||u,T=o.view||u,_=o.projection||u,w=[[-1e6,-1e6,-1e6],[1e6,1e6,1e6]],k=0;k<3;++k)w[0][k]=Math.max(w[0][k],this.clipBounds[0][k]),w[1][k]=Math.min(w[1][k],this.clipBounds[1][k]);this._model=[].slice.call(l),this._view=[].slice.call(T),this._projection=[].slice.call(_),this._resolution=[b.drawingBufferWidth,b.drawingBufferHeight];var L={model:l,view:T,projection:_,clipBounds:w,tubeScale:this.tubeScale,vectorScale:this.vectorScale,coneScale:this.coneScale,coneOffset:this.coneOffset,pickId:this.pickId/255},M=this.pickShader;M.bind(),M.uniforms=L,this.triangleCount>0&&(this.triangleVAO.bind(),b.drawArrays(b.TRIANGLES,0,3*this.triangleCount),this.triangleVAO.unbind())},c.pick=function(o){if(!o||o.id!==this.pickId)return null;var b=o.value[0]+256*o.value[1]+65536*o.value[2],l=this.cells[b],T=this.positions[l[1]].slice(0,3),_={position:T,dataCoordinate:T,index:Math.floor(l[1]/48)};return"cone"===this.traceType?_.index=Math.floor(l[1]/48):"streamtube"===this.traceType&&(_.intensity=this.intensity[l[1]],_.velocity=this.vectors[l[1]].slice(0,3),_.divergence=this.vectors[l[1]][3],_.index=b),_},c.dispose=function(){this.texture.dispose(),this.triShader.dispose(),this.pickShader.dispose(),this.triangleVAO.dispose(),this.trianglePositions.dispose(),this.triangleVectors.dispose(),this.triangleColors.dispose(),this.triangleUVs.dispose(),this.triangleIds.dispose()},m.exports=function(o,b,l){var T=l.shaders;1===arguments.length&&(o=(b=o).gl);var _=h(o,T),w=p(o,T),k=a(o,s(new Uint8Array([255,255,255,255]),[1,1,4]));k.generateMipmap(),k.minFilter=o.LINEAR_MIPMAP_LINEAR,k.magFilter=o.LINEAR;var L=n(o),M=n(o),I=n(o),P=n(o),S=n(o),z=new f(o,k,_,w,L,M,S,I,P,t(o,[{buffer:L,type:o.FLOAT,size:4},{buffer:S,type:o.UNSIGNED_BYTE,size:4,normalized:!0},{buffer:I,type:o.FLOAT,size:4},{buffer:P,type:o.FLOAT,size:2},{buffer:M,type:o.FLOAT,size:4}]),l.traceType||"cone");return z.update(b),z}},{colormap:53,"gl-buffer":78,"gl-mat4/invert":98,"gl-mat4/multiply":100,"gl-shader":132,"gl-texture2d":146,"gl-vao":150,ndarray:259}],81:[function(v,m,x){var e=v("glslify"),n=e(["precision highp float;\n\nprecision highp float;\n#define GLSLIFY 1\n\nvec3 getOrthogonalVector(vec3 v) {\n  // Return up-vector for only-z vector.\n  // Return ax + by + cz = 0, a point that lies on the plane that has v as a normal and that isn't (0,0,0).\n  // From the above if-statement we have ||a|| > 0  U  ||b|| > 0.\n  // Assign z = 0, x = -b, y = a:\n  // a*-b + b*a + c*0 = -ba + ba + 0 = 0\n  if (v.x*v.x > v.z*v.z || v.y*v.y > v.z*v.z) {\n    return normalize(vec3(-v.y, v.x, 0.0));\n  } else {\n    return normalize(vec3(0.0, v.z, -v.y));\n  }\n}\n\n// Calculate the cone vertex and normal at the given index.\n//\n// The returned vertex is for a cone with its top at origin and height of 1.0,\n// pointing in the direction of the vector attribute.\n//\n// Each cone is made up of a top vertex, a center base vertex and base perimeter vertices.\n// These vertices are used to make up the triangles of the cone by the following:\n//   segment + 0 top vertex\n//   segment + 1 perimeter vertex a+1\n//   segment + 2 perimeter vertex a\n//   segment + 3 center base vertex\n//   segment + 4 perimeter vertex a\n//   segment + 5 perimeter vertex a+1\n// Where segment is the number of the radial segment * 6 and a is the angle at that radial segment.\n// To go from index to segment, floor(index / 6)\n// To go from segment to angle, 2*pi * (segment/segmentCount)\n// To go from index to segment index, index - (segment*6)\n//\nvec3 getConePosition(vec3 d, float rawIndex, float coneOffset, out vec3 normal) {\n\n  const float segmentCount = 8.0;\n\n  float index = rawIndex - floor(rawIndex /\n    (segmentCount * 6.0)) *\n    (segmentCount * 6.0);\n\n  float segment = floor(0.001 + index/6.0);\n  float segmentIndex = index - (segment*6.0);\n\n  normal = -normalize(d);\n\n  if (segmentIndex > 2.99 && segmentIndex < 3.01) {\n    return mix(vec3(0.0), -d, coneOffset);\n  }\n\n  float nextAngle = (\n    (segmentIndex > 0.99 &&  segmentIndex < 1.01) ||\n    (segmentIndex > 4.99 &&  segmentIndex < 5.01)\n  ) ? 1.0 : 0.0;\n  float angle = 2.0 * 3.14159 * ((segment + nextAngle) / segmentCount);\n\n  vec3 v1 = mix(d, vec3(0.0), coneOffset);\n  vec3 v2 = v1 - d;\n\n  vec3 u = getOrthogonalVector(d);\n  vec3 v = normalize(cross(u, d));\n\n  vec3 x = u * cos(angle) * length(d)*0.25;\n  vec3 y = v * sin(angle) * length(d)*0.25;\n  vec3 v3 = v2 + x + y;\n  if (segmentIndex < 3.0) {\n    vec3 tx = u * sin(angle);\n    vec3 ty = v * -cos(angle);\n    vec3 tangent = tx + ty;\n    normal = normalize(cross(v3 - v1, tangent));\n  }\n\n  if (segmentIndex == 0.0) {\n    return mix(d, vec3(0.0), coneOffset);\n  }\n  return v3;\n}\n\nattribute vec3 vector;\nattribute vec4 color, position;\nattribute vec2 uv;\n\nuniform float vectorScale, coneScale, coneOffset;\nuniform mat4 model, view, projection, inverseModel;\nuniform vec3 eyePosition, lightPosition;\n\nvarying vec3 f_normal, f_lightDirection, f_eyeDirection, f_data, f_position;\nvarying vec4 f_color;\nvarying vec2 f_uv;\n\nvoid main() {\n  // Scale the vector magnitude to stay constant with\n  // model & view changes.\n  vec3 normal;\n  vec3 XYZ = getConePosition(mat3(model) * ((vectorScale * coneScale) * vector), position.w, coneOffset, normal);\n  vec4 conePosition = model * vec4(position.xyz, 1.0) + vec4(XYZ, 0.0);\n\n  //Lighting geometry parameters\n  vec4 cameraCoordinate = view * conePosition;\n  cameraCoordinate.xyz /= cameraCoordinate.w;\n  f_lightDirection = lightPosition - cameraCoordinate.xyz;\n  f_eyeDirection   = eyePosition - cameraCoordinate.xyz;\n  f_normal = normalize((vec4(normal, 0.0) * inverseModel).xyz);\n\n  // vec4 m_position  = model * vec4(conePosition, 1.0);\n  vec4 t_position  = view * conePosition;\n  gl_Position      = projection * t_position;\n\n  f_color          = color;\n  f_data           = conePosition.xyz;\n  f_position       = position.xyz;\n  f_uv             = uv;\n}\n"]),t=e(["#extension GL_OES_standard_derivatives : enable\n\nprecision highp float;\n#define GLSLIFY 1\n\nfloat beckmannDistribution(float x, float roughness) {\n  float NdotH = max(x, 0.0001);\n  float cos2Alpha = NdotH * NdotH;\n  float tan2Alpha = (cos2Alpha - 1.0) / cos2Alpha;\n  float roughness2 = roughness * roughness;\n  float denom = 3.141592653589793 * roughness2 * cos2Alpha * cos2Alpha;\n  return exp(tan2Alpha / roughness2) / denom;\n}\n\nfloat cookTorranceSpecular(\n  vec3 lightDirection,\n  vec3 viewDirection,\n  vec3 surfaceNormal,\n  float roughness,\n  float fresnel) {\n\n  float VdotN = max(dot(viewDirection, surfaceNormal), 0.0);\n  float LdotN = max(dot(lightDirection, surfaceNormal), 0.0);\n\n  //Half angle vector\n  vec3 H = normalize(lightDirection + viewDirection);\n\n  //Geometric term\n  float NdotH = max(dot(surfaceNormal, H), 0.0);\n  float VdotH = max(dot(viewDirection, H), 0.000001);\n  float LdotH = max(dot(lightDirection, H), 0.000001);\n  float G1 = (2.0 * NdotH * VdotN) / VdotH;\n  float G2 = (2.0 * NdotH * LdotN) / LdotH;\n  float G = min(1.0, min(G1, G2));\n  \n  //Distribution term\n  float D = beckmannDistribution(NdotH, roughness);\n\n  //Fresnel term\n  float F = pow(1.0 - VdotN, fresnel);\n\n  //Multiply terms and done\n  return  G * F * D / max(3.14159265 * VdotN, 0.000001);\n}\n\nbool outOfRange(float a, float b, float p) {\n  return ((p > max(a, b)) || \n          (p < min(a, b)));\n}\n\nbool outOfRange(vec2 a, vec2 b, vec2 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y));\n}\n\nbool outOfRange(vec3 a, vec3 b, vec3 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y) ||\n          outOfRange(a.z, b.z, p.z));\n}\n\nbool outOfRange(vec4 a, vec4 b, vec4 p) {\n  return outOfRange(a.xyz, b.xyz, p.xyz);\n}\n\nuniform vec3 clipBounds[2];\nuniform float roughness, fresnel, kambient, kdiffuse, kspecular, opacity;\nuniform sampler2D texture;\n\nvarying vec3 f_normal, f_lightDirection, f_eyeDirection, f_data, f_position;\nvarying vec4 f_color;\nvarying vec2 f_uv;\n\nvoid main() {\n  if (outOfRange(clipBounds[0], clipBounds[1], f_position)) discard;\n  vec3 N = normalize(f_normal);\n  vec3 L = normalize(f_lightDirection);\n  vec3 V = normalize(f_eyeDirection);\n\n  if(gl_FrontFacing) {\n    N = -N;\n  }\n\n  float specular = min(1.0, max(0.0, cookTorranceSpecular(L, V, N, roughness, fresnel)));\n  float diffuse  = min(kambient + kdiffuse * max(dot(N, L), 0.0), 1.0);\n\n  vec4 surfaceColor = f_color * texture2D(texture, f_uv);\n  vec4 litColor = surfaceColor.a * vec4(diffuse * surfaceColor.rgb + kspecular * vec3(1,1,1) * specular,  1.0);\n\n  gl_FragColor = litColor * opacity;\n}\n"]),a=e(["precision highp float;\n\nprecision highp float;\n#define GLSLIFY 1\n\nvec3 getOrthogonalVector(vec3 v) {\n  // Return up-vector for only-z vector.\n  // Return ax + by + cz = 0, a point that lies on the plane that has v as a normal and that isn't (0,0,0).\n  // From the above if-statement we have ||a|| > 0  U  ||b|| > 0.\n  // Assign z = 0, x = -b, y = a:\n  // a*-b + b*a + c*0 = -ba + ba + 0 = 0\n  if (v.x*v.x > v.z*v.z || v.y*v.y > v.z*v.z) {\n    return normalize(vec3(-v.y, v.x, 0.0));\n  } else {\n    return normalize(vec3(0.0, v.z, -v.y));\n  }\n}\n\n// Calculate the cone vertex and normal at the given index.\n//\n// The returned vertex is for a cone with its top at origin and height of 1.0,\n// pointing in the direction of the vector attribute.\n//\n// Each cone is made up of a top vertex, a center base vertex and base perimeter vertices.\n// These vertices are used to make up the triangles of the cone by the following:\n//   segment + 0 top vertex\n//   segment + 1 perimeter vertex a+1\n//   segment + 2 perimeter vertex a\n//   segment + 3 center base vertex\n//   segment + 4 perimeter vertex a\n//   segment + 5 perimeter vertex a+1\n// Where segment is the number of the radial segment * 6 and a is the angle at that radial segment.\n// To go from index to segment, floor(index / 6)\n// To go from segment to angle, 2*pi * (segment/segmentCount)\n// To go from index to segment index, index - (segment*6)\n//\nvec3 getConePosition(vec3 d, float rawIndex, float coneOffset, out vec3 normal) {\n\n  const float segmentCount = 8.0;\n\n  float index = rawIndex - floor(rawIndex /\n    (segmentCount * 6.0)) *\n    (segmentCount * 6.0);\n\n  float segment = floor(0.001 + index/6.0);\n  float segmentIndex = index - (segment*6.0);\n\n  normal = -normalize(d);\n\n  if (segmentIndex > 2.99 && segmentIndex < 3.01) {\n    return mix(vec3(0.0), -d, coneOffset);\n  }\n\n  float nextAngle = (\n    (segmentIndex > 0.99 &&  segmentIndex < 1.01) ||\n    (segmentIndex > 4.99 &&  segmentIndex < 5.01)\n  ) ? 1.0 : 0.0;\n  float angle = 2.0 * 3.14159 * ((segment + nextAngle) / segmentCount);\n\n  vec3 v1 = mix(d, vec3(0.0), coneOffset);\n  vec3 v2 = v1 - d;\n\n  vec3 u = getOrthogonalVector(d);\n  vec3 v = normalize(cross(u, d));\n\n  vec3 x = u * cos(angle) * length(d)*0.25;\n  vec3 y = v * sin(angle) * length(d)*0.25;\n  vec3 v3 = v2 + x + y;\n  if (segmentIndex < 3.0) {\n    vec3 tx = u * sin(angle);\n    vec3 ty = v * -cos(angle);\n    vec3 tangent = tx + ty;\n    normal = normalize(cross(v3 - v1, tangent));\n  }\n\n  if (segmentIndex == 0.0) {\n    return mix(d, vec3(0.0), coneOffset);\n  }\n  return v3;\n}\n\nattribute vec4 vector;\nattribute vec4 position;\nattribute vec4 id;\n\nuniform mat4 model, view, projection;\nuniform float vectorScale, coneScale, coneOffset;\n\nvarying vec3 f_position;\nvarying vec4 f_id;\n\nvoid main() {\n  vec3 normal;\n  vec3 XYZ = getConePosition(mat3(model) * ((vectorScale * coneScale) * vector.xyz), position.w, coneOffset, normal);\n  vec4 conePosition = model * vec4(position.xyz, 1.0) + vec4(XYZ, 0.0);\n  gl_Position = projection * view * conePosition;\n  f_id        = id;\n  f_position  = position.xyz;\n}\n"]),r=e(["precision highp float;\n#define GLSLIFY 1\n\nbool outOfRange(float a, float b, float p) {\n  return ((p > max(a, b)) || \n          (p < min(a, b)));\n}\n\nbool outOfRange(vec2 a, vec2 b, vec2 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y));\n}\n\nbool outOfRange(vec3 a, vec3 b, vec3 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y) ||\n          outOfRange(a.z, b.z, p.z));\n}\n\nbool outOfRange(vec4 a, vec4 b, vec4 p) {\n  return outOfRange(a.xyz, b.xyz, p.xyz);\n}\n\nuniform vec3  clipBounds[2];\nuniform float pickId;\n\nvarying vec3 f_position;\nvarying vec4 f_id;\n\nvoid main() {\n  if (outOfRange(clipBounds[0], clipBounds[1], f_position)) discard;\n\n  gl_FragColor = vec4(pickId, f_id.xyz);\n}"]);x.meshShader={vertex:n,fragment:t,attributes:[{name:"position",type:"vec4"},{name:"color",type:"vec4"},{name:"uv",type:"vec2"},{name:"vector",type:"vec3"}]},x.pickShader={vertex:a,fragment:r,attributes:[{name:"position",type:"vec4"},{name:"id",type:"vec4"},{name:"vector",type:"vec3"}]}},{glslify:231}],82:[function(v,m,x){m.exports={0:"NONE",1:"ONE",2:"LINE_LOOP",3:"LINE_STRIP",4:"TRIANGLES",5:"TRIANGLE_STRIP",6:"TRIANGLE_FAN",256:"DEPTH_BUFFER_BIT",512:"NEVER",513:"LESS",514:"EQUAL",515:"LEQUAL",516:"GREATER",517:"NOTEQUAL",518:"GEQUAL",519:"ALWAYS",768:"SRC_COLOR",769:"ONE_MINUS_SRC_COLOR",770:"SRC_ALPHA",771:"ONE_MINUS_SRC_ALPHA",772:"DST_ALPHA",773:"ONE_MINUS_DST_ALPHA",774:"DST_COLOR",775:"ONE_MINUS_DST_COLOR",776:"SRC_ALPHA_SATURATE",1024:"STENCIL_BUFFER_BIT",1028:"FRONT",1029:"BACK",1032:"FRONT_AND_BACK",1280:"INVALID_ENUM",1281:"INVALID_VALUE",1282:"INVALID_OPERATION",1285:"OUT_OF_MEMORY",1286:"INVALID_FRAMEBUFFER_OPERATION",2304:"CW",2305:"CCW",2849:"LINE_WIDTH",2884:"CULL_FACE",2885:"CULL_FACE_MODE",2886:"FRONT_FACE",2928:"DEPTH_RANGE",2929:"DEPTH_TEST",2930:"DEPTH_WRITEMASK",2931:"DEPTH_CLEAR_VALUE",2932:"DEPTH_FUNC",2960:"STENCIL_TEST",2961:"STENCIL_CLEAR_VALUE",2962:"STENCIL_FUNC",2963:"STENCIL_VALUE_MASK",2964:"STENCIL_FAIL",2965:"STENCIL_PASS_DEPTH_FAIL",2966:"STENCIL_PASS_DEPTH_PASS",2967:"STENCIL_REF",2968:"STENCIL_WRITEMASK",2978:"VIEWPORT",3024:"DITHER",3042:"BLEND",3088:"SCISSOR_BOX",3089:"SCISSOR_TEST",3106:"COLOR_CLEAR_VALUE",3107:"COLOR_WRITEMASK",3317:"UNPACK_ALIGNMENT",3333:"PACK_ALIGNMENT",3379:"MAX_TEXTURE_SIZE",3386:"MAX_VIEWPORT_DIMS",3408:"SUBPIXEL_BITS",3410:"RED_BITS",3411:"GREEN_BITS",3412:"BLUE_BITS",3413:"ALPHA_BITS",3414:"DEPTH_BITS",3415:"STENCIL_BITS",3553:"TEXTURE_2D",4352:"DONT_CARE",4353:"FASTEST",4354:"NICEST",5120:"BYTE",5121:"UNSIGNED_BYTE",5122:"SHORT",5123:"UNSIGNED_SHORT",5124:"INT",5125:"UNSIGNED_INT",5126:"FLOAT",5386:"INVERT",5890:"TEXTURE",6401:"STENCIL_INDEX",6402:"DEPTH_COMPONENT",6406:"ALPHA",6407:"RGB",6408:"RGBA",6409:"LUMINANCE",6410:"LUMINANCE_ALPHA",7680:"KEEP",7681:"REPLACE",7682:"INCR",7683:"DECR",7936:"VENDOR",7937:"RENDERER",7938:"VERSION",9728:"NEAREST",9729:"LINEAR",9984:"NEAREST_MIPMAP_NEAREST",9985:"LINEAR_MIPMAP_NEAREST",9986:"NEAREST_MIPMAP_LINEAR",9987:"LINEAR_MIPMAP_LINEAR",10240:"TEXTURE_MAG_FILTER",10241:"TEXTURE_MIN_FILTER",10242:"TEXTURE_WRAP_S",10243:"TEXTURE_WRAP_T",10497:"REPEAT",10752:"POLYGON_OFFSET_UNITS",16384:"COLOR_BUFFER_BIT",32769:"CONSTANT_COLOR",32770:"ONE_MINUS_CONSTANT_COLOR",32771:"CONSTANT_ALPHA",32772:"ONE_MINUS_CONSTANT_ALPHA",32773:"BLEND_COLOR",32774:"FUNC_ADD",32777:"BLEND_EQUATION_RGB",32778:"FUNC_SUBTRACT",32779:"FUNC_REVERSE_SUBTRACT",32819:"UNSIGNED_SHORT_4_4_4_4",32820:"UNSIGNED_SHORT_5_5_5_1",32823:"POLYGON_OFFSET_FILL",32824:"POLYGON_OFFSET_FACTOR",32854:"RGBA4",32855:"RGB5_A1",32873:"TEXTURE_BINDING_2D",32926:"SAMPLE_ALPHA_TO_COVERAGE",32928:"SAMPLE_COVERAGE",32936:"SAMPLE_BUFFERS",32937:"SAMPLES",32938:"SAMPLE_COVERAGE_VALUE",32939:"SAMPLE_COVERAGE_INVERT",32968:"BLEND_DST_RGB",32969:"BLEND_SRC_RGB",32970:"BLEND_DST_ALPHA",32971:"BLEND_SRC_ALPHA",33071:"CLAMP_TO_EDGE",33170:"GENERATE_MIPMAP_HINT",33189:"DEPTH_COMPONENT16",33306:"DEPTH_STENCIL_ATTACHMENT",33635:"UNSIGNED_SHORT_5_6_5",33648:"MIRRORED_REPEAT",33901:"ALIASED_POINT_SIZE_RANGE",33902:"ALIASED_LINE_WIDTH_RANGE",33984:"TEXTURE0",33985:"TEXTURE1",33986:"TEXTURE2",33987:"TEXTURE3",33988:"TEXTURE4",33989:"TEXTURE5",33990:"TEXTURE6",33991:"TEXTURE7",33992:"TEXTURE8",33993:"TEXTURE9",33994:"TEXTURE10",33995:"TEXTURE11",33996:"TEXTURE12",33997:"TEXTURE13",33998:"TEXTURE14",33999:"TEXTURE15",34e3:"TEXTURE16",34001:"TEXTURE17",34002:"TEXTURE18",34003:"TEXTURE19",34004:"TEXTURE20",34005:"TEXTURE21",34006:"TEXTURE22",34007:"TEXTURE23",34008:"TEXTURE24",34009:"TEXTURE25",34010:"TEXTURE26",34011:"TEXTURE27",34012:"TEXTURE28",34013:"TEXTURE29",34014:"TEXTURE30",34015:"TEXTURE31",34016:"ACTIVE_TEXTURE",34024:"MAX_RENDERBUFFER_SIZE",34041:"DEPTH_STENCIL",34055:"INCR_WRAP",34056:"DECR_WRAP",34067:"TEXTURE_CUBE_MAP",34068:"TEXTURE_BINDING_CUBE_MAP",34069:"TEXTURE_CUBE_MAP_POSITIVE_X",34070:"TEXTURE_CUBE_MAP_NEGATIVE_X",34071:"TEXTURE_CUBE_MAP_POSITIVE_Y",34072:"TEXTURE_CUBE_MAP_NEGATIVE_Y",34073:"TEXTURE_CUBE_MAP_POSITIVE_Z",34074:"TEXTURE_CUBE_MAP_NEGATIVE_Z",34076:"MAX_CUBE_MAP_TEXTURE_SIZE",34338:"VERTEX_ATTRIB_ARRAY_ENABLED",34339:"VERTEX_ATTRIB_ARRAY_SIZE",34340:"VERTEX_ATTRIB_ARRAY_STRIDE",34341:"VERTEX_ATTRIB_ARRAY_TYPE",34342:"CURRENT_VERTEX_ATTRIB",34373:"VERTEX_ATTRIB_ARRAY_POINTER",34466:"NUM_COMPRESSED_TEXTURE_FORMATS",34467:"COMPRESSED_TEXTURE_FORMATS",34660:"BUFFER_SIZE",34661:"BUFFER_USAGE",34816:"STENCIL_BACK_FUNC",34817:"STENCIL_BACK_FAIL",34818:"STENCIL_BACK_PASS_DEPTH_FAIL",34819:"STENCIL_BACK_PASS_DEPTH_PASS",34877:"BLEND_EQUATION_ALPHA",34921:"MAX_VERTEX_ATTRIBS",34922:"VERTEX_ATTRIB_ARRAY_NORMALIZED",34930:"MAX_TEXTURE_IMAGE_UNITS",34962:"ARRAY_BUFFER",34963:"ELEMENT_ARRAY_BUFFER",34964:"ARRAY_BUFFER_BINDING",34965:"ELEMENT_ARRAY_BUFFER_BINDING",34975:"VERTEX_ATTRIB_ARRAY_BUFFER_BINDING",35040:"STREAM_DRAW",35044:"STATIC_DRAW",35048:"DYNAMIC_DRAW",35632:"FRAGMENT_SHADER",35633:"VERTEX_SHADER",35660:"MAX_VERTEX_TEXTURE_IMAGE_UNITS",35661:"MAX_COMBINED_TEXTURE_IMAGE_UNITS",35663:"SHADER_TYPE",35664:"FLOAT_VEC2",35665:"FLOAT_VEC3",35666:"FLOAT_VEC4",35667:"INT_VEC2",35668:"INT_VEC3",35669:"INT_VEC4",35670:"BOOL",35671:"BOOL_VEC2",35672:"BOOL_VEC3",35673:"BOOL_VEC4",35674:"FLOAT_MAT2",35675:"FLOAT_MAT3",35676:"FLOAT_MAT4",35678:"SAMPLER_2D",35680:"SAMPLER_CUBE",35712:"DELETE_STATUS",35713:"COMPILE_STATUS",35714:"LINK_STATUS",35715:"VALIDATE_STATUS",35716:"INFO_LOG_LENGTH",35717:"ATTACHED_SHADERS",35718:"ACTIVE_UNIFORMS",35719:"ACTIVE_UNIFORM_MAX_LENGTH",35720:"SHADER_SOURCE_LENGTH",35721:"ACTIVE_ATTRIBUTES",35722:"ACTIVE_ATTRIBUTE_MAX_LENGTH",35724:"SHADING_LANGUAGE_VERSION",35725:"CURRENT_PROGRAM",36003:"STENCIL_BACK_REF",36004:"STENCIL_BACK_VALUE_MASK",36005:"STENCIL_BACK_WRITEMASK",36006:"FRAMEBUFFER_BINDING",36007:"RENDERBUFFER_BINDING",36048:"FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE",36049:"FRAMEBUFFER_ATTACHMENT_OBJECT_NAME",36050:"FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL",36051:"FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE",36053:"FRAMEBUFFER_COMPLETE",36054:"FRAMEBUFFER_INCOMPLETE_ATTACHMENT",36055:"FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT",36057:"FRAMEBUFFER_INCOMPLETE_DIMENSIONS",36061:"FRAMEBUFFER_UNSUPPORTED",36064:"COLOR_ATTACHMENT0",36096:"DEPTH_ATTACHMENT",36128:"STENCIL_ATTACHMENT",36160:"FRAMEBUFFER",36161:"RENDERBUFFER",36162:"RENDERBUFFER_WIDTH",36163:"RENDERBUFFER_HEIGHT",36164:"RENDERBUFFER_INTERNAL_FORMAT",36168:"STENCIL_INDEX8",36176:"RENDERBUFFER_RED_SIZE",36177:"RENDERBUFFER_GREEN_SIZE",36178:"RENDERBUFFER_BLUE_SIZE",36179:"RENDERBUFFER_ALPHA_SIZE",36180:"RENDERBUFFER_DEPTH_SIZE",36181:"RENDERBUFFER_STENCIL_SIZE",36194:"RGB565",36336:"LOW_FLOAT",36337:"MEDIUM_FLOAT",36338:"HIGH_FLOAT",36339:"LOW_INT",36340:"MEDIUM_INT",36341:"HIGH_INT",36346:"SHADER_COMPILER",36347:"MAX_VERTEX_UNIFORM_VECTORS",36348:"MAX_VARYING_VECTORS",36349:"MAX_FRAGMENT_UNIFORM_VECTORS",37440:"UNPACK_FLIP_Y_WEBGL",37441:"UNPACK_PREMULTIPLY_ALPHA_WEBGL",37442:"CONTEXT_LOST_WEBGL",37443:"UNPACK_COLORSPACE_CONVERSION_WEBGL",37444:"BROWSER_DEFAULT_WEBGL"}},{}],83:[function(v,m,x){var e=v("./1.0/numbers");m.exports=function(n){return e[n]}},{"./1.0/numbers":82}],84:[function(v,m,x){"use strict";m.exports=function(f){var c=f.gl,h=e(c),p=n(c,[{buffer:h,type:c.FLOAT,size:3,offset:0,stride:40},{buffer:h,type:c.FLOAT,size:4,offset:12,stride:40},{buffer:h,type:c.FLOAT,size:3,offset:28,stride:40}]),o=t(c);o.attributes.position.location=0,o.attributes.color.location=1,o.attributes.offset.location=2;var b=new r(c,h,p,o);return b.update(f),b};var e=v("gl-buffer"),n=v("gl-vao"),t=v("./shaders/index"),a=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];function r(f,c,h,p){this.gl=f,this.shader=p,this.buffer=c,this.vao=h,this.pixelRatio=1,this.bounds=[[1/0,1/0,1/0],[-1/0,-1/0,-1/0]],this.clipBounds=[[-1/0,-1/0,-1/0],[1/0,1/0,1/0]],this.lineWidth=[1,1,1],this.capSize=[10,10,10],this.lineCount=[0,0,0],this.lineOffset=[0,0,0],this.opacity=1,this.hasAlpha=!1}var d=r.prototype;function s(f,c){for(var h=0;h<3;++h)f[0][h]=Math.min(f[0][h],c[h]),f[1][h]=Math.max(f[1][h],c[h])}d.isOpaque=function(){return!this.hasAlpha},d.isTransparent=function(){return this.hasAlpha},d.drawTransparent=d.draw=function(f){var c=this.gl,h=this.shader.uniforms;this.shader.bind();var p=h.view=f.view||a,o=h.projection=f.projection||a;h.model=f.model||a,h.clipBounds=this.clipBounds,h.opacity=this.opacity;var w=(f._ortho?2:1)*this.pixelRatio*(o[3]*p[12]+o[7]*p[13]+o[11]*p[14]+o[15]*p[15])/c.drawingBufferHeight;this.vao.bind();for(var k=0;k<3;++k)c.lineWidth(this.lineWidth[k]*this.pixelRatio),h.capSize=this.capSize[k]*w,this.lineCount[k]&&c.drawArrays(c.LINES,this.lineOffset[k],this.lineCount[k]);this.vao.unbind()};var i=function(){for(var f=new Array(3),c=0;c<3;++c){for(var h=[],p=1;p<=2;++p)for(var o=-1;o<=1;o+=2){var b=[0,0,0];b[(p+c)%3]=o,h.push(b)}f[c]=h}return f}();function u(f,c,h,p){for(var o=i[p],b=0;b<o.length;++b){var l=o[b];f.push(c[0],c[1],c[2],h[0],h[1],h[2],h[3],l[0],l[1],l[2])}return o.length}d.update=function(f){"lineWidth"in(f=f||{})&&(this.lineWidth=f.lineWidth,Array.isArray(this.lineWidth)||(this.lineWidth=[this.lineWidth,this.lineWidth,this.lineWidth])),"capSize"in f&&(this.capSize=f.capSize,Array.isArray(this.capSize)||(this.capSize=[this.capSize,this.capSize,this.capSize])),this.hasAlpha=!1,"opacity"in f&&(this.opacity=+f.opacity,this.opacity<1&&(this.hasAlpha=!0));var c=f.color||[[0,0,0],[0,0,0],[0,0,0]],h=f.position,p=f.error;if(Array.isArray(c[0])||(c=[c,c,c]),h&&p){var o=[],b=h.length,l=0;this.bounds=[[1/0,1/0,1/0],[-1/0,-1/0,-1/0]],this.lineCount=[0,0,0];for(var T=0;T<3;++T){this.lineOffset[T]=l;e:for(var _=0;_<b;++_){for(var w=h[_],k=0;k<3;++k)if(isNaN(w[k])||!isFinite(w[k]))continue e;var I,L=p[_],M=c[T];Array.isArray(M[0])&&(M=c[_]),3===M.length?M=[M[0],M[1],M[2],1]:4===M.length&&(M=[M[0],M[1],M[2],M[3]],!this.hasAlpha&&M[3]<1&&(this.hasAlpha=!0)),isNaN(L[0][T])||isNaN(L[1][T])||(L[0][T]<0&&((I=w.slice())[T]+=L[0][T],o.push(w[0],w[1],w[2],M[0],M[1],M[2],M[3],0,0,0,I[0],I[1],I[2],M[0],M[1],M[2],M[3],0,0,0),s(this.bounds,I),l+=2+u(o,I,M,T)),L[1][T]>0&&((I=w.slice())[T]+=L[1][T],o.push(w[0],w[1],w[2],M[0],M[1],M[2],M[3],0,0,0,I[0],I[1],I[2],M[0],M[1],M[2],M[3],0,0,0),s(this.bounds,I),l+=2+u(o,I,M,T)))}this.lineCount[T]=l-this.lineOffset[T]}this.buffer.update(o)}},d.dispose=function(){this.shader.dispose(),this.buffer.dispose(),this.vao.dispose()}},{"./shaders/index":85,"gl-buffer":78,"gl-vao":150}],85:[function(v,m,x){"use strict";var e=v("glslify"),n=v("gl-shader"),t=e(["precision highp float;\n#define GLSLIFY 1\n\nattribute vec3 position, offset;\nattribute vec4 color;\nuniform mat4 model, view, projection;\nuniform float capSize;\nvarying vec4 fragColor;\nvarying vec3 fragPosition;\n\nvoid main() {\n  vec4 worldPosition  = model * vec4(position, 1.0);\n  worldPosition       = (worldPosition / worldPosition.w) + vec4(capSize * offset, 0.0);\n  gl_Position         = projection * view * worldPosition;\n  fragColor           = color;\n  fragPosition        = position;\n}"]),a=e(["precision highp float;\n#define GLSLIFY 1\n\nbool outOfRange(float a, float b, float p) {\n  return ((p > max(a, b)) || \n          (p < min(a, b)));\n}\n\nbool outOfRange(vec2 a, vec2 b, vec2 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y));\n}\n\nbool outOfRange(vec3 a, vec3 b, vec3 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y) ||\n          outOfRange(a.z, b.z, p.z));\n}\n\nbool outOfRange(vec4 a, vec4 b, vec4 p) {\n  return outOfRange(a.xyz, b.xyz, p.xyz);\n}\n\nuniform vec3 clipBounds[2];\nuniform float opacity;\nvarying vec3 fragPosition;\nvarying vec4 fragColor;\n\nvoid main() {\n  if (\n    outOfRange(clipBounds[0], clipBounds[1], fragPosition) ||\n    fragColor.a * opacity == 0.\n  ) discard;\n\n  gl_FragColor = opacity * fragColor;\n}"]);m.exports=function(r){return n(r,t,a,null,[{name:"position",type:"vec3"},{name:"color",type:"vec4"},{name:"offset",type:"vec3"}])}},{"gl-shader":132,glslify:231}],86:[function(v,m,x){"use strict";var e=v("gl-texture2d");m.exports=function(b,l,T,_){n||(n=b.FRAMEBUFFER_UNSUPPORTED,t=b.FRAMEBUFFER_INCOMPLETE_ATTACHMENT,a=b.FRAMEBUFFER_INCOMPLETE_DIMENSIONS,r=b.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT);var w=b.getExtension("WEBGL_draw_buffers");if(!d&&w&&function(E,z){var R=E.getParameter(z.MAX_COLOR_ATTACHMENTS_WEBGL);d=new Array(R+1);for(var q=0;q<=R;++q){for(var V=new Array(R),W=0;W<q;++W)V[W]=E.COLOR_ATTACHMENT0+W;for(W=q;W<R;++W)V[W]=E.NONE;d[q]=V}}(b,w),Array.isArray(l)&&(_=T,T=0|l[1],l=0|l[0]),"number"!=typeof l)throw new Error("gl-fbo: Missing shape parameter");var k=b.getParameter(b.MAX_RENDERBUFFER_SIZE);if(l<0||l>k||T<0||T>k)throw new Error("gl-fbo: Parameters are too large for FBO");var L=1;if("color"in(_=_||{})){if((L=Math.max(0|_.color,0))<0)throw new Error("gl-fbo: Must specify a nonnegative number of colors");if(L>1){if(!w)throw new Error("gl-fbo: Multiple draw buffer extension not supported");if(L>b.getParameter(w.MAX_COLOR_ATTACHMENTS_WEBGL))throw new Error("gl-fbo: Context does not support "+L+" draw buffers")}}var M=b.UNSIGNED_BYTE,I=b.getExtension("OES_texture_float");if(_.float&&L>0){if(!I)throw new Error("gl-fbo: Context does not support floating point textures");M=b.FLOAT}else _.preferFloat&&L>0&&I&&(M=b.FLOAT);var P=!0;"depth"in _&&(P=!!_.depth);var S=!1;return"stencil"in _&&(S=!!_.stencil),new h(b,l,T,M,L,P,S,w)};var n,t,a,r,d=null;function s(b){return[b.getParameter(b.FRAMEBUFFER_BINDING),b.getParameter(b.RENDERBUFFER_BINDING),b.getParameter(b.TEXTURE_BINDING_2D)]}function i(b,l){b.bindFramebuffer(b.FRAMEBUFFER,l[0]),b.bindRenderbuffer(b.RENDERBUFFER,l[1]),b.bindTexture(b.TEXTURE_2D,l[2])}function u(b){switch(b){case n:throw new Error("gl-fbo: Framebuffer unsupported");case t:throw new Error("gl-fbo: Framebuffer incomplete attachment");case a:throw new Error("gl-fbo: Framebuffer incomplete dimensions");case r:throw new Error("gl-fbo: Framebuffer incomplete missing attachment");default:throw new Error("gl-fbo: Framebuffer failed for unspecified reason")}}function f(b,l,T,_,w,k){if(!_)return null;var L=e(b,l,T,w,_);return L.magFilter=b.NEAREST,L.minFilter=b.NEAREST,L.mipSamples=1,L.bind(),b.framebufferTexture2D(b.FRAMEBUFFER,k,b.TEXTURE_2D,L.handle,0),L}function c(b,l,T,_,w){var k=b.createRenderbuffer();return b.bindRenderbuffer(b.RENDERBUFFER,k),b.renderbufferStorage(b.RENDERBUFFER,_,l,T),b.framebufferRenderbuffer(b.FRAMEBUFFER,w,b.RENDERBUFFER,k),k}function h(b,l,T,_,w,k,L,M){this.gl=b,this._shape=[0|l,0|T],this._destroyed=!1,this._ext=M,this.color=new Array(w);for(var I=0;I<w;++I)this.color[I]=null;this._color_rb=null,this.depth=null,this._depth_rb=null,this._colorType=_,this._useDepth=k,this._useStencil=L;var P=this,S=[0|l,0|T];Object.defineProperties(S,{0:{get:function(){return P._shape[0]},set:function(E){return P.width=E}},1:{get:function(){return P._shape[1]},set:function(E){return P.height=E}}}),this._shapeVector=S,function(E){var z=s(E.gl),R=E.gl,q=E.handle=R.createFramebuffer(),V=E._shape[0],W=E._shape[1],K=E.color.length,G=E._ext,Y=E._useStencil,$=E._useDepth,B=E._colorType;R.bindFramebuffer(R.FRAMEBUFFER,q);for(var N=0;N<K;++N)E.color[N]=f(R,V,W,B,R.RGBA,R.COLOR_ATTACHMENT0+N);0===K?(E._color_rb=c(R,V,W,R.RGBA4,R.COLOR_ATTACHMENT0),G&&G.drawBuffersWEBGL(d[0])):K>1&&G.drawBuffersWEBGL(d[K]);var U=R.getExtension("WEBGL_depth_texture");U?Y?E.depth=f(R,V,W,U.UNSIGNED_INT_24_8_WEBGL,R.DEPTH_STENCIL,R.DEPTH_STENCIL_ATTACHMENT):$&&(E.depth=f(R,V,W,R.UNSIGNED_SHORT,R.DEPTH_COMPONENT,R.DEPTH_ATTACHMENT)):$&&Y?E._depth_rb=c(R,V,W,R.DEPTH_STENCIL,R.DEPTH_STENCIL_ATTACHMENT):$?E._depth_rb=c(R,V,W,R.DEPTH_COMPONENT16,R.DEPTH_ATTACHMENT):Y&&(E._depth_rb=c(R,V,W,R.STENCIL_INDEX,R.STENCIL_ATTACHMENT));var te=R.checkFramebufferStatus(R.FRAMEBUFFER);if(te!==R.FRAMEBUFFER_COMPLETE){for(E._destroyed=!0,R.bindFramebuffer(R.FRAMEBUFFER,null),R.deleteFramebuffer(E.handle),E.handle=null,E.depth&&(E.depth.dispose(),E.depth=null),E._depth_rb&&(R.deleteRenderbuffer(E._depth_rb),E._depth_rb=null),N=0;N<E.color.length;++N)E.color[N].dispose(),E.color[N]=null;E._color_rb&&(R.deleteRenderbuffer(E._color_rb),E._color_rb=null),i(R,z),u(te)}i(R,z)}(this)}var p=h.prototype;function o(b,l,T){if(b._destroyed)throw new Error("gl-fbo: Can't resize destroyed FBO");if(b._shape[0]!==l||b._shape[1]!==T){var _=b.gl,w=_.getParameter(_.MAX_RENDERBUFFER_SIZE);if(l<0||l>w||T<0||T>w)throw new Error("gl-fbo: Can't resize FBO, invalid dimensions");b._shape[0]=l,b._shape[1]=T;for(var k=s(_),L=0;L<b.color.length;++L)b.color[L].shape=b._shape;b._color_rb&&(_.bindRenderbuffer(_.RENDERBUFFER,b._color_rb),_.renderbufferStorage(_.RENDERBUFFER,_.RGBA4,b._shape[0],b._shape[1])),b.depth&&(b.depth.shape=b._shape),b._depth_rb&&(_.bindRenderbuffer(_.RENDERBUFFER,b._depth_rb),b._useDepth&&b._useStencil?_.renderbufferStorage(_.RENDERBUFFER,_.DEPTH_STENCIL,b._shape[0],b._shape[1]):b._useDepth?_.renderbufferStorage(_.RENDERBUFFER,_.DEPTH_COMPONENT16,b._shape[0],b._shape[1]):b._useStencil&&_.renderbufferStorage(_.RENDERBUFFER,_.STENCIL_INDEX,b._shape[0],b._shape[1])),_.bindFramebuffer(_.FRAMEBUFFER,b.handle);var M=_.checkFramebufferStatus(_.FRAMEBUFFER);M!==_.FRAMEBUFFER_COMPLETE&&(b.dispose(),i(_,k),u(M)),i(_,k)}}Object.defineProperties(p,{shape:{get:function(){return this._destroyed?[0,0]:this._shapeVector},set:function(b){if(Array.isArray(b)||(b=[0|b,0|b]),2!==b.length)throw new Error("gl-fbo: Shape vector must be length 2");var l=0|b[0],T=0|b[1];return o(this,l,T),[l,T]},enumerable:!1},width:{get:function(){return this._destroyed?0:this._shape[0]},set:function(b){return o(this,b|=0,this._shape[1]),b},enumerable:!1},height:{get:function(){return this._destroyed?0:this._shape[1]},set:function(b){return o(this,this._shape[0],b|=0),b},enumerable:!1}}),p.bind=function(){if(!this._destroyed){var b=this.gl;b.bindFramebuffer(b.FRAMEBUFFER,this.handle),b.viewport(0,0,this._shape[0],this._shape[1])}},p.dispose=function(){if(!this._destroyed){this._destroyed=!0;var b=this.gl;b.deleteFramebuffer(this.handle),this.handle=null,this.depth&&(this.depth.dispose(),this.depth=null),this._depth_rb&&(b.deleteRenderbuffer(this._depth_rb),this._depth_rb=null);for(var l=0;l<this.color.length;++l)this.color[l].dispose(),this.color[l]=null;this._color_rb&&(b.deleteRenderbuffer(this._color_rb),this._color_rb=null)}}},{"gl-texture2d":146}],87:[function(v,m,x){var e=v("sprintf-js").sprintf,n=v("gl-constants/lookup"),t=v("glsl-shader-name"),a=v("add-line-numbers");m.exports=function(r,d,s){"use strict";var i=t(d)||"of unknown name (see npm glsl-shader-name)",u="unknown type";void 0!==s&&(u=s===n.FRAGMENT_SHADER?"fragment":"vertex");for(var f=e("Error compiling %s shader %s:\n",u,i),c=e("%s%s",f,r),h=r.split("\n"),p={},o=0;o<h.length;o++){var b=h[o];if(""!==b&&"\0"!==b){var l=parseInt(b.split(":")[2]);if(isNaN(l))throw new Error(e("Could not parse error: %s",b));p[l]=b}}var T=a(d).split("\n");for(o=0;o<T.length;o++)if((p[o+3]||p[o+2]||p[o+1])&&(f+=T[o]+"\n",p[o+1])){var w=p[o+1];w=w.substr(w.split(":",3).join(":").length+1).trim(),f+=e("^^^ %s\n\n",w)}return{long:f.trim(),short:c.trim()}}},{"add-line-numbers":9,"gl-constants/lookup":83,"glsl-shader-name":223,"sprintf-js":301}],88:[function(v,m,x){"use strict";m.exports=function(c,h){var p=c.gl,k=new s(c,a(p,d.vertex,d.fragment),a(p,d.pickVertex,d.pickFragment),r(p),r(p),r(p),r(p));return k.update(h),c.addObject(k),k};var e=v("binary-search-bounds"),n=v("iota-array"),t=v("typedarray-pool"),a=v("gl-shader"),r=v("gl-buffer"),d=v("./lib/shaders");function s(c,h,p,o,b,l,T){this.plot=c,this.shader=h,this.pickShader=p,this.positionBuffer=o,this.weightBuffer=b,this.colorBuffer=l,this.idBuffer=T,this.xData=[],this.yData=[],this.shape=[0,0],this.bounds=[1/0,1/0,-1/0,-1/0],this.pickOffset=0}var i,c,h,u=s.prototype,f=[0,0,1,0,0,1,1,0,1,1,0,1];u.draw=(i=[1,0,0,0,1,0,0,0,1],function(){var c=this.plot,h=this.shader,p=this.bounds,o=this.numVertices;if(!(o<=0)){var b=c.gl,l=c.dataBox,_=p[3]-p[1],w=l[2]-l[0],k=l[3]-l[1];i[0]=2*(p[2]-p[0])/w,i[4]=2*_/k,i[6]=2*(p[0]-l[0])/w-1,i[7]=2*(p[1]-l[1])/k-1,h.bind();var L=h.uniforms;L.viewTransform=i,L.shape=this.shape;var M=h.attributes;this.positionBuffer.bind(),M.position.pointer(),this.weightBuffer.bind(),M.weight.pointer(b.UNSIGNED_BYTE,!1),this.colorBuffer.bind(),M.color.pointer(b.UNSIGNED_BYTE,!0),b.drawArrays(b.TRIANGLES,0,o)}}),u.drawPick=(c=[1,0,0,0,1,0,0,0,1],h=[0,0,0,0],function(p){var o=this.plot,b=this.pickShader,l=this.bounds,T=this.numVertices;if(!(T<=0)){var _=o.gl,w=o.dataBox,L=l[3]-l[1],M=w[2]-w[0],I=w[3]-w[1];c[0]=2*(l[2]-l[0])/M,c[4]=2*L/I,c[6]=2*(l[0]-w[0])/M-1,c[7]=2*(l[1]-w[1])/I-1;for(var P=0;P<4;++P)h[P]=p>>8*P&255;this.pickOffset=p,b.bind();var S=b.uniforms;S.viewTransform=c,S.pickOffset=h,S.shape=this.shape;var E=b.attributes;return this.positionBuffer.bind(),E.position.pointer(),this.weightBuffer.bind(),E.weight.pointer(_.UNSIGNED_BYTE,!1),this.idBuffer.bind(),E.pickId.pointer(_.UNSIGNED_BYTE,!1),_.drawArrays(_.TRIANGLES,0,T),p+this.shape[0]*this.shape[1]}}),u.pick=function(c,h,p){var o=this.pickOffset;if(p<o||p>=o+this.shape[0]*this.shape[1])return null;var l=p-o;return{object:this,pointId:l,dataCoord:[this.xData[l%this.shape[0]],this.yData[l/this.shape[0]|0]]}},u.update=function(c){var h=(c=c||{}).shape||[0,0],p=c.x||n(h[0]),o=c.y||n(h[1]),b=c.z||new Float32Array(h[0]*h[1]),l=!1!==c.zsmooth;this.xData=p,this.yData=o;var T,_,w,k,L=c.colorLevels||[0],M=c.colorValues||[0,0,0,1],I=L.length,P=this.bounds;l?(T=P[0]=p[0],_=P[1]=o[0],w=P[2]=p[p.length-1],k=P[3]=o[o.length-1]):(T=P[0]=p[0]+(p[1]-p[0])/2,_=P[1]=o[0]+(o[1]-o[0])/2,w=P[2]=p[p.length-1]+(p[p.length-1]-p[p.length-2])/2,k=P[3]=o[o.length-1]+(o[o.length-1]-o[o.length-2])/2);var S=1/(w-T),E=1/(k-_),z=h[0],R=h[1];this.shape=[z,R];var q=(l?(z-1)*(R-1):z*R)*(f.length>>>1);this.numVertices=q;for(var V=t.mallocUint8(4*q),W=t.mallocFloat32(2*q),K=t.mallocUint8(2*q),G=t.mallocUint32(q),Y=0,$=l?z-1:z,B=l?R-1:R,N=0;N<B;++N){var U,te;l?(U=E*(o[N]-_),te=E*(o[N+1]-_)):(U=N<R-1?E*(o[N]-(o[N+1]-o[N])/2-_):E*(o[N]-(o[N]-o[N-1])/2-_),te=N<R-1?E*(o[N]+(o[N+1]-o[N])/2-_):E*(o[N]+(o[N]-o[N-1])/2-_));for(var j=0;j<$;++j){var J,X;l?(J=S*(p[j]-T),X=S*(p[j+1]-T)):(J=j<z-1?S*(p[j]-(p[j+1]-p[j])/2-T):S*(p[j]-(p[j]-p[j-1])/2-T),X=j<z-1?S*(p[j]+(p[j+1]-p[j])/2-T):S*(p[j]+(p[j]-p[j-1])/2-T));for(var re=0;re<f.length;re+=2){var ne,le,oe,de,se=f[re],ge=f[re+1],_e=b[l?(N+ge)*z+(j+se):N*z+j],Te=e.le(L,_e);if(Te<0)ne=M[0],le=M[1],oe=M[2],de=M[3];else if(Te===I-1)ne=M[4*I-4],le=M[4*I-3],oe=M[4*I-2],de=M[4*I-1];else{var we=(_e-L[Te])/(L[Te+1]-L[Te]),Oe=1-we,fe=4*Te,ve=4*(Te+1);ne=Oe*M[fe]+we*M[ve],le=Oe*M[fe+1]+we*M[ve+1],oe=Oe*M[fe+2]+we*M[ve+2],de=Oe*M[fe+3]+we*M[ve+3]}V[4*Y]=255*ne,V[4*Y+1]=255*le,V[4*Y+2]=255*oe,V[4*Y+3]=255*de,W[2*Y]=.5*J+.5*X,W[2*Y+1]=.5*U+.5*te,K[2*Y]=se,K[2*Y+1]=ge,G[Y]=N*z+j,Y+=1}}}this.positionBuffer.update(W),this.weightBuffer.update(K),this.colorBuffer.update(V),this.idBuffer.update(G),t.free(W),t.free(V),t.free(K),t.free(G)},u.dispose=function(){this.shader.dispose(),this.pickShader.dispose(),this.positionBuffer.dispose(),this.weightBuffer.dispose(),this.colorBuffer.dispose(),this.idBuffer.dispose(),this.plot.removeObject(this)}},{"./lib/shaders":89,"binary-search-bounds":31,"gl-buffer":78,"gl-shader":132,"iota-array":235,"typedarray-pool":308}],89:[function(v,m,x){"use strict";var e=v("glslify");m.exports={fragment:e(["precision lowp float;\n#define GLSLIFY 1\nvarying vec4 fragColor;\nvoid main() {\n  gl_FragColor = vec4(fragColor.rgb * fragColor.a, fragColor.a);\n}\n"]),vertex:e(["precision mediump float;\n#define GLSLIFY 1\n\nattribute vec2 position;\nattribute vec4 color;\nattribute vec2 weight;\n\nuniform vec2 shape;\nuniform mat3 viewTransform;\n\nvarying vec4 fragColor;\n\nvoid main() {\n  vec3 vPosition = viewTransform * vec3( position + (weight-.5)/(shape-1.) , 1.0);\n  fragColor = color;\n  gl_Position = vec4(vPosition.xy, 0, vPosition.z);\n}\n"]),pickFragment:e(["precision mediump float;\n#define GLSLIFY 1\n\nvarying vec4 fragId;\nvarying vec2 vWeight;\n\nuniform vec2 shape;\nuniform vec4 pickOffset;\n\nvoid main() {\n  vec2 d = step(.5, vWeight);\n  vec4 id = fragId + pickOffset;\n  id.x += d.x + d.y*shape.x;\n\n  id.y += floor(id.x / 256.0);\n  id.x -= floor(id.x / 256.0) * 256.0;\n\n  id.z += floor(id.y / 256.0);\n  id.y -= floor(id.y / 256.0) * 256.0;\n\n  id.w += floor(id.z / 256.0);\n  id.z -= floor(id.z / 256.0) * 256.0;\n\n  gl_FragColor = id/255.;\n}\n"]),pickVertex:e(["precision mediump float;\n#define GLSLIFY 1\n\nattribute vec2 position;\nattribute vec4 pickId;\nattribute vec2 weight;\n\nuniform vec2 shape;\nuniform mat3 viewTransform;\n\nvarying vec4 fragId;\nvarying vec2 vWeight;\n\nvoid main() {\n  vWeight = weight;\n\n  fragId = pickId;\n\n  vec3 vPosition = viewTransform * vec3( position + (weight-.5)/(shape-1.) , 1.0);\n  gl_Position = vec4(vPosition.xy, 0, vPosition.z);\n}\n"])}},{glslify:231}],90:[function(v,m,x){var e=v("glslify"),n=v("gl-shader"),t=e(["precision highp float;\n#define GLSLIFY 1\n\nattribute vec3 position, nextPosition;\nattribute float arcLength, lineWidth;\nattribute vec4 color;\n\nuniform vec2 screenShape;\nuniform float pixelRatio;\nuniform mat4 model, view, projection;\n\nvarying vec4 fragColor;\nvarying vec3 worldPosition;\nvarying float pixelArcLength;\n\nvec4 project(vec3 p) {\n  return projection * view * model * vec4(p, 1.0);\n}\n\nvoid main() {\n  vec4 startPoint = project(position);\n  vec4 endPoint   = project(nextPosition);\n\n  vec2 A = startPoint.xy / startPoint.w;\n  vec2 B =   endPoint.xy /   endPoint.w;\n\n  float clipAngle = atan(\n    (B.y - A.y) * screenShape.y,\n    (B.x - A.x) * screenShape.x\n  );\n\n  vec2 offset = 0.5 * pixelRatio * lineWidth * vec2(\n    sin(clipAngle),\n    -cos(clipAngle)\n  ) / screenShape;\n\n  gl_Position = vec4(startPoint.xy + startPoint.w * offset, startPoint.zw);\n\n  worldPosition = position;\n  pixelArcLength = arcLength;\n  fragColor = color;\n}\n"]),a=e(["precision highp float;\n#define GLSLIFY 1\n\nbool outOfRange(float a, float b, float p) {\n  return ((p > max(a, b)) || \n          (p < min(a, b)));\n}\n\nbool outOfRange(vec2 a, vec2 b, vec2 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y));\n}\n\nbool outOfRange(vec3 a, vec3 b, vec3 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y) ||\n          outOfRange(a.z, b.z, p.z));\n}\n\nbool outOfRange(vec4 a, vec4 b, vec4 p) {\n  return outOfRange(a.xyz, b.xyz, p.xyz);\n}\n\nuniform vec3      clipBounds[2];\nuniform sampler2D dashTexture;\nuniform float     dashScale;\nuniform float     opacity;\n\nvarying vec3    worldPosition;\nvarying float   pixelArcLength;\nvarying vec4    fragColor;\n\nvoid main() {\n  if (\n    outOfRange(clipBounds[0], clipBounds[1], worldPosition) ||\n    fragColor.a * opacity == 0.\n  ) discard;\n\n  float dashWeight = texture2D(dashTexture, vec2(dashScale * pixelArcLength, 0)).r;\n  if(dashWeight < 0.5) {\n    discard;\n  }\n  gl_FragColor = fragColor * opacity;\n}\n"]),r=e(["precision highp float;\n#define GLSLIFY 1\n\n#define FLOAT_MAX  1.70141184e38\n#define FLOAT_MIN  1.17549435e-38\n\n// https://github.com/mikolalysenko/glsl-read-float/blob/master/index.glsl\nvec4 packFloat(float v) {\n  float av = abs(v);\n\n  //Handle special cases\n  if(av < FLOAT_MIN) {\n    return vec4(0.0, 0.0, 0.0, 0.0);\n  } else if(v > FLOAT_MAX) {\n    return vec4(127.0, 128.0, 0.0, 0.0) / 255.0;\n  } else if(v < -FLOAT_MAX) {\n    return vec4(255.0, 128.0, 0.0, 0.0) / 255.0;\n  }\n\n  vec4 c = vec4(0,0,0,0);\n\n  //Compute exponent and mantissa\n  float e = floor(log2(av));\n  float m = av * pow(2.0, -e) - 1.0;\n\n  //Unpack mantissa\n  c[1] = floor(128.0 * m);\n  m -= c[1] / 128.0;\n  c[2] = floor(32768.0 * m);\n  m -= c[2] / 32768.0;\n  c[3] = floor(8388608.0 * m);\n\n  //Unpack exponent\n  float ebias = e + 127.0;\n  c[0] = floor(ebias / 2.0);\n  ebias -= c[0] * 2.0;\n  c[1] += floor(ebias) * 128.0;\n\n  //Unpack sign bit\n  c[0] += 128.0 * step(0.0, -v);\n\n  //Scale back to range\n  return c / 255.0;\n}\n\nbool outOfRange(float a, float b, float p) {\n  return ((p > max(a, b)) || \n          (p < min(a, b)));\n}\n\nbool outOfRange(vec2 a, vec2 b, vec2 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y));\n}\n\nbool outOfRange(vec3 a, vec3 b, vec3 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y) ||\n          outOfRange(a.z, b.z, p.z));\n}\n\nbool outOfRange(vec4 a, vec4 b, vec4 p) {\n  return outOfRange(a.xyz, b.xyz, p.xyz);\n}\n\nuniform float pickId;\nuniform vec3 clipBounds[2];\n\nvarying vec3 worldPosition;\nvarying float pixelArcLength;\nvarying vec4 fragColor;\n\nvoid main() {\n  if (outOfRange(clipBounds[0], clipBounds[1], worldPosition)) discard;\n\n  gl_FragColor = vec4(pickId/255.0, packFloat(pixelArcLength).xyz);\n}"]),d=[{name:"position",type:"vec3"},{name:"nextPosition",type:"vec3"},{name:"arcLength",type:"float"},{name:"lineWidth",type:"float"},{name:"color",type:"vec4"}];x.createShader=function(s){return n(s,t,a,null,d)},x.createPickShader=function(s){return n(s,t,r,null,d)}},{"gl-shader":132,glslify:231}],91:[function(v,m,x){"use strict";m.exports=function(T){var _=T.gl||T.scene&&T.scene.gl,w=u(_);w.attributes.position.location=0,w.attributes.nextPosition.location=1,w.attributes.arcLength.location=2,w.attributes.lineWidth.location=3,w.attributes.color.location=4;var k=f(_);k.attributes.position.location=0,k.attributes.nextPosition.location=1,k.attributes.arcLength.location=2,k.attributes.lineWidth.location=3,k.attributes.color.location=4;for(var L=e(_),M=n(_,[{buffer:L,size:3,offset:0,stride:48},{buffer:L,size:3,offset:12,stride:48},{buffer:L,size:1,offset:24,stride:48},{buffer:L,size:1,offset:28,stride:48},{buffer:L,size:4,offset:32,stride:48}]),I=s(new Array(1024),[256,1,4]),P=0;P<1024;++P)I.data[P]=255;var S=t(_,I);S.wrap=_.REPEAT;var E=new b(_,w,k,L,M,S);return E.update(T),E};var e=v("gl-buffer"),n=v("gl-vao"),t=v("gl-texture2d"),a=new Uint8Array(4),r=new Float32Array(a.buffer),d=v("binary-search-bounds"),s=v("ndarray"),i=v("./lib/shaders"),u=i.createShader,f=i.createPickShader,c=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];function h(T,_){for(var w=0,k=0;k<3;++k){var L=T[k]-_[k];w+=L*L}return Math.sqrt(w)}function p(T){for(var _=[[-1e6,-1e6,-1e6],[1e6,1e6,1e6]],w=0;w<3;++w)_[0][w]=Math.max(T[0][w],_[0][w]),_[1][w]=Math.min(T[1][w],_[1][w]);return _}function o(T,_,w,k){this.arcLength=T,this.position=_,this.index=w,this.dataCoordinate=k}function b(T,_,w,k,L,M){this.gl=T,this.shader=_,this.pickShader=w,this.buffer=k,this.vao=L,this.clipBounds=[[-1/0,-1/0,-1/0],[1/0,1/0,1/0]],this.points=[],this.arcLength=[],this.vertexCount=0,this.bounds=[[0,0,0],[0,0,0]],this.pickId=0,this.lineWidth=1,this.texture=M,this.dashScale=1,this.opacity=1,this.hasAlpha=!1,this.dirty=!0,this.pixelRatio=1}var l=b.prototype;l.isTransparent=function(){return this.hasAlpha},l.isOpaque=function(){return!this.hasAlpha},l.pickSlots=1,l.setPickBase=function(T){this.pickId=T},l.drawTransparent=l.draw=function(T){if(this.vertexCount){var _=this.gl,w=this.shader,k=this.vao;w.bind(),w.uniforms={model:T.model||c,view:T.view||c,projection:T.projection||c,clipBounds:p(this.clipBounds),dashTexture:this.texture.bind(),dashScale:this.dashScale/this.arcLength[this.arcLength.length-1],opacity:this.opacity,screenShape:[_.drawingBufferWidth,_.drawingBufferHeight],pixelRatio:this.pixelRatio},k.bind(),k.draw(_.TRIANGLE_STRIP,this.vertexCount),k.unbind()}},l.drawPick=function(T){if(this.vertexCount){var _=this.gl,w=this.pickShader,k=this.vao;w.bind(),w.uniforms={model:T.model||c,view:T.view||c,projection:T.projection||c,pickId:this.pickId,clipBounds:p(this.clipBounds),screenShape:[_.drawingBufferWidth,_.drawingBufferHeight],pixelRatio:this.pixelRatio},k.bind(),k.draw(_.TRIANGLE_STRIP,this.vertexCount),k.unbind()}},l.update=function(T){var _,w;this.dirty=!0;var k=!!T.connectGaps;"dashScale"in T&&(this.dashScale=T.dashScale),this.hasAlpha=!1,"opacity"in T&&(this.opacity=+T.opacity,this.opacity<1&&(this.hasAlpha=!0));var L=[],M=[],I=[],P=0,S=0,E=[[1/0,1/0,1/0],[-1/0,-1/0,-1/0]],z=T.position||T.positions;if(z){var R=T.color||T.colors||[0,0,0,1],q=T.lineWidth||1,V=!1;e:for(_=1;_<z.length;++_){var W,K,G,Y=z[_-1],$=z[_];for(M.push(P),I.push(Y.slice()),w=0;w<3;++w){if(isNaN(Y[w])||isNaN($[w])||!isFinite(Y[w])||!isFinite($[w])){if(!k&&L.length>0){for(var B=0;B<24;++B)L.push(L[L.length-12]);S+=2,V=!0}continue e}E[0][w]=Math.min(E[0][w],Y[w],$[w]),E[1][w]=Math.max(E[1][w],Y[w],$[w])}Array.isArray(R[0])?(W=R.length>_-1?R[_-1]:R.length>0?R[R.length-1]:[0,0,0,1],K=R.length>_?R[_]:R.length>0?R[R.length-1]:[0,0,0,1]):W=K=R,3===W.length&&(W=[W[0],W[1],W[2],1]),3===K.length&&(K=[K[0],K[1],K[2],1]),!this.hasAlpha&&W[3]<1&&(this.hasAlpha=!0),G=Array.isArray(q)?q.length>_-1?q[_-1]:q.length>0?q[q.length-1]:[0,0,0,1]:q;var N=P;if(P+=h(Y,$),V){for(w=0;w<2;++w)L.push(Y[0],Y[1],Y[2],$[0],$[1],$[2],N,G,W[0],W[1],W[2],W[3]);S+=2,V=!1}L.push(Y[0],Y[1],Y[2],$[0],$[1],$[2],N,G,W[0],W[1],W[2],W[3],Y[0],Y[1],Y[2],$[0],$[1],$[2],N,-G,W[0],W[1],W[2],W[3],$[0],$[1],$[2],Y[0],Y[1],Y[2],P,-G,K[0],K[1],K[2],K[3],$[0],$[1],$[2],Y[0],Y[1],Y[2],P,G,K[0],K[1],K[2],K[3]),S+=4}}if(this.buffer.update(L),M.push(P),I.push(z[z.length-1].slice()),this.bounds=E,this.vertexCount=S,this.points=I,this.arcLength=M,"dashes"in T){var U=T.dashes.slice();for(U.unshift(0),_=1;_<U.length;++_)U[_]=U[_-1]+U[_];var te=s(new Array(1024),[256,1,4]);for(_=0;_<256;++_){for(w=0;w<4;++w)te.set(_,0,w,0);1&d.le(U,U[U.length-1]*_/255)?te.set(_,0,0,0):te.set(_,0,0,255)}this.texture.setPixels(te)}},l.dispose=function(){this.shader.dispose(),this.vao.dispose(),this.buffer.dispose()},l.pick=function(T){if(!T||T.id!==this.pickId)return null;var z,R,q,_=(z=T.value[0],R=T.value[1],q=T.value[2],a[0]=0,a[1]=q,a[2]=R,a[3]=z,r[0]),w=d.le(this.arcLength,_);if(w<0)return null;if(w===this.arcLength.length-1)return new o(this.arcLength[this.arcLength.length-1],this.points[this.points.length-1].slice(),w);for(var k=this.points[w],L=this.points[Math.min(w+1,this.points.length-1)],M=(_-this.arcLength[w])/(this.arcLength[w+1]-this.arcLength[w]),I=1-M,P=[0,0,0],S=0;S<3;++S)P[S]=I*k[S]+M*L[S];var E=Math.min(M<.5?w:w+1,this.points.length-1);return new o(_,P,E,this.points[E])}},{"./lib/shaders":90,"binary-search-bounds":31,"gl-buffer":78,"gl-texture2d":146,"gl-vao":150,ndarray:259}],92:[function(v,m,x){m.exports=function(e){var n=new Float32Array(16);return n[0]=e[0],n[1]=e[1],n[2]=e[2],n[3]=e[3],n[4]=e[4],n[5]=e[5],n[6]=e[6],n[7]=e[7],n[8]=e[8],n[9]=e[9],n[10]=e[10],n[11]=e[11],n[12]=e[12],n[13]=e[13],n[14]=e[14],n[15]=e[15],n}},{}],93:[function(v,m,x){m.exports=function(){var e=new Float32Array(16);return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}},{}],94:[function(v,m,x){m.exports=function(e){var n=e[0],t=e[1],a=e[2],r=e[3],d=e[4],s=e[5],i=e[6],u=e[7],f=e[8],c=e[9],h=e[10],p=e[11],o=e[12],b=e[13],l=e[14],T=e[15];return(n*s-t*d)*(h*T-p*l)-(n*i-a*d)*(c*T-p*b)+(n*u-r*d)*(c*l-h*b)+(t*i-a*s)*(f*T-p*o)-(t*u-r*s)*(f*l-h*o)+(a*u-r*i)*(f*b-c*o)}},{}],95:[function(v,m,x){m.exports=function(e,n){var t=n[0],a=n[1],r=n[2],d=n[3],s=t+t,i=a+a,u=r+r,f=t*s,c=a*s,h=a*i,p=r*s,o=r*i,b=r*u,l=d*s,T=d*i,_=d*u;return e[0]=1-h-b,e[1]=c+_,e[2]=p-T,e[3]=0,e[4]=c-_,e[5]=1-f-b,e[6]=o+l,e[7]=0,e[8]=p+T,e[9]=o-l,e[10]=1-f-h,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}},{}],96:[function(v,m,x){m.exports=function(e,n,t){var a=n[0],r=n[1],d=n[2],s=n[3],i=a+a,u=r+r,f=d+d,c=a*i,h=a*u,p=a*f,o=r*u,b=r*f,l=d*f,T=s*i,_=s*u,w=s*f;return e[0]=1-(o+l),e[1]=h+w,e[2]=p-_,e[3]=0,e[4]=h-w,e[5]=1-(c+l),e[6]=b+T,e[7]=0,e[8]=p+_,e[9]=b-T,e[10]=1-(c+o),e[11]=0,e[12]=t[0],e[13]=t[1],e[14]=t[2],e[15]=1,e}},{}],97:[function(v,m,x){m.exports=function(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}},{}],98:[function(v,m,x){m.exports=function(e,n){var t=n[0],a=n[1],r=n[2],d=n[3],s=n[4],i=n[5],u=n[6],f=n[7],c=n[8],h=n[9],p=n[10],o=n[11],b=n[12],l=n[13],T=n[14],_=n[15],w=t*i-a*s,k=t*u-r*s,L=t*f-d*s,M=a*u-r*i,I=a*f-d*i,P=r*f-d*u,S=c*l-h*b,E=c*T-p*b,z=c*_-o*b,R=h*T-p*l,q=h*_-o*l,V=p*_-o*T,W=w*V-k*q+L*R+M*z-I*E+P*S;return W?(e[0]=(i*V-u*q+f*R)*(W=1/W),e[1]=(r*q-a*V-d*R)*W,e[2]=(l*P-T*I+_*M)*W,e[3]=(p*I-h*P-o*M)*W,e[4]=(u*z-s*V-f*E)*W,e[5]=(t*V-r*z+d*E)*W,e[6]=(T*L-b*P-_*k)*W,e[7]=(c*P-p*L+o*k)*W,e[8]=(s*q-i*z+f*S)*W,e[9]=(a*z-t*q-d*S)*W,e[10]=(b*I-l*L+_*w)*W,e[11]=(h*L-c*I-o*w)*W,e[12]=(i*E-s*R-u*S)*W,e[13]=(t*R-a*E+r*S)*W,e[14]=(l*k-b*M-T*w)*W,e[15]=(c*M-h*k+p*w)*W,e):null}},{}],99:[function(v,m,x){var e=v("./identity");m.exports=function(n,t,a,r){var d,s,i,u,f,c,h,p,o,b,l=t[0],T=t[1],_=t[2],w=r[0],k=r[1],L=r[2],M=a[0],I=a[1],P=a[2];return Math.abs(l-M)<1e-6&&Math.abs(T-I)<1e-6&&Math.abs(_-P)<1e-6?e(n):(h=l-M,p=T-I,o=_-P,d=k*(o*=b=1/Math.sqrt(h*h+p*p+o*o))-L*(p*=b),s=L*(h*=b)-w*o,i=w*p-k*h,(b=Math.sqrt(d*d+s*s+i*i))?(d*=b=1/b,s*=b,i*=b):(d=0,s=0,i=0),u=p*i-o*s,f=o*d-h*i,c=h*s-p*d,(b=Math.sqrt(u*u+f*f+c*c))?(u*=b=1/b,f*=b,c*=b):(u=0,f=0,c=0),n[0]=d,n[1]=u,n[2]=h,n[3]=0,n[4]=s,n[5]=f,n[6]=p,n[7]=0,n[8]=i,n[9]=c,n[10]=o,n[11]=0,n[12]=-(d*l+s*T+i*_),n[13]=-(u*l+f*T+c*_),n[14]=-(h*l+p*T+o*_),n[15]=1,n)}},{"./identity":97}],100:[function(v,m,x){m.exports=function(e,n,t){var a=n[0],r=n[1],d=n[2],s=n[3],i=n[4],u=n[5],f=n[6],c=n[7],h=n[8],p=n[9],o=n[10],b=n[11],l=n[12],T=n[13],_=n[14],w=n[15],k=t[0],L=t[1],M=t[2],I=t[3];return e[0]=k*a+L*i+M*h+I*l,e[1]=k*r+L*u+M*p+I*T,e[2]=k*d+L*f+M*o+I*_,e[3]=k*s+L*c+M*b+I*w,e[4]=(k=t[4])*a+(L=t[5])*i+(M=t[6])*h+(I=t[7])*l,e[5]=k*r+L*u+M*p+I*T,e[6]=k*d+L*f+M*o+I*_,e[7]=k*s+L*c+M*b+I*w,e[8]=(k=t[8])*a+(L=t[9])*i+(M=t[10])*h+(I=t[11])*l,e[9]=k*r+L*u+M*p+I*T,e[10]=k*d+L*f+M*o+I*_,e[11]=k*s+L*c+M*b+I*w,e[12]=(k=t[12])*a+(L=t[13])*i+(M=t[14])*h+(I=t[15])*l,e[13]=k*r+L*u+M*p+I*T,e[14]=k*d+L*f+M*o+I*_,e[15]=k*s+L*c+M*b+I*w,e}},{}],101:[function(v,m,x){m.exports=function(e,n,t,a,r,d,s){var i=1/(n-t),u=1/(a-r),f=1/(d-s);return e[0]=-2*i,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=-2*u,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=2*f,e[11]=0,e[12]=(n+t)*i,e[13]=(r+a)*u,e[14]=(s+d)*f,e[15]=1,e}},{}],102:[function(v,m,x){m.exports=function(e,n,t,a,r){var d=1/Math.tan(n/2),s=1/(a-r);return e[0]=d/t,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=d,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=(r+a)*s,e[11]=-1,e[12]=0,e[13]=0,e[14]=2*r*a*s,e[15]=0,e}},{}],103:[function(v,m,x){m.exports=function(e,n,t,a){var r,d,s,i,u,f,c,h,p,o,b,l,T,_,w,k,L,M,I,P,S,E,z,R,q=a[0],V=a[1],W=a[2],K=Math.sqrt(q*q+V*V+W*W);return Math.abs(K)<1e-6?null:(q*=K=1/K,V*=K,W*=K,r=Math.sin(t),d=Math.cos(t),u=n[1],f=n[2],c=n[3],p=n[5],o=n[6],b=n[7],T=n[9],_=n[10],w=n[11],I=q*V*(s=1-d)-W*r,P=V*V*s+d,S=W*V*s+q*r,E=q*W*s+V*r,z=V*W*s-q*r,R=W*W*s+d,e[0]=(i=n[0])*(k=q*q*s+d)+(h=n[4])*(L=V*q*s+W*r)+(l=n[8])*(M=W*q*s-V*r),e[1]=u*k+p*L+T*M,e[2]=f*k+o*L+_*M,e[3]=c*k+b*L+w*M,e[4]=i*I+h*P+l*S,e[5]=u*I+p*P+T*S,e[6]=f*I+o*P+_*S,e[7]=c*I+b*P+w*S,e[8]=i*E+h*z+l*R,e[9]=u*E+p*z+T*R,e[10]=f*E+o*z+_*R,e[11]=c*E+b*z+w*R,n!==e&&(e[12]=n[12],e[13]=n[13],e[14]=n[14],e[15]=n[15]),e)}},{}],104:[function(v,m,x){m.exports=function(e,n,t){var a=Math.sin(t),r=Math.cos(t),d=n[4],s=n[5],i=n[6],u=n[7],f=n[8],c=n[9],h=n[10],p=n[11];return n!==e&&(e[0]=n[0],e[1]=n[1],e[2]=n[2],e[3]=n[3],e[12]=n[12],e[13]=n[13],e[14]=n[14],e[15]=n[15]),e[4]=d*r+f*a,e[5]=s*r+c*a,e[6]=i*r+h*a,e[7]=u*r+p*a,e[8]=f*r-d*a,e[9]=c*r-s*a,e[10]=h*r-i*a,e[11]=p*r-u*a,e}},{}],105:[function(v,m,x){m.exports=function(e,n,t){var a=Math.sin(t),r=Math.cos(t),d=n[0],s=n[1],i=n[2],u=n[3],f=n[8],c=n[9],h=n[10],p=n[11];return n!==e&&(e[4]=n[4],e[5]=n[5],e[6]=n[6],e[7]=n[7],e[12]=n[12],e[13]=n[13],e[14]=n[14],e[15]=n[15]),e[0]=d*r-f*a,e[1]=s*r-c*a,e[2]=i*r-h*a,e[3]=u*r-p*a,e[8]=d*a+f*r,e[9]=s*a+c*r,e[10]=i*a+h*r,e[11]=u*a+p*r,e}},{}],106:[function(v,m,x){m.exports=function(e,n,t){var a=Math.sin(t),r=Math.cos(t),d=n[0],s=n[1],i=n[2],u=n[3],f=n[4],c=n[5],h=n[6],p=n[7];return n!==e&&(e[8]=n[8],e[9]=n[9],e[10]=n[10],e[11]=n[11],e[12]=n[12],e[13]=n[13],e[14]=n[14],e[15]=n[15]),e[0]=d*r+f*a,e[1]=s*r+c*a,e[2]=i*r+h*a,e[3]=u*r+p*a,e[4]=f*r-d*a,e[5]=c*r-s*a,e[6]=h*r-i*a,e[7]=p*r-u*a,e}},{}],107:[function(v,m,x){m.exports=function(e,n,t){var a=t[0],r=t[1],d=t[2];return e[0]=n[0]*a,e[1]=n[1]*a,e[2]=n[2]*a,e[3]=n[3]*a,e[4]=n[4]*r,e[5]=n[5]*r,e[6]=n[6]*r,e[7]=n[7]*r,e[8]=n[8]*d,e[9]=n[9]*d,e[10]=n[10]*d,e[11]=n[11]*d,e[12]=n[12],e[13]=n[13],e[14]=n[14],e[15]=n[15],e}},{}],108:[function(v,m,x){m.exports=function(e,n,t){var a,r,d,s,i,u,f,c,h,p,o,b,l=t[0],T=t[1],_=t[2];return n===e?(e[12]=n[0]*l+n[4]*T+n[8]*_+n[12],e[13]=n[1]*l+n[5]*T+n[9]*_+n[13],e[14]=n[2]*l+n[6]*T+n[10]*_+n[14],e[15]=n[3]*l+n[7]*T+n[11]*_+n[15]):(r=n[1],d=n[2],s=n[3],i=n[4],u=n[5],f=n[6],c=n[7],h=n[8],p=n[9],o=n[10],b=n[11],e[0]=a=n[0],e[1]=r,e[2]=d,e[3]=s,e[4]=i,e[5]=u,e[6]=f,e[7]=c,e[8]=h,e[9]=p,e[10]=o,e[11]=b,e[12]=a*l+i*T+h*_+n[12],e[13]=r*l+u*T+p*_+n[13],e[14]=d*l+f*T+o*_+n[14],e[15]=s*l+c*T+b*_+n[15]),e}},{}],109:[function(v,m,x){m.exports=function(e,n){if(e===n){var t=n[1],a=n[2],r=n[3],d=n[6],s=n[7],i=n[11];e[1]=n[4],e[2]=n[8],e[3]=n[12],e[4]=t,e[6]=n[9],e[7]=n[13],e[8]=a,e[9]=d,e[11]=n[14],e[12]=r,e[13]=s,e[14]=i}else e[0]=n[0],e[1]=n[4],e[2]=n[8],e[3]=n[12],e[4]=n[1],e[5]=n[5],e[6]=n[9],e[7]=n[13],e[8]=n[2],e[9]=n[6],e[10]=n[10],e[11]=n[14],e[12]=n[3],e[13]=n[7],e[14]=n[11],e[15]=n[15];return e}},{}],110:[function(v,m,x){"use strict";var e=v("barycentric"),n=v("polytope-closest-point/lib/closest_point_2d.js");function t(d,s){for(var i=[0,0,0,0],u=0;u<4;++u)for(var f=0;f<4;++f)i[f]+=d[4*u+f]*s[u];return i}function a(d,s,i,u,f){for(var c=t(u,t(i,t(s,[d[0],d[1],d[2],1]))),h=0;h<3;++h)c[h]/=c[3];return[.5*f[0]*(1+c[0]),.5*f[1]*(1-c[1])]}function r(d,s){for(var i=[0,0,0],u=0;u<d.length;++u)for(var f=d[u],c=s[u],h=0;h<3;++h)i[h]+=c*f[h];return i}m.exports=function(d,s,i,u,f,c){if(1===d.length)return[0,d[0].slice()];for(var h=new Array(d.length),p=0;p<d.length;++p)h[p]=a(d[p],i,u,f,c);var o=0,b=1/0;for(p=0;p<h.length;++p){for(var l=0,T=0;T<2;++T)l+=Math.pow(h[p][T]-s[T],2);l<b&&(b=l,o=p)}var _=function(k,L){if(2===k.length){for(var M=0,I=0,P=0;P<2;++P)M+=Math.pow(L[P]-k[0][P],2),I+=Math.pow(L[P]-k[1][P],2);return(M=Math.sqrt(M))+(I=Math.sqrt(I))<1e-6?[1,0]:[I/(M+I),M/(I+M)]}if(3===k.length){var S=[0,0];return n(k[0],k[1],k[2],L,S),e(k,S)}return[]}(h,s),w=0;for(p=0;p<3;++p){if(_[p]<-.001||_[p]>1.0001)return null;w+=_[p]}return Math.abs(w-1)>.001?null:[o,r(d,_),_]}},{barycentric:14,"polytope-closest-point/lib/closest_point_2d.js":270}],111:[function(v,m,x){var e=v("glslify"),n=e(["precision highp float;\n#define GLSLIFY 1\n\nattribute vec3 position, normal;\nattribute vec4 color;\nattribute vec2 uv;\n\nuniform mat4 model\n           , view\n           , projection\n           , inverseModel;\nuniform vec3 eyePosition\n           , lightPosition;\n\nvarying vec3 f_normal\n           , f_lightDirection\n           , f_eyeDirection\n           , f_data;\nvarying vec4 f_color;\nvarying vec2 f_uv;\n\nvec4 project(vec3 p) {\n  return projection * view * model * vec4(p, 1.0);\n}\n\nvoid main() {\n  gl_Position      = project(position);\n\n  //Lighting geometry parameters\n  vec4 cameraCoordinate = view * vec4(position , 1.0);\n  cameraCoordinate.xyz /= cameraCoordinate.w;\n  f_lightDirection = lightPosition - cameraCoordinate.xyz;\n  f_eyeDirection   = eyePosition - cameraCoordinate.xyz;\n  f_normal  = normalize((vec4(normal, 0.0) * inverseModel).xyz);\n\n  f_color          = color;\n  f_data           = position;\n  f_uv             = uv;\n}\n"]),t=e(["#extension GL_OES_standard_derivatives : enable\n\nprecision highp float;\n#define GLSLIFY 1\n\nfloat beckmannDistribution(float x, float roughness) {\n  float NdotH = max(x, 0.0001);\n  float cos2Alpha = NdotH * NdotH;\n  float tan2Alpha = (cos2Alpha - 1.0) / cos2Alpha;\n  float roughness2 = roughness * roughness;\n  float denom = 3.141592653589793 * roughness2 * cos2Alpha * cos2Alpha;\n  return exp(tan2Alpha / roughness2) / denom;\n}\n\nfloat cookTorranceSpecular(\n  vec3 lightDirection,\n  vec3 viewDirection,\n  vec3 surfaceNormal,\n  float roughness,\n  float fresnel) {\n\n  float VdotN = max(dot(viewDirection, surfaceNormal), 0.0);\n  float LdotN = max(dot(lightDirection, surfaceNormal), 0.0);\n\n  //Half angle vector\n  vec3 H = normalize(lightDirection + viewDirection);\n\n  //Geometric term\n  float NdotH = max(dot(surfaceNormal, H), 0.0);\n  float VdotH = max(dot(viewDirection, H), 0.000001);\n  float LdotH = max(dot(lightDirection, H), 0.000001);\n  float G1 = (2.0 * NdotH * VdotN) / VdotH;\n  float G2 = (2.0 * NdotH * LdotN) / LdotH;\n  float G = min(1.0, min(G1, G2));\n  \n  //Distribution term\n  float D = beckmannDistribution(NdotH, roughness);\n\n  //Fresnel term\n  float F = pow(1.0 - VdotN, fresnel);\n\n  //Multiply terms and done\n  return  G * F * D / max(3.14159265 * VdotN, 0.000001);\n}\n\n//#pragma glslify: beckmann = require(glsl-specular-beckmann) // used in gl-surface3d\n\nbool outOfRange(float a, float b, float p) {\n  return ((p > max(a, b)) || \n          (p < min(a, b)));\n}\n\nbool outOfRange(vec2 a, vec2 b, vec2 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y));\n}\n\nbool outOfRange(vec3 a, vec3 b, vec3 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y) ||\n          outOfRange(a.z, b.z, p.z));\n}\n\nbool outOfRange(vec4 a, vec4 b, vec4 p) {\n  return outOfRange(a.xyz, b.xyz, p.xyz);\n}\n\nuniform vec3 clipBounds[2];\nuniform float roughness\n            , fresnel\n            , kambient\n            , kdiffuse\n            , kspecular;\nuniform sampler2D texture;\n\nvarying vec3 f_normal\n           , f_lightDirection\n           , f_eyeDirection\n           , f_data;\nvarying vec4 f_color;\nvarying vec2 f_uv;\n\nvoid main() {\n  if (f_color.a == 0.0 ||\n    outOfRange(clipBounds[0], clipBounds[1], f_data)\n  ) discard;\n\n  vec3 N = normalize(f_normal);\n  vec3 L = normalize(f_lightDirection);\n  vec3 V = normalize(f_eyeDirection);\n\n  if(gl_FrontFacing) {\n    N = -N;\n  }\n\n  float specular = min(1.0, max(0.0, cookTorranceSpecular(L, V, N, roughness, fresnel)));\n  //float specular = max(0.0, beckmann(L, V, N, roughness)); // used in gl-surface3d\n\n  float diffuse  = min(kambient + kdiffuse * max(dot(N, L), 0.0), 1.0);\n\n  vec4 surfaceColor = vec4(f_color.rgb, 1.0) * texture2D(texture, f_uv);\n  vec4 litColor = surfaceColor.a * vec4(diffuse * surfaceColor.rgb + kspecular * vec3(1,1,1) * specular,  1.0);\n\n  gl_FragColor = litColor * f_color.a;\n}\n"]),a=e(["precision highp float;\n#define GLSLIFY 1\n\nattribute vec3 position;\nattribute vec4 color;\nattribute vec2 uv;\n\nuniform mat4 model, view, projection;\n\nvarying vec4 f_color;\nvarying vec3 f_data;\nvarying vec2 f_uv;\n\nvoid main() {\n  gl_Position = projection * view * model * vec4(position, 1.0);\n  f_color = color;\n  f_data  = position;\n  f_uv    = uv;\n}"]),r=e(["precision highp float;\n#define GLSLIFY 1\n\nbool outOfRange(float a, float b, float p) {\n  return ((p > max(a, b)) || \n          (p < min(a, b)));\n}\n\nbool outOfRange(vec2 a, vec2 b, vec2 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y));\n}\n\nbool outOfRange(vec3 a, vec3 b, vec3 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y) ||\n          outOfRange(a.z, b.z, p.z));\n}\n\nbool outOfRange(vec4 a, vec4 b, vec4 p) {\n  return outOfRange(a.xyz, b.xyz, p.xyz);\n}\n\nuniform vec3 clipBounds[2];\nuniform sampler2D texture;\nuniform float opacity;\n\nvarying vec4 f_color;\nvarying vec3 f_data;\nvarying vec2 f_uv;\n\nvoid main() {\n  if (outOfRange(clipBounds[0], clipBounds[1], f_data)) discard;\n\n  gl_FragColor = f_color * texture2D(texture, f_uv) * opacity;\n}"]),d=e(["precision highp float;\n#define GLSLIFY 1\n\nbool outOfRange(float a, float b, float p) {\n  return ((p > max(a, b)) || \n          (p < min(a, b)));\n}\n\nbool outOfRange(vec2 a, vec2 b, vec2 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y));\n}\n\nbool outOfRange(vec3 a, vec3 b, vec3 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y) ||\n          outOfRange(a.z, b.z, p.z));\n}\n\nbool outOfRange(vec4 a, vec4 b, vec4 p) {\n  return outOfRange(a.xyz, b.xyz, p.xyz);\n}\n\nattribute vec3 position;\nattribute vec4 color;\nattribute vec2 uv;\nattribute float pointSize;\n\nuniform mat4 model, view, projection;\nuniform vec3 clipBounds[2];\n\nvarying vec4 f_color;\nvarying vec2 f_uv;\n\nvoid main() {\n  if (outOfRange(clipBounds[0], clipBounds[1], position)) {\n\n    gl_Position = vec4(0.0, 0.0 ,0.0 ,0.0);\n  } else {\n    gl_Position = projection * view * model * vec4(position, 1.0);\n  }\n  gl_PointSize = pointSize;\n  f_color = color;\n  f_uv = uv;\n}"]),s=e(["precision highp float;\n#define GLSLIFY 1\n\nuniform sampler2D texture;\nuniform float opacity;\n\nvarying vec4 f_color;\nvarying vec2 f_uv;\n\nvoid main() {\n  vec2 pointR = gl_PointCoord.xy - vec2(0.5, 0.5);\n  if(dot(pointR, pointR) > 0.25) {\n    discard;\n  }\n  gl_FragColor = f_color * texture2D(texture, f_uv) * opacity;\n}"]),i=e(["precision highp float;\n#define GLSLIFY 1\n\nattribute vec3 position;\nattribute vec4 id;\n\nuniform mat4 model, view, projection;\n\nvarying vec3 f_position;\nvarying vec4 f_id;\n\nvoid main() {\n  gl_Position = projection * view * model * vec4(position, 1.0);\n  f_id        = id;\n  f_position  = position;\n}"]),u=e(["precision highp float;\n#define GLSLIFY 1\n\nbool outOfRange(float a, float b, float p) {\n  return ((p > max(a, b)) || \n          (p < min(a, b)));\n}\n\nbool outOfRange(vec2 a, vec2 b, vec2 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y));\n}\n\nbool outOfRange(vec3 a, vec3 b, vec3 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y) ||\n          outOfRange(a.z, b.z, p.z));\n}\n\nbool outOfRange(vec4 a, vec4 b, vec4 p) {\n  return outOfRange(a.xyz, b.xyz, p.xyz);\n}\n\nuniform vec3  clipBounds[2];\nuniform float pickId;\n\nvarying vec3 f_position;\nvarying vec4 f_id;\n\nvoid main() {\n  if (outOfRange(clipBounds[0], clipBounds[1], f_position)) discard;\n\n  gl_FragColor = vec4(pickId, f_id.xyz);\n}"]),f=e(["precision highp float;\n#define GLSLIFY 1\n\nbool outOfRange(float a, float b, float p) {\n  return ((p > max(a, b)) || \n          (p < min(a, b)));\n}\n\nbool outOfRange(vec2 a, vec2 b, vec2 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y));\n}\n\nbool outOfRange(vec3 a, vec3 b, vec3 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y) ||\n          outOfRange(a.z, b.z, p.z));\n}\n\nbool outOfRange(vec4 a, vec4 b, vec4 p) {\n  return outOfRange(a.xyz, b.xyz, p.xyz);\n}\n\nattribute vec3  position;\nattribute float pointSize;\nattribute vec4  id;\n\nuniform mat4 model, view, projection;\nuniform vec3 clipBounds[2];\n\nvarying vec3 f_position;\nvarying vec4 f_id;\n\nvoid main() {\n  if (outOfRange(clipBounds[0], clipBounds[1], position)) {\n\n    gl_Position = vec4(0.0, 0.0, 0.0, 0.0);\n  } else {\n    gl_Position  = projection * view * model * vec4(position, 1.0);\n    gl_PointSize = pointSize;\n  }\n  f_id         = id;\n  f_position   = position;\n}"]),c=e(["precision highp float;\n#define GLSLIFY 1\n\nattribute vec3 position;\n\nuniform mat4 model, view, projection;\n\nvoid main() {\n  gl_Position = projection * view * model * vec4(position, 1.0);\n}"]),h=e(["precision highp float;\n#define GLSLIFY 1\n\nuniform vec3 contourColor;\n\nvoid main() {\n  gl_FragColor = vec4(contourColor, 1.0);\n}\n"]);x.meshShader={vertex:n,fragment:t,attributes:[{name:"position",type:"vec3"},{name:"normal",type:"vec3"},{name:"color",type:"vec4"},{name:"uv",type:"vec2"}]},x.wireShader={vertex:a,fragment:r,attributes:[{name:"position",type:"vec3"},{name:"color",type:"vec4"},{name:"uv",type:"vec2"}]},x.pointShader={vertex:d,fragment:s,attributes:[{name:"position",type:"vec3"},{name:"color",type:"vec4"},{name:"uv",type:"vec2"},{name:"pointSize",type:"float"}]},x.pickShader={vertex:i,fragment:u,attributes:[{name:"position",type:"vec3"},{name:"id",type:"vec4"}]},x.pointPickShader={vertex:f,fragment:u,attributes:[{name:"position",type:"vec3"},{name:"pointSize",type:"float"},{name:"id",type:"vec4"}]},x.contourShader={vertex:c,fragment:h,attributes:[{name:"position",type:"vec3"}]}},{glslify:231}],112:[function(v,m,x){"use strict";var e=v("gl-shader"),n=v("gl-buffer"),t=v("gl-vao"),a=v("gl-texture2d"),r=v("normals"),d=v("gl-mat4/multiply"),s=v("gl-mat4/invert"),i=v("ndarray"),u=v("colormap"),f=v("simplicial-complex-contour"),c=v("typedarray-pool"),h=v("./lib/shaders"),p=v("./lib/closest-point"),o=h.meshShader,b=h.wireShader,l=h.pointShader,T=h.pickShader,_=h.pointPickShader,w=h.contourShader,k=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];function L(V,W,K,G,Y,$,B,N,U,te,j,J,X,re,ne,le,oe,de,se,ge,_e,Te,we,Oe,fe,ve,Ae){this.gl=V,this.pixelRatio=1,this.cells=[],this.positions=[],this.intensity=[],this.texture=W,this.dirty=!0,this.triShader=K,this.lineShader=G,this.pointShader=Y,this.pickShader=$,this.pointPickShader=B,this.contourShader=N,this.trianglePositions=U,this.triangleColors=j,this.triangleNormals=X,this.triangleUVs=J,this.triangleIds=te,this.triangleVAO=re,this.triangleCount=0,this.lineWidth=1,this.edgePositions=ne,this.edgeColors=oe,this.edgeUVs=de,this.edgeIds=le,this.edgeVAO=se,this.edgeCount=0,this.pointPositions=ge,this.pointColors=Te,this.pointUVs=we,this.pointSizes=Oe,this.pointIds=_e,this.pointVAO=fe,this.pointCount=0,this.contourLineWidth=1,this.contourPositions=ve,this.contourVAO=Ae,this.contourCount=0,this.contourColor=[0,0,0],this.contourEnable=!0,this.pickVertex=!0,this.pickId=1,this.bounds=[[1/0,1/0,1/0],[-1/0,-1/0,-1/0]],this.clipBounds=[[-1/0,-1/0,-1/0],[1/0,1/0,1/0]],this.lightPosition=[1e5,1e5,0],this.ambientLight=.8,this.diffuseLight=.8,this.specularLight=2,this.roughness=.5,this.fresnel=1.5,this.opacity=1,this.hasAlpha=!1,this.opacityscale=!1,this._model=k,this._view=k,this._projection=k,this._resolution=[1,1]}var M=L.prototype;function I(V,W){if(!W||!W.length)return 1;for(var K=0;K<W.length;++K){if(W.length<2)return 1;if(W[K][0]===V)return W[K][1];if(W[K][0]>V&&K>0){var G=(W[K][0]-V)/(W[K][0]-W[K-1][0]);return W[K][1]*(1-G)+G*W[K-1][1]}}return 1}function P(V){var W=e(V,o.vertex,o.fragment);return W.attributes.position.location=0,W.attributes.color.location=2,W.attributes.uv.location=3,W.attributes.normal.location=4,W}function S(V){var W=e(V,b.vertex,b.fragment);return W.attributes.position.location=0,W.attributes.color.location=2,W.attributes.uv.location=3,W}function E(V){var W=e(V,l.vertex,l.fragment);return W.attributes.position.location=0,W.attributes.color.location=2,W.attributes.uv.location=3,W.attributes.pointSize.location=4,W}function z(V){var W=e(V,T.vertex,T.fragment);return W.attributes.position.location=0,W.attributes.id.location=1,W}function R(V){var W=e(V,_.vertex,_.fragment);return W.attributes.position.location=0,W.attributes.id.location=1,W.attributes.pointSize.location=4,W}function q(V){var W=e(V,w.vertex,w.fragment);return W.attributes.position.location=0,W}M.isOpaque=function(){return!this.hasAlpha},M.isTransparent=function(){return this.hasAlpha},M.pickSlots=1,M.setPickBase=function(V){this.pickId=V},M.highlight=function(V){if(V&&this.contourEnable){for(var W=f(this.cells,this.intensity,V.intensity),K=W.cells,G=W.vertexIds,Y=W.vertexWeights,$=K.length,B=c.mallocFloat32(6*$),N=0,U=0;U<$;++U)for(var te=K[U],j=0;j<2;++j){var J=te[0];2===te.length&&(J=te[j]);for(var ne=Y[J],le=1-ne,oe=this.positions[G[J][0]],de=this.positions[G[J][1]],se=0;se<3;++se)B[N++]=ne*oe[se]+le*de[se]}this.contourCount=N/3|0,this.contourPositions.update(B.subarray(0,N)),c.free(B)}else this.contourCount=0},M.update=function(V){V=V||{};var W=this.gl;this.dirty=!0,"contourEnable"in V&&(this.contourEnable=V.contourEnable),"contourColor"in V&&(this.contourColor=V.contourColor),"lineWidth"in V&&(this.lineWidth=V.lineWidth),"lightPosition"in V&&(this.lightPosition=V.lightPosition),this.hasAlpha=!1,"opacity"in V&&(this.opacity=V.opacity,this.opacity<1&&(this.hasAlpha=!0)),"opacityscale"in V&&(this.opacityscale=V.opacityscale,this.hasAlpha=!0),"ambient"in V&&(this.ambientLight=V.ambient),"diffuse"in V&&(this.diffuseLight=V.diffuse),"specular"in V&&(this.specularLight=V.specular),"roughness"in V&&(this.roughness=V.roughness),"fresnel"in V&&(this.fresnel=V.fresnel),V.texture?(this.texture.dispose(),this.texture=a(W,V.texture)):V.colormap&&(this.texture.shape=[256,256],this.texture.minFilter=W.LINEAR_MIPMAP_LINEAR,this.texture.magFilter=W.LINEAR,this.texture.setPixels(function(Ut,er){for(var Wt=u({colormap:Ut,nshades:256,format:"rgba"}),rr=new Uint8Array(1024),Ht=0;Ht<256;++Ht){for(var Ve=Wt[Ht],We=0;We<3;++We)rr[4*Ht+We]=Ve[We];rr[4*Ht+3]=er?255*I(Ht/255,er):255*Ve[3]}return i(rr,[256,256,4],[4,0,1])}(V.colormap,this.opacityscale)),this.texture.generateMipmap());var K=V.cells,G=V.positions;if(G&&K){var Y=[],$=[],B=[],N=[],U=[],te=[],j=[],J=[],X=[],re=[],ne=[],le=[],oe=[],de=[];this.cells=K,this.positions=G;var se=V.vertexNormals,ge=V.cellNormals,_e=void 0===V.vertexNormalsEpsilon?1e-6:V.vertexNormalsEpsilon;V.useFacetNormals&&!ge&&(ge=r.faceNormals(K,G,void 0===V.faceNormalsEpsilon?1e-6:V.faceNormalsEpsilon)),ge||se||(se=r.vertexNormals(K,G,_e));var we=V.vertexColors,Oe=V.cellColors,fe=V.meshColor||[1,1,1,1],ve=V.vertexUVs,Ae=V.vertexIntensity,ke=V.cellUVs,Pe=V.cellIntensity,Ne=1/0,De=-1/0;if(!ve&&!ke)if(Ae)if(V.vertexIntensityBounds)Ne=+V.vertexIntensityBounds[0],De=+V.vertexIntensityBounds[1];else for(var ze=0;ze<Ae.length;++ze){var Me=Ae[ze];Ne=Math.min(Ne,Me),De=Math.max(De,Me)}else if(Pe)if(V.cellIntensityBounds)Ne=+V.cellIntensityBounds[0],De=+V.cellIntensityBounds[1];else for(ze=0;ze<Pe.length;++ze)Me=Pe[ze],Ne=Math.min(Ne,Me),De=Math.max(De,Me);else for(ze=0;ze<G.length;++ze)Me=G[ze][2],Ne=Math.min(Ne,Me),De=Math.max(De,Me);this.intensity=Ae||Pe||function(Ut){for(var er=Ut.length,Wt=new Array(er),rr=0;rr<er;++rr)Wt[rr]=Ut[rr][2];return Wt}(G),this.pickVertex=!(Pe||Oe);var Se=V.pointSizes,Ie=V.pointSize||1;for(this.bounds=[[1/0,1/0,1/0],[-1/0,-1/0,-1/0]],ze=0;ze<G.length;++ze)for(var Fe=G[ze],Re=0;Re<3;++Re)!isNaN(Fe[Re])&&isFinite(Fe[Re])&&(this.bounds[0][Re]=Math.min(this.bounds[0][Re],Fe[Re]),this.bounds[1][Re]=Math.max(this.bounds[1][Re],Fe[Re]));var Xe=0,nt=0,ct=0;e:for(ze=0;ze<K.length;++ze){var xt=K[ze];switch(xt.length){case 1:for(Fe=G[tt=xt[0]],Re=0;Re<3;++Re)if(isNaN(Fe[Re])||!isFinite(Fe[Re]))continue e;re.push(Fe[0],Fe[1],Fe[2]),Ke=we?we[tt]:Oe?Oe[ze]:fe,this.opacityscale&&Ae?$.push(Ke[0],Ke[1],Ke[2],this.opacity*I((Ae[tt]-Ne)/(De-Ne),this.opacityscale)):3===Ke.length?ne.push(Ke[0],Ke[1],Ke[2],this.opacity):(ne.push(Ke[0],Ke[1],Ke[2],Ke[3]*this.opacity),Ke[3]<1&&(this.hasAlpha=!0)),le.push((mt=ve?ve[tt]:Ae?[(Ae[tt]-Ne)/(De-Ne),0]:ke?ke[ze]:Pe?[(Pe[ze]-Ne)/(De-Ne),0]:[(Fe[2]-Ne)/(De-Ne),0])[0],mt[1]),oe.push(Se?Se[tt]:Ie),de.push(ze),ct+=1;break;case 2:for(Re=0;Re<2;++Re){Fe=G[tt=xt[Re]];for(var dt=0;dt<3;++dt)if(isNaN(Fe[dt])||!isFinite(Fe[dt]))continue e}for(Re=0;Re<2;++Re)Fe=G[tt=xt[Re]],te.push(Fe[0],Fe[1],Fe[2]),Ke=we?we[tt]:Oe?Oe[ze]:fe,this.opacityscale&&Ae?$.push(Ke[0],Ke[1],Ke[2],this.opacity*I((Ae[tt]-Ne)/(De-Ne),this.opacityscale)):3===Ke.length?j.push(Ke[0],Ke[1],Ke[2],this.opacity):(j.push(Ke[0],Ke[1],Ke[2],Ke[3]*this.opacity),Ke[3]<1&&(this.hasAlpha=!0)),J.push((mt=ve?ve[tt]:Ae?[(Ae[tt]-Ne)/(De-Ne),0]:ke?ke[ze]:Pe?[(Pe[ze]-Ne)/(De-Ne),0]:[(Fe[2]-Ne)/(De-Ne),0])[0],mt[1]),X.push(ze);nt+=1;break;case 3:for(Re=0;Re<3;++Re)for(Fe=G[tt=xt[Re]],dt=0;dt<3;++dt)if(isNaN(Fe[dt])||!isFinite(Fe[dt]))continue e;for(Re=0;Re<3;++Re){var tt,Ke,mt,Bt;Fe=G[tt=xt[2-Re]],Y.push(Fe[0],Fe[1],Fe[2]),(Ke=we?we[tt]:Oe?Oe[ze]:fe)?this.opacityscale&&Ae?$.push(Ke[0],Ke[1],Ke[2],this.opacity*I((Ae[tt]-Ne)/(De-Ne),this.opacityscale)):3===Ke.length?$.push(Ke[0],Ke[1],Ke[2],this.opacity):($.push(Ke[0],Ke[1],Ke[2],Ke[3]*this.opacity),Ke[3]<1&&(this.hasAlpha=!0)):$.push(.5,.5,.5,1),N.push((mt=ve?ve[tt]:Ae?[(Ae[tt]-Ne)/(De-Ne),0]:ke?ke[ze]:Pe?[(Pe[ze]-Ne)/(De-Ne),0]:[(Fe[2]-Ne)/(De-Ne),0])[0],mt[1]),B.push((Bt=se?se[tt]:ge[ze])[0],Bt[1],Bt[2]),U.push(ze)}Xe+=1}}this.pointCount=ct,this.edgeCount=nt,this.triangleCount=Xe,this.pointPositions.update(re),this.pointColors.update(ne),this.pointUVs.update(le),this.pointSizes.update(oe),this.pointIds.update(new Uint32Array(de)),this.edgePositions.update(te),this.edgeColors.update(j),this.edgeUVs.update(J),this.edgeIds.update(new Uint32Array(X)),this.trianglePositions.update(Y),this.triangleColors.update($),this.triangleUVs.update(N),this.triangleNormals.update(B),this.triangleIds.update(new Uint32Array(U))}},M.drawTransparent=M.draw=function(V){for(var W=this.gl,K=(V=V||{}).model||k,G=V.view||k,Y=V.projection||k,$=[[-1e6,-1e6,-1e6],[1e6,1e6,1e6]],B=0;B<3;++B)$[0][B]=Math.max($[0][B],this.clipBounds[0][B]),$[1][B]=Math.min($[1][B],this.clipBounds[1][B]);var N={model:K,view:G,projection:Y,inverseModel:k.slice(),clipBounds:$,kambient:this.ambientLight,kdiffuse:this.diffuseLight,kspecular:this.specularLight,roughness:this.roughness,fresnel:this.fresnel,eyePosition:[0,0,0],lightPosition:[0,0,0],contourColor:this.contourColor,texture:0};N.inverseModel=s(N.inverseModel,N.model),W.disable(W.CULL_FACE),this.texture.bind(0);var U=new Array(16);for(d(U,N.view,N.model),d(U,N.projection,U),s(U,U),B=0;B<3;++B)N.eyePosition[B]=U[12+B]/U[15];var te,j=U[15];for(B=0;B<3;++B)j+=this.lightPosition[B]*U[4*B+3];for(B=0;B<3;++B){for(var J=U[12+B],X=0;X<3;++X)J+=U[4*X+B]*this.lightPosition[X];N.lightPosition[B]=J/j}this.triangleCount>0&&((te=this.triShader).bind(),te.uniforms=N,this.triangleVAO.bind(),W.drawArrays(W.TRIANGLES,0,3*this.triangleCount),this.triangleVAO.unbind()),this.edgeCount>0&&this.lineWidth>0&&((te=this.lineShader).bind(),te.uniforms=N,this.edgeVAO.bind(),W.lineWidth(this.lineWidth*this.pixelRatio),W.drawArrays(W.LINES,0,2*this.edgeCount),this.edgeVAO.unbind()),this.pointCount>0&&((te=this.pointShader).bind(),te.uniforms=N,this.pointVAO.bind(),W.drawArrays(W.POINTS,0,this.pointCount),this.pointVAO.unbind()),this.contourEnable&&this.contourCount>0&&this.contourLineWidth>0&&((te=this.contourShader).bind(),te.uniforms=N,this.contourVAO.bind(),W.drawArrays(W.LINES,0,this.contourCount),this.contourVAO.unbind())},M.drawPick=function(V){for(var W=this.gl,K=(V=V||{}).model||k,G=V.view||k,Y=V.projection||k,$=[[-1e6,-1e6,-1e6],[1e6,1e6,1e6]],B=0;B<3;++B)$[0][B]=Math.max($[0][B],this.clipBounds[0][B]),$[1][B]=Math.min($[1][B],this.clipBounds[1][B]);this._model=[].slice.call(K),this._view=[].slice.call(G),this._projection=[].slice.call(Y),this._resolution=[W.drawingBufferWidth,W.drawingBufferHeight];var N,U={model:K,view:G,projection:Y,clipBounds:$,pickId:this.pickId/255};(N=this.pickShader).bind(),N.uniforms=U,this.triangleCount>0&&(this.triangleVAO.bind(),W.drawArrays(W.TRIANGLES,0,3*this.triangleCount),this.triangleVAO.unbind()),this.edgeCount>0&&(this.edgeVAO.bind(),W.lineWidth(this.lineWidth*this.pixelRatio),W.drawArrays(W.LINES,0,2*this.edgeCount),this.edgeVAO.unbind()),this.pointCount>0&&((N=this.pointPickShader).bind(),N.uniforms=U,this.pointVAO.bind(),W.drawArrays(W.POINTS,0,this.pointCount),this.pointVAO.unbind())},M.pick=function(V){if(!V||V.id!==this.pickId)return null;for(var W=V.value[0]+256*V.value[1]+65536*V.value[2],K=this.cells[W],G=this.positions,Y=new Array(K.length),$=0;$<K.length;++$)Y[$]=G[K[$]];var B=V.coord[0],N=V.coord[1];if(!this.pickVertex){var U=this.positions[K[0]],te=this.positions[K[1]],j=this.positions[K[2]];return{_cellCenter:!0,position:[B,N],index:W,cell:K,cellId:W,intensity:this.intensity[W],dataCoordinate:[(U[0]+te[0]+j[0])/3,(U[1]+te[1]+j[1])/3,(U[2]+te[2]+j[2])/3]}}var X=p(Y,[B*this.pixelRatio,this._resolution[1]-N*this.pixelRatio],this._model,this._view,this._projection,this._resolution);if(!X)return null;var re=X[2],ne=0;for($=0;$<K.length;++$)ne+=re[$]*this.intensity[K[$]];return{position:X[1],index:K[X[0]],cell:K,cellId:W,intensity:ne,dataCoordinate:this.positions[K[X[0]]]}},M.dispose=function(){this.texture.dispose(),this.triShader.dispose(),this.lineShader.dispose(),this.pointShader.dispose(),this.pickShader.dispose(),this.pointPickShader.dispose(),this.triangleVAO.dispose(),this.trianglePositions.dispose(),this.triangleColors.dispose(),this.triangleUVs.dispose(),this.triangleNormals.dispose(),this.triangleIds.dispose(),this.edgeVAO.dispose(),this.edgePositions.dispose(),this.edgeColors.dispose(),this.edgeUVs.dispose(),this.edgeIds.dispose(),this.pointVAO.dispose(),this.pointPositions.dispose(),this.pointColors.dispose(),this.pointUVs.dispose(),this.pointSizes.dispose(),this.pointIds.dispose(),this.contourVAO.dispose(),this.contourPositions.dispose(),this.contourShader.dispose()},m.exports=function(V,W){if(1===arguments.length&&(V=(W=V).gl),!(V.getExtension("OES_standard_derivatives")||V.getExtension("MOZ_OES_standard_derivatives")||V.getExtension("WEBKIT_OES_standard_derivatives")))throw new Error("derivatives not supported");var G=P(V),Y=S(V),$=E(V),B=z(V),N=R(V),U=q(V),te=a(V,i(new Uint8Array([255,255,255,255]),[1,1,4]));te.generateMipmap(),te.minFilter=V.LINEAR_MIPMAP_LINEAR,te.magFilter=V.LINEAR;var j=n(V),J=n(V),X=n(V),re=n(V),ne=n(V),le=t(V,[{buffer:j,type:V.FLOAT,size:3},{buffer:ne,type:V.UNSIGNED_BYTE,size:4,normalized:!0},{buffer:J,type:V.FLOAT,size:4},{buffer:X,type:V.FLOAT,size:2},{buffer:re,type:V.FLOAT,size:3}]),oe=n(V),de=n(V),se=n(V),ge=n(V),_e=t(V,[{buffer:oe,type:V.FLOAT,size:3},{buffer:ge,type:V.UNSIGNED_BYTE,size:4,normalized:!0},{buffer:de,type:V.FLOAT,size:4},{buffer:se,type:V.FLOAT,size:2}]),Te=n(V),we=n(V),Oe=n(V),fe=n(V),ve=n(V),Ae=t(V,[{buffer:Te,type:V.FLOAT,size:3},{buffer:ve,type:V.UNSIGNED_BYTE,size:4,normalized:!0},{buffer:we,type:V.FLOAT,size:4},{buffer:Oe,type:V.FLOAT,size:2},{buffer:fe,type:V.FLOAT,size:1}]),ke=n(V),Ne=new L(V,te,G,Y,$,B,N,U,j,ne,J,X,re,le,oe,ge,de,se,_e,Te,ve,we,Oe,fe,Ae,ke,t(V,[{buffer:ke,type:V.FLOAT,size:3}]));return Ne.update(W),Ne}},{"./lib/closest-point":110,"./lib/shaders":111,colormap:53,"gl-buffer":78,"gl-mat4/invert":98,"gl-mat4/multiply":100,"gl-shader":132,"gl-texture2d":146,"gl-vao":150,ndarray:259,normals:261,"simplicial-complex-contour":291,"typedarray-pool":308}],113:[function(v,m,x){"use strict";m.exports=function(i){var u=i.gl;return new a(i,e(u,[0,0,0,1,1,0,1,1]),n(u,t.boxVert,t.lineFrag))};var e=v("gl-buffer"),n=v("gl-shader"),t=v("./shaders");function a(i,u,f){this.plot=i,this.vbo=u,this.shader=f}var r,d,s=a.prototype;s.bind=function(){var i=this.shader;this.vbo.bind(),this.shader.bind(),i.attributes.coord.pointer(),i.uniforms.screenBox=this.plot.screenBox},s.drawBox=(r=[0,0],d=[0,0],function(i,u,f,c,h){var o=this.shader,b=this.plot.gl;r[0]=i,r[1]=u,d[0]=f,d[1]=c,o.uniforms.lo=r,o.uniforms.hi=d,o.uniforms.color=h,b.drawArrays(b.TRIANGLE_STRIP,0,4)}),s.dispose=function(){this.vbo.dispose(),this.shader.dispose()}},{"./shaders":116,"gl-buffer":78,"gl-shader":132}],114:[function(v,m,x){"use strict";m.exports=function(p){var o=p.gl;return new r(p,e(o),n(o,a.gridVert,a.gridFrag),n(o,a.tickVert,a.gridFrag))};var e=v("gl-buffer"),n=v("gl-shader"),t=v("binary-search-bounds"),a=v("./shaders");function r(p,o,b,l){this.plot=p,this.vbo=o,this.shader=b,this.tickShader=l,this.ticks=[[],[]]}function d(p,o){return p-o}var s,i,u,f,c,p,o,b,l,T,_,h=r.prototype;h.draw=(s=[0,0],i=[0,0],u=[0,0],function(){for(var p=this.plot,o=this.vbo,b=this.shader,l=this.ticks,T=p.gl,_=p._tickBounds,w=p.dataBox,k=p.viewBox,L=p.gridLineWidth,M=p.gridLineColor,I=p.gridLineEnable,P=p.pixelRatio,S=0;S<2;++S){var E=_[S],R=.5*(w[S+2]+w[S]),q=w[S+2]-w[S];i[S]=2*(_[S+2]-E)/q,s[S]=2*(E-R)/q}b.bind(),o.bind(),b.attributes.dataCoord.pointer(),b.uniforms.dataShift=s,b.uniforms.dataScale=i;var V=0;for(S=0;S<2;++S){u[0]=u[1]=0,u[S]=1,b.uniforms.dataAxis=u,b.uniforms.lineWidth=L[S]/(k[S+2]-k[S])*P,b.uniforms.color=M[S];var W=6*l[S].length;I[S]&&W&&T.drawArrays(T.TRIANGLES,V,W),V+=W}}),h.drawTickMarks=(p=[0,0],o=[0,0],b=[1,0],l=[0,1],T=[0,0],_=[0,0],function(){for(var w=this.plot,k=this.vbo,L=this.tickShader,M=this.ticks,I=w.gl,P=w._tickBounds,S=w.dataBox,E=w.viewBox,z=w.pixelRatio,R=w.screenBox,q=R[2]-R[0],V=R[3]-R[1],W=E[2]-E[0],K=E[3]-E[1],G=0;G<2;++G){var Y=P[G],B=.5*(S[G+2]+S[G]),N=S[G+2]-S[G];o[G]=2*(P[G+2]-Y)/N,p[G]=2*(Y-B)/N}o[0]*=W/q,p[0]*=W/q,o[1]*=K/V,p[1]*=K/V,L.bind(),k.bind(),L.attributes.dataCoord.pointer();var U=L.uniforms;U.dataShift=p,U.dataScale=o;var te=w.tickMarkLength,j=w.tickMarkWidth,J=w.tickMarkColor,X=6*M[0].length,re=Math.min(t.ge(M[0],(S[0]-P[0])/(P[2]-P[0]),d),M[0].length),ne=Math.min(t.gt(M[0],(S[2]-P[0])/(P[2]-P[0]),d),M[0].length),le=0+6*re,oe=6*Math.max(0,ne-re),de=Math.min(t.ge(M[1],(S[1]-P[1])/(P[3]-P[1]),d),M[1].length),se=Math.min(t.gt(M[1],(S[3]-P[1])/(P[3]-P[1]),d),M[1].length),ge=X+6*de,_e=6*Math.max(0,se-de);T[0]=2*(E[0]-te[1])/q-1,T[1]=(E[3]+E[1])/V-1,_[0]=te[1]*z/q,_[1]=j[1]*z/V,_e&&(U.color=J[1],U.tickScale=_,U.dataAxis=l,U.screenOffset=T,I.drawArrays(I.TRIANGLES,ge,_e)),T[0]=(E[2]+E[0])/q-1,T[1]=2*(E[1]-te[0])/V-1,_[0]=j[0]*z/q,_[1]=te[0]*z/V,oe&&(U.color=J[0],U.tickScale=_,U.dataAxis=b,U.screenOffset=T,I.drawArrays(I.TRIANGLES,le,oe)),T[0]=2*(E[2]+te[3])/q-1,T[1]=(E[3]+E[1])/V-1,_[0]=te[3]*z/q,_[1]=j[3]*z/V,_e&&(U.color=J[3],U.tickScale=_,U.dataAxis=l,U.screenOffset=T,I.drawArrays(I.TRIANGLES,ge,_e)),T[0]=(E[2]+E[0])/q-1,T[1]=2*(E[3]+te[2])/V-1,_[0]=j[2]*z/q,_[1]=te[2]*z/V,oe&&(U.color=J[2],U.tickScale=_,U.dataAxis=b,U.screenOffset=T,I.drawArrays(I.TRIANGLES,le,oe))}),h.update=(f=[1,1,-1,-1,1,-1],c=[1,-1,1,1,-1,-1],function(p){for(var o=p.ticks,b=p.bounds,l=new Float32Array(18*(o[0].length+o[1].length)),T=0,_=[[],[]],w=0;w<2;++w)for(var k=_[w],L=o[w],M=b[w],I=b[w+2],P=0;P<L.length;++P){var S=(L[P].x-M)/(I-M);k.push(S);for(var E=0;E<6;++E)l[T++]=S,l[T++]=f[E],l[T++]=c[E]}this.ticks=_,this.vbo.update(l)}),h.dispose=function(){this.vbo.dispose(),this.shader.dispose(),this.tickShader.dispose()}},{"./shaders":116,"binary-search-bounds":31,"gl-buffer":78,"gl-shader":132}],115:[function(v,m,x){"use strict";m.exports=function(i){var u=i.gl;return new a(i,e(u,[-1,-1,-1,1,1,-1,1,1]),n(u,t.lineVert,t.lineFrag))};var e=v("gl-buffer"),n=v("gl-shader"),t=v("./shaders");function a(i,u,f){this.plot=i,this.vbo=u,this.shader=f}var r,d,s=a.prototype;s.bind=function(){var i=this.shader;this.vbo.bind(),this.shader.bind(),i.attributes.coord.pointer(),i.uniforms.screenBox=this.plot.screenBox},s.drawLine=(r=[0,0],d=[0,0],function(i,u,f,c,h,p){var o=this.plot,b=this.shader,l=o.gl;r[0]=i,r[1]=u,d[0]=f,d[1]=c,b.uniforms.start=r,b.uniforms.end=d,b.uniforms.width=h*o.pixelRatio,b.uniforms.color=p,l.drawArrays(l.TRIANGLE_STRIP,0,4)}),s.dispose=function(){this.vbo.dispose(),this.shader.dispose()}},{"./shaders":116,"gl-buffer":78,"gl-shader":132}],116:[function(v,m,x){"use strict";var e=v("glslify"),n=e(["precision lowp float;\n#define GLSLIFY 1\nuniform vec4 color;\nvoid main() {\n  gl_FragColor = vec4(color.xyz * color.w, color.w);\n}\n"]);m.exports={lineVert:e(["precision mediump float;\n#define GLSLIFY 1\n\nattribute vec2 coord;\n\nuniform vec4 screenBox;\nuniform vec2 start, end;\nuniform float width;\n\nvec2 perp(vec2 v) {\n  return vec2(v.y, -v.x);\n}\n\nvec2 screen(vec2 v) {\n  return 2.0 * (v - screenBox.xy) / (screenBox.zw - screenBox.xy) - 1.0;\n}\n\nvoid main() {\n  vec2 delta = normalize(perp(start - end));\n  vec2 offset = mix(start, end, 0.5 * (coord.y+1.0));\n  gl_Position = vec4(screen(offset + 0.5 * width * delta * coord.x), 0, 1);\n}\n"]),lineFrag:n,textVert:e(["#define GLSLIFY 1\nattribute vec3 textCoordinate;\n\nuniform vec2 dataScale, dataShift, dataAxis, screenOffset, textScale;\nuniform float angle;\n\nvoid main() {\n  float dataOffset  = textCoordinate.z;\n  vec2 glyphOffset  = textCoordinate.xy;\n  mat2 glyphMatrix = mat2(cos(angle), sin(angle), -sin(angle), cos(angle));\n  vec2 screenCoordinate = dataAxis * (dataScale * dataOffset + dataShift) +\n    glyphMatrix * glyphOffset * textScale + screenOffset;\n  gl_Position = vec4(screenCoordinate, 0, 1);\n}\n"]),textFrag:n,gridVert:e(["precision mediump float;\n#define GLSLIFY 1\n\nattribute vec3 dataCoord;\n\nuniform vec2 dataAxis, dataShift, dataScale;\nuniform float lineWidth;\n\nvoid main() {\n  vec2 pos = dataAxis * (dataScale * dataCoord.x + dataShift);\n  pos += 10.0 * dataCoord.y * vec2(dataAxis.y, -dataAxis.x) + dataCoord.z * lineWidth;\n  gl_Position = vec4(pos, 0, 1);\n}\n"]),gridFrag:n,boxVert:e(["precision mediump float;\n#define GLSLIFY 1\n\nattribute vec2 coord;\n\nuniform vec4 screenBox;\nuniform vec2 lo, hi;\n\nvec2 screen(vec2 v) {\n  return 2.0 * (v - screenBox.xy) / (screenBox.zw - screenBox.xy) - 1.0;\n}\n\nvoid main() {\n  gl_Position = vec4(screen(mix(lo, hi, coord)), 0, 1);\n}\n"]),tickVert:e(["precision mediump float;\n#define GLSLIFY 1\n\nattribute vec3 dataCoord;\n\nuniform vec2 dataAxis, dataShift, dataScale, screenOffset, tickScale;\n\nvoid main() {\n  vec2 pos = dataAxis * (dataScale * dataCoord.x + dataShift);\n  gl_Position = vec4(pos + tickScale*dataCoord.yz + screenOffset, 0, 1);\n}\n"])}},{glslify:231}],117:[function(v,m,x){"use strict";m.exports=function(o){var b=o.gl;return new d(o,e(b),n(b,r.textVert,r.textFrag))};var e=v("gl-buffer"),n=v("gl-shader"),t=v("text-cache"),a=v("binary-search-bounds"),r=v("./shaders");function d(o,b,l){this.plot=o,this.vbo=b,this.shader=l,this.tickOffset=[[],[]],this.tickX=[[],[]],this.labelOffset=[0,0],this.labelCount=[0,0]}var s,i,u,f,c,h,o,b,p=d.prototype;p.drawTicks=(s=[0,0],i=[0,0],u=[0,0],function(o){var b=this.plot,l=this.shader,T=this.tickX[o],_=this.tickOffset[o],w=b.gl,k=b.viewBox,L=b.dataBox,M=b.screenBox,I=b.pixelRatio,P=b.tickEnable,S=b.tickPad,E=b.tickColor,z=b.tickAngle,R=b.labelEnable,q=b.labelPad,V=b.labelColor,W=b.labelAngle,K=this.labelOffset[o],G=this.labelCount[o],Y=a.lt(T,L[o]),$=a.le(T,L[o+2]);s[0]=s[1]=0,s[o]=1,i[o]=(k[2+o]+k[o])/(M[2+o]-M[o])-1;var B=2/M[2+(1^o)]-M[1^o];i[1^o]=B*k[1^o]-1,P[o]&&(i[1^o]-=B*I*S[o],Y<$&&_[$]>_[Y]&&(l.uniforms.dataAxis=s,l.uniforms.screenOffset=i,l.uniforms.color=E[o],l.uniforms.angle=z[o],w.drawArrays(w.TRIANGLES,_[Y],_[$]-_[Y]))),R[o]&&G&&(i[1^o]-=B*I*q[o],l.uniforms.dataAxis=u,l.uniforms.screenOffset=i,l.uniforms.color=V[o],l.uniforms.angle=W[o],w.drawArrays(w.TRIANGLES,K,G)),i[1^o]=B*k[2+(1^o)]-1,P[o+2]&&(i[1^o]+=B*I*S[o+2],Y<$&&_[$]>_[Y]&&(l.uniforms.dataAxis=s,l.uniforms.screenOffset=i,l.uniforms.color=E[o+2],l.uniforms.angle=z[o+2],w.drawArrays(w.TRIANGLES,_[Y],_[$]-_[Y]))),R[o+2]&&G&&(i[1^o]+=B*I*q[o+2],l.uniforms.dataAxis=u,l.uniforms.screenOffset=i,l.uniforms.color=V[o+2],l.uniforms.angle=W[o+2],w.drawArrays(w.TRIANGLES,K,G))}),p.drawTitle=(o=[0,0],b=[0,0],function(){var l=this.plot,T=this.shader,_=l.gl,w=l.screenBox,k=l.titleCenter,L=l.titleAngle,M=l.titleColor,I=l.pixelRatio;if(this.titleCount){for(var P=0;P<2;++P)b[P]=2*(k[P]*I-w[P])/(w[2+P]-w[P])-1;T.bind(),T.uniforms.dataAxis=o,T.uniforms.screenOffset=b,T.uniforms.angle=L,T.uniforms.color=M,_.drawArrays(_.TRIANGLES,this.titleOffset,this.titleCount)}}),p.bind=(f=[0,0],c=[0,0],h=[0,0],function(){var o=this.plot,b=this.shader,l=o._tickBounds,T=o.dataBox,_=o.screenBox,w=o.viewBox;b.bind();for(var k=0;k<2;++k){var L=l[k],I=.5*(T[k+2]+T[k]),P=T[k+2]-T[k],E=w[k+2]-w[k],R=_[k+2]-_[k];c[k]=2*(l[k+2]-L)/P*E/R,f[k]=2*(L-I)/P*E/R}h[1]=2*o.pixelRatio/(_[3]-_[1]),h[0]=h[1]*(_[3]-_[1])/(_[2]-_[0]),b.uniforms.dataScale=c,b.uniforms.dataShift=f,b.uniforms.textScale=h,this.vbo.bind(),b.attributes.textCoordinate.pointer()}),p.update=function(o){var b,l,T,_,w,k=[],L=o.ticks,M=o.bounds;for(w=0;w<2;++w){var I=[Math.floor(k.length/3)],P=[-1/0],S=L[w];for(b=0;b<S.length;++b){var E=S[b],z=E.x,q=E.font||"sans-serif";_=E.fontSize||12;for(var V=1/(M[w+2]-M[w]),W=M[w],K=E.text.split("\n"),G=0;G<K.length;G++)for(T=t(q,K[G]).data,l=0;l<T.length;l+=2)k.push(T[l]*_,-T[l+1]*_-G*_*1.2,(z-W)*V);I.push(Math.floor(k.length/3)),P.push(z)}this.tickOffset[w]=I,this.tickX[w]=P}for(w=0;w<2;++w){for(this.labelOffset[w]=Math.floor(k.length/3),T=t(o.labelFont[w],o.labels[w],{textAlign:"center"}).data,_=o.labelSize[w],b=0;b<T.length;b+=2)k.push(T[b]*_,-T[b+1]*_,0);this.labelCount[w]=Math.floor(k.length/3)-this.labelOffset[w]}for(this.titleOffset=Math.floor(k.length/3),T=t(o.titleFont,o.title).data,_=o.titleSize,b=0;b<T.length;b+=2)k.push(T[b]*_,-T[b+1]*_,0);this.titleCount=Math.floor(k.length/3)-this.titleOffset,this.vbo.update(k)},p.dispose=function(){this.vbo.dispose(),this.shader.dispose()}},{"./shaders":116,"binary-search-bounds":31,"gl-buffer":78,"gl-shader":132,"text-cache":303}],118:[function(v,m,x){"use strict";m.exports=function(f){var c=f.gl,p=new d(c,e(c,[c.drawingBufferWidth,c.drawingBufferHeight]));return p.grid=n(p),p.text=t(p),p.line=a(p),p.box=r(p),p.update(f),p};var e=v("gl-select-static"),n=v("./lib/grid"),t=v("./lib/text"),a=v("./lib/line"),r=v("./lib/box");function d(f,c){this.gl=f,this.pickBuffer=c,this.screenBox=[0,0,f.drawingBufferWidth,f.drawingBufferHeight],this.viewBox=[0,0,0,0],this.dataBox=[-10,-10,10,10],this.gridLineEnable=[!0,!0],this.gridLineWidth=[1,1],this.gridLineColor=[[0,0,0,1],[0,0,0,1]],this.pixelRatio=1,this.tickMarkLength=[0,0,0,0],this.tickMarkWidth=[0,0,0,0],this.tickMarkColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.tickPad=[15,15,15,15],this.tickAngle=[0,0,0,0],this.tickEnable=[!0,!0,!0,!0],this.tickColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.labelPad=[15,15,15,15],this.labelAngle=[0,Math.PI/2,0,3*Math.PI/2],this.labelEnable=[!0,!0,!0,!0],this.labelColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.titleCenter=[0,0],this.titleEnable=!0,this.titleAngle=0,this.titleColor=[0,0,0,1],this.borderColor=[0,0,0,0],this.backgroundColor=[0,0,0,0],this.zeroLineEnable=[!0,!0],this.zeroLineWidth=[4,4],this.zeroLineColor=[[0,0,0,1],[0,0,0,1]],this.borderLineEnable=[!0,!0,!0,!0],this.borderLineWidth=[2,2,2,2],this.borderLineColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.grid=null,this.text=null,this.line=null,this.box=null,this.objects=[],this.overlays=[],this._tickBounds=[1/0,1/0,-1/0,-1/0],this.static=!1,this.dirty=!1,this.pickDirty=!1,this.pickDelay=120,this.pickRadius=10,this._pickTimeout=null,this._drawPick=this.drawPick.bind(this),this._depthCounter=0}var s=d.prototype;function i(f){for(var c=f.slice(),h=0;h<c.length;++h)c[h]=c[h].slice();return c}function u(f,c){return f.x-c.x}s.setDirty=function(){this.dirty=this.pickDirty=!0},s.setOverlayDirty=function(){this.dirty=!0},s.nextDepthValue=function(){return this._depthCounter++/65536},s.draw=function(){var f=this.gl,c=this.screenBox,h=this.viewBox,p=this.dataBox,o=this.pixelRatio,b=this.grid,l=this.line,T=this.text,_=this.objects;if(this._depthCounter=0,this.pickDirty&&(this._pickTimeout&&clearTimeout(this._pickTimeout),this.pickDirty=!1,this._pickTimeout=setTimeout(this._drawPick,this.pickDelay)),this.dirty){if(this.dirty=!1,f.bindFramebuffer(f.FRAMEBUFFER,null),f.enable(f.SCISSOR_TEST),f.disable(f.DEPTH_TEST),f.depthFunc(f.LESS),f.depthMask(!1),f.enable(f.BLEND),f.blendEquation(f.FUNC_ADD,f.FUNC_ADD),f.blendFunc(f.ONE,f.ONE_MINUS_SRC_ALPHA),this.borderColor){f.scissor(c[0],c[1],c[2]-c[0],c[3]-c[1]);var w=this.borderColor;f.clearColor(w[0]*w[3],w[1]*w[3],w[2]*w[3],w[3]),f.clear(f.COLOR_BUFFER_BIT|f.DEPTH_BUFFER_BIT)}f.scissor(h[0],h[1],h[2]-h[0],h[3]-h[1]),f.viewport(h[0],h[1],h[2]-h[0],h[3]-h[1]);var k=this.backgroundColor;f.clearColor(k[0]*k[3],k[1]*k[3],k[2]*k[3],k[3]),f.clear(f.COLOR_BUFFER_BIT),b.draw();var L=this.zeroLineEnable,M=this.zeroLineColor,I=this.zeroLineWidth;if(L[0]||L[1]){l.bind();for(var P=0;P<2;++P)if(L[P]&&p[P]<=0&&p[P+2]>=0){var S=c[P]-p[P]*(c[P+2]-c[P])/(p[P+2]-p[P]);0===P?l.drawLine(S,c[1],S,c[3],I[P],M[P]):l.drawLine(c[0],S,c[2],S,I[P],M[P])}}for(P=0;P<_.length;++P)_[P].draw();f.viewport(c[0],c[1],c[2]-c[0],c[3]-c[1]),f.scissor(c[0],c[1],c[2]-c[0],c[3]-c[1]),this.grid.drawTickMarks(),l.bind();var E=this.borderLineEnable,z=this.borderLineWidth,R=this.borderLineColor;for(E[1]&&l.drawLine(h[0],h[1]-.5*z[1]*o,h[0],h[3]+.5*z[3]*o,z[1],R[1]),E[0]&&l.drawLine(h[0]-.5*z[0]*o,h[1],h[2]+.5*z[2]*o,h[1],z[0],R[0]),E[3]&&l.drawLine(h[2],h[1]-.5*z[1]*o,h[2],h[3]+.5*z[3]*o,z[3],R[3]),E[2]&&l.drawLine(h[0]-.5*z[0]*o,h[3],h[2]+.5*z[2]*o,h[3],z[2],R[2]),T.bind(),P=0;P<2;++P)T.drawTicks(P);this.titleEnable&&T.drawTitle();var q=this.overlays;for(P=0;P<q.length;++P)q[P].draw();f.disable(f.SCISSOR_TEST),f.disable(f.BLEND),f.depthMask(!0)}},s.drawPick=function(){if(!this.static){var f=this.pickBuffer;this._pickTimeout=null,f.begin();for(var c=1,h=this.objects,p=0;p<h.length;++p)c=h[p].drawPick(c);f.end()}},s.pick=function(f,c){if(!this.static){var h=this.pixelRatio,p=this.pickPixelRatio,o=this.viewBox,b=0|Math.round((f-o[0]/h)*p),l=0|Math.round((c-o[1]/h)*p),T=this.pickBuffer.query(b,l,this.pickRadius);if(!T)return null;for(var _=T.id+(T.value[0]<<8)+(T.value[1]<<16)+(T.value[2]<<24),w=this.objects,k=0;k<w.length;++k){var L=w[k].pick(b,l,_);if(L)return L}return null}},s.setScreenBox=function(f){var c=this.screenBox,h=this.pixelRatio;c[0]=0|Math.round(f[0]*h),c[1]=0|Math.round(f[1]*h),c[2]=0|Math.round(f[2]*h),c[3]=0|Math.round(f[3]*h),this.setDirty()},s.setDataBox=function(f){var c=this.dataBox;(c[0]!==f[0]||c[1]!==f[1]||c[2]!==f[2]||c[3]!==f[3])&&(c[0]=f[0],c[1]=f[1],c[2]=f[2],c[3]=f[3],this.setDirty())},s.setViewBox=function(f){var c=this.pixelRatio,h=this.viewBox;h[0]=0|Math.round(f[0]*c),h[1]=0|Math.round(f[1]*c),h[2]=0|Math.round(f[2]*c),h[3]=0|Math.round(f[3]*c);var p=this.pickPixelRatio;this.pickBuffer.shape=[0|Math.round((f[2]-f[0])*p),0|Math.round((f[3]-f[1])*p)],this.setDirty()},s.update=function(f){var c=this.gl;this.pixelRatio=(f=f||{}).pixelRatio||1;var h=this.pixelRatio;this.pickPixelRatio=Math.max(h,1),this.setScreenBox(f.screenBox||[0,0,c.drawingBufferWidth/h,c.drawingBufferHeight/h]),this.setViewBox(f.viewBox||[.125*(this.screenBox[2]-this.screenBox[0])/h,.125*(this.screenBox[3]-this.screenBox[1])/h,.875*(this.screenBox[2]-this.screenBox[0])/h,.875*(this.screenBox[3]-this.screenBox[1])/h]);var p=this.viewBox,o=(p[2]-p[0])/(p[3]-p[1]);this.setDataBox(f.dataBox||[-10,-10/o,10,10/o]),this.borderColor=!1!==f.borderColor&&(f.borderColor||[0,0,0,0]).slice(),this.backgroundColor=(f.backgroundColor||[0,0,0,0]).slice(),this.gridLineEnable=(f.gridLineEnable||[!0,!0]).slice(),this.gridLineWidth=(f.gridLineWidth||[1,1]).slice(),this.gridLineColor=i(f.gridLineColor||[[.5,.5,.5,1],[.5,.5,.5,1]]),this.zeroLineEnable=(f.zeroLineEnable||[!0,!0]).slice(),this.zeroLineWidth=(f.zeroLineWidth||[4,4]).slice(),this.zeroLineColor=i(f.zeroLineColor||[[0,0,0,1],[0,0,0,1]]),this.tickMarkLength=(f.tickMarkLength||[0,0,0,0]).slice(),this.tickMarkWidth=(f.tickMarkWidth||[0,0,0,0]).slice(),this.tickMarkColor=i(f.tickMarkColor||[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]]),this.titleCenter=(f.titleCenter||[.5*(p[0]+p[2])/h,(p[3]+120)/h]).slice(),this.titleEnable=!("titleEnable"in f)||!!f.titleEnable,this.titleAngle=f.titleAngle||0,this.titleColor=(f.titleColor||[0,0,0,1]).slice(),this.labelPad=(f.labelPad||[15,15,15,15]).slice(),this.labelAngle=(f.labelAngle||[0,Math.PI/2,0,3*Math.PI/2]).slice(),this.labelEnable=(f.labelEnable||[!0,!0,!0,!0]).slice(),this.labelColor=i(f.labelColor||[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]]),this.tickPad=(f.tickPad||[15,15,15,15]).slice(),this.tickAngle=(f.tickAngle||[0,0,0,0]).slice(),this.tickEnable=(f.tickEnable||[!0,!0,!0,!0]).slice(),this.tickColor=i(f.tickColor||[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]]),this.borderLineEnable=(f.borderLineEnable||[!0,!0,!0,!0]).slice(),this.borderLineWidth=(f.borderLineWidth||[2,2,2,2]).slice(),this.borderLineColor=i(f.borderLineColor||[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]]);var b=f.ticks||[[],[]],l=this._tickBounds;l[0]=l[1]=1/0,l[2]=l[3]=-1/0;for(var T=0;T<2;++T){var _=b[T].slice(0);0!==_.length&&(_.sort(u),l[T]=Math.min(l[T],_[0].x),l[T+2]=Math.max(l[T+2],_[_.length-1].x))}this.grid.update({bounds:l,ticks:b}),this.text.update({bounds:l,ticks:b,labels:f.labels||["x","y"],labelSize:f.labelSize||[12,12],labelFont:f.labelFont||["sans-serif","sans-serif"],title:f.title||"",titleSize:f.titleSize||18,titleFont:f.titleFont||"sans-serif"}),this.static=!!f.static,this.setDirty()},s.dispose=function(){this.box.dispose(),this.grid.dispose(),this.text.dispose(),this.line.dispose();for(var f=this.objects.length-1;f>=0;--f)this.objects[f].dispose();for(this.objects.length=0,f=this.overlays.length-1;f>=0;--f)this.overlays[f].dispose();this.overlays.length=0,this.gl=null},s.addObject=function(f){this.objects.indexOf(f)<0&&(this.objects.push(f),this.setDirty())},s.removeObject=function(f){for(var c=this.objects,h=0;h<c.length;++h)if(c[h]===f){c.splice(h,1),this.setDirty();break}},s.addOverlay=function(f){this.overlays.indexOf(f)<0&&(this.overlays.push(f),this.setOverlayDirty())},s.removeOverlay=function(f){for(var c=this.overlays,h=0;h<c.length;++h)if(c[h]===f){c.splice(h,1),this.setOverlayDirty();break}}},{"./lib/box":113,"./lib/grid":114,"./lib/line":115,"./lib/text":117,"gl-select-static":131}],119:[function(v,m,x){"use strict";m.exports=function(s,i){s=s||document.body;var u=[.01,1/0];"distanceLimits"in(i=i||{})&&(u[0]=i.distanceLimits[0],u[1]=i.distanceLimits[1]),"zoomMin"in i&&(u[0]=i.zoomMin),"zoomMax"in i&&(u[1]=i.zoomMax);var f=n({center:i.center||[0,0,0],up:i.up||[0,1,0],eye:i.eye||[0,0,10],mode:i.mode||"orbit",distanceLimits:u}),c=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],h=0,p=s.clientWidth,o=s.clientHeight,b={keyBindingMode:"rotate",enableWheel:!0,view:f,element:s,delay:i.delay||16,rotateSpeed:i.rotateSpeed||1,zoomSpeed:i.zoomSpeed||1,translateSpeed:i.translateSpeed||1,flipX:!!i.flipX,flipY:!!i.flipY,modes:f.modes,_ortho:i._ortho||i.projection&&"orthographic"===i.projection.type||!1,tick:function(){var l=e(),T=this.delay,_=l-2*T;f.idle(l-T),f.recalcMatrix(_),f.flush(l-(100+2*T));for(var w=!0,k=f.computedMatrix,L=0;L<16;++L)w=w&&c[L]===k[L],c[L]=k[L];var M=s.clientWidth===p&&s.clientHeight===o;return p=s.clientWidth,o=s.clientHeight,w?!M:(h=Math.exp(f.computedRadius[0]),!0)},lookAt:function(l,T,_){f.lookAt(f.lastT(),l,T,_)},rotate:function(l,T,_){f.rotate(f.lastT(),l,T,_)},pan:function(l,T,_){f.pan(f.lastT(),l,T,_)},translate:function(l,T,_){f.translate(f.lastT(),l,T,_)}};return Object.defineProperties(b,{matrix:{get:function(){return f.computedMatrix},set:function(l){return f.setMatrix(f.lastT(),l),f.computedMatrix},enumerable:!0},mode:{get:function(){return f.getMode()},set:function(l){var T=f.computedUp.slice(),_=f.computedEye.slice(),w=f.computedCenter.slice();if(f.setMode(l),"turntable"===l){var k=e();f._active.lookAt(k,_,w,T),f._active.lookAt(k+500,_,w,[0,0,1]),f._active.flush(k)}return f.getMode()},enumerable:!0},center:{get:function(){return f.computedCenter},set:function(l){return f.lookAt(f.lastT(),null,l),f.computedCenter},enumerable:!0},eye:{get:function(){return f.computedEye},set:function(l){return f.lookAt(f.lastT(),l),f.computedEye},enumerable:!0},up:{get:function(){return f.computedUp},set:function(l){return f.lookAt(f.lastT(),null,null,l),f.computedUp},enumerable:!0},distance:{get:function(){return h},set:function(l){return f.setDistance(f.lastT(),l),l},enumerable:!0},distanceLimits:{get:function(){return f.getDistanceLimits(u)},set:function(l){return f.setDistanceLimits(l),l},enumerable:!0}}),s.addEventListener("contextmenu",function(l){return l.preventDefault(),!1}),b._lastX=-1,b._lastY=-1,b._lastMods={shift:!1,control:!1,alt:!1,meta:!1},b.enableMouseListeners=function(){function l(T,_,w,k){var L=b.keyBindingMode;if(!1!==L){var M="rotate"===L,I="pan"===L,P="zoom"===L,S=!!k.control,E=!!k.alt,z=!!k.shift,R=!!(1&T),q=!!(2&T),V=!!(4&T),W=1/s.clientHeight,K=W*(_-b._lastX),G=W*(w-b._lastY),Y=b.flipX?1:-1,$=b.flipY?1:-1,B=Math.PI*b.rotateSpeed,N=e();if(-1!==b._lastX&&-1!==b._lastY&&((M&&R&&!S&&!E&&!z||R&&!S&&!E&&z)&&f.rotate(N,Y*B*K,-$*B*G,0),(I&&R&&!S&&!E&&!z||q||R&&S&&!E&&!z)&&f.pan(N,-b.translateSpeed*K*h,b.translateSpeed*G*h,0),P&&R&&!S&&!E&&!z||V||R&&!S&&E&&!z)){var U=-b.zoomSpeed*G/window.innerHeight*(N-f.lastT())*100;f.pan(N,0,0,h*(Math.exp(U)-1))}return b._lastX=_,b._lastY=w,b._lastMods=k,!0}}b.mouseListener=t(s,l),s.addEventListener("touchstart",function(T){var _=r(T.changedTouches[0],s);l(0,_[0],_[1],b._lastMods),l(1,_[0],_[1],b._lastMods)},!!d&&{passive:!0}),s.addEventListener("touchmove",function(T){var _=r(T.changedTouches[0],s);l(1,_[0],_[1],b._lastMods),T.preventDefault()},!!d&&{passive:!1}),s.addEventListener("touchend",function(T){l(0,b._lastX,b._lastY,b._lastMods)},!!d&&{passive:!0}),b.wheelListener=a(s,function(T,_){if(!1!==b.keyBindingMode&&b.enableWheel){var w=b.flipX?1:-1,k=b.flipY?1:-1,L=e();if(Math.abs(T)>Math.abs(_))f.rotate(L,0,0,-T*w*Math.PI*b.rotateSpeed/window.innerWidth);else if(!b._ortho){var M=-b.zoomSpeed*k*_/window.innerHeight*(L-f.lastT())/20;f.pan(L,0,0,h*(Math.exp(M)-1))}}},!0)},b.enableMouseListeners(),b};var e=v("right-now"),n=v("3d-view"),t=v("mouse-change"),a=v("mouse-wheel"),r=v("mouse-event-offset"),d=v("has-passive-events")},{"3d-view":7,"has-passive-events":232,"mouse-change":247,"mouse-event-offset":248,"mouse-wheel":250,"right-now":278}],120:[function(v,m,x){var e=v("glslify"),n=v("gl-shader"),t=e(["precision mediump float;\n#define GLSLIFY 1\nattribute vec2 position;\nvarying vec2 uv;\nvoid main() {\n  uv = position;\n  gl_Position = vec4(position, 0, 1);\n}"]),a=e(["precision mediump float;\n#define GLSLIFY 1\n\nuniform sampler2D accumBuffer;\nvarying vec2 uv;\n\nvoid main() {\n  vec4 accum = texture2D(accumBuffer, 0.5 * (uv + 1.0));\n  gl_FragColor = min(vec4(1,1,1,1), accum);\n}"]);m.exports=function(r){return n(r,t,a,null,[{name:"position",type:"vec2"}])}},{"gl-shader":132,glslify:231}],121:[function(v,m,x){"use strict";var e=v("./camera.js"),n=v("gl-axes3d"),t=v("gl-axes3d/properties"),a=v("gl-spikes3d"),r=v("gl-select-static"),d=v("gl-fbo"),s=v("a-big-triangle"),i=v("mouse-change"),u=v("gl-mat4/perspective"),f=v("gl-mat4/ortho"),c=v("./lib/shader"),h=v("is-mobile")({tablet:!0,featureDetect:!0});function p(){this.mouse=[-1,-1],this.screen=null,this.distance=1/0,this.index=null,this.dataCoordinate=null,this.dataPosition=null,this.object=null,this.data=null}function o(l){var T=Math.round(Math.log(Math.abs(l))/Math.log(10));if(T<0){var _=Math.round(Math.pow(10,-T));return Math.ceil(l*_)/_}return T>0?(_=Math.round(Math.pow(10,T)),Math.ceil(l/_)*_):Math.ceil(l)}function b(l){return"boolean"!=typeof l||l}m.exports={createScene:function(l){(l=l||{}).camera=l.camera||{};var T=l.canvas;T||(T=document.createElement("canvas"),l.container?l.container.appendChild(T):document.body.appendChild(T));var _=l.gl;if(_||(l.glOptions&&(h=!!l.glOptions.preserveDrawingBuffer),_=function(se,ge){var _e=null;try{(_e=se.getContext("webgl",ge))||(_e=se.getContext("experimental-webgl",ge))}catch{return null}return _e}(T,l.glOptions||{premultipliedAlpha:!0,antialias:!0,preserveDrawingBuffer:h})),!_)throw new Error("webgl not supported");var w=l.bounds||[[-10,-10,-10],[10,10,10]],k=new p,L=d(_,_.drawingBufferWidth,_.drawingBufferHeight,{preferFloat:!h}),M=c(_),I=l.cameraObject&&!0===l.cameraObject._ortho||l.camera.projection&&"orthographic"===l.camera.projection.type||!1,P={eye:l.camera.eye||[2,0,0],center:l.camera.center||[0,0,0],up:l.camera.up||[0,1,0],zoomMin:l.camera.zoomMax||.1,zoomMax:l.camera.zoomMin||100,mode:l.camera.mode||"turntable",_ortho:I},S=l.axes||{},E=n(_,S);E.enable=!S.disable;var R=a(_,l.spikes||{}),q=[],V=[],W=[],K=[],G=!0,Y=!0,N={view:null,projection:new Array(16),model:new Array(16),_ortho:!1},U=(Y=!0,[_.drawingBufferWidth,_.drawingBufferHeight]),te=l.cameraObject||e(T,P),j={gl:_,contextLost:!1,pixelRatio:l.pixelRatio||1,canvas:T,selection:k,camera:te,axes:E,axesPixels:null,spikes:R,bounds:w,objects:q,shape:U,aspect:l.aspectRatio||[1,1,1],pickRadius:l.pickRadius||10,zNear:l.zNear||.01,zFar:l.zFar||1e3,fovy:l.fovy||Math.PI/4,clearColor:l.clearColor||[0,0,0,0],autoResize:b(l.autoResize),autoBounds:b(l.autoBounds),autoScale:!!l.autoScale,autoCenter:b(l.autoCenter),clipToBounds:b(l.clipToBounds),snapToData:!!l.snapToData,onselect:l.onselect||null,onrender:l.onrender||null,onclick:l.onclick||null,cameraParams:N,oncontextloss:null,mouseListener:null,_stopped:!1,getAspectratio:function(){return{x:this.aspect[0],y:this.aspect[1],z:this.aspect[2]}},setAspectratio:function(se){this.aspect[0]=se.x,this.aspect[1]=se.y,this.aspect[2]=se.z,Y=!0},setBounds:function(se,ge){this.bounds[0][se]=ge.min,this.bounds[1][se]=ge.max},setClearColor:function(se){this.clearColor=se},clearRGBA:function(){this.gl.clearColor(this.clearColor[0],this.clearColor[1],this.clearColor[2],this.clearColor[3]),this.gl.clear(this.gl.COLOR_BUFFER_BIT|this.gl.DEPTH_BUFFER_BIT)}},J=[_.drawingBufferWidth/j.pixelRatio|0,_.drawingBufferHeight/j.pixelRatio|0];function X(){if(!j._stopped&&j.autoResize){var se=T.parentNode,ge=1,_e=1;se&&se!==document.body?(ge=se.clientWidth,_e=se.clientHeight):(ge=window.innerWidth,_e=window.innerHeight);var Te=0|Math.ceil(ge*j.pixelRatio),we=0|Math.ceil(_e*j.pixelRatio);if(Te!==T.width||we!==T.height){T.width=Te,T.height=we;var Oe=T.style;Oe.position=Oe.position||"absolute",Oe.left="0px",Oe.top="0px",Oe.width=ge+"px",Oe.height=_e+"px",G=!0}}}function re(){for(var se=q.length,ge=K.length,_e=0;_e<ge;++_e)W[_e]=0;e:for(_e=0;_e<se;++_e){var Te=q[_e],we=Te.pickSlots;if(we){for(var Oe=0;Oe<ge;++Oe)if(W[Oe]+we<255){V[_e]=Oe,Te.setPickBase(W[Oe]+1),W[Oe]+=we;continue e}var fe=r(_,U);V[_e]=ge,K.push(fe),W.push(we),Te.setPickBase(1),ge+=1}else V[_e]=-1}for(;ge>0&&0===W[ge-1];)W.pop(),K.pop().dispose()}function ne(){if(j.contextLost)return!0;_.isContextLost()&&(j.contextLost=!0,j.mouseListener.enabled=!1,j.selection.object=null,j.oncontextloss&&j.oncontextloss())}j.autoResize&&X(),window.addEventListener("resize",X),j.update=function(se){j._stopped||(se=se||{},G=!0,Y=!0)},j.add=function(se){j._stopped||(se.axes=E,q.push(se),V.push(-1),G=!0,Y=!0,re())},j.remove=function(se){if(!j._stopped){var ge=q.indexOf(se);ge<0||(q.splice(ge,1),V.pop(),G=!0,Y=!0,re())}},j.dispose=function(){if(!j._stopped&&(j._stopped=!0,window.removeEventListener("resize",X),T.removeEventListener("webglcontextlost",ne),j.mouseListener.enabled=!1,!j.contextLost)){E.dispose(),R.dispose();for(var se=0;se<q.length;++se)q[se].dispose();for(L.dispose(),se=0;se<K.length;++se)K[se].dispose();M.dispose(),_=null,E=null,R=null,q=[]}},j._mouseRotating=!1,j._prevButtons=0,j.enableMouseListeners=function(){j.mouseListener=i(T,function(se,ge,_e){if(!j._stopped){var Te=K.length,we=q.length,Oe=k.object;k.distance=1/0,k.mouse[0]=ge,k.mouse[1]=_e,k.object=null,k.screen=null,k.dataCoordinate=k.dataPosition=null;var fe=!1;if(se&&j._prevButtons)j._mouseRotating=!0;else{j._mouseRotating&&(Y=!0),j._mouseRotating=!1;for(var ve=0;ve<Te;++ve){var Ae=K[ve].query(ge,J[1]-_e-1,j.pickRadius);if(Ae){if(Ae.distance>k.distance)continue;for(var ke=0;ke<we;++ke){var Pe=q[ke];if(V[ke]===ve){var Ne=Pe.pick(Ae);Ne&&(k.buttons=se,k.screen=Ae.coord,k.distance=Ae.distance,k.object=Pe,k.index=Ne.distance,k.dataPosition=Ne.position,k.dataCoordinate=Ne.dataCoordinate,k.data=Ne,fe=!0)}}}}}Oe&&Oe!==k.object&&(Oe.highlight&&Oe.highlight(null),G=!0),k.object&&(k.object.highlight&&k.object.highlight(k.data),G=!0),(fe=fe||k.object!==Oe)&&j.onselect&&j.onselect(k),1&se&&!(1&j._prevButtons)&&j.onclick&&j.onclick(k),j._prevButtons=se}})},T.addEventListener("webglcontextlost",ne);var le=[[1/0,1/0,1/0],[-1/0,-1/0,-1/0]],oe=[le[0].slice(),le[1].slice()];function de(){if(!ne()){X();var se=j.camera.tick();N.view=j.camera.matrix,G=G||se,Y=Y||se,E.pixelRatio=j.pixelRatio,R.pixelRatio=j.pixelRatio;var ge=q.length,_e=le[0],Te=le[1];_e[0]=_e[1]=_e[2]=1/0,Te[0]=Te[1]=Te[2]=-1/0;for(var we=0;we<ge;++we){(Ie=q[we]).pixelRatio=j.pixelRatio,Ie.axes=j.axes,G=G||!!Ie.dirty,Y=Y||!!Ie.dirty;var Oe=Ie.bounds;if(Oe)for(var fe=Oe[0],ve=Oe[1],Ae=0;Ae<3;++Ae)_e[Ae]=Math.min(_e[Ae],fe[Ae]),Te[Ae]=Math.max(Te[Ae],ve[Ae])}var ke=j.bounds;if(j.autoBounds)for(Ae=0;Ae<3;++Ae){if(Te[Ae]<_e[Ae])_e[Ae]=-1,Te[Ae]=1;else{_e[Ae]===Te[Ae]&&(_e[Ae]-=1,Te[Ae]+=1);var Pe=.05*(Te[Ae]-_e[Ae]);_e[Ae]=_e[Ae]-Pe,Te[Ae]=Te[Ae]+Pe}ke[0][Ae]=_e[Ae],ke[1][Ae]=Te[Ae]}var Ne=!1;for(Ae=0;Ae<3;++Ae)Ne=Ne||oe[0][Ae]!==ke[0][Ae]||oe[1][Ae]!==ke[1][Ae],oe[0][Ae]=ke[0][Ae],oe[1][Ae]=ke[1][Ae];if(Y=Y||Ne,G=G||Ne){if(Ne){var De=[0,0,0];for(we=0;we<3;++we)De[we]=o((ke[1][we]-ke[0][we])/10);E.update(E.autoTicks?{bounds:ke,tickSpacing:De}:{bounds:ke})}var ze=_.drawingBufferWidth,Me=_.drawingBufferHeight;for(U[0]=ze,U[1]=Me,J[0]=0|Math.max(ze/j.pixelRatio,1),J[1]=0|Math.max(Me/j.pixelRatio,1),function(Fe,Re){var Xe=Fe.bounds,nt=Fe.cameraParams,ct=nt.projection,xt=nt.model,Ke=Fe.zNear,mt=Fe.zFar,Bt=Fe.fovy,Ut=Fe.gl.drawingBufferWidth/Fe.gl.drawingBufferHeight;Re?(f(ct,-Ut,Ut,-1,1,Ke,mt),nt._ortho=!0):(u(ct,Bt,Ut,Ke,mt),nt._ortho=!1);for(var er=0;er<16;++er)xt[er]=0;xt[15]=1;var Wt=0;for(er=0;er<3;++er)Wt=Math.max(Wt,Xe[1][er]-Xe[0][er]);for(er=0;er<3;++er)xt[5*er]=Fe.autoScale?Fe.aspect[er]/(Xe[1][er]-Xe[0][er]):1/Wt,Fe.autoCenter&&(xt[12+er]=.5*-xt[5*er]*(Xe[0][er]+Xe[1][er]))}(j,I),we=0;we<ge;++we)(Ie=q[we]).axesBounds=ke,j.clipToBounds&&(Ie.clipBounds=ke);k.object&&(R.position=j.snapToData?k.dataCoordinate:k.dataPosition,R.bounds=ke),Y&&(Y=!1,function(){if(!ne()){_.colorMask(!0,!0,!0,!0),_.depthMask(!0),_.disable(_.BLEND),_.enable(_.DEPTH_TEST),_.depthFunc(_.LEQUAL);for(var Fe=q.length,Re=K.length,Xe=0;Xe<Re;++Xe){var nt=K[Xe];nt.shape=J,nt.begin();for(var ct=0;ct<Fe;++ct)if(V[ct]===Xe){var xt=q[ct];xt.drawPick&&(xt.pixelRatio=1,xt.drawPick(N))}nt.end()}}}()),j.axesPixels=t(j.axes,N,ze,Me),j.onrender&&j.onrender(),_.bindFramebuffer(_.FRAMEBUFFER,null),_.viewport(0,0,ze,Me),j.clearRGBA(),_.depthMask(!0),_.colorMask(!0,!0,!0,!0),_.enable(_.DEPTH_TEST),_.depthFunc(_.LEQUAL),_.disable(_.BLEND),_.disable(_.CULL_FACE);var Se=!1;for(E.enable&&(Se=Se||E.isTransparent(),E.draw(N)),R.axes=E,k.object&&R.draw(N),_.disable(_.CULL_FACE),we=0;we<ge;++we)(Ie=q[we]).axes=E,Ie.pixelRatio=j.pixelRatio,Ie.isOpaque&&Ie.isOpaque()&&Ie.draw(N),Ie.isTransparent&&Ie.isTransparent()&&(Se=!0);if(Se){for(L.shape=U,L.bind(),_.clear(_.DEPTH_BUFFER_BIT),_.colorMask(!1,!1,!1,!1),_.depthMask(!0),_.depthFunc(_.LESS),E.enable&&E.isTransparent()&&E.drawTransparent(N),we=0;we<ge;++we)(Ie=q[we]).isOpaque&&Ie.isOpaque()&&Ie.draw(N);for(_.enable(_.BLEND),_.blendEquation(_.FUNC_ADD),_.blendFunc(_.ONE,_.ONE_MINUS_SRC_ALPHA),_.colorMask(!0,!0,!0,!0),_.depthMask(!1),_.clearColor(0,0,0,0),_.clear(_.COLOR_BUFFER_BIT),E.isTransparent()&&E.drawTransparent(N),we=0;we<ge;++we){var Ie;(Ie=q[we]).isTransparent&&Ie.isTransparent()&&Ie.drawTransparent(N)}_.bindFramebuffer(_.FRAMEBUFFER,null),_.blendFunc(_.ONE,_.ONE_MINUS_SRC_ALPHA),_.disable(_.DEPTH_TEST),M.bind(),L.color[0].bind(0),M.uniforms.accumBuffer=0,s(_),_.disable(_.BLEND)}for(G=!1,we=0;we<ge;++we)q[we].dirty=!1}}}return j.enableMouseListeners(),function se(){j._stopped||j.contextLost||(de(),requestAnimationFrame(se))}(),j.redraw=function(){j._stopped||(G=!0,de())},j},createCamera:e}},{"./camera.js":119,"./lib/shader":120,"a-big-triangle":8,"gl-axes3d":70,"gl-axes3d/properties":77,"gl-fbo":86,"gl-mat4/ortho":101,"gl-mat4/perspective":102,"gl-select-static":131,"gl-spikes3d":141,"is-mobile":238,"mouse-change":247}],122:[function(v,m,x){var e=v("glslify");x.pointVertex=e(["precision mediump float;\n#define GLSLIFY 1\n\nattribute vec2 position;\n\nuniform mat3 matrix;\nuniform float pointSize;\nuniform float pointCloud;\n\nhighp float rand(vec2 co) {\n  highp float a = 12.9898;\n  highp float b = 78.233;\n  highp float c = 43758.5453;\n  highp float d = dot(co.xy, vec2(a, b));\n  highp float e = mod(d, 3.14);\n  return fract(sin(e) * c);\n}\n\nvoid main() {\n  vec3 hgPosition = matrix * vec3(position, 1);\n  gl_Position  = vec4(hgPosition.xy, 0, hgPosition.z);\n    // if we don't jitter the point size a bit, overall point cloud\n    // saturation 'jumps' on zooming, which is disturbing and confusing\n  gl_PointSize = pointSize * ((19.5 + rand(position)) / 20.0);\n  if(pointCloud != 0.0) { // pointCloud is truthy\n    // get the same square surface as circle would be\n    gl_PointSize *= 0.886;\n  }\n}"]),x.pointFragment=e(["precision mediump float;\n#define GLSLIFY 1\n\nuniform vec4 color, borderColor;\nuniform float centerFraction;\nuniform float pointCloud;\n\nvoid main() {\n  float radius;\n  vec4 baseColor;\n  if(pointCloud != 0.0) { // pointCloud is truthy\n    if(centerFraction == 1.0) {\n      gl_FragColor = color;\n    } else {\n      gl_FragColor = mix(borderColor, color, centerFraction);\n    }\n  } else {\n    radius = length(2.0 * gl_PointCoord.xy - 1.0);\n    if(radius > 1.0) {\n      discard;\n    }\n    baseColor = mix(borderColor, color, step(radius, centerFraction));\n    gl_FragColor = vec4(baseColor.rgb * baseColor.a, baseColor.a);\n  }\n}\n"]),x.pickVertex=e(["precision mediump float;\n#define GLSLIFY 1\n\nattribute vec2 position;\nattribute vec4 pickId;\n\nuniform mat3 matrix;\nuniform float pointSize;\nuniform vec4 pickOffset;\n\nvarying vec4 fragId;\n\nvoid main() {\n  vec3 hgPosition = matrix * vec3(position, 1);\n  gl_Position  = vec4(hgPosition.xy, 0, hgPosition.z);\n  gl_PointSize = pointSize;\n\n  vec4 id = pickId + pickOffset;\n  id.y += floor(id.x / 256.0);\n  id.x -= floor(id.x / 256.0) * 256.0;\n\n  id.z += floor(id.y / 256.0);\n  id.y -= floor(id.y / 256.0) * 256.0;\n\n  id.w += floor(id.z / 256.0);\n  id.z -= floor(id.z / 256.0) * 256.0;\n\n  fragId = id;\n}\n"]),x.pickFragment=e(["precision mediump float;\n#define GLSLIFY 1\n\nvarying vec4 fragId;\n\nvoid main() {\n  float radius = length(2.0 * gl_PointCoord.xy - 1.0);\n  if(radius > 1.0) {\n    discard;\n  }\n  gl_FragColor = fragId / 255.0;\n}\n"])},{glslify:231}],123:[function(v,m,x){"use strict";var e=v("gl-shader"),n=v("gl-buffer"),t=v("typedarray-pool"),a=v("./lib/shader");function r(u,f,c,h,p){this.plot=u,this.offsetBuffer=f,this.pickBuffer=c,this.shader=h,this.pickShader=p,this.sizeMin=.5,this.sizeMinCap=2,this.sizeMax=20,this.areaRatio=1,this.pointCount=0,this.color=[1,0,0,1],this.borderColor=[0,0,0,1],this.blend=!1,this.pickOffset=0,this.points=null}m.exports=function(u,f){var c=u.gl,l=new r(u,n(c),n(c),e(c,a.pointVertex,a.pointFragment),e(c,a.pickVertex,a.pickFragment));return l.update(f),u.addObject(l),l};var d,s,i=r.prototype;i.dispose=function(){this.shader.dispose(),this.pickShader.dispose(),this.offsetBuffer.dispose(),this.pickBuffer.dispose(),this.plot.removeObject(this)},i.update=function(u){var f;function c(_,w){return _ in u?u[_]:w}u=u||{},this.sizeMin=c("sizeMin",.5),this.sizeMax=c("sizeMax",20),this.color=c("color",[1,0,0,1]).slice(),this.areaRatio=c("areaRatio",1),this.borderColor=c("borderColor",[0,0,0,1]).slice(),this.blend=c("blend",!1);var h=u.positions.length>>>1,p=u.positions instanceof Float32Array,o=u.idToIndex instanceof Int32Array&&u.idToIndex.length>=h,b=u.positions,l=p?b:t.mallocFloat32(b.length),T=o?u.idToIndex:t.mallocInt32(h);if(p||l.set(b),!o)for(l.set(b),f=0;f<h;f++)T[f]=f;this.points=b,this.offsetBuffer.update(l),this.pickBuffer.update(T),p||t.free(l),o||t.free(T),this.pointCount=h,this.pickOffset=0},i.unifiedDraw=(d=[1,0,0,0,1,0,0,0,1],s=[0,0,0,0],function(u){var f=void 0!==u,c=f?this.pickShader:this.shader,h=this.plot.gl,p=this.plot.dataBox;if(0===this.pointCount)return u;var o=p[2]-p[0],b=p[3]-p[1],l=function(k,L){var M,I=0,P=k.length>>>1;for(M=0;M<P;M++){var S=k[2*M],E=k[2*M+1];S>=L[0]&&S<=L[2]&&E>=L[1]&&E<=L[3]&&I++}return I}(this.points,p),T=this.plot.pickPixelRatio*Math.max(Math.min(this.sizeMinCap,this.sizeMin),Math.min(this.sizeMax,this.sizeMax/Math.pow(l,.33333)));d[0]=2/o,d[4]=2/b,d[6]=-2*p[0]/o-1,d[7]=-2*p[1]/b-1,this.offsetBuffer.bind(),c.bind(),c.attributes.position.pointer(),c.uniforms.matrix=d,c.uniforms.color=this.color,c.uniforms.borderColor=this.borderColor,c.uniforms.pointCloud=T<5,c.uniforms.pointSize=T,c.uniforms.centerFraction=Math.min(1,Math.max(0,Math.sqrt(1-this.areaRatio))),f&&(s[0]=255&u,s[1]=u>>8&255,s[2]=u>>16&255,s[3]=u>>24&255,this.pickBuffer.bind(),c.attributes.pickId.pointer(h.UNSIGNED_BYTE),c.uniforms.pickOffset=s,this.pickOffset=u);var _=h.getParameter(h.BLEND),w=h.getParameter(h.DITHER);return _&&!this.blend&&h.disable(h.BLEND),w&&h.disable(h.DITHER),h.drawArrays(h.POINTS,0,this.pointCount),_&&!this.blend&&h.enable(h.BLEND),w&&h.enable(h.DITHER),u+this.pointCount}),i.draw=i.unifiedDraw,i.drawPick=i.unifiedDraw,i.pick=function(u,f,c){var h=this.pickOffset;if(c<h||c>=h+this.pointCount)return null;var o=c-h,b=this.points;return{object:this,pointId:o,dataCoord:[b[2*o],b[2*o+1]]}}},{"./lib/shader":122,"gl-buffer":78,"gl-shader":132,"typedarray-pool":308}],124:[function(v,m,x){m.exports=function(e,n,t,a){var r,d,s,i,u,f=n[0],c=n[1],h=n[2],p=n[3],o=t[0],b=t[1],l=t[2],T=t[3];return(d=f*o+c*b+h*l+p*T)<0&&(d=-d,o=-o,b=-b,l=-l,T=-T),1-d>1e-6?(r=Math.acos(d),s=Math.sin(r),i=Math.sin((1-a)*r)/s,u=Math.sin(a*r)/s):(i=1-a,u=a),e[0]=i*f+u*o,e[1]=i*c+u*b,e[2]=i*h+u*l,e[3]=i*p+u*T,e}},{}],125:[function(v,m,x){"use strict";m.exports=function(e){return e||0===e?e.toString():""}},{}],126:[function(v,m,x){"use strict";var e=v("vectorize-text");m.exports=function(t,a,r){var d=n[a];if(d||(d=n[a]={}),t in d)return d[t];var s={textAlign:"center",textBaseline:"middle",lineHeight:1,font:a,lineSpacing:1.25,styletags:{breaklines:!0,bolds:!0,italics:!0,subscripts:!0,superscripts:!0},triangles:!0},i=e(t,s);s.triangles=!1;var u,f,c=e(t,s);if(r&&1!==r){for(u=0;u<i.positions.length;++u)for(f=0;f<i.positions[u].length;++f)i.positions[u][f]/=r;for(u=0;u<c.positions.length;++u)for(f=0;f<c.positions[u].length;++f)c.positions[u][f]/=r}var h=[[1/0,1/0],[-1/0,-1/0]],p=c.positions.length;for(u=0;u<p;++u){var o=c.positions[u];for(f=0;f<2;++f)h[0][f]=Math.min(h[0][f],o[f]),h[1][f]=Math.max(h[1][f],o[f])}return d[t]=[i,c,h]};var n={}},{"vectorize-text":311}],127:[function(v,m,x){var e=v("gl-shader"),n=v("glslify"),t=n(["precision highp float;\n#define GLSLIFY 1\n\nbool outOfRange(float a, float b, float p) {\n  return ((p > max(a, b)) || \n          (p < min(a, b)));\n}\n\nbool outOfRange(vec2 a, vec2 b, vec2 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y));\n}\n\nbool outOfRange(vec3 a, vec3 b, vec3 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y) ||\n          outOfRange(a.z, b.z, p.z));\n}\n\nbool outOfRange(vec4 a, vec4 b, vec4 p) {\n  return outOfRange(a.xyz, b.xyz, p.xyz);\n}\n\nattribute vec3 position;\nattribute vec4 color;\nattribute vec2 glyph;\nattribute vec4 id;\n\nuniform vec4 highlightId;\nuniform float highlightScale;\nuniform mat4 model, view, projection;\nuniform vec3 clipBounds[2];\n\nvarying vec4 interpColor;\nvarying vec4 pickId;\nvarying vec3 dataCoordinate;\n\nvoid main() {\n  if (outOfRange(clipBounds[0], clipBounds[1], position)) {\n\n    gl_Position = vec4(0,0,0,0);\n  } else {\n    float scale = 1.0;\n    if(distance(highlightId, id) < 0.0001) {\n      scale = highlightScale;\n    }\n\n    vec4 worldPosition = model * vec4(position, 1);\n    vec4 viewPosition = view * worldPosition;\n    viewPosition = viewPosition / viewPosition.w;\n    vec4 clipPosition = projection * (viewPosition + scale * vec4(glyph.x, -glyph.y, 0, 0));\n\n    gl_Position = clipPosition;\n    interpColor = color;\n    pickId = id;\n    dataCoordinate = position;\n  }\n}"]),a=n(["precision highp float;\n#define GLSLIFY 1\n\nbool outOfRange(float a, float b, float p) {\n  return ((p > max(a, b)) || \n          (p < min(a, b)));\n}\n\nbool outOfRange(vec2 a, vec2 b, vec2 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y));\n}\n\nbool outOfRange(vec3 a, vec3 b, vec3 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y) ||\n          outOfRange(a.z, b.z, p.z));\n}\n\nbool outOfRange(vec4 a, vec4 b, vec4 p) {\n  return outOfRange(a.xyz, b.xyz, p.xyz);\n}\n\nattribute vec3 position;\nattribute vec4 color;\nattribute vec2 glyph;\nattribute vec4 id;\n\nuniform mat4 model, view, projection;\nuniform vec2 screenSize;\nuniform vec3 clipBounds[2];\nuniform float highlightScale, pixelRatio;\nuniform vec4 highlightId;\n\nvarying vec4 interpColor;\nvarying vec4 pickId;\nvarying vec3 dataCoordinate;\n\nvoid main() {\n  if (outOfRange(clipBounds[0], clipBounds[1], position)) {\n\n    gl_Position = vec4(0,0,0,0);\n  } else {\n    float scale = pixelRatio;\n    if(distance(highlightId.bgr, id.bgr) < 0.001) {\n      scale *= highlightScale;\n    }\n\n    vec4 worldPosition = model * vec4(position, 1.0);\n    vec4 viewPosition = view * worldPosition;\n    vec4 clipPosition = projection * viewPosition;\n    clipPosition /= clipPosition.w;\n\n    gl_Position = clipPosition + vec4(screenSize * scale * vec2(glyph.x, -glyph.y), 0.0, 0.0);\n    interpColor = color;\n    pickId = id;\n    dataCoordinate = position;\n  }\n}"]),r=n(["precision highp float;\n#define GLSLIFY 1\n\nbool outOfRange(float a, float b, float p) {\n  return ((p > max(a, b)) || \n          (p < min(a, b)));\n}\n\nbool outOfRange(vec2 a, vec2 b, vec2 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y));\n}\n\nbool outOfRange(vec3 a, vec3 b, vec3 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y) ||\n          outOfRange(a.z, b.z, p.z));\n}\n\nbool outOfRange(vec4 a, vec4 b, vec4 p) {\n  return outOfRange(a.xyz, b.xyz, p.xyz);\n}\n\nattribute vec3 position;\nattribute vec4 color;\nattribute vec2 glyph;\nattribute vec4 id;\n\nuniform float highlightScale;\nuniform vec4 highlightId;\nuniform vec3 axes[2];\nuniform mat4 model, view, projection;\nuniform vec2 screenSize;\nuniform vec3 clipBounds[2];\nuniform float scale, pixelRatio;\n\nvarying vec4 interpColor;\nvarying vec4 pickId;\nvarying vec3 dataCoordinate;\n\nvoid main() {\n  if (outOfRange(clipBounds[0], clipBounds[1], position)) {\n\n    gl_Position = vec4(0,0,0,0);\n  } else {\n    float lscale = pixelRatio * scale;\n    if(distance(highlightId, id) < 0.0001) {\n      lscale *= highlightScale;\n    }\n\n    vec4 clipCenter   = projection * view * model * vec4(position, 1);\n    vec3 dataPosition = position + 0.5*lscale*(axes[0] * glyph.x + axes[1] * glyph.y) * clipCenter.w * screenSize.y;\n    vec4 clipPosition = projection * view * model * vec4(dataPosition, 1);\n\n    gl_Position = clipPosition;\n    interpColor = color;\n    pickId = id;\n    dataCoordinate = dataPosition;\n  }\n}\n"]),d=n(["precision highp float;\n#define GLSLIFY 1\n\nbool outOfRange(float a, float b, float p) {\n  return ((p > max(a, b)) || \n          (p < min(a, b)));\n}\n\nbool outOfRange(vec2 a, vec2 b, vec2 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y));\n}\n\nbool outOfRange(vec3 a, vec3 b, vec3 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y) ||\n          outOfRange(a.z, b.z, p.z));\n}\n\nbool outOfRange(vec4 a, vec4 b, vec4 p) {\n  return outOfRange(a.xyz, b.xyz, p.xyz);\n}\n\nuniform vec3 fragClipBounds[2];\nuniform float opacity;\n\nvarying vec4 interpColor;\nvarying vec3 dataCoordinate;\n\nvoid main() {\n  if (\n    outOfRange(fragClipBounds[0], fragClipBounds[1], dataCoordinate) ||\n    interpColor.a * opacity == 0.\n  ) discard;\n  gl_FragColor = interpColor * opacity;\n}\n"]),s=n(["precision highp float;\n#define GLSLIFY 1\n\nbool outOfRange(float a, float b, float p) {\n  return ((p > max(a, b)) || \n          (p < min(a, b)));\n}\n\nbool outOfRange(vec2 a, vec2 b, vec2 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y));\n}\n\nbool outOfRange(vec3 a, vec3 b, vec3 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y) ||\n          outOfRange(a.z, b.z, p.z));\n}\n\nbool outOfRange(vec4 a, vec4 b, vec4 p) {\n  return outOfRange(a.xyz, b.xyz, p.xyz);\n}\n\nuniform vec3 fragClipBounds[2];\nuniform float pickGroup;\n\nvarying vec4 pickId;\nvarying vec3 dataCoordinate;\n\nvoid main() {\n  if (outOfRange(fragClipBounds[0], fragClipBounds[1], dataCoordinate)) discard;\n\n  gl_FragColor = vec4(pickGroup, pickId.bgr);\n}"]),i=[{name:"position",type:"vec3"},{name:"color",type:"vec4"},{name:"glyph",type:"vec2"},{name:"id",type:"vec4"}],u={vertex:t,fragment:d,attributes:i},f={vertex:a,fragment:d,attributes:i},c={vertex:r,fragment:d,attributes:i},h={vertex:t,fragment:s,attributes:i},p={vertex:a,fragment:s,attributes:i},o={vertex:r,fragment:s,attributes:i};function b(l,T){var _=e(l,T),w=_.attributes;return w.position.location=0,w.color.location=1,w.glyph.location=2,w.id.location=3,_}x.createPerspective=function(l){return b(l,u)},x.createOrtho=function(l){return b(l,f)},x.createProject=function(l){return b(l,c)},x.createPickPerspective=function(l){return b(l,h)},x.createPickOrtho=function(l){return b(l,p)},x.createPickProject=function(l){return b(l,o)}},{"gl-shader":132,glslify:231}],128:[function(v,m,x){"use strict";var e=v("is-string-blank"),n=v("gl-buffer"),t=v("gl-vao"),a=v("typedarray-pool"),r=v("gl-mat4/multiply"),d=v("./lib/shaders"),s=v("./lib/glyphs"),i=v("./lib/get-simple-string"),u=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];function f(W,K){var G=W[0],Y=W[1],$=W[2],B=W[3];return W[0]=K[0]*G+K[4]*Y+K[8]*$+K[12]*B,W[1]=K[1]*G+K[5]*Y+K[9]*$+K[13]*B,W[2]=K[2]*G+K[6]*Y+K[10]*$+K[14]*B,W[3]=K[3]*G+K[7]*Y+K[11]*$+K[15]*B,W}function c(W,K,G,Y){return f(Y,Y),f(Y,Y),f(Y,Y)}function h(W,K){this.index=W,this.dataCoordinate=this.position=K}function p(W){return!0===W||W>1?1:W}function o(W,K,G,Y,$,B,N,U,te,j,J,X){this.gl=W,this.pixelRatio=1,this.shader=K,this.orthoShader=G,this.projectShader=Y,this.pointBuffer=$,this.colorBuffer=B,this.glyphBuffer=N,this.idBuffer=U,this.vao=te,this.vertexCount=0,this.lineVertexCount=0,this.opacity=1,this.hasAlpha=!1,this.lineWidth=0,this.projectScale=[2/3,2/3,2/3],this.projectOpacity=[1,1,1],this.projectHasAlpha=!1,this.pickId=0,this.pickPerspectiveShader=j,this.pickOrthoShader=J,this.pickProjectShader=X,this.points=[],this._selectResult=new h(0,[0,0,0]),this.useOrtho=!0,this.bounds=[[1/0,1/0,1/0],[-1/0,-1/0,-1/0]],this.axesProject=[!0,!0,!0],this.axesBounds=[[-1/0,-1/0,-1/0],[1/0,1/0,1/0]],this.highlightId=[1,1,1,1],this.highlightScale=2,this.clipBounds=[[-1/0,-1/0,-1/0],[1/0,1/0,1/0]],this.dirty=!0}m.exports=function(W){var K=W.gl,G=d.createPerspective(K),Y=d.createOrtho(K),$=d.createProject(K),B=d.createPickPerspective(K),N=d.createPickOrtho(K),U=d.createPickProject(K),te=n(K),j=n(K),J=n(K),X=n(K),ne=new o(K,G,Y,$,te,j,J,X,t(K,[{buffer:te,size:3,type:K.FLOAT},{buffer:j,size:4,type:K.FLOAT},{buffer:J,size:2,type:K.FLOAT},{buffer:X,size:4,type:K.UNSIGNED_BYTE,normalized:!0}]),B,N,U);return ne.update(W),ne};var b=o.prototype;b.pickSlots=1,b.setPickBase=function(W){this.pickId=W},b.isTransparent=function(){if(this.hasAlpha)return!0;for(var W=0;W<3;++W)if(this.axesProject[W]&&this.projectHasAlpha)return!0;return!1},b.isOpaque=function(){if(!this.hasAlpha)return!0;for(var W=0;W<3;++W)if(this.axesProject[W]&&!this.projectHasAlpha)return!0;return!1};var l=[0,0],T=[0,0,0],_=[0,0,0],w=[0,0,0,1],k=[0,0,0,1],L=u.slice(),M=[0,0,0],I=[[0,0,0],[0,0,0]];function P(W){return W[0]=W[1]=W[2]=0,W}function S(W,K){return W[0]=K[0],W[1]=K[1],W[2]=K[2],W[3]=1,W}function E(W,K,G,Y){return W[0]=K[0],W[1]=K[1],W[2]=K[2],W[G]=Y,W}var R=[[-1e8,-1e8,-1e8],[1e8,1e8,1e8]];function q(W,K,G,Y,$,B,N){var U=G.gl;if((B===G.projectHasAlpha||N)&&function z(W,K,G,Y){var $,B=K.axesProject,N=K.gl,U=W.uniforms,te=G.model||u,j=G.view||u,J=G.projection||u,X=K.axesBounds,re=function(ke){for(var Pe=I,Ne=0;Ne<2;++Ne)for(var De=0;De<3;++De)Pe[Ne][De]=Math.max(Math.min(ke[Ne][De],1e8),-1e8);return Pe}(K.clipBounds);$=K.axes&&K.axes.lastCubeProps?K.axes.lastCubeProps.axis:[1,1,1],l[0]=2/N.drawingBufferWidth,l[1]=2/N.drawingBufferHeight,W.bind(),U.view=j,U.projection=J,U.screenSize=l,U.highlightId=K.highlightId,U.highlightScale=K.highlightScale,U.clipBounds=re,U.pickGroup=K.pickId/255,U.pixelRatio=Y;for(var ne=0;ne<3;++ne)if(B[ne]){U.scale=K.projectScale[ne],U.opacity=K.projectOpacity[ne];for(var le=L,oe=0;oe<16;++oe)le[oe]=0;for(oe=0;oe<4;++oe)le[5*oe]=1;le[5*ne]=0,le[12+ne]=$[ne]<0?X[0][ne]:X[1][ne],r(le,te,le),U.model=le;var de=(ne+1)%3,se=(ne+2)%3,ge=P(T),_e=P(_);ge[de]=1,_e[se]=1;var Te=c(0,0,0,S(w,ge)),we=c(0,0,0,S(k,_e));if(Math.abs(Te[1])>Math.abs(we[1])){var Oe=Te;Te=we,we=Oe,Oe=ge,ge=_e,_e=Oe;var fe=de;de=se,se=fe}Te[0]<0&&(ge[de]=-1),we[1]>0&&(_e[se]=-1);var ve=0,Ae=0;for(oe=0;oe<4;++oe)ve+=Math.pow(te[4*de+oe],2),Ae+=Math.pow(te[4*se+oe],2);ge[de]/=Math.sqrt(ve),_e[se]/=Math.sqrt(Ae),U.axes[0]=ge,U.axes[1]=_e,U.fragClipBounds[0]=E(M,re[0],ne,-1e8),U.fragClipBounds[1]=E(M,re[1],ne,1e8),K.vao.bind(),K.vao.draw(N.TRIANGLES,K.vertexCount),K.lineWidth>0&&(N.lineWidth(K.lineWidth*Y),K.vao.draw(N.LINES,K.lineVertexCount,K.vertexCount)),K.vao.unbind()}}(K,G,Y,$),B===G.hasAlpha||N){W.bind();var te=W.uniforms;te.model=Y.model||u,te.view=Y.view||u,te.projection=Y.projection||u,l[0]=2/U.drawingBufferWidth,l[1]=2/U.drawingBufferHeight,te.screenSize=l,te.highlightId=G.highlightId,te.highlightScale=G.highlightScale,te.fragClipBounds=R,te.clipBounds=G.axes.bounds,te.opacity=G.opacity,te.pickGroup=G.pickId/255,te.pixelRatio=$,G.vao.bind(),G.vao.draw(U.TRIANGLES,G.vertexCount),G.lineWidth>0&&(U.lineWidth(G.lineWidth*$),G.vao.draw(U.LINES,G.lineVertexCount,G.vertexCount)),G.vao.unbind()}}function V(W,K,G,Y){var $;$=Array.isArray(W)?K<W.length?W[K]:void 0:W,$=i($);var B=!0;e($)&&($="\u25bc",B=!1);var N=s($,G,Y);return{mesh:N[0],lines:N[1],bounds:N[2],visible:B}}b.draw=function(W){q(this.useOrtho?this.orthoShader:this.shader,this.projectShader,this,W,this.pixelRatio,!1,!1)},b.drawTransparent=function(W){q(this.useOrtho?this.orthoShader:this.shader,this.projectShader,this,W,this.pixelRatio,!0,!1)},b.drawPick=function(W){q(this.useOrtho?this.pickOrthoShader:this.pickPerspectiveShader,this.pickProjectShader,this,W,1,!0,!0)},b.pick=function(W){if(!W||W.id!==this.pickId)return null;var K=W.value[2]+(W.value[1]<<8)+(W.value[0]<<16);if(K>=this.pointCount||K<0)return null;var G=this.points[K],Y=this._selectResult;Y.index=K;for(var $=0;$<3;++$)Y.position[$]=Y.dataCoordinate[$]=G[$];return Y},b.highlight=function(W){if(W){var K=W.index;this.highlightId=[(255&K)/255,(K>>8&255)/255,(K>>16&255)/255,0]}else this.highlightId=[1,1,1,1]},b.update=function(W){if("perspective"in(W=W||{})&&(this.useOrtho=!W.perspective),"orthographic"in W&&(this.useOrtho=!!W.orthographic),"lineWidth"in W&&(this.lineWidth=W.lineWidth),"project"in W)if(Array.isArray(W.project))this.axesProject=W.project;else{var K=!!W.project;this.axesProject=[K,K,K]}if("projectScale"in W)if(Array.isArray(W.projectScale))this.projectScale=W.projectScale.slice();else{var G=+W.projectScale;this.projectScale=[G,G,G]}if(this.projectHasAlpha=!1,"projectOpacity"in W){this.projectOpacity=Array.isArray(W.projectOpacity)?W.projectOpacity.slice():[G=+W.projectOpacity,G,G];for(var Y=0;Y<3;++Y)this.projectOpacity[Y]=p(this.projectOpacity[Y]),this.projectOpacity[Y]<1&&(this.projectHasAlpha=!0)}this.hasAlpha=!1,"opacity"in W&&(this.opacity=p(W.opacity),this.opacity<1&&(this.hasAlpha=!0)),this.dirty=!0;var $,B,N=W.position,U=W.font||"normal",te=W.alignment||[0,0];if(2===te.length)$=te[0],B=te[1];else for($=[],B=[],Y=0;Y<te.length;++Y)$[Y]=te[Y][0],B[Y]=te[Y][1];var j=[1/0,1/0,1/0],J=[-1/0,-1/0,-1/0],X=W.glyph,re=W.color,ne=W.size,le=W.angle,oe=W.lineColor,de=-1,se=0,ge=0,_e=0;if(N.length){_e=N.length;e:for(Y=0;Y<_e;++Y){for(var Te=N[Y],we=0;we<3;++we)if(isNaN(Te[we])||!isFinite(Te[we]))continue e;var Oe=(Xe=V(X,Y,U,this.pixelRatio)).mesh,fe=Xe.lines,ve=Xe.bounds;se+=3*Oe.cells.length,ge+=2*fe.edges.length}}var Ae=se+ge,ke=a.mallocFloat(3*Ae),Pe=a.mallocFloat(4*Ae),Ne=a.mallocFloat(2*Ae),De=a.mallocUint32(Ae);if(Ae>0){var ze=0,Me=se,Se=[0,0,0,1],Ie=[0,0,0,1],Fe=Array.isArray(re)&&Array.isArray(re[0]),Re=Array.isArray(oe)&&Array.isArray(oe[0]);e:for(Y=0;Y<_e;++Y){for(de+=1,Te=N[Y],we=0;we<3;++we){if(isNaN(Te[we])||!isFinite(Te[we]))continue e;J[we]=Math.max(J[we],Te[we]),j[we]=Math.min(j[we],Te[we])}Oe=(Xe=V(X,Y,U,this.pixelRatio)).mesh,fe=Xe.lines,ve=Xe.bounds;var Xe,nt=Xe.visible;if(nt)if(Array.isArray(re)){if(3===(ct=Fe?Y<re.length?re[Y]:[0,0,0,0]:re).length){for(we=0;we<3;++we)Se[we]=ct[we];Se[3]=1}else if(4===ct.length){for(we=0;we<4;++we)Se[we]=ct[we];!this.hasAlpha&&ct[3]<1&&(this.hasAlpha=!0)}}else Se[0]=Se[1]=Se[2]=0,Se[3]=1;else Se=[1,1,1,0];if(nt)if(Array.isArray(oe)){var ct;if(3===(ct=Re?Y<oe.length?oe[Y]:[0,0,0,0]:oe).length){for(we=0;we<3;++we)Ie[we]=ct[we];Ie[we]=1}else if(4===ct.length){for(we=0;we<4;++we)Ie[we]=ct[we];!this.hasAlpha&&ct[3]<1&&(this.hasAlpha=!0)}}else Ie[0]=Ie[1]=Ie[2]=0,Ie[3]=1;else Ie=[1,1,1,0];var xt=.5;nt?Array.isArray(ne)?xt=Y<ne.length?+ne[Y]:12:ne?xt=+ne:this.useOrtho&&(xt=12):xt=0;var dt=0;Array.isArray(le)?dt=Y<le.length?+le[Y]:0:le&&(dt=+le);var tt=Math.cos(dt),Ke=Math.sin(dt);for(Te=N[Y],we=0;we<3;++we)J[we]=Math.max(J[we],Te[we]),j[we]=Math.min(j[we],Te[we]);var mt=$,Bt=B;mt=0,Array.isArray($)?mt=Y<$.length?$[Y]:0:$&&(mt=$),Bt=0,Array.isArray(B)?Bt=Y<B.length?B[Y]:0:B&&(Bt=B);var Ut=[mt*=mt>0?1-ve[0][0]:mt<0?1+ve[1][0]:1,Bt*=Bt>0?1-ve[0][1]:Bt<0?1+ve[1][1]:1],er=Oe.cells||[],Wt=Oe.positions||[];for(we=0;we<er.length;++we)for(var rr=er[we],Ht=0;Ht<3;++Ht){for(var Ve=0;Ve<3;++Ve)ke[3*ze+Ve]=Te[Ve];for(Ve=0;Ve<4;++Ve)Pe[4*ze+Ve]=Se[Ve];De[ze]=de;var We=Wt[rr[Ht]];Ne[2*ze]=xt*(tt*We[0]-Ke*We[1]+Ut[0]),Ne[2*ze+1]=xt*(Ke*We[0]+tt*We[1]+Ut[1]),ze+=1}for(er=fe.edges,Wt=fe.positions,we=0;we<er.length;++we)for(rr=er[we],Ht=0;Ht<2;++Ht){for(Ve=0;Ve<3;++Ve)ke[3*Me+Ve]=Te[Ve];for(Ve=0;Ve<4;++Ve)Pe[4*Me+Ve]=Ie[Ve];De[Me]=de,Ne[2*Me]=xt*(tt*(We=Wt[rr[Ht]])[0]-Ke*We[1]+Ut[0]),Ne[2*Me+1]=xt*(Ke*We[0]+tt*We[1]+Ut[1]),Me+=1}}}this.bounds=[j,J],this.points=N,this.pointCount=N.length,this.vertexCount=se,this.lineVertexCount=ge,this.pointBuffer.update(ke),this.colorBuffer.update(Pe),this.glyphBuffer.update(Ne),this.idBuffer.update(De),a.free(ke),a.free(Pe),a.free(Ne),a.free(De)},b.dispose=function(){this.shader.dispose(),this.orthoShader.dispose(),this.pickPerspectiveShader.dispose(),this.pickOrthoShader.dispose(),this.vao.dispose(),this.pointBuffer.dispose(),this.colorBuffer.dispose(),this.glyphBuffer.dispose(),this.idBuffer.dispose()}},{"./lib/get-simple-string":125,"./lib/glyphs":126,"./lib/shaders":127,"gl-buffer":78,"gl-mat4/multiply":100,"gl-vao":150,"is-string-blank":239,"typedarray-pool":308}],129:[function(v,m,x){"use strict";var e=v("glslify");x.boxVertex=e(["precision mediump float;\n#define GLSLIFY 1\n\nattribute vec2 vertex;\n\nuniform vec2 cornerA, cornerB;\n\nvoid main() {\n  gl_Position = vec4(mix(cornerA, cornerB, vertex), 0, 1);\n}\n"]),x.boxFragment=e(["precision mediump float;\n#define GLSLIFY 1\n\nuniform vec4 color;\n\nvoid main() {\n  gl_FragColor = color;\n}\n"])},{glslify:231}],130:[function(v,m,x){"use strict";var e=v("gl-shader"),n=v("gl-buffer"),t=v("./lib/shaders");function a(d,s,i){this.plot=d,this.boxBuffer=s,this.boxShader=i,this.enabled=!0,this.selectBox=[1/0,1/0,-1/0,-1/0],this.borderColor=[0,0,0,1],this.innerFill=!1,this.innerColor=[0,0,0,.25],this.outerFill=!0,this.outerColor=[0,0,0,.5],this.borderWidth=10}m.exports=function(d,s){var i=d.gl,c=new a(d,n(i,[0,0,0,1,1,0,1,1]),e(i,t.boxVertex,t.boxFragment));return c.update(s),d.addOverlay(c),c};var r=a.prototype;r.draw=function(){if(this.enabled){var d=this.plot,s=this.selectBox,i=this.borderWidth,u=this.innerColor,f=this.outerColor,c=this.borderColor,h=d.box,p=d.screenBox,o=d.dataBox,b=d.viewBox,l=d.pixelRatio,T=(s[0]-o[0])*(b[2]-b[0])/(o[2]-o[0])+b[0],_=(s[1]-o[1])*(b[3]-b[1])/(o[3]-o[1])+b[1],w=(s[2]-o[0])*(b[2]-b[0])/(o[2]-o[0])+b[0],k=(s[3]-o[1])*(b[3]-b[1])/(o[3]-o[1])+b[1];if(T=Math.max(T,b[0]),_=Math.max(_,b[1]),w=Math.min(w,b[2]),k=Math.min(k,b[3]),!(w<T||k<_)){h.bind();var L=p[2]-p[0],M=p[3]-p[1];if(this.outerFill&&(h.drawBox(0,0,L,_,f),h.drawBox(0,_,T,k,f),h.drawBox(0,k,L,M,f),h.drawBox(w,_,L,k,f)),this.innerFill&&h.drawBox(T,_,w,k,u),i>0){var I=i*l;h.drawBox(T-I,_-I,w+I,_+I,c),h.drawBox(T-I,k-I,w+I,k+I,c),h.drawBox(T-I,_-I,T+I,k+I,c),h.drawBox(w-I,_-I,w+I,k+I,c)}}}},r.update=function(d){this.innerFill=!!(d=d||{}).innerFill,this.outerFill=!!d.outerFill,this.innerColor=(d.innerColor||[0,0,0,.5]).slice(),this.outerColor=(d.outerColor||[0,0,0,.5]).slice(),this.borderColor=(d.borderColor||[0,0,0,1]).slice(),this.borderWidth=d.borderWidth||0,this.selectBox=(d.selectBox||this.selectBox).slice()},r.dispose=function(){this.boxBuffer.dispose(),this.boxShader.dispose(),this.plot.removeOverlay(this)}},{"./lib/shaders":129,"gl-buffer":78,"gl-shader":132}],131:[function(v,m,x){"use strict";m.exports=function(i,u){var f=u[0],c=u[1];return new d(i,e(i,f,c,{}),n.mallocUint8(f*c*4))};var e=v("gl-fbo"),n=v("typedarray-pool"),t=v("ndarray"),a=v("bit-twiddle").nextPow2;function r(i,u,f,c,h){this.coord=[i,u],this.id=f,this.value=c,this.distance=h}function d(i,u,f){this.gl=i,this.fbo=u,this.buffer=f,this._readTimeout=null;var c=this;this._readCallback=function(){c.gl&&(u.bind(),i.readPixels(0,0,u.shape[0],u.shape[1],i.RGBA,i.UNSIGNED_BYTE,c.buffer),c._readTimeout=null)}}var s=d.prototype;Object.defineProperty(s,"shape",{get:function(){return this.gl?this.fbo.shape.slice():[0,0]},set:function(i){if(this.gl){this.fbo.shape=i;var u=this.fbo.shape[0],f=this.fbo.shape[1];if(f*u*4>this.buffer.length){n.free(this.buffer);for(var c=this.buffer=n.mallocUint8(a(f*u*4)),h=0;h<f*u*4;++h)c[h]=255}return i}}}),s.begin=function(){var i=this.gl;i&&(this.fbo.bind(),i.clearColor(1,1,1,1),i.clear(i.COLOR_BUFFER_BIT|i.DEPTH_BUFFER_BIT))},s.end=function(){var i=this.gl;i&&(i.bindFramebuffer(i.FRAMEBUFFER,null),this._readTimeout||clearTimeout(this._readTimeout),this._readTimeout=setTimeout(this._readCallback,1))},s.query=function(i,u,f){if(!this.gl)return null;var c=this.fbo.shape.slice();i|=0,u|=0,"number"!=typeof f&&(f=1);var h=0|Math.min(Math.max(i-f,0),c[0]),p=0|Math.min(Math.max(i+f,0),c[0]),o=0|Math.min(Math.max(u-f,0),c[1]),b=0|Math.min(Math.max(u+f,0),c[1]);if(p<=h||b<=o)return null;var l=[p-h,b-o],T=t(this.buffer,[l[0],l[1],4],[4,4*c[0],1],4*(h+c[0]*o)),_=function(L,M,I){for(var P=1e8,S=-1,E=-1,z=L.shape[0],R=L.shape[1],q=0;q<z;q++)for(var V=0;V<R;V++){var W=L.get(q,V,0),K=L.get(q,V,1),G=L.get(q,V,2),Y=L.get(q,V,3);if(W<255||K<255||G<255||Y<255){var $=M-q,B=I-V,N=$*$+B*B;N<P&&(P=N,S=q,E=V)}}return[S,E,P]}(T.hi(l[0],l[1],1),f,f),w=_[0],k=_[1];return w<0||Math.pow(this.radius,2)<_[2]?null:new r(w+h|0,k+o|0,T.get(w,k,0),[T.get(w,k,1),T.get(w,k,2),T.get(w,k,3)],Math.sqrt(_[2]))},s.dispose=function(){this.gl&&(this.fbo.dispose(),n.free(this.buffer),this.gl=null,this._readTimeout&&clearTimeout(this._readTimeout))}},{"bit-twiddle":32,"gl-fbo":86,ndarray:259,"typedarray-pool":308}],132:[function(v,m,x){"use strict";var e=v("./lib/create-uniforms"),n=v("./lib/create-attributes"),t=v("./lib/reflect"),a=v("./lib/shader-cache"),r=v("./lib/runtime-reflect"),d=v("./lib/GLError");function s(f){this.gl=f,this.gl.lastAttribCount=0,this._vref=this._fref=this._relink=this.vertShader=this.fragShader=this.program=this.attributes=this.uniforms=this.types=null}var i=s.prototype;function u(f,c){return f.name<c.name?-1:1}i.bind=function(){var f;this.program||this._relink();var c=this.gl.getProgramParameter(this.program,this.gl.ACTIVE_ATTRIBUTES),h=this.gl.lastAttribCount;if(c>h)for(f=h;f<c;f++)this.gl.enableVertexAttribArray(f);else if(h>c)for(f=c;f<h;f++)this.gl.disableVertexAttribArray(f);this.gl.lastAttribCount=c,this.gl.useProgram(this.program)},i.dispose=function(){for(var f=this.gl.lastAttribCount,c=0;c<f;c++)this.gl.disableVertexAttribArray(c);this.gl.lastAttribCount=0,this._fref&&this._fref.dispose(),this._vref&&this._vref.dispose(),this.attributes=this.types=this.vertShader=this.fragShader=this.program=this._relink=this._fref=this._vref=null},i.update=function(f,c,h,p){if(!c||1===arguments.length){var o=f;f=o.vertex,c=o.fragment,h=o.uniforms,p=o.attributes}var b=this,l=b.gl,T=b._vref;b._vref=a.shader(l,l.VERTEX_SHADER,f),T&&T.dispose(),b.vertShader=b._vref.shader;var _=this._fref;if(b._fref=a.shader(l,l.FRAGMENT_SHADER,c),_&&_.dispose(),b.fragShader=b._fref.shader,!h||!p){var w=l.createProgram();if(l.attachShader(w,b.fragShader),l.attachShader(w,b.vertShader),l.linkProgram(w),!l.getProgramParameter(w,l.LINK_STATUS)){var k=l.getProgramInfoLog(w);throw new d(k,"Error linking program:"+k)}h=h||r.uniforms(l,w),p=p||r.attributes(l,w),l.deleteProgram(w)}(p=p.slice()).sort(u);var L,M=[],I=[],P=[];for(L=0;L<p.length;++L){var S=p[L];if(S.type.indexOf("mat")>=0){for(var E=0|S.type.charAt(S.type.length-1),z=new Array(E),R=0;R<E;++R)z[R]=P.length,I.push(S.name+"["+R+"]"),"number"==typeof S.location?P.push(S.location+R):Array.isArray(S.location)&&S.location.length===E&&"number"==typeof S.location[R]?P.push(0|S.location[R]):P.push(-1);M.push({name:S.name,type:S.type,locations:z})}else M.push({name:S.name,type:S.type,locations:[P.length]}),I.push(S.name),P.push("number"==typeof S.location?0|S.location:-1)}var q=0;for(L=0;L<P.length;++L)if(P[L]<0){for(;P.indexOf(q)>=0;)q+=1;P[L]=q}var V=new Array(h.length);function W(){b.program=a.program(l,b._vref,b._fref,I,P);for(var K=0;K<h.length;++K)V[K]=l.getUniformLocation(b.program,h[K].name)}W(),b._relink=W,b.types={uniforms:t(h),attributes:t(p)},b.attributes=n(l,b,M,P),Object.defineProperty(b,"uniforms",e(l,b,h,V))},m.exports=function(f,c,h,p,o){var b=new s(f);return b.update(c,h,p,o),b}},{"./lib/GLError":133,"./lib/create-attributes":134,"./lib/create-uniforms":135,"./lib/reflect":136,"./lib/runtime-reflect":137,"./lib/shader-cache":138}],133:[function(v,m,x){function e(n,t,a){this.shortMessage=t||"",this.longMessage=a||"",this.rawError=n||"",this.message="gl-shader: "+(t||n||"")+(a?"\n"+a:""),this.stack=(new Error).stack}(e.prototype=new Error).name="GLError",e.prototype.constructor=e,m.exports=e},{}],134:[function(v,m,x){"use strict";m.exports=function(s,i,u,f){for(var c={},h=0,p=u.length;h<p;++h){var o=u[h],b=o.name,l=o.type,T=o.locations;switch(l){case"bool":case"int":case"float":r(s,i,T[0],f,1,c,b);break;default:if(l.indexOf("vec")>=0){if((_=l.charCodeAt(l.length-1)-48)<2||_>4)throw new e("","Invalid data type for attribute "+b+": "+l);r(s,i,T[0],f,_,c,b)}else{if(!(l.indexOf("mat")>=0))throw new e("","Unknown data type for attribute "+b+": "+l);var _;if((_=l.charCodeAt(l.length-1)-48)<2||_>4)throw new e("","Invalid data type for attribute "+b+": "+l);d(s,i,T,f,_,c,b)}}}return c};var e=v("./GLError");function n(s,i,u,f,c,h){this._gl=s,this._wrapper=i,this._index=u,this._locations=f,this._dimension=c,this._constFunc=h}var t=n.prototype;t.pointer=function(s,i,u,f){var c=this._gl,h=this._locations[this._index];c.vertexAttribPointer(h,this._dimension,s||c.FLOAT,!!i,u||0,f||0),c.enableVertexAttribArray(h)},t.set=function(s,i,u,f){return this._constFunc(this._locations[this._index],s,i,u,f)},Object.defineProperty(t,"location",{get:function(){return this._locations[this._index]},set:function(s){return s!==this._locations[this._index]&&(this._locations[this._index]=0|s,this._wrapper.program=null),0|s}});var a=[function(s,i,u){return void 0===u.length?s.vertexAttrib1f(i,u):s.vertexAttrib1fv(i,u)},function(s,i,u,f){return void 0===u.length?s.vertexAttrib2f(i,u,f):s.vertexAttrib2fv(i,u)},function(s,i,u,f,c){return void 0===u.length?s.vertexAttrib3f(i,u,f,c):s.vertexAttrib3fv(i,u)},function(s,i,u,f,c,h){return void 0===u.length?s.vertexAttrib4f(i,u,f,c,h):s.vertexAttrib4fv(i,u)}];function r(s,i,u,f,c,h,p){var o=a[c],b=new n(s,i,u,f,c,o);Object.defineProperty(h,p,{set:function(l){return s.disableVertexAttribArray(f[u]),o(s,f[u],l),l},get:function(){return b},enumerable:!0})}function d(s,i,u,f,c,h,p){for(var o=new Array(c),b=new Array(c),l=0;l<c;++l)r(s,i,u[l],f,c,o,l),b[l]=o[l];Object.defineProperty(o,"location",{set:function(w){if(Array.isArray(w))for(var k=0;k<c;++k)b[k].location=w[k];else for(k=0;k<c;++k)b[k].location=w+k;return w},get:function(){for(var w=new Array(c),k=0;k<c;++k)w[k]=f[u[k]];return w},enumerable:!0}),o.pointer=function(w,k,L,M){w=w||s.FLOAT,k=!!k,L=L||c*c,M=M||0;for(var I=0;I<c;++I){var P=f[u[I]];s.vertexAttribPointer(P,c,w,k,L,M+I*c),s.enableVertexAttribArray(P)}};var T=new Array(c),_=s["vertexAttrib"+c+"fv"];Object.defineProperty(h,p,{set:function(w){for(var k=0;k<c;++k){var L=f[u[k]];if(s.disableVertexAttribArray(L),Array.isArray(w[0]))_.call(s,L,w[k]);else{for(var M=0;M<c;++M)T[M]=w[c*k+M];_.call(s,L,T)}}return w},get:function(){return o},enumerable:!0})}},{"./GLError":133}],135:[function(v,m,x){"use strict";var e=v("./reflect"),n=v("./GLError");function t(r){return function(){return r}}function a(r,d){for(var s=new Array(r),i=0;i<r;++i)s[i]=d;return s}m.exports=function(r,d,s,i){function u(p){return function(o){for(var b=function R(q,V){if("object"!=typeof V)return[[q,V]];var W=[];for(var K in V){var G=V[K],Y=q;parseInt(K)+""===K?Y+="["+K+"]":Y+="."+K,"object"==typeof G?W.push.apply(W,R(Y,G)):W.push([Y,G])}return W}("",p),l=0;l<b.length;++l){var T=b[l],_=T[0],w=T[1];if(i[w]){var k=o;if("string"==typeof _&&(0===_.indexOf(".")||0===_.indexOf("["))){var L=_;if(0===_.indexOf(".")&&(L=_.slice(1)),L.indexOf("]")===L.length-1){var M=L.indexOf("["),I=L.slice(0,M),P=L.slice(M+1,L.length-1);k=I?o[I][P]:o[P]}else k=o[L]}var S,E=s[w].type;switch(E){case"bool":case"int":case"sampler2D":case"samplerCube":r.uniform1i(i[w],k);break;case"float":r.uniform1f(i[w],k);break;default:var z=E.indexOf("vec");if(!(0<=z&&z<=1&&E.length===4+z)){if(0===E.indexOf("mat")&&4===E.length){if((S=E.charCodeAt(E.length-1)-48)<2||S>4)throw new n("","Invalid uniform dimension type for matrix "+name+": "+E);r["uniformMatrix"+S+"fv"](i[w],!1,k);break}throw new n("","Unknown uniform data type for "+name+": "+E)}if((S=E.charCodeAt(E.length-1)-48)<2||S>4)throw new n("","Invalid data type");switch(E.charAt(0)){case"b":case"i":r["uniform"+S+"iv"](i[w],k);break;case"v":r["uniform"+S+"fv"](i[w],k);break;default:throw new n("","Unrecognized data type for vector "+name+": "+E)}}}}}}function f(p,o,b){if("object"==typeof b){var l=c(b);Object.defineProperty(p,o,{get:t(l),set:u(b),enumerable:!0,configurable:!1})}else i[b]?Object.defineProperty(p,o,{get:(T=b,function(_,w,k){return _.getUniform(w.program,k[T])}),set:u(b),enumerable:!0,configurable:!1}):p[o]=function(_){switch(_){case"bool":return!1;case"int":case"sampler2D":case"samplerCube":case"float":return 0;default:var w=_.indexOf("vec");if(0<=w&&w<=1&&_.length===4+w){if((k=_.charCodeAt(_.length-1)-48)<2||k>4)throw new n("","Invalid data type");return"b"===_.charAt(0)?a(k,!1):a(k,0)}if(0===_.indexOf("mat")&&4===_.length){var k;if((k=_.charCodeAt(_.length-1)-48)<2||k>4)throw new n("","Invalid uniform dimension type for matrix "+name+": "+_);return a(k*k,0)}throw new n("","Unknown uniform data type for "+name+": "+_)}}(s[b].type);var T}function c(p){var o;if(Array.isArray(p)){o=new Array(p.length);for(var b=0;b<p.length;++b)f(o,b,p[b])}else for(var l in o={},p)f(o,l,p[l]);return o}var h=e(s,!0);return{get:t(c(h)),set:u(h),enumerable:!0,configurable:!0}}},{"./GLError":133,"./reflect":136}],136:[function(v,m,x){"use strict";m.exports=function(e,n){for(var t={},a=0;a<e.length;++a)for(var r=e[a].name.split("."),d=t,s=0;s<r.length;++s){var i=r[s].split("[");if(i.length>1){i[0]in d||(d[i[0]]=[]),d=d[i[0]];for(var u=1;u<i.length;++u){var f=parseInt(i[u]);u<i.length-1||s<r.length-1?(f in d||(d[f]=u<i.length-1?[]:{}),d=d[f]):d[f]=n?a:e[a].type}}else s<r.length-1?(i[0]in d||(d[i[0]]={}),d=d[i[0]]):d[i[0]]=n?a:e[a].type}return t}},{}],137:[function(v,m,x){"use strict";x.uniforms=function(a,r){for(var d=a.getProgramParameter(r,a.ACTIVE_UNIFORMS),s=[],i=0;i<d;++i){var u=a.getActiveUniform(r,i);if(u){var f=t(a,u.type);if(u.size>1)for(var c=0;c<u.size;++c)s.push({name:u.name.replace("[0]","["+c+"]"),type:f});else s.push({name:u.name,type:f})}}return s},x.attributes=function(a,r){for(var d=a.getProgramParameter(r,a.ACTIVE_ATTRIBUTES),s=[],i=0;i<d;++i){var u=a.getActiveAttrib(r,i);u&&s.push({name:u.name,type:t(a,u.type)})}return s};var e={FLOAT:"float",FLOAT_VEC2:"vec2",FLOAT_VEC3:"vec3",FLOAT_VEC4:"vec4",INT:"int",INT_VEC2:"ivec2",INT_VEC3:"ivec3",INT_VEC4:"ivec4",BOOL:"bool",BOOL_VEC2:"bvec2",BOOL_VEC3:"bvec3",BOOL_VEC4:"bvec4",FLOAT_MAT2:"mat2",FLOAT_MAT3:"mat3",FLOAT_MAT4:"mat4",SAMPLER_2D:"sampler2D",SAMPLER_CUBE:"samplerCube"},n=null;function t(a,r){if(!n){var d=Object.keys(e);n={};for(var s=0;s<d.length;++s){var i=d[s];n[a[i]]=e[i]}}return n[r]}},{}],138:[function(v,m,x){"use strict";x.shader=function(u,f,c){return i(u).getShaderReference(f,c)},x.program=function(u,f,c,h,p){return i(u).getProgram(f,c,h,p)};var e=v("./GLError"),n=v("gl-format-compiler-error"),t=new(typeof WeakMap>"u"?v("weakmap-shim"):WeakMap),a=0;function r(u,f,c,h,p,o,b){this.id=u,this.src=f,this.type=c,this.shader=h,this.count=o,this.programs=[],this.cache=b}function d(u){this.gl=u,this.shaders=[{},{}],this.programs={}}r.prototype.dispose=function(){if(0==--this.count){for(var u=this.cache,f=u.gl,c=this.programs,h=0,p=c.length;h<p;++h){var o=u.programs[c[h]];o&&(delete u.programs[h],f.deleteProgram(o))}f.deleteShader(this.shader),delete u.shaders[this.type===f.FRAGMENT_SHADER|0][this.src]}};var s=d.prototype;function i(u){var f=t.get(u);return f||(f=new d(u),t.set(u,f)),f}s.getShaderReference=function(u,f){var c=this.gl,h=this.shaders[u===c.FRAGMENT_SHADER|0],p=h[f];if(p&&c.isShader(p.shader))p.count+=1;else{var o=function(b,l,T){var _=b.createShader(l);if(b.shaderSource(_,T),b.compileShader(_),!b.getShaderParameter(_,b.COMPILE_STATUS)){var w=b.getShaderInfoLog(_);try{var k=n(w,T,l)}catch(L){throw console.warn("Failed to format compiler error: "+L),new e(w,"Error compiling shader:\n"+w)}throw new e(w,k.short,k.long)}return _}(c,u,f);p=h[f]=new r(a++,f,u,o,[],1,this)}return p},s.getProgram=function(u,f,c,h){var p=[u.id,f.id,c.join(":"),h.join(":")].join("@"),o=this.programs[p];return o&&this.gl.isProgram(o)||(this.programs[p]=o=function(b,l,T,_,w){var k=b.createProgram();b.attachShader(k,l),b.attachShader(k,T);for(var L=0;L<_.length;++L)b.bindAttribLocation(k,w[L],_[L]);if(b.linkProgram(k),!b.getProgramParameter(k,b.LINK_STATUS)){var M=b.getProgramInfoLog(k);throw new e(M,"Error linking program: "+M)}return k}(this.gl,u.shader,f.shader,c,h),u.programs.push(p),f.programs.push(p)),o}},{"./GLError":133,"gl-format-compiler-error":87,"weakmap-shim":316}],139:[function(v,m,x){"use strict";function e(t){this.plot=t,this.enable=[!0,!0,!1,!1],this.width=[1,1,1,1],this.color=[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.center=[1/0,1/0]}m.exports=function(t,a){var r=new e(t);return r.update(a),t.addOverlay(r),r};var n=e.prototype;n.update=function(t){this.enable=((t=t||{}).enable||[!0,!0,!1,!1]).slice(),this.width=(t.width||[1,1,1,1]).slice(),this.color=(t.color||[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]]).map(function(a){return a.slice()}),this.center=(t.center||[1/0,1/0]).slice(),this.plot.setOverlayDirty()},n.draw=function(){var t=this.enable,a=this.width,r=this.color,d=this.center,s=this.plot,i=s.line,u=s.dataBox,f=s.viewBox;if(i.bind(),u[0]<=d[0]&&d[0]<=u[2]&&u[1]<=d[1]&&d[1]<=u[3]){var c=f[0]+(d[0]-u[0])/(u[2]-u[0])*(f[2]-f[0]),h=f[1]+(d[1]-u[1])/(u[3]-u[1])*(f[3]-f[1]);t[0]&&i.drawLine(c,h,f[0],h,a[0],r[0]),t[1]&&i.drawLine(c,h,c,f[1],a[1],r[1]),t[2]&&i.drawLine(c,h,f[2],h,a[2],r[2]),t[3]&&i.drawLine(c,h,c,f[3],a[3],r[3])}},n.dispose=function(){this.plot.removeOverlay(this)}},{}],140:[function(v,m,x){"use strict";var e=v("glslify"),n=v("gl-shader"),t=e(["precision mediump float;\n#define GLSLIFY 1\n\nattribute vec3 position, color;\nattribute float weight;\n\nuniform mat4 model, view, projection;\nuniform vec3 coordinates[3];\nuniform vec4 colors[3];\nuniform vec2 screenShape;\nuniform float lineWidth;\n\nvarying vec4 fragColor;\n\nvoid main() {\n  vec3 vertexPosition = mix(coordinates[0],\n    mix(coordinates[2], coordinates[1], 0.5 * (position + 1.0)), abs(position));\n\n  vec4 clipPos = projection * view * model * vec4(vertexPosition, 1.0);\n  vec2 clipOffset = (projection * view * model * vec4(color, 0.0)).xy;\n  vec2 delta = weight * clipOffset * screenShape;\n  vec2 lineOffset = normalize(vec2(delta.y, -delta.x)) / screenShape;\n\n  gl_Position   = vec4(clipPos.xy + clipPos.w * 0.5 * lineWidth * lineOffset, clipPos.z, clipPos.w);\n  fragColor     = color.x * colors[0] + color.y * colors[1] + color.z * colors[2];\n}\n"]),a=e(["precision mediump float;\n#define GLSLIFY 1\n\nvarying vec4 fragColor;\n\nvoid main() {\n  gl_FragColor = fragColor;\n}"]);m.exports=function(r){return n(r,t,a,null,[{name:"position",type:"vec3"},{name:"color",type:"vec3"},{name:"weight",type:"float"}])}},{"gl-shader":132,glslify:231}],141:[function(v,m,x){"use strict";var e=v("gl-buffer"),n=v("gl-vao"),t=v("./shaders/index");m.exports=function(f,c){var h=[];function p(_,w,k,L,M,I){var P=[_,w,k,0,0,0,1];P[L+3]=1,P[L]=M,h.push.apply(h,P),P[6]=-1,h.push.apply(h,P),P[L]=I,h.push.apply(h,P),h.push.apply(h,P),P[6]=1,h.push.apply(h,P),P[L]=M,h.push.apply(h,P)}p(0,0,0,0,0,1),p(0,0,0,1,0,1),p(0,0,0,2,0,1),p(1,0,0,1,-1,1),p(1,0,0,2,-1,1),p(0,1,0,0,-1,1),p(0,1,0,2,-1,1),p(0,0,1,0,-1,1),p(0,0,1,1,-1,1);var o=e(f,h),b=n(f,[{type:f.FLOAT,buffer:o,size:3,offset:0,stride:28},{type:f.FLOAT,buffer:o,size:3,offset:12,stride:28},{type:f.FLOAT,buffer:o,size:1,offset:24,stride:28}]),l=t(f);l.attributes.position.location=0,l.attributes.color.location=1,l.attributes.weight.location=2;var T=new r(f,o,b,l);return T.update(c),T};var a=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];function r(f,c,h,p){this.gl=f,this.buffer=c,this.vao=h,this.shader=p,this.pixelRatio=1,this.bounds=[[-1e3,-1e3,-1e3],[1e3,1e3,1e3]],this.position=[0,0,0],this.lineWidth=[2,2,2],this.colors=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.enabled=[!0,!0,!0],this.drawSides=[!0,!0,!0],this.axes=null}var d=r.prototype,s=[0,0,0],i=[0,0,0],u=[0,0];d.isTransparent=function(){return!1},d.drawTransparent=function(f){},d.draw=function(f){var c=this.gl,h=this.vao,p=this.shader;h.bind(),p.bind();var o,b=f.model||a,l=f.view||a,T=f.projection||a;this.axes&&(o=this.axes.lastCubeProps.axis);for(var _=s,w=i,k=0;k<3;++k)o&&o[k]<0?(_[k]=this.bounds[0][k],w[k]=this.bounds[1][k]):(_[k]=this.bounds[1][k],w[k]=this.bounds[0][k]);for(u[0]=c.drawingBufferWidth,u[1]=c.drawingBufferHeight,p.uniforms.model=b,p.uniforms.view=l,p.uniforms.projection=T,p.uniforms.coordinates=[this.position,_,w],p.uniforms.colors=this.colors,p.uniforms.screenShape=u,k=0;k<3;++k)p.uniforms.lineWidth=this.lineWidth[k]*this.pixelRatio,this.enabled[k]&&(h.draw(c.TRIANGLES,6,6*k),this.drawSides[k]&&h.draw(c.TRIANGLES,12,18+12*k));h.unbind()},d.update=function(f){f&&("bounds"in f&&(this.bounds=f.bounds),"position"in f&&(this.position=f.position),"lineWidth"in f&&(this.lineWidth=f.lineWidth),"colors"in f&&(this.colors=f.colors),"enabled"in f&&(this.enabled=f.enabled),"drawSides"in f&&(this.drawSides=f.drawSides))},d.dispose=function(){this.vao.dispose(),this.buffer.dispose(),this.shader.dispose()}},{"./shaders/index":140,"gl-buffer":78,"gl-vao":150}],142:[function(v,m,x){var e=v("glslify"),n=e(["precision highp float;\n\nprecision highp float;\n#define GLSLIFY 1\n\nvec3 getOrthogonalVector(vec3 v) {\n  // Return up-vector for only-z vector.\n  // Return ax + by + cz = 0, a point that lies on the plane that has v as a normal and that isn't (0,0,0).\n  // From the above if-statement we have ||a|| > 0  U  ||b|| > 0.\n  // Assign z = 0, x = -b, y = a:\n  // a*-b + b*a + c*0 = -ba + ba + 0 = 0\n  if (v.x*v.x > v.z*v.z || v.y*v.y > v.z*v.z) {\n    return normalize(vec3(-v.y, v.x, 0.0));\n  } else {\n    return normalize(vec3(0.0, v.z, -v.y));\n  }\n}\n\n// Calculate the tube vertex and normal at the given index.\n//\n// The returned vertex is for a tube ring with its center at origin, radius of length(d), pointing in the direction of d.\n//\n// Each tube segment is made up of a ring of vertices.\n// These vertices are used to make up the triangles of the tube by connecting them together in the vertex array.\n// The indexes of tube segments run from 0 to 8.\n//\nvec3 getTubePosition(vec3 d, float index, out vec3 normal) {\n  float segmentCount = 8.0;\n\n  float angle = 2.0 * 3.14159 * (index / segmentCount);\n\n  vec3 u = getOrthogonalVector(d);\n  vec3 v = normalize(cross(u, d));\n\n  vec3 x = u * cos(angle) * length(d);\n  vec3 y = v * sin(angle) * length(d);\n  vec3 v3 = x + y;\n\n  normal = normalize(v3);\n\n  return v3;\n}\n\nattribute vec4 vector;\nattribute vec4 color, position;\nattribute vec2 uv;\n\nuniform float vectorScale, tubeScale;\nuniform mat4 model, view, projection, inverseModel;\nuniform vec3 eyePosition, lightPosition;\n\nvarying vec3 f_normal, f_lightDirection, f_eyeDirection, f_data, f_position;\nvarying vec4 f_color;\nvarying vec2 f_uv;\n\nvoid main() {\n  // Scale the vector magnitude to stay constant with\n  // model & view changes.\n  vec3 normal;\n  vec3 XYZ = getTubePosition(mat3(model) * (tubeScale * vector.w * normalize(vector.xyz)), position.w, normal);\n  vec4 tubePosition = model * vec4(position.xyz, 1.0) + vec4(XYZ, 0.0);\n\n  //Lighting geometry parameters\n  vec4 cameraCoordinate = view * tubePosition;\n  cameraCoordinate.xyz /= cameraCoordinate.w;\n  f_lightDirection = lightPosition - cameraCoordinate.xyz;\n  f_eyeDirection   = eyePosition - cameraCoordinate.xyz;\n  f_normal = normalize((vec4(normal, 0.0) * inverseModel).xyz);\n\n  // vec4 m_position  = model * vec4(tubePosition, 1.0);\n  vec4 t_position  = view * tubePosition;\n  gl_Position      = projection * t_position;\n\n  f_color          = color;\n  f_data           = tubePosition.xyz;\n  f_position       = position.xyz;\n  f_uv             = uv;\n}\n"]),t=e(["#extension GL_OES_standard_derivatives : enable\n\nprecision highp float;\n#define GLSLIFY 1\n\nfloat beckmannDistribution(float x, float roughness) {\n  float NdotH = max(x, 0.0001);\n  float cos2Alpha = NdotH * NdotH;\n  float tan2Alpha = (cos2Alpha - 1.0) / cos2Alpha;\n  float roughness2 = roughness * roughness;\n  float denom = 3.141592653589793 * roughness2 * cos2Alpha * cos2Alpha;\n  return exp(tan2Alpha / roughness2) / denom;\n}\n\nfloat cookTorranceSpecular(\n  vec3 lightDirection,\n  vec3 viewDirection,\n  vec3 surfaceNormal,\n  float roughness,\n  float fresnel) {\n\n  float VdotN = max(dot(viewDirection, surfaceNormal), 0.0);\n  float LdotN = max(dot(lightDirection, surfaceNormal), 0.0);\n\n  //Half angle vector\n  vec3 H = normalize(lightDirection + viewDirection);\n\n  //Geometric term\n  float NdotH = max(dot(surfaceNormal, H), 0.0);\n  float VdotH = max(dot(viewDirection, H), 0.000001);\n  float LdotH = max(dot(lightDirection, H), 0.000001);\n  float G1 = (2.0 * NdotH * VdotN) / VdotH;\n  float G2 = (2.0 * NdotH * LdotN) / LdotH;\n  float G = min(1.0, min(G1, G2));\n  \n  //Distribution term\n  float D = beckmannDistribution(NdotH, roughness);\n\n  //Fresnel term\n  float F = pow(1.0 - VdotN, fresnel);\n\n  //Multiply terms and done\n  return  G * F * D / max(3.14159265 * VdotN, 0.000001);\n}\n\nbool outOfRange(float a, float b, float p) {\n  return ((p > max(a, b)) || \n          (p < min(a, b)));\n}\n\nbool outOfRange(vec2 a, vec2 b, vec2 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y));\n}\n\nbool outOfRange(vec3 a, vec3 b, vec3 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y) ||\n          outOfRange(a.z, b.z, p.z));\n}\n\nbool outOfRange(vec4 a, vec4 b, vec4 p) {\n  return outOfRange(a.xyz, b.xyz, p.xyz);\n}\n\nuniform vec3 clipBounds[2];\nuniform float roughness, fresnel, kambient, kdiffuse, kspecular, opacity;\nuniform sampler2D texture;\n\nvarying vec3 f_normal, f_lightDirection, f_eyeDirection, f_data, f_position;\nvarying vec4 f_color;\nvarying vec2 f_uv;\n\nvoid main() {\n  if (outOfRange(clipBounds[0], clipBounds[1], f_position)) discard;\n  vec3 N = normalize(f_normal);\n  vec3 L = normalize(f_lightDirection);\n  vec3 V = normalize(f_eyeDirection);\n\n  if(gl_FrontFacing) {\n    N = -N;\n  }\n\n  float specular = min(1.0, max(0.0, cookTorranceSpecular(L, V, N, roughness, fresnel)));\n  float diffuse  = min(kambient + kdiffuse * max(dot(N, L), 0.0), 1.0);\n\n  vec4 surfaceColor = f_color * texture2D(texture, f_uv);\n  vec4 litColor = surfaceColor.a * vec4(diffuse * surfaceColor.rgb + kspecular * vec3(1,1,1) * specular,  1.0);\n\n  gl_FragColor = litColor * opacity;\n}\n"]),a=e(["precision highp float;\n\nprecision highp float;\n#define GLSLIFY 1\n\nvec3 getOrthogonalVector(vec3 v) {\n  // Return up-vector for only-z vector.\n  // Return ax + by + cz = 0, a point that lies on the plane that has v as a normal and that isn't (0,0,0).\n  // From the above if-statement we have ||a|| > 0  U  ||b|| > 0.\n  // Assign z = 0, x = -b, y = a:\n  // a*-b + b*a + c*0 = -ba + ba + 0 = 0\n  if (v.x*v.x > v.z*v.z || v.y*v.y > v.z*v.z) {\n    return normalize(vec3(-v.y, v.x, 0.0));\n  } else {\n    return normalize(vec3(0.0, v.z, -v.y));\n  }\n}\n\n// Calculate the tube vertex and normal at the given index.\n//\n// The returned vertex is for a tube ring with its center at origin, radius of length(d), pointing in the direction of d.\n//\n// Each tube segment is made up of a ring of vertices.\n// These vertices are used to make up the triangles of the tube by connecting them together in the vertex array.\n// The indexes of tube segments run from 0 to 8.\n//\nvec3 getTubePosition(vec3 d, float index, out vec3 normal) {\n  float segmentCount = 8.0;\n\n  float angle = 2.0 * 3.14159 * (index / segmentCount);\n\n  vec3 u = getOrthogonalVector(d);\n  vec3 v = normalize(cross(u, d));\n\n  vec3 x = u * cos(angle) * length(d);\n  vec3 y = v * sin(angle) * length(d);\n  vec3 v3 = x + y;\n\n  normal = normalize(v3);\n\n  return v3;\n}\n\nattribute vec4 vector;\nattribute vec4 position;\nattribute vec4 id;\n\nuniform mat4 model, view, projection;\nuniform float tubeScale;\n\nvarying vec3 f_position;\nvarying vec4 f_id;\n\nvoid main() {\n  vec3 normal;\n  vec3 XYZ = getTubePosition(mat3(model) * (tubeScale * vector.w * normalize(vector.xyz)), position.w, normal);\n  vec4 tubePosition = model * vec4(position.xyz, 1.0) + vec4(XYZ, 0.0);\n\n  gl_Position = projection * view * tubePosition;\n  f_id        = id;\n  f_position  = position.xyz;\n}\n"]),r=e(["precision highp float;\n#define GLSLIFY 1\n\nbool outOfRange(float a, float b, float p) {\n  return ((p > max(a, b)) || \n          (p < min(a, b)));\n}\n\nbool outOfRange(vec2 a, vec2 b, vec2 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y));\n}\n\nbool outOfRange(vec3 a, vec3 b, vec3 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y) ||\n          outOfRange(a.z, b.z, p.z));\n}\n\nbool outOfRange(vec4 a, vec4 b, vec4 p) {\n  return outOfRange(a.xyz, b.xyz, p.xyz);\n}\n\nuniform vec3  clipBounds[2];\nuniform float pickId;\n\nvarying vec3 f_position;\nvarying vec4 f_id;\n\nvoid main() {\n  if (outOfRange(clipBounds[0], clipBounds[1], f_position)) discard;\n\n  gl_FragColor = vec4(pickId, f_id.xyz);\n}"]);x.meshShader={vertex:n,fragment:t,attributes:[{name:"position",type:"vec4"},{name:"color",type:"vec4"},{name:"uv",type:"vec2"},{name:"vector",type:"vec4"}]},x.pickShader={vertex:a,fragment:r,attributes:[{name:"position",type:"vec4"},{name:"id",type:"vec4"},{name:"vector",type:"vec4"}]}},{glslify:231}],143:[function(v,m,x){"use strict";var e=v("gl-vec3"),n=v("gl-vec4"),t=["xyz","xzy","yxz","yzx","zxy","zyx"],r=function(f,c){var h,p=f.length;for(h=0;h<p;h++){var o=f[h];if(o===c)return h;if(o>c)return h-1}return h},d=function(f,c,h){return f<c?c:f>h?h:f},s=function(f){var c=1/0;f.sort(function(b,l){return b-l});for(var h=f.length,p=1;p<h;p++){var o=Math.abs(f[p]-f[p-1]);o<c&&(c=o)}return c};m.exports=function(f,c){var h=f.startingPositions,p=f.maxLength||1e3,o=f.tubeSize||1,b=f.absoluteTubeSize,l=f.gridFill||"+x+y+z",T={};-1!==l.indexOf("-x")&&(T.reversedX=!0),-1!==l.indexOf("-y")&&(T.reversedY=!0),-1!==l.indexOf("-z")&&(T.reversedZ=!0),T.filled=t.indexOf(l.replace(/-/g,"").replace(/\+/g,""));var oe,de,se,ge,_=f.getVelocity||function(oe){return function(de,se,ge){var _e=se.vectors,Te=se.meshgrid,we=de[0],Oe=de[1],fe=de[2],ve=Te[0].length,Ae=Te[1].length,ke=Te[2].length,Pe=r(Te[0],we),Ne=r(Te[1],Oe),De=r(Te[2],fe),ze=Pe+1,Me=Ne+1,Se=De+1;if(Pe=d(Pe,0,ve-1),ze=d(ze,0,ve-1),Ne=d(Ne,0,Ae-1),Me=d(Me,0,Ae-1),De=d(De,0,ke-1),Se=d(Se,0,ke-1),Pe<0||Ne<0||De<0||ze>ve-1||Me>Ae-1||Se>ke-1)return e.create();var Ie,Fe,Re,Xe,nt,ct,xt=Te[0][Pe],tt=Te[1][Ne],mt=Te[2][De],Bt=(we-xt)/(Te[0][ze]-xt),Ut=(Oe-tt)/(Te[1][Me]-tt),er=(fe-mt)/(Te[2][Se]-mt);switch(isFinite(Bt)||(Bt=.5),isFinite(Ut)||(Ut=.5),isFinite(er)||(er=.5),ge.reversedX&&(Pe=ve-1-Pe,ze=ve-1-ze),ge.reversedY&&(Ne=Ae-1-Ne,Me=Ae-1-Me),ge.reversedZ&&(De=ke-1-De,Se=ke-1-Se),ge.filled){case 5:nt=De,ct=Se,Re=Ne*ke,Xe=Me*ke,Ie=Pe*ke*Ae,Fe=ze*ke*Ae;break;case 4:nt=De,ct=Se,Ie=Pe*ke,Fe=ze*ke,Re=Ne*ke*ve,Xe=Me*ke*ve;break;case 3:Re=Ne,Xe=Me,nt=De*Ae,ct=Se*Ae,Ie=Pe*Ae*ke,Fe=ze*Ae*ke;break;case 2:Re=Ne,Xe=Me,Ie=Pe*Ae,Fe=ze*Ae,nt=De*Ae*ve,ct=Se*Ae*ve;break;case 1:Ie=Pe,Fe=ze,nt=De*ve,ct=Se*ve,Re=Ne*ve*ke,Xe=Me*ve*ke;break;default:Ie=Pe,Fe=ze,Re=Ne*ve,Xe=Me*ve,nt=De*ve*Ae,ct=Se*ve*Ae}var Wt=_e[Ie+Re+nt],rr=_e[Ie+Re+ct],Ht=_e[Ie+Xe+nt],Ve=_e[Ie+Xe+ct],We=_e[Fe+Re+nt],he=_e[Fe+Re+ct],ye=_e[Fe+Xe+nt],Be=_e[Fe+Xe+ct],Ge=e.create(),Je=e.create(),He=e.create(),st=e.create();e.lerp(Ge,Wt,We,Bt),e.lerp(Je,rr,he,Bt),e.lerp(He,Ht,ye,Bt),e.lerp(st,Ve,Be,Bt);var ot=e.create(),wt=e.create();e.lerp(ot,Ge,He,Ut),e.lerp(wt,Je,st,Ut);var Ct=e.create();return e.lerp(Ct,ot,wt,er),Ct}(oe,f,T)},w=f.getDivergence||function(oe,de){var se=e.create(),ge=1e-4;e.add(se,oe,[ge,0,0]);var _e=_(se);e.subtract(_e,_e,de),e.scale(_e,_e,1/ge),e.add(se,oe,[0,ge,0]);var Te=_(se);e.subtract(Te,Te,de),e.scale(Te,Te,1/ge),e.add(se,oe,[0,0,ge]);var we=_(se);return e.subtract(we,we,de),e.scale(we,we,1/ge),e.add(se,_e,Te),e.add(se,se,we),se},k=[],L=c[0][0],M=c[0][1],I=c[0][2],P=c[1][0],S=c[1][1],E=c[1][2],R=10*e.distance(c[0],c[1])/p,q=R*R,V=1,W=0,K=h.length;K>1&&(V=function(oe){for(var de=[],se=[],ge=[],_e={},Te={},we={},Oe=oe.length,fe=0;fe<Oe;fe++){var ve=oe[fe],Ae=ve[0],ke=ve[1],Pe=ve[2];_e[Ae]||(de.push(Ae),_e[Ae]=!0),Te[ke]||(se.push(ke),Te[ke]=!0),we[Pe]||(ge.push(Pe),we[Pe]=!0)}var Ne=s(de),De=s(se),ze=s(ge),Me=Math.min(Ne,De,ze);return isFinite(Me)?Me:1}(h));for(var G=0;G<K;G++){var Y=e.create();e.copy(Y,h[G]);var $=[Y],B=[],N=_(Y),U=Y;B.push(N);var te=[],j=w(Y,N),J=e.length(j);isFinite(J)&&J>W&&(W=J),te.push(J),k.push({points:$,velocities:B,divergences:te});for(var X=0;X<100*p&&$.length<p&&(de=void 0,se=void 0,ge=void 0,se=(oe=Y)[1],ge=oe[2],!((de=oe[0])<L||de>P||se<M||se>S||ge<I||ge>E));){X++;var re=e.clone(N),ne=e.squaredLength(re);if(0===ne)break;ne>q&&e.scale(re,re,R/Math.sqrt(ne)),e.add(re,re,Y),N=_(re),e.squaredDistance(U,re)-q>-1e-4*q&&($.push(re),U=re,B.push(N),j=w(re,N),J=e.length(j),isFinite(J)&&J>W&&(W=J),te.push(J)),Y=re}}var le=function(f,c,h,p){for(var o=0,b=0;b<f.length;b++)for(var l=f[b].velocities,T=0;T<l.length;T++)o=Math.max(o,e.length(l[T]));var _=f.map(function(R){return function(q,V,W,K){for(var G=q.points,Y=q.velocities,$=q.divergences,B=[],N=[],U=[],te=[],j=[],J=[],X=0,re=0,ne=n.create(),le=n.create(),oe=0;oe<G.length;oe++){var de=G[oe],se=Y[oe],ge=$[oe];0===V&&(ge=.05*W),re=e.length(se)/K,ne=n.create(),e.copy(ne,se),ne[3]=ge;for(var _e=0;_e<8;_e++)j[_e]=[de[0],de[1],de[2],_e];if(te.length>0)for(_e=0;_e<8;_e++){var Te=(_e+1)%8;B.push(te[_e],j[_e],j[Te],j[Te],te[Te],te[_e]),U.push(le,ne,ne,ne,le,le),J.push(X,re,re,re,X,X);var we=B.length;N.push([we-6,we-5,we-4],[we-3,we-2,we-1])}var Oe=te;te=j,j=Oe;var fe=le;le=ne,ne=fe;var ve=X;X=re,re=ve}return{positions:B,cells:N,vectors:U,vertexIntensity:J}}(R,h,p,o)}),w=[],k=[],L=[],M=[];for(b=0;b<_.length;b++){var I=_[b],P=w.length;for(w=w.concat(I.positions),L=L.concat(I.vectors),M=M.concat(I.vertexIntensity),T=0;T<I.cells.length;T++){var S=I.cells[T],E=[];k.push(E);for(var z=0;z<S.length;z++)E.push(S[z]+P)}}return{positions:w,cells:k,vectors:L,vertexIntensity:M,colormap:c}}(k,f.colormap,W,V);return b?le.tubeScale=b:(0===W&&(W=1),le.tubeScale=.5*o*V/W),le};var i=v("./lib/shaders"),u=v("gl-cone3d").createMesh;m.exports.createTubeMesh=function(f,c){return u(f,c,{shaders:i,traceType:"streamtube"})}},{"./lib/shaders":142,"gl-cone3d":79,"gl-vec3":169,"gl-vec4":205}],144:[function(v,m,x){var e=v("gl-shader"),n=v("glslify"),t=n(["precision highp float;\n#define GLSLIFY 1\n\nattribute vec4 uv;\nattribute vec3 f;\nattribute vec3 normal;\n\nuniform vec3 objectOffset;\nuniform mat4 model, view, projection, inverseModel;\nuniform vec3 lightPosition, eyePosition;\nuniform sampler2D colormap;\n\nvarying float value, kill;\nvarying vec3 worldCoordinate;\nvarying vec2 planeCoordinate;\nvarying vec3 lightDirection, eyeDirection, surfaceNormal;\nvarying vec4 vColor;\n\nvoid main() {\n  vec3 localCoordinate = vec3(uv.zw, f.x);\n  worldCoordinate = objectOffset + localCoordinate;\n  vec4 worldPosition = model * vec4(worldCoordinate, 1.0);\n  vec4 clipPosition = projection * view * worldPosition;\n  gl_Position = clipPosition;\n  kill = f.y;\n  value = f.z;\n  planeCoordinate = uv.xy;\n\n  vColor = texture2D(colormap, vec2(value, value));\n\n  //Lighting geometry parameters\n  vec4 cameraCoordinate = view * worldPosition;\n  cameraCoordinate.xyz /= cameraCoordinate.w;\n  lightDirection = lightPosition - cameraCoordinate.xyz;\n  eyeDirection   = eyePosition - cameraCoordinate.xyz;\n  surfaceNormal  = normalize((vec4(normal,0) * inverseModel).xyz);\n}\n"]),a=n(["precision highp float;\n#define GLSLIFY 1\n\nfloat beckmannDistribution(float x, float roughness) {\n  float NdotH = max(x, 0.0001);\n  float cos2Alpha = NdotH * NdotH;\n  float tan2Alpha = (cos2Alpha - 1.0) / cos2Alpha;\n  float roughness2 = roughness * roughness;\n  float denom = 3.141592653589793 * roughness2 * cos2Alpha * cos2Alpha;\n  return exp(tan2Alpha / roughness2) / denom;\n}\n\nfloat beckmannSpecular(\n  vec3 lightDirection,\n  vec3 viewDirection,\n  vec3 surfaceNormal,\n  float roughness) {\n  return beckmannDistribution(dot(surfaceNormal, normalize(lightDirection + viewDirection)), roughness);\n}\n\nbool outOfRange(float a, float b, float p) {\n  return ((p > max(a, b)) || \n          (p < min(a, b)));\n}\n\nbool outOfRange(vec2 a, vec2 b, vec2 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y));\n}\n\nbool outOfRange(vec3 a, vec3 b, vec3 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y) ||\n          outOfRange(a.z, b.z, p.z));\n}\n\nbool outOfRange(vec4 a, vec4 b, vec4 p) {\n  return outOfRange(a.xyz, b.xyz, p.xyz);\n}\n\nuniform vec3 lowerBound, upperBound;\nuniform float contourTint;\nuniform vec4 contourColor;\nuniform sampler2D colormap;\nuniform vec3 clipBounds[2];\nuniform float roughness, fresnel, kambient, kdiffuse, kspecular, opacity;\nuniform float vertexColor;\n\nvarying float value, kill;\nvarying vec3 worldCoordinate;\nvarying vec3 lightDirection, eyeDirection, surfaceNormal;\nvarying vec4 vColor;\n\nvoid main() {\n  if (\n    kill > 0.0 ||\n    vColor.a == 0.0 ||\n    outOfRange(clipBounds[0], clipBounds[1], worldCoordinate)\n  ) discard;\n\n  vec3 N = normalize(surfaceNormal);\n  vec3 V = normalize(eyeDirection);\n  vec3 L = normalize(lightDirection);\n\n  if(gl_FrontFacing) {\n    N = -N;\n  }\n\n  float specular = max(beckmannSpecular(L, V, N, roughness), 0.);\n  float diffuse  = min(kambient + kdiffuse * max(dot(N, L), 0.0), 1.0);\n\n  //decide how to interpolate color \u2014 in vertex or in fragment\n  vec4 surfaceColor =\n    step(vertexColor, .5) * texture2D(colormap, vec2(value, value)) +\n    step(.5, vertexColor) * vColor;\n\n  vec4 litColor = surfaceColor.a * vec4(diffuse * surfaceColor.rgb + kspecular * vec3(1,1,1) * specular,  1.0);\n\n  gl_FragColor = mix(litColor, contourColor, contourTint) * opacity;\n}\n"]),r=n(["precision highp float;\n#define GLSLIFY 1\n\nattribute vec4 uv;\nattribute float f;\n\nuniform vec3 objectOffset;\nuniform mat3 permutation;\nuniform mat4 model, view, projection;\nuniform float height, zOffset;\nuniform sampler2D colormap;\n\nvarying float value, kill;\nvarying vec3 worldCoordinate;\nvarying vec2 planeCoordinate;\nvarying vec3 lightDirection, eyeDirection, surfaceNormal;\nvarying vec4 vColor;\n\nvoid main() {\n  vec3 dataCoordinate = permutation * vec3(uv.xy, height);\n  worldCoordinate = objectOffset + dataCoordinate;\n  vec4 worldPosition = model * vec4(worldCoordinate, 1.0);\n\n  vec4 clipPosition = projection * view * worldPosition;\n  clipPosition.z += zOffset;\n\n  gl_Position = clipPosition;\n  value = f + objectOffset.z;\n  kill = -1.0;\n  planeCoordinate = uv.zw;\n\n  vColor = texture2D(colormap, vec2(value, value));\n\n  //Don't do lighting for contours\n  surfaceNormal   = vec3(1,0,0);\n  eyeDirection    = vec3(0,1,0);\n  lightDirection  = vec3(0,0,1);\n}\n"]),d=n(["precision highp float;\n#define GLSLIFY 1\n\nbool outOfRange(float a, float b, float p) {\n  return ((p > max(a, b)) || \n          (p < min(a, b)));\n}\n\nbool outOfRange(vec2 a, vec2 b, vec2 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y));\n}\n\nbool outOfRange(vec3 a, vec3 b, vec3 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y) ||\n          outOfRange(a.z, b.z, p.z));\n}\n\nbool outOfRange(vec4 a, vec4 b, vec4 p) {\n  return outOfRange(a.xyz, b.xyz, p.xyz);\n}\n\nuniform vec2 shape;\nuniform vec3 clipBounds[2];\nuniform float pickId;\n\nvarying float value, kill;\nvarying vec3 worldCoordinate;\nvarying vec2 planeCoordinate;\nvarying vec3 surfaceNormal;\n\nvec2 splitFloat(float v) {\n  float vh = 255.0 * v;\n  float upper = floor(vh);\n  float lower = fract(vh);\n  return vec2(upper / 255.0, floor(lower * 16.0) / 16.0);\n}\n\nvoid main() {\n  if ((kill > 0.0) ||\n      (outOfRange(clipBounds[0], clipBounds[1], worldCoordinate))) discard;\n\n  vec2 ux = splitFloat(planeCoordinate.x / shape.x);\n  vec2 uy = splitFloat(planeCoordinate.y / shape.y);\n  gl_FragColor = vec4(pickId, ux.x, uy.x, ux.y + (uy.y/16.0));\n}\n"]);x.createShader=function(s){var i=e(s,t,a,null,[{name:"uv",type:"vec4"},{name:"f",type:"vec3"},{name:"normal",type:"vec3"}]);return i.attributes.uv.location=0,i.attributes.f.location=1,i.attributes.normal.location=2,i},x.createPickShader=function(s){var i=e(s,t,d,null,[{name:"uv",type:"vec4"},{name:"f",type:"vec3"},{name:"normal",type:"vec3"}]);return i.attributes.uv.location=0,i.attributes.f.location=1,i.attributes.normal.location=2,i},x.createContourShader=function(s){var i=e(s,r,a,null,[{name:"uv",type:"vec4"},{name:"f",type:"float"}]);return i.attributes.uv.location=0,i.attributes.f.location=1,i},x.createPickContourShader=function(s){var i=e(s,r,d,null,[{name:"uv",type:"vec4"},{name:"f",type:"float"}]);return i.attributes.uv.location=0,i.attributes.f.location=1,i}},{"gl-shader":132,glslify:231}],145:[function(v,m,x){"use strict";m.exports=function(N){var U=N.gl,te=l(U),j=_(U),J=T(U),X=w(U),re=n(U),ne=t(U,[{buffer:re,size:4,stride:40,offset:0},{buffer:re,size:3,stride:40,offset:16},{buffer:re,size:3,stride:40,offset:28}]),le=n(U),oe=t(U,[{buffer:le,size:4,stride:20,offset:0},{buffer:le,size:1,stride:20,offset:16}]),de=n(U),se=t(U,[{buffer:de,size:2,type:U.FLOAT}]),ge=a(U,1,256,U.RGBA,U.UNSIGNED_BYTE);ge.minFilter=U.LINEAR,ge.magFilter=U.LINEAR;var _e=new P(U,[0,0],[[0,0,0],[0,0,0]],te,j,re,ne,ge,J,X,le,oe,de,se,[0,0,0]),Te={levels:[[],[],[]]};for(var we in N)Te[we]=N[we];return Te.colormap=Te.colormap||"jet",_e.update(Te),_e};var e=v("bit-twiddle"),n=v("gl-buffer"),t=v("gl-vao"),a=v("gl-texture2d"),r=v("typedarray-pool"),d=v("colormap"),s=v("ndarray-ops"),i=v("ndarray-pack"),u=v("ndarray"),f=v("surface-nets"),c=v("gl-mat4/multiply"),h=v("gl-mat4/invert"),p=v("binary-search-bounds"),o=v("ndarray-gradient"),b=v("./lib/shaders"),l=b.createShader,T=b.createContourShader,_=b.createPickShader,w=b.createPickContourShader,k=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],L=[[0,0],[0,1],[1,0],[1,1],[1,0],[0,1]],M=[[0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0]];function I(N,U,te,j,J){this.position=N,this.index=U,this.uv=te,this.level=j,this.dataCoordinate=J}function P(N,U,te,j,J,X,re,ne,le,oe,de,se,ge,_e,Te){this.gl=N,this.shape=U,this.bounds=te,this.objectOffset=Te,this.intensityBounds=[],this._shader=j,this._pickShader=J,this._coordinateBuffer=X,this._vao=re,this._colorMap=ne,this._contourShader=le,this._contourPickShader=oe,this._contourBuffer=de,this._contourVAO=se,this._contourOffsets=[[],[],[]],this._contourCounts=[[],[],[]],this._vertexCount=0,this._pickResult=new I([0,0,0],[0,0],[0,0],[0,0,0],[0,0,0]),this._dynamicBuffer=ge,this._dynamicVAO=_e,this._dynamicOffsets=[0,0,0],this._dynamicCounts=[0,0,0],this.contourWidth=[1,1,1],this.contourLevels=[[1],[1],[1]],this.contourTint=[0,0,0],this.contourColor=[[.5,.5,.5,1],[.5,.5,.5,1],[.5,.5,.5,1]],this.showContour=!0,this.showSurface=!0,this.enableHighlight=[!0,!0,!0],this.highlightColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.highlightTint=[1,1,1],this.highlightLevel=[-1,-1,-1],this.enableDynamic=[!0,!0,!0],this.dynamicLevel=[NaN,NaN,NaN],this.dynamicColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.dynamicTint=[1,1,1],this.dynamicWidth=[1,1,1],this.axesBounds=[[1/0,1/0,1/0],[-1/0,-1/0,-1/0]],this.surfaceProject=[!1,!1,!1],this.contourProject=[[!1,!1,!1],[!1,!1,!1],[!1,!1,!1]],this.colorBounds=[!1,!1],this._field=[u(r.mallocFloat(1024),[0,0]),u(r.mallocFloat(1024),[0,0]),u(r.mallocFloat(1024),[0,0])],this.pickId=1,this.clipBounds=[[-1/0,-1/0,-1/0],[1/0,1/0,1/0]],this.snapToData=!1,this.pixelRatio=1,this.opacity=1,this.lightPosition=[10,1e4,0],this.ambientLight=.8,this.diffuseLight=.8,this.specularLight=2,this.roughness=.5,this.fresnel=1.5,this.vertexColor=0,this.dirty=!0}!function(){for(var N=0;N<3;++N){var U=M[N],te=(N+2)%3;U[(N+1)%3+0]=1,U[te+3]=1,U[N+6]=1}}();var S=P.prototype;S.genColormap=function(N,U){var te=!1,j=i([d({colormap:N,nshades:256,format:"rgba"}).map(function(J,X){var re=U?function(ne,le){if(!le||!le.length)return 1;for(var oe=0;oe<le.length;++oe){if(le.length<2)return 1;if(le[oe][0]===ne)return le[oe][1];if(le[oe][0]>ne&&oe>0){var de=(le[oe][0]-ne)/(le[oe][0]-le[oe-1][0]);return le[oe][1]*(1-de)+de*le[oe-1][1]}}return 1}(X/255,U):J[3];return re<1&&(te=!0),[J[0],J[1],J[2],255*re]})]);return s.divseq(j,255),this.hasAlphaScale=te,j},S.isTransparent=function(){return this.opacity<1||this.hasAlphaScale},S.isOpaque=function(){return!this.isTransparent()},S.pickSlots=1,S.setPickBase=function(N){this.pickId=N};var E=[0,0,0],z={showSurface:!1,showContour:!1,projections:[k.slice(),k.slice(),k.slice()],clipBounds:[[[0,0,0],[0,0,0]],[[0,0,0],[0,0,0]],[[0,0,0],[0,0,0]]]};function R(N,U){var te,j,J,X=U.axes&&U.axes.lastCubeProps.axis||E,re=U.showSurface,ne=U.showContour;for(te=0;te<3;++te)for(re=re||U.surfaceProject[te],j=0;j<3;++j)ne=ne||U.contourProject[te][j];for(te=0;te<3;++te){var le=z.projections[te];for(j=0;j<16;++j)le[j]=0;for(j=0;j<4;++j)le[5*j]=1;le[5*te]=0,le[12+te]=U.axesBounds[+(X[te]>0)][te],c(le,N.model,le);var oe=z.clipBounds[te];for(J=0;J<2;++J)for(j=0;j<3;++j)oe[J][j]=N.clipBounds[J][j];oe[0][te]=-1e8,oe[1][te]=1e8}return z.showSurface=re,z.showContour=ne,z}var q={model:k,view:k,projection:k,inverseModel:k.slice(),lowerBound:[0,0,0],upperBound:[0,0,0],colorMap:0,clipBounds:[[0,0,0],[0,0,0]],height:0,contourTint:0,contourColor:[0,0,0,1],permutation:[1,0,0,0,1,0,0,0,1],zOffset:-1e-4,objectOffset:[0,0,0],kambient:1,kdiffuse:1,kspecular:1,lightPosition:[1e3,1e3,1e3],eyePosition:[0,0,0],roughness:1,fresnel:1,opacity:1,vertexColor:0},V=k.slice(),W=[1,0,0,0,1,0,0,0,1];function K(N,U){N=N||{};var te=this.gl;te.disable(te.CULL_FACE),this._colorMap.bind(0);var j=q;j.model=N.model||k,j.view=N.view||k,j.projection=N.projection||k,j.lowerBound=[this.bounds[0][0],this.bounds[0][1],this.colorBounds[0]||this.bounds[0][2]],j.upperBound=[this.bounds[1][0],this.bounds[1][1],this.colorBounds[1]||this.bounds[1][2]],j.objectOffset=this.objectOffset,j.contourColor=this.contourColor[0],j.inverseModel=h(j.inverseModel,j.model);for(var J=0;J<2;++J)for(var X=j.clipBounds[J],re=0;re<3;++re)X[re]=Math.min(Math.max(this.clipBounds[J][re],-1e8),1e8);j.kambient=this.ambientLight,j.kdiffuse=this.diffuseLight,j.kspecular=this.specularLight,j.roughness=this.roughness,j.fresnel=this.fresnel,j.opacity=this.opacity,j.height=0,j.permutation=W,j.vertexColor=this.vertexColor;var ne=V;for(c(ne,j.view,j.model),c(ne,j.projection,ne),h(ne,ne),J=0;J<3;++J)j.eyePosition[J]=ne[12+J]/ne[15];var le=ne[15];for(J=0;J<3;++J)le+=this.lightPosition[J]*ne[4*J+3];for(J=0;J<3;++J){var oe=ne[12+J];for(re=0;re<3;++re)oe+=ne[4*re+J]*this.lightPosition[re];j.lightPosition[J]=oe/le}var de=R(j,this);if(de.showSurface){for(this._shader.bind(),this._shader.uniforms=j,this._vao.bind(),this.showSurface&&this._vertexCount&&this._vao.draw(te.TRIANGLES,this._vertexCount),J=0;J<3;++J)this.surfaceProject[J]&&this.vertexCount&&(this._shader.uniforms.model=de.projections[J],this._shader.uniforms.clipBounds=de.clipBounds[J],this._vao.draw(te.TRIANGLES,this._vertexCount));this._vao.unbind()}if(de.showContour){var se=this._contourShader;j.kambient=1,j.kdiffuse=0,j.kspecular=0,j.opacity=1,se.bind(),se.uniforms=j;var ge=this._contourVAO;for(ge.bind(),J=0;J<3;++J)for(se.uniforms.permutation=M[J],te.lineWidth(this.contourWidth[J]*this.pixelRatio),re=0;re<this.contourLevels[J].length;++re)re===this.highlightLevel[J]?(se.uniforms.contourColor=this.highlightColor[J],se.uniforms.contourTint=this.highlightTint[J]):0!==re&&re-1!==this.highlightLevel[J]||(se.uniforms.contourColor=this.contourColor[J],se.uniforms.contourTint=this.contourTint[J]),this._contourCounts[J][re]&&(se.uniforms.height=this.contourLevels[J][re],ge.draw(te.LINES,this._contourCounts[J][re],this._contourOffsets[J][re]));for(J=0;J<3;++J)for(se.uniforms.model=de.projections[J],se.uniforms.clipBounds=de.clipBounds[J],re=0;re<3;++re)if(this.contourProject[J][re]){se.uniforms.permutation=M[re],te.lineWidth(this.contourWidth[re]*this.pixelRatio);for(var _e=0;_e<this.contourLevels[re].length;++_e)_e===this.highlightLevel[re]?(se.uniforms.contourColor=this.highlightColor[re],se.uniforms.contourTint=this.highlightTint[re]):0!==_e&&_e-1!==this.highlightLevel[re]||(se.uniforms.contourColor=this.contourColor[re],se.uniforms.contourTint=this.contourTint[re]),this._contourCounts[re][_e]&&(se.uniforms.height=this.contourLevels[re][_e],ge.draw(te.LINES,this._contourCounts[re][_e],this._contourOffsets[re][_e]))}for(ge.unbind(),(ge=this._dynamicVAO).bind(),J=0;J<3;++J)if(0!==this._dynamicCounts[J])for(se.uniforms.model=j.model,se.uniforms.clipBounds=j.clipBounds,se.uniforms.permutation=M[J],te.lineWidth(this.dynamicWidth[J]*this.pixelRatio),se.uniforms.contourColor=this.dynamicColor[J],se.uniforms.contourTint=this.dynamicTint[J],se.uniforms.height=this.dynamicLevel[J],ge.draw(te.LINES,this._dynamicCounts[J],this._dynamicOffsets[J]),re=0;re<3;++re)this.contourProject[re][J]&&(se.uniforms.model=de.projections[re],se.uniforms.clipBounds=de.clipBounds[re],ge.draw(te.LINES,this._dynamicCounts[J],this._dynamicOffsets[J]));ge.unbind()}}S.draw=function(N){return K.call(this,N,!1)},S.drawTransparent=function(N){return K.call(this,N,!0)};var G={model:k,view:k,projection:k,inverseModel:k,clipBounds:[[0,0,0],[0,0,0]],height:0,shape:[0,0],pickId:0,lowerBound:[0,0,0],upperBound:[0,0,0],zOffset:0,objectOffset:[0,0,0],permutation:[1,0,0,0,1,0,0,0,1],lightPosition:[0,0,0],eyePosition:[0,0,0]};function Y(N,U){return Array.isArray(N)?[U(N[0]),U(N[1]),U(N[2])]:[U(N),U(N),U(N)]}function $(N){return Array.isArray(N)?3===N.length?[N[0],N[1],N[2],1]:[N[0],N[1],N[2],N[3]]:[0,0,0,1]}function B(N){if(Array.isArray(N)){if(Array.isArray(N))return[$(N[0]),$(N[1]),$(N[2])];var U=$(N);return[U.slice(),U.slice(),U.slice()]}}S.drawPick=function(N){N=N||{};var U=this.gl;U.disable(U.CULL_FACE);var te=G;te.model=N.model||k,te.view=N.view||k,te.projection=N.projection||k,te.shape=this._field[2].shape,te.pickId=this.pickId/255,te.lowerBound=this.bounds[0],te.upperBound=this.bounds[1],te.objectOffset=this.objectOffset,te.permutation=W;for(var j=0;j<2;++j)for(var J=te.clipBounds[j],X=0;X<3;++X)J[X]=Math.min(Math.max(this.clipBounds[j][X],-1e8),1e8);var re=R(te,this);if(re.showSurface){for(this._pickShader.bind(),this._pickShader.uniforms=te,this._vao.bind(),this._vao.draw(U.TRIANGLES,this._vertexCount),j=0;j<3;++j)this.surfaceProject[j]&&(this._pickShader.uniforms.model=re.projections[j],this._pickShader.uniforms.clipBounds=re.clipBounds[j],this._vao.draw(U.TRIANGLES,this._vertexCount));this._vao.unbind()}if(re.showContour){var ne=this._contourPickShader;ne.bind(),ne.uniforms=te;var le=this._contourVAO;for(le.bind(),X=0;X<3;++X)for(U.lineWidth(this.contourWidth[X]*this.pixelRatio),ne.uniforms.permutation=M[X],j=0;j<this.contourLevels[X].length;++j)this._contourCounts[X][j]&&(ne.uniforms.height=this.contourLevels[X][j],le.draw(U.LINES,this._contourCounts[X][j],this._contourOffsets[X][j]));for(j=0;j<3;++j)for(ne.uniforms.model=re.projections[j],ne.uniforms.clipBounds=re.clipBounds[j],X=0;X<3;++X)if(this.contourProject[j][X]){ne.uniforms.permutation=M[X],U.lineWidth(this.contourWidth[X]*this.pixelRatio);for(var oe=0;oe<this.contourLevels[X].length;++oe)this._contourCounts[X][oe]&&(ne.uniforms.height=this.contourLevels[X][oe],le.draw(U.LINES,this._contourCounts[X][oe],this._contourOffsets[X][oe]))}le.unbind()}},S.pick=function(N){if(!N||N.id!==this.pickId)return null;var U=this._field[2].shape,te=this._pickResult,j=U[0]*(N.value[0]+(N.value[2]>>4)/16)/255,J=Math.floor(j),X=j-J,re=U[1]*(N.value[1]+(15&N.value[2])/16)/255,ne=Math.floor(re),le=re-ne;J+=1,ne+=1;var oe=te.position;oe[0]=oe[1]=oe[2]=0;for(var de=0;de<2;++de)for(var se=de?X:1-X,ge=0;ge<2;++ge)for(var _e=J+de,Te=ne+ge,we=se*(ge?le:1-le),Oe=0;Oe<3;++Oe)oe[Oe]+=this._field[Oe].get(_e,Te)*we;for(var fe=this._pickResult.level,ve=0;ve<3;++ve)if(fe[ve]=p.le(this.contourLevels[ve],oe[ve]),fe[ve]<0)this.contourLevels[ve].length>0&&(fe[ve]=0);else if(fe[ve]<this.contourLevels[ve].length-1){var ke=this.contourLevels[ve][fe[ve]+1];Math.abs(this.contourLevels[ve][fe[ve]]-oe[ve])>Math.abs(ke-oe[ve])&&(fe[ve]+=1)}for(te.index[0]=X<.5?J:J+1,te.index[1]=le<.5?ne:ne+1,te.uv[0]=j/U[0],te.uv[1]=re/U[1],Oe=0;Oe<3;++Oe)te.dataCoordinate[Oe]=this._field[Oe].get(te.index[0],te.index[1]);return te},S.padField=function(N,U){var te=U.shape.slice(),j=N.shape.slice();s.assign(N.lo(1,1).hi(te[0],te[1]),U),s.assign(N.lo(1).hi(te[0],1),U.hi(te[0],1)),s.assign(N.lo(1,j[1]-1).hi(te[0],1),U.lo(0,te[1]-1).hi(te[0],1)),s.assign(N.lo(0,1).hi(1,te[1]),U.hi(1)),s.assign(N.lo(j[0]-1,1).hi(1,te[1]),U.lo(te[0]-1)),N.set(0,0,U.get(0,0)),N.set(0,j[1]-1,U.get(0,te[1]-1)),N.set(j[0]-1,0,U.get(te[0]-1,0)),N.set(j[0]-1,j[1]-1,U.get(te[0]-1,te[1]-1))},S.update=function(N){this.objectOffset=(N=N||{}).objectOffset||this.objectOffset,this.dirty=!0,"contourWidth"in N&&(this.contourWidth=Y(N.contourWidth,Number)),"showContour"in N&&(this.showContour=Y(N.showContour,Boolean)),"showSurface"in N&&(this.showSurface=!!N.showSurface),"contourTint"in N&&(this.contourTint=Y(N.contourTint,Boolean)),"contourColor"in N&&(this.contourColor=B(N.contourColor)),"contourProject"in N&&(this.contourProject=Y(N.contourProject,function(Gt){return Y(Gt,Boolean)})),"surfaceProject"in N&&(this.surfaceProject=N.surfaceProject),"dynamicColor"in N&&(this.dynamicColor=B(N.dynamicColor)),"dynamicTint"in N&&(this.dynamicTint=Y(N.dynamicTint,Number)),"dynamicWidth"in N&&(this.dynamicWidth=Y(N.dynamicWidth,Number)),"opacity"in N&&(this.opacity=N.opacity),"opacityscale"in N&&(this.opacityscale=N.opacityscale),"colorBounds"in N&&(this.colorBounds=N.colorBounds),"vertexColor"in N&&(this.vertexColor=N.vertexColor?1:0),"colormap"in N&&this._colorMap.setPixels(this.genColormap(N.colormap,this.opacityscale));var U=N.field||N.coords&&N.coords[2]||null,te=!1;if(U||(U=this._field[2].shape[0]||this._field[2].shape[2]?this._field[2].lo(1,1).hi(this._field[2].shape[0]-2,this._field[2].shape[1]-2):this._field[2].hi(0,0)),"field"in N||"coords"in N){var j=(U.shape[0]+2)*(U.shape[1]+2);j>this._field[2].data.length&&(r.freeFloat(this._field[2].data),this._field[2].data=r.mallocFloat(e.nextPow2(j))),this._field[2]=u(this._field[2].data,[U.shape[0]+2,U.shape[1]+2]),this.padField(this._field[2],U),this.shape=U.shape.slice();for(var J=this.shape,X=0;X<2;++X)this._field[2].size>this._field[X].data.length&&(r.freeFloat(this._field[X].data),this._field[X].data=r.mallocFloat(this._field[2].size)),this._field[X]=u(this._field[X].data,[J[0]+2,J[1]+2]);if(N.coords){var re=N.coords;if(!Array.isArray(re)||3!==re.length)throw new Error("gl-surface: invalid coordinates for x/y");for(X=0;X<2;++X){var ne=re[X];for(ge=0;ge<2;++ge)if(ne.shape[ge]!==J[ge])throw new Error("gl-surface: coords have incorrect shape");this.padField(this._field[X],ne)}}else if(N.ticks){var le=N.ticks;if(!Array.isArray(le)||2!==le.length)throw new Error("gl-surface: invalid ticks");for(X=0;X<2;++X){var oe=le[X];if((Array.isArray(oe)||oe.length)&&(oe=u(oe)),oe.shape[0]!==J[X])throw new Error("gl-surface: invalid tick length");var de=u(oe.data,J);de.stride[X]=oe.stride[0],de.stride[1^X]=0,this.padField(this._field[X],de)}}else{for(X=0;X<2;++X){var se=[0,0];se[X]=1,this._field[X]=u(this._field[X].data,[J[0]+2,J[1]+2],se,0)}this._field[0].set(0,0,0);for(var ge=0;ge<J[0];++ge)this._field[0].set(ge+1,0,ge);for(this._field[0].set(J[0]+1,0,J[0]-1),this._field[1].set(0,0,0),ge=0;ge<J[1];++ge)this._field[1].set(0,ge+1,ge);this._field[1].set(0,J[1]+1,J[1]-1)}var _e=this._field,Te=u(r.mallocFloat(3*_e[2].size*2),[3,J[0]+2,J[1]+2,2]);for(X=0;X<3;++X)o(Te.pick(X),_e[X],"mirror");var we=u(r.mallocFloat(3*_e[2].size),[J[0]+2,J[1]+2,3]);for(X=0;X<J[0]+2;++X)for(ge=0;ge<J[1]+2;++ge){var Oe=Te.get(0,X,ge,0),fe=Te.get(0,X,ge,1),ve=Te.get(1,X,ge,0),Ae=Te.get(1,X,ge,1),ke=Te.get(2,X,ge,0),Pe=Te.get(2,X,ge,1),Ne=ve*Pe-Ae*ke,De=ke*fe-Pe*Oe,ze=Oe*Ae-fe*ve,Me=Math.sqrt(Ne*Ne+De*De+ze*ze);Me<1e-8?(Me=Math.max(Math.abs(Ne),Math.abs(De),Math.abs(ze)))<1e-8?(ze=1,De=Ne=0,Me=1):Me=1/Me:Me=1/Math.sqrt(Me),we.set(X,ge,0,Ne*Me),we.set(X,ge,1,De*Me),we.set(X,ge,2,ze*Me)}r.free(Te.data);var Se=[1/0,1/0,1/0],Ie=[-1/0,-1/0,-1/0],Fe=1/0,Re=-1/0,nt=r.mallocFloat(e.nextPow2((J[0]-1)*(J[1]-1)*6*10)),ct=0,xt=0;for(X=0;X<J[0]-1;++X)e:for(ge=0;ge<J[1]-1;++ge){for(var dt=0;dt<2;++dt)for(var tt=0;tt<2;++tt)for(var Ke=0;Ke<3;++Ke){var mt=this._field[Ke].get(1+X+dt,1+ge+tt);if(isNaN(mt)||!isFinite(mt))continue e}for(Ke=0;Ke<6;++Ke){var Bt=X+L[Ke][0],Ut=ge+L[Ke][1],er=this._field[0].get(Bt+1,Ut+1),Wt=this._field[1].get(Bt+1,Ut+1);mt=this._field[2].get(Bt+1,Ut+1),Ne=we.get(Bt+1,Ut+1,0),De=we.get(Bt+1,Ut+1,1),ze=we.get(Bt+1,Ut+1,2),N.intensity&&(rr=N.intensity.get(Bt,Ut));var rr=N.intensity?N.intensity.get(Bt,Ut):mt+this.objectOffset[2];nt[ct++]=Bt,nt[ct++]=Ut,nt[ct++]=er,nt[ct++]=Wt,nt[ct++]=mt,nt[ct++]=0,nt[ct++]=rr,nt[ct++]=Ne,nt[ct++]=De,nt[ct++]=ze,Se[0]=Math.min(Se[0],er+this.objectOffset[0]),Se[1]=Math.min(Se[1],Wt+this.objectOffset[1]),Se[2]=Math.min(Se[2],mt+this.objectOffset[2]),Fe=Math.min(Fe,rr),Ie[0]=Math.max(Ie[0],er+this.objectOffset[0]),Ie[1]=Math.max(Ie[1],Wt+this.objectOffset[1]),Ie[2]=Math.max(Ie[2],mt+this.objectOffset[2]),Re=Math.max(Re,rr),xt+=1}}for(N.intensityBounds&&(Fe=+N.intensityBounds[0],Re=+N.intensityBounds[1]),X=6;X<ct;X+=10)nt[X]=(nt[X]-Fe)/(Re-Fe);this._vertexCount=xt,this._coordinateBuffer.update(nt.subarray(0,ct)),r.freeFloat(nt),r.free(we.data),this.bounds=[Se,Ie],this.intensity=N.intensity||this._field[2],this.intensityBounds[0]===Fe&&this.intensityBounds[1]===Re||(te=!0),this.intensityBounds=[Fe,Re]}if("levels"in N){var Ht=N.levels;for(Ht=Array.isArray(Ht[0])?Ht.slice():[[],[],Ht],X=0;X<3;++X)Ht[X]=Ht[X].slice(),Ht[X].sort(function(Gt,jt){return Gt-jt});for(X=0;X<3;++X)for(ge=0;ge<Ht[X].length;++ge)Ht[X][ge]-=this.objectOffset[X];e:for(X=0;X<3;++X){if(Ht[X].length!==this.contourLevels[X].length){te=!0;break}for(ge=0;ge<Ht[X].length;++ge)if(Ht[X][ge]!==this.contourLevels[X][ge]){te=!0;break e}}this.contourLevels=Ht}if(te){_e=this._field,J=this.shape;for(var Ve=[],We=0;We<3;++We){var he=this.contourLevels[We],ye=[],Be=[],Ge=[0,0,0];for(X=0;X<he.length;++X){var Je=f(this._field[We],he[X]);ye.push(Ve.length/5|0),xt=0;e:for(ge=0;ge<Je.cells.length;++ge){var He=Je.cells[ge];for(Ke=0;Ke<2;++Ke){var st=Je.positions[He[Ke]],ot=st[0],wt=0|Math.floor(ot),Ct=ot-wt,rt=st[1],ft=0|Math.floor(rt),Rt=rt-ft,kt=!1;t:for(var Lt=0;Lt<3;++Lt){Ge[Lt]=0;var Ee=(We+Lt+1)%3;for(dt=0;dt<2;++dt){var Ye=dt?Ct:1-Ct;for(Bt=0|Math.min(Math.max(wt+dt,0),J[0]),tt=0;tt<2;++tt){var it=tt?Rt:1-Rt;if(Ut=0|Math.min(Math.max(ft+tt,0),J[1]),mt=Lt<2?this._field[Ee].get(Bt,Ut):(this.intensity.get(Bt,Ut)-this.intensityBounds[0])/(this.intensityBounds[1]-this.intensityBounds[0]),!isFinite(mt)||isNaN(mt)){kt=!0;break t}Ge[Lt]+=Ye*it*mt}}}if(kt){if(Ke>0){for(var At=0;At<5;++At)Ve.pop();xt-=1}continue e}Ve.push(Ge[0],Ge[1],st[0],st[1],Ge[2]),xt+=1}}Be.push(xt)}this._contourOffsets[We]=ye,this._contourCounts[We]=Be}var Ft=r.mallocFloat(Ve.length);for(X=0;X<Ve.length;++X)Ft[X]=Ve[X];this._contourBuffer.update(Ft),r.freeFloat(Ft)}},S.dispose=function(){this._shader.dispose(),this._vao.dispose(),this._coordinateBuffer.dispose(),this._colorMap.dispose(),this._contourBuffer.dispose(),this._contourVAO.dispose(),this._contourShader.dispose(),this._contourPickShader.dispose(),this._dynamicBuffer.dispose(),this._dynamicVAO.dispose();for(var N=0;N<3;++N)r.freeFloat(this._field[N].data)},S.highlight=function(N){var U,te;if(!N)return this._dynamicCounts=[0,0,0],this.dyanamicLevel=[NaN,NaN,NaN],void(this.highlightLevel=[-1,-1,-1]);for(U=0;U<3;++U)this.highlightLevel[U]=this.enableHighlight[U]?N.level[U]:-1;for(te=this.snapToData?N.dataCoordinate:N.position,U=0;U<3;++U)te[U]-=this.objectOffset[U];if(this.enableDynamic[0]&&te[0]!==this.dynamicLevel[0]||this.enableDynamic[1]&&te[1]!==this.dynamicLevel[1]||this.enableDynamic[2]&&te[2]!==this.dynamicLevel[2]){for(var j=0,J=this.shape,X=r.mallocFloat(12*J[0]*J[1]),re=0;re<3;++re)if(this.enableDynamic[re]){this.dynamicLevel[re]=te[re];var de=this._field[(re+1)%3],se=this._field[(re+2)%3],ge=f(this._field[re],te[re]),_e=ge.cells,Te=ge.positions;for(this._dynamicOffsets[re]=j,U=0;U<_e.length;++U)for(var we=_e[U],Oe=0;Oe<2;++Oe){var fe=Te[we[Oe]],ve=+fe[0],Ae=0|ve,ke=0|Math.min(Ae+1,J[0]),Pe=ve-Ae,Ne=1-Pe,De=+fe[1],ze=0|De,Me=0|Math.min(ze+1,J[1]),Se=De-ze,Ie=1-Se,Fe=Ne*Ie,Re=Ne*Se,Xe=Pe*Ie,nt=Pe*Se,ct=Fe*de.get(Ae,ze)+Re*de.get(Ae,Me)+Xe*de.get(ke,ze)+nt*de.get(ke,Me),xt=Fe*se.get(Ae,ze)+Re*se.get(Ae,Me)+Xe*se.get(ke,ze)+nt*se.get(ke,Me);if(isNaN(ct)||isNaN(xt)){Oe&&(j-=1);break}X[2*j+0]=ct,X[2*j+1]=xt,j+=1}this._dynamicCounts[re]=j-this._dynamicOffsets[re]}else this.dynamicLevel[re]=NaN,this._dynamicCounts[re]=0;this._dynamicBuffer.update(X.subarray(0,2*j)),r.freeFloat(X)}}},{"./lib/shaders":144,"binary-search-bounds":31,"bit-twiddle":32,colormap:53,"gl-buffer":78,"gl-mat4/invert":98,"gl-mat4/multiply":100,"gl-texture2d":146,"gl-vao":150,ndarray:259,"ndarray-gradient":252,"ndarray-ops":254,"ndarray-pack":255,"surface-nets":302,"typedarray-pool":308}],146:[function(v,m,x){"use strict";var e=v("ndarray"),n=v("ndarray-ops"),t=v("typedarray-pool");m.exports=function(_){if(arguments.length<=1)throw new Error("gl-texture2d: Missing arguments for texture2d constructor");if(a||s(_),"number"==typeof arguments[1])return b(_,arguments[1],arguments[2],arguments[3]||_.RGBA,arguments[4]||_.UNSIGNED_BYTE);if(Array.isArray(arguments[1]))return b(_,0|arguments[1][0],0|arguments[1][1],arguments[2]||_.RGBA,arguments[3]||_.UNSIGNED_BYTE);if("object"==typeof arguments[1]){var w=arguments[1],k=i(w)?w:w.raw;if(k)return l(_,k,0|w.width,0|w.height,arguments[2]||_.RGBA,arguments[3]||_.UNSIGNED_BYTE);if(w.shape&&w.data&&w.stride)return T(_,w)}throw new Error("gl-texture2d: Invalid arguments for texture2d constructor")};var a=null,r=null,d=null;function s(_){a=[_.LINEAR,_.NEAREST_MIPMAP_LINEAR,_.LINEAR_MIPMAP_NEAREST,_.LINEAR_MIPMAP_NEAREST],r=[_.NEAREST,_.LINEAR,_.NEAREST_MIPMAP_NEAREST,_.NEAREST_MIPMAP_LINEAR,_.LINEAR_MIPMAP_NEAREST,_.LINEAR_MIPMAP_LINEAR],d=[_.REPEAT,_.CLAMP_TO_EDGE,_.MIRRORED_REPEAT]}function i(_){return typeof HTMLCanvasElement<"u"&&_ instanceof HTMLCanvasElement||typeof HTMLImageElement<"u"&&_ instanceof HTMLImageElement||typeof HTMLVideoElement<"u"&&_ instanceof HTMLVideoElement||typeof ImageData<"u"&&_ instanceof ImageData}var u=function(_,w){n.muls(_,w,255)};function f(_,w,k){var L=_.gl,M=L.getParameter(L.MAX_TEXTURE_SIZE);if(w<0||w>M||k<0||k>M)throw new Error("gl-texture2d: Invalid texture size");return _._shape=[w,k],_.bind(),L.texImage2D(L.TEXTURE_2D,0,_.format,w,k,0,_.format,_.type,null),_._mipLevels=[0],_}function c(_,w,k,L,M,I){this.gl=_,this.handle=w,this.format=M,this.type=I,this._shape=[k,L],this._mipLevels=[0],this._magFilter=_.NEAREST,this._minFilter=_.NEAREST,this._wrapS=_.CLAMP_TO_EDGE,this._wrapT=_.CLAMP_TO_EDGE,this._anisoSamples=1;var P=this,S=[this._wrapS,this._wrapT];Object.defineProperties(S,[{get:function(){return P._wrapS},set:function(z){return P.wrapS=z}},{get:function(){return P._wrapT},set:function(z){return P.wrapT=z}}]),this._wrapVector=S;var E=[this._shape[0],this._shape[1]];Object.defineProperties(E,[{get:function(){return P._shape[0]},set:function(z){return P.width=z}},{get:function(){return P._shape[1]},set:function(z){return P.height=z}}]),this._shapeVector=E}var h=c.prototype;function p(_,w){return 3===_.length?1===w[2]&&w[1]===_[0]*_[2]&&w[0]===_[2]:1===w[0]&&w[1]===_[0]}function o(_){var w=_.createTexture();return _.bindTexture(_.TEXTURE_2D,w),_.texParameteri(_.TEXTURE_2D,_.TEXTURE_MIN_FILTER,_.NEAREST),_.texParameteri(_.TEXTURE_2D,_.TEXTURE_MAG_FILTER,_.NEAREST),_.texParameteri(_.TEXTURE_2D,_.TEXTURE_WRAP_S,_.CLAMP_TO_EDGE),_.texParameteri(_.TEXTURE_2D,_.TEXTURE_WRAP_T,_.CLAMP_TO_EDGE),w}function b(_,w,k,L,M){var I=_.getParameter(_.MAX_TEXTURE_SIZE);if(w<0||w>I||k<0||k>I)throw new Error("gl-texture2d: Invalid texture shape");if(M===_.FLOAT&&!_.getExtension("OES_texture_float"))throw new Error("gl-texture2d: Floating point textures not supported on this platform");var P=o(_);return _.texImage2D(_.TEXTURE_2D,0,L,w,k,0,L,M,null),new c(_,P,w,k,L,M)}function l(_,w,k,L,M,I){var P=o(_);return _.texImage2D(_.TEXTURE_2D,0,M,M,I,w),new c(_,P,k,L,M,I)}function T(_,w){var k=w.dtype,L=w.shape.slice(),M=_.getParameter(_.MAX_TEXTURE_SIZE);if(L[0]<0||L[0]>M||L[1]<0||L[1]>M)throw new Error("gl-texture2d: Invalid texture size");var I=p(L,w.stride.slice()),P=0;"float32"===k?P=_.FLOAT:"float64"===k?(P=_.FLOAT,I=!1,k="float32"):"uint8"===k?P=_.UNSIGNED_BYTE:(P=_.UNSIGNED_BYTE,I=!1,k="uint8");var S,E,z=0;if(2===L.length)z=_.LUMINANCE,w=e(w.data,L=[L[0],L[1],1],[w.stride[0],w.stride[1],1],w.offset);else{if(3!==L.length)throw new Error("gl-texture2d: Invalid shape for texture");if(1===L[2])z=_.ALPHA;else if(2===L[2])z=_.LUMINANCE_ALPHA;else if(3===L[2])z=_.RGB;else{if(4!==L[2])throw new Error("gl-texture2d: Invalid shape for pixel coords");z=_.RGBA}}P!==_.FLOAT||_.getExtension("OES_texture_float")||(P=_.UNSIGNED_BYTE,I=!1);var R=w.size;if(I)S=0===w.offset&&w.data.length===R?w.data:w.data.subarray(w.offset,w.offset+R);else{var q=[L[2],L[2]*L[0],1];E=t.malloc(R,k);var V=e(E,L,q,0);"float32"!==k&&"float64"!==k||P!==_.UNSIGNED_BYTE?n.assign(V,w):u(V,w),S=E.subarray(0,R)}var W=o(_);return _.texImage2D(_.TEXTURE_2D,0,z,L[0],L[1],0,z,P,S),I||t.free(E),new c(_,W,L[0],L[1],z,P)}Object.defineProperties(h,{minFilter:{get:function(){return this._minFilter},set:function(_){this.bind();var w=this.gl;if(this.type===w.FLOAT&&a.indexOf(_)>=0&&(w.getExtension("OES_texture_float_linear")||(_=w.NEAREST)),r.indexOf(_)<0)throw new Error("gl-texture2d: Unknown filter mode "+_);return w.texParameteri(w.TEXTURE_2D,w.TEXTURE_MIN_FILTER,_),this._minFilter=_}},magFilter:{get:function(){return this._magFilter},set:function(_){this.bind();var w=this.gl;if(this.type===w.FLOAT&&a.indexOf(_)>=0&&(w.getExtension("OES_texture_float_linear")||(_=w.NEAREST)),r.indexOf(_)<0)throw new Error("gl-texture2d: Unknown filter mode "+_);return w.texParameteri(w.TEXTURE_2D,w.TEXTURE_MAG_FILTER,_),this._magFilter=_}},mipSamples:{get:function(){return this._anisoSamples},set:function(_){var w=this._anisoSamples;if(this._anisoSamples=0|Math.max(_,1),w!==this._anisoSamples){var k=this.gl.getExtension("EXT_texture_filter_anisotropic");k&&this.gl.texParameterf(this.gl.TEXTURE_2D,k.TEXTURE_MAX_ANISOTROPY_EXT,this._anisoSamples)}return this._anisoSamples}},wrapS:{get:function(){return this._wrapS},set:function(_){if(this.bind(),d.indexOf(_)<0)throw new Error("gl-texture2d: Unknown wrap mode "+_);return this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_S,_),this._wrapS=_}},wrapT:{get:function(){return this._wrapT},set:function(_){if(this.bind(),d.indexOf(_)<0)throw new Error("gl-texture2d: Unknown wrap mode "+_);return this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_T,_),this._wrapT=_}},wrap:{get:function(){return this._wrapVector},set:function(_){if(Array.isArray(_)||(_=[_,_]),2!==_.length)throw new Error("gl-texture2d: Must specify wrap mode for rows and columns");for(var w=0;w<2;++w)if(d.indexOf(_[w])<0)throw new Error("gl-texture2d: Unknown wrap mode "+_);this._wrapS=_[0],this._wrapT=_[1];var k=this.gl;return this.bind(),k.texParameteri(k.TEXTURE_2D,k.TEXTURE_WRAP_S,this._wrapS),k.texParameteri(k.TEXTURE_2D,k.TEXTURE_WRAP_T,this._wrapT),_}},shape:{get:function(){return this._shapeVector},set:function(_){if(Array.isArray(_)){if(2!==_.length)throw new Error("gl-texture2d: Invalid texture shape")}else _=[0|_,0|_];return f(this,0|_[0],0|_[1]),[0|_[0],0|_[1]]}},width:{get:function(){return this._shape[0]},set:function(_){return f(this,_|=0,this._shape[1]),_}},height:{get:function(){return this._shape[1]},set:function(_){return f(this,this._shape[0],_|=0),_}}}),h.bind=function(_){var w=this.gl;return void 0!==_&&w.activeTexture(w.TEXTURE0+(0|_)),w.bindTexture(w.TEXTURE_2D,this.handle),void 0!==_?0|_:w.getParameter(w.ACTIVE_TEXTURE)-w.TEXTURE0},h.dispose=function(){this.gl.deleteTexture(this.handle)},h.generateMipmap=function(){this.bind(),this.gl.generateMipmap(this.gl.TEXTURE_2D);for(var _=Math.min(this._shape[0],this._shape[1]),w=0;_>0;++w,_>>>=1)this._mipLevels.indexOf(w)<0&&this._mipLevels.push(w)},h.setPixels=function(_,w,k,L){var M=this.gl;this.bind(),Array.isArray(w)?(L=k,k=0|w[1],w=0|w[0]):(w=w||0,k=k||0),L=L||0;var I=i(_)?_:_.raw;if(I)this._mipLevels.indexOf(L)<0?(M.texImage2D(M.TEXTURE_2D,0,this.format,this.format,this.type,I),this._mipLevels.push(L)):M.texSubImage2D(M.TEXTURE_2D,L,w,k,this.format,this.type,I);else{if(!(_.shape&&_.stride&&_.data))throw new Error("gl-texture2d: Unsupported data type");if(_.shape.length<2||w+_.shape[1]>this._shape[1]>>>L||k+_.shape[0]>this._shape[0]>>>L||w<0||k<0)throw new Error("gl-texture2d: Texture dimensions are out of bounds");!function(P,S,E,z,R,q,V,W){var K=W.dtype,G=W.shape.slice();if(G.length<2||G.length>3)throw new Error("gl-texture2d: Invalid ndarray, must be 2d or 3d");var Y=0,$=0,B=p(G,W.stride.slice());if("float32"===K?Y=P.FLOAT:"float64"===K?(Y=P.FLOAT,B=!1,K="float32"):"uint8"===K?Y=P.UNSIGNED_BYTE:(Y=P.UNSIGNED_BYTE,B=!1,K="uint8"),2===G.length)$=P.LUMINANCE,W=e(W.data,G=[G[0],G[1],1],[W.stride[0],W.stride[1],1],W.offset);else{if(3!==G.length)throw new Error("gl-texture2d: Invalid shape for texture");if(1===G[2])$=P.ALPHA;else if(2===G[2])$=P.LUMINANCE_ALPHA;else if(3===G[2])$=P.RGB;else{if(4!==G[2])throw new Error("gl-texture2d: Invalid shape for pixel coords");$=P.RGBA}}if($!==P.LUMINANCE&&$!==P.ALPHA||R!==P.LUMINANCE&&R!==P.ALPHA||($=R),$!==R)throw new Error("gl-texture2d: Incompatible texture format for setPixels");var N=W.size,U=V.indexOf(z)<0;if(U&&V.push(z),Y===q&&B)0===W.offset&&W.data.length===N?U?P.texImage2D(P.TEXTURE_2D,z,R,G[0],G[1],0,R,q,W.data):P.texSubImage2D(P.TEXTURE_2D,z,S,E,G[0],G[1],R,q,W.data):U?P.texImage2D(P.TEXTURE_2D,z,R,G[0],G[1],0,R,q,W.data.subarray(W.offset,W.offset+N)):P.texSubImage2D(P.TEXTURE_2D,z,S,E,G[0],G[1],R,q,W.data.subarray(W.offset,W.offset+N));else{var te;te=q===P.FLOAT?t.mallocFloat32(N):t.mallocUint8(N);var j=e(te,G,[G[2],G[2]*G[0],1]);Y===P.FLOAT&&q===P.UNSIGNED_BYTE?u(j,W):n.assign(j,W),U?P.texImage2D(P.TEXTURE_2D,z,R,G[0],G[1],0,R,q,te.subarray(0,N)):P.texSubImage2D(P.TEXTURE_2D,z,S,E,G[0],G[1],R,q,te.subarray(0,N)),q===P.FLOAT?t.freeFloat32(te):t.freeUint8(te)}}(M,w,k,L,this.format,this.type,this._mipLevels,_)}}},{ndarray:259,"ndarray-ops":254,"typedarray-pool":308}],147:[function(v,m,x){"use strict";m.exports=function(e,n,t){n?n.bind():e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,null);var a=0|e.getParameter(e.MAX_VERTEX_ATTRIBS);if(t){if(t.length>a)throw new Error("gl-vao: Too many vertex attributes");for(var r=0;r<t.length;++r){var d=t[r];if(d.buffer){var i=d.size||4,u=d.type||e.FLOAT,f=!!d.normalized,c=d.stride||0,h=d.offset||0;d.buffer.bind(),e.enableVertexAttribArray(r),e.vertexAttribPointer(r,i,u,f,c,h)}else{if("number"==typeof d)e.vertexAttrib1f(r,d);else if(1===d.length)e.vertexAttrib1f(r,d[0]);else if(2===d.length)e.vertexAttrib2f(r,d[0],d[1]);else if(3===d.length)e.vertexAttrib3f(r,d[0],d[1],d[2]);else{if(4!==d.length)throw new Error("gl-vao: Invalid vertex attribute");e.vertexAttrib4f(r,d[0],d[1],d[2],d[3])}e.disableVertexAttribArray(r)}}for(;r<a;++r)e.disableVertexAttribArray(r)}else for(e.bindBuffer(e.ARRAY_BUFFER,null),r=0;r<a;++r)e.disableVertexAttribArray(r)}},{}],148:[function(v,m,x){"use strict";var e=v("./do-bind.js");function n(t){this.gl=t,this._elements=null,this._attributes=null,this._elementsType=t.UNSIGNED_SHORT}n.prototype.bind=function(){e(this.gl,this._elements,this._attributes)},n.prototype.update=function(t,a,r){this._elements=a,this._attributes=t,this._elementsType=r||this.gl.UNSIGNED_SHORT},n.prototype.dispose=function(){},n.prototype.unbind=function(){},n.prototype.draw=function(t,a,r){r=r||0;var d=this.gl;this._elements?d.drawElements(t,a,this._elementsType,r):d.drawArrays(t,r,a)},m.exports=function(t){return new n(t)}},{"./do-bind.js":147}],149:[function(v,m,x){"use strict";var e=v("./do-bind.js");function n(a,r,d,s,i,u){this.location=a,this.dimension=r,this.a=d,this.b=s,this.c=i,this.d=u}function t(a,r,d){this.gl=a,this._ext=r,this.handle=d,this._attribs=[],this._useElements=!1,this._elementsType=a.UNSIGNED_SHORT}n.prototype.bind=function(a){switch(this.dimension){case 1:a.vertexAttrib1f(this.location,this.a);break;case 2:a.vertexAttrib2f(this.location,this.a,this.b);break;case 3:a.vertexAttrib3f(this.location,this.a,this.b,this.c);break;case 4:a.vertexAttrib4f(this.location,this.a,this.b,this.c,this.d)}},t.prototype.bind=function(){this._ext.bindVertexArrayOES(this.handle);for(var a=0;a<this._attribs.length;++a)this._attribs[a].bind(this.gl)},t.prototype.unbind=function(){this._ext.bindVertexArrayOES(null)},t.prototype.dispose=function(){this._ext.deleteVertexArrayOES(this.handle)},t.prototype.update=function(a,r,d){if(this.bind(),e(this.gl,r,a),this.unbind(),this._attribs.length=0,a)for(var s=0;s<a.length;++s){var i=a[s];"number"==typeof i?this._attribs.push(new n(s,1,i)):Array.isArray(i)&&this._attribs.push(new n(s,i.length,i[0],i[1],i[2],i[3]))}this._useElements=!!r,this._elementsType=d||this.gl.UNSIGNED_SHORT},t.prototype.draw=function(a,r,d){d=d||0;var s=this.gl;this._useElements?s.drawElements(a,r,this._elementsType,d):s.drawArrays(a,d,r)},m.exports=function(a,r){return new t(a,r,r.createVertexArrayOES())}},{"./do-bind.js":147}],150:[function(v,m,x){"use strict";var e=v("./lib/vao-native.js"),n=v("./lib/vao-emulated.js");function t(a){this.bindVertexArrayOES=a.bindVertexArray.bind(a),this.createVertexArrayOES=a.createVertexArray.bind(a),this.deleteVertexArrayOES=a.deleteVertexArray.bind(a)}m.exports=function(a,r,d,s){var i,u=a.createVertexArray?new t(a):a.getExtension("OES_vertex_array_object");return(i=u?e(a,u):n(a)).update(r,d,s),i}},{"./lib/vao-emulated.js":148,"./lib/vao-native.js":149}],151:[function(v,m,x){m.exports=function(e,n,t){return e[0]=n[0]+t[0],e[1]=n[1]+t[1],e[2]=n[2]+t[2],e}},{}],152:[function(v,m,x){m.exports=function(a,r){var d=e(a[0],a[1],a[2]),s=e(r[0],r[1],r[2]);n(d,d),n(s,s);var i=t(d,s);return i>1?0:Math.acos(i)};var e=v("./fromValues"),n=v("./normalize"),t=v("./dot")},{"./dot":162,"./fromValues":168,"./normalize":179}],153:[function(v,m,x){m.exports=function(e,n){return e[0]=Math.ceil(n[0]),e[1]=Math.ceil(n[1]),e[2]=Math.ceil(n[2]),e}},{}],154:[function(v,m,x){m.exports=function(e){var n=new Float32Array(3);return n[0]=e[0],n[1]=e[1],n[2]=e[2],n}},{}],155:[function(v,m,x){m.exports=function(e,n){return e[0]=n[0],e[1]=n[1],e[2]=n[2],e}},{}],156:[function(v,m,x){m.exports=function(){var e=new Float32Array(3);return e[0]=0,e[1]=0,e[2]=0,e}},{}],157:[function(v,m,x){m.exports=function(e,n,t){var a=n[0],r=n[1],d=n[2],s=t[0],i=t[1],u=t[2];return e[0]=r*u-d*i,e[1]=d*s-a*u,e[2]=a*i-r*s,e}},{}],158:[function(v,m,x){m.exports=v("./distance")},{"./distance":159}],159:[function(v,m,x){m.exports=function(e,n){var t=n[0]-e[0],a=n[1]-e[1],r=n[2]-e[2];return Math.sqrt(t*t+a*a+r*r)}},{}],160:[function(v,m,x){m.exports=v("./divide")},{"./divide":161}],161:[function(v,m,x){m.exports=function(e,n,t){return e[0]=n[0]/t[0],e[1]=n[1]/t[1],e[2]=n[2]/t[2],e}},{}],162:[function(v,m,x){m.exports=function(e,n){return e[0]*n[0]+e[1]*n[1]+e[2]*n[2]}},{}],163:[function(v,m,x){m.exports=1e-6},{}],164:[function(v,m,x){m.exports=function(n,t){var a=n[0],r=n[1],d=n[2],s=t[0],i=t[1],u=t[2];return Math.abs(a-s)<=e*Math.max(1,Math.abs(a),Math.abs(s))&&Math.abs(r-i)<=e*Math.max(1,Math.abs(r),Math.abs(i))&&Math.abs(d-u)<=e*Math.max(1,Math.abs(d),Math.abs(u))};var e=v("./epsilon")},{"./epsilon":163}],165:[function(v,m,x){m.exports=function(e,n){return e[0]===n[0]&&e[1]===n[1]&&e[2]===n[2]}},{}],166:[function(v,m,x){m.exports=function(e,n){return e[0]=Math.floor(n[0]),e[1]=Math.floor(n[1]),e[2]=Math.floor(n[2]),e}},{}],167:[function(v,m,x){m.exports=function(n,t,a,r,d,s){var i,u;for(t||(t=3),a||(a=0),u=r?Math.min(r*t+a,n.length):n.length,i=a;i<u;i+=t)e[0]=n[i],e[1]=n[i+1],e[2]=n[i+2],d(e,e,s),n[i]=e[0],n[i+1]=e[1],n[i+2]=e[2];return n};var e=v("./create")()},{"./create":156}],168:[function(v,m,x){m.exports=function(e,n,t){var a=new Float32Array(3);return a[0]=e,a[1]=n,a[2]=t,a}},{}],169:[function(v,m,x){m.exports={EPSILON:v("./epsilon"),create:v("./create"),clone:v("./clone"),angle:v("./angle"),fromValues:v("./fromValues"),copy:v("./copy"),set:v("./set"),equals:v("./equals"),exactEquals:v("./exactEquals"),add:v("./add"),subtract:v("./subtract"),sub:v("./sub"),multiply:v("./multiply"),mul:v("./mul"),divide:v("./divide"),div:v("./div"),min:v("./min"),max:v("./max"),floor:v("./floor"),ceil:v("./ceil"),round:v("./round"),scale:v("./scale"),scaleAndAdd:v("./scaleAndAdd"),distance:v("./distance"),dist:v("./dist"),squaredDistance:v("./squaredDistance"),sqrDist:v("./sqrDist"),length:v("./length"),len:v("./len"),squaredLength:v("./squaredLength"),sqrLen:v("./sqrLen"),negate:v("./negate"),inverse:v("./inverse"),normalize:v("./normalize"),dot:v("./dot"),cross:v("./cross"),lerp:v("./lerp"),random:v("./random"),transformMat4:v("./transformMat4"),transformMat3:v("./transformMat3"),transformQuat:v("./transformQuat"),rotateX:v("./rotateX"),rotateY:v("./rotateY"),rotateZ:v("./rotateZ"),forEach:v("./forEach")}},{"./add":151,"./angle":152,"./ceil":153,"./clone":154,"./copy":155,"./create":156,"./cross":157,"./dist":158,"./distance":159,"./div":160,"./divide":161,"./dot":162,"./epsilon":163,"./equals":164,"./exactEquals":165,"./floor":166,"./forEach":167,"./fromValues":168,"./inverse":170,"./len":171,"./length":172,"./lerp":173,"./max":174,"./min":175,"./mul":176,"./multiply":177,"./negate":178,"./normalize":179,"./random":180,"./rotateX":181,"./rotateY":182,"./rotateZ":183,"./round":184,"./scale":185,"./scaleAndAdd":186,"./set":187,"./sqrDist":188,"./sqrLen":189,"./squaredDistance":190,"./squaredLength":191,"./sub":192,"./subtract":193,"./transformMat3":194,"./transformMat4":195,"./transformQuat":196}],170:[function(v,m,x){m.exports=function(e,n){return e[0]=1/n[0],e[1]=1/n[1],e[2]=1/n[2],e}},{}],171:[function(v,m,x){m.exports=v("./length")},{"./length":172}],172:[function(v,m,x){m.exports=function(e){var n=e[0],t=e[1],a=e[2];return Math.sqrt(n*n+t*t+a*a)}},{}],173:[function(v,m,x){m.exports=function(e,n,t,a){var r=n[0],d=n[1],s=n[2];return e[0]=r+a*(t[0]-r),e[1]=d+a*(t[1]-d),e[2]=s+a*(t[2]-s),e}},{}],174:[function(v,m,x){m.exports=function(e,n,t){return e[0]=Math.max(n[0],t[0]),e[1]=Math.max(n[1],t[1]),e[2]=Math.max(n[2],t[2]),e}},{}],175:[function(v,m,x){m.exports=function(e,n,t){return e[0]=Math.min(n[0],t[0]),e[1]=Math.min(n[1],t[1]),e[2]=Math.min(n[2],t[2]),e}},{}],176:[function(v,m,x){m.exports=v("./multiply")},{"./multiply":177}],177:[function(v,m,x){m.exports=function(e,n,t){return e[0]=n[0]*t[0],e[1]=n[1]*t[1],e[2]=n[2]*t[2],e}},{}],178:[function(v,m,x){m.exports=function(e,n){return e[0]=-n[0],e[1]=-n[1],e[2]=-n[2],e}},{}],179:[function(v,m,x){m.exports=function(e,n){var t=n[0],a=n[1],r=n[2],d=t*t+a*a+r*r;return d>0&&(d=1/Math.sqrt(d),e[0]=n[0]*d,e[1]=n[1]*d,e[2]=n[2]*d),e}},{}],180:[function(v,m,x){m.exports=function(e,n){n=n||1;var t=2*Math.random()*Math.PI,a=2*Math.random()-1,r=Math.sqrt(1-a*a)*n;return e[0]=Math.cos(t)*r,e[1]=Math.sin(t)*r,e[2]=a*n,e}},{}],181:[function(v,m,x){m.exports=function(e,n,t,a){var r=t[1],d=t[2],s=n[1]-r,i=n[2]-d,u=Math.sin(a),f=Math.cos(a);return e[0]=n[0],e[1]=r+s*f-i*u,e[2]=d+s*u+i*f,e}},{}],182:[function(v,m,x){m.exports=function(e,n,t,a){var r=t[0],d=t[2],s=n[0]-r,i=n[2]-d,u=Math.sin(a),f=Math.cos(a);return e[0]=r+i*u+s*f,e[1]=n[1],e[2]=d+i*f-s*u,e}},{}],183:[function(v,m,x){m.exports=function(e,n,t,a){var r=t[0],d=t[1],s=n[0]-r,i=n[1]-d,u=Math.sin(a),f=Math.cos(a);return e[0]=r+s*f-i*u,e[1]=d+s*u+i*f,e[2]=n[2],e}},{}],184:[function(v,m,x){m.exports=function(e,n){return e[0]=Math.round(n[0]),e[1]=Math.round(n[1]),e[2]=Math.round(n[2]),e}},{}],185:[function(v,m,x){m.exports=function(e,n,t){return e[0]=n[0]*t,e[1]=n[1]*t,e[2]=n[2]*t,e}},{}],186:[function(v,m,x){m.exports=function(e,n,t,a){return e[0]=n[0]+t[0]*a,e[1]=n[1]+t[1]*a,e[2]=n[2]+t[2]*a,e}},{}],187:[function(v,m,x){m.exports=function(e,n,t,a){return e[0]=n,e[1]=t,e[2]=a,e}},{}],188:[function(v,m,x){m.exports=v("./squaredDistance")},{"./squaredDistance":190}],189:[function(v,m,x){m.exports=v("./squaredLength")},{"./squaredLength":191}],190:[function(v,m,x){m.exports=function(e,n){var t=n[0]-e[0],a=n[1]-e[1],r=n[2]-e[2];return t*t+a*a+r*r}},{}],191:[function(v,m,x){m.exports=function(e){var n=e[0],t=e[1],a=e[2];return n*n+t*t+a*a}},{}],192:[function(v,m,x){m.exports=v("./subtract")},{"./subtract":193}],193:[function(v,m,x){m.exports=function(e,n,t){return e[0]=n[0]-t[0],e[1]=n[1]-t[1],e[2]=n[2]-t[2],e}},{}],194:[function(v,m,x){m.exports=function(e,n,t){var a=n[0],r=n[1],d=n[2];return e[0]=a*t[0]+r*t[3]+d*t[6],e[1]=a*t[1]+r*t[4]+d*t[7],e[2]=a*t[2]+r*t[5]+d*t[8],e}},{}],195:[function(v,m,x){m.exports=function(e,n,t){var a=n[0],r=n[1],d=n[2],s=t[3]*a+t[7]*r+t[11]*d+t[15];return e[0]=(t[0]*a+t[4]*r+t[8]*d+t[12])/(s=s||1),e[1]=(t[1]*a+t[5]*r+t[9]*d+t[13])/s,e[2]=(t[2]*a+t[6]*r+t[10]*d+t[14])/s,e}},{}],196:[function(v,m,x){m.exports=function(e,n,t){var a=n[0],r=n[1],d=n[2],s=t[0],i=t[1],u=t[2],f=t[3],c=f*a+i*d-u*r,h=f*r+u*a-s*d,p=f*d+s*r-i*a,o=-s*a-i*r-u*d;return e[0]=c*f+o*-s+h*-u-p*-i,e[1]=h*f+o*-i+p*-s-c*-u,e[2]=p*f+o*-u+c*-i-h*-s,e}},{}],197:[function(v,m,x){m.exports=function(e,n,t){return e[0]=n[0]+t[0],e[1]=n[1]+t[1],e[2]=n[2]+t[2],e[3]=n[3]+t[3],e}},{}],198:[function(v,m,x){m.exports=function(e){var n=new Float32Array(4);return n[0]=e[0],n[1]=e[1],n[2]=e[2],n[3]=e[3],n}},{}],199:[function(v,m,x){m.exports=function(e,n){return e[0]=n[0],e[1]=n[1],e[2]=n[2],e[3]=n[3],e}},{}],200:[function(v,m,x){m.exports=function(){var e=new Float32Array(4);return e[0]=0,e[1]=0,e[2]=0,e[3]=0,e}},{}],201:[function(v,m,x){m.exports=function(e,n){var t=n[0]-e[0],a=n[1]-e[1],r=n[2]-e[2],d=n[3]-e[3];return Math.sqrt(t*t+a*a+r*r+d*d)}},{}],202:[function(v,m,x){m.exports=function(e,n,t){return e[0]=n[0]/t[0],e[1]=n[1]/t[1],e[2]=n[2]/t[2],e[3]=n[3]/t[3],e}},{}],203:[function(v,m,x){m.exports=function(e,n){return e[0]*n[0]+e[1]*n[1]+e[2]*n[2]+e[3]*n[3]}},{}],204:[function(v,m,x){m.exports=function(e,n,t,a){var r=new Float32Array(4);return r[0]=e,r[1]=n,r[2]=t,r[3]=a,r}},{}],205:[function(v,m,x){m.exports={create:v("./create"),clone:v("./clone"),fromValues:v("./fromValues"),copy:v("./copy"),set:v("./set"),add:v("./add"),subtract:v("./subtract"),multiply:v("./multiply"),divide:v("./divide"),min:v("./min"),max:v("./max"),scale:v("./scale"),scaleAndAdd:v("./scaleAndAdd"),distance:v("./distance"),squaredDistance:v("./squaredDistance"),length:v("./length"),squaredLength:v("./squaredLength"),negate:v("./negate"),inverse:v("./inverse"),normalize:v("./normalize"),dot:v("./dot"),lerp:v("./lerp"),random:v("./random"),transformMat4:v("./transformMat4"),transformQuat:v("./transformQuat")}},{"./add":197,"./clone":198,"./copy":199,"./create":200,"./distance":201,"./divide":202,"./dot":203,"./fromValues":204,"./inverse":206,"./length":207,"./lerp":208,"./max":209,"./min":210,"./multiply":211,"./negate":212,"./normalize":213,"./random":214,"./scale":215,"./scaleAndAdd":216,"./set":217,"./squaredDistance":218,"./squaredLength":219,"./subtract":220,"./transformMat4":221,"./transformQuat":222}],206:[function(v,m,x){m.exports=function(e,n){return e[0]=1/n[0],e[1]=1/n[1],e[2]=1/n[2],e[3]=1/n[3],e}},{}],207:[function(v,m,x){m.exports=function(e){var n=e[0],t=e[1],a=e[2],r=e[3];return Math.sqrt(n*n+t*t+a*a+r*r)}},{}],208:[function(v,m,x){m.exports=function(e,n,t,a){var r=n[0],d=n[1],s=n[2],i=n[3];return e[0]=r+a*(t[0]-r),e[1]=d+a*(t[1]-d),e[2]=s+a*(t[2]-s),e[3]=i+a*(t[3]-i),e}},{}],209:[function(v,m,x){m.exports=function(e,n,t){return e[0]=Math.max(n[0],t[0]),e[1]=Math.max(n[1],t[1]),e[2]=Math.max(n[2],t[2]),e[3]=Math.max(n[3],t[3]),e}},{}],210:[function(v,m,x){m.exports=function(e,n,t){return e[0]=Math.min(n[0],t[0]),e[1]=Math.min(n[1],t[1]),e[2]=Math.min(n[2],t[2]),e[3]=Math.min(n[3],t[3]),e}},{}],211:[function(v,m,x){m.exports=function(e,n,t){return e[0]=n[0]*t[0],e[1]=n[1]*t[1],e[2]=n[2]*t[2],e[3]=n[3]*t[3],e}},{}],212:[function(v,m,x){m.exports=function(e,n){return e[0]=-n[0],e[1]=-n[1],e[2]=-n[2],e[3]=-n[3],e}},{}],213:[function(v,m,x){m.exports=function(e,n){var t=n[0],a=n[1],r=n[2],d=n[3],s=t*t+a*a+r*r+d*d;return s>0&&(s=1/Math.sqrt(s),e[0]=t*s,e[1]=a*s,e[2]=r*s,e[3]=d*s),e}},{}],214:[function(v,m,x){var e=v("./normalize"),n=v("./scale");m.exports=function(t,a){return a=a||1,t[0]=Math.random(),t[1]=Math.random(),t[2]=Math.random(),t[3]=Math.random(),e(t,t),n(t,t,a),t}},{"./normalize":213,"./scale":215}],215:[function(v,m,x){m.exports=function(e,n,t){return e[0]=n[0]*t,e[1]=n[1]*t,e[2]=n[2]*t,e[3]=n[3]*t,e}},{}],216:[function(v,m,x){m.exports=function(e,n,t,a){return e[0]=n[0]+t[0]*a,e[1]=n[1]+t[1]*a,e[2]=n[2]+t[2]*a,e[3]=n[3]+t[3]*a,e}},{}],217:[function(v,m,x){m.exports=function(e,n,t,a,r){return e[0]=n,e[1]=t,e[2]=a,e[3]=r,e}},{}],218:[function(v,m,x){m.exports=function(e,n){var t=n[0]-e[0],a=n[1]-e[1],r=n[2]-e[2],d=n[3]-e[3];return t*t+a*a+r*r+d*d}},{}],219:[function(v,m,x){m.exports=function(e){var n=e[0],t=e[1],a=e[2],r=e[3];return n*n+t*t+a*a+r*r}},{}],220:[function(v,m,x){m.exports=function(e,n,t){return e[0]=n[0]-t[0],e[1]=n[1]-t[1],e[2]=n[2]-t[2],e[3]=n[3]-t[3],e}},{}],221:[function(v,m,x){m.exports=function(e,n,t){var a=n[0],r=n[1],d=n[2],s=n[3];return e[0]=t[0]*a+t[4]*r+t[8]*d+t[12]*s,e[1]=t[1]*a+t[5]*r+t[9]*d+t[13]*s,e[2]=t[2]*a+t[6]*r+t[10]*d+t[14]*s,e[3]=t[3]*a+t[7]*r+t[11]*d+t[15]*s,e}},{}],222:[function(v,m,x){m.exports=function(e,n,t){var a=n[0],r=n[1],d=n[2],s=t[0],i=t[1],u=t[2],f=t[3],c=f*a+i*d-u*r,h=f*r+u*a-s*d,p=f*d+s*r-i*a,o=-s*a-i*r-u*d;return e[0]=c*f+o*-s+h*-u-p*-i,e[1]=h*f+o*-i+p*-s-c*-u,e[2]=p*f+o*-u+c*-i-h*-s,e[3]=n[3],e}},{}],223:[function(v,m,x){var e=v("glsl-tokenizer"),n=v("atob-lite");m.exports=function(t){for(var a=Array.isArray(t)?t:e(t),r=0;r<a.length;r++){var d=a[r];if("preprocessor"===d.type){var s=d.data.match(/\#define\s+SHADER_NAME(_B64)?\s+(.+)$/);if(s&&s[2]){var u=s[2];return(s[1]?n(u):u).trim()}}}}},{"atob-lite":13,"glsl-tokenizer":230}],224:[function(v,m,x){m.exports=function(s){var i,u,f,c=0,h=0,p=999,o=[],b=[],l=1,T=0,_=0,w=!1,k=!1,L="",M=t,I=e;"300 es"===(s=s||{}).version&&(M=r,I=a);var P={},S={};for(c=0;c<M.length;c++)P[M[c]]=!0;for(c=0;c<I.length;c++)S[I[c]]=!0;return function(N){return b=[],null!==N?function(U){var te;for(c=0,U.toString&&(U=U.toString()),L+=U.replace(/\r\n/g,"\n"),f=L.length;i=L[c],c<f;){switch(te=c,p){case 0:c="/"===i&&"*"===u?(o.push(i),E(o.join("")),p=999,c+1):(o.push(i),u=i,c+1);break;case 1:case 2:c="\r"!==i&&"\n"!==i||"\\"===u?(o.push(i),u=i,c+1):(E(o.join("")),p=999,c);break;case 3:c=W();break;case 4:c="."===i||/[eE]/.test(i)?(o.push(i),p=5,u=i,c+1):"x"===i&&1===o.length&&"0"===o[0]?(p=11,o.push(i),u=i,c+1):/[^\d]/.test(i)?(E(o.join("")),p=999,c):(o.push(i),u=i,c+1);break;case 11:c=/[^a-fA-F0-9]/.test(i)?(E(o.join("")),p=999,c):(o.push(i),u=i,c+1);break;case 5:"f"===i&&(o.push(i),u=i,c+=1),c=/[eE]/.test(i)?(o.push(i),u=i,c+1):("-"!==i&&"+"!==i||!/[eE]/.test(u))&&/[^\d]/.test(i)?(E(o.join("")),p=999,c):(o.push(i),u=i,c+1);break;case 9999:c=B();break;case 9:c=/[^\s]/g.test(i)?(E(o.join("")),p=999,c):(o.push(i),u=i,c+1);break;case 999:o=o.length?[]:o,c="/"===u&&"*"===i?(_=h+c-1,p=0,u=i,c+1):"/"===u&&"/"===i?(_=h+c-1,p=1,u=i,c+1):"#"===i?(p=2,_=h+c,c):/\s/.test(i)?(p=9,_=h+c,c):(w=/\d/.test(i),k=/[^\w_]/.test(i),_=h+c,p=w?4:k?3:9999,c)}te!==c&&("\n"===L[te]?(T=0,++l):++T)}return h+=c,L=L.slice(c),b}(N):(o.length&&E(o.join("")),p=10,E("(eof)"),b)};function E(N){N.length&&b.push({type:d[p],data:N,position:_,line:l,column:T})}function W(){if("."===u&&/\d/.test(i))return p=5,c;if("/"===u&&"*"===i)return p=0,c;if("/"===u&&"/"===i)return p=1,c;if("."===i&&o.length){for(;K(o););return p=5,c}if(";"===i||")"===i||"("===i){if(o.length)for(;K(o););return E(i),p=999,c+1}var N=2===o.length&&"="!==i;if(/[\w_\d\s]/.test(i)||N){for(;K(o););return p=999,c}return o.push(i),u=i,c+1}function K(N){for(var U,te,j=0;;){if(U=n.indexOf(N.slice(0,N.length+j).join("")),te=n[U],-1===U){if(j--+N.length>0)continue;te=N.slice(0,1).join("")}return E(te),_+=te.length,(o=o.slice(te.length)).length}}function B(){if(/[^\d\w_]/.test(i)){var N=o.join("");return p=S[N]?8:P[N]?7:6,E(o.join("")),p=999,c}return o.push(i),u=i,c+1}};var e=v("./lib/literals"),n=v("./lib/operators"),t=v("./lib/builtins"),a=v("./lib/literals-300es"),r=v("./lib/builtins-300es"),d=["block-comment","line-comment","preprocessor","operator","integer","float","ident","builtin","keyword","whitespace","eof","integer"]},{"./lib/builtins":226,"./lib/builtins-300es":225,"./lib/literals":228,"./lib/literals-300es":227,"./lib/operators":229}],225:[function(v,m,x){var e=v("./builtins");e=e.slice().filter(function(n){return!/^(gl\_|texture)/.test(n)}),m.exports=e.concat(["gl_VertexID","gl_InstanceID","gl_Position","gl_PointSize","gl_FragCoord","gl_FrontFacing","gl_FragDepth","gl_PointCoord","gl_MaxVertexAttribs","gl_MaxVertexUniformVectors","gl_MaxVertexOutputVectors","gl_MaxFragmentInputVectors","gl_MaxVertexTextureImageUnits","gl_MaxCombinedTextureImageUnits","gl_MaxTextureImageUnits","gl_MaxFragmentUniformVectors","gl_MaxDrawBuffers","gl_MinProgramTexelOffset","gl_MaxProgramTexelOffset","gl_DepthRangeParameters","gl_DepthRange","trunc","round","roundEven","isnan","isinf","floatBitsToInt","floatBitsToUint","intBitsToFloat","uintBitsToFloat","packSnorm2x16","unpackSnorm2x16","packUnorm2x16","unpackUnorm2x16","packHalf2x16","unpackHalf2x16","outerProduct","transpose","determinant","inverse","texture","textureSize","textureProj","textureLod","textureOffset","texelFetch","texelFetchOffset","textureProjOffset","textureLodOffset","textureProjLod","textureProjLodOffset","textureGrad","textureGradOffset","textureProjGrad","textureProjGradOffset"])},{"./builtins":226}],226:[function(v,m,x){m.exports=["abs","acos","all","any","asin","atan","ceil","clamp","cos","cross","dFdx","dFdy","degrees","distance","dot","equal","exp","exp2","faceforward","floor","fract","gl_BackColor","gl_BackLightModelProduct","gl_BackLightProduct","gl_BackMaterial","gl_BackSecondaryColor","gl_ClipPlane","gl_ClipVertex","gl_Color","gl_DepthRange","gl_DepthRangeParameters","gl_EyePlaneQ","gl_EyePlaneR","gl_EyePlaneS","gl_EyePlaneT","gl_Fog","gl_FogCoord","gl_FogFragCoord","gl_FogParameters","gl_FragColor","gl_FragCoord","gl_FragData","gl_FragDepth","gl_FragDepthEXT","gl_FrontColor","gl_FrontFacing","gl_FrontLightModelProduct","gl_FrontLightProduct","gl_FrontMaterial","gl_FrontSecondaryColor","gl_LightModel","gl_LightModelParameters","gl_LightModelProducts","gl_LightProducts","gl_LightSource","gl_LightSourceParameters","gl_MaterialParameters","gl_MaxClipPlanes","gl_MaxCombinedTextureImageUnits","gl_MaxDrawBuffers","gl_MaxFragmentUniformComponents","gl_MaxLights","gl_MaxTextureCoords","gl_MaxTextureImageUnits","gl_MaxTextureUnits","gl_MaxVaryingFloats","gl_MaxVertexAttribs","gl_MaxVertexTextureImageUnits","gl_MaxVertexUniformComponents","gl_ModelViewMatrix","gl_ModelViewMatrixInverse","gl_ModelViewMatrixInverseTranspose","gl_ModelViewMatrixTranspose","gl_ModelViewProjectionMatrix","gl_ModelViewProjectionMatrixInverse","gl_ModelViewProjectionMatrixInverseTranspose","gl_ModelViewProjectionMatrixTranspose","gl_MultiTexCoord0","gl_MultiTexCoord1","gl_MultiTexCoord2","gl_MultiTexCoord3","gl_MultiTexCoord4","gl_MultiTexCoord5","gl_MultiTexCoord6","gl_MultiTexCoord7","gl_Normal","gl_NormalMatrix","gl_NormalScale","gl_ObjectPlaneQ","gl_ObjectPlaneR","gl_ObjectPlaneS","gl_ObjectPlaneT","gl_Point","gl_PointCoord","gl_PointParameters","gl_PointSize","gl_Position","gl_ProjectionMatrix","gl_ProjectionMatrixInverse","gl_ProjectionMatrixInverseTranspose","gl_ProjectionMatrixTranspose","gl_SecondaryColor","gl_TexCoord","gl_TextureEnvColor","gl_TextureMatrix","gl_TextureMatrixInverse","gl_TextureMatrixInverseTranspose","gl_TextureMatrixTranspose","gl_Vertex","greaterThan","greaterThanEqual","inversesqrt","length","lessThan","lessThanEqual","log","log2","matrixCompMult","max","min","mix","mod","normalize","not","notEqual","pow","radians","reflect","refract","sign","sin","smoothstep","sqrt","step","tan","texture2D","texture2DLod","texture2DProj","texture2DProjLod","textureCube","textureCubeLod","texture2DLodEXT","texture2DProjLodEXT","textureCubeLodEXT","texture2DGradEXT","texture2DProjGradEXT","textureCubeGradEXT"]},{}],227:[function(v,m,x){var e=v("./literals");m.exports=e.slice().concat(["layout","centroid","smooth","case","mat2x2","mat2x3","mat2x4","mat3x2","mat3x3","mat3x4","mat4x2","mat4x3","mat4x4","uvec2","uvec3","uvec4","samplerCubeShadow","sampler2DArray","sampler2DArrayShadow","isampler2D","isampler3D","isamplerCube","isampler2DArray","usampler2D","usampler3D","usamplerCube","usampler2DArray","coherent","restrict","readonly","writeonly","resource","atomic_uint","noperspective","patch","sample","subroutine","common","partition","active","filter","image1D","image2D","image3D","imageCube","iimage1D","iimage2D","iimage3D","iimageCube","uimage1D","uimage2D","uimage3D","uimageCube","image1DArray","image2DArray","iimage1DArray","iimage2DArray","uimage1DArray","uimage2DArray","image1DShadow","image2DShadow","image1DArrayShadow","image2DArrayShadow","imageBuffer","iimageBuffer","uimageBuffer","sampler1DArray","sampler1DArrayShadow","isampler1D","isampler1DArray","usampler1D","usampler1DArray","isampler2DRect","usampler2DRect","samplerBuffer","isamplerBuffer","usamplerBuffer","sampler2DMS","isampler2DMS","usampler2DMS","sampler2DMSArray","isampler2DMSArray","usampler2DMSArray"])},{"./literals":228}],228:[function(v,m,x){m.exports=["precision","highp","mediump","lowp","attribute","const","uniform","varying","break","continue","do","for","while","if","else","in","out","inout","float","int","uint","void","bool","true","false","discard","return","mat2","mat3","mat4","vec2","vec3","vec4","ivec2","ivec3","ivec4","bvec2","bvec3","bvec4","sampler1D","sampler2D","sampler3D","samplerCube","sampler1DShadow","sampler2DShadow","struct","asm","class","union","enum","typedef","template","this","packed","goto","switch","default","inline","noinline","volatile","public","static","extern","external","interface","long","short","double","half","fixed","unsigned","input","output","hvec2","hvec3","hvec4","dvec2","dvec3","dvec4","fvec2","fvec3","fvec4","sampler2DRect","sampler3DRect","sampler2DRectShadow","sizeof","cast","namespace","using"]},{}],229:[function(v,m,x){m.exports=["<<=",">>=","++","--","<<",">>","<=",">=","==","!=","&&","||","+=","-=","*=","/=","%=","&=","^^","^=","|=","(",")","[","]",".","!","~","*","/","%","+","-","<",">","&","^","|","?",":","=",",",";","{","}"]},{}],230:[function(v,m,x){var e=v("./index");m.exports=function(n,t){var a=e(t),r=[];return(r=r.concat(a(n))).concat(a(null))}},{"./index":224}],231:[function(v,m,x){m.exports=function(e){"string"==typeof e&&(e=[e]);for(var n=[].slice.call(arguments,1),t=[],a=0;a<e.length-1;a++)t.push(e[a],n[a]||"");return t.push(e[a]),t.join("")}},{}],232:[function(v,m,x){"use strict";var e=v("is-browser");m.exports=e&&function(){var n=!1;try{var t=Object.defineProperty({},"passive",{get:function(){n=!0}});window.addEventListener("test",null,t),window.removeEventListener("test",null,t)}catch{n=!1}return n}()},{"is-browser":236}],233:[function(v,m,x){"use strict";m.exports=function(u,f){var c=u.length;if(0===c)throw new Error("Must have at least d+1 points");var h=u[0].length;if(c<=h)throw new Error("Must input at least d+1 points");var p=u.slice(0,h+1),o=e.apply(void 0,p);if(0===o)throw new Error("Input not in general position");for(var b=new Array(h+1),l=0;l<=h;++l)b[l]=l;o<0&&(b[0]=1,b[1]=0);var T=new t(b,new Array(h+1),!1),_=T.adjacent,w=new Array(h+2);for(l=0;l<=h;++l){for(var k=b.slice(),L=0;L<=h;++L)L===l&&(k[L]=-1);var M=k[0];k[0]=k[1],k[1]=M;var I=new t(k,new Array(h+1),!0);_[l]=I,w[l]=I}for(w[h+1]=T,l=0;l<=h;++l){k=_[l].vertices;var P=_[l].adjacent;for(L=0;L<=h;++L){var S=k[L];if(S<0)P[L]=T;else for(var E=0;E<=h;++E)_[E].vertices.indexOf(S)<0&&(P[L]=_[E])}}var z=new s(h,p,w),R=!!f;for(l=h+1;l<c;++l)z.insert(u[l],R);return z.boundary()};var e=v("robust-orientation"),n=v("simplicial-complex").compareCells;function t(u,f,c){this.vertices=u,this.adjacent=f,this.boundary=c,this.lastVisited=-1}function a(u,f,c){this.vertices=u,this.cell=f,this.index=c}function r(u,f){return n(u.vertices,f.vertices)}t.prototype.flip=function(){var u=this.vertices[0];this.vertices[0]=this.vertices[1],this.vertices[1]=u;var f=this.adjacent[0];this.adjacent[0]=this.adjacent[1],this.adjacent[1]=f};var d=[];function s(u,f,c){this.dimension=u,this.vertices=f,this.simplices=c,this.interior=c.filter(function(b){return!b.boundary}),this.tuple=new Array(u+1);for(var h=0;h<=u;++h)this.tuple[h]=this.vertices[h];var p,b,o=d[u];o||(o=d[u]=((p=e[u+1])||(p=e),b=p,function(){return b.apply(this,this.tuple)})),this.orient=o}var i=s.prototype;i.handleBoundaryDegeneracy=function(u,f){var c=this.dimension,h=this.vertices.length-1,p=this.tuple,o=this.vertices,b=[u];for(u.lastVisited=-h;b.length>0;)for(var l=(u=b.pop()).adjacent,T=0;T<=c;++T){var _=l[T];if(_.boundary&&!(_.lastVisited<=-h)){for(var w=_.vertices,k=0;k<=c;++k){var L=w[k];p[k]=L<0?f:o[L]}var M=this.orient();if(M>0)return _;_.lastVisited=-h,0===M&&b.push(_)}}return null},i.walk=function(u,f){var c=this.vertices.length-1,h=this.dimension,p=this.vertices,o=this.tuple,b=f?this.interior.length*Math.random()|0:this.interior.length-1,l=this.interior[b];e:for(;!l.boundary;){for(var T=l.vertices,_=l.adjacent,w=0;w<=h;++w)o[w]=p[T[w]];for(l.lastVisited=c,w=0;w<=h;++w){var k=_[w];if(!(k.lastVisited>=c)){var L=o[w];o[w]=u;var M=this.orient();if(o[w]=L,M<0){l=k;continue e}k.lastVisited=k.boundary?-c:c}}return}return l},i.addPeaks=function(u,f){var c=this.vertices.length-1,h=this.dimension,p=this.vertices,o=this.tuple,b=this.interior,l=this.simplices,T=[f];f.lastVisited=c,f.vertices[f.vertices.indexOf(-1)]=c,f.boundary=!1,b.push(f);for(var _=[];T.length>0;){var w=(f=T.pop()).vertices,k=f.adjacent,L=w.indexOf(c);if(!(L<0))for(var M=0;M<=h;++M)if(M!==L){var I=k[M];if(I.boundary&&!(I.lastVisited>=c)){var P=I.vertices;if(I.lastVisited!==-c){for(var S=0,E=0;E<=h;++E)P[E]<0?(S=E,o[E]=u):o[E]=p[P[E]];if(this.orient()>0){P[S]=c,I.boundary=!1,b.push(I),T.push(I),I.lastVisited=c;continue}I.lastVisited=-c}var z=I.adjacent,R=w.slice(),q=k.slice(),V=new t(R,q,!0);l.push(V);var W=z.indexOf(f);if(!(W<0))for(z[W]=V,q[L]=I,R[M]=-1,q[M]=f,k[M]=V,V.flip(),E=0;E<=h;++E){var K=R[E];if(!(K<0||K===c)){for(var G=new Array(h-1),Y=0,$=0;$<=h;++$){var B=R[$];B<0||$===E||(G[Y++]=B)}_.push(new a(G,V,E))}}}}}for(_.sort(r),M=0;M+1<_.length;M+=2){var N=_[M],U=_[M+1];N.index<0||U.index<0||(N.cell.adjacent[N.index]=U.cell,U.cell.adjacent[U.index]=N.cell)}},i.insert=function(u,f){var c=this.vertices;c.push(u);var h=this.walk(u,f);if(h){for(var p=this.dimension,o=this.tuple,b=0;b<=p;++b){var l=h.vertices[b];o[b]=l<0?u:c[l]}var T=this.orient(o);T<0||(0!==T||(h=this.handleBoundaryDegeneracy(h,u)))&&this.addPeaks(u,h)}},i.boundary=function(){for(var u=this.dimension,f=[],c=this.simplices,h=c.length,p=0;p<h;++p){var o=c[p];if(o.boundary){for(var b=new Array(u),l=o.vertices,T=0,_=0,w=0;w<=u;++w)l[w]>=0?b[T++]=l[w]:_=1&w;if(_===(1&u)){var k=b[0];b[0]=b[1],b[1]=k}f.push(b)}}return f}},{"robust-orientation":284,"simplicial-complex":293}],234:[function(v,m,x){"use strict";var e=v("binary-search-bounds");function n(T,_,w,k,L){this.mid=T,this.left=_,this.right=w,this.leftPoints=k,this.rightPoints=L,this.count=(_?_.count:0)+(w?w.count:0)+k.length}m.exports=function(T){return new b(T&&0!==T.length?o(T):null)};var t=n.prototype;function a(T,_){T.mid=_.mid,T.left=_.left,T.right=_.right,T.leftPoints=_.leftPoints,T.rightPoints=_.rightPoints,T.count=_.count}function r(T,_){var w=o(_);T.mid=w.mid,T.left=w.left,T.right=w.right,T.leftPoints=w.leftPoints,T.rightPoints=w.rightPoints,T.count=w.count}function d(T,_){var w=T.intervals([]);w.push(_),r(T,w)}function s(T,_){var w=T.intervals([]),k=w.indexOf(_);return k<0?0:(w.splice(k,1),r(T,w),1)}function i(T,_,w){for(var k=0;k<T.length&&T[k][0]<=_;++k){var L=w(T[k]);if(L)return L}}function u(T,_,w){for(var k=T.length-1;k>=0&&T[k][1]>=_;--k){var L=w(T[k]);if(L)return L}}function f(T,_){for(var w=0;w<T.length;++w){var k=_(T[w]);if(k)return k}}function c(T,_){return T-_}function h(T,_){return T[0]-_[0]||T[1]-_[1]}function p(T,_){return T[1]-_[1]||T[0]-_[0]}function o(T){if(0===T.length)return null;for(var _=[],w=0;w<T.length;++w)_.push(T[w][0],T[w][1]);_.sort(c);var k=_[_.length>>1],L=[],M=[],I=[];for(w=0;w<T.length;++w){var P=T[w];P[1]<k?L.push(P):k<P[0]?M.push(P):I.push(P)}var S=I,E=I.slice();return S.sort(h),E.sort(p),new n(k,o(L),o(M),S,E)}function b(T){this.root=T}t.intervals=function(T){return T.push.apply(T,this.leftPoints),this.left&&this.left.intervals(T),this.right&&this.right.intervals(T),T},t.insert=function(T){var _=this.count-this.leftPoints.length;if(this.count+=1,T[1]<this.mid)this.left?4*(this.left.count+1)>3*(_+1)?d(this,T):this.left.insert(T):this.left=o([T]);else if(T[0]>this.mid)this.right?4*(this.right.count+1)>3*(_+1)?d(this,T):this.right.insert(T):this.right=o([T]);else{var w=e.ge(this.leftPoints,T,h),k=e.ge(this.rightPoints,T,p);this.leftPoints.splice(w,0,T),this.rightPoints.splice(k,0,T)}},t.remove=function(T){var _=this.count-this.leftPoints;if(T[1]<this.mid)return this.left?4*(this.right?this.right.count:0)>3*(_-1)?s(this,T):2===(M=this.left.remove(T))?(this.left=null,this.count-=1,1):(1===M&&(this.count-=1),M):0;if(T[0]>this.mid)return this.right?4*(this.left?this.left.count:0)>3*(_-1)?s(this,T):2===(M=this.right.remove(T))?(this.right=null,this.count-=1,1):(1===M&&(this.count-=1),M):0;if(1===this.count)return this.leftPoints[0]===T?2:0;if(1===this.leftPoints.length&&this.leftPoints[0]===T){if(this.left&&this.right){for(var w=this,k=this.left;k.right;)w=k,k=k.right;if(w===this)k.right=this.right;else{var L=this.left,M=this.right;w.count-=k.count,w.right=k.left,k.left=L,k.right=M}a(this,k),this.count=(this.left?this.left.count:0)+(this.right?this.right.count:0)+this.leftPoints.length}else a(this,this.left?this.left:this.right);return 1}for(L=e.ge(this.leftPoints,T,h);L<this.leftPoints.length&&this.leftPoints[L][0]===T[0];++L)if(this.leftPoints[L]===T)for(this.count-=1,this.leftPoints.splice(L,1),M=e.ge(this.rightPoints,T,p);M<this.rightPoints.length&&this.rightPoints[M][1]===T[1];++M)if(this.rightPoints[M]===T)return this.rightPoints.splice(M,1),1;return 0},t.queryPoint=function(T,_){return T<this.mid?this.left&&(w=this.left.queryPoint(T,_))?w:i(this.leftPoints,T,_):T>this.mid?this.right&&(w=this.right.queryPoint(T,_))?w:u(this.rightPoints,T,_):f(this.leftPoints,_);var w},t.queryInterval=function(T,_,w){var k;return T<this.mid&&this.left&&(k=this.left.queryInterval(T,_,w))||_>this.mid&&this.right&&(k=this.right.queryInterval(T,_,w))?k:_<this.mid?i(this.leftPoints,_,w):T>this.mid?u(this.rightPoints,T,w):f(this.leftPoints,w)};var l=b.prototype;l.insert=function(T){this.root?this.root.insert(T):this.root=new n(T[0],null,null,[T],[T])},l.remove=function(T){if(this.root){var _=this.root.remove(T);return 2===_&&(this.root=null),0!==_}return!1},l.queryPoint=function(T,_){if(this.root)return this.root.queryPoint(T,_)},l.queryInterval=function(T,_,w){if(T<=_&&this.root)return this.root.queryInterval(T,_,w)},Object.defineProperty(l,"count",{get:function(){return this.root?this.root.count:0}}),Object.defineProperty(l,"intervals",{get:function(){return this.root?this.root.intervals([]):[]}})},{"binary-search-bounds":31}],235:[function(v,m,x){"use strict";m.exports=function(e){for(var n=new Array(e),t=0;t<e;++t)n[t]=t;return n}},{}],236:[function(v,m,x){m.exports=!0},{}],237:[function(v,m,x){function e(n){return!!n.constructor&&"function"==typeof n.constructor.isBuffer&&n.constructor.isBuffer(n)}m.exports=function(n){return null!=n&&(e(n)||"function"==typeof(t=n).readFloatLE&&"function"==typeof t.slice&&e(t.slice(0,0))||!!n._isBuffer);var t}},{}],238:[function(v,m,x){"use strict";m.exports=t,m.exports.isMobile=t,m.exports.default=t;var e=/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series[46]0|symbian|treo|up\.(browser|link)|vodafone|wap|windows (ce|phone)|xda|xiino/i,n=/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series[46]0|symbian|treo|up\.(browser|link)|vodafone|wap|windows (ce|phone)|xda|xiino|android|ipad|playbook|silk/i;function t(a){a||(a={});var r=a.ua;if(r||typeof navigator>"u"||(r=navigator.userAgent),r&&r.headers&&"string"==typeof r.headers["user-agent"]&&(r=r.headers["user-agent"]),"string"!=typeof r)return!1;var d=a.tablet?n.test(r):e.test(r);return!d&&a.tablet&&a.featureDetect&&navigator&&navigator.maxTouchPoints>1&&-1!==r.indexOf("Macintosh")&&-1!==r.indexOf("Safari")&&(d=!0),d}},{}],239:[function(v,m,x){"use strict";m.exports=function(e){for(var n,t=e.length,a=0;a<t;a++)if(((n=e.charCodeAt(a))<9||n>13)&&32!==n&&133!==n&&160!==n&&5760!==n&&6158!==n&&(n<8192||n>8205)&&8232!==n&&8233!==n&&8239!==n&&8287!==n&&8288!==n&&12288!==n&&65279!==n)return!1;return!0}},{}],240:[function(v,m,x){m.exports=function(e,n,t){return e*(1-t)+n*t}},{}],241:[function(v,m,x){var e=v("./normalize"),n=v("gl-mat4/create"),t=v("gl-mat4/clone"),a=v("gl-mat4/determinant"),r=v("gl-mat4/invert"),d=v("gl-mat4/transpose"),s={length:v("gl-vec3/length"),normalize:v("gl-vec3/normalize"),dot:v("gl-vec3/dot"),cross:v("gl-vec3/cross")},i=n(),u=n(),f=[0,0,0,0],c=[[0,0,0],[0,0,0],[0,0,0]],h=[0,0,0];function p(o,b,l,T,_){o[0]=b[0]*T+l[0]*_,o[1]=b[1]*T+l[1]*_,o[2]=b[2]*T+l[2]*_}m.exports=function(o,b,l,T,_,w){if(b||(b=[0,0,0]),l||(l=[0,0,0]),T||(T=[0,0,0]),_||(_=[0,0,0,1]),w||(w=[0,0,0,1]),!e(i,o)||(t(u,i),u[3]=0,u[7]=0,u[11]=0,u[15]=1,Math.abs(a(u)<1e-8)))return!1;var k,L,M,I,P,S,E,$,B,z=i[3],R=i[7],q=i[11],V=i[12],W=i[13],K=i[14],G=i[15];if(0!==z||0!==R||0!==q){if(f[0]=z,f[1]=R,f[2]=q,f[3]=G,!r(u,u))return!1;d(u,u),I=(L=f)[0],(k=_)[0]=(M=u)[0]*I+M[4]*(P=L[1])+M[8]*(S=L[2])+M[12]*(E=L[3]),k[1]=M[1]*I+M[5]*P+M[9]*S+M[13]*E,k[2]=M[2]*I+M[6]*P+M[10]*S+M[14]*E,k[3]=M[3]*I+M[7]*P+M[11]*S+M[15]*E}else _[0]=_[1]=_[2]=0,_[3]=1;if(b[0]=V,b[1]=W,b[2]=K,($=c)[0][0]=(B=i)[0],$[0][1]=B[1],$[0][2]=B[2],$[1][0]=B[4],$[1][1]=B[5],$[1][2]=B[6],$[2][0]=B[8],$[2][1]=B[9],$[2][2]=B[10],l[0]=s.length(c[0]),s.normalize(c[0],c[0]),T[0]=s.dot(c[0],c[1]),p(c[1],c[1],c[0],1,-T[0]),l[1]=s.length(c[1]),s.normalize(c[1],c[1]),T[0]/=l[1],T[1]=s.dot(c[0],c[2]),p(c[2],c[2],c[0],1,-T[1]),T[2]=s.dot(c[1],c[2]),p(c[2],c[2],c[1],1,-T[2]),l[2]=s.length(c[2]),s.normalize(c[2],c[2]),T[1]/=l[2],T[2]/=l[2],s.cross(h,c[1],c[2]),s.dot(c[0],h)<0)for(var Y=0;Y<3;Y++)l[Y]*=-1,c[Y][0]*=-1,c[Y][1]*=-1,c[Y][2]*=-1;return w[0]=.5*Math.sqrt(Math.max(1+c[0][0]-c[1][1]-c[2][2],0)),w[1]=.5*Math.sqrt(Math.max(1-c[0][0]+c[1][1]-c[2][2],0)),w[2]=.5*Math.sqrt(Math.max(1-c[0][0]-c[1][1]+c[2][2],0)),w[3]=.5*Math.sqrt(Math.max(1+c[0][0]+c[1][1]+c[2][2],0)),c[2][1]>c[1][2]&&(w[0]=-w[0]),c[0][2]>c[2][0]&&(w[1]=-w[1]),c[1][0]>c[0][1]&&(w[2]=-w[2]),!0}},{"./normalize":242,"gl-mat4/clone":92,"gl-mat4/create":93,"gl-mat4/determinant":94,"gl-mat4/invert":98,"gl-mat4/transpose":109,"gl-vec3/cross":157,"gl-vec3/dot":162,"gl-vec3/length":172,"gl-vec3/normalize":179}],242:[function(v,m,x){m.exports=function(e,n){var t=n[15];if(0===t)return!1;for(var a=1/t,r=0;r<16;r++)e[r]=n[r]*a;return!0}},{}],243:[function(v,m,x){var e=v("gl-vec3/lerp"),n=v("mat4-recompose"),t=v("mat4-decompose"),a=v("gl-mat4/determinant"),r=v("quat-slerp"),d=u(),s=u(),i=u();function u(){return{translate:f(),scale:f(1),skew:f(),perspective:[0,0,0,1],quaternion:[0,0,0,1]}}function f(c){return[c||0,c||0,c||0]}m.exports=function(c,h,p,o){if(0===a(h)||0===a(p))return!1;var b=t(h,d.translate,d.scale,d.skew,d.perspective,d.quaternion),l=t(p,s.translate,s.scale,s.skew,s.perspective,s.quaternion);return!(!b||!l||(e(i.translate,d.translate,s.translate,o),e(i.skew,d.skew,s.skew,o),e(i.scale,d.scale,s.scale,o),e(i.perspective,d.perspective,s.perspective,o),r(i.quaternion,d.quaternion,s.quaternion,o),n(c,i.translate,i.scale,i.skew,i.perspective,i.quaternion),0))}},{"gl-mat4/determinant":94,"gl-vec3/lerp":173,"mat4-decompose":241,"mat4-recompose":244,"quat-slerp":271}],244:[function(v,m,x){var e={identity:v("gl-mat4/identity"),translate:v("gl-mat4/translate"),multiply:v("gl-mat4/multiply"),create:v("gl-mat4/create"),scale:v("gl-mat4/scale"),fromRotationTranslation:v("gl-mat4/fromRotationTranslation")},n=(e.create(),e.create());m.exports=function(t,a,r,d,s,i){return e.identity(t),e.fromRotationTranslation(t,i,a),t[3]=s[0],t[7]=s[1],t[11]=s[2],t[15]=s[3],e.identity(n),0!==d[2]&&(n[9]=d[2],e.multiply(t,t,n)),0!==d[1]&&(n[9]=0,n[8]=d[1],e.multiply(t,t,n)),0!==d[0]&&(n[8]=0,n[4]=d[0],e.multiply(t,t,n)),e.scale(t,t,r),t}},{"gl-mat4/create":93,"gl-mat4/fromRotationTranslation":96,"gl-mat4/identity":97,"gl-mat4/multiply":100,"gl-mat4/scale":107,"gl-mat4/translate":108}],245:[function(v,m,x){"use strict";var e=v("binary-search-bounds"),n=v("mat4-interpolate"),t=v("gl-mat4/invert"),a=v("gl-mat4/rotateX"),r=v("gl-mat4/rotateY"),d=v("gl-mat4/rotateZ"),s=v("gl-mat4/lookAt"),i=v("gl-mat4/translate"),u=(v("gl-mat4/scale"),v("gl-vec3/normalize")),f=[0,0,0];function c(o){this._components=o.slice(),this._time=[0],this.prevMatrix=o.slice(),this.nextMatrix=o.slice(),this.computedMatrix=o.slice(),this.computedInverse=o.slice(),this.computedEye=[0,0,0],this.computedUp=[0,0,0],this.computedCenter=[0,0,0],this.computedRadius=[0],this._limits=[-1/0,1/0]}m.exports=function(o){return new c((o=o||{}).matrix||[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])};var h=c.prototype;h.recalcMatrix=function(o){var b=this._time,l=e.le(b,o),T=this.computedMatrix;if(!(l<0)){var _=this._components;if(l===b.length-1)for(var w=16*l,k=0;k<16;++k)T[k]=_[w++];else{var L=b[l+1]-b[l],M=(w=16*l,this.prevMatrix),I=!0;for(k=0;k<16;++k)M[k]=_[w++];var P=this.nextMatrix;for(k=0;k<16;++k)P[k]=_[w++],I=I&&M[k]===P[k];if(L<1e-6||I)for(k=0;k<16;++k)T[k]=M[k];else n(T,M,P,(o-b[l])/L)}var S=this.computedUp;S[0]=T[1],S[1]=T[5],S[2]=T[9],u(S,S);var E=this.computedInverse;t(E,T);var z=this.computedEye,R=E[15];z[0]=E[12]/R,z[1]=E[13]/R,z[2]=E[14]/R;var q=this.computedCenter,V=Math.exp(this.computedRadius[0]);for(k=0;k<3;++k)q[k]=z[k]-T[2+4*k]*V}},h.idle=function(o){if(!(o<this.lastT())){for(var b=this._components,l=b.length-16,T=0;T<16;++T)b.push(b[l++]);this._time.push(o)}},h.flush=function(o){var b=e.gt(this._time,o)-2;b<0||(this._time.splice(0,b),this._components.splice(0,16*b))},h.lastT=function(){return this._time[this._time.length-1]},h.lookAt=function(o,b,l,T){this.recalcMatrix(o),this.setMatrix(o,s(this.computedMatrix,b=b||this.computedEye,l=l||f,T=T||this.computedUp));for(var _=0,w=0;w<3;++w)_+=Math.pow(l[w]-b[w],2);_=Math.log(Math.sqrt(_)),this.computedRadius[0]=_},h.rotate=function(o,b,l,T){this.recalcMatrix(o);var _=this.computedInverse;b&&r(_,_,b),l&&a(_,_,l),T&&d(_,_,T),this.setMatrix(o,t(this.computedMatrix,_))};var p=[0,0,0];h.pan=function(o,b,l,T){p[0]=-(b||0),p[1]=-(l||0),p[2]=-(T||0),this.recalcMatrix(o);var _=this.computedInverse;i(_,_,p),this.setMatrix(o,t(_,_))},h.translate=function(o,b,l,T){p[0]=b||0,p[1]=l||0,p[2]=T||0,this.recalcMatrix(o);var _=this.computedMatrix;i(_,_,p),this.setMatrix(o,_)},h.setMatrix=function(o,b){if(!(o<this.lastT())){this._time.push(o);for(var l=0;l<16;++l)this._components.push(b[l])}},h.setDistance=function(o,b){this.computedRadius[0]=b},h.setDistanceLimits=function(o,b){var l=this._limits;l[0]=o,l[1]=b},h.getDistanceLimits=function(o){var b=this._limits;return o?(o[0]=b[0],o[1]=b[1],o):b}},{"binary-search-bounds":31,"gl-mat4/invert":98,"gl-mat4/lookAt":99,"gl-mat4/rotateX":104,"gl-mat4/rotateY":105,"gl-mat4/rotateZ":106,"gl-mat4/scale":107,"gl-mat4/translate":108,"gl-vec3/normalize":179,"mat4-interpolate":243}],246:[function(v,m,x){"use strict";m.exports=function(n){var t=n.length;if(t<3){for(var a=new Array(t),r=0;r<t;++r)a[r]=r;return 2===t&&n[0][0]===n[1][0]&&n[0][1]===n[1][1]?[0]:a}var d=new Array(t);for(r=0;r<t;++r)d[r]=r;d.sort(function(b,l){return n[b][0]-n[l][0]||n[b][1]-n[l][1]});var s=[d[0],d[1]],i=[d[0],d[1]];for(r=2;r<t;++r){for(var u=d[r],f=n[u],c=s.length;c>1&&e(n[s[c-2]],n[s[c-1]],f)<=0;)c-=1,s.pop();for(s.push(u),c=i.length;c>1&&e(n[i[c-2]],n[i[c-1]],f)>=0;)c-=1,i.pop();i.push(u)}a=new Array(i.length+s.length-2);for(var h=0,p=(r=0,s.length);r<p;++r)a[h++]=s[r];for(var o=i.length-2;o>0;--o)a[h++]=i[o];return a};var e=v("robust-orientation")[3]},{"robust-orientation":284}],247:[function(v,m,x){"use strict";m.exports=function(n,t){t||(t=n,n=window);var a=0,r=0,d=0,s={shift:!1,alt:!1,control:!1,meta:!1},i=!1;function u(w){var k=!1;return"altKey"in w&&(k=k||w.altKey!==s.alt,s.alt=!!w.altKey),"shiftKey"in w&&(k=k||w.shiftKey!==s.shift,s.shift=!!w.shiftKey),"ctrlKey"in w&&(k=k||w.ctrlKey!==s.control,s.control=!!w.ctrlKey),"metaKey"in w&&(k=k||w.metaKey!==s.meta,s.meta=!!w.metaKey),k}function f(w,k){var L=e.x(k),M=e.y(k);"buttons"in k&&(w=0|k.buttons),(w!==a||L!==r||M!==d||u(k))&&(a=0|w,r=L||0,d=M||0,t&&t(a,r,d,s))}function c(w){f(0,w)}function h(){(a||r||d||s.shift||s.alt||s.meta||s.control)&&(r=d=0,a=0,s.shift=s.alt=s.control=s.meta=!1,t&&t(0,0,0,s))}function p(w){u(w)&&t&&t(a,r,d,s)}function o(w){0===e.buttons(w)?f(0,w):f(a,w)}function b(w){f(a|e.buttons(w),w)}function l(w){f(a&~e.buttons(w),w)}function T(){i||(i=!0,n.addEventListener("mousemove",o),n.addEventListener("mousedown",b),n.addEventListener("mouseup",l),n.addEventListener("mouseleave",c),n.addEventListener("mouseenter",c),n.addEventListener("mouseout",c),n.addEventListener("mouseover",c),n.addEventListener("blur",h),n.addEventListener("keyup",p),n.addEventListener("keydown",p),n.addEventListener("keypress",p),n!==window&&(window.addEventListener("blur",h),window.addEventListener("keyup",p),window.addEventListener("keydown",p),window.addEventListener("keypress",p)))}T();var _={element:n};return Object.defineProperties(_,{enabled:{get:function(){return i},set:function(w){w?T():!i||(i=!1,n.removeEventListener("mousemove",o),n.removeEventListener("mousedown",b),n.removeEventListener("mouseup",l),n.removeEventListener("mouseleave",c),n.removeEventListener("mouseenter",c),n.removeEventListener("mouseout",c),n.removeEventListener("mouseover",c),n.removeEventListener("blur",h),n.removeEventListener("keyup",p),n.removeEventListener("keydown",p),n.removeEventListener("keypress",p),n!==window&&(window.removeEventListener("blur",h),window.removeEventListener("keyup",p),window.removeEventListener("keydown",p),window.removeEventListener("keypress",p)))},enumerable:!0},buttons:{get:function(){return a},enumerable:!0},x:{get:function(){return r},enumerable:!0},y:{get:function(){return d},enumerable:!0},mods:{get:function(){return s},enumerable:!0}}),_};var e=v("mouse-event")},{"mouse-event":249}],248:[function(v,m,x){var e={left:0,top:0};m.exports=function(n,t,a){t=t||n.currentTarget||n.srcElement,Array.isArray(a)||(a=[0,0]);var i,r=n.clientX||0,d=n.clientY||0,s=(i=t)===window||i===document||i===document.body?e:i.getBoundingClientRect();return a[0]=r-s.left,a[1]=d-s.top,a}},{}],249:[function(v,m,x){"use strict";function e(n){return n.target||n.srcElement||window}x.buttons=function(n){if("object"==typeof n){if("buttons"in n)return n.buttons;if("which"in n){if(2===(t=n.which))return 4;if(3===t)return 2;if(t>0)return 1<<t-1}else if("button"in n){var t;if(1===(t=n.button))return 4;if(2===t)return 2;if(t>=0)return 1<<t}}return 0},x.element=e,x.x=function(n){if("object"==typeof n){if("offsetX"in n)return n.offsetX;var t=e(n).getBoundingClientRect();return n.clientX-t.left}return 0},x.y=function(n){if("object"==typeof n){if("offsetY"in n)return n.offsetY;var t=e(n).getBoundingClientRect();return n.clientY-t.top}return 0}},{}],250:[function(v,m,x){"use strict";var e=v("to-px");m.exports=function(n,t,a){"function"==typeof n&&(a=!!t,t=n,n=window);var r=e("ex",n),d=function(s){a&&s.preventDefault();var i=s.deltaX||0,u=s.deltaY||0,f=s.deltaZ||0,c=1;switch(s.deltaMode){case 1:c=r;break;case 2:c=window.innerHeight}if(u*=c,f*=c,(i*=c)||u||f)return t(i,u,f,s)};return n.addEventListener("wheel",d),d}},{"to-px":304}],251:[function(v,m,x){"use strict";var e=v("typedarray-pool");m.exports=function(t){function a(c){throw new Error("ndarray-extract-contour: "+c)}"object"!=typeof t&&a("Must specify arguments");var r=t.order;Array.isArray(r)||a("Must specify order");var c,h,p,T,d=t.arrayArguments||1;d<1&&a("Must have at least one array argument"),(t.scalarArguments||0)<0&&a("Scalar arg count must be > 0"),"function"!=typeof t.vertex&&a("Must specify vertex creation function"),"function"!=typeof t.cell&&a("Must specify cell creation function"),"function"!=typeof t.phase&&a("Must specify phase function");for(var i=t.getters||[],u=new Array(d),f=0;f<d;++f)u[f]=i.indexOf(f)>=0;return c=t.vertex,h=t.cell,p=t.phase,T=[u,r].join(","),(0,n[T])(c,h,p,e.mallocUint32,e.freeUint32)};var n={"false,0,1":function(t,a,r,d,s){return function(i,u,f,c){var h,p=0|i.shape[0],o=0|i.shape[1],b=i.data,T=0|i.stride[0],_=0|i.stride[1],w=0|i.offset,k=0|-T,L=0,M=0|-_,I=0,P=-T-_|0,S=0,E=0|T,z=_-T*p|0,R=0,q=0,V=0,W=2*p|0,K=d(W),G=d(W),Y=0,$=0,B=-1,N=-1,U=0,te=0|-p,j=0|p,J=0,X=-p-1|0,re=p-1|0,ne=0,le=0,oe=0;for(R=0;R<p;++R)K[Y++]=r(b[w],u,f,c),w+=E;if(w+=z,o>0){if(q=1,K[Y++]=r(b[w],u,f,c),w+=E,p>0)for(R=1,$=K[Y]=r(h=b[w],u,f,c),J=K[Y+te],ne=K[Y+X],$===(U=K[Y+B])&&$===J&&$===ne||(t(R,q,h,L=b[w+k],I=b[w+M],S=b[w+P],$,U,J,ne,u,f,c),le=G[Y]=V++),Y+=1,w+=E,R=2;R<p;++R)$=K[Y]=r(h=b[w],u,f,c),J=K[Y+te],ne=K[Y+X],$===(U=K[Y+B])&&$===J&&$===ne||(t(R,q,h,L=b[w+k],I=b[w+M],S=b[w+P],$,U,J,ne,u,f,c),le=G[Y]=V++,ne!==U&&a(G[Y+B],le,S,L,ne,U,u,f,c)),Y+=1,w+=E;for(w+=z,Y=0,oe=B,B=N,N=oe,oe=te,te=j,j=oe,oe=X,X=re,re=oe,q=2;q<o;++q){if(K[Y++]=r(b[w],u,f,c),w+=E,p>0)for(R=1,$=K[Y]=r(h=b[w],u,f,c),J=K[Y+te],ne=K[Y+X],$===(U=K[Y+B])&&$===J&&$===ne||(t(R,q,h,L=b[w+k],I=b[w+M],S=b[w+P],$,U,J,ne,u,f,c),le=G[Y]=V++,ne!==J&&a(G[Y+te],le,I,S,J,ne,u,f,c)),Y+=1,w+=E,R=2;R<p;++R)$=K[Y]=r(h=b[w],u,f,c),J=K[Y+te],ne=K[Y+X],$===(U=K[Y+B])&&$===J&&$===ne||(t(R,q,h,L=b[w+k],I=b[w+M],S=b[w+P],$,U,J,ne,u,f,c),le=G[Y]=V++,ne!==J&&a(G[Y+te],le,I,S,J,ne,u,f,c),ne!==U&&a(G[Y+B],le,S,L,ne,U,u,f,c)),Y+=1,w+=E;1&q&&(Y=0),oe=B,B=N,N=oe,oe=te,te=j,j=oe,oe=X,X=re,re=oe,w+=z}}s(G),s(K)}},"false,1,0":function(t,a,r,d,s){return function(i,u,f,c){var h,p=0|i.shape[0],o=0|i.shape[1],b=i.data,T=0|i.stride[0],_=0|i.stride[1],w=0|i.offset,k=0|-T,L=0,M=0|-_,I=0,P=-T-_|0,S=0,E=0|_,z=T-_*o|0,R=0,q=0,V=0,W=2*o|0,K=d(W),G=d(W),Y=0,$=0,B=-1,N=-1,U=0,te=0|-o,j=0|o,J=0,X=-o-1|0,re=o-1|0,ne=0,le=0,oe=0;for(q=0;q<o;++q)K[Y++]=r(b[w],u,f,c),w+=E;if(w+=z,p>0){if(R=1,K[Y++]=r(b[w],u,f,c),w+=E,o>0)for(q=1,$=K[Y]=r(h=b[w],u,f,c),U=K[Y+B],ne=K[Y+X],$===(J=K[Y+te])&&$===U&&$===ne||(t(R,q,h,L=b[w+k],I=b[w+M],S=b[w+P],$,J,U,ne,u,f,c),le=G[Y]=V++),Y+=1,w+=E,q=2;q<o;++q)$=K[Y]=r(h=b[w],u,f,c),U=K[Y+B],ne=K[Y+X],$===(J=K[Y+te])&&$===U&&$===ne||(t(R,q,h,L=b[w+k],I=b[w+M],S=b[w+P],$,J,U,ne,u,f,c),le=G[Y]=V++,ne!==U&&a(G[Y+B],le,I,S,U,ne,u,f,c)),Y+=1,w+=E;for(w+=z,Y=0,oe=te,te=j,j=oe,oe=B,B=N,N=oe,oe=X,X=re,re=oe,R=2;R<p;++R){if(K[Y++]=r(b[w],u,f,c),w+=E,o>0)for(q=1,$=K[Y]=r(h=b[w],u,f,c),U=K[Y+B],ne=K[Y+X],$===(J=K[Y+te])&&$===U&&$===ne||(t(R,q,h,L=b[w+k],I=b[w+M],S=b[w+P],$,J,U,ne,u,f,c),le=G[Y]=V++,ne!==J&&a(G[Y+te],le,S,L,ne,J,u,f,c)),Y+=1,w+=E,q=2;q<o;++q)$=K[Y]=r(h=b[w],u,f,c),U=K[Y+B],ne=K[Y+X],$===(J=K[Y+te])&&$===U&&$===ne||(t(R,q,h,L=b[w+k],I=b[w+M],S=b[w+P],$,J,U,ne,u,f,c),le=G[Y]=V++,ne!==U&&a(G[Y+B],le,I,S,U,ne,u,f,c),ne!==J&&a(G[Y+te],le,S,L,ne,J,u,f,c)),Y+=1,w+=E;1&R&&(Y=0),oe=te,te=j,j=oe,oe=B,B=N,N=oe,oe=X,X=re,re=oe,w+=z}}s(G),s(K)}}}},{"typedarray-pool":308}],252:[function(v,m,x){"use strict";var e=v("dup"),n={zero:function(p,o,b,l){var T=p[0];l|=0;var _=0,w=b[0];for(_=0;_<T;++_)o[l]=0,l+=w},fdTemplate1:function(p,o,b,l,T,_,w){var k=p[0],L=b[0],M=-1*L,I=L;l|=0,w|=0;var P=0,S=L,E=_[0];for(P=0;P<k;++P)T[w]=.5*(o[l+M]-o[l+I]),l+=S,w+=E},fdTemplate2:function(p,o,b,l,T,_,w,k,L,M){var I=p[0],P=p[1],S=b[0],E=b[1],R=_[1],V=L[1],W=-1*S,K=S,G=-1*E,Y=E;l|=0,w|=0,M|=0;var $=0,B=0,N=E,U=S-P*E,te=R,j=_[0]-P*R,J=V,X=L[0]-P*V;for(B=0;B<I;++B){for($=0;$<P;++$)T[w]=.5*(o[l+W]-o[l+K]),k[M]=.5*(o[l+G]-o[l+Y]),l+=N,w+=te,M+=J;l+=U,w+=j,M+=X}}},t={cdiff:function(p){var o={};return function(b,l,T){var _=b.dtype,w=b.order,k=l.dtype,L=l.order,M=T.dtype,I=T.order,P=[_,w.join(),k,L.join(),M,I.join()].join(),S=o[P];return S||(o[P]=S=p([_,w,k,L,M,I])),S(b.shape.slice(0),b.data,b.stride,0|b.offset,l.data,l.stride,0|l.offset,T.data,T.stride,0|T.offset)}},zero:function(p){var o={};return function(b){var l=b.dtype,T=b.order,_=[l,T.join()].join(),w=o[_];return w||(o[_]=w=p([l,T])),w(b.shape.slice(0),b.data,b.stride,0|b.offset)}},fdTemplate1:function(p){var o={};return function(b,l){var T=b.dtype,_=b.order,w=l.dtype,k=l.order,L=[T,_.join(),w,k.join()].join(),M=o[L];return M||(o[L]=M=p([T,_,w,k])),M(b.shape.slice(0),b.data,b.stride,0|b.offset,l.data,l.stride,0|l.offset)}},fdTemplate2:function(p){var o={};return function(b,l,T){var _=b.dtype,w=b.order,k=l.dtype,L=l.order,M=T.dtype,I=T.order,P=[_,w.join(),k,L.join(),M,I.join()].join(),S=o[P];return S||(o[P]=S=p([_,w,k,L,M,I])),S(b.shape.slice(0),b.data,b.stride,0|b.offset,l.data,l.stride,0|l.offset,T.data,T.stride,0|T.offset)}}};function a(p){return(0,t[p.funcName])(r.bind(void 0,p))}function r(p){return n[p.funcName]}function d(p){return a({funcName:p.funcName})}var s={},i={},u=d({funcName:"cdiff"}),f=d({funcName:"zero"});function c(p){return p in s?s[p]:s[p]=d({funcName:"fdTemplate"+p})}function h(p,o,b,l){return function(T,_){var w=_.shape.slice();return w[0]>2&&w[1]>2&&l(_.pick(-1,-1).lo(1,1).hi(w[0]-2,w[1]-2),T.pick(-1,-1,0).lo(1,1).hi(w[0]-2,w[1]-2),T.pick(-1,-1,1).lo(1,1).hi(w[0]-2,w[1]-2)),w[1]>2&&(b(_.pick(0,-1).lo(1).hi(w[1]-2),T.pick(0,-1,1).lo(1).hi(w[1]-2)),o(T.pick(0,-1,0).lo(1).hi(w[1]-2))),w[1]>2&&(b(_.pick(w[0]-1,-1).lo(1).hi(w[1]-2),T.pick(w[0]-1,-1,1).lo(1).hi(w[1]-2)),o(T.pick(w[0]-1,-1,0).lo(1).hi(w[1]-2))),w[0]>2&&(b(_.pick(-1,0).lo(1).hi(w[0]-2),T.pick(-1,0,0).lo(1).hi(w[0]-2)),o(T.pick(-1,0,1).lo(1).hi(w[0]-2))),w[0]>2&&(b(_.pick(-1,w[1]-1).lo(1).hi(w[0]-2),T.pick(-1,w[1]-1,0).lo(1).hi(w[0]-2)),o(T.pick(-1,w[1]-1,1).lo(1).hi(w[0]-2))),T.set(0,0,0,0),T.set(0,0,1,0),T.set(w[0]-1,0,0,0),T.set(w[0]-1,0,1,0),T.set(0,w[1]-1,0,0),T.set(0,w[1]-1,1,0),T.set(w[0]-1,w[1]-1,0,0),T.set(w[0]-1,w[1]-1,1,0),T}}m.exports=function(p,o,b){return Array.isArray(b)||(b=e(o.dimension,"string"==typeof b?b:"clamp")),0===o.size?p:0===o.dimension?(p.set(0),p):function(l){var T=l.join();if(L=i[T])return L;for(var _=l.length,w=[u,f],k=1;k<=_;++k)w.push(c(k));var L=h.apply(void 0,w);return i[T]=L,L}(b)(p,o)}},{dup:65}],253:[function(v,m,x){"use strict";function e(r,d){var s=Math.floor(d),i=d-s,f=0<=s+1&&s+1<r.shape[0];return(1-i)*(0<=s&&s<r.shape[0]?+r.get(s):0)+i*(f?+r.get(s+1):0)}function n(r,d,s){var i=Math.floor(d),u=d-i,f=0<=i&&i<r.shape[0],c=0<=i+1&&i+1<r.shape[0],h=Math.floor(s),p=s-h,o=0<=h&&h<r.shape[1],b=0<=h+1&&h+1<r.shape[1],l=f&&o?r.get(i,h):0,T=f&&b?r.get(i,h+1):0;return(1-p)*((1-u)*l+u*(c&&o?r.get(i+1,h):0))+p*((1-u)*T+u*(c&&b?r.get(i+1,h+1):0))}function t(r,d,s,i){var u=Math.floor(d),f=d-u,c=0<=u&&u<r.shape[0],h=0<=u+1&&u+1<r.shape[0],p=Math.floor(s),o=s-p,b=0<=p&&p<r.shape[1],l=0<=p+1&&p+1<r.shape[1],T=Math.floor(i),_=i-T,w=0<=T&&T<r.shape[2],k=0<=T+1&&T+1<r.shape[2],L=c&&b&&w?r.get(u,p,T):0,M=c&&l&&w?r.get(u,p+1,T):0,I=h&&b&&w?r.get(u+1,p,T):0,P=h&&l&&w?r.get(u+1,p+1,T):0,S=c&&b&&k?r.get(u,p,T+1):0,E=c&&l&&k?r.get(u,p+1,T+1):0;return(1-_)*((1-o)*((1-f)*L+f*I)+o*((1-f)*M+f*P))+_*((1-o)*((1-f)*S+f*(h&&b&&k?r.get(u+1,p,T+1):0))+o*((1-f)*E+f*(h&&l&&k?r.get(u+1,p+1,T+1):0)))}function a(r){var d,s,i=0|r.shape.length,u=new Array(i),f=new Array(i),c=new Array(i),h=new Array(i);for(d=0;d<i;++d)s=+arguments[d+1],u[d]=Math.floor(s),f[d]=s-u[d],c[d]=0<=u[d]&&u[d]<r.shape[d],h[d]=0<=u[d]+1&&u[d]+1<r.shape[d];var p,o,b,l=0;e:for(d=0;d<1<<i;++d){for(o=1,b=r.offset,p=0;p<i;++p)if(d&1<<p){if(!h[p])continue e;o*=f[p],b+=r.stride[p]*(u[p]+1)}else{if(!c[p])continue e;o*=1-f[p],b+=r.stride[p]*u[p]}l+=o*r.data[b]}return l}m.exports=function(r,d,s,i){switch(r.shape.length){case 0:return 0;case 1:return e(r,d);case 2:return n(r,d,s);case 3:return t(r,d,s,i);default:return a.apply(void 0,arguments)}},m.exports.d1=e,m.exports.d2=n,m.exports.d3=t},{}],254:[function(v,m,x){"use strict";var e={"float64,2,1,0":function(){return function(d,s,i,u,f){var c=d[0],h=d[1],p=d[2],b=i[1],l=i[2];u|=0;var T=0,_=0,w=0,k=l,L=b-p*l,M=i[0]-h*b;for(w=0;w<c;++w){for(_=0;_<h;++_){for(T=0;T<p;++T)s[u]/=f,u+=k;u+=L}u+=M}}},"uint8,2,0,1,float64,2,1,0":function(){return function(d,s,i,u,f,c,h,p){for(var o=d[0],b=d[1],l=d[2],T=i[0],_=i[1],w=i[2],k=c[0],L=c[1],M=c[2],I=u|=0,P=h|=0,S=0|d[0];S>0;){S<64?(o=S,S=0):(o=64,S-=64);for(var E=0|d[1];E>0;){E<64?(b=E,E=0):(b=64,E-=64),u=I+S*T+E*_,h=P+S*k+E*L;var z=0,R=0,q=0,V=w,W=T-l*w,K=_-o*T,G=M,Y=k-l*M,$=L-o*k;for(q=0;q<b;++q){for(R=0;R<o;++R){for(z=0;z<l;++z)s[u]=f[h]*p,u+=V,h+=G;u+=W,h+=Y}u+=K,h+=$}}}}},"float32,1,0,float32,1,0":function(){return function(d,s,i,u,f,c,h){var p=d[0],o=d[1],l=i[1],_=c[1];u|=0,h|=0;var w=0,k=0,L=l,M=i[0]-o*l,I=_,P=c[0]-o*_;for(k=0;k<p;++k){for(w=0;w<o;++w)s[u]=f[h],u+=L,h+=I;u+=M,h+=P}}},"float32,1,0,float32,0,1":function(){return function(d,s,i,u,f,c,h){for(var p=d[0],o=d[1],b=i[0],l=i[1],T=c[0],_=c[1],w=u|=0,k=h|=0,L=0|d[1];L>0;){L<64?(o=L,L=0):(o=64,L-=64);for(var M=0|d[0];M>0;){M<64?(p=M,M=0):(p=64,M-=64),u=w+L*l+M*b,h=k+L*_+M*T;var I=0,P=0,S=l,E=b-o*l,z=_,R=T-o*_;for(P=0;P<p;++P){for(I=0;I<o;++I)s[u]=f[h],u+=S,h+=z;u+=E,h+=R}}}}},"uint8,2,0,1,uint8,1,2,0":function(){return function(d,s,i,u,f,c,h){for(var p=d[0],o=d[1],b=d[2],l=i[0],T=i[1],_=i[2],w=c[0],k=c[1],L=c[2],M=u|=0,I=h|=0,P=0|d[2];P>0;){P<64?(b=P,P=0):(b=64,P-=64);for(var S=0|d[0];S>0;){S<64?(p=S,S=0):(p=64,S-=64);for(var E=0|d[1];E>0;){E<64?(o=E,E=0):(o=64,E-=64),u=M+P*_+S*l+E*T,h=I+P*L+S*w+E*k;var z=0,R=0,q=0,V=_,W=l-b*_,K=T-p*l,G=L,Y=w-b*L,$=k-p*w;for(q=0;q<o;++q){for(R=0;R<p;++R){for(z=0;z<b;++z)s[u]=f[h],u+=V,h+=G;u+=W,h+=Y}u+=K,h+=$}}}}}},"uint8,2,0,1,array,2,0,1":function(){return function(d,s,i,u,f,c,h){var p=d[0],o=d[1],b=d[2],l=i[0],_=i[2],w=c[0],L=c[2];u|=0,h|=0;var M=0,I=0,P=0,S=_,E=l-b*_,z=i[1]-p*l,R=L,q=w-b*L,V=c[1]-p*w;for(P=0;P<o;++P){for(I=0;I<p;++I){for(M=0;M<b;++M)s[u]=f[h],u+=S,h+=R;u+=E,h+=q}u+=z,h+=V}}}},n=function(d,s){var i=s.join(",");return(0,e[i])()},t={mul:function(d){var s={};return function(i,u,f){var c=i.dtype,h=i.order,p=u.dtype,o=u.order,b=f.dtype,l=f.order,T=[c,h.join(),p,o.join(),b,l.join()].join(),_=s[T];return _||(s[T]=_=d([c,h,p,o,b,l])),_(i.shape.slice(0),i.data,i.stride,0|i.offset,u.data,u.stride,0|u.offset,f.data,f.stride,0|f.offset)}},muls:function(d){var s={};return function(i,u,f){var c=i.dtype,h=i.order,p=u.dtype,o=u.order,b=[c,h.join(),p,o.join()].join(),l=s[b];return l||(s[b]=l=d([c,h,p,o])),l(i.shape.slice(0),i.data,i.stride,0|i.offset,u.data,u.stride,0|u.offset,f)}},mulseq:function(d){var s={};return function(i,u){var f=i.dtype,c=i.order,h=[f,c.join()].join(),p=s[h];return p||(s[h]=p=d([f,c])),p(i.shape.slice(0),i.data,i.stride,0|i.offset,u)}},div:function(d){var s={};return function(i,u,f){var c=i.dtype,h=i.order,p=u.dtype,o=u.order,b=f.dtype,l=f.order,T=[c,h.join(),p,o.join(),b,l.join()].join(),_=s[T];return _||(s[T]=_=d([c,h,p,o,b,l])),_(i.shape.slice(0),i.data,i.stride,0|i.offset,u.data,u.stride,0|u.offset,f.data,f.stride,0|f.offset)}},divs:function(d){var s={};return function(i,u,f){var c=i.dtype,h=i.order,p=u.dtype,o=u.order,b=[c,h.join(),p,o.join()].join(),l=s[b];return l||(s[b]=l=d([c,h,p,o])),l(i.shape.slice(0),i.data,i.stride,0|i.offset,u.data,u.stride,0|u.offset,f)}},divseq:function(d){var s={};return function(i,u){var f=i.dtype,c=i.order,h=[f,c.join()].join(),p=s[h];return p||(s[h]=p=d([f,c])),p(i.shape.slice(0),i.data,i.stride,0|i.offset,u)}},assign:function(d){var s={};return function(i,u){var f=i.dtype,c=i.order,h=u.dtype,p=u.order,o=[f,c.join(),h,p.join()].join(),b=s[o];return b||(s[o]=b=d([f,c,h,p])),b(i.shape.slice(0),i.data,i.stride,0|i.offset,u.data,u.stride,0|u.offset)}}};function a(d){return(0,t[(s={funcName:d.funcName}).funcName])(n.bind(void 0,s));var s}var r={mul:"*",div:"/"};(function(){for(var d in r)x[d]=a({funcName:d}),x[d+"s"]=a({funcName:d+"s"}),x[d+"seq"]=a({funcName:d+"seq"})})(),x.assign=a({funcName:"assign"})},{}],255:[function(v,m,x){"use strict";var e=v("ndarray"),n=v("./doConvert.js");m.exports=function(t,a){for(var r=[],d=t,s=1;Array.isArray(d);)r.push(d.length),s*=d.length,d=d[0];return 0===r.length?e():(a||(a=e(new Float64Array(s),r)),n(a,t),a)}},{"./doConvert.js":256,ndarray:259}],256:[function(v,m,x){"use strict";var t,a;m.exports=(t=function(){return function(t,a,r,d,s){var i=t[0],u=t[1],f=t[2],h=r[1],p=r[2],o=[0,0,0];d|=0;var b=0,l=0,T=0,_=p,w=h-f*p,k=r[0]-u*h;for(T=0;T<i;++T){for(l=0;l<u;++l){for(b=0;b<f;++b){var L,M=s;for(L=0;L<o.length-1;++L)M=M[o[L]];a[d]=M[o[o.length-1]],d+=_,++o[2]}d+=w,o[2]-=f,++o[1]}d+=k,o[1]-=u,++o[0]}}}.bind(void 0,{funcName:"convert"}),a={},function(r,d){var s=r.dtype,i=r.order,u=[s,i.join()].join(),f=a[u];return f||(a[u]=f=t([s,i])),f(r.shape.slice(0),r.data,r.stride,0|r.offset,d)})},{}],257:[function(v,m,x){"use strict";var e=v("typedarray-pool");function n(d){return"uint32"===d?[e.mallocUint32,e.freeUint32]:null}var t={"uint32,1,0":function(d,s){return function(i,u,f,c,h,p,o,b,l,T,_){var w,k,L,M,I,P,S,E,z=i*h+c,R=d(b);for(w=i+1;w<=u;++w){for(k=w,L=z+=h,I=0,P=z,M=0;M<b;++M)R[I++]=f[P],P+=l;e:for(;k-- >i;){I=0,P=L-h;t:for(M=0;M<b;++M){if((S=f[P])<(E=R[I]))break e;if(S>E)break t;P+=T,I+=_}for(I=L,P=L-h,M=0;M<b;++M)f[I]=f[P],I+=l,P+=l;L-=h}for(I=L,P=0,M=0;M<b;++M)f[I]=R[P++],I+=l}s(R)}}},a={"uint32,1,0":function(d,s,i){return function u(f,c,h,p,o,b,l,T,_,w,k){var L,M,P,S,E,z,R,q,V,W,K,G,Y,$,B,N,U,te,j,J,X,re,ne,le,oe=(c-f+1)/6|0,de=f+oe,se=c-oe,ge=f+c>>1,_e=ge-oe,Te=ge+oe,we=de,Oe=_e,fe=ge,ve=Te,Ae=se,ke=f+1,Pe=c-1,Ne=!0,De=0,ze=0,Me=0,Se=T,Ie=s(Se),Fe=s(Se);W=o*we,K=o*Oe,le=p;e:for(V=0;V<T;++V){if((Me=h[z=W+le]-h[R=K+le])>0){M=we,we=Oe,Oe=M;break e}if(Me<0)break e;le+=w}W=o*ve,K=o*Ae,le=p;e:for(V=0;V<T;++V){if((Me=h[z=W+le]-h[R=K+le])>0){M=ve,ve=Ae,Ae=M;break e}if(Me<0)break e;le+=w}W=o*we,K=o*fe,le=p;e:for(V=0;V<T;++V){if((Me=h[z=W+le]-h[R=K+le])>0){M=we,we=fe,fe=M;break e}if(Me<0)break e;le+=w}W=o*Oe,K=o*fe,le=p;e:for(V=0;V<T;++V){if((Me=h[z=W+le]-h[R=K+le])>0){M=Oe,Oe=fe,fe=M;break e}if(Me<0)break e;le+=w}W=o*we,K=o*ve,le=p;e:for(V=0;V<T;++V){if((Me=h[z=W+le]-h[R=K+le])>0){M=we,we=ve,ve=M;break e}if(Me<0)break e;le+=w}W=o*fe,K=o*ve,le=p;e:for(V=0;V<T;++V){if((Me=h[z=W+le]-h[R=K+le])>0){M=fe,fe=ve,ve=M;break e}if(Me<0)break e;le+=w}W=o*Oe,K=o*Ae,le=p;e:for(V=0;V<T;++V){if((Me=h[z=W+le]-h[R=K+le])>0){M=Oe,Oe=Ae,Ae=M;break e}if(Me<0)break e;le+=w}W=o*Oe,K=o*fe,le=p;e:for(V=0;V<T;++V){if((Me=h[z=W+le]-h[R=K+le])>0){M=Oe,Oe=fe,fe=M;break e}if(Me<0)break e;le+=w}W=o*ve,K=o*Ae,le=p;e:for(V=0;V<T;++V){if((Me=h[z=W+le]-h[R=K+le])>0){M=ve,ve=Ae,Ae=M;break e}if(Me<0)break e;le+=w}for(W=o*we,K=o*Oe,G=o*fe,Y=o*ve,$=o*Ae,B=o*de,N=o*ge,U=o*se,ne=0,le=p,V=0;V<T;++V)z=W+le,q=G+le,te=Y+le,j=$+le,J=B+le,X=N+le,re=U+le,Ie[ne]=h[R=K+le],Fe[ne]=h[te],Ne=Ne&&Ie[ne]===Fe[ne],P=h[q],S=h[j],h[J]=h[z],h[X]=P,h[re]=S,++ne,le+=_;for(W=o*_e,K=o*f,le=p,V=0;V<T;++V)h[z=W+le]=h[R=K+le],le+=_;for(W=o*Te,K=o*c,le=p,V=0;V<T;++V)h[z=W+le]=h[R=K+le],le+=_;if(Ne)for(E=ke;E<=Pe;++E){for(z=p+E*o,ne=0,V=0;V<T&&0==(Me=h[z]-Ie[ne]);++V)ne+=k,z+=w;if(0!==Me)if(Me<0){if(E!==ke)for(W=o*E,K=o*ke,le=p,V=0;V<T;++V)L=h[z=W+le],h[z]=h[R=K+le],h[R]=L,le+=_;++ke}else for(;;){for(z=p+Pe*o,ne=0,V=0;V<T&&0==(Me=h[z]-Ie[ne]);++V)ne+=k,z+=w;if(!(Me>0)){if(Me<0){for(W=o*E,K=o*ke,G=o*Pe,le=p,V=0;V<T;++V)q=G+le,L=h[z=W+le],h[z]=h[R=K+le],h[R]=h[q],h[q]=L,le+=_;++ke,--Pe;break}for(W=o*E,K=o*Pe,le=p,V=0;V<T;++V)L=h[z=W+le],h[z]=h[R=K+le],h[R]=L,le+=_;--Pe;break}Pe--}}else for(E=ke;E<=Pe;++E){for(z=p+E*o,ne=0,V=0;V<T&&0==(De=h[z]-Ie[ne]);++V)ne+=k,z+=w;if(De<0){if(E!==ke)for(W=o*E,K=o*ke,le=p,V=0;V<T;++V)L=h[z=W+le],h[z]=h[R=K+le],h[R]=L,le+=_;++ke}else{for(z=p+E*o,ne=0,V=0;V<T&&0==(ze=h[z]-Fe[ne]);++V)ne+=k,z+=w;if(ze>0)for(;;){for(z=p+Pe*o,ne=0,V=0;V<T&&0==(Me=h[z]-Fe[ne]);++V)ne+=k,z+=w;if(!(Me>0)){for(z=p+Pe*o,ne=0,V=0;V<T&&0==(Me=h[z]-Ie[ne]);++V)ne+=k,z+=w;if(Me<0){for(W=o*E,K=o*ke,G=o*Pe,le=p,V=0;V<T;++V)q=G+le,L=h[z=W+le],h[z]=h[R=K+le],h[R]=h[q],h[q]=L,le+=_;++ke,--Pe}else{for(W=o*E,K=o*Pe,le=p,V=0;V<T;++V)L=h[z=W+le],h[z]=h[R=K+le],h[R]=L,le+=_;--Pe}break}if(--Pe<E)break}}}for(W=o*f,K=o*(ke-1),ne=0,le=p,V=0;V<T;++V)h[z=W+le]=h[R=K+le],h[R]=Ie[ne],++ne,le+=_;for(W=o*c,K=o*(Pe+1),ne=0,le=p,V=0;V<T;++V)h[z=W+le]=h[R=K+le],h[R]=Fe[ne],++ne,le+=_;if(ke-2-f<=32?d(f,ke-2,h,p,o,b,l,T,_,w,k):u(f,ke-2,h,p,o,b,l,T,_,w,k),c-(Pe+2)<=32?d(Pe+2,c,h,p,o,b,l,T,_,w,k):u(Pe+2,c,h,p,o,b,l,T,_,w,k),Ne)return i(Ie),void i(Fe);if(ke<de&&Pe>se){e:for(;;){for(z=p+ke*o,ne=0,le=p,V=0;V<T;++V){if(h[z]!==Ie[ne])break e;++ne,z+=_}++ke}e:for(;;){for(z=p+Pe*o,ne=0,le=p,V=0;V<T;++V){if(h[z]!==Fe[ne])break e;++ne,z+=_}--Pe}for(E=ke;E<=Pe;++E){for(z=p+E*o,ne=0,V=0;V<T&&0==(De=h[z]-Ie[ne]);++V)ne+=k,z+=w;if(0===De){if(E!==ke)for(W=o*E,K=o*ke,le=p,V=0;V<T;++V)L=h[z=W+le],h[z]=h[R=K+le],h[R]=L,le+=_;++ke}else{for(z=p+E*o,ne=0,V=0;V<T&&0==(ze=h[z]-Fe[ne]);++V)ne+=k,z+=w;if(0===ze)for(;;){for(z=p+Pe*o,ne=0,V=0;V<T&&0==(Me=h[z]-Fe[ne]);++V)ne+=k,z+=w;if(0!==Me){for(z=p+Pe*o,ne=0,V=0;V<T&&0==(Me=h[z]-Ie[ne]);++V)ne+=k,z+=w;if(Me<0){for(W=o*E,K=o*ke,G=o*Pe,le=p,V=0;V<T;++V)q=G+le,L=h[z=W+le],h[z]=h[R=K+le],h[R]=h[q],h[q]=L,le+=_;++ke,--Pe}else{for(W=o*E,K=o*Pe,le=p,V=0;V<T;++V)L=h[z=W+le],h[z]=h[R=K+le],h[R]=L,le+=_;--Pe}break}if(--Pe<E)break}}}}i(Ie),i(Fe),Pe-ke<=32?d(ke,Pe,h,p,o,b,l,T,_,w,k):u(ke,Pe,h,p,o,b,l,T,_,w,k)}}},r={"uint32,1,0":function(d,s){return function(i){var u=i.data,f=0|i.offset,c=i.shape,h=i.stride,p=0|h[0],o=0|c[0],b=0|h[1],l=0|c[1],T=b,_=b;o<=32?d(0,o-1,u,f,p,b,o,l,T,_,1):s(0,o-1,u,f,p,b,o,l,T,_,1)}}};m.exports=function(d,s){var h,p,o,b,l,i=[s,d].join(","),u=r[i],f=(h=d,o=n(p=s),b=[p,h].join(","),l=t[b],o?l(o[0],o[1]):l()),c=function(h,p,o){var b=n(p),l=[p,h].join(","),T=a[l];return h.length>1&&b?T(o,b[0],b[1]):T(o)}(d,s,f);return u(f,c)}},{"typedarray-pool":308}],258:[function(v,m,x){"use strict";var e=v("./lib/compile_sort.js"),n={};m.exports=function(t){var a=t.order,r=t.dtype,d=[a,r].join(":"),s=n[d];return s||(n[d]=s=e(a,r)),s(t),t}},{"./lib/compile_sort.js":257}],259:[function(v,m,x){var e=v("is-buffer"),n=typeof Float64Array<"u";function t(i,u){return i[0]-u[0]}function a(){var i,u=this.stride,f=new Array(u.length);for(i=0;i<f.length;++i)f[i]=[Math.abs(u[i]),i];f.sort(t);var c=new Array(f.length);for(i=0;i<c.length;++i)c[i]=f[i][1];return c}var r={T:function(i){function u(c){this.data=c}var f=u.prototype;return f.dtype=i,f.index=function(){return-1},f.size=0,f.dimension=-1,f.shape=f.stride=f.order=[],f.lo=f.hi=f.transpose=f.step=function(){return new u(this.data)},f.get=f.set=function(){},f.pick=function(){return null},function(c){return new u(c)}},0:function(i,u){function f(h,p){this.data=h,this.offset=p}var c=f.prototype;return c.dtype=i,c.index=function(){return this.offset},c.dimension=0,c.size=1,c.shape=c.stride=c.order=[],c.lo=c.hi=c.transpose=c.step=function(){return new f(this.data,this.offset)},c.pick=function(){return u(this.data)},c.valueOf=c.get=function(){return"generic"===i?this.data.get(this.offset):this.data[this.offset]},c.set=function(h){return"generic"===i?this.data.set(this.offset,h):this.data[this.offset]=h},function(h,p,o,b){return new f(h,b)}},1:function(i,u,f){function c(p,o,b,l){this.data=p,this.shape=[o],this.stride=[b],this.offset=0|l}var h=c.prototype;return h.dtype=i,h.dimension=1,Object.defineProperty(h,"size",{get:function(){return this.shape[0]}}),h.order=[0],h.set=function(p,o){return"generic"===i?this.data.set(this.offset+this.stride[0]*p,o):this.data[this.offset+this.stride[0]*p]=o},h.get=function(p){return"generic"===i?this.data.get(this.offset+this.stride[0]*p):this.data[this.offset+this.stride[0]*p]},h.index=function(p){return this.offset+this.stride[0]*p},h.hi=function(p){return new c(this.data,"number"!=typeof p||p<0?this.shape[0]:0|p,this.stride[0],this.offset)},h.lo=function(p){var o=this.offset,b=0,l=this.shape[0],T=this.stride[0];return"number"==typeof p&&p>=0&&(o+=T*(b=0|p),l-=b),new c(this.data,l,T,o)},h.step=function(p){var o=this.shape[0],b=this.stride[0],l=this.offset,T=0,_=Math.ceil;return"number"==typeof p&&((T=0|p)<0?(l+=b*(o-1),o=_(-o/T)):o=_(o/T),b*=T),new c(this.data,o,b,l)},h.transpose=function(p){return new c(this.data,this.shape[p=void 0===p?0:0|p],this.stride[p],this.offset)},h.pick=function(p){var o=[],b=[],l=this.offset;return"number"==typeof p&&p>=0?l=l+this.stride[0]*p|0:(o.push(this.shape[0]),b.push(this.stride[0])),(0,u[o.length+1])(this.data,o,b,l)},function(p,o,b,l){return new c(p,o[0],b[0],l)}},2:function(i,u,f){function c(p,o,b,l,T,_){this.data=p,this.shape=[o,b],this.stride=[l,T],this.offset=0|_}var h=c.prototype;return h.dtype=i,h.dimension=2,Object.defineProperty(h,"size",{get:function(){return this.shape[0]*this.shape[1]}}),Object.defineProperty(h,"order",{get:function(){return Math.abs(this.stride[0])>Math.abs(this.stride[1])?[1,0]:[0,1]}}),h.set=function(p,o,b){return"generic"===i?this.data.set(this.offset+this.stride[0]*p+this.stride[1]*o,b):this.data[this.offset+this.stride[0]*p+this.stride[1]*o]=b},h.get=function(p,o){return"generic"===i?this.data.get(this.offset+this.stride[0]*p+this.stride[1]*o):this.data[this.offset+this.stride[0]*p+this.stride[1]*o]},h.index=function(p,o){return this.offset+this.stride[0]*p+this.stride[1]*o},h.hi=function(p,o){return new c(this.data,"number"!=typeof p||p<0?this.shape[0]:0|p,"number"!=typeof o||o<0?this.shape[1]:0|o,this.stride[0],this.stride[1],this.offset)},h.lo=function(p,o){var b=this.offset,l=0,T=this.shape[0],_=this.shape[1],w=this.stride[0],k=this.stride[1];return"number"==typeof p&&p>=0&&(b+=w*(l=0|p),T-=l),"number"==typeof o&&o>=0&&(b+=k*(l=0|o),_-=l),new c(this.data,T,_,w,k,b)},h.step=function(p,o){var b=this.shape[0],l=this.shape[1],T=this.stride[0],_=this.stride[1],w=this.offset,k=0,L=Math.ceil;return"number"==typeof p&&((k=0|p)<0?(w+=T*(b-1),b=L(-b/k)):b=L(b/k),T*=k),"number"==typeof o&&((k=0|o)<0?(w+=_*(l-1),l=L(-l/k)):l=L(l/k),_*=k),new c(this.data,b,l,T,_,w)},h.transpose=function(p,o){var b=this.shape,l=this.stride;return new c(this.data,b[p=void 0===p?0:0|p],b[o=void 0===o?1:0|o],l[p],l[o],this.offset)},h.pick=function(p,o){var b=[],l=[],T=this.offset;return"number"==typeof p&&p>=0?T=T+this.stride[0]*p|0:(b.push(this.shape[0]),l.push(this.stride[0])),"number"==typeof o&&o>=0?T=T+this.stride[1]*o|0:(b.push(this.shape[1]),l.push(this.stride[1])),(0,u[b.length+1])(this.data,b,l,T)},function(p,o,b,l){return new c(p,o[0],o[1],b[0],b[1],l)}},3:function(i,u,f){function c(p,o,b,l,T,_,w,k){this.data=p,this.shape=[o,b,l],this.stride=[T,_,w],this.offset=0|k}var h=c.prototype;return h.dtype=i,h.dimension=3,Object.defineProperty(h,"size",{get:function(){return this.shape[0]*this.shape[1]*this.shape[2]}}),Object.defineProperty(h,"order",{get:function(){var p=Math.abs(this.stride[0]),o=Math.abs(this.stride[1]),b=Math.abs(this.stride[2]);return p>o?o>b?[2,1,0]:p>b?[1,2,0]:[1,0,2]:p>b?[2,0,1]:b>o?[0,1,2]:[0,2,1]}}),h.set=function(p,o,b,l){return"generic"===i?this.data.set(this.offset+this.stride[0]*p+this.stride[1]*o+this.stride[2]*b,l):this.data[this.offset+this.stride[0]*p+this.stride[1]*o+this.stride[2]*b]=l},h.get=function(p,o,b){return"generic"===i?this.data.get(this.offset+this.stride[0]*p+this.stride[1]*o+this.stride[2]*b):this.data[this.offset+this.stride[0]*p+this.stride[1]*o+this.stride[2]*b]},h.index=function(p,o,b){return this.offset+this.stride[0]*p+this.stride[1]*o+this.stride[2]*b},h.hi=function(p,o,b){return new c(this.data,"number"!=typeof p||p<0?this.shape[0]:0|p,"number"!=typeof o||o<0?this.shape[1]:0|o,"number"!=typeof b||b<0?this.shape[2]:0|b,this.stride[0],this.stride[1],this.stride[2],this.offset)},h.lo=function(p,o,b){var l=this.offset,T=0,_=this.shape[0],w=this.shape[1],k=this.shape[2],L=this.stride[0],M=this.stride[1],I=this.stride[2];return"number"==typeof p&&p>=0&&(l+=L*(T=0|p),_-=T),"number"==typeof o&&o>=0&&(l+=M*(T=0|o),w-=T),"number"==typeof b&&b>=0&&(l+=I*(T=0|b),k-=T),new c(this.data,_,w,k,L,M,I,l)},h.step=function(p,o,b){var l=this.shape[0],T=this.shape[1],_=this.shape[2],w=this.stride[0],k=this.stride[1],L=this.stride[2],M=this.offset,I=0,P=Math.ceil;return"number"==typeof p&&((I=0|p)<0?(M+=w*(l-1),l=P(-l/I)):l=P(l/I),w*=I),"number"==typeof o&&((I=0|o)<0?(M+=k*(T-1),T=P(-T/I)):T=P(T/I),k*=I),"number"==typeof b&&((I=0|b)<0?(M+=L*(_-1),_=P(-_/I)):_=P(_/I),L*=I),new c(this.data,l,T,_,w,k,L,M)},h.transpose=function(p,o,b){var l=this.shape,T=this.stride;return new c(this.data,l[p=void 0===p?0:0|p],l[o=void 0===o?1:0|o],l[b=void 0===b?2:0|b],T[p],T[o],T[b],this.offset)},h.pick=function(p,o,b){var l=[],T=[],_=this.offset;return"number"==typeof p&&p>=0?_=_+this.stride[0]*p|0:(l.push(this.shape[0]),T.push(this.stride[0])),"number"==typeof o&&o>=0?_=_+this.stride[1]*o|0:(l.push(this.shape[1]),T.push(this.stride[1])),"number"==typeof b&&b>=0?_=_+this.stride[2]*b|0:(l.push(this.shape[2]),T.push(this.stride[2])),(0,u[l.length+1])(this.data,l,T,_)},function(p,o,b,l){return new c(p,o[0],o[1],o[2],b[0],b[1],b[2],l)}},4:function(i,u,f){function c(p,o,b,l,T,_,w,k,L,M){this.data=p,this.shape=[o,b,l,T],this.stride=[_,w,k,L],this.offset=0|M}var h=c.prototype;return h.dtype=i,h.dimension=4,Object.defineProperty(h,"size",{get:function(){return this.shape[0]*this.shape[1]*this.shape[2]*this.shape[3]}}),Object.defineProperty(h,"order",{get:f}),h.set=function(p,o,b,l,T){return"generic"===i?this.data.set(this.offset+this.stride[0]*p+this.stride[1]*o+this.stride[2]*b+this.stride[3]*l,T):this.data[this.offset+this.stride[0]*p+this.stride[1]*o+this.stride[2]*b+this.stride[3]*l]=T},h.get=function(p,o,b,l){return"generic"===i?this.data.get(this.offset+this.stride[0]*p+this.stride[1]*o+this.stride[2]*b+this.stride[3]*l):this.data[this.offset+this.stride[0]*p+this.stride[1]*o+this.stride[2]*b+this.stride[3]*l]},h.index=function(p,o,b,l){return this.offset+this.stride[0]*p+this.stride[1]*o+this.stride[2]*b+this.stride[3]*l},h.hi=function(p,o,b,l){return new c(this.data,"number"!=typeof p||p<0?this.shape[0]:0|p,"number"!=typeof o||o<0?this.shape[1]:0|o,"number"!=typeof b||b<0?this.shape[2]:0|b,"number"!=typeof l||l<0?this.shape[3]:0|l,this.stride[0],this.stride[1],this.stride[2],this.stride[3],this.offset)},h.lo=function(p,o,b,l){var T=this.offset,_=0,w=this.shape[0],k=this.shape[1],L=this.shape[2],M=this.shape[3],I=this.stride[0],P=this.stride[1],S=this.stride[2],E=this.stride[3];return"number"==typeof p&&p>=0&&(T+=I*(_=0|p),w-=_),"number"==typeof o&&o>=0&&(T+=P*(_=0|o),k-=_),"number"==typeof b&&b>=0&&(T+=S*(_=0|b),L-=_),"number"==typeof l&&l>=0&&(T+=E*(_=0|l),M-=_),new c(this.data,w,k,L,M,I,P,S,E,T)},h.step=function(p,o,b,l){var T=this.shape[0],_=this.shape[1],w=this.shape[2],k=this.shape[3],L=this.stride[0],M=this.stride[1],I=this.stride[2],P=this.stride[3],S=this.offset,E=0,z=Math.ceil;return"number"==typeof p&&((E=0|p)<0?(S+=L*(T-1),T=z(-T/E)):T=z(T/E),L*=E),"number"==typeof o&&((E=0|o)<0?(S+=M*(_-1),_=z(-_/E)):_=z(_/E),M*=E),"number"==typeof b&&((E=0|b)<0?(S+=I*(w-1),w=z(-w/E)):w=z(w/E),I*=E),"number"==typeof l&&((E=0|l)<0?(S+=P*(k-1),k=z(-k/E)):k=z(k/E),P*=E),new c(this.data,T,_,w,k,L,M,I,P,S)},h.transpose=function(p,o,b,l){var T=this.shape,_=this.stride;return new c(this.data,T[p=void 0===p?0:0|p],T[o=void 0===o?1:0|o],T[b=void 0===b?2:0|b],T[l=void 0===l?3:0|l],_[p],_[o],_[b],_[l],this.offset)},h.pick=function(p,o,b,l){var T=[],_=[],w=this.offset;return"number"==typeof p&&p>=0?w=w+this.stride[0]*p|0:(T.push(this.shape[0]),_.push(this.stride[0])),"number"==typeof o&&o>=0?w=w+this.stride[1]*o|0:(T.push(this.shape[1]),_.push(this.stride[1])),"number"==typeof b&&b>=0?w=w+this.stride[2]*b|0:(T.push(this.shape[2]),_.push(this.stride[2])),"number"==typeof l&&l>=0?w=w+this.stride[3]*l|0:(T.push(this.shape[3]),_.push(this.stride[3])),(0,u[T.length+1])(this.data,T,_,w)},function(p,o,b,l){return new c(p,o[0],o[1],o[2],o[3],b[0],b[1],b[2],b[3],l)}},5:function(i,u,f){function c(p,o,b,l,T,_,w,k,L,M,I,P){this.data=p,this.shape=[o,b,l,T,_],this.stride=[w,k,L,M,I],this.offset=0|P}var h=c.prototype;return h.dtype=i,h.dimension=5,Object.defineProperty(h,"size",{get:function(){return this.shape[0]*this.shape[1]*this.shape[2]*this.shape[3]*this.shape[4]}}),Object.defineProperty(h,"order",{get:f}),h.set=function(p,o,b,l,T,_){return"generic"===i?this.data.set(this.offset+this.stride[0]*p+this.stride[1]*o+this.stride[2]*b+this.stride[3]*l+this.stride[4]*T,_):this.data[this.offset+this.stride[0]*p+this.stride[1]*o+this.stride[2]*b+this.stride[3]*l+this.stride[4]*T]=_},h.get=function(p,o,b,l,T){return"generic"===i?this.data.get(this.offset+this.stride[0]*p+this.stride[1]*o+this.stride[2]*b+this.stride[3]*l+this.stride[4]*T):this.data[this.offset+this.stride[0]*p+this.stride[1]*o+this.stride[2]*b+this.stride[3]*l+this.stride[4]*T]},h.index=function(p,o,b,l,T){return this.offset+this.stride[0]*p+this.stride[1]*o+this.stride[2]*b+this.stride[3]*l+this.stride[4]*T},h.hi=function(p,o,b,l,T){return new c(this.data,"number"!=typeof p||p<0?this.shape[0]:0|p,"number"!=typeof o||o<0?this.shape[1]:0|o,"number"!=typeof b||b<0?this.shape[2]:0|b,"number"!=typeof l||l<0?this.shape[3]:0|l,"number"!=typeof T||T<0?this.shape[4]:0|T,this.stride[0],this.stride[1],this.stride[2],this.stride[3],this.stride[4],this.offset)},h.lo=function(p,o,b,l,T){var _=this.offset,w=0,k=this.shape[0],L=this.shape[1],M=this.shape[2],I=this.shape[3],P=this.shape[4],S=this.stride[0],E=this.stride[1],z=this.stride[2],R=this.stride[3],q=this.stride[4];return"number"==typeof p&&p>=0&&(_+=S*(w=0|p),k-=w),"number"==typeof o&&o>=0&&(_+=E*(w=0|o),L-=w),"number"==typeof b&&b>=0&&(_+=z*(w=0|b),M-=w),"number"==typeof l&&l>=0&&(_+=R*(w=0|l),I-=w),"number"==typeof T&&T>=0&&(_+=q*(w=0|T),P-=w),new c(this.data,k,L,M,I,P,S,E,z,R,q,_)},h.step=function(p,o,b,l,T){var _=this.shape[0],w=this.shape[1],k=this.shape[2],L=this.shape[3],M=this.shape[4],I=this.stride[0],P=this.stride[1],S=this.stride[2],E=this.stride[3],z=this.stride[4],R=this.offset,q=0,V=Math.ceil;return"number"==typeof p&&((q=0|p)<0?(R+=I*(_-1),_=V(-_/q)):_=V(_/q),I*=q),"number"==typeof o&&((q=0|o)<0?(R+=P*(w-1),w=V(-w/q)):w=V(w/q),P*=q),"number"==typeof b&&((q=0|b)<0?(R+=S*(k-1),k=V(-k/q)):k=V(k/q),S*=q),"number"==typeof l&&((q=0|l)<0?(R+=E*(L-1),L=V(-L/q)):L=V(L/q),E*=q),"number"==typeof T&&((q=0|T)<0?(R+=z*(M-1),M=V(-M/q)):M=V(M/q),z*=q),new c(this.data,_,w,k,L,M,I,P,S,E,z,R)},h.transpose=function(p,o,b,l,T){var _=this.shape,w=this.stride;return new c(this.data,_[p=void 0===p?0:0|p],_[o=void 0===o?1:0|o],_[b=void 0===b?2:0|b],_[l=void 0===l?3:0|l],_[T=void 0===T?4:0|T],w[p],w[o],w[b],w[l],w[T],this.offset)},h.pick=function(p,o,b,l,T){var _=[],w=[],k=this.offset;return"number"==typeof p&&p>=0?k=k+this.stride[0]*p|0:(_.push(this.shape[0]),w.push(this.stride[0])),"number"==typeof o&&o>=0?k=k+this.stride[1]*o|0:(_.push(this.shape[1]),w.push(this.stride[1])),"number"==typeof b&&b>=0?k=k+this.stride[2]*b|0:(_.push(this.shape[2]),w.push(this.stride[2])),"number"==typeof l&&l>=0?k=k+this.stride[3]*l|0:(_.push(this.shape[3]),w.push(this.stride[3])),"number"==typeof T&&T>=0?k=k+this.stride[4]*T|0:(_.push(this.shape[4]),w.push(this.stride[4])),(0,u[_.length+1])(this.data,_,w,k)},function(p,o,b,l){return new c(p,o[0],o[1],o[2],o[3],o[4],b[0],b[1],b[2],b[3],b[4],l)}}};function d(i,u){var f=-1===u?"T":String(u),c=r[f];return-1===u?c(i):0===u?c(i,s[i][0]):c(i,s[i],a)}var s={generic:[],buffer:[],array:[],float32:[],float64:[],int8:[],int16:[],int32:[],uint8_clamped:[],uint8:[],uint16:[],uint32:[],bigint64:[],biguint64:[]};m.exports=function(i,u,f,c){if(void 0===i)return(0,s.array[0])([]);"number"==typeof i&&(i=[i]),void 0===u&&(u=[i.length]);var h=u.length;if(void 0===f){f=new Array(h);for(var p=h-1,o=1;p>=0;--p)f[p]=o,o*=u[p]}if(void 0===c)for(c=0,p=0;p<h;++p)f[p]<0&&(c-=(u[p]-1)*f[p]);for(var b=function(T){if(e(T))return"buffer";if(n)switch(Object.prototype.toString.call(T)){case"[object Float64Array]":return"float64";case"[object Float32Array]":return"float32";case"[object Int8Array]":return"int8";case"[object Int16Array]":return"int16";case"[object Int32Array]":return"int32";case"[object Uint8ClampedArray]":return"uint8_clamped";case"[object Uint8Array]":return"uint8";case"[object Uint16Array]":return"uint16";case"[object Uint32Array]":return"uint32";case"[object BigInt64Array]":return"bigint64";case"[object BigUint64Array]":return"biguint64"}return Array.isArray(T)?"array":"generic"}(i),l=s[b];l.length<=h+1;)l.push(d(b,l.length-1));return(0,l[h+1])(i,u,f,c)}},{"is-buffer":237}],260:[function(v,m,x){"use strict";var e=v("double-bits"),n=Math.pow(2,-1074);m.exports=function(t,a){if(isNaN(t)||isNaN(a))return NaN;if(t===a)return t;if(0===t)return a<0?-n:n;var r=e.hi(t),d=e.lo(t);return a>t==t>0?d===-1>>>0?(r+=1,d=0):d+=1:0===d?(d=-1>>>0,r-=1):d-=1,e.pack(d,r)}},{"double-bits":64}],261:[function(v,m,x){x.vertexNormals=function(e,n,t){for(var a=n.length,r=new Array(a),d=void 0===t?1e-6:t,s=0;s<a;++s)r[s]=[0,0,0];for(s=0;s<e.length;++s)for(var i=e[s],f=i[i.length-1],c=i[0],h=0;h<i.length;++h){for(var p=n[f],o=n[f=c],b=n[c=i[(h+1)%i.length]],l=new Array(3),T=0,_=new Array(3),w=0,k=0;k<3;++k)l[k]=p[k]-o[k],T+=l[k]*l[k],_[k]=b[k]-o[k],w+=_[k]*_[k];if(T*w>d){var L=r[f],M=1/Math.sqrt(T*w);for(k=0;k<3;++k){var I=(k+1)%3,P=(k+2)%3;L[k]+=M*(_[I]*l[P]-_[P]*l[I])}}}for(s=0;s<a;++s){L=r[s];var S=0;for(k=0;k<3;++k)S+=L[k]*L[k];if(S>d)for(M=1/Math.sqrt(S),k=0;k<3;++k)L[k]*=M;else for(k=0;k<3;++k)L[k]=0}return r},x.faceNormals=function(e,n,t){for(var a=e.length,r=new Array(a),d=void 0===t?1e-6:t,s=0;s<a;++s){for(var i=e[s],u=new Array(3),f=0;f<3;++f)u[f]=n[i[f]];var c=new Array(3),h=new Array(3);for(f=0;f<3;++f)c[f]=u[1][f]-u[0][f],h[f]=u[2][f]-u[0][f];var p=new Array(3),o=0;for(f=0;f<3;++f){var b=(f+1)%3,l=(f+2)%3;p[f]=c[b]*h[l]-c[l]*h[b],o+=p[f]*p[f]}for(o=o>d?1/Math.sqrt(o):0,f=0;f<3;++f)p[f]*=o;r[s]=p}return r}},{}],262:[function(v,m,x){"use strict";m.exports=function(e,n,t,a,r,d,s,i,u,f){var c=n+d+f;if(h>0){var h=Math.sqrt(c+1);e[0]=.5*(s-u)/h,e[1]=.5*(i-a)/h,e[2]=.5*(t-d)/h,e[3]=.5*h}else{var p=Math.max(n,d,f);h=Math.sqrt(2*p-c+1),n>=p?(e[0]=.5*h,e[1]=.5*(r+t)/h,e[2]=.5*(i+a)/h,e[3]=.5*(s-u)/h):d>=p?(e[0]=.5*(t+r)/h,e[1]=.5*h,e[2]=.5*(u+s)/h,e[3]=.5*(i-a)/h):(e[0]=.5*(a+i)/h,e[1]=.5*(s+u)/h,e[2]=.5*h,e[3]=.5*(t-r)/h)}return e}},{}],263:[function(v,m,x){"use strict";m.exports=function(c){var h=(c=c||{}).center||[0,0,0],p=c.rotation||[0,0,0,1],o=c.radius||1;h=[].slice.call(h,0,3),i(p=[].slice.call(p,0,4),p);var b=new u(p,h,Math.log(o));return b.setDistanceLimits(c.zoomMin,c.zoomMax),("eye"in c||"up"in c)&&b.lookAt(0,c.eye,c.center,c.up),b};var e=v("filtered-vector"),n=v("gl-mat4/lookAt"),t=v("gl-mat4/fromQuat"),a=v("gl-mat4/invert"),r=v("./lib/quatFromFrame");function d(c,h,p){return Math.sqrt(Math.pow(c,2)+Math.pow(h,2)+Math.pow(p,2))}function s(c,h,p,o){return Math.sqrt(Math.pow(c,2)+Math.pow(h,2)+Math.pow(p,2)+Math.pow(o,2))}function i(c,h){var p=h[0],o=h[1],b=h[2],l=h[3],T=s(p,o,b,l);T>1e-6?(c[0]=p/T,c[1]=o/T,c[2]=b/T,c[3]=l/T):(c[0]=c[1]=c[2]=0,c[3]=1)}function u(c,h,p){this.radius=e([p]),this.center=e(h),this.rotation=e(c),this.computedRadius=this.radius.curve(0),this.computedCenter=this.center.curve(0),this.computedRotation=this.rotation.curve(0),this.computedUp=[.1,0,0],this.computedEye=[.1,0,0],this.computedMatrix=[.1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],this.recalcMatrix(0)}var f=u.prototype;f.lastT=function(){return Math.max(this.radius.lastT(),this.center.lastT(),this.rotation.lastT())},f.recalcMatrix=function(c){this.radius.curve(c),this.center.curve(c),this.rotation.curve(c);var h=this.computedRotation;i(h,h);var p=this.computedMatrix;t(p,h);var o=this.computedCenter,b=this.computedEye,l=this.computedUp,T=Math.exp(this.computedRadius[0]);b[0]=o[0]+T*p[2],b[1]=o[1]+T*p[6],b[2]=o[2]+T*p[10],l[0]=p[1],l[1]=p[5],l[2]=p[9];for(var _=0;_<3;++_){for(var w=0,k=0;k<3;++k)w+=p[_+4*k]*b[k];p[12+_]=-w}},f.getMatrix=function(c,h){this.recalcMatrix(c);var p=this.computedMatrix;if(h){for(var o=0;o<16;++o)h[o]=p[o];return h}return p},f.idle=function(c){this.center.idle(c),this.radius.idle(c),this.rotation.idle(c)},f.flush=function(c){this.center.flush(c),this.radius.flush(c),this.rotation.flush(c)},f.pan=function(c,h,p,o){h=h||0,p=p||0,o=o||0,this.recalcMatrix(c);var b=this.computedMatrix,l=b[1],T=b[5],_=b[9],w=d(l,T,_),k=b[0],L=b[4],M=b[8],I=k*(l/=w)+L*(T/=w)+M*(_/=w),P=d(k-=l*I,L-=T*I,M-=_*I),S=b[2],E=b[6],z=b[10],R=S*l+E*T+z*_,q=S*(k/=P)+E*(L/=P)+z*(M/=P),V=d(S-=R*l+q*k,E-=R*T+q*L,z-=R*_+q*M);S/=V,E/=V,z/=V,this.center.move(c,k*h+l*p,L*h+T*p,M*h+_*p);var Y=Math.exp(this.computedRadius[0]);Y=Math.max(1e-4,Y+o),this.radius.set(c,Math.log(Y))},f.rotate=function(c,h,p,o){this.recalcMatrix(c);var b=this.computedMatrix,M=b[2],I=b[6],P=b[10],S=(h=h||0)*b[0]+(p=p||0)*b[1],E=h*b[4]+p*b[5],z=h*b[8]+p*b[9],R=-(I*z-P*E),q=-(P*S-M*z),V=-(M*E-I*S),W=Math.sqrt(Math.max(0,1-Math.pow(R,2)-Math.pow(q,2)-Math.pow(V,2))),K=s(R,q,V,W);K>1e-6?(R/=K,q/=K,V/=K,W/=K):(R=q=V=0,W=1);var G=this.computedRotation,Y=G[0],$=G[1],B=G[2],N=G[3],U=Y*W+N*R+$*V-B*q,te=$*W+N*q+B*R-Y*V,j=B*W+N*V+Y*q-$*R,J=N*W-Y*R-$*q-B*V;if(o){R=M,q=I,V=P;var X=Math.sin(o)/d(R,q,V);R*=X,q*=X,V*=X,J=J*(W=Math.cos(h))-(U=U*W+J*R+te*V-j*q)*R-(te=te*W+J*q+j*R-U*V)*q-(j=j*W+J*V+U*q-te*R)*V}var re=s(U,te,j,J);re>1e-6?(U/=re,te/=re,j/=re,J/=re):(U=te=j=0,J=1),this.rotation.set(c,U,te,j,J)},f.lookAt=function(c,h,p,o){this.recalcMatrix(c);var b=this.computedMatrix;n(b,h=h||this.computedEye,p=p||this.computedCenter,o=o||this.computedUp);var l=this.computedRotation;r(l,b[0],b[1],b[2],b[4],b[5],b[6],b[8],b[9],b[10]),i(l,l),this.rotation.set(c,l[0],l[1],l[2],l[3]);for(var T=0,_=0;_<3;++_)T+=Math.pow(p[_]-h[_],2);this.radius.set(c,.5*Math.log(Math.max(T,1e-6))),this.center.set(c,p[0],p[1],p[2])},f.translate=function(c,h,p,o){this.center.move(c,h||0,p||0,o||0)},f.setMatrix=function(c,h){var p=this.computedRotation;r(p,h[0],h[1],h[2],h[4],h[5],h[6],h[8],h[9],h[10]),i(p,p),this.rotation.set(c,p[0],p[1],p[2],p[3]);var o=this.computedMatrix;a(o,h);var b=o[15];if(Math.abs(b)>1e-6){var l=o[12]/b,T=o[13]/b,_=o[14]/b;this.recalcMatrix(c);var w=Math.exp(this.computedRadius[0]);this.center.set(c,l-o[2]*w,T-o[6]*w,_-o[10]*w),this.radius.idle(c)}else this.center.idle(c),this.radius.idle(c)},f.setDistance=function(c,h){h>0&&this.radius.set(c,Math.log(h))},f.setDistanceLimits=function(c,h){c=c>0?Math.log(c):-1/0,h=h>0?Math.log(h):1/0,h=Math.max(h,c),this.radius.bounds[0][0]=c,this.radius.bounds[1][0]=h},f.getDistanceLimits=function(c){var h=this.radius.bounds;return c?(c[0]=Math.exp(h[0][0]),c[1]=Math.exp(h[1][0]),c):[Math.exp(h[0][0]),Math.exp(h[1][0])]},f.toJSON=function(){return this.recalcMatrix(this.lastT()),{center:this.computedCenter.slice(),rotation:this.computedRotation.slice(),distance:Math.log(this.computedRadius[0]),zoomMin:this.radius.bounds[0][0],zoomMax:this.radius.bounds[1][0]}},f.fromJSON=function(c){var h=this.lastT(),p=c.center;p&&this.center.set(h,p[0],p[1],p[2]);var o=c.rotation;o&&this.rotation.set(h,o[0],o[1],o[2],o[3]);var b=c.distance;b&&b>0&&this.radius.set(h,Math.log(b)),this.setDistanceLimits(c.zoomMin,c.zoomMax)}},{"./lib/quatFromFrame":262,"filtered-vector":68,"gl-mat4/fromQuat":95,"gl-mat4/invert":98,"gl-mat4/lookAt":99}],264:[function(v,m,x){"use strict";var e=v("repeat-string");m.exports=function(n,t,a){return e(a=void 0!==a?a+"":" ",t)+n}},{"repeat-string":277}],265:[function(v,m,x){m.exports=function(e,n){n||(n=[0,""]),e=String(e);var t=parseFloat(e,10);return n[0]=t,n[1]=e.match(/[\d.\-\+]*\s*(.*)/)[1]||"",n}},{}],266:[function(v,m,x){"use strict";m.exports=function(n,t){for(var a=0|t.length,r=n.length,d=[new Array(a),new Array(a)],s=0;s<a;++s)d[0][s]=[],d[1][s]=[];for(s=0;s<r;++s){var i=n[s];d[0][i[0]].push(i),d[1][i[1]].push(i)}var _,u=[];for(s=0;s<a;++s)d[0][s].length+d[1][s].length===0&&u.push([s]);function f(T,_){var w=d[_][T[_]];w.splice(w.indexOf(T),1)}function c(T,_,w){for(var k,L,M,I=0;I<2;++I)if(d[I][_].length>0){k=d[I][_][0],M=I;break}L=k[1^M];for(var P=0;P<2;++P)for(var S=d[P][_],E=0;E<S.length;++E){var z=S[E],R=z[1^P];e(t[T],t[_],t[L],t[R])>0&&(k=z,L=R,M=P)}return w||k&&f(k,M),L}function h(T,_){var w=d[_][T][0],k=[T];f(w,_);for(var L=w[1^_];;){for(;L!==T;)k.push(L),L=c(k[k.length-2],L,!1);if(d[0][T].length+d[1][T].length===0)break;var M=k[k.length-1],I=T,P=k[1],S=c(M,I,!0);if(e(t[M],t[I],t[P],t[S])<0)break;k.push(T),L=c(M,I)}return k}for(s=0;s<a;++s)for(var o=0;o<2;++o){for(var b=[];d[o][s].length>0;){var l=h(s,o);(_=l)[1]===_[_.length-1]?b.push.apply(b,l):(b.length>0&&u.push(b),b=l)}b.length>0&&u.push(b)}return u};var e=v("compare-angle")},{"compare-angle":54}],267:[function(v,m,x){"use strict";m.exports=function(n,t){for(var a=e(n,t.length),r=new Array(t.length),d=new Array(t.length),s=[],i=0;i<t.length;++i){var u=a[i].length;d[i]=u,r[i]=!0,u<=1&&s.push(i)}for(;s.length>0;){var f=s.pop();r[f]=!1;var c=a[f];for(i=0;i<c.length;++i){var h=c[i];0==--d[h]&&s.push(h)}}var p=new Array(t.length),o=[];for(i=0;i<t.length;++i)r[i]?(p[i]=f=o.length,o.push(t[i])):p[i]=-1;var b=[];for(i=0;i<n.length;++i){var l=n[i];r[l[0]]&&r[l[1]]&&b.push([p[l[0]],p[l[1]]])}return[b,o]};var e=v("edges-to-adjacency-list")},{"edges-to-adjacency-list":66}],268:[function(v,m,x){"use strict";m.exports=function(u,f){for(var c=s(u,f),h=(f=c[1]).length,p=e(u=c[0],f.length),o=0;o<h;++o)if(p[o].length%2==1)throw new Error("planar-graph-to-polyline: graph must be manifold");var b=n(u,f),l=(b=b.filter(function(oe){for(var de=oe.length,se=[0],ge=0;ge<de;++ge){var _e=f[oe[ge]],Te=f[oe[(ge+1)%de]],we=a(-_e[0],_e[1]),Oe=a(-_e[0],Te[1]),fe=a(Te[0],_e[1]),ve=a(Te[0],Te[1]);se=r(se,r(r(we,Oe),r(fe,ve)))}return se[se.length-1]>0})).length,T=new Array(l),_=new Array(l);for(o=0;o<l;++o){T[o]=o;var w=new Array(l),k=b[o].map(function(oe){return f[oe]}),L=t([k]),M=0;e:for(var I=0;I<l;++I)if(w[I]=0,o!==I){for(var P=(ne=b[I]).length,S=0;S<P;++S){var E=L(f[ne[S]]);if(0!==E){E<0&&(w[I]=1,M+=1);continue e}}w[I]=1,M+=1}_[o]=[M,o,w]}for(_.sort(function(oe,de){return de[0]-oe[0]}),o=0;o<l;++o){var z=(w=_[o])[1],R=w[2];for(I=0;I<l;++I)R[I]&&(T[I]=z)}var q=function(oe){for(var de=new Array(oe),se=0;se<oe;++se)de[se]=[];return de}(l);for(o=0;o<l;++o)q[o].push(T[o]),q[T[o]].push(o);var V={},W=i(h,!1);for(o=0;o<l;++o)for(P=(ne=b[o]).length,I=0;I<P;++I){var K=ne[I],G=ne[(I+1)%P],Y=Math.min(K,G)+":"+Math.max(K,G);if(Y in V){var $=V[Y];q[$].push(o),q[o].push($),W[K]=W[G]=!0}else V[Y]=o}function B(oe){for(var de=oe.length,se=0;se<de;++se)if(!W[oe[se]])return!1;return!0}var N=[],U=i(l,-1);for(o=0;o<l;++o)T[o]!==o||B(b[o])?U[o]=-1:(N.push(o),U[o]=0);for(c=[];N.length>0;){var te=N.pop(),j=q[te];d(j,function(oe,de){return oe-de});var J,X=j.length,re=U[te];if(0===re){var ne=b[te];J=[ne]}for(o=0;o<X;++o){var le=j[o];U[le]>=0||(U[le]=1^re,N.push(le),0===re&&(B(ne=b[le])||(ne.reverse(),J.push(ne))))}0===re&&c.push(J)}return c};var e=v("edges-to-adjacency-list"),n=v("planar-dual"),t=v("point-in-big-polygon"),a=v("two-product"),r=v("robust-sum"),d=v("uniq"),s=v("./lib/trim-leaves");function i(u,f){for(var c=new Array(u),h=0;h<u;++h)c[h]=f;return c}},{"./lib/trim-leaves":267,"edges-to-adjacency-list":66,"planar-dual":266,"point-in-big-polygon":269,"robust-sum":289,"two-product":306,uniq:310}],269:[function(v,m,x){m.exports=function(i){for(var u=i.length,f=[],c=[],h=0;h<u;++h)for(var p=i[h],o=p.length,b=o-1,l=0;l<o;b=l++){var T=p[b],_=p[l];T[0]===_[0]?c.push([T,_]):f.push([T,_])}if(0===f.length)return 0===c.length?s:(w=d(c),function(M){return w(M[0],M[1])?0:1});var w,M,I,k=n(f),L=(M=k.slabs,I=k.coordinates,function(P){var S=a.le(I,P[0]);if(S<0)return 1;var E=M[S];if(!E){if(!(S>0&&I[S]===P[0]))return 1;E=M[S-1]}for(var z=1;E;){var R=E.key,q=e(P,R[0],R[1]);if(R[0][0]<R[1][0])if(q<0)E=E.left;else{if(!(q>0))return 0;z=-1,E=E.right}else if(q>0)E=E.left;else{if(!(q<0))return 0;z=1,E=E.right}}return z});return 0===c.length?L:function(M,I){return function(P){return M(P[0],P[1])?0:I(P)}}(d(c),L)};var e=v("robust-orientation")[3],n=v("slab-decomposition"),t=v("interval-tree-1d"),a=v("binary-search-bounds");function r(){return!0}function d(i){for(var u={},f=0;f<i.length;++f){var c=i[f],h=c[0][0],p=c[0][1],o=c[1][1],b=[Math.min(p,o),Math.max(p,o)];h in u?u[h].push(b):u[h]=[b]}var w,l={},T=Object.keys(u);for(f=0;f<T.length;++f)l[T[f]]=t(u[T[f]]);return w=l,function(k,L){var M=w[k];return!!M&&!!M.queryPoint(L,r)}}function s(i){return 1}},{"binary-search-bounds":31,"interval-tree-1d":234,"robust-orientation":284,"slab-decomposition":299}],270:[function(v,m,x){"use strict";var e=new Float64Array(4),n=new Float64Array(4),t=new Float64Array(4);m.exports=function(a,r,d,s,i){e.length<s.length&&(e=new Float64Array(s.length),n=new Float64Array(s.length),t=new Float64Array(s.length));for(var u=0;u<s.length;++u)e[u]=a[u]-s[u],n[u]=r[u]-a[u],t[u]=d[u]-a[u];var f=0,c=0,h=0,p=0,o=0,b=0;for(u=0;u<s.length;++u){var l=n[u],T=t[u],_=e[u];f+=l*l,c+=l*T,h+=T*T,p+=_*l,o+=_*T,b+=_*_}var w,k,L,M,I,P=Math.abs(f*h-c*c),S=c*o-h*p,E=c*p-f*o;if(S+E<=P)if(S<0)E<0&&p<0?(E=0,-p>=f?(S=1,w=f+2*p+b):w=p*(S=-p/f)+b):(S=0,o>=0?(E=0,w=b):-o>=h?(E=1,w=h+2*o+b):w=o*(E=-o/h)+b);else if(E<0)E=0,p>=0?(S=0,w=b):-p>=f?(S=1,w=f+2*p+b):w=p*(S=-p/f)+b;else{var z=1/P;w=(S*=z)*(f*S+c*(E*=z)+2*p)+E*(c*S+h*E+2*o)+b}else S<0?(L=h+o)>(k=c+p)?(M=L-k)>=(I=f-2*c+h)?(S=1,E=0,w=f+2*p+b):w=(S=M/I)*(f*S+c*(E=1-S)+2*p)+E*(c*S+h*E+2*o)+b:(S=0,L<=0?(E=1,w=h+2*o+b):o>=0?(E=0,w=b):w=o*(E=-o/h)+b):E<0?(L=f+p)>(k=c+o)?(M=L-k)>=(I=f-2*c+h)?(E=1,S=0,w=h+2*o+b):w=(S=1-(E=M/I))*(f*S+c*E+2*p)+E*(c*S+h*E+2*o)+b:(E=0,L<=0?(S=1,w=f+2*p+b):p>=0?(S=0,w=b):w=p*(S=-p/f)+b):(M=h+o-c-p)<=0?(S=0,E=1,w=h+2*o+b):M>=(I=f-2*c+h)?(S=1,E=0,w=f+2*p+b):w=(S=M/I)*(f*S+c*(E=1-S)+2*p)+E*(c*S+h*E+2*o)+b;var R=1-S-E;for(u=0;u<s.length;++u)i[u]=R*a[u]+S*r[u]+E*d[u];return w<0?0:w}},{}],271:[function(v,m,x){m.exports=v("gl-quat/slerp")},{"gl-quat/slerp":124}],272:[function(v,m,x){"use strict";var e=v("big-rat/add");m.exports=function(n,t){for(var a=n.length,r=new Array(a),d=0;d<a;++d)r[d]=e(n[d],t[d]);return r}},{"big-rat/add":15}],273:[function(v,m,x){"use strict";m.exports=function(n){for(var t=new Array(n.length),a=0;a<n.length;++a)t[a]=e(n[a]);return t};var e=v("big-rat")},{"big-rat":18}],274:[function(v,m,x){"use strict";var e=v("big-rat"),n=v("big-rat/mul");m.exports=function(t,a){for(var r=e(a),d=t.length,s=new Array(d),i=0;i<d;++i)s[i]=n(t[i],r);return s}},{"big-rat":18,"big-rat/mul":27}],275:[function(v,m,x){"use strict";var e=v("big-rat/sub");m.exports=function(n,t){for(var a=n.length,r=new Array(a),d=0;d<a;++d)r[d]=e(n[d],t[d]);return r}},{"big-rat/sub":29}],276:[function(v,m,x){"use strict";var e=v("compare-cell"),n=v("compare-oriented-cell"),t=v("cell-orientation");m.exports=function(a){a.sort(n);for(var r=a.length,d=0,s=0;s<r;++s){var i=a[s],u=t(i);if(0!==u){if(d>0){var f=a[d-1];if(0===e(i,f)&&t(f)!==u){d-=1;continue}}a[d++]=i}}return a.length=d,a}},{"cell-orientation":47,"compare-cell":56,"compare-oriented-cell":57}],277:[function(v,m,x){"use strict";var e,n="";m.exports=function(t,a){if("string"!=typeof t)throw new TypeError("expected a string");if(1===a)return t;if(2===a)return t+t;var r=t.length*a;if(e!==t||void 0===e)e=t,n="";else if(n.length>=r)return n.substr(0,r);for(;r>n.length&&a>1;)1&a&&(n+=t),a>>=1,t+=t;return n=(n+=t).substr(0,r)}},{}],278:[function(v,m,x){(function(e){(function(){m.exports=e.performance&&e.performance.now?function(){return performance.now()}:Date.now||function(){return+new Date}}).call(this)}).call(this,void 0!==g?g:typeof self<"u"?self:typeof window<"u"?window:{})},{}],279:[function(v,m,x){"use strict";m.exports=function(e){for(var n=e.length,t=e[e.length-1],a=n,r=n-2;r>=0;--r){var d=t,s=e[r];(u=s-((t=d+s)-d))&&(e[--a]=t,t=u)}var i=0;for(r=a;r<n;++r){var u;(u=(s=t)-((t=(d=e[r])+s)-d))&&(e[i++]=u)}return e[i++]=t,e.length=i,e}},{}],280:[function(v,m,x){"use strict";var e=v("two-product"),n=v("robust-sum"),t=v("robust-scale"),a=v("robust-compress");function r(h,p,o,b){return function(l){return b(h(o(l[0][0],l[1][1]),o(-l[0][1],l[1][0])))}}function d(h,p,o,b){return function(l){return b(h(p(h(o(l[1][1],l[2][2]),o(-l[1][2],l[2][1])),l[0][0]),h(p(h(o(l[1][0],l[2][2]),o(-l[1][2],l[2][0])),-l[0][1]),p(h(o(l[1][0],l[2][1]),o(-l[1][1],l[2][0])),l[0][2]))))}}function s(h,p,o,b){return function(l){return b(h(h(p(h(p(h(o(l[2][2],l[3][3]),o(-l[2][3],l[3][2])),l[1][1]),h(p(h(o(l[2][1],l[3][3]),o(-l[2][3],l[3][1])),-l[1][2]),p(h(o(l[2][1],l[3][2]),o(-l[2][2],l[3][1])),l[1][3]))),l[0][0]),p(h(p(h(o(l[2][2],l[3][3]),o(-l[2][3],l[3][2])),l[1][0]),h(p(h(o(l[2][0],l[3][3]),o(-l[2][3],l[3][0])),-l[1][2]),p(h(o(l[2][0],l[3][2]),o(-l[2][2],l[3][0])),l[1][3]))),-l[0][1])),h(p(h(p(h(o(l[2][1],l[3][3]),o(-l[2][3],l[3][1])),l[1][0]),h(p(h(o(l[2][0],l[3][3]),o(-l[2][3],l[3][0])),-l[1][1]),p(h(o(l[2][0],l[3][1]),o(-l[2][1],l[3][0])),l[1][3]))),l[0][2]),p(h(p(h(o(l[2][1],l[3][2]),o(-l[2][2],l[3][1])),l[1][0]),h(p(h(o(l[2][0],l[3][2]),o(-l[2][2],l[3][0])),-l[1][1]),p(h(o(l[2][0],l[3][1]),o(-l[2][1],l[3][0])),l[1][2]))),-l[0][3]))))}}function i(h,p,o,b){return function(l){return b(h(h(p(h(h(p(h(p(h(o(l[3][3],l[4][4]),o(-l[3][4],l[4][3])),l[2][2]),h(p(h(o(l[3][2],l[4][4]),o(-l[3][4],l[4][2])),-l[2][3]),p(h(o(l[3][2],l[4][3]),o(-l[3][3],l[4][2])),l[2][4]))),l[1][1]),p(h(p(h(o(l[3][3],l[4][4]),o(-l[3][4],l[4][3])),l[2][1]),h(p(h(o(l[3][1],l[4][4]),o(-l[3][4],l[4][1])),-l[2][3]),p(h(o(l[3][1],l[4][3]),o(-l[3][3],l[4][1])),l[2][4]))),-l[1][2])),h(p(h(p(h(o(l[3][2],l[4][4]),o(-l[3][4],l[4][2])),l[2][1]),h(p(h(o(l[3][1],l[4][4]),o(-l[3][4],l[4][1])),-l[2][2]),p(h(o(l[3][1],l[4][2]),o(-l[3][2],l[4][1])),l[2][4]))),l[1][3]),p(h(p(h(o(l[3][2],l[4][3]),o(-l[3][3],l[4][2])),l[2][1]),h(p(h(o(l[3][1],l[4][3]),o(-l[3][3],l[4][1])),-l[2][2]),p(h(o(l[3][1],l[4][2]),o(-l[3][2],l[4][1])),l[2][3]))),-l[1][4]))),l[0][0]),p(h(h(p(h(p(h(o(l[3][3],l[4][4]),o(-l[3][4],l[4][3])),l[2][2]),h(p(h(o(l[3][2],l[4][4]),o(-l[3][4],l[4][2])),-l[2][3]),p(h(o(l[3][2],l[4][3]),o(-l[3][3],l[4][2])),l[2][4]))),l[1][0]),p(h(p(h(o(l[3][3],l[4][4]),o(-l[3][4],l[4][3])),l[2][0]),h(p(h(o(l[3][0],l[4][4]),o(-l[3][4],l[4][0])),-l[2][3]),p(h(o(l[3][0],l[4][3]),o(-l[3][3],l[4][0])),l[2][4]))),-l[1][2])),h(p(h(p(h(o(l[3][2],l[4][4]),o(-l[3][4],l[4][2])),l[2][0]),h(p(h(o(l[3][0],l[4][4]),o(-l[3][4],l[4][0])),-l[2][2]),p(h(o(l[3][0],l[4][2]),o(-l[3][2],l[4][0])),l[2][4]))),l[1][3]),p(h(p(h(o(l[3][2],l[4][3]),o(-l[3][3],l[4][2])),l[2][0]),h(p(h(o(l[3][0],l[4][3]),o(-l[3][3],l[4][0])),-l[2][2]),p(h(o(l[3][0],l[4][2]),o(-l[3][2],l[4][0])),l[2][3]))),-l[1][4]))),-l[0][1])),h(p(h(h(p(h(p(h(o(l[3][3],l[4][4]),o(-l[3][4],l[4][3])),l[2][1]),h(p(h(o(l[3][1],l[4][4]),o(-l[3][4],l[4][1])),-l[2][3]),p(h(o(l[3][1],l[4][3]),o(-l[3][3],l[4][1])),l[2][4]))),l[1][0]),p(h(p(h(o(l[3][3],l[4][4]),o(-l[3][4],l[4][3])),l[2][0]),h(p(h(o(l[3][0],l[4][4]),o(-l[3][4],l[4][0])),-l[2][3]),p(h(o(l[3][0],l[4][3]),o(-l[3][3],l[4][0])),l[2][4]))),-l[1][1])),h(p(h(p(h(o(l[3][1],l[4][4]),o(-l[3][4],l[4][1])),l[2][0]),h(p(h(o(l[3][0],l[4][4]),o(-l[3][4],l[4][0])),-l[2][1]),p(h(o(l[3][0],l[4][1]),o(-l[3][1],l[4][0])),l[2][4]))),l[1][3]),p(h(p(h(o(l[3][1],l[4][3]),o(-l[3][3],l[4][1])),l[2][0]),h(p(h(o(l[3][0],l[4][3]),o(-l[3][3],l[4][0])),-l[2][1]),p(h(o(l[3][0],l[4][1]),o(-l[3][1],l[4][0])),l[2][3]))),-l[1][4]))),l[0][2]),h(p(h(h(p(h(p(h(o(l[3][2],l[4][4]),o(-l[3][4],l[4][2])),l[2][1]),h(p(h(o(l[3][1],l[4][4]),o(-l[3][4],l[4][1])),-l[2][2]),p(h(o(l[3][1],l[4][2]),o(-l[3][2],l[4][1])),l[2][4]))),l[1][0]),p(h(p(h(o(l[3][2],l[4][4]),o(-l[3][4],l[4][2])),l[2][0]),h(p(h(o(l[3][0],l[4][4]),o(-l[3][4],l[4][0])),-l[2][2]),p(h(o(l[3][0],l[4][2]),o(-l[3][2],l[4][0])),l[2][4]))),-l[1][1])),h(p(h(p(h(o(l[3][1],l[4][4]),o(-l[3][4],l[4][1])),l[2][0]),h(p(h(o(l[3][0],l[4][4]),o(-l[3][4],l[4][0])),-l[2][1]),p(h(o(l[3][0],l[4][1]),o(-l[3][1],l[4][0])),l[2][4]))),l[1][2]),p(h(p(h(o(l[3][1],l[4][2]),o(-l[3][2],l[4][1])),l[2][0]),h(p(h(o(l[3][0],l[4][2]),o(-l[3][2],l[4][0])),-l[2][1]),p(h(o(l[3][0],l[4][1]),o(-l[3][1],l[4][0])),l[2][2]))),-l[1][4]))),-l[0][3]),p(h(h(p(h(p(h(o(l[3][2],l[4][3]),o(-l[3][3],l[4][2])),l[2][1]),h(p(h(o(l[3][1],l[4][3]),o(-l[3][3],l[4][1])),-l[2][2]),p(h(o(l[3][1],l[4][2]),o(-l[3][2],l[4][1])),l[2][3]))),l[1][0]),p(h(p(h(o(l[3][2],l[4][3]),o(-l[3][3],l[4][2])),l[2][0]),h(p(h(o(l[3][0],l[4][3]),o(-l[3][3],l[4][0])),-l[2][2]),p(h(o(l[3][0],l[4][2]),o(-l[3][2],l[4][0])),l[2][3]))),-l[1][1])),h(p(h(p(h(o(l[3][1],l[4][3]),o(-l[3][3],l[4][1])),l[2][0]),h(p(h(o(l[3][0],l[4][3]),o(-l[3][3],l[4][0])),-l[2][1]),p(h(o(l[3][0],l[4][1]),o(-l[3][1],l[4][0])),l[2][3]))),l[1][2]),p(h(p(h(o(l[3][1],l[4][2]),o(-l[3][2],l[4][1])),l[2][0]),h(p(h(o(l[3][0],l[4][2]),o(-l[3][2],l[4][0])),-l[2][1]),p(h(o(l[3][0],l[4][1]),o(-l[3][1],l[4][0])),l[2][2]))),-l[1][3]))),l[0][4])))))}}function u(h){return(2===h?r:3===h?d:4===h?s:5===h?i:void 0)(n,t,e,a)}var f=[function(){return[0]},function(h){return[h[0][0]]}];function c(h,p,o,b,l,T,_,w){return function(k){switch(k.length){case 0:return h(k);case 1:return p(k);case 2:return o(k);case 3:return b(k);case 4:return l(k);case 5:return T(k)}var L=_[k.length];return L||(L=_[k.length]=w(k.length)),L(k)}}!function(){for(;f.length<6;)f.push(u(f.length));m.exports=c.apply(void 0,f.concat([f,u]));for(var h=0;h<f.length;++h)m.exports[h]=f[h]}()},{"robust-compress":279,"robust-scale":286,"robust-sum":289,"two-product":306}],281:[function(v,m,x){"use strict";var e=v("two-product"),n=v("robust-sum");m.exports=function(t,a){for(var r=e(t[0],a[0]),d=1;d<t.length;++d)r=n(r,e(t[d],a[d]));return r}},{"robust-sum":289,"two-product":306}],282:[function(v,m,x){"use strict";var e=v("two-product"),n=v("robust-sum"),t=v("robust-subtract"),a=v("robust-scale");function r(p){return(3===p?d:4===p?s:5===p?i:u)(n,t,e,a)}function d(p,o,b,l){return function(T,_,w){var k=b(T[0],T[0]),L=l(k,_[0]),M=l(k,w[0]),I=b(_[0],_[0]),P=l(I,T[0]),S=l(I,w[0]),E=b(w[0],w[0]),z=l(E,T[0]),R=l(E,_[0]),q=p(o(R,S),o(P,L)),V=o(z,M),W=o(q,V);return W[W.length-1]}}function s(p,o,b,l){return function(T,_,w,k){var L=p(b(T[0],T[0]),b(T[1],T[1])),M=l(L,_[0]),I=l(L,w[0]),P=l(L,k[0]),S=p(b(_[0],_[0]),b(_[1],_[1])),E=l(S,T[0]),z=l(S,w[0]),R=l(S,k[0]),q=p(b(w[0],w[0]),b(w[1],w[1])),V=l(q,T[0]),W=l(q,_[0]),K=l(q,k[0]),G=p(b(k[0],k[0]),b(k[1],k[1])),Y=l(G,T[0]),$=l(G,_[0]),B=l(G,w[0]),N=p(p(l(o(B,K),_[1]),p(l(o($,R),-w[1]),l(o(W,z),k[1]))),p(l(o($,R),T[1]),p(l(o(Y,P),-_[1]),l(o(E,M),k[1])))),U=p(p(l(o(B,K),T[1]),p(l(o(Y,P),-w[1]),l(o(V,I),k[1]))),p(l(o(W,z),T[1]),p(l(o(V,I),-_[1]),l(o(E,M),w[1])))),te=o(N,U);return te[te.length-1]}}function i(p,o,b,l){return function(T,_,w,k,L){var M=p(b(T[0],T[0]),p(b(T[1],T[1]),b(T[2],T[2]))),I=l(M,_[0]),P=l(M,w[0]),S=l(M,k[0]),E=l(M,L[0]),z=p(b(_[0],_[0]),p(b(_[1],_[1]),b(_[2],_[2]))),R=l(z,T[0]),q=l(z,w[0]),V=l(z,k[0]),W=l(z,L[0]),K=p(b(w[0],w[0]),p(b(w[1],w[1]),b(w[2],w[2]))),G=l(K,T[0]),Y=l(K,_[0]),$=l(K,k[0]),B=l(K,L[0]),N=p(b(k[0],k[0]),p(b(k[1],k[1]),b(k[2],k[2]))),U=l(N,T[0]),te=l(N,_[0]),j=l(N,w[0]),J=l(N,L[0]),X=p(b(L[0],L[0]),p(b(L[1],L[1]),b(L[2],L[2]))),re=l(X,T[0]),ne=l(X,_[0]),le=l(X,w[0]),oe=l(X,k[0]),de=p(p(p(l(p(l(o(oe,J),w[1]),p(l(o(le,B),-k[1]),l(o(j,$),L[1]))),_[2]),p(l(p(l(o(oe,J),_[1]),p(l(o(ne,W),-k[1]),l(o(te,V),L[1]))),-w[2]),l(p(l(o(le,B),_[1]),p(l(o(ne,W),-w[1]),l(o(Y,q),L[1]))),k[2]))),p(l(p(l(o(j,$),_[1]),p(l(o(te,V),-w[1]),l(o(Y,q),k[1]))),-L[2]),p(l(p(l(o(oe,J),_[1]),p(l(o(ne,W),-k[1]),l(o(te,V),L[1]))),T[2]),l(p(l(o(oe,J),T[1]),p(l(o(re,E),-k[1]),l(o(U,S),L[1]))),-_[2])))),p(p(l(p(l(o(ne,W),T[1]),p(l(o(re,E),-_[1]),l(o(R,I),L[1]))),k[2]),p(l(p(l(o(te,V),T[1]),p(l(o(U,S),-_[1]),l(o(R,I),k[1]))),-L[2]),l(p(l(o(j,$),_[1]),p(l(o(te,V),-w[1]),l(o(Y,q),k[1]))),T[2]))),p(l(p(l(o(j,$),T[1]),p(l(o(U,S),-w[1]),l(o(G,P),k[1]))),-_[2]),p(l(p(l(o(te,V),T[1]),p(l(o(U,S),-_[1]),l(o(R,I),k[1]))),w[2]),l(p(l(o(Y,q),T[1]),p(l(o(G,P),-_[1]),l(o(R,I),w[1]))),-k[2]))))),se=p(p(p(l(p(l(o(oe,J),w[1]),p(l(o(le,B),-k[1]),l(o(j,$),L[1]))),T[2]),l(p(l(o(oe,J),T[1]),p(l(o(re,E),-k[1]),l(o(U,S),L[1]))),-w[2])),p(l(p(l(o(le,B),T[1]),p(l(o(re,E),-w[1]),l(o(G,P),L[1]))),k[2]),l(p(l(o(j,$),T[1]),p(l(o(U,S),-w[1]),l(o(G,P),k[1]))),-L[2]))),p(p(l(p(l(o(le,B),_[1]),p(l(o(ne,W),-w[1]),l(o(Y,q),L[1]))),T[2]),l(p(l(o(le,B),T[1]),p(l(o(re,E),-w[1]),l(o(G,P),L[1]))),-_[2])),p(l(p(l(o(ne,W),T[1]),p(l(o(re,E),-_[1]),l(o(R,I),L[1]))),w[2]),l(p(l(o(Y,q),T[1]),p(l(o(G,P),-_[1]),l(o(R,I),w[1]))),-L[2])))),ge=o(de,se);return ge[ge.length-1]}}function u(p,o,b,l){return function(T,_,w,k,L,M){var I=p(p(b(T[0],T[0]),b(T[1],T[1])),p(b(T[2],T[2]),b(T[3],T[3]))),P=l(I,_[0]),S=l(I,w[0]),E=l(I,k[0]),z=l(I,L[0]),R=l(I,M[0]),q=p(p(b(_[0],_[0]),b(_[1],_[1])),p(b(_[2],_[2]),b(_[3],_[3]))),V=l(q,T[0]),W=l(q,w[0]),K=l(q,k[0]),G=l(q,L[0]),Y=l(q,M[0]),$=p(p(b(w[0],w[0]),b(w[1],w[1])),p(b(w[2],w[2]),b(w[3],w[3]))),B=l($,T[0]),N=l($,_[0]),U=l($,k[0]),te=l($,L[0]),j=l($,M[0]),J=p(p(b(k[0],k[0]),b(k[1],k[1])),p(b(k[2],k[2]),b(k[3],k[3]))),X=l(J,T[0]),re=l(J,_[0]),ne=l(J,w[0]),le=l(J,L[0]),oe=l(J,M[0]),de=p(p(b(L[0],L[0]),b(L[1],L[1])),p(b(L[2],L[2]),b(L[3],L[3]))),se=l(de,T[0]),ge=l(de,_[0]),_e=l(de,w[0]),Te=l(de,k[0]),we=l(de,M[0]),Oe=p(p(b(M[0],M[0]),b(M[1],M[1])),p(b(M[2],M[2]),b(M[3],M[3]))),fe=l(Oe,T[0]),ve=l(Oe,_[0]),Ae=l(Oe,w[0]),ke=l(Oe,k[0]),Pe=l(Oe,L[0]),Ne=p(p(p(l(p(p(l(p(l(o(Pe,we),k[1]),p(l(o(ke,oe),-L[1]),l(o(Te,le),M[1]))),w[2]),l(p(l(o(Pe,we),w[1]),p(l(o(Ae,j),-L[1]),l(o(_e,te),M[1]))),-k[2])),p(l(p(l(o(ke,oe),w[1]),p(l(o(Ae,j),-k[1]),l(o(ne,U),M[1]))),L[2]),l(p(l(o(Te,le),w[1]),p(l(o(_e,te),-k[1]),l(o(ne,U),L[1]))),-M[2]))),_[3]),p(l(p(p(l(p(l(o(Pe,we),k[1]),p(l(o(ke,oe),-L[1]),l(o(Te,le),M[1]))),_[2]),l(p(l(o(Pe,we),_[1]),p(l(o(ve,Y),-L[1]),l(o(ge,G),M[1]))),-k[2])),p(l(p(l(o(ke,oe),_[1]),p(l(o(ve,Y),-k[1]),l(o(re,K),M[1]))),L[2]),l(p(l(o(Te,le),_[1]),p(l(o(ge,G),-k[1]),l(o(re,K),L[1]))),-M[2]))),-w[3]),l(p(p(l(p(l(o(Pe,we),w[1]),p(l(o(Ae,j),-L[1]),l(o(_e,te),M[1]))),_[2]),l(p(l(o(Pe,we),_[1]),p(l(o(ve,Y),-L[1]),l(o(ge,G),M[1]))),-w[2])),p(l(p(l(o(Ae,j),_[1]),p(l(o(ve,Y),-w[1]),l(o(N,W),M[1]))),L[2]),l(p(l(o(_e,te),_[1]),p(l(o(ge,G),-w[1]),l(o(N,W),L[1]))),-M[2]))),k[3]))),p(p(l(p(p(l(p(l(o(ke,oe),w[1]),p(l(o(Ae,j),-k[1]),l(o(ne,U),M[1]))),_[2]),l(p(l(o(ke,oe),_[1]),p(l(o(ve,Y),-k[1]),l(o(re,K),M[1]))),-w[2])),p(l(p(l(o(Ae,j),_[1]),p(l(o(ve,Y),-w[1]),l(o(N,W),M[1]))),k[2]),l(p(l(o(ne,U),_[1]),p(l(o(re,K),-w[1]),l(o(N,W),k[1]))),-M[2]))),-L[3]),l(p(p(l(p(l(o(Te,le),w[1]),p(l(o(_e,te),-k[1]),l(o(ne,U),L[1]))),_[2]),l(p(l(o(Te,le),_[1]),p(l(o(ge,G),-k[1]),l(o(re,K),L[1]))),-w[2])),p(l(p(l(o(_e,te),_[1]),p(l(o(ge,G),-w[1]),l(o(N,W),L[1]))),k[2]),l(p(l(o(ne,U),_[1]),p(l(o(re,K),-w[1]),l(o(N,W),k[1]))),-L[2]))),M[3])),p(l(p(p(l(p(l(o(Pe,we),k[1]),p(l(o(ke,oe),-L[1]),l(o(Te,le),M[1]))),_[2]),l(p(l(o(Pe,we),_[1]),p(l(o(ve,Y),-L[1]),l(o(ge,G),M[1]))),-k[2])),p(l(p(l(o(ke,oe),_[1]),p(l(o(ve,Y),-k[1]),l(o(re,K),M[1]))),L[2]),l(p(l(o(Te,le),_[1]),p(l(o(ge,G),-k[1]),l(o(re,K),L[1]))),-M[2]))),T[3]),l(p(p(l(p(l(o(Pe,we),k[1]),p(l(o(ke,oe),-L[1]),l(o(Te,le),M[1]))),T[2]),l(p(l(o(Pe,we),T[1]),p(l(o(fe,R),-L[1]),l(o(se,z),M[1]))),-k[2])),p(l(p(l(o(ke,oe),T[1]),p(l(o(fe,R),-k[1]),l(o(X,E),M[1]))),L[2]),l(p(l(o(Te,le),T[1]),p(l(o(se,z),-k[1]),l(o(X,E),L[1]))),-M[2]))),-_[3])))),p(p(p(l(p(p(l(p(l(o(Pe,we),_[1]),p(l(o(ve,Y),-L[1]),l(o(ge,G),M[1]))),T[2]),l(p(l(o(Pe,we),T[1]),p(l(o(fe,R),-L[1]),l(o(se,z),M[1]))),-_[2])),p(l(p(l(o(ve,Y),T[1]),p(l(o(fe,R),-_[1]),l(o(V,P),M[1]))),L[2]),l(p(l(o(ge,G),T[1]),p(l(o(se,z),-_[1]),l(o(V,P),L[1]))),-M[2]))),k[3]),l(p(p(l(p(l(o(ke,oe),_[1]),p(l(o(ve,Y),-k[1]),l(o(re,K),M[1]))),T[2]),l(p(l(o(ke,oe),T[1]),p(l(o(fe,R),-k[1]),l(o(X,E),M[1]))),-_[2])),p(l(p(l(o(ve,Y),T[1]),p(l(o(fe,R),-_[1]),l(o(V,P),M[1]))),k[2]),l(p(l(o(re,K),T[1]),p(l(o(X,E),-_[1]),l(o(V,P),k[1]))),-M[2]))),-L[3])),p(l(p(p(l(p(l(o(Te,le),_[1]),p(l(o(ge,G),-k[1]),l(o(re,K),L[1]))),T[2]),l(p(l(o(Te,le),T[1]),p(l(o(se,z),-k[1]),l(o(X,E),L[1]))),-_[2])),p(l(p(l(o(ge,G),T[1]),p(l(o(se,z),-_[1]),l(o(V,P),L[1]))),k[2]),l(p(l(o(re,K),T[1]),p(l(o(X,E),-_[1]),l(o(V,P),k[1]))),-L[2]))),M[3]),l(p(p(l(p(l(o(ke,oe),w[1]),p(l(o(Ae,j),-k[1]),l(o(ne,U),M[1]))),_[2]),l(p(l(o(ke,oe),_[1]),p(l(o(ve,Y),-k[1]),l(o(re,K),M[1]))),-w[2])),p(l(p(l(o(Ae,j),_[1]),p(l(o(ve,Y),-w[1]),l(o(N,W),M[1]))),k[2]),l(p(l(o(ne,U),_[1]),p(l(o(re,K),-w[1]),l(o(N,W),k[1]))),-M[2]))),T[3]))),p(p(l(p(p(l(p(l(o(ke,oe),w[1]),p(l(o(Ae,j),-k[1]),l(o(ne,U),M[1]))),T[2]),l(p(l(o(ke,oe),T[1]),p(l(o(fe,R),-k[1]),l(o(X,E),M[1]))),-w[2])),p(l(p(l(o(Ae,j),T[1]),p(l(o(fe,R),-w[1]),l(o(B,S),M[1]))),k[2]),l(p(l(o(ne,U),T[1]),p(l(o(X,E),-w[1]),l(o(B,S),k[1]))),-M[2]))),-_[3]),l(p(p(l(p(l(o(ke,oe),_[1]),p(l(o(ve,Y),-k[1]),l(o(re,K),M[1]))),T[2]),l(p(l(o(ke,oe),T[1]),p(l(o(fe,R),-k[1]),l(o(X,E),M[1]))),-_[2])),p(l(p(l(o(ve,Y),T[1]),p(l(o(fe,R),-_[1]),l(o(V,P),M[1]))),k[2]),l(p(l(o(re,K),T[1]),p(l(o(X,E),-_[1]),l(o(V,P),k[1]))),-M[2]))),w[3])),p(l(p(p(l(p(l(o(Ae,j),_[1]),p(l(o(ve,Y),-w[1]),l(o(N,W),M[1]))),T[2]),l(p(l(o(Ae,j),T[1]),p(l(o(fe,R),-w[1]),l(o(B,S),M[1]))),-_[2])),p(l(p(l(o(ve,Y),T[1]),p(l(o(fe,R),-_[1]),l(o(V,P),M[1]))),w[2]),l(p(l(o(N,W),T[1]),p(l(o(B,S),-_[1]),l(o(V,P),w[1]))),-M[2]))),-k[3]),l(p(p(l(p(l(o(ne,U),_[1]),p(l(o(re,K),-w[1]),l(o(N,W),k[1]))),T[2]),l(p(l(o(ne,U),T[1]),p(l(o(X,E),-w[1]),l(o(B,S),k[1]))),-_[2])),p(l(p(l(o(re,K),T[1]),p(l(o(X,E),-_[1]),l(o(V,P),k[1]))),w[2]),l(p(l(o(N,W),T[1]),p(l(o(B,S),-_[1]),l(o(V,P),w[1]))),-k[2]))),M[3]))))),De=p(p(p(l(p(p(l(p(l(o(Pe,we),k[1]),p(l(o(ke,oe),-L[1]),l(o(Te,le),M[1]))),w[2]),l(p(l(o(Pe,we),w[1]),p(l(o(Ae,j),-L[1]),l(o(_e,te),M[1]))),-k[2])),p(l(p(l(o(ke,oe),w[1]),p(l(o(Ae,j),-k[1]),l(o(ne,U),M[1]))),L[2]),l(p(l(o(Te,le),w[1]),p(l(o(_e,te),-k[1]),l(o(ne,U),L[1]))),-M[2]))),T[3]),p(l(p(p(l(p(l(o(Pe,we),k[1]),p(l(o(ke,oe),-L[1]),l(o(Te,le),M[1]))),T[2]),l(p(l(o(Pe,we),T[1]),p(l(o(fe,R),-L[1]),l(o(se,z),M[1]))),-k[2])),p(l(p(l(o(ke,oe),T[1]),p(l(o(fe,R),-k[1]),l(o(X,E),M[1]))),L[2]),l(p(l(o(Te,le),T[1]),p(l(o(se,z),-k[1]),l(o(X,E),L[1]))),-M[2]))),-w[3]),l(p(p(l(p(l(o(Pe,we),w[1]),p(l(o(Ae,j),-L[1]),l(o(_e,te),M[1]))),T[2]),l(p(l(o(Pe,we),T[1]),p(l(o(fe,R),-L[1]),l(o(se,z),M[1]))),-w[2])),p(l(p(l(o(Ae,j),T[1]),p(l(o(fe,R),-w[1]),l(o(B,S),M[1]))),L[2]),l(p(l(o(_e,te),T[1]),p(l(o(se,z),-w[1]),l(o(B,S),L[1]))),-M[2]))),k[3]))),p(p(l(p(p(l(p(l(o(ke,oe),w[1]),p(l(o(Ae,j),-k[1]),l(o(ne,U),M[1]))),T[2]),l(p(l(o(ke,oe),T[1]),p(l(o(fe,R),-k[1]),l(o(X,E),M[1]))),-w[2])),p(l(p(l(o(Ae,j),T[1]),p(l(o(fe,R),-w[1]),l(o(B,S),M[1]))),k[2]),l(p(l(o(ne,U),T[1]),p(l(o(X,E),-w[1]),l(o(B,S),k[1]))),-M[2]))),-L[3]),l(p(p(l(p(l(o(Te,le),w[1]),p(l(o(_e,te),-k[1]),l(o(ne,U),L[1]))),T[2]),l(p(l(o(Te,le),T[1]),p(l(o(se,z),-k[1]),l(o(X,E),L[1]))),-w[2])),p(l(p(l(o(_e,te),T[1]),p(l(o(se,z),-w[1]),l(o(B,S),L[1]))),k[2]),l(p(l(o(ne,U),T[1]),p(l(o(X,E),-w[1]),l(o(B,S),k[1]))),-L[2]))),M[3])),p(l(p(p(l(p(l(o(Pe,we),w[1]),p(l(o(Ae,j),-L[1]),l(o(_e,te),M[1]))),_[2]),l(p(l(o(Pe,we),_[1]),p(l(o(ve,Y),-L[1]),l(o(ge,G),M[1]))),-w[2])),p(l(p(l(o(Ae,j),_[1]),p(l(o(ve,Y),-w[1]),l(o(N,W),M[1]))),L[2]),l(p(l(o(_e,te),_[1]),p(l(o(ge,G),-w[1]),l(o(N,W),L[1]))),-M[2]))),T[3]),l(p(p(l(p(l(o(Pe,we),w[1]),p(l(o(Ae,j),-L[1]),l(o(_e,te),M[1]))),T[2]),l(p(l(o(Pe,we),T[1]),p(l(o(fe,R),-L[1]),l(o(se,z),M[1]))),-w[2])),p(l(p(l(o(Ae,j),T[1]),p(l(o(fe,R),-w[1]),l(o(B,S),M[1]))),L[2]),l(p(l(o(_e,te),T[1]),p(l(o(se,z),-w[1]),l(o(B,S),L[1]))),-M[2]))),-_[3])))),p(p(p(l(p(p(l(p(l(o(Pe,we),_[1]),p(l(o(ve,Y),-L[1]),l(o(ge,G),M[1]))),T[2]),l(p(l(o(Pe,we),T[1]),p(l(o(fe,R),-L[1]),l(o(se,z),M[1]))),-_[2])),p(l(p(l(o(ve,Y),T[1]),p(l(o(fe,R),-_[1]),l(o(V,P),M[1]))),L[2]),l(p(l(o(ge,G),T[1]),p(l(o(se,z),-_[1]),l(o(V,P),L[1]))),-M[2]))),w[3]),l(p(p(l(p(l(o(Ae,j),_[1]),p(l(o(ve,Y),-w[1]),l(o(N,W),M[1]))),T[2]),l(p(l(o(Ae,j),T[1]),p(l(o(fe,R),-w[1]),l(o(B,S),M[1]))),-_[2])),p(l(p(l(o(ve,Y),T[1]),p(l(o(fe,R),-_[1]),l(o(V,P),M[1]))),w[2]),l(p(l(o(N,W),T[1]),p(l(o(B,S),-_[1]),l(o(V,P),w[1]))),-M[2]))),-L[3])),p(l(p(p(l(p(l(o(_e,te),_[1]),p(l(o(ge,G),-w[1]),l(o(N,W),L[1]))),T[2]),l(p(l(o(_e,te),T[1]),p(l(o(se,z),-w[1]),l(o(B,S),L[1]))),-_[2])),p(l(p(l(o(ge,G),T[1]),p(l(o(se,z),-_[1]),l(o(V,P),L[1]))),w[2]),l(p(l(o(N,W),T[1]),p(l(o(B,S),-_[1]),l(o(V,P),w[1]))),-L[2]))),M[3]),l(p(p(l(p(l(o(Te,le),w[1]),p(l(o(_e,te),-k[1]),l(o(ne,U),L[1]))),_[2]),l(p(l(o(Te,le),_[1]),p(l(o(ge,G),-k[1]),l(o(re,K),L[1]))),-w[2])),p(l(p(l(o(_e,te),_[1]),p(l(o(ge,G),-w[1]),l(o(N,W),L[1]))),k[2]),l(p(l(o(ne,U),_[1]),p(l(o(re,K),-w[1]),l(o(N,W),k[1]))),-L[2]))),T[3]))),p(p(l(p(p(l(p(l(o(Te,le),w[1]),p(l(o(_e,te),-k[1]),l(o(ne,U),L[1]))),T[2]),l(p(l(o(Te,le),T[1]),p(l(o(se,z),-k[1]),l(o(X,E),L[1]))),-w[2])),p(l(p(l(o(_e,te),T[1]),p(l(o(se,z),-w[1]),l(o(B,S),L[1]))),k[2]),l(p(l(o(ne,U),T[1]),p(l(o(X,E),-w[1]),l(o(B,S),k[1]))),-L[2]))),-_[3]),l(p(p(l(p(l(o(Te,le),_[1]),p(l(o(ge,G),-k[1]),l(o(re,K),L[1]))),T[2]),l(p(l(o(Te,le),T[1]),p(l(o(se,z),-k[1]),l(o(X,E),L[1]))),-_[2])),p(l(p(l(o(ge,G),T[1]),p(l(o(se,z),-_[1]),l(o(V,P),L[1]))),k[2]),l(p(l(o(re,K),T[1]),p(l(o(X,E),-_[1]),l(o(V,P),k[1]))),-L[2]))),w[3])),p(l(p(p(l(p(l(o(_e,te),_[1]),p(l(o(ge,G),-w[1]),l(o(N,W),L[1]))),T[2]),l(p(l(o(_e,te),T[1]),p(l(o(se,z),-w[1]),l(o(B,S),L[1]))),-_[2])),p(l(p(l(o(ge,G),T[1]),p(l(o(se,z),-_[1]),l(o(V,P),L[1]))),w[2]),l(p(l(o(N,W),T[1]),p(l(o(B,S),-_[1]),l(o(V,P),w[1]))),-L[2]))),-k[3]),l(p(p(l(p(l(o(ne,U),_[1]),p(l(o(re,K),-w[1]),l(o(N,W),k[1]))),T[2]),l(p(l(o(ne,U),T[1]),p(l(o(X,E),-w[1]),l(o(B,S),k[1]))),-_[2])),p(l(p(l(o(re,K),T[1]),p(l(o(X,E),-_[1]),l(o(V,P),k[1]))),w[2]),l(p(l(o(N,W),T[1]),p(l(o(B,S),-_[1]),l(o(V,P),w[1]))),-k[2]))),L[3]))))),ze=o(Ne,De);return ze[ze.length-1]}}var f=[function(){return 0},function(){return 0},function(){return 0}];function c(p){var o=f[p.length];return o||(o=f[p.length]=r(p.length)),o.apply(void 0,p)}function h(p,o,b,l,T,_,w,k){return function(L,M,I,P,S,E){switch(arguments.length){case 0:case 1:return 0;case 2:return l(L,M);case 3:return T(L,M,I);case 4:return _(L,M,I,P);case 5:return w(L,M,I,P,S);case 6:return k(L,M,I,P,S,E)}for(var z=new Array(arguments.length),R=0;R<arguments.length;++R)z[R]=arguments[R];return p(z)}}!function(){for(;f.length<=6;)f.push(r(f.length));m.exports=h.apply(void 0,[c].concat(f));for(var p=0;p<=6;++p)m.exports[p]=f[p]}()},{"robust-scale":286,"robust-subtract":288,"robust-sum":289,"two-product":306}],283:[function(v,m,x){"use strict";var e=v("robust-determinant");function n(f){return(2===f?t:3===f?a:4===f?r:5===f?d:s)(f<6?e[f]:e)}function t(f){return function(c,h){return[f([[+h[0],+c[0][1]],[+h[1],+c[1][1]]]),f([[+c[0][0],+h[0]],[+c[1][0],+h[1]]]),f(c)]}}function a(f){return function(c,h){return[f([[+h[0],+c[0][1],+c[0][2]],[+h[1],+c[1][1],+c[1][2]],[+h[2],+c[2][1],+c[2][2]]]),f([[+c[0][0],+h[0],+c[0][2]],[+c[1][0],+h[1],+c[1][2]],[+c[2][0],+h[2],+c[2][2]]]),f([[+c[0][0],+c[0][1],+h[0]],[+c[1][0],+c[1][1],+h[1]],[+c[2][0],+c[2][1],+h[2]]]),f(c)]}}function r(f){return function(c,h){return[f([[+h[0],+c[0][1],+c[0][2],+c[0][3]],[+h[1],+c[1][1],+c[1][2],+c[1][3]],[+h[2],+c[2][1],+c[2][2],+c[2][3]],[+h[3],+c[3][1],+c[3][2],+c[3][3]]]),f([[+c[0][0],+h[0],+c[0][2],+c[0][3]],[+c[1][0],+h[1],+c[1][2],+c[1][3]],[+c[2][0],+h[2],+c[2][2],+c[2][3]],[+c[3][0],+h[3],+c[3][2],+c[3][3]]]),f([[+c[0][0],+c[0][1],+h[0],+c[0][3]],[+c[1][0],+c[1][1],+h[1],+c[1][3]],[+c[2][0],+c[2][1],+h[2],+c[2][3]],[+c[3][0],+c[3][1],+h[3],+c[3][3]]]),f([[+c[0][0],+c[0][1],+c[0][2],+h[0]],[+c[1][0],+c[1][1],+c[1][2],+h[1]],[+c[2][0],+c[2][1],+c[2][2],+h[2]],[+c[3][0],+c[3][1],+c[3][2],+h[3]]]),f(c)]}}function d(f){return function(c,h){return[f([[+h[0],+c[0][1],+c[0][2],+c[0][3],+c[0][4]],[+h[1],+c[1][1],+c[1][2],+c[1][3],+c[1][4]],[+h[2],+c[2][1],+c[2][2],+c[2][3],+c[2][4]],[+h[3],+c[3][1],+c[3][2],+c[3][3],+c[3][4]],[+h[4],+c[4][1],+c[4][2],+c[4][3],+c[4][4]]]),f([[+c[0][0],+h[0],+c[0][2],+c[0][3],+c[0][4]],[+c[1][0],+h[1],+c[1][2],+c[1][3],+c[1][4]],[+c[2][0],+h[2],+c[2][2],+c[2][3],+c[2][4]],[+c[3][0],+h[3],+c[3][2],+c[3][3],+c[3][4]],[+c[4][0],+h[4],+c[4][2],+c[4][3],+c[4][4]]]),f([[+c[0][0],+c[0][1],+h[0],+c[0][3],+c[0][4]],[+c[1][0],+c[1][1],+h[1],+c[1][3],+c[1][4]],[+c[2][0],+c[2][1],+h[2],+c[2][3],+c[2][4]],[+c[3][0],+c[3][1],+h[3],+c[3][3],+c[3][4]],[+c[4][0],+c[4][1],+h[4],+c[4][3],+c[4][4]]]),f([[+c[0][0],+c[0][1],+c[0][2],+h[0],+c[0][4]],[+c[1][0],+c[1][1],+c[1][2],+h[1],+c[1][4]],[+c[2][0],+c[2][1],+c[2][2],+h[2],+c[2][4]],[+c[3][0],+c[3][1],+c[3][2],+h[3],+c[3][4]],[+c[4][0],+c[4][1],+c[4][2],+h[4],+c[4][4]]]),f([[+c[0][0],+c[0][1],+c[0][2],+c[0][3],+h[0]],[+c[1][0],+c[1][1],+c[1][2],+c[1][3],+h[1]],[+c[2][0],+c[2][1],+c[2][2],+c[2][3],+h[2]],[+c[3][0],+c[3][1],+c[3][2],+c[3][3],+h[3]],[+c[4][0],+c[4][1],+c[4][2],+c[4][3],+h[4]]]),f(c)]}}function s(f){return function(c,h){return[f([[+h[0],+c[0][1],+c[0][2],+c[0][3],+c[0][4],+c[0][5]],[+h[1],+c[1][1],+c[1][2],+c[1][3],+c[1][4],+c[1][5]],[+h[2],+c[2][1],+c[2][2],+c[2][3],+c[2][4],+c[2][5]],[+h[3],+c[3][1],+c[3][2],+c[3][3],+c[3][4],+c[3][5]],[+h[4],+c[4][1],+c[4][2],+c[4][3],+c[4][4],+c[4][5]],[+h[5],+c[5][1],+c[5][2],+c[5][3],+c[5][4],+c[5][5]]]),f([[+c[0][0],+h[0],+c[0][2],+c[0][3],+c[0][4],+c[0][5]],[+c[1][0],+h[1],+c[1][2],+c[1][3],+c[1][4],+c[1][5]],[+c[2][0],+h[2],+c[2][2],+c[2][3],+c[2][4],+c[2][5]],[+c[3][0],+h[3],+c[3][2],+c[3][3],+c[3][4],+c[3][5]],[+c[4][0],+h[4],+c[4][2],+c[4][3],+c[4][4],+c[4][5]],[+c[5][0],+h[5],+c[5][2],+c[5][3],+c[5][4],+c[5][5]]]),f([[+c[0][0],+c[0][1],+h[0],+c[0][3],+c[0][4],+c[0][5]],[+c[1][0],+c[1][1],+h[1],+c[1][3],+c[1][4],+c[1][5]],[+c[2][0],+c[2][1],+h[2],+c[2][3],+c[2][4],+c[2][5]],[+c[3][0],+c[3][1],+h[3],+c[3][3],+c[3][4],+c[3][5]],[+c[4][0],+c[4][1],+h[4],+c[4][3],+c[4][4],+c[4][5]],[+c[5][0],+c[5][1],+h[5],+c[5][3],+c[5][4],+c[5][5]]]),f([[+c[0][0],+c[0][1],+c[0][2],+h[0],+c[0][4],+c[0][5]],[+c[1][0],+c[1][1],+c[1][2],+h[1],+c[1][4],+c[1][5]],[+c[2][0],+c[2][1],+c[2][2],+h[2],+c[2][4],+c[2][5]],[+c[3][0],+c[3][1],+c[3][2],+h[3],+c[3][4],+c[3][5]],[+c[4][0],+c[4][1],+c[4][2],+h[4],+c[4][4],+c[4][5]],[+c[5][0],+c[5][1],+c[5][2],+h[5],+c[5][4],+c[5][5]]]),f([[+c[0][0],+c[0][1],+c[0][2],+c[0][3],+h[0],+c[0][5]],[+c[1][0],+c[1][1],+c[1][2],+c[1][3],+h[1],+c[1][5]],[+c[2][0],+c[2][1],+c[2][2],+c[2][3],+h[2],+c[2][5]],[+c[3][0],+c[3][1],+c[3][2],+c[3][3],+h[3],+c[3][5]],[+c[4][0],+c[4][1],+c[4][2],+c[4][3],+h[4],+c[4][5]],[+c[5][0],+c[5][1],+c[5][2],+c[5][3],+h[5],+c[5][5]]]),f([[+c[0][0],+c[0][1],+c[0][2],+c[0][3],+c[0][4],+h[0]],[+c[1][0],+c[1][1],+c[1][2],+c[1][3],+c[1][4],+h[1]],[+c[2][0],+c[2][1],+c[2][2],+c[2][3],+c[2][4],+h[2]],[+c[3][0],+c[3][1],+c[3][2],+c[3][3],+c[3][4],+h[3]],[+c[4][0],+c[4][1],+c[4][2],+c[4][3],+c[4][4],+h[4]],[+c[5][0],+c[5][1],+c[5][2],+c[5][3],+c[5][4],+h[5]]]),f(c)]}}var i=[function(){return[[0]]},function(f,c){return[[c[0]],[f[0][0]]]}];function u(f,c,h,p,o,b,l,T){return function(_,w){switch(_.length){case 0:return f(_,w);case 1:return c(_,w);case 2:return h(_,w);case 3:return p(_,w);case 4:return o(_,w);case 5:return b(_,w)}var k=l[_.length];return k||(k=l[_.length]=T(_.length)),k(_,w)}}!function(){for(;i.length<6;)i.push(n(i.length));m.exports=u.apply(void 0,i.concat([i,n]));for(var f=0;f<6;++f)m.exports[f]=i[f]}()},{"robust-determinant":280}],284:[function(v,m,x){"use strict";var e=v("two-product"),n=v("robust-sum"),t=v("robust-scale"),a=v("robust-subtract");function r(o,b,l,T){return function(_,w,k){var L=o(o(b(w[1],k[0]),b(-k[1],w[0])),o(b(_[1],w[0]),b(-w[1],_[0]))),M=o(b(_[1],k[0]),b(-k[1],_[0])),I=T(L,M);return I[I.length-1]}}function d(o,b,l,T){return function(_,w,k,L){var M=o(o(l(o(b(k[1],L[0]),b(-L[1],k[0])),w[2]),o(l(o(b(w[1],L[0]),b(-L[1],w[0])),-k[2]),l(o(b(w[1],k[0]),b(-k[1],w[0])),L[2]))),o(l(o(b(w[1],L[0]),b(-L[1],w[0])),_[2]),o(l(o(b(_[1],L[0]),b(-L[1],_[0])),-w[2]),l(o(b(_[1],w[0]),b(-w[1],_[0])),L[2])))),I=o(o(l(o(b(k[1],L[0]),b(-L[1],k[0])),_[2]),o(l(o(b(_[1],L[0]),b(-L[1],_[0])),-k[2]),l(o(b(_[1],k[0]),b(-k[1],_[0])),L[2]))),o(l(o(b(w[1],k[0]),b(-k[1],w[0])),_[2]),o(l(o(b(_[1],k[0]),b(-k[1],_[0])),-w[2]),l(o(b(_[1],w[0]),b(-w[1],_[0])),k[2])))),P=T(M,I);return P[P.length-1]}}function s(o,b,l,T){return function(_,w,k,L,M){var I=o(o(o(l(o(l(o(b(L[1],M[0]),b(-M[1],L[0])),k[2]),o(l(o(b(k[1],M[0]),b(-M[1],k[0])),-L[2]),l(o(b(k[1],L[0]),b(-L[1],k[0])),M[2]))),w[3]),o(l(o(l(o(b(L[1],M[0]),b(-M[1],L[0])),w[2]),o(l(o(b(w[1],M[0]),b(-M[1],w[0])),-L[2]),l(o(b(w[1],L[0]),b(-L[1],w[0])),M[2]))),-k[3]),l(o(l(o(b(k[1],M[0]),b(-M[1],k[0])),w[2]),o(l(o(b(w[1],M[0]),b(-M[1],w[0])),-k[2]),l(o(b(w[1],k[0]),b(-k[1],w[0])),M[2]))),L[3]))),o(l(o(l(o(b(k[1],L[0]),b(-L[1],k[0])),w[2]),o(l(o(b(w[1],L[0]),b(-L[1],w[0])),-k[2]),l(o(b(w[1],k[0]),b(-k[1],w[0])),L[2]))),-M[3]),o(l(o(l(o(b(L[1],M[0]),b(-M[1],L[0])),w[2]),o(l(o(b(w[1],M[0]),b(-M[1],w[0])),-L[2]),l(o(b(w[1],L[0]),b(-L[1],w[0])),M[2]))),_[3]),l(o(l(o(b(L[1],M[0]),b(-M[1],L[0])),_[2]),o(l(o(b(_[1],M[0]),b(-M[1],_[0])),-L[2]),l(o(b(_[1],L[0]),b(-L[1],_[0])),M[2]))),-w[3])))),o(o(l(o(l(o(b(w[1],M[0]),b(-M[1],w[0])),_[2]),o(l(o(b(_[1],M[0]),b(-M[1],_[0])),-w[2]),l(o(b(_[1],w[0]),b(-w[1],_[0])),M[2]))),L[3]),o(l(o(l(o(b(w[1],L[0]),b(-L[1],w[0])),_[2]),o(l(o(b(_[1],L[0]),b(-L[1],_[0])),-w[2]),l(o(b(_[1],w[0]),b(-w[1],_[0])),L[2]))),-M[3]),l(o(l(o(b(k[1],L[0]),b(-L[1],k[0])),w[2]),o(l(o(b(w[1],L[0]),b(-L[1],w[0])),-k[2]),l(o(b(w[1],k[0]),b(-k[1],w[0])),L[2]))),_[3]))),o(l(o(l(o(b(k[1],L[0]),b(-L[1],k[0])),_[2]),o(l(o(b(_[1],L[0]),b(-L[1],_[0])),-k[2]),l(o(b(_[1],k[0]),b(-k[1],_[0])),L[2]))),-w[3]),o(l(o(l(o(b(w[1],L[0]),b(-L[1],w[0])),_[2]),o(l(o(b(_[1],L[0]),b(-L[1],_[0])),-w[2]),l(o(b(_[1],w[0]),b(-w[1],_[0])),L[2]))),k[3]),l(o(l(o(b(w[1],k[0]),b(-k[1],w[0])),_[2]),o(l(o(b(_[1],k[0]),b(-k[1],_[0])),-w[2]),l(o(b(_[1],w[0]),b(-w[1],_[0])),k[2]))),-L[3]))))),P=o(o(o(l(o(l(o(b(L[1],M[0]),b(-M[1],L[0])),k[2]),o(l(o(b(k[1],M[0]),b(-M[1],k[0])),-L[2]),l(o(b(k[1],L[0]),b(-L[1],k[0])),M[2]))),_[3]),l(o(l(o(b(L[1],M[0]),b(-M[1],L[0])),_[2]),o(l(o(b(_[1],M[0]),b(-M[1],_[0])),-L[2]),l(o(b(_[1],L[0]),b(-L[1],_[0])),M[2]))),-k[3])),o(l(o(l(o(b(k[1],M[0]),b(-M[1],k[0])),_[2]),o(l(o(b(_[1],M[0]),b(-M[1],_[0])),-k[2]),l(o(b(_[1],k[0]),b(-k[1],_[0])),M[2]))),L[3]),l(o(l(o(b(k[1],L[0]),b(-L[1],k[0])),_[2]),o(l(o(b(_[1],L[0]),b(-L[1],_[0])),-k[2]),l(o(b(_[1],k[0]),b(-k[1],_[0])),L[2]))),-M[3]))),o(o(l(o(l(o(b(k[1],M[0]),b(-M[1],k[0])),w[2]),o(l(o(b(w[1],M[0]),b(-M[1],w[0])),-k[2]),l(o(b(w[1],k[0]),b(-k[1],w[0])),M[2]))),_[3]),l(o(l(o(b(k[1],M[0]),b(-M[1],k[0])),_[2]),o(l(o(b(_[1],M[0]),b(-M[1],_[0])),-k[2]),l(o(b(_[1],k[0]),b(-k[1],_[0])),M[2]))),-w[3])),o(l(o(l(o(b(w[1],M[0]),b(-M[1],w[0])),_[2]),o(l(o(b(_[1],M[0]),b(-M[1],_[0])),-w[2]),l(o(b(_[1],w[0]),b(-w[1],_[0])),M[2]))),k[3]),l(o(l(o(b(w[1],k[0]),b(-k[1],w[0])),_[2]),o(l(o(b(_[1],k[0]),b(-k[1],_[0])),-w[2]),l(o(b(_[1],w[0]),b(-w[1],_[0])),k[2]))),-M[3])))),S=T(I,P);return S[S.length-1]}}function i(o){return(3===o?r:4===o?d:s)(n,e,t,a)}var u=i(3),f=i(4),c=[function(){return 0},function(){return 0},function(o,b){return b[0]-o[0]},function(o,b,l){var T,_=(o[1]-l[1])*(b[0]-l[0]),w=(o[0]-l[0])*(b[1]-l[1]),k=_-w;if(_>0){if(w<=0)return k;T=_+w}else{if(!(_<0)||w>=0)return k;T=-(_+w)}var L=33306690738754716e-32*T;return k>=L||k<=-L?k:u(o,b,l)},function(o,b,l,T){var _=o[0]-T[0],w=b[0]-T[0],k=l[0]-T[0],L=o[1]-T[1],M=b[1]-T[1],I=l[1]-T[1],P=o[2]-T[2],S=b[2]-T[2],E=l[2]-T[2],z=w*I,R=k*M,q=k*L,V=_*I,W=_*M,K=w*L,G=P*(z-R)+S*(q-V)+E*(W-K),Y=7771561172376103e-31*((Math.abs(z)+Math.abs(R))*Math.abs(P)+(Math.abs(q)+Math.abs(V))*Math.abs(S)+(Math.abs(W)+Math.abs(K))*Math.abs(E));return G>Y||-G>Y?G:f(o,b,l,T)}];function h(o){var b=c[o.length];return b||(b=c[o.length]=i(o.length)),b.apply(void 0,o)}function p(o,b,l,T,_,w,k){return function(L,M,I,P,S){switch(arguments.length){case 0:case 1:return 0;case 2:return T(L,M);case 3:return _(L,M,I);case 4:return w(L,M,I,P);case 5:return k(L,M,I,P,S)}for(var E=new Array(arguments.length),z=0;z<arguments.length;++z)E[z]=arguments[z];return o(E)}}!function(){for(;c.length<=5;)c.push(i(c.length));m.exports=p.apply(void 0,[h].concat(c));for(var o=0;o<=5;++o)m.exports[o]=c[o]}()},{"robust-scale":286,"robust-subtract":288,"robust-sum":289,"two-product":306}],285:[function(v,m,x){"use strict";var e=v("robust-sum"),n=v("robust-scale");m.exports=function(t,a){if(1===t.length)return n(a,t[0]);if(1===a.length)return n(t,a[0]);if(0===t.length||0===a.length)return[0];var r=[0];if(t.length<a.length)for(var d=0;d<t.length;++d)r=e(r,n(a,t[d]));else for(d=0;d<a.length;++d)r=e(r,n(t,a[d]));return r}},{"robust-scale":286,"robust-sum":289}],286:[function(v,m,x){"use strict";var e=v("two-product"),n=v("two-sum");m.exports=function(t,a){var r=t.length;if(1===r){var d=e(t[0],a);return d[0]?d:[d[1]]}var s=new Array(2*r),i=[.1,.1],u=[.1,.1],f=0;e(t[0],a,i),i[0]&&(s[f++]=i[0]);for(var c=1;c<r;++c){e(t[c],a,u),n(i[1],u[0],i),i[0]&&(s[f++]=i[0]);var p=u[1],o=i[1],b=p+o,l=o-(b-p);i[1]=b,l&&(s[f++]=l)}return i[1]&&(s[f++]=i[1]),0===f&&(s[f++]=0),s.length=f,s}},{"two-product":306,"two-sum":307}],287:[function(v,m,x){"use strict";m.exports=function(n,t,a,r){var d=e(n,a,r),s=e(t,a,r);if(d>0&&s>0||d<0&&s<0)return!1;var i=e(a,n,t),u=e(r,n,t);return!(i>0&&u>0||i<0&&u<0)&&(0!==d||0!==s||0!==i||0!==u||function(f,c,h,p){for(var o=0;o<2;++o){var b=f[o],l=c[o],T=Math.min(b,l),_=Math.max(b,l),w=h[o],k=p[o],L=Math.min(w,k);if(Math.max(w,k)<T||_<L)return!1}return!0}(n,t,a,r))};var e=v("robust-orientation")[3]},{"robust-orientation":284}],288:[function(v,m,x){"use strict";m.exports=function(e,n){var I,P,S,E,z,t=0|e.length,a=0|n.length;if(1===t&&1===a)return(z=(I=e[0])-((S=I+(P=-n[0]))-(E=S-I))+(P-E))?[z,S]:[S];var r,d,s=new Array(t+a),i=0,u=0,f=0,c=Math.abs,h=e[u],p=c(h),o=-n[f],b=c(o);p<b?(d=h,(u+=1)<t&&(p=c(h=e[u]))):(d=o,(f+=1)<a&&(b=c(o=-n[f]))),u<t&&p<b||f>=a?(r=h,(u+=1)<t&&(p=c(h=e[u]))):(r=o,(f+=1)<a&&(b=c(o=-n[f])));for(var l,T,_=r+d,w=_-r,k=d-w,L=k,M=_;u<t&&f<a;)p<b?(r=h,(u+=1)<t&&(p=c(h=e[u]))):(r=o,(f+=1)<a&&(b=c(o=-n[f]))),(k=(d=L)-(w=(_=r+d)-r))&&(s[i++]=k),L=M-((l=M+_)-(T=l-M))+(_-T),M=l;for(;u<t;)(k=(d=L)-(w=(_=(r=h)+d)-r))&&(s[i++]=k),L=M-((l=M+_)-(T=l-M))+(_-T),M=l,(u+=1)<t&&(h=e[u]);for(;f<a;)(k=(d=L)-(w=(_=(r=o)+d)-r))&&(s[i++]=k),L=M-((l=M+_)-(T=l-M))+(_-T),M=l,(f+=1)<a&&(o=-n[f]);return L&&(s[i++]=L),M&&(s[i++]=M),i||(s[i++]=0),s.length=i,s}},{}],289:[function(v,m,x){"use strict";m.exports=function(e,n){var I,P,S,E,z,t=0|e.length,a=0|n.length;if(1===t&&1===a)return(z=(I=e[0])-((S=I+(P=n[0]))-(E=S-I))+(P-E))?[z,S]:[S];var r,d,s=new Array(t+a),i=0,u=0,f=0,c=Math.abs,h=e[u],p=c(h),o=n[f],b=c(o);p<b?(d=h,(u+=1)<t&&(p=c(h=e[u]))):(d=o,(f+=1)<a&&(b=c(o=n[f]))),u<t&&p<b||f>=a?(r=h,(u+=1)<t&&(p=c(h=e[u]))):(r=o,(f+=1)<a&&(b=c(o=n[f])));for(var l,T,_=r+d,w=_-r,k=d-w,L=k,M=_;u<t&&f<a;)p<b?(r=h,(u+=1)<t&&(p=c(h=e[u]))):(r=o,(f+=1)<a&&(b=c(o=n[f]))),(k=(d=L)-(w=(_=r+d)-r))&&(s[i++]=k),L=M-((l=M+_)-(T=l-M))+(_-T),M=l;for(;u<t;)(k=(d=L)-(w=(_=(r=h)+d)-r))&&(s[i++]=k),L=M-((l=M+_)-(T=l-M))+(_-T),M=l,(u+=1)<t&&(h=e[u]);for(;f<a;)(k=(d=L)-(w=(_=(r=o)+d)-r))&&(s[i++]=k),L=M-((l=M+_)-(T=l-M))+(_-T),M=l,(f+=1)<a&&(o=n[f]);return L&&(s[i++]=L),M&&(s[i++]=M),i||(s[i++]=0),s.length=i,s}},{}],290:[function(v,m,x){"use strict";m.exports=function(t){return n(e(t))};var e=v("boundary-cells"),n=v("reduce-simplicial-complex")},{"boundary-cells":34,"reduce-simplicial-complex":276}],291:[function(v,m,x){"use strict";m.exports=function(r,d,s,i){if(s=s||0,void 0===i&&(i=function(l){for(var T=l.length,_=0,w=0;w<T;++w)_=0|Math.max(_,l[w].length);return _-1}(r)),0===r.length||i<1)return{cells:[],vertexIds:[],vertexWeights:[]};var u=function(l,T){for(var _=l.length,w=n.mallocUint8(_),k=0;k<_;++k)w[k]=l[k]<T|0;return w}(d,+s),f=function(l,T){for(var _=l.length,k=n.mallocUint32(2*(T*(T+1)/2*_|0)),L=0,M=0;M<_;++M)for(var I=l[M],P=(T=I.length,0);P<T;++P)for(var S=0;S<P;++S){var E=I[S],z=I[P];k[L++]=0|Math.min(E,z),k[L++]=0|Math.max(E,z)}t(e(k,[L/2|0,2]));var R=2;for(M=2;M<L;M+=2)k[M-2]===k[M]&&k[M-1]===k[M+1]||(k[R++]=k[M],k[R++]=k[M+1]);return e(k,[R/2|0,2])}(r,i),c=function(l,T,_,w){for(var k=l.data,L=l.shape[0],M=n.mallocDouble(L),I=0,P=0;P<L;++P){var S=k[2*P],E=k[2*P+1];if(_[S]!==_[E]){var z=T[S],R=T[E];k[2*I]=S,k[2*I+1]=E,M[I++]=(R-w)/(R-z)}}return l.shape[0]=I,e(M,[I])}(f,d,u,+s),h=function(l,T){var _=n.mallocInt32(2*T),w=l.shape[0],k=l.data;_[0]=0;for(var L=0,M=0;M<w;++M){var I=k[2*M];if(I!==L){for(_[2*L+1]=M;++L<I;)_[2*L]=M,_[2*L+1]=M;_[2*L]=M}}for(_[2*L+1]=w;++L<T;)_[2*L]=_[2*L+1]=w;return _}(f,0|d.length),p=a(i)(r,f.data,h,u),o=function(l){for(var T=0|l.shape[0],_=l.data,w=new Array(T),k=0;k<T;++k)w[k]=[_[2*k],_[2*k+1]];return w}(f),b=[].slice.call(c.data,0,c.shape[0]);return n.free(u),n.free(f.data),n.free(c.data),n.free(h),{cells:p,vertexIds:o,vertexWeights:b}};var e=v("ndarray"),n=v("typedarray-pool"),t=v("ndarray-sort"),a=v("./lib/codegen")},{"./lib/codegen":292,ndarray:259,"ndarray-sort":258,"typedarray-pool":308}],292:[function(v,m,x){"use strict";m.exports=function(n){return e[n]()};var e=[function(){return function(n,t,a,r){for(var d=n.length,s=0;s<d;++s);return[]}},function(){function n(t,a,r,d){for(var s=0|Math.min(r,d),i=0|Math.max(r,d),u=t[2*s],f=t[2*s+1];u<f;){var c=u+f>>1,h=a[2*c+1];if(h===i)return c;i<h?f=c:u=c+1}return u}return function(t,a,r,d){for(var s=t.length,i=[],u=0;u<s;++u){var f=t[u];if(2===f.length){var c=(d[f[0]]<<0)+(d[f[1]]<<1);if(0===c||3===c)continue;switch(c){case 0:break;case 1:i.push([n(r,a,f[0],f[1])]);break;case 2:i.push([n(r,a,f[1],f[0])])}}}return i}},function(){function n(t,a,r,d){for(var s=0|Math.min(r,d),i=0|Math.max(r,d),u=t[2*s],f=t[2*s+1];u<f;){var c=u+f>>1,h=a[2*c+1];if(h===i)return c;i<h?f=c:u=c+1}return u}return function(t,a,r,d){for(var s=t.length,i=[],u=0;u<s;++u){var f=t[u],c=f.length;if(3===c){if(0==(h=(d[f[0]]<<0)+(d[f[1]]<<1)+(d[f[2]]<<2))||7===h)continue;switch(h){case 0:break;case 1:i.push([n(r,a,f[0],f[2]),n(r,a,f[0],f[1])]);break;case 2:i.push([n(r,a,f[1],f[0]),n(r,a,f[1],f[2])]);break;case 3:i.push([n(r,a,f[0],f[2]),n(r,a,f[1],f[2])]);break;case 4:i.push([n(r,a,f[2],f[1]),n(r,a,f[2],f[0])]);break;case 5:i.push([n(r,a,f[2],f[1]),n(r,a,f[0],f[1])]);break;case 6:i.push([n(r,a,f[1],f[0]),n(r,a,f[2],f[0])])}}else if(2===c){var h;if(0==(h=(d[f[0]]<<0)+(d[f[1]]<<1))||3===h)continue;switch(h){case 0:break;case 1:i.push([n(r,a,f[0],f[1])]);break;case 2:i.push([n(r,a,f[1],f[0])])}}}return i}},function(){function n(t,a,r,d){for(var s=0|Math.min(r,d),i=0|Math.max(r,d),u=t[2*s],f=t[2*s+1];u<f;){var c=u+f>>1,h=a[2*c+1];if(h===i)return c;i<h?f=c:u=c+1}return u}return function(t,a,r,d){for(var s=t.length,i=[],u=0;u<s;++u){var f=t[u],c=f.length;if(4===c){if(0==(h=(d[f[0]]<<0)+(d[f[1]]<<1)+(d[f[2]]<<2)+(d[f[3]]<<3))||15===h)continue;switch(h){case 0:break;case 1:i.push([n(r,a,f[0],f[1]),n(r,a,f[0],f[2]),n(r,a,f[0],f[3])]);break;case 2:i.push([n(r,a,f[1],f[2]),n(r,a,f[1],f[0]),n(r,a,f[1],f[3])]);break;case 3:i.push([n(r,a,f[1],f[2]),n(r,a,f[0],f[2]),n(r,a,f[0],f[3])],[n(r,a,f[1],f[3]),n(r,a,f[1],f[2]),n(r,a,f[0],f[3])]);break;case 4:i.push([n(r,a,f[2],f[0]),n(r,a,f[2],f[1]),n(r,a,f[2],f[3])]);break;case 5:i.push([n(r,a,f[0],f[1]),n(r,a,f[2],f[1]),n(r,a,f[0],f[3])],[n(r,a,f[2],f[1]),n(r,a,f[2],f[3]),n(r,a,f[0],f[3])]);break;case 6:i.push([n(r,a,f[2],f[0]),n(r,a,f[1],f[0]),n(r,a,f[1],f[3])],[n(r,a,f[2],f[3]),n(r,a,f[2],f[0]),n(r,a,f[1],f[3])]);break;case 7:i.push([n(r,a,f[0],f[3]),n(r,a,f[1],f[3]),n(r,a,f[2],f[3])]);break;case 8:i.push([n(r,a,f[3],f[1]),n(r,a,f[3],f[0]),n(r,a,f[3],f[2])]);break;case 9:i.push([n(r,a,f[3],f[1]),n(r,a,f[0],f[1]),n(r,a,f[0],f[2])],[n(r,a,f[3],f[2]),n(r,a,f[3],f[1]),n(r,a,f[0],f[2])]);break;case 10:i.push([n(r,a,f[1],f[0]),n(r,a,f[3],f[0]),n(r,a,f[1],f[2])],[n(r,a,f[3],f[0]),n(r,a,f[3],f[2]),n(r,a,f[1],f[2])]);break;case 11:i.push([n(r,a,f[1],f[2]),n(r,a,f[0],f[2]),n(r,a,f[3],f[2])]);break;case 12:i.push([n(r,a,f[3],f[0]),n(r,a,f[2],f[0]),n(r,a,f[2],f[1])],[n(r,a,f[3],f[1]),n(r,a,f[3],f[0]),n(r,a,f[2],f[1])]);break;case 13:i.push([n(r,a,f[0],f[1]),n(r,a,f[2],f[1]),n(r,a,f[3],f[1])]);break;case 14:i.push([n(r,a,f[2],f[0]),n(r,a,f[1],f[0]),n(r,a,f[3],f[0])])}}else if(3===c){if(0==(h=(d[f[0]]<<0)+(d[f[1]]<<1)+(d[f[2]]<<2))||7===h)continue;switch(h){case 0:break;case 1:i.push([n(r,a,f[0],f[2]),n(r,a,f[0],f[1])]);break;case 2:i.push([n(r,a,f[1],f[0]),n(r,a,f[1],f[2])]);break;case 3:i.push([n(r,a,f[0],f[2]),n(r,a,f[1],f[2])]);break;case 4:i.push([n(r,a,f[2],f[1]),n(r,a,f[2],f[0])]);break;case 5:i.push([n(r,a,f[2],f[1]),n(r,a,f[0],f[1])]);break;case 6:i.push([n(r,a,f[1],f[0]),n(r,a,f[2],f[0])])}}else if(2===c){var h;if(0==(h=(d[f[0]]<<0)+(d[f[1]]<<1))||3===h)continue;switch(h){case 0:break;case 1:i.push([n(r,a,f[0],f[1])]);break;case 2:i.push([n(r,a,f[1],f[0])])}}}return i}}]},{}],293:[function(v,m,x){"use strict";var e=v("bit-twiddle"),n=v("union-find");function t(f,c){var h=f.length,p=f.length-c.length,o=Math.min;if(p)return p;switch(h){case 0:return 0;case 1:return f[0]-c[0];case 2:return(T=f[0]+f[1]-c[0]-c[1])||o(f[0],f[1])-o(c[0],c[1]);case 3:var b=f[0]+f[1],l=c[0]+c[1];if(T=b+f[2]-(l+c[2]))return T;var T,_=o(f[0],f[1]),w=o(c[0],c[1]);return(T=o(_,f[2])-o(w,c[2]))||o(_+f[2],b)-o(w+c[2],l);default:var k=f.slice(0);k.sort();var L=c.slice(0);L.sort();for(var M=0;M<h;++M)if(p=k[M]-L[M])return p;return 0}}function a(f,c){return t(f[0],c[0])}function r(f,c){if(c){for(var h=f.length,p=new Array(h),o=0;o<h;++o)p[o]=[f[o],c[o]];for(p.sort(a),o=0;o<h;++o)f[o]=p[o][0],c[o]=p[o][1];return f}return f.sort(t),f}function d(f){if(0===f.length)return[];for(var c=1,h=f.length,p=1;p<h;++p){var o=f[p];if(t(o,f[p-1])){if(p===c){c++;continue}f[c++]=o}}return f.length=c,f}function s(f,c){for(var h=0,p=f.length-1,o=-1;h<=p;){var b=h+p>>1,l=t(f[b],c);l<=0?(0===l&&(o=b),h=b+1):l>0&&(p=b-1)}return o}function i(f,c){for(var h=new Array(f.length),p=0,o=h.length;p<o;++p)h[p]=[];for(var b=[],l=(p=0,c.length);p<l;++p)for(var T=c[p],_=T.length,w=1,k=1<<_;w<k;++w){b.length=e.popCount(w);for(var L=0,M=0;M<_;++M)w&1<<M&&(b[L++]=T[M]);var I=s(f,b);if(!(I<0))for(;h[I++].push(p),!(I>=f.length||0!==t(f[I],b)););}return h}function u(f,c){if(c<0)return[];for(var h=[],p=(1<<c+1)-1,o=0;o<f.length;++o)for(var b=f[o],l=p;l<1<<b.length;l=e.nextCombination(l)){for(var T=new Array(c+1),_=0,w=0;w<b.length;++w)l&1<<w&&(T[_++]=b[w]);h.push(T)}return r(h)}x.dimension=function(f){for(var c=0,h=Math.max,p=0,o=f.length;p<o;++p)c=h(c,f[p].length);return c-1},x.countVertices=function(f){for(var c=-1,h=Math.max,p=0,o=f.length;p<o;++p)for(var b=f[p],l=0,T=b.length;l<T;++l)c=h(c,b[l]);return c+1},x.cloneCells=function(f){for(var c=new Array(f.length),h=0,p=f.length;h<p;++h)c[h]=f[h].slice(0);return c},x.compareCells=t,x.normalize=r,x.unique=d,x.findCell=s,x.incidence=i,x.dual=function(f,c){if(!c)return i(d(u(f,0)),f);for(var h=new Array(c),p=0;p<c;++p)h[p]=[];p=0;for(var o=f.length;p<o;++p)for(var b=f[p],l=0,T=b.length;l<T;++l)h[b[l]].push(p);return h},x.explode=function(f){for(var c=[],h=0,p=f.length;h<p;++h)for(var o=f[h],b=0|o.length,l=1,T=1<<b;l<T;++l){for(var _=[],w=0;w<b;++w)l>>>w&1&&_.push(o[w]);c.push(_)}return r(c)},x.skeleton=u,x.boundary=function(f){for(var c=[],h=0,p=f.length;h<p;++h)for(var o=f[h],b=0,l=o.length;b<l;++b){for(var T=new Array(o.length-1),_=0,w=0;_<l;++_)_!==b&&(T[w++]=o[_]);c.push(T)}return r(c)},x.connectedComponents=function(f,c){return c?function(h,p){for(var o=new n(p),b=0;b<h.length;++b)for(var l=h[b],T=0;T<l.length;++T)for(var _=T+1;_<l.length;++_)o.link(l[T],l[_]);var w=[],k=o.ranks;for(b=0;b<k.length;++b)k[b]=-1;for(b=0;b<h.length;++b){var L=o.find(h[b][0]);k[L]<0?(k[L]=w.length,w.push([h[b].slice(0)])):w[k[L]].push(h[b].slice(0))}return w}(f,c):function(h){for(var p=d(r(u(h,0))),o=new n(p.length),b=0;b<h.length;++b)for(var l=h[b],T=0;T<l.length;++T)for(var _=s(p,[l[T]]),w=T+1;w<l.length;++w)o.link(_,s(p,[l[w]]));var k=[],L=o.ranks;for(b=0;b<L.length;++b)L[b]=-1;for(b=0;b<h.length;++b){var M=o.find(s(p,[h[b][0]]));L[M]<0?(L[M]=k.length,k.push([h[b].slice(0)])):k[L[M]].push(h[b].slice(0))}return k}(f)}},{"bit-twiddle":32,"union-find":309}],294:[function(v,m,x){arguments[4][32][0].apply(x,arguments)},{dup:32}],295:[function(v,m,x){arguments[4][293][0].apply(x,arguments)},{"bit-twiddle":294,dup:293,"union-find":296}],296:[function(v,m,x){"use strict";function e(n){this.roots=new Array(n),this.ranks=new Array(n);for(var t=0;t<n;++t)this.roots[t]=t,this.ranks[t]=0}m.exports=e,e.prototype.length=function(){return this.roots.length},e.prototype.makeSet=function(){var n=this.roots.length;return this.roots.push(n),this.ranks.push(0),n},e.prototype.find=function(n){for(var t=this.roots;t[n]!==n;){var a=t[n];t[n]=t[a],n=a}return n},e.prototype.link=function(n,t){var a=this.find(n),r=this.find(t);if(a!==r){var d=this.ranks,s=this.roots,i=d[a],u=d[r];i<u?s[a]=r:u<i?s[r]=a:(s[r]=a,++d[a])}}},{}],297:[function(v,m,x){"use strict";m.exports=function(t,a,r){for(var d=a.length,s=t.length,i=new Array(d),u=new Array(d),f=new Array(d),c=new Array(d),h=0;h<d;++h)i[h]=u[h]=-1,f[h]=1/0,c[h]=!1;for(h=0;h<s;++h){var p=t[h];if(2!==p.length)throw new Error("Input must be a graph");var o=p[1],b=p[0];u[b]=-1!==u[b]?-2:o,i[o]=-1!==i[o]?-2:b}function l(K){if(c[K])return 1/0;var Y,$,U=i[K],te=u[K];return U<0||te<0?1/0:(Y=a[U],$=a[te],Math.abs(e(a[K],Y,$))/Math.sqrt(Math.pow(Y[0]-$[0],2)+Math.pow(Y[1]-$[1],2)))}function T(K,G){var Y=S[K],$=S[G];S[K]=$,S[G]=Y,E[Y]=G,E[$]=K}function _(K){return f[S[K]]}function w(K){return 1&K?K-1>>1:(K>>1)-1}function k(K){for(var G=_(K);;){var Y=G,$=2*K+1,B=2*(K+1),N=K;if($<z){var U=_($);U<Y&&(N=$,Y=U)}if(B<z&&_(B)<Y&&(N=B),N===K)return K;T(K,N),K=N}}function L(K){for(var G=_(K);K>0;){var Y=w(K);if(!(Y>=0&&G<_(Y)))return K;T(K,Y),K=Y}}function M(){if(z>0){var K=S[0];return T(0,z-1),z-=1,k(0),K}return-1}function I(K,G){var Y=S[K];return f[Y]===G?K:(f[Y]=-1/0,L(K),M(),f[Y]=G,L((z+=1)-1))}function P(K){if(!c[K]){c[K]=!0;var G=i[K],Y=u[K];i[Y]>=0&&(i[Y]=G),u[G]>=0&&(u[G]=Y),E[G]>=0&&I(E[G],l(G)),E[Y]>=0&&I(E[Y],l(Y))}}var S=[],E=new Array(d);for(h=0;h<d;++h)(f[h]=l(h))<1/0?(E[h]=S.length,S.push(h)):E[h]=-1;var z=S.length;for(h=z>>1;h>=0;--h)k(h);for(;;){var R=M();if(R<0||f[R]>r)break;P(R)}var q=[];for(h=0;h<d;++h)c[h]||(E[h]=q.length,q.push(a[h].slice()));function V(K,G){if(K[G]<0)return G;var Y=G,$=G;do{var B=K[$];if(!c[$]||B<0||B===$||(B=K[$=B],!c[$]||B<0||B===$))break;$=B,Y=K[Y]}while(Y!==$);for(var N=G;N!==$;N=K[N])K[N]=$;return $}var W=[];return t.forEach(function(K){var G=V(i,K[0]),Y=V(u,K[1]);if(G>=0&&Y>=0&&G!==Y){var $=E[G],B=E[Y];$!==B&&W.push([$,B])}}),n.unique(n.normalize(W)),{positions:q,edges:W}};var e=v("robust-orientation"),n=v("simplicial-complex")},{"robust-orientation":284,"simplicial-complex":295}],298:[function(v,m,x){"use strict";m.exports=function(t,a){var r,d,s,i;if(a[0][0]<a[1][0])r=a[0],d=a[1];else{if(!(a[0][0]>a[1][0]))return n(a,t);r=a[1],d=a[0]}if(t[0][0]<t[1][0])s=t[0],i=t[1];else{if(!(t[0][0]>t[1][0]))return-n(t,a);s=t[1],i=t[0]}var u=e(r,d,i),f=e(r,d,s);if(u<0){if(f<=0)return u}else if(u>0){if(f>=0)return u}else if(f)return f;if(u=e(i,s,d),f=e(i,s,r),u<0){if(f<=0)return u}else if(u>0){if(f>=0)return u}else if(f)return f;return d[0]-i[0]};var e=v("robust-orientation");function n(t,a){var r,d,s,i;if(a[0][0]<a[1][0])r=a[0],d=a[1];else{if(!(a[0][0]>a[1][0])){var u=Math.min(t[0][1],t[1][1]),f=Math.max(t[0][1],t[1][1]),c=Math.min(a[0][1],a[1][1]),h=Math.max(a[0][1],a[1][1]);return f<c?f-c:u>h?u-h:f-h}r=a[1],d=a[0]}t[0][1]<t[1][1]?(s=t[0],i=t[1]):(s=t[1],i=t[0]);var p=e(d,r,s);return p||(p=e(d,r,i))||i-d}},{"robust-orientation":284}],299:[function(v,m,x){"use strict";m.exports=function(f){for(var c=f.length,h=2*c,p=new Array(h),o=0;o<c;++o){var b=f[o],l=b[0][0]<b[1][0];p[2*o]=new u(b[0][0],b,l,o),p[2*o+1]=new u(b[1][0],b,!l,o)}p.sort(function(P,S){var E=P.x-S.x;return E||(E=P.create-S.create)||Math.min(P.segment[0][1],P.segment[1][1])-Math.min(S.segment[0][1],S.segment[1][1])});var T=n(a),_=[],w=[],k=[];for(o=0;o<h;){for(var L=p[o].x,M=[];o<h;){var I=p[o];if(I.x!==L)break;o+=1,I.segment[0][0]===I.x&&I.segment[1][0]===I.x?I.create&&(I.segment[0][1]<I.segment[1][1]?(M.push(new i(I.segment[0][1],I.index,!0,!0)),M.push(new i(I.segment[1][1],I.index,!1,!1))):(M.push(new i(I.segment[1][1],I.index,!0,!1)),M.push(new i(I.segment[0][1],I.index,!1,!0)))):T=I.create?T.insert(I.segment,I.index):T.remove(I.segment)}_.push(T.root),w.push(L),k.push(M)}return new r(_,w,k)};var e=v("binary-search-bounds"),n=v("functional-red-black-tree"),t=v("robust-orientation"),a=v("./lib/order-segments");function r(f,c,h){this.slabs=f,this.coordinates=c,this.horizontal=h}function d(f,c){return f.y-c}function s(f,c){for(var h=null;f;){var p,o,b=f.key;b[0][0]<b[1][0]?(p=b[0],o=b[1]):(p=b[1],o=b[0]);var l=t(p,o,c);if(l<0)f=f.left;else if(l>0)if(c[0]!==b[1][0])h=f,f=f.right;else{if(T=s(f.right,c))return T;f=f.left}else{if(c[0]!==b[1][0])return f;var T;if(T=s(f.right,c))return T;f=f.left}}return h}function i(f,c,h,p){this.y=f,this.index=c,this.start=h,this.closed=p}function u(f,c,h,p){this.x=f,this.segment=c,this.create=h,this.index=p}r.prototype.castUp=function(f){var c=e.le(this.coordinates,f[0]);if(c<0)return-1;var h=s(this.slabs[c],f),p=-1;if(h&&(p=h.value),this.coordinates[c]===f[0]){var o=null;if(h&&(o=h.key),c>0){var b=s(this.slabs[c-1],f);b&&(o?a(b.key,o)>0&&(o=b.key,p=b.value):(p=b.value,o=b.key))}var l=this.horizontal[c];if(l.length>0){var T=e.ge(l,f[1],d);if(T<l.length){var _=l[T];if(f[1]===_.y){if(_.closed)return _.index;for(;T<l.length-1&&l[T+1].y===f[1];)if((_=l[T+=1]).closed)return _.index;if(_.y===f[1]&&!_.start){if((T+=1)>=l.length)return p;_=l[T]}}if(_.start)if(o){var w=t(o[0],o[1],[f[0],_.y]);o[0][0]>o[1][0]&&(w=-w),w>0&&(p=_.index)}else p=_.index;else _.y!==f[1]&&(p=_.index)}}}return p}},{"./lib/order-segments":298,"binary-search-bounds":31,"functional-red-black-tree":69,"robust-orientation":284}],300:[function(v,m,x){"use strict";var e=v("robust-dot-product"),n=v("robust-sum");function t(r,d){var s=n(e(r,d),[d[d.length-1]]);return s[s.length-1]}function a(r,d,s,i){var u=-d/(i-d);u<0?u=0:u>1&&(u=1);for(var f=1-u,c=r.length,h=new Array(c),p=0;p<c;++p)h[p]=u*r[p]+f*s[p];return h}m.exports=function(r,d){for(var s=[],i=[],u=t(r[r.length-1],d),f=r[r.length-1],c=r[0],h=0;h<r.length;++h,f=c){var p=t(c=r[h],d);if(u<0&&p>0||u>0&&p<0){var o=a(f,p,c,u);s.push(o),i.push(o.slice())}p<0?i.push(c.slice()):p>0?s.push(c.slice()):(s.push(c.slice()),i.push(c.slice())),u=p}return{positive:s,negative:i}},m.exports.positive=function(r,d){for(var s=[],i=t(r[r.length-1],d),u=r[r.length-1],f=r[0],c=0;c<r.length;++c,u=f){var h=t(f=r[c],d);(i<0&&h>0||i>0&&h<0)&&s.push(a(u,h,f,i)),h>=0&&s.push(f.slice()),i=h}return s},m.exports.negative=function(r,d){for(var s=[],i=t(r[r.length-1],d),u=r[r.length-1],f=r[0],c=0;c<r.length;++c,u=f){var h=t(f=r[c],d);(i<0&&h>0||i>0&&h<0)&&s.push(a(u,h,f,i)),h<=0&&s.push(f.slice()),i=h}return s}},{"robust-dot-product":281,"robust-sum":289}],301:[function(v,m,x){!function(){"use strict";var e={not_string:/[^s]/,not_bool:/[^t]/,not_type:/[^T]/,not_primitive:/[^v]/,number:/[diefg]/,numeric_arg:/[bcdiefguxX]/,json:/[j]/,not_json:/[^j]/,text:/^[^\x25]+/,modulo:/^\x25{2}/,placeholder:/^\x25(?:([1-9]\d*)\$|\(([^)]+)\))?(\+)?(0|'[^$])?(-)?(\d+)?(?:\.(\d+))?([b-gijostTuvxX])/,key:/^([a-z_][a-z_\d]*)/i,key_access:/^\.([a-z_][a-z_\d]*)/i,index_access:/^\[(\d+)\]/,sign:/^[+-]/};function n(s){return a(d(s),arguments)}function t(s,i){return n.apply(null,[s].concat(i||[]))}function a(s,i){var u,f,c,h,p,o,b,l,T,_=1,w=s.length,k="";for(f=0;f<w;f++)if("string"==typeof s[f])k+=s[f];else if("object"==typeof s[f]){if((h=s[f]).keys)for(u=i[_],c=0;c<h.keys.length;c++){if(null==u)throw new Error(n('[sprintf] Cannot access property "%s" of undefined value "%s"',h.keys[c],h.keys[c-1]));u=u[h.keys[c]]}else u=h.param_no?i[h.param_no]:i[_++];if(e.not_type.test(h.type)&&e.not_primitive.test(h.type)&&u instanceof Function&&(u=u()),e.numeric_arg.test(h.type)&&"number"!=typeof u&&isNaN(u))throw new TypeError(n("[sprintf] expecting number but found %T",u));switch(e.number.test(h.type)&&(l=u>=0),h.type){case"b":u=parseInt(u,10).toString(2);break;case"c":u=String.fromCharCode(parseInt(u,10));break;case"d":case"i":u=parseInt(u,10);break;case"j":u=JSON.stringify(u,null,h.width?parseInt(h.width):0);break;case"e":u=h.precision?parseFloat(u).toExponential(h.precision):parseFloat(u).toExponential();break;case"f":u=h.precision?parseFloat(u).toFixed(h.precision):parseFloat(u);break;case"g":u=h.precision?String(Number(u.toPrecision(h.precision))):parseFloat(u);break;case"o":u=(parseInt(u,10)>>>0).toString(8);break;case"s":u=String(u),u=h.precision?u.substring(0,h.precision):u;break;case"t":u=String(!!u),u=h.precision?u.substring(0,h.precision):u;break;case"T":u=Object.prototype.toString.call(u).slice(8,-1).toLowerCase(),u=h.precision?u.substring(0,h.precision):u;break;case"u":u=parseInt(u,10)>>>0;break;case"v":u=u.valueOf(),u=h.precision?u.substring(0,h.precision):u;break;case"x":u=(parseInt(u,10)>>>0).toString(16);break;case"X":u=(parseInt(u,10)>>>0).toString(16).toUpperCase()}e.json.test(h.type)?k+=u:(!e.number.test(h.type)||l&&!h.sign?T="":(T=l?"+":"-",u=u.toString().replace(e.sign,"")),o=h.pad_char?"0"===h.pad_char?"0":h.pad_char.charAt(1):" ",b=h.width-(T+u).length,p=h.width&&b>0?o.repeat(b):"",k+=h.align?T+u+p:"0"===o?T+p+u:p+T+u)}return k}var r=Object.create(null);function d(s){if(r[s])return r[s];for(var i,u=s,f=[],c=0;u;){if(null!==(i=e.text.exec(u)))f.push(i[0]);else if(null!==(i=e.modulo.exec(u)))f.push("%");else{if(null===(i=e.placeholder.exec(u)))throw new SyntaxError("[sprintf] unexpected placeholder");if(i[2]){c|=1;var h=[],p=i[2],o=[];if(null===(o=e.key.exec(p)))throw new SyntaxError("[sprintf] failed to parse named argument key");for(h.push(o[1]);""!==(p=p.substring(o[0].length));)if(null!==(o=e.key_access.exec(p)))h.push(o[1]);else{if(null===(o=e.index_access.exec(p)))throw new SyntaxError("[sprintf] failed to parse named argument key");h.push(o[1])}i[2]=h}else c|=2;if(3===c)throw new Error("[sprintf] mixing positional and named placeholders is not (yet) supported");f.push({placeholder:i[0],param_no:i[1],keys:i[2],sign:i[3],pad_char:i[4],align:i[5],width:i[6],precision:i[7],type:i[8]})}u=u.substring(i[0].length)}return r[s]=f}void 0!==x&&(x.sprintf=n,x.vsprintf=t),typeof window<"u"&&(window.sprintf=n,window.vsprintf=t)}()},{}],302:[function(v,m,x){"use strict";m.exports=function(r,d){if(r.dimension<=0)return{positions:[],cells:[]};if(1===r.dimension)return function(u,f){for(var c=n(u,f),h=c.length,p=new Array(h),o=new Array(h),b=0;b<h;++b)p[b]=[c[b]],o[b]=[b];return{positions:p,cells:o}}(r,d);var s=r.order.join()+"-"+r.dtype,i=a[s];return d=+d||0,i||(i=a[s]=function(u,f){var h=t[u.length+"d"];if(h)return h(e,u,f)}(r.order,r.dtype)),i(r,d)};var e=v("ndarray-extract-contour"),n=v("zero-crossings"),t={"2d":function(r,d,s){var i=r({order:d,scalarArguments:3,getters:"generic"===s?[0]:void 0,phase:function(u,f,c,h){return u>h|0},vertex:function(u,f,c,h,p,o,b,l,T,_,w,k,L){var M=(b<<0)+(l<<1)+(T<<2)+(_<<3)|0;if(0!==M&&15!==M)switch(M){case 0:case 15:w.push([u-.5,f-.5]);break;case 1:w.push([u-.25-.25*(h+c-2*L)/(c-h),f-.25-.25*(p+c-2*L)/(c-p)]);break;case 2:w.push([u-.75-.25*(-h-c+2*L)/(h-c),f-.25-.25*(o+h-2*L)/(h-o)]);break;case 3:w.push([u-.5,f-.5-.5*(p+c+o+h-4*L)/(c-p+h-o)]);break;case 4:w.push([u-.25-.25*(o+p-2*L)/(p-o),f-.75-.25*(-p-c+2*L)/(p-c)]);break;case 5:w.push([u-.5-.5*(h+c+o+p-4*L)/(c-h+p-o),f-.5]);break;case 6:w.push([u-.5-.25*(-h-c+o+p)/(h-c+p-o),f-.5-.25*(-p-c+o+h)/(p-c+h-o)]);break;case 7:w.push([u-.75-.25*(o+p-2*L)/(p-o),f-.75-.25*(o+h-2*L)/(h-o)]);break;case 8:w.push([u-.75-.25*(-o-p+2*L)/(o-p),f-.75-.25*(-o-h+2*L)/(o-h)]);break;case 9:w.push([u-.5-.25*(h+c+-o-p)/(c-h+o-p),f-.5-.25*(p+c+-o-h)/(c-p+o-h)]);break;case 10:w.push([u-.5-.5*(-h-c-o-p+4*L)/(h-c+o-p),f-.5]);break;case 11:w.push([u-.25-.25*(-o-p+2*L)/(o-p),f-.75-.25*(p+c-2*L)/(c-p)]);break;case 12:w.push([u-.5,f-.5-.5*(-p-c-o-h+4*L)/(p-c+o-h)]);break;case 13:w.push([u-.75-.25*(h+c-2*L)/(c-h),f-.25-.25*(-o-h+2*L)/(o-h)]);break;case 14:w.push([u-.25-.25*(-h-c+2*L)/(h-c),f-.25-.25*(-p-c+2*L)/(p-c)])}},cell:function(u,f,c,h,p,o,b,l,T){l.push(p?[u,f]:[f,u])}});return function(u,f){var c=[],h=[];return i(u,c,h,f),{positions:c,cells:h}}}},a={}},{"ndarray-extract-contour":251,"zero-crossings":318}],303:[function(v,m,x){(function(e){(function(){"use strict";m.exports=function r(d,s,i){i=i||{};var u=a[d];u||(u=a[d]={" ":{data:new Float32Array(0),shape:.2}});var f=u[s];if(!f)if(s.length<=1||!/\d/.test(s))f=u[s]=function(L){for(var M=L.cells,I=L.positions,P=new Float32Array(6*M.length),S=0,E=0,z=0;z<M.length;++z)for(var R=M[z],q=0;q<3;++q){var V=I[R[q]];P[S++]=V[0],P[S++]=V[1]+1.4,E=Math.max(V[0],E)}return{data:P,shape:E}}(n(s,{triangles:!0,font:d,textAlign:i.textAlign||"left",textBaseline:"alphabetic",styletags:{breaklines:!0,bolds:!0,italics:!0,subscripts:!0,superscripts:!0}}));else{for(var c=s.split(/(\d|\s)/),h=new Array(c.length),p=0,o=0,b=0;b<c.length;++b)h[b]=r(d,c[b]),p+=h[b].data.length,o+=h[b].shape,b>0&&(o+=.02);var l=new Float32Array(p),T=0,_=-.5*o;for(b=0;b<h.length;++b){for(var w=h[b].data,k=0;k<w.length;k+=2)l[T++]=w[k]+_,l[T++]=w[k+1];_+=h[b].shape+.02}f=u[s]={data:l,shape:o}}return f};var n=v("vectorize-text"),t=window||e.global||{},a=t.__TEXT_CACHE||{};t.__TEXT_CACHE={}}).call(this)}).call(this,v("_process"))},{_process:5,"vectorize-text":311}],304:[function(v,m,x){"use strict";var e=v("parse-unit");function n(a,r){var d=e(getComputedStyle(a).getPropertyValue(r));return d[0]*t(d[1],a)}function t(a,r){switch(r=r||document.body,a=(a||"px").trim().toLowerCase(),r!==window&&r!==document||(r=document.body),a){case"%":return r.clientHeight/100;case"ch":case"ex":return function(d,s){var i=document.createElement("div");i.style["font-size"]="128"+d,s.appendChild(i);var u=n(i,"font-size")/128;return s.removeChild(i),u}(a,r);case"em":return n(r,"font-size");case"rem":return n(document.body,"font-size");case"vw":return window.innerWidth/100;case"vh":return window.innerHeight/100;case"vmin":return Math.min(window.innerWidth,window.innerHeight)/100;case"vmax":return Math.max(window.innerWidth,window.innerHeight)/100;case"in":return 96;case"cm":return 96/2.54;case"mm":return 96/25.4;case"pt":return 96/72;case"pc":return 16}return 1}m.exports=t},{"parse-unit":265}],305:[function(v,m,x){"use strict";m.exports=function(p){var o=(p=p||{}).center||[0,0,0],b=p.up||[0,1,0],l=p.right||u(b),T=p.radius||1,_=p.theta||0,w=p.phi||0;if(o=[].slice.call(o,0,3),b=[].slice.call(b,0,3),r(b,b),l=[].slice.call(l,0,3),r(l,l),"eye"in p){var k=p.eye,L=[k[0]-o[0],k[1]-o[1],k[2]-o[2]];a(l,L,b),s(l[0],l[1],l[2])<1e-6?l=u(b):r(l,l),T=s(L[0],L[1],L[2]);var M=d(b,L)/T,I=d(l,L)/T;w=Math.acos(M),_=Math.acos(I)}return T=Math.log(T),new f(p.zoomMin,p.zoomMax,o,b,l,T,_,w)};var e=v("filtered-vector"),n=v("gl-mat4/invert"),t=v("gl-mat4/rotate"),a=v("gl-vec3/cross"),r=v("gl-vec3/normalize"),d=v("gl-vec3/dot");function s(p,o,b){return Math.sqrt(Math.pow(p,2)+Math.pow(o,2)+Math.pow(b,2))}function i(p){return Math.min(1,Math.max(-1,p))}function u(p){var o=Math.abs(p[0]),b=Math.abs(p[1]),l=Math.abs(p[2]),T=[0,0,0];o>Math.max(b,l)?T[2]=1:b>Math.max(o,l)?T[0]=1:T[1]=1;for(var _=0,w=0,k=0;k<3;++k)_+=p[k]*p[k],w+=T[k]*p[k];for(k=0;k<3;++k)T[k]-=w/_*p[k];return r(T,T),T}function f(p,o,b,l,T,_,w,k){this.center=e(b),this.up=e(l),this.right=e(T),this.radius=e([_]),this.angle=e([w,k]),this.angle.bounds=[[-1/0,-Math.PI/2],[1/0,Math.PI/2]],this.setDistanceLimits(p,o),this.computedCenter=this.center.curve(0),this.computedUp=this.up.curve(0),this.computedRight=this.right.curve(0),this.computedRadius=this.radius.curve(0),this.computedAngle=this.angle.curve(0),this.computedToward=[0,0,0],this.computedEye=[0,0,0],this.computedMatrix=new Array(16);for(var L=0;L<16;++L)this.computedMatrix[L]=.5;this.recalcMatrix(0)}var c=f.prototype;c.setDistanceLimits=function(p,o){p=p>0?Math.log(p):-1/0,o=o>0?Math.log(o):1/0,o=Math.max(o,p),this.radius.bounds[0][0]=p,this.radius.bounds[1][0]=o},c.getDistanceLimits=function(p){var o=this.radius.bounds[0];return p?(p[0]=Math.exp(o[0][0]),p[1]=Math.exp(o[1][0]),p):[Math.exp(o[0][0]),Math.exp(o[1][0])]},c.recalcMatrix=function(p){this.center.curve(p),this.up.curve(p),this.right.curve(p),this.radius.curve(p),this.angle.curve(p);for(var o=this.computedUp,b=this.computedRight,l=0,T=0,_=0;_<3;++_)T+=o[_]*b[_],l+=o[_]*o[_];var w=Math.sqrt(l),k=0;for(_=0;_<3;++_)b[_]-=o[_]*T/l,k+=b[_]*b[_],o[_]/=w;var L=Math.sqrt(k);for(_=0;_<3;++_)b[_]/=L;var M=this.computedToward;a(M,o,b),r(M,M);var I=Math.exp(this.computedRadius[0]),P=this.computedAngle[0],S=this.computedAngle[1],E=Math.cos(P),z=Math.sin(P),R=Math.cos(S),q=Math.sin(S),V=this.computedCenter,W=E*R,K=z*R,G=q,Y=-E*q,$=-z*q,B=R,N=this.computedEye,U=this.computedMatrix;for(_=0;_<3;++_){var te=W*b[_]+K*M[_]+G*o[_];U[4*_+1]=Y*b[_]+$*M[_]+B*o[_],U[4*_+2]=te,U[4*_+3]=0}var j=U[1],J=U[5],X=U[9],re=U[2],ne=U[6],le=U[10],oe=J*le-X*ne,de=X*re-j*le,se=j*ne-J*re,ge=s(oe,de,se);for(de/=ge,se/=ge,U[0]=oe/=ge,U[4]=de,U[8]=se,_=0;_<3;++_)N[_]=V[_]+U[2+4*_]*I;for(_=0;_<3;++_){k=0;for(var _e=0;_e<3;++_e)k+=U[_+4*_e]*N[_e];U[12+_]=-k}U[15]=1},c.getMatrix=function(p,o){this.recalcMatrix(p);var b=this.computedMatrix;if(o){for(var l=0;l<16;++l)o[l]=b[l];return o}return b};var h=[0,0,0];c.rotate=function(p,o,b,l){if(this.angle.move(p,o,b),l){this.recalcMatrix(p);var T=this.computedMatrix;h[0]=T[2],h[1]=T[6],h[2]=T[10];for(var _=this.computedUp,w=this.computedRight,k=this.computedToward,L=0;L<3;++L)T[4*L]=_[L],T[4*L+1]=w[L],T[4*L+2]=k[L];for(t(T,T,l,h),L=0;L<3;++L)_[L]=T[4*L],w[L]=T[4*L+1];this.up.set(p,_[0],_[1],_[2]),this.right.set(p,w[0],w[1],w[2])}},c.pan=function(p,o,b,l){o=o||0,b=b||0,l=l||0,this.recalcMatrix(p);var T=this.computedMatrix,_=(Math.exp(this.computedRadius[0]),T[1]),w=T[5],k=T[9],L=s(_,w,k),M=T[0],I=T[4],P=T[8],S=M*(_/=L)+I*(w/=L)+P*(k/=L),E=s(M-=_*S,I-=w*S,P-=k*S),z=(M/=E)*o+_*b,R=(I/=E)*o+w*b,q=(P/=E)*o+k*b;this.center.move(p,z,R,q);var V=Math.exp(this.computedRadius[0]);V=Math.max(1e-4,V+l),this.radius.set(p,Math.log(V))},c.translate=function(p,o,b,l){this.center.move(p,o||0,b||0,l||0)},c.setMatrix=function(p,o,b,l){var T=1;"number"==typeof b&&(T=0|b),(T<0||T>3)&&(T=1);var _=(T+2)%3;o||(this.recalcMatrix(p),o=this.computedMatrix);var w=o[T],k=o[T+4],L=o[T+8];if(l){var M=Math.abs(w),I=Math.abs(k),P=Math.abs(L),S=Math.max(M,I,P);M===S?(w=w<0?-1:1,k=L=0):P===S?(L=L<0?-1:1,w=k=0):(k=k<0?-1:1,w=L=0)}else{var E=s(w,k,L);w/=E,k/=E,L/=E}var z,R,q=o[_],V=o[_+4],W=o[_+8],K=q*w+V*k+W*L,G=s(q-=w*K,V-=k*K,W-=L*K),Y=k*(W/=G)-L*(V/=G),$=L*(q/=G)-w*W,B=w*V-k*q,N=s(Y,$,B);if(Y/=N,$/=N,B/=N,this.center.jump(p,fe,ve,Ae),this.radius.idle(p),this.up.jump(p,w,k,L),this.right.jump(p,q,V,W),2===T){var U=o[1],te=o[5],j=o[9];z=oe<0?-Math.PI/2:Math.PI/2,R=Math.atan2(U*Y+te*$+j*B,U*q+te*V+j*W)}else{var re=o[2],ne=o[6],le=o[10],oe=re*w+ne*k+le*L,de=re*q+ne*V+le*W,se=re*Y+ne*$+le*B;z=Math.asin(i(oe)),R=Math.atan2(se,de)}this.angle.jump(p,R,z),this.recalcMatrix(p);var ge=o[2],_e=o[6],Te=o[10],we=this.computedMatrix;n(we,o);var Oe=we[15],fe=we[12]/Oe,ve=we[13]/Oe,Ae=we[14]/Oe,ke=Math.exp(this.computedRadius[0]);this.center.jump(p,fe-ge*ke,ve-_e*ke,Ae-Te*ke)},c.lastT=function(){return Math.max(this.center.lastT(),this.up.lastT(),this.right.lastT(),this.radius.lastT(),this.angle.lastT())},c.idle=function(p){this.center.idle(p),this.up.idle(p),this.right.idle(p),this.radius.idle(p),this.angle.idle(p)},c.flush=function(p){this.center.flush(p),this.up.flush(p),this.right.flush(p),this.radius.flush(p),this.angle.flush(p)},c.setDistance=function(p,o){o>0&&this.radius.set(p,Math.log(o))},c.lookAt=function(p,o,b,l){this.recalcMatrix(p),o=o||this.computedEye,b=b||this.computedCenter;var T=(l=l||this.computedUp)[0],_=l[1],w=l[2],k=s(T,_,w);if(!(k<1e-6)){T/=k,_/=k,w/=k;var L=o[0]-b[0],M=o[1]-b[1],I=o[2]-b[2],P=s(L,M,I);if(!(P<1e-6)){L/=P,M/=P,I/=P;var S=this.computedRight,E=S[0],z=S[1],R=S[2],q=T*E+_*z+w*R,V=s(E-=q*T,z-=q*_,R-=q*w);if(!(V<.01&&(V=s(E=_*I-w*M,z=w*L-T*I,R=T*M-_*L))<1e-6)){E/=V,z/=V,R/=V,this.up.set(p,T,_,w),this.right.set(p,E,z,R),this.center.set(p,b[0],b[1],b[2]),this.radius.set(p,Math.log(P));var W=_*R-w*z,K=w*E-T*R,G=T*z-_*E,Y=s(W,K,G),B=E*L+z*M+R*I,N=(W/=Y)*L+(K/=Y)*M+(G/=Y)*I,U=Math.asin(i(T*L+_*M+w*I)),te=Math.atan2(N,B),j=this.angle._state,J=j[j.length-1],X=j[j.length-2];J%=2*Math.PI;var re=Math.abs(J+2*Math.PI-te),ne=Math.abs(J-te),le=Math.abs(J-2*Math.PI-te);re<ne&&(J+=2*Math.PI),le<ne&&(J-=2*Math.PI),this.angle.jump(this.angle.lastT(),J,X),this.angle.set(p,te,U)}}}}},{"filtered-vector":68,"gl-mat4/invert":98,"gl-mat4/rotate":103,"gl-vec3/cross":157,"gl-vec3/dot":162,"gl-vec3/normalize":179}],306:[function(v,m,x){"use strict";m.exports=function(n,t,a){var r=n*t,d=e*n,s=d-(d-n),i=n-s,u=e*t,f=u-(u-t),c=t-f,h=i*c-(r-s*f-i*f-s*c);return a?(a[0]=h,a[1]=r,a):[h,r]};var e=+(Math.pow(2,27)+1)},{}],307:[function(v,m,x){"use strict";m.exports=function(e,n,t){var a=e+n,r=a-e,d=n-r,s=e-(a-r);return t?(t[0]=s+d,t[1]=a,t):[s+d,a]}},{}],308:[function(v,m,x){(function(e){(function(){"use strict";var n=v("bit-twiddle"),t=v("dup"),a=v("buffer").Buffer;e.__TYPEDARRAY_POOL||(e.__TYPEDARRAY_POOL={UINT8:t([32,0]),UINT16:t([32,0]),UINT32:t([32,0]),BIGUINT64:t([32,0]),INT8:t([32,0]),INT16:t([32,0]),INT32:t([32,0]),BIGINT64:t([32,0]),FLOAT:t([32,0]),DOUBLE:t([32,0]),DATA:t([32,0]),UINT8C:t([32,0]),BUFFER:t([32,0])});var r=typeof Uint8ClampedArray<"u",d=typeof BigUint64Array<"u",s=typeof BigInt64Array<"u",i=e.__TYPEDARRAY_POOL;i.UINT8C||(i.UINT8C=t([32,0])),i.BIGUINT64||(i.BIGUINT64=t([32,0])),i.BIGINT64||(i.BIGINT64=t([32,0])),i.BUFFER||(i.BUFFER=t([32,0]));var u=i.DATA,f=i.BUFFER;function c(E){if(E){var R=n.log2(E.length||E.byteLength);u[R].push(E)}}function h(E){E=n.nextPow2(E);var z=n.log2(E),R=u[z];return R.length>0?R.pop():new ArrayBuffer(E)}function p(E){return new Uint8Array(h(E),0,E)}function o(E){return new Uint16Array(h(2*E),0,E)}function b(E){return new Uint32Array(h(4*E),0,E)}function l(E){return new Int8Array(h(E),0,E)}function T(E){return new Int16Array(h(2*E),0,E)}function _(E){return new Int32Array(h(4*E),0,E)}function w(E){return new Float32Array(h(4*E),0,E)}function k(E){return new Float64Array(h(8*E),0,E)}function L(E){return r?new Uint8ClampedArray(h(E),0,E):p(E)}function M(E){return d?new BigUint64Array(h(8*E),0,E):null}function I(E){return s?new BigInt64Array(h(8*E),0,E):null}function P(E){return new DataView(h(E),0,E)}function S(E){E=n.nextPow2(E);var z=n.log2(E),R=f[z];return R.length>0?R.pop():new a(E)}x.free=function(E){if(a.isBuffer(E))f[n.log2(E.length)].push(E);else{if("[object ArrayBuffer]"!==Object.prototype.toString.call(E)&&(E=E.buffer),!E)return;var R=0|n.log2(E.length||E.byteLength);u[R].push(E)}},x.freeUint8=x.freeUint16=x.freeUint32=x.freeBigUint64=x.freeInt8=x.freeInt16=x.freeInt32=x.freeBigInt64=x.freeFloat32=x.freeFloat=x.freeFloat64=x.freeDouble=x.freeUint8Clamped=x.freeDataView=function(E){c(E.buffer)},x.freeArrayBuffer=c,x.freeBuffer=function(E){f[n.log2(E.length)].push(E)},x.malloc=function(E,z){if(void 0===z||"arraybuffer"===z)return h(E);switch(z){case"uint8":return p(E);case"uint16":return o(E);case"uint32":return b(E);case"int8":return l(E);case"int16":return T(E);case"int32":return _(E);case"float":case"float32":return w(E);case"double":case"float64":return k(E);case"uint8_clamped":return L(E);case"bigint64":return I(E);case"biguint64":return M(E);case"buffer":return S(E);case"data":case"dataview":return P(E);default:return null}return null},x.mallocArrayBuffer=h,x.mallocUint8=p,x.mallocUint16=o,x.mallocUint32=b,x.mallocInt8=l,x.mallocInt16=T,x.mallocInt32=_,x.mallocFloat32=x.mallocFloat=w,x.mallocFloat64=x.mallocDouble=k,x.mallocUint8Clamped=L,x.mallocBigUint64=M,x.mallocBigInt64=I,x.mallocDataView=P,x.mallocBuffer=S,x.clearCache=function(){for(var E=0;E<32;++E)i.UINT8[E].length=0,i.UINT16[E].length=0,i.UINT32[E].length=0,i.INT8[E].length=0,i.INT16[E].length=0,i.INT32[E].length=0,i.FLOAT[E].length=0,i.DOUBLE[E].length=0,i.BIGUINT64[E].length=0,i.BIGINT64[E].length=0,i.UINT8C[E].length=0,u[E].length=0,f[E].length=0}}).call(this)}).call(this,void 0!==g?g:typeof self<"u"?self:typeof window<"u"?window:{})},{"bit-twiddle":32,buffer:3,dup:65}],309:[function(v,m,x){"use strict";function e(t){this.roots=new Array(t),this.ranks=new Array(t);for(var a=0;a<t;++a)this.roots[a]=a,this.ranks[a]=0}m.exports=e;var n=e.prototype;Object.defineProperty(n,"length",{get:function(){return this.roots.length}}),n.makeSet=function(){var t=this.roots.length;return this.roots.push(t),this.ranks.push(0),t},n.find=function(t){for(var a=t,r=this.roots;r[t]!==t;)t=r[t];for(;r[a]!==t;){var d=r[a];r[a]=t,a=d}return t},n.link=function(t,a){var r=this.find(t),d=this.find(a);if(r!==d){var s=this.ranks,i=this.roots,u=s[r],f=s[d];u<f?i[r]=d:f<u?i[d]=r:(i[d]=r,++s[r])}}},{}],310:[function(v,m,x){"use strict";m.exports=function(e,n,t){return 0===e.length?e:n?(t||e.sort(n),function(a,r){for(var d=1,s=a.length,i=a[0],u=a[0],f=1;f<s;++f)if(u=i,r(i=a[f],u)){if(f===d){d++;continue}a[d++]=i}return a.length=d,a}(e,n)):(t||e.sort(),function(a){for(var r=1,d=a.length,s=a[0],i=a[0],u=1;u<d;++u,i=s)if(i=s,(s=a[u])!==i){if(u===r){r++;continue}a[r++]=s}return a.length=r,a}(e))}},{}],311:[function(v,m,x){"use strict";m.exports=function(a,r){return"object"==typeof r&&null!==r||(r={}),e(a,r.canvas||n,r.context||t,r)};var e=v("./lib/vtext"),n=null,t=null;typeof document<"u"&&((n=document.createElement("canvas")).width=8192,n.height=1024,t=n.getContext("2d"))},{"./lib/vtext":312}],312:[function(v,m,x){m.exports=function(c,h,p,o){var b=64,l=1.25,T={breaklines:!1,bolds:!1,italics:!1,subscripts:!1,superscripts:!1};return o&&(o.size&&o.size>0&&(b=o.size),o.lineSpacing&&o.lineSpacing>0&&(l=o.lineSpacing),o.styletags&&o.styletags.breaklines&&(T.breaklines=!!o.styletags.breaklines),o.styletags&&o.styletags.bolds&&(T.bolds=!!o.styletags.bolds),o.styletags&&o.styletags.italics&&(T.italics=!!o.styletags.italics),o.styletags&&o.styletags.subscripts&&(T.subscripts=!!o.styletags.subscripts),o.styletags&&o.styletags.superscripts&&(T.superscripts=!!o.styletags.superscripts)),p.font=[o.fontStyle,o.fontVariant,o.fontWeight,b+"px",o.font].filter(function(_){return _}).join(" "),p.textAlign="start",p.textBaseline="alphabetic",p.direction="ltr",f(function(_,w,k,L,M,I){k=(k=k.replace(/\n/g,"")).replace(/\<br\>/g,!0===I.breaklines?"\n":" ");var P="",S=[];for(q=0;q<k.length;++q)S[q]=P;!0===I.bolds&&(S=s("b","b|",k,S)),!0===I.italics&&(S=s("i","i|",k,S)),!0===I.superscripts&&(S=s("sup","+1",k,S)),!0===I.subscripts&&(S=s("sub","-1",k,S));var E=[],z="";for(q=0;q<k.length;++q)null!==S[q]&&(z+=k[q],E.push(S[q]));var R,q,V,W,K,G=z.split("\n"),Y=G.length,$=Math.round(M*L),B=L,N=2*L,U=0,te=Y*$+N;_.height<te&&(_.height=te),w.fillStyle="#000",w.fillRect(0,0,_.width,_.height),w.fillStyle="#fff";var j=0,J="";function X(){if(""!==J){var _e=w.measureText(J).width;w.fillText(J,B+V,N+W),V+=_e}}function re(){return Math.round(K)+"px "}function ne(_e,Te){var we=""+w.font;if(!0===I.subscripts){var Oe=_e.indexOf("-"),fe=Te.indexOf("-"),ve=Oe>-1?parseInt(_e[1+Oe]):0,Ae=fe>-1?parseInt(Te[1+fe]):0;ve!==Ae&&(we=we.replace(re(),"?px "),K*=Math.pow(.75,Ae-ve),we=we.replace("?px ",re())),W+=.25*$*(Ae-ve)}if(!0===I.superscripts){var ke=_e.indexOf("+"),Pe=Te.indexOf("+"),Ne=ke>-1?parseInt(_e[1+ke]):0,De=Pe>-1?parseInt(Te[1+Pe]):0;Ne!==De&&(we=we.replace(re(),"?px "),K*=Math.pow(.75,De-Ne),we=we.replace("?px ",re())),W-=.25*$*(De-Ne)}if(!0===I.bolds){var ze=_e.indexOf("b|")>-1,Me=Te.indexOf("b|")>-1;!ze&&Me&&(we=Se?we.replace("italic ","italic bold "):"bold "+we),ze&&!Me&&(we=we.replace("bold ",""))}if(!0===I.italics){var Se=_e.indexOf("i|")>-1,Ie=Te.indexOf("i|")>-1;!Se&&Ie&&(we="italic "+we),Se&&!Ie&&(we=we.replace("italic ",""))}w.font=we}for(R=0;R<Y;++R){var le=G[R]+"\n";for(V=0,W=R*$,K=L,J="",q=0;q<le.length;++q){var oe=q+j<E.length?E[q+j]:E[E.length-1];P===oe?J+=le[q]:(X(),J=le[q],void 0!==oe&&(ne(P,oe),P=oe))}X(),j+=le.length;var de=0|Math.round(V+2*B);U<de&&(U=de)}var se=U,ge=N+$*Y;return n(w.getImageData(0,0,se,ge).data,[ge,se,4]).pick(-1,-1,0).transpose(1,0)}(h,p,c,b,l,T),o,b)},m.exports.processPixels=f;var e=v("surface-nets"),n=v("ndarray"),t=v("simplify-planar-graph"),a=v("clean-pslg"),r=v("cdt2d"),d=v("planar-graph-to-polyline");function s(c,h,p,o){for(var b="<"+c+">",l="</"+c+">",T=b.length,_=l.length,w="+"===h[0]||"-"===h[0],k=0,L=-_;k>-1&&-1!==(k=p.indexOf(b,k))&&-1!==(L=p.indexOf(l,k+T))&&!(L<=k);){for(var M=k;M<L+_;++M)if(M<k+T||M>=L)o[M]=null,p=p.substr(0,M)+" "+p.substr(M+1);else if(null!==o[M]){var I=o[M].indexOf(h[0]);-1===I?o[M]+=h:w&&(o[M]=o[M].substr(0,I+1)+(1+parseInt(o[M][I+1]))+o[M].substr(I+2))}var P=k+T,S=p.substr(P,L-P).indexOf(b);k=-1!==S?S:L+_}return o}function u(c,h,p,o){var b=function i(c,h){var p=e(c,128);return h?t(p.cells,p.positions,.25):{edges:p.cells,positions:p.positions}}(c,o),l=function(R,q,V){for(var W=q.textAlign||"start",K=q.textBaseline||"alphabetic",G=[1<<30,1<<30],Y=[0,0],$=R.length,B=0;B<$;++B)for(var N=R[B],U=0;U<2;++U)G[U]=0|Math.min(G[U],N[U]),Y[U]=0|Math.max(Y[U],N[U]);var te=0;switch(W){case"center":te=-.5*(G[0]+Y[0]);break;case"right":case"end":te=-Y[0];break;case"left":case"start":te=-G[0];break;default:throw new Error("vectorize-text: Unrecognized textAlign: '"+W+"'")}var j=0;switch(K){case"hanging":case"top":j=-G[1];break;case"middle":j=-.5*(G[1]+Y[1]);break;case"alphabetic":case"ideographic":j=-3*V;break;case"bottom":j=-Y[1];break;default:throw new Error("vectorize-text: Unrecoginized textBaseline: '"+K+"'")}var J=1/V;return"lineHeight"in q?J*=+q.lineHeight:"width"in q?J=q.width/(Y[0]-G[0]):"height"in q&&(J=q.height/(Y[1]-G[1])),R.map(function(X){return[J*(X[0]+te),J*(X[1]+j)]})}(b.positions,h,p),T=b.edges,_="ccw"===h.orientation;if(a(l,T),h.polygons||h.polygon||h.polyline){for(var w=d(T,l),k=new Array(w.length),L=0;L<w.length;++L){for(var M=w[L],I=new Array(M.length),P=0;P<M.length;++P){for(var S=M[P],E=new Array(S.length),z=0;z<S.length;++z)E[z]=l[S[z]].slice();_&&E.reverse(),I[P]=E}k[L]=I}return k}return h.triangles||h.triangulate||h.triangle?{cells:r(l,T,{delaunay:!1,exterior:!1,interior:!0}),positions:l}:{edges:T,positions:l}}function f(c,h,p){try{return u(c,h,p,!0)}catch{}try{return u(c,h,p,!1)}catch{}return h.polygons||h.polyline||h.polygon?[]:h.triangles||h.triangulate||h.triangle?{cells:[],positions:[]}:{edges:[],positions:[]}}},{cdt2d:42,"clean-pslg":50,ndarray:259,"planar-graph-to-polyline":268,"simplify-planar-graph":297,"surface-nets":302}],313:[function(v,m,x){!function(){"use strict";if(typeof ses>"u"||!ses.ok||ses.ok()){typeof ses<"u"&&(ses.weakMapPermitHostObjects=b);var e=!1;if("function"==typeof WeakMap){var n=WeakMap;if(!(typeof navigator<"u"&&/Firefox/.test(navigator.userAgent))){var t=new n,a=Object.freeze({});if(t.set(a,1),1===t.get(a))return void(m.exports=WeakMap);e=!0}}var r=Object.getOwnPropertyNames,d=Object.defineProperty,s=Object.isExtensible,i="weakmap:ident:"+Math.random()+"___";if(typeof crypto<"u"&&"function"==typeof crypto.getRandomValues&&"function"==typeof ArrayBuffer&&"function"==typeof Uint8Array){var u=new ArrayBuffer(25),f=new Uint8Array(u);crypto.getRandomValues(f),i="weakmap:rand:"+Array.prototype.map.call(f,function(k){return(k%36).toString(36)}).join("")+"___"}if(d(Object,"getOwnPropertyNames",{value:function(k){return r(k).filter(l)}}),"getPropertyNames"in Object){var c=Object.getPropertyNames;d(Object,"getPropertyNames",{value:function(k){return c(k).filter(l)}})}!function(){var k=Object.freeze;d(Object,"freeze",{value:function(I){return T(I),k(I)}});var L=Object.seal;d(Object,"seal",{value:function(I){return T(I),L(I)}});var M=Object.preventExtensions;d(Object,"preventExtensions",{value:function(I){return T(I),M(I)}})}();var h=!1,p=0,o=function(){this instanceof o||w();var k=[],L=[],M=p++;return Object.create(o.prototype,{get___:{value:_(function(I,P){var S,E=T(I);return E?M in E?E[M]:P:(S=k.indexOf(I))>=0?L[S]:P})},has___:{value:_(function(I){var P=T(I);return P?M in P:k.indexOf(I)>=0})},set___:{value:_(function(I,P){var S,E=T(I);return E?E[M]=P:(S=k.indexOf(I))>=0?L[S]=P:(L[S=k.length]=P,k[S]=I),this})},delete___:{value:_(function(I){var P,S,E=T(I);return E?M in E&&delete E[M]:!((P=k.indexOf(I))<0||(S=k.length-1,k[P]=void 0,L[P]=L[S],k[P]=k[S],k.length=S,L.length=S,0))})}})};o.prototype=Object.create(Object.prototype,{get:{value:function(k,L){return this.get___(k,L)},writable:!0,configurable:!0},has:{value:function(k){return this.has___(k)},writable:!0,configurable:!0},set:{value:function(k,L){return this.set___(k,L)},writable:!0,configurable:!0},delete:{value:function(k){return this.delete___(k)},writable:!0,configurable:!0}}),"function"==typeof n?function(){function k(){this instanceof o||w();var L,M=new n,I=void 0,P=!1;return L=e?function(S,E){return M.set(S,E),M.has(S)||(I||(I=new o),I.set(S,E)),this}:function(S,E){if(P)try{M.set(S,E)}catch{I||(I=new o),I.set___(S,E)}else M.set(S,E);return this},Object.create(o.prototype,{get___:{value:_(function(S,E){return I?M.has(S)?M.get(S):I.get___(S,E):M.get(S,E)})},has___:{value:_(function(S){return M.has(S)||!!I&&I.has___(S)})},set___:{value:_(L)},delete___:{value:_(function(S){var E=!!M.delete(S);return I&&I.delete___(S)||E})},permitHostObjects___:{value:_(function(S){if(S!==b)throw new Error("bogus call to permitHostObjects___");P=!0})}})}e&&typeof Proxy<"u"&&(Proxy=void 0),k.prototype=o.prototype,m.exports=k,Object.defineProperty(WeakMap.prototype,"constructor",{value:WeakMap,enumerable:!1,configurable:!0,writable:!0})}():(typeof Proxy<"u"&&(Proxy=void 0),m.exports=o)}function b(k){k.permitHostObjects___&&k.permitHostObjects___(b)}function l(k){return!("weakmap:"==k.substr(0,8)&&"___"===k.substr(k.length-3))}function T(k){if(k!==Object(k))throw new TypeError("Not an object: "+k);var L=k[i];if(L&&L.key===k)return L;if(s(k)){L={key:k};try{return d(k,i,{value:L,writable:!1,enumerable:!1,configurable:!1}),L}catch{return}}}function _(k){return k.prototype=null,Object.freeze(k)}function w(){h||typeof console>"u"||(h=!0,console.warn("WeakMap should be invoked as new WeakMap(), not WeakMap(). This will be an error in the future."))}}()},{}],314:[function(v,m,x){var e=v("./hidden-store.js");m.exports=function(){var n={};return function(t){if(("object"!=typeof t||null===t)&&"function"!=typeof t)throw new Error("Weakmap-shim: Key must be object");var a=t.valueOf(n);return a&&a.identity===n?a:e(t,n)}}},{"./hidden-store.js":315}],315:[function(v,m,x){m.exports=function(e,n){var t={identity:n},a=e.valueOf;return Object.defineProperty(e,"valueOf",{value:function(r){return r!==n?a.apply(this,arguments):t},writable:!0}),t}},{}],316:[function(v,m,x){var e=v("./create-store.js");m.exports=function(){var n=e();return{get:function(t,a){var r=n(t);return r.hasOwnProperty("value")?r.value:a},set:function(t,a){return n(t).value=a,this},has:function(t){return"value"in n(t)},delete:function(t){return delete n(t).value}}}},{"./create-store.js":314}],317:[function(v,m,x){"use strict";var t,a;m.exports=(t=function(){return function(t,a,r,d,s,i){var u=t[0],f=r[0],c=[0],h=f;d|=0;var p=0,o=f;for(p=0;p<u;++p){var b=a[d]-i,l=a[d+h]-i;b>=0!=l>=0&&s.push(c[0]+.5+.5*(b+l)/(b-l)),d+=o,++c[0]}}}.bind(void 0,{funcName:"zeroCrossings"}),a={},function(r,d,s){var i=r.dtype,u=r.order,f=[i,u.join()].join(),c=a[f];return c||(a[f]=c=t([i,u])),c(r.shape.slice(0),r.data,r.stride,0|r.offset,d,s)})},{}],318:[function(v,m,x){"use strict";m.exports=function(n,t){var a=[];return t=+t||0,e(n.hi(n.shape[0]-1),a,t),a};var e=v("./lib/zc-core")},{"./lib/zc-core":317}]},{},[6])(6)})}).call(this)}).call(this,typeof global<"u"?global:typeof self<"u"?self:typeof window<"u"?window:{})},{}]},{},[27])(27)}}]);